[{"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1543451180, "post_id": 53529895, "comment_id": 93928686, "body": "Maybe I&#39;m missing something here, but why would you think the expectation comes before the method call? How would that work?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1543452061, "post_id": 53529895, "comment_id": 93928885, "body": "The <code>allow</code> or <code>expect</code> lines go before the method call. But for any expectations, where you check the <i>state</i> that occurs as a <i>result</i> of a method call - that needs to go afterwards. Why would <code>cli.class_name == &quot;Song&quot;</code> before you call the method <code>get_class_info</code>?"}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1543506034, "post_id": 53529895, "comment_id": 93952063, "body": "only mock expectations go before"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1543508838, "post_id": 53529895, "comment_id": 93953721, "body": "can you show the part where <code>cli</code> is defined? Something like <code>let(:cli) { ... }</code>"}, {"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1543610907, "post_id": 53529895, "comment_id": 93995210, "body": "Thanks @maxpleaner and others. I&#39;m still getting the hang of writing specs, and getting the hang of understanding the kinds of principles you&#39;re referring to."}], "owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543449327, "creation_date": 1543449327, "question_id": 53529895, "link": "https://stackoverflow.com/questions/53529895/rspec-fails-even-when-variables-should-match", "title": "rspec fails even when variables should match", "body": "<p>Methods in my class:</p>\n\n<pre><code>  def get_class_info\n    @class_name = get_class_name\n  end\n\n  def get_class_name\n    puts \"Enter the name for your class. Enter 'done' to return to the main prompt.\"\n    input = gets.chomp\n    if input.valid_class_name?\n      class_name = input.titleize\n    elsif input.downcase == \"done\"\n      run\n    else\n      puts \"Invalid class name.\"\n      get_class_name\n    end\n    class_name\n  end\n</code></pre>\n\n<p>My test:</p>\n\n<pre><code>it \"stores the name in the @class_name property\" do\n  expect(cli.class_name).to eq('Song')\n  allow(cli).to receive(:gets) {'song'}\n  cli.get_class_info\nend\n</code></pre>\n\n<p>It fails, saying it expected \"Song\" but got nil.\nIf I comment out the expect line and add a pry to the end of the test, querying <code>cli.class_name</code> returns <code>\"Song\"</code>!!!</p>\n\n<p>Why is this test failing??</p>\n\n<p>Update: Okay, moving the <code>expect</code> line to the <em>bottom</em> of the test apparently solved it. But I'm confused because usually the expectation goes before the actual method call. Am I wrong? What am I missing here?</p>\n"}, {"tags": ["ruby", "api", "chef-infra", "newrelic"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6201169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d8ec6f6e7aaf80d2337bc9eb05ad42?s=128&d=identicon&r=PG&f=1", "display_name": "skyvo", "link": "https://stackoverflow.com/users/6201169/skyvo"}, "is_accepted": false, "score": 0, "last_activity_date": 1543531038, "creation_date": 1543531038, "answer_id": 53548623, "question_id": 53528798, "link": "https://stackoverflow.com/questions/53528798/chef-ruby-need-help-creating-api-call-with-headers-proxy-https/53548623#53548623", "title": "Chef Ruby need help creating API call with headers, proxy, https", "body": "<p>Figured it out!</p>\n\n<p>Had to use <code>Net::HTTP.new</code> instead of <code>Net::HTTP.get</code>:</p>\n\n<pre><code>    uri = URI.parse('https://synthetics.newrelic.com/synthetics/api/v3/monitors')\n\nbegin\n  tries ||= 3\n\n  proxy_ipaddress = \"192.168.0.100\"\n  proxy_port = \"3200\"\n\n  proxy_uri = URI.parse(\"http://#{proxy_ipaddress}:#{proxy_port}\")\n\n  http = Net::HTTP.new(uri.host, uri.port, proxy_uri.host, proxy_uri.port)\n  http.use_ssl = true\n  request = Net::HTTP::Get.new(uri.request_uri)\n  request[\"x-api-key\"] = \"&lt;insert_your_API_key_here&gt;\"\n\n  response = http.request(request)\n  all_running_synthetics_scripts = response.body.to_json\n\n  # Finish HTTP connection. -- Find out if this is necessary or not\n  http.finish if http.started?\n\n raise \"ERROR: Unable to retrieve New Relic Synthetics monitors, got http code #{response.response.code.to_i}\" unless response.response.code.to_i == 200\n\nrescue\n  if (tries -= 1) &gt; 0\n    puts(\"Retrieving New Relic Synthetics monitors: [#{uri}].. Retrying!\\n\")\n    sleep(10)\n    retry\n  else\n    puts(\"Retrieving New Relic Synthetics monitors: [#{uri}].. Failed!\\n\")\n    return\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6201169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82d8ec6f6e7aaf80d2337bc9eb05ad42?s=128&d=identicon&r=PG&f=1", "display_name": "skyvo", "link": "https://stackoverflow.com/users/6201169/skyvo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543531038, "creation_date": 1543442578, "last_edit_date": 1543443779, "question_id": 53528798, "link": "https://stackoverflow.com/questions/53528798/chef-ruby-need-help-creating-api-call-with-headers-proxy-https", "title": "Chef Ruby need help creating API call with headers, proxy, https", "body": "<p>I'm trying to run an API call to New Relic in order to retrieve a list of all Synthetics monitors. I'm having trouble getting this to work and just getting stuck... tried looking at many ruby references but I'm just not getting it so I hope you guys could help me!</p>\n\n<p>This requires HTTPS, Proxy, and auth headers:</p>\n\n<pre><code>Chef::Log.info('Retrieving New Relic Synthetics monitors')\nuri = URI(\"https://synthetics.newrelic.com/synthetics/api/v3/monitors\")\nuri.headers = \"x-api-key:&lt;my_key_here&gt;\"\nproxy_addr = \"192.168.0.100\"\nproxy_port = \"3200\"\n\nbegin\n  tries ||= 3\n  response = JSON.parse(Net::HTTP.new(uri.host, uri.port, proxy_addr, proxy_port, :use_ssl =&gt; uri.scheme == 'https') { |http|\n    request = Net::HTTP::Get.new uri\n    response = http.request request\n  })\n\n  raise 'ERROR: Unable to retrieve New Relic Synthetics monitors' unless response['monitors'] \n  all_synthetics_monitors = response\nrescue\n  if (tries -= 1) &gt; 0\n    Chef::Log.warn(\"Retrieving New Relic Synthetics monitors: [#{uri}].. Retrying!\\n\")\n    sleep(10)\n    retry\n  else\n    Chef::Log.error(\"Retrieving New Relic Synthetics monitors: [#{uri}].. Failed!\\n\")\n    return\n  end\nend.flatten\n</code></pre>\n\n<p>So far, I'm just getting retries and not able to figure out even what this API is passing. I tried running some 'puts' around request and response, but haven't been able to get very far here...</p>\n"}, {"tags": ["ruby", "class", "conditional"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1543442373, "post_id": 53528707, "comment_id": 93926230, "body": "Your conditional will never be true <code>:environemnt == :development</code> will always be false and the second one is not actually a condition at all. Additionally <code>Symbols</code> are not variables and cannot be assigned as above"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1543442434, "post_id": 53528707, "comment_id": 93926249, "body": "And <code>:ssl_pin = &#39;AKEIN&#39;</code> is a syntax error"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543443105, "post_id": 53528707, "comment_id": 93926476, "body": "@engineersmnky ok I will modify the conditional.  Why is the second option not a condition?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543443600, "post_id": 53528707, "comment_id": 93926683, "body": "Because when I posted that it said else and not elsif but either way now both both conditions will always be false since a symbol will never equal a string"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1543443710, "post_id": 53528707, "comment_id": 93926728, "body": "OK, I see.  I&#39;ll go with @mrzasa&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1543443342, "post_id": 53528768, "comment_id": 93926578, "body": "+1 Sometimes a hash is all you need. If you later need an object, that object can replace the hash and provide a <code>[]</code> method for compatibility."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 6, "last_activity_date": 1543442473, "creation_date": 1543442473, "answer_id": 53528768, "question_id": 53528707, "link": "https://stackoverflow.com/questions/53528707/can-i-use-objects-instead-of-conditionals-for-clean-code-ruby/53528768#53528768", "title": "Can I use objects instead of conditionals for Clean Code Ruby?", "body": "<p>You can use hashes with config if you really want to avoid conditionals:</p>\n\n<pre><code>config = {\n  development: {\n    ssl_merchant_id: '001234'\n    ssl_user_id: 'windoe6'\n    ssl_pin: 'ABCDE'\n  }\n  production: { \n    ssl_merchant_id: '006543'\n    ssl_user_id: 'dingbat32'\n    ssl_pin: 'AKEIN'\n  }\n}\n\nconfig[environment.to_sym]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1543443254, "post_id": 53528853, "comment_id": 93926547, "body": "I&#39;d suggest a hybrid of @mrzasa&#39;s answer. Put the initialization info into a constant. Initialize from the constant. This avoids hard coding configuration in the class and prevents an unnecessary amount of subclasses. And remember, Hashes are objects."}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1543443417, "post_id": 53528853, "comment_id": 93926613, "body": "@Schwern in a real environment I totally agree with you. I would die inside if I saw a setup class like this :P"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1543443934, "post_id": 53528853, "comment_id": 93926812, "body": "Doesn&#39;t code get super bloated this way?  It seems like a lot to make a simple choice of values."}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1543454283, "post_id": 53528853, "comment_id": 93929377, "body": "@Rich_F when you get to the level of complexity where something like this is warranted you&#39;re going to need abstractions. It&#39;s impossible to work in a system without good abstractions. It <i>can</i> bloat code, but so can tons of switch and if/else statements. Ask yourself what happens when you want to attach behaviour to configuration. Where do those methods go? Passing around arrays and hashes is easy to write, but can be hard to debug down the road."}], "tags": [], "owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "is_accepted": false, "score": 3, "last_activity_date": 1543443368, "last_edit_date": 1543443368, "creation_date": 1543442912, "answer_id": 53528853, "question_id": 53528707, "link": "https://stackoverflow.com/questions/53528707/can-i-use-objects-instead-of-conditionals-for-clean-code-ruby/53528853#53528853", "title": "Can I use objects instead of conditionals for Clean Code Ruby?", "body": "<p>Using objects you'd create a Factory like this:</p>\n\n<pre><code>class Environment\n  attr_accessor :ssl_merchant_id, :ssl_user_id, :ssl_pin\nend\n\nclass Development &lt; Environment\n  def initialize\n    @ssl_merchant_id  = '001234'\n    @ssl_user_id      = 'windoe6'\n    @ssl_pin          = 'ABCDE'\n  end\nend\n\nclass Production &lt; Environment\n  def initialize\n    @ssl_merchant_id  = '006543'\n    @ssl_user_id      = 'dingbat32'\n    @ssl_pin          = 'AKEIN'\n  end\nend\n\nclass EnvironmentFactory\n  def self.build(environment)\n    Kernel.const_get(environment.to_s.capitalize).new\n  end\nend\n\nEnvironmentFactory.build(&lt;:development or :production&gt;)\n</code></pre>\n\n<p>This is a \"more object oriented\" version of <a href=\"https://stackoverflow.com/a/53528768/33226\">mrzasa's answer</a>. Typically you'll want to stick with the config based version until your objects need this level of complexity and overhead.</p>\n\n<p>This type of pattern is more used in Java / .NET than Ruby and you won't find it commonly used in practice.</p>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 2, "last_activity_date": 1543456206, "creation_date": 1543456206, "answer_id": 53530720, "question_id": 53528707, "link": "https://stackoverflow.com/questions/53528707/can-i-use-objects-instead-of-conditionals-for-clean-code-ruby/53530720#53530720", "title": "Can I use objects instead of conditionals for Clean Code Ruby?", "body": "<p>Objects; no conditionals:</p>\n\n<pre><code># a Struct is just a fast way of creating a class\nSSldata = Struct.new(:ssl_merchant_id, :ssl_user_id, :ssl_pin) \n\ndevelopment = SSldata.new('001234', 'windoe6', 'ABCDE')\nproduction  = SSldata.new('006543', 'dingbat32','AKEIN')\n\n# demo    \nenvironment = development\n\nenvironment.ssl_pin # =&gt; \"ABCDE\"\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53528768, "answer_count": 3, "score": 0, "last_activity_date": 1543464115, "creation_date": 1543442058, "last_edit_date": 1543464115, "question_id": 53528707, "link": "https://stackoverflow.com/questions/53528707/can-i-use-objects-instead-of-conditionals-for-clean-code-ruby", "title": "Can I use objects instead of conditionals for Clean Code Ruby?", "body": "<p>I have a conditional on <code>:environment</code> to set eCommerce symbols for transactions.  When I'm developing, I want the test account to be used.  </p>\n\n<pre><code>if :environemnt == 'development'\n    :ssl_merchant_id  = '001234'\n    :ssl_user_id      = 'windoe6'\n    :ssl_pin          = 'ABCDE'\nelsif :environemnt == 'production'\n    :ssl_merchant_id  = '006543'\n    :ssl_user_id      = 'dingbat32'\n    :ssl_pin          = 'AKEIN'\nend\n</code></pre>\n\n<p>I want to use class definitions and object creation to avoid conditionals.  Clean Code suggests doing so. I can't see getting around a conditional to choose either of these sets of symbols.   </p>\n\n<p>Is it possible to use class definitions to avoid conditionals?  I would still have to create two classes, then choose a class, which has to be chosen in the code.  There's still a trigger which chooses what object to use or create.  Can it be done, and how can it be done?</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1543438541, "post_id": 53527936, "comment_id": 93924679, "body": "Check that <code>rubygems.org</code> resolves, and that you can connect to it. You may have firewall restrictions preventing this from working."}, {"owner": {"reputation": 35, "user_id": 10719310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a9e7669b0b802d49180ed56e0d853d?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10719310/julien"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1543439153, "post_id": 53527936, "comment_id": 93924938, "body": "can connect to rubygems.org, downloading my gems from there to manually install them, however that is quite tedious. edit :  how would i go about seeing if i have those firewall restrictions ? (using win10)"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1543452468, "post_id": 53527936, "comment_id": 93928982, "body": "enter this in terminal and post output: <code>gem env</code>"}, {"owner": {"reputation": 35, "user_id": 10719310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a9e7669b0b802d49180ed56e0d853d?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10719310/julien"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1543497925, "post_id": 53527936, "comment_id": 93947142, "body": "edited. @lacostenycoder"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1543501756, "post_id": 53527936, "comment_id": 93949373, "body": "Are you using Cygwin or Bash on Ubuntu on Windows ?  You probably should be. I also recommend using a ruby version manager see <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">rvm.io/rvm/install</a> but try answer I&#39;ve posted first."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "edited": false, "score": 0, "creation_date": 1543503859, "post_id": 53527936, "comment_id": 93950678, "body": "had smth similar when i had paths with spaces in my system path environment variable, not saying it&#39;s the cause here but use the short form of the paths in windows"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10719310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a9e7669b0b802d49180ed56e0d853d?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10719310/julien"}, "edited": false, "score": 0, "creation_date": 1543502909, "post_id": 53541239, "comment_id": 93950085, "body": "didnt fix the issue, however i did mange to fix it... seems like a stupid issue on rubegems.org side."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1543501663, "creation_date": 1543501663, "answer_id": 53541239, "question_id": 53527936, "link": "https://stackoverflow.com/questions/53527936/ruby-cant-install-gems-only-manually/53541239#53541239", "title": "ruby cant install gems, only manually", "body": "<p>It looks like you're missing sources in your gem configuration. Try this.</p>\n\n<pre><code>gem sources -a  http://rubygems.org\n</code></pre>\n\n<p>It should edit your <code>~/.gemrc</code> file to look like this:</p>\n\n<pre><code>---\n:backtrace: false\n:bulk_threshold: 1000\n:sources:\n- http://rubygems.org\n:update_sources: true\n:verbose: true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10719310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a9e7669b0b802d49180ed56e0d853d?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10719310/julien"}, "is_accepted": false, "score": 0, "last_activity_date": 1543502942, "creation_date": 1543502942, "answer_id": 53541640, "question_id": 53527936, "link": "https://stackoverflow.com/questions/53527936/ruby-cant-install-gems-only-manually/53541640#53541640", "title": "ruby cant install gems, only manually", "body": "<p><a href=\"https://github.com/rubygems/rubygems/issues/2253\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/issues/2253</a></p>\n\n<p>TL;DR: some ipv6 requests dont go through. use ipv4</p>\n"}], "owner": {"reputation": 35, "user_id": 10719310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a9e7669b0b802d49180ed56e0d853d?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10719310/julien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543502942, "creation_date": 1543438424, "last_edit_date": 1543497913, "question_id": 53527936, "link": "https://stackoverflow.com/questions/53527936/ruby-cant-install-gems-only-manually", "title": "ruby cant install gems, only manually", "body": "<p>Title says it all, whenever I try to install a gem this happens :</p>\n\n<blockquote>\n  <p>ERROR: Could not find a valid gem 'ruby2d' (>= 0), here is why: \n            Unable to download data from <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">https://rubygems.org/</a> - timed out (<a href=\"https://api.rubygems.org/specs.4.8.gz\" rel=\"nofollow noreferrer\">https://api.rubygems.org/specs.4.8.gz</a>)</p>\n</blockquote>\n\n<p>I have reinstalled ruby to try to fix this, without any luck.\nAlso, I tried updating my rubygems version, getting this error : </p>\n\n<blockquote>\n  <p>ERROR:  While executing gem ... (Gem::RemoteFetcher::UnknownHostError)\n      timed out (<a href=\"https://api.rubygems.org/specs.4.8.gz\" rel=\"nofollow noreferrer\">https://api.rubygems.org/specs.4.8.gz</a>)</p>\n</blockquote>\n\n<pre><code> RubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.6\n  - RUBY VERSION: 2.5.3 (2018-10-18 patchlevel 105) [x64-mingw32]\n  - INSTALLATION DIRECTORY: C:/Ruby25-x64/lib/ruby/gems/2.5.0\n  - USER INSTALLATION DIRECTORY: C:/Users/julia_ps3fg4w/.gem/ruby/2.5.0\n  - RUBY EXECUTABLE: C:/Ruby25-x64/bin/ruby.exe\n  - EXECUTABLE DIRECTORY: C:/Ruby25-x64/bin\n  - SPEC CACHE DIRECTORY: C:/Users/julia_ps3fg4w/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: C:/ProgramData\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x64-mingw32\n  - GEM PATHS:\n     - C:/Ruby25-x64/lib/ruby/gems/2.5.0\n     - C:/Users/julia_ps3fg4w/.gem/ruby/2.5.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n</code></pre>\n"}, {"tags": ["ruby", "class", "instance"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543440850, "post_id": 53527932, "comment_id": 93925635, "body": "I assume you know that you can&#39;t write <code>def get_a; @a; end</code>, as <code>c = C.new; c.get_a</code> would return the value of <code>c</code>&#39;s instance_variable <code>@a</code>. You therefore will need to employ two methods within <code>get_a</code> to obtain the value of the class instance variable <code>@a</code>. The first to obtain <code>c</code>&#39;s class; the second, invoked on <code>c</code>&#39;s class, to obtain the value of the variable."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1543484347, "post_id": 53527932, "comment_id": 93939362, "body": "Instance variables belong to instances. That&#39;s why they are called instance variables. <code>C</code> and <code>C.new</code> are two completely different objects that have absolutely northing to do with each other. The whole point of instance variables is that one object cannot access another object&#39;s instance variables, <i>unless</i> that object explicitly exposes them in some manner."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543439403, "post_id": 53528050, "comment_id": 93925040, "body": "What do you mean you can&#39;t reference it directly? Is not <code>instance_variable_get</code> a perfectly good, garden-variety method? I think you should say &quot;yes, use <code>instance_variable_get</code>&quot;."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543439610, "post_id": 53528050, "comment_id": 93925133, "body": "I mean that you cannot reference them using <code>@@var</code> or <code>@var</code> form, you need to  use a method to access it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543439776, "post_id": 53528050, "comment_id": 93925202, "body": "Yes, I realize that, but the OP merely says, &quot;...can I still access it from within the instance method get_a?&quot;. There&#39;s no mention of not using a method. Also, the mention of an accessor is somewhat irrelevant as it would seem that the OP only wants to change <code>get_a</code> and even if there were an accessor, you&#39;d still be using a method in <code>get_a</code> to access it. This is of course a minor points."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543442260, "post_id": 53528050, "comment_id": 93926196, "body": "@CarySwoveland in that sense almost all variables are accessible from everywhere (the only exception being local variables). With <code>class_eval</code> <code>instance_eval</code> and <code>send</code> you can bypass any scope restrictions, even if there isn&#39;t a standard interface in place like <code>instance_variable_get</code>"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 3, "last_activity_date": 1543438996, "creation_date": 1543438996, "answer_id": 53528050, "question_id": 53527932, "link": "https://stackoverflow.com/questions/53527932/in-ruby-can-i-access-a-class-instance-variable-from-within-an-instance-method/53528050#53528050", "title": "In Ruby, can I access a class instance variable from within an instance method?", "body": "<p>I don't think you can reference it directly. Class is an object and instance variables are private/internal to the object. You can access it either using <a href=\"https://ruby-doc.org/core-2.5.1/Object.html#method-i-instance_variable_get\" rel=\"nofollow noreferrer\"><code>instance_variable_get</code></a> on the class or by wrapping it in a getter method.</p>\n\n<p>In Rails you can use <a href=\"https://api.rubyonrails.org/classes/Class.html#method-i-class_attribute\" rel=\"nofollow noreferrer\"><code>class_variable</code> macro</a> that facilitates setting and accessing class-level variables.</p>\n"}], "owner": {"reputation": 12283, "user_id": 200783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6b938dc4205cd0cea4e4e68451c42a21?s=128&d=identicon&r=PG", "display_name": "user200783", "link": "https://stackoverflow.com/users/200783/user200783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1543479390, "creation_date": 1543438400, "last_edit_date": 1543479390, "question_id": 53527932, "link": "https://stackoverflow.com/questions/53527932/in-ruby-can-i-access-a-class-instance-variable-from-within-an-instance-method", "title": "In Ruby, can I access a class instance variable from within an instance method?", "body": "<p>The following code sets a class variable in the class <code>C</code> from a class method, and shows that it is accessible from an instance method:</p>\n\n<pre><code>class C\n  def self.set_a\n    @@a = 1\n  end\n\n  def get_a\n    @@a\n  end\nend\n\nC.set_a\nC.new.get_a #=&gt; 1\n</code></pre>\n\n<p>If I replace <code>@@a</code> in the class method <code>set_a</code> with <code>@a</code>, so that it creates a class instance variable instead of a class variable, can I still access it from within the instance method <code>get_a</code>?</p>\n"}, {"tags": ["ruby", "rspec", "mocking"], "answers": [{"comments": [{"owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "edited": false, "score": 0, "creation_date": 1543446094, "post_id": 53528517, "comment_id": 93927486, "body": "Thanks! <code>allow(cli).to receive(:gets).and_return(&#39;class&#39;)</code> is exactly the kind of thing I was looking for, and it works."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1543441595, "last_edit_date": 1543441595, "creation_date": 1543441119, "answer_id": 53528517, "question_id": 53527160, "link": "https://stackoverflow.com/questions/53527160/testing-gets-in-rspec-user-input/53528517#53528517", "title": "Testing gets in rspec (user input)", "body": "<p>You can avoid this as such: </p>\n\n<pre><code>def run\n  puts \"Enter 'class' to create a new class.\"\n  input = gets.chomp\nend\n\ndescribe 'gets' do \n  it 'belongs to Kernel' do \n    allow_any_instance_of(Kernel).to receive(:gets).and_return('class')\n    expect(run).to eq('class')\n  end\nend\n</code></pre>\n\n<p>The method <code>gets</code> actually belongs to the <code>Kernel</code> module. (<code>method(:gets).owner == Kernel</code>). Since <code>Kernel</code> is included in <code>Object</code> and almost all ruby objects inherit from <code>Object</code> this will work.</p>\n\n<p>Now if <code>run</code> is an instance method scoped in a <code>Class</code> I would recommend scoping the stubbing a bit more such that:</p>\n\n<pre><code>class Test\n  def run\n    puts \"Enter 'class' to create a new class.\"\n    input = gets.chomp\n  end\nend\n\ndescribe 'gets' do \n  it 'can be stubbed lower than that' do \n    allow_any_instance_of(Test).to receive(:gets).and_return('class')\n    expect(Test.new.run).to eq('class')\n  end\n  # or even \n  it 'or even lower than that' do \n    cli = Test.new\n    allow(cli).to receive(:gets).and_return('class')\n    expect(cli.run).to eq('class')\n  end\nend\n</code></pre>\n\n<p><a href=\"https://repl.it/@engineersmnky/Stub-Kernelgets\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 6375, "user_id": 6826164, "user_type": "registered", "accept_rate": 39, "profile_image": "https://lh6.googleusercontent.com/-CKThqFqe5Eo/AAAAAAAAAAI/AAAAAAAAP10/ih0uh1YgT_I/photo.jpg?sz=128", "display_name": "Jonathan Tuzman", "link": "https://stackoverflow.com/users/6826164/jonathan-tuzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 53528517, "answer_count": 1, "score": 0, "last_activity_date": 1543441595, "creation_date": 1543434992, "question_id": 53527160, "link": "https://stackoverflow.com/questions/53527160/testing-gets-in-rspec-user-input", "title": "Testing gets in rspec (user input)", "body": "<p>My class has this #run method that so far is just this, to test the testing:</p>\n\n<pre><code>def run\n    puts \"Enter 'class' to create a new class.\"\n    input = $stdin.gets.chomp\n    binding.pry\n</code></pre>\n\n<p>And in the tests so far I've got </p>\n\n<pre><code>  allow($stdin).to receive(:gets).and_return 'class'\n  cli.run\n</code></pre>\n\n<p>Doing it this way I am able to see, in the pry session, that <code>input</code> has been set to <code>'class'</code>, as intended.</p>\n\n<p>Is there a way to do with without adding <code>$stdin</code> to my call to <code>gets</code> in my method itself? i.e., <code>input = gets.chomp</code></p>\n\n<p>I've tried <code>allow(cli.run).to receive(:gets).and_return 'class'</code>\nBut then in the pry session, <code>input</code> is equal to the first line of the spec file!</p>\n"}, {"tags": ["ruby", "garbage-collection"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 3, "creation_date": 1543434677, "post_id": 53527020, "comment_id": 93922973, "body": "From a black box perspective, this seems normal; the GC hasn&#39;t deemed it fit to destroy the instance in memory. Maybe it&#39;s waiting for a certain point in execution or for for some threshold to be hit, but regardless, it&#39;s out of your hands."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1543441891, "post_id": 53527020, "comment_id": 93926043, "body": "@ggorlen &quot;...it&#39;s out of your hands&quot; not necessarily. If you really want to force something to be collected you can technically <a href=\"https://ruby-doc.org/stdlib-2.1.2/libdoc/weakref/rdoc/WeakRef.html\" rel=\"nofollow noreferrer\">WeakRef</a> it, although definitely not recommended as it could be consumed by an internal GC rather than an explicit <code>GC.start</code>. Simply adding <code>b = WeakRef.new(b)</code> before the <code>GC.start</code> causes this code to result in <code>0</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543479828, "post_id": 53527020, "comment_id": 93936773, "body": "Cannot reproduce. Your example code works for me as expected, i.e. the last count returns <code>0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1543484488, "creation_date": 1543484488, "answer_id": 53535947, "question_id": 53527020, "link": "https://stackoverflow.com/questions/53527020/why-isnt-this-simple-class-garbage-collected-in-ruby-console/53535947#53535947", "title": "Why isn&#39;t this simple class garbage collected in Ruby console?", "body": "<p>The garbage collector only collects garbage when it absolutely has to. Collection is expensive.</p>\n\n<p>Unless you run out of memory, it is highly unlikely that your object will be garbage collected.</p>\n\n<p>Note: this is obviously highly dependent on the specific implementation, the specific version of the specific implementation, and the specific environment that you use. E.g. Rubinius has a completely different GC than YARV has, which has a completely different GC than MRuby has. Even <em>within</em> YARV, the GC has changed significantly between versions. TruffleRuby, JRuby, IronRuby, MagLev, and Opal don't even have a GC at all, the rely on the underlying platform's memory management.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 2701069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe51b01b1ea813f204a30e7d0591bfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Gomez", "link": "https://stackoverflow.com/users/2701069/leandro-gomez"}, "is_accepted": true, "score": 0, "last_activity_date": 1543582999, "creation_date": 1543582999, "answer_id": 53558152, "question_id": 53527020, "link": "https://stackoverflow.com/questions/53527020/why-isnt-this-simple-class-garbage-collected-in-ruby-console/53558152#53558152", "title": "Why isn&#39;t this simple class garbage collected in Ruby console?", "body": "<p>It seems this was already answered in <a href=\"https://stackoverflow.com/questions/17643390/gc-start-has-no-effect-in-pry-but-does-in-irb\">another question</a></p>\n\n<p>Pry stores the output of the last 100 commands and thus the object can't actually be garbage collected.</p>\n"}], "owner": {"reputation": 39, "user_id": 2701069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe51b01b1ea813f204a30e7d0591bfbb?s=128&d=identicon&r=PG&f=1", "display_name": "Leandro Gomez", "link": "https://stackoverflow.com/users/2701069/leandro-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53558152, "answer_count": 2, "score": 0, "last_activity_date": 1543582999, "creation_date": 1543434437, "last_edit_date": 1543582824, "question_id": 53527020, "link": "https://stackoverflow.com/questions/53527020/why-isnt-this-simple-class-garbage-collected-in-ruby-console", "title": "Why isn&#39;t this simple class garbage collected in Ruby console?", "body": "<p>I am running some tests with the Ruby garbage collector. When I run it from the Ruby console I get this weird behavior:</p>\n\n<pre><code>class B\nend\n#=&gt; nil\ncount = ObjectSpace.each_object(B) {|x| x }\n#=&gt; 0\nb = B.new\n#=&gt; #&lt;B:0x00007feeb7849678&gt;\ncount = ObjectSpace.each_object(B) {|x| x }\n#=&gt; 1\nb = nil\n#=&gt;  nil\nGC.start\n#=&gt; nil\ncount = ObjectSpace.each_object(B) {|x| x }\n#=&gt; 1\n</code></pre>\n\n<p>Why is it happening?</p>\n\n<p>UPDATE: I only get this behavior in PRY. In IRB works as expected (the object is garbage collected).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "haml"], "answers": [{"tags": [], "owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "is_accepted": false, "score": 1, "last_activity_date": 1543432467, "creation_date": 1543432467, "answer_id": 53526548, "question_id": 53526312, "link": "https://stackoverflow.com/questions/53526312/the-new-lines-from-en-yml-wont-get-rendered-on-an-html-page/53526548#53526548", "title": "The new lines from en.yml won&#39;t get rendered on an html page", "body": "<p>YAML returns a string with <code>\\n</code> for that <code>test</code> key. If you want to show it in html you need to convert that new lines to proper html tags. You can use <a href=\"https://api.rubyonrails.org/v5.1/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format\" rel=\"nofollow noreferrer\">simple_format</a> helper for that:</p>\n\n<pre><code>simple_format(\"foo\\nbar\") # =&gt; \"&lt;p&gt;foo\\n&lt;br /&gt;bar&lt;/p&gt;\"\nsimple_format(\"foo\\n\\nbar\") # =&gt; \"&lt;p&gt;foo&lt;/p&gt;\\n\\n&lt;p&gt;bar&lt;/p&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10691978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e8becc69dd0d98b53e959c9489fd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Maddani", "link": "https://stackoverflow.com/users/10691978/maddani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543432467, "creation_date": 1543431478, "question_id": 53526312, "link": "https://stackoverflow.com/questions/53526312/the-new-lines-from-en-yml-wont-get-rendered-on-an-html-page", "title": "The new lines from en.yml won&#39;t get rendered on an html page", "body": "<p>In en.yml I have strings with new lines. When they're rendered on an html page, the new lines disappear -- it's rendered as a single line. </p>\n\n<p>My en.yml:</p>\n\n<pre><code>test: |+\n  Something fdsafdsfd\n\n\n  fdsafdsfd\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rvm", "bundler"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6491246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28c6e1a2932e9827c6627dc9fb80af3?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Johnson", "link": "https://stackoverflow.com/users/6491246/brad-johnson"}, "edited": false, "score": 0, "creation_date": 1543431705, "post_id": 53526345, "comment_id": 93921542, "body": "That&#39;s it, thank you! <code>grep -r &quot;2.3.3&quot; *</code> doesn&#39;t include hidden files! That&#39;s why I couldn&#39;t find it. I should have been using <code>grep -r &quot;2.3.3&quot; .</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 53, "user_id": 6491246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28c6e1a2932e9827c6627dc9fb80af3?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Johnson", "link": "https://stackoverflow.com/users/6491246/brad-johnson"}, "edited": false, "score": 0, "creation_date": 1543431812, "post_id": 53526345, "comment_id": 93921603, "body": "I copy pasted your grep and forgot to change the asterisk to dot afterwards, as I initially intended to do... :p"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 7, "last_activity_date": 1543431731, "last_edit_date": 1543431731, "creation_date": 1543431599, "answer_id": 53526345, "question_id": 53526189, "link": "https://stackoverflow.com/questions/53526189/rails-required-ruby-2-3-3-is-not-installed-after-ruby-update-to-2-5-3/53526345#53526345", "title": "Rails - &quot;Required ruby-2.3.3 is not installed.&quot; after Ruby update to 2.5.3", "body": "<p><code>.ruby-version</code></p>\n\n<p>Also, if you had grepped with <code>grep -r \"2.3.3\" .</code> you would have found it.</p>\n"}], "owner": {"reputation": 53, "user_id": 6491246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28c6e1a2932e9827c6627dc9fb80af3?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Johnson", "link": "https://stackoverflow.com/users/6491246/brad-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1295, "favorite_count": 1, "accepted_answer_id": 53526345, "answer_count": 1, "score": 4, "last_activity_date": 1543431731, "creation_date": 1543431040, "question_id": 53526189, "link": "https://stackoverflow.com/questions/53526189/rails-required-ruby-2-3-3-is-not-installed-after-ruby-update-to-2-5-3", "title": "Rails - &quot;Required ruby-2.3.3 is not installed.&quot; after Ruby update to 2.5.3", "body": "<p>I have a Rails install where I updated the Ruby version from 2.3.3 to 2.5.3. I was previously using 2.3.3 from the Debian Ruby package, but installed 2.5.3 from RVM. I modified my Gemfile to use <code>ruby '2.5.3'</code> and ran <code>bundle install</code>. Rails is now using 2.5.3 as it should, but when I cd to the directory, I get a message: </p>\n\n<p><code>\nRequired ruby-2.3.3 is not installed.\nTo install do: 'rvm install \"ruby-2.3.3\"'\n</code></p>\n\n<p>I can't find where it's getting this. Running <code>grep -r \"2.3.3\" *</code> in my Rails project root returns nothing. I know it's something specific to this project, because I've cloned it over to another server and the message persists. What is reporting this and how do I tell it that 2.5.3 is the correct Ruby version? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "edited": false, "score": 0, "creation_date": 1543428958, "post_id": 53525374, "comment_id": 93920221, "body": "Went with this <code>@latest_share = @transaction.captable.shares.maximum(:share_number) || 0</code>. Worked great, thanks!"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 4, "last_activity_date": 1543427634, "creation_date": 1543427634, "answer_id": 53525374, "question_id": 53525336, "link": "https://stackoverflow.com/questions/53525336/increment-a-number-from-nil-to-1-in-ruby/53525374#53525374", "title": "Increment a number from nil to 1 in Ruby", "body": "<p>I'd simply change</p>\n\n<pre><code>@latest_share = @transaction.captable.shares.maximum(:share_number)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>@latest_share = @transaction.captable.shares.maximum(:share_number) || 0\n</code></pre>\n\n<p>or alternatively (assuming that you're operating on integers)</p>\n\n<pre><code>@latest_share = @transaction.captable.shares.maximum(:share_number).to_i\n</code></pre>\n\n<p>as <code>nil.to_i == 0</code></p>\n"}], "owner": {"reputation": 337, "user_id": 2011640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a727a370570aac33c1705c8b1c702abc?s=128&d=identicon&r=PG&f=1", "display_name": "rock_n_rolla", "link": "https://stackoverflow.com/users/2011640/rock-n-rolla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53525374, "answer_count": 1, "score": 0, "last_activity_date": 1543427634, "creation_date": 1543427477, "question_id": 53525336, "link": "https://stackoverflow.com/questions/53525336/increment-a-number-from-nil-to-1-in-ruby", "title": "Increment a number from nil to 1 in Ruby", "body": "<p>I have the following piece of code which works really well for incrementing a number based on the latest maximum number in the database. However, if this is nil, I get an error. </p>\n\n<p>What I'd like to achieve is that I can keep the <code>share_number: @latest_share += 1</code> in place but also check on this line that if that returns nil that we set it nil to 1, and then the loop continues. </p>\n\n<p>Is this possible somehow? </p>\n\n<p>Thanks! </p>\n\n<pre><code># Get last sharenumber in captable \n@latest_share = @transaction.captable.shares.maximum(:share_number)\n\n@number_of_share_numbers_to_create.times do |i| # TODO Refactor this so we don't slow down the application with so many queries\n  Share.create(\n    owner_id: params[:buying_shareholder_id], \n    captable_id: @transaction.captable.id, \n    company_id: @transaction.company.id, \n    share_number: @latest_share += 1 #Increment up from the latest number, but start at 1 if this is nil \n  )\nend\n</code></pre>\n"}, {"tags": ["ruby", "ajax"], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 5156455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008e0ac86b465299852befcb2e44c453?s=128&d=identicon&r=PG", "display_name": "Anil Cherukuri", "link": "https://stackoverflow.com/users/5156455/anil-cherukuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1544041455, "creation_date": 1544041455, "answer_id": 53640175, "question_id": 53525159, "link": "https://stackoverflow.com/questions/53525159/ruby-ajax-request-delete-table-row/53640175#53640175", "title": "Ruby AJAX request delete table row", "body": "<p>You can do something like this <a href=\"https://guides.rubyonrails.org/working_with_javascript_in_rails.html#link-to\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/working_with_javascript_in_rails.html#link-to</a></p>\n"}], "owner": {"reputation": 163, "user_id": 10077523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f822573f9e371bb432a29f595b7d7867?s=128&d=identicon&r=PG", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0430\u043d\u0434\u0440", "link": "https://stackoverflow.com/users/10077523/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544041455, "creation_date": 1543426737, "question_id": 53525159, "link": "https://stackoverflow.com/questions/53525159/ruby-ajax-request-delete-table-row", "title": "Ruby AJAX request delete table row", "body": "<p>I have a project (unfortunately i can't show that all) and my task is to delete table row when clicking a link using AJAX request.</p>\n\n<p>My page file has structure like this:</p>\n\n<pre><code>&lt;table&gt;\n&lt;tr&gt;\n&lt;a href=\"account/1\" \"data-id\": \"1\", \"data-method\": \"delete\"&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;a href=\"account/2\" \"data-id\": \"2\", \"data-method\": \"delete\"&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>By default it's deleted using Ruby method delete. \nWhen we have only one row, it should be deleted using Ruby logic, if more - by AJAX request.</p>\n\n<p>In my removeButtonController I defined a, href, closest tr, account id and i don't know how to put it right to AJAX request.\nsorry that i can't give you more detailed information. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 4480, "user_id": 259889, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aba1af6d6197093c880797a82e1bc2a2?s=128&d=identicon&r=PG", "display_name": "Sid", "link": "https://stackoverflow.com/users/259889/sid"}, "edited": false, "score": 0, "creation_date": 1543419191, "post_id": 53522899, "comment_id": 93914647, "body": "<a href=\"https://stackoverflow.com/a/36833288/259889\">stackoverflow.com/a/36833288/259889</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1543424140, "post_id": 53522899, "comment_id": 93917803, "body": "You can also consider using <code>subject(:house) { .... }</code> to define both <code>subject</code> and <code>house</code> as the same things. I&#39;m not sure whether that syntax works well in this example however, given the lack on context in your post."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1543419302, "creation_date": 1543419302, "answer_id": 53523011, "question_id": 53522899, "link": "https://stackoverflow.com/questions/53522899/rspec-difference-between-is-expect-and-expect/53523011#53523011", "title": "RSpec: difference between is_expect and expect", "body": "<blockquote>\n  <p><code>is_expected</code> is defined simply as expect(subject) and is designed for when you are using rspec-expectations with its newer expect-based syntax.</p>\n</blockquote>\n\n<p><a href=\"https://relishapp.com/rspec/rspec-core/docs/subject/one-liner-syntax\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-core/docs/subject/one-liner-syntax</a></p>\n\n<p>As the object under test is <code>house</code> not <code>subject</code>, I assume that <code>subject</code> is not initialized, therefore set to defaul (<code>described_class.new</code>). <code>is_expected</code> calls expectation on this default subject.</p>\n\n<p>To use <code>is_expected</code>, initialize subject:</p>\n\n<pre><code>describe House do\n   subject { House.new(...) } # or build :house if you use FactoryBot\n   # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 9908, "user_id": 257948, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/63fc52037c03c7d22c8baf001f55f2f7?s=128&d=identicon&r=PG&f=1", "display_name": "noloman", "link": "https://stackoverflow.com/users/257948/noloman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 1, "accepted_answer_id": 53523011, "answer_count": 1, "score": 1, "last_activity_date": 1543422393, "creation_date": 1543418970, "last_edit_date": 1543422393, "question_id": 53522899, "link": "https://stackoverflow.com/questions/53522899/rspec-difference-between-is-expect-and-expect", "title": "RSpec: difference between is_expect and expect", "body": "<p>I have two specs here:</p>\n\n<pre><code>it 'is not an included preferred gender' do\n  house.preferred_gender = 3\n  is_expected.not_to be_valid\nend\n\nit 'is an included preferred gender' do\n  house.preferred_gender = 2\n  expect(house).to be_valid\nend\n</code></pre>\n\n<p>What I don't understand is that if I replace in my second spec <code>expect(house).to be_valid</code> for <code>is_expected.to be_valid</code>, then my test fails:</p>\n\n<p>Failures:</p>\n\n<pre><code>1) House preferred gender is an included preferred gender\n     Failure/Error: is_expected.to be_valid\n       expected #&lt;House id: nil, rent: nil, deposit: nil, description: nil, preferred_gender: nil, created_at: nil, updated_at: nil, available_at: nil, user_id: nil, lease_length: nil, built_in: nil&gt; to be valid, but got errors: User must exist, Rent can't be blank, Rent is not a number, Preferred gender can't be blank, Preferred gender is not included in the list, Available at can't be blank\n     # ./spec/models/house_spec.rb:94:in `block (3 levels) in &lt;main&gt;'\n\nFinished in 16.27 seconds (files took 3.02 seconds to load)\n52 examples, 1 failure\n</code></pre>\n\n<p>Why does this happen?\nThanks a lot in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "edited": false, "score": 1, "creation_date": 1543439189, "post_id": 53521916, "comment_id": 93924956, "body": "<code>quote_column</code> does not exist on <code>Rails 5.0.0.1</code>, the correct name should be <code>quote_column_names</code>. This works."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 2, "last_activity_date": 1543415929, "creation_date": 1543415929, "answer_id": 53521916, "question_id": 53521767, "link": "https://stackoverflow.com/questions/53521767/parameter-based-joins-not-susceptible-for-sql-injection/53521916#53521916", "title": "parameter based joins not susceptible for sql injection", "body": "<p>You can sanitize parameters using <code>ActiveRecord::Base.connection.quote(string)</code> or even <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Quoting.html#method-i-quote_column_name\" rel=\"nofollow noreferrer\"><code>.quote_column</code></a></p>\n"}, {"comments": [{"owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 4, "creation_date": 1543417791, "post_id": 53522359, "comment_id": 93913639, "body": "This uses <code>sanitize_sql</code> from <code>ActiveRecord::Sanitization</code> module. The deprecated method you are stating is from <code>ActiveRecord::Base</code> as <a href=\"https://github.com/rails/rails/issues/28947#issuecomment-298399793\" rel=\"nofollow noreferrer\">explained by rafaelfranca</a>"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1543421715, "post_id": 53522359, "comment_id": 93916399, "body": "Someone just got Byrded"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543430665, "post_id": 53522359, "comment_id": 93921027, "body": "Are you sure that&#39;s the right escaping method for column names?"}, {"owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543432977, "post_id": 53522359, "comment_id": 93922148, "body": "@tadman I did further research and testing, the method <code>sanitize_sql</code> is not proper for the intended functionality. Is for these cases that we should avoid writing code of this nature. Will update the answer."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543438497, "post_id": 53522359, "comment_id": 93924661, "body": "mrzasa has an answer here which uses <code>quote_column</code> which does the correct kind of escaping."}, {"owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543439478, "post_id": 53522359, "comment_id": 93925067, "body": "@tadman you&#39;re right, will update this answer for people to see the correct solution. Upvoted mrzasa&#39;s answer as it is correct."}], "tags": [], "owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "is_accepted": true, "score": 3, "last_activity_date": 1543439857, "last_edit_date": 1592644375, "creation_date": 1543417275, "answer_id": 53522359, "question_id": 53521767, "link": "https://stackoverflow.com/questions/53521767/parameter-based-joins-not-susceptible-for-sql-injection/53522359#53522359", "title": "parameter based joins not susceptible for sql injection", "body": "<p><strong>Do not attempt this:</strong>\n(explanation below)</p>\n<blockquote>\n<p>You can use the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html\" rel=\"nofollow noreferrer\">ActiveRecord::Sanitization module</a> and write something like the following, inside your ActiveRecord model:</p>\n<pre><code>AExample.joins(&quot;INNER JOIN b_examples ON b_examples.#{sanitize_sql(field_name)} = a_examples.#{sanitize_sql(field_name)}&quot;)\n</code></pre>\n<p>Or you can include the module somewhere else and use it there (e.g. your controller).</p>\n</blockquote>\n<p><strong>Do use this, instead:</strong> (included from another answer)</p>\n<pre><code>AExample.joins(&quot;INNER JOIN b_examples ON b_examples.#{ActiveRecord::Base.connection.quote_column_name(field_name)} = a_examples.#{ActiveRecord::Base.connection.quote_column_name(field_name)}&quot;)\n</code></pre>\n<p>It will raise an error if the column is not found, preventing malicious code from entering your query.</p>\n<p>However I wouldn't do this in my app as it looks suspicious, other programers may not understand what is happening, it may be implemented wrong, solid testing should be included, it may have bugs and such. In your problem, you only need to construct two different queries, with that information I would write something like:</p>\n<pre><code>case dynamic_field\nwhen 'field_x'\n AExample.joins('INNER JOIN b_examples ON b_examples.field_x = a_examples.field_x')\nwhen 'field_y'\n AExample.joins('INNER JOIN b_examples ON b_examples.field_y = a_examples.field_y')\nelse\n  raise &quot;Some suspicious parameter was sent!: #{dynamic_field}&quot;\nend\n</code></pre>\n<p>Or even write <a href=\"https://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\">scopes</a> on your model and avoid this code to be flying around.</p>\n<p>With problems of this nature, as with encryption, try to find a workaround and avoid implementing your own solutions as much as possible.</p>\n<p><strong>EDIT:</strong></p>\n<p>The method <code>sanitize_sql</code> is intended to sanitize conditions for a WHERE clause (<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html#method-i-sanitize_sql_for_conditions\" rel=\"nofollow noreferrer\">ActiveRecord::Sanitization</a>):</p>\n<blockquote>\n<p>Accepts an array or string of SQL conditions and sanitizes them into a valid SQL fragment for a WHERE clause.</p>\n</blockquote>\n<p>It is not an option as you try to sanitize for an <code>INNER JOIN</code>, or an <code>ON</code> clause.</p>\n<p>Note that the <code>ActiveRecord::Sanitization</code> module only has options for WHERE, SET, ORDER and LIKE clauses. I was unable to find a sanitization method for a column name, an INNER JOIN or an ON clause. Perhaps is a useful funcionality that should be added on Rails on further version.</p>\n<p>Using <code>sanitize_sql</code> with a string passes it almost unfiltered, so if the <code>field_name</code> variable has some malicious code as:</p>\n<pre><code>&quot;field_x = a_examples.field_x; DROP TABLE a_examples; --&quot;\n</code></pre>\n<p><strong>It will be included in your query, without any error being raised</strong>.</p>\n<p>This solution is not safe, and is for reasons like these that we should avoid writing code of this nature. Perhaps you find something helpful with <code>Arel</code> or other gems, but I would strongly advice not to.</p>\n<p><strong>EDIT 2:</strong></p>\n<p>Added the working solution to escape a column name. It raises an error if malicious code is being entered, as the column with that name will not be found.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4638556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 53522359, "answer_count": 2, "score": 2, "last_activity_date": 1566467785, "creation_date": 1543415447, "last_edit_date": 1566467785, "question_id": 53521767, "link": "https://stackoverflow.com/questions/53521767/parameter-based-joins-not-susceptible-for-sql-injection", "title": "parameter based joins not susceptible for sql injection", "body": "<p>I want to do non-standard query with join based on the parameters. </p>\n\n<p>For example I have 2 tables: <strong>a_examples</strong> and <strong>b_examples</strong> both with fields: <strong>field_x</strong> and <strong>field_y</strong>. \nI want to join rows when both tables have the same values on <strong>field_x</strong>(or <strong>field_y</strong>).</p>\n\n<p>Example query can looks like this:</p>\n\n<pre><code>AExample.joins('INNER JOIN b_examples ON b_examples.field_x = a_examples.field_x')\n</code></pre>\n\n<p>The problem occurs when I have field name based on parameter.\nFor example I have variable <strong>field_name</strong> and want to use it for query. I can do it like this:</p>\n\n<pre><code>AExample.joins(\"INNER JOIN b_examples ON b_examples.#{field_name} = a_examples.#{field_name}\")\n</code></pre>\n\n<p>This query works, but is susceptible for sql injection. </p>\n\n<p>For where clause we have special syntax with ? to avoid sql injection but there isnt any such thing for joins. How can I make this query safe?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "migration"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1543415761, "post_id": 53521726, "comment_id": 93912360, "body": "What is a name of the table where this records are stored?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543416414, "post_id": 53521726, "comment_id": 93912741, "body": "They were all being stored under content_panels... stupid of me not to check - thanks for highlighting"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1543419847, "post_id": 53521726, "comment_id": 93915101, "body": "This isn&#39;t surprising -- your model inherits from <code>Content::Panel</code>. When using Single Table Inheritance, the base model class typically matches the table name."}], "answers": [{"tags": [], "owner": {"reputation": 2228, "user_id": 797285, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/155e3a832ac9eda845e10564e4e3c1a1?s=128&d=identicon&r=PG", "display_name": "lafeber", "link": "https://stackoverflow.com/users/797285/lafeber"}, "is_accepted": true, "score": 2, "last_activity_date": 1543415879, "creation_date": 1543415879, "answer_id": 53521905, "question_id": 53521726, "link": "https://stackoverflow.com/questions/53521726/rails-namespaced-migrations/53521905#53521905", "title": "Rails - namespaced migrations", "body": "<p>When the table name is <code>content_panels_iframes</code>, the migration should be:</p>\n\n<pre><code>add_column :content_panels_iframes, :height, :integer, after: :headline\n</code></pre>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 53521905, "answer_count": 1, "score": 0, "last_activity_date": 1543415879, "creation_date": 1543415341, "last_edit_date": 1543415746, "question_id": 53521726, "link": "https://stackoverflow.com/questions/53521726/rails-namespaced-migrations", "title": "Rails - namespaced migrations", "body": "<p>I have the following model and migration:</p>\n\n<pre><code>class Content::Panels::Iframe &lt; Content::Panel\n  ## Associations ##\n  belongs_to :panel_holder, polymorphic: true\n\n  ## Validations ##\n  validates :uri, presence: true\n\n  ## Methods ##\n  def self.plural_name\n    'iframe_index'\n  end\nend\n\nclass AddHeightToIframes &lt; ActiveRecord::Migration[5.1]\n  def change\n    add_column :iframes, :height, :integer, after: :headline\n  end\nend\n</code></pre>\n\n<p>The migration fails as there is no table called 'iframes'. After googling I've tried adding to the iframe class:</p>\n\n<pre><code>self.table_name_prefix = 'content_panels_'\nself.table_name = 'content_panels_iframes'\n</code></pre>\n\n<p>and changing the table title to 'content_panels_iframes', However neither of these work when tried independently or together.</p>\n\n<p>What am I doing wrong? Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2", "codeanywhere"], "answers": [{"comments": [{"owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "reply_to_user": {"reputation": 13, "user_id": 10634479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a443e47829eeb6b0bf195e92bc94a7da?s=128&d=identicon&r=PG&f=1", "display_name": "user10634479", "link": "https://stackoverflow.com/users/10634479/user10634479"}, "edited": false, "score": 0, "creation_date": 1543418960, "post_id": 53522134, "comment_id": 93914478, "body": "Great. Welcome to StackOverflow, and also to Vim if you haven&#39;t used it before! :)"}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 0, "last_activity_date": 1543416529, "creation_date": 1543416529, "answer_id": 53522134, "question_id": 53521244, "link": "https://stackoverflow.com/questions/53521244/codeanywhere-cant-find-editor-for-rails-5-2-1-app/53522134#53522134", "title": "Codeanywhere can&#39;t find editor for Rails 5.2.1 app", "body": "<p>This means that you haven't set the environment variable that determines your editor. The example in the output will make TextMate your default editor.</p>\n\n<p>Not sure what editors are available in CodeAnywhere, but most systems have access to VIM, so you might try running:</p>\n\n<p><code>EDITOR=\"vim --wait\" bin/rails credentials:edit</code></p>\n\n<p>You may not need to pass the <code>--wait</code> option.</p>\n"}], "owner": {"reputation": 13, "user_id": 10634479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a443e47829eeb6b0bf195e92bc94a7da?s=128&d=identicon&r=PG&f=1", "display_name": "user10634479", "link": "https://stackoverflow.com/users/10634479/user10634479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 53522134, "answer_count": 1, "score": 1, "last_activity_date": 1543419581, "creation_date": 1543413822, "last_edit_date": 1543419581, "question_id": 53521244, "link": "https://stackoverflow.com/questions/53521244/codeanywhere-cant-find-editor-for-rails-5-2-1-app", "title": "Codeanywhere can&#39;t find editor for Rails 5.2.1 app", "body": "<p>I am having difficulty accessing the command: <code>rails credentials:edit</code> using the Codeanywhere environment. I am running Rails 5.2.1 and Ruby 2.5.1.</p>\n\n<p>I receive the following response from the terminal: </p>\n\n<pre><code>No $EDITOR to open file in. Assign one like this:\n\nEDITOR=\"mate --wait\" bin/rails credentials:edit\n\nFor editors that fork and exit immediately, it's important to pass a\nwait flag, otherwise the credentials will be saved immediately \nwith no chance to edit.\n</code></pre>\n\n<p>I don't seem to be able to get this working.</p>\n\n<p>Can someone please help?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "image", "ruby-on-rails-4", "frontend"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1543412679, "post_id": 53520732, "comment_id": 93910348, "body": "And what do you want inside image_tag?"}, {"owner": {"reputation": 65, "user_id": 9757992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67cfb270d2a3122360b327b41a67d21?s=128&d=identicon&r=PG&f=1", "display_name": "Malus_khanot", "link": "https://stackoverflow.com/users/9757992/malus-khanot"}, "edited": false, "score": 0, "creation_date": 1543412751, "post_id": 53520732, "comment_id": 93910394, "body": "I want to add information from the database, I edit my message."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543413188, "post_id": 53520732, "comment_id": 93910700, "body": "Looking at method&#39;s source, it does not use the block: <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionView/Helpers/&hellip;</a>"}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1543418932, "post_id": 53520732, "comment_id": 93914465, "body": "The way to best do this is add data- tags that get parsed by javascript to create the popover"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9757992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67cfb270d2a3122360b327b41a67d21?s=128&d=identicon&r=PG&f=1", "display_name": "Malus_khanot", "link": "https://stackoverflow.com/users/9757992/malus-khanot"}, "edited": false, "score": 0, "creation_date": 1543413267, "post_id": 53520997, "comment_id": 93910743, "body": "Thank you for your answer !"}, {"owner": {"reputation": 5125, "user_id": 251920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dIvKK.png?s=128&g=1", "display_name": "dfens", "link": "https://stackoverflow.com/users/251920/dfens"}, "edited": false, "score": 1, "creation_date": 1543413780, "post_id": 53520997, "comment_id": 93911063, "body": "Well, world is changing and technology moves forward. Hopefully &lt;img&gt; tags will be able to have babies some day, same way as all other tags."}], "tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": true, "score": 1, "last_activity_date": 1543413107, "creation_date": 1543413107, "answer_id": 53520997, "question_id": 53520732, "link": "https://stackoverflow.com/questions/53520732/ruby-on-rails-image-tag-with-do-does-not-work/53520997#53520997", "title": "Ruby On Rails - &#39;image_tag&#39; with &#39;do&#39; does not work", "body": "<p>HTML <code>&lt;img&gt;</code> tags cannot have children, so this doesn't make sense.</p>\n\n<p>To add popups, you need some JavaScript (or very nifty CSS with hidden checkboxes). If you don't want to write that yourself, use something like <a href=\"https://getbootstrap.com/docs/4.0/components/modal/\" rel=\"nofollow noreferrer\">Bootstrap popups</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 9757992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67cfb270d2a3122360b327b41a67d21?s=128&d=identicon&r=PG&f=1", "display_name": "Malus_khanot", "link": "https://stackoverflow.com/users/9757992/malus-khanot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 53520997, "answer_count": 1, "score": 0, "last_activity_date": 1543413107, "creation_date": 1543412209, "last_edit_date": 1543412901, "question_id": 53520732, "link": "https://stackoverflow.com/questions/53520732/ruby-on-rails-image-tag-with-do-does-not-work", "title": "Ruby On Rails - &#39;image_tag&#39; with &#39;do&#39; does not work", "body": "<p>I am trying to create my image as a block, but it's not working ... The app doesn't read the code inside the block :</p>\n\n<pre><code>&lt;%= image_tag(\"house-toiture.jpg\") do %&gt;\n    &lt;%= puts \"COME ON DUDE\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to add the following information inside :</p>\n\n<pre><code>&lt;% @operation_presenter.works.each do |work| %&gt;\n     &lt;!-- (&lt;%= work.travaux %&gt;) --&gt;\n    &lt;button type=\"button\" data-container=\"body\" data-toggle=\"popover\" data-trigger=\"hover\" data-placement=\"top\" data-html=\"true\" title=\"&lt;%= work.nom_travaux %&gt;\" data-content=\"travaux : &lt;%= work.travaux %&gt;&lt;br /&gt;\n    Cout travaux : &lt;%= work.cout_travaux %&gt;\u20ac&lt;br /&gt;\n    TVA : &lt;%= work.tva_travaux %&gt;%\"&gt;&lt;%= work.nom_travaux %&gt;&lt;/button&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The idea is to add popover on the image.</p>\n\n<p>Someone has an idea where comes from the issue ?</p>\n\n<p>Thank you very much !</p>\n"}, {"tags": ["arrays", "ruby", "iterator", "ruby-hash"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543411563, "post_id": 53520433, "comment_id": 93909587, "body": "What is the problem that you have in somewhere in <code>failed_tests.each do |hash|</code> block? You haven&#39;t stated it. What do you expect the method to do?"}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543412339, "post_id": 53520433, "comment_id": 93910098, "body": "Yep, sorry. The method should return <code>final_result</code> which should also contain <code>failed_tests</code> array with 2 different hashes (results and comparison for different tests). Currently, as you can see from the example - both hashes are actually the same, therefore I thought that smthn is wrong in <code>failed_tests.each do |hash|</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1543414520, "post_id": 53520433, "comment_id": 93911552, "body": "@Mikhah it&#39;s nice that you showed effort, but it&#39;s difficult to read through your method. If you want an answer, provide your input (the 2 hashes) and the hash you&#39;d like to be the result."}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543415222, "post_id": 53520433, "comment_id": 93912043, "body": "@sawa ofc, I&#39;ve updated the question"}, {"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1543416402, "post_id": 53520433, "comment_id": 93912736, "body": "@MarcinKo\u0142odziej sorry, missclicked) I&#39;ve updated the question"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "edited": false, "score": 0, "creation_date": 1543421018, "post_id": 53522980, "comment_id": 93915948, "body": "Thanks for the simplification and answer, it works perfectly)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543433547, "post_id": 53522980, "comment_id": 93922421, "body": "Perhaps <code>...after.each_with_object([]) { |(k,v),a| a &lt;&lt; { test_name: k,actual_status: v, previous_status: before[k] } if v==&quot;Failed&quot; }</code> to traverse the array just once."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 2, "last_activity_date": 1543419216, "creation_date": 1543419216, "answer_id": 53522980, "question_id": 53520433, "link": "https://stackoverflow.com/questions/53520433/ruby-set-key-value-pairs-inside-array-of-hashes/53522980#53522980", "title": "Ruby - Set key-value pairs inside array of hashes", "body": "<p>Solution: </p>\n\n<pre><code>def comparison_reporter(before, after)\n  failed_tests = after.select { |k,v| v == \"Failed\" }.map do |k,v|\n    {\n      test_name: k,\n      actual_status: v,\n      previous_status: before[k]\n    }\n  end\n\n  {\n    passed: after.size - failed_tests.size,\n    failed: failed_tests.size,\n    failed_tests: failed_tests\n  }\nend\n</code></pre>\n\n<p>Simplified <code>failed_tests</code> quite a bit. Since we calculate number of failed tests, we can use it for the final counts, instead of iterating over the hash again.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "edited": false, "score": 0, "creation_date": 1543421071, "post_id": 53523058, "comment_id": 93915995, "body": "Thanks for the advice, I&#39;ll definitely use byebug in future"}], "tags": [], "owner": {"reputation": 1298, "user_id": 6305204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jGfSZ.png?s=128&g=1", "display_name": "con--", "link": "https://stackoverflow.com/users/6305204/con"}, "is_accepted": false, "score": 1, "last_activity_date": 1543419439, "creation_date": 1543419439, "answer_id": 53523058, "question_id": 53520433, "link": "https://stackoverflow.com/questions/53520433/ruby-set-key-value-pairs-inside-array-of-hashes/53523058#53523058", "title": "Ruby - Set key-value pairs inside array of hashes", "body": "<p>The problem is on line 8: You're overwriting <code>hash[\"previous_status\"]</code> with the last value in <code>list_of_scenarios_results1.values_at(*actual_failed_tests.keys)</code> when you map over it.</p>\n\n<p>Usually you use map to assign an iterable to something, not modify something else.\ne.g.<br>\n<code>x = ['1','2','3'].map(&amp;:to_i)</code><br>\nrather than<br>\n<code>x = []; ['1','2','3'].map {|v| x &lt;&lt; v.to_i}</code></p>\n\n<p>I'd suggest re-thinking your approach. Will you always have the same keys in both hashes? If so you could simplify this. I'd also suggest looking into <a href=\"https://github.com/deivid-rodriguez/byebug\" rel=\"nofollow noreferrer\">byebug</a>. It's an interactive debugger that'll let you step through your function and see where things aren't doing what you expect.</p>\n"}], "owner": {"reputation": 139, "user_id": 5581314, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f08692876a66df8a8fcb54d990ec22b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhah", "link": "https://stackoverflow.com/users/5581314/mikhah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 53522980, "answer_count": 2, "score": 0, "last_activity_date": 1543432735, "creation_date": 1543411296, "last_edit_date": 1543432735, "question_id": 53520433, "link": "https://stackoverflow.com/questions/53520433/ruby-set-key-value-pairs-inside-array-of-hashes", "title": "Ruby - Set key-value pairs inside array of hashes", "body": "<p>The problem is:\nI have a method</p>\n\n<pre><code>def comparison_reporter(list_of_scenarios_results1, list_of_scenarios_results2)\n  actual_failed_tests = list_of_scenarios_results2.select {|k,v| v == 'Failed'}\n  actual_passed_tests = list_of_scenarios_results2.select {|k,v| v == 'Passed'}\n  failed_tests = Array.new(actual_failed_tests.length) { Hash.new }\n  failed_tests.each do |hash|\n      actual_failed_tests.keys.map {|name| hash[\"test_name\"] = name}\n      actual_failed_tests.values.map {|new_status| hash[\"actual_status\"] = new_status}\n      list_of_scenarios_results1.values_at(*actual_failed_tests.keys).map {|old_status| hash[\"previous_status\"] = old_status}\n  end\n  final_result = {\n    \"passed_tests_count\" =&gt; list_of_scenarios_results2.select {|k,v| v == 'Passed'}.length,\n    \"failed_tests_count\" =&gt; list_of_scenarios_results2.select {|k,v| v == 'Failed'}.length,\n    \"failed_tests\" =&gt; failed_tests\n  }\n  return final_result\nend\n</code></pre>\n\n<p>This method takes 2 hashes as arguments and returns the result of their comparison and some other things. Currently, it always returns <code>failed_tests</code> with two (or more) identical hashes (same key-value pairs).\nI think, that problem is somewhere in <code>failed_tests.each do |hash|</code> block, but I can't find the reason of this bug, please advice. Example of the method result (in .json format)</p>\n\n<pre><code>{\n  \"passed_tests_count\": 3,\n  \"failed_tests_count\": 2,\n  \"failed_tests\": [\n    {\n      \"test_name\": \"As a user I want to use Recent searches tab\",\n      \"actual_status\": \"Failed\",\n      \"previous_status\": \"Failed\"\n    },\n    {\n      \"test_name\": \"As a user I want to use Recent searches tab\",\n      \"actual_status\": \"Failed\",\n      \"previous_status\": \"Failed\"\n    }\n  ]\n}\n</code></pre>\n\n<p>UPD:\nhash1 (first argument) - </p>\n\n<pre><code>{\"\"=&gt;\"Passed\",\n\"As a new user I want to use no fee rentals tab\"=&gt;\"Passed\",\n\"As a new user I want to use Luxury rentals tab\"=&gt;\"Passed\", \n\"As a user I want to use Recent searches tab\"=&gt;\"Failed\",\n\"As a user I want to use new listings for you tab\"=&gt;\"Passed\"}\n</code></pre>\n\n<p>hash2 (second argument)- </p>\n\n<pre><code>{\"\"=&gt;\"Passed\",\n\"As a new user I want to use no fee rentals tab\"=&gt;\"Failed\",\n\"As a new user I want to use Luxury rentals tab\"=&gt;\"Passed\",\n\"As a user I want to use Recent searches tab\"=&gt;\"Failed\",\n\"As a user I want to use new listings for you tab\"=&gt;\"Passed\"}\n</code></pre>\n\n<p>Example of desired desired output:</p>\n\n<pre><code>{ \n\"passed\":\"count\",\n\"failed\":\"count\",\n\"failed_tests\": [\n   {\"test_name\":\"As a user I want to use Recent searches tab\",\n    \"actual_status\":\"failed\",\n    \"previous_status\":\"failed\"},\n   {\"test_name\":\"As a new user I want to use no fee rentals tab\",\n    \"actual_status\":\"failed\",\n    \"previous_status\":\"passed\"}]\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543410703, "post_id": 53520135, "comment_id": 93909071, "body": "Not sure what you mean by <code>click on the &quot;link_to&quot;</code>. I suppose you do not mean that there is a link on the rendered page that says &quot;link_to&quot;."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 1, "creation_date": 1543410777, "post_id": 53520135, "comment_id": 93909111, "body": "can you show output of rake <code>routes | grep albums</code> by running it on console on project directory?"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1543412130, "post_id": 53520135, "comment_id": 93909953, "body": "where does page redirects on click on this link? do you get any error?"}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1543412292, "post_id": 53520135, "comment_id": 93910070, "body": "Nothing happens. I inspect the code, and its like this: &lt;a class=&quot;btn-upload trigger-file-upload&quot; href=&quot;/albums/new&quot;&gt;&lt;/a&gt;.   If I click it on directly on the inspector, it works. Maybe some JS issue?"}, {"owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "edited": false, "score": 0, "creation_date": 1543445085, "post_id": 53520135, "comment_id": 93927208, "body": "Your question didn&#39;t understand please ask clearly"}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1251220, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ef0b83959c5ad0bf18f1dcd57c678792?s=128&d=identicon&r=PG", "display_name": "Walid Da.", "link": "https://stackoverflow.com/users/1251220/walid-da"}, "is_accepted": false, "score": 0, "last_activity_date": 1543410496, "creation_date": 1543410496, "answer_id": 53520212, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails/53520212#53520212", "title": "How to make `link_to` work correctly in Rails", "body": "<p>if you want to use new_album_path, you need to have resources :photos in your routes.rb file. So you need to only keep:</p>\n\n<pre><code>resources :photos\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>resources :albums do\n  resources :photos\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1543415260, "post_id": 53520293, "comment_id": 93912069, "body": "OP wants to create an album resource first before adding a photo."}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": false, "score": 1, "last_activity_date": 1543410763, "creation_date": 1543410763, "answer_id": 53520293, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails/53520293#53520293", "title": "How to make `link_to` work correctly in Rails", "body": "<p>More of a \"teach how to fish\" but to determine what routes are available in your application and the cooresponding paths you should run</p>\n\n<p><code>rails routes | grep album</code></p>\n\n<p>That will show you all of the possible named routes along with their path and associated controller.  Yours is most likely named <code>new_album_photo_path</code> for getting a link to upload a new image.  Always consult the rails routes though when you have a question.</p>\n"}, {"comments": [{"owner": {"reputation": 1327, "user_id": 4650675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiYJE.jpg?s=128&g=1", "display_name": "Niraj Kaushal", "link": "https://stackoverflow.com/users/4650675/niraj-kaushal"}, "reply_to_user": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1543412526, "post_id": 53520731, "comment_id": 93910244, "body": "Could you tell me what link it shows when you hover on it?? And please share CSS code of &#39;file-upload&#39; class. I think the problem is with its CSS."}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1543412605, "post_id": 53520731, "comment_id": 93910297, "body": "/albums/new . But when I click nothing happens."}], "tags": [], "owner": {"reputation": 1327, "user_id": 4650675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiYJE.jpg?s=128&g=1", "display_name": "Niraj Kaushal", "link": "https://stackoverflow.com/users/4650675/niraj-kaushal"}, "is_accepted": false, "score": 0, "last_activity_date": 1543412446, "last_edit_date": 1543412446, "creation_date": 1543412206, "answer_id": 53520731, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails/53520731#53520731", "title": "How to make `link_to` work correctly in Rails", "body": "<p>I think everything is good except one thing text for anchor, so when you click on that text and it will open <code>https://localhost:3000/albums/new</code>.</p>\n\n<p><code>&lt;span class=\"file-upload\"&gt;\n    &lt;%= link_to 'Create New Album', \n new_album_path, class: \"btn-upload trigger-file-upload\" %&gt;\n&lt;/span&gt;</code></p>\n\n<p>I hope this will help you.</p>\n"}, {"tags": [], "owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "is_accepted": false, "score": 0, "last_activity_date": 1543413034, "creation_date": 1543413034, "answer_id": 53520976, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails/53520976#53520976", "title": "How to make `link_to` work correctly in Rails", "body": "<p>It was a problem on my javascript, that makes the click button being overrided</p>\n\n<pre><code> $('.trigger-file-upload').click(function(event){\n    form = $(this).parents('.file-upload').parent();\n    field = $(this).parents('.file-upload').find('input[type=\"file\"]');\n    field.trigger('click');\n\n    return false;\n  });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 10384879, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5HTxyDEG1Qo/AAAAAAAAAAI/AAAAAAAAAeQ/9iMyCvOw2A4/photo.jpg?sz=128", "display_name": "giri dharan", "link": "https://stackoverflow.com/users/10384879/giri-dharan"}, "is_accepted": false, "score": 0, "last_activity_date": 1543445609, "creation_date": 1543445609, "answer_id": 53529312, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails/53529312#53529312", "title": "How to make `link_to` work correctly in Rails", "body": "<p><strong>Try like this</strong></p>\n\n<pre><code> &lt;span class=\"file-upload\"&gt;\n&lt;a class=\"btn-upload trigger-file-upload\" herf=\" &lt;%=  new_album_path%&gt;\"&lt;/a&gt;\n &lt;/span&gt;\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1543445609, "creation_date": 1543410247, "last_edit_date": 1543411677, "question_id": 53520135, "link": "https://stackoverflow.com/questions/53520135/how-to-make-link-to-work-correctly-in-rails", "title": "How to make `link_to` work correctly in Rails", "body": "<p>I have one page with a button to create a new album of photos on my app like this: </p>\n\n<pre><code>&lt;span class=\"file-upload\"&gt;\n  &lt;%= link_to '', new_album_path, class: \"btn-upload trigger-file-upload\"%&gt;\n&lt;/span&gt;\n</code></pre>\n\n<p>My routes.rb is like this: </p>\n\n<pre><code>resources :albums do\n  resources :photos\nend\n</code></pre>\n\n<p>If I click directly on my page like this, it works: </p>\n\n<pre><code>https://localhost:3000/albums/new\n</code></pre>\n\n<p>Why the link generated by &lt;%= link_to '', new_album_path, class: \"btn-upload trigger-file-upload\"%> doesnt works? I click on it, and the page isnt redirected</p>\n\n<p>Edited: My rake routes: </p>\n\n<p><a href=\"https://i.stack.imgur.com/gva6F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gva6F.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "counter-cache"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1543408583, "post_id": 53519551, "comment_id": 93907780, "body": "If you&#39;re trying to update sequence column of a model Group then <a href=\"https://apidock.com/rails/ActiveRecord/Base/update_all/class\" rel=\"nofollow noreferrer\"><code>update_all</code></a>  - <code>Group.where(id: ids).update_all(sequence: 1)</code>"}, {"owner": {"reputation": 380, "user_id": 4382423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/vd3QX.jpg?s=128&g=1", "display_name": "Ankita Agrawal", "link": "https://stackoverflow.com/users/4382423/ankita-agrawal"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1543408791, "post_id": 53519551, "comment_id": 93907915, "body": "@Surya this will update all sequence to 1. I want to update sequence increment sequence by 1 to the previous records"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1543409043, "post_id": 53519551, "comment_id": 93908045, "body": "@AnkitaAgrawal : Provide Group model code and the association on which sequence is updated when cached."}, {"owner": {"reputation": 380, "user_id": 4382423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/vd3QX.jpg?s=128&g=1", "display_name": "Ankita Agrawal", "link": "https://stackoverflow.com/users/4382423/ankita-agrawal"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1543409591, "post_id": 53519551, "comment_id": 93908405, "body": "@Surya It dont have a sequence association. It has a Sequence as a column_name"}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1543410010, "post_id": 53519551, "comment_id": 93908657, "body": "Did you try <a href=\"https://api.rubyonrails.org/v5.0.1/classes/ActiveRecord/CounterCache/ClassMethods.html#method-i-update_counters\" rel=\"nofollow noreferrer\"><code>update_counters</code></a>?"}, {"owner": {"reputation": 380, "user_id": 4382423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/vd3QX.jpg?s=128&g=1", "display_name": "Ankita Agrawal", "link": "https://stackoverflow.com/users/4382423/ankita-agrawal"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1543410245, "post_id": 53519551, "comment_id": 93908795, "body": "@31piy update_counters will update sequence by 1 with existing id sequence. I want to reset that and update all records one by one"}], "owner": {"reputation": 380, "user_id": 4382423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/vd3QX.jpg?s=128&g=1", "display_name": "Ankita Agrawal", "link": "https://stackoverflow.com/users/4382423/ankita-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562730923, "creation_date": 1543408309, "last_edit_date": 1562730923, "question_id": 53519551, "link": "https://stackoverflow.com/questions/53519551/reset-counters-not-works-for-not-association-field", "title": "reset_counters not works for not association field", "body": "<p><a href=\"https://api.rubyonrails.org/v5.0.1/classes/ActiveRecord/CounterCache/ClassMethods.html#method-i-reset_counters\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/v5.0.1/classes/ActiveRecord/CounterCache/ClassMethods.html#method-i-reset_counters</a></p>\n\n<p>I have a field called <code>sequence</code> in my model. I want to reset all sequences of particular record set and update all sequences one by one <code>1</code>. But while using <code>reset_counter</code> I'm getting <code>has no association called 'sequence'</code>. Here is my code block</p>\n\n<pre><code>ids = [1,2,4,6,7]\nGroup.reset_counters(ids, \"sequence\")\nGroup.increment_counter(sequence, ids)\n</code></pre>\n\n<p>Is it any way to update given ids sequence by 1 (each id sequence should be updated by 1 to the previous id)?</p>\n\n<p>PS: <code>update_attribute</code> is taking time for updating individual records. so i want to update records in bulk.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543405696, "post_id": 53518673, "comment_id": 93906080, "body": "Your notation <code>..</code> is not clear. Does that represent a <code>Range</code> object (in which case your example is invalid), or are they meant to be ellipsis (in which case you are missing commas in between the items, and using three periods <code>...</code> rather than two <code>..</code> are standard)?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543405837, "post_id": 53518673, "comment_id": 93906146, "body": "Do you <b>have</b> a matrix from the beginning (as you wrote), or are you trying to <b>generate</b> one? Even that is not clear."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543405890, "post_id": 53518673, "comment_id": 93906192, "body": "What does <code>rows</code> and <code>cols</code> mean in <code>(m = rows-1, n = cols-1)</code>?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543406041, "post_id": 53518673, "comment_id": 93906284, "body": "Given that you have an (m, n) matrix, in your <code>Suppose n=0, so for 4x4 matrix</code> case, shouldn&#39;t it be <code>mx0</code> matrix rather than <code>4x4</code>? Not clear what <code>n</code> means here."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543461789, "post_id": 53518673, "comment_id": 93930868, "body": "Where you say, &quot;Suppose <code>n=0</code>, so for 4x4 matrix...&quot;, don&#39;t you mean &quot;Suppose <code>i=0</code>, so for 4x4 matrix&quot;?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543466879, "post_id": 53518673, "comment_id": 93931935, "body": "If my understanding of the question is correct, I believe you could express it as follows. &quot;Given positive integers <code>rows</code> and <code>cols</code>, let <code>mat</code> be a matrix with <code>r</code> rows and <code>c</code> columns, whose <code>i,j</code> element is the array <code>[i,j]</code>. Further, let <code>off</code> be a non-negative index offset. First extract from <code>mat</code> the submatrix <code>sub</code> comprised of rows and columns of <code>mat</code> having indices <code>off..r-1-off</code> and <code>off..c-1-off</code>, respectively&quot;..."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543466893, "post_id": 53518673, "comment_id": 93931940, "body": "...&quot;Once this has been done compute and return an array containing  the elements on the &quot;perimeter&quot; of <code>sub</code>, beginning with the first column, in increasing row order, then the last row, in increasing column order, then then the last column, in decreasing row order and lastly the first row in decreasing column order. The &quot;corner&quot; elements of <code>sub</code> are not to be double-counted. How can I do that?&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543467158, "post_id": 53518673, "comment_id": 93932012, "body": "This is really two separate questions. It would have been better to have asked each separately, with the second referencing the first. @sawa, as you left several comments above, I thought you might want to see my take on what is being asked. We&#39;ll see."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543470992, "post_id": 53518673, "comment_id": 93933163, "body": "@CarySwoveland Maybe you are right, I could not express from bottom prerequisite. But it was supposed to consider <b>matrix is proper 2D</b> then you can consider it as square or rectangle. Just check <b>answer</b> I posted."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543471024, "post_id": 53518673, "comment_id": 93933179, "body": "@sawa Maybe you will get clear Idea from answer I posted."}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1543429043, "creation_date": 1543429043, "answer_id": 53525700, "question_id": 53518673, "link": "https://stackoverflow.com/questions/53518673/optimised-loop-for-array-using-ruby/53525700#53525700", "title": "Optimised loop for array using ruby", "body": "<p>I ended up with this solution, but I think there is a better way out there.</p>\n\n<p>First define a method to print the matrix mapped by indexes, just to check if the result id correct:</p>\n\n<pre><code>def print_matrix(n,m)\n  range_n, range_m = (0..n-1), (0..m-1)\n  mapp = range_m.map { |y| range_n.map { |x| [x, y] } }\n  mapp.each { |e| p e }\n  puts \"-\" * 8 * n\nend\n</code></pre>\n\n<p>Then define a method that returns the frame starting from the loop s (where 0 is the external frame):</p>\n\n<pre><code>def frame (n, m, s = 0)\n  res = []\n  return res if (s &gt;= n/2 and s &gt;= m/2) and (n.even? or m.even?)\n  (s..n-s-1).each { |x| res &lt;&lt; [x,s] }\n  (s..m-s-1).each { |y| res &lt;&lt; [res.last[0], y] }\n  (res.last[0].downto s).each { |x| res &lt;&lt; [x, res.last[1]] }\n  (res.last[1].downto s).each { |y| res &lt;&lt; [res.last[0], y] }\n  res.uniq\nend\n</code></pre>\n\n<p>Now, call the methods and check the output:</p>\n\n<pre><code>n, m, loops = 4, 4, 1\nprint_matrix(n,m)\nframe(n, m, loops)\n\n# [[0, 0], [1, 0], [2, 0], [3, 0]]\n# [[0, 1], [1, 1], [2, 1], [3, 1]]\n# [[0, 2], [1, 2], [2, 2], [3, 2]]\n# [[0, 3], [1, 3], [2, 3], [3, 3]]\n# --------------------------------\n# [[1, 1], [2, 1], [2, 2], [1, 2]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543470723, "post_id": 53531804, "comment_id": 93933066, "body": "I solved, checked in answers. Thanks for the help :)"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1543472739, "post_id": 53531804, "comment_id": 93933766, "body": "Thanks prof, I never worked with <code>Matrix</code> functions, well introduced now :)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1543465399, "creation_date": 1543465399, "answer_id": 53531804, "question_id": 53518673, "link": "https://stackoverflow.com/questions/53518673/optimised-loop-for-array-using-ruby/53531804#53531804", "title": "Optimised loop for array using ruby", "body": "<p>Here we can use <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html\" rel=\"nofollow noreferrer\">Matrix</a> methods to advantage, specifically <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html#method-c-build\" rel=\"nofollow noreferrer\">Matrix::build</a>, <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html#method-i-minor\" rel=\"nofollow noreferrer\">Matrix#minor</a> and <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">Matrix#[]</a>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'matrix'\n\ndef border_indices(nrows, ncols, i)\n  m = Matrix.build(nrows, ncols) { |r,c| [r,c] }.minor(i..nrows-1-i, i..ncols-1-i)\n  [[1,0,m.row_count-1], [0,1,m.column_count-1],\n   [-1,0,m.row_count-1], [0,-1,m.column_count-2]].\n    each_with_object([[0,0]]) do |(x,y,n),a|\n      n.times { a &lt;&lt; [a.last.first+x, a.last.last+y] }\n    end.map { |i,j| m[i,j] }\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>nrows = 5\nncols = 6\n\nborder_indices(nrows, ncols, 0)\n  #=&gt; [[0, 0], [1, 0], [2, 0], [3, 0],\n  #    [4, 0], [4, 1], [4, 2], [4, 3], [4, 4],\n  #    [4, 5], [3, 5], [2, 5], [1, 5],\n  #    [0, 5], [0, 4], [0, 3], [0, 2], [0, 1]]\nborder_indices(nrows, ncols, 1)\n  #=&gt; [[1, 1], [2, 1],\n  #    [3, 1], [3, 2], [3, 3],\n  #    [3, 4], [2, 4],\n  #    [1, 4], [1, 3], [1, 2]]\nborder_indices(nrows, ncols, 2)\n  #=&gt; [[2, 2], [2, 3]]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Consider the calculation of <code>border_indices(5, 6, 1)</code>.</p>\n\n<pre><code>nrows = 5\nncols = 6\ni = 1\nmat = Matrix.build(nrows, ncols) { |r,c| [r,c] }\n  #=&gt; Matrix[[[0, 0], [0, 1], [0, 2], [0, 3], [0, 4], [0, 5]],\n  #          [[1, 0], [1, 1], [1, 2], [1, 3], [1, 4], [1, 5]],\n  #          [[2, 0], [2, 1], [2, 2], [2, 3], [2, 4], [2, 5]],\n  #          [[3, 0], [3, 1], [3, 2], [3, 3], [3, 4], [3, 5]],\n  #          [[4, 0], [4, 1], [4, 2], [4, 3], [4, 4], [4, 5]]]\nm = mat.minor(i..nrows-1-i, i..ncols-1-i)\n  #=&gt; mat.minor(1..3, 1..4)\n  #=&gt; Matrix[[[1, 1], [1, 2], [1, 3], [1, 4]],\n  #          [[2, 1], [2, 2], [2, 3], [2, 4]],\n  #          [[3, 1], [3, 2], [3, 3], [3, 4]]]\nb = [[1,0,m.row_count-1], [0,1,m.column_count-1],\n     [-1,0,m.row_count-1], [0,-1,m.column_count-2]]\n  #=&gt; [[1, 0, 2], [0, 1, 3], [-1, 0, 2], [0, -1, 2]]\nc = b.each_with_object([[0,0]]) do |(x,y,n),a|\n      n.times { a &lt;&lt; [a.last.first+x, a.last.last+y] }\n    end\n  #=&gt; [[0, 0], [1, 0],\n  #    [2, 0], [2, 1], [2, 2],\n  #    [2, 3], [1, 3],\n  #    [0, 3], [0, 2], [0, 1]]\nc.map { |i,j| m[i,j] }\n  #=&gt; [[1, 1], [2, 1],\n  #    [3, 1], [3, 2], [3, 3],\n  #    [3, 4], [2, 4],\n  #    [1, 4], [1, 3], [1, 2]]\n</code></pre>\n\n<p>Note that in the calculation of <code>c</code>, <code>a.last</code> is the last pair of indices added to the array being constructed (<code>a.last = [a.last.first, a.last.last]</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543476726, "post_id": 53532658, "comment_id": 93935371, "body": "The questions shows the &quot;output&quot; to be an array of pairs of indices whereas here you are displaying an array that contains the values from the array at those indices. It&#39;s a small point but please explain."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543485030, "post_id": 53532658, "comment_id": 93939772, "body": "@CarySwoveland Actual my job was, I want to rotate each layer of matrix by some value and so I wanted Matrix layer elements in circular manner and in order so that I can rotate. So I was having problem to get indices array. Later part was easy."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543485241, "post_id": 53532658, "comment_id": 93939896, "body": "@CarySwoveland Now I can rotate indices by <code>values[0,0] = values.pop(r%values.length)</code> which will rotate by <code>r</code> which can be 4, 36 etc. And then I will assign them to matrix by using indices and values (rotated)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543487594, "post_id": 53532658, "comment_id": 93941410, "body": "If it\u2019s a help, <code>arr.map(&amp;:reverse).transpose</code> \u201crotates\u201d an entire array <code>arr</code> 90 degrees."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543487990, "post_id": 53532658, "comment_id": 93941636, "body": "@CarySwoveland You are real good with matrix operation. It does rotate by <code>m</code> for <code>m x m</code> matrix."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 1, "last_activity_date": 1543471196, "last_edit_date": 1543471196, "creation_date": 1543470685, "answer_id": 53532658, "question_id": 53518673, "link": "https://stackoverflow.com/questions/53518673/optimised-loop-for-array-using-ruby/53532658#53532658", "title": "Optimised loop for array using ruby", "body": "<p>Following will work for both <code>m == n</code> &amp; <code>m != n</code> case.</p>\n\n<p>I hope, all will consider what matrix variable below stands for (2 D array)</p>\n\n<pre><code>def matrixRotation(matrix)\n    m,n = matrix.length-1, matrix[0].length-1\n    loop_count = [m,n].min/2\n    0.upto(loop_count) do |i|\n        indices = []\n        i.upto(m-i) { |j| indices &lt;&lt; [j, i] }\n        i.upto(n-i) { |j| indices &lt;&lt; [m-i, j] }\n        i.upto(m-i) { |j| indices &lt;&lt; [m-j, n-i] }\n        i.upto(n-i) { |j| indices &lt;&lt; [i, n-j] }\n        puts \"-------------- For Layer #{i+1} ---------------\", nil\n        indices = indices.uniq\n        values = indices.map { |x| matrix[x[0]][x[1]] }\n        puts 'indices:', indices.inspect, nil, 'values:', values.inspect\n    end\nend\n</code></pre>\n"}], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 53532658, "answer_count": 3, "score": -2, "last_activity_date": 1543471196, "creation_date": 1543405408, "last_edit_date": 1543409352, "question_id": 53518673, "link": "https://stackoverflow.com/questions/53518673/optimised-loop-for-array-using-ruby", "title": "Optimised loop for array using ruby", "body": "<p>I have (m = rows-1, n = cols-1) dimensional matrix. </p>\n\n<p>And I passing <strong>i</strong> to method which will return array in following manner (provided with <code>i &lt;= m,n</code>)</p>\n\n<p>Suppose n=0, so for 4x4 matrix, it will return boundary elements position. </p>\n\n<p><strong>Do not consider below as ruby syntax, get only flow.</strong></p>\n\n<pre><code>square = [[i,i] -&gt; [i, m-i] -&gt; [n-i, m-1] -&gt; [n-i, i] -&gt; [i,i]]\n</code></pre>\n\n<p>(no data is repeated in above)</p>\n\n<p>I achieved above in recursion manner by setting parameters but I need easier/optimised trick.</p>\n\n<p><strong>Update</strong> - for user sawa</p>\n\n<pre><code>arr = [*1..16].each_slice(4).to_a\nm,n = arr.length-1, arr[0].length-1\n\nloop_count = 0\n\noutput = [[0, 0], [1, 0], [2, 0], [3, 0], [4, 0], [4, 1], [4, 2], [3, 2], [2, 2], [1, 2], [0, 2], [0, 1]]\n\nloop_count = 1\n\noutput = [[1, 1], [2, 1], [2, 2], [1, 2]]\n</code></pre>\n"}, {"tags": ["ruby", "compiler-construction", "abstract-syntax-tree"], "owner": {"reputation": 20004, "user_id": 458137, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/578d634d7ce34d89570ba1b85a4cf118?s=128&d=identicon&r=PG", "display_name": "megas", "link": "https://stackoverflow.com/users/458137/megas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543408889, "creation_date": 1543404751, "last_edit_date": 1543408889, "question_id": 53518486, "link": "https://stackoverflow.com/questions/53518486/extend-ruby-compiler-on-the-fly", "title": "Extend ruby compiler on the fly", "body": "<p>I've met interesting ruby gems <a href=\"https://github.com/kddeisz/vernacular\" rel=\"nofollow noreferrer\">vernacular</a> and <a href=\"https://github.com/kddeisz/vernacular-ast\" rel=\"nofollow noreferrer\">vernacular-ast</a>.</p>\n\n<p>By these gems we can extend the ruby compiler, add new syntax etc.</p>\n\n<p>From the code I understood that I have to run manually on ruby lines or ruby files:</p>\n\n<pre><code>require 'vernacular'\n\nVernacular.configure {}\n\nVernacular.modify('my ruby code goes here')\n</code></pre>\n\n<p>Is it possible to add <code>Vernacular</code> to my project so I can use extended syntax? </p>\n\n<p>Something like this:</p>\n\n<pre><code># my_ruby_file.rb\nrequire 'vernacular'\nrequire 'extended_syntax'\n\nextended_syntax arg1, arg2\n</code></pre>\n"}, {"tags": ["ruby", "algorithm", "partitioning"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543403237, "post_id": 53517946, "comment_id": 93904669, "body": "Your issue is not clear. You need to state it fully and clearly."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543403668, "post_id": 53517946, "comment_id": 93904895, "body": "Hi @sawa, sorry how can I clarify this? I think it is pretty clear. I need to split an array into optimal subgroups with a minimum and maximum number of elements in each subgroup."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543403883, "post_id": 53517946, "comment_id": 93905022, "body": "What is optimal? That is an abstract word unless you define it. What to do when the remainder is other than 1? In your example, you have 5 as subgroup 1, which is less than your minimum 10. I am not sure what you mean by a minimum."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 2, "creation_date": 1543404660, "post_id": 53517946, "comment_id": 93905471, "body": "@ndbroadbent minimum doesn&#39;t make a lot of sense for this. Also, shouldn&#39;t <code>41</code> be <code>13,14,14</code>? And <code>50</code> be <code>16,17,17</code>?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543404772, "post_id": 53517946, "comment_id": 93905526, "body": "Indeed, the examples contradict the restrictions"}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1543405492, "post_id": 53517946, "comment_id": 93905943, "body": "@MarcinKo\u0142odziej Thanks for your feedback. I was taking the floor of each division and then adding the remainder to the last group, and I think that&#39;s fine for now. But you&#39;re right that <code>13,14,14</code> would be a more optimal solution. Maybe I can change my code to do that. (See my answer for an example.)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543405916, "post_id": 53517946, "comment_id": 93906209, "body": "To get the number of groups just divide the number of elements by the maximum length and round up, e.g. <code>61.fdiv(20).ceil #=&gt; 4</code> (your minimum length is not needed at all)."}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543406381, "post_id": 53517946, "comment_id": 93906472, "body": "Thanks @Stefan, you&#39;re right! I didn&#39;t need the minimum."}], "answers": [{"tags": [], "owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "is_accepted": false, "score": 0, "last_activity_date": 1543406010, "last_edit_date": 1543406010, "creation_date": 1543405346, "answer_id": 53518641, "question_id": 53517946, "link": "https://stackoverflow.com/questions/53517946/what-is-the-best-ruby-algorithm-to-divide-an-array-into-groups-with-a-minimum-an/53518641#53518641", "title": "What is the best Ruby algorithm to divide an array into groups with a minimum and maximum length?", "body": "<p>Here is my attempt at a solution:</p>\n\n<pre><code>class ArrayPartition\n  def self.partition_lengths(length, minimum, maximum)\n    if length &lt;= maximum\n      return [length]\n    end\n\n    group_size = maximum\n    groups = []\n\n    while groups.empty? || groups.last &lt; minimum\n      groups = []\n      remaining = length\n      while remaining &gt; group_size\n        groups &lt;&lt; group_size\n        remaining -= group_size\n      end\n      groups &lt;&lt; remaining\n      group_size -= 1\n    end\n\n    # Redistribute evenly\n    avg_group_size = (length / groups.size.to_f).round\n    groups = []\n    remaining = length\n    while remaining &gt; maximum\n      groups &lt;&lt; avg_group_size\n      remaining -= avg_group_size\n    end\n    groups &lt;&lt; remaining\n\n    groups.sort\n  end\nend\n</code></pre>\n\n<p>The RSpec test:</p>\n\n<pre><code>RSpec.describe ArrayPartition do\n  it 'partitions an array into optimal groups with min and max elements' do\n    expect(ArrayPartition.partition_lengths(5, 5, 10)).to eq [5]\n    expect(ArrayPartition.partition_lengths(6, 5, 10)).to eq [6]\n    expect(ArrayPartition.partition_lengths(7, 5, 10)).to eq [7]\n    expect(ArrayPartition.partition_lengths(10, 5, 10)).to eq [10]\n    expect(ArrayPartition.partition_lengths(11, 5, 10)).to eq [5, 6]\n    expect(ArrayPartition.partition_lengths(12, 5, 10)).to eq [6, 6]\n    expect(ArrayPartition.partition_lengths(13, 5, 10)).to eq [6, 7]\n    expect(ArrayPartition.partition_lengths(16, 5, 10)).to eq [8, 8]\n    expect(ArrayPartition.partition_lengths(20, 5, 10)).to eq [10, 10]\n    expect(ArrayPartition.partition_lengths(21, 5, 10)).to eq [7, 7, 7]\n    expect(ArrayPartition.partition_lengths(22, 5, 10)).to eq [7, 7, 8]\n\n    expect(ArrayPartition.partition_lengths(5, 10, 20)).to eq [5]\n    expect(ArrayPartition.partition_lengths(10, 10, 20)).to eq [10]\n    expect(ArrayPartition.partition_lengths(15, 10, 20)).to eq [15]\n    expect(ArrayPartition.partition_lengths(20, 10, 20)).to eq [20]\n    expect(ArrayPartition.partition_lengths(21, 10, 20)).to eq [10, 11]\n    expect(ArrayPartition.partition_lengths(30, 10, 20)).to eq [15, 15]\n    expect(ArrayPartition.partition_lengths(40, 10, 20)).to eq [20, 20]\n    expect(ArrayPartition.partition_lengths(41, 10, 20)).to eq [13, 14, 14]\n    expect(ArrayPartition.partition_lengths(42, 10, 20)).to eq [14, 14, 14]\n    expect(ArrayPartition.partition_lengths(43, 10, 20)).to eq [14, 14, 15]\n    expect(ArrayPartition.partition_lengths(45, 10, 20)).to eq [15, 15, 15]\n    expect(ArrayPartition.partition_lengths(50, 10, 20)).to eq [16, 17, 17]\n    expect(ArrayPartition.partition_lengths(55, 10, 20)).to eq [18, 18, 19]\n    expect(ArrayPartition.partition_lengths(60, 10, 20)).to eq [20, 20, 20]\n    expect(ArrayPartition.partition_lengths(61, 10, 20)).to eq [15, 15, 15, 16]\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1543405665, "post_id": 53518694, "comment_id": 93906060, "body": "Isn&#39;t <code>(count &#47; 20) + (count % 20 &gt; 0 ? 1 : 0)</code> just <code>(count.to_f &#47; 20).ceil</code>?"}, {"owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "edited": false, "score": 0, "creation_date": 1543406620, "post_id": 53518694, "comment_id": 93906624, "body": "This is what I ended up with: <a href=\"https://gist.github.com/ndbroadbent/ba93b017053377b610d15bbf2ec66523\" rel=\"nofollow noreferrer\">gist.github.com/ndbroadbent/ba93b017053377b610d15bbf2ec66523</a>  Thanks again!"}], "tags": [], "owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "is_accepted": true, "score": 2, "last_activity_date": 1543405920, "last_edit_date": 1543405920, "creation_date": 1543405472, "answer_id": 53518694, "question_id": 53517946, "link": "https://stackoverflow.com/questions/53517946/what-is-the-best-ruby-algorithm-to-divide-an-array-into-groups-with-a-minimum-an/53518694#53518694", "title": "What is the best Ruby algorithm to divide an array into groups with a minimum and maximum length?", "body": "<p>I would approach it like this:</p>\n\n<pre><code># count of original items\ncount = 61\n\n# max bucket size\nmax = 20\n\n# decide buckets\ngroups = (count / max) + (count % max &gt; 0 ? 1 : 0)\n\n# this will be the final result\nresult = []\n\n# create buckets\ngroups.times { result.push(0) }\n\n# iterate over original items and distribute them in the buckets\ncount.times do |n|\n  result[n % groups] += 1\nend\n\np result\n</code></pre>\n\n<p>Given the <code>count</code> as 61, it prints 16, 15, 15, 15. I've explained the purpose of each statement in the snippet itself.</p>\n"}, {"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 1, "last_activity_date": 1543412322, "last_edit_date": 1543412322, "creation_date": 1543406860, "answer_id": 53519128, "question_id": 53517946, "link": "https://stackoverflow.com/questions/53517946/what-is-the-best-ruby-algorithm-to-divide-an-array-into-groups-with-a-minimum-an/53519128#53519128", "title": "What is the best Ruby algorithm to divide an array into groups with a minimum and maximum length?", "body": "<p>Slightly different version:</p>\n\n<pre><code>def divide(c, max = 20)\n  groups = (c.to_f / max).ceil\n  min_count = (c.to_f / groups).floor\n\n  [min_count + 1] * (c % min_count) + [min_count] * (groups - c % min_count)\nend\n</code></pre>\n"}], "owner": {"reputation": 12499, "user_id": 304706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4931eceec58528529fd004e56af197c4?s=128&d=identicon&r=PG", "display_name": "ndbroadbent", "link": "https://stackoverflow.com/users/304706/ndbroadbent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 53518694, "answer_count": 3, "score": 1, "last_activity_date": 1543412322, "creation_date": 1543402995, "last_edit_date": 1543406042, "question_id": 53517946, "link": "https://stackoverflow.com/questions/53517946/what-is-the-best-ruby-algorithm-to-divide-an-array-into-groups-with-a-minimum-an", "title": "What is the best Ruby algorithm to divide an array into groups with a minimum and maximum length?", "body": "<p>I have a background job that needs to merge a lot of items together. I want to split this up into multiple \"sub jobs\" that each merge a subset of the data, and then a final pass that merges the output of all the \"sub jobs\" together.</p>\n\n<p>A naive way to do this is to split up the data into groups of x elements. The problem is that the last group might have the remainder of 1 element, so it would be a \"noop\". I want to find the optimal \"x\" so that the groups are roughly even, and have a minimum and maximum number of elements in each group (e.g. no less than 10 elements, and no more than 20.)</p>\n\n<p>What is a good algorithm for this in Ruby?</p>\n\n<p>Here is some sample output, with a minimum of 10, and maximum of 20. The numbers represent the number of elements in each array.</p>\n\n<pre><code>&lt;number of elements in input&gt; =&gt; &lt;subgroup 1&gt;, &lt;subgroup 2&gt;, etc. \n\n5 =&gt; 5\n10 =&gt; 10\n15 =&gt; 15\n20 =&gt; 20\n21 =&gt; 10, 11\n30 =&gt; 15, 15\n40 =&gt; 20, 20\n41 =&gt; 13, 14, 14\n42 =&gt; 14, 14, 14\n43 =&gt; 14, 14, 15\n45 =&gt; 15, 15, 15\n50 =&gt; 16, 17, 17\n55 =&gt; 18, 18, 19\n60 =&gt; 20, 20, 20\n61 =&gt; 15, 15, 15, 16\n</code></pre>\n\n<p>Basically I want to divide the array into roughly even groups, but with a minimum and maximum number of elements in each group.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "twitter-bootstrap", "bootstrap-4", "haml"], "comments": [{"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 2, "creation_date": 1543397250, "post_id": 53516023, "comment_id": 93901048, "body": "Why not put the input outside the if condition instead of having an else block"}], "owner": {"reputation": 2050, "user_id": 5695646, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-nEigl1xsDV4/AAAAAAAAAAI/AAAAAAAAANE/WGykpWYiogM/photo.jpg?sz=128", "display_name": "Yshmarov", "link": "https://stackoverflow.com/users/5695646/yshmarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543428917, "creation_date": 1543396987, "question_id": 53516023, "link": "https://stackoverflow.com/questions/53516023/conditional-html-in-rails-forms-a-better-way", "title": "Conditional html in rails forms - a better way?", "body": "<p>I have a form with conditional bootstrap:</p>\n\n<pre><code>= simple_form_for(@user) do |f|\n    = f.input :first_name\n    - if f.object.new_record?\n      %button.btn.btn-primary{\"data-target\" =&gt; \"#accordion\", \"data-toggle\" =&gt; \"collapse\", :type =&gt; \"button\"}\n        .fa.fa-cog\n        More options\n      #accordion.collapse\n      = f.input :many_more_fields\n    - else\n      = f.input :many_more_fields\n</code></pre>\n\n<p>Is there a better way to make only the css conditional, in order not to have to duplicate <code>= f.input :many_more_fields</code>.\nCSS part:</p>\n\n<pre><code>  %button.btn.btn-primary{\"data-target\" =&gt; \"#accordion\", \"data-toggle\" =&gt; \"collapse\", :type =&gt; \"button\"}\n    .fa.fa-cog\n    More options\n  #accordion.collapse\n</code></pre>\n\n<p>P.S. Any ideas, except creating a partial for <code>= f.input :many_more_fields</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543397764, "post_id": 53516158, "comment_id": 93901345, "body": "this is my rails version  5.0.1 Tried adding freeze_time getting this error  &#39; undefined method `freeze_time&#39;  &#39;"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543397946, "post_id": 53516158, "comment_id": 93901464, "body": "NoMethodError:        undefined method `freeze_time&#39; for #&lt;RSpec::ExampleGroups::ApiV2SomeController::GETIndex:0x007f&zwnj;&#8203;94275d27e0&gt;        Did you mean?  freeze"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543398184, "post_id": 53516158, "comment_id": 93901634, "body": "When I tried the second way    &quot;updatedAt&quot;=&gt;&quot;2018-11-28T15:12:01.408+05:30&quot;, :updatedAt=&gt;(be within 3 of 2018-11-28 15:12:01 +0530)  this is how the data goes."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543402234, "post_id": 53516158, "comment_id": 93904120, "body": "@Surya <code>freeze_time</code> was added to Rails 5.2. As I wrote above, you can use <code>travel_to(Time.zone.now)</code> -- that&#39;s literally the same thing, just slightly more clunky."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543407011, "post_id": 53516158, "comment_id": 93906868, "body": "I don&#39;t understand your comment about &quot;the second way&quot;. Are you saying that it worked? Or that it failed? If it failed, then what&#39;s the error? Is the issue that you&#39;re comparing a string with a time object?"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 0, "creation_date": 1543411198, "post_id": 53516158, "comment_id": 93909375, "body": "Ya in my  LHS I get this  -&quot;updatedAt&quot; =&gt; (be within 3 of 2018-11-28 18:46:45 +0530), RHS I get this  +&quot;updatedAt&quot; =&gt; &quot;2018-11-28T18:46:45.154+05:30&quot;,  think like to eql  be_within could be given  not sure if be within could be used as mentioned in the answer"}, {"owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "edited": false, "score": 1, "creation_date": 1543411402, "post_id": 53516158, "comment_id": 93909483, "body": "But travel_to worked. I had to include ActiveSupport::Testing::TimeHelpers Thanks"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1543397342, "creation_date": 1543397342, "answer_id": 53516158, "question_id": 53515806, "link": "https://stackoverflow.com/questions/53515806/trouble-with-rspec-for-timestamp-in-hashes/53516158#53516158", "title": "Trouble with Rspec for timestamp in hashes", "body": "<p>Since you haven't shown how <code>response_body_json</code> nor <code>Presenter#page</code> are defined, I cannot really answer why your current attempt doesn't work.</p>\n\n<p>However, I can instead say that I would use a different approach.</p>\n\n<p>There are two standard ways to write tests like this:</p>\n\n<ol>\n<li><strong>Freeze time</strong>.</li>\n</ol>\n\n<p>Assuming you're using a relatively up-to-date rails version, you can use use <a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActiveSupport/Testing/TimeHelpers.html#method-i-freeze_time%60\" rel=\"nofollow noreferrer\"><code>ActiveSupport::Testing::TimeHelpers#freeze_time</code></a> somewhere in the test, e.g. something like:</p>\n\n<pre><code>around do |example|\n  freeze_time { example.run }\nend\n\nit 'should return the movie_1 in page format' do\n  expect(response_body_json).to eql(Presenter.new(ActiveRecordObject).page)\nend\n</code></pre>\n\n<p>If you're on an older rails version, you may need to use <code>travel_to(Time.zone.now)</code> instead.</p>\n\n<p>And if you're on a very old rails version (or a non-rails project!), which doesn't have this helper library, you can use <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow noreferrer\"><code>timecop</code></a> instead.</p>\n\n<ol start=\"2\">\n<li><strong>Use a fuzzy matcher for timestamps</strong> (e.g. <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/be-within-matcher\" rel=\"nofollow noreferrer\"><code>be_within</code></a>). Something along the lines of:</li>\n</ol>\n\n<p>.</p>\n\n<pre><code>it 'should return the movie_1 in page format' do\n  expected_json = Presenter.new(ActiveRecordObject).page\n  expect(response_body_json).to match(\n    expected_json.merge(updated_at: be_within(3.seconds).of(Time.zone.now))\n  )\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "is_accepted": false, "score": 1, "last_activity_date": 1543468237, "last_edit_date": 1543468237, "creation_date": 1543465655, "answer_id": 53531835, "question_id": 53515806, "link": "https://stackoverflow.com/questions/53515806/trouble-with-rspec-for-timestamp-in-hashes/53531835#53531835", "title": "Trouble with Rspec for timestamp in hashes", "body": "<pre><code>before do\n  movie_1.publish\n  allow(Time.zone).to receive(:now).and_return(Time.now)\n  get :show, format: :json, params: { id: movie_1.uuid }\nend\n\nit 'should return the rec_1 in page format' do\n expect(response_body_json).to eql(Preseneter.new(ActiveRecordObject).page)\nend\n</code></pre>\n\n<p>end</p>\n\n<p>The above code resolved my issue.</p>\n\n<p>Looks like I have given this <code>allow(Time.zone).to receive(:now).and_return('hello')</code> in the wrong place. It  should be placed within the before block so that it gets set before the test case is run and I guess it must probably be set before the get request as well.</p>\n\n<p>However Tom Lord's approach is a better approach.</p>\n"}], "owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 1, "accepted_answer_id": 53516158, "answer_count": 2, "score": 2, "last_activity_date": 1543468237, "creation_date": 1543396293, "last_edit_date": 1543465504, "question_id": 53515806, "link": "https://stackoverflow.com/questions/53515806/trouble-with-rspec-for-timestamp-in-hashes", "title": "Trouble with Rspec for timestamp in hashes", "body": "<p>To compare to hashdata we had this in our spec</p>\n\n<pre><code>it 'should return the rec_1 in page format' do\n     expect(response_body_json).to eql(Preseneter.new(ActiveRecordObject).page)\nend\n</code></pre>\n\n<p>Presenter is a class that will accept the ActiveRecordObject and respond with hash data in a particular format.</p>\n\n<p><strong>We then added updated_at with timestamp to the hash_data.</strong>\nIn my code I have <code>updated_at = Time.zone.now</code>\nSo the spec started failing because both the updated_at had difference of few seconds.</p>\n\n<p>Tried stubbing Time.zone</p>\n\n<pre><code>it 'should return the rec_1 in page format' do\n     allow(Time.zone).to receive(:now).and_return('hello')\n     expect(response_body_json).to eql(Preseneter.new(ActiveRecordObject).page)\nend\n</code></pre>\n\n<p>but now response_body_json.updated_at comes as 'hello'\nbut still Right hand side comes with a timestamp</p>\n\n<p>Where am I going wrong???\nor is there any other better way to handle such scenarios?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543372962, "post_id": 53511177, "comment_id": 93892196, "body": "so where is <code>if there is comment</code> condition in your question?"}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543375224, "post_id": 53511177, "comment_id": 93892629, "body": "Thats what I am having a problem with. Not sure how I would add that logic."}, {"owner": {"reputation": 577, "user_id": 2839410, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wyRs5.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2839410/aaron"}, "edited": false, "score": 0, "creation_date": 1543379403, "post_id": 53511177, "comment_id": 93893649, "body": "Well, you&#39;re going to see that link beneath every comment, because if you didn&#39;t, you&#39;d be clicking delete_comment and not telling the application which comment you actually mean to target. Unless of course, you mean delete_comments. You&#39;d have to write that method in your comments controller."}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "reply_to_user": {"reputation": 577, "user_id": 2839410, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wyRs5.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2839410/aaron"}, "edited": false, "score": 0, "creation_date": 1543380348, "post_id": 53511177, "comment_id": 93893862, "body": "@Aaron I am fine with having the delete comment link underneath each comment. Thats what I want. The issue is that even when there is no comment, The Delete comment link still appears."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543375151, "post_id": 53511372, "comment_id": 93892614, "body": "I tried using that, and I get an <code>Undefined method, &#39;empty?&#39;</code>"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543375329, "post_id": 53511372, "comment_id": 93892654, "body": "it should be <code>if user_signed_in? &amp;&amp; comment.present?</code>"}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543375664, "post_id": 53511372, "comment_id": 93892734, "body": "Still getting the same result."}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "edited": false, "score": 0, "creation_date": 1543375691, "post_id": 53511372, "comment_id": 93892747, "body": "What is comment? An object or  a string? Can you post the code where it is defined?"}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543376364, "post_id": 53511372, "comment_id": 93892909, "body": "@jenstreetman its an object defined in my comments_controller <code>@comment = @pic.comments.create(params[:comment].permit(:name, :body))</code>"}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "edited": false, "score": 0, "creation_date": 1543376953, "post_id": 53511372, "comment_id": 93893020, "body": "So, just to make sure I understand, when you test if comment.present? When there isn&#39;t a comment,  the delete link still shows up? Or you get an error?"}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "edited": false, "score": 0, "creation_date": 1543377427, "post_id": 53511372, "comment_id": 93893138, "body": "If the link is showing up, then the comment must be present, I&#39;m guessing. Try testing if the body of the comment has something in it, !comment[:body].empty? Or something like that."}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543381524, "post_id": 53511372, "comment_id": 93894181, "body": "@jenstreetman Thanks! you solved it! i tried using the code you suggested and it threw an error, because of <code>empty?</code>, but I switched empty to <code>present?</code> and it worked."}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "edited": false, "score": 0, "creation_date": 1543387828, "post_id": 53511372, "comment_id": 93896367, "body": "I&#39;m so glad. I&#39;ll edit my answer, and if you wouldn&#39;t mind accepting it, that would help me out. Thanks."}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543388007, "post_id": 53511372, "comment_id": 93896442, "body": "@jenstreetman This is so weird it. It was working fine then all of a sudden I am having the same issue."}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "edited": false, "score": 0, "creation_date": 1543388354, "post_id": 53511372, "comment_id": 93896596, "body": "I&#39;ve been there. That is is so frustrating. Ca you post the code that you changed it to?"}, {"owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "edited": false, "score": 0, "creation_date": 1543389316, "post_id": 53511372, "comment_id": 93897019, "body": "@jenstreetman ok it works again. So weird. I accepted your answer. If I have more trouble ill be in touch. Thanks again."}], "tags": [], "owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "is_accepted": true, "score": 0, "last_activity_date": 1543387885, "last_edit_date": 1543387885, "creation_date": 1543373337, "answer_id": 53511372, "question_id": 53511177, "link": "https://stackoverflow.com/questions/53511177/logic-for-user-session/53511372#53511372", "title": "Logic for user session", "body": "<p>The delete link is showing up because you're not testing for the presence of the comment. You could do something like adding a test for an empty comment or if a comment exists:</p>\n\n<pre><code>&lt;% if user_signed_in? &amp;&amp; comment[:body].present?&gt;\n    &lt;p&gt;&lt;%= link_to 'Delete Comment', [comment.pic, comment], \n                   method: :delete, class: \"btn btn-danger\", \n        data: { confirm: \"Are you sure?\" } %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8530211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13962138d932f77703eb220806f0f1a1?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/8530211/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53511372, "answer_count": 1, "score": -1, "last_activity_date": 1558054233, "creation_date": 1543371807, "last_edit_date": 1558054233, "question_id": 53511177, "link": "https://stackoverflow.com/questions/53511177/logic-for-user-session", "title": "Logic for user session", "body": "<p><code>user_signed_in?</code> method comes from the devise Gem. If a user is signed in, and there is comment, I want the <code>Delete Comment</code> link to appear. If there are no comments, I want the link not to be there. <a href=\"https://i.stack.imgur.com/OAxNV.png\" rel=\"nofollow noreferrer\">Sample of show page</a>.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>&lt;% if user_signed_in? %&gt;\n  &lt;p&gt;&lt;%= link_to 'Delete Comment', [comment.pic, comment], method: :delete, class: \"btn btn-danger\", data: { confirm: \"Are you sure?\" } %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am having some trouble with the logic for the show page. If a user is signed in, the <code>Delete comment</code> link appears even if there are no comments. And if I post a comment, the <code>Delete Comment</code> link appears beneath every comment, with an extra <code>Delete Comment</code> link that is not linked to any specific comment.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 313, "user_id": 4056267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K1jA0.jpg?s=128&g=1", "display_name": "Dana Scheider", "link": "https://stackoverflow.com/users/4056267/dana-scheider"}, "edited": false, "score": 1, "creation_date": 1543378947, "post_id": 53510818, "comment_id": 93893518, "body": "You&#39;re going to need to include a lot more detail. Can you show us the code?"}], "answers": [{"tags": [], "owner": {"reputation": 6122, "user_id": 946500, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fqdcn.jpg?s=128&g=1", "display_name": "Pavel Oganesyan", "link": "https://stackoverflow.com/users/946500/pavel-oganesyan"}, "is_accepted": true, "score": 1, "last_activity_date": 1543397168, "creation_date": 1543397168, "answer_id": 53516090, "question_id": 53510818, "link": "https://stackoverflow.com/questions/53510818/errnoenoent-no-such-file-or-directory-rb-sysopen-sinatra-wont-load-views/53516090#53516090", "title": "Errno::ENOENT No such file or directory @ rb_sysopen sinatra wont load views", "body": "<p>You can specify views folder like this</p>\n\n<pre><code>set :views, Proc.new { File.join(root, \"templates\") }\n</code></pre>\n\n<p>Documentation: <a href=\"http://sinatrarb.com/configuration.html\" rel=\"nofollow noreferrer\">http://sinatrarb.com/configuration.html</a></p>\n\n<p>I suppose that you should storeviews like<code>/views/users/signup.html</code> - without <code>app</code> folder</p>\n"}], "owner": {"reputation": 73, "user_id": 5785905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd01dc6dd5786a658bba043310d8f57?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/5785905/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 53516090, "answer_count": 1, "score": 0, "last_activity_date": 1543397168, "creation_date": 1543369303, "question_id": 53510818, "link": "https://stackoverflow.com/questions/53510818/errnoenoent-no-such-file-or-directory-rb-sysopen-sinatra-wont-load-views", "title": "Errno::ENOENT No such file or directory @ rb_sysopen sinatra wont load views", "body": "<p>i have a view in the /app/views/users/signup.html and am calling erb :\"users/signup.html\" but am getting this error and it seems like sinatra cant find my views folder. </p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1543364526, "post_id": 53510194, "comment_id": 93890312, "body": "Can you clarify what your expected output is? You want to show the count of <code>deals</code> and the count of <code>free</code> in the first string? Would <code>p a.split.count &quot;deals&quot;</code> work?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "edited": false, "score": 0, "creation_date": 1543367174, "post_id": 53510314, "comment_id": 93890915, "body": "Thank you,On another note- Could you tell me a way by which we can iterate a string within an array of multiple strings ?"}], "tags": [], "owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "is_accepted": false, "score": 0, "last_activity_date": 1543364821, "creation_date": 1543364821, "answer_id": 53510314, "question_id": 53510194, "link": "https://stackoverflow.com/questions/53510194/how-to-iterate-through-multiple-strings-in-an-array/53510314#53510314", "title": "How to Iterate through multiple strings in an array", "body": "<p>With a little variable renaming, and some trickery of <code>scan</code> instead of match, this might work?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>a = \"Apple Banana oranges grapes. free free free phones. deals deals time.black white grey\"\nsentences = a.split(/\\./) # Split on `.`\n\n# Initialize variables\nfree_count = 0\ndeal_count = 0\nno_match = []\nmatches = []\n\nsentences.each do |i| # Go through each sentence\n  if (m = i.scan(/free/)) &amp;&amp; m.any? # Try matching \"free\", and check if there is any matches\n    matches &lt;&lt; i # Add match to matches array\n    free_count += m.length # Count up amounts of `free` spotted.\n  elsif (m = i.scan(/deals/)) &amp;&amp; m.any? # Try matching \"deals\", and check if there is any matches\n    matches &lt;&lt; i # Add match to matches array\n    deal_count += m.length # Count up amounts of `deals` spotted.\n  else\n    no_match &lt;&lt; i # Count up for nothing spotted\n end\nend\n\np free_count #=&gt; 3\np deal_count #=&gt; 2\np no_match #=&gt; [\"Apple Banana oranges grapes\", \"black white grey\"]\np matches #=&gt; [\" free free free phones\", \" deals deals time\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "edited": false, "score": 0, "creation_date": 1543367187, "post_id": 53510411, "comment_id": 93890918, "body": "Thank you,On another note- Could you tell me a way by which we can iterate a string within an array of multiple strings ?"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "reply_to_user": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "edited": false, "score": 0, "creation_date": 1543367462, "post_id": 53510411, "comment_id": 93890971, "body": "In Ruby, there are probably dozens of ways of doing that. You can use <code>.each</code> on arrays and <code>.each_char</code> on a string to iterate characters."}], "tags": [], "owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "is_accepted": false, "score": 0, "last_activity_date": 1543366415, "last_edit_date": 1543366415, "creation_date": 1543365638, "answer_id": 53510411, "question_id": 53510194, "link": "https://stackoverflow.com/questions/53510194/how-to-iterate-through-multiple-strings-in-an-array/53510411#53510411", "title": "How to Iterate through multiple strings in an array", "body": "<p>Your approach counts the sentences, not the occurrences of a word in the matched sentences. Use <code>c += i.split.count \"free\"</code> to count the actual occurrences of the word <code>\"free\"</code>. Avoid using single-letter variable names unless the meaning is clear.</p>\n\n<p>However, this all seems like a bit of extra lifting; you can perform counts and select/reject items matching a pattern using <a href=\"https://ruby-doc.org/core-2.2.0/Array.html\" rel=\"nofollow noreferrer\">builtin array methods</a>:</p>\n\n<pre><code>a = \"Apple Banana oranges grapes. free free free phones. deals deals time.black white grey\"\n\np a.split(\".\").grep /\\bfree\\b|\\bdeals\\b/\np a.split(\".\").reject {|e| e =~ /\\bfree\\b|\\bdeals\\b/}\np a.split.count \"free\"\np a.split.count \"deals\"\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[\" free free free phones\", \" deals deals time\"]\n[\"Apple Banana oranges grapes\", \"black white grey\"]\n3\n2\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/UrbanEnlightenedJavadocs\" rel=\"nofollow noreferrer\">Try it!</a></p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1543387694, "last_edit_date": 1543387694, "creation_date": 1543386305, "answer_id": 53513342, "question_id": 53510194, "link": "https://stackoverflow.com/questions/53510194/how-to-iterate-through-multiple-strings-in-an-array/53513342#53513342", "title": "How to Iterate through multiple strings in an array", "body": "<p>Possibly a solution that follows your original code:</p>\n\n<pre><code>a = \"Apple Banana oranges grapes. free free free phones. deals deals time.black white grey\"\nb = a.split(/\\W+/)\n\nc = 0\nd = 0\ng = Array.new\nt = Array.new\nb.each do |i|\n  if i == \"free\"\n    t.push i\n    c = c + 1\n  elsif i == \"deals\"\n    t.push i\n    d = d + 1\n  else\n    g.push i\n  end\nend\n\nputs \"Original words: #{b}\"\nputs \"Counts of 'free': #{c}\"\nputs \"Counts of 'deals': #{d}\"\nputs \"Array of matches: #{t}\"\nputs \"Array of non matches: #{g}\"\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code># Original words: [\"Apple\", \"Banana\", \"oranges\", \"grapes\", \"free\", \"free\", \"free\", \"phones\", \"deals\", \"deals\", \"time\", \"black\", \"white\", \"grey\"]\n# Counts of 'free': 3\n# Counts of 'deals': 2\n# Array of matches: [\"free\", \"free\", \"free\", \"deals\", \"deals\"]\n# Array of non matches: [\"Apple\", \"Banana\", \"oranges\", \"grapes\", \"phones\", \"time\", \"black\", \"white\", \"grey\"]\n</code></pre>\n\n<p><hr>\nAn example of counting using Ruby tools:</p>\n\n<pre><code>counts = {}\na.split(/\\W+/).tap { |b| b.uniq.map { |w| counts[w.downcase] = b.count(w) } }\ncounts #=&gt; {\"apple\"=&gt;1, \"banana\"=&gt;1, \"oranges\"=&gt;1, \"grapes\"=&gt;1, \"free\"=&gt;3, \"phones\"=&gt;1, \"deals\"=&gt;2, \"time\"=&gt;1, \"black\"=&gt;1, \"white\"=&gt;1, \"grey\"=&gt;1}\n</code></pre>\n\n<p>Then you can access data, for example:</p>\n\n<pre><code>counts.keys #=&gt; [\"apple\", \"banana\", \"oranges\", \"grapes\", \"free\", \"phones\", \"deals\", \"time\", \"black\", \"white\", \"grey\"]\ncounts['free'] #=&gt; 3\ncounts['deals'] #=&gt; 2\ncounts.select { |_, v| v &gt; 1} #=&gt; {\"free\"=&gt;3, \"deals\"=&gt;2}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1543387694, "creation_date": 1543363977, "last_edit_date": 1543382255, "question_id": 53510194, "link": "https://stackoverflow.com/questions/53510194/how-to-iterate-through-multiple-strings-in-an-array", "title": "How to Iterate through multiple strings in an array", "body": "<p>I have an array of strings.</p>\n\n<pre><code>a = \"Apple Banana oranges grapes. free free free phones. deals deals time.black white grey\"\nb = a.split(/\\./)\n</code></pre>\n\n<p>I want to check if a word <code>\"free\"</code> or <code>\"deals\"</code> is present in each string, and count and store it to a new array.</p>\n\n<pre><code>c = 0\nd = 0\ng = Array.new\nt = Array.new\nb.each do |i|\n  if /free/.match(i)\n    t.push i\n    c = c + 1\n  elsif /deals/.match(i)\n    t.push i\n    d = d + 1\n  else\n    g.push i\n  end\nend\np d\np c\np g\np t\n</code></pre>\n\n<p>But it doesn't show the exact count. Is there any other way to parse a string inside an array?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "carrierwave"], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1543382651, "post_id": 53510701, "comment_id": 93894483, "body": "really helpful for me too."}, {"owner": {"reputation": 362, "user_id": 7720957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jeSm9.jpg?s=128&g=1", "display_name": "Travis Le", "link": "https://stackoverflow.com/users/7720957/travis-le"}, "edited": false, "score": 0, "creation_date": 1547110111, "post_id": 53510701, "comment_id": 95081091, "body": "It works man. I would choose solution creating a helper method and just call it anywhere I want :D"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 14, "last_activity_date": 1543368225, "creation_date": 1543368225, "answer_id": 53510701, "question_id": 53510040, "link": "https://stackoverflow.com/questions/53510040/carrierwave-argument-error-nil-location-provided-cant-build-uri-for-an-image/53510701#53510701", "title": "Carrierwave: Argument Error Nil location provided. Can&#39;t build URI for an image_tag using carrier wave Ruby on Rails", "body": "<p>You have two options.</p>\n\n<p>1) Render image tag only if there is an image to be shown:</p>\n\n<pre><code> &lt;% if @restaurant.image_url %&gt;\n    &lt;%= image_tag @restaurant.image_url %&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>2) Provide a default value for <code>image_url</code> field:</p>\n\n<pre><code> &lt;%= image_tag @restaurant.image_url || default_image %&gt;\n</code></pre>\n\n<p>It's better to do it in a model/presenter:</p>\n\n<pre><code>class Image &lt; ApplicationModel\n\n  def image_url\n    super || default_image\n  end\nend\n</code></pre>\n\n<p>Or with <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Attributes/ClassMethods.html#method-i-attribute\" rel=\"noreferrer\">attribute API</a>:</p>\n\n<pre><code>class Image &lt; ApplicationModel\n  attribute :image_url, default: default_image\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7355520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9afd1ebebac64f3a989b58391d83263f?s=128&d=identicon&r=PG&f=1", "display_name": "Fenet", "link": "https://stackoverflow.com/users/7355520/fenet"}, "is_accepted": false, "score": 0, "last_activity_date": 1565350036, "creation_date": 1565350036, "answer_id": 57429072, "question_id": 53510040, "link": "https://stackoverflow.com/questions/53510040/carrierwave-argument-error-nil-location-provided-cant-build-uri-for-an-image/57429072#57429072", "title": "Carrierwave: Argument Error Nil location provided. Can&#39;t build URI for an image_tag using carrier wave Ruby on Rails", "body": "<p>use if condition, if there is an image it will display, if none, no error</p>\n\n<pre><code>   &lt;% if @restaurant.image_url? %&gt;\n     &lt;%= image_tag @restaurant.image_url %&gt;\n   &lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7944, "user_id": 10907864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGpcY.jpg?s=128&g=1", "display_name": "Promise Preston", "link": "https://stackoverflow.com/users/10907864/promise-preston"}, "is_accepted": false, "score": 1, "last_activity_date": 1602580671, "creation_date": 1602580671, "answer_id": 64332269, "question_id": 53510040, "link": "https://stackoverflow.com/questions/53510040/carrierwave-argument-error-nil-location-provided-cant-build-uri-for-an-image/64332269#64332269", "title": "Carrierwave: Argument Error Nil location provided. Can&#39;t build URI for an image_tag using carrier wave Ruby on Rails", "body": "<p>Just to add to the answers.</p>\n<p>You can use a one-liner code for this:</p>\n<pre><code>&lt;%= image_tag(@restaurant.image_url) if @restaurant.image_url%&gt;\n</code></pre>\n<p>which is equivalent to:</p>\n<pre><code>&lt;% if @restaurant.image_url? %&gt;\n  &lt;%= image_tag(@restaurant.image_url) %&gt;\n&lt;% end %&gt;\n</code></pre>\n<p><strong>OR</strong></p>\n<pre><code>&lt;% if @restaurant.image_url? %&gt;\n  &lt;%= image_tag @restaurant.image_url %&gt;\n&lt;% end %&gt;\n</code></pre>\n<p><strong>Resources</strong>: <a href=\"https://github.com/carrierwaveuploader/carrierwave#making-uploads-work-across-form-redisplays\" rel=\"nofollow noreferrer\">Carrierwave - Making uploads work across form redisplays</a></p>\n<p>That's all.</p>\n<p><strong>I hope this helps</strong></p>\n"}], "owner": {"reputation": 177, "user_id": 10095385, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AQNUq2AuhX0/AAAAAAAAAAI/AAAAAAAACeM/W_ToTsU2GKw/photo.jpg?sz=128", "display_name": "Sachin", "link": "https://stackoverflow.com/users/10095385/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5582, "favorite_count": 2, "accepted_answer_id": 53510701, "answer_count": 3, "score": 8, "last_activity_date": 1602580728, "creation_date": 1543362857, "last_edit_date": 1602580728, "question_id": 53510040, "link": "https://stackoverflow.com/questions/53510040/carrierwave-argument-error-nil-location-provided-cant-build-uri-for-an-image", "title": "Carrierwave: Argument Error Nil location provided. Can&#39;t build URI for an image_tag using carrier wave Ruby on Rails", "body": "<p>I'm getting an argument error for Nil location provided when using the image_tag.  How do I make the image_tag optional where it only displays if there is a corresponding image?  This is with Ruby on Rails 5.</p>\n\n<p>This is my current show page view:</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;%= image_tag @restaurant.image_url %&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Name:&lt;/strong&gt;\n  &lt;%= @restaurant.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Address:&lt;/strong&gt;\n  &lt;%= @restaurant.address %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Phone:&lt;/strong&gt;\n  &lt;%= @restaurant.phone %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Website:&lt;/strong&gt;\n  &lt;%= @restaurant.website %&gt;\n&lt;/p&gt;\n\n&lt;%= link_to 'Edit', edit_restaurant_path(@restaurant), class: 'btn btn-link' %&gt; |\n&lt;%= link_to 'Back', restaurants_path, class: 'btn btn-link' %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "will-paginate"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1543362729, "post_id": 53510003, "comment_id": 93889843, "body": "Wait. You don&#39;t want pagination? How about removing <code>.paginate</code>, then?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10410465"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1543362970, "post_id": 53510003, "comment_id": 93889910, "body": "No, I do want pagination on my index view. I just want to be able to download all enteries in the Order table. At the moment I can only download the first 20 because of pagination (which I want to keep)"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1543363008, "post_id": 53510003, "comment_id": 93889925, "body": "as @jvillian suggested, but you already set <code>@orders = Order.all</code> and still got pagnated result is weird. @orders was tampered somewhere else, like <code>before_action</code>?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1543363142, "post_id": 53510003, "comment_id": 93889954, "body": "Can you show your console log? I wonder if you&#39;re not using the <code>.csv</code> format and instead ending up in the <code>.html</code> format?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10410465"}, "edited": false, "score": 0, "creation_date": 1543364643, "post_id": 53510003, "comment_id": 93890344, "body": "Okay, the code I mentioned I tried actually throws an error. I&#39;ve added the console log of the original code."}], "answers": [{"comments": [{"owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "edited": false, "score": 0, "creation_date": 1543365357, "post_id": 53510375, "comment_id": 93890506, "body": "I just spotted another comment in your post; You&#39;ve tried something similar.. I have tried this approach as shown in my answer once, with success.. If it is not working, let me know, i will fire up a new rails app, and give it a go for you! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10410465"}, "edited": false, "score": 0, "creation_date": 1543368163, "post_id": 53510375, "comment_id": 93891132, "body": "This works! Thanks a lot for your help - much appreciated!"}], "tags": [], "owner": {"reputation": 2989, "user_id": 1009655, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K3jdk.png?s=128&g=1", "display_name": "Frederik Spang", "link": "https://stackoverflow.com/users/1009655/frederik-spang"}, "is_accepted": true, "score": 0, "last_activity_date": 1543365260, "creation_date": 1543365260, "answer_id": 53510375, "question_id": 53510003, "link": "https://stackoverflow.com/questions/53510003/how-do-i-use-the-send-data-method-in-rails-for-my-entire-index-view-and-not-just/53510375#53510375", "title": "How do I use the send_data method in Rails for my entire index view and not just the first page?", "body": "<p>I think it might be as simple as moving the <code>.paginate</code> call into a <code>format.html { ... }</code> block</p>\n\n<pre><code>class OrdersController &lt; ApplicationController\n    before_action :find_order, only: [:edit, :destroy, :update, :show]\n\n    def index\n        orders = Order.all.order(\"created_at DESC\")\n\n        # to allow csv and xls formats to be downloaded\n        respond_to do |format|\n            format.html do \n                @orders = orders.paginate(:page =&gt; params[:page], :per_page =&gt; 20)\n            end\n            format.csv { send_data orders.to_csv }\n            format.xls { send_data orders.to_csv(col_sep: \"\\t\") } # tab separate to work with Excel\n        end\n    end\n\n    ...\nend\n</code></pre>\n\n<p>You <strong>MAY</strong> have to add a <code>render :index</code>inside the format.html block. I have not been able to test this code currently.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10410465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 53510375, "answer_count": 1, "score": 0, "last_activity_date": 1543365260, "creation_date": 1543362574, "last_edit_date": 1543364562, "question_id": 53510003, "link": "https://stackoverflow.com/questions/53510003/how-do-i-use-the-send-data-method-in-rails-for-my-entire-index-view-and-not-just", "title": "How do I use the send_data method in Rails for my entire index view and not just the first page?", "body": "<p>I would like to be able to download my index data from my Order table in csv format. I have been able to implement this functionality with the following code:</p>\n\n<pre><code>orders controller:\n\nclass OrdersController &lt; ApplicationController\n    before_action :find_order, only: [:edit, :destroy, :update, :show]\n\n    def index\n        @orders = Order.all.order(\"created_at DESC\").paginate(:page =&gt; params[:page], :per_page =&gt; 20)\n        # to allow csv and xls formats to be downloaded\n        respond_to do |format|\n            format.html \n            format.csv { send_data @orders.to_csv }\n            format.xls { send_data @orders.to_csv(col_sep: \"\\t\") } # tab separate to work with Excel\n        end\n    end\n</code></pre>\n\n<p>Order model:</p>\n\n<pre><code>def self.to_csv(options = {}) \n        CSV.generate(options) do |csv|\n            csv &lt;&lt; column_names\n            all.each do |order|\n                csv &lt;&lt; order.attributes.values_at(*column_names)\n            end\n        end\n    end\n</code></pre>\n\n<p>This, however, only lets me download the first 20 entries in the Order table because of the pagination I have. I thought the following code would fix it, but it doesn't change anything:</p>\n\n<pre><code>def index\n        @orders = Order.all\n        # to allow csv and xls formats to be downloaded\n        respond_to do |format|\n            format.html { @orders.order(\"created_at DESC\").paginate(:page =&gt; params[:page], :per_page =&gt; 20) }\n            format.csv { send_data @orders.to_csv }\n            format.xls { send_data @orders.to_csv(col_sep: \"\\t\") } # tab separate to work with Excel\n        end\n    end\n\napp/views/orders/index.html.erb:43:in `_app_views_orders_index_html_erb___1955221700531553779_70231785858000'\nStarted GET \"/\" for 127.0.0.1 at 2018-11-28 01:19:56 +0100\nProcessing by OrdersController#index as HTML\n  Rendering orders/index.html.erb within layouts/application\n  User Load (0.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 3], [\"LIMIT\", 1]]\n  Order Load (0.9ms)  SELECT  \"orders\".* FROM \"orders\" ORDER BY created_at DESC LIMIT ? OFFSET ?  [[\"LIMIT\", 10], [\"OFFSET\", 0]]\n   (0.3ms)  SELECT COUNT(*) FROM \"orders\"\n  Rendered orders/index.html.erb within layouts/application (44.6ms)\nCompleted 200 OK in 216ms (Views: 203.2ms | ActiveRecord: 6.4ms)\n\n\nStarted GET \"/orders.csv\" for 127.0.0.1 at 2018-11-28 01:20:03 +0100\nProcessing by OrdersController#index as CSV\n  Order Load (0.6ms)  SELECT  \"orders\".* FROM \"orders\" ORDER BY created_at DESC LIMIT ? OFFSET ?  [[\"LIMIT\", 10], [\"OFFSET\", 0]]\n  Rendering text template\n  Rendered text template (0.0ms)\nSent data  (4.7ms)\nCompleted 200 OK in 15ms (Views: 4.5ms | ActiveRecord: 0.6ms)\n</code></pre>\n\n<p>Any ideas of how to keep the pagination but be able to download all entries in the Order table?</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": true, "score": 5, "last_activity_date": 1543374742, "creation_date": 1543374742, "answer_id": 53511548, "question_id": 53509852, "link": "https://stackoverflow.com/questions/53509852/how-to-get-ruby-platform-value-without-ruby/53511548#53511548", "title": "How to get RUBY_PLATFORM value without Ruby?", "body": "<p>After a fair bit of digging, it seems that the RUBY_PLATFORM value you seek is not derived from anything in the host system. Rather it is a string constant contained in the file \"rbconfig.rb\" in the Ruby install.</p>\n\n<p>Now if you have access to the Ruby files you could search for that file and then the following line of code:</p>\n\n<pre><code>CONFIG[\"arch\"] = \"i386-mingw32\"\n</code></pre>\n\n<p>You would of course extract a different string value.</p>\n\n<p>If you can execute ruby then maybe:</p>\n\n<pre><code>ruby -e \"puts RUBY_PLATFORM\"\n</code></pre>\n\n<p>but I suspect that is not the case.</p>\n"}], "owner": {"reputation": 11415, "user_id": 675311, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5e4575fdaacc879dc2199490417d170a?s=128&d=identicon&r=PG", "display_name": "bigblind", "link": "https://stackoverflow.com/users/675311/bigblind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 53511548, "answer_count": 1, "score": 4, "last_activity_date": 1543374742, "creation_date": 1543361516, "question_id": 53509852, "link": "https://stackoverflow.com/questions/53509852/how-to-get-ruby-platform-value-without-ruby", "title": "How to get RUBY_PLATFORM value without Ruby?", "body": "<p>I'm trying to automate the installation of dependencies for a project I'm working on. It uses the v8 binary from `<a href=\"https://rubygems.org/downloads/libv8-\" rel=\"nofollow noreferrer\">https://rubygems.org/downloads/libv8-</a>${V8_VERSION}-x86_64-linux.gem``</p>\n\n<p>That last part of the URL should be the <code>RUBY_PLATFORM</code>value for the platform it supports. Where can I find how this constant is set, so I can determine its value without requiring Ruby to be installed?</p>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1543365243, "post_id": 53509761, "comment_id": 93890478, "body": "Please be more specific about sorting numerically, considering that each string begins with one or two digits and there are two or three digits between the hyphens. Similarly, what do you mean by the second sort criterion, considering that there are strings of letters in two places as well?"}, {"owner": {"reputation": 394, "user_id": 1238856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/FKWJR.jpg?s=128&g=1", "display_name": "KBouldin9", "link": "https://stackoverflow.com/users/1238856/kbouldin9"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543417835, "post_id": 53509761, "comment_id": 93913672, "body": "I wanted it sorted so the first section is sorted by number, then with all the ones with the same first number the second section is sorted by number, then the within those the last section is sorted alphabetically."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543361643, "creation_date": 1543361643, "answer_id": 53509879, "question_id": 53509761, "link": "https://stackoverflow.com/questions/53509761/sort-array-of-string-with-digits-and-characters-in-ruby/53509879#53509879", "title": "Sort array of string with digits and characters in ruby", "body": "<p>You can chain several <code>#sort</code> method calls, each sorting by a different part of a string (starting with one with smallest priority):</p>\n\n<pre><code>array.sort { |a,b| a.match(/-(.*)$/)[1] &lt;=&gt; b.match(/-(.*)-/)[1] } # sort by last element ('classic', 'super')\n     .sort { |a,b| a.match(/-(\\d+)-/)[1].to_i &lt;=&gt; b.match(/-(\\d+)-/)[1].to_i } # sort by the number between dashes \n     .sort { |a,b| a.to_i &lt;=&gt; b.to_i  } # sort by the initial number\n\n=&gt; [\"1mo-20-extra\",\n \"1mo-30-classic\",\n \"1mo-30-super\",\n \"1mo-40-classic\",\n \"1mo-110-super\",\n \"6mo-11-super\",\n \"6mo-21-super\",\n \"12mo-21-super\",\n \"12mo-21-classic\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 1, "last_activity_date": 1543363748, "creation_date": 1543363748, "answer_id": 53510160, "question_id": 53509761, "link": "https://stackoverflow.com/questions/53509761/sort-array-of-string-with-digits-and-characters-in-ruby/53510160#53510160", "title": "Sort array of string with digits and characters in ruby", "body": "<p>You're looking for a \"natural\" sort where the numeric substrings will be compared as numbers as the non-numeric parts will be compared like strings. Conveniently enough, arrays in Ruby compare element-by-element and your format is fairly regular so you can get away with a <code>#sort_by</code> call and a bit of mangling to convert <code>\"12mo-21-classic\"</code> to <code>[12, 'mo-', 21, '-classic']</code>. Something like this for example:</p>\n\n<pre><code># This is a bit complicated so we'll give the logic a name.\nnatural_parts = -&gt;(s) { s.match(/(\\d+)(\\D+)(\\d+)(\\D+)/).to_a.drop(1).map.with_index { |e, i| i.even?? e.to_i : e } }\narray.sort_by(&amp;natural_parts)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1543378274, "last_edit_date": 1543378274, "creation_date": 1543377608, "answer_id": 53511917, "question_id": 53509761, "link": "https://stackoverflow.com/questions/53509761/sort-array-of-string-with-digits-and-characters-in-ruby/53511917#53511917", "title": "Sort array of string with digits and characters in ruby", "body": "<pre><code>array.sort_by { |s| [s.to_i, s[/(?&lt;=-)\\d+/].to_i, s.gsub(/\\A.+-/,'')] }\n  #=&gt; [\"1mo-20-extra\", \"1mo-30-classic\", \"1mo-30-super\", \"1mo-40-classic\", \"1mo-110-super\",\n  #    \"6mo-11-super\", \"6mo-21-super\", \"12mo-21-classic\", \"12mo-21-super\"]\n</code></pre>\n\n<p>When sorting arrays the method <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Arrays#&lt;=></a> is used to order pairs of arrays. See the third paragraph of the doc for an explanation of how that is done.</p>\n\n<p>The arrays used for the sort ordering are as follows.</p>\n\n<pre><code>array.each do |s|\n  puts \"%-15s -&gt; [%2d, %3d, %s]\" % [s, s.to_i, s[/(?&lt;=-)\\d+/].to_i, s.gsub(/\\A.+-/,'')]\nend\n\n1mo-30-super    -&gt; [ 1,  30, super]\n1mo-40-classic  -&gt; [ 1,  40, classic]\n1mo-30-classic  -&gt; [ 1,  30, classic]\n1mo-110-super   -&gt; [ 1, 110, super]\n1mo-20-extra    -&gt; [ 1,  20, extra]\n6mo-21-super    -&gt; [ 6,  21, super]\n6mo-11-super    -&gt; [ 6,  11, super]\n12mo-21-classic -&gt; [12,  21, classic]\n12mo-21-super   -&gt; [12,  21, super]\n</code></pre>\n\n<p><code>(?&lt;=-)</code> is a <em>positive lookbehind</em>. It requires that the match be immediately preceded by a hyphen. <code>/\\A.+-/</code> matches the beginning of the string followed by one or more characters followed by a hyphen. Because regular expressions are by default <em>greedy</em>, it concludes the match on the second hyphen.</p>\n\n<p>Note that it is not necessary to use regular expressions:</p>\n\n<pre><code>array.sort_by { |s| [s.to_i, s[s.index('-')+1..-1].to_i, s[s.rindex('-')+1..-1]] }\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 1238856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/FKWJR.jpg?s=128&g=1", "display_name": "KBouldin9", "link": "https://stackoverflow.com/users/1238856/kbouldin9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 53510160, "answer_count": 3, "score": 0, "last_activity_date": 1543378274, "creation_date": 1543361008, "question_id": 53509761, "link": "https://stackoverflow.com/questions/53509761/sort-array-of-string-with-digits-and-characters-in-ruby", "title": "Sort array of string with digits and characters in ruby", "body": "<p>I have an array with the given strings</p>\n\n<pre><code>array = [\n  \"1mo-30-super\",\n  \"1mo-40-classic\",\n  \"1mo-30-classic\",\n  \"1mo-110-super\",\n  \"1mo-20-extra\",\n  \"6mo-21-super\",\n  \"6mo-11-super\",\n  \"12mo-21-classic\",\n  \"12mo-21-super\"\n]\n</code></pre>\n\n<p>How can I sort the array so that it goes in numerical order, then alphabetical order so the array displays like so:</p>\n\n<pre><code>array = [\n  \"1mo-20-extra\",\n  \"1mo-30-classic\",\n  \"1mo-30-super\",\n  \"1mo-40-classic\",\n  \"1mo-110-super\",\n  \"6mo-11-super\",\n  \"6mo-21-super\",\n  \"12mo-21-classic\",\n  \"12mo-21-super\"\n]\n</code></pre>\n"}, {"tags": ["ruby", "google-sheets-api"], "comments": [{"owner": {"reputation": 21, "user_id": 5999694, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207352197357404/picture?type=large", "display_name": "Corey Shapiro", "link": "https://stackoverflow.com/users/5999694/corey-shapiro"}, "edited": false, "score": 0, "creation_date": 1543366505, "post_id": 53509699, "comment_id": 93890756, "body": "Oops. Those last two lines aren&#39;t really relevant."}, {"owner": {"reputation": 21, "user_id": 5999694, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207352197357404/picture?type=large", "display_name": "Corey Shapiro", "link": "https://stackoverflow.com/users/5999694/corey-shapiro"}, "edited": false, "score": 0, "creation_date": 1543377876, "post_id": 53509699, "comment_id": 93893271, "body": "I think the problem might be that formatted value is read-only as it says here: (<a href=\"https://www.rubydoc.info/github/google/google-api-ruby-client/Google/Apis/SheetsV4/CellData#formatted_value-instance_method\" rel=\"nofollow noreferrer\">rubydoc.info/github/google/google-api-ruby-client/Google/Ap&zwnj;&#8203;is/&hellip;</a>)  If that is the case, the API should return an error saying I tried to write to a read only field instead of doing nothing."}], "owner": {"reputation": 21, "user_id": 5999694, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207352197357404/picture?type=large", "display_name": "Corey Shapiro", "link": "https://stackoverflow.com/users/5999694/corey-shapiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543360668, "creation_date": 1543360668, "question_id": 53509699, "link": "https://stackoverflow.com/questions/53509699/how-do-i-add-data-to-a-cell-with-the-batch-update-spreadsheet-method-in-the-goog", "title": "How do I add data to a cell with the batch_update_spreadsheet method in the google sheets api?", "body": "<p>The following code is supposed to add text to a cell on a google sheet, but when I run it, it does nothing and does not give an error:</p>\n\n<pre><code>values = [{formatted_value: \"Hello Sheet\"}]\n\nstart = {sheet_id: 0, column_index: 0, row_index: 1}\nrows = [{values: values}]\n\nrequests.push({\n    update_cells: {\n        fields: \"*\",\n        start: start,\n        rows: rows\n    }\n})\n\n\nbody = {requests: requests}\nresult = $service.batch_update_spreadsheet($spreadsheet_id, body, {})\nfind_replace_response = result.replies[1].find_replace\nputs \"#{find_replace_response.occurrences_changed} replacements made.\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 9180784, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xN7Dl.jpg?s=128&g=1", "display_name": "Hackstreet_Boy", "link": "https://stackoverflow.com/users/9180784/hackstreet-boy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543376486, "last_edit_date": 1543376486, "creation_date": 1543359946, "answer_id": 53509591, "question_id": 53509421, "link": "https://stackoverflow.com/questions/53509421/how-to-query-update-table-from-ruby-on-rails-application/53509591#53509591", "title": "How to query UPDATE table from ruby on rails application?", "body": "<p>Try using a where clause on the document with the form thats being changed, and use update_all() to run a SQL query for that specific event. See if something like this works with your Database -></p>\n\n<pre><code>Document.where(conditions).limit(1).update_all(changes) # =&gt; 1\n</code></pre>\n\n<p>Here is some documentation on update_all() in Active Record relations\n<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-update_all\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-update_all</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10713699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd49cb76f430f13742d1d172f24fc3?s=128&d=identicon&r=PG&f=1", "display_name": "Artificial", "link": "https://stackoverflow.com/users/10713699/artificial"}, "edited": false, "score": 0, "creation_date": 1543424926, "post_id": 53509749, "comment_id": 93918223, "body": "This did the job. Thank you!"}], "tags": [], "owner": {"reputation": 820, "user_id": 2640181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7599b700aee8e1a534030709ae43616?s=128&d=identicon&r=PG", "display_name": "barmic", "link": "https://stackoverflow.com/users/2640181/barmic"}, "is_accepted": true, "score": 0, "last_activity_date": 1543360958, "creation_date": 1543360958, "answer_id": 53509749, "question_id": 53509421, "link": "https://stackoverflow.com/questions/53509421/how-to-query-update-table-from-ruby-on-rails-application/53509749#53509749", "title": "How to query UPDATE table from ruby on rails application?", "body": "<p>If you want to delete attachment, you should do something like this:</p>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"files\"&gt;\n    &lt;% @document.files.each do |file| %&gt;\n      &lt;%= link_to file.filename, delete_file_attachment_document_url(file), method: :delete, data: { confirm: 'Are you sure?' }%&gt;\n    &lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p><strong>documents_controller.rb</strong></p>\n\n<pre><code>@file = ActiveStorage::Attachment.find(params[:id])\n@file.purge\n</code></pre>\n\n<p>I hope, that will resolve your issue.</p>\n"}], "owner": {"reputation": 3, "user_id": 10713699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd49cb76f430f13742d1d172f24fc3?s=128&d=identicon&r=PG&f=1", "display_name": "Artificial", "link": "https://stackoverflow.com/users/10713699/artificial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 53509749, "answer_count": 2, "score": 0, "last_activity_date": 1543376486, "creation_date": 1543358820, "last_edit_date": 1543375355, "question_id": 53509421, "link": "https://stackoverflow.com/questions/53509421/how-to-query-update-table-from-ruby-on-rails-application", "title": "How to query UPDATE table from ruby on rails application?", "body": "<p>While testing I use <code>Document.last.files.first.purge</code> from console with rails c, the first file is deleted, but also rails c automatically calls an UPDATE query on the document. But when I call purge on a file from my application, I can see that in the rails server only the DELETE query is launched. (This causes a heap of problems, like server trying to load unexistent blobs, so I assume that it's very important to update a table after changes have been made to it.)\nMy question is how can I replicate this UPDATE query from ruby?\nThanks!</p>\n\n<p><img src=\"https://i.stack.imgur.com/mdjxj.png\" alt=\"Expected result from rails server\">\n <code>doc= Document.last</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/t20Ru.png\" alt=\"Real result from rails server\"></p>\n\n<p>Code for deleting file:</p>\n\n<blockquote>\n  <p>Controller (documents_controller.rb)</p>\n</blockquote>\n\n<pre><code>def delete_file_attachment\n    @file = ActiveStorage::Blob.find_signed(params[:id]).purge\nend\n</code></pre>\n\n<blockquote>\n  <p>View (_form.html.erb)</p>\n</blockquote>\n\n<pre><code>&lt;div class=\"files\"&gt;\n    &lt;% @document.files.each do |file| %&gt;\n      &lt;%= link_to file.filename, delete_file_attachment_document_url(file.signed_id), method: :delete, data: { confirm: 'Are you sure?' }%&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<blockquote>\n  <p>Model (document.rb)</p>\n</blockquote>\n\n<pre><code>class Document &lt; ApplicationRecord\n  has_many_attached :files\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543359559, "post_id": 53509416, "comment_id": 93888951, "body": "Could you post the code of the form, controller and Tweet model?"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1543360918, "post_id": 53509560, "comment_id": 93889345, "body": "ah thanks. my code is the same as yours but i dont have shallow true.  I&#39;ve actually never heard of it."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1543362763, "post_id": 53509560, "comment_id": 93889853, "body": "Feel free to upvote if you found the answer helpful to help future searchers."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 1, "last_activity_date": 1543359725, "creation_date": 1543359725, "answer_id": 53509560, "question_id": 53509416, "link": "https://stackoverflow.com/questions/53509416/simple-form-in-ruby-on-rails-nesting/53509560#53509560", "title": "simple form in ruby on rails- nesting", "body": "<blockquote>\n  <p>I'm a bit unclear how this works. Is it because a new tweet needs to be assigned to a user, therefore @user and @tweet are used, and to edit a tweet, the @user isnt needed because there is no need for it?</p>\n</blockquote>\n\n<p>The short answer is \"yes\". The longer answer is...</p>\n\n<p>I don't know, but I'm guessing that the routes look something like: </p>\n\n<pre><code>resources :user do \n  resources :tweets, shallow: true \nend\n</code></pre>\n\n<p>Which would give you something like: </p>\n\n<pre><code>    user_tweets GET    /users/:user_id/tweets(.:format)          tweets#index\n                POST   /users/:user_id/tweets(.:format)          tweets#create\n new_user_tweet GET    /users/:user_id/tweets/new(.:format)      tweets#new\n     edit_tweet GET    /tweets/:id/edit(.:format)                tweets#edit\n          tweet GET    /tweets/:id(.:format)                     tweets#show\n                PATCH  /tweets/:id(.:format)                     tweets#update\n                PUT    /tweets/:id(.:format)                     tweets#update\n                DELETE /tweets/:id(.:format)                     tweets#destroy\n          users GET    /users(.:format)                          users#index\n                POST   /users(.:format)                          users#create\n       new_user GET    /users/new(.:format)                      users#new\n      edit_user GET    /users/:id/edit(.:format)                 users#edit\n           user GET    /users/:id(.:format)                      users#show\n                PATCH  /users/:id(.:format)                      users#update\n                PUT    /users/:id(.:format)                      users#update\n                DELETE /users/:id(.:format)                      users#destroy\n</code></pre>\n\n<p>So, you can see that for <code>tweets#edit</code>, <code>tweets#show</code>, <code>tweets#update</code>, and <code>tweets#destroy</code>, <code>:user_id</code> is not needed. This is due to <code>shallow: true</code></p>\n\n<p>You can read more about shallow nesting in the <a href=\"https://edgeguides.rubyonrails.org/routing.html#shallow-nesting\" rel=\"nofollow noreferrer\">guide</a>.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53509560, "answer_count": 1, "score": 0, "last_activity_date": 1543359725, "creation_date": 1543358773, "question_id": 53509416, "link": "https://stackoverflow.com/questions/53509416/simple-form-in-ruby-on-rails-nesting", "title": "simple form in ruby on rails- nesting", "body": "<p>I am just curious about simple form and nesting. Ive read documents but still dont quite understand. </p>\n\n<p>I created a website using device where a user can post tweet and also edit a tweet.\nI was under the impression that [@user, @tweet] would need to be present in the simple_form_for on both new and edit forms. However i discovered that [@user, @tweet] needs to be on the new form and only [@tweet] needs to be on the edit form. is this correct?\nI'm a bit unclear how this works. Is it because a new tweet needs to be assigned to a user, therefore @user and @tweet are used, and to edit a tweet, the @user isnt needed because there is no need for it?\napologies if this makes no sense.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543391842, "post_id": 53509340, "comment_id": 93898177, "body": "&quot;but it does not update the field in the ruby code&quot; - indeed, this is simply not what this method is supposed to do."}], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543358876, "post_id": 53509379, "comment_id": 93888721, "body": "I need to use class_eval then to open up the class and modify the code and then reload the documents dynamically"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543359505, "post_id": 53509379, "comment_id": 93888934, "body": "Why do you want to do it dynamically? You can rename it in the source code and then reload the app.  Btw in production settings it&#39;s safer to copy field content instead of renaming it."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543361223, "post_id": 53509379, "comment_id": 93889438, "body": "I need to do it dynamically because field name is based on user input."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543361718, "post_id": 53509379, "comment_id": 93889575, "body": "So you want to rename field in the database basing on user input? Quite risky, I assume you&#39;re doing a tool for mongo management."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543363206, "post_id": 53509379, "comment_id": 93889971, "body": "Yes that&#39;s exactly what I want to do"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 1, "creation_date": 1543390843, "post_id": 53509379, "comment_id": 93897729, "body": "@Donato: if you&#39;re making a db management tool, then mongoid is of no use to you. Precisely because you don&#39;t know the schema beforehand and (I assume) do not care at all about relations. Your best course of action (IMHO) is to use the &quot;raw&quot; mongo driver."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543443327, "post_id": 53509379, "comment_id": 93926575, "body": "@SergioTulentsev But I use Mongoid for a lot of other things, Rails-style querying methods, validations, associations, and a ton of other useful features. Why must I redo all this tested work just because one small feature involves the ability to add and delete fields dynamically. That&#39;s it. Everything else Mongoid is used for."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1543474162, "post_id": 53509379, "comment_id": 93934314, "body": "@Donato I see. Just redo the dynamic part then."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 0, "last_activity_date": 1543358655, "creation_date": 1543358655, "answer_id": 53509379, "question_id": 53509340, "link": "https://stackoverflow.com/questions/53509340/renaming-field-in-mongoid-does-not-update-field-in-class/53509379#53509379", "title": "Renaming field in Mongoid does not update field in class", "body": "<p>When you run <code>#rename</code>, you interact with MongoDB. The change of document structure is stored in the database. This method does not interact with ruby source code, you need to edit it by yourself. </p>\n\n<p>Btw. I can't recall any ruby/rails method (besides ones in rake tasks and generators) that interacts with the source code stored in files. </p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 53509379, "answer_count": 1, "score": 1, "last_activity_date": 1543358655, "creation_date": 1543358386, "question_id": 53509340, "link": "https://stackoverflow.com/questions/53509340/renaming-field-in-mongoid-does-not-update-field-in-class", "title": "Renaming field in Mongoid does not update field in class", "body": "<p>When I rename a field in Mongoid, it successfully updates the field in MongoDB, but it does not update the field in the ruby code:</p>\n\n<pre><code>class Example\n  include Mongoid::Document\n  field :apple, type: String, as: :c_apple\nend\n\nExample.all\n =&gt; #&lt;Mongoid::Criteria\n  selector: {}\n  options:  {}\n  class:    Example\n  embedded: false&gt;\n\nExample.all.rename(\"apple\" =&gt; \"d_apple\")\n  MOPED: 127.0.0.1:27017 UPDATE       database=core collection=examples selector={} update={\"$rename\"=&gt;{\"apple\"=&gt;\"d_apple\"}} flags=[:multi]\n                         COMMAND      database=core command={:getlasterror=&gt;1, :w=&gt;1} runtime: 1.2460ms\n =&gt; {\"connectionId\"=&gt;2, \"updatedExisting\"=&gt;false, \"n\"=&gt;0, \"syncMillis\"=&gt;0, \"writtenTo\"=&gt;nil, \"err\"=&gt;nil, \"ok\"=&gt;1.0} \n\ne = Example.new\n =&gt; #&lt;Example _id: 5bfdbf103ed1492f9a000001, apple(c_apple): nil&gt; \n\n e.d_apple\nNoMethodError: undefined method `d_apple' for #&lt;Example _id: 5bfdbf103ed1492f9a000001, apple(c_apple): nil&gt;\n</code></pre>\n\n<p>Why are the changes in MongoDB not reflected in class definition?</p>\n"}, {"tags": ["ruby", "multithreading", "mutex"], "owner": {"reputation": 3674, "user_id": 126781, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/390625ce982313b7fd5a5812c376c16a?s=128&d=identicon&r=PG", "display_name": "zeroDivisible", "link": "https://stackoverflow.com/users/126781/zerodivisible"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1543516580, "creation_date": 1543357102, "last_edit_date": 1543516580, "question_id": 53509084, "link": "https://stackoverflow.com/questions/53509084/is-the-code-mutex-unlock-if-mutex-owned-safe-in-ruby", "title": "Is the code &quot;mutex.unlock if mutex.owned?&quot; safe in Ruby?", "body": "<p>The following simplified code (extracted from a rather big multi-threaded piece of software) very rarely results in a <code>ThreadError: Attempt to unlock a mutex which is not locked</code>:</p>\n\n<pre><code>begin\n  yield(mutex) if mutex.try_lock\nensure\n  mutex.unlock if mutex.owned?\nend\n</code></pre>\n\n<p>on line 4.</p>\n\n<p>That's in Ruby 2.1.5, which is EOF right now, but my understanding was that calling <code>mutex.unlock</code> is safe if current thread owns the mutex, which is being checked with <code>mutex.owned?</code>. Would I be wrong in this assumption?</p>\n\n<p>I believe that <code>yield(mutex)</code> in line 2 does never attempt to unlock the yielded mutex.</p>\n\n<p>I understand that using something like <code>mutex.synchronize(&amp;block)</code> may be preferable instead - but I'm just wondering how the above snippet should behave. And if I'm missing something in my understanding.</p>\n"}, {"tags": ["ruby", "text", "nlp", "sentiment-analysis"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2297332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c03e55b45518652852997f5660b2952?s=128&d=identicon&r=PG", "display_name": "Bob Kessler", "link": "https://stackoverflow.com/users/2297332/bob-kessler"}, "edited": false, "score": 0, "creation_date": 1543365966, "post_id": 53510021, "comment_id": 93890631, "body": "These answers are coming via text/sms so we have no control. I&#39;m looking for a text analysis approach that would yield these results. Doesn&#39;t have to be 100% correct but work for most cases. Thanks for responding."}, {"owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "reply_to_user": {"reputation": 1, "user_id": 2297332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c03e55b45518652852997f5660b2952?s=128&d=identicon&r=PG", "display_name": "Bob Kessler", "link": "https://stackoverflow.com/users/2297332/bob-kessler"}, "edited": false, "score": 0, "creation_date": 1543369951, "post_id": 53510021, "comment_id": 93891528, "body": "I did a Google search for &quot;ruby gem sentiment analysis&quot; and got this link. You may want to take a look and also try a similar search. <a href=\"https://github.com/7compass/sentimental/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/7compass/sentimental/blob/master/README.md</a>"}], "tags": [], "owner": {"reputation": 313, "user_id": 3561547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z35dD.jpg?s=128&g=1", "display_name": "jenstreetman", "link": "https://stackoverflow.com/users/3561547/jenstreetman"}, "is_accepted": false, "score": 0, "last_activity_date": 1543362725, "creation_date": 1543362725, "answer_id": 53510021, "question_id": 53508706, "link": "https://stackoverflow.com/questions/53508706/how-to-detect-numerical-value-of-a-text/53510021#53510021", "title": "How to detect numerical value of a text?", "body": "<p>If you are solely looking to turn THESE SPECIFIC responses into numerical values, then you can pass them through a series of if statements in a function:</p>\n\n<pre><code>    def inputToNumber(string)\n        #thumbs up emoji\n        if string == \"\\u{1f44d}\"\n            return 5\n        #the word four\n        elsif string == \"four\"\n            return 4\n        #etc., etc. with if statements for your other cases\n        end\n    end\n</code></pre>\n\n<p>But it might make more sense for you to only allow numeric answers to begin with, because:</p>\n\n<ol>\n<li>You can't predict every possible written response</li>\n<li>Someone could input malicious code </li>\n</ol>\n\n<p>You didn't provide your code to show how you are accepting input so I can't really offer you specific solutions, but you can look here for some suggestions: <a href=\"https://stackoverflow.com/questions/32146970/accept-only-numeric-input\">Accept only numeric input</a></p>\n\n<p>Good luck with your project.</p>\n"}], "owner": {"reputation": 1, "user_id": 2297332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c03e55b45518652852997f5660b2952?s=128&d=identicon&r=PG", "display_name": "Bob Kessler", "link": "https://stackoverflow.com/users/2297332/bob-kessler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543366107, "creation_date": 1543355341, "last_edit_date": 1543366107, "question_id": 53508706, "link": "https://stackoverflow.com/questions/53508706/how-to-detect-numerical-value-of-a-text", "title": "How to detect numerical value of a text?", "body": "<p>We have data for survey question (e.g. rate us between 1-5) that's supposed to be numerical. However, we find that the response also includes</p>\n\n<ul>\n<li>\ud83d\udc4d repeated 5 times </li>\n<li>\u2764\ufe0f repeated 4 times </li>\n<li>Great! </li>\n<li>four </li>\n<li>3 and a half</li>\n</ul>\n\n<p>I'd like a way to turn the user response into a numerical value. e.g. the text above should translate into 5, 4, 5, 4, 3.5 respectively. Obviously this won't work 100% of the time so I'm looking for an optimal solution (perhaps a text analysis approach) that gets me over 80%. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "rails-engines", "payola"], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "is_accepted": false, "score": 0, "last_activity_date": 1543360198, "creation_date": 1543360198, "answer_id": 53509631, "question_id": 53508261, "link": "https://stackoverflow.com/questions/53508261/use-engine-routes-inside-of-rails-application-routes-draw-rails-5-2/53509631#53509631", "title": "Use Engine Routes inside of Rails.application.routes.draw Rails 5.2", "body": "<p>I created a scoped module that would render the same results as the engine itself.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code> scope :module =&gt; \"payola\" do\n    match '/buy/:product_class/:permalink'  =&gt; 'transactions#create',   via: :post, as: :buy\n    match '/confirm/:guid'                  =&gt; 'transactions#show',     via: :get,  as: :confirm\n    match '/status/:guid'                   =&gt; 'transactions#status',   via: :get,  as: :status\n\n    match '/subscribe/:plan_class/:plan_id' =&gt; 'subscriptions#create',   via: :post,   as: :subscribe\n    match '/confirm_subscription/:guid'     =&gt; 'subscriptions#show',     via: :get,    as: :confirm_subscription\n    match '/subscription_status/:guid'      =&gt; 'subscriptions#status',   via: :get,    as: :subscription_status\n    match '/cancel_subscription/:guid'      =&gt; 'subscriptions#destroy',  via: :delete, as: :cancel_subscription\n    match '/change_plan/:guid'              =&gt; 'subscriptions#change_plan', via: :post, as: :change_subscription_plan\n    match '/change_quantity/:guid'          =&gt; 'subscriptions#change_quantity', via: :post, as: :change_subscription_quantity\n    match '/update_card/:guid'              =&gt; 'subscriptions#update_card', via: :post, as: :update_card\n\n    match '/update_customer/:id'            =&gt; 'customers#update', via: :post, as: :update_customer\n\n    match '/create_card/:customer_id'       =&gt; 'cards#create', via: :post, as: :create_card\n    match '/destroy_card/:id/:customer_id'  =&gt; 'cards#destroy', via: :delete, as: :destroy_card\n    mount StripeEvent::Engine =&gt; '/events'\n  end\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543360198, "creation_date": 1543353431, "question_id": 53508261, "link": "https://stackoverflow.com/questions/53508261/use-engine-routes-inside-of-rails-application-routes-draw-rails-5-2", "title": "Use Engine Routes inside of Rails.application.routes.draw Rails 5.2", "body": "<p>I'm currently using a custom build of a gem that hasn't been updated to work with Rails 5.2 as of now. I've extracted the core files and now I'm faced with an issue where I need to access the routes for the engine internally. All folders for the gem, have the namespace <strong>payola</strong> - which allows me to access its resources. How can I setup my routes to take into account the namespaced routes for the gem, without including the reference to the engine itself (which is causing duplicates). My routes file is below. When I add the routes to the Rails.application.routes.draw alone, its unable to find the controllers for it. </p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  get 'mobile_search/index'\n  mount Payola::Engine =&gt; '/payola', as: :payola\n  mount ActionCable.server =&gt; '/cable'\n  require 'sidekiq/web'\n  mount Sidekiq::Web =&gt; '/sidekiq'\n  mount Resque::Server, :at =&gt; \"/resque\"\n  mount CountryStateSelect::Rails::Engine, at: \"/\"\n\n  devise_for :admins\n  devise_for :users, path: '', path_names: {sign_in: 'login', sign_out: 'logout', sign_up: 'signup'}, controllers: {registrations: 'users/registrations'}\n\n  devise_scope :user do\n    put 'user_change_plan', :to =&gt; 'users/registrations#user_change_plan'\n    authenticated do\n      root to: 'user_dashboard#index', as: 'authenticated_user_root'\n    end\n    unauthenticated do\n      root to: 'home#index', as: 'unauthenticated_user_root'\n    end\n  end\n\n  devise_scope :admin do\n    authenticated do\n      root to: 'admin_dashboard#admin', as: 'authenticated_admin_root'\n    end\n\n    unauthenticated do\n      root to: 'home#index', as: 'unauthenticated_admin_root'\n    end\n  end\n\n  resources :after_registration_wizard, only: [:show]\n\n  root 'home#index'\nend\n\n# Payola\n\nPayola::Engine.routes.draw do\n  match '/buy/:product_class/:permalink'  =&gt; 'transactions#create',   via: :post, as: :buy\n  match '/confirm/:guid'                  =&gt; 'transactions#show',     via: :get,  as: :confirm\n  match '/status/:guid'                   =&gt; 'transactions#status',   via: :get,  as: :status\n\n  match '/subscribe/:plan_class/:plan_id' =&gt; 'subscriptions#create',   via: :post,   as: :subscribe\n  match '/confirm_subscription/:guid'     =&gt; 'subscriptions#show',     via: :get,    as: :confirm_subscription\n  match '/subscription_status/:guid'      =&gt; 'subscriptions#status',   via: :get,    as: :subscription_status\n  match '/cancel_subscription/:guid'      =&gt; 'subscriptions#destroy',  via: :delete, as: :cancel_subscription\n  match '/change_plan/:guid'              =&gt; 'subscriptions#change_plan', via: :post, as: :change_subscription_plan\n  match '/change_quantity/:guid'          =&gt; 'subscriptions#change_quantity', via: :post, as: :change_subscription_quantity\n  match '/update_card/:guid'              =&gt; 'subscriptions#update_card', via: :post, as: :update_card\n\n  match '/update_customer/:id'            =&gt; 'customers#update', via: :post, as: :update_customer\n\n  match '/create_card/:customer_id'       =&gt; 'cards#create', via: :post, as: :create_card\n  match '/destroy_card/:id/:customer_id'  =&gt; 'cards#destroy', via: :delete, as: :destroy_card\n\n  mount StripeEvent::Engine =&gt; '/events'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1543349709, "post_id": 53507383, "comment_id": 93884688, "body": "Have you tried <code>&lt;%= simple_form_for  @chairdo |f| %&gt;</code>? Could you paste the full stacktrace?"}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "edited": false, "score": 0, "creation_date": 1543350096, "post_id": 53507383, "comment_id": 93884873, "body": "Also post your models code. Documentation about nested simple from <a href=\"https://github.com/plataformatec/simple_form/wiki/Nested-Models\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "edited": false, "score": 1, "creation_date": 1543350230, "post_id": 53507383, "comment_id": 93884940, "body": "Just don&#39;t understand why you are passing a user in form.   If you need a form for a chair - <code>&lt;%= simple_form_for @chair do |f| %&gt;</code>"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1543350888, "post_id": 53507383, "comment_id": 93885237, "body": "i have tried with only @chair and it does not work. ive added other code above"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1543351905, "post_id": 53507383, "comment_id": 93885696, "body": "Also, so should i only need <code>@user</code> and <code>@chair</code> in the form if im making a new chair post? and only <code>@chair</code> if im editing a post?"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1543356586, "creation_date": 1543356586, "answer_id": 53508988, "question_id": 53507383, "link": "https://stackoverflow.com/questions/53507383/undefined-method-model-name-for-nilnilclass-trying-to-edit-a-post/53508988#53508988", "title": "undefined method `model_name&#39; for nil:NilClass - Trying to edit a post", "body": "<p>You probably pass <code>nil</code> to <code>simple_form_for</code>. I don't know how it happens, let me just describe some strange things I've found out:</p>\n\n<p>You have incorrect nesting of methods in the controller - <code>#edit</code>, <code>#update</code> and <code>#delete</code> are nested in <code>create</code>. Either you did a mistake when you were copying it, or you have a piece of really weird code.</p>\n\n<p>Logs show that user is fetched from the db, but there is nothing about a chair. That may be the reason for this behaiour - <code>@chair</code> is not initialized. </p>\n\n<p>I would do two things to push debugging forward:</p>\n\n<ul>\n<li>check nesting of methods. </li>\n<li>ensure that <code>ChairsController</code> is not defined twice</li>\n<li>check if <code>@chair</code> is not nil in <code>@edit</code> (e.g. by printing <code>@chair.id</code> to logs).</li>\n</ul>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 53508988, "answer_count": 1, "score": 1, "last_activity_date": 1543384435, "creation_date": 1543349448, "last_edit_date": 1543384435, "question_id": 53507383, "link": "https://stackoverflow.com/questions/53507383/undefined-method-model-name-for-nilnilclass-trying-to-edit-a-post", "title": "undefined method `model_name&#39; for nil:NilClass - Trying to edit a post", "body": "<p>I have made a chair selling website, at the moment i want to edit a chair post, no matter who posted it.\nhowever its coming up with an error 'undefined method `model_name' for nil:NilClass'.\nNot sure why. Ive tried with only @chair in the edit form.\nI have added some more code from models and the terminal below.</p>\n\n<pre><code>Started GET \"/chairs/1/edit\" for 127.0.0.1 at 2018-11-27 20:30:53 +0000\nProcessing by ChairsController#edit as HTML\n  Parameters: {\"id\"=&gt;\"1\"}\n  User Load (0.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 3], [\"LIMIT\", 1]]\n  \u21b3 /Users/benherring/.rbenv/versions/2.4.4/lib/ruby/gems/2.4.0/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98\n  Rendering chairs/edit.html.erb within layouts/application\n  Rendered chairs/edit.html.erb within layouts/application (3.4ms)\nCompleted 500 Internal Server Error in 22ms (ActiveRecord: 0.4ms)\n\n\n\nActionView::Template::Error (undefined method `model_name' for nil:NilClass):\n    1: &lt;%= simple_form_for @chair do |f| %&gt;\n    2: &lt;%= f.input :name %&gt;\n    3: &lt;%= f.input :description %&gt;\n    4: &lt;%= f.submit :submit %&gt;\n\napp/views/chairs/edit.html.erb:1:in `_app_views_chairs_edit_html_erb___2826282127562707280_70360397910180' . \n</code></pre>\n\n\n\n<pre><code>class Chair &lt; ApplicationRecord\n  belongs_to :user\nend\n\n\n\nclass User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n         has_many :chairs\nend\n</code></pre>\n\n\n\n<pre><code>class ChairsController &lt; ApplicationController\n\n  def index\n    @chairs = Chair.all\n  end\n\n  def show\n    @chair = Chair.find(params[:id])\n    @user = @chair.user\n  end\n\n  def new\n    @chair = Chair.new\n    @user = current_user\n  end\n\n  def create\n    @user = current_user\n    @chair = Chair.new(chair_params)\n    @chair.user = @user\n    if @chair.save\n      redirect_to chairs_path\n    end\n\n    def edit\n      @chair = Chair.find(params[:id])\n      @user = current_user\n    end\n\n    def update\n\n    @chair = Chair.find(params[:id])\n    @chair.update(chair_params)\n    redirect_to chairs_path\n    end\n\n    def delete\n    end\n\n  end\n\n\n  private\n\n  def chair_params\n    params.require(:chair).permit(:name, :description)\n  end\nend\n</code></pre>\n\n\n\n<pre><code>&lt;%= simple_form_for [@user, @chair] do |f| %&gt;\n&lt;%= f.input :name %&gt;\n&lt;%= f.input :description %&gt;\n&lt;%= f.submit :submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n"}, {"tags": ["ruby", "inheritance", "module", "metaprogramming"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "edited": false, "score": 0, "creation_date": 1543661412, "post_id": 53506722, "comment_id": 94004801, "body": "im sorry but I dont really understand the answer you linked to. As I understand it, it creates instance variables in the subclass. I want to create a hook in the subclass, that hook would be inherited from the parent class."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543346511, "creation_date": 1543346511, "answer_id": 53506722, "question_id": 53506408, "link": "https://stackoverflow.com/questions/53506408/inheriting-a-before-or-after-hook-to-child-classes/53506722#53506722", "title": "Inheriting a before or after hook to child classes", "body": "<p>You can use inheritable class instance variables for hooks to make them available in child classes, as described <a href=\"https://stackoverflow.com/a/10729812/580346\">here</a>.</p>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543346511, "creation_date": 1543345065, "question_id": 53506408, "link": "https://stackoverflow.com/questions/53506408/inheriting-a-before-or-after-hook-to-child-classes", "title": "Inheriting a before or after hook to child classes", "body": "<p>I have written a module to hook methods before or after an instance method call. Id like to apply these hooks to all classes that inherit from the parent class. However if I write the hook in the parent class it wont be executed, it will only be executed if it is present in the child class.</p>\n\n<p>This is the module to create the hooks :</p>\n\n<pre><code>module Hooks\n\ndef self.included(base)\n base.send :extend, ClassMethods\nend\n\n\nmodule ClassMethods\n  # everytime we add a method to the class we check if we must redifine it\n  def method_added(method)\n    if @hooker_before &amp;&amp; (@methods_to_hook_before.include?(method)|| @methods_to_hook_after.include?(method)) &amp;&amp; !@methods_seen.include?(method)\n      hooked_method_before = instance_method(@hooker_before) if @hooker_before\n      hooked_method_after =  instance_method(@hooker_after) if @hooker_after\n      @methods_to_hook_before.each do |method_name|\n        begin\n          method_to_hook = instance_method(method_name)\n        rescue NameError =&gt; e\n          return\n        end\n        @methods_seen.push(method)\n\n        define_method(method_name) do |*args, &amp;block|\n          hooked_method_before.bind(self).call if hooked_method_before\n          method_to_hook.bind(self).(*args, &amp;block) ## your old code in the method of the class\n          hooked_method_after.bind(self).call if hooked_method_after\n        end\n      end\n     end\n   end\n\n  def before(*methods_to_hook, hookers)\n   @methods_to_hook_before = methods_to_hook\n   @methods_to_hook_after = [] unless @methods_to_hook_after\n   @hooker_before = hookers[:call]\n   @methods_seen = []\n  end\n\n  def after(*methods_to_hook, hookers)\n    @methods_to_hook_after = methods_to_hook\n    @methods_to_hook_before = [] unless @methods_to_hook_before\n    @hooker_after = hookers[:call]\n    @methods_seen = []\n  end\n end\nend\n\nmodule Utilities\n  def before_generate\n    puts(\"in before generate utilities\")\n  end\nend\n\nclass Parent\n  include Utilities\n  include Hooks\n\n\n  def generate\n    puts(\"in generate Parent\")\n  end\nend\n\nclass Child &lt; Parent\n  before :generate, call: :before_generate\n\n  def generate\n    puts(\"in child generate\")\n  end\nend\nclass AnotherChild &lt; Parent\n      before :generate, call: :before_generate\n\n      def generate\n        puts(\"in child generate\")\n      end\n    end\n</code></pre>\n\n<p><code>Child.new.generate()</code> produces the desired output : \nin before generate utilities\nin child generate\nHowever I would like all class that inherits from Parent to automatically inherit from this behavior. Adding <code>before :generate, call: :before_generate</code> to the parent class won't do the trick. Is there maybe a way by wrapping all the child classes in the same module ?\nIs there a way to achieve that or shall I reproduce the before call in every single child class where I want it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1543348622, "post_id": 53505934, "comment_id": 93884147, "body": "Looks like there is a validation on the domain name that Shopifys gem adds when creating the model, i was so confused as to what was causing it, thanks for the tip"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 2, "last_activity_date": 1543343136, "creation_date": 1543343136, "answer_id": 53505934, "question_id": 53505908, "link": "https://stackoverflow.com/questions/53505908/when-creating-an-active-record-in-the-datatbase-it-is-being-created-without-the/53505934#53505934", "title": "When creating an active record in the datatbase, it is being created without the primary key", "body": "<p>One of the validations you have for your shop caused your object to not be saved. <code>create</code> returns the object regardless of whether or not it was saved.</p>\n\n<p>In order to investigate further:</p>\n\n<pre><code>shop.persisted?\n# =&gt; false\nshop.errors\n# =&gt; will display errors of your object\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 316, "user_id": 6376149, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VSEqbriQIqs/AAAAAAAAAAI/AAAAAAAAAJg/OycI2fK3nCo/photo.jpg?sz=128", "display_name": "ahawrylak", "link": "https://stackoverflow.com/users/6376149/ahawrylak"}, "is_accepted": false, "score": 2, "last_activity_date": 1543343452, "creation_date": 1543343452, "answer_id": 53506018, "question_id": 53505908, "link": "https://stackoverflow.com/questions/53505908/when-creating-an-active-record-in-the-datatbase-it-is-being-created-without-the/53506018#53506018", "title": "When creating an active record in the datatbase, it is being created without the primary key", "body": "<p>I'm pretty sure that your object is simply invalid and therefore was not saved to database. That's why it has no <code>id</code>. You can check if there are any errors by:</p>\n\n<pre><code>shop.errors.any?\nshop.errors.messages # =&gt; display errors\n</code></pre>\n\n<p>If you want to raise <code>RecordInvalid</code> error if validations fail, use <code>create!</code> instead of <code>create</code>.</p>\n"}], "owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53505934, "answer_count": 2, "score": 0, "last_activity_date": 1543343452, "creation_date": 1543343029, "question_id": 53505908, "link": "https://stackoverflow.com/questions/53505908/when-creating-an-active-record-in-the-datatbase-it-is-being-created-without-the", "title": "When creating an active record in the datatbase, it is being created without the primary key", "body": "<p>I am creating an active record object like so:</p>\n\n<pre><code>shop = ShopifyShop.create(shopify_domain: shopDomain, primary_domain: shopObj.domain, shopify_token: token, user_id: userId) if !shop\n</code></pre>\n\n<p>When the an object with the same <code>primary_domain</code> is created, the record is not stored in the database and the object is created with no primary key</p>\n\n<p>so when i do:</p>\n\n<pre><code>p shop\n</code></pre>\n\n<p>i get <code>#&lt;ShopifyShop id: nil, shopify_domain: \"***.myshopify.com\", shopify_token: \"***\", created_at: nil, updated_at: nil, user_id: 45, primary_domain: \"***.myshopify.com\"&gt;</code></p>\n\n<p>I checked to see if it was related to constrain maybe but theres only a primary key constraint in the table, i am not sure what is causing this. </p>\n\n<p>Anyone know what could be happening?</p>\n"}, {"tags": ["ruby", "string"], "owner": {"reputation": 55, "user_id": 9645125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OfZ9J.jpg?s=128&g=1", "display_name": "Oscar Q.", "link": "https://stackoverflow.com/users/9645125/oscar-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1543343103, "answer_count": 0, "score": 1, "last_activity_date": 1543387417, "creation_date": 1543342766, "last_edit_date": 1543387417, "question_id": 53505848, "link": "https://stackoverflow.com/questions/53505848/getting-position-from-multiple-characters-in-a-string", "closed_reason": "Duplicate", "title": "Getting position from multiple characters in a string", "body": "<p>I can only get the position of the first space <code>\" \"</code> but not the other three using <code>index</code>.</p>\n\n<pre><code>text = \"Lorem ipsum dolor sit amet\"\nputs text.index(\" \")\n</code></pre>\n\n<p>Is there any way to get the position of the other three spaces?\nShould I use any other string method?</p>\n\n<p>Edit:\nI ended up solving it myself.</p>\n\n<pre><code>i = 0\nwhile i &lt; text.length do\n    if text[i] == \" \"\n        puts i\n    end\n    i += 1\nend\n</code></pre>\n\n<p>I looped through the string until it found a space, and then it displayed the variable <code>i</code>, which in this case is equal to the positioning of the spaces in the string.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1543342755, "post_id": 53505833, "comment_id": 93881266, "body": "You&#39;re fast! Just about to say the same thing."}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1543343422, "post_id": 53505833, "comment_id": 93881638, "body": "ah perfect. thanks very much. Could you please explain how this works? im relatively new to rails."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543343691, "post_id": 53505833, "comment_id": 93881770, "body": "Your <code>Chair</code> model has probably a <code>belongs_to :user</code> line. In your <code>create</code> method you assign the <code>current_user</code> to that <code>user</code> association. In the <code>show</code> method you read that user again. I suggest to read about <a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">Associations in the Rails Guides</a>."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1543342719, "creation_date": 1543342719, "answer_id": 53505833, "question_id": 53505710, "link": "https://stackoverflow.com/questions/53505710/error-couldnt-find-user-with-id-2-unable-to-solve/53505833#53505833", "title": "ERROR - Couldn&#39;t find User with &#39;id&#39;=2 - unable to solve", "body": "<p>At the moment you try to load the user by the same <code>params[:id]</code> as the chair your <code>show</code> method.  Change your <code>show</code> method to:</p>\n\n<pre><code>def show\n  @chair = Chair.find(params[:id])\n  @user = @chair.user\nend\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53505833, "answer_count": 1, "score": 0, "last_activity_date": 1543342719, "creation_date": 1543342275, "question_id": 53505710, "link": "https://stackoverflow.com/questions/53505710/error-couldnt-find-user-with-id-2-unable-to-solve", "title": "ERROR - Couldn&#39;t find User with &#39;id&#39;=2 - unable to solve", "body": "<p>im using rails to make a basic chair selling website. At the moment someone can post a new chair and people can look at each individual show page. However im having issues with the show page when trying to display the email of who posted the chair.\nIf i click on the first chair, it works fine, however if i click on the other it says 'Couldn't find User with 'id'=2'. I have made all the chairs under 1 user.\nthanks. let me know if you need anymore info.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class ChairsController &lt; ApplicationController\r\n\r\n  def index\r\n    @chairs = Chair.all\r\n  end\r\n\r\n  def show\r\n    @chair = Chair.find(params[:id])\r\n    @user = User.find(params[:id])\r\n  end\r\n\r\n  def new\r\n    @chair = Chair.new\r\n    @user = current_user\r\n  end\r\n\r\n  def create\r\n    @user = current_user\r\n    @chair = Chair.new(chair_params)\r\n    @chair.user = @user\r\n    if @chair.save\r\n      redirect_to chairs_path\r\n    end\r\n\r\n  end\r\n\r\n\r\n  private\r\n\r\n  def chair_params\r\n    params.require(:chair).permit(:name, :description)\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;h1&gt;&lt;%= @chair.name %&gt;&lt;/h1&gt;\r\n\r\nposted by &lt;%= @user.email %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "docker"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1543340637, "post_id": 53505250, "comment_id": 93880089, "body": "During ruby 1.8.7 days, rake was of much lower version. Not even 1.0. Try one of those, 0.X.Y"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1543341461, "post_id": 53505250, "comment_id": 93880517, "body": "You dont have <code>Gemfile</code> in your docker image or project. Is this intentional?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1543345374, "post_id": 53505250, "comment_id": 93882601, "body": "@MartinZinovsky: bundler probably didn&#39;t exist back then :)"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543345603, "post_id": 53505250, "comment_id": 93882722, "body": "Do you have more information on the required gems? Especially what version of Rails this app was build for? Do you know when this application was build (that would make it easier to guess the required gem versions)?"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543345638, "post_id": 53505250, "comment_id": 93882739, "body": "@SergioTulentsev <a href=\"https://rubygems.org/gems/bundler\" rel=\"nofollow noreferrer\">bundler requires ruby &gt;= <code>1.8.7</code></a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1543345940, "post_id": 53505250, "comment_id": 93882878, "body": "@MartinZinovsky Rails started to use bundler for dependency management with version 3.0 Therefore the use of bundler was very rare in previous versions of Rails. Given the age of this application I am ot surprised that there is no Gemfile. But I agree adding a Gemfile should probably be the next step."}, {"owner": {"reputation": 2942, "user_id": 477340, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a858a54895a4242c16f7f43f92fd343d?s=128&d=identicon&r=PG", "display_name": "khinester", "link": "https://stackoverflow.com/users/477340/khinester"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543362218, "post_id": 53505250, "comment_id": 93889707, "body": "@spickermann thanks for the replies  is there a correct way to build the Gemfile or do i have to import these from the code in the app dir?"}], "answers": [{"comments": [{"owner": {"reputation": 912, "user_id": 362420, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BPoSl.png?s=128&g=1", "display_name": "Riccardo", "link": "https://stackoverflow.com/users/362420/riccardo"}, "edited": false, "score": 1, "creation_date": 1608967154, "post_id": 53514589, "comment_id": 115720058, "body": "Wow this is a SWEET answer! Thanks! So much to unpack here. Yet I&#39;m still failing to find a nice, supported, docker version of ruby1.8.7 :/"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1582819390, "last_edit_date": 1582819390, "creation_date": 1543391591, "answer_id": 53514589, "question_id": 53505250, "link": "https://stackoverflow.com/questions/53505250/running-ruby-1-8-7-in-docker/53514589#53514589", "title": "running ruby 1.8.7 in docker", "body": "<p>When you install the <code>rake</code> gem manually with <code>gem install rake</code> then <code>gem</code> tries to install the latest version. But the latest version of <code>rake</code> doesn't support your old version of Ruby anymore. Instead, you need to pick a version that still works with Ruby 1.8.7</p>\n\n<p>But that is only part of your problem. Your problem is that you need to install all the dependencies of your application without any information on what dependencies your application might have.</p>\n\n<p>Since Ruby on Rails 3.0 <code>bundler</code> is used to manage dependencies. And I highly suggest that you start fixing your problem by <a href=\"https://bundler.io/\" rel=\"nofollow noreferrer\">adding <code>bundler</code> and a <code>Gemfile</code> to your application</a>.</p>\n\n<p>Remember you have only very limited information about what dependencies your application might have. You know that is was build against Ruby 1.8.7 which was released mid-2008. Therefore I guess that your application was built 2008\u20132010 (after 2010 the developer would likely have used Ruby 1.9.x). </p>\n\n<p>The up-to-date versions of <code>rake</code> were <code>~&gt; 0.8.3</code> at that time (see <a href=\"https://rubygems.org/gems/rake/versions\" rel=\"nofollow noreferrer\"><code>rake</code> versions</a>). Furthermore, I guess your application uses Ruby on Rails <code>2.x</code> (see <a href=\"https://rubygems.org/gems/rails/versions\" rel=\"nofollow noreferrer\"><code>rails</code> versions</a>). In <code>&lt;3.0</code> Rails application you can usually find the Rails version in <code>config/environment.rb</code> assigned to <code>RAILS_GEM_VERSION</code>. I assume it is <code>2.3.5</code>. Create a <code>Gemfile</code> with this information in your application root:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '2.3.5'\ngem 'rake', '~&gt; 0.8.7'\n</code></pre>\n\n<p>Install these gems by running <code>bundle install</code> and try to open the rails console or to start the application server. This will very likely not work and you will need to add more gems as dependencies to your <code>Gemfile</code>. </p>\n\n<p>I guess you will need to add these:</p>\n\n<pre><code>gem 'rack', '~&gt; 0.9.0'\ngem 'mysql', '2.8.1'\n</code></pre>\n\n<p>Look closely at error messages, if Ruby \u2013 for example \u2013 is complaining about a missing gem with the name <code>foo</code> then look on <a href=\"https://rubygems.org/\" rel=\"nofollow noreferrer\">Rubygems</a> what version of the <code>foo</code> gem was available around 2008-2010 and add <code>gem 'foo', '&lt;version number&gt;'</code> to your <code>Gemfile</code> and run <code>bundle install</code> again.</p>\n\n<p>It is not easy to find all required dependencies this way and it is even harder to find a working set of specific versions. But without further information this is IMHO the best way to start. Good luck!</p>\n"}], "owner": {"reputation": 2942, "user_id": 477340, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a858a54895a4242c16f7f43f92fd343d?s=128&d=identicon&r=PG", "display_name": "khinester", "link": "https://stackoverflow.com/users/477340/khinester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582819390, "creation_date": 1543340431, "last_edit_date": 1543578981, "question_id": 53505250, "link": "https://stackoverflow.com/questions/53505250/running-ruby-1-8-7-in-docker", "title": "running ruby 1.8.7 in docker", "body": "<p>i have inherited a very old app, that was built using ruby 1.8.7 with postgres and i am trying to create a docker image for this.</p>\n\n<p>from this image <a href=\"https://hub.docker.com/r/hublogix/minimal-ruby/\" rel=\"nofollow noreferrer\">https://hub.docker.com/r/hublogix/minimal-ruby/</a>\n i have the app code added to the image.</p>\n\n<p>so now i am inside the image, i can see:</p>\n\n<pre><code>bash-4.3# ls\nCapfile    REVISION   Rakefile   app        config     config.ru  db         doc        lib        public     script     test       tmp        vendor\nbash-4.3#\n\n\nbash-4.3# gem install rake\nFetching: rake-12.3.1.gem (100%)\nERROR:  Error installing rake:\n        rake requires Ruby version &gt;= 2.0.0.\nbash-4.3#\n</code></pre>\n\n<p>config/environment.rb is like:</p>\n\n<pre><code># Be sure to restart your server when you modify this file\n\n# Specifies gem version of Rails to use when vendor/rails is not present\nRAILS_GEM_VERSION = '2.3.16' unless defined? RAILS_GEM_VERSION\n\nAPP_NAME = \"App name\"\n\n# Bootstrap the Rails environment, frameworks, and default configuration\nrequire File.join(File.dirname(__FILE__), 'boot')\n\nRails::Initializer.run do |config|\n\n  config.gem \"inherited_resources\",\n    :source =&gt; \"http://gemcutter.org\",\n    :version =&gt; \"1.0.1\"\n\n  config.gem \"has_scope\",\n    :lib    =&gt; \"has_scope\",\n    :source =&gt; 'http://gemcutter.org',\n    :version =&gt; \"0.4.1\"\n\n  config.gem \"haml\"\n\n  config.gem \"will_paginate\", \n    :lib    =&gt; \"will_paginate\",\n    :source =&gt; \"http://gemcutter.org\"\n\n  config.gem \"searchlogic\",\n    :lib     =&gt; \"searchlogic\",\n    :source  =&gt; \"http://gemcutter.org\",\n    :version =&gt; \"2.4.11\"\n\n  config.gem \"paperclip\",\n    :lib     =&gt; \"paperclip\",\n    :source  =&gt; \"http://gemcutter.org\",\n    :version =&gt; \"2.3.1.1\"\n\n  config.gem \"clearance\",\n    :lib     =&gt; \"clearance\",\n    :source  =&gt; \"http://gemcutter.org\",\n    :version =&gt; \"0.8.8\"\n\n  config.gem \"rsl-stringex\",\n    :lib     =&gt; \"stringex\",\n    :source  =&gt; \"http://gems.github.com\",\n    :version =&gt; \"1.0.3\"\n\n  config.gem 'formtastic',\n    :lib     =&gt; \"formtastic\",\n    :version =&gt; \"0.9.7\"\n\n  config.gem \"acts_as_audited\",\n    :lib     =&gt; \"acts_as_audited\",\n    :version =&gt; \"1.1.0\"\n\n  config.gem \"prawn\",\n    :version =&gt; \"0.8.4\"\n\n  config.gem \"htmlentities\",\n    :version =&gt; \"4.2.0\"\n\n  config.gem \"emap_single_sign_on\"\n\n  config.gem \"rmagick\",\n    :lib =&gt; \"RMagick\"\n\n  config.load_paths += %W( #{Rails.root}/app/mailers #{Rails.root}/app/observers #{Rails.root}/app/sweepers )\n  config.load_paths += %W( #{Rails.root}/app/presenters #{Rails.root}/app/reports)\n\n  config.frameworks -= [ :active_resource ]\n\n  # config.active_record.observers = :name\n\n  config.time_zone = 'UTC'\n\nend\n\nGOOGLE_ANALYTICS_TRACKING_CODE = \"\"\n</code></pre>\n\n<p>and when i try to run it i get this error from the container:</p>\n\n<pre><code>/usr/local/lib/ruby/site_ruby/1.8/rubygems.rb:900:in `report_activate_error': Could not find RubyGem rack (~&gt; 1.1.0) (Gem::LoadError)\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems.rb:248:in `activate'\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems.rb:1276:in `gem'\n        from /usr/src/vendor/rails/actionpack/lib/action_controller.rb:34\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n        from /usr/src/vendor/rails/activesupport/lib/active_support/dependencies.rb:182:in `require'\n        from /usr/src/vendor/rails/activesupport/lib/active_support/dependencies.rb:547:in `new_constants_in'\n        from /usr/src/vendor/rails/activesupport/lib/active_support/dependencies.rb:182:in `require'\n        from /usr/src/vendor/rails/railties/lib/commands/server.rb:2\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n        from ./script/server:3\n</code></pre>\n\n<p>depandanices list:</p>\n\n<pre><code>actionmailer (2.3.17)\nactionpack (2.3.17)\nactiverecord (2.3.17)\nactiveresource (2.3.17)\nactivesupport (2.3.17)\nandre-geokit (1.2.5)\nbackup (3.0.25)\nbuilder (3.2.2)\nbundler (1.5.3)\nexcon (0.31.0)\nfastercsv (1.5.5, 1.5.4)\nformatador (0.2.4)\ngeocoder (1.1.9)\nhaml (4.0.5, 2.0.9)\njson (1.8.1)\nmislav-will_paginate (2.3.11)\nmulti_json (1.9.0)\nmysql (2.9.1, 2.8.1)\nnewrelic_rpm (3.7.3.204)\nnokogiri (1.4.2, 1.4.1)\nopen4 (1.3.3)\npuma (2.8.1)\nrack (1.1.6, 1.1.0)\nrails (2.3.17)\nrake (10.1.1)\nrdoc (4.1.1)\nRedCloth (4.2.9)\nright_aws (3.1.0)\nright_http_connection (1.4.0)\nrmagick (2.13.3, 2.13.2)\nrubyist-aasm (2.0.5)\nstringex (1.2.0)\nthor (0.15.4)\nthoughtbot-paperclip (2.2.9.2)\ntilt (2.0.0)\n</code></pre>\n\n<p>i have the vendor folder which has all the dependencies, but i am unclear as to what else i need to do in order to install the base system in docker?</p>\n\n<p>any advice on how to get this app running in docker or get it to build?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1543339015, "post_id": 53504840, "comment_id": 93879228, "body": "postgresql != mysql. Also, that looks more like some sort of wrapper library than a raw query; it&#39;s usually helpful such information in the tags."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 15207, "user_id": 4104224, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1UvuxsNkn9w/AAAAAAAAAAI/AAAAAAAAA10/vjzWlg3BR-U/photo.jpg?sz=128", "display_name": "Uueerdo", "link": "https://stackoverflow.com/users/4104224/uueerdo"}, "edited": false, "score": 0, "creation_date": 1543339504, "post_id": 53504840, "comment_id": 93879475, "body": "topic speaks for itself. I want to gain some attention. I know mysql != postgresql. Some kind of queries are possible in mysql and not possible in postgresql, I added both as Im looking for any answer, concept how to solve it."}, {"owner": {"reputation": 2763, "user_id": 890743, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/cdffc284f976d9d6ccdec0d839d82472?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/890743/eric"}, "edited": false, "score": 0, "creation_date": 1543339939, "post_id": 53504840, "comment_id": 93879712, "body": "MySQL &lt;&gt; Postgres!!!  This doesn&#39;t look like either of the two."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543340026, "post_id": 53504840, "comment_id": 93879765, "body": "Oh thats right. Im looking for concept, its ruby"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1543341021, "post_id": 53504840, "comment_id": 93880280, "body": "Do you want do find foos that have other_model with value &quot;one&quot; AND another other_model with value &quot;two&quot;? In raw sql you can achieve this by joining other_models twice. Off the top of my head, can&#39;t tell how to do this in activerecord"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543341253, "post_id": 53504840, "comment_id": 93880402, "body": "omg, downvoting. People You think you are smart and orginized, Thats why stackoverflow will never change because its about who is right, not problem solving. Thanks Sergio for hint"}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543341991, "post_id": 53504840, "comment_id": 93880844, "body": "in ruby there is merge function but it doesn&#39;t work for me. Yes you have understood me"}], "answers": [{"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543342449, "post_id": 53505694, "comment_id": 93881096, "body": "See <a href=\"https://en.wikipedia.org/wiki/Having_(SQL)\" rel=\"nofollow noreferrer\"><code>HAVING</code></a>. It does basically the same as <code>WHERE</code> but runs after an aggregate function like <code>GROUP BY</code>."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543342689, "post_id": 53505694, "comment_id": 93881233, "body": "why count more or equal 2 ? I will check it right now. Thank you for answer"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543342822, "post_id": 53505694, "comment_id": 93881305, "body": "Because you want to find all <code>foos</code> that have at least two <code>other_models</code> (the one that has <code>value == &#39;one&#39;</code> and the one that has <code>value == &#39;two&#39;</code>."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "edited": false, "score": 0, "creation_date": 1543343947, "post_id": 53505694, "comment_id": 93881906, "body": "thank you, its seems it worked ! but I need to test it to figure it out if it really works"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1543342217, "creation_date": 1543342217, "answer_id": 53505694, "question_id": 53504840, "link": "https://stackoverflow.com/questions/53504840/combine-2-results-in-one-in-sql/53505694#53505694", "title": "Combine 2 results in one in SQL", "body": "<p>I think you are looking for a query like:</p>\n\n<pre><code>Foo\n  .joins(:other_model)\n  .where('other_model.value = ? OR other_model.value = ?', 'one', 'two') \n  .group('foos.id')\n  .having('COUNT(other_models.id) &gt;= 2')\n</code></pre>\n"}], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53505694, "answer_count": 1, "score": -2, "last_activity_date": 1543342392, "creation_date": 1543338856, "last_edit_date": 1543342392, "question_id": 53504840, "link": "https://stackoverflow.com/questions/53504840/combine-2-results-in-one-in-sql", "title": "Combine 2 results in one in SQL", "body": "<p><strong>Update</strong> merge</p>\n\n<pre><code>Cama::PostType.first.posts.joins(:custom_field_values)\n.where(\"cama_custom_fields_relationships.custom_field_slug = ? AND \ncama_custom_fields_relationships.value LIKE ?\",\"localization\", \n\"%Paris%\").merge(Cama::PostType.first.posts.joins(:custom_field_values)\n.where(\"cama_custom_fields_relationships.custom_field_slug = ? AND \ncama_custom_fields_relationships.value = ?\",\"type-localization\", \"2\"))\n</code></pre>\n\n<p>This also doesnt work. When executed seperatelty, it returns same AssociationRelation. I guess it only works for ActiveRecord:Relation</p>\n\n<p><strong>Update</strong>\nI think Im looking for INTERSECT but don't know how to use it with where</p>\n\n<p>There is another topic that I created and still can't find answer how to optimize it.</p>\n\n<p>It goes likes this</p>\n\n<p>I need to find \"posts\" by \"other_model\" values.  Other model has relationship with posts throught another table but lets keep it simple. When i do</p>\n\n<pre><code>Foo.joins(:other_model).where(\"other_model.value = ? AND other_model.value = ?\", \"one\", \"two\") \n</code></pre>\n\n<p>This of course won't find me any result because it contradicts itself.</p>\n\n<p>When I do with OR instead of AND</p>\n\n<pre><code>Foo.joins(:other_model).where(\"other_model.value = ? OR other_model.value = ?\", \"one\", \"two\") \n</code></pre>\n\n<p>It finds posts for me but... either it has one value or either has second value and...</p>\n\n<p><strong>I want to find posts based on other_model.value = one and other_model.value = two</strong> </p>\n\n<p>Which means it looks for 2 seperate results and then I need to just return ids that covers each other... Does it make sense ?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "loops", "erb"], "comments": [{"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 1, "creation_date": 1543332753, "post_id": 53502084, "comment_id": 93875318, "body": "since you&#39;re new, you&#39;d probably want to read up on html elements because your issue can be fixed in a lot of ways, eg using <code>span</code> instead of <code>p</code>, or changing the styling of <code>p</code> to <code>display:inline</code>.  <a href=\"https://www.w3schools.com/tags/tag_p.asp\" rel=\"nofollow noreferrer\">w3schools.com/tags/tag_p.asp</a> Also google for block vs inline html elements."}], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 7431246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154943107064592/picture?type=large", "display_name": "Ofir Sasson", "link": "https://stackoverflow.com/users/7431246/ofir-sasson"}, "edited": false, "score": 0, "creation_date": 1543329763, "post_id": 53502109, "comment_id": 93873462, "body": "it worked but I have a &#39;,&#39; at the end like that: name1, name2, name3, and I don&#39;t want the last &#39;,&#39; how can I remove it through code?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 525, "user_id": 7431246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154943107064592/picture?type=large", "display_name": "Ofir Sasson", "link": "https://stackoverflow.com/users/7431246/ofir-sasson"}, "edited": false, "score": 1, "creation_date": 1543329940, "post_id": 53502109, "comment_id": 93873589, "body": "@OfirSasson if the code above leaves an empty comma at the end, it means that your last name is either an empty string (<code>&quot;&quot;</code>) or a <code>nil</code>."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1543329769, "last_edit_date": 1543329769, "creation_date": 1543329586, "answer_id": 53502109, "question_id": 53502084, "link": "https://stackoverflow.com/questions/53502084/ruby-on-rails-print-element-of-array-in-a-single-line-in-html-erb-file/53502109#53502109", "title": "Ruby on Rails: Print element of array in a single line in html.erb file", "body": "<p>Doesn't something like this work?, just join them, leaving them inside the paragraph tag:</p>\n\n<pre><code>&lt;p class=\"center\"&gt;\n  &lt;%= @names_array.join(', ') %&gt;\n&lt;/p&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "is_accepted": false, "score": 4, "last_activity_date": 1543351809, "last_edit_date": 1543351809, "creation_date": 1543334208, "answer_id": 53503474, "question_id": 53502084, "link": "https://stackoverflow.com/questions/53502084/ruby-on-rails-print-element-of-array-in-a-single-line-in-html-erb-file/53503474#53503474", "title": "Ruby on Rails: Print element of array in a single line in html.erb file", "body": "<p>You can use Active Support's <code>to_sentence</code> method. Example:</p>\n\n<pre><code>names = ['name1', 'name2', 'name3']\n\nirb(main):001:0&gt; names = ['name1', 'name2', 'name3']\n=&gt; [\"name1\", \"name2\", \"name3\"]\n\nirb(main):002:0&gt; names.to_sentence\n=&gt; \"name1, name2 and name3\"\n</code></pre>\n\n<p>You can modify the last connector passing a word option:</p>\n\n<pre><code>irb(main):003:0&gt; names.to_sentence(last_word_connector: ', ')\n=&gt; \"name1, name2, name3\"\n</code></pre>\n\n<p>Check the <a href=\"https://apidock.com/rails/ActiveSupport/CoreExtensions/Array/Conversions/to_sentence\" rel=\"nofollow noreferrer\">documentation</a></p>\n"}], "owner": {"reputation": 525, "user_id": 7431246, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154943107064592/picture?type=large", "display_name": "Ofir Sasson", "link": "https://stackoverflow.com/users/7431246/ofir-sasson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 53502109, "answer_count": 2, "score": 1, "last_activity_date": 1543351809, "creation_date": 1543329492, "last_edit_date": 1543340681, "question_id": 53502084, "link": "https://stackoverflow.com/questions/53502084/ruby-on-rails-print-element-of-array-in-a-single-line-in-html-erb-file", "title": "Ruby on Rails: Print element of array in a single line in html.erb file", "body": "<p>I'm new to html.erb files and I didn't find an answer to my problem.\nI have array of names and I'm trying to print them in a paragraph tag <code>&lt;p&gt;</code> in one line with ',' like that:</p>\n\n<pre><code>name1, name2, name3\n</code></pre>\n\n<p>But instead I get this:</p>\n\n<pre><code>name1,\nname2,\n</code></pre>\n\n<p>This is the code:</p>\n\n<pre><code>&lt;% @names_array.each do |name| %&gt;\n  &lt;p class=\"center\"&gt;&lt;%= name %&gt;,&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cloudinary", "seed"], "comments": [{"owner": {"reputation": 598, "user_id": 1019579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a3iQz.jpg?s=128&g=1", "display_name": "bsvin33t", "link": "https://stackoverflow.com/users/1019579/bsvin33t"}, "edited": false, "score": 0, "creation_date": 1543403136, "post_id": 53501852, "comment_id": 93904620, "body": "can you check the validations on <code>Vacancy</code> model?  <code>create!</code> usually raises error if the validations fail"}, {"owner": {"reputation": 1841, "user_id": 2433909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5gIQe.jpg?s=128&g=1", "display_name": "Itay Taragano", "link": "https://stackoverflow.com/users/2433909/itay-taragano"}, "edited": false, "score": 0, "creation_date": 1543426613, "post_id": 53501852, "comment_id": 93919154, "body": "There&#39;s a typo in the in one line I believe. It should be: <code>photo = &quot;#{resource_type}&#47;#{type}&#47;v#{version}&#47;#{public_id}.#{format}&zwnj;&#8203;##{signature}&quot;</code>. Let me know if that works?"}, {"owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "edited": false, "score": 0, "creation_date": 1543565872, "post_id": 53501852, "comment_id": 93972823, "body": "This was it -  Thanks so much for the quick help!"}], "owner": {"reputation": 113, "user_id": 10075876, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7d3Chl5TZo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7obE-kTGcNuqf5tWp6sQ3RBQUo5dA/mo/photo.jpg?sz=128", "display_name": "Sabrina", "link": "https://stackoverflow.com/users/10075876/sabrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543328701, "creation_date": 1543328701, "question_id": 53501852, "link": "https://stackoverflow.com/questions/53501852/cannot-set-photo-url-of-seeds-in-rails-app-using-cloudinary-gem", "title": "Cannot set photo url of seeds in rails app using cloudinary gem", "body": "<p>I coded a job platform with rails and when you add a new job, you can upload a photo (the logo of the company). I used cloudinary and everything is working fine.</p>\n\n<p>But now I coded a scraper in my seed file.\nIt scrapes a job site for jobs.</p>\n\n<p>But when I set:\nJob.create(title: job_title, description: job_description, photo: \"image/upload/qwxcsitnlxzbjvannpbm\")</p>\n\n<p>the job is created but the photo ist nil.</p>\n\n<p>I now found that it does not work this way as with cloudinary the parameters need to be verified. </p>\n\n<p>I found this thread that explains the problem:\n<a href=\"https://stackoverflow.com/questions/51163036/seed-cloudinary-photos-for-rails-app\">seed cloudinary photos for rails app</a></p>\n\n<p>But when I follow the first solution, the job (or vacancy as I call it) is still nil:</p>\n\n<pre><code>resource_type = \"image\"\n  type = \"upload\"\n  version = 1234567890\n  public_id = \"wv7l1o6xwimtfvx2oxdw\"\n  format = \"jpg\"\n  signature = Cloudinary::Utils.api_sign_request({:public_id=&gt;public_id,\n  :version=&gt;version}, Cloudinary.config.api_secret)\n  photo = \"#{resource_type}/#{type}/v#{version}/#{public_id}.#{format}## .\n  {signature}\"\n  Vacancy.create(title: job_title, companyname: 'Lillydoo', jobdescription: job_description, photo: photo)\n</code></pre>\n\n<p>when I follow the second solution, I get the error \"TypeError: no implicit conversion of nil into String\"</p>\n\n<p>here is the second code:</p>\n\n<pre><code>Vacancy.create!({ photo: open(\"https://res.cloudinary.com/dfom3nog0/image/upload/v1543327271/qwxcsitnlxzbjvannpbm.png\") })\n</code></pre>\n\n<p>Hope someone can help me find an easy way to solve this! Thank you in advance.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "docker", "aws-codebuild"], "comments": [{"owner": {"reputation": 182, "user_id": 367713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bdf089329550549bebc54a4610011af?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/367713/paul"}, "edited": false, "score": 0, "creation_date": 1546606801, "post_id": 53501834, "comment_id": 94913910, "body": "Did you end up finding a solution for this? I&#39;m running into a similar issue when trying to mount a locally created directory through docker compose and get denied permission to write to it from the container"}, {"owner": {"reputation": 399, "user_id": 1348329, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/499d49e7a2244ddd0533b25f1d497d2b?s=128&d=identicon&r=PG", "display_name": "Constantine", "link": "https://stackoverflow.com/users/1348329/constantine"}, "reply_to_user": {"reputation": 182, "user_id": 367713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bdf089329550549bebc54a4610011af?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/367713/paul"}, "edited": false, "score": 0, "creation_date": 1548426845, "post_id": 53501834, "comment_id": 95548500, "body": "@Paul unfortunately no. The file was not critical to my application so I wound up removing it. It is driving me crazy so if you do find an answer can you please post it here if you don;&#39;t mind."}, {"owner": {"reputation": 182, "user_id": 367713, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bdf089329550549bebc54a4610011af?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/367713/paul"}, "edited": false, "score": 0, "creation_date": 1548548323, "post_id": 53501834, "comment_id": 95580907, "body": "I myself found a work around and ended up copying all the files I needed from the container after the job had finished running and the container was stopped using <a href=\"https://docs.docker.com/engine/reference/commandline/cp/\" rel=\"nofollow noreferrer\">docker cp</a>. Not sure that&#39;s something that would solve your problem too"}], "owner": {"reputation": 399, "user_id": 1348329, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/499d49e7a2244ddd0533b25f1d497d2b?s=128&d=identicon&r=PG", "display_name": "Constantine", "link": "https://stackoverflow.com/users/1348329/constantine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1543338747, "creation_date": 1543328652, "last_edit_date": 1543338747, "question_id": 53501834, "link": "https://stackoverflow.com/questions/53501834/docker-permissions-are-different-when-running-on-codebuild", "title": "Docker permissions are different when running on CodeBuild", "body": "<p>I am using <code>ruby:2.5.1-alpine</code> for my application's container image. When I run <code>make release</code> locally, which runs the following commands:</p>\n\n<pre><code>docker-compose build --pull release\ndocker-compose up --abort-on-container-exit test\n</code></pre>\n\n<p>The test stage runs the migrations, linter and specs. It runs without an issues. When I run the same exact command on CodeBuild which is using a <code>aws/codebuild/ruby:2.5.1</code> as the host environment I get the following error:</p>\n\n<pre><code>Running RuboCop...\nInspecting 82 files\n.................................................................................W\n Offenses:\n bin/console:1:1: W: Lint/ScriptPermission: Script file console doesn't have execute permission.\n</code></pre>\n\n<p>I checked the git permissions and everything looks kosher:</p>\n\n<pre><code>edit [...master ] git ls-tree HEAD bin/\n100755 blob ad9a02fe6ed489beb105295de771cab5fa87a6af    bin/console\n100755 blob 9d87e9579b9c16c42d65301e8540888e044ba25d    bin/run\n100755 blob cf5febb7c6dd34aebdb862792fa147d06a9c5764    bin/setup\nedit [...master ]\n</code></pre>\n\n<p>I added a debug statement to see what the permissions are at the time of the tests running and here is where it diverges. </p>\n\n<p>Locally I get:</p>\n\n<pre><code>test_1_4d039799a73c | File permissions for bin/console are \n#&lt;File::Stat ino=10432530, **mode=0100755**, nlink=1, uid=1000, gid=1000,...&gt;\n</code></pre>\n\n<p>And On the CodeBuild server I get:</p>\n\n<pre><code>File permissions for bin/console are \n#&lt;File::Stat  ino=525319, **mode=0100666**, nlink=1, uid=0, gid=0, ...&gt;\n</code></pre>\n\n<p>As I pasted the above I also noticed that the UID and the GID are different. So it looks like the permissions are not being set correctly:</p>\n\n<pre><code>RUN addgroup -g 1000 app &amp;&amp; adduser -u 1000 -G app -D app\nRUN chown -R app:app $APP_ROOT\n\nWORKDIR $APP_ROOT\n</code></pre>\n\n<p>This was part of the issue:</p>\n\n<p><a href=\"https://forums.docker.com/t/not-able-to-change-permissions-for-files-and-folders-created-on-mounted-volumes/45769\" rel=\"nofollow noreferrer\">https://forums.docker.com/t/not-able-to-change-permissions-for-files-and-folders-created-on-mounted-volumes/45769</a></p>\n\n<p>After removing the volume for the stage that runs on CodeBuild the mid and gig are correct but the permissions themselves are still off.</p>\n\n<pre><code> \u00b7[36mcodebuild_1 |\u00b7[0m File permissions for bin/console are \n #&lt;File::Stat ino=2755035, mode=0100666, nlink=1, uid=1000, gid=1000...&gt;\n</code></pre>\n\n<p>Not sure how to go about debugging this. </p>\n"}, {"tags": ["ruby", "firebird"], "comments": [{"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1543330429, "post_id": 53500616, "comment_id": 93873911, "body": "Have you tried using parameters instead?"}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 0, "creation_date": 1543392290, "post_id": 53500616, "comment_id": 93898384, "body": "you have to use parameters: <a href=\"http://bobby-tables.com\" rel=\"nofollow noreferrer\">bobby-tables.com</a>"}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 0, "creation_date": 1543392435, "post_id": 53500616, "comment_id": 93898452, "body": "Here is how it looks on Ruby: <a href=\"https://stackoverflow.com/a/10181301/976391\">stackoverflow.com/a/10181301/976391</a>"}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543392664, "post_id": 53500616, "comment_id": 93898557, "body": "@engineersmnky that is not a good way to do it: there is another maximum limit on the statement length in whole. You would trade one limit for another. In brief, one should not pass data as text literals, stressing SQL parser, inflating traffic and opening possibilities for errors like type mismatches and SQL injections. Program is program and data is data. SQL request is program, ideally it is to be compiled once and then executed against different - and type-checked - data. That is what SQL query preparation and data parameters are for."}, {"owner": {"reputation": 311, "user_id": 4464659, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001913404106/picture?type=large", "display_name": "Konstantin Streletsky", "link": "https://stackoverflow.com/users/4464659/konstantin-streletsky"}, "edited": false, "score": 0, "creation_date": 1543401539, "post_id": 53500616, "comment_id": 93903676, "body": "for firebird 2.5 blob fields there&#39;s no limit for 16Kb  UTF8 chars (read this man <a href=\"https://firebirdsql.org/file/documentation/reference_manuals/fblangref25-en/html/fblangref25-datatypes-bnrytypes.html\" rel=\"nofollow noreferrer\">firebirdsql.org/file/documentation/reference_manuals/&hellip;</a>)  it&#39;s just segment size . limit for firebird blob filed in Unicode is near  2^30 chars (<a href=\"https://firebirdsql.org/manual/migration-mssql-data-types.html\" rel=\"nofollow noreferrer\">firebirdsql.org/manual/migration-mssql-data-types.html</a>) I&#39;ve successfully tested your update statement with Ibexpert  for this structure   CREATE TABLE TABLE_WITH_JSON_STRING_FIELD (     ID          INTEGER NOT NULL,     JSON_FIELD  BLOB SUB_TYPE 1 SEGMENT SIZE 32762 CHARACTER SET UTF8 );"}, {"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 0, "creation_date": 1543411924, "post_id": 53500616, "comment_id": 93909811, "body": "In Rails I call the update with the update_attributes method <code>obj.update_attributes(patient_json: string)</code> And this creates the update statement above.Should I call a different method to get past this limitation?"}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 0, "creation_date": 1543419609, "post_id": 53500616, "comment_id": 93914935, "body": "that is a question of Ruby libraries used there in stack, their capabilities, etc. There are examples on B.T. site but I don&#39;t know if they are about your libraries or some other Ruby libs. Proper SQL way - both safer and faster - is not making ad hoc brand new SQL text request every now and then, but making a &quot;standard&quot; query for a typical change, preparing it once and forever, and then just refilling parameters data without changing and re-compiling the query itself. In one my legacy app the speedup seemed like 2-3 times. I don&#39;t know if the libs you choose in Ruby are capable of it or not."}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 1, "creation_date": 1543420089, "post_id": 53500616, "comment_id": 93915292, "body": "you can also save JSON ZIP or JSON GZ, not plain text JSON. It would push the limit to a degree, unless it would be zip/gz binary data size, that would exceed sting HEX literal max length. Still, using literals for arbitrary length data is not lucky choice, even if would to a degree stretch the limits, but then storing packed texts instead of redundant JSON would perhaps be better for both disk I/O and database file size even when you later would switch to using parameters."}, {"owner": {"reputation": 14940, "user_id": 976391, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a20cdd68e2d66033d22408a925a5761a?s=128&d=identicon&r=PG", "display_name": "Arioch &#39;The", "link": "https://stackoverflow.com/users/976391/arioch-the"}, "edited": false, "score": 0, "creation_date": 1543420162, "post_id": 53500616, "comment_id": 93915341, "body": "Check this also: <a href=\"https://github.com/petdance/bobby-tables/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+is%3Aopen+ruby\" rel=\"nofollow noreferrer\">github.com/petdance/bobby-tables/&hellip;</a>"}, {"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "reply_to_user": {"reputation": 311, "user_id": 4464659, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001913404106/picture?type=large", "display_name": "Konstantin Streletsky", "link": "https://stackoverflow.com/users/4464659/konstantin-streletsky"}, "edited": false, "score": 0, "creation_date": 1543424444, "post_id": 53500616, "comment_id": 93917959, "body": "@KonstantinStreletsky The problem here is that the driver used will not populate a blob itself, but instead produces a literal string with the value to leave populating the blob to Firebird. String literals have a limited size (iirc 64KB in Firebird 3, which limits it to 16383 characters UTF8). Also note that segment sizes are irrelevant for most applications of Firebird; they are a historical holdover that are (or: should be) only relevant for applications using embedded SQL using GPRE."}, {"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 0, "creation_date": 1543424806, "post_id": 53500616, "comment_id": 93918157, "body": "Shimu, I think you hit an implementation gotcha of the driver you&#39;re using. You might want to ask the maintainer of that driver to find out if there is another way or not."}, {"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 0, "creation_date": 1543473350, "post_id": 53500616, "comment_id": 93934003, "body": "Thanks for all the hints. I ended up zipping the string and sending the data this way. I know, I won&#39;t be safe for ever, but I am reasonable far away from the limits for now. A short question though: Where can I find some docu about parameterized statements? A link would be nice :-)"}], "owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543324638, "creation_date": 1543324638, "question_id": 53500616, "link": "https://stackoverflow.com/questions/53500616/firebird-cant-save-to-blob-column-because-string-literal-too-big", "title": "Firebird can&#39;t save to blob column because string literal too big", "body": "<p>I have a table that save various input from users. In one column we write a giant json string produced a step by step wizard. This column is defined as a blob sub_type 1 with the utf-8 charset.  </p>\n\n<p>Now I when I want to save the last step I get this error:</p>\n\n<blockquote>\n  <p>String literal with 16538 characters exceeds the maximum length of 16383 characters for the UTF8 character set </p>\n</blockquote>\n\n<p>This happens online with my Rails server and also with my db admin tool (DBeaver).</p>\n\n<p>According to <a href=\"http://firebird.1100200.n4.nabble.com/Maximum-length-of-string-literals-td4640262.html\" rel=\"nofollow noreferrer\">this Link</a> there is a max length of a string literal. How do I save a string longer than this limit in a blob field?</p>\n\n<p>This would be the statement:</p>\n\n<pre><code>UPDATE \"TABLE_WITH_JSON_STRING_FIELD\" SET\n    \"JSON_FIELD\" = '{\"allgemeine_fragen\":{\"vorname\":\"John\",\"nachname\":\"Smith\",\"geburtstag\":\"01.01.1900\",\"telefon\":\"0049 123 456 789 0\",\"email\":\"test@tst.com\",\"anzahl_kinder\":\"\",\"beruf\":\"\",\"groesse_cm\":\"\",\"groesse_ft_in\":\"\",\"gewicht_kg\":\"\",\"gewicht_lb\":\"\",\"bmi\":\"\",\"kur\":[{\"jahr\":\"Jul 2015\",\"klinikname\":\"test\",\"ort\":\"baden baden\"},{\"jahr\":\"May 2013\",\"klinikname\":\"test 2\",\"ort\":\"test 2\"}],\"hobbies\":\"\",\"im_ruhestand\":\"0\"},\"familienanamnese\":{\"vater_sonstiges\":\"\",\"vater_anderes_karzinom\":\"\",\"brueder_sonstiges\":\"\",\"brueder_anderes_karzinom\":\"\",\"sonstige_verwandte_sonstiges\":\"\",\"sonstige_verwandte_anderes_karzinom\":\"\",\"mutter_sonstiges\":\"\",\"mutter_anderes_karzinom\":\"\",\"schwestern_sonstiges\":\"\",\"schwestern_anderes_karzinom\":\"\",\"vater_schlaganfall\":\"0\",\"vater_herzinfarkt\":\"0\",\"vater_koronare_herzerkrankung\":\"0\",\"vater_diabetes\":\"0\",\"vater_bluthochdruck\":\"0\",\"vater_darmerkrankungen\":\"0\",\"vater_adipositas_fettleibigkeit\":\"0\",\"vater_erhoehte_fettwerte\":\"0\",\"vater_psych_erkrankung\":\"0\",\"vater_alzheimer_demenz\":\"0\",\"vater_thrombose_lungenembolie\":\"0\",\"vater_osteoporose\":\"0\",\"vater_blasenkarzinom\":\"0\",\"vater_lungenkarzinom\":\"0\",\"vater_dickdarmkarzinom\":\"0\",\"vater_melanom\":\"0\",\"vater_prostatakarzinom\":\"0\",\"vater_hodenkarzinom\":\"0\",\"brueder_schlaganfall\":\"0\",\"brueder_herzinfarkt\":\"0\",\"brueder_koronare_herzerkrankung\":\"0\",\"brueder_diabetes\":\"0\",\"brueder_bluthochdruck\":\"0\",\"brueder_darmerkrankungen\":\"0\",\"brueder_adipositas_fettleibigkeit\":\"0\",\"brueder_erhoehte_fettwerte\":\"0\",\"brueder_psych_erkrankung\":\"0\",\"brueder_alzheimer_demenz\":\"0\",\"brueder_thrombose_lungenembolie\":\"0\",\"brueder_osteoporose\":\"0\",\"brueder_blasenkarzinom\":\"0\",\"brueder_lungenkarzinom\":\"0\",\"brueder_dickdarmkarzinom\":\"0\",\"brueder_melanom\":\"0\",\"brueder_prostatakarzinom\":\"0\",\"brueder_hodenkarzinom\":\"0\",\"sonstige_verwandte_schlaganfall\":\"0\",\"sonstige_verwandte_herzinfarkt\":\"0\",\"sonstige_verwandte_koronare_herzerkrankung\":\"0\",\"sonstige_verwandte_diabetes\":\"0\",\"sonstige_verwandte_bluthochdruck\":\"0\",\"sonstige_verwandte_darmerkrankungen\":\"0\",\"sonstige_verwandte_adipositas_fettleibigkeit\":\"0\",\"sonstige_verwandte_erhoehte_fettwerte\":\"0\",\"sonstige_verwandte_psych_erkrankung\":\"0\",\"sonstige_verwandte_alzheimer_demenz\":\"0\",\"sonstige_verwandte_thrombose_lungenembolie\":\"0\",\"sonstige_verwandte_osteoporose\":\"0\",\"sonstige_verwandte_blasenkarzinom\":\"0\",\"sonstige_verwandte_lungenkarzinom\":\"0\",\"sonstige_verwandte_dickdarmkarzinom\":\"0\",\"sonstige_verwandte_melanom\":\"0\",\"sonstige_verwandte_prostatakarzinom\":\"0\",\"sonstige_verwandte_hodenkarzinom\":\"0\",\"sonstige_verwandte_mammakarzinom\":\"0\",\"sonstige_verwandte_ovarialkarzinom\":\"0\",\"sonstige_verwandte_zervixkarzinom\":\"0\",\"mutter_schlaganfall\":\"0\",\"mutter_herzinfarkt\":\"0\",\"mutter_koronare_herzerkrankung\":\"0\",\"mutter_diabetes\":\"0\",\"mutter_bluthochdruck\":\"0\",\"mutter_darmerkrankungen\":\"0\",\"mutter_adipositas_fettleibigkeit\":\"0\",\"mutter_erhoehte_fettwerte\":\"0\",\"mutter_psych_erkrankung\":\"0\",\"mutter_alzheimer_demenz\":\"0\",\"mutter_thrombose_lungenembolie\":\"0\",\"mutter_osteoporose\":\"0\",\"mutter_blasenkarzinom\":\"0\",\"mutter_lungenkarzinom\":\"0\",\"mutter_dickdarmkarzinom\":\"0\",\"mutter_melanom\":\"0\",\"mutter_mammakarzinom\":\"0\",\"mutter_ovarialkarzinom\":\"0\",\"mutter_zervixkarzinom\":\"0\",\"schwestern_schlaganfall\":\"0\",\"schwestern_herzinfarkt\":\"0\",\"schwestern_koronare_herzerkrankung\":\"0\",\"schwestern_diabetes\":\"0\",\"schwestern_bluthochdruck\":\"0\",\"schwestern_darmerkrankungen\":\"0\",\"schwestern_adipositas_fettleibigkeit\":\"0\",\"schwestern_erhoehte_fettwerte\":\"0\",\"schwestern_psych_erkrankung\":\"0\",\"schwestern_alzheimer_demenz\":\"0\",\"schwestern_thrombose_lungenembolie\":\"0\",\"schwestern_osteoporose\":\"0\",\"schwestern_blasenkarzinom\":\"0\",\"schwestern_lungenkarzinom\":\"0\",\"schwestern_dickdarmkarzinom\":\"0\",\"schwestern_melanom\":\"0\",\"schwestern_mammakarzinom\":\"0\",\"schwestern_ovarialkarzinom\":\"0\",\"schwestern_zervixkarzinom\":\"0\"},\"medikamente_supplemente\":{\"medikament\":[{\"name\":\"\",\"dosierung\":\"\",\"morgens\":\"\",\"mittags\":\"\",\"abends\":\"\",\"nachts\":\"\",\"beibedarf\":\"\",\"seitwann\":\"\"}],\"supplement\":[{\"name\":\"\",\"dosierung\":\"\",\"morgens\":\"\",\"mittags\":\"\",\"abends\":\"\",\"nachts\":\"\",\"beibedarf\":\"\",\"seitwann\":\"\"}]},\"allergien_unvertraeglichkeiten\":{\"unvertraeglichkeiten_nahrung_sonstige\":\"\",\"umweltallergene_sonstige\":\"\",\"medikamentenallergie\":\"\",\"unvertraeglichkeiten_sonstige\":\"\",\"medikamentenallergie_ja\":\"0\"},\"ernaehrungsanamnese\":{\"trinkverhalten_alkohol_name\":\"\",\"trinkverhalten_trinken_sonstiges_name\":\"\",\"ernaehrungsprofil_fruehstueck_was\":\"\",\"ernaehrungsprofil_mittagessen_was\":\"\",\"ernaehrungsprofil_abendessen_was\":\"\",\"ernaehrungsprofil_zwischenmahlzeiten_was\":\"\",\"ernaehrungsanamnese_bemerkungen\":\"\",\"rauchverhalten_rauchen_beginn\":\"\",\"rauchverhalten_rauchen_ende\":\"\",\"rauchverhalten_rauchen_zigaretten_tag\":\"\",\"rauchverhalten_rauchen_packyears\":\"\",\"sucht_sonstiges\":\"\",\"rauchverhalten_rauchen_zigaretten\":\"0\",\"rauchverhalten_rauchen_e_zigarette\":\"0\",\"rauchverhalten_rauchen_pfeife\":\"0\",\"rauchverhalten_rauchen_zigarre\":\"0\",\"rauchverhalten_rauchen_shisha\":\"0\",\"sucht_alkohol\":\"0\",\"sucht_medikamente\":\"0\",\"sucht_drogen\":\"0\",\"ernaehrungsberatung_gewuenscht\":null},\"darmgesundheit\":{\"darm_diagnosen_sonstiges\":\"\",\"stuhlgang_rhythmus_pro_tag\":\"\",\"stuhlgang_rhythmus_pro_woche\":\"\",\"darm_beschwerden_symptome_sonstige\":\"\",\"darmgesundheit_bemerkungen\":\"\",\"gastroskopie_jahr\":\"\",\"gastroskopie_wiederholung_geplant\":\"\",\"gastroskopie_befund\":\"\",\"koloskopie_jahr\":\"\",\"koloskopie_wiederholung_geplant\":\"\",\"koloskopie_befund\":\"\",\"kapselendoskopie_jahr\":\"\",\"kapselendoskopie_wiederholung_geplant\":\"\",\"kapselendoskopie_befund\":\"\",\"sonographie_abdomens_jahr\":\"\",\"sonographie_abdomens_wiederholung_geplant\":\"\",\"sonographie_abdomens_befund\":\"\",\"darmgesundheit_op_therapie\":[{\"jahr\":\"\",\"klinik\":\"\",\"behandlung\":\"\"}],\"helicobacter\":\"0\",\"reflux\":\"0\",\"refluxoesophagitis\":\"0\",\"gastritis\":\"0\",\"morbus_crohn\":\"0\",\"colitis_ulcerosa\":\"0\",\"diverticulitis\":\"0\",\"haemorrhoiden\":\"0\",\"koloskopie_gewuenscht\":null,\"gastroskopie_gewuenscht\":null,\"kapselendoskopie_gewuenscht\":null,\"sonographie_abdomens_gewuenscht\":null},\"herzkreislaufmedizin\":{\"hypotonie_seit\":\"\",\"bluthochdruck_seit\":\"\",\"herzinfarkt_wann\":\"\",\"herzinfarkt_wo\":\"\",\"herzinfarkt_befund\":\"\",\"herzkreislauf_diagnosen_sonstiges\":\"\",\"herzkreislauf_weitere_beschwerden_symptome\":\"\",\"herzkreislaufmedizin_bemerkungen\":\"\",\"kardiocheck_wann\":\"\",\"blutdruck\":[{\"datum\":\"\",\"morgens\":\"\",\"mittags\":\"\",\"abends\":\"\"}],\"kardio_ct_wann\":\"\",\"kardio_ct_wo\":\"\",\"kardio_ct_befund\":\"\",\"herzkreislauf_sonstige_diagnostik\":\"\",\"bypass_operation_wann\":\"\",\"bypass_operation_wo\":\"\",\"bypass_operation_befund\":\"\",\"klappen_operation_wann\":\"\",\"klappen_operation_wo\":\"\",\"klappen_operation_befund\":\"\",\"herzkatheter_wann\":\"\",\"herzkatheter_wo\":\"\",\"herzkatheter_befund\":\"\",\"herzkreislauf_op_therapie\":[{\"jahr\":\"\",\"klinik\":\"\",\"behandlung\":\"\"}],\"hypotonie\":\"0\",\"bluthochdruck\":\"0\",\"koronare_herzkrankheit\":\"0\",\"herzinsuffizienz\":\"0\",\"synkope\":\"0\",\"trombose_lungenembolie\":\"0\",\"vorhofflimmern\":\"0\",\"herzrhythmusstoerungen\":\"0\",\"pavk\":\"0\",\"herzinfarkt\":\"0\",\"beschwerde_herzstolpern_rhythmusstoerungen\":\"0\",\"beschwerde_luftnot_bei_belastung\":\"0\",\"luftnot_in_ruhe\":\"0\",\"beschwerde_angina_pectoris\":\"0\",\"schwindel\":\"0\",\"geschwollene_beine\":\"0\",\"kardiocheck\":\"0\",\"kardio_ct\":\"0\",\"bypass_operation\":\"0\",\"klappen_operation\":\"0\",\"herzkatheter\":\"0\",\"stent\":\"0\",\"herzschrittmacher\":\"0\",\"kardio_check_gewuenscht\":null},\"stoffwechsel\":{\"stoffwechsel_beschwerden_symptome\":\"\",\"stoffwechsel_bemerkungen\":\"\",\"sono_schilddr\u00fcse_jahr\":\"\",\"sono_schilddr\u00fcse_wiederholung_geplant\":\"\",\"sono_schilddr\u00fcse_befund\":\"\",\"stoffwechsel_diagnostik\":\"\",\"stoffwechsel_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"diabetes_typ_1\":\"0\",\"diabetes_typ_2\":\"0\",\"schilddruesenueberfunktion\":\"0\",\"schilddruesenunterfunktion\":\"0\",\"erhoehte_blutfette\":\"0\",\"hypercholesterinaemie\":\"0\",\"hypertriglyceridaemie\":\"0\",\"fettleber\":\"0\",\"sono_schilddruese_gewuenscht\":null},\"augenheilkunde\":{\"augenheilkunde_beschwerden_symptome\":\"\",\"augenheilkunde_bemerkungen\":\"\",\"augenheilkunde_diagnostik\":\"\",\"augenheilkunde_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"diabetische_retinopathie\":\"0\",\"hypertensive_retinopathie\":\"0\",\"erhoehter_augeninnendruck\":\"0\",\"linsentruebung\":\"0\",\"kurzsichtigkeit\":\"0\",\"weitsichtigkeit\":\"0\",\"alterssichtigkeit\":\"0\",\"sehhilfe_brille\":\"0\",\"sehhilfe_linsen\":\"0\",\"augen_vorsorgediagnostik_gewuenscht\":null},\"zahnheilkunde\":{\"zahnheilkunde_diagnosen\":\"\",\"zahnheilkunde_beschwerden_symptome\":\"\",\"zahnheilkunde_bemerkungen\":\"\",\"letzte_zahnaerztliche_kontrolle\":\"\",\"zahnheilkunde_diagnostik\":\"\",\"zahnheilkunde_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"zahnfleischbluten_entzuendungen\":\"0\",\"zaehneknirschen\":\"0\",\"zahnfleischrueckgang\":\"0\",\"problem_kiefergelenk\":\"0\",\"fehlbiss\":\"0\",\"zahnersatz\":\"0\",\"implantate\":\"0\",\"fuellungen\":\"0\",\"fuellung_gold\":\"0\",\"fuellung_amalgam\":\"0\",\"fuellung_kunststoff\":\"0\",\"keramikkronen\":\"0\",\"wurzelbehandlungen\":\"0\",\"zahnregulierungen_kieferorthopaed\":\"0\",\"zahnuntersuchung_gewuenscht\":null,\"prof_zahnreinigung_gewuenscht\":null,\"bleaching_gewuenscht\":null},\"atemwege_hno\":{\"atemwege_hno_beschwerden_symptome\":\"\",\"atemwege_hno_bemerkungen\":\"\",\"atemwege_hno_diagnostik\":\"\",\"atemwege_hno_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"chron_sinusitis_tinnitus\":\"0\",\"copd_chronische_bronchitis\":\"0\",\"asthma_bronchiale\":\"0\",\"schwerhoerigkeit\":\"0\",\"tinnitus\":\"0\",\"halsschmerzen\":\"0\",\"chron_schnupfen\":\"0\",\"geschwollene_lymphknoten\":\"0\",\"riechstoerung\":\"0\",\"schwindel\":\"0\",\"hno_untersuchung_gewuenscht\":null,\"lungen_untersuchung_gewuenscht\":null},\"sportmedizin_orthopaedie\":{\"sport_zeit_pro_woche\":\"\",\"form_bewegung_sport\":\"\",\"schulterschmerzen_sonstiges\":\"\",\"rueckenschmerzen_sonstiges\":\"\",\"tennisellenbogen_text\":\"\",\"hand_sonstiges\":\"\",\"huefte_sonstiges\":\"\",\"knie_sonstiges\":\"\",\"fuesse_einlagen\":\"\",\"mittelfussbruch_ermuedungsbruch\":\"\",\"sprunggelenk_fuesse_sonstiges\":\"\",\"knochenbrueche_wann\":\"\",\"knochenbrueche_lokalisation\":\"\",\"sportunfaelle_wann\":\"\",\"sportunfaelle_therapie\":\"\",\"trainingstherapie_gewunscht_anzahl\":null,\"trainingstherapie_gewunscht_sonstige_text\":null,\"herzkreislaufmedizin_bemerkungen\":\"\",\"aktuelle_beschwerden\":\"\",\"durchgefuehrte_orthop_therapien\":\"\",\"cortison_injektionen_wann\":\"\",\"cortison_injektionen_wo\":\"\",\"stosswellentherapie_wann\":\"\",\"stosswellentherapie_wo\":\"\",\"physiotherapie\":\"\",\"tcm\":\"\",\"med_trainingstherapie\":\"\",\"magnetfeldtherapie\":\"\",\"medikamente\":\"\",\"sonstige\":\"\",\"schulterschmerzen\":\"0\",\"schulter_schleimbeutel\":\"0\",\"schulter_verkalkung\":\"0\",\"schulter_arthrose\":\"0\",\"rueckenschmerzen\":\"0\",\"halswirbelsaeule\":\"0\",\"halswirbelsaeule_bandscheibenvorfall\":\"0\",\"halswirbelsaeule_op\":\"0\",\"brustwirbelsaeule\":\"0\",\"brustwirbelsaeule_bandscheibenvorfall\":\"0\",\"brustwirbelsaeule_op\":\"0\",\"lendenwirbelsaeule\":\"0\",\"lendenwirbelsaeule_bandscheibenvorfall\":\"0\",\"lendenwirbelsaeule_op\":\"0\",\"iliosakralgelenk\":\"0\",\"iliosakralgelenk_bandscheibenvorfall\":\"0\",\"iliosakralgelenk_op\":\"0\",\"tennisellenbogen\":\"0\",\"hand\":\"0\",\"ganglion\":\"0\",\"fingerarthrosen\":\"0\",\"karpaltunnelsyndrom\":\"0\",\"huefte\":\"0\",\"hueftarthrose\":\"0\",\"huefte_schleimbeutel\":\"0\",\"leistenschmerzen\":\"0\",\"knie\":\"0\",\"meniskusschaden\":\"0\",\"knorpelschaeden\":\"0\",\"kreuzbandverletzung\":\"0\",\"kniearthrose\":\"0\",\"kniegelenkserguss\":\"0\",\"sprunggelenk_fuesse\":\"0\",\"sprunggelenk_fuesse_arthrose\":\"0\",\"baenderrisse\":\"0\",\"achillessehnenbeschwerden\":\"0\",\"spreiz_send_plattfuesse\":\"0\",\"fersensporn\":\"0\",\"muskelverletzungen\":\"0\",\"muskelkraempfe\":\"0\",\"sehnenverletzungen\":\"0\",\"knochenbrueche\":\"0\",\"knochenbrueche_op\":\"0\",\"osteoporose\":\"0\",\"rachitis\":\"0\",\"vitamin_d_mangel\":\"0\",\"rheuma\":\"0\",\"sportunfaelle\":\"0\",\"trainingstherapie_gewunscht_fahrrad\":null,\"trainingstherapie_gewunscht_golf\":null,\"trainingstherapie_gewunscht_sonstige\":null,\"cortison_injektionen\":\"0\",\"stosswellentherapie\":\"0\",\"orthopaedische_untersuchung_gewuenscht\":null,\"sportmedizinische_untersuchung_gewuenscht\":null,\"trainingstherapie_gewunscht\":null,\"physiotherapie_gewunscht\":null,\"osteopathie_gewunscht\":null,\"kaeltetherapie_gewuenscht\":null,\"hoehentherapie_gewuenscht\":null,\"trainingstherapie_gewunscht_radio\":null},\"nerven_neurologie\":{\"nerven_neurologie_diagnosen_sonstiges\":\"\",\"nerven_neurologie_beschwerden_symptome\":\"\",\"nerven_neurologie_bemerkungen\":\"\",\"dopplersono_carotiden_jahr\":\"\",\"dopplersono_carotiden_wiederholung_geplant\":\"\",\"dopplersono_carotiden_befund\":\"\",\"nerven_neurologie_diagnostik\":\"\",\"nerven_neurologie_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"schlaganfall\":\"0\",\"polyneuropathie\":\"0\",\"multiple_sklerose\":\"0\",\"morbus_parkinson\":\"0\",\"demenz\":\"0\",\"migraene\":\"0\",\"kopfschmerzen\":\"0\",\"epilepsie\":\"0\",\"schwindel\":\"0\",\"taubheit\":\"0\",\"kraftverlust\":\"0\",\"laehmungen\":\"0\",\"demenzcheck_gewuenscht\":null,\"neurologische_untersuchung_gewuenscht\":null,\"dopplersono_carotiden_gewuenscht\":null},\"schmerz\":{\"sonstiger_schmerz\":\"0\",\"keine_schmerzen\":\"0\"},\"frauengesundheit_gynaekologie\":{\"geburten_anzahl\":\"\",\"fehlgeburten_anzahl\":\"\",\"zyklusanamnese_sonstiges\":\"\",\"gynaekologie_bemerkungen\":\"\",\"brustkrebs_screening_jahr\":\"\",\"brustkrebs_screening_wiederholung_geplant\":\"\",\"brustkrebs_screening_befund\":\"\",\"gynaekologischer_check_jahr\":\"\",\"gynaekologischer_check_wiederholung_geplant\":\"\",\"gynaekologischer_check_befund\":\"\",\"gynaekologie_diagnostik\":\"\",\"gynaekologie_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"geburt\":\"0\",\"fehlgeburt\":\"0\",\"sectio\":\"0\",\"dammriss_dammschnitt\":\"0\",\"brustkrebs\":\"0\",\"gebaermutterkrebs\":\"0\",\"eierstockkrebs\":\"0\",\"brustkrebs_screening_gewuenscht\":null,\"gynaekologischer_check_gewuenscht\":null,\"hormonsprechstunde_gewuenscht\":null},\"nephrologie_urogenitaltrakt_female\":{\"nephrologie_urogenitaltrakt_diagnosen\":\"\",\"haeufiges_wasserlassen_wie_oft\":\"\",\"naechtliches_wasserlassen_wie_oft\":\"\",\"nephrologie_urogenitaltrakt_beschwerden_symptome\":\"\",\"nephrologie_urogenitaltrakt_bemerkungen\":\"\",\"nephrologie_urogenitaltrakt_diagnostik\":\"\",\"nephrologie_urogenitaltrakt_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"niereninsuffizienz\":\"0\",\"nierensteine\":\"0\",\"chronische_harnwegsinfekte\":\"0\",\"urininkontinenz\":\"0\",\"abgeschwaechter_harnstrahl\":\"0\",\"schmerzen_wasserlassen\":\"0\",\"haeufiges_wasserlassen\":\"0\",\"naechtliches_wasserlassen\":\"0\"},\"psyche\":{\"psyche_diagnosen\":\"\",\"psyche_beschwerden_symptome\":\"\",\"psyche_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"psyche_bemerkungen\":\"\",\"psyche_froehlich\":\"0\",\"psyche_gluecklich\":\"0\",\"psyche_ausgeglichen\":\"0\",\"psyche_traurig\":\"0\",\"psyche_depressiv\":\"0\",\"psyche_aggressiv\":\"0\",\"psyche_einsam\":\"0\",\"erschoepft\":\"0\",\"psychologisches_gespraech_gewuenscht\":null,\"coaching_beratung_gewuenscht\":null},\"dermatologie_aesthetik\":{\"dermatologie_aesthetik_bemerkungen\":\"\",\"dermatologie_aesthetik_beschwerden_symptome\":\"\",\"dermatologie_aesthetik_wuensche\":\"\",\"hautkrebsscreening_jahr\":\"\",\"hautkrebsscreeninge_wiederholung_geplant\":\"\",\"hautkrebsscreening_befund\":\"\",\"dermatologie_aesthetik_diagnostik\":\"\",\"dermatologie_aesthetik_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"psoriasis\":\"0\",\"neurodermitis\":\"0\",\"basaliom\":\"0\",\"melanom\":\"0\",\"dermatologische_diagnostik_gewuenscht\":null},\"schlafmedizin\":{\"schlafmedizin_schlafqualitaet\":\"1\",\"schlafmedizin_bemerkungen\":\"\",\"schlafmedizin_wuensche\":\"\",\"schlafmedizin_schlaflabor_untersuchung_wann\":\"\",\"schlafmedizin_diagnostik\":\"\",\"schlafmedizin_op_therapie\":[{\"jahr\":\"\",\"ort\":\"\",\"befund\":\"\"}],\"schlafmedizin_schlafapnoe\":\"0\",\"schlafmedizin_beatmungsgeraet\":\"0\",\"schlafmedizin_unterkieferprotrusionsschiene\":\"0\",\"schlafmedizin_einschlafstoerungen\":\"0\",\"schlafmedizin_durchschlafstoerungen\":\"0\",\"schlafmedizin_naechtliches_wasserlassen\":\"0\",\"schlafmedizin_schnarchen\":\"0\",\"schlafmedizin_apnoe\":\"0\",\"schlafmedizin_lumbalgie\":\"0\",\"schlafmedizin_muskelkraempfe\":\"0\",\"schlafmedizin_morgenmuedigkeit\":\"0\",\"schlafmedizin_zappelbeine\":\"0\",\"schlafmedizin_sekundenschlaf\":\"0\",\"schlafmedizin_nachtschweiss\":\"0\",\"schlaflaboruntersuchung_gewuenscht\":null,\"schlafmedizinische_beratung_gewuenscht\":null},\"infektion_reisemedizin_impfung\":{\"infektionen_chronisch_sonstige\":\"\",\"infektions_reisemedizin_impfung_bemerkungen\":\"\",\"infektions_reisemedizin_impfung_wuensche\":\"\",\"impfungen_influenza_letzte_impfung\":\"\",\"impfungen_sonstige\":\"\",\"herpes\":\"0\",\"infektionen_hepatitis_b\":\"0\",\"infektionen_hepatitis_c\":\"0\",\"infektionen_hiv\":\"0\",\"infektionen_tuberkulose\":\"0\",\"infektionen_infektioese_durchfaelle\":\"0\",\"infektionen_resistente_keime\":\"0\",\"malaria\":\"0\"},\"nephrologie_urogenitaltrakt\":{\"urogloische_diagnostik_gewuenscht\":null},\"gewuenschte_diagnostik_therapie\":{\"trainingstherapie_gewunscht_anzahl\":\"\",\"trainingstherapie_gewun2018-11-27T09:06:57.467671307Z scht_sonstige_text\":\"\",\"wuensche_bemerkungen\":\"\",\"trainingstherapie_gewunscht_fahrrad\":\"0\",\"trainingstherapie_gewunscht_golf\":\"0\",\"trainingstherapie_gewunscht_sonstige\":\"0\"}}'\nWHERE\n    \"TABLE_WITH_JSON_STRING_FIELD\".\"ID\" = 129444104;\n</code></pre>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "sass", "asset-pipeline"], "comments": [{"owner": {"reputation": 1895, "user_id": 1343297, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/9fc2686e1ea3df77da352524c45cd5f3?s=128&d=identicon&r=PG", "display_name": "Chandrakant", "link": "https://stackoverflow.com/users/1343297/chandrakant"}, "edited": false, "score": 0, "creation_date": 1543322604, "post_id": 53499396, "comment_id": 93869053, "body": "are you trying to compile .SASS file? if yes - could you please post that file as well?"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1543326603, "post_id": 53499396, "comment_id": 93871528, "body": "hmmm the error looks like it&#39;s pointing to the wrong file/line, it&#39;s hard to tell, I would move all the files out from that directory and start adding one by one and try compilying it until the error appears"}, {"owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1543387622, "post_id": 53499396, "comment_id": 93896284, "body": "@arieljuod oops! It seems a hard way to find it out! Do you have any other workaround to fix it?"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1543411532, "post_id": 53499396, "comment_id": 93909570, "body": "@MenporulPoriyalan, no idea, maybe instead of adding one do it like a search algorithm haha, remove half of the files, if the error persist, it&#39;s in the half you left, if the error is gone it&#39;s in the half you took out. It shouldn&#39;t be so long to do that, you will narrow it down very fast."}, {"owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1543473536, "post_id": 53499396, "comment_id": 93934074, "body": "@arieljuod Thanks Mate! However,I figured out what causes it."}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1543494806, "post_id": 53499396, "comment_id": 93945406, "body": "@MenporulPoriyalan add an answer then, in case someone finds this question, maybe it helps, at least can lead a user in the right direction if you tell how did you solve it."}, {"owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1543496706, "post_id": 53499396, "comment_id": 93946469, "body": "@arieljuod - I added an answer."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "edited": false, "score": 0, "creation_date": 1543387481, "post_id": 53499633, "comment_id": 93896219, "body": "I have changed &quot;background&quot; to &quot;background-color&quot; , But now the different error is showing  <code>Error: Invalid CSS after &quot;both&quot;: expected expression (e.g. 1px, bold), was &quot;;&quot;         on line 19 of app&#47;assets&#47;stylesheets&#47;ajax-bootstrap-select.css</code>"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1543322213, "last_edit_date": 1543322213, "creation_date": 1543321407, "answer_id": 53499633, "question_id": 53499396, "link": "https://stackoverflow.com/questions/53499396/rake-assetsprecompile-sasssyntaxerror-invalid-css-after-padding-expect/53499633#53499633", "title": "rake assets:precompile &gt; Sass::SyntaxError: Invalid CSS after &quot; padding&quot;: expected &quot;;&quot;, was &quot;:20px;&quot;", "body": "<p>As the error states, it comes just after your background: #f0f0f0 line:</p>\n\n<p><a href=\"https://www.w3schools.com/css/css_background.asp\" rel=\"nofollow noreferrer\">https://www.w3schools.com/css/css_background.asp</a></p>\n\n<p>If all you're trying to do is change the background colour, try:</p>\n\n<pre><code>.bootstrap-select .status {\n  background-color: #f0f0f0;\n  clear: both;\n  color: #999;\n  font-size: 11px;\n  font-style: italic;\n  font-weight: 500;\n  line-height: 1;\n  margin-bottom: -5px;\n  padding: 10px 20px;\n}\n</code></pre>\n\n<p>You're just using background, which is shorthand for entering various background attributes at once:</p>\n\n<blockquote>\n  <p>Background - Shorthand property To shorten the code, it is also\n  possible to specify all the background properties in one single\n  property. This is called a shorthand property.</p>\n  \n  <p>The shorthand property for background is background:</p>\n  \n  <p>Example body {\n      background: #ffffff url(\"img_tree.png\") no-repeat right top; }</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "is_accepted": true, "score": 0, "last_activity_date": 1543399762, "creation_date": 1543399762, "answer_id": 53516908, "question_id": 53499396, "link": "https://stackoverflow.com/questions/53499396/rake-assetsprecompile-sasssyntaxerror-invalid-css-after-padding-expect/53516908#53516908", "title": "rake assets:precompile &gt; Sass::SyntaxError: Invalid CSS after &quot; padding&quot;: expected &quot;;&quot;, was &quot;:20px;&quot;", "body": "<p>It seems in the Rails 5 this error happening. I just ran <code>rake assets:precompile</code> and it compiles successfully without error.</p>\n"}], "owner": {"reputation": 113, "user_id": 5209795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JULuW.jpg?s=128&g=1", "display_name": "Menporul Poriyalan", "link": "https://stackoverflow.com/users/5209795/menporul-poriyalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 53516908, "answer_count": 2, "score": 0, "last_activity_date": 1543399762, "creation_date": 1543320620, "question_id": 53499396, "link": "https://stackoverflow.com/questions/53499396/rake-assetsprecompile-sasssyntaxerror-invalid-css-after-padding-expect", "title": "rake assets:precompile &gt; Sass::SyntaxError: Invalid CSS after &quot; padding&quot;: expected &quot;;&quot;, was &quot;:20px;&quot;", "body": "<p>I was running</p>\n\n<pre><code>rake assets:precompile RAILS_ENV=staging\n</code></pre>\n\n<p>Then I get this error stack:</p>\n\n<pre><code>rake aborted!\nSass::SyntaxError: Invalid CSS after \" padding\": expected \";\", was \":20px;\"\n(sass):5108\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:1278:in `expected'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:1208:in `expected'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:1203:in `tok!'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:804:in `block in try_declaration'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:1254:in `rethrow'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:809:in `try_declaration'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:732:in `declaration_or_ruleset'\n/home/ubuntu/auto_ful/path/ruby/2.3.0/gems/sass-3.5.6/lib/sass/scss/parser.rb:697:in `block_child'\n</code></pre>\n\n<p>But then I tried this to backtrace where exactly the error is:</p>\n\n<pre><code>sass -c app/assets/stylesheets/**.css*\n</code></pre>\n\n<p>I get this following error message : </p>\n\n<pre><code>Error: Invalid CSS after \"#f0f0f0\": expected expression (e.g. 1px, bold), was \";\"\n        on line 18 of app/assets/stylesheets/ajax-bootstrap-select.css\n</code></pre>\n\n<p>My CSS in ajax-bootstrap-select.css is</p>\n\n<pre><code>.bootstrap-select .status {\n  background: #f0f0f0;\n  clear: both;\n  color: #999;\n  font-size: 11px;\n  font-style: italic;\n  font-weight: 500;\n  line-height: 1;\n  margin-bottom: -5px;\n  padding: 10px 20px;\n}\n</code></pre>\n\n<p>How to fix it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543320601, "post_id": 53499182, "comment_id": 93867854, "body": "Also this: <a href=\"https://stackoverflow.com/questions/4601652/ruby-array-creation-array-new-vs/4601727#4601727\" title=\"ruby array creation array new vs\">stackoverflow.com/questions/4601652/&hellip;</a>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1543320794, "post_id": 53499182, "comment_id": 93867966, "body": "@webster no need of r_hash, try this, <code>[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;].map { |o| c_hash[o] = [1, 2, 3].inject({}){ |m, r| m[r] = []; m } }</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1543320857, "post_id": 53499182, "comment_id": 93868004, "body": "@ray Why tell me? Say it to the OP."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 2, "creation_date": 1543320898, "post_id": 53499182, "comment_id": 93868042, "body": "I had same problem when I used  <code>Array.new(5,[])</code>  but solved using <code>Array.new(5) { Array.new }</code>"}], "owner": {"reputation": 3459, "user_id": 3185510, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nlb4D.jpg?s=128&g=1", "display_name": "webster", "link": "https://stackoverflow.com/users/3185510/webster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1543320559, "answer_count": 0, "score": 1, "last_activity_date": 1543320235, "creation_date": 1543319907, "last_edit_date": 1543320235, "question_id": 53499182, "link": "https://stackoverflow.com/questions/53499182/inserting-values-in-array-inside-a-nested-hash-updates-multiple-records", "closed_reason": "Duplicate", "title": "Inserting values in array inside a nested hash updates multiple records", "body": "<p>I am trying to insert values to an array in a nested hash as follows:</p>\n\n<pre><code>c_hash = {}\nr_hash = {}\n[1, 2, 3].map{ |r| r_hash[r] = [] }\n# =&gt; [[], [], []]\nr_hash\n# =&gt; {1=&gt;[], 2=&gt;[], 3=&gt;[]}\n[\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"].map { |o| c_hash[o] = r_hash }\n# =&gt; [{1=&gt;[], 2=&gt;[], 3=&gt;[]}, {1=&gt;[], 2=&gt;[], 3=&gt;[]}, {1=&gt;[], 2=&gt;[], 3=&gt;[]}, {1=&gt;[], 2=&gt;[], 3=&gt;[]}, {1=&gt;[], 2=&gt;[], 3=&gt;[]}, {1=&gt;[], 2=&gt;[], 3=&gt;[]}]\nc_hash\n# =&gt; {\"a\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"b\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"c\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"d\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"e\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"f\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}}\nc_hash[\"a\"][1] &lt;&lt; 10\nc_hash\n# =&gt; {\"a\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"b\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"c\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"d\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"e\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"f\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}}\n</code></pre>\n\n<p>But the value <code>10</code> is inserted in multiple records. While hardcoding the hash value (<code>10</code>), it is inserted only once.</p>\n\n<pre><code>c_hash = {\"a\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"b\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"c\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"d\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"e\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"f\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}}\nc_hash[\"a\"][1] &lt;&lt; 10\n# =&gt; [10]\nc_hash\n# =&gt; {\"a\"=&gt;{1=&gt;[10], 2=&gt;[], 3=&gt;[]}, \"b\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"c\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"d\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"e\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}, \"f\"=&gt;{1=&gt;[], 2=&gt;[], 3=&gt;[]}}\n</code></pre>\n\n<p>Could you please explain why this happens?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1543316060, "post_id": 53497291, "comment_id": 93865302, "body": "The title of the post is &#39;How to update one attribute when other changes&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 3, "last_activity_date": 1543314772, "creation_date": 1543314772, "answer_id": 53497692, "question_id": 53497291, "link": "https://stackoverflow.com/questions/53497291/how-to-update-one-attribute-when-other-changes/53497692#53497692", "title": "How to update one attribute when other changes", "body": "<p>You're pretty much there. Your issue is that you're performing your check after you save instead of before. After you've saved the record, the update has already taken place, so the system thinks nothing has changed.</p>\n\n<p>Change </p>\n\n<pre><code>  after_save :check_is_completed\n  after_update :check_is_completed\n</code></pre>\n\n<p>To</p>\n\n<pre><code>  before_save :check_is_completed\n</code></pre>\n\n<p>You also won't need to use any instance variables. As you're already in your class, all you need to do is:</p>\n\n<pre><code>def check_is_completed\n  return unless completed_changed?\n  self.completed_at = Date.new() if completed?\nend\n</code></pre>\n\n<p>This will perform the check before every save, doing nothing unless the completed attribute has changed, and then only updating the completed_at field if completed is true</p>\n"}], "owner": {"reputation": 7313, "user_id": 3238178, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/lwfYd.jpg?s=128&g=1", "display_name": "MCMatan", "link": "https://stackoverflow.com/users/3238178/mcmatan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 53497692, "answer_count": 1, "score": 0, "last_activity_date": 1543315800, "creation_date": 1543313517, "last_edit_date": 1543315800, "question_id": 53497291, "link": "https://stackoverflow.com/questions/53497291/how-to-update-one-attribute-when-other-changes", "title": "How to update one attribute when other changes", "body": "<p>I am new to Rails and can get this right.</p>\n\n<p>Trying to update \"completed_at\" when \"completed\" turns true.</p>\n\n<p>I've read this: <a href=\"https://api.rubyonrails.org/classes/ActiveModel/Dirty.html#method-i-changed-3F\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveModel/Dirty.html#method-i-changed-3F</a></p>\n\n<p>And decided to add a callback, on each update or save. Then check if the \"completed\" prop has changed, if not, if it is true, update \"completed_at\" to the current date.</p>\n\n<p>The method \"check_is_completed\" does get called, but I can't access the correct prop's and detect if changed and get the new value</p>\n\n<pre><code>class Task &lt; ApplicationRecord\n  belongs_to :user\n  validates :name, presence: true\n\n  after_save :check_is_completed\n  after_update :check_is_completed\n\n  private \n\n  # This gets called\n  def check_is_completed\n    # try 1\n    # This does not work called\n    if @completed.changed?\n      if @completed == true\n      self.completed_at = Date.new()\n      end\n    end\n    #try 2\n    if self.completed_changed?\n      if self.completed == true\n      self.completed_at = Date.new()\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "build", "yaml", "travis-ci"], "comments": [{"owner": {"reputation": 50175, "user_id": 1307905, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a38a4f5f180194ac457cdc057f1be6e3?s=128&d=identicon&r=PG", "display_name": "Anthon", "link": "https://stackoverflow.com/users/1307905/anthon"}, "edited": false, "score": 0, "creation_date": 1543315490, "post_id": 53497278, "comment_id": 93865005, "body": "In YAML, the scalar <code>if</code> doesn&#39;t have any special meaning. YAML also doesn&#39;t know how to parse the scalar &quot;type = pull_request LIVE_SERVICE_TEST=true&quot;,  Even though your input has a newline within that scalar, that will passed on to the application as a single space."}], "answers": [{"tags": [], "owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "is_accepted": false, "score": 1, "last_activity_date": 1543330863, "creation_date": 1543330863, "answer_id": 53502457, "question_id": 53497278, "link": "https://stackoverflow.com/questions/53497278/travis-configuration-conditional-environment-variable/53502457#53502457", "title": "Travis configuration conditional environment variable", "body": "<p>Doing some research on <a href=\"https://docs.travis-ci.com/user/conditional-builds-stages-jobs/#conditional-stages\" rel=\"nofollow noreferrer\">conditional stages</a> and <a href=\"https://stackoverflow.com/a/33758552/8304905\">this other answer</a>, your solution might include something like the following:</p>\n\n<pre><code>matrix:\n  include:\n      if: type = pull_request\n      env: LIVE_SERVICE_TEST=true\n</code></pre>\n\n<p>Check the documentation of Travis on <a href=\"https://docs.travis-ci.com/user/conditional-builds-stages-jobs/\" rel=\"nofollow noreferrer\">Conditional Builds, Stages and Jobs</a></p>\n"}], "owner": {"reputation": 4207, "user_id": 2015350, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f746dc2cf1dba31f8bf32382cc447b01?s=128&d=identicon&r=PG", "display_name": "Johnny Cash", "link": "https://stackoverflow.com/users/2015350/johnny-cash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543330863, "creation_date": 1543313432, "last_edit_date": 1543314467, "question_id": 53497278, "link": "https://stackoverflow.com/questions/53497278/travis-configuration-conditional-environment-variable", "title": "Travis configuration conditional environment variable", "body": "<p>Inside of the travis configuration file, I have some environment variables defined like those:</p>\n\n<pre><code>env:\n  SERVICE_URL=xxx\n  SERVICE_VERSION=1.1.1\n  TEST_CLUSTER=yyy\n</code></pre>\n\n<p>and I also want to add another environment variable if the travis build type is <code>pull_request</code>. Is there a way to do it?</p>\n\n<p>What I mean is something like that (I couldn't find syntactically correct version)</p>\n\n<pre><code>env:\n  if: type = pull_request\n    LIVE_SERVICE_TEST=true\n</code></pre>\n"}, {"tags": ["ruby", "daru"], "answers": [{"tags": [], "owner": {"reputation": 1416, "user_id": 8656126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a097761015b0c2b723f22eb4d239b3e6?s=128&d=identicon&r=PG&f=1", "display_name": "richflow", "link": "https://stackoverflow.com/users/8656126/richflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1543314372, "creation_date": 1543314372, "answer_id": 53497560, "question_id": 53497206, "link": "https://stackoverflow.com/questions/53497206/drop-the-first-n-rows-from-daru-dataframe/53497560#53497560", "title": "Drop the first n rows from daru dataframe", "body": "<p>You can use <a href=\"https://www.rubydoc.info/gems/daru/Daru/DataFrame#row_at-instance_method\" rel=\"nofollow noreferrer\">row_at</a> to retrieve all the rows without the first 4.</p>\n\n<p>Example:</p>\n\n<pre><code>2.4.5 :001 &gt; require 'daru'\n =&gt; true\n2.4.5 :002 &gt; df = Daru::DataFrame.new({\n2.4.5 :003 &gt;         'col0' =&gt; [1,2,3,4,5,6],\n2.4.5 :004 &gt;         'col2' =&gt; ['a','b','c','d','e','f'],\n2.4.5 :005 &gt;         'col1' =&gt; [11,22,33,44,55,66]\n2.4.5 :006?&gt;       })\n =&gt; #&lt;Daru::DataFrame(6x3)&gt;\n      col0 col2 col1\n    0    1    a   11\n    1    2    b   22\n    2    3    c   33\n    3    4    d   44\n    4    5    e   55\n    5    6    f   66\n</code></pre>\n\n<p>Retrieve rows:</p>\n\n<pre><code>2.4.5 :010 &gt; df.row_at(4..df.shape()[0])\n =&gt; #&lt;Daru::DataFrame(2x3)&gt;\n      col0 col2 col1\n    4    5    e   55\n    5    6    f   66\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38, "user_id": 3212716, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/81f252dff77ea0ce472ac5e6739467e8?s=128&d=identicon&r=PG&f=1", "display_name": "simon tan", "link": "https://stackoverflow.com/users/3212716/simon-tan"}, "is_accepted": false, "score": 0, "last_activity_date": 1546941812, "creation_date": 1546941812, "answer_id": 54089363, "question_id": 53497206, "link": "https://stackoverflow.com/questions/53497206/drop-the-first-n-rows-from-daru-dataframe/54089363#54089363", "title": "Drop the first n rows from daru dataframe", "body": "<p>You can put this into a loop:</p>\n\n<pre><code>df.delete_row(0)\n</code></pre>\n\n<p><a href=\"https://www.rubydoc.info/gems/daru/0.1.4.1/Daru/DataFrame#delete_row-instance_method\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/daru/0.1.4.1/Daru/DataFrame#delete_row-instance_method</a></p>\n"}], "owner": {"reputation": 2594, "user_id": 3090068, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69636a28e85f584b8f264495494f3de0?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki Inoue", "link": "https://stackoverflow.com/users/3090068/yuki-inoue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 53497560, "answer_count": 2, "score": 0, "last_activity_date": 1579608325, "creation_date": 1543313210, "last_edit_date": 1579608325, "question_id": 53497206, "link": "https://stackoverflow.com/questions/53497206/drop-the-first-n-rows-from-daru-dataframe", "title": "Drop the first n rows from daru dataframe", "body": "<p>One can drop the first n elements of an array by using <code>Array#drop</code>.</p>\n\n<pre><code>a = [1,2,3]\na.drop(2) # =&gt; [3]\n</code></pre>\n\n<p>I want to drop the first n rows from a <code>Daru::DataFrame</code> object.  It seems this class does not implement such <code>drop</code> method.</p>\n\n<p>How can I delete the first n rows from a <code>Daru::DataFrame</code> object?</p>\n"}, {"tags": ["javascript", "ruby", "slim-lang"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543305179, "post_id": 53494950, "comment_id": 93859447, "body": "Rather than modifying the click event, it would be much easier and clearer to call the additional js method within the original js method that is triggered by onclick."}, {"owner": {"reputation": 35, "user_id": 10324074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eIogS2d8Pkg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOn2j_AgIi2lfQGQW_v_nrlWBRBKg/mo/photo.jpg?sz=128", "display_name": "Theresa", "link": "https://stackoverflow.com/users/10324074/theresa"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543305463, "post_id": 53494950, "comment_id": 93859567, "body": "@sawa the parent button must actually trigger the chatbox button to open the chatbox. There&#39;s basically a redundancy of buttons, I know, but UX wise - there&#39;s a &quot;Let&#39;s Chat&quot; button that should trigger opening the &quot;Reamaze chatbox&quot; button."}, {"owner": {"reputation": 35, "user_id": 10324074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eIogS2d8Pkg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOn2j_AgIi2lfQGQW_v_nrlWBRBKg/mo/photo.jpg?sz=128", "display_name": "Theresa", "link": "https://stackoverflow.com/users/10324074/theresa"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543305581, "post_id": 53494950, "comment_id": 93859611, "body": "@sawa edited the question - must &#39;ve been unclear was writing in a hurry"}, {"owner": {"reputation": 2777, "user_id": 1788201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d0de3e55b33e22977ff75990486979?s=128&d=identicon&r=PG", "display_name": "Nima", "link": "https://stackoverflow.com/users/1788201/nima"}, "edited": false, "score": 0, "creation_date": 1543311600, "post_id": 53494950, "comment_id": 93862659, "body": "This question is not about PHP Slim framework thus should not be tagged <code>slim</code>. The correct tag is <code>slim-lang</code>"}, {"owner": {"reputation": 35, "user_id": 10324074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eIogS2d8Pkg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOn2j_AgIi2lfQGQW_v_nrlWBRBKg/mo/photo.jpg?sz=128", "display_name": "Theresa", "link": "https://stackoverflow.com/users/10324074/theresa"}, "reply_to_user": {"reputation": 2777, "user_id": 1788201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d0de3e55b33e22977ff75990486979?s=128&d=identicon&r=PG", "display_name": "Nima", "link": "https://stackoverflow.com/users/1788201/nima"}, "edited": false, "score": 0, "creation_date": 1543371808, "post_id": 53494950, "comment_id": 93891956, "body": "@Nima sorry I&#39;ll change it I thought its the same! Thanks!"}], "owner": {"reputation": 35, "user_id": 10324074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eIogS2d8Pkg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOn2j_AgIi2lfQGQW_v_nrlWBRBKg/mo/photo.jpg?sz=128", "display_name": "Theresa", "link": "https://stackoverflow.com/users/10324074/theresa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543371825, "creation_date": 1543304847, "last_edit_date": 1543371825, "question_id": 53494950, "link": "https://stackoverflow.com/questions/53494950/ruby-slim-lang-onclick-button-triggers-another-onclick-event", "title": "Ruby Slim Lang: Onclick button triggers another onclick event", "body": "<p>I have a \"Let's Chat\" button placed in a much better place rather than the \"Reamaze Chat\" chatbox. </p>\n\n<p>How can I hook an onclick event on the \"Let's Chat\" button that uses slim, </p>\n\n<pre><code>  div.col-md-3\n    p\n      a.btn-primary.btn-lg.btn-block.chat-link Let's Chat\n</code></pre>\n\n<p>to open the ReAmaze chatbox triggered by an onclick action as well:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" async src=\"https://cdn.reamaze.com/assets/reamaze.js\"&gt;&lt;/script&gt;\n\n&lt;script type=\"text/javascript\"&gt;\nvar _support = _support || { 'ui': {}, 'user': {} };\n  _support['account'] = 'scihelp';\n  _support['ui']['widget'] = true;\n  &lt;% if user_signed_in? %&gt;\n  _support['user'] = {\n    id: '&lt;%= current_user.id %&gt;',\n    email: '&lt;%= current_user.email %&gt;',\n    name: '&lt;%= current_user.full_name %&gt;',\n    authkey: '&lt;%= OpenSSL::HMAC.hexdigest('sha256', \"#{ENV['REAMAZE_SSO_SECRET']}\", \"#{current_user.id}:#{current_user.email}\") %&gt;'\n  }\n  &lt;% end %&gt;\n  _support['custom_fields'] = {\n    AppName: {\n      type: 'hidden',\n      value: 'Chat',\n    }\n  }\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543308206, "post_id": 53494542, "comment_id": 93860817, "body": "What is class of <code>@payouts</code>  ?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543309484, "post_id": 53494542, "comment_id": 93861511, "body": "Its under def account in my dashboard controller."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543309532, "post_id": 53494542, "comment_id": 93861532, "body": "no, check the class of payouts with `  @payouts.class` what are you getting ?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543309644, "post_id": 53494542, "comment_id": 93861597, "body": "Oh! I get &quot; Stripe::ListObject &quot; --- is that what you were looking for?  thats from doing &quot;&lt;%= @payouts.class %&gt;&quot; in the view"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543309888, "post_id": 53494542, "comment_id": 93861717, "body": "Did you check <code>kaminari gem</code> ?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543310209, "post_id": 53494542, "comment_id": 93861913, "body": "ill take a look into but from the github i believe it does what the will_paginate gem already does.  I think the api-pagination gem is the gem way to go but theres probably a way to do this through jquey/JS -  Although it looks like kaminari can do arrays which could help.  thanks, ill take a look"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1543310509, "post_id": 53494542, "comment_id": 93862063, "body": "Yes. Kaminari gem has lots of scopes, you can use it as you want."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543360468, "post_id": 53497577, "comment_id": 93889220, "body": "To clarify, I will need to set up params to save this stripe data? I did notice stripe has auto pagination but i can&#39;t see how it relates to the front end view.  I know it can be done but i haven&#39;t sorted it out and all tutorials ive found on it are aimed towards more console style to retrieve in &quot;pages&quot;"}, {"owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543395957, "post_id": 53497577, "comment_id": 93900260, "body": "Yes, you&#39;ll need to add parameters to your <code>Stripe::Payout.list</code> call and the value of those parameters will be dependent on the payouts you&#39;ve already fetched."}], "tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": false, "score": 0, "last_activity_date": 1543314413, "creation_date": 1543314413, "answer_id": 53497577, "question_id": 53494542, "link": "https://stackoverflow.com/questions/53494542/how-to-paginate-over-stripe-api-results/53497577#53497577", "title": "How to paginate over Stripe API results?", "body": "<p>The Stripe API uses cursors for pagination rather than just specifying a page and a page size (which is what will_paginate and kaminari do).</p>\n\n<p>If you look at the api docs for <a href=\"https://stripe.com/docs/api/payouts/list\" rel=\"nofollow noreferrer\">listing payouts</a> the arguments you'll need to use are <code>ending_before</code> and <code>starting_after</code>.</p>\n\n<p>If you retrieve 10 payouts with ids <code>[1, 2, ..., 10]</code> and you want the next \"page\" of results you'll need to make the request again with <code>starting_after=10</code>. I.e. from the payout with id=10 get me the next 10 payouts.</p>\n\n<p>I'm not aware of any gem support for this (although that definitely doesn't mean that there isn't any!) and I've tended to roll my own by generating \"Next\" and \"Previous\" links to set <code>starting_after</code> the id of the last payout in my current page or <code>ending_before</code> the id of the first payout in my current page. E.g.</p>\n\n<pre><code>&lt;%= link_to 'Previous', list_payouts_url(first_payout_id: @payouts.first.id) %&gt;\n&lt;%= link_to 'Next', list_payouts_url(last_payout_id: @payouts.last.id) %&gt;\n</code></pre>\n\n<p>and then setting the <code>ending_before</code> or <code>starting_after</code> to <code>params[:first_payout_id]</code> and <code>params[:last_payout_id]</code>.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1130, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1543314413, "creation_date": 1543303086, "last_edit_date": 1543303471, "question_id": 53494542, "link": "https://stackoverflow.com/questions/53494542/how-to-paginate-over-stripe-api-results", "title": "How to paginate over Stripe API results?", "body": "<p><strong>Issue:</strong> I want to find a way to paginate over Stripe API results past a certain number.  The issue is, as time goes on and more API documentation appears, a page will be loaded with way too much data.  Preferably I would like to have a months worth of data per page.</p>\n\n<p><strong>Question:</strong> How can I limit to results on the views side and create pagination for it.</p>\n\n<p>For example, I have this in my controller:</p>\n\n<pre><code>  @payouts = Stripe::Payout.list(\n      {\n        limit: 100,\n        expand: ['data.destination']\n      },\n      { stripe_account: current_user.stripe_token } \n    )\n</code></pre>\n\n<p>Views:</p>\n\n<pre><code> #table html stuffs\n    ...\n    &lt;% @payouts.each do |payout| %&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= number_to_currency(as_table_row_payout(payout[\"amount\"] / 100.00 )) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= as_table_row_payout(Time.at(payout[\"arrival_date\"]).strftime('%m/%d/%Y')) %&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n  &lt;% end %&gt;\n    ...\n</code></pre>\n\n<p>I have the will_paginate gem but that didn't seem to work.  So I figured there may be a way with jquery / JS to solve this.  Does anyone have a solution to limit the amount of API JSON data that is requested on the view page?</p>\n\n<p>Somewhat of an update and a bit off topic... (sorry if this strays from the post itself and starts a new conversation)\nI have found a gem for will_paginate to paginate through API requests</p>\n\n<p>I have found the api-pagination gem here: <a href=\"https://github.com/davidcelis/api-pagination\" rel=\"nofollow noreferrer\">https://github.com/davidcelis/api-pagination</a></p>\n\n<p>Although, when i installed the gem and followed the directions, nothing seemed to happen - I manually created an api_pagination.rb config file and did what it seems like the docs say to do as well... Anyone use this before?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml", "erb"], "comments": [{"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543299621, "post_id": 53493729, "comment_id": 93857173, "body": "you didn&#39;t pre-assign <code>task</code> in new.js.erb, hence the error message"}, {"owner": {"reputation": 1386, "user_id": 6064073, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/457ca4f4c23d927e3f39ee3842776367?s=128&d=identicon&r=PG&f=1", "display_name": "jean182", "link": "https://stackoverflow.com/users/6064073/jean182"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543300221, "post_id": 53493729, "comment_id": 93857372, "body": "But where should I assign it, is it on my view in the link_to or where should I put that?"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543300339, "post_id": 53493729, "comment_id": 93857435, "body": "what view was <code>render &#39;messages&#47;form&#39;, current_company_task: task.company_tasks.find_or_create_by(company: @company).id</code>  on?new.html.haml?"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543300589, "post_id": 53493729, "comment_id": 93857526, "body": "<code>task</code> should be assigned in MessagesController <code>new</code> action, and it should be instance variable"}, {"owner": {"reputation": 1386, "user_id": 6064073, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/457ca4f4c23d927e3f39ee3842776367?s=128&d=identicon&r=PG&f=1", "display_name": "jean182", "link": "https://stackoverflow.com/users/6064073/jean182"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543301322, "post_id": 53493729, "comment_id": 93857822, "body": "But task is under a loop, i cannot use it as an instance variable under that controller"}, {"owner": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 1, "creation_date": 1543302139, "post_id": 53493729, "comment_id": 93858171, "body": "when you render the form inside modal, <code>task</code> is not in the loop anymore"}, {"owner": {"reputation": 1386, "user_id": 6064073, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/457ca4f4c23d927e3f39ee3842776367?s=128&d=identicon&r=PG&f=1", "display_name": "jean182", "link": "https://stackoverflow.com/users/6064073/jean182"}, "reply_to_user": {"reputation": 2412, "user_id": 1253504, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1ba0b6bef219b34fa4f2d014046ff987?s=128&d=identicon&r=PG", "display_name": "kasperite", "link": "https://stackoverflow.com/users/1253504/kasperite"}, "edited": false, "score": 0, "creation_date": 1543304603, "post_id": 53493729, "comment_id": 93859180, "body": "Oh thanks, at the end I passed the task.id parameters to the link and now I can create a @task variable under the controller"}], "owner": {"reputation": 1386, "user_id": 6064073, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/457ca4f4c23d927e3f39ee3842776367?s=128&d=identicon&r=PG&f=1", "display_name": "jean182", "link": "https://stackoverflow.com/users/6064073/jean182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581309355, "creation_date": 1543299078, "last_edit_date": 1581309355, "question_id": 53493729, "link": "https://stackoverflow.com/questions/53493729/render-form-with-local-variable-in-js-erb-file-rails", "title": "Render form with local variable in js erb file rails", "body": "<p>Hi I'm trying to render a form in a modal using bootstrap 4 but I'm getting this error</p>\n\n<pre><code>undefined local variable or method `task' for #&lt;# \n&lt;Class:0x007f8aedbd9730&gt;:0x007f8af4511d10&gt;\n</code></pre>\n\n<h2>    app/views/messages/new.js.erb, line 3</h2>\n\n<p>When I try to use the form on my haml view it works perfectly</p>\n\n<pre><code> - checklist.tasks.each_with_index do |task, index|\n   = task.description\n   = render 'messages/form', current_company_task: task.company_tasks.find_or_create_by(company: @company).id\n</code></pre>\n\n<p>When I try to make this as a modal instead of doing the above code I do this:</p>\n\n<pre><code>- checklist.tasks.each_with_index do |task, index|\n  =task.description\n  = link_to 'New Message', new_message_path, {remote: true, 'data-toggle' =&gt;  \"modal\", 'data-target' =&gt; \"#dialog-#{index}\", 'data-backdrop' =&gt; 'static', 'data-keyboard' =&gt; 'true'}\n</code></pre>\n\n<p>Now on my <strong>new.js.erb</strong> It's like this</p>\n\n<pre><code>$('.modal-body').html('&lt;%= j render(\"form\", current_company_task: task.company_tasks.find_or_create_by(company: @company).ids) %&gt;');\n</code></pre>\n\n<p>It is the same call but I don't know why is not working under my js.erb file\nBtw my modal is working, it is the form the one that is not rendering on that modal. But why the variable is working under my view but not on my js.erb file?</p>\n"}, {"tags": ["ruby", "sinatra", "rack"], "comments": [{"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 2, "creation_date": 1543300877, "post_id": 53493717, "comment_id": 93857647, "body": "There was a similar issue in sidekiq with its Sinatra based web UI. Please see if <a href=\"https://github.com/mperham/sidekiq/issues/1289#issuecomment-232330804\" rel=\"nofollow noreferrer\">this thread</a> helps you. Basically, just ensure that you&#39;re passing appropriate headers from the reverse proxy (load balancer) to the rack."}, {"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 1, "creation_date": 1543373924, "post_id": 53493717, "comment_id": 93892380, "body": "Thanks @31piy .   Based on that reading and some experimentation disabling the &#39;remote_referrer&#39; protection did the trick.  In Sinatra: <code>set :protection, :except =&gt; [:remote_referrer]</code>"}, {"owner": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1543374928, "post_id": 53493717, "comment_id": 93892559, "body": "Its great that you found a way on your own to solve this problem. To help future readers facing similar problem, you should add an answer describing what did you do, and then accept it."}, {"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "reply_to_user": {"reputation": 21010, "user_id": 2019247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MnZYd.jpg?s=128&g=1", "display_name": "31piy", "link": "https://stackoverflow.com/users/2019247/31piy"}, "edited": false, "score": 0, "creation_date": 1543380990, "post_id": 53493717, "comment_id": 93894033, "body": "Actually it seemed to be  <code>set :protection, :except =&gt; [:json_csrf]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "is_accepted": false, "score": 1, "last_activity_date": 1543381392, "last_edit_date": 1543381392, "creation_date": 1543381062, "answer_id": 53512408, "question_id": 53493717, "link": "https://stackoverflow.com/questions/53493717/how-can-i-see-what-rackprotection-is-doing-with-sinatra-server/53512408#53512408", "title": "How can I see what `Rack::Protection` is doing with Sinatra server?", "body": "<p>While I did not work out how to get better logging, I did work out that doing this:</p>\n\n<pre><code>set :protection, :except =&gt; [:json_csrf]\n</code></pre>\n\n<p>stopped the 'Forbidden' message on a client side redirect in the scenario described in the question.</p>\n"}], "owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543381392, "creation_date": 1543299021, "last_edit_date": 1543374239, "question_id": 53493717, "link": "https://stackoverflow.com/questions/53493717/how-can-i-see-what-rackprotection-is-doing-with-sinatra-server", "title": "How can I see what `Rack::Protection` is doing with Sinatra server?", "body": "<p>I have a Sinatra server in an AWS environment with a load balancer between the client and the server.</p>\n\n<p>Unless I do something like:</p>\n\n<pre><code>disable: protection\n</code></pre>\n\n<p>it gives 'Forbidden' on a redirect. I don't want to always disable protection, and I should narrow the amount of disabled protection, so I would like to know what protection is forbidding my redirect.   </p>\n\n<p>I am expecting to see something like:</p>\n\n<pre><code>attack prevented by Rack::Protection::&lt;Something&gt;\n</code></pre>\n\n<p>I have:</p>\n\n<pre><code>enable: logging\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>-e development\n</code></pre>\n\n<p>but can't get any feedback from <code>Rack::Protection</code> on why it is applying a rule.</p>\n\n<p>I have tried this:</p>\n\n<pre><code>def self.log_rack_protection(namespace = nil, data = nil)\n  puts \"rack data: #{data.pretty_inspect}\"\nend\nuse Rack::Protection, instrumenter: log_rack_protection\n</code></pre>\n\n<p>but it doesn't seem to be called except on startup.</p>\n\n<p>What do I need to do to get more feedback from <code>Rack::Protection</code> on what module is doing the blocking? Alternatively, is there some configuration we should be applying to the load balancer to stop this protection?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "edited": false, "score": 0, "creation_date": 1543510835, "post_id": 53493634, "comment_id": 93954795, "body": "In your final implementation, you want to have two different routes for <code>devise</code> right?  <code>localhost:3000&#47;login</code> and <code>localhost:3000&#47;api&#47;login</code>, at the same time."}, {"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "reply_to_user": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "edited": false, "score": 0, "creation_date": 1543561413, "post_id": 53493634, "comment_id": 93971071, "body": "Yes, first for standart db-auth, second - jwt-auth for api calls"}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543475099, "post_id": 53496981, "comment_id": 93934691, "body": "in that case i got error &quot;uninitialized constant SessionsController&quot;"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1543312508, "creation_date": 1543312508, "answer_id": 53496981, "question_id": 53493634, "link": "https://stackoverflow.com/questions/53493634/devise-multiple-pathes-for-one-model/53496981#53496981", "title": "Devise multiple pathes for one model", "body": "<p>I think in your initial route definition, you're already in the API namespace, so when you define your controller, you don't need</p>\n\n<pre><code>'api/sessions'\n</code></pre>\n\n<p>But just</p>\n\n<pre><code>'sessions'\n</code></pre>\n\n<p>I think this will make the request hit the correct controller, which means your authenticate_admin! method won't fire, which it is at the moment, resulting in your auth issue.</p>\n"}, {"comments": [{"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543561519, "post_id": 53545531, "comment_id": 93971115, "body": "I have already removed <code>skip_before_action :authenticate_user!</code>, it doesn&#39;t matter"}, {"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543561696, "post_id": 53545531, "comment_id": 93971178, "body": "Your answer is my second case, where there is single devise login route through api. But i need to have two routes: <code>localhost:3000&#47;login</code> and <code>localhost:3000&#47;api&#47;login</code> with different devise-controllers."}, {"owner": {"reputation": 485, "user_id": 8538812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnflc.jpg?s=128&g=1", "display_name": "Guillermo Aguirre", "link": "https://stackoverflow.com/users/8538812/guillermo-aguirre"}, "reply_to_user": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543587858, "post_id": 53545531, "comment_id": 93984144, "body": "I&#39;m sorry that I missunderstood your question initially. I have now edited the answer, now I think this is what you want, of course correct me if I&#39;m wrong."}, {"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543896647, "post_id": 53545531, "comment_id": 94073281, "body": "thx for your answer, i done similiar thing, look at my answer."}, {"owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "edited": false, "score": 0, "creation_date": 1543896680, "post_id": 53545531, "comment_id": 94073290, "body": "For me it wat not obvious that i can&#39;t have two devise_for :users )"}, {"owner": {"reputation": 2155, "user_id": 1048520, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/PLLuY.jpg?s=128&g=1", "display_name": "Karsten S.", "link": "https://stackoverflow.com/users/1048520/karsten-s"}, "edited": false, "score": 0, "creation_date": 1613302707, "post_id": 53545531, "comment_id": 117028622, "body": "I&#39;m struggling with the same problem now and came up with the same solution. However, when I use <code>devise-jwt</code> for api, it seems the Authorization header is not sent back on a successful login as it is when I use it for a controller set up via <code>devise_for</code>. Any clues?"}], "tags": [], "owner": {"reputation": 485, "user_id": 8538812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnflc.jpg?s=128&g=1", "display_name": "Guillermo Aguirre", "link": "https://stackoverflow.com/users/8538812/guillermo-aguirre"}, "is_accepted": false, "score": 5, "last_activity_date": 1543588279, "last_edit_date": 1543588279, "creation_date": 1543516652, "answer_id": 53545531, "question_id": 53493634, "link": "https://stackoverflow.com/questions/53493634/devise-multiple-pathes-for-one-model/53545531#53545531", "title": "Devise multiple pathes for one model", "body": "<p>Having this in my routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users,\n    path: '',\n    path_names: {\n      sign_in: 'login',\n      sign_out: 'logout'\n    }\n\n  namespace :api, defaults: { format: :json } do\n    namespace :users do\n      devise_scope :user do\n        post 'login', to: 'sessions#create', defaults: { format: :json }\n      end\n    end\n  end    \nend\n</code></pre>\n\n<p><code>rails routes</code> outputs:</p>\n\n<pre><code>                                   Prefix Verb       URI Pattern                                              Controller#Action\n                         new_user_session GET        /login(.:format)                                         devise/sessions#new\n                             user_session POST       /login(.:format)                                         devise/sessions#create\n                     destroy_user_session DELETE     /logout(.:format)                                        devise/sessions#destroy\n                       api_v1_users_login POST       /api/v1/users/login(.:format)                            api/v1/users/sessions#create {:format=&gt;:json}\n</code></pre>\n\n<p>Making the POST request to <code>http://localhost:3000/api/v1/users/login</code> works as expected\nAnd now accessing <code>http://localhost:3000/login</code> redirects to the default devise login page, and login works as it should. The problem was you can't have the same <code>devise_for</code> twice. You can have <code>devise_for :users</code> and <code>devise_for :admin_users</code> but not twice for the same, in this case <code>:users</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "is_accepted": true, "score": 1, "last_activity_date": 1543896519, "creation_date": 1543896519, "answer_id": 53605549, "question_id": 53493634, "link": "https://stackoverflow.com/questions/53493634/devise-multiple-pathes-for-one-model/53605549#53605549", "title": "Devise multiple pathes for one model", "body": "<p>My answer:</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout' }\ndevise_scope :user do\n   post 'api/login', to: 'api/sessions#create', as: 'api_login', defaults: {format: :json}\n   get 'api/logout', to: 'api/sessions#destroy', as: 'api_logout', defaults: {format: :json}\nend\n</code></pre>\n\n<p>It's similiar with Guilermo Aguirre answer.</p>\n"}], "owner": {"reputation": 1303, "user_id": 2789810, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/89a53157699228dbdd2426f783908ae9?s=128&d=identicon&r=PG", "display_name": "nuT707", "link": "https://stackoverflow.com/users/2789810/nut707"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 2, "accepted_answer_id": 53605549, "answer_count": 3, "score": 2, "last_activity_date": 1543896519, "creation_date": 1543298582, "last_edit_date": 1543561872, "question_id": 53493634, "link": "https://stackoverflow.com/questions/53493634/devise-multiple-pathes-for-one-model", "title": "Devise multiple pathes for one model", "body": "<p>I want to have two different routes for devise: </p>\n\n<ul>\n<li>localhost:3000/login - standart devise auth</li>\n<li>localhost:3000/api/login - auth for api calls using another, not standart controller <strong>/api/sessions_controller</strong></li>\n</ul>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout' }  \nnamespace :api, defaults: { format: :json } do\n  devise_for :users,\n             path: '',\n             defaults: { format: :json },\n             path_names: {\n               sign_in: 'login',\n               sign_out: 'logout',\n              },\n              controllers: { sessions: 'api/sessions' }\nend\n</code></pre>\n\n<p><strong>rails routes | grep sessio</strong></p>\n\n<pre><code>new_user_session         GET     /login(.:format)  devise/sessions#new\nuser_session             POST    /login(.:format) devise/sessions#create\ndestroy_user_session     DELETE  /logout(.:format) devise/sessions#destroy\nnew_api_user_session     GET     /api/login(.:format) api/sessions#new {:format=&gt;:json}\napi_user_session         POST    /api/login(.:format) api/sessions#create {:format=&gt;:json}\ndestroy_api_user_session DELETE  /api/logout(.:format) api/sessions#destroy {:format=&gt;:json}\n</code></pre>\n\n<p><strong>api/sessions_controller.rb</strong></p>\n\n<pre><code>class Api::SessionsController &lt; Devise::SessionsController\nskip_before_action :verify_authenticity_token\nskip_before_action :authenticate_user!\n\nrespond_to :json\n\nprivate\n\ndef respond_with(resource, _opts = {})\n  render json: resource\nend\n\ndef respond_to_on_destroy\n  head :no_content\nend\nend\n</code></pre>\n\n<p>That code looks fine for me, but when i try to send POST-request to my <strong>localhost:3000/api/login</strong> with auth credentials it returns error:</p>\n\n<blockquote>\n  <p>{\"error\":\"You need to sign in or sign up before continuing.\"}</p>\n</blockquote>\n\n<p>If i comment out my default devise routes and move api routes from api namespace everything works fine, post-request return me json with resource:\n<strong>routes.rb</strong></p>\n\n<pre><code>#devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout' }  \ndevise_for :users,\n             path: 'api',\n             defaults: { format: :json },\n             path_names: {\n               sign_in: 'login',\n               sign_out: 'logout',\n              },\n              controllers: { sessions: 'api/sessions' }\n\nnamespace :api, defaults: { format: :json } do\n  ...\nend\n</code></pre>\n\n<p>Why that happened? What i'm missing?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "activeadmin"], "answers": [{"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": true, "score": 2, "last_activity_date": 1543381122, "last_edit_date": 1543381122, "creation_date": 1543295367, "answer_id": 53493102, "question_id": 53493029, "link": "https://stackoverflow.com/questions/53493029/activeadmin-collection-names/53493102#53493102", "title": "ActiveAdmin Collection Names", "body": "<p>You can use <strong>Rails(Active Support)</strong> method <strong><a href=\"https://apidock.com/rails/ActiveSupport/Inflector/titleize\" rel=\"nofollow noreferrer\">String#titleize</a></strong> instead <code>split.map(&amp;:capitalize).join(' ')</code></p>\n\n<p>If you want to store record in DB as <code>snakecase</code> you can do below way: In dropdown option it will be displayed as <code>titalize</code> but it's value will be set as <code>snakecase</code> which will be stored in DB.</p>\n\n<pre><code>&gt; roles.map{|e|[e.titleize, e]}\n#=&gt; [[\"Super Admin\", \"super_admin\"], [\"User\", \"user\"], [\"User Admin\", \"user_admin\"]]\n</code></pre>\n\n<hr>\n\n<p>in activeadmin use:</p>\n\n<pre><code>input :roles, as: :check_boxes, collection: User::ROLES.map{|e|[e.titleize, e]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1543299647, "last_edit_date": 1543299647, "creation_date": 1543299302, "answer_id": 53493777, "question_id": 53493029, "link": "https://stackoverflow.com/questions/53493029/activeadmin-collection-names/53493777#53493777", "title": "ActiveAdmin Collection Names", "body": "<p>If you want to use pure Ruby, one alternative could be:</p>\n\n<pre><code>'super_admin'.split('_').map(&amp;:capitalize).join(' ')\n#=&gt; \"Super Admin\"\n</code></pre>\n\n<p>So, mapping your array:</p>\n\n<pre><code>roles.map { |str| [str.split('_').map(&amp;:capitalize).join(' '), str] }\n#=&gt; [[\"Super Admin\", \"super_admin\"], [\"User\", \"user\"], [\"User Admin\", \"user_admin\"]]\n</code></pre>\n\n<p>Backward (<code>before_save</code>):</p>\n\n<pre><code>\"Super Admin\".downcase.gsub(' ', '_') #=&gt; \"super_admin\"\n</code></pre>\n"}], "owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 53493102, "answer_count": 2, "score": 2, "last_activity_date": 1543381122, "creation_date": 1543294874, "last_edit_date": 1543324116, "question_id": 53493029, "link": "https://stackoverflow.com/questions/53493029/activeadmin-collection-names", "title": "ActiveAdmin Collection Names", "body": "<p>I have an array of roles in my model:</p>\n\n<pre><code>ROLES = ['super_admin', 'user', 'user_admin']\n</code></pre>\n\n<p>I have an ActiveAdmin form that shows these roles:</p>\n\n<pre><code>input :roles, as: :check_boxes, collection: User::ROLES\n</code></pre>\n\n<p>I have to show the roles as humanized, capitalized names instead of snake case on the form:</p>\n\n<pre><code>Super Admin, Salesman, Sales Admin\n</code></pre>\n\n<p>but when one of them is selected, it has to be saved in snakecase.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>User::ROLES\n.map { |r| \"#{r.humanize}\" }\n.map { |r| r.split.map(&amp;:capitalize).join(' ') }\n</code></pre>\n\n<p>but this saves the role as the humanized, capitalized form instead of the snake case form. How can I use the humanized, capitalized version of the words on the form, but save the snake case version?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 1, "creation_date": 1543295408, "post_id": 53492943, "comment_id": 93855823, "body": "use the <code>index</code> action and then call <code>show</code> if your param is present"}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 10560675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a032efbf386fce2fab38d983cb08f5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Conrad", "link": "https://stackoverflow.com/users/10560675/albert-conrad"}, "edited": false, "score": 0, "creation_date": 1543316021, "post_id": 53493307, "comment_id": 93865287, "body": "i want the page to open when i click on the title, not category list, i only want the page to be passed through a params"}, {"owner": {"reputation": 74, "user_id": 10560675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a032efbf386fce2fab38d983cb08f5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Conrad", "link": "https://stackoverflow.com/users/10560675/albert-conrad"}, "edited": false, "score": 0, "creation_date": 1543336168, "post_id": 53493307, "comment_id": 93877548, "body": "when i click on the page title, it takes me to the same page, how can i make it take me to a different page"}, {"owner": {"reputation": 74, "user_id": 10560675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a032efbf386fce2fab38d983cb08f5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Conrad", "link": "https://stackoverflow.com/users/10560675/albert-conrad"}, "edited": false, "score": 0, "creation_date": 1543336606, "post_id": 53493307, "comment_id": 93877786, "body": "i posted my full controller if it will help you help me"}], "tags": [], "owner": {"reputation": 1327, "user_id": 4650675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SiYJE.jpg?s=128&g=1", "display_name": "Niraj Kaushal", "link": "https://stackoverflow.com/users/4650675/niraj-kaushal"}, "is_accepted": false, "score": 0, "last_activity_date": 1543316681, "last_edit_date": 1543316681, "creation_date": 1543296729, "answer_id": 53493307, "question_id": 53492943, "link": "https://stackoverflow.com/questions/53492943/how-to-pass-parameters-in-page/53493307#53493307", "title": "how to pass parameters in page", "body": "<p>There may be many ways to do this and my way is as follow.</p>\n\n<hr>\n\n<p>Change <code>index</code> action of <code>pages_controller</code> as follow</p>\n\n<pre><code>def index\n  if params[:id].present?\n    show\n  else\n   #Code of index action\n   @pages = Page.all\n  end\nend\n</code></pre>\n\n<p>Change <code>show</code> action of <code>pages_controller</code> as follow</p>\n\n<pre><code>def show\n  @page = Page.find(params[:id])\nend\n</code></pre>\n\n<p>And pass page <code>id</code> in <code>link_to</code> function as follow</p>\n\n<pre><code>&lt;% @pages.each do |page| %&gt;\n  &lt;h4&gt;&lt;b&gt;&lt;%= link_to page.title, pages_path(:id =&gt; page.id)%&gt; &lt;/b&gt;&lt;/h4&gt;\n  #&lt;h4&gt;&lt;b&gt;&lt;a href=\"/pages?id=page_number\"&gt;Page Title&lt;/a&gt;&lt;/b&gt;&lt;/h4&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I hope this will solve your problem.</p>\n"}], "owner": {"reputation": 74, "user_id": 10560675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a032efbf386fce2fab38d983cb08f5e1?s=128&d=identicon&r=PG&f=1", "display_name": "Albert Conrad", "link": "https://stackoverflow.com/users/10560675/albert-conrad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543336551, "creation_date": 1543294285, "last_edit_date": 1543336551, "question_id": 53492943, "link": "https://stackoverflow.com/questions/53492943/how-to-pass-parameters-in-page", "title": "how to pass parameters in page", "body": "<p>I have this page (called \"page\"). I tried calling those pages by id with <code>&lt;%= link_to page.title, page_path(page.id) %&gt;</code>which is working, but I want to call those pages using params, I don't want their link to be direct like <a href=\"http://localhost:3000/pages/6\" rel=\"nofollow noreferrer\">http://localhost:3000/pages/6</a> but I want that id 6 to be passed through a params, so I'll have a link like <a href=\"http://localhost:3000/pages?category_id=1\" rel=\"nofollow noreferrer\">http://localhost:3000/pages?category_id=1</a>.</p>\n\n<p>Here's my pages controller</p>\n\n<pre><code>    class PagesController &lt; ApplicationController\n  def show\n    @pages = Page.find(params[:id])\n  end\n\n  def all\n    @category = Category.find_by(id: params[:category_id])\n    @pages = @category.pages\n  end\n\n  def index\n    if params[:id].present?\n      show\n    else\n     #Code of index action\n     @pages = Page.all\n    end\n  end\nend\n</code></pre>\n\n<p>and my show.html.erb</p>\n\n<pre><code>&lt;%= @page.title %&gt;\n&lt;%= @page.body %&gt;\n</code></pre>\n\n<p>and then the link to this page</p>\n\n<pre><code>&lt;% @pages.each do |page| %&gt;\n  &lt;h4&gt;\n    &lt;b&gt;\n      &lt;%= link_to page.title, page_path(page.id)%&gt;\n    &lt;/b&gt;\n  &lt;/h4&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ssl"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543287760, "post_id": 53492066, "comment_id": 93854193, "body": "are you invoking <code>&quot;https:&#47;&#47;localhost&quot;</code>?"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543288033, "post_id": 53492066, "comment_id": 93854240, "body": "I have tried both. If I used http Chrome forces it to https. Https directly does not work either."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1543288452, "post_id": 53492066, "comment_id": 93854319, "body": "What&#39;s going on with the hyphens and spaces in your command? Are you sure it&#39;s <code>\u2013 ssl \u2013 ssl-key-file ~&#47;.ssl&#47;localhost.key \u2013 ssl-cert- file ~&#47;.ssl&#47;localhost.crt</code> and not <code>--ssl --ssl-key-file ~&#47;.ssl&#47;localhost.key --ssl-cert-file ~&#47;.ssl&#47;localhost.crt</code>?"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543289090, "post_id": 53492066, "comment_id": 93854464, "body": "Made the suggested change and still the same issue."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1543290072, "post_id": 53492066, "comment_id": 93854655, "body": "I recommend following a different guide or very carefully examining every single step in the guide you linked to because it has totally mangled the spaces and hyphens and I wouldn&#39;t be surprised if you have other copy/paste issues."}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543290282, "post_id": 53492066, "comment_id": 93854696, "body": "Tried a different one and still the same issue.  <a href=\"https://makandracards.com/makandra/15903-using-thin-for-development-with-ssl\" rel=\"nofollow noreferrer\">makandracards.com/makandra/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543291157, "post_id": 53492491, "comment_id": 93854887, "body": "Tried that same issue. Want to be sure I am using the procfile, but manually starting server via terminal &quot;bundle exec rails server -e development&quot;"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543291469, "post_id": 53492491, "comment_id": 93854941, "body": "What do you mean be sure you&#39;re using Profile?  Are you using foreman?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543292845, "post_id": 53492491, "comment_id": 93855230, "body": "See updated answer. Profile is not used just by being there.  Locally you  need to run <code>gem install foreman</code> and then see my updated answer."}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543297327, "post_id": 53492491, "comment_id": 93856415, "body": "gem install forman fails. ERROR:  While executing gem ... (Errno::EHOSTUNREACH)     No route to host - sendto(2)"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543297801, "post_id": 53492491, "comment_id": 93856573, "body": "jn$ gem install foreman ERROR:  While executing gem ... (Errno::EHOSTUNREACH)     No route to host - sendto(2)"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543299562, "post_id": 53492491, "comment_id": 93857157, "body": "Also use your bundle exec command in terminal says --ssl is invalid"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1543324604, "last_edit_date": 1543324604, "creation_date": 1543290784, "answer_id": 53492491, "question_id": 53492066, "link": "https://stackoverflow.com/questions/53492066/how-to-run-an-ssl-cert-on-localhost-for-ruby-on-rails-app/53492491#53492491", "title": "How to run an SSL cert on localhost for Ruby on Rails app?", "body": "<p>UPDATE: Based on your last comment.  You need to start your local server either with </p>\n\n<pre><code>foreman start -f Procfile\n</code></pre>\n\n<p>Or with</p>\n\n<pre><code>bundle exec thin start -p 3001 --ssl \u2013-ssl-key-file ~/.ssl/localhost.key \u2013-ssl-cert-file ~/.ssl/localhost.crt\n</code></pre>\n\n<p>However this Profile won't work in production.  You might want to use an alternate <code>Procfile-dev</code> file in development</p>\n\n<p>ORIGINAL:</p>\n\n<p>In Procfile try hard coding the port use 3001 for ssl</p>\n\n<pre><code>web: bundle exec thin start -p 3001 --ssl \u2013-ssl-key-file ~/.ssl/localhost.key \u2013-ssl-cert-file ~/.ssl/localhost.crt\n</code></pre>\n\n<p>UPDATE 2: You shouldn't need a cert at all for local dev, you should be able to allow access via Chrome</p>\n\n<pre><code>bundle exec thin start -p 3001 --ssl  #this should work without any other arguments\n</code></pre>\n\n<p>Then you need to pass the port into the browser</p>\n\n<pre><code>https://localhost:3001\n</code></pre>\n\n<p>You might also try to comment out this in application.rb</p>\n\n<pre><code>#config.force_ssl = true\n</code></pre>\n\n<p>That should only be set in production.rb</p>\n\n<p>As to why you can't install <code>gem install foreman</code> I'm not sure why you can't, it sounds like some kind of network problem on your machine, do you have a firewall blocking?</p>\n"}, {"comments": [{"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543297375, "post_id": 53492877, "comment_id": 93856434, "body": "Puma does NOT work at all. Followed this <a href=\"https://stormconsultancy.co.uk/blog/development/ruby-on-rails/switching-pow-puma-rails-development/\" rel=\"nofollow noreferrer\">stormconsultancy.co.uk/blog/development/ruby-on-rails/&hellip;</a> and get Unable to Connect when hitting <a href=\"https://statrubytwotwo.dev/\" rel=\"nofollow noreferrer\">statrubytwotwo.dev</a> or <a href=\"http://statrubytwotwo.dev/\" rel=\"nofollow noreferrer\">statrubytwotwo.dev</a>"}, {"owner": {"reputation": 1166, "user_id": 882223, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd45c3d279959bed4fc7ff575c7c885e?s=128&d=identicon&r=PG", "display_name": "Aref Aslani", "link": "https://stackoverflow.com/users/882223/aref-aslani"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 1, "creation_date": 1543303891, "post_id": 53492877, "comment_id": 93858899, "body": "Run <code>puma-dev -d dev</code> to handle <code>.dev</code> domains, but it&#39;s better to use <code>.test</code> or <code>.localhost</code> domains since Chrome &amp; Firefox now force .dev domains to HTTPS via preloaded HSTS."}, {"owner": {"reputation": 1166, "user_id": 882223, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd45c3d279959bed4fc7ff575c7c885e?s=128&d=identicon&r=PG", "display_name": "Aref Aslani", "link": "https://stackoverflow.com/users/882223/aref-aslani"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543304150, "post_id": 53492877, "comment_id": 93859007, "body": "Also you can see development logs to see what happened. Maybe there is an error somewhere."}], "tags": [], "owner": {"reputation": 1166, "user_id": 882223, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dd45c3d279959bed4fc7ff575c7c885e?s=128&d=identicon&r=PG", "display_name": "Aref Aslani", "link": "https://stackoverflow.com/users/882223/aref-aslani"}, "is_accepted": false, "score": 2, "last_activity_date": 1543293612, "creation_date": 1543293612, "answer_id": 53492877, "question_id": 53492066, "link": "https://stackoverflow.com/questions/53492066/how-to-run-an-ssl-cert-on-localhost-for-ruby-on-rails-app/53492877#53492877", "title": "How to run an SSL cert on localhost for Ruby on Rails app?", "body": "<p>You can use <a href=\"https://github.com/puma/puma-dev\" rel=\"nofollow noreferrer\">puma-dev</a> for local development. It makes HTTPS available without a hassle.</p>\n\n<blockquote>\n  <p>Puma-dev automatically makes the apps available via SSL as well. When you first run puma-dev, it will have likely caused a dialog to appear to put in your password. What happened there was puma-dev generates its own CA certification that is stored in ~/Library/Application Support/io.puma.dev/cert.pem.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "is_accepted": true, "score": 0, "last_activity_date": 1543514419, "creation_date": 1543514419, "answer_id": 53545013, "question_id": 53492066, "link": "https://stackoverflow.com/questions/53492066/how-to-run-an-ssl-cert-on-localhost-for-ruby-on-rails-app/53545013#53545013", "title": "How to run an SSL cert on localhost for Ruby on Rails app?", "body": "<p>Updated the app to 2.3.1 which got puma-dev to work. \nRemoved <code>config.action_cable.disable_request_forgery_protection = true</code> which was throwing an error.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 10164608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WRvOg.jpg?s=128&g=1", "display_name": "saqib", "link": "https://stackoverflow.com/users/10164608/saqib"}, "is_accepted": false, "score": 0, "last_activity_date": 1599615984, "creation_date": 1599615984, "answer_id": 63803659, "question_id": 53492066, "link": "https://stackoverflow.com/questions/53492066/how-to-run-an-ssl-cert-on-localhost-for-ruby-on-rails-app/63803659#63803659", "title": "How to run an SSL cert on localhost for Ruby on Rails app?", "body": "<p>Open the terminal and follow these steps</p>\n<ol>\n<li><p>openssl req -x509 -sha256 -nodes -newkey rsa:2048 -days 365 -keyout\nlocalhost.key -out localhost.crt</p>\n</li>\n<li><p>sudo nano  /usr/local/share/ca-certificates/localhost.crt and copy text from<br />\ngernate file localhost.crt save</p>\n</li>\n<li><p>sudo update-ca-certificates</p>\n</li>\n<li><p>add gem &quot;thin&quot;</p>\n</li>\n<li><p>for run sever &quot;thin start --ssl --ssl-key-file localhost.key --ssl-cert-file localhost.crt&quot;</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2403, "favorite_count": 0, "accepted_answer_id": 53545013, "answer_count": 4, "score": 2, "last_activity_date": 1599615984, "creation_date": 1543287311, "last_edit_date": 1543442799, "question_id": 53492066, "link": "https://stackoverflow.com/questions/53492066/how-to-run-an-ssl-cert-on-localhost-for-ruby-on-rails-app", "title": "How to run an SSL cert on localhost for Ruby on Rails app?", "body": "<p>Running Ruby 1.9.3, Rails 4.2.10 and using Thin server on development.</p>\n\n<p>My app is using SSL on Heroku. Need to run SSL on my local Mac.</p>\n\n<p>I followed this tutorial.</p>\n\n<p><a href=\"https://www.botreetechnologies.com/blog/enable-ssl-for-rails-development-environment-two-minutes\" rel=\"nofollow noreferrer\">https://www.botreetechnologies.com/blog/enable-ssl-for-rails-development-environment-two-minutes</a></p>\n\n<p>Here is my Procfile:</p>\n\n<pre><code>web: bundle exec rails server thin start -p 3001 -e development --ssl --ssl-verify --ssl-key-file server.key --ssl-cert-file server.crt\n</code></pre>\n\n<p>Here is the error I am received in trace</p>\n\n<pre><code>Invalid request: Invalid HTTP format, parsing fails.\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/request.rb:84:in `execute'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/request.rb:84:in `parse'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/connection.rb:39:in `receive_data'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.8/lib/eventmachine.rb:193:in `run_machine'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.8/lib/eventmachine.rb:193:in `run'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/backends/base.rb:73:in `start'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/server.rb:162:in `start'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/rack-1.6.4/lib/rack/handler/thin.rb:19:in `run'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/rack-1.6.4/lib/rack/server.rb:286:in `start'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands/server.rb:80:in `start'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands/commands_tasks.rb:80:in `block in server'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands/commands_tasks.rb:75:in `tap'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands/commands_tasks.rb:75:in `server'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n    /Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/railties-4.2.4/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n    script/rails:6:in `require'\n    script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Though my procfile contains information about cert. I manually start my THIN rails server via terminal like this.</p>\n\n<pre><code>bundle exec rails server thin start -p 3001 -e development\n</code></pre>\n\n<p>So not sure if it is using the Procfile?</p>\n\n<p>UPDATE 2 ========</p>\n\n<p>Tried to use <code>bundle exec thin start -p 3001 --ssl</code>\nHad force_ssl set to false</p>\n\n<p>Server starts</p>\n\n<pre><code>jn$ bundle exec thin start -p 3001 --ssl\n/Users/jn/.rbenv/versions/1.9.3-p551/lib/ruby/gems/1.9.1/gems/thin-1.6.4/lib/thin/backends/base.rb:103: warning: epoll is not supported on this platform\nUsing rack adapter\nThin web server (v1.6.4 codename Gob Bluth)\nMaximum connections set to 1024\nListening on 0.0.0.0:3001, CTRL+C to stop\n</code></pre>\n\n<p>Try to hit <a href=\"https://localhost:3001\" rel=\"nofollow noreferrer\">https://localhost:3001</a> and server stops with error</p>\n\n<pre><code>libc++abi.dylib: terminating with uncaught exception of type std::runtime_error: Encryption not available on this event-machine\nAbort trap: 6\n</code></pre>\n\n<p>=====  UPDATE 3: ======</p>\n\n<p>Tried Puma.io failed same issue (cant establish a secure connection).\nTried Puma-dev failed to even recognize .dev URl \nTried manually adding cert and key again same issue (cant establish a secure connection).</p>\n\n<p>App loads our app signin form at <a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">http://localhost:3000</a>. As soon as I log in the app loads the correct user account page using http then about 1 second later page is redireted to the same user account page but https which says 'can't establish a secure connection'. Have no idea why the browser is forcing me to https? Nothing in the app is set to https that I can \"Find/Replace\".</p>\n\n<p>Generated a new secret_key as think it was short 20 characters in stead of 30. Pasted into secret_key.rb restarted server. Same ssl issue.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 1, "creation_date": 1543286414, "post_id": 53491961, "comment_id": 93853922, "body": "Should normally use lowercase for foreign keys (government_party_id)"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 0, "creation_date": 1543286479, "post_id": 53491961, "comment_id": 93853932, "body": "@mahemoff Oh, even if the DB column is in a different case?"}, {"owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "edited": false, "score": 1, "creation_date": 1543286920, "post_id": 53491961, "comment_id": 93854023, "body": "No, should match the DB. I guess the way it&#39;s written, the question hints that they do begin with uppercase, so I get why you wrote it that way. It&#39;s just fairly unusual in any context to have a dashed name starting with uppercase."}, {"owner": {"reputation": 13, "user_id": 10709232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sv8sV.jpg?s=128&g=1", "display_name": "Robert Fletcher", "link": "https://stackoverflow.com/users/10709232/robert-fletcher"}, "edited": false, "score": 0, "creation_date": 1543311846, "post_id": 53491961, "comment_id": 93862812, "body": "Thanks for this. What would I have in my Party model class?"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543354522, "post_id": 53491961, "comment_id": 93886906, "body": "you can use <code>has_many</code> or <code>has_one</code> based on the number of elections per party"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1543286320, "creation_date": 1543286320, "answer_id": 53491961, "question_id": 53491794, "link": "https://stackoverflow.com/questions/53491794/rails-active-record-associations-referring-to-same-model/53491961#53491961", "title": "Rails active record associations referring to same model", "body": "<pre><code>class Election &lt; ActiveRecord::Base\n  belongs_to :government_party, class_name: 'Party', foreign_key: 'Government_party_id'\n  belongs_to :opposition_party, class_name: 'Party', foreign_key: 'Opposition_party_id'\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10709232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sv8sV.jpg?s=128&g=1", "display_name": "Robert Fletcher", "link": "https://stackoverflow.com/users/10709232/robert-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53491961, "answer_count": 1, "score": 1, "last_activity_date": 1543286320, "creation_date": 1543284786, "last_edit_date": 1543286243, "question_id": 53491794, "link": "https://stackoverflow.com/questions/53491794/rails-active-record-associations-referring-to-same-model", "title": "Rails active record associations referring to same model", "body": "<p>I am looking for some assistance with setting up activerecord associations between these two tables.</p>\n\n<p>In particular the associations with Government party Id and Opposition Party id - which I would like to both point back to the parties table.</p>\n\n<p>Can someone please assist with how I would set them up in my models?</p>\n\n<pre><code>Tables\n\nElection\nId:integer\nLocation_id:integer\nDate:date\nGovernment_party_id:integer\nGovernment_seats:integer\nGovernment_tpp:float\nOpposition_party_id:integer\nOpposition_seats:integer\nopposition_tpp:float\nTotal_seats:integer\n\nParty\nId:integer\nName:string\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543309873, "post_id": 53491664, "comment_id": 93861709, "body": "Where is <code>hash_key_two</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543310847, "post_id": 53491664, "comment_id": 93862239, "body": "Suppose <code>my_array[1][:first_hash_key]</code> equaled <code>{id: 1, title: &quot;my dog&quot;}</code>. How (if at all) would that change the desired result. Perhaps if two hashes have the same value of <code>:id</code> they have the same value of <code>:title</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543311433, "post_id": 53491664, "comment_id": 93862572, "body": "As @sawa intimated in a comment below you are making life unnecessarily difficult for yourself by not always having the value of <code>:second_hash_key</code> be an array of arrays, even when it contains just one array."}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1543310323, "post_id": 53492339, "comment_id": 93861970, "body": "The result of your code is more consistent and makes sense, but is different from what OP wanted. For the value of <code>:second_hash_key</code> in the hash where <code>[:first_hash_key][:id] == 2</code>, the OP did not want a nested array. What OP wanted is inconsistent and makes less sense, but is not what your code returns."}, {"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1543372634, "post_id": 53492339, "comment_id": 93892123, "body": "Actually - I do want a nested array, and max&#39;s code returns a nested array - I incorrectly posted my desired return.  I need to be able to iterate over the arrays from second_hash_key.  I can update the question"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1543289955, "last_edit_date": 1543289955, "creation_date": 1543289628, "answer_id": 53492339, "question_id": 53491664, "link": "https://stackoverflow.com/questions/53491664/group-array-of-hashes-on-key-and-append-nested-array-on-another-hash-key/53492339#53492339", "title": "Group array of hashes on key and append nested array on another hash key", "body": "<p>well it ain't pretty but here you go:</p>\n\n<pre><code>my_array.\n  group_by { |elem| elem[:first_hash_key] }.\n  transform_values { |vals| vals.map { |val| val[:second_hash_key] } }.\n  reduce([]) do |memo, (key, vals)|\n    memo + [{first_hash_key: key, second_hash_key: vals}]\n  end\n</code></pre>\n\n<p>returns:</p>\n\n<pre><code>[\n  {\n    :first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"},\n    :second_hash_key=&gt;[\n      [\"stuff\", \"more stuff\", \"more stuff\"],\n      [\"stuff 3\", \"uniq stuff 2\"]\n    ]\n  }, {\n    :first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"},\n    :second_hash_key=&gt;[\n      [\"interesting stuff\", \"uniq stuff\"]\n    ]\n  }\n]\n</code></pre>\n\n<p>If you're not clear how this works you should inspect the result of each line, but to summarize</p>\n\n<ol>\n<li>group by <code>first_hash_key</code></li>\n<li><p>call <code>transform_values</code> to get the values at <code>second_hash_key</code> corresponding to each of these <code>first_hash_key</code> values</p></li>\n<li><p>At this point you have a hash mapping <code>first_hash_key</code> value to all of the corresponding values of <code>second_hash_key</code>. Now just have to <code>reduce</code> it to get the final data structure. </p></li>\n</ol>\n\n<p>This pattern of group_by => transform_values => reduce is something I use all the time and is very useful. transform_values is available in rails as well as ruby 2.5 I believe. </p>\n"}, {"comments": [{"owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "edited": false, "score": 0, "creation_date": 1543372858, "post_id": 53506616, "comment_id": 93892172, "body": "So noted.  I agree, too much work to guess at the data within second_hash_key - updated output required.  thanks!!!!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1543345994, "creation_date": 1543345994, "answer_id": 53506616, "question_id": 53491664, "link": "https://stackoverflow.com/questions/53491664/group-array-of-hashes-on-key-and-append-nested-array-on-another-hash-key/53506616#53506616", "title": "Group array of hashes on key and append nested array on another hash key", "body": "<pre><code>my_array.each_with_object({}) do |g,h|\n  h.update(g[:first_hash_key][:id]=&gt;g) { |_,o,n|\n    o.merge(second_hash_key: [[*o[:second_hash_key]], n[:second_hash_key]]) }\nend.values\n  #=&gt; [{:first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"},\n  #     :second_hash_key=&gt;[[\"stuff\", \"more stuff\", \"more stuff\"],\n  #                        [\"stuff 3\", \"uniq stuff 2\"]]},\n  #    {:first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"},\n  #     :second_hash_key=&gt;[\"interesting stuff\", \"uniq stuff\"]}]\n</code></pre>\n\n<p>The receiver of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-values\" rel=\"nofollow noreferrer\">Hash#values</a> is the hash:</p>\n\n<pre><code>{1=&gt;{:first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"},\n     :second_hash_key=&gt;[[\"stuff\", \"more stuff\", \"more stuff\"],\n                        [\"stuff 3\", \"uniq stuff 2\"]]},\n 2=&gt;{:first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"},\n     :second_hash_key=&gt;[\"interesting stuff\", \"uniq stuff\"]}}\n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) that employs a block to determine the values of keys that are present in both hashes being merged, here the keys being <code>1</code> and <code>2</code>. That block has three block variables: <code>_</code> equals the common key<sup>1</sup>; <code>o</code> (\"old\") is value of the key <code>_</code> in the hash being constructed and <code>n</code> (\"new\") is the value of the key <code>_</code> in the hash being merged into the hash being constructed.</p>\n\n<p>The expression <code>[*o[:second_hash_key]]</code> converts <code>o[:second_hash_key]</code> to an array of itself if <code>o[:second_hash_key]</code> is not an array and leaves <code>o[:second_hash_key]</code> unchanged if it is already an array. For example, <code>[*1] #=&gt; [1]</code>, whereas <code>[*[1,2]] #=&gt; [1,2]</code>.</p>\n\n<p>The return value is problematic in that the value of <code>:second_hash_key</code> is in one case an array of arrays and in another it is simply an array. In subsequent calculations it therefore will be necessary to determine if each value is an array of arrays or just an array, and then take action accordingly. That could be done, of course, but it's messy and ugly; better to make all the values arrays of arrays. We could do that as follows.</p>\n\n<pre><code>my_array.each_with_object({}) do |g,h|\n  h.update(g[:first_hash_key][:id]=&gt;\n    g.merge(second_hash_key: [g[:second_hash_key]])) { |_,o,n|\n      o.merge(second_hash_key: o[:second_hash_key] + n[:second_hash_key]) }\nend.values\n  #=&gt; [{:first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"},\n  #     :second_hash_key=&gt;[[\"stuff\", \"more stuff\", \"more stuff\"],\n  #                        [\"stuff 3\", \"uniq stuff 2\"]]},\n  #    {:first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"},\n  #     :second_hash_key=&gt;[[\"interesting stuff\", \"uniq stuff\"]]}]\n</code></pre>\n\n<p><sup>1 The use of the underscore--a valid local variable--for the common key is to inform the reader that it is not used in the block calculation.</sup></p>\n"}], "owner": {"reputation": 6846, "user_id": 1753596, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/r9f3k.jpg?s=128&g=1", "display_name": "trh", "link": "https://stackoverflow.com/users/1753596/trh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 53492339, "answer_count": 2, "score": -2, "last_activity_date": 1543372819, "creation_date": 1543283666, "last_edit_date": 1543372819, "question_id": 53491664, "link": "https://stackoverflow.com/questions/53491664/group-array-of-hashes-on-key-and-append-nested-array-on-another-hash-key", "title": "Group array of hashes on key and append nested array on another hash key", "body": "<p>I need to reduce an array of hashes into a single hash if that hash key matches.</p>\n\n<p><code>my_array</code> is an array of hashes, each of which has two keys: one an active record object, the other an array of different active record objects, similar to:</p>\n\n<pre><code>my_array = [\n  {\n    first_hash_key: {id: 1, title: \"my title\"},\n    second_hash_key: [\"stuff\", \"more stuff\", \"more stuff\"]\n  },\n  {\n    first_hash_key: {id: 1, title: \"my title\"},\n    second_hash_key: [\"stuff 3\", \"uniq stuff 2\"]\n  },\n  {\n    first_hash_key: {id: 2, title: \"my other title\"},\n    second_hash_key: [\"interesting stuff\", \"uniq stuff\"]\n  }\n]\n</code></pre>\n\n<p>I want to combine hashes by <code>first_hash_key[:id]</code>, add each item in <code>hash_key_two</code> to an array, not overwrite them to get:</p>\n\n<pre><code>my_array = [\n  {\n    first_hash_key: {id: 1, title: \"my title\"},\n    second_hash_key: [\n      [\"stuff\", \"more stuff\", \"more stuff\"],\n      [\"stuff 3\", \"uniq stuff 2\"]\n    ]\n  },\n  {\n    first_hash_key: {id: 2, title: \"my other title\"},\n    second_hash_key: [\"interesting stuff\", \"uniq stuff\"]\n  }\n]\n</code></pre>\n\n<p>I can reduce the top level array and hash, and use <code>merge</code>, but I'm losing the individual arrays inside the hash.</p>\n\n<p>I've also tried grouping by the <code>id</code> of the <code>first_hash_key</code>, and then injecting like this:</p>\n\n<pre><code>my_array.group_by{|h| h[:first_hash_key]}.map{|k,v| v.inject(:merge)}\n</code></pre>\n\n<p>Again, I'm losing the arrays in the <code>second_hash_key</code>. I only get the last array listed. Without <code>map</code>, I get an array of each hash in the group, but the top level isn't combined. </p>\n\n<pre><code>[\n  {\n    :first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"},\n    :second_hash_key=&gt;[\"stuff 3\", \"uniq stuff 2\"]\n  },\n  {\n    :first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"}, \n    :second_hash_key=&gt;[\"interesting stuff\", \"uniq stuff\"]\n  }\n]\n</code></pre>\n\n<p><strong>Update</strong>\nAs noted by sawa and cary, there is no sense in guessing for the second_hash_key if the data is an array or array or arrays, better to always have an array of arrays.  The desired output is:</p>\n\n<pre><code> [{:first_hash_key=&gt;{:id=&gt;1, :title=&gt;\"my title\"}, \n   :second_hash_key=&gt;[[\"stuff\", \"more stuff\", \"more stuff\"], \n                      [\"stuff 3\", \"uniq stuff 2\"]]\n },\n {:first_hash_key=&gt;{:id=&gt;2, :title=&gt;\"my other title\"}, \n :second_hash_key=&gt;[[\"interesting stuff\", \"uniq stuff\"]]\n }]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8224023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696ee61dc7f75c3026c2b1439a4198f0?s=128&d=identicon&r=PG&f=1", "display_name": "Bipin Manandhar", "link": "https://stackoverflow.com/users/8224023/bipin-manandhar"}, "edited": false, "score": 0, "creation_date": 1546480050, "post_id": 53595587, "comment_id": 94867790, "body": "I am not able to set the common heading as shown in the image above, like descritption, quantity, amount, unit_price"}, {"owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "reply_to_user": {"reputation": 55, "user_id": 8224023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696ee61dc7f75c3026c2b1439a4198f0?s=128&d=identicon&r=PG&f=1", "display_name": "Bipin Manandhar", "link": "https://stackoverflow.com/users/8224023/bipin-manandhar"}, "edited": false, "score": 0, "creation_date": 1546957325, "post_id": 53595587, "comment_id": 95019541, "body": "Hi Bipin, my error I think. The label property on the form inputs should be omitted. And then the first 2 css rules make it so that only the first labels are retained."}], "tags": [], "owner": {"reputation": 1641, "user_id": 790737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b5cec3d638d5eeefd2b32800907397?s=128&d=identicon&r=PG", "display_name": "Sjors Branderhorst", "link": "https://stackoverflow.com/users/790737/sjors-branderhorst"}, "is_accepted": true, "score": 1, "last_activity_date": 1543846680, "last_edit_date": 1543846680, "creation_date": 1543846377, "answer_id": 53595587, "question_id": 53491650, "link": "https://stackoverflow.com/questions/53491650/active-admin-nested-resources-form-generation/53595587#53595587", "title": "active admin nested resources form generation", "body": "<p>I had a similar issue in one of my activeadmin projects. The <code>fieldset</code> element uses <code>li</code> elements that you can style. So check the class the form is using, and than add something like this to the end of <code>app/assets/stylesheets/active_admin.scss</code>. Here I assume the css class on the surrounding form is <code>line_items</code>. The trick is the <code>inline-block</code> property on the <code>li</code> element, you may have to fiddle with the css properties though.</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>form.line_items fieldset.has_many_fields ol &gt; li &gt; label { display: none; }\nform.line_items fieldset.has_many_fields:first-child ol &gt; li &gt; label { display: block; }\nform.line_items fieldset.has_many_fields ol &gt; li { display: inline-block; padding: 5px; width: 18%; float:left;}\nform.line_items fieldset.has_many_fields ol &gt; li.has_many_delete { margin-top:20px; margin-left: -36px;}\nform.line_items fieldset.has_many_fields ol &gt; li &gt; label { width: auto; padding-right: 10px;}\nform.line_items fieldset.has_many_fields ol &gt; li &gt; div &gt; label.label { width: auto; padding-right: 10px;}\nform.line_items fieldset.has_many_fields ol &gt; li &gt; a.has_many_remove { margin-top:20px; }\nform.line_items fieldset.has_many_fields ol &gt; li &gt; p.inline-errors { margin: 0.3em 0 0 0; }\n</code></pre>\n\n\n\n<p>This would work but you will have to rewrite the form to:</p>\n\n<pre><code>  f.inputs 'Line Item/s' do\n    f.has_many :payment_line_items, heading: false do |form|\n      form.input :description, label: false\n      form.input :quantity, label: false\n      form.input :unit_price, label: false\n      form.input :amount, label: false                    \n    end\n  end\n</code></pre>\n\n<p>If you want the user to be able to destroy line items you will have to set up your assocations and the permit_params for it like so:</p>\n\n<p>In your model</p>\n\n<pre><code>accepts_nested_attributes_for :line_items, :allow_destroy =&gt; true\n</code></pre>\n\n<p>And in the activeadmin register block:</p>\n\n<pre><code>permit_params \\\n  :line_items_attributes =&gt; [:id, :description, :quantity, :unit_price, :amount, :_destroy]\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 55, "user_id": 8224023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/696ee61dc7f75c3026c2b1439a4198f0?s=128&d=identicon&r=PG&f=1", "display_name": "Bipin Manandhar", "link": "https://stackoverflow.com/users/8224023/bipin-manandhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 1, "accepted_answer_id": 53595587, "answer_count": 1, "score": 1, "last_activity_date": 1543846680, "creation_date": 1543283591, "last_edit_date": 1543289281, "question_id": 53491650, "link": "https://stackoverflow.com/questions/53491650/active-admin-nested-resources-form-generation", "title": "active admin nested resources form generation", "body": "<p>I am able to generate the required layout for nested attribute form like the below image:</p>\n\n<p><img src=\"https://i.stack.imgur.com/GQeOL.png\" alt=\"form layout I want\"></p>\n\n<p>The code for nested form:</p>\n\n<pre><code>f.inputs 'Line Item/s' do\n    f.has_many :payment_line_items, heading: false do |form|\n      table do\n        tr do\n          th 'Description'\n          th 'Qty'\n          th 'Unit Price'\n          th 'Amount'\n        end\n        tr do\n          td {form.input :description, label: false}\n          td {form.input :quantity, label: false}\n          td {form.input :unit_price, label: false}\n          td {form.input :amount, label: false}\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>When I click on 'add new payment line Item button' I get something like this image:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DOiBI.png\" alt=\"after adding the line item\"></p>\n\n<p>I just want to duplicate the whole table or just the tr with the form part when I click on 'add new payment line Item' button. How can I accomplish this ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543284218, "post_id": 53491604, "comment_id": 93853434, "body": "have you tried removing the remote true from the link?"}, {"owner": {"reputation": 27, "user_id": 3499671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uos2y.png?s=128&g=1", "display_name": "Jumping Jack", "link": "https://stackoverflow.com/users/3499671/jumping-jack"}, "reply_to_user": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543284642, "post_id": 53491604, "comment_id": 93853518, "body": "Yeah, unfortunately, its been doing this before I added remote: true."}, {"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543284969, "post_id": 53491604, "comment_id": 93853596, "body": "then maybe it&#39;s the remote true that isn&#39;t working, do you have <code>&#47;&#47;= require rails-ujs</code> on your application.js file? do you have other remote parts on your application that are working as expected?"}, {"owner": {"reputation": 27, "user_id": 3499671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uos2y.png?s=128&g=1", "display_name": "Jumping Jack", "link": "https://stackoverflow.com/users/3499671/jumping-jack"}, "reply_to_user": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1543285358, "post_id": 53491604, "comment_id": 93853678, "body": "Yes, I have <code>&#47;&#47;= require rails-ujs</code> in application.js. No, I this is the only remote item so far."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 3499671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uos2y.png?s=128&g=1", "display_name": "Jumping Jack", "link": "https://stackoverflow.com/users/3499671/jumping-jack"}, "is_accepted": true, "score": 1, "last_activity_date": 1543289904, "creation_date": 1543289904, "answer_id": 53492369, "question_id": 53491604, "link": "https://stackoverflow.com/questions/53491604/remove-controller-action-name-from-url/53492369#53492369", "title": "Remove controller action name from url", "body": "<p>So I was able to solve this by adding a <code>target: _blank</code> to the <code>link_to</code>.</p>\n\n<pre><code>&lt;%= link_to :download, class: 'download-btn', target: \"_blank\" do %&gt;\n    &lt;%= image_tag('img_btn_icon.png') %&gt; &lt;span class='resume-btn-text'&gt;Resume&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This prevents the download button from applying the name for the controller action being called by the <code>link_to</code> from being placed in the browsers URL.</p>\n"}], "owner": {"reputation": 27, "user_id": 3499671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uos2y.png?s=128&g=1", "display_name": "Jumping Jack", "link": "https://stackoverflow.com/users/3499671/jumping-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53492369, "answer_count": 1, "score": 0, "last_activity_date": 1543289904, "creation_date": 1543283240, "question_id": 53491604, "link": "https://stackoverflow.com/questions/53491604/remove-controller-action-name-from-url", "title": "Remove controller action name from url", "body": "<p>I'm having what I feel might be a simple issue but am kind struggling with it. I have an action in my Controller that downloads a pdf when a button is clicked in the View. The PDF download but the issue is after I click it the action remains in the browser and downloads the PDF every time I reload the page.</p>\n\n<p><strong>Example of URL</strong></p>\n\n<p>Before I click button</p>\n\n<pre><code>https://matrix-spam-camp.c9users.io\n</code></pre>\n\n<p>After I click of the button this stays in URL until I delete it manually from the browser.</p>\n\n<pre><code>https://matrix-spam-camp.c9users.io/download_pdf\n</code></pre>\n\n<p>/app/app/views/portfolio/main.html.erb  (link)</p>\n\n<pre><code>&lt;%= link_to download_pdf_path, class: 'download-btn', remote: true do %&gt;\n    &lt;%= image_tag('img_btn_icon.png') %&gt; &lt;span class='resume-btn-text'&gt;Resume&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>/app/app/controllers/portfolio_controller.rb</p>\n\n<pre><code>def download_pdf\n  send_file \"#{Rails.root}/app/assets/docs/resume.pdf\", type: \"application/pdf\", x_sendfile: true\nend\n</code></pre>\n\n<p>/app/config/routes.rb</p>\n\n<pre><code>get 'download_pdf', to: \"portfolio#download_pdf\"\n</code></pre>\n\n<p>Any help with this issue will be greatly appreciated.</p>\n"}, {"tags": ["ruby", "docker", "rubygems", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1543283270, "creation_date": 1543283270, "answer_id": 53491612, "question_id": 53491349, "link": "https://stackoverflow.com/questions/53491349/bundle-install-error-in-ruby-docker-image/53491612#53491612", "title": "Bundle install error in ruby docker image", "body": "<p>jruby has often <a href=\"https://github.com/jruby/jruby/wiki/Differences-Between-MRI-and-JRuby\" rel=\"nofollow noreferrer\">has trouble with native extensions</a>. In this case, the <a href=\"https://github.com/jgarber/redcloth#compiling\" rel=\"nofollow noreferrer\">redcloth gem</a> used to provide precompiled binaries for jruby but as of version 4.3 (the version you're attempting to install) they are no longer available:</p>\n\n<blockquote>\n  <p>Precompiled binary gems are provided for JRuby and Win32 platforms prior to version 4.3.</p>\n</blockquote>\n\n<p>According to the <a href=\"https://github.com/jgarber/redcloth#compiling\" rel=\"nofollow noreferrer\">README</a>, you should be able to run <code>rake compile</code> to build the binaries. This may be a lot of extra work in your Docker image to make work, so I would recommend trying an older version of redcloth that has the binaries you need first. (keep in mind, the 4.2 series was released in 2011 and may not have the functionality you need)</p>\n"}], "owner": {"reputation": 137, "user_id": 5492086, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f349610a2d8cf79f9225b982047d648?s=128&d=identicon&r=PG", "display_name": "Rohil", "link": "https://stackoverflow.com/users/5492086/rohil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543298777, "creation_date": 1543280663, "question_id": 53491349, "link": "https://stackoverflow.com/questions/53491349/bundle-install-error-in-ruby-docker-image", "title": "Bundle install error in ruby docker image", "body": "<p>I am trying to create a docker image using a ruby app using the docker file: </p>\n\n<pre><code>FROM jruby:latest \n\n# Install apt based dependencies required to run Rails as \n# well as RubyGems. As the Ruby image itself is based on a \n# Debian image, we use apt-get to install those.\nRUN apt-get update &amp;&amp; apt-get install -y \\ \n  build-essential \\ \n  nodejs \\\n  git \\\n  ruby-dev \\\n  gcc \\\n  libffi-dev \\\n  make \\\n  zlib1g-dev \\\n  libssl-dev \\\n  libreadline6-dev \\\n  libyaml-dev\n\n# Configure the main working directory. This is the base \n# directory used in any further RUN, COPY, and ENTRYPOINT \n# commands.\nRUN mkdir -p /app \nWORKDIR /app\n\n# Copy the Gemfile as well as the Gemfile.lock and install \n# the RubyGems. This is a separate step so the dependencies \n# will be cached unless changes to one of those two files \n# are made.\nCOPY Gemfile Gemfile.lock ./ \nRUN gem install bundler &amp;&amp; bundle install --jobs 20 --retry 5\n\n# Copy the main application.\nCOPY . ./\n\n# Expose port 3000 to the Docker host, so we can access it \n# from the outside.\nEXPOSE 3000\n</code></pre>\n\n<p>but i get an error when i'm trying to build this docker image </p>\n\n<p>the <code>gem install RedCloth</code> is giving an error saying that I need to install development tools first. </p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: /usr/local/bundle/gems/RedCloth-4.3.2/ext/redcloth_scan\n/opt/jruby/bin/jruby -r ./siteconf20181127-31-1zsapr.rb extconf.rb\nchecking for main() in -lc... RuntimeError: The compiler failed to generate an\nexecutable file.\nYou have to install development tools first.\n</code></pre>\n\n<p>How do I fix this? </p>\n"}, {"tags": ["ruby", "inheritance", "superclass"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543302354, "post_id": 53491282, "comment_id": 93858257, "body": "Your use case is not clear. If you want to switch between different methods, why can&#39;t they be named as different methods? Why do they have to be named the same? Can you pass some argument to the method, depending on which the method behaves differently?"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1543327142, "post_id": 53491282, "comment_id": 93871874, "body": "Suppose I am not in charge of the module or the superclass."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1543303108, "post_id": 53492355, "comment_id": 93858591, "body": "Shame (or not depending how much sanity you like) that you can&#39;t edit <code>SomeModule.ancestors</code>."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1543347241, "post_id": 53492355, "comment_id": 93883468, "body": "I did a quick test, and defining a class method <code>self.ancestors</code> in the child class with the desired order does not work. <code>super</code> must use some other means of looking up the ancestors. You may be able to find some more info in the <a href=\"https://github.com/ruby/ruby/blob/4444025d16ae1a586eee6a0ac9bdd09e33833f3c/spec/ruby/language/super_spec.rb\" rel=\"nofollow noreferrer\">spec for <code>super</code></a>."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 3, "last_activity_date": 1543305055, "last_edit_date": 1592644375, "creation_date": 1543289713, "answer_id": 53492355, "question_id": 53491282, "link": "https://stackoverflow.com/questions/53491282/let-super-call-the-parent-class-over-an-included-module/53492355#53492355", "title": "Let `super` call the parent class over an included module", "body": "<p>No, there is no standard way to force a call to <code>super</code> to walk the ancestors in a specific order. They are walked in a pre-defined order. Take a look at <a href=\"http://ruby-doc.org/core-2.4.0/doc/syntax/calling_methods_rdoc.html#label-Method+Lookup\" rel=\"nofollow noreferrer\">the documentation on calling methods</a>:</p>\n<blockquote>\n<p>When you send a message, Ruby looks up the method that matches the name of the message for the receiver. Methods are stored in classes and modules so method lookup walks these, not the objects themselves.</p>\n<p>Here is the order of method lookup for the receiver's class or module <code>R</code>:</p>\n<ul>\n<li>The prepended modules of <code>R</code> in reverse order</li>\n<li>For a matching method in <code>R</code></li>\n<li>The included modules of <code>R</code> in reverse order</li>\n</ul>\n<p>If <code>R</code> is a class with a superclass, this is repeated with <code>R</code>'s superclass until a method is found.</p>\n<p>Once a match is found method lookup stops.</p>\n</blockquote>\n<p>Since your class <code>Boy</code> includes the module <code>Bipedal</code> directly, and since included modules are searched before the superclass, and since searching stops once a match is found, the superclass <code>Person</code> is never checked.</p>\n<p>The same is true when using <a href=\"http://ruby-doc.org/core-2.4.0/doc/syntax/refinements_rdoc.html#label-Method+Lookup\" rel=\"nofollow noreferrer\">refinements</a> because the lookup always hits included modules before it checks the superclass.</p>\n<p>If you move <code>include Bipedal</code> into the <code>Person</code> class then it will work the way you expect because <code>Boy</code> does not include a module directly, so it will eventually search the superclass where it will find the defined method.</p>\n<p>There may be other creative ways you can accomplish this goal, like the <code>Boy.superclass...</code> example you gave, but you asked if it's possible to change the lookup behavior when calling <code>super</code> and the answer is no per the documentation.</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1543326082, "post_id": 53494530, "comment_id": 93871195, "body": "I love this idea, but when I typed it in, I couldn\u2019t get it to work. I get \u201cprivate method \u2018remove_method\u2019 called for SemiBipedal:Module (NoMethodError)\u201d."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1543326691, "post_id": 53494530, "comment_id": 93871590, "body": "The only place that remove_method seems to work is within the Bipedal module itself\u2026"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1543345426, "post_id": 53494530, "comment_id": 93882626, "body": "Which version of Ruby are you using? <code>remove_method</code> doesn&#39;t appear to be private in 2.5.3. You can always <code>SemiBipedal.send(:remove_method, :two_legs)</code> or <code>module SemiBipedal; remove_method :two_legs; end</code> to kludge around that."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1543364478, "post_id": 53494530, "comment_id": 93890300, "body": "I was using 2.4.0 but I updated it to 2.5.3, re-ran the code (copied straight from yours) and it still gives me that private method error. <code>SemiBipedal.send(:remove_method, :two_legs)</code> works great. Maybe the most straightforward way is to skip an alias module and add <code>Bipedal.send(:remove_method, :two_legs)</code> directly to <code>Boy</code>, assuming <code>Boy</code> doesn&#39;t need the <code>Bipedal</code> version..."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 2, "creation_date": 1543365371, "post_id": 53494530, "comment_id": 93890513, "body": "But <code>Bipedal.send(:remove_method, :two_legs)</code> modifies <code>Bipedal</code> so everything that uses the module will be affected, hence the copy of <code>Bipedal</code> (not alias) and removing <code>two_legs</code> from the copy."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 2, "last_activity_date": 1543303023, "creation_date": 1543303023, "answer_id": 53494530, "question_id": 53491282, "link": "https://stackoverflow.com/questions/53491282/let-super-call-the-parent-class-over-an-included-module/53494530#53494530", "title": "Let `super` call the parent class over an included module", "body": "<p>I don't think you can change how <code>super</code> works and you can't \"<code>super super</code>\" to skip an ancestor but you can use a different ancestor. If you're just including <code>Bipedal</code> for some of its methods and want to skip a few of them then you could do something like this:</p>\n\n<pre><code>SemiBipedal = Bipedal.dup\nSemiBipedal.remove_method(:two_legs)\n\nclass Boy &lt; Person\n  include SemiBipedal\n  #...\nend\n</code></pre>\n\n<p>Of course <code>johnny.is_a? Bipedal</code> won't be true anymore and <code>Boy.ancestors</code> will have <code>SemiBipedal</code> instead of <code>Bipedal</code> at index 1 but that might not matter.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1543468743, "last_edit_date": 1543468743, "creation_date": 1543442648, "answer_id": 53528807, "question_id": 53491282, "link": "https://stackoverflow.com/questions/53491282/let-super-call-the-parent-class-over-an-included-module/53528807#53528807", "title": "Let `super` call the parent class over an included module", "body": "<p>One could use the method <a href=\"https://ruby-doc.org/core-2.2.0/Method.html#method-i-super_method\" rel=\"nofollow noreferrer\">Method#super_method</a> twice. That being a garden-variety Ruby method, I believe it would qualify as a \"standard way\" to let <code>Boy#two_legs</code> invoke <code>Person#two_legs</code> rather than <code>Bipedal#two_legs</code>.</p>\n\n<pre><code>class Boy &lt; Person\n  include Bipedal\n  attr_accessor :name\n  def initialize(name)\n    @name = name\n  end\n  def two_legs\n    method(:two_legs).super_method.super_method.call(@name)\n  end\nend\n\nwillie = Boy.new('Willie')\nwillie.two_legs\nWillie has two human legs.\n</code></pre>\n\n<p>Note the following.</p>\n\n<pre><code>willie.method(:two_legs).super_method.owner\n  #=&gt; Bipedal\nwillie.method(:two_legs).super_method.super_method.owner\n  #=&gt; Person\n</code></pre>\n"}], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 53528807, "answer_count": 3, "score": 3, "last_activity_date": 1543537558, "creation_date": 1543280161, "last_edit_date": 1543537558, "question_id": 53491282, "link": "https://stackoverflow.com/questions/53491282/let-super-call-the-parent-class-over-an-included-module", "title": "Let `super` call the parent class over an included module", "body": "<p>I have class <code>Boy</code> that inherits class <code>Person</code>, and includes module <code>Bipedal</code>. Both <code>Person</code> and <code>Bipedal</code> have versions of <code>#two_legs</code>.</p>\n\n<pre><code>module Bipedal\n  def two_legs(name)\n    puts \"#{name} has exactly two limbs used for walking.\"\n  end\nend\n\nclass Person\n  def two_legs(name)\n    puts \"#{name} has two human legs.\"\n  end\nend\n\nclass Boy &lt; Person\n  include Bipedal\n  attr_accessor :name\n  def initialize(name)\n    @name = name\n  end\n\n  def two_legs\n    super(@name)\n  end\nend\n</code></pre>\n\n<p>Since the <code>Bipedal</code> module is included in <code>Boy</code>, <code>Bipedal#two_legs</code> takes precedence over the <code>Person#two_legs</code>. When I call <code>super</code> on a <code>Boy</code> instance, the module <code>Bipedal</code> takes precedence over the parent class <code>Person</code>.</p>\n\n<pre><code>johnny = Boy.new('Johnny')\njohnny.two_legs\n# &gt;&gt; \"Johnny has exactly two limbs used for walking.\"\n</code></pre>\n\n<p>I want to use one version in one place and the other in another. <code>Bipedal</code> has other stuff, so I can't comment out <code>include Bipedal</code>. Is there some standard way to let <code>Boy#two_legs</code> or <code>super</code> to use the parent class version instead of the module version as follows?</p>\n\n<pre><code>johnny.two_legs\n# &gt;&gt; \"Johnny has two human legs.\"\n</code></pre>\n\n<p>I came up with this:</p>\n\n<pre><code>Boy.superclass.instance_method(:two_legs).bind(self).call(@name)\n</code></pre>\n\n<p>which works in place of <code>super(@name)</code>, but is more complicated than I was expecting.</p>\n\n<p>Again, the question is, is there a standard way to force the parent class to take precedence over the module when calling <code>super</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "heroku", "railstutorial.org"], "comments": [{"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 1, "creation_date": 1543282751, "post_id": 53490994, "comment_id": 93853178, "body": "try changing this line <code>config.root = Rails.root.join(&#39;tmp&#39;).to_s</code>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 1, "creation_date": 1543290761, "post_id": 53490994, "comment_id": 93854805, "body": "Where&#39;s the stacktrace? It should tell you exactly what line is causing the problem.  I agree with @xploshioOn that it&#39;s likely your <code>config.root</code> line because it returns a <code>Pathname</code> object. But it may be that you need a proc. Check this <a href=\"https://github.com/carrierwaveuploader/carrierwave/issues/2192\" rel=\"nofollow noreferrer\">GitHub issue</a> for more."}], "owner": {"reputation": 1, "user_id": 9926547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a806c314db7ce67644f3efc09d2f3da?s=128&d=identicon&r=PG&f=1", "display_name": "twosheds", "link": "https://stackoverflow.com/users/9926547/twosheds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543278235, "creation_date": 1543277774, "last_edit_date": 1543278235, "question_id": 53490994, "link": "https://stackoverflow.com/questions/53490994/typeerror-no-implicit-conversion-of-array-into-string-rails-app-on-heroku-usin", "title": "TypeError (no implicit conversion of Array into String) Rails App on Heroku Using AWS", "body": "<p>I am following Michael Hart's <a href=\"https://www.railstutorial.org/book/_single-page\" rel=\"nofollow noreferrer\">Ruby on Rails Tutorial</a> and am stuck on Chapter 13. I am unable to post images on my Rails app deployed on Heroku, but images work just fine on the development server. My carrier_wave.rb originally looked like</p>\n\n<pre><code>if Rails.env.production?\n  CarrierWave.configure do |config|\n    config.fog_credentials = {\n      # Configuration for Amazon S3\n      :provider              =&gt; 'AWS',\n      :aws_access_key_id     =&gt; ENV['S3_ACCESS_KEY'],\n      :aws_secret_access_key =&gt; ENV['S3_SECRET_KEY'],\n      :region                =&gt; ENV['S3_REGION']\n    }\n    config.fog_directory     =  ENV['S3_BUCKET']\n  end\nend\n</code></pre>\n\n<p>When my carrier_wave.rb looked like this I was getting an error that looked like this</p>\n\n<pre><code>:reason_phrase =&gt; \"Forbidden\"\n</code></pre>\n\n<p>After searching around on SO I found <a href=\"https://stackoverflow.com/questions/27949158/heroku-missing-required-arguments-aws-access-key-id-aws-secret-access-key-f\">this post</a>, and have changed my carrier_wave.rb to look like this</p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.root = Rails.root.join('tmp') # adding these...\n  config.cache_dir = 'carrierwave' # ...two lines\n\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',                        # required\n    :s3_access_key_id      =&gt; ENV['S3_ACCESS_KEY'],                        # required\n    :s3_secret_access_key  =&gt; ENV['S3_SECRET_KEY'],                     # required\n    :region                 =&gt; 'us-east-2',                  # optional, defaults to 'us-east-1'\n    :host                   =&gt; 's3.example.com',             # optional, defaults to nil\n    :endpoint               =&gt; 'https://s3.example.com:8080' # optional, defaults to nil\n  }\n  config.fog_directory  = ENV['S3_Bucket']                             # required\n  config.fog_public     = false                                   # optional, defaults to true\n  config.fog_attributes = {'Cache-Control'=&gt;'max-age=315576000'}  # optional, defaults to {}\nend\n</code></pre>\n\n<p>Now I'm receiving the error </p>\n\n<pre><code>TypeError (no implicit conversion of Array into String)\n</code></pre>\n\n<p>I don't know if this is closer to working than the original carrier_wave.rb</p>\n\n<p>My IAM user has 'AmazonS3FullAccess' as a permission. I have even tried setting the S3 Bucket to public access, but to no success. Any help or advice would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1543363471, "creation_date": 1543363471, "answer_id": 53510120, "question_id": 53490962, "link": "https://stackoverflow.com/questions/53490962/error-while-installing-rails-on-ruby-please-check-the-error-code-and-advise/53510120#53510120", "title": "Error while installing rails on ruby. Please check the error code and advise?", "body": "<p>Turns out there was a miss match b/w the devkit and the bit version. Installed ruby again in 64 bits again and it worked!</p>\n"}], "owner": {"reputation": 113, "user_id": 10435234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RA1DnjQ1h1E/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUSUSggVRzzuE-_38kSQQqJd74q3w/mo/photo.jpg?sz=128", "display_name": "Rafeh Ishtiaq", "link": "https://stackoverflow.com/users/10435234/rafeh-ishtiaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543363471, "creation_date": 1543277535, "question_id": 53490962, "link": "https://stackoverflow.com/questions/53490962/error-while-installing-rails-on-ruby-please-check-the-error-code-and-advise", "title": "Error while installing rails on ruby. Please check the error code and advise?", "body": "<p>So ive been trying to install rails on my windows, but I keep getting this error.\nMY ruby version is  2.3.3p222.</p>\n\n<p>and I have updated my gems to 2.7.8</p>\n\n<p>I have had no trouble in installing any other gems so far and Ive also installed gems like rack or rake prior to this.</p>\n\n<p>This is the error I get-</p>\n\n<pre><code>C:\\Users\\rafeh\\RubymineProjects\\untitled&gt;gem install rails\nTemporarily enhancing PATH to include DevKit...\nBuilding native extensions. This could take a while...\nERROR:  Error installing rails:\n        ERROR: Failed to build gem native extension.\n\n    current directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/websocket-driver-0.7.0/ext/websocket-driver\nC:/Ruby23/bin/ruby.exe -r ./siteconf20181126-14776-9pzyr1.rb extconf.rb\n\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/websocket-driver-0.7.0/ext/websocket-driver\nmake \"DESTDIR=\" clean\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/websocket-driver-0.7.0/ext/websocket-driver\nmake \"DESTDIR=\"\ngenerating websocket_mask-i386-mingw32.def\ncompiling websocket_mask.c\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from websocket_mask.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:131:14: error: size of array 'ruby_check_sizeof_voidp' is negative\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from websocket_mask.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_obj_freeze_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1360:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1361:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1362:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1362:27: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_get':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1400:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1414:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_typed_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1421:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_num2char_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1587:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1588:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1588:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1588:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_class_of':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1949:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_type':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1966:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from websocket_mask.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_clone_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1997:56: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1998:33: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_dup_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2005:42: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2012:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2013:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2013:24: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2027:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2027:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2027:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2035:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2035:26: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2041:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2041:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2041:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c: In function 'method_websocket_mask':\nwebsocket_mask.c:26:23: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:26:23: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:26:23: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:30:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:30:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:30:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:31:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:31:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:31:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:32:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:32:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:32:15: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:35:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:35:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nwebsocket_mask.c:35:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nmake: *** [websocket_mask.o] Error 1\n\nmake failed, exit code 2\n</code></pre>\n\n<p>What do you think might be causing this, please advice.</p>\n"}, {"tags": ["arrays", "ruby", "regex", "select"], "comments": [{"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 0, "creation_date": 1543389413, "post_id": 53490528, "comment_id": 93897069, "body": "if you wanted to filter based on regexp (given question is not clear), then you can use <code>array.grep(&#47;want_this&#47;)</code> or <code>pattern = &#47;want_this&#47;</code> followed by <code>array.grep(pattern)</code> ... to get other than matching elements, use <code>grep_v</code> instead of <code>grep</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543281007, "post_id": 53490541, "comment_id": 93852858, "body": "Jose, note that <code>&quot;do_not_want_this&quot;.match?(&#47;want_this&#47;) #=&gt; true</code>. If <code>false</code> is desired here add anchors (<code>&#47;\\Awant_this\\z&#47;</code>, where <code>\\A</code> and <code>\\z</code> are the  beginning and end of string), or, better, as suggested in this answer, simply <code>line == &#39;want_this&#39;</code>."}, {"owner": {"reputation": 1369, "user_id": 393977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/L6Klf.jpg?s=128&g=1", "display_name": "Jose Villalta", "link": "https://stackoverflow.com/users/393977/jose-villalta"}, "edited": false, "score": 0, "creation_date": 1543336609, "post_id": 53490541, "comment_id": 93877790, "body": "Thank you, I wasn&#39;t trying to get exact matches. The context is some ruby that parses a DNS zone-transfer query. The CNAMES that it was returning had unwanted results...long story. I thought I&#39;d simplify my coding sample."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1543274275, "creation_date": 1543274275, "answer_id": 53490541, "question_id": 53490528, "link": "https://stackoverflow.com/questions/53490528/ruby-variable-regular-expression-in-array-select/53490541#53490541", "title": "Ruby variable regular expression in Array Select", "body": "<p>You include quotes in regex definition:</p>\n\n<pre><code> /\"#{things_i_want}\"/\n</code></pre>\n\n<p>remove them and it should work:</p>\n\n<pre><code>/#{things_i_want}/\n</code></pre>\n\n<p>EDIT:\nBy the way, you don't have to use regex for exact matching, you can use equality check (<code>==</code>) or <code>#include?</code> depending if you need a string to be equal to thing you want or just include it:</p>\n\n<pre><code>&gt; array = [\"want_this\", \"do_not_want\", \"do_not_want\",\"want_this\", \"want_this\"]\n&gt; array.select{|line| line == 'want_this'}\n# =&gt; [\"want_this\", \"want_this\", \"want_this\"]\n&gt; array.select{|line| line.include? 'want_this'}\n# =&gt; [\"want_this\", \"want_this\", \"want_this\"]\n</code></pre>\n"}], "owner": {"reputation": 1369, "user_id": 393977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/L6Klf.jpg?s=128&g=1", "display_name": "Jose Villalta", "link": "https://stackoverflow.com/users/393977/jose-villalta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 53490541, "answer_count": 1, "score": 1, "last_activity_date": 1543336712, "creation_date": 1543274179, "last_edit_date": 1543336712, "question_id": 53490528, "link": "https://stackoverflow.com/questions/53490528/ruby-variable-regular-expression-in-array-select", "title": "Ruby variable regular expression in Array Select", "body": "<p>I'm trying to exclude elements from an array of strings using <code>array.select</code>. I have this method:</p>\n\n<pre><code>def filter_out_other_bad_vals(array_of_strs, things_i_want)\n  array_of_strs = array_of_strs.select { |line| /\"#{things_i_want}\"/.match(line) } \nend \n</code></pre>\n\n<p>I want to pass a string as a variable <code>things_i_want</code>. But this does not return any matches:</p>\n\n<pre><code>array = [\"want_this\", \"do_not_want\", \"do_not_want\",\"want_this\", \"want_this\"]\npattern = 'want_this'\narray = filter_out_other_bad_vals(array, pattern)\n</code></pre>\n\n<p>This returns an empty array. But if I hardcode the value in the match expression, I get what I want. </p>\n\n<pre><code>def filter_out_other_bad_vals(array_of_strs, things_i_want)\n  array_of_strs = array_of_strs.select { |line| /want_this/.match(line) } \nend \n</code></pre>\n\n<p>How do I put a variable in the regex? What am I doing wrong? </p>\n\n<p>I could just traverse the array, check each item, and then save the value in another array, but that's not very ruby-like, is it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activemodel"], "answers": [{"tags": [], "owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "is_accepted": true, "score": 2, "last_activity_date": 1543440930, "last_edit_date": 1543440930, "creation_date": 1543422152, "answer_id": 53523904, "question_id": 53490150, "link": "https://stackoverflow.com/questions/53490150/activemodeldirty-and-json-fields/53523904#53523904", "title": "ActiveModel::Dirty and JSON fields", "body": "<p>After opening an issue on the Rails Github I got a response <a href=\"https://github.com/rails/rails/issues/34537#issuecomment-442265161\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/34537#issuecomment-442265161</a></p>\n\n<p>The change is forced through the attributes for json, jsonb, hstore, and serialized attribute types is what I was told. Source code here: <a href=\"https://github.com/rails/rails/blob/06ab7b27ea1c1ab357085439abacdb464f6742bf/activerecord/lib/active_record/store.rb#L181\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/06ab7b27ea1c1ab357085439abacdb464f6742bf/activerecord/lib/active_record/store.rb#L181</a></p>\n\n<p>The reason I came across this is something I'm no longer trying to attempt as the project I'm working on isn't going to be using ActiveModel::Dirty and isn't going to try tracking the changes the way I was attempting to do it. </p>\n\n<p>So any future generations that come across this issue good luck and feel free to go into that github issue and complain about this not working.</p>\n"}], "owner": {"reputation": 564, "user_id": 9911698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiA9x.jpg?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/9911698/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 1, "accepted_answer_id": 53523904, "answer_count": 1, "score": 4, "last_activity_date": 1543440930, "creation_date": 1543271699, "last_edit_date": 1543334083, "question_id": 53490150, "link": "https://stackoverflow.com/questions/53490150/activemodeldirty-and-json-fields", "title": "ActiveModel::Dirty and JSON fields", "body": "<p>I am using <a href=\"https://api.rubyonrails.org/classes/ActiveModel/Dirty.html\" rel=\"nofollow noreferrer\">ActiveModel::Dirty</a> to track changes made in a form. Now everything is working as I expect. With stuff like phone numbers that get dashes in them when in the form I simply format them and then the phone number will not appear in the list of <code>.changed</code> which is expected behavior. </p>\n\n<p>However I run into an issue where I am using a jsonb field in my Profile model. So the issue is ActiveModel will list the JSONB field as being changed even though I format it specifically to match how it looked before. This is not expected behavior. What's stranger still is that another JSONB column I have does not experience this madness. </p>\n\n<p>The JSONB field I'm having trouble with looks like this \n  <code>\n    store_accessor :user_details, :names, :other_field\n    store_accessor :bank_details, :bank_city, :bank_name\n</code>\n<code>user_details</code> and <code>bank_details</code> are jsonb columns.\nSome things to note: names is an array, other_field is a string.\nbank_city and bank_name are strings.</p>\n\n<p>Can anyone shed some insight into why :user_details specifically is struggling with this issue and not the :bank_details JSON column?</p>\n\n<p>I am suspecting it might be due to me using an array within the :user_details and I suspect that the comparison is being thrown off somewhere in the ActiveModel source code, but maybe I'm wrong?</p>\n\n<p>Edit:\nI have discovered it is definitely because I am using an array for :names. I changed it to be a string and it stopped thinking that the JSON column had been changed. Going to dig into the ActiveModel source code to see if I can find a reason why.</p>\n\n<p>Edit #2:\nFor some reason I thought I solved the issue by doing nothing but I'm a dummy and realized that I had removed something in the form. So this issue still hasn't been solved for me. Any insight would be amazing. I can't figure out from looking into the ActiveModel::Dirty source code why this is happening. I'm not entirely sure where to look. Going to slap in byebugs to see if that helps.</p>\n\n<p>Edit #3:\nSteps to repeat this issue</p>\n\n<p>Create a rails Model with a JSONB column.\nSet store accessors you just need one to do this.\nHave it default using either a validator or formatter to be an empty array.\nGive your model the ActiveModel::Dirty include.\nRun the rails console.\nrun the following commands.\nImagine that user_details is the JSONB column and its store accessor is names.</p>\n\n<pre><code>  a = Profile.user_details\n  a.user_details = { \"names\" =&gt; [{\"first_name\" =&gt; \"\", \"last_name\" =&gt; \"\" }] } # This is to replicate what it would look like in a form when a user is submitting a blank entry.\n  a.changed # This will show that user_details has changed which is correct\n  a.names = []\n  a.changed # This will still show that user_details has changed even though it has been set back to its initial state of an empty array. This would work if it was a string field instead of an array.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "hstore"], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1543274688, "post_id": 53490534, "comment_id": 93851320, "body": "Might be better to link to the <a href=\"https://api.rubyonrails.org\" rel=\"nofollow noreferrer\">official docs</a> and the GitHub repository (if you need a specific version of Rails), APIDock is terribly out of date and apparently abandoned."}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1543275487, "post_id": 53490534, "comment_id": 93851536, "body": "Done, thanks for pointing that out, @muistooshort. I didn&#39;t know APIDock is abandoned (too bad btw :|)"}, {"owner": {"reputation": 1158, "user_id": 2267992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wsP3m.jpg?s=128&g=1", "display_name": "Ryan Rebo", "link": "https://stackoverflow.com/users/2267992/ryan-rebo"}, "edited": false, "score": 0, "creation_date": 1543276666, "post_id": 53490534, "comment_id": 93851854, "body": "Thanks @mrzasa, appreciate that!"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1543276670, "post_id": 53490534, "comment_id": 93851856, "body": "Yeah, a shame, the comments were handy but Rails 4.2.7 and Ruby 1.9.3 (!) is sort of ancient history."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1543275451, "last_edit_date": 1543275451, "creation_date": 1543274205, "answer_id": 53490534, "question_id": 53490127, "link": "https://stackoverflow.com/questions/53490127/column-mistakenly-returning-the-key-from-hstore/53490534#53490534", "title": "Column mistakenly returning the key from HSTORE", "body": "<p><code>.store_accessor</code> is a macro that <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Store/ClassMethods.html#method-i-store_accessor\" rel=\"nofollow noreferrer\">defines accessors for hstore fields</a>. As it's called inside the class body, generated accesstors override ones for DB columns provided by default by ActiveRecord. It looks that you cannot have store field and column with the same name in a model.  </p>\n"}], "owner": {"reputation": 1158, "user_id": 2267992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wsP3m.jpg?s=128&g=1", "display_name": "Ryan Rebo", "link": "https://stackoverflow.com/users/2267992/ryan-rebo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 53490534, "answer_count": 1, "score": 3, "last_activity_date": 1566467465, "creation_date": 1543271557, "last_edit_date": 1566467465, "question_id": 53490127, "link": "https://stackoverflow.com/questions/53490127/column-mistakenly-returning-the-key-from-hstore", "title": "Column mistakenly returning the key from HSTORE", "body": "<p>Ok, I have a weird one here.\nIn a Rails 4.0.13 application, I've added to a model: </p>\n\n<p><code>store_accessor :transcoding_meta, :state</code></p>\n\n<p>Looking at the schema of the model (SongVersion), <code>transcoding_meta</code>'s type is indeed <code>hstore</code>.</p>\n\n<p>Note, there is also a <code>state</code> column on SongVersion, which is a string column.</p>\n\n<pre><code>s = SongVersion.ready.last\ns.transcoding_meta\n=&gt; {\"state\"=&gt;\"finished\"}\n\ns.state\n=&gt; \"finished\"\n</code></pre>\n\n<p>When in fact, the state column in the database is saved as <code>\"active\"</code> as expected.</p>\n\n<p>Why is Rails getting tripped up? Can I really not have an <code>hstore</code> key with the same name as an existing column? Seems it should know the diff.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "csrf", "crud"], "comments": [{"owner": {"reputation": 11638, "user_id": 461294, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EQqHn.jpg?s=128&g=1", "display_name": "vich", "link": "https://stackoverflow.com/users/461294/vich"}, "edited": false, "score": 1, "creation_date": 1543268237, "post_id": 53489097, "comment_id": 93848833, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7203304/warning-cant-verify-csrf-token-authenticity-rails\">WARNING: Can&#39;t verify CSRF token authenticity rails</a>"}], "answers": [{"tags": [], "owner": {"reputation": 630, "user_id": 2232797, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/a79GM.jpg?s=128&g=1", "display_name": "Joe Bauer", "link": "https://stackoverflow.com/users/2232797/joe-bauer"}, "is_accepted": true, "score": 0, "last_activity_date": 1543355641, "creation_date": 1543355641, "answer_id": 53508775, "question_id": 53489097, "link": "https://stackoverflow.com/questions/53489097/why-does-adding-a-file-field-to-my-form-cause-cant-verify-csrf-token/53508775#53508775", "title": "Why does adding a file field to my form cause &quot;can&#39;t verify CSRF token...&quot;", "body": "<p>I found this in another thread, and it solves my problem:</p>\n\n<p>I added the following to my form:</p>\n\n<pre><code>&lt;%= token_tag(nil) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 2232797, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/a79GM.jpg?s=128&g=1", "display_name": "Joe Bauer", "link": "https://stackoverflow.com/users/2232797/joe-bauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 53508775, "answer_count": 1, "score": 0, "last_activity_date": 1543355641, "creation_date": 1543266522, "last_edit_date": 1543355601, "question_id": 53489097, "link": "https://stackoverflow.com/questions/53489097/why-does-adding-a-file-field-to-my-form-cause-cant-verify-csrf-token", "title": "Why does adding a file field to my form cause &quot;can&#39;t verify CSRF token...&quot;", "body": "<p>I have (probably) a simple problem that I can't seem to wrap my head around. </p>\n\n<p>I have a simple form to edit a <code>tenant</code> object in my rails application. It works as expected.</p>\n\n<p>However, when I add the <code>&lt;%= f.file_field :logo %&gt;</code> line into my form, I get the <code>Can't verify CSRF token authenticity.</code> error. </p>\n\n<p><strong>My question:</strong>\nWhy does adding the file_field result in this CSRF error?</p>\n\n<p>The form in question: </p>\n\n<pre><code>....\n&lt;%= form_for(tenant,:html=&gt;{:id=&gt;\"your_form_id\",:multipart =&gt; true,:remote=&gt;true}) do |f| %&gt;\n  &lt;%= render 'errors/form_errors', object: @tenant %&gt;\n\n  &lt;div id=\"login-form\"&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.text_field :name, placeholder: \"name\" %&gt;\n    &lt;/div&gt;\n    &lt;/br&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.email_field :email, placeholder: \"email\" %&gt;\n    &lt;/div&gt;\n    &lt;/br&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.phone_field :phone, id: \"phoneNumber\", placeholder: \"(XXX) XXX-XXXX\", onkeypress:\"return numberPressed(event);\" %&gt;\n    &lt;/div&gt;\n    &lt;/br&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;%= f.file_field :logo %&gt; //WORKS FINE WITHOUT THIS FIELD!\n    &lt;/div&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit id: \"login-button\", class: \"btn-outline-primary\", value: \"Save\",'data-disable-with':\"Wait...\" %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n&lt;% end %&gt;\n....\n</code></pre>\n\n<p>additionally, here is the code that brings up the form. Not sure if it has any relevance.</p>\n\n<p>This is the code in the file that brings up my form: <code>edit.js.erb</code></p>\n\n<pre><code>closeLightbox();\n$(\"body\").prepend('&lt;%= escape_javascript(render 'edit', tenant: @tenant) %&gt;');\n</code></pre>\n\n<p>EDIT: I have found a solution, although I don't really understand why it is necessary. See answer below.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mobility"], "comments": [{"owner": {"reputation": 25857, "user_id": 820254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb7f91e7b7b3457ca57701a40f920f2a?s=128&d=identicon&r=PG", "display_name": "Chris Salzberg", "link": "https://stackoverflow.com/users/820254/chris-salzberg"}, "edited": false, "score": 0, "creation_date": 1544306987, "post_id": 53488383, "comment_id": 94231372, "body": "This is a bug, it was fixed in 0.8.7: <a href=\"https://github.com/shioyama/mobility/releases/tag/v0.8.7\" rel=\"nofollow noreferrer\">github.com/shioyama/mobility/releases/tag/v0.8.7</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 837015, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/540420d4ae645ea7f308a8bbd3e95820?s=128&d=identicon&r=PG", "display_name": "MendelGusmao", "link": "https://stackoverflow.com/users/837015/mendelgusmao"}, "edited": false, "score": 0, "creation_date": 1543317702, "post_id": 53492629, "comment_id": 93866218, "body": "Sounds weird. The purpose of Mobility  is to automate fetching some values related to a locale instead. Under the i18 scope it is possible to execute <code>where(name: &#39;Java&#39;)</code> with the JSONB backend translating it to the proper JSON query. Also, as of 0.8.2 there is support for pluck, select and group and as far as I understand, these should reproduce the behavior of <code>where()</code>"}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1543291872, "creation_date": 1543291872, "answer_id": 53492629, "question_id": 53488383, "link": "https://stackoverflow.com/questions/53488383/calling-obj-i18-pluck-in-a-model-with-a-jsonb-backend-gives-a-typeerror/53492629#53492629", "title": "Calling obj.i18.pluck in a model with a jsonb backend gives a TypeError", "body": "<p><code>i18</code> wants to translate strings but you're feeding it JSONB. Try:</p>\n\n<pre><code>Skill.i18.pluck(\"name -&gt; 'pt-BR'\").take(5)\n</code></pre>\n\n<p>That should pluck the value of the key <code>pt-BR</code> (e.g., <code>Ruby</code>, <code>Java</code>, etc.) and feed it through the i18 translator, rather than supplying the full JSONB payload to the translator.</p>\n"}], "owner": {"reputation": 31, "user_id": 837015, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/540420d4ae645ea7f308a8bbd3e95820?s=128&d=identicon&r=PG", "display_name": "MendelGusmao", "link": "https://stackoverflow.com/users/837015/mendelgusmao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543291872, "creation_date": 1543263375, "question_id": 53488383, "link": "https://stackoverflow.com/questions/53488383/calling-obj-i18-pluck-in-a-model-with-a-jsonb-backend-gives-a-typeerror", "title": "Calling obj.i18.pluck in a model with a jsonb backend gives a TypeError", "body": "<p>I'm using Mobility 0.8.4 and when I try to pluck an attribute from a model, it raises a TypeError.</p>\n\n<pre><code># models/skill.rb\nclass Skill &lt; ApplicationRecord\n  extend Mobility\n\n  translates :name, backend: :jsonb\nend\n\n# db/schema.rb\ncreate_table \"skills\" do |t|\n  ...\n  t.jsonb \"name\", default: {}\n  ...\nend\n</code></pre>\n\n<p>Then...</p>\n\n<pre><code>irb(main):001:0&gt; Skill.pluck(:name).take(5)\n   (1.9ms)  SELECT \"skills\".\"name\" FROM \"skills\"\n=&gt; [{\"pt-BR\"=&gt;\"Ruby\"}, {\"pt-BR\"=&gt;\"Java\"}, {\"pt-BR\"=&gt;\"PHP\"}, {\"pt-BR\"=&gt;\"Python\"}, {\"pt-BR\"=&gt;\"C++\"}]\n\nirb(main):002:0&gt; Skill.i18.pluck(:name).take(5)\nTraceback (most recent call last):\n        1: from (irb):2\nTypeError (no implicit conversion of Mobility::Arel::Nodes::Jsonb into String)\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "openssl"], "answers": [{"comments": [{"owner": {"reputation": 7429, "user_id": 197302, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/cb3f8a2021f4528c6e96896f6b217e82?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/197302/toby"}, "edited": false, "score": 0, "creation_date": 1543663554, "post_id": 53488859, "comment_id": 94005279, "body": "Thanks, the en/decode was a typo. I didn&#39;t know about being able to read directly though!"}], "tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1543265449, "creation_date": 1543265449, "answer_id": 53488859, "question_id": 53488230, "link": "https://stackoverflow.com/questions/53488230/creating-a-new-openssl-ec-point-using-prime256v1-and-a-known-public-key/53488859#53488859", "title": "Creating a new OpenSSL EC Point using prime256v1 and a known public key", "body": "<p>First of all, that string is already base64 encoded, so you need to <em>de</em>code it, not <em>en</em>code it:</p>\n\n<pre><code>decoded_public = Base64.decode64(public)\n</code></pre>\n\n<p>The result you get is a DER encoded structure containing the key, so trying to look at the bytes directly isn\u2019t going to get you anywhere (you can see what it contains using <code>OpenSSL::ASN1.decode(decoded_public)</code>).</p>\n\n<p>You can however use <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/openssl/rdoc/OpenSSL/PKey.html#method-c-read\" rel=\"nofollow noreferrer\"><code>OpenSSL::PKey::read</code></a> directly on <code>decoded_public</code>, which will give you an <code>OpenSSL::PKey::EC</code> object (with the correct group). To get the associated point you can just call <a href=\"https://ruby-doc.org/stdlib-2.5.3/libdoc/openssl/rdoc/OpenSSL/PKey/EC.html#method-i-public_key\" rel=\"nofollow noreferrer\"><code>public_key</code></a>:</p>\n\n<pre><code>key = OpenSSL::PKey.read decoded_public\npoint = key.public_key\n</code></pre>\n\n<p>The result is an <code>OpenSSL::PKey::EC::Point</code> object.</p>\n"}], "owner": {"reputation": 7429, "user_id": 197302, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/cb3f8a2021f4528c6e96896f6b217e82?s=128&d=identicon&r=PG", "display_name": "Toby", "link": "https://stackoverflow.com/users/197302/toby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 53488859, "answer_count": 1, "score": 2, "last_activity_date": 1543265449, "creation_date": 1543262721, "question_id": 53488230, "link": "https://stackoverflow.com/questions/53488230/creating-a-new-openssl-ec-point-using-prime256v1-and-a-known-public-key", "title": "Creating a new OpenSSL EC Point using prime256v1 and a known public key", "body": "<p>I'm trying to turn a known public key into an instance of <code>OpenSSL::PKey::EC::Point</code> with the following code:</p>\n\n<pre><code>require 'base64'\nrequire 'openssl'\n\npublic = 'MDkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDIgAD5tgZhw82GpGYJYkWNgeDp/0OzT4y/YLS+tMpZeJ2VEQ='\n\ndecoded_public = Base64.encode64(public)\nhex_string = decoded_public.each_byte.map { |b| b.to_s(16) }.join()\n\nec_group = OpenSSL::PKey::EC::Group.new('prime256v1')\nkey = OpenSSL::PKey::EC.new(ec_group)\nbn = OpenSSL::BN.new(hex_string, 16)\npoint = OpenSSL::PKey::EC::Point.new(ec_group, bn)\n</code></pre>\n\n<p>The error occurs on the last line, throwing:</p>\n\n<pre><code>`initialize': invalid encoding (OpenSSL::PKey::EC::Point::Error)\n</code></pre>\n\n<p>I run <code>Base64.encode64</code> and then turn each byte into a hex representation because from reading around it seems like hex strings are a common way of creating a new BigNum.</p>\n\n<p>I'm guessing it is something I'm doing wrong with the public key information, because the <code>ec_group</code> gets created without complaint.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "iframe", "sinatra", "content-security-policy"], "owner": {"reputation": 265, "user_id": 4252525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MSSy0.jpg?s=128&g=1", "display_name": "Makrau", "link": "https://stackoverflow.com/users/4252525/makrau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543319014, "creation_date": 1543262224, "last_edit_date": 1543319014, "question_id": 53488122, "link": "https://stackoverflow.com/questions/53488122/how-to-config-sinatra-to-put-csp-on-response-header", "title": "How to config Sinatra to put CSP on response header", "body": "<p>I have an application that has a page that needs to be displayed in an iframe of another application. However, it currently has the <code>X-Frame-Options = sameorigin</code> setting, to avoid clickjacking, but also prevents the display in iframes in another application. Changing from <code>sameorigin</code> to <code>allow-from</code> does not solve my problem since Chrome and Safari do not support this setting and release to view in iframes for any domain, being that I want to release to only a specific domain to reduce the chance of clickjacking.</p>\n\n<p>As I researched the problem, I found that Chrome and Safari use CSP (Content Security Policy), which has the <code>frame-ancestors</code> setting that could be used to solve my problem.</p>\n\n<p>However, I am not able to make the Padrino/ Sinatra insert this setting in the response header.</p>\n\n<p>That's how my <code>config/apps.rb</code> was setted:</p>\n\n<pre><code>Padrino.configure_apps do\n  set :session_secret, '&lt;some session secret&gt;'\n  set :protection, :except =&gt; :path_traversal\n  set :protect_from_csrf, true\nend\n</code></pre>\n\n<p>That's the code wroted to try solve my problem with CSP:</p>\n\n<pre><code>Padrino.configure_apps do\n  set :session_secret, '&lt;some session secret&gt;'\n  set :protection, {:use =&gt; [:content_security_policy], :except =&gt; [:path_traversal, :frame_options], :frame_ancestors =&gt; \"self &lt;domain that will open my page in an iframe&gt;\"}\n  set :protect_from_csrf, true\nend\n</code></pre>\n\n<p>Response Headers on Chrome:</p>\n\n<pre><code>HTTP/1.1 200 OK\nServer: nginx/1.15.6\nDate: Mon, 26 Nov 2018 19:52:42 GMT\nContent-Type: text/html;charset=utf-8\nContent-Length: 18327\nConnection: keep-alive\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\n</code></pre>\n\n<p>the problem is that CSP is not being added to the header. the <code>:except</code> is properly disabling the settings that are turned on by default, but the <code>:use</code> is not enabling those that are turned off by default. I'm following this <a href=\"https://github.com/sinatra/sinatra/blob/master/rack-protection/lib/rack/protection.rb\" rel=\"nofollow noreferrer\">module</a> for reference. I can only think that I'm using it in the wrong way, but I don't see how it should be used instead.</p>\n\n<p><a href=\"https://github.com/sinatra/sinatra/blob/master/rack-protection/lib/rack/protection/content_security_policy.rb\" rel=\"nofollow noreferrer\">CSP rack::protection</a> for reference.</p>\n"}, {"tags": ["ruby", "module", "hook"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1543268644, "post_id": 53487250, "comment_id": 93849008, "body": "The tiniest of points: you can write <code>base.send :extend, ClassMethods</code> as simply <code>base.extend ClassMethods</code>."}], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 160272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813f535246722b7bf02aacc9ce818de8?s=128&d=identicon&r=PG", "display_name": "showaltb", "link": "https://stackoverflow.com/users/160272/showaltb"}, "edited": false, "score": 0, "creation_date": 1543263399, "post_id": 53488268, "comment_id": 93846629, "body": "An alternative to the <code>@_adding_a_method</code> option is to remove the method name from <code>@methods_to_hook_before</code> before calling <code>define_method</code>. Instead of <code>@methods_to_hook_before.each do |method_name|</code>, use something like <code>while method_name = @methods_to_hook_before.shift</code>"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 6, "last_activity_date": 1543262863, "creation_date": 1543262863, "answer_id": 53488268, "question_id": 53487250, "link": "https://stackoverflow.com/questions/53487250/stack-level-too-deep-with-method-added-ruby/53488268#53488268", "title": "Stack Level too deep with method_added ruby", "body": "<p>You've caused an infinite recursion because you're calling <code>define_method</code> inside <code>method_added</code>. The stack trace (which you haven't provided unfortunately) should show this.</p>\n\n<p>A slightly ugly workaround to resolve this could be to explicitly set a variable (e.g. <code>@_adding_a_method</code>) and use it as a guard clause for <code>method_added</code>:</p>\n\n<pre><code>module ClassMethods\n  def method_added(method)\n    return if @_adding_a_method\n\n    if @hooker_before.present? &amp;&amp; @methods_to_hook_before.include?(method)\n      # ...\n\n      @_adding_a_method = true\n      define_method(method_name) do |*args, &amp;block|\n        # ...\n      end\n      @_adding_a_method = false\n\n      # ...\n    end\n  end\nend\n</code></pre>\n\n<p><strong>However</strong>, taking a step back, I'm not really sure what this module is trying to achieve. Couldn't you just achieve this with <a href=\"https://ruby-doc.org/core/Module.html#method-i-prepend\" rel=\"noreferrer\"><code>Module#prepend</code></a> instead of this meta-programming?</p>\n\n<p>This code reminds me of what you might find in an old Ruby 1.8/1.9 tutorial on advanced meta-programming techniques; <code>Module#prepend</code> makes such workarounds redundant for the most part.</p>\n"}], "owner": {"reputation": 2285, "user_id": 4620141, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10152601898256854/picture?type=large", "display_name": "David Geismar", "link": "https://stackoverflow.com/users/4620141/david-geismar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 53488268, "answer_count": 1, "score": 1, "last_activity_date": 1543262863, "creation_date": 1543257997, "question_id": 53487250, "link": "https://stackoverflow.com/questions/53487250/stack-level-too-deep-with-method-added-ruby", "title": "Stack Level too deep with method_added ruby", "body": "<p>I have created a module to hook methods before a method call in a class :</p>\n\n<pre><code>module Hooks\n\ndef self.included(base)\n base.send :extend, ClassMethods\nend\n\n\nmodule ClassMethods\n  # everytime we add a method to the class we check if we must redifine it\n  def method_added(method)\n    if @hooker_before.present? &amp;&amp; @methods_to_hook_before.include?(method)\n      hooked_method = instance_method(@hooker_before)\n      @methods_to_hook_before.each do |method_name|\n        begin\n          method_to_hook = instance_method(method_name)\n        rescue NameError =&gt; e\n          return\n        end\n        define_method(method_name) do |*args, &amp;block|\n          hooked_method.bind(self).call\n          method_to_hook.bind(self).(*args, &amp;block) ## your old code in the method of the class\n        end\n      end\n     end\n   end\n\n  def before(*methods_to_hooks, hookers)\n   @methods_to_hook_before = methods_to_hooks\n   @hooker_before = hookers[:call]\n  end\n end\nend\n</code></pre>\n\n<p>I have included the module in one of my class :</p>\n\n<pre><code>require_relative 'hooks'\n\nclass Block\n  include Indentation\n  include Hooks\n  attr_accessor :file, :indent\n  before :generate, call: :indent\n  # after  :generate, call: :write_end\n\n  def initialize(file, indent=nil)\n    self.file = file\n    self.indent = indent\n  end\n\n  def generate\n    yield\n  end\nend\n</code></pre>\n\n<p>this Block class is parent to another class that is implementing its own version of the generate method and that is actually implemented.  </p>\n\n<p>When my code is running method_added is actually called with method :generate as argument in some kind of infinite loop. I can't figure out why method_added is caught in this infinite loop. Do you know what's wrong with this code ?\nHere's a link to the full code :\n<a href=\"https://github.com/davidgeismar/test-automation/tree/master/lib/tasks\" rel=\"nofollow noreferrer\">link to code on github</a></p>\n"}, {"tags": ["json", "ruby", "hash"], "comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1543254656, "post_id": 53486494, "comment_id": 93842648, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5348449/get-a-particular-key-value-from-json-in-ruby\">Get a particular key value from json in ruby</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543254855, "post_id": 53486494, "comment_id": 93842732, "body": "<code>=&gt;</code> doesn&#39;t look like JSON, that looks like a Ruby hash. So, what exactly is your input? A string containing some JSON? Or a Ruby hash?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9753902"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1543254890, "post_id": 53486494, "comment_id": 93842751, "body": "@MarcinKo\u0142odziej That link is useless to me, I have tried already and it didn&#39;t work. I get <code>uninitialized constant</code> for <code>ActiveSupport</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1543254904, "post_id": 53486494, "comment_id": 93842758, "body": "Wait, this isn&#39;t even JSON, this is a simple hash. This is so easily googlable, have you really tried to google a solution? It&#39;s <code>hash[&quot;token&quot;]</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9753902"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543254953, "post_id": 53486494, "comment_id": 93842784, "body": "@spickermann It is technically a hash but I figured they were the same thing as a json object in ruby since I have been able to use them in API calls where it required json"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9753902"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1543255000, "post_id": 53486494, "comment_id": 93842801, "body": "@MarcinKo\u0142odziej If I had found it on google I would not have posted here...."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543255289, "post_id": 53486494, "comment_id": 93842940, "body": "@JoshKirby No, a Ruby hash isn&#39;t the same as a JSON string. Perhaps you are runig a library that translates parameters automatically?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1543255345, "post_id": 53486494, "comment_id": 93842965, "body": "<a href=\"https://docs.ruby-lang.org/en/2.0.0/Hash.html\" rel=\"nofollow noreferrer\">This</a> is the first result in google after searching for &quot;ruby hash value&quot;, <a href=\"http://ruby-for-beginners.rubymonstas.org/built_in_classes/hashes.html\" rel=\"nofollow noreferrer\">this</a> is the third one. Hashes are one of the most common data structures in Ruby and it does sound improbable that you have not been able to find an answer."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1543255546, "creation_date": 1543255546, "answer_id": 53486716, "question_id": 53486494, "link": "https://stackoverflow.com/questions/53486494/parsing-ruby-json-hash-to-get-single-value/53486716#53486716", "title": "Parsing Ruby JSON/hash to get single value", "body": "<p>Ruby Hash objects and JSON \"objects\" might seem similar superficially but there's important differences.</p>\n\n<p>Ruby's internal Hash looks like this when expressed with <code>inspect</code>:</p>\n\n<pre><code>{\"token\"=&gt;\"&lt;my token&gt;\", \"dc\"=&gt;\"test-dc\"}\n</code></pre>\n\n<p>Whereas JSON, which is a language-neutral data format inspired by JavaScript, looks like:</p>\n\n<pre><code>{\"token\": \"&lt;my token&gt;\", \"dc\": \"test-dc\"}\n</code></pre>\n\n<p>These are superficially similar, but the important difference is that if you have the former, not as a string but as a <code>Hash</code>, you can just use it:</p>\n\n<pre><code>hash[\"token\"]\n</code></pre>\n\n<p>If you have the latter you'll need to parse it with something like <code>JSON.load</code>:</p>\n\n<pre><code>JSON.load('{\"token\": \"&lt;my token&gt;\", \"dc\": \"test-dc\"}')[\"token\"]\n</code></pre>\n\n<p>Of course if you have Ruby and want JSON you can always dump it:</p>\n\n<pre><code>JSON.dump({\"token\"=&gt;\"&lt;my token&gt;\", \"dc\"=&gt;\"test-dc\"})\n# =&gt; \"{\\\"token\\\":\\\"&lt;my token&gt;\\\",\\\"dc\\\":\\\"test-dc\\\"}\n</code></pre>\n\n<p>Note that the arguments to <code>dump</code> are actual Ruby code and not a string like in the previous example. The output is a string, and as such, double-quotes need to be escaped with backslash. If you actually <code>print</code> this you'll see it without the extra escaping and it looks normal, that's just an artifact of how Ruby presents strings using <code>inspect</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9753902"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 53486716, "answer_count": 1, "score": -1, "last_activity_date": 1543255546, "creation_date": 1543254542, "question_id": 53486494, "link": "https://stackoverflow.com/questions/53486494/parsing-ruby-json-hash-to-get-single-value", "title": "Parsing Ruby JSON/hash to get single value", "body": "<p>I am very new to ruby and could not find any examples of what I wanted to do though I am sure there is many out there. </p>\n\n<p>I have a ruby json object that I need to get a certain value out of the first key pair in it. Below is the ruby/json and I want to take that and get the <code>token</code> value from it.</p>\n\n<p><code>{\"token\"=&gt;\"&lt;my token&gt;\", \"dc\"=&gt;\"test-dc\"}</code></p>\n\n<p>How do I get the token?</p>\n"}, {"tags": ["ruby", "resources", "puppet"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1543297679, "post_id": 53483737, "comment_id": 93856535, "body": "Your syntax looks fine, though it&#39;s suspicious that the resource type name <code>node_exporter</code> is used unqualified.  Is it a native type?  Also, are you sure <code>$listen_address</code> has a non-empty value? A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would make it a lot easier for us to help you."}, {"owner": {"reputation": 37, "user_id": 5726931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o5B4G.jpg?s=128&g=1", "display_name": "Yannick Dixken", "link": "https://stackoverflow.com/users/5726931/yannick-dixken"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543331331, "post_id": 53483737, "comment_id": 93874452, "body": "Hey John, thanks for your answer. :-) Do i understand it correctly that the Resource Type Name needs to be a native type?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543342034, "post_id": 53483737, "comment_id": 93880870, "body": "No, you can export resources of defined types, too, but if yours is a defined type then I would expect it to be referenced by its fully-qualified name.  At minimum, that&#39;s a matter of good style.  You haven&#39;t presented enough information for me to judge whether you have a <i>bona fide</i> error in that regard."}], "owner": {"reputation": 37, "user_id": 5726931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o5B4G.jpg?s=128&g=1", "display_name": "Yannick Dixken", "link": "https://stackoverflow.com/users/5726931/yannick-dixken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543244504, "creation_date": 1543244022, "last_edit_date": 1543244504, "question_id": 53483737, "link": "https://stackoverflow.com/questions/53483737/exported-resources-not-working-with-puppet", "title": "Exported resources not working with puppet", "body": "<p>I've written a module to set up the Prometheus node_exporter (in here called <code>ni_trending</code>). Now I need to add all FQDNs of the nodes to a simple file:  So declaring an exported resource makes much sense here. PuppetDB is configured and working.</p>\n\n<p>Here's the declaration, within my <code>config.pp</code>:</p>\n\n<pre><code>@@node_exporter { \"${listen_address}\":\n  hostname    =&gt; $ni_trending::hostname,\n  listen_port =&gt; $ni_trending::listen_port,\n}\n</code></pre>\n\n<p>When the module is applied on the node I get following error:</p>\n\n<pre><code>Error: Could not retrieve catalog from remote server: Error 500 on \nSERVER: Server Error: Evaluation Error: Error while evaluating a \nResource Statement, Invalid export in Class[Ni_trending]: {} is not a \nresource on node ydixken-dev01.berlin.ni\n</code></pre>\n\n<p>Within the ni_trending module I'm retrieving all collected resources via:</p>\n\n<pre><code>Node_exporter &lt;&lt;| |&gt;&gt;\n</code></pre>\n\n<p>What is missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "overriding", "spree", "deface"], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 10587677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286e5499a121af0e479956d84224c85?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Andrade", "link": "https://stackoverflow.com/users/10587677/matheus-andrade"}, "is_accepted": false, "score": 0, "last_activity_date": 1543251798, "creation_date": 1543251798, "answer_id": 53485865, "question_id": 53482448, "link": "https://stackoverflow.com/questions/53482448/deface-on-spree-to-override-an-image/53485865#53485865", "title": "Deface on spree to override an image", "body": "<p>I got how it works.</p>\n\n<p>I needed to base myself on the Ruby Assets pipeline, so the path of the images should be at: railsapplication/apps/assets/images/*.png to be used as an override by deface.</p>\n\n<p>Also the code should be:</p>\n\n<pre><code>    Deface:: Override.new(:virutal_path =&gt; 'spree/shared/_header', #change this at need\n      :name =&gt; 'change store logo', #optional\n      :replace =&gt; 'figure#logo' #id that will be replaced located at /_header\n      :text =&gt; \"&lt;%= link_to image_tag('logos/logo_small.png') %&gt;, #Ruby tag included\n    )\n</code></pre>\n\n<p>And should work without a problem.</p>\n"}], "owner": {"reputation": 27, "user_id": 10587677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6286e5499a121af0e479956d84224c85?s=128&d=identicon&r=PG&f=1", "display_name": "Matheus Andrade", "link": "https://stackoverflow.com/users/10587677/matheus-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543251798, "creation_date": 1543239828, "question_id": 53482448, "link": "https://stackoverflow.com/questions/53482448/deface-on-spree-to-override-an-image", "title": "Deface on spree to override an image", "body": "<p>I'm new to Ruby on Rails and I'm developing a smal e-commerce website based on the spree gem.</p>\n\n<p>However I wanted to update/override the front-end part of the website using the spree deface library.</p>\n\n<pre><code>Deface::Override.new(:virtual_path =&gt; 'spree/shared/_header',\n:name =&gt; 'change store logo',\n:replace =&gt; 'figure#logo',\n:text =&gt; \"&lt;%= image_tag('/images/logo.png') %&gt;\"\n</code></pre>\n\n<p>This is my code, but it after reloading the page, the logo gets replaced only by a word 'Logo' and not the image itself. Am I targeting the wrong path? Where should the image files for override be put at?</p>\n\n<p>This is the html of the page:</p>\n\n<pre><code>    &lt;div id=\"spree-header\"&gt;\n  &lt;header id=\"header\" data-hook&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;div class=\"row\"&gt;\n        &lt;figure id=\"logo\" class=\"col-md-4 col-sm-3\" data-hook&gt;\n          &lt;%= logo %&gt;\n        &lt;/figure&gt;\n        &lt;%= render partial: 'spree/shared/nav_bar' %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/header&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;%= render partial: 'spree/shared/main_nav_bar' %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 1, "creation_date": 1543239413, "post_id": 53481988, "comment_id": 93834194, "body": "<a href=\"https://stackoverflow.com/q/31527819/3444240\">may be of help</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 8981593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb7b9960b729c5dba37192f7983eea5?s=128&d=identicon&r=PG&f=1", "display_name": "KosBlo", "link": "https://stackoverflow.com/users/8981593/kosblo"}, "is_accepted": false, "score": 1, "last_activity_date": 1543239274, "creation_date": 1543239274, "answer_id": 53482279, "question_id": 53481988, "link": "https://stackoverflow.com/questions/53481988/how-to-chain-class-methods-together-in-ruby-on-rails/53482279#53482279", "title": "How to chain class methods together in Ruby on Rails?", "body": "<p>Maybe you can use scopes? </p>\n\n<pre><code>scope :payable, -&gt; { open.where.not(:delivery_status =&gt; \"draft\") }\n</code></pre>\n\n<p>You can use this like that</p>\n\n<pre><code>YouModel.payable\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 1, "creation_date": 1543241868, "post_id": 53482786, "comment_id": 93835768, "body": "&quot;This is exactly the same as defining a class method, and which you use is a matter of personal preference&quot;. From the documentation you linked"}], "tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": true, "score": 2, "last_activity_date": 1543296025, "last_edit_date": 1543296025, "creation_date": 1543240959, "answer_id": 53482786, "question_id": 53481988, "link": "https://stackoverflow.com/questions/53481988/how-to-chain-class-methods-together-in-ruby-on-rails/53482786#53482786", "title": "How to chain class methods together in Ruby on Rails?", "body": "<p>To chain negated queries you can use this trick:</p>\n\n<pre><code>def self.payable\n  open.where.not(id: draft)\nend\n</code></pre>\n\n<p>Another alternative if you don't care if an <code>ActiveRecord::Relation</code> object is returned is using <code>-</code>, which returns an <code>Array</code>:</p>\n\n<pre><code>def self.payable\n  open - draft\nend\n</code></pre>\n\n<p>I would personally use <code>scope</code>s instead of class methods for queries: <a href=\"https://guides.rubyonrails.org/active_record_querying.html#scopes\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_querying.html#scopes</a>. So:</p>\n\n<pre><code>scope :draft, -&gt; { where(:delivery_status =&gt; \"draft\") }\nscope :open, -&gt; { where(:payment_status =&gt; \"open\") }\nscope :payable, -&gt; { open.where.not(id: draft) }\n</code></pre>\n"}], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 53482786, "answer_count": 2, "score": 1, "last_activity_date": 1543296025, "creation_date": 1543238272, "question_id": 53481988, "link": "https://stackoverflow.com/questions/53481988/how-to-chain-class-methods-together-in-ruby-on-rails", "title": "How to chain class methods together in Ruby on Rails?", "body": "<p>I've got this in my Rails 5 model:</p>\n\n<pre><code>def self.payable\n  open.where.not(:delivery_status =&gt; \"draft\")\nend\n\ndef self.draft\n  where(:delivery_status =&gt; \"draft\")\nend\n\ndef self.open\n  where(:payment_status =&gt; \"open\")\nend\n</code></pre>\n\n<p>Is there a more elegant way to write the first method? </p>\n\n<p>It would be great to chain the <code>open</code> and <code>draft</code> methods together like this:</p>\n\n<pre><code>def self.payable\n  open.not(:draft)\nend\n</code></pre>\n\n<p>Unfortunately, this doesn't work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "api", "mongoid"], "comments": [{"owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "edited": false, "score": 3, "creation_date": 1543238063, "post_id": 53481794, "comment_id": 93833322, "body": "can I see <code>get_params</code> method?"}, {"owner": {"reputation": 75, "user_id": 8582768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798e9a6b2aaf359c77091ff0e730ae43?s=128&d=identicon&r=PG&f=1", "display_name": "huntz rahmadi", "link": "https://stackoverflow.com/users/8582768/huntz-rahmadi"}, "reply_to_user": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "edited": false, "score": 0, "creation_date": 1543273574, "post_id": 53481794, "comment_id": 93850958, "body": "@HardikUpadhyayi already add the get params sory for that"}, {"owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "edited": false, "score": 1, "creation_date": 1543296761, "post_id": 53481794, "comment_id": 93856226, "body": "huntz please follow @Ana Mar&#237;a Mart&#237;nez G&#243;mez answer, if you still face any issue than let us know."}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1543242393, "creation_date": 1543242393, "answer_id": 53483218, "question_id": 53481794, "link": "https://stackoverflow.com/questions/53481794/rails-undefined-method-persisted/53483218#53483218", "title": "Rails undefined method `persisted?&#39;", "body": "<p>As far as I understand, <code>push</code> accepts a record (a model), not a hash of params:</p>\n\n<pre><code>label = Label.first\nlabel.bands.push(Band.first)\n</code></pre>\n\n<p><a href=\"https://docs.mongodb.com/mongoid/current/tutorials/mongoid-relations/#dependent-behaviour\" rel=\"nofollow noreferrer\">Docs</a>\nMongoid checks if the model is persisted, that's why <code>#persisted?</code> is called on <code>ActionController::Parameters</code> that you pass there.</p>\n\n<p>Try sth like</p>\n\n<pre><code>@merchant.order.push(Order.new(get_params))\n</code></pre>\n\n<p>if <code>order</code> is has_many relationship or</p>\n\n<pre><code>@merchant.order = Order.new(get_params)\n</code></pre>\n\n<p>if <code>order</code> is has_one relationship.</p>\n"}, {"tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": true, "score": 3, "last_activity_date": 1543244002, "last_edit_date": 1543244002, "creation_date": 1543243655, "answer_id": 53483603, "question_id": 53481794, "link": "https://stackoverflow.com/questions/53481794/rails-undefined-method-persisted/53483603#53483603", "title": "Rails undefined method `persisted?&#39;", "body": "<p><code>push</code> accept an instance of <code>Order</code> and I assume you are passing something like <code>ActionController::Parameters</code>. Also, <code>push</code> always returns an association. I think if this failed, it would be with an exception and then the <code>if</code> makes no sense. I suggest to use <code>create</code> instead. So (assuming get_params is an instance of <code>ActionController::Parameters</code> or a <code>Hash</code> and that <code>order</code> is a <code>has_many</code> relationship): </p>\n\n<pre><code>if @merchant.order.create(get_params)\n   render json: {:response =&gt; true, :status =&gt; \"ok\"}\n  else\n   render json: {:response =&gt; false, :status =&gt; \"ok\"}\n  end\nend\n</code></pre>\n\n<p>If it is a <code>hash_one</code> relationship, it should be something like:</p>\n\n<pre><code>params = get_params.merge(merchant: @merchant)\nif @Order.create(params)\n   render json: {:response =&gt; true, :status =&gt; \"ok\"}\n  else\n   render json: {:response =&gt; false, :status =&gt; \"ok\"}\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8582768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798e9a6b2aaf359c77091ff0e730ae43?s=128&d=identicon&r=PG&f=1", "display_name": "huntz rahmadi", "link": "https://stackoverflow.com/users/8582768/huntz-rahmadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 53483603, "answer_count": 2, "score": 2, "last_activity_date": 1543273536, "creation_date": 1543237605, "last_edit_date": 1543273536, "question_id": 53481794, "link": "https://stackoverflow.com/questions/53481794/rails-undefined-method-persisted", "title": "Rails undefined method `persisted?&#39;", "body": "<p>I working using rails \nmy project make API using mongodb</p>\n\n<p>and I got this error:</p>\n\n<blockquote>\n  <p>NoMethodError: undefined method `persisted?'for ActionController::Parameters:0x000055f487fc4ac8</p>\n</blockquote>\n\n<p>This error is in my controller on create method:</p>\n\n<pre><code>  def create\n    if @merchant.order.push(get_params)\n     render json: {:response =&gt; true, :status =&gt; \"ok\"}\n    else\n     render json: {:response =&gt; false, :status =&gt; \"ok\"}\n    end\n  end\n\n  def get_params\n  params.required(:order).permit!\n  end\n</code></pre>\n\n<p>This is my model: </p>\n\n<pre><code>class Order\n include Mongoid::Document\n include Mongoid::Timestamps\n\n field :items\n field :grand_total, type: Integer\n\n belongs_to :merchant\nend\n</code></pre>\n\n<p>I appreciate all kind of support, thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tinymce", "haml"], "answers": [{"comments": [{"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1543237516, "post_id": 53481691, "comment_id": 93833000, "body": "undefined method `sanitize&#39; for &quot;&lt;p&gt;&lt;strong&gt;gfhfh&lt;/strong&gt;&lt;/p&gt;&quot;:String"}, {"owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "reply_to_user": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 0, "creation_date": 1543237630, "post_id": 53481691, "comment_id": 93833065, "body": "@VarinderSohal, fixed, sorry i edited my answer as fast as possible, because sanitize is preferable to use instead of html_safe which expose security problem"}, {"owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "edited": false, "score": 1, "creation_date": 1543238049, "post_id": 53481691, "comment_id": 93833314, "body": "Thank you!! so much bro I appreciate your effort ."}], "tags": [], "owner": {"reputation": 784, "user_id": 7970365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30ea30f5ef13a4593ad0eafd20304601?s=128&d=identicon&r=PG", "display_name": "D1ceWard", "link": "https://stackoverflow.com/users/7970365/d1ceward"}, "is_accepted": true, "score": 2, "last_activity_date": 1543237562, "last_edit_date": 1543237562, "creation_date": 1543237250, "answer_id": 53481691, "question_id": 53480759, "link": "https://stackoverflow.com/questions/53480759/how-to-render-tinymce-editor-content-in-haml/53481691#53481691", "title": "how to render tinymce editor content in haml?", "body": "<p>You could use <code>.sanitize</code> method like :</p>\n\n<pre><code>%td.mb-4= sanitize(blog.text)\n</code></pre>\n\n<blockquote>\n  <p>Sanitizes HTML input, stripping all tags and attributes that aren\u2019t whitelisted.</p>\n</blockquote>\n\n<p>You can configure list of whitelisted tags with (for example) :</p>\n\n<pre><code># In config/application.rb\nconfig.action_view.sanitized_allowed_tags = ['strong', 'em', 'a']\nconfig.action_view.sanitized_allowed_attributes = ['href', 'title']\n</code></pre>\n\n<p><a href=\"https://apidock.com/rails/ActionView/Helpers/SanitizeHelper/sanitize\" rel=\"nofollow noreferrer\">.sanitize method doc</a></p>\n"}], "owner": {"reputation": 738, "user_id": 8206178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-20kpbzWvNqw/AAAAAAAAAAI/AAAAAAAAAAs/qNar8diO6Ms/photo.jpg?sz=128", "display_name": "Varinder Sohal", "link": "https://stackoverflow.com/users/8206178/varinder-sohal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 53481691, "answer_count": 1, "score": 2, "last_activity_date": 1618482344, "creation_date": 1543233960, "last_edit_date": 1581309369, "question_id": 53480759, "link": "https://stackoverflow.com/questions/53480759/how-to-render-tinymce-editor-content-in-haml", "title": "how to render tinymce editor content in haml?", "body": "<p>I'm start learning ruby on rails and create blogs. I have integrate tinyMCE editor for blogs content. but i don`t know how to render tinyMCE content for front-end. Now it shows content with as it is html. <a href=\"https://i.stack.imgur.com/5H4hB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5H4hB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Content Rendering Code: </p>\n\n<pre><code>%div.container\n   %h1.text-center Blogs List\n   = link_to 'New Blog', '/admin/blogs/new', :class =&gt; 'btn btn-info'            \n   = link_to 'logout', '/admin/logout' , :class =&gt; 'btn btn-info'\n   %table\n      %tr\n         %th.text-center Title\n         %th.text-center Category\n         %th.text-center Content\n         %th.text-center Feature Image\n         %th.text-center{:colspan =&gt; 3} Operations\n      -@blogs.each do |blog|\n         %tr\n            %td\n               %h4= blog.title\n               %td= render blog.categories\n            %td.mb-4= blog.text  #editor content\n            %td= link_to 'Download', blog.featuredImage_url ,:class=&gt; 'thumbnail'\n            %td= link_to 'Show', admin_blog_path(blog) , :class=&gt;'btn btn-info'\n            %td= link_to 'Edit', edit_admin_blog_path(blog), :class=&gt; 'btn btn-info'\n            %td= link_to 'Destroy', admin_blog_path(blog), :class=&gt; 'btn btn-info', |\n               method: :delete,\n               data: { confirm: 'Are you sure?' }\n</code></pre>\n\n<p>Thankyou!!</p>\n"}, {"tags": ["ruby", "methods", "collections"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1543233208, "post_id": 53480273, "comment_id": 93830698, "body": "For <code>Enumerator</code>, <code>size</code> attempts to calculate the size whereas <code>count</code> actually counts the elements by traversing the entire collection."}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1543235597, "post_id": 53480273, "comment_id": 93831969, "body": "You should read <a href=\"http://web.archive.org/web/20100210204319/http://blog.hasmanythrough.com/2008/2/27/count-length-size\" rel=\"nofollow noreferrer\">web.archive.org/web/20100210204319/http://&hellip;</a>"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1543238394, "post_id": 53480273, "comment_id": 93833516, "body": "<code>count</code> is more suitable when used with a block or argument, something like <code>collection.count { |x| x.price &gt; 10 }</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1543257757, "post_id": 53480273, "comment_id": 93844032, "body": "@Kimmo,  yes, <code>count</code> is more suitable when used with a block or argument, but then <code>size</code> and <code>length</code> take neither an argument nor a block. :-)"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1543272215, "post_id": 53480273, "comment_id": 93850452, "body": "@stefan Yes this. I was pleasantly surprised trying stuff like <code>p (1..200).to_a.combination(9).size</code> , which returns 1175445251780800 almost instantly."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1543257235, "post_id": 53480585, "comment_id": 93843783, "body": "One answer at the link you give provided a link to <a href=\"https://batsov.com/articles/2014/02/17/the-elements-of-style-in-ruby-number-13-length-vs-size-vs-count/\" rel=\"nofollow noreferrer\">this article</a>, which I thought was very helpful."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543264198, "post_id": 53480585, "comment_id": 93846983, "body": "Please also remember that AirBNB is a rails application at heart so their style guide is most likely geared towards this as well. <code>count</code> from an AR perspective is a query execution where as size defers to <code>Array#size</code> thus using size has far less overhead than <code>Select COUNT(*) FROM xxx</code>"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1543264663, "post_id": 53480585, "comment_id": 93847188, "body": "@engineersmnky I haven&#39;t mentioned AR as the guide is named &quot;Ruby Style Guide&quot;while Rubocop&#39;s guides distinguish Ruby vs Rails. I also do not think that the answer is very straightforward in this case, as when getting counts for AR relations, pagination and whether the records have already been loaded comes into play which makes it difficult to write a generalized statement about what is better."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1543264959, "post_id": 53480585, "comment_id": 93847335, "body": "My point was not whether or not you mentioned it but rather that the guide is written by Airbnb and the first line states &quot;This is Airbnb&#39;s Ruby Style Guide.&quot; which implies that it might have some leanings. Which looking at the examples it certainly does. Also Airbnb makes not such distinction but rather included a rather brief Rails section."}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 7, "last_activity_date": 1543233896, "last_edit_date": 1592644375, "creation_date": 1543233315, "answer_id": 53480585, "question_id": 53480273, "link": "https://stackoverflow.com/questions/53480273/are-there-performance-reasons-to-prefer-size-over-length-or-count-in-ruby/53480585#53480585", "title": "Are there performance reasons to prefer size over length or count in Ruby?", "body": "<p>It seems a bit wrong, for most commonly used cases (<code>Array</code>, <code>Hash</code>, <code>String</code>), <code>size</code> and <code>length</code> are either aliases or are implemented in the same way (you can read more <a href=\"https://stackoverflow.com/questions/35816739/what-is-the-difference-between-size-and-length-methods\">here</a> or check the implementation of each method) and will run in <code>O(1)</code>.</p>\n<p><code>count</code> however:</p>\n<ul>\n<li>For <code>Hash</code> is not redefined and will fallback to <a href=\"https://ruby-doc.org/core-2.5.3/Enumerable.html#method-i-count\" rel=\"noreferrer\"><code>Enumerable#count</code></a>, which means its complexity will be <code>O(n)</code> as all key-values will be traversed.</li>\n<li>For <code>Array</code> it is redefined (<a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-count\" rel=\"noreferrer\"><code>Array#count</code></a>) and at the very least it will check the number of arguments given which is something that neither <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-size\" rel=\"noreferrer\"><code>Array#size</code></a> nor <a href=\"https://ruby-doc.org/core-2.5.3/Array.html#method-i-length\" rel=\"noreferrer\"><code>Array#length</code></a> have to do.</li>\n<li>for <code>String</code> it's used to count substrings.</li>\n</ul>\n<p>All in all, I would say that</p>\n<blockquote>\n<p>Prefer <code>size</code> or <code>length</code> over <code>count</code> for performance reasons.</p>\n</blockquote>\n<p>would be more accurate.</p>\n"}], "owner": {"reputation": 185, "user_id": 10284901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xuIJw.jpg?s=128&g=1", "display_name": "jeporcher", "link": "https://stackoverflow.com/users/10284901/jeporcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 1, "accepted_answer_id": 53480585, "answer_count": 1, "score": 4, "last_activity_date": 1543261166, "creation_date": 1543232191, "last_edit_date": 1543261166, "question_id": 53480273, "link": "https://stackoverflow.com/questions/53480273/are-there-performance-reasons-to-prefer-size-over-length-or-count-in-ruby", "title": "Are there performance reasons to prefer size over length or count in Ruby?", "body": "<p>In <a href=\"https://github.com/airbnb/ruby\" rel=\"nofollow noreferrer\">Airbnb's Ruby Style Guide</a> one reads:</p>\n\n<blockquote>\n  <p>Prefer <code>size</code> over either <code>length</code> or <code>count</code> for performance reasons.</p>\n</blockquote>\n\n<p>What would these be?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "yaml", "errno"], "answers": [{"tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": true, "score": 0, "last_activity_date": 1543230300, "last_edit_date": 1543230300, "creation_date": 1543229998, "answer_id": 53479683, "question_id": 53479588, "link": "https://stackoverflow.com/questions/53479588/how-to-avoid-errnoeisdir-is-a-directory-read-when-run-seed-migration/53479683#53479683", "title": "How to avoid Errno::EISDIR: Is a directory - read when run seed migration?", "body": "<p>The problem is that when <code>post_img</code> is empty/nil, <code>File.open(\"#{images_path}#{post['post_img']}\")</code> is a directory (<code>images_path</code>) instead of a file, as the error message says. You can do something like:</p>\n\n<pre><code>  file = File.open(\"#{images_path}#{post['post_img']}\") if post['post_img'].present?\n  Post.create(\n      title: post['title'],\n      content: post['content'],\n      created_at: post['created_at'],\n      updated_at: post['updated_at'],\n      deleted_at: post['deleted_at'],\n      post_img: file\n  )\n</code></pre>\n\n<p>This will create a post with a nil image in case <code>post_img</code> is empty/nil.</p>\n"}], "owner": {"reputation": 63, "user_id": 10658300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6f164d3ffc4a040412c552ed693bc0?s=128&d=identicon&r=PG&f=1", "display_name": "pfc", "link": "https://stackoverflow.com/users/10658300/pfc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4314, "favorite_count": 1, "accepted_answer_id": 53479683, "answer_count": 1, "score": 2, "last_activity_date": 1543230300, "creation_date": 1543229709, "question_id": 53479588, "link": "https://stackoverflow.com/questions/53479588/how-to-avoid-errnoeisdir-is-a-directory-read-when-run-seed-migration", "title": "How to avoid Errno::EISDIR: Is a directory - read when run seed migration?", "body": "<p>I have hard time with uploading seeds from YAML file- everything works fine until try to upload post without image(image: nil)</p>\n\n<pre><code>#seeds.rb\n    posts_file = Rails.root.join('db', 'seeds', 'fixtures', 'posts.yml')\n    posts = YAML::load_file(posts_file)\n    images_path = Rails.root.join('db', 'seeds', 'fixtures', 'images')\n\n    posts.each do |post|\n\n      Post.create(\n          title: post['title'],\n          content: post['content'],\n          created_at: post['created_at'],\n          updated_at: post['updated_at'],\n          deleted_at: post['deleted_at'],\n          post_img: File.open(\"#{images_path}#{post['post_img']}\")\n      )\n\n    end\n</code></pre>\n\n<p>and YAML file: </p>\n\n<pre><code>-\n  title: 'Title1'\n  content: 'some content for post'\n  created_at: \n  updated_at:\n  deleted_at:\n  post_img: '/image1jpg'\n\n\n-\n  title: 'Title 2'\n  content: 'some content for post'\n  created_at: \n  updated_at:\n  deleted_at:\n  post_img:\n</code></pre>\n\n<p>If I fill both post_img fields it works fine, but when one of these is empty get this error: </p>\n\n<blockquote>\n  <p>Errno::EISDIR: Is a directory</p>\n</blockquote>\n\n<p>which means that it reads whole images folder. How to find a way to avoid this error?</p>\n"}, {"tags": ["json", "ruby", "parsing", "jsonparser", "yajl"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543220237, "post_id": 53476973, "comment_id": 93824071, "body": "any error message from the OS when your app is killed?"}, {"owner": {"reputation": 209, "user_id": 1042066, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2154fff2752768f62317e22249e6130c?s=128&d=identicon&r=PG", "display_name": "kriztean", "link": "https://stackoverflow.com/users/1042066/kriztean"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543220414, "post_id": 53476973, "comment_id": 93824132, "body": "nada @emaillenin, I have been running my tests with <code>rspec</code> and I can see the whole parser printing each element of the array til suddenly I get a <code>Killed</code> stdout. that&#39;s it."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 2, "creation_date": 1543220583, "post_id": 53476973, "comment_id": 93824210, "body": "can you try Oj gem?"}, {"owner": {"reputation": 209, "user_id": 1042066, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2154fff2752768f62317e22249e6130c?s=128&d=identicon&r=PG", "display_name": "kriztean", "link": "https://stackoverflow.com/users/1042066/kriztean"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543222365, "post_id": 53476973, "comment_id": 93825007, "body": "that seems like an option but i need to give it a read. It seems a more like building your own parser <a href=\"http://www.ohler.com/oj/doc/Oj/ScHandler.html\" rel=\"nofollow noreferrer\">ohler.com/oj/doc/Oj/ScHandler.html</a> . have you use it ?"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1543231760, "post_id": 53476973, "comment_id": 93830007, "body": "Did you tried approach described in <a href=\"https://coderwall.com/p/l1omyw/ruby-reading-parsing-and-forwarding-large-json-files-in-small-chunks-i-e-streaming\" rel=\"nofollow noreferrer\"><code>Ruby: reading, parsing and forwarding large JSON files in small chunks (i.e. streaming)</code></a> article? It uses Oj::ScHandler parser but <a href=\"https://stackoverflow.com/a/52876204/4950680\"><code>Yajl::FFI::Parser</code> also supports streaming</a>"}, {"owner": {"reputation": 209, "user_id": 1042066, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2154fff2752768f62317e22249e6130c?s=128&d=identicon&r=PG", "display_name": "kriztean", "link": "https://stackoverflow.com/users/1042066/kriztean"}, "edited": false, "score": 0, "creation_date": 1543314665, "post_id": 53476973, "comment_id": 93864481, "body": "I&#39;m going to try the <code>Oj</code>approach. I have read the <code>Yajl::FFI::Parser</code> approach but this seem mostly to rely on getting the json object from a request (EventMachine).     That is not my case. I already have the json object, I just need to parse the json object."}], "owner": {"reputation": 209, "user_id": 1042066, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2154fff2752768f62317e22249e6130c?s=128&d=identicon&r=PG", "display_name": "kriztean", "link": "https://stackoverflow.com/users/1042066/kriztean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1543220940, "creation_date": 1543219967, "last_edit_date": 1543220940, "question_id": 53476973, "link": "https://stackoverflow.com/questions/53476973/parse-a-massive-json-array-of-hashes", "title": "Parse a massive JSON array of hashes", "body": "<p>I am trying to parse a JSON object that consists of a few hashes and a massive array of hashes (sometimes 300,000 hashes inside the array, 200MB). Here is an example of the JSON object. I need to parse hash by hash inside the array <code>report_datasets</code>.</p>\n\n<p><a href=\"https://api.datacite.org/reports/0cb326d1-e3e7-4cc1-9d86-7c5f3d5ca310\" rel=\"nofollow noreferrer\">https://api.datacite.org/reports/0cb326d1-e3e7-4cc1-9d86-7c5f3d5ca310</a></p>\n\n<pre><code>{ report_header: {report_id: 33738, report_name: \"Report first\"},\n  report_datasets: [\n  {dataset_id:1, yop:1990},\n  {dataset_id:2, yop:2007},\n  {dataset_id:3,  yop:1983},\n  .\n  {dataset_id:578999,yop:1964},\n  ]\n}\n</code></pre>\n\n<p>In every approach I tried, including a few approaches using <code>yajl-ruby</code> and <code>json-streamer</code>, my app is killed. When I use <code>parse_chunk</code>,</p>\n\n<pre><code>def parse_very_large_json\n        options= {symbolize_keys:false}\n        parser = Yajl::Parser.new(options)\n        parser.on_parse_complete = method(:print_each_item)\n\n        report_array = parser.parse_chunk(json_string) \nend\n\ndef print_each_item report\n      report[\"report-datasets\"].each do |dataset|\n      puts \u201cthis is an element of the array\u201c\n      puts dataset\n    end\nend\n</code></pre>\n\n<p>parsing happens, but eventually again it is killed.</p>\n\n<p>The problem seems to be that there is not much difference between <code>Yajl::Parser.new().parse</code> and <code>Yajl::Parser.new().parse_chunk</code> in both approaches that are killed.</p>\n\n<p>How can one parse the elements of such a massive JSON array efficiently without killing the rails app?</p>\n"}, {"tags": ["ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 10005, "user_id": 724036, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6VXVJ.jpg?s=128&g=1", "display_name": "zishe", "link": "https://stackoverflow.com/users/724036/zishe"}, "edited": false, "score": 0, "creation_date": 1543215602, "post_id": 53475499, "comment_id": 93822252, "body": "I don&#39;t see this method <a href=\"https://stripe.com/docs/api/subscriptions/update?lang=ruby\" rel=\"nofollow noreferrer\">here</a>. Retrieve a subscription, set a property and save it."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2805785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e812e48162286ce23ce695389cd1b2a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Kumar", "link": "https://stackoverflow.com/users/2805785/hari-kumar"}, "edited": false, "score": 0, "creation_date": 1543220620, "post_id": 53476773, "comment_id": 93824228, "body": "As you said, if you want to cancel the subscription at the end of the current billing period, we have to update with cancel_at_period_end flag as true. <a href=\"https://stripe.com/docs/billing/subscriptions/canceling-pausing\" rel=\"nofollow noreferrer\">stripe.com/docs/billing/subscriptions/canceling-pausing</a>      subscription = Stripe::Subscription.retrieve(&#39;sub_49ty4767H20z6a&#39;)     subscription.update(cancel_at_period_end: true) There may be issue in stripe gem."}, {"owner": {"reputation": 642, "user_id": 7841637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a2cbdfd3ba468100784c5c463cb824?s=128&d=identicon&r=PG&f=1", "display_name": "hpar", "link": "https://stackoverflow.com/users/7841637/hpar"}, "edited": false, "score": 0, "creation_date": 1543240189, "post_id": 53476773, "comment_id": 93834696, "body": "This appears to be an issue with the documentation rather than an issue with the gem. <code>Stripe::Subscription.update(cancel_at_period_end: true)</code> is the preferred approach per the <a href=\"https://github.com/stripe/stripe-ruby/blob/master/test/stripe/subscription_test.rb#L38\" rel=\"nofollow noreferrer\">test suite</a>`. This also saves an API round trip to retrieve an Subscription that you&#39;re only going to cancel."}], "tags": [], "owner": {"reputation": 31, "user_id": 2805785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e812e48162286ce23ce695389cd1b2a9?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Kumar", "link": "https://stackoverflow.com/users/2805785/hari-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1543218961, "creation_date": 1543218961, "answer_id": 53476773, "question_id": 53475499, "link": "https://stackoverflow.com/questions/53475499/stripe-update-of-subscription-generating-error/53476773#53476773", "title": "Stripe update of subscription generating error", "body": "<p>There is no method as update for subscription object.\nIf you want to cancel the subscription on period end, you need to call the subscription services cancel method. You will need to pass that your customer and subscription id, and then use the cancelAtPeriodEnd flag (set it to true).</p>\n"}, {"tags": [], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "is_accepted": true, "score": 2, "last_activity_date": 1543362151, "creation_date": 1543362151, "answer_id": 53509951, "question_id": 53475499, "link": "https://stackoverflow.com/questions/53475499/stripe-update-of-subscription-generating-error/53509951#53509951", "title": "Stripe update of subscription generating error", "body": "<p>Stripe support confirmed that there is an error in the documentation example. They also stated there were two ways to do this</p>\n\n<pre><code>sub = Stripe::Subscription.retrieve(\"sub_xxxyyyzz\")\nsub.cancel_at_period_end = true\nsub.save\n\nOr\n\nStripe::Subscription.update(\"sub_xxxyyzz\",{:cancel_at_period_end =&gt; true})\n</code></pre>\n"}], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 53509951, "answer_count": 2, "score": 1, "last_activity_date": 1543362151, "creation_date": 1543212163, "last_edit_date": 1543213345, "question_id": 53475499, "link": "https://stackoverflow.com/questions/53475499/stripe-update-of-subscription-generating-error", "title": "Stripe update of subscription generating error", "body": "<p>I am using the gem stripe v4.0.3.  If I retrieve a subscription, then I can cancel it using:</p>\n\n<pre><code>subscription.cancel_at_period_end = true\nsubscription.save\n</code></pre>\n\n<p>According to the <a href=\"https://stripe.com/docs/billing/subscriptions/canceling-pausing\" rel=\"nofollow noreferrer\">stripe documentation</a>, I should also be able to do this with the command:</p>\n\n<pre><code>subscription.update(cancel_at_period_end: true)\n</code></pre>\n\n<p>but this generates an error:</p>\n\n<pre><code>Failure/Error: subscription.update(cancel_at_period_end: true)\n\n     NoMethodError:\n       undefined method `update' for #&lt;Stripe::Subscription:0x00007fcda95efd20&gt;\n</code></pre>\n\n<p>Why is this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler", "gemfile"], "answers": [{"comments": [{"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543210394, "post_id": 53475183, "comment_id": 93820697, "body": "If it cannot find compatible version does it just go with what was last used?"}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543210994, "post_id": 53475183, "comment_id": 93820824, "body": "&quot;compatible&quot; with what?"}, {"owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543211320, "post_id": 53475183, "comment_id": 93820903, "body": "I am running bundle install all of the above errors are saying it cannot find compatible versions."}, {"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 1, "creation_date": 1543211956, "post_id": 53475183, "comment_id": 93821078, "body": "I just answered &quot;Why is it resolving it to 4.2.10 &quot; which was your question"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543223586, "post_id": 53475183, "comment_id": 93825633, "body": "@jdog On a side note, you <i>probably</i> aught to be using <code>4.2.10</code>, not <code>4.2.4</code>. Unless you have a good reason not to (which you have not articulated in your question), it&#39;s highly unlikely that there is a compatibility issue between those patch releases. It&#39;s far <i>more</i> likely that you&#39;ll benefit from the various bug fixes and improvements that were added to the patch release."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "edited": false, "score": 0, "creation_date": 1543223820, "post_id": 53475183, "comment_id": 93825776, "body": "@jdog But as said above, you need to <b>show us the error</b> in order for us to give any specific advice about resolving said error. We&#39;re not mind readers."}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 3, "last_activity_date": 1543212059, "last_edit_date": 1543212059, "creation_date": 1543210062, "answer_id": 53475183, "question_id": 53475172, "link": "https://stackoverflow.com/questions/53475172/rails-4-2-4-was-resolved-to-4-2-10/53475183#53475183", "title": "rails (~&gt; 4.2.4) was resolved to 4.2.10", "body": "<p>The squiggly arrow <code>~&gt;</code> symbol means the last minor version will be updated to the latest version. So <code>4.2.4</code> will be resolved to <code>4.2.X</code> where X is the latest available.</p>\n\n<p>If you want to stick to <code>4.2.4</code>, use <code>=</code> like <code>gem 'rails', '= 4.2.4'</code>.</p>\n"}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 53475183, "answer_count": 1, "score": 0, "last_activity_date": 1543212059, "creation_date": 1543209973, "question_id": 53475172, "link": "https://stackoverflow.com/questions/53475172/rails-4-2-4-was-resolved-to-4-2-10", "title": "rails (~&gt; 4.2.4) was resolved to 4.2.10", "body": "<p>I am trying to update my ROR app which is currently Ruby 1.9.3 and Rails 4.2.4</p>\n\n<p>I am trying to move to Ruby 2.2.2 and Rails 4.2.4, which is the minimum to get MongoDB 3.2 to run.</p>\n\n<p>When I changed my Gemfile to Ruby 2.2.2 and run <code>bundle install</code>, and <code>bundle update</code> I get rails (~> 4.2.4) was resolved to 4.2.10</p>\n\n<p>Why is it resolving it to 4.2.10 when I have rails set to (~> 4.2.4) in my Gemfile?</p>\n\n<p>Gemfile below.</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.2.2'\ngem 'rails', '~&gt; 4.2.4'\ngem 'mongo', '~&gt; 2.1.1'\ngem 'bson_ext', '~&gt; 1.12.1'\ngem 'mongoid', '~&gt; 5.0.0'\n# mongoid seemed to want these to run the generator\ngem 'execjs', '~&gt; 2.6.0'\ngem 'therubyracer', '~&gt; 0.12.2'\ngem 'devise', '~&gt; 3.5.2'\ngem 'grape', '~&gt; 0.13.0'\n#gem 'grape-swagger'\ngem 'thin', '~&gt; 1.6.4'\ngem 'geocoder', '~&gt; 1.2.11'\n#gem 'mongoid_geospatial'\ngem 'kaminari', '~&gt;1.0.0' # pagination\n#gem 'iron_worker_ng', '~&gt; 1.6.6'\ngem 'iron_worker', '~&gt; 3.1.0'\ngem 'newrelic_rpm', '~&gt; 3.13.2.302'\ngem 'newrelic-grape', '~&gt; 2.0.0'\n#gem \"opentok\"\ngem 'mandrill-api', '~&gt; 1.0.53'\ngem 'aws-sdk', \"~&gt; 1\"\ngem 'nexmo', '~&gt; 3.0.0'\ngem 'rmagick', '~&gt; 2.15.4', :ref =&gt; '69db6635c2630ffd63c1858646cbc280226f31a7bc34e1c9d1322c2c73e1e386'\n#gem 'stripe', :git =&gt; 'https://github.com/stripe/stripe-ruby', :ref =&gt;'df2e36287d88726c6a03ec6c1fdc19b5d6e2b274'\ngem 'stripe', '~&gt; 1.22.0'\ngem 'gibberish', \"~&gt; 2.0.0\"\n#gem 'mongoid-encrypted-fields', :path =&gt; \"./vendor/plugins/mongoid-encrypted-fields-1.2.2\"\ngem 'twilio-ruby', '~&gt; 4.4.0'\ngem 'gcm', '~&gt; 0.1.0'\ngem 'chronic', '~&gt; 0.10.2'\ngem 'oauth2', '~&gt; 1.1.0'# for stripe connect\ngem 'aescrypt', '~&gt; 1.0.0'\ngem 'houston', '~&gt; 2.2.3'\ngem 'hashids', '~&gt; 1.0.3'\ngem 'rack-cors', '~&gt; 0.4.0', :require =&gt; 'rack/cors'\ngem 'mail', '~&gt; 2.6.4'\ngem 'sendgrid-ruby', '~&gt; 1.1.6'\n\ngroup :production, :staging do\n    gem 'rails_12factor', '~&gt; 0.0.3'\nend\n\ngroup :development, :test do\n  gem 'factory_girl_rails', '~&gt; 4.6.0'\n  gem 'timecop', '~&gt; 0.8.0'\n  gem 'debugger', '~&gt; 1.6.8'\n  gem 'typhoeus', '~&gt; 0.8.0'\nend\n\n# Gems used only for assets and not required\n# in production environments by default.\n#group :assets do\n#  gem 'sass-rails'\n#  gem 'coffee-rails'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n#  gem 'uglifier'\n#end\ngem 'uglifier', '~&gt; 2.7.2'\ngem 'jquery-rails', '~&gt; 4.0.5'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routing", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543209385, "post_id": 53474743, "comment_id": 93820495, "body": "any errors with whatever you have tried already?"}, {"owner": {"reputation": 3746, "user_id": 134788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e8424594187a3e0eb125f6e0a62a2999?s=128&d=identicon&r=PG", "display_name": "Ayrad", "link": "https://stackoverflow.com/users/134788/ayrad"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543210129, "post_id": 53474743, "comment_id": 93820639, "body": "Not errors but it creates a different route for each controller instead of a dynamic one so I can&#39;t use a generic _path helper. Why the downvote?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1543211777, "post_id": 53474743, "comment_id": 93821016, "body": "How should the router determine to which controller to pass? There is nothing in the parameters that identifies a certain type of media - as far as I understand your method call. Do you expect the router to know or to check that a certain <code>content_id</code> belongs to a certain media type? How can that be done?"}, {"owner": {"reputation": 3746, "user_id": 134788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e8424594187a3e0eb125f6e0a62a2999?s=128&d=identicon&r=PG", "display_name": "Ayrad", "link": "https://stackoverflow.com/users/134788/ayrad"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1543212028, "post_id": 53474743, "comment_id": 93821103, "body": "@spickerman yes. Something like that. Maybe a generic function that loads the object, and checks its type and redirects to the correct controller. Not sure the best way to do something like that."}, {"owner": {"reputation": 443, "user_id": 3678149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YVIsD.jpg?s=128&g=1", "display_name": "kishore cheruku", "link": "https://stackoverflow.com/users/3678149/kishore-cheruku"}, "edited": false, "score": 2, "creation_date": 1543212438, "post_id": 53474743, "comment_id": 93821206, "body": "As I understand with your question , am giving solution . Don&#39;t use any url&#39;s , just create one helper method and do the functionality . its a very clean way probably for your question ."}, {"owner": {"reputation": 111, "user_id": 4275302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b495db33ec776c3e6a7dfd347f80a4ae?s=128&d=identicon&r=PG&f=1", "display_name": "A_rayB", "link": "https://stackoverflow.com/users/4275302/a-rayb"}, "edited": false, "score": 1, "creation_date": 1543242698, "post_id": 53474743, "comment_id": 93836294, "body": "You could use a routing constraint to load the object and then check if it is of a certain type. You&#39;d probably have to create a route for each type, and then add a constraint to each that only allows objects of the correct type to route to it.  <a href=\"https://guides.rubyonrails.org/routing.html#advanced-constraints\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html#advanced-constraints</a>"}, {"owner": {"reputation": 3746, "user_id": 134788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e8424594187a3e0eb125f6e0a62a2999?s=128&d=identicon&r=PG", "display_name": "Ayrad", "link": "https://stackoverflow.com/users/134788/ayrad"}, "edited": false, "score": 0, "creation_date": 1543286394, "post_id": 53474743, "comment_id": 93853920, "body": "I&#39;m currently investigating polymorphic routes. It might also be a solution: <a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionDispatch/Routing/PolymorphicRoutes.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/v5.2.1/classes/ActionDispatch/Routing/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3746, "user_id": 134788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e8424594187a3e0eb125f6e0a62a2999?s=128&d=identicon&r=PG", "display_name": "Ayrad", "link": "https://stackoverflow.com/users/134788/ayrad"}, "is_accepted": true, "score": 0, "last_activity_date": 1543287759, "creation_date": 1543287759, "answer_id": 53492113, "question_id": 53474743, "link": "https://stackoverflow.com/questions/53474743/how-can-i-get-the-rails-router-to-choose-controller-dynamically-from-content/53492113#53492113", "title": "How can I get the rails router to choose controller dynamically from content?", "body": "<p>Ended up solving this the other way around. </p>\n\n<p>Putting the removal from playlist on the playlist controller instead of repeating it in each content controller and using  <code>Object.const_get(params[:klass])</code> to send the right class to <code>@playlist.send(klass).delete</code> </p>\n\n<p>Hopefully this will help someone with a similar architecture. </p>\n"}], "owner": {"reputation": 3746, "user_id": 134788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e8424594187a3e0eb125f6e0a62a2999?s=128&d=identicon&r=PG", "display_name": "Ayrad", "link": "https://stackoverflow.com/users/134788/ayrad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53492113, "answer_count": 1, "score": 0, "last_activity_date": 1543287759, "creation_date": 1543206063, "last_edit_date": 1543206382, "question_id": 53474743, "link": "https://stackoverflow.com/questions/53474743/how-can-i-get-the-rails-router-to-choose-controller-dynamically-from-content", "title": "How can I get the rails router to choose controller dynamically from content?", "body": "<p>I'm building a playlist feature that can hold different types and I need a generic url helper that would go to the a controller#action depending on the type of object passed to it. </p>\n\n<p>For example:</p>\n\n<pre><code>remove_from_playlist_path(:playlist_id: 1, :content_id: 34)\n</code></pre>\n\n<p>My attempted routing:</p>\n\n<pre><code> [:links, :medias, :documents].each do |content|    \n    get 'remove_from_playlist', :controller =&gt; :content, :action =&gt; :remove_from_playlist, :type =&gt; content, :as =&gt; 'remove_' + content.to_s + 'playlist'\n  end\n</code></pre>\n\n<p>In each content type controller I have a remove from playlist action that looks like this:</p>\n\n<pre><code> def remove_from_playlist\n    playlist = Playlist.find(params[:playlist_id])\n    playlist.links.delete @link\n   removed successfully!'\n  end\n</code></pre>\n\n<p>How can I get the route to function properly and allow me to just pass the object and have it redirect to the correct <code>{type}#remove_from_playlist</code> with a generic url helper?</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "elasticsearch-rails"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "edited": false, "score": 0, "creation_date": 1543209567, "post_id": 53474594, "comment_id": 93820530, "body": "Thank you for your response Austio. I did as you said. I&#39;ve established an index (create_index! method) and them I imported my Leads. The only problem is that still somehow elasticsearch ignores my restrictions and imports a lot of fields which I did not intented to fetch. E.g. emails table, ignored on my custom mapping method in Lead model. How can I change that and fetch only selected fields?"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "edited": false, "score": 0, "creation_date": 1543253928, "post_id": 53474594, "comment_id": 93842296, "body": "@andrzej541 it appears you can handle that through passing a transform to the import. <a href=\"https://github.com/elastic/elasticsearch-rails/blob/52f649bd40d112fb4576acdbd58940099c03d008/elasticsearch-model/lib/elasticsearch/model/importing.rb#L81\" rel=\"nofollow noreferrer\">github.com/elastic/elasticsearch-rails/blob/&hellip;</a>"}, {"owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "reply_to_user": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "edited": false, "score": 0, "creation_date": 1543254000, "post_id": 53474594, "comment_id": 93842330, "body": "Side note, if you are not commited to that library you are using maybe check this library out <a href=\"https://github.com/doximity/es-elasticity\" rel=\"nofollow noreferrer\">github.com/doximity/es-elasticity</a>  It has document models that are independent from your database models which is much better because you are not limited to a single index per model."}], "tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 1, "last_activity_date": 1543204510, "creation_date": 1543204510, "answer_id": 53474594, "question_id": 53474460, "link": "https://stackoverflow.com/questions/53474460/rails-elasticsearch-unable-to-perform-custom-mapping-content-of-the-table/53474594#53474594", "title": "Rails-elasticsearch: unable to perform custom mapping content of the table", "body": "<p>I use es-elasticity for this type of stuff.  But from the output from elasticsearch it is only creating the index, you must index the objects in order for them to show up in elasticsearch.</p>\n\n<p>From gandering at the docs it looks like you could import by doing <code>Lead.import</code></p>\n"}], "owner": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 53474594, "answer_count": 1, "score": 0, "last_activity_date": 1543204510, "creation_date": 1543203187, "question_id": 53474460, "link": "https://stackoverflow.com/questions/53474460/rails-elasticsearch-unable-to-perform-custom-mapping-content-of-the-table", "title": "Rails-elasticsearch: unable to perform custom mapping content of the table", "body": "<p>I am trying to make a custom index of my model to elasticsearch serwer. Somehow I can render only a structure (selected columns) but without a records. </p>\n\n<p>My model:</p>\n\n<pre><code>require 'elasticsearch/model'\n\nclass Lead &lt; ApplicationRecord\n  include Elasticsearch::Model\n  include Elasticsearch::Model::Callbacks\n\n   mappings dynamic: false do\n      indexes :id, type: 'keyword'\n      indexes :lead_status, type: 'keyword'\n      indexes :country\n      indexes :city\n      indexes :title\n      indexes :description\n      indexes :contact_person\n    end\nend\n</code></pre>\n\n<p>And then I try to create an index from rails console:</p>\n\n<pre><code>2.5.1 :004 &gt; Lead.__elasticsearch__.create_index!(force:true)\n2018-11-26 04:19:55 +0100: DELETE http://localhost:9200/leads [status:404, request:0.034s, query:N/A]\n2018-11-26 04:19:55 +0100: &lt; {\"error\":{\"root_cause\":[{\"type\":\"index_not_found_exception\",\"reason\":\"no such index\",\"resource.type\":\"index_or_alias\",\"resource.id\":\"leads\",\"index_uuid\":\"_na_\",\"index\":\"leads\"}],\"type\":\"index_not_found_exception\",\"reason\":\"no such index\",\"resource.type\":\"index_or_alias\",\"resource.id\":\"leads\",\"index_uuid\":\"_na_\",\"index\":\"leads\"},\"status\":404}\n2018-11-26 04:19:55 +0100: [404] {\"error\":{\"root_cause\":[{\"type\":\"index_not_found_exception\",\"reason\":\"no such index\",\"resource.type\":\"index_or_alias\",\"resource.id\":\"leads\",\"index_uuid\":\"_na_\",\"index\":\"leads\"}],\"type\":\"index_not_found_exception\",\"reason\":\"no such index\",\"resource.type\":\"index_or_alias\",\"resource.id\":\"leads\",\"index_uuid\":\"_na_\",\"index\":\"leads\"},\"status\":404}\n[!!!] Index does not exist (Elasticsearch::Transport::Transport::Errors::NotFound)\n2018-11-26 04:19:55 +0100: HEAD http://localhost:9200/leads [status:404, request:0.007s, query:N/A]\n2018-11-26 04:19:55 +0100: &lt; \n2018-11-26 04:19:55 +0100: [404] \n2018-11-26 04:19:56 +0100: PUT http://localhost:9200/leads [status:200, request:0.707s, query:n/a]\n2018-11-26 04:19:56 +0100: &gt; {\"settings\":{},\"mappings\":{\"_doc\":{\"dynamic\":false,\"properties\":{\"id\":{\"type\":\"keyword\"},\"lead_status\":{\"type\":\"keyword\"},\"country\":{\"type\":\"text\"},\"city\":{\"type\":\"text\"},\"title\":{\"type\":\"text\"},\"description\":{\"type\":\"text\"},\"contact_person\":{\"type\":\"text\"}}}}}\n2018-11-26 04:19:56 +0100: &lt; {\"acknowledged\":true,\"shards_acknowledged\":true,\"index\":\"leads\"}\n =&gt; {\"acknowledged\"=&gt;true, \"shards_acknowledged\"=&gt;true, \"index\"=&gt;\"leads\"}\n</code></pre>\n\n<p>After that on my local elasticsearch server on /leads I can see my custom structure but without any records. How can I fix this issue?</p>\n\n<p>Rails version: 5.2.1\nElasticsearch: 6.4.3\nelasticsearch-model/rails gems: 6.0.0</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "view", "zencoder", "redirecttoroute"], "comments": [{"owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543208943, "post_id": 53474437, "comment_id": 93820401, "body": "where is that zencoder logic in your code?"}, {"owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "reply_to_user": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "edited": false, "score": 0, "creation_date": 1543258969, "post_id": 53474437, "comment_id": 93844631, "body": "There&#39;s a route for <code>encode_progress</code> - logic is in the controller"}], "owner": {"reputation": 2908, "user_id": 1220243, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A8tm4.jpg?s=128&g=1", "display_name": "zero_cool", "link": "https://stackoverflow.com/users/1220243/zero-cool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543202959, "creation_date": 1543202959, "question_id": 53474437, "link": "https://stackoverflow.com/questions/53474437/ruby-rails-wait-for-redirect-to-to-resolve-and-do-something-depending-on-respo", "title": "Ruby / Rails Wait for redirect_to to resolve and do something depending on response", "body": "<p>I've got a <strong>redirect_to</strong> in a <strong>rails</strong> app\nthat hits an endpoint to send a video to <strong>Zencoder</strong> to be encoded into a few different formats. </p>\n\n<p>Just after I've got a <strong>redirect_to</strong> that redirect to a view. \nWhat's happening is the <strong>redirect</strong> to the view happens <strong>too quickly</strong>, so when the view makes <strong>the first request</strong> for the Zencoder urls - it throws <strong>404s</strong>.\nOn refresh the requests are <strong>200</strong> </p>\n\n<p>I'd like to either:</p>\n\n<ol>\n<li><p>Delay the redirect momentarily so that the 404's don't occcur\n(simpler)</p></li>\n<li><p>Listen to the Zencoder redirect and only redirect to the view after getting a response from Zencoder</p></li>\n</ol>\n\n<p>Here's the relevant code: </p>\n\n<pre><code>  def edit\n    @director = Director.find(params[:id])\n    @director_videos = Video.where(:director_id =&gt; @director.id)\n    if params[:bucket].present?\n      # process video\n      key = params[:key]\n      video = Video.new\n      video.director_id = @director.id\n\n      video.video_url = \"https://\"+Settings.S3_BUCKET + \".s3.amazonaws.com/\" + URI.unescape(key)\n      video.save    \n      video.process\n      redirect_to '/encode_progress' and return\n    end\n    @video_uploader = Video.new.video\n    @video = Video.new\n    redirect = \"http://\"+Settings.DOMAIN+\"/directors/\"+@director.id.to_s+\"/edit\"\n    @video_uploader.success_action_redirect = redirect\n  end\n</code></pre>\n"}, {"tags": ["ruby", "literals", "heredoc"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1543243577, "post_id": 53474368, "comment_id": 93836818, "body": "Note that you can accomplish this without class eval (and thus no worrying about string escaping). Just replace the <code>class_eval</code> and <code>def _phone</code> with <code>define_method :_phone do |val|</code>"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 3, "creation_date": 1543208072, "post_id": 53474943, "comment_id": 93820205, "body": "Or, another way is to replace <code>\\D</code> with <code>\\\\D</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543223543, "post_id": 53474943, "comment_id": 93825616, "body": "Official reference: <a href=\"http://ruby-doc.org/core-2.5.3/doc/syntax/literals_rdoc.html#label-Here+Documents\" rel=\"nofollow noreferrer\">Literals - Here Documents</a>"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 5, "last_activity_date": 1543208624, "last_edit_date": 1543208624, "creation_date": 1543207877, "answer_id": 53474943, "question_id": 53474368, "link": "https://stackoverflow.com/questions/53474368/using-gsub-inside-double-quoted-heredoc-does-not-work/53474943#53474943", "title": "Using `gsub` inside (double quoted) heredoc does not work", "body": "<p>The problem is with the <code>\\D</code> in the regex. It will be evaluated when the heredoc is evaluated as a string, which results in <code>D</code>:</p>\n\n<pre><code>\"\\D\" # =&gt; \"D\"\neval(\"/\\D/\") #=&gt; /D/\n</code></pre>\n\n<p>On the other hand, <code>\\D</code> inside a single quote will not be evaluated as <code>D</code>:</p>\n\n<pre><code>'\\D' # =&gt; \"\\\\D\"\neval('/\\D/') # =&gt; /\\D/ \n</code></pre>\n\n<p>So wrap the heredoc terminator <code>EOS</code> in a single quote to achieve what you want:</p>\n\n<pre><code>class Test\n  def self.define_phone\n    class_eval &lt;&lt;-'EOS'\n      def _phone=(val)\n        puts val\n        puts val.gsub(/\\D/,'')\n      end\n    EOS\n  end\nend\n\nTest.define_phone\ntest = Test.new\ntest._phone = '123-456-7890'\n# &gt;&gt; 123-456-7890\n# &gt;&gt; 1234567890\n</code></pre>\n\n<p><a href=\"https://makandracards.com/makandra/15003-how-to-ruby-heredoc-without-interpolation\" rel=\"nofollow noreferrer\">Reference</a></p>\n\n<p>If you run the above code without the wrapped <code>EOS</code>, <code>gsub</code> will try to replace \"D\" (literally) in the <code>val</code>. See this:</p>\n\n<pre><code>test._phone = '123-D456-D7890DD'\n# &gt;&gt; 123-D456-D7890DD\n# &gt;&gt; 123-456-7890\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53474943, "answer_count": 1, "score": 2, "last_activity_date": 1543208725, "creation_date": 1543202324, "last_edit_date": 1543208725, "question_id": 53474368, "link": "https://stackoverflow.com/questions/53474368/using-gsub-inside-double-quoted-heredoc-does-not-work", "title": "Using `gsub` inside (double quoted) heredoc does not work", "body": "<p>It appears that using <code>gsub</code> inside a (double quoted) heredoc does not evaluate the result of <code>gsub</code>, as follows:</p>\n\n<pre><code>class Test\n  def self.define_phone\n    class_eval &lt;&lt;-EOS\n      def _phone=(val)\n        puts val\n        puts val.gsub(/\\D/,'')\n      end\n    EOS\n  end\nend\n\nTest.define_phone\ntest = Test.new\ntest._phone = '123-456-7890'\n# &gt;&gt; 123-456-7890\n# &gt;&gt; 123-456-7890\n</code></pre>\n\n<p>The second <code>puts</code> should have printed <code>1234567890</code>, just as it would in this case:</p>\n\n<pre><code>'123-456-7890'.gsub(/\\D/,'')\n # =&gt; \"1234567890\" \n</code></pre>\n\n<p>What is going on inside the heredoc?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oop", "view"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1543198187, "post_id": 53473796, "comment_id": 93818264, "body": "You can try using where.not to query your category_products: <code>where.not(heritable_sale_price: nil, product_selections: nil, purchase_price: nil)</code>. If that doesn&#39;t fix your problem, any second method called within the reduce block on the item variable is able to throw a NoMethodError."}, {"owner": {"reputation": 541, "user_id": 7773621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4bfe00cf0e21d8915f252905ccc73d3?s=128&d=identicon&r=PG&f=1", "display_name": "Boucherie", "link": "https://stackoverflow.com/users/7773621/boucherie"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1543255881, "post_id": 53473796, "comment_id": 93843176, "body": "If I take :purchase_price alone (:product_selections is a joined class, and sale price is a method) this works, and set up a second instance of &lt;% <code>@category_products_count = category.products_by_warehouse_id(params[:id]).where.not(pur&zwnj;&#8203;chase_price: nil).size%&gt;</code> in order to have consistent values for averaging. Submit as an answer?"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1543314102, "creation_date": 1543314102, "answer_id": 53497474, "question_id": 53473796, "link": "https://stackoverflow.com/questions/53473796/adding-map-and-or-reject-to-a-reduce-in-rails-view/53497474#53497474", "title": "Adding map and/or reject to a reduce in rails view", "body": "<p>So, in order to make sure, that none of the methods being accessed within the reduce block, to the item object are going to return nil, which hence, would throw a NoMethodError, you could firstly check them at the moment of creating your query. A <code>where.not</code> would do that. But keeping in mind that it'll leave aside each record in the database which doesn't satisfy the query criteria.</p>\n\n<p>For that, then:</p>\n\n<pre><code>where.not(\n  heritable_sale_price: nil,\n  product_selections: nil,\n  purchase_price: nil\n)\n</code></pre>\n\n<p>For that, you can analyze the option on setting a default value for each of those columns, so this helps you avoiding the previous query, and having to rescue on each case where there's no value for them. You can see the <a href=\"https://api.rubyonrails.org/v5.1/classes/ActiveRecord/Migration.html\" rel=\"nofollow noreferrer\">Rails Migration docs</a>.</p>\n"}], "owner": {"reputation": 541, "user_id": 7773621, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b4bfe00cf0e21d8915f252905ccc73d3?s=128&d=identicon&r=PG&f=1", "display_name": "Boucherie", "link": "https://stackoverflow.com/users/7773621/boucherie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53497474, "answer_count": 1, "score": 0, "last_activity_date": 1543314102, "creation_date": 1543196821, "last_edit_date": 1543222593, "question_id": 53473796, "link": "https://stackoverflow.com/questions/53473796/adding-map-and-or-reject-to-a-reduce-in-rails-view", "title": "Adding map and/or reject to a reduce in rails view", "body": "<p>I am calculating an ROI value that averages over a category. </p>\n\n<pre><code>&lt;% @categories.each do |category| %&gt;       \n\n  &lt;h3&gt;&lt;strong&gt;&lt;%= category.name %&gt;&lt;strong&gt;&lt;/h3&gt;\n  &lt;% @category_products = category.products_by_warehouse_id(params[:id]) %&gt;\n\n    &lt;!-- add map/reject below --&gt;\n    &lt;%@ROI = (@category_products.reduce(0.0) {|acc, item| acc + (item.heritable_sale_price.to_f  * item.product_selections.length) / item.purchase_price.to_f }) %&gt;\n\n    &lt;p&gt; Category ROI: &lt;%= number_with_precision((@ROI / @category_products.length.to_f), precision:2) %&gt;&lt;/p&gt;\n\n.....(close tags)......\n</code></pre>\n\n<p>The value throws <code>NaN</code> when financial data is missing. For individual values, this is fine; however, it does the same for averages with missing data as well.</p>\n\n<p>How can I add <code>map</code>/<code>reject</code> into my call to throw out <code>nil</code> values, and get the average of what's available?</p>\n\n<p><code>@category_products.length.to_f</code> would also have to skip over empty elements in the array if I go this route as well, to keep the sum and length consistent. Something like <code>.where(purchase_price: [!nil, \"\"]).size</code> may work.</p>\n"}, {"tags": ["ruby", "iteration"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1543194287, "post_id": 53473571, "comment_id": 93817545, "body": "<a href=\"https://code-maven.com/iterate-over-character-of-a-string-in-ruby\" rel=\"nofollow noreferrer\">code-maven.com/iterate-over-character-of-a-string-in-ruby</a>"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 3, "creation_date": 1543194347, "post_id": 53473571, "comment_id": 93817553, "body": "There is also a built-in method for this, <code>each_char</code>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543223280, "post_id": 53473583, "comment_id": 93825486, "body": "<code>greeting.each_char { |c| p c }</code> might even be easier to remember. BTW, passing a block to <code>chars</code> is deprecated and results in a warning."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1543228786, "post_id": 53473583, "comment_id": 93828446, "body": "Now I see <i>&quot;If a block is given, which is a deprecated form, works the same as each_char.&quot;</i>, didn&#39;t know that. Thanks @Stefan!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 6, "last_activity_date": 1543228841, "last_edit_date": 1543228841, "creation_date": 1543194320, "answer_id": 53473583, "question_id": 53473571, "link": "https://stackoverflow.com/questions/53473571/iterating-through-each-letter-of-a-string/53473583#53473583", "title": "Iterating through each letter of a string", "body": "<p>You're printing inside the loop a variable that has been initialized and which its value has never changed, that's why is always printing \"h\".</p>\n\n<p>It would be different if you print it inside the loop as the \"counter\" (<code>extract</code>) goes increasing:</p>\n\n<pre><code>greeting = \"hello\"\nextract = 0\n\nwhile extract &lt; greeting.length\n  p greeting[extract]\n  extract += 1\nend\n</code></pre>\n\n<p>If you wanna take another step and use built-in Ruby functions, you can use <code>each_char</code>:</p>\n\n<pre><code>greeting = 'hello'\ngreeting.each_char(&amp;method(:p))\n# same output\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 10663676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e53116ab119e0bb4c481ff8829db729?s=128&d=identicon&r=PG&f=1", "display_name": "kel.o", "link": "https://stackoverflow.com/users/10663676/kel-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 53473583, "answer_count": 1, "score": 1, "last_activity_date": 1543228841, "creation_date": 1543194157, "last_edit_date": 1543207064, "question_id": 53473571, "link": "https://stackoverflow.com/questions/53473571/iterating-through-each-letter-of-a-string", "title": "Iterating through each letter of a string", "body": "<p>I am trying to iterate through each letter of a string to print out a word.</p>\n\n<pre><code>greeting = \"hello\"\nextract = 0\nletter = greeting[extract]\n\nwhile extract &lt; greeting.length\n  p letter\n  extract += 1\nend\n</code></pre>\n\n<p>The result is <code>\"h\", \"h\", \"h\" ,\"h\", \"h\"</code> instead of hello. What am I doing wrong?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1543193105, "post_id": 53473473, "comment_id": 93817341, "body": "Can you format your question?"}, {"owner": {"reputation": 19, "user_id": 10145256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d11c93bd35cd3a33d39bc1d67d6acb?s=128&d=identicon&r=PG&f=1", "display_name": "zena", "link": "https://stackoverflow.com/users/10145256/zena"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1543193153, "post_id": 53473473, "comment_id": 93817349, "body": "I am new here, i&#39;m not sure how to do that to make it more readable and explain my question properly. sorry"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1543193792, "post_id": 53473473, "comment_id": 93817458, "body": "What&#39;s the input and expected output?"}, {"owner": {"reputation": 19, "user_id": 10145256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d11c93bd35cd3a33d39bc1d67d6acb?s=128&d=identicon&r=PG&f=1", "display_name": "zena", "link": "https://stackoverflow.com/users/10145256/zena"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1543196397, "post_id": 53473473, "comment_id": 93817914, "body": "the input is the string type line and from there I extracted various forms of substring such as trim, type, km, year etc but for MODEL I can&#39;t seem to work it out, since the question is asking for any text that doesn\u2019t match any of the other criteria in this table which contains type, km, stock, status, model, maker, year, setOfFeatures,trim."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10145256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d11c93bd35cd3a33d39bc1d67d6acb?s=128&d=identicon&r=PG&f=1", "display_name": "zena", "link": "https://stackoverflow.com/users/10145256/zena"}, "edited": false, "score": 0, "creation_date": 1543196492, "post_id": 53473707, "comment_id": 93817925, "body": "but actually the LINE is going to be in a file where there could be many other lines among which it might not only be prius but other values as well."}, {"owner": {"reputation": 156, "user_id": 9181162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd829666bea20085c717384bdba27fb?s=128&d=identicon&r=PG", "display_name": "mjrcodin", "link": "https://stackoverflow.com/users/9181162/mjrcodin"}, "reply_to_user": {"reputation": 19, "user_id": 10145256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d11c93bd35cd3a33d39bc1d67d6acb?s=128&d=identicon&r=PG&f=1", "display_name": "zena", "link": "https://stackoverflow.com/users/10145256/zena"}, "edited": false, "score": 0, "creation_date": 1543212462, "post_id": 53473707, "comment_id": 93821215, "body": "So you can see from the above you can still accomplish this, I created a function that you can call with the file, and item to be removed. You may be reading it from the file system first if so if you are using Node then the fs library would help there."}], "tags": [], "owner": {"reputation": 156, "user_id": 9181162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd829666bea20085c717384bdba27fb?s=128&d=identicon&r=PG", "display_name": "mjrcodin", "link": "https://stackoverflow.com/users/9181162/mjrcodin"}, "is_accepted": false, "score": 0, "last_activity_date": 1543212368, "last_edit_date": 1543212368, "creation_date": 1543195858, "answer_id": 53473707, "question_id": 53473473, "link": "https://stackoverflow.com/questions/53473473/extract-a-certain-kind-of-word-from-an-unformatted-string-using-regex/53473707#53473707", "title": "Extract a certain kind of word from an unformatted string using regex", "body": "<p>You can do this using the below code snippet. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const filterString = (file, string) =&gt; {\r\n    let result = file.split(',').filter(word =&gt; word !== string).join(',')\r\n    return result\r\n}\r\n\r\n// In your case you would read this in from the file system\r\n// Using Node it would be the fs library, fs.readFileSync(path, utf8)\r\n\r\nhttps://nodejs.org/dist/latest-v10.x/docs/api/fs.html#fs_fs_readfilesync_path_options\r\n\r\nlet file = `39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\r\n`\r\n\r\nlet result = filterString(file, 'prius')\r\nconsole.log(file, result)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 19, "user_id": 10145256, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d11c93bd35cd3a33d39bc1d67d6acb?s=128&d=identicon&r=PG&f=1", "display_name": "zena", "link": "https://stackoverflow.com/users/10145256/zena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1543212368, "creation_date": 1543192966, "last_edit_date": 1543197099, "question_id": 53473473, "link": "https://stackoverflow.com/questions/53473473/extract-a-certain-kind-of-word-from-an-unformatted-string-using-regex", "title": "Extract a certain kind of word from an unformatted string using regex", "body": "<p>The given string is inside a .txt file where there are other similar lines of this format but different.</p>\n\n<pre><code>line = \"39km,Sedan,Manual,4738B,AWD,Used,5.5L/100km,Toyota,prius,SE,{AC, Heated Seats, Heated Mirrors, Keyless Entry},2010\"\n</code></pre>\n\n<ul>\n<li>Type: {Sedan, coupe, hatchback, station, SUV}</li>\n<li>Transmission: {Auto, manual, steptronic}</li>\n<li>stock: Combination of letters and numbers NOT ending with \u201ckm\u201d Drivetrain {FWD,RWD,AWD}</li>\n<li>Status: {Used, new}</li>\n<li>Fuel Economy Similar to: 5.5L/100km</li>\n<li>format car_maker: {Honda, Toyota, Mercedes, BMW, Lexus}</li>\n<li>Model: Any text that doesn\u2019t match any of the other criteria in this table</li>\n<li>Year: Any year  </li>\n<li>Trim: any two letters acronym</li>\n<li>set_of_features: Any set of features inside curly parenthesis</li>\n</ul>\n\n<p>My solution:</p>\n\n<pre><code>model = /[^ #{carmaker}.to_s#{drivetrain}.to_s#{stock}.to_s#{year}.to_s#{trim}.to_s#{setOffeatures}.to_s#{fueleconomy}.to_s#{type}.to_s#{transmission}.to_s#{km}.to_s]/.match(line)\nputs model returns\nu \nx \nw\n</code></pre>\n\n<p>I need to extract prius for model, but I need a general pattern matching that can match any kind of model, ie camry, altima, fiesta etc depending on what the file contains.\nI tried lots of ways, but nothing is working.</p>\n"}, {"tags": ["ruby", "github", "octokit"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6203915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6f032d31bd7da4c5a5492915eac43?s=128&d=identicon&r=PG&f=1", "display_name": "codeavenger07", "link": "https://stackoverflow.com/users/6203915/codeavenger07"}, "edited": false, "score": 0, "creation_date": 1543191826, "post_id": 53473190, "comment_id": 93817137, "body": "Thanks for the link. I&#39;m getting a 404. I&#39;m guessing it has to do with my authenticating. Any ideas?  <code>Octokit::NotFound - GET https:&#47;&#47;api.github.com&#47;authorizations&#47;99: 404 - Not Found</code>    <code>##login</code>   <code>client = Octokit::Client.new(:login =&gt; &#39;username&#39;, :password =&gt; &#39;password&#39;)</code> <code>client.authorization(99)</code> <code>## create an issue in new repo with @mention</code> <code>Octokit.create_issue(&quot;CodeAvenger07Organization&#47;test&quot;, &quot;New issue&quot;, &quot;take a look @codeavenger07&quot;)</code>"}], "tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": false, "score": 1, "last_activity_date": 1543189995, "creation_date": 1543189995, "answer_id": 53473190, "question_id": 53473176, "link": "https://stackoverflow.com/questions/53473176/how-do-i-automatically-create-an-issue-in-a-new-github-repository/53473190#53473190", "title": "How do I automatically create an issue in a new GitHub repository?", "body": "<pre><code>Octokit.create_issue(\"sferik/rails_admin\", 'Updated Docs', 'Added some extra links')\n</code></pre>\n\n<p><a href=\"http://octokit.github.io/octokit.rb/Octokit/Client/Issues.html#create_issue-instance_method\" rel=\"nofollow noreferrer\">http://octokit.github.io/octokit.rb/Octokit/Client/Issues.html#create_issue-instance_method</a></p>\n"}], "owner": {"reputation": 53, "user_id": 6203915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d6f032d31bd7da4c5a5492915eac43?s=128&d=identicon&r=PG&f=1", "display_name": "codeavenger07", "link": "https://stackoverflow.com/users/6203915/codeavenger07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543189995, "creation_date": 1543189802, "question_id": 53473176, "link": "https://stackoverflow.com/questions/53473176/how-do-i-automatically-create-an-issue-in-a-new-github-repository", "title": "How do I automatically create an issue in a new GitHub repository?", "body": "<p>I am the admin of a GitHub organization. I have set up a Repository webhook for the organization. I am using ngrok to communicate to a local sinatra instance. Here is my server.rb file:</p>\n\n<pre><code>require 'sinatra'\nrequire 'json'\n\nset :port, 1234\n\npost '/payload' do\n  push = JSON.parse(request.body.read)\n  puts \"I got some JSON: #{push.inspect}\"\nend\n</code></pre>\n\n<p>I receive a JSON payload when a repository is created. I would like to automatically create an issue in this new repository with a name and description. I'm assuming I need to use a gem to interact with GitHub API, so I chose octokit. I was able to authenticate, but I'm having trouble seeing how to interact with the API. I would like to create an issue in the newly created GitHub repository. Could I see some examples on ho this is used?</p>\n\n<p>Reference:\n<a href=\"https://developer.github.com/v3/issues/#create-an-issue\" rel=\"nofollow noreferrer\">https://developer.github.com/v3/issues/#create-an-issue</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543193988, "post_id": 53473509, "comment_id": 93817476, "body": "this looks like this should work.......so try putting the &quot;charge_amount&quot; action in the orders_helper.rb ? just to clarify make sure im understanding this correctly.  As for .(order_status) - should i just use order_params at that point and put videos on there? -----"}, {"owner": {"reputation": 219, "user_id": 3503295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vreKN.jpg?s=128&g=1", "display_name": "ZainNazirButt", "link": "https://stackoverflow.com/users/3503295/zainnazirbutt"}, "reply_to_user": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543194455, "post_id": 53473509, "comment_id": 93817578, "body": "by helper i mean make another method in the controller, and yes remove (order_status) and (order_charge), just use (order_params). i will also update the answer."}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543197294, "post_id": 53473509, "comment_id": 93818078, "body": "okay so that worked... my only issue now is that.  I want a separate action for each update.  There will be 3 possible update by either a seller or buyer.   Updating order information (name, email, etc.), updating order_status (1,2,3), and Updating by uploading a video.  I want a different message for each.  Whenever I upload a video, i get the order_status message since i change the order status on video upload"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543295329, "post_id": 53473509, "comment_id": 93855802, "body": "Yes, i ended up creating a new restful under routes and use that route within the same edit page to upload the videos.  I will update my answer"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1543295770, "post_id": 53473509, "comment_id": 93855933, "body": "just added to it.  i found a SO post that was trying to do something similar to me and it ended up working out perfectly.  Apparently you can&#39;t separate update actions without more restful actions (whatever they&#39;re called) - unless you make another controller, which may not be needed in this situation."}], "tags": [], "owner": {"reputation": 219, "user_id": 3503295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vreKN.jpg?s=128&g=1", "display_name": "ZainNazirButt", "link": "https://stackoverflow.com/users/3503295/zainnazirbutt"}, "is_accepted": false, "score": 1, "last_activity_date": 1543215882, "last_edit_date": 1543215882, "creation_date": 1543193426, "answer_id": 53473509, "question_id": 53473139, "link": "https://stackoverflow.com/questions/53473139/should-i-be-creating-multiple-controllers-or-multiple-update-methods-in-one-cont/53473509#53473509", "title": "Should I be creating multiple controllers or multiple update methods in one controller?", "body": "<p>One way to approach this would be to just have one <code>order_params</code> method and remove <code>order_charge</code> and <code>order_status</code> because whatever the case only one resource is being updated. And as you said the user is charged only in one case when file is uploaded, so instead have a helper method in the <strong>controller</strong> that would be responsible to charge the user.</p>\n\n<pre><code>def charge_amount\n    @amount = (@order.order_price).to_i * 100\n    @amount_seller = (@order.order_price).to_i * 75\n    if current_user.seller?\n      charge = Stripe::Charge.create({\n                        :amount      =&gt; @amount,\n                        :description =&gt; 'Rails Stripe customer',\n                        :currency    =&gt; 'usd',\n                        :customer =&gt; @order.stripe_customer_token,\n                        :destination =&gt; {\n                          :amount =&gt; @amount_seller ,\n                          :account =&gt; (@order.seller.stripe_token),\n                        }\n                      })\n      @order.order_status = \"charged\"\n    end\nend\n</code></pre>\n\n<p>And inside your update method just update the order and charge the user if required. It would be something like,</p>\n\n<pre><code>def update\n  respond_to do |format|\n    if user_signed_in? #this could be moved to a `before_action` that authenticates the user\n      if @order.update(order_status)\n        if order_params[:video].present?\n          charge = charge_amount\n        end\n        format.html { redirect_to ([@user, @order]), notice: 'Order was successfully order_status.' }\n        format.json { render :show, status: :ok, location: @order }\n      else\n        format.html { render :edit }\n        format.json { render json: @order.errors, status: :unprocessable_entity }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>With this approach the code would shrink in size and separates the logic and would be easier to debug. I hope this answers your question or atleast provide you some guidance.</p>\n\n<p><strong>update</strong>\nIf you want separate actions, just create three methods in your controller and depending upon the type of params call the appropriate method in your <code>update</code> action. </p>\n"}, {"tags": [], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "is_accepted": false, "score": 0, "last_activity_date": 1543295690, "creation_date": 1543295690, "answer_id": 53493159, "question_id": 53473139, "link": "https://stackoverflow.com/questions/53473139/should-i-be-creating-multiple-controllers-or-multiple-update-methods-in-one-cont/53493159#53493159", "title": "Should I be creating multiple controllers or multiple update methods in one controller?", "body": "<p>I ended up doing this... thanks to a SO post i found earlier...</p>\n\n<p>Orders controller: (separate from update action:)</p>\n\n<pre><code>def charge_update\n    respond_to do |format|\n      @amount = (@order.order_price).to_i * 100\n      @amount_seller = (@order.order_price).to_i * 75\n      if @order.update(order_charge)\n                      charge = Stripe::Charge.create({\n                        :amount      =&gt; (@order.order_price).to_i * 100,\n                        :description =&gt; 'Rails Stripe customer',\n                        :currency    =&gt; 'usd',\n                        :customer =&gt; @order.stripe_customer_token,\n                        :destination =&gt; {\n                          :amount =&gt; @amount_seller ,\n                          :account =&gt; (@order.seller.stripe_token),\n                        }\n                      })\n          @order.update_column(:order_status, 2)\n          format.html { redirect_to ([@user, @order]), notice: 'Order was successfully uploaded.' }\n          format.json { render :show, status: :ok, location: @order }\n        else\n          format.html { render :edit }\n          format.json { render json: @order.errors, status: :unprocessable_entity }\n        end\n      end\n  end\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code> resources :orders do\n    member do\n      patch :charge_update\n      put :charge_update\n    end\n  end\n</code></pre>\n\n<p>And for the upload in the view:</p>\n\n<pre><code>&lt;%= form_for([@listing, @order], :url =&gt; charge_update_order_path ) do |form| %&gt;\n...\n&lt;%= form.file_field :video %&gt;\n...\n&lt;%= form.submit \"Upload\", class: \"btn btn-success\"  %&gt;\n</code></pre>\n\n<p>rest of controller: (private section)</p>\n\n<pre><code>private\n\ndef order_charge\n      params.require(:order).permit(:video, :order_status)\n    end\n</code></pre>\n\n<p>Now the uploading video action is separate and works faster.  I haven't done the same for updating the order status to cancel, which i may or may not after doing more testing.  The charging aspect was the most important thing to separate from the rest of the params.</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543295690, "creation_date": 1543189451, "question_id": 53473139, "link": "https://stackoverflow.com/questions/53473139/should-i-be-creating-multiple-controllers-or-multiple-update-methods-in-one-cont", "title": "Should I be creating multiple controllers or multiple update methods in one controller?", "body": "<p><strong>Issue:</strong> I have a controller where I want to separate the update action into 3 separate update actions... Update for all params (minus the other update actions), update for changing order status (created, cancelled, charged), and an update for charging (charges only occur once a file is uploaded to the order)</p>\n\n<p><strong>Question:</strong> Can you help direct and guide me in which route i should be going in to accomplishing this?</p>\n\n<p>How should i go about doing this in the most efficient and \"right\" way?</p>\n\n<ol>\n<li><p>Should i create 2 more controllers (since i need 3 updates), one for changing order status, and one for charging and have them inherit the OrderController?</p></li>\n<li><p>Or is there a way to have 3 update actions in one controller? I tried this, but couldn't figure it out</p></li>\n</ol>\n\n<p>Here is how I \"solved\" it, but it doesn't seem to run too smoothly as sometimes i notice when i upload a file to the order, it starts looping and/or takes longer than just having it all under one defined param method:</p>\n\n<pre><code>  def update\n    respond_to do |format|\n      if @order.update(order_status)\n        if user_signed_in?\n          format.html { redirect_to ([@user, @order]), notice: 'Order was successfully order_status.' }\n          format.json { render :show, status: :ok, location: @order }\n        else\n          format.html { render :edit }\n          format.json { render json: @order.errors, status: :unprocessable_entity }\n        end\n      end\n        if @order.update(order_charge)\n          @amount = (@order.order_price).to_i * 100\n          @amount_seller = (@order.order_price).to_i * 75\n          if @order.update(order_charge)\n            if current_user.seller?\n                          charge = Stripe::Charge.create({\n                            :amount      =&gt; @amount,\n                            :description =&gt; 'Rails Stripe customer',\n                            :currency    =&gt; 'usd',\n                            :customer =&gt; @order.stripe_customer_token,\n                            :destination =&gt; {\n                              :amount =&gt; @amount_seller ,\n                              :account =&gt; (@order.seller.stripe_token),\n                            }\n                          })\n              @order.order_status = \"charged\"\n              format.html { redirect_to ([@user, @order]), notice: 'Order was successfully uploaded.' }\n              format.json { render :show, status: :ok, location: @order }\n            else\n              format.html { render :edit }\n              format.json { render json: @order.errors, status: :unprocessable_entity }\n            end\n          end\n        end\n        if @order.update(order_params)\n          if user_signed_in?\n            format.html { redirect_to ([@user, @order]), notice: 'Order was successfully updated.' }\n            format.json { render :show, status: :ok, location: @order }\n          else\n            format.html { render :edit }\n            format.json { render json: @order.errors, status: :unprocessable_entity }\n          end\n          if buyer_signed_in?\n            format.html { redirect_to ([@user, @order]), notice: 'Order was successfully updated.' }\n            format.json { render :show, status: :ok, location: @order }\n          else\n            format.html { render :edit }\n            format.json { render json: @order.errors, status: :unprocessable_entity }\n          end\n        end\n      end\n    end\n\n\n  private\n\n    def set_order\n      @order = Order.find(params[:id])\n    end\n\n\n    def order_params\n      params.require(:order).permit(:name, :email, :image, :video, :description)\n    end\n\n    def order_status\n      params.require(:order).permit(:order_status)\n    end\n\n    def order_charge\n      params.require(:order).permit(:video)\n    end\n...\nend\n</code></pre>\n\n<p>This technically works, but not exactly fast or how i want it to.  When i upload a video, it gives me the order_status message, which is because i change the order status when a video gets uploaded.  But it still works in the sense that a charge is created.</p>\n\n<p>Has anyone ever made an app where they needed multiple update actions under one controller and model and found the best way to go about doing it?</p>\n\n<p>Even though the above code \"works\", i was told it was not efficient and I should create 2 more controllers to go about what i want to do.  I figured I would come here before i divulge in doing that to get other peoples opinions based on their experience if they have had similar apps with this issue.</p>\n\n<p>Or maybe aside from the above 1 and 2, you have more ideas?</p>\n\n<p>(The update action above isn't complete, such as the order_status.  But I'm mostly concerned on how I should actually go about doing this.)</p>\n"}, {"tags": ["ruby", "datetime"], "comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1543183823, "post_id": 53472154, "comment_id": 93815521, "body": "Why should it be less? (Note the offset -0500 on the <code>today</code> date)"}, {"owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1543186090, "post_id": 53472154, "comment_id": 93816009, "body": "I feel like an idiot. Thanks for the note!"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1543243998, "post_id": 53472154, "comment_id": 93837033, "body": "You should probably be using <code>Time</code> instead of <code>DateTime</code>: <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/DateTime.html#class-DateTime-label-When+should+you+use+DateTime+and+when+should+you+use+Time-3F\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib/libdoc/date/rdoc/&hellip;</a>"}, {"owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1543245632, "post_id": 53472154, "comment_id": 93837936, "body": "@Max Thanks for the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 20644, "user_id": 184184, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f6a508697f9eca2680b12ddb85ba1319?s=128&d=identicon&r=PG", "display_name": "Lenin Raj Rajasekaran", "link": "https://stackoverflow.com/users/184184/lenin-raj-rajasekaran"}, "is_accepted": true, "score": 1, "last_activity_date": 1543184735, "creation_date": 1543184735, "answer_id": 53472635, "question_id": 53472154, "link": "https://stackoverflow.com/questions/53472154/comparing-2-datetime-instances-and-its-giving-me-the-wrong-result/53472635#53472635", "title": "Comparing 2 DateTime instances and it&#39;s giving me the wrong result", "body": "<p>Note that <code>today</code> and <code>tomorrow</code> are in a different timezone. When you add <code>1.minute</code> to <code>today</code>, both values become the same. Hence <code>==</code> returns <code>true</code>.</p>\n\n<pre><code>2.5.3 :001 &gt; today = DateTime.parse('Sun, 25 Nov 2018 18:59:00 -0500')\n =&gt; Sun, 25 Nov 2018 18:59:00 -0500\n2.5.3 :002 &gt; tomorrow = DateTime.parse('Mon, 26 Nov 2018 00:00:00 GMT +00:00')\n =&gt; Mon, 26 Nov 2018 00:00:00 +0000\n2.5.3 :003 &gt; today &gt;= tomorrow\n =&gt; false\n2.5.3 :004 &gt; today + 1.minute\n =&gt; Sun, 25 Nov 2018 19:00:00 -0500\n2.5.3 :005 &gt; today + 1.minute &gt;= tomorrow\n =&gt; true\n2.5.3 :006 &gt; today + 1.minute == tomorrow\n =&gt; true\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53472635, "answer_count": 1, "score": 0, "last_activity_date": 1543184735, "creation_date": 1543181137, "question_id": 53472154, "link": "https://stackoverflow.com/questions/53472154/comparing-2-datetime-instances-and-its-giving-me-the-wrong-result", "title": "Comparing 2 DateTime instances and it&#39;s giving me the wrong result", "body": "<p>I have 2 DateTime instances</p>\n\n<pre><code>today = Sun, 25 Nov 2018 18:59:00 -0500\ntomorrow = Mon, 26 Nov 2018 00:00:00 GMT +00:00\n</code></pre>\n\n<p>When I do</p>\n\n<pre><code>today &gt;= tomorrow\n</code></pre>\n\n<p>it comes out false which is correct</p>\n\n<p>When I do</p>\n\n<pre><code>today + 1.minute &gt;= tomorrow\n</code></pre>\n\n<p>it comes out true which is incorrect. Why is it doing that when the Nov 25 should be less than Nov 26? Is it somehow computing just the time and not the date? If yes, how can I fix this?  </p>\n"}, {"tags": ["ruby", "clipboard"], "comments": [{"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1543177796, "post_id": 53471428, "comment_id": 93813882, "body": "What platform are you using? See the docs for linux/Windows configuration here: <a href=\"https://github.com/janlelis/clipboard\" rel=\"nofollow noreferrer\">github.com/janlelis/clipboard</a>"}, {"owner": {"reputation": 85, "user_id": 4785390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb18caa947b6a96f5b5fa5f9f8d8126b?s=128&d=identicon&r=PG&f=1", "display_name": "YiLuo", "link": "https://stackoverflow.com/users/4785390/yiluo"}, "reply_to_user": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1543177940, "post_id": 53471428, "comment_id": 93813926, "body": "I am using MacOS, I know it\u2019s Linux based but do I need to install something?"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1543178434, "post_id": 53471428, "comment_id": 93814084, "body": "it looks like the gem can only read the text off of the clipboard. I am not quite sure how you add a file to a cliboard."}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1543180574, "creation_date": 1543180574, "answer_id": 53472053, "question_id": 53471428, "link": "https://stackoverflow.com/questions/53471428/how-to-get-the-temp-file-in-the-clipboard-in-ruby/53472053#53472053", "title": "How to get the temp file in the clipboard in Ruby?", "body": "<p>The clipboard gem uses the command line applications <a href=\"https://github.com/janlelis/clipboard/blob/master/lib/clipboard/mac.rb#L12\" rel=\"nofollow noreferrer\"><code>pbcopy</code></a> and <a href=\"https://github.com/janlelis/clipboard/blob/master/lib/clipboard/mac.rb#L8\" rel=\"nofollow noreferrer\"><code>pbpaste</code></a> on macOS. Neither application works for files in the way you are describing it.</p>\n\n<p>There is more detail at <a href=\"https://apple.stackexchange.com/a/15327/197811\">this answer</a>, but the short version is that when you select a file in the Finder and press CMD+C, macOS is placing a reference to the selected file into the clipboard, and then when you press CMD+V macOS interprets the referenced file and performs a copy operation for the file to the destination location. There is a lot of behind-the-scenes work done to facilitate that operation. It is an extension of the clipboard's base functionality.</p>\n\n<p>Neither <code>pbcopy</code> nor <code>pbpaste</code> support that functionality; they can only operate on strings. Accordingly, you cannot use the clipboard gem for this purpose.</p>\n\n<p>If the file you want to copy is plaintext then you can read it into a string and then paste it into a new file. If the file is not plaintext (e.g., an image or a compiled binary) then you cannot do this.</p>\n"}], "owner": {"reputation": 85, "user_id": 4785390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb18caa947b6a96f5b5fa5f9f8d8126b?s=128&d=identicon&r=PG&f=1", "display_name": "YiLuo", "link": "https://stackoverflow.com/users/4785390/yiluo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 53472053, "answer_count": 1, "score": 1, "last_activity_date": 1543180574, "creation_date": 1543176434, "question_id": 53471428, "link": "https://stackoverflow.com/questions/53471428/how-to-get-the-temp-file-in-the-clipboard-in-ruby", "title": "How to get the temp file in the clipboard in Ruby?", "body": "<p>I am trying to get the directory of the temp file that is in the clipboard. I wrote the code like this</p>\n\n<pre><code>require 'clipboard'\n\nputs Clipboard.paste\n</code></pre>\n\n<p>I notice that when it is text in the clipboard, the script prints out text, but when it comes to file the output is an empty string.</p>\n\n<p>What is the correct way to get the file from clipboard in Ruby?</p>\n"}]