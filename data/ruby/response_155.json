[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 8, "creation_date": 1514418747, "post_id": 47999892, "comment_id": 82968432, "body": "You&#39;ve defined to_csv on Batch, but you&#39;re calling it on Datum. You didn&#39;t post that class, is it defined there?"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514425463, "post_id": 47999892, "comment_id": 82969823, "body": "@JacobVanus Holy Guacamole that is it. I thought I needed to declare on Batches since that&#39;s where I was calling it. Thank you!"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514503773, "post_id": 47999892, "comment_id": 83000533, "body": "@JacobVanus that fixed it - if you want to post as solution i will accept"}], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 7558674, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qp50wBg6IhU/AAAAAAAAAAI/AAAAAAAAAD0/YNvxuQYnz6A/photo.jpg?sz=128", "display_name": "Pietro Allievi", "link": "https://stackoverflow.com/users/7558674/pietro-allievi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514461637, "last_edit_date": 1514461637, "creation_date": 1514460799, "answer_id": 48006714, "question_id": 47999892, "link": "https://stackoverflow.com/questions/47999892/undefined-method-to-csv-rails-5/48006714#48006714", "title": "undefined method `to_csv&#39; Rails 5", "body": "<p>I don't know if could be helpfull but have you tried to create a show.csv.erb in you app/views/batchs/ folder?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I notice you define to_csv method on another class. I can suppose Datum has a relation one_to_many with Batch, if my considerations are correct try this</p>\n\n<p>models/batch.rb</p>\n\n<pre><code>class Batch &lt; ApplicationRecord\n  belongs_to :user\n  has_many :datums\n\n  def self.to_csv\n    CSV.generate do |csv|\n      csv &lt;&lt; column_names\n      all.each do |datum|\n        csv &lt;&lt; datum.attributes.values_at(*column_names)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>batches_controller.rb</p>\n\n<pre><code>def show\n   @batch = Batch.find(batch_id)\n\n  respond_to do |format|\n    format.html\n    format.csv { send_data @batch.to_csv }\n  end\nend\n</code></pre>\n\n<p>You can always retrieve name by @batch.name</p>\n"}], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514461637, "creation_date": 1514418200, "question_id": 47999892, "link": "https://stackoverflow.com/questions/47999892/undefined-method-to-csv-rails-5", "title": "undefined method `to_csv&#39; Rails 5", "body": "<p>I'm trying to use .to_csv for the first time, and I'm receiving the error <code>undefined method 'to_csv' for #&lt;Datum::ActiveRecord_Relation:0x007fd101f32f08&gt; Did you mean? to_s</code></p>\n\n<p>I've looked around, and I'm unsure if it's my code or <code>.to_csv</code> is incompatible with Rails 5 (5.0.6 to be exact)? Then end goal is for the user to download all the Datum data on the current Batch show page. </p>\n\n<p>Any pointers would be great!</p>\n\n<p>application.rb</p>\n\n<pre><code>require File.expand_path('../boot', __FILE__)\nrequire 'csv'\nrequire 'uri'\nrequire 'net/http'\nrequire 'rails/all'\n</code></pre>\n\n<p>models/batch.rb</p>\n\n<pre><code>class Batch &lt; ApplicationRecord\n  belongs_to :user\n\n\n  def self.to_csv\n    CSV.generate do |csv|\n      csv &lt;&lt; column_names\n      all.each do |datum|\n        csv &lt;&lt; datum.attributes.values_at(*column_names)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>batches_controller.rb</p>\n\n<pre><code>def show\n   batch_id = params[:id]\n   @batch_name = Batch.find(batch_id).name\n   @data = Datum.where(batch_id: batch_id)\n\n  respond_to do |format|\n    format.html\n    format.csv { send_data @data.to_csv }\n  end\nend\n</code></pre>\n\n<p>views/batches/show.html.erb</p>\n\n<pre><code>&lt;%= link_to \"CSV\", batch_path(@batch, format: \"csv\") %&gt; \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "heroku", "errno"], "comments": [{"owner": {"reputation": 10865, "user_id": 2933977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25308d33862d9b72e0b93160b1fd778c?s=128&d=identicon&r=PG", "display_name": "stdunbar", "link": "https://stackoverflow.com/users/2933977/stdunbar"}, "edited": false, "score": 0, "creation_date": 1514416538, "post_id": 47999507, "comment_id": 82967956, "body": "Your answer is in #7 as you posted above - by default you can&#39;t open a URL with the same code as a local file.  Use <code>open-uri</code> as linked in #7."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1514417617, "post_id": 47999507, "comment_id": 82968217, "body": "It&#39;s not clear why you are making the leap from one kind of thing (path to a file on the machine where the code is running) to another entirely different kind of thing (URL) and assuming that they are interchangeable.  Download the file from S3 to a temporary file... as your argument, use the path to that file (which is <b>now</b> an actual path to a file)... then delete the temporary file when you are done."}, {"owner": {"reputation": 21, "user_id": 3138264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9wRlM.png?s=128&g=1", "display_name": "chrisdmccoy", "link": "https://stackoverflow.com/users/3138264/chrisdmccoy"}, "reply_to_user": {"reputation": 10865, "user_id": 2933977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25308d33862d9b72e0b93160b1fd778c?s=128&d=identicon&r=PG", "display_name": "stdunbar", "link": "https://stackoverflow.com/users/2933977/stdunbar"}, "edited": false, "score": 0, "creation_date": 1514957715, "post_id": 47999507, "comment_id": 83117060, "body": "Thanks all for your help and feedback.  This issue has been resolved.  I utilized @stdunbar &#39;s suggested solution.  It&#39;s more clear to me how URLs and URIs are different &amp; how ruby loads (or doesn&#39;t load) certain files.  Here&#39;s the closed github issue for anyone else struggling with this problem: <a href=\"https://github.com/chiedolabs/stl_parser/issues/2\" rel=\"nofollow noreferrer\">github.com/chiedolabs/stl_parser/issues/2</a>"}], "owner": {"reputation": 21, "user_id": 3138264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9wRlM.png?s=128&g=1", "display_name": "chrisdmccoy", "link": "https://stackoverflow.com/users/3138264/chrisdmccoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 892, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1514422312, "creation_date": 1514414778, "last_edit_date": 1514422312, "question_id": 47999507, "link": "https://stackoverflow.com/questions/47999507/errnoenoent-no-file-exists-but-file-does-exist-works-locally-not-in-aws", "title": "&quot;Errno::ENOENT no file exists&quot; but file DOES exist. Works locally, not in AWS", "body": "<p>MY CODE BASE SETUP:  </p>\n\n<ul>\n<li>Ruby on Rails Deployed locally with Postgres</li>\n<li>Production with Heroku (staging and production servers).</li>\n</ul>\n\n<p><strong>MY PROBLEM: Things are \"seemingly\" working on local machine (no hard errors) but NOT working in production.  I believe my issue has to do with sending the proper information to the ruby, <code>file.open()</code> command.</strong></p>\n\n<p>I'm receiving the following error on my production(staging) server:</p>\n\n<blockquote>\n  <p>Errno::ENOENT in Projects#show\n  Showing /app/app/views/projects/show.html.erb where line #276 raised:</p>\n  \n  <p>No such file or directory @ rb_sysopen - <a href=\"https://[bucketname].s3.amazonaws.com/path/to/instance/of/file/file_name.stl\" rel=\"nofollow noreferrer\">https://[bucketname].s3.amazonaws.com/path/to/instance/of/file/file_name.stl</a></p>\n</blockquote>\n\n<p><strong>But if I take the resulting hyperlink and copy / paste it into my web browser, the file open / download menu is prompted.  What am I doing wrong here?</strong>  </p>\n\n<p>BACKGROUND / HISTORY:</p>\n\n<p>I haven't been able to resolve and I've scoured much of the stackoverflow questions looking for answers:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/27207850/enoent-no-such-file-or-directory-but-file-exists\">ENOENT, no such file or directory but file exists</a> ()</li>\n<li><a href=\"https://stackoverflow.com/questions/9056600/file-exists-but-receiving-enoent-error\">File Exists But Receiving ENOENT Error</a>  (I'm not using node and my server restarts everytime I deploy)</li>\n<li><a href=\"https://stackoverflow.com/questions/20905869/rails-3-errnoenoent-exception\">Rails 3: Errno::ENOENT exception</a> (if CentOS is like Heroku, then we have a similar issue which no one seems to be able to answer).  Not sure about my Tmp file situation. But this question sounds similar to my issue.</li>\n<li><a href=\"https://stackoverflow.com/questions/18391271/carrierwave-rails-4-errnoenoent-no-such-file-or-directory-identify\">Carrierwave, Rails 4; Errno::ENOENT (No such file or directory - identify)</a> (might be relevant, but I'm not pulling an imagemagick file, I'm trying to parse a non-image file)</li>\n<li><a href=\"https://stackoverflow.com/questions/10251094/remove-www-http-from-string\">Remove &quot;www&quot;, &quot;http://&quot; from string</a> (I tried stripping various portions of my path in order to feed the file.open() command the right format to no avail</li>\n<li><a href=\"https://stackoverflow.com/questions/1727217/file-open-open-and-io-foreach-in-ruby-what-is-the-difference\">File.open, open and IO.foreach in Ruby, what is the difference?</a> (this helped me understand the difference between each command type, which might be my issue).</li>\n<li><a href=\"https://stackoverflow.com/questions/263536/open-an-io-stream-from-a-local-file-or-url\">Open an IO stream from a local file or url</a> (sounds again like a reliable fix but I don't know how to utilize this open command as the gem specifies a file.open() command vs. these open() commands).</li>\n</ol>\n\n<p>I defined the following method in my \"project model\" (project.rb) which takes the project file from a particular instance and from the \"project_file path\" input, the gem parses an STL file for my webapp.</p>\n\n<p>This particular gem--\"STL_parser\"--calls a file.open(filepath,'rb') command which is where I believe my app is running into issues.  Here's the method I call in my model which calls the STL_parser gem:</p>\n\n<pre><code>def analyze_STL project_file\n\n  if Rails.env.development? || Rails.env.test?\n    full_path = project_file.current_path\n  else\n    full_path = project_file.url.to_s\n  end\n\n  parser = STLParser.new\n  parser.process(full_path)\nend\n</code></pre>\n\n<p>The RESULTS from each case and environment are as follows:</p>\n\n<p>In Development:</p>\n\n<pre><code>    project_file.current_path\n</code></pre>\n\n<p>...for one particular instance yields on my mac:</p>\n\n<pre><code>    /Users/myname/full/path/to/file/on/laptop/unique_instance_file.stl\n</code></pre>\n\n<p>RESULT: app works on local machine AND if I copy/paste the above path into a web browser like Chrome, it prompts a file open / download menu.</p>\n\n<p>In Production Environment:</p>\n\n<pre><code>    project_file.current_path \n</code></pre>\n\n<p>RESULT: </p>\n\n<blockquote>\n  <p>Errno::ENOENT error - No such file or directory @ rb_sysopen\n  -uploads/project/project_file/instance/instance_file.stl</p>\n</blockquote>\n\n<p>and clearly lacks a subdomain, so in Production, I modified the path to call the file URL from AWS as seen above:</p>\n\n<pre><code> project_file.url.to_s\n\n    https://[bucketname].s3.amazonaws.com/path/to/instance/of/file/file_name.stl\n</code></pre>\n\n<p>RESULT:</p>\n\n<blockquote>\n  <p>Errno::ENOENT error - No such file or directory @ rb_sysopen\n  -<a href=\"https://[bucketname].s3.amazonaws.com/path/to/instance/of/file/file_name.stl\" rel=\"nofollow noreferrer\">https://[bucketname].s3.amazonaws.com/path/to/instance/of/file/file_name.stl</a></p>\n</blockquote>\n\n<p>...but if I copy / paste that path into my web browser, the file will prompt an open / download menu.  </p>\n\n<p>Thus the path seems to be pointing towards the correct to the file, but the <code>file.open()</code> command doesn't like that path format.  Thoughts?  I've been banging my head now for some time!</p>\n\n<p>Possibilities:</p>\n\n<ol>\n<li><p>Is it a permissions thing with AWS?  If so, why would other image files produced by other ruby Gems open fine in the same AWS bucket?  </p></li>\n<li><p>When I apply the full-path as a hack...the URL format for my development environment, by simply creating a variable:  <code>hacked_path = \"localhost:3000\"+file_path</code></p></li>\n</ol>\n\n<p>...this generates the Errno::ENOENT No such file or directory @ rb_sysopen error.  But I can copy / paste that same path in my web browser and it opens a download prompt.  So it seems like my browser is piecing together some information about how to open the file, but the Gem I'm calling in my webapp isn't that flexible.  A friend of mine said something about my webapp not being able to read the \"binary\" while my local machine can? </p>\n\n<ol start=\"3\">\n<li><p>Is this an issue of <code>file.open(filename, 'rb')</code> vs. <code>open(filename, 'rb')</code>?  I wouldn't even know how to modify the gem, but I could ask the developers for help.</p></li>\n<li><p>Is this because the my app doesn't have enough time to download the file from AWS before it tries to process the file?</p></li>\n<li><p>CORS permissions in AWS?</p></li>\n<li><p>Something else more simple I haven't thought of?  </p></li>\n</ol>\n\n<p>Thanks in advance for your help and feedback!  Yes I know I need more programming fundamentals courses.  Any online ones you'd recommend?  Already took the one from onemonth.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1514422901, "creation_date": 1514422901, "answer_id": 48000394, "question_id": 47999457, "link": "https://stackoverflow.com/questions/47999457/how-can-i-access-my-form-data-for-a-has-many-through-relationship/48000394#48000394", "title": "How can I access my form data for a has_many_through relationship?", "body": "<p>I may be totally wrong, but I think that if you run something like <code>@series.pros.create(params)</code> you will have what you need with the join table populated correctly.</p>\n"}], "owner": {"reputation": 121, "user_id": 3731338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcbec906a7c838a7a7b1a3495720ce4b?s=128&d=identicon&r=PG&f=1", "display_name": "GLD", "link": "https://stackoverflow.com/users/3731338/gld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1514452036, "creation_date": 1514414373, "last_edit_date": 1514452036, "question_id": 47999457, "link": "https://stackoverflow.com/questions/47999457/how-can-i-access-my-form-data-for-a-has-many-through-relationship", "title": "How can I access my form data for a has_many_through relationship?", "body": "<p>This gist of the application is that 'Pros' have multiple video series, which are made up of multiple videos.</p>\n\n<p>My issue lies where each Pro may feature in several videos, and each series may feature multiple pros. I have set this up as a 'has many through' relationship, where pros and series may have many 'features' but each feature belongs to a single pro and series (join table).</p>\n\n<p>Therefore I declared my models as such:</p>\n\n<pre><code>class Pro &lt; ApplicationRecord\n    has_many :features\n    has_many :series, through: :features\nend\n\nclass Series &lt; ApplicationRecord\n    has_many :features\n    has_many :pros, through: :features\n    has_many :videos\nend\n\nclass Feature &lt; ApplicationRecord\n    belongs_to :pro\n    belongs_to :series\nend\n</code></pre>\n\n<p>Pros are created as normal in their own form, however when creating a series I want to specify which Pros are featured in the series.</p>\n\n<p>For which I have attempted:</p>\n\n<pre><code>def new\n    @pro = Pro.new\nend\n\ndef create\n    @pro = Pro.new(pro_params)\n\n    if @pro.save\n        redirect_to pros_path\n    else\n        render 'edit'\n    end\nend\n</code></pre>\n\n<p>Fairly normal stuff so far...</p>\n\n<p>However, within: ~\\views\\series_form.html.haml.\nI attempt to select the pro for the series from a dropdown box...</p>\n\n<pre><code>= form_for @series do |f|\n%p\n    Title:\n    = f.text_field :title\n= fields_for(@series, @series.pros) do |u|\n    %p= collection_select(:pro, :pro_id, @pros.all, :id, :name, prompt: :true)\n%p= f.submit \"Submit\"\nlink_to \"Back\", root_path\n</code></pre>\n\n<p>Collection select gives me a dropdown menu to select a pro, I want to use this information to create a 'feature' for that pro in my database, allowing me to link a series and pro together.</p>\n\n<blockquote>\n  <p>How can I access the data in this form so I can run @series.features.create(pro_id: @pro.id) or equivalent in the create method?</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515456505, "post_id": 48000413, "comment_id": 83299121, "body": "@maximilian thanks for answering, it is possible that instead of reloading the entire page, it will only be reloaded by ajax and with the last parameters entered from a search engine?"}], "tags": [], "owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1514423086, "creation_date": 1514423086, "answer_id": 48000413, "question_id": 47999453, "link": "https://stackoverflow.com/questions/47999453/how-to-update-automatically/48000413#48000413", "title": "How to update automatically?", "body": "<p>You can add some timeout js function with location reload to reload the page every x minutes.\nExample:</p>\n\n<pre><code>&lt;script&gt;\n  setTimeout(function(){ document.location.reload() }, 300000);\n&lt;/script&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515456385, "post_id": 48001518, "comment_id": 83299086, "body": "thanks for answering, I tried with your code but when I checked the console I see that it is not working, I need to place something more additional in my rails code to send it by ajax?"}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515518974, "post_id": 48001518, "comment_id": 83326881, "body": "In the line data:data I get this error: Uncaught ReferenceError: data is not defined     at"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515521227, "post_id": 48001518, "comment_id": 83328032, "body": "Data means pass your search params in hash format e.g. <code>data: {key: value, key: value}</code>"}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515541512, "post_id": 48001518, "comment_id": 83336739, "body": "Well, now it is executed when the time lapse is fulfilled but it is only executed once, is there any way to make it run several times? and it is possible that instead of JSON it is executed by JS?"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515567808, "post_id": 48001518, "comment_id": 83343451, "body": "It will execute on every 5 second. and send request as js instead of json, check my updated answer."}, {"owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515613878, "post_id": 48001518, "comment_id": 83370836, "body": "thanks for the update, it is strange but it only reloads it once after the specified time, will it be because I am only loading specific parts of the page and not the whole page with the javascript code?"}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "edited": false, "score": 0, "creation_date": 1515644551, "post_id": 48001518, "comment_id": 83380511, "body": "No problem, its not about load specific part of page, anyway I updated answer please check if it will work for you. and if you think it works for you accept the answer and up vote it."}], "tags": [], "owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "is_accepted": false, "score": 0, "last_activity_date": 1515644570, "last_edit_date": 1515644570, "creation_date": 1514434662, "answer_id": 48001518, "question_id": 47999453, "link": "https://stackoverflow.com/questions/47999453/how-to-update-automatically/48001518#48001518", "title": "How to update automatically?", "body": "<p>Yes, you can auto update the report page periodically using <code>timeout</code> and <code>ajax</code> request.</p>\n\n<p>in your page.js</p>\n\n<pre><code>$( document ).ready(function() {\n  setTimeout(function(){ \n    $.ajax({\n      url: '/report', # Write url of your request API\n      type: \"GET\",\n      data: data, # Pass data here, as a parameter\n      dataType: \"JSON\",\n    }).done(function(data) {\n      # Do stuff here\n    }\n  }, 5000 ); # Set the time as you wish, this will execute at every 5 seconds\n});\n</code></pre>\n\n<p><strong>Update ajax call</strong></p>\n\n<pre><code>$( document ).ready(function() {\n  window.setInterval(function(){\n    $.ajax({\n      url: '/report.js', # Write url of your request API\n      type: \"GET\",\n      data: data # Pass data here, as a parameter\n    }).done(function(data) {\n      # Do stuff here\n    }\n  }, 5000 ); # Set the time as you wish, this will execute at every 5 seconds\n});\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515644570, "creation_date": 1514414337, "question_id": 47999453, "link": "https://stackoverflow.com/questions/47999453/how-to-update-automatically", "title": "How to update automatically?", "body": "<p>I am developing a report that will contain a small search field to send parameters, execute the query and show the data but I need that report to be updated every certain time or when there are more records to show, how could I auto update the report with the same parameters? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "qr-code", "actionmailer"], "answers": [{"tags": [], "owner": {"reputation": 2234, "user_id": 7927036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j8HJn.png?s=128&g=1", "display_name": "Matt Croak", "link": "https://stackoverflow.com/users/7927036/matt-croak"}, "is_accepted": true, "score": 2, "last_activity_date": 1514574539, "creation_date": 1514574539, "answer_id": 48027278, "question_id": 47999411, "link": "https://stackoverflow.com/questions/47999411/trouble-rendering-qr-code-in-email-using-rails-actionmailer/48027278#48027278", "title": "Trouble Rendering QR code in Email using Rails ActionMailer", "body": "<p>I found another <a href=\"https://stackoverflow.com/questions/32538786/rails-4-getting-qrcode-to-display-in-email-via-action-mailer\">question</a> similar to this one and ended up going with the <a href=\"https://rubygems.org/gems/google-qr/versions/0.2.2\" rel=\"nofollow noreferrer\">google-qr gem</a> utilizing the <a href=\"https://github.com/jhsu/google-qr\" rel=\"nofollow noreferrer\">google charts api</a>.</p>\n\n<p>It's really easy to use and worked like a charm!</p>\n\n<p>In my model:</p>\n\n<pre><code>def generate_qr(text)\nrequire 'google-qr'\nchart = GoogleQR.new(:data =&gt; \"#{text}\", :size =&gt; \"500x500\", :margin =&gt; 4, :error_correction =&gt; \"L\")\nreturn chart.to_s end\n</code></pre>\n\n<p>In my view: </p>\n\n<pre><code>&lt;%=image_tag(\"#{@company_lead_rsvp_ticket.generate_qr(@company_lead_rsvp_ticket.otp_secret_key)}\", :alt =&gt; \"qrcode\")%&gt; &lt;br/&gt;\n</code></pre>\n\n<p><code>google-qr</code> accepts a text input which is uses to generate a qr code and host it using a secure URL. All you have to do is take the data generated by <code>google-qr</code> and convert it to a string so it can be used as an image source. </p>\n\n<p>The best part is that if you tried to go directly to this URL in your browser you get a big fat 400 error and you cannot see the QR code. </p>\n"}], "owner": {"reputation": 2234, "user_id": 7927036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/j8HJn.png?s=128&g=1", "display_name": "Matt Croak", "link": "https://stackoverflow.com/users/7927036/matt-croak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 48027278, "answer_count": 1, "score": 1, "last_activity_date": 1514574539, "creation_date": 1514414066, "question_id": 47999411, "link": "https://stackoverflow.com/questions/47999411/trouble-rendering-qr-code-in-email-using-rails-actionmailer", "title": "Trouble Rendering QR code in Email using Rails ActionMailer", "body": "<p>I am currently able to generate a QR code using ActionMailer but I am unable to actually send that QR code in an email. The element is being sent through properly but the image is broken and it only shows the alt. I can see the QR code in my ActionMailer preview but for some reason it isn't going through when the email is sent/received. </p>\n\n<p>I am using barby to create the QR code in my CompanyLeadRsvpTicketModel. </p>\n\n<p>Here is the code in my model:</p>\n\n<pre><code>def generate_qr(text)\n\n  require 'barby'\n  require 'barby/barcode'\n  require 'barby/barcode/qr_code'\n  require 'barby/outputter/png_outputter'\n\n  barcode = Barby::QrCode.new(text, level: :q, size: 5)\n  base64_output = Base64.encode64(barcode.to_png({ xdim: 5 }))\n  return \"data:image/png;base64,#{base64_output}\"\n\nend\n</code></pre>\n\n<p>And here is the code in my view:</p>\n\n<pre><code>&lt;h1&gt;Hi &lt;%= @company_lead_rsvp_ticket.company_lead[0].first_name%&gt;! Here is your RSVP ticket for the &lt;%=@event.title%&gt;!&lt;/h1&gt;&lt;h2&gt;Please bring this ticket to check in for the event.&lt;/h2&gt;&lt;%=image_tag(\"#{@company_lead_rsvp_ticket.generate_qr(@company_lead_rsvp_ticket.otp_secret_key)}\", :alt =&gt; \"qrcode\")%&gt;&lt;p&gt;&lt;%= @company_lead_rsvp_ticket.confirmation %&gt;&lt;/p&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "partials"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1514411336, "post_id": 47999014, "comment_id": 82966542, "body": "change <code>resources :items, only: [:new, :create]</code> to <code>resources :items, only: [:new, :create, :index]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1515265029, "last_edit_date": 1515265029, "creation_date": 1514411991, "answer_id": 47999131, "question_id": 47999014, "link": "https://stackoverflow.com/questions/47999014/nomethoderror-in-usersshow-ruby-rails/47999131#47999131", "title": "NoMethodError in Users#show (Ruby Rails)", "body": "<p>Your <code>items</code> route is nested under <code>users</code>. therefore you have to pass both to the <code>form_for</code> - a user and an item.</p>\n\n<p>Something like this will probably work:</p>\n\n<pre><code>&lt;%= form_for(current_user, @item) do |f| %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 7920477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3719c25b1179d515e71c97ed21f9d8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Yun", "link": "https://stackoverflow.com/users/7920477/jacob-yun"}, "edited": false, "score": 0, "creation_date": 1514416267, "post_id": 47999140, "comment_id": 82967873, "body": "Thank you, your explanation was clear and helped solve my issue!"}], "tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": true, "score": 1, "last_activity_date": 1514412054, "creation_date": 1514412054, "answer_id": 47999140, "question_id": 47999014, "link": "https://stackoverflow.com/questions/47999014/nomethoderror-in-usersshow-ruby-rails/47999140#47999140", "title": "NoMethodError in Users#show (Ruby Rails)", "body": "<p>In your <code>routes.rb</code> file, you have items defined as a <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested resource</a>. You can check all of your routes by running this command on your terminal: <code>rake routes</code>.</p>\n\n<p>For your routes specifically, you say:</p>\n\n<pre><code>resources :users do\n  resources :items, only: [:new, :create]\nend\n</code></pre>\n\n<p>This would give you routes for <code>GET /users/:user_id/items/new</code> and <code>POST /users/:user_id/items</code>. However, in your form, it looks like you're trying to do this: <code>&lt;%= form_for @item do |f| %&gt;</code>. You don't have a route defined for an item by itself. You'll need to supply a user as well.</p>\n\n<p>Try this for your form:</p>\n\n<pre><code>&lt;%= form_for [@user, @item] do |f| %&gt;\n</code></pre>\n\n<p>And something like this in your <code>ItemsController</code>:</p>\n\n<pre><code>class ItemsController\n  def new\n    @user = current_user\n    @item = Item.new\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7920477, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3719c25b1179d515e71c97ed21f9d8b?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Yun", "link": "https://stackoverflow.com/users/7920477/jacob-yun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "accepted_answer_id": 47999140, "answer_count": 2, "score": 1, "last_activity_date": 1515265029, "creation_date": 1514411143, "question_id": 47999014, "link": "https://stackoverflow.com/questions/47999014/nomethoderror-in-usersshow-ruby-rails", "title": "NoMethodError in Users#show (Ruby Rails)", "body": "<p>I'm running into a NoMethodError in my Users#show when trying to include a form partial for submitting a task item (_form.html.erb). My other partial (_item.html.erb) is rendering properly. My item model and my user model are related to each other, user has_many :items, and item belongs_to :user.</p>\n\n<p>Any and all help would be greatly appreciated!</p>\n\n<p>Below is my routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  get 'welcome/index'\n\n  get 'welcome/about'\n\n  root 'users#show'\n\n  resources :users do\n    resources :items, only: [:new, :create]\n  end\n\n\n  devise_for :users\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n\n<p>Below is my terminal output</p>\n\n<pre><code>ActionView::Template::Error (undefined method `items_path' for #&lt;#&lt;Class:0x007fefeca61dd0&gt;:0x007fefeca58b18&gt;\nDid you mean?  items_create_path):\n    1: &lt;h4&gt; Create a new to-do item &lt;/h4&gt;\n    2: \n    3: &lt;%= form_for @item do |f| %&gt;\n    4:   &lt;%= f.label :name %&gt;\n    5:   &lt;%= f.text_field :name, class: 'form-control', placeholder: \"Enter task here\" %&gt;\n</code></pre>\n\n<p>Items Controller</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\n    def new\n        @item = Item.new\n    end\n\n    def create\n        @item = Item.new\n        @item.user = current_user\n        @item.name = params[:item][:name]\n\n        if @item.save\n            flash[:notice] = \"Item saved\"\n            redirect_to @item\n        else\n            flash.now[:alert] = \"Item was not created, please try again.\"\n            render :new\n        end\n    end\nend\n</code></pre>\n\n<p>Users Controller</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n\n  def show\n    if !current_user.nil?\n      @user = current_user\n      @item = Item.new\n      @items = @user.items\n    else\n      redirect_to new_user_registration_path\n    end  \n  end\nend\n</code></pre>\n\n<p>Users#show page</p>\n\n<pre><code>&lt;h2&gt; Your to-do list&lt;/h2&gt;\n\n\n  &lt;div class=\"col-md-8\"&gt;\n    &lt;div class='items'&gt;\n      &lt;%= render partial: \"items/item\", local: { item: @item} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"col-md-8\"&gt;\n    &lt;div class='new-item'&gt;\n      &lt;%= render partial: \"items/form\", local: { item: @item } %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "merge", "devise", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 849, "user_id": 2601689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KKSIm.jpg?s=128&g=1", "display_name": "Designer", "link": "https://stackoverflow.com/users/2601689/designer"}, "is_accepted": true, "score": 0, "last_activity_date": 1516579649, "creation_date": 1516579649, "answer_id": 48373067, "question_id": 47998483, "link": "https://stackoverflow.com/questions/47998483/rails-5-merging-existing-custom-user-table-scaffolded-with-devise/48373067#48373067", "title": "Rails 5: merging existing custom user table (scaffolded) with Devise", "body": "<p>I figured it out. Apparently I could use any existing table for Devise. I just added Devise required fields to Designer table and added devise_for :designers to routes.rb</p>\n"}], "owner": {"reputation": 849, "user_id": 2601689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KKSIm.jpg?s=128&g=1", "display_name": "Designer", "link": "https://stackoverflow.com/users/2601689/designer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 48373067, "answer_count": 1, "score": 0, "last_activity_date": 1516579649, "creation_date": 1514407759, "question_id": 47998483, "link": "https://stackoverflow.com/questions/47998483/rails-5-merging-existing-custom-user-table-scaffolded-with-devise", "title": "Rails 5: merging existing custom user table (scaffolded) with Devise", "body": "<p>Happy Xmas friends,</p>\n\n<p>I have a Designer table (Scaffolded) where I create users manually and add posts for them.  I created all users with their Twitter username. </p>\n\n<p>.....com/designer/jonive</p>\n\n<p>Now I want to open twitter sign up functionality with Devise and I was wondering how I can merge my Designer table with Devise User so that when someone signups, </p>\n\n<ul>\n<li>if it matches with an existing designer name I added earlier, it would move posts for the user\u2019s control (edit/delete)</li>\n<li>If not, it would just create as new user. </li>\n</ul>\n\n<p>Thank you </p>\n"}, {"tags": ["ruby", "reflection"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1514405335, "post_id": 47997916, "comment_id": 82964413, "body": "<a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\"><code>pry</code></a> an <code>irb</code> alternative also has excellent methods for this like <code>show-method</code> which will output the file location and the method body"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1514407225, "post_id": 47997916, "comment_id": 82965091, "body": "@engineersmnky still for methods written in ruby itself only :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407482, "post_id": 47997916, "comment_id": 82965183, "body": "@mudasobwa please explain?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407548, "post_id": 47997916, "comment_id": 82965211, "body": "It won\u2019t work for the core methods, written in C."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407630, "post_id": 47997916, "comment_id": 82965238, "body": "@mudasobwa not true <code>show-method puts</code> outputs &quot;From: io.c (C Method): Owner: Kernel Visibility: private Number of lines: 8  static VALUE rb_f_puts(int argc, VALUE *argv, VALUE recv) {     if (recv == rb_stdout) {         return rb_io_puts(argc, argv, recv);     }     return rb_funcall2(rb_stdout, rb_intern(&quot;puts&quot;), argc, argv); }&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407716, "post_id": 47997916, "comment_id": 82965266, "body": "Oh, indeed. Sorry, I was plain wrong, my understanding was obsolete. Thanks!"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514413288, "post_id": 47997916, "comment_id": 82967071, "body": "Your question is unclear. What do you mean by the &quot;scope of an object&quot;, for example? Objects don&#39;t <i>have</i> scopes. The closest an object has to a scope is the <i>lifetime</i> of the object, and no, IRb cannot tell you the lifetime of the object, because statically determining the lifetime of an object is equivalent to solving the Halting Problem. (Put another way: if IRb could tell you the lifetime of an object, then Ruby wouldn&#39;t need garbage collection. The whole reason why garbage collection, reference counting, manual memory management etc. exist is because this cannot be done.)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514413510, "post_id": 47997916, "comment_id": 82967159, "body": "Likewise, for methods, class, and variables, it is unclear what exactly you mean by &quot;the scope of&quot;. Methods and classes <i>are</i> scopes (or rather their bodies are) but there are other scopes as well, and variables <i>belong</i> to scopes."}], "answers": [{"comments": [{"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 3, "creation_date": 1514404946, "post_id": 47997957, "comment_id": 82964240, "body": "And once you have the method, you can call <code>method.owner</code> to get the class. In this case, <code>method.owner</code> would return <code>Kernel</code>."}, {"owner": {"reputation": 1608, "user_id": 241930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d29fef1247a3b3c86ab7e52e31c5537?s=128&d=identicon&r=PG", "display_name": "Christian Madsen", "link": "https://stackoverflow.com/users/241930/christian-madsen"}, "edited": false, "score": 0, "creation_date": 1514407329, "post_id": 47997957, "comment_id": 82965131, "body": "@mudasobwa Thanks for the URI tip. I see that I can get a Method object using this strategy. One question: I don&#39;t see URI#method method documented.  Can you explain how it works?  And can I also do this for class/instance?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407484, "post_id": 47997957, "comment_id": 82965185, "body": "It is a method of Object, or Module, or even Kernel. Use this technique to discover it with <code>URI.method(:method)</code> :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1514404950, "last_edit_date": 1514404950, "creation_date": 1514404834, "answer_id": 47997957, "question_id": 47997916, "link": "https://stackoverflow.com/questions/47997916/ruby-irb-get-scope-info-for-method/47997957#47997957", "title": "ruby/irb get scope info for method", "body": "<p>For the methods defined on <code>Kernel</code> / <code>Object</code> one might simply use:</p>\n\n<pre><code>method :puts\n#\u21d2\u00a0#&lt;Method: Object(Kernel)#puts&gt; \n</code></pre>\n\n<p>For the method defined on the module/class that is not included everywhere, the fully qualified name is required:</p>\n\n<pre><code>Integer.instance_method :to_s\n#\u21d2 #&lt;UnboundMethod: Integer#to_s&gt; \n</code></pre>\n\n<p>For methods, defined in ruby (not in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a>,) the source location might be also queried:</p>\n\n<pre><code>URI.method(:split).source_location\n#\u21d2 [\"/path_to_ruby/uri/common.rb\", 192] \n</code></pre>\n"}], "owner": {"reputation": 1608, "user_id": 241930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d29fef1247a3b3c86ab7e52e31c5537?s=128&d=identicon&r=PG", "display_name": "Christian Madsen", "link": "https://stackoverflow.com/users/241930/christian-madsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 47997957, "answer_count": 1, "score": -1, "last_activity_date": 1514404950, "creation_date": 1514404557, "question_id": 47997916, "link": "https://stackoverflow.com/questions/47997916/ruby-irb-get-scope-info-for-method", "title": "ruby/irb get scope info for method", "body": "<p>Can IRB tell me the scope of a class/object/variable/method?</p>\n\n<p>For instance <code>puts</code>.</p>\n\n<p>I am imagining something like <code>describe puts</code> would output information that puts is a method of object and perhaps where its source is located.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 10, "creation_date": 1514404515, "post_id": 47997875, "comment_id": 82964062, "body": "Your last example seems pretty ruby-ish to me..."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 4, "creation_date": 1514410311, "post_id": 47997875, "comment_id": 82966168, "body": "<code>puts [1,2,3]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1608, "user_id": 241930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d29fef1247a3b3c86ab7e52e31c5537?s=128&d=identicon&r=PG", "display_name": "Christian Madsen", "link": "https://stackoverflow.com/users/241930/christian-madsen"}, "edited": false, "score": 0, "creation_date": 1514404658, "post_id": 47997907, "comment_id": 82964117, "body": "Thanks. Exactly what I was looking for. Now, I just need to wait 10 minutes before SO allows me to flag this as &quot;answer&quot;"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1514405607, "post_id": 47997907, "comment_id": 82964508, "body": "To expand on this a bit for other perusing parties the leading <code>&amp;</code> in this case is to convert the argument to a block via the object&#39;s <code>to_proc</code> method. For instance <code>&amp;:to_s</code> (as in the question is <code>Symbol#to_proc</code>) and <code>&amp;method(:puts)</code> (as in the answer) is <code>Method#to_proc</code>. For <code>Symbol#to_proc</code> is sends the <code>Symbol</code> to the block argument where as <code>Method#to_proc</code> sends the block argument to the <code>Method</code>"}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 3, "creation_date": 1514405950, "post_id": 47997907, "comment_id": 82964608, "body": "This is neat and all but I think OPs last example is more idiomatic and, more importantly, <i>much easier to understand</i> than these examples..."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1514404716, "last_edit_date": 1514404716, "creation_date": 1514404473, "answer_id": 47997907, "question_id": 47997875, "link": "https://stackoverflow.com/questions/47997875/ruby-apply-puts-to-array/47997907#47997907", "title": "ruby apply puts to array", "body": "<p><code>puts</code> is a method, defined on <code>Kernel</code> to convert it to <code>proc</code>, use:</p>\n\n<pre><code>[1,2,3].each(&amp;method(:puts))\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core/Symbol.html#method-i-to_proc\" rel=\"nofollow noreferrer\"><code>Symbol#to_proc</code></a> has a specific meaning, basically sending itself to the receiver.</p>\n\n<p>One might convert any method to <code>proc</code> to pass it to block:</p>\n\n<pre><code>%w[1 2 3].map(&amp;method(:Integer))\n#\u21d2\u00a0[1, 2, 3]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514407049, "post_id": 47998219, "comment_id": 82965031, "body": "This will never pass my CR. Ruby was invented to be syntax sugared and it deserves the ability to have this syntax sugar usage."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1514418781, "post_id": 47998219, "comment_id": 82968440, "body": "@mudasobwa I suppose we have differing opinions here - to me, simplicity and clarity are more important than sugar."}, {"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 1, "creation_date": 1514428519, "post_id": 47998219, "comment_id": 82970378, "body": "Never is a strong word. IMO, very few things in programming should use the words never or always. I have to agree with @maerics on this one. Code is written, yes; but in the end, code is meant to be read. It&#39;s read by your future self and the next guy that has to maintain your code."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514435811, "post_id": 47998219, "comment_id": 82971735, "body": "Using an explicit block where the shorthand might be used does not bring additional simplicity nor clarity. The same way as using <i>\u201cget\u201c</i> instead of all other verbs does not make English text better readable. Ampersand notation is a core of ruby and if it decreases the ability of developers to read it smoothly, I would question developers\u2019 expertise/skills in the first place. And yes, I ban <code>{ |e| e.to_s }</code> instead of <code>(&amp;:to_s)</code> explicitly for the sake of readability and simplicity, not vice versa. It makes me think they do not understand the basics and I put some effort to make them do."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 5, "last_activity_date": 1514406276, "creation_date": 1514406276, "answer_id": 47998219, "question_id": 47997875, "link": "https://stackoverflow.com/questions/47997875/ruby-apply-puts-to-array/47998219#47998219", "title": "ruby apply puts to array", "body": "<p>Your last example is idiomatic Ruby:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>[1,2,3].each { |x| puts x }\n</code></pre>\n\n<p>There are certainly other ways to do the same thing but the code above is straightforward and easily understood by any Rubyist.</p>\n"}], "owner": {"reputation": 1608, "user_id": 241930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d29fef1247a3b3c86ab7e52e31c5537?s=128&d=identicon&r=PG", "display_name": "Christian Madsen", "link": "https://stackoverflow.com/users/241930/christian-madsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 47997907, "answer_count": 2, "score": 1, "last_activity_date": 1514433035, "creation_date": 1514404326, "last_edit_date": 1514433035, "question_id": 47997875, "link": "https://stackoverflow.com/questions/47997875/ruby-apply-puts-to-array", "title": "ruby apply puts to array", "body": "<p>For methods that the elements of an array responds to, I can do </p>\n\n<pre><code>[1,2,3].each(&amp;:to_s)\n</code></pre>\n\n<p>But for:</p>\n\n<pre><code>[1,2,3].each {|i| puts i}\n</code></pre>\n\n<p>I cannot do:</p>\n\n<pre><code>[1,2,3].each(&amp;:puts)\n</code></pre>\n\n<p>How do I elegantly apply <code>Kernel</code> methods such as <code>puts</code> to the objects in an array? Would there be a more Rubyish way?</p>\n"}, {"tags": ["ruby", "postgresql", "multidimensional-array", "ruby-on-rails-5", "relationships"], "comments": [{"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 1, "creation_date": 1514407934, "post_id": 47997426, "comment_id": 82965338, "body": "You can do this sort of condensing (&quot;aggregating&quot;) in SQL but it&#39;s not usually pretty (at least in MySQL, don&#39;t know about postgres). I&#39;d use the ruby-core method <a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\"><code>Array#group_by</code></a> method. E.g. <code>Meeting.all.preload(:location, :service).group_by{|meeting| [meeting.location.name, meeting.service.name]}</code> (swap out <code>name</code> for the relevant field, like <code>title</code> or whatever you called them), and go from there."}, {"owner": {"reputation": 151, "user_id": 756655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/11ff7e6de40f27c56c5f2e5bc367af99?s=128&d=identicon&r=PG", "display_name": "Josiah Palmer", "link": "https://stackoverflow.com/users/756655/josiah-palmer"}, "reply_to_user": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 0, "creation_date": 1514580141, "post_id": 47997426, "comment_id": 83026378, "body": "@AndrewSchwartz: Thank you so much! That did it!"}, {"owner": {"reputation": 151, "user_id": 756655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/11ff7e6de40f27c56c5f2e5bc367af99?s=128&d=identicon&r=PG", "display_name": "Josiah Palmer", "link": "https://stackoverflow.com/users/756655/josiah-palmer"}, "reply_to_user": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 0, "creation_date": 1514580347, "post_id": 47997426, "comment_id": 83026443, "body": "@AndrewSchwartz: I&#39;d love to select this answer as the correct answer but it&#39;s only a comment. If you turn it into an answer, I&#39;ll definitely checkmark it."}], "owner": {"reputation": 151, "user_id": 756655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/11ff7e6de40f27c56c5f2e5bc367af99?s=128&d=identicon&r=PG", "display_name": "Josiah Palmer", "link": "https://stackoverflow.com/users/756655/josiah-palmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514401857, "creation_date": 1514401857, "last_edit_date": 1592644375, "question_id": 47997426, "link": "https://stackoverflow.com/questions/47997426/ruby-rails-how-to-map-and-condense-database-query-into-multidimensional-arrays", "title": "Ruby/Rails: How to map and condense database query into multidimensional arrays", "body": "<p>I have a Location model and a Service model. I also have a Meeting model that belongs to one Location and to one Service and has a weekday param and a time param.</p>\n<p>I need to display all of my meetings by location then by service in a condensed format. My plan was to pull all my meetings (it's a closed database and will remain very low volume) by location and then by type (service), condense them according to the day while putting them in a multidimensional array that gets read out in the view. The following is how it should look in the view:</p>\n<hr />\n<h2>Tennille Campus (from Location model)</h2>\n<h2>Weekend Services (a Service)</h2>\n<p><em>Saturdays (weekday param) at 7:00pm (time param)</em>\n<em>Sundays at 9:30am and 11:15am</em></p>\n<h2>Youth</h2>\n<p><em>Sundays at 6:00pm</em></p>\n<hr />\n<p>My plan was for output array to look like:</p>\n<pre><code>array = [[&quot;Weekend Services&quot;, [&quot;Saturdays at 7:00pm&quot;, &quot;Sundays at 9:30am and 11:15am&quot;]], [&quot;Youth&quot;, [&quot;Sundays at 6:00pm&quot;]]]\n</code></pre>\n<p>I figured I would pass the location to the function and use my scope for that part but I'm getting lost when it comes to ordering meetings by services in the services order of importance (<em>a Service scope</em>). The problem I'm having is trying to not make so many requests to the database with if statements. How do I do this without the if statements?</p>\n<hr />\n<pre><code>**meeting.rb**\n\nbelongs_to :location\nbelongs_to :service\n\n#scopes based on meeting types\nscope :in_partial, -&gt; { where(level: 1) }\nscope :location, lambda { |location| where(:location_id =&gt; location) }\nscope :titled, lambda { |title| where(:title =&gt; title) }\nscope :on_day, lambda { |weekday| where(weekday: Date::DAYNAMES.index(weekday)) }\n</code></pre>\n<hr />\n<pre><code>**service.rb**\n\nhas_many :meetings\n\nscope :ordered_by_priority, -&gt; { order(priority: :asc) }\n</code></pre>\n<hr />\n<p>I'm using rails 5 and a postgresql db.</p>\n<p>Thank you for the help and let me know if there's a better way than using the array to do this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 0, "creation_date": 1514396326, "post_id": 47996009, "comment_id": 82960810, "body": "Have you tried <code>Scopes</code>?, I think it will be worth trying."}, {"owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514396718, "post_id": 47996009, "comment_id": 82960945, "body": "Why not define a scope on Post which accepts a user_id param and returns only posts that user has not yet viewed."}, {"owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "reply_to_user": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514398938, "post_id": 47996009, "comment_id": 82961829, "body": "@Jacob Vanus I want to show all posts, not just new ones. and then I want to use the frontend to mark the new ones as new. probably by giving the element a class of &#39;new&#39; unless my understanding of scopes is deficient, theres no real way use them in this fashion."}, {"owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514400402, "post_id": 47996009, "comment_id": 82962416, "body": "I think that case is actually easier. Just define <code>Post#is_new_for_user?(user)</code> as ruby (not SQL). Then eager load event data in a scope <code>Post#for_user -&gt; (user)</code>. Your controller only calls 1 method, your view can branch on <code>is_new_for_user?(current_user)</code> without making db queries."}, {"owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "reply_to_user": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "edited": false, "score": 0, "creation_date": 1514402933, "post_id": 47996009, "comment_id": 82963428, "body": "@Jacob Vanus I think you might be on to something there, but I don&#39;t understand what you are describing. do you think you could post an answer? It sounds a lot like what I already have, the problem is that .where() will hit the database whether events have been eager loaded or not."}], "answers": [{"comments": [{"owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514399116, "post_id": 47996559, "comment_id": 82961894, "body": "as far as I know there is no way to write a scope that will add a parameter like the methods block does. I want to return all the posts for forum ID 15, not just the new ones. I&#39;ll use a css class on the front end to mark the new ones as new. Does that make sense?"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "reply_to_user": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514399625, "post_id": 47996559, "comment_id": 82962117, "body": "I was talking about <a href=\"http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments\" rel=\"nofollow noreferrer\">sending this type of parameter</a>, take a look at the link and let me know if we are talking about the same thing. And about the post from forum ID 15, you want to return all post, but making a distinction with the post that are new for forum ID 15, and the ones that are old??"}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "reply_to_user": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514400484, "post_id": 47996559, "comment_id": 82962445, "body": "How about, adding a boolean field (<code>new</code>) to your model? with a defaul value of <code>true</code>, a value that later will be updated to <code>false</code> (with a business logic rule). In that way, you can return all your post from the forum, and in your view you can ask for that value to reder it in the proper way."}, {"owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514402720, "post_id": 47996559, "comment_id": 82963349, "body": "I think we were speaking of the same thing earlier, as for adding a boolean field to the model, that won&#39;t work because I have more than one user, this is a forum type of situation, so posts that are new for one user will not be new for another, hence the events table."}], "tags": [], "owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1514397143, "creation_date": 1514397143, "answer_id": 47996559, "question_id": 47996009, "link": "https://stackoverflow.com/questions/47996009/session-aware-model-methods-in-to-json-cause-n1-queries/47996559#47996559", "title": "session aware model methods in to_json cause n+1 queries", "body": "<p>If working with <code>scope</code> is an option, I will try something like:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  scope :is_new, -&gt; { where(user_id: current_user.id, name: 'Show') } if current_user.id?\nend\n</code></pre>\n\n<p>If is a better option to send the <code>current_user</code> in your case, you can also do it:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  scope :is_new, -&gt;(current_user) {...}\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514405376, "post_id": 47997945, "comment_id": 82964428, "body": "I&#39;ll give this a shot, I might have some quesitons regarding making this work with to_json(), (I&#39;m not using .erb files, the front end is a separate node project.)"}, {"owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "reply_to_user": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "edited": false, "score": 0, "creation_date": 1514406776, "post_id": 47997945, "comment_id": 82964913, "body": "Oops, I forgot about the json. Posted an edit to help with that."}], "tags": [], "owner": {"reputation": 470, "user_id": 1249891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df65c5095bee4d8e1177fb87c4d81249?s=128&d=identicon&r=PG", "display_name": "Jacob Vanus", "link": "https://stackoverflow.com/users/1249891/jacob-vanus"}, "is_accepted": false, "score": 0, "last_activity_date": 1514406446, "last_edit_date": 1514406446, "creation_date": 1514404724, "answer_id": 47997945, "question_id": 47996009, "link": "https://stackoverflow.com/questions/47996009/session-aware-model-methods-in-to-json-cause-n1-queries/47997945#47997945", "title": "session aware model methods in to_json cause n+1 queries", "body": "<p>This is just pseudo-code to give an example:</p>\n\n<h2>First Answer</h2>\n\n<p>When I posted this I forgot you are rendering json from ForumsController.</p>\n\n<h3>Post</h3>\n\n<pre><code>scope :for_user, -&gt; (user = nil) do \n  includes(events: :users).where(users: {id: user.id}) if user\nend\n\ndef is_new_for_user?(user = nil)\n  return true if user.nil?\n  self.events.empty?{ |e| e.name == 'Show' }\nend\n</code></pre>\n\n<h3>PostController</h3>\n\n<pre><code>def index\n  @posts = Post.for_user(current_user)\nend\n</code></pre>\n\n<h3>posts/index.html.erb</h3>\n\n<pre><code>...\n&lt;% if post.is_new_for_user?(current_user) %&gt;\n  ...\n&lt;% end\n...\n</code></pre>\n\n<h2>Second Answer</h2>\n\n<p>This is still pseudo-code. I didn't test anything.</p>\n\n<h3>Forum</h3>\n\n<pre><code>scope :for_user, -&gt; (user = nil) do\n  if user\n    includes(posts: [events: :users]).where(users: {id: user.id})\n  else\n    includes(:posts)\n  end\nend\n</code></pre>\n\n<h3>ForumsController</h3>\n\n<pre><code>def all_posts\n    current_user = User.find(session[:user_id])\n    forum = Forum.for_user(current_user).where(id: params[:id]).take\n\n     render json: forum.to_json(\n        include: [\n            { posts: {\n                methods: [:is_new_for_user?(current_user)]\n            }}\n        ]\n     )\nend\n</code></pre>\n"}], "owner": {"reputation": 1580, "user_id": 2539548, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/128121c202394df3192495e58d6497a6?s=128&d=identicon&r=PG", "display_name": "denodster", "link": "https://stackoverflow.com/users/2539548/denodster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1514406446, "creation_date": 1514394397, "last_edit_date": 1514405283, "question_id": 47996009, "link": "https://stackoverflow.com/questions/47996009/session-aware-model-methods-in-to-json-cause-n1-queries", "title": "session aware model methods in to_json cause n+1 queries", "body": "<p>This is an optimization question for an existing application, I've made the code generic to both make it annonmous and also easier to understand, instead of our proprietary models I'm describing a Forum discussion type situation. I've modified all this code for this example and not tested it, so if there are any typos I apologize, I'll try to fix them if they are pointed out to me.</p>\n\n<p>Lets say I have a rails app with four models: Event, User, Forum, and Post.</p>\n\n<p>the important relationships are as follows:</p>\n\n<ul>\n<li>User has many events.</li>\n<li>Forum has many posts.</li>\n<li>Post has many events.</li>\n</ul>\n\n<p>The front end is a single page javascript app, so all database data needs to be returned in json format.</p>\n\n<p>Context: </p>\n\n<ul>\n<li>when a User clicks on a post, an event is created with the name\n'Show' which marks the post as no longer new. </li>\n<li>The user needs to be\nlogged in to see which posts are new clicking on a forum calls the\nfollowing endpoint:</li>\n<li>There are multiple users so the events able is a many to many relationship between posts and users.</li>\n</ul>\n\n<p><code>example.com/forum/15/all_posts</code></p>\n\n<p>heres the relevant code:</p>\n\n<p>Forum Controller:</p>\n\n<pre><code>#forums_controller.rb\ndef all_posts\n    current_user = User.find(session[:user_id])\n    forum = Forum.includes(:posts).where(id: params[:id]).take\n\n    forum.posts.each do |post|\n        post.current_user = current_user\n    end\n\n     render json: forum.to_json(\n        include: [\n            { posts: {\n                methods: [:is_new]\n            }}\n        ]\n     )\nend\n</code></pre>\n\n<p>Posts model:</p>\n\n<pre><code>#post.rb (posts model)\n\nhas_many :events\nattr_accessor :current_user\n\ndef is_new\n    if current_user #user may not be logged in\n        !!self.events.where(user_id: current_user.id, name: 'Show').take\n    else\n        false\n    end\nend\n</code></pre>\n\n<p>the model is where the action is at, so we've tried to keep logic out of the controller, but since the session is not available in the model we end up with this crazy work around of adding current_user as an attr_accessor so that methods can return the appropriate data for the user in question.... I don't like this but I've never come up with a better way to do it. We've repeated this pattern elsewhere and I would love to hear alternatives.</p>\n\n<p>Here's my problem:</p>\n\n<p>The call to is_new is used on the front end to determine what posts to hi-light but it's also triggering an n+1 scenario If there are 10 posts, this endpoint would net me a total 12 queries which is no good if my events table is huge. If I moved all the logic to the controller I could probably do this in 2 queries.</p>\n\n<p>in short I have two questions:</p>\n\n<ol>\n<li><strong>MOST IMPORTANT</strong>: How can I fix this n+1 situation?</li>\n<li>Is there a better way in general? I don't like needing an each loop before calling to_json I don't find this pattern to be elegant or easy to understand. at the same time I don't want to move all the code into the controller. What is the rails way to do this?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1514392111, "post_id": 47995283, "comment_id": 82959010, "body": "probably not, but depends on how your schedule the job. Speaking of which, how are you doing that?"}, {"owner": {"reputation": 603, "user_id": 1441608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T0Zmx.jpg?s=128&g=1", "display_name": "Muhammad Azizol Aminuddin", "link": "https://stackoverflow.com/users/1441608/muhammad-azizol-aminuddin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1514392279, "post_id": 47995283, "comment_id": 82959085, "body": "I will add the job to schedule.rb in config folder."}, {"owner": {"reputation": 603, "user_id": 1441608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T0Zmx.jpg?s=128&g=1", "display_name": "Muhammad Azizol Aminuddin", "link": "https://stackoverflow.com/users/1441608/muhammad-azizol-aminuddin"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1514392304, "post_id": 47995283, "comment_id": 82959093, "body": "I check the gemfile, I see we using this gem for background  gem &#39;whenever&#39;, :require =&gt; false gem &#39;delayed_job_active_record&#39; gem &#39;daemon-spawn  Not sure if related or not."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1514392401, "post_id": 47995283, "comment_id": 82959131, "body": "Ok, that sounds like a good way to do it. It probably is fine running multiple at the same time, but you could could check for yourself by making two jobs that write to the same file and then readinng the file."}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1514393609, "last_edit_date": 1514393609, "creation_date": 1514393263, "answer_id": 47995766, "question_id": 47995283, "link": "https://stackoverflow.com/questions/47995283/long-running-schedule-job/47995766#47995766", "title": "Long running schedule job", "body": "<p>The <a href=\"https://github.com/javan/whenever\" rel=\"nofollow noreferrer\"><code>whenever</code> gem</a> is basically only a way to configure and handle <a href=\"https://en.wikipedia.org/wiki/Cron\" rel=\"nofollow noreferrer\">Cron jobs</a>.</p>\n\n<p>That said: At the given time Cron will just start and run a configured job. Cron will not block other jobs nor it cares if a job fails or if another job is still running.</p>\n\n<p>Limiting factor might be: </p>\n\n<ul>\n<li>Memory/CPU consumption: Each job consumes memory/CPU. If there are too many jobs running at the same time your server might run out of memory or might have a high load. But this doesn't really block other jobs it just slows down the whole server.</li>\n<li>Database locks: If your jobs perform tasks that lock database tables other queries might be blocked and need to wait. But this is not Cron specific, this depends on what your code actually does.</li>\n</ul>\n"}], "owner": {"reputation": 603, "user_id": 1441608, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T0Zmx.jpg?s=128&g=1", "display_name": "Muhammad Azizol Aminuddin", "link": "https://stackoverflow.com/users/1441608/muhammad-azizol-aminuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 47995766, "answer_count": 1, "score": 0, "last_activity_date": 1514393609, "creation_date": 1514391172, "question_id": 47995283, "link": "https://stackoverflow.com/questions/47995283/long-running-schedule-job", "title": "Long running schedule job", "body": "<p>I new to ROR. Wanted to ask something for confirmation. If I run long schedule job. Will it block others schedule job? I have others job running every 5 minutes, Plan to write something that easily run more than 3 hours. Will it block the 5 minutes job?</p>\n"}, {"tags": ["ruby", "string", "built-in-types"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514391124, "post_id": 47995082, "comment_id": 82958568, "body": "check out my stab at the problem :) <a href=\"http://exercism.io/submissions/d8e23c0109f849e7b47de2bc20689e88\" rel=\"nofollow noreferrer\">exercism.io/submissions/d8e23c0109f849e7b47de2bc20689e88</a>"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514398782, "post_id": 47995082, "comment_id": 82961760, "body": "@SergioTulentsev You do <code>(str.downcase.chars.uniq.sort &amp; alphabet) == alphabet</code>. Wouldn&#39;t <code>(alphabet &amp; str.downcase.chars) == alphabet</code> work as well?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514399183, "post_id": 47995082, "comment_id": 82961922, "body": "@StefanPochmann: indeed, you&#39;re right. You could have posted this on exercism as well :)"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514399225, "post_id": 47995082, "comment_id": 82961944, "body": "@SergioTulentsev Didn&#39;t want to create an account and learn how it works just for that."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514399356, "post_id": 47995082, "comment_id": 82961996, "body": "@StefanPochmann: might as well solve some problems. :) I found the process to be akin to meditation. Interesting thoughts/ideas just pop into your head."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514399533, "post_id": 47995082, "comment_id": 82962080, "body": "@SergioTulentsev Yeah, but not now. Plus I have accounts at a dozen or so similar sites already."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1514444939, "post_id": 47995082, "comment_id": 82974417, "body": "You needn&#39;t shout."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1514391377, "post_id": 47995244, "comment_id": 82958679, "body": "Folder organization is good, but as far as actual logic goes, this is worse than <code>include</code>, because it unconditionally overwrites the method, leaving no trace. With <code>include</code>, the module will be in the ancestors chain, at least."}, {"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514391690, "post_id": 47995244, "comment_id": 82958817, "body": "Thanks for the advice.  I will try to use more <code>includes</code> in my apps and less of the <code>core_ext</code>"}], "tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": false, "score": 0, "last_activity_date": 1514390990, "creation_date": 1514390990, "answer_id": 47995244, "question_id": 47995082, "link": "https://stackoverflow.com/questions/47995082/what-is-the-proper-way-to-add-a-method-to-a-built-in-class-in-ruby/47995244#47995244", "title": "What is the proper way to add a method to a built-in class in ruby?", "body": "<p>When extending a core class I like to add a <code>core_ext</code> directory in the <code>lib</code> directory.</p>\n\n<p>Create and <a href=\"http://guides.rubyonrails.org/configuring.html#using-initializer-files\" rel=\"nofollow noreferrer\">initializer</a> for loading the custom extensions (for example: <code>config/initializers/core_exts.rb</code>). And add the following line in it:</p>\n\n<pre><code>Dir[File.join(Rails.root, \"lib\", \"core_ext\", \"*.rb\")].each {|file| require file }\n</code></pre>\n\n<p>and have your extension like:</p>\n\n<pre><code>#lib/core_ext/string.rb\nclass String\n  def alpha?\n    self[/[a-zA-Z]+/] == self\n  end\nend\n</code></pre>\n\n<p>now from the console you can do </p>\n\n<pre><code>\"ABCD\".alpha? # true\n\"ABC1\".alpha? # false\n\"1234\".alpha? # false\n</code></pre>\n\n<p>I hope that this helps </p>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1514423086, "last_edit_date": 1514423086, "creation_date": 1514391075, "answer_id": 47995263, "question_id": 47995082, "link": "https://stackoverflow.com/questions/47995082/what-is-the-proper-way-to-add-a-method-to-a-built-in-class-in-ruby/47995263#47995263", "title": "What is the proper way to add a method to a built-in class in ruby?", "body": "<p>tenebrousedge there was probably hinting at <a href=\"https://docs.ruby-lang.org/en/2.4.0/syntax/refinements_rdoc.html\" rel=\"nofollow noreferrer\">refinements</a>. </p>\n\n<p>Or, rather, not patching <code>String</code> at all. More often than not, monkeypatching creates more problems than it solves. What if String already knew <code>alpha?</code> and it did something different? </p>\n\n<p>For example, future versions of ruby might add <code>String#alpha?</code> that will handle unicode properly</p>\n\n<pre><code>'\u65b0\u5e79\u7dda'.alpha? # =&gt; true\n</code></pre>\n\n<p>and your code, as it is, would overwrite this built-in functionality with an inferior version. Now your app is breaking in all kinds of places, because stdlib/rails assumes the new behaviour. Chaos!</p>\n\n<p>This is to say: avoid monkeypatching whenever possible. And when you <strong>can't</strong> avoid, use refinements.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514423245, "post_id": 47998682, "comment_id": 82969366, "body": "Threequals looks much better here: <code>&#47;^[a-zA-Z]+$&#47; === string</code>. No need for any additional booleanification."}, {"owner": {"reputation": 23, "user_id": 8455842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hdfJ5.jpg?s=128&g=1", "display_name": "Javier Llerenas", "link": "https://stackoverflow.com/users/8455842/javier-llerenas"}, "edited": false, "score": 0, "creation_date": 1514474338, "post_id": 47998682, "comment_id": 82988245, "body": "I like this, however what I am trying to accomplish is to add functionality to a built-in class in a controlled manner, that way I can achieve what I am trying to achieve while having a clean, elegant solution."}], "tags": [], "owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "is_accepted": false, "score": 1, "last_activity_date": 1514409007, "creation_date": 1514409007, "answer_id": 47998682, "question_id": 47995082, "link": "https://stackoverflow.com/questions/47995082/what-is-the-proper-way-to-add-a-method-to-a-built-in-class-in-ruby/47998682#47998682", "title": "What is the proper way to add a method to a built-in class in ruby?", "body": "<p>Just want to add to @sergio's answer with a concrete what-to-do example (writing as an answer to get code formatting). Make your own class / module. A method like <code>alpha?</code> doesn't have to be defined on <code>String</code> itself to be useful and reusable, and putting it there, even with refinements, is asking for name collisions. Any gem that does this is immediately on my shit list, because it just takes two gems to choose the same name for a method they want to add and it's chaos.</p>\n\n<p>Instead, better to keep your methods contained to your own classes. I'd choose a better name than <code>MyStringIdentifier</code>, but you don't have to</p>\n\n<p>As a module:</p>\n\n<pre><code>module MyStringIdentifier\n  # allows you to use `MyStringIdentifer.any_module_method_name_here`\n  extend self\n\n  def alpha?(string)\n    !!(/^[a-zA-Z]+$/ =~ string)\n  end\nend\n\nMyStringIdentifier.alpha?(\"hello\")\n</code></pre>\n\n<p>Or, as a class:    </p>\n\n<pre><code>class MyStringIdentifier\n  attr_reader :string\n\n  def initialize(string)\n    @string = string.to_s\n  end\n\n  def alpha?\n    !!(/^[a-zA-Z]+$/ =~ string)\n  end\nend\n\nMyStringIdentifier.new(\"hello\").alpha?\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8455842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hdfJ5.jpg?s=128&g=1", "display_name": "Javier Llerenas", "link": "https://stackoverflow.com/users/8455842/javier-llerenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 47995263, "answer_count": 3, "score": 2, "last_activity_date": 1514423086, "creation_date": 1514390274, "question_id": 47995082, "link": "https://stackoverflow.com/questions/47995082/what-is-the-proper-way-to-add-a-method-to-a-built-in-class-in-ruby", "title": "What is the proper way to add a method to a built-in class in ruby?", "body": "<p>In <a href=\"http://exercism.io\" rel=\"nofollow noreferrer\">exercism.io</a> I have submitted a solution ot the <a href=\"http://exercism.io/submissions/0db312ba068646f088c75c08b63f0c9a\" rel=\"nofollow noreferrer\"><code>Pangram Problem</code></a> in <code>Ruby</code>.\n<br><br>To solve the problem, I created a method for the <code>String</code> class called <code>alpha?</code> which determines if a character is alphabetial or not ('a'..'z'). This method is inside a <strong>module</strong> which I then <strong>include</strong> in the String class.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>module Str_Plus\n  def alpha?\n      self[/[a-zA-Z]+/] == self\n  end\nend\n\nclass Pangram\n  String.include Str_Plus \n  ...\nend\n</code></pre>\n\n<p>Someone mentioned this is <strong>NOT the best way to add functionality to a built-in class</strong>. <br>My question is, <strong>What is the proper way</strong>?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514390078, "post_id": 47994984, "comment_id": 82958087, "body": "these are two distinct methods, <code>name</code> and <code>name=</code>, getter and setter. That&#39;s the difference."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514390231, "post_id": 47994984, "comment_id": 82958166, "body": "JFYI, the spacing in this code is... unusual. You might want to glance through the <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow noreferrer\">ruby style guide</a>."}, {"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514390351, "post_id": 47994984, "comment_id": 82958218, "body": "Thanks I updated the spacing. its just came with that space when I copy and pasted."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1514390748, "post_id": 47994984, "comment_id": 82958383, "body": "See also <a href=\"https://stackoverflow.com/q/5398919/244128\">stackoverflow.com/q/5398919/244128</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514391731, "post_id": 47994984, "comment_id": 82958834, "body": "Do you know what a method definition in Ruby looks like?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514390139, "post_id": 47995036, "comment_id": 82958118, "body": "what is this &quot;<code>:name</code> variable&quot; you speak of?"}, {"owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514390361, "post_id": 47995036, "comment_id": 82958225, "body": "Well, your methods are using a hash to store variables. That&#39;s what <code>self[:name]</code> is. And your two methods seem to be accessing the data referenced by the key <code>:name</code> (there&#39;s so missing information in your question, so I&#39;m making assumptions)"}], "tags": [], "owner": {"reputation": 40466, "user_id": 33226, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8f75007bcbcb8ba4daa408592e1c65ec?s=128&d=identicon&r=PG", "display_name": "Gavin Miller", "link": "https://stackoverflow.com/users/33226/gavin-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1514390581, "last_edit_date": 1514390581, "creation_date": 1514390105, "answer_id": 47995036, "question_id": 47994984, "link": "https://stackoverflow.com/questions/47994984/equal-sign-in-ruby-method-definition/47995036#47995036", "title": "Equal sign in Ruby method definition", "body": "<p>The first one is declaring the getter for the <code>:name</code> variable. The second one is declaring a setter for the <code>:name</code> variable. And there is additional behaviour there as well.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>class GSExample\n  def name\n    @name\n  end\n\n  def name=(val)\n    @name = val\n  end\nend\n\ne = GSExample.new\nputs e.name\n# =&gt; nil\n\ne.name = 'dave'\nputs e.name\n# =&gt; dave\n</code></pre>\n\n<p>Above you can see that <code>@name</code> is an instance variable that is used for as a getter with the method <code>name</code> and as a setter for the method <code>name=</code>. The equals sign is ruby convention for setter (we could easily not do a setter, but that would be bad practice.)</p>\n\n<p>Typically getters &amp; setters (or accessors) are done using <code>attr_reader</code>, <code>attr_writer</code>, or <code>attr_accessor</code> if they're simple. In your code they're not so they've been custom defined. You can read a much more through answer here: <a href=\"https://stackoverflow.com/a/4371458/33226\">https://stackoverflow.com/a/4371458/33226</a></p>\n"}], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "closed_date": 1514391134, "answer_count": 1, "score": 3, "last_activity_date": 1514390581, "creation_date": 1514389925, "last_edit_date": 1514390298, "question_id": 47994984, "link": "https://stackoverflow.com/questions/47994984/equal-sign-in-ruby-method-definition", "closed_reason": "Duplicate", "title": "Equal sign in Ruby method definition", "body": "<p>I came across the following method definitions and would like to know the difference between the first and second definitions.</p>\n\n<p>The first one does not have the equal sign in the definition:</p>\n\n<pre><code> def name\n   display_name(:name)\n end\n</code></pre>\n\n<p>This second has the equal sign:</p>\n\n<pre><code> def name=(new_name)\n   if! self[:real_name]\n     self[:real_name] = new_name\n     gera_name_exhibition\n   else\n     if new_name.is_a? Hash\n       self[:name] = new_name.sort.map {| b | b [1]} .join ('')\n     else\n       self[:name] = new_name\n     end\n   end\n end\n</code></pre>\n"}, {"tags": ["ruby", "string", "sorting"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1514447129, "post_id": 47994383, "comment_id": 82975281, "body": "What do you mean by &quot;the last word&quot;? Is <code>&quot;img_0_0_0.jpg&quot;</code> a word? In what sense?"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1514387825, "creation_date": 1514387825, "answer_id": 47994527, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string/47994527#47994527", "title": "Sort array on the basis of the last word of string", "body": "<p>I assume you expect the items to be sorted in <em>numerical</em> order, so that <code>img_0_0_9</code> comes before <code>img_0_0_10</code>. To do so, we extract the suffix of the <code>img</code> part of all items, convert them to numeric values and sort the array accordingly:</p>\n\n<pre><code>arr.sort_by { |e| e[%r|(?&lt;=/img_0_0_).*(?=\\.jpg\\z)|].to_i }\n\n#\u21d2 [\n#   [0] \"https://ya.../img_0_0_0.jpg\",\n#   [1] \"https://ya.../img_0_0_1.jpg\",\n#   [2] \"https://ya.../img_0_0_10.jpg\",\n#   [3] \"https://ya.../img_0_0_20.jpg\",\n#   [4] \"https://ya.../img_0_0_30.jpg\",\n#   [5] \"https://ya.../img_0_0_31.jpg\"\n# ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1514394560, "post_id": 47994635, "comment_id": 82960147, "body": "DRY: <code>arr.sort { |x, y| [x, y].map { |e| e.split(&#39;&#47;&#39;).sub(&#47;\\.jpg\\z&#47;, &#39;&#39;) }.reduce(:&lt;=&gt;) }</code>."}], "tags": [], "owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "is_accepted": false, "score": 1, "last_activity_date": 1514388282, "creation_date": 1514388282, "answer_id": 47994635, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string/47994635#47994635", "title": "Sort array on the basis of the last word of string", "body": "<p>Another possible solution</p>\n\n<pre><code>arr.sort{ |x, y| x.split('/')[-1].gsub('.jpg', '') &lt;=&gt; y.split('/')[-1].gsub('.jpg', '') }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8003264, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-A3L3uX1xDso/AAAAAAAAAAI/AAAAAAAAAN4/0whlbtywgzY/photo.jpg?sz=128", "display_name": "Daniel Rej&#243;n", "link": "https://stackoverflow.com/users/8003264/daniel-rej%c3%b3n"}, "is_accepted": false, "score": 1, "last_activity_date": 1514388551, "creation_date": 1514388551, "answer_id": 47994701, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string/47994701#47994701", "title": "Sort array on the basis of the last word of string", "body": "<pre><code>links = [\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650497/img_0_0_0.jpg\",\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650510/img_0_0_20.jpg\",\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650499/img_0_0_10.jpg\",\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650521/img_0_0_30.jpg\",\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650498/img_0_0_1.jpg\",\n  \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650522/img_0_0_31.jpg\"]\n\nlinks.sort_by do |link|\n  link.last(12)\n      .split('')\n      .map {|x| Integer(x) rescue nil }\n      .compact\n      .join\n      .to_i\nend\n</code></pre>\n\n<p>This takes the last 12 characters from each array and takes every number on it, convert it to integer, and then sort it</p>\n"}, {"tags": [], "owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "is_accepted": false, "score": 2, "last_activity_date": 1514388652, "creation_date": 1514388652, "answer_id": 47994727, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string/47994727#47994727", "title": "Sort array on the basis of the last word of string", "body": "<p>You can try something like this:</p>\n\n<pre><code>array.sort_by do |item| \n  item.match(/\\/img_(\\d)+_(\\d+)_(\\d+).jpg$/).captures.map(&amp;:to_i)\nend\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/AggravatingCreativeAmphiuma\" rel=\"nofollow noreferrer\"><strong>Demonstration</strong></a></p>\n"}, {"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1514405776, "post_id": 47997597, "comment_id": 82964556, "body": "Best one . Thanks Sir (Y)"}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": true, "score": 2, "last_activity_date": 1514402765, "creation_date": 1514402765, "answer_id": 47997597, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string/47997597#47997597", "title": "Sort array on the basis of the last word of string", "body": "<p>To order as strings:</p>\n\n<pre><code>&gt; puts urls.sort_by { |u| u.split('/').last }\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650497/img_0_0_10.jpg\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650510/img_0_0_2.jpg\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650499/img_0_1_1.jpg\n</code></pre>\n\n<p>To order by the numbers \"naturally\":</p>\n\n<pre><code>&gt; puts urls.sort_by { |u| u.split('/').last.scan(/\\d+/).map(&amp;:to_i) }\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650510/img_0_0_2.jpg\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650497/img_0_0_10.jpg\nhttps://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650499/img_0_1_1.jpg\n</code></pre>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 47997597, "answer_count": 5, "score": 1, "last_activity_date": 1515673139, "creation_date": 1514387211, "last_edit_date": 1515673139, "question_id": 47994383, "link": "https://stackoverflow.com/questions/47994383/sort-array-on-the-basis-of-the-last-word-of-string", "title": "Sort array on the basis of the last word of string", "body": "<p>I have an array like:</p>\n\n<pre><code>[\n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650497/img_0_0_0.jpg\",\n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650510/img_0_0_20.jpg\",\n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650499/img_0_0_10.jpg\",\n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650521/img_0_0_30.jpg\", \n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650498/img_0_0_1.jpg\",\n \"https://yallamotor-development-assets.s3.ap-south-1.amazonaws.com/2650522/img_0_0_31.jpg\"\n]\n</code></pre>\n\n<p>I want to sort it on the basis of the last word of the string after <code>\"/\"</code>, which is the <code>\"img_0_0\"</code> word. But I cannot find any solution to do it.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1514385615, "post_id": 47993326, "comment_id": 82956129, "body": "Question is not clear. How would you know if <code>a</code> part in the string is meant to be <code>:a</code> or <code>&quot;a&quot;</code>? How would you know if <code>0</code> is meant to be <code>0</code>, <code>&quot;0&quot;</code>, or <code>:0</code>?"}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "edited": false, "score": 2, "creation_date": 1514385778, "post_id": 47993326, "comment_id": 82956214, "body": "I don&#39;t think this is good taste of coding."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "edited": false, "score": 0, "creation_date": 1514386461, "post_id": 47993326, "comment_id": 82956520, "body": "@Daniel why is that? It\u2019s e.g. perfectly valid for quick tuning of huge config. <i>As a user</i>, I definitely would thank a developer that provided an access to settings via dot notation."}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1514386784, "post_id": 47993326, "comment_id": 82956656, "body": "@mudasobwa In the his/her code, some keys are symbols and some are string. Also, array is huge config is not good."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "edited": false, "score": 0, "creation_date": 1514386968, "post_id": 47993326, "comment_id": 82956730, "body": "@Daniel: not sure what you&#39;re trying to say. Using ruby for configs is good. Indifferent access is good. Arrays are useful. Addressing values with dot notation is super-convenient. :shrug:"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1514408069, "post_id": 47993326, "comment_id": 82965387, "body": "@sawa well I can guarantee it doesn&#39;t mean <code>:0</code> since that is not a valid symbol but I guess it could mean <code>:&quot;0&quot;</code> :)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514383124, "post_id": 47993442, "comment_id": 82955016, "body": "Given rails: <code>target.with_indifferent_access.dig(*path.split(&#39;.&#39;))</code>. If indifferent access isn&#39;t needed, so is active_support."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383228, "post_id": 47993442, "comment_id": 82955067, "body": "@SergioTulentsev given tags specified Rails sucks (as usual :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383296, "post_id": 47993442, "comment_id": 82955095, "body": "Ah, there are arrays too. In this case, your answer is  better, indeed."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1514383405, "post_id": 47993442, "comment_id": 82955155, "body": "Nitpicking: this code will fail to fetch value from <code>target = { &quot;42&quot; =&gt; &#39;the answer&#39;}</code> :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514383425, "post_id": 47993442, "comment_id": 82955164, "body": "might want to note that a <code>Hash</code> can have <code>String</code> keys that are numeric values so this is case specific to the provided <code>Hash</code> and @SergioTulentsev beat me to it"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383482, "post_id": 47993442, "comment_id": 82955194, "body": "@SergioTulentsev fixed."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383582, "post_id": 47993442, "comment_id": 82955235, "body": "Yes, type check is better. I was about to point out another failing case :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383666, "post_id": 47993442, "comment_id": 82955273, "body": "Oh, come on. Use that sexy threequals :) <code>case acc when Array</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383703, "post_id": 47993442, "comment_id": 82955288, "body": "@SergioTulentsev as you wish :-P"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514383782, "post_id": 47993442, "comment_id": 82955321, "body": "@mudasobwa Not quite what I meant, tho :) This is: <a href=\"https://gist.github.com/stulentsev/a7c11c7be8fc2a9646d39b4a7cc6e42c\" rel=\"nofollow noreferrer\">gist.github.com/stulentsev/a7c11c7be8fc2a9646d39b4a7cc6e42c</a>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514385790, "post_id": 47993442, "comment_id": 82956219, "body": "@SergioTulentsev since we are having fun pointing out flaws (more specifically in the request than the implementation) a <code>Hash</code> can contain numeric keys as  well e.g. <code>{42 =&gt; &#39;the answer&#39;}</code> which would be unhandled by <code>val</code> or <code>val.to_sym</code> and <code>String#to_i</code> will return <code>0</code> when not lead with a numeric so <code>{a: {&#39;b&#39; =&gt; [{x: &#39;here&#39;}]}}</code> will have the same return for <code>&#39;a.b.0.x&#39;</code> as it would for <code>&#39;a.b.c.x&#39;</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1514386178, "post_id": 47993442, "comment_id": 82956395, "body": "@engineersmnky fixed :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1514386473, "post_id": 47993442, "comment_id": 82956526, "body": "@engineersmnky: good point about arrays and non-numeric path segments. The current version is too forgiving, I think. If it were me, I&#39;d rather prefer loud crash when I try access array element by index <code>&#39;foo&#39;</code>, because this means that my expectations about data shape are wrong. But maybe I&#39;m just making these requirements out of thin air. :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514386572, "post_id": 47993442, "comment_id": 82956556, "body": "@SergioTulentsev I follow ruby default behaviour: both <code>{}[:inexisting]</code> and <code>[][0]</code> return <code>nil</code> rather than crash loudly."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514386618, "post_id": 47993442, "comment_id": 82956579, "body": "@mudasobwa: but <code>[][&#39;0&#39;]</code> crashes. So does <code>[][&#39;foo&#39;]</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514386706, "post_id": 47993442, "comment_id": 82956618, "body": "@SergioTulentsev nah, probably you\u2019re right, but I am tired editing this answer :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514386762, "post_id": 47993442, "comment_id": 82956646, "body": "@mudasobwa: yeah, no pressure :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1514391205, "post_id": 47993442, "comment_id": 82958607, "body": "@mudasobwa No problem I got you :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1514386169, "last_edit_date": 1514386169, "creation_date": 1514382965, "answer_id": 47993442, "question_id": 47993326, "link": "https://stackoverflow.com/questions/47993326/how-would-you-access-an-element-in-a-nested-hash-array-given-a-path-like-a-b-0/47993442#47993442", "title": "How would you access an element in a nested hash/array given a path like &quot;a.b.0.x&quot;?", "body": "<pre><code>path = \"a.b.0.x\"\n\npath.split('.').reduce(target) do |acc, val|\n  case acc\n  when Array\n    break nil unless /\\A\\d+\\z/ === val\n    acc[val.to_i]\n  when Hash\n    next acc[val.to_i] if /\\A\\d+\\z/ === val &amp;&amp; acc[val.to_i]\n    acc[val] || acc[val.to_sym]\n  else break nil\n  end\nend rescue nil\n#\u21d2\u00a0\"here\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 2, "last_activity_date": 1514509776, "last_edit_date": 1514509776, "creation_date": 1514391171, "answer_id": 47995282, "question_id": 47993326, "link": "https://stackoverflow.com/questions/47993326/how-would-you-access-an-element-in-a-nested-hash-array-given-a-path-like-a-b-0/47995282#47995282", "title": "How would you access an element in a nested hash/array given a path like &quot;a.b.0.x&quot;?", "body": "<p>Given the edge cases for such access I would recommend creating a new class to handle this situation and homogenize the input into a consistent structure. In this case a <code>Hash</code> (probably still more edge cases <em>comments welcome</em>)</p>\n\n<pre><code>class DepthAccessor\n  class AccessFailure &lt; StandardError\n    def initialize(val,current=nil,full=nil,depth=nil)\n      super(\n        if full &amp;&amp; depth\n          \"Failed to find #{val.inspect} for #{current.inspect}:#{current.class} in #{full.inspect} at depth #{depth}\"\n        else\n          val\n        end\n      )\n    end\n  end\n\n  def initialize(target)\n    raise ArgumentError, \"#{target.inspect}:#{target.class} must respond_to :each_with_object\" unless target.respond_to?(:each_with_object)\n    @target = homogenize(target) \n  end\n\n  def path_search(path,sep: '.',raise_on_fail: true)\n    split_path = path.split(sep) \n    split_path.each_with_index.inject(@target) do |acc,(val,idx)|\n      begin\n        acc.is_a?(Hash) ? acc[val] : raise\n      rescue StandardError\n        if raise_on_fail\n          raise AccessFailure.new(val,acc,@target,split_path[0..idx].join(sep)) \n        else\n          nil \n        end\n      end\n    end\n  end\n\n\n  private \n\n    def homogenize(val)\n      case val\n        when Array\n          val.each_with_index.with_object({}) {|(v,idx),obj| obj[idx.to_s] = homogenize(v) }\n        when Hash \n          val.each_with_object({}) { |(k,v),obj| obj[k.to_s] = homogenize(v) }\n        else\n          val\n      end\n    end\nend\n</code></pre>\n\n<p>When you create a new instance all keys are converted to <code>Strings</code> and all <code>Array</code> are converted to <code>Hash</code>es using the <code>index</code> as the <code>key</code></p>\n\n<p>Then usage as such </p>\n\n<pre><code>target = {\n  :a =&gt; {\n    \"b\" =&gt; [\n      {\n        :x =&gt; \"here\"\n      }\n    ]\n  }\n}\n\nDepthAccessor.new(target).path_search('a.b.0.x')\n#=&gt; \"here\"\nDepthAccessor.new(target).path_search('a.b.c.x')\n#=&gt; Failed to find \"c\" for {\"0\"=&gt;{\"x\"=&gt;\"here\"}}:Hash in {\"a\"=&gt;{\"b\"=&gt;{\"0\"=&gt;{\"x\"=&gt;\"here\"}}}} at depth a.b.c  \n</code></pre>\n\n<p><a href=\"https://repl.it/@engineersmnky/UrbanFlamboyantKittiwake\" rel=\"nofollow noreferrer\">Full Example</a></p>\n\n<p>If reservation of <code>Array</code>s is a requirement then here is another example (with a few extra features) <a href=\"https://repl.it/@engineersmnky/SmartExpensiveAlbino\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 1469, "user_id": 1227960, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6c5f5b95e74dce0d8cbe095febd9e00?s=128&d=identicon&r=PG", "display_name": "kukrt", "link": "https://stackoverflow.com/users/1227960/kukrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 47993442, "answer_count": 2, "score": -1, "last_activity_date": 1514509776, "creation_date": 1514382447, "last_edit_date": 1514385399, "question_id": 47993326, "link": "https://stackoverflow.com/questions/47993326/how-would-you-access-an-element-in-a-nested-hash-array-given-a-path-like-a-b-0", "title": "How would you access an element in a nested hash/array given a path like &quot;a.b.0.x&quot;?", "body": "<p>I have a nested hash/array such as:</p>\n\n<pre><code>target = {\n  :a =&gt; {\n    \"b\" =&gt; [\n      {\n        :x =&gt; \"here\"\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>where a hash key is never a number. Given a string of indices/keys separated by <code>\".\"</code> such as <code>\"a.b.0.x\"</code>, which would express <code>target[:a][\"b\"][0][:x]</code>, how can I access the corresponding element?</p>\n"}, {"tags": ["ruby", "regex", "telegram"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1514382473, "post_id": 47993267, "comment_id": 82954729, "body": "<code>%r|\\A&#47;newdb\\b.*|</code>: use <code>\\A</code> unless you explicitly chase after carriage return in the middle of the message and use <code>%r</code> notation for regexps when it contains slashes. Also, parentheses are redundant, AFAICT."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 2, "last_activity_date": 1514383032, "last_edit_date": 1514383032, "creation_date": 1514382201, "answer_id": 47993267, "question_id": 47993175, "link": "https://stackoverflow.com/questions/47993175/passing-parameters-to-telegram-bots-and-parsing-using-regex/47993267#47993267", "title": "Passing parameters to Telegram bots and parsing using regex?", "body": "<p>That's because the <code>/</code> is a metacharacter in regexp, here is a right regexp:</p>\n\n<pre><code>Telegram::Bot::Client.run(token) do |bot|\n  bot.listen do |message|\n    case message.text\n    when /^\\/newdb\\s(.*)/\n      database = $~[1] # get the database name. $~[N] regexp matches.\n      bot.api.send_message(chat_id: message.chat.id, text: \"created!, #{message.from.first_name}\")\n    end\n  end\nend\n</code></pre>\n\n<p><code>%r|\\A/newdb\\b.*|</code>: use <code>\\A</code> unless you explicitly chase after carriage return in the middle of the message and use <code>%r</code> notation for regexps when it contains slashes. Thx <a href=\"https://stackoverflow.com/users/2035262/mudasobwa\">@mudasobwa</a></p>\n\n<p>Check that regexp expression <a href=\"https://regex101.com/r/Q0qrtt/1\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 47993267, "answer_count": 1, "score": 1, "last_activity_date": 1514383032, "creation_date": 1514381825, "last_edit_date": 1514382213, "question_id": 47993175, "link": "https://stackoverflow.com/questions/47993175/passing-parameters-to-telegram-bots-and-parsing-using-regex", "title": "Passing parameters to Telegram bots and parsing using regex?", "body": "<p>I have a telegram bot which is supposed to create a new database when a user enters <code>/newdb nameofdatabase</code></p>\n\n<pre><code>Telegram::Bot::Client.run(token) do |bot|\n  bot.listen do |message|\n    case message.text\n    when '/newdb.*/'\n      bot.api.send_message(chat_id: message.chat.id, text: \"created!, #{message.from.first_name}\")\n    end\n  end\nend\n</code></pre>\n\n<p>I'm using a regex string to try and capture the user's message and parsing it afterwards.\nUnfortunately, the bot does not respond to the given command (In this case, it doesn't print the <code>\"created!\"</code> line.\"</p>\n\n<p>How can I go about capturing user's input to a Telegram bot using a Ruby wrapper?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano"], "answers": [{"comments": [{"owner": {"reputation": 745, "user_id": 8588607, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4a6f92294ead1dc2f726601c3f13c0b9?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o Coletta", "link": "https://stackoverflow.com/users/8588607/l%c3%a9o-coletta"}, "edited": false, "score": 0, "creation_date": 1514383058, "post_id": 47993360, "comment_id": 82954988, "body": "Yes I have capistrano-rails-console but it doesn&#39;t work"}], "tags": [], "owner": {"reputation": 539, "user_id": 9006638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kV5us.jpg?s=128&g=1", "display_name": "Michael Arkhipov", "link": "https://stackoverflow.com/users/9006638/michael-arkhipov"}, "is_accepted": false, "score": 0, "last_activity_date": 1514382633, "creation_date": 1514382633, "answer_id": 47993360, "question_id": 47992886, "link": "https://stackoverflow.com/questions/47992886/how-to-access-rails-console-with-capistrano/47993360#47993360", "title": "How to access rails console with capistrano?", "body": "<p>Check thish gems:</p>\n\n<ul>\n<li>console: <a href=\"https://rubygems.org/gems/capistrano-rails-console\" rel=\"nofollow noreferrer\">capistrano-rails-console</a></li>\n<li>rake db: <a href=\"https://rubygems.org/gems/capistrano-rails-collection\" rel=\"nofollow noreferrer\">capistrano-rails-collection</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 467, "user_id": 6003939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9fP_gxi1pEA/AAAAAAAAAAI/AAAAAAAAAC4/L9NDDYQE22s/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6003939/vivek-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1514384886, "creation_date": 1514384886, "answer_id": 47993875, "question_id": 47992886, "link": "https://stackoverflow.com/questions/47992886/how-to-access-rails-console-with-capistrano/47993875#47993875", "title": "How to access rails console with capistrano?", "body": "<p>I had face same problem got resolved by adding following line in deploy.rb</p>\n\n<pre><code>namespace :rails do\n desc \"Open the rails console on one remote server\"\n task :console, :roles =&gt; :app do\n   hostname = find_servers_for_task(current_task).first\n   port = exists?(:port) ? fetch(:port) : 22\n   exec \"ssh -l #{user} #{hostname} -p #{port} -t 'source ~/.profile &amp;&amp; #{current_path}/script/rails c #{rails_env}'\"\n end\nend\n</code></pre>\n\n<p>Make sure that <strong>ssh port</strong> is open on hosted server.</p>\n"}], "owner": {"reputation": 745, "user_id": 8588607, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4a6f92294ead1dc2f726601c3f13c0b9?s=128&d=identicon&r=PG&f=1", "display_name": "L&#233;o Coletta", "link": "https://stackoverflow.com/users/8588607/l%c3%a9o-coletta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514384886, "creation_date": 1514380570, "last_edit_date": 1514381329, "question_id": 47992886, "link": "https://stackoverflow.com/questions/47992886/how-to-access-rails-console-with-capistrano", "title": "How to access rails console with capistrano?", "body": "<p>I'd like to access the rails console of my remote server.\nRails version : 5.1.4\nRuby version : 2.4.3</p>\n\n<p>I've tried to install the gem <a href=\"https://github.com/ydkn/capistrano-rails-console\" rel=\"nofollow noreferrer\">https://github.com/ydkn/capistrano-rails-console</a>\nand I have followed the instructions but when I do \"cap production rails:console\" I get an error :</p>\n\n<pre><code>(Backtrace restricted to imported tasks)\ncap aborted!\nDon't know how to build task 'console' (see --tasks)\n\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Here is the Capfile : <a href=\"https://pastebin.com/uNdBuTan\" rel=\"nofollow noreferrer\">https://pastebin.com/uNdBuTan</a>\n/ Here is the deploy.rb file : <a href=\"https://pastebin.com/W8ic92Nf\" rel=\"nofollow noreferrer\">https://pastebin.com/W8ic92Nf</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "where"], "comments": [{"owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1514389369, "post_id": 47992634, "comment_id": 82957757, "body": "The snippet of code you added isn&#39;t enough for us to understand what you&#39;re trying. Add more code."}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1514437161, "post_id": 47992634, "comment_id": 82972032, "body": "Question has been updated."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 8608623, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vT47uFvmnRo/AAAAAAAAAAI/AAAAAAAABBI/LfctXKOBBRY/photo.jpg?sz=128", "display_name": "Suvarna Swami", "link": "https://stackoverflow.com/users/8608623/suvarna-swami"}, "is_accepted": true, "score": 1, "last_activity_date": 1514614968, "creation_date": 1514614968, "answer_id": 48031572, "question_id": 47992634, "link": "https://stackoverflow.com/questions/47992634/rails-how-to-filter-a-string-field-in-searchkick/48031572#48031572", "title": "Rails - How to filter a string field in searchkick?", "body": "<p>Change the <code>scope :search_import</code> based on your condition and modify <code>should_index?</code> method like,</p>\n\n<pre><code>def should_index?\n  User.search_import\nend\n</code></pre>\n\n<p>After this changes, call reindex separately <code>after_update</code> of any data</p>\n"}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 48031572, "answer_count": 1, "score": 1, "last_activity_date": 1514614968, "creation_date": 1514379523, "last_edit_date": 1514437132, "question_id": 47992634, "link": "https://stackoverflow.com/questions/47992634/rails-how-to-filter-a-string-field-in-searchkick", "title": "Rails - How to filter a string field in searchkick?", "body": "<p>In rails, I am using <code>searchkick</code> gem for search. I need to add one string field called <code>status</code> for filter. How can I add to this plugin?</p>\n\n<p>Already I have raised one question regarding this issue <a href=\"https://stackoverflow.com/questions/47977917/rails-how-to-add-more-fields-for-filter-in-searchkick\">Rails - How to add more fields for filter in searchkick?</a></p>\n\n<p>Now I am trying with string field instead of boolean still search is not working. Please help me regarding the same.</p>\n\n<p>I have added a condition like <code>where: {status: 'approved'}</code>, as per this condition I should get only active users(not 'deleted' users). Right now no search data is displaying.</p>\n\n<pre><code>searchkick word_start: [:name]\n\ndef initialize(name, limit = User::SUGGESTION_LIMIT, page = nil)\n  @name = name\n  @limit = limit\n  @page = page\n  @per_page = limit.to_i\nend\n\nquery = {\n  match: :word_start,\n  where: {status: 'approved'},\n  fields: [{ emails: \"exact\" }, \"name^5\"],\n  misspellings: { prefix_length: 2 },\n  load: false\n}\n\nUser.search(name, query).records\n</code></pre>\n\n<p>Also I have tried by adding filterable like <code>searchkick word_start: [:name], filterable: [:status]</code></p>\n\n<p>Server log is,</p>\n\n<pre><code>Processing by UsersController#search as JSON\nParameters: {\"query\"=&gt;\"sal\"}\nETHON: Libcurl initialized\nETHON: performed EASY \neffective_url=http://elastic:changeme@14.127.18.141:9200/users-some_index-en/_search response_code=200 return_code=ok total_time=0.498938\nUser Search (589.3ms)  curl http://14.127.18.141:9200/users-some_index-en/_search?pretty -d '{\"query\":{\"bool\":{\"must\":{\"dis_max\":{\"queries\":[{\"match\":{\"emails.true\":{\"query\":\"sal\",\"boost\":10,\"operator\":\"and\",\"analyzer\":\"searchkick_autocomplete_search\"}}},{\"match\":{\"emails.true\":{\"query\":\"sal\",\"boost\":1,\"operator\":\"and\",\"analyzer\":\"searchkick_autocomplete_search\",\"fuzziness\":1,\"prefix_length\":2,\"max_expansions\":3,\"fuzzy_transpositions\":true}}},{\"bool\":{\"must\":{\"bool\":{\"should\":[{\"match\":{\"name.word_start\":{\"query\":\"sal\",\"boost\":50.0,\"operator\":\"and\",\"analyzer\":\"searchkick_word_search\"}}},{\"match\":{\"name.word_start\":{\"query\":\"sal\",\"boost\":5.0,\"operator\":\"and\",\"analyzer\":\"searchkick_word_search\",\"fuzziness\":1,\"prefix_length\":2,\"max_expansions\":3,\"fuzzy_transpositions\":true}}}]}},\"should\":{\"match\":{\"name.analyzed\":{\"query\":\"sal\",\"boost\":50.0,\"operator\":\"and\",\"analyzer\":\"searchkick_word_search\"}}}}}]}},\"filter\":[{\"term\":{\"status\":\"approved\"}}]}},\"size\":5,\"from\":0,\"timeout\":\"11s\"}'\nUser Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\nETHON: performed EASY effective_url=http://elastic:changeme@14.127.18.141:9200/entities-some_index-en/_search response_code=200 return_code=ok total_time=0.251783\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5322249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2696e5ddc8dbd02d1850823390235a21?s=128&d=identicon&r=PG", "display_name": "asda111sd", "link": "https://stackoverflow.com/users/5322249/asda111sd"}, "edited": false, "score": 0, "creation_date": 1514378122, "post_id": 47992260, "comment_id": 82952762, "body": "it works but not currectly. when i add to the new_task_view   &lt;div class=&quot;field&quot;&gt;\\n     &lt;%= form.label :user_id %&gt;\\n     &lt;%= form.text_field :user_id, id: :task_done %&gt;\\n   &lt;/div&gt; \\n it works how i whant, but i need the handly put user&#39;s id. I whant to do that automaticly"}], "tags": [], "owner": {"reputation": 846, "user_id": 5805239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/53b5c6384585bfc78c2b95b354d99a32?s=128&d=identicon&r=PG", "display_name": "Aakanksha", "link": "https://stackoverflow.com/users/5805239/aakanksha"}, "is_accepted": false, "score": 0, "last_activity_date": 1514377906, "creation_date": 1514377906, "answer_id": 47992260, "question_id": 47992201, "link": "https://stackoverflow.com/questions/47992201/cant-create-task-with-devise/47992260#47992260", "title": "Can&#39;t create task with devise", "body": "<p>Change <code>belongs_to :user</code> to  <code>belongs_to :user, optional: true</code>. Rails 5 has introduced default validation in associations. Refer <a href=\"https://github.com/thoughtbot/shoulda-matchers/issues/870\" rel=\"nofollow noreferrer\">this link</a> for better understanding</p>\n"}, {"comments": [{"owner": {"reputation": 4568, "user_id": 8712097, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hevmE.jpg?s=128&g=1", "display_name": "Tom Aranda", "link": "https://stackoverflow.com/users/8712097/tom-aranda"}, "edited": false, "score": 0, "creation_date": 1514440347, "post_id": 47992538, "comment_id": 82972832, "body": "This is an answer.  It could use more explanation, but it is an answer."}], "tags": [], "owner": {"reputation": 29, "user_id": 5322249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2696e5ddc8dbd02d1850823390235a21?s=128&d=identicon&r=PG", "display_name": "asda111sd", "link": "https://stackoverflow.com/users/5322249/asda111sd"}, "is_accepted": false, "score": 0, "last_activity_date": 1514379129, "creation_date": 1514379129, "answer_id": 47992538, "question_id": 47992201, "link": "https://stackoverflow.com/questions/47992201/cant-create-task-with-devise/47992538#47992538", "title": "Can&#39;t create task with devise", "body": "<p>in method create in controller need to add <code>@task.user_id = current_user.id</code></p>\n"}, {"tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": 0, "last_activity_date": 1514380318, "creation_date": 1514380318, "answer_id": 47992825, "question_id": 47992201, "link": "https://stackoverflow.com/questions/47992201/cant-create-task-with-devise/47992825#47992825", "title": "Can&#39;t create task with devise", "body": "<p>Be aware, that Task is not good name for model according to <a href=\"https://reservedwords.herokuapp.com/words/task?q[word_or_notes_cont]=task\" rel=\"nofollow noreferrer\">https://reservedwords.herokuapp.com/words/task?q[word_or_notes_cont]=task</a></p>\n\n<p>In Rails there is not full list of reserved words because of the nature of the language and framework. But sometimes you can face strange behaviour, when you use conflicting keyword. </p>\n"}, {"tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1515574044, "creation_date": 1515574044, "answer_id": 48183457, "question_id": 47992201, "link": "https://stackoverflow.com/questions/47992201/cant-create-task-with-devise/48183457#48183457", "title": "Can&#39;t create task with devise", "body": "<p>You have missing <code>user_id</code> for creating <code>task</code></p>\n\n<p>Try to the following </p>\n\n<p>On your code</p>\n\n<pre><code>def create\n  @task = Task.new(task_params)\n\n  respond_to do |format|\n    if @task.save\n      format.html { redirect_to @task, notice: 'Task was successfully created.' }\n      format.json { render :show, status: :created, location: @task }\n    else\n      format.html { render :new }\n      format.json { render json: @task.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>Modified from your code, you can use that</p>\n\n<pre><code>def create\n  @task = Task.new(task_params)\n  @task.user = current_user\n\n  respond_to do |format|\n    if @task.save\n      format.html { redirect_to @task, notice: 'Task was successfully created.' }\n      format.json { render :show, status: :created, location: @task }\n    else\n      format.html { render :new }\n      format.json { render json: @task.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>Hope to help</p>\n"}], "owner": {"reputation": 29, "user_id": 5322249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2696e5ddc8dbd02d1850823390235a21?s=128&d=identicon&r=PG", "display_name": "asda111sd", "link": "https://stackoverflow.com/users/5322249/asda111sd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1515574044, "creation_date": 1514377645, "question_id": 47992201, "link": "https://stackoverflow.com/questions/47992201/cant-create-task-with-devise", "title": "Can&#39;t create task with devise", "body": "<p>Using device and can't create task\nmy models\nuser</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  has_many :tasks\nend\n</code></pre>\n\n<p>task</p>\n\n<pre><code>class Task &lt; ApplicationRecord\n  belongs_to :user\nend\n</code></pre>\n\n<p>task controller</p>\n\n<pre><code>  def create\n    @task = Task.new(task_params)\n\n    respond_to do |format|\n      if @task.save\n        format.html { redirect_to @task, notice: 'Task was successfully created.' }\n        format.json { render :show, status: :created, location: @task }\n      else\n        format.html { render :new }\n        format.json { render json: @task.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>and when trying to create task have an error </p>\n\n<blockquote>\n  <p>1 error prohibited this task from being saved:</p>\n\n<pre><code>User must exist\n</code></pre>\n</blockquote>\n\n<p>my response </p>\n\n<p>Started POST \"/tasks\" for 127.0.0.1 at 2017-12-27 14:20:59 +0200\nProcessing by TasksController#create as HTML\n  Parameters: {\"utf8\"=>\"\u2713\", \"authenticity_token\"=>\"b7EkQsJygYBW1xLIm1uFD8jluXy2LYeoYjAOjKcwWOMHLwtalXmkTrNJu0yhexucwY94COegDcuVrOWLRkf8dg==\", \"task\"=>{\"title\"=>\"\", \"description\"=>\"\", \"priority\"=>\"\", \"due(1i)\"=>\"2017\", \"due(2i)\"=>\"12\", \"due(3i)\"=>\"27\", \"done\"=>\"0\"}, \"commit\"=>\"Create Task\"}</p>\n\n<pre><code>  User Load (0.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 2], [\"LIMIT\", 1]]\n   (0.0ms)  begin transaction\n   (0.1ms)  rollback transaction\n</code></pre>\n\n<p>what's wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "protocol-buffers", "grpc"], "owner": {"reputation": 183, "user_id": 4287777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-O_mtHOa20Kc/AAAAAAAAAAI/AAAAAAAACis/w86ZHFF6acw/photo.jpg?sz=128", "display_name": "Marko Bogdanovi\u0107", "link": "https://stackoverflow.com/users/4287777/marko-bogdanovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1514377460, "creation_date": 1514377460, "question_id": 47992159, "link": "https://stackoverflow.com/questions/47992159/integrate-grpc-server-with-rails-codebase", "title": "Integrate GRPC server with Rails codebase", "body": "<p>When the Google::Protobuf::DescriptorPool.generated_pool.build is called twice with the same message types, the error is being thrown saying that DescriptorPool has already registered message with the same name.</p>\n\n<pre><code>Unable to add defs to DescriptorPool: Symtab already has a def named\n</code></pre>\n\n<p>I see that as expected behavior.</p>\n\n<p>Though, I need to include GRPC generated files within Rails codebase which some parts are eagerly loaded.</p>\n\n<p>Is there any possible way to tell protobuf to generate Ruby classes and modules instead of generating <code>Google::Protobuf::DescriptorPool.generated_pool.build</code> block? In case it has generated classes, the require on that file more than once wouldn't throw an error.</p>\n\n<p>I see the only way to fix this is to add some condition before <code>Google::Protobuf::DescriptorPool.generated_pool.build</code> block, letting it register messages unless these are already defined.</p>\n\n<p>BTW I wanted to run gprc server within a rake task when I stumbled upon this issue.</p>\n\n<p>Please tell me if I am missing something, which is quite likely. Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-connect"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1514375185, "post_id": 47990996, "comment_id": 82951421, "body": "I happen to remember it happening to me while i was working on Stripe Connect. Unfortunately couldn&#39;t find anything to make it a permanent success but the things are working smoothly in production for a long time now."}], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1514375100, "post_id": 47991232, "comment_id": 82951385, "body": "This does not answer the question. I think the user has test account numbers but the issue is that it works sometimes and sometimes it doesn&#39;t work."}, {"owner": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1514376188, "post_id": 47991232, "comment_id": 82951856, "body": "I&#39;m using this one US - 000123456789 , but sometimes it won&#39;t work"}, {"owner": {"reputation": 1112, "user_id": 2072436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b249cbaef1c8317b21b19cea6fcf30?s=128&d=identicon&r=PG", "display_name": "Umar Khan", "link": "https://stackoverflow.com/users/2072436/umar-khan"}, "edited": false, "score": 0, "creation_date": 1514376474, "post_id": 47991232, "comment_id": 82952002, "body": "are you getting the same error? &quot;You cannot use a live bank account number when making transfers or debits in test mode&quot;"}, {"owner": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1515587214, "post_id": 47991232, "comment_id": 83354524, "body": "any other alternative ?"}], "tags": [], "owner": {"reputation": 1112, "user_id": 2072436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0b249cbaef1c8317b21b19cea6fcf30?s=128&d=identicon&r=PG", "display_name": "Umar Khan", "link": "https://stackoverflow.com/users/2072436/umar-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1514373507, "creation_date": 1514373507, "answer_id": 47991232, "question_id": 47990996, "link": "https://stackoverflow.com/questions/47990996/stripe-in-test-mode-not-able-to-create-bank-account-sometimes/47991232#47991232", "title": "Stripe in test mode not able to create bank account sometimes", "body": "<p>Can be found <a href=\"https://stripe.com/docs/connect/testing\" rel=\"nofollow noreferrer\">here</a> in their documentation; to get the numbers for a specific country there's a little dropdown for you to select the relevant one. For convenience, the standard test bank account numbers below:</p>\n\n<ol>\n<li>US - 000123456789</li>\n<li>UK - 00012345</li>\n<li>JP - 00012345</li>\n</ol>\n"}], "owner": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1585900512, "creation_date": 1514372466, "last_edit_date": 1514696734, "question_id": 47990996, "link": "https://stackoverflow.com/questions/47990996/stripe-in-test-mode-not-able-to-create-bank-account-sometimes", "title": "Stripe in test mode not able to create bank account sometimes", "body": "<p>I want to create stripe account through bank account and add bank account further on stripe in test mode.It's working but sometimes It's giving following error\n\"You cannot use a live bank account number when making transfers or debits in test mode\" while using below details. </p>\n\n<p>Account Number :- 000123456789\nRouting Number :- 110000000</p>\n\n<p>I'm not able to get that why this is occurring sometimes.Tried to google it but did not find any solution.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514369407, "post_id": 47990128, "comment_id": 82948695, "body": "How are you going to create the instances then, if not with <code>new</code>?"}, {"owner": {"reputation": 134, "user_id": 7027047, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/851b7b6e9604a6bcaa42ae3479b27c45?s=128&d=identicon&r=PG&f=1", "display_name": "alt-ja", "link": "https://stackoverflow.com/users/7027047/alt-ja"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514369562, "post_id": 47990128, "comment_id": 82948773, "body": "What if I want to make all methods class-methods? This question is theoretical and I want to know how standard classes without new are implemented"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514370000, "post_id": 47990128, "comment_id": 82948970, "body": "If you don&#39;t need instances of the class, then it&#39;s not a class, it&#39;s a module. Integer (and maybe a few other primitive types) is a special class in this regard: it&#39;s not a &quot;real&quot; class, with state and all. That said, this can be achieved with <a href=\"https://stackoverflow.com/questions/543774/undef-why-would-you-want-to-undefine-a-method-in-ruby\"><code>undef</code></a>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1514370077, "post_id": 47990128, "comment_id": 82949002, "body": "I would argue if you want to disable the option to instantiate an instance then use a <code>module</code> instead of a <code>class</code>"}, {"owner": {"reputation": 2151, "user_id": 7070779, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3f82a88d62105c7b3cfcbd7f24f9524a?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Vo", "link": "https://stackoverflow.com/users/7070779/huy-vo"}, "edited": false, "score": 1, "creation_date": 1514370265, "post_id": 47990128, "comment_id": 82949117, "body": "Module is a better word to use in your case. You only create a class when you know you&#39;re going to use its instances at some point."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1514382355, "post_id": 47990128, "comment_id": 82954654, "body": "Ruby is a class-based object-oriented programming language. If you want to do prototype-based object-oriented programming, use another language, such as JavaScript."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 6, "last_activity_date": 1514375071, "creation_date": 1514375071, "answer_id": 47991582, "question_id": 47990128, "link": "https://stackoverflow.com/questions/47990128/how-do-i-create-a-class-without-new-method/47991582#47991582", "title": "How do I create a class without &#39;new&#39; method?", "body": "<p>You have several options, which I will present here (roughly) in the order of how \"aggressive\" they are in my personal opinion:</p>\n\n<h1>Override the default <code>Object#initialize</code> with your own</h1>\n\n<p>You can override the default implementation of <code>Object#initialize</code> with your own implementation which does something different. In your case, say, <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-raise\" rel=\"noreferrer\"><code>raise</code></a> an <a href=\"http://ruby-doc.org/core/Exception.html\" rel=\"noreferrer\"><code>Exception</code></a>:</p>\n\n<pre><code>class Foo\n  def initialize(*) raise TypeError, \"`#{self.class}` cannot be instantiated.\" end\nend\n\nFoo.new\n# TypeError: `Foo` cannot be instantiated.\n# from (\u2026):5:in `initialize'\n</code></pre>\n\n<p>The default implementation of <a href=\"http://ruby-doc.org/core/Class.html#method-i-new\" rel=\"noreferrer\"><code>Class#new</code></a> will automatically call your implementation of <code>Foo#initialize</code>, which will then <code>raise</code> an <code>Exception</code> and abort the object construction, or more precisely: it will abort the object <em>initialization</em>, since the object will have been constructed by the time <code>initialize</code> is called (otherwise, how would you call <code>initialize</code> if there is no object to call it on?) However, object construction is cheap, and the object will immediately be eligible for garbage collection, so it shouldn't matter.</p>\n\n<p>For completeness' sake, here is (approximately) what the default implementation of <code>Class#new</code> looks like:</p>\n\n<pre><code>class Class\n  def new(*args, &amp;b)\n    obj = allocate\n    obj.send(:initialize, *args, &amp;b) # `initialize` is `private`, must use `send`\n    obj\n  end\nend\n</code></pre>\n\n<p>As you can see, by the time <code>initialize</code> is called, <a href=\"http://ruby-doc.org/core/Class.html#method-i-allocate\" rel=\"noreferrer\"><code>Class#allocate</code></a> will have already constructed the object.</p>\n\n<h1>Override the default <code>Class#new</code> with your own</h1>\n\n<p>You can override the default implementation of <code>Class#new</code> with your own implementation which does something different. In your case, say, <code>raise</code> an <code>Exception</code>:</p>\n\n<pre><code>def Foo.new(*) raise TypeError, \"`#{self}` cannot be instantiated.\" end\n\nFoo.new\n# TypeError: `Foo` cannot be instantiated.\n# from (\u2026):3:in `new'\n</code></pre>\n\n<h1>Make <code>Foo::new</code> a <code>private</code> method</h1>\n\n<p>You can make the <code>new</code> method of the singleton class of <code>Foo</code> a <a href=\"http://ruby-doc.org/core/Module.html#method-i-private_class_method\" rel=\"noreferrer\"><code>private</code> method</a>, that way, it can't be called with an explicit receiver:</p>\n\n<pre><code>Foo.private_class_method :new\n\nFoo.new\n# NoMethodError: private method `new' called for Foo:Class\n# from (\u2026):3:in `\u2026'\n</code></pre>\n\n<p>This would, for example, still allow you to have special <em>factory methods</em> that construct instances of your class, e.g. something like:</p>\n\n<pre><code>def Foo.create_from_xml(file)\n  # do stuff to parse `file`\n  new(argument_parsed_from_file)\nend\n</code></pre>\n\n<p>Note this sentence in the documentation of <code>Module#private_class_method</code>:</p>\n\n<blockquote>\n  <p>Often used to hide the default constructor <code>new</code>.</p>\n</blockquote>\n\n<p>and the code example directly following it.</p>\n\n<h1>Undefine the <code>new</code> method from the singleton class of <code>Foo</code></h1>\n\n<p>You could undefine the <code>new</code> method using <a href=\"http://ruby-doc.org/core/Module.html#method-i-undef_method\" rel=\"noreferrer\"><code>Module#undef_method</code></a>. <code>undef_method</code> will prevent instances of the module from responding to that message completely, unlike <a href=\"http://ruby-doc.org/core/Module.html#method-i-remove_method\" rel=\"noreferrer\"><code>Module#remove_method</code></a>, which will simply remove the method from the module, so that method lookup continues normally up the inheritance chain.</p>\n\n<pre><code>Foo.singleton_class.undef_method :new\n\nFoo.new\n# NoMethodError: undefined method `new' for Foo:Class\n# from (\u2026):3:in `\u2026'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514381391, "post_id": 47992448, "comment_id": 82954221, "body": "This does not provide an answer to the question. It should probably be a comment to the question."}, {"owner": {"reputation": 4791, "user_id": 3899471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f65ff7602231a1a1653a7debf32e7f?s=128&d=identicon&r=PG&f=1", "display_name": "kvorobiev", "link": "https://stackoverflow.com/users/3899471/kvorobiev"}, "edited": false, "score": 0, "creation_date": 1514385140, "post_id": 47992448, "comment_id": 82955923, "body": "This does not provide an answer to the question. To critique or request clarification from an author, leave a comment below their post. - <a href=\"/review/low-quality-posts/18363040\">From Review</a>"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1514399809, "post_id": 47992448, "comment_id": 82962197, "body": "@J&#246;rgWMittag Why not? It sounds like the OP wants a class but no instances. Is it then not a reasonable idea to use a module instead of a class?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 4791, "user_id": 3899471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f65ff7602231a1a1653a7debf32e7f?s=128&d=identicon&r=PG&f=1", "display_name": "kvorobiev", "link": "https://stackoverflow.com/users/3899471/kvorobiev"}, "edited": false, "score": 1, "creation_date": 1514399829, "post_id": 47992448, "comment_id": 82962205, "body": "@kvorobiev Same question to you."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514446408, "post_id": 47992448, "comment_id": 82975022, "body": "I think, it does provide an answer (my module <b>is</b> a class and you can not apply <code>new</code> to it; actually, it is the way we implement such classes in our project). @J&#246;rgWMittag : Aside from this, it&#39;s difficult to put this in a comment, because comments can&#39;t be multi-line. Of course I could describe the <code>extend self</code> trick without given an example, but it&#39;s better to understand if we see a concrete example."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514456367, "post_id": 47992448, "comment_id": 82979519, "body": "The OP wrote in the question that they want &quot;a class&quot;. Your answer does not show a class, it shows a module. The question also says &quot;like <code>Integer</code>&quot;, and <code>Integer</code> <i>does</i> have instances, yet, it doesn&#39;t have a <code>new</code> method. Your answer doesn&#39;t address that. In a comment, the OP wrote that the question is &quot;theoretical&quot;, IOW it is not about how best to write some code, it is about how to hide the <code>new</code> method. Your answer doesn&#39;t address that. And lastly, your answer isn&#39;t even an answer at all, it is a request for clarification &quot;How about this?&quot; and as such belongs in a comment or in chat."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514456444, "post_id": 47992448, "comment_id": 82979559, "body": "@StefanPochmann: The OP wants a class without <code>new</code> method, not a class without instances. In the question, <code>Integer</code> is given as an example, which <i>does</i> have instances."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514468902, "post_id": 47992448, "comment_id": 82985455, "body": "@J&#246;rgWMittag He also said <i>&quot;make all methods class-methods&quot;</i>. What good are instances if they have no methods? And <code>Integer</code> is only given as an example of a class <i>not supporting instantiation via <code>new</code>.</i> It has <i>lots</i> of instance methods and as far as I understand not even <i>any</i> class methods. I wouldn&#39;t get hung up on him saying the word &quot;class&quot; and I wouldn&#39;t read more his <code>Integer</code> example than what he actually said about it. Also, even if <i>he</i> actually does want a class, maybe someone else wondering about this doesn&#39;t, and I don&#39;t think answers are only for the question author."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514533924, "post_id": 47992448, "comment_id": 83007580, "body": "@J&#246;rgWMittag : I understood the question in that the OP doesn&#39;t care whether he has one instance, or just a class. That&#39;s why I would consider your proposed solution as correct, but mine as correct as well. Maybe a more philosophical question: Can such a &quot;module&quot;, which I proposed, be considered as a &quot;class which is its own (sole) instance&quot;? Actually, if we create a <code>Module</code>, we do <b>not</b> get a <code>Class</code> in the Ruby sense (because <code>Module &lt;= Class</code> evaluates to <code>false</code>), although of course from the viewpoint of OO-design, it can be regarded as (singleton-) class."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514534087, "post_id": 47992448, "comment_id": 83007633, "body": "@StefanPochmann : While I agree with your argument, the reasoning giving by J&#246;rg also sounds reasonable. In hindsight, I think the question is not specified precisely, so we <b>should</b> have asked the OP for clarification, before posting an answer."}], "tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 0, "last_activity_date": 1514378745, "creation_date": 1514378745, "answer_id": 47992448, "question_id": 47990128, "link": "https://stackoverflow.com/questions/47990128/how-do-i-create-a-class-without-new-method/47992448#47992448", "title": "How do I create a class without &#39;new&#39; method?", "body": "<p>How about this?</p>\n\n<pre><code>module MyClassWithOnlyClassMethods\n\n  extend self\n\n  def foo\n  end\n\nend\n</code></pre>\n\n<p>Actually, you can do it without <code>extend self</code>, but you would have then to write <code>def self.foo</code> etc. for each method, which gets cumbersome.</p>\n"}], "owner": {"reputation": 134, "user_id": 7027047, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/851b7b6e9604a6bcaa42ae3479b27c45?s=128&d=identicon&r=PG&f=1", "display_name": "alt-ja", "link": "https://stackoverflow.com/users/7027047/alt-ja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 47991582, "answer_count": 2, "score": 0, "last_activity_date": 1514382163, "creation_date": 1514369144, "last_edit_date": 1514382163, "question_id": 47990128, "link": "https://stackoverflow.com/questions/47990128/how-do-i-create-a-class-without-new-method", "title": "How do I create a class without &#39;new&#39; method?", "body": "<p>I want a class that does not support instantiation via <code>new</code>, like the <code>Integer</code> class. I tried to inherit from <code>BasicObject</code>, but it still lets me create an instance with <code>new</code>.</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "ruby-on-rails-5.1"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1514368427, "post_id": 47989146, "comment_id": 82948216, "body": "Please accept answer if it is helpful to you."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8227488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dx3Ss.jpg?s=128&g=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/8227488/giuseppe"}, "edited": false, "score": 0, "creation_date": 1514374667, "post_id": 47989160, "comment_id": 82951218, "body": "The problem is that I need to distribute the javascripts files. Is it possible? I have much pages and much javascripts to include, different in each page. Is a mess for me to place all javascripts apart and include them in the pages, also beacause this javascripts files have some names equals"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "reply_to_user": {"reputation": 61, "user_id": 8227488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dx3Ss.jpg?s=128&g=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/8227488/giuseppe"}, "edited": false, "score": 0, "creation_date": 1514375050, "post_id": 47989160, "comment_id": 82951367, "body": "@GiuseppeMagazz&#249; When you generate controller in rails , it will automatic   generate its js and css file, so you can add related js code to that js file for that controller&#39;s view."}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": true, "score": 6, "last_activity_date": 1514375238, "last_edit_date": 1514375238, "creation_date": 1514365092, "answer_id": 47989160, "question_id": 47989146, "link": "https://stackoverflow.com/questions/47989146/rails-include-js-in-html-public-files/47989160#47989160", "title": "Rails include js in html public files", "body": "<p>You have to place all js files under <code>app/assets/javascripts</code> folder.</p>\n\n<blockquote>\n  <p>Updated Answer</p>\n</blockquote>\n\n<p>Load the main JavaScript in application.js every time. Now create files for different needs. Create a form.js file, a myfancypart.js file etc. Don't load them in the application.html.erb layout. Load them dynamically when you need them:</p>\n\n<p>application.html.erb:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n&lt;%= yield :javascript_includes %&gt;\n</code></pre>\n\n<p>top of your view.html.erb OR users/new.html.erb:</p>\n\n<pre><code>&lt;% content_for :javascript_includes do %&gt;\n  &lt;%= javascript_include_tag \"users_new.js\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Everything in the content_for block will be loaded at yield :javascript_includes.</p>\n\n<p>Source: <a href=\"https://stackoverflow.com/a/602192\">stackoverflow</a></p>\n"}, {"tags": [], "owner": {"reputation": 20744, "user_id": 1251563, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/dc155cfc7c8fb1f19e3bcdb74d5075bd?s=128&d=identicon&r=PG&f=1", "display_name": "breq", "link": "https://stackoverflow.com/users/1251563/breq"}, "is_accepted": false, "score": 1, "last_activity_date": 1514365298, "creation_date": 1514365298, "answer_id": 47989197, "question_id": 47989146, "link": "https://stackoverflow.com/questions/47989146/rails-include-js-in-html-public-files/47989197#47989197", "title": "Rails include js in html public files", "body": "<p>You should follow like this:</p>\n\n<pre><code>folder/\n  pages/\n    index.html\n    aboutus.html\n  assets/\n    js/\n      some_js.js\n      anoter_js.js\n    css/\n      homepage.css\n      about.css\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1670, "user_id": 3475163, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dce396a4249c07f19902779e54c7a40b?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammed Anees", "link": "https://stackoverflow.com/users/3475163/muhammed-anees"}, "is_accepted": false, "score": 2, "last_activity_date": 1514371009, "creation_date": 1514371009, "answer_id": 47990650, "question_id": 47989146, "link": "https://stackoverflow.com/questions/47989146/rails-include-js-in-html-public-files/47990650#47990650", "title": "Rails include js in html public files", "body": "<p>The best practice is to place all your third party assets in <code>vendor/assets</code> folder and your app specific assets in <code>app/assets</code> folder. And you should <code>require</code> the assets in their specific manifest files.<br>\nIf your <code>vendor/assets/javascripts</code> folder have some js files like this, </p>\n\n<pre><code>`/vendor/\n     /assets/\n          /javascripts/`\n               script1.js\n               script2.js\n</code></pre>\n\n<p>Then in your <code>app/assets/javascripts/application.js</code> just add<br></p>\n\n<pre><code>  //= require script1\n  //= require script2\n</code></pre>\n\n<p>In rails 5.1+, the <code>assets</code> directory is removed from vendor, so you should create your own directories and either add it to <code>config/initializers/assets.rb</code> to precompile or use relative path to the file with respect to vendor directory.</p>\n"}, {"tags": [], "owner": {"reputation": 264, "user_id": 1944986, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7a1edeee0ce6eb20c4d617a5fe2cb04?s=128&d=identicon&r=PG", "display_name": "Bernie Chiu", "link": "https://stackoverflow.com/users/1944986/bernie-chiu"}, "is_accepted": false, "score": 1, "last_activity_date": 1515125850, "creation_date": 1515125850, "answer_id": 48107126, "question_id": 47989146, "link": "https://stackoverflow.com/questions/47989146/rails-include-js-in-html-public-files/48107126#48107126", "title": "Rails include js in html public files", "body": "<pre><code>/sketches\n  sketch.js\n  /project1\n     index.html &lt;-- include relative path for sketch.js\n     script1.js\n  /project2\n     index.html &lt;-- include relative path for sketch.js\n</code></pre>\n\n<p>I think u can just include relative path js file from your parent folder so u don't need to put to every subfolders.</p>\n"}], "owner": {"reputation": 61, "user_id": 8227488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dx3Ss.jpg?s=128&g=1", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/8227488/giuseppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2802, "favorite_count": 0, "accepted_answer_id": 47989160, "answer_count": 4, "score": 0, "last_activity_date": 1515125850, "creation_date": 1514365021, "last_edit_date": 1514378194, "question_id": 47989146, "link": "https://stackoverflow.com/questions/47989146/rails-include-js-in-html-public-files", "title": "Rails include js in html public files", "body": "<p>I have some html pages in which each page includes some javascripts files. Where I have to place this files?</p>\n\n<pre><code>folder/\n  page1/\n    index.html\n    script1.js\n  page2/\n    index.html\n    script2.js\n</code></pre>\n\n<blockquote>\n  <p>Updated</p>\n</blockquote>\n\n<p>I explain better. I have some little projects composed by an html page and some javascripts files, in which i use a canvas. I have different scripts for each page.</p>\n\n<pre><code>/sketches\n  /project1\n     index.html\n     script1.js\n     sketch.js\n  /project2\n     index.html\n     sketch.js\n</code></pre>\n\n<p>The files named 'sketch' are different between them. \nI tought to make one controller with a parameter id and basing on this I'll load a different project. I did it putting the html page inside the public folder and it worked, but I have problems with the javascripts, that are refused.</p>\n\n<p>So, for what you are saying to me, I have to place all the javascripts in a separate folder... I'd like to keep that structure. Is there no way in rails to serve that folder, which contains all the projects,  as static?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1514351938, "post_id": 47986553, "comment_id": 82942193, "body": "can you please add reinvite action as well?"}], "answers": [{"comments": [{"owner": {"reputation": 2835, "user_id": 1884846, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/7Z5MP.jpg?s=128&g=1", "display_name": "jeznag", "link": "https://stackoverflow.com/users/1884846/jeznag"}, "edited": false, "score": 0, "creation_date": 1514352986, "post_id": 47986701, "comment_id": 82942480, "body": "Hmm interesting. My code doesn&#39;t actually use find:       @admin_users = AdminUser.deleted.where(email: admin_user_params[:email])  (and then it iterates over each one). It seems a bit hacky to have to override .find anyway. Is this a recommended practice or am I just trying to do the wrong thing?"}, {"owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "reply_to_user": {"reputation": 2835, "user_id": 1884846, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/7Z5MP.jpg?s=128&g=1", "display_name": "jeznag", "link": "https://stackoverflow.com/users/1884846/jeznag"}, "edited": false, "score": 1, "creation_date": 1514353643, "post_id": 47986701, "comment_id": 82942657, "body": "It\u2019s not ideal to put an expectation on <code>find</code> but if you don\u2019t want to use expect_any_instance_of there\u2019s very little choice. There\u2019s an argument that your function calling <code>invite!</code> is an implementation detail and instead you could check the end result such as an email being triggered or an <code>invite_sent_at</code> timestamp being updated if those are things which happen. That said, your question was quite specific so I gave the answer to that. Do any of these alternatives help you?"}], "tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": false, "score": 3, "last_activity_date": 1514351947, "creation_date": 1514351947, "answer_id": 47986701, "question_id": 47986553, "link": "https://stackoverflow.com/questions/47986553/how-to-avoid-using-the-expect-any-instance-of-hammer/47986701#47986701", "title": "How to avoid using the expect_any_instance_of hammer?", "body": "<p>The problem is that your code is finding the record afresh and instantiating it as a new object, therefore the object that receives the message is different to the one in your test. </p>\n\n<p>To get round this do:</p>\n\n<pre><code>it 'should invite user again' do\n  admin_user = create(:invited_admin_user)\n  expect(User).to receive(:find).with(admin_user.id).and_return(admin_user)\n  expect(admin_user).to receive(:invite!).and_return(true)\n  patch :reinvite, params: { id: admin_user.to_param }\nend\n</code></pre>\n\n<p>This just intercepts the User.find call and returns your test object rather than the one it would normally initialise.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1514354895, "last_edit_date": 1514354895, "creation_date": 1514354443, "answer_id": 47987085, "question_id": 47986553, "link": "https://stackoverflow.com/questions/47986553/how-to-avoid-using-the-expect-any-instance-of-hammer/47987085#47987085", "title": "How to avoid using the expect_any_instance_of hammer?", "body": "<p>Why do you want to use mocks here in the first place?</p>\n\n<pre><code>it 'should invite user again' do\n  admin_user = create(:invited_admin_user)\n  patch :reinvite, params: { id: admin_user.to_param }\n  expect(admin_user.reload.invited).to eq(true)\nend\n</code></pre>\n\n<p>If you want to avoid redundant calls to the database, the whole test should be written a) without a real DB object creation (<code>FactoryGirl#build</code>,) b) without <code>patch</code> call (directly call the respective controller\u2019s method,) and c) mocking everything to be called in between.</p>\n\n<p><strong>NB</strong> I personally do not see any reason at all to have tests where everything is mocked: they hardly differ from the code itself. I mean, we could make a mistake in the test as well as in the code and checking that <code>patch</code> calls the respective controller\u2019s method is silly: it\u2019s already checked in Rails tests. I always try to test <em>real</em> things, when applicable (like the user was indeed changed, rather than some method was invoked.) </p>\n"}], "owner": {"reputation": 2835, "user_id": 1884846, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/7Z5MP.jpg?s=128&g=1", "display_name": "jeznag", "link": "https://stackoverflow.com/users/1884846/jeznag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 47987085, "answer_count": 2, "score": 1, "last_activity_date": 1514354895, "creation_date": 1514350807, "last_edit_date": 1592644375, "question_id": 47986553, "link": "https://stackoverflow.com/questions/47986553/how-to-avoid-using-the-expect-any-instance-of-hammer", "title": "How to avoid using the expect_any_instance_of hammer?", "body": "<p>I've got a few tests like this:</p>\n<pre><code>it 'should invite user again' do\n    admin_user = create(:invited_admin_user)\n    expect_any_instance_of(AdminUser).to receive(:invite!).and_return(true)\n    patch :reinvite, params: { id: admin_user.to_param }\nend\n</code></pre>\n<p>I really want to write it like this:</p>\n<pre><code>it 'should invite user again' do\n    admin_user = create(:invited_admin_user)\n    expect(admin_user).to receive(:invite!).and_return(true)\n    patch :reinvite, params: { id: admin_user.to_param }\nend\n</code></pre>\n<p>But the test fails if I do that. Any idea why that would happen? I'm using factory_bot to create the AdminUser instance.</p>\n<p>I've tried putting puts statements in the test and the invite method to confirm the ID.</p>\n<pre><code>def invite!(_param1 = AdminUser.new, _param2 = {})\n    puts 'ID in invite!' + self.id.inspect\n    super(_param1, _param2)\nend\n\nit 'should invite user again' do\n    admin_user = create(:invited_admin_user)\n    puts 'adminuser created' + admin_user.id.inspect\n    expect(admin_user).to receive(:invite!).and_return(true)\n    patch :reinvite, params: { id: admin_user.to_param }\nend\n</code></pre>\n<p>Result</p>\n<blockquote>\n<p>adminuser created7768</p>\n<p>ID in invite!7768</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 5, "creation_date": 1514400178, "post_id": 47985660, "comment_id": 82962332, "body": "@J&#246;rgWMittag It is pretty clear to everyone else what they&#39;re asking, not everyone consults a dictionary when asking a question. You&#39;re welcome to provide your own answer if you need to display your command of the English language."}], "answers": [{"comments": [{"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 6, "creation_date": 1556904947, "post_id": 47985757, "comment_id": 98600109, "body": "This is how the default value is used: <code>ENV.fetch(&#39;NON_EXISTENT&#39;) {&#39;returns this string&#39;}</code>"}, {"owner": {"reputation": 440, "user_id": 1410503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6557162b55f7553845dea754b2b659?s=128&d=identicon&r=PG", "display_name": "Yannick Schuchmann", "link": "https://stackoverflow.com/users/1410503/yannick-schuchmann"}, "reply_to_user": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "edited": false, "score": 7, "creation_date": 1559553229, "post_id": 47985757, "comment_id": 99443284, "body": "or <code>ENV.fetch(&#39;NON_EXISTENT&#39;, &#39;my default value&#39;)</code> @estani"}, {"owner": {"reputation": 17551, "user_id": 1182464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e569ac49e984e3a55ee167b14c11cf41?s=128&d=identicon&r=PG", "display_name": "estani", "link": "https://stackoverflow.com/users/1182464/estani"}, "reply_to_user": {"reputation": 440, "user_id": 1410503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6557162b55f7553845dea754b2b659?s=128&d=identicon&r=PG", "display_name": "Yannick Schuchmann", "link": "https://stackoverflow.com/users/1410503/yannick-schuchmann"}, "edited": false, "score": 3, "creation_date": 1559744695, "post_id": 47985757, "comment_id": 99516508, "body": "@YannickSchuchmann indeed! My example should have been <code>ENV.fetch(&#39;NON_EXISTENT&#39;) { &lt;compute the value&gt; }</code> or something more appropriate for a block. Otherwise the second parameter in you comment is much better."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 73, "last_activity_date": 1593551560, "last_edit_date": 1593551560, "creation_date": 1514343083, "answer_id": 47985757, "question_id": 47985660, "link": "https://stackoverflow.com/questions/47985660/rails-difference-between-env-fetch-and-env/47985757#47985757", "title": "Rails: difference between ENV.fetch() and ENV[]", "body": "<p>The <code>ENV</code> hash-like object is plain Ruby, not part of Rails. From the <a href=\"http://ruby-doc.org/core/ENV.html#method-c-5B-5D\" rel=\"noreferrer\">fine <code>ENV#[]</code> manual</a>:</p>\n<blockquote>\n<p>Retrieves the value for environment variable <code>name</code> as a String. Returns <code>nil</code> if the named variable does not exist.</p>\n</blockquote>\n<p>and the <a href=\"http://ruby-doc.org/core/ENV.html#method-c-fetch\" rel=\"noreferrer\">fine <code>ENV#fetch</code> manual</a>:</p>\n<blockquote>\n<p>Retrieves the environment variable <code>name</code>.</p>\n<p>If the given name does not exist and neither <code>default</code> nor a block a provided an IndexError is raised. If a block is given it is called with the missing name to provide a value. If a default value is given it will be returned when no block is given.</p>\n</blockquote>\n<p>So just like <a href=\"http://ruby-doc.org/core/Hash.html#method-i-5B-5D\" rel=\"noreferrer\"><code>Hash#[]</code></a> and <a href=\"http://ruby-doc.org/core/Hash.html#method-i-fetch\" rel=\"noreferrer\"><code>Hash#fetch</code></a>, the only difference is that <code>fetch</code> allows you to specify the behavior if a key is not found (use a default value passed to <code>fetch</code>, default block passed to <code>fetch</code>, or raise an exception) whereas <code>[]</code> just silently gives you <code>nil</code> if the key isn't found.</p>\n<p>In the specific case of:</p>\n<pre><code>ENV.fetch(&quot;MY_VAR&quot;)\nENV['MY_VAR']\n</code></pre>\n<p>the difference is that <code>ENV['MY_VAR']</code> will give you <code>nil</code> if there is no <code>MY_VAR</code> environment variable but <code>ENV.fetch('MY_VAR')</code> will raise an exception.</p>\n"}], "owner": {"reputation": 465, "user_id": 8502177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d9386cd90a04602716da5edb7d199444?s=128&d=identicon&r=PG&f=1", "display_name": "Winker", "link": "https://stackoverflow.com/users/8502177/winker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18763, "favorite_count": 2, "accepted_answer_id": 47985757, "answer_count": 1, "score": 36, "last_activity_date": 1593551560, "creation_date": 1514341973, "last_edit_date": 1514343093, "question_id": 47985660, "link": "https://stackoverflow.com/questions/47985660/rails-difference-between-env-fetch-and-env", "title": "Rails: difference between ENV.fetch() and ENV[]", "body": "<p>What is the difference between these two syntax:</p>\n\n<p><code>ENV.fetch(\"MY_VAR\")</code></p>\n\n<p><code>ENV['MY_VAR']</code></p>\n\n<p>I've seen Rails 5 use both versions of these in difference places and can't figure out what the difference is (apart from the first one being more characters to type).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1514346072, "post_id": 47985367, "comment_id": 82941014, "body": "What SQL query produces <code>Summoner.last.match_references</code>? I mean console log or <code>Summoner.last.match_references.to_sql</code> output"}, {"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1514346517, "post_id": 47985367, "comment_id": 82941090, "body": "You can also try to use objects instead of attributes to let Rails do the job <code>m.summoner = s</code>"}, {"owner": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "reply_to_user": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1514347663, "post_id": 47985367, "comment_id": 82941279, "body": "<code>Summoner Load (1.9ms)  SELECT  &quot;summoners&quot;.* FROM &quot;summoners&quot; ORDER BY &quot;summoners&quot;.&quot;id&quot; DESC LIMIT $1  [[&quot;LIMIT&quot;, 1]]</code>   <code>=&gt; &quot;SELECT \\&quot;match_references\\&quot;.* FROM \\&quot;match_references\\&quot; WHERE \\&quot;match_references\\&quot;.\\&quot;summoner_id\\&quot; = 1&quot;</code>"}, {"owner": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "reply_to_user": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1514348258, "post_id": 47985367, "comment_id": 82941400, "body": "I&#39;m not sure I understand your question. Do you mean to say: &quot;Do you use <code>accountId</code> to find <code>match_references</code>? If so, it&#39;s possible - this is a brand new project so nothing is used to find match_references right now.  I&#39;m trying to populate the <code>match_references</code> table via console with some data, which is when I ran into the error message I posted in my original post."}], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "edited": false, "score": 0, "creation_date": 1514351754, "post_id": 47986544, "comment_id": 82942152, "body": "Do I need to do anything other than declare the primary key? Like run any migrations?"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "reply_to_user": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "edited": false, "score": 0, "creation_date": 1514354315, "post_id": 47986544, "comment_id": 82942855, "body": "@HebronGeorge no, you don&#39;t."}, {"owner": {"reputation": 1048, "user_id": 6166821, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpwuPY2Vfjw/AAAAAAAAAAI/AAAAAAAADS0/aT3BFBVyQEQ/photo.jpg?sz=128", "display_name": "Hasmukh Rathod", "link": "https://stackoverflow.com/users/6166821/hasmukh-rathod"}, "reply_to_user": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "edited": false, "score": 0, "creation_date": 1514358260, "post_id": 47986544, "comment_id": 82944263, "body": "@HebronGeorge, Also, AddAccountIdToMatchReferences migration is not needed."}, {"owner": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "edited": false, "score": 0, "creation_date": 1514395993, "post_id": 47986544, "comment_id": 82960695, "body": "I still can&#39;t get it working. I get this error:  &gt; ref = MatchReference.new &gt; <code>ref.summoner = Summoner.last</code>   <code>Summoner Load (0.5ms)  SELECT  &quot;summoners&quot;.* FROM &quot;summoners&quot; ORDER BY &quot;summoners&quot;.&quot;accountId&quot; DESC LIMIT $1  [[&quot;LIMIT&quot;, 1]] ActiveModel::MissingAttributeError: can&#39;t write unknown attribute </code>summoner_id``"}, {"owner": {"reputation": 1048, "user_id": 6166821, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpwuPY2Vfjw/AAAAAAAAAAI/AAAAAAAADS0/aT3BFBVyQEQ/photo.jpg?sz=128", "display_name": "Hasmukh Rathod", "link": "https://stackoverflow.com/users/6166821/hasmukh-rathod"}, "edited": false, "score": 0, "creation_date": 1514428650, "post_id": 47986544, "comment_id": 82970406, "body": "Make sure MatchReference model has an attribute called: &#39;accountId&#39; as it is foreign key. There should not be summoner_id column in MatchReference."}], "tags": [], "owner": {"reputation": 1048, "user_id": 6166821, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LpwuPY2Vfjw/AAAAAAAAAAI/AAAAAAAADS0/aT3BFBVyQEQ/photo.jpg?sz=128", "display_name": "Hasmukh Rathod", "link": "https://stackoverflow.com/users/6166821/hasmukh-rathod"}, "is_accepted": false, "score": 0, "last_activity_date": 1514350704, "creation_date": 1514350704, "answer_id": 47986544, "question_id": 47985367, "link": "https://stackoverflow.com/questions/47985367/proper-way-to-add-a-non-standard-foreign-key-to-my-model-ruby-on-rails/47986544#47986544", "title": "Proper way to add a non standard foreign key to my model? Ruby on Rails", "body": "<p>This should work:</p>\n\n<pre><code>class Summoner &lt; ApplicationRecord\n self.primary_key = 'accountId'\n has_many :match_references, :foreign_key =&gt; 'accountId'\nend\n\nclass MatchReference &lt; ApplicationRecord\n belongs_to :summoner\nend\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 1496918, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/6b5cc654d8751ace98750c42d0cba826?s=128&d=identicon&r=PG", "display_name": "Hebron George", "link": "https://stackoverflow.com/users/1496918/hebron-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514350704, "creation_date": 1514338631, "question_id": 47985367, "link": "https://stackoverflow.com/questions/47985367/proper-way-to-add-a-non-standard-foreign-key-to-my-model-ruby-on-rails", "title": "Proper way to add a non standard foreign key to my model? Ruby on Rails", "body": "<p>I have a table that needs to reference another table without using the <code>id</code> column for the foreign key.</p>\n\n<p>I have these two models:</p>\n\n<pre><code>class MatchReference &lt; ApplicationRecord\n    belongs_to :summoner, :foreign_key =&gt; 'accountId'\nend\n\n\nclass Summoner &lt; ApplicationRecord\n    has_many :match_references\nend\n</code></pre>\n\n<p>I created this migration to link them together with a Summoner.accountId:</p>\n\n<pre><code>class AddAccountIdToMatchReferences &lt; ActiveRecord::Migration[5.1]\n  def change\n    add_reference :match_references, :summoner, column: :accountId, foreign_key: true\n  end\nend\n</code></pre>\n\n<p>Note that the foreign key that <code>match_references</code> should use is <code>summoners.accountId</code> and NOT <code>summoners.id</code></p>\n\n<p>I get this schema after running the migrations: </p>\n\n<pre><code>create_table \"match_references\", force: :cascade do |t|\n  t.string \"lane\"\n  t.bigint \"gameId\"\n  t.integer \"champion\"\n  t.string \"platformId\"\n  t.integer \"season\"\n  t.integer \"queue\"\n  t.string \"role\"\n  t.bigint \"timestamp\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\n  t.bigint \"summoner_id\"\n  t.index [\"summoner_id\"], name: \"index_match_references_on_summoner_id\"\nend\n\n\ncreate_table \"summoners\", force: :cascade do |t|\n  t.bigint \"profileIconId\"\n  t.string \"name\"\n  t.integer \"summonerLevel\"\n  t.datetime \"revisionDate\"\n  t.bigint \"league_id\"\n  t.bigint \"accountId\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>and I want to be able to do something like:</p>\n\n<pre><code>  s = Summoner.last\n  s.match_references.last.gameId # =&gt; 123456789\n\n  m = MatchReference.new\n  m.summoner_id = s.accountId\n  m.game_id = 1234\n  m.champion = 123\n  ...\n  m.save!\n</code></pre>\n\n<p>But I get an error saying: </p>\n\n<pre><code>ActiveRecord::RecordInvalid: Validation failed: Summoner must exist\nfrom /Users/hebrongeorge/.rvm/gems/ruby-2.4.1/gems/activerecord-5.1.4/lib/active_record/validations.rb:78:in `raise_validation_error'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 0, "creation_date": 1514337174, "post_id": 47985204, "comment_id": 82939500, "body": "This may help you a little bit: <a href=\"https://github.com/rails/rails/issues/10615\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/10615</a>. In Rails 3.x, it looks like there was an implicit read-only when you use <code>joins</code>. In Rails 4 and beyond, that seems to have been removed. According to that issue though, <code>readonly(false)</code> is the recommended way. It&#39;s weird that it&#39;s not working for you."}, {"owner": {"reputation": 749, "user_id": 3767348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/evVot.jpg?s=128&g=1", "display_name": "veeresh yh", "link": "https://stackoverflow.com/users/3767348/veeresh-yh"}, "edited": false, "score": 1, "creation_date": 1514351637, "post_id": 47985204, "comment_id": 82942121, "body": "For soft-delete  <a href=\"https://github.com/rubysherpas/paranoia\" rel=\"nofollow noreferrer\">github.com/rubysherpas/paranoia</a> gem provides handy functions ."}, {"owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "edited": false, "score": 0, "creation_date": 1514351723, "post_id": 47985204, "comment_id": 82942143, "body": "Thanks, I will look into that gem :)"}], "answers": [{"tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": false, "score": 5, "last_activity_date": 1514338353, "creation_date": 1514338353, "answer_id": 47985346, "question_id": 47985204, "link": "https://stackoverflow.com/questions/47985204/association-with-scope-in-ruby-on-rails/47985346#47985346", "title": "Association with scope in Ruby on Rails", "body": "<p>According to <a href=\"https://github.com/rails/rails/issues/11199\" rel=\"noreferrer\">this thread in GitHub</a>, this is a Rails 4.0 bug, which has been fixed in version 4.0.1. Updating your Rails, you can include <code>readonly (false)</code> in your scope and it will work:</p>\n\n<p></p>\n\n<pre><code>class License &lt;ActiveRecord :: Base\n    has_many: license_items,\n          -&gt; {joins (: item) .where (items: {deleted: false}). readonly (false)},\n          dependent:: destroy\nend\n</code></pre>\n\n<p>To update the Rails version, edit your <code>Gemfile</code> and then run<code>bundle update</code>.</p>\n\n<p>In the latter case, if you can not update the Rails version, you can pass the <code>readonly: false</code> option to the<code>find</code> (not recommended) method:</p>\n\n<p></p>\n\n<pre><code>License.find (1) .license_items.find (1, readonly: false) .update_attributes (amount: 5)\n</code></pre>\n"}], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1514338353, "creation_date": 1514336413, "question_id": 47985204, "link": "https://stackoverflow.com/questions/47985204/association-with-scope-in-ruby-on-rails", "title": "Association with scope in Ruby on Rails", "body": "<p>I have a Ruby on Rails application in which I have licenses, items that can be licensed and a table that lists the two (Which items in what quantity are present in the license?). Analogously to the items in a shopping cart.</p>\n\n<p>Some of the items will no longer be marketed, but I intend to keep them in the database. I then created a <em>soft-delete</em> and used a default scope for the template and for the relationships. But when I try to change existing records using the related template, I get an exception: <code>ActiveRecord :: ReadOnlyRecord</code></p>\n\n<p>My templates look like this:</p>\n\n<pre><code>class Item &lt;ActiveRecord :: Base\n  default_scope {where (deleted: false)}\nend\n\nclass LicenseItem &lt;ActiveRecord :: Base\n  belongs_to: license, touch: true\n  belongs_to: item\nend\n\nclass License &lt;ActiveRecord :: Base\n  has_many: license_items,\n          -&gt; {joins (: item) .where (items: {deleted: false})},\n          dependent:: destroy\nend\n</code></pre>\n\n<p>In this way:</p>\n\n<pre><code>pry (main)&gt; License.find (0) .license_items [0] .readonly?\n=&gt; true\n</code></pre>\n\n<p>Is there any way to make this relationship not just reading?</p>\n\n<p>I have already tried to add <code>readonly (false)</code> at the end of the <code>has_many</code> scope to<code>License</code> without success.</p>\n"}, {"tags": ["ruby", "regex", "posix"], "comments": [{"owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "edited": false, "score": 1, "creation_date": 1514334777, "post_id": 47985045, "comment_id": 82939104, "body": "Why not just write your own class? <code>[\\r\\n\\v\\f]</code>"}, {"owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "edited": false, "score": 0, "creation_date": 1514334875, "post_id": 47985045, "comment_id": 82939118, "body": "<code>&quot;foo \\t bar baz&quot;.gsub(&#47;[^\\S\\t]&#47;, &#39;&#39;)</code> did the trick"}, {"owner": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "edited": false, "score": 1, "creation_date": 1514334925, "post_id": 47985045, "comment_id": 82939127, "body": "Wrong trick. Trick needs to include all possible matches for [[:space:]], including full width character (i.e. Japanese etc) spaces, and other incarnations of non printable characters."}, {"owner": {"reputation": 5979, "user_id": 8534588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/63d016df9eac3cc0a70b1fb1683dc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Withee", "link": "https://stackoverflow.com/users/8534588/josh-withee"}, "edited": false, "score": 1, "creation_date": 1514335092, "post_id": 47985045, "comment_id": 82939157, "body": "Have you tried using a negative lookahead? Try <code>(?!\\t)[[:space:]]</code>"}, {"owner": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "edited": false, "score": 0, "creation_date": 1514335402, "post_id": 47985045, "comment_id": 82939208, "body": "Hmm, not yet. I\u2019ll try it when I return to computer."}], "answers": [{"comments": [{"owner": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "edited": false, "score": 4, "creation_date": 1514335569, "post_id": 47985113, "comment_id": 82939240, "body": "It includes more than just those, such as full width characters beyond ascii set."}], "tags": [], "owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "is_accepted": false, "score": 0, "last_activity_date": 1514335400, "creation_date": 1514335400, "answer_id": 47985113, "question_id": 47985045, "link": "https://stackoverflow.com/questions/47985045/how-can-i-apply-regexp-posix-class-subtraction-or-equivalent/47985113#47985113", "title": "How can I apply regexp POSIX class subtraction or equivalent?", "body": "<p>The POSIX <code>[[:space]]</code> class is simply shorthand for <code>[ \\t\\r\\n\\v\\f]</code>. Therefore, all you need to do is use that same pattern, except without the <code>\\t</code>, or the space since that's what you're replacing the match with anyway.</p>\n\n<p><code>value.gsub!(/[\\r\\n\\v\\f]/, ' ')</code></p>\n\n<p>For more info see <a href=\"https://www.regular-expressions.info/posixbrackets.html\" rel=\"nofollow noreferrer\">https://www.regular-expressions.info/posixbrackets.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "edited": false, "score": 0, "creation_date": 1517519472, "post_id": 47985162, "comment_id": 84140297, "body": "I am curious if you have a similar way to do this subtraction (or subtraction by intersection with a negated) when using <code>tr</code> or <code>sed</code>? My initial testing using <code>tr</code> didn&#39;t seem to produce correct results. I need to build a counterpart to the ruby solution that uses unix system tools outside of ruby environment (to speed it up when processing large files)."}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "edited": false, "score": 0, "creation_date": 1517519707, "post_id": 47985162, "comment_id": 84140431, "body": "@Streamline Ruby uses Onigmo regex library, and it is not POSIX, it is an NFA regex library. The only POSIX thing in your current question is the POSIX character class, a <code>[:&lt;name&gt;:]</code> construct. POSIX regex engines like <code>sed</code> has no character class subtraction feature. Well, not sure if POSIX character classes there are Unicode aware. You might try to combine a negated brackets expression with the POSIX character class and add excluded char there, something like <code>[^\\t[:graph:]]</code> - any char that is not a printable character and not a tab. In <code>sed</code>, add <code>-E</code> option to enable ERE POSIX syntax."}], "tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 5, "last_activity_date": 1514335965, "creation_date": 1514335965, "answer_id": 47985162, "question_id": 47985045, "link": "https://stackoverflow.com/questions/47985045/how-can-i-apply-regexp-posix-class-subtraction-or-equivalent/47985162#47985162", "title": "How can I apply regexp POSIX class subtraction or equivalent?", "body": "<p>You may use</p>\n\n<pre><code>/[[:space:]&amp;&amp;[^\\t]]/\n</code></pre>\n\n<p>See the <a href=\"http://rubular.com/r/HDHpuprJrv\" rel=\"noreferrer\">Rubular demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>[</code> - start of a character class (bracket expression)\n\n<ul>\n<li><code>[:space:]</code>  - a POSIX character class matching whitespace chars</li>\n<li><code>&amp;&amp;</code> - a character class intersection operator</li>\n<li><code>[^\\t]</code> - any char other than a tab</li>\n</ul></li>\n<li><code>]</code> - end of a character class (bracket expression).</li>\n</ul>\n\n<p>See more about how to use <a href=\"http://www.rexegg.com/regex-class-operations.html#subtraction\" rel=\"noreferrer\">character class subtraction in Ruby</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 5979, "user_id": 8534588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/63d016df9eac3cc0a70b1fb1683dc62b?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Withee", "link": "https://stackoverflow.com/users/8534588/josh-withee"}, "is_accepted": false, "score": 2, "last_activity_date": 1514336104, "creation_date": 1514336104, "answer_id": 47985175, "question_id": 47985045, "link": "https://stackoverflow.com/questions/47985045/how-can-i-apply-regexp-posix-class-subtraction-or-equivalent/47985175#47985175", "title": "How can I apply regexp POSIX class subtraction or equivalent?", "body": "<p>Try using a negative lookahead assertion in your regex:</p>\n\n<pre><code>value.gsub!(/(?!\\t)[[:space:]]/, ' ')\n</code></pre>\n\n<p>The negative lookahead will prevent <code>[[:space:]]</code> from matching tabs.</p>\n"}, {"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": false, "score": 2, "last_activity_date": 1514340989, "creation_date": 1514340989, "answer_id": 47985559, "question_id": 47985045, "link": "https://stackoverflow.com/questions/47985045/how-can-i-apply-regexp-posix-class-subtraction-or-equivalent/47985559#47985559", "title": "How can I apply regexp POSIX class subtraction or equivalent?", "body": "<p>Ruby seems to support perl's negated posix classes (though I'm not seeing it documented :( ), so you can do:</p>\n\n<pre><code>/[^[:^space:]\\t]/\n</code></pre>\n\n<p>(not a non-space or tab)</p>\n"}], "owner": {"reputation": 1838, "user_id": 56082, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7d8f27df91b3d4b2a43606598ab75029?s=128&d=identicon&r=PG", "display_name": "Streamline", "link": "https://stackoverflow.com/users/56082/streamline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 47985162, "answer_count": 4, "score": 1, "last_activity_date": 1514349417, "creation_date": 1514334417, "last_edit_date": 1514349417, "question_id": 47985045, "link": "https://stackoverflow.com/questions/47985045/how-can-i-apply-regexp-posix-class-subtraction-or-equivalent", "title": "How can I apply regexp POSIX class subtraction or equivalent?", "body": "<p>Trying to do this in ruby but I suppose the question is applicable in any regexp language that handles POSIX classes</p>\n\n<p>Goal: I want to replace all of the characters that match the <code>[[:space:]]</code> POSIX class except a <code>tab</code>, with a regular single space.</p>\n\n<p>Hoping character class subtraction would work with POSIX classes, I tried this but it doesn't work</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>value.gsub!(/[ [[:space:]] - [\\t] ]/, ' ')\n</code></pre>\n\n<p>Is there a way to rewrite this so I can match and replace any of the characters found in the <code>[[:space:]]</code> class except the tab with a single regular space character?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Thanks for all of the answers.</p>\n\n<p>The answer I was searching for and defined in my question focused on <code>[[:space:]]</code> POSIX class because this class extends beyond just ascii characters and control characters and includes irregular or otherwise non-ascii whitespace equivalents in unicode, etc. Therefore, while I agree I could go and build my own class and find each and every possible whitespace, I'd rather make use of the existing class defined to include those and remove what I want from it.</p>\n\n<p>Initial testing shows that these 3 below answers provided:</p>\n\n<pre><code>value.gsub!(/(?!\\t)[[:space:]]/, ' ')  # appears to be language agnostic regexp approach which is good if needed\n\nvalue.gsub!(/[[:space:]&amp;&amp;[^\\t]]/, ' ') # for languages that don't actually support true class subtraction \n\nvalue.gsub!(/[^[:^space:]\\t]/, ' ') # inverse or double negative approach\n</code></pre>\n\n<p>produce the desired results. I like the first two best, but since I originally framed the question with ruby and the answer points out that ruby doesn't actually support class subtraction but instead demonstrates an intersection with a negative, I am choosing that answer for this question because it seems this is good to know even with non-POSIX classes.</p>\n"}, {"tags": ["html", "ruby", "jekyll"], "answers": [{"comments": [{"owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "edited": false, "score": 0, "creation_date": 1514334831, "post_id": 47985056, "comment_id": 82939111, "body": "Makes sense didnt see that one! Thanks"}], "tags": [], "owner": {"reputation": 19724, "user_id": 1165509, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ebdffd5ddb4a98b0cc77117503d2711?s=128&d=identicon&r=PG", "display_name": "marcanuy", "link": "https://stackoverflow.com/users/1165509/marcanuy"}, "is_accepted": true, "score": 1, "last_activity_date": 1514334477, "creation_date": 1514334477, "answer_id": 47985056, "question_id": 47984843, "link": "https://stackoverflow.com/questions/47984843/jekyll-how-to-not-interpret-jekyll-ruby-lines-in-a-code-snippet-rouge/47985056#47985056", "title": "Jekyll: how to not interpret jekyll / ruby lines in a code snippet (rouge)?", "body": "<p>Surround code with </p>\n\n<pre><code> {% raw %}\n</code></pre>\n\n<p>And\u00a0</p>\n\n<pre><code>{% endraw %}\n</code></pre>\n\n<blockquote>\n  <p>If you are using a language that contains curly braces, you will\n  likely need to place\u00a0{% raw %}and\u00a0{% endraw %}\u00a0tags around your code.</p>\n</blockquote>\n\n<p>More at <a href=\"https://jekyllrb.com/docs/templates/\" rel=\"nofollow noreferrer\">https://jekyllrb.com/docs/templates/</a></p>\n"}], "owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47985056, "answer_count": 1, "score": 1, "last_activity_date": 1514334477, "creation_date": 1514331989, "last_edit_date": 1514334361, "question_id": 47984843, "link": "https://stackoverflow.com/questions/47984843/jekyll-how-to-not-interpret-jekyll-ruby-lines-in-a-code-snippet-rouge", "title": "Jekyll: how to not interpret jekyll / ruby lines in a code snippet (rouge)?", "body": "<p>I have this snippet of code in a Jekyll post:</p>\n\n<pre><code>{% highlight html linenos %}\n&lt;!doctype html&gt;\n&lt;html class=\"no-js\" lang=\"en\" dir=\"ltr\"&gt;\n\n    {% include head.html %}\n\n    &lt;body&gt;\n    [...]\n    &lt;/body&gt;\n\n&lt;/html&gt;\n{% endhighlight %}\n</code></pre>\n\n<p>I would like that for example the line <code>{% include head.html %}</code> is not interpreted when rendering the snippet.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cancancan"], "answers": [{"comments": [{"owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "edited": false, "score": 1, "creation_date": 1514334860, "post_id": 47984731, "comment_id": 82939116, "body": "<code>cancancan</code> will load database records for you if you use <code>load_resource</code> or <code>load_and_authorize_resource</code>. For example, if you have an index action, cancancan does something like this for you: <code>@shifts = Shift.accessible_by(current_ability)</code>. Here&#39;s a link to the documentation about that feature: <a href=\"https://github.com/CanCanCommunity/cancancan/wiki/authorizing-controller-actions\" rel=\"nofollow noreferrer\">github.com/CanCanCommunity/cancancan/wiki/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 1, "last_activity_date": 1514330726, "creation_date": 1514330726, "answer_id": 47984731, "question_id": 47984574, "link": "https://stackoverflow.com/questions/47984574/rails-5-with-cancancan-how-to-filter-list-for-an-index-action/47984731#47984731", "title": "Rails 5 with CanCanCan - How to filter list for an index action", "body": "<p>You're asking a few different questions here, and it's hard to answer them individually, so I'm going to take a more broad approach in hopes of answering some of the underlying questions I believe you're having.</p>\n\n<p>First thing's first: Cancancan does not do anything that relates to querying your database. Cancancan leaves that up to you.</p>\n\n<p>I'm not seeing where <code>@shifts</code> is defined, so I'm going to assume it's in your <code>ShiftsController</code> \u2014 whereas the index action is supposed to show a given user's shifts.</p>\n\n<p>A given user is usually the <code>current_user</code> in Rails applications \u2014 this authentication is done by something such as Devise. If your associations are setup correctly, you're able to do <code>@shifts = current_user.shifts</code></p>\n\n<p>But in the case that you want to, say, filter the shifts by user \u2014 such as having a RESTful route of <code>/users/:id/shifts</code> \u2014 you would have routes that look like this:</p>\n\n<pre><code>resources :users do \n  member do\n    get :shifts =&gt; 'users#shifts'\n  end\nend\n</code></pre>\n\n<p>which would map to your <code>UsersController</code> with a method <code>shifts</code>.</p>\n\n<p>Inside that method you'd have an <code>:id</code> param with the value that you'd expect from your show action. </p>\n\n<p><code>@shifts = Shift.where(:user_id =&gt; params[:id])</code></p>\n\n<p>Now, if you wanted to filter shifts on your <code>ShiftsController#index</code> method, you could have something like this:</p>\n\n<p><code>@shifts = Shift.where(:user_id =&gt; params[:user_id])</code></p>\n\n<p>and your URL would look like, presumably, <code>/shifts?user_id=1</code></p>\n\n<p>Now, if a user doesn't have any shifts, <code>@shifts</code> will return an empty array \u2014 indicative of no rows that match your database query. Therefore, you can do some simple logic in your view,</p>\n\n<p><code>&lt;% if @shifts.empty? %&gt; No shifts. &lt;% else %&gt; ... things to list shifts &lt;% end %&gt;</code></p>\n"}], "owner": {"reputation": 43, "user_id": 7999165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbJku.jpg?s=128&g=1", "display_name": "Breno Nogueira", "link": "https://stackoverflow.com/users/7999165/breno-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514330726, "creation_date": 1514329103, "question_id": 47984574, "link": "https://stackoverflow.com/questions/47984574/rails-5-with-cancancan-how-to-filter-list-for-an-index-action", "title": "Rails 5 with CanCanCan - How to filter list for an index action", "body": "<p>I'm making a system for study purposes.</p>\n\n<p>This system controls the hospital shifts for the user. An user should only see his shifts.</p>\n\n<p>I'm using CanCanCan for the authorization control.</p>\n\n<p>So for the index page the controller action I have:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n    def index\n        @users = User.all\n    end\nend\n</code></pre>\n\n<p>In the index.html.erb</p>\n\n<pre><code>&lt;% @shifts.each do |shift| %&gt;\n    &lt;% if can? :read, shift %&gt;\n      &lt;tr&gt;\n          &lt;td&gt;&lt;%= shift.date %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In the ability I have:</p>\n\n<pre><code>class Ability\n    include CanCan::Ability\n\n    def initialize(user)\n        if user\n            can :manage, Shift, user_id: user.id\n        end\n    end\nend\n</code></pre>\n\n<p>I want to show a message to the user if he doesn't have any shifts.</p>\n\n<p>But using the can method in index html page because if the list is not empty but there is no shift the current user can see I can't use an empty method direct in the @shift.</p>\n\n<p>Is it possible to filter the list in the index action in user controller?</p>\n"}, {"tags": ["ios", "ruby", "rubygems", "bundler", "gemspecs"], "answers": [{"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 0, "last_activity_date": 1514324057, "creation_date": 1514324057, "answer_id": 47983925, "question_id": 47983754, "link": "https://stackoverflow.com/questions/47983754/bundler-create-gem-default-contact-info-source/47983925#47983925", "title": "Bundler: Create Gem - Default Contact Info Source?", "body": "<p>Bundler pulls that info from git so just set your name in your <code>~/.gitconfig</code> globally:</p>\n\n<pre><code>[user]\n  email = my@workemail.com\n  name = MyName\n</code></pre>\n\n<p>or you could set it locally to that repo via <code>./git/config</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 3966058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQTN6.jpg?s=128&g=1", "display_name": "Pseudo", "link": "https://stackoverflow.com/users/3966058/pseudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 47983925, "answer_count": 1, "score": 1, "last_activity_date": 1514324057, "creation_date": 1514322761, "question_id": 47983754, "link": "https://stackoverflow.com/questions/47983754/bundler-create-gem-default-contact-info-source", "title": "Bundler: Create Gem - Default Contact Info Source?", "body": "<p>I followed this guide to build my first Ruby Gem:</p>\n\n<p><a href=\"http://bundler.io/v1.12/guides/creating_gem.html\" rel=\"nofollow noreferrer\">http://bundler.io/v1.12/guides/creating_gem.html</a></p>\n\n<p>Everything worked as expected, but I have one question: I noticed that Bundler auto-magically pulled my personal contact info from somewhere (I'm on a Mac) and used that to build the gem.  An example of a file containing this info:</p>\n\n<pre><code>gem_name.gemspec\n</code></pre>\n\n<p>I don't want it to default to using my personal contact info (such as my personal email address, etc.) as I build more gems.  I want it to use my company's info by default.  I'm guessing/hoping that there is some data file somewhere that I can set this default info, to be used on all further new gem builds?  Or maybe some other way to set these default values???</p>\n\n<p>I realize that I can edit this info after the scaffold builds, but I want to automate it as much as possible.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5383552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7363bdcb7e822e9b3a49a08a9e3c45b9?s=128&d=identicon&r=PG&f=1", "display_name": "rosenjd4", "link": "https://stackoverflow.com/users/5383552/rosenjd4"}, "is_accepted": false, "score": 0, "last_activity_date": 1514324748, "creation_date": 1514324748, "answer_id": 47984016, "question_id": 47983382, "link": "https://stackoverflow.com/questions/47983382/issue-including-a-second-and-a-third-level-association/47984016#47984016", "title": "Issue including a second and a third level association", "body": "<p>Without a stacktrace here's what I suggest:</p>\n\n<p>Assuming your has_one method name is <code>products_pedidos</code>, your issue looks like a problem with your hash syntax.</p>\n\n<p>Your syntax creates a hash with key <code>products_pedidos</code> that returns a hash without a value.  This is probably where the error is occurring.</p>\n\n<pre><code>@pedidos = Pedido.includes(:products_pedidos =&gt; { :product_size })\n</code></pre>\n\n<p>What you likely want is this which returns a hash with key <code>products_pedidos</code> with value <code>product_size</code></p>\n\n<pre><code>@pedidos = Pedido.includes({products_pedidos: :product_size })\n</code></pre>\n\n<p>The Entire query might look like:</p>\n\n<pre><code>@pedidos = Pedido.includes(\n  :pedidos_payments,\n  {products_pedidos :product_size},\n  :estado,\n  :brand,\n  :customer\n).where(is_quote: false)\n</code></pre>\n\n<p>Here's a great post explaining a bit more about ActiveRecord nested relationship loading: <a href=\"https://stackoverflow.com/questions/24397640/rails-nested-includes-on-active-records\">Rails - Nested includes on Active Records?</a>.  I'd also suggest fixing the naming on products_pedido to follow good naming practices.</p>\n"}], "owner": {"reputation": 37, "user_id": 8387879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/721c42f4aa3265608eba49d08950c933?s=128&d=identicon&r=PG&f=1", "display_name": "Sebasti&#225;n Echeverr&#237;a", "link": "https://stackoverflow.com/users/8387879/sebasti%c3%a1n-echeverr%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514324748, "creation_date": 1514319896, "last_edit_date": 1514321359, "question_id": 47983382, "link": "https://stackoverflow.com/questions/47983382/issue-including-a-second-and-a-third-level-association", "title": "Issue including a second and a third level association", "body": "<p>This query is not working, pease help. I'm trying to include a second and a third deep-level of association. </p>\n\n<p>Pedido > has_one(products_pedido) > has_one(product_size)</p>\n\n<pre><code>@pedidos = Pedido.includes(:pedidos_payments, :products_pedidos =&gt; { :product_size }\u00a0, :estado, :brand, :customer ).where(:is_quote =&gt; false)\n</code></pre>\n\n<p>Ps: I know products_pedido is mispelled according to ActiveRecord good practices :). </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1514330930, "post_id": 47982856, "comment_id": 82938409, "body": "I&#39;m not sure the stage of your application, but one thing to always keep in mind that premature optimization is the root of all evil."}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "edited": false, "score": 0, "creation_date": 1514318599, "post_id": 47983159, "comment_id": 82935060, "body": "That&#39;s what I figured but wanted to get some confirmation. Thank you. Much appreciated."}], "tags": [], "owner": {"reputation": 3206, "user_id": 4721554, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4zQo.png?s=128&g=1", "display_name": "fbelanger", "link": "https://stackoverflow.com/users/4721554/fbelanger"}, "is_accepted": true, "score": 3, "last_activity_date": 1514507764, "last_edit_date": 1514507764, "creation_date": 1514318185, "answer_id": 47983159, "question_id": 47982856, "link": "https://stackoverflow.com/questions/47982856/activerecord-better-performance/47983159#47983159", "title": "ActiveRecord Better Performance", "body": "<p>The age old question of all Rails developer.</p>\n\n<p>Having developed multiple apps with complex datasets, I can assure you that there is always a way to get your cake and eat it too.</p>\n\n<p>It really depends on the dataset size. Say you were to do multiple array operations where N = 3 ^ 1000. Then multiple array manipulations would cripple the app.</p>\n\n<p>Worked on an app where we thought data was retrieved in a single query, then turned into a PDF. Our app would crash for large customer data and we did not really understand why.</p>\n\n<p>We later found out that it had everything to do with the array manipulation required to build the PDFs.</p>\n\n<p>We eventually refactored in a way to minimize manipulation of data and reduce queries down to a single query.</p>\n\n<p>This might not be necessary for you, but just to give some context of what I'm saying.</p>\n\n<p>On the flip side, for small requests with small datasets, doing multiple DB queries can be cripplingly slow.</p>\n\n<p>All in all, it's always best to do a single query and to work off the original array.</p>\n\n<p>If you're interested, I would look into deeply nested association in Rails, <code>eager_load</code> and when all else fails writing SQL by hand.</p>\n"}, {"comments": [{"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "edited": false, "score": 0, "creation_date": 1514318627, "post_id": 47983176, "comment_id": 82935083, "body": "Thanks Hubert. This is helpful. I am going to give this a try."}], "tags": [], "owner": {"reputation": 532, "user_id": 5841310, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/10206848519343961/picture?type=large", "display_name": "Hubert Jakubiak", "link": "https://stackoverflow.com/users/5841310/hubert-jakubiak"}, "is_accepted": false, "score": 1, "last_activity_date": 1514318298, "creation_date": 1514318298, "answer_id": 47983176, "question_id": 47982856, "link": "https://stackoverflow.com/questions/47982856/activerecord-better-performance/47983176#47983176", "title": "ActiveRecord Better Performance", "body": "<p>You can benchmark two implementations of single method. Try to execute below code in rails console. I changed in your code <code>params[:name]</code> to string <code>some name</code>. You should adjust it to find some products.</p>\n\n<pre><code>require 'benchmark'\n\ndef detail_1\n  sorted_sizes = [\"S\", \"M\", \"L\", \"XL\"]\n  products = Product.where(:name =&gt; 'some name')\n  if products.empty?\n    return redirect_to shop_path, :notice =&gt; 'The item is no longer available'\n  end \n  @product = products.first\n  @sizes = sorted_sizes &amp; products.pluck(:size).uniq\n  @colors = products.pluck(:color).uniq\n  @quantity = products.where(\"size = :size AND color = :color AND available = :bool\",\n                              size: @sizes[0], color: @colors[0], bool: true).count\nend\n\ndef detail_2\n  sorted_sizes = [\"S\", \"M\", \"L\", \"XL\"]\n  products = Product.where(:name =&gt; 'some name').to_a\n  if products.empty?\n    return redirect_to shop_path, :notice =&gt; 'The item is no longer available'\n  end \n  @product = products.first\n  @sizes = sorted_sizes &amp; products.pluck(:size).uniq\n  @colors = products.pluck(:color).uniq\n  @quantity = products.select do |elem|\n                elem.size == @sizes[0] &amp;&amp; elem.color == @colors[0] &amp;&amp; elem.available == true\n              end\n  @quantity = @quantity.count\nend\n\nBenchmark.bmbm do |x|\n  x.report('first implementation') do\n    10000.times { detail_1 }\n  end\n  x.report('second implementation') do\n    10000.times { detail_2 }\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 47983159, "answer_count": 2, "score": 0, "last_activity_date": 1514507764, "creation_date": 1514316133, "question_id": 47982856, "link": "https://stackoverflow.com/questions/47982856/activerecord-better-performance", "title": "ActiveRecord Better Performance", "body": "<p>I am new to Ruby and Rails and am experimenting with improving performance. Which of the two options is better way to go for a live app?</p>\n\n<p>Option A: More hits to the database but uses the built in ActiveRecord Relation</p>\n\n<pre><code> def detail\n    sorted_sizes = [\"S\", \"M\", \"L\", \"XL\"]\n    products = Product.where(:name =&gt; params[:name])\n    if products.empty?\n      return redirect_to shop_path, :notice =&gt; 'The item is no longer available'\n    end \n    @product = products.first\n    @sizes = sorted_sizes &amp; products.pluck(:size).uniq\n    @colors = products.pluck(:color).uniq\n    @quantity = products.where(\"size = :size AND color = :color AND available = :bool\",\n                                size: @sizes[0], color: @colors[0], bool: true).count\n  end\n</code></pre>\n\n<p>Option B: Uses an array to reduce hits to a DB but requires some custom code such as to grab the total quantity that matches certain filters.</p>\n\n<pre><code> def detail\n    sorted_sizes = [\"S\", \"M\", \"L\", \"XL\"]\n    products = Product.where(:name =&gt; params[:name]).to_a\n    if products.empty?\n      return redirect_to shop_path, :notice =&gt; 'The item is no longer available'\n    end \n    @product = products.first\n    @sizes = sorted_sizes &amp; products.pluck(:size).uniq\n    @colors = products.pluck(:color).uniq\n    @quantity = products.select do |elem|\n                  elem.size == @sizes[0] &amp;&amp; elem.color == @colors[0] &amp;&amp; elem.available == true\n                end\n    @quantity = @quantity.count\n  end\n</code></pre>\n\n<p>Am I wrong to assume Option B is better since the hits to the DB are reduced? And if the answer is it depends, where would option A be preferred except in having to access the built in methods?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5.1"], "comments": [{"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1514312254, "post_id": 47982072, "comment_id": 82932893, "body": "Try <code>[].method(:sum).source_location</code> in the Rails console of your existing project to see if <code>sum</code> is being overridden somewhere. Also might be some clues in the stacktrace lines that come after <code>undefined method `each&#39; for nil:NilClass</code>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1514312624, "post_id": 47982072, "comment_id": 82933028, "body": "There is no stack trace after the error. <code>[].method(:sum).source_location</code> returns <code>[&quot;&#47;Users&#47;mmo&#47;.rbenv&#47;versions&#47;2.4.2&#47;lib&#47;ruby&#47;gems&#47;2.4.0&#47;gems&#47;&zwnj;&#8203;activesupport-5.1.4&#47;&zwnj;&#8203;lib&#47;active_support&#47;c&zwnj;&#8203;ore_ext&#47;enumerable.r&zwnj;&#8203;b&quot;, 148]</code>. It returns the same result in my newly created test project in which <code>[].sum</code> works properly."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 1, "creation_date": 1514313959, "post_id": 47982072, "comment_id": 82933453, "body": "Looking at <a href=\"https://github.com/rails/rails/blob/v5.1.4/activesupport/lib/active_support/core_ext/enumerable.rb\" rel=\"nofollow noreferrer\">the source</a> it definitely seems like something odd because you shouldn&#39;t have been getting the behaviour you described for Rails 5.1.4 using Ruby 2.3.5. (i.e. you should have been getting 0 not <code>nil</code> there too). In the source <code>Array#sum</code> will call <code>super</code> which is <code>Enumerable#sum</code> and <a href=\"https://github.com/rails/rails/blob/5-1-stable/activesupport/lib/active_support/core_ext/enumerable.rb#L8\" rel=\"nofollow noreferrer\">both implementations</a> of that have a default of 0."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1514314168, "post_id": 47982072, "comment_id": 82933536, "body": "So it&#39;s looking like <code>[].sum</code> is calling <code>Array#sum</code> (the <code>source_location</code>) reported, but that is calling a customised <code>Enumerable#sum</code>. So you could try this: <code>[].method(:sum).super_method.source_location</code>"}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1514314220, "post_id": 47982072, "comment_id": 82933561, "body": "Was just typing another comment as you were replying :) - that included the suggestion to check <code>[].method(:sum).super_method.source_location</code>"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 4, "creation_date": 1514314244, "post_id": 47982072, "comment_id": 82933572, "body": "In my newly created project, <code>[].method(:sum).super_method.source_location</code> returns <code>[&quot;&#47;Users&#47;mmo&#47;.rbenv&#47;versions&#47;2.4.2&#47;lib&#47;ruby&#47;gems&#47;2.4.0&#47;gems&#47;&zwnj;&#8203;activesupport-5.1.4&#47;&zwnj;&#8203;lib&#47;active_support&#47;c&zwnj;&#8203;ore_ext&#47;enumerable.r&zwnj;&#8203;b&quot;, 31]</code>. In the existing project, it returns <code>[&quot;&#47;Users&#47;mmo&#47;.rbenv&#47;versions&#47;2.4.2&#47;lib&#47;ruby&#47;gems&#47;2.4.0&#47;gems&#47;&zwnj;&#8203;descriptive_statisti&zwnj;&#8203;cs-2.5.1&#47;lib&#47;descrip&zwnj;&#8203;tive_statistics&#47;sum.&zwnj;&#8203;rb&quot;, 2]</code>. Looks like the descriptive_statistics gem is the source of the problem."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 2, "creation_date": 1514317491, "post_id": 47982072, "comment_id": 82934662, "body": "@mikej Thanks for the detective work. If you&#39;d like to rephrase this conversation as an answer, I&#39;m happy to accept it."}, {"owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "edited": false, "score": 0, "creation_date": 1514318607, "post_id": 47982072, "comment_id": 82935069, "body": "Great! This could be useful for others coming across other slightly different problems too so I&#39;ve written it up as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1514314034, "creation_date": 1514314034, "answer_id": 47982522, "question_id": 47982072, "link": "https://stackoverflow.com/questions/47982072/ruby-2-4-enumerablesum-breaks-in-rails-5-1/47982522#47982522", "title": "Ruby 2.4 Enumerable#sum breaks in Rails 5.1", "body": "<p>I think that your application have some overhidden on sum method. Look the example below with 2 new applications using the 2 different versions of ruby</p>\n\n<pre><code>/testapp# ruby --version\nruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-linux]\n/testapp# rails --version\nRails 5.1.4\n/testapp# rails c\nirb(main):001:0&gt; [].sum\n=&gt; 0\n</code></pre>\n\n<p>and the other version</p>\n\n<pre><code>/testapp# ruby --version\nruby 2.3.5p376 (2017-09-14 revision 59905) [x86_64-linux]\n/testapp# rails --version\nRails 5.1.4\n/testapp# rails c\nirb(main):001:0&gt; [].sum\n=&gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61438, "user_id": 63034, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZXKMO.jpg?s=128&g=1", "display_name": "mikej", "link": "https://stackoverflow.com/users/63034/mikej"}, "is_accepted": true, "score": 1, "last_activity_date": 1514318562, "creation_date": 1514318562, "answer_id": 47983232, "question_id": 47982072, "link": "https://stackoverflow.com/questions/47982072/ruby-2-4-enumerablesum-breaks-in-rails-5-1/47983232#47983232", "title": "Ruby 2.4 Enumerable#sum breaks in Rails 5.1", "body": "<p>Looking at the <a href=\"https://github.com/rails/rails/blob/v5.1.4/activesupport/lib/active_support/core_ext/enumerable.rb\" rel=\"nofollow noreferrer\">source for the Active Support enumerable extensions</a> it definitely seems like something odd is going on because you shouldn't have been getting the behaviour you described for Rails 5.1.4 using Ruby 2.3.5 i.e. you should have been getting 0 not <code>nil</code> there too.</p>\n\n<p>Active Support's <code>Array#sum</code> checks if Ruby's own <code>sum</code> can be used by checking <code>first.is_a?(Numeric)</code>. This will be false for an empty array so the call to <code>super</code> will call <code>Enumerable#sum</code> and <a href=\"https://github.com/rails/rails/blob/5-1-stable/activesupport/lib/active_support/core_ext/enumerable.rb#L8\" rel=\"nofollow noreferrer\">both implementations of that</a> have a default of 0.</p>\n\n<p>Try <code>[].method(:sum).source_location</code> in the Rails console of your existing project to see if <code>Array#sum</code> is being overridden somewhere.</p>\n\n<p>if that returns the expected line from <code>active_support/c\u200c\u200bore_ext/enumerable.r\u200c\u200bb</code> then the next step will be to check <code>[].method(:sum).super_method.source_location</code> and see if a customised <code>Enumerable#sum</code> is the culprit.</p>\n"}], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 1, "accepted_answer_id": 47983232, "answer_count": 2, "score": 3, "last_activity_date": 1517085666, "creation_date": 1514311161, "last_edit_date": 1517085666, "question_id": 47982072, "link": "https://stackoverflow.com/questions/47982072/ruby-2-4-enumerablesum-breaks-in-rails-5-1", "title": "Ruby 2.4 Enumerable#sum breaks in Rails 5.1", "body": "<p>In Rails 5.1.4 using Ruby 2.3.5, I get this behavior:</p>\n\n<pre><code>&gt;&gt; [].sum\n#&gt; nil\n</code></pre>\n\n<p>I'd like to upgrade to Ruby 2.4, where Enumerable#sum is implemented natively. Testing this in IRB using Ruby 2.4.2, I get this result:</p>\n\n<pre><code>&gt;&gt; [].sum\n#&gt; 0\n</code></pre>\n\n<p>That's OK, and I can handle the different result. But going back to the Rails console in Rails 5.1.4 using Ruby 2.4.2, I get this:</p>\n\n<pre><code>&gt;&gt; [].sum\n#&gt; NoMethodError: undefined method `each' for nil:NilClass\n</code></pre>\n\n<p>However, in a newly created Rails 5.1.4 project, I don't get this error. What's going on here? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "edited": false, "score": 0, "creation_date": 1514323878, "post_id": 47982614, "comment_id": 82936758, "body": "Do you know how can I load admin AFTER other queries? Thank you"}, {"owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "reply_to_user": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "edited": false, "score": 2, "creation_date": 1514330054, "post_id": 47982614, "comment_id": 82938257, "body": "The first thing that it will do is check if the user is valid. There is no way to do this later. It will have to check before do anything"}], "tags": [], "owner": {"reputation": 372, "user_id": 9141855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a68f4ad4f0df2aaf0d37f23cf960ce52?s=128&d=identicon&r=PG&f=1", "display_name": "Max Forasteiro", "link": "https://stackoverflow.com/users/9141855/max-forasteiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1514314638, "creation_date": 1514314638, "answer_id": 47982614, "question_id": 47981725, "link": "https://stackoverflow.com/questions/47981725/rails-active-admin-load-user-on-every-page/47982614#47982614", "title": "Rails: Active admin load user on every page", "body": "<p>I think that this query runs every time to check if the current admin user is a valid and existing one. I'd never used Active Admin, but with <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow noreferrer\">rails admin</a> is the same thing</p>\n"}], "owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 47982614, "answer_count": 1, "score": 0, "last_activity_date": 1514314638, "creation_date": 1514308865, "last_edit_date": 1514311344, "question_id": 47981725, "link": "https://stackoverflow.com/questions/47981725/rails-active-admin-load-user-on-every-page", "title": "Rails: Active admin load user on every page", "body": "<p>Every time I reload a page (a totally blank page as well) I get this:</p>\n\n<pre><code>User Load (0.5ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT ?  [[\"id\", 1], [\"LIMIT\", 1]]\n</code></pre>\n\n<p>So Active Admin load the admin user 1 every time I reload the page. Is it normal? There is one way to load AFTER other sql query?</p>\n"}, {"tags": ["ruby", "go", "encryption", "rsa"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1514308953, "post_id": 47981709, "comment_id": 82931886, "body": "Why do you need the output to be identical? Have you checked whether the message encrypted by Go can be decrypted by Ruby as required?"}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 0, "creation_date": 1514309050, "post_id": 47981709, "comment_id": 82931920, "body": "I&#39;d be interested in the versions you are using for Ruby at least. And the goal or objective. What is the PKI used for concretely ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1514309269, "post_id": 47981709, "comment_id": 82931965, "body": "You should never end up the identical cipher text, else someone would be able to break the encryption."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 3, "creation_date": 1514310342, "post_id": 47981709, "comment_id": 82932303, "body": "In other words, you did it wrong in Ruby because it gave you the rope to hang yourself, now your looking to do it wrong in Go."}, {"owner": {"reputation": 441, "user_id": 6451721, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-4pC3WCmF5xE/AAAAAAAAAAI/AAAAAAAAAFI/NjnGhmZoI6w/photo.jpg?sz=128", "display_name": "Fer Vargas", "link": "https://stackoverflow.com/users/6451721/fer-vargas"}, "edited": false, "score": 0, "creation_date": 1514310701, "post_id": 47981709, "comment_id": 82932400, "body": "Im using ruby 1.9.3, the encrypted part can be decrypted but ruby doesn&#39;t give the output that is needed.  As a side note, I didn&#39;t code the ruby part that we&#39;re trying to change to golang, that is just the tip of a horrible coded rails iceberg."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1514313044, "post_id": 47981709, "comment_id": 82933139, "body": "Can you expand on that? If Ruby can decrypt it, you&#39;re halfway home. What&#39;s wrong with the output? It seems like that&#39;s the problem to fix."}, {"owner": {"reputation": 441, "user_id": 6451721, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-4pC3WCmF5xE/AAAAAAAAAAI/AAAAAAAAAFI/NjnGhmZoI6w/photo.jpg?sz=128", "display_name": "Fer Vargas", "link": "https://stackoverflow.com/users/6451721/fer-vargas"}, "edited": false, "score": 0, "creation_date": 1514313537, "post_id": 47981709, "comment_id": 82933297, "body": "Let me edit the question, since i overlooked a couple of details."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1514314432, "post_id": 47981709, "comment_id": 82933646, "body": "As far as I can tell all public interfaces available from <code>crypto&#47;rsa</code> enforce either PKCS15 or OAEP padding and will thus always reject your ciphertext during decryption. Either do it right in Ruby or you&#39;ll have to roll your own rsa decryptor in go."}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 1, "creation_date": 1514330771, "post_id": 47981709, "comment_id": 82938378, "body": "To add to everyone else&#39;s concerns, a more existential one.  RSA crypto has a very limited possible message length (somewhat less than the number of bits in the key).  The more typical approach is to use the public key to encrypt a random symmetric key for e.g. AES-256-CBC or similar and use that to send the actual message.  See <a href=\"https://stackoverflow.com/questions/5866129/rsa-encryption-problem-size-of-payload-data\" title=\"rsa encryption problem size of payload data\">stackoverflow.com/questions/5866129/&hellip;</a> and <a href=\"https://crypto.stackexchange.com/questions/14/how-can-i-use-asymmetric-encryption-such-as-rsa-to-encrypt-an-arbitrary-length\" title=\"how can i use asymmetric encryption such as rsa to encrypt an arbitrary length\">crypto.stackexchange.com/questions/14/&hellip;</a>"}, {"owner": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "edited": false, "score": 0, "creation_date": 1514358566, "post_id": 47981709, "comment_id": 82944395, "body": "what is the <code>cryptorand</code> variable?"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 6451721, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-4pC3WCmF5xE/AAAAAAAAAAI/AAAAAAAAAFI/NjnGhmZoI6w/photo.jpg?sz=128", "display_name": "Fer Vargas", "link": "https://stackoverflow.com/users/6451721/fer-vargas"}, "edited": false, "score": 0, "creation_date": 1514406924, "post_id": 47987979, "comment_id": 82964981, "body": "Thank you so much. Now I have a better understanding of how this works, I modified a couple of things in the code and now it works. I edited the question with the changes."}], "tags": [], "owner": {"reputation": 8340, "user_id": 1645712, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/48781792c1fb7d61086b4fb612938c13?s=128&d=identicon&r=PG", "display_name": "gusto2", "link": "https://stackoverflow.com/users/1645712/gusto2"}, "is_accepted": true, "score": 2, "last_activity_date": 1514368549, "last_edit_date": 1514368549, "creation_date": 1514358999, "answer_id": 47987979, "question_id": 47981709, "link": "https://stackoverflow.com/questions/47981709/ruby-rsa-public-key-encryption-to-golang/47987979#47987979", "title": "Ruby RSA public key encryption to Golang", "body": "<p>I am no knowledgeable about golang, however I may know something about RSA.</p>\n\n<p>The difference seems to be in the <a href=\"https://en.wikipedia.org/wiki/Padding_(cryptography)\" rel=\"nofollow noreferrer\">padding</a>.</p>\n\n<p>For ruby - no padding is used<br/>\nFor golang - PKCS1v15 padding is used </p>\n\n<p>In the <em>ruby</em>example you use <code>OpenSSL::PKey::RSA::NO_PADDING</code> is used which is <strong>VERY VERY unsafe</strong>. It is called <em>textbook</em> RSA and is not inteded in real-life use as it has many weaknesses and dangerous traps. So <strong>the ruby example is very dangerously unsafe</strong> because of using the textbook RSA. As well it is limited to encrypting small messages (much smaller than the keyspace).</p>\n\n<p>There are two padding types used with RSA:</p>\n\n<ul>\n<li><p>PKCS1 v1 (commonly referred as PKCS1) - this is a deterministic padding (the output is always the same), many cryptographers consider this option obsolete as some weaknesses has been found when not used properly, but it is still in use and not considered broken.</p></li>\n<li><p>PKCS1 v2 (commonly refered as OAEP or PSS) which is stochastic (randomized) padding. You can distinguish the last two as the output of OAEP is always different.</p></li>\n</ul>\n\n<blockquote>\n  <p>One of the problems is that ruby can encrypt the text with no problem, and in golang I'm getting an error that the key is too short to encrypt everything</p>\n</blockquote>\n\n<p>You've provided only a small part of the golang example, so <em>here I may only assume many things</em>.</p>\n\n<p>As you claim the golang example outputs randomized output and according to the parameters PKCS1 v1.5 is used, I'd assume the implementation is doing <a href=\"https://en.wikipedia.org/wiki/Hybrid_cryptosystem\" rel=\"nofollow noreferrer\">hybrid encryption</a> which is good and much safer way to encrypt data with RSA (using symmetric encryption with random key and wrap/encrypt the key with RSA).</p>\n"}], "owner": {"reputation": 441, "user_id": 6451721, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-4pC3WCmF5xE/AAAAAAAAAAI/AAAAAAAAAFI/NjnGhmZoI6w/photo.jpg?sz=128", "display_name": "Fer Vargas", "link": "https://stackoverflow.com/users/6451721/fer-vargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 47987979, "answer_count": 1, "score": 0, "last_activity_date": 1514406872, "creation_date": 1514308777, "last_edit_date": 1514406872, "question_id": 47981709, "link": "https://stackoverflow.com/questions/47981709/ruby-rsa-public-key-encryption-to-golang", "title": "Ruby RSA public key encryption to Golang", "body": "<p>I'm currently working on a project where I have to \"convert\" some code from Ruby(version 1.9.3p194) to Golang(version 1.7). There is this part where Ruby uses RSA public key encryption and I always get a consistent result every time it gets executed. This is the function used:</p>\n\n<p><strong>Edit</strong>: I overlooked that after the public key encryption, there is a base 64 encoding as well</p>\n\n<pre><code>public_key = OpenSSL::PKey::RSA.new(public_encryption_key)\npublic_encrypted_text = public_key.public_encrypt(text, OpenSSL::PKey::RSA::NO_PADDING)\nbase64_encrypted_text = Base64.encode64(public_encrypted_text).gsub(\"\\n\", \"\")\nescaped_encrypted_text = URI.escape(encrypted_key, \"/+=\")\n</code></pre>\n\n<p>However in Golang, due to the rsa library I can't get a consistent result since the function to encrypt takes a random parameter to generate different result each time. I understand why it needs to be different every time, but i can't get anything remotely similar to what ruby generates. These are the functions used in Golang:</p>\n\n<pre><code>//keyBytes is the public key as []byte\nblock, _ := pem.Decode(keyBytes)\nkey, err := x509.ParsePKIXPublicKey(block.Bytes)\nif err != nil {\n    return nil, err\n}\n\npubKey, ok := key.(*rsa.PublicKey)\nif !ok {\n    return nil, errors.New(\"Cannot convert to rsa.PublicKey\")\n}\n\nresult, err := rsa.EncryptPKCS1v15(cryptorand.Reader, pubKey, text)\nencryptedText := base64.URLEncoding.EncodeToString(result)\nencryptedText = strings.TrimRight(encryptedText, \"=\")\n</code></pre>\n\n<p>One of the problems is that ruby can encrypt the text with no problem, and in golang I'm getting an error that the key is too short to encrypt everything.</p>\n\n<p>If I encrypt something else, like \"Hello\". When decrypting I get from ruby the error \"padding check failed\". The decryption is being handle like follows:</p>\n\n<pre><code>private_key.private_decrypt(Base64.decode64(text))  \n</code></pre>\n\n<p><strong>EDIT:</strong> Thanks to the answer of <a href=\"https://stackoverflow.com/users/1645712/gusto2\">gusto2</a> I now know better what is going on since I didn't have much understanding of RSA.</p>\n\n<p>Now in Golang I was able to encrypt the text using PKCS1 v1.5, and just to be sure I tried to decrypt that as well, also in Golang, with no problem.</p>\n\n<p>However in Ruby I still wasn't able to decrypt using the private key. So I figured that the base64 encoding used in Golang was the issue. So I changed that part to this:</p>\n\n<pre><code>encryptedText := base64.StdEncoding.EncodeToString(result)\n</code></pre>\n\n<p>And also I removed the last line were the equal sign was being trimmed.</p>\n\n<p>With that done it worked like a charm.</p>\n"}, {"tags": ["ruby", "sass"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1514305188, "post_id": 47981084, "comment_id": 82930684, "body": "you can download it from rubygems (<a href=\"https://rubygems.org/gems/sass\" rel=\"nofollow noreferrer\">link</a>)"}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1514331008, "post_id": 47981084, "comment_id": 82938420, "body": "you can always run your own gem server. <a href=\"http://guides.rubygems.org/run-your-own-gem-server/\" rel=\"nofollow noreferrer\">guides.rubygems.org/run-your-own-gem-server</a> \u2014 there are other solutions as well."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8676501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvJMP.jpg?s=128&g=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/8676501/ryan-c"}, "edited": false, "score": 0, "creation_date": 1514469209, "post_id": 47989169, "comment_id": 82985617, "body": "I did this and got this: ERROR: Could not find a valid gem &#39;sass-listen&#39; (~&gt; 4.0.0) in any repository."}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 25, "user_id": 8676501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvJMP.jpg?s=128&g=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/8676501/ryan-c"}, "edited": false, "score": 0, "creation_date": 1514543754, "post_id": 47989169, "comment_id": 83011392, "body": "see wat I wrote about dependencies, sass-listen is one of them, you need to download them as well and put them in the same folder, the easiest thing to do is first install the gem on a normal to the internet connected pc, copy the list of gems that are installed as well and copy these gems to your server behind the firewall"}, {"owner": {"reputation": 25, "user_id": 8676501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvJMP.jpg?s=128&g=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/8676501/ryan-c"}, "edited": false, "score": 0, "creation_date": 1515003501, "post_id": 47989169, "comment_id": 83140435, "body": "This is a great answer and got me close. However, it still did not work for me due to corporate restrictions on my computer. My end goal is SASS, so I might explore another way to compile it. Thanks!"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": true, "score": 0, "last_activity_date": 1514365139, "creation_date": 1514365139, "answer_id": 47989169, "question_id": 47981084, "link": "https://stackoverflow.com/questions/47981084/can-rubys-sass-gem-be-manually-installed/47989169#47989169", "title": "Can Ruby&#39;s Sass gem be manually installed?", "body": "<p>I'm in the same position and use two techniques</p>\n\n<ol>\n<li><p>through the firewall\nSee my answer at <a href=\"https://stackoverflow.com/questions/1903005/installing-gems-from-behind-a-corporate-firewall/9021630?s=1%7C97.4893#9021630\">installing-gems-from-behind-a-corporate-firewall</a></p></li>\n<li><p>from a local file</p></li>\n</ol>\n\n<p>You download the gem from <a href=\"https://rubygems.org/downloads/sass-3.5.4.gem\" rel=\"nofollow noreferrer\">https://rubygems.org/downloads/sass-3.5.4.gem</a>\nYou can put the file in your ruby\\bin folder and delete it later.</p>\n\n<p>Then you cd to your bin folder and install it in the console with the command</p>\n\n<pre><code>gem install sass-3.5.4.gem --local\n</code></pre>\n\n<p>the 3.5.4 is the current version.\nIf there are dependencies (other gems) you need to first download them as wel.\nCan't see what these are because on this machine I'm still using Ruby MRI 1.9.3 and the current version of sass requires Ruby 2.0.0</p>\n\n<p>See also my answer here</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35555141/deploy-a-ruby-gem-local-without-using-git-or-internet-access/35581275?s=1%7C63.6473#35581275\">deploy-a-ruby-gem-local-without-using-git-or-internet-access</a></p>\n"}], "owner": {"reputation": 25, "user_id": 8676501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvJMP.jpg?s=128&g=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/8676501/ryan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 47989169, "answer_count": 1, "score": 1, "last_activity_date": 1514365139, "creation_date": 1514304969, "last_edit_date": 1514356036, "question_id": 47981084, "link": "https://stackoverflow.com/questions/47981084/can-rubys-sass-gem-be-manually-installed", "title": "Can Ruby&#39;s Sass gem be manually installed?", "body": "<p>I work inside a corporate firewall. I am using Windows 10 and have the Ruby 2.4 x64 install.</p>\n\n<p>I need to get the sass gem. I cannot do it through the command line because all external calls such as this are blocked and will not be unblocked for my situation. Is there a place I can manually download the sass gem, and then issue the command to install the gem from a local file?</p>\n"}, {"tags": ["ruby", "memoization"], "answers": [{"tags": [], "owner": {"reputation": 13349, "user_id": 224334, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bfeafb6026cbf6128309744296c6d726?s=128&d=identicon&r=PG", "display_name": "RyanWilcox", "link": "https://stackoverflow.com/users/224334/ryanwilcox"}, "is_accepted": false, "score": 2, "last_activity_date": 1514305975, "creation_date": 1514305975, "answer_id": 47981259, "question_id": 47980896, "link": "https://stackoverflow.com/questions/47980896/why-is-an-instance-variable-used-instead-of-a-local-variable-in-a-module/47981259#47981259", "title": "Why is an instance variable used instead of a local variable in a module?", "body": "<blockquote>\n  <p>@current_user ||= User.find_by id: session[:user_id]</p>\n</blockquote>\n\n<p>This is using some Ruby shortcuts here, so let's expand to be this instead:</p>\n\n<pre><code> if @current_user == nil\n   @current_user = User.find_by id: session[:user_id]\n end\n\n return @current_user\n</code></pre>\n\n<p>Ok, great. But this database lookup could actually take a long time (say tens of milliseconds per each time we call it.). Which might not feel like a long time, but it will eventually add up - Rails apps call the current user a lot (only requesting once vs dozens of times also reduces load on your database server). (Absent of any kind of caching ActiveRecord and Rails is doing behind your back that is...</p>\n\n<p>So we save the results into an instance variable we have for later.</p>\n\n<p>So if you did something like this instead, in your current_user method</p>\n\n<pre><code>if my_current_user\n  my_current_user = User.find_by id: session[:user_id]\nend\n\nreturn my_current_user\n</code></pre>\n\n<p>This will always go into that <code>if</code> statement, always do the lookup, put the answer in a local and return it. Next time it has no knowledge it's already looked it up, so will do the same database query again, getting the result, etc etc. So it may work, but it'll be slower than using an instance variable here.</p>\n\n<p>There is a disadvantage, of course. Modules in Ruby can be imported into classes - the methods in the module become methods of the class. So yes, now you have created an instance variable for all the classes that import your module. This is... probably not entirely kind (what if some other module also uses that name??), but ehhhhhhhhhhh.... in a small beginner codebase it won't matter.</p>\n"}, {"tags": [], "owner": {"reputation": 5358, "user_id": 2399861, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/5fbe887e0a643cd477ba3f14fa528f84?s=128&d=identicon&r=PG", "display_name": "Ruby Racer", "link": "https://stackoverflow.com/users/2399861/ruby-racer"}, "is_accepted": true, "score": 0, "last_activity_date": 1514308264, "creation_date": 1514308264, "answer_id": 47981609, "question_id": 47980896, "link": "https://stackoverflow.com/questions/47980896/why-is-an-instance-variable-used-instead-of-a-local-variable-in-a-module/47981609#47981609", "title": "Why is an instance variable used instead of a local variable in a module?", "body": "<p>This roughly means that if <code>@current_user</code>, as an instance variable of global request/response scope (Controller/View/Helpers), has already been defined, use it as <code>current_user</code>. Otherwise, assign it the user that corresponds to the id stored in the session do what you do.</p>\n\n<p>In other words, this is similar to:</p>\n\n<pre><code>def current_user\n    if @current_user # this will be false in every hit, for the same request\n        @current_user\n    else\n        User.find_by id: session[:user_id]\n    end\nend\n</code></pre>\n\n<p>And this should be enough.</p>\n\n<p>But then, you may use again <code>current_user</code> in some other part of the code, let's say in the controller, for the same request. </p>\n\n<p>This means, that <code>current_user</code> will have to hit the DB again (caching aside). And you would like to avoid that, if you can. So, why not store the user in a global instance variable?</p>\n\n<p>Thus:</p>\n\n<pre><code>def current_user\n    if @current_user # this will be false for the first hit, true for every subsequent request\n        @current_user \n    else\n        @current_user = User.find_by id: session[:user_id]\n    end\nend\n</code></pre>\n\n<p>And since we do this, why not use the shorthand method for it? </p>\n\n<p>So, finally:</p>\n\n<pre><code>def current_user\n    @current_user ||= User.find_by id: session[:user_id]\nend\n</code></pre>\n\n<p>The answer is, you do this for reusability shake, within the same request/response.</p>\n"}], "owner": {"reputation": 69, "user_id": 9087151, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1903189199708362/picture?type=large", "display_name": "Tr\u1ea7n H\u1ed3ng", "link": "https://stackoverflow.com/users/9087151/tr%e1%ba%a7n-h%e1%bb%93ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 47981609, "answer_count": 2, "score": -1, "last_activity_date": 1514454206, "creation_date": 1514303796, "last_edit_date": 1514454206, "question_id": 47980896, "link": "https://stackoverflow.com/questions/47980896/why-is-an-instance-variable-used-instead-of-a-local-variable-in-a-module", "title": "Why is an instance variable used instead of a local variable in a module?", "body": "<p>I saw this code for a Ruby on Rails application:</p>\n\n<pre><code>module SessionsHelper\n  def current_user\n    @current_user ||= User.find_by id: session[:user_id]\n  end\n\n  ...\nend\n</code></pre>\n\n<p>Why is an instance variable used instead of a local variable in <code>current_user</code> method? When I change it to a local variable, everything is the same as using an instance variable.</p>\n\n<p>I read that an instance variable can be used in many other classes that include this module. But in this case, they are defined in <code>current_user</code> method for storing the user's value <code>@current_user</code>. How is this used in many other classes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 0, "last_activity_date": 1514303303, "creation_date": 1514303303, "answer_id": 47980815, "question_id": 47979611, "link": "https://stackoverflow.com/questions/47979611/ruby-on-rails-4-bundle-install-grape-jbuilder/47980815#47980815", "title": "ruby on rails 4 -- bundle install grape-jbuilder", "body": "<p>From <a href=\"https://github.com/rails/rails/issues/14115#issuecomment-35873914\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>Actually it's spring which cause this issue. Try to comment it in the\n  Gemfile, then bundle install and restart the server ; shutting it\n  down, the warning is not present anymore.</p>\n</blockquote>\n"}], "owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514303303, "creation_date": 1514296671, "last_edit_date": 1514297096, "question_id": 47979611, "link": "https://stackoverflow.com/questions/47979611/ruby-on-rails-4-bundle-install-grape-jbuilder", "title": "ruby on rails 4 -- bundle install grape-jbuilder", "body": "<p>After I installed gem grape-jbuilder<br>\nand run <code>bundle exec rails s</code> it showed this message</p>\n\n<pre><code>\nbin/rails:6: warning: already initialized constant APP_PATH            \n/Users/xxx/xxx/bin/rails:6: warning: previous definition of APP_PATH was \nhere                                                       \nUsage: rails COMMAND [ARGS]\n\nThe most common rails commands are:                                    \n generate    Generate new code (short-cut alias: \"g\")                  \n console     Start the Rails console (short-cut alias: \"c\")            \n server      Start the Rails server (short-cut alias: \"s\")             \n dbconsole   Start a console for the database specified in config/database.yml                                                                 \n             (short-cut alias: \"db\")                                   \n new         Create a new Rails application. \"rails new my_app\" creates a                                                                      \n             new application called MyApp in \"./my_app\"                \n\nIn addition to those, there are:   \n destroy      Undo code generated with \"generate\" (short-cut alias: \"d\")                                                                       \n plugin new   Generates skeleton for developing a Rails plugin         \n runner       Run a piece of code in the application environment (short-cut alias: \"r\")                                                        \n\nAll commands can be run with -h (or --help) for more information.         \n</code></pre>\n\n<p>And when I run <code>bundle exec rake rails:update:bin</code>\nIt show the error message below</p>\n\n<p><pre><code>\nrake aborted!\nLoadError: cannot load such file -- hashie/hash\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.4/lib/active_support/dependencies.rb:274:in <code>require'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.4/lib/active_support/dependencies.rb:274:in</code>block in require'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.4/lib/active_support/dependencies.rb:240:in <code>load_dependency'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.4/lib/active_support/dependencies.rb:274:in</code>require'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/grape-jbuilder-0.2.0/lib/grape/jbuilder.rb:2:in <code>&lt;top (required)&gt;'\n/Users/xxx/xxx/config/application.rb:7:in</code>'\n/Users/xxx/xxx/Rakefile:4:in <code>require'\n/Users/xxx/xxx/Rakefile:4:in</code>'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/exe/rake:27:in <code>&lt;top (required)&gt;'\n/Users/xxx/.rbenv/versions/2.3.1/bin/bundle:23:in</code>load'\n/Users/xxx/.rbenv/versions/2.3.1/bin/bundle:23:in <code>&lt;main&gt;'\nLoadError: cannot load such file -- grape-jbuilder\n/Users/xxx/xxx/config/application.rb:7:in</code>'\n/Users/xxx/xxx/Rakefile:4:in <code>require'\n/Users/xxx/xxx/Rakefile:4:in</code>'\n/Users/xxx/xxx/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/exe/rake:27:in <code>&lt;top (required)&gt;'\n/Users/xxx/.rbenv/versions/2.3.1/bin/bundle:23:in</code>load'\n/Users/jiaping/.rbenv/versions/2.3.1/bin/bundle:23:in `'\n(See full trace by running task with --trace)\n</pre></code></p>\n\n<p>Gemfile</p>\n\n<p><pre><code>\ngem 'rails', '4.2.4'\ngem 'rack-contrib'\ngem 'sdoc', '~> 0.4.0', group: :doc\ngem 'therubyracer'\ngem 'rb-readline'\ngem 'jquery-rails'\ngem 'jquery-ui-rails'\ngem 'bootstrap-sass'\ngem 'font-awesome-rails'\ngem 'react-rails'\ngem 'coffee-rails', '~> 4.1.0'\ngem 'uglifier', '>= 1.3.0'\ngem 'sass-rails'\ngem 'momentjs-rails'\ngem 'bootstrap3-datetimepicker-rails'\ngem 'jquery-payment-rails', git: '<a href=\"https://github.com/thoughtbot/jquery-payment-rails.git\" rel=\"nofollow noreferrer\">https://github.com/thoughtbot/jquery-payment-rails.git</a>'\ngem 'page_title_helper'\ngem 'sprockets-es6', require: 'sprockets/es6'\ngem 'jbuilder', '~> 2.0'\ngem 'sorcery'\ngem 'oauth2', '~> 1.3.0'\ngem 'bcrypt'\ngem 'dotenv-rails'\ngem 'config', '~> 1.0.0'\ngem 'enum_help'\ngem 'mysql2', '~> 0.3.18'\ngem 'squeel'\ngem 'seed-fu'\ngem 'carrierwave'\ngem 'carrierwave-data-uri'\ngem 'carrierwave-aws'\ngem 'rmagick'\ngem 'acts_as_list'\ngem 'kaminari'\ngem 'ransack'\ngem 'rails-jquery-autocomplete'\ngem 'gretel'\ngem 'email_validator'\ngem 'icalendar'\ngem 'bootstrap_form'\ngem 'paranoia', '~> 2.0'\ngem 'unicorn'\ngem 'unicorn-rails'\ngem 'unicorn-worker-killer'\ngem 'google-analytics-rails'\ngem 'meta-tags'\ngem 'web-console', '~> 2.0', group: :development\ngem 'adminlte2-rails'\ngem 'geocoder'\ngem 'validates_timeliness', '~> 4.0'\ngem 'stripe', :git => '<a href=\"https://github.com/stripe/stripe-ruby\" rel=\"nofollow noreferrer\">https://github.com/stripe/stripe-ruby</a>'\ngem 'whenever', require: false\ngem 'holiday_jp'\ngem 'exception_notification', github: 'smartinez87/exception_notification'\ngem 'slack-notifier'\ngem 'grape'\ngem 'grape-jbuilder'</p>\n\n<p>group :staging do\n  gem 'letter_opener_web'\nend\ngroup :development, :test do\n  gem 'letter_opener'\n  gem 'spring'\n  gem 'spring-commands-rspec'\n  gem 'rspec-rails'\n  gem 'factory_girl_rails'\n  gem 'simplecov', require: false\n  gem 'rubocop'\n  gem 'byebug'\n  gem 'better_errors'\n  gem 'pry'\n  gem 'pry-byebug'\n  gem 'pry-doc'\n  gem 'pry-rails'\n  gem 'pry-stack_explorer'\n  gem 'quiet_assets'\n  gem 'awesome_print'\n  gem 'annotate'\n  gem 'migration_comments'\n  gem 'capistrano', '~> 3.4.0'\n  gem 'capistrano-rails'\n  gem 'capistrano-rbenv'\n  gem 'capistrano-bundler'\n  gem 'capistrano3-unicorn'\n  gem 'rails-admin-scaffold'\nend</p>\n\n<p>group :test do\n  gem 'capybara'\n  gem 'database_cleaner'\n  gem 'faker'\n  gem 'fuubar'\n  gem 'launchy'\n  gem 'selenium-webdriver'\n  gem 'shoulda-matchers'\n  gem 'timecop'\nend\n</pre></code></p>\n\n<p>How can I solve this problem? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm", "graph", "ruby-rgl"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1514295270, "post_id": 47979061, "comment_id": 82927306, "body": "&quot;I am able to find the shortest path using the Dijkstras Shortest Path Algorithm from the gem&quot; - So, i would suggest look into the gem <code>rgl</code> implementation. May be they calculate all possible paths before finding the shortest path. May be. I don&#39;t have much idea about Dijkstra&#39;s."}, {"owner": {"reputation": 421, "user_id": 2473275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20777f23254acdc35a5f9de0f14fd8a3?s=128&d=identicon&r=PG", "display_name": "Jami Couch", "link": "https://stackoverflow.com/users/2473275/jami-couch"}, "edited": false, "score": 0, "creation_date": 1514307104, "post_id": 47979061, "comment_id": 82931322, "body": "Dijkstra&#39;s algorithm is for specifically finding the shortest path. It does not calculate all paths. I don&#39;t know if there are any shortcuts to finding all paths...that sounds like a necessarily slow operation on large graphs. Related: <a href=\"https://stackoverflow.com/a/9535898/2473275\">stackoverflow.com/a/9535898/2473275</a>"}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1514376009, "post_id": 47979061, "comment_id": 82951772, "body": "@JagdeepSingh nope, as mentioned by Jami Couch, it doesn&#39;t calculate all paths."}, {"owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "reply_to_user": {"reputation": 421, "user_id": 2473275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20777f23254acdc35a5f9de0f14fd8a3?s=128&d=identicon&r=PG", "display_name": "Jami Couch", "link": "https://stackoverflow.com/users/2473275/jami-couch"}, "edited": false, "score": 0, "creation_date": 1514376209, "post_id": 47979061, "comment_id": 82951867, "body": "Thanks @JamiCouch for the related post, it seems to be a np hard problem. I am still being optimistic that there should be 1 hack/work around method where it can be achieved. I don&#39;t know, maybe, calling dijkstra&#39;s with variation in weights may result in different path..maybe..just thinking on those lines now.."}], "answers": [{"tags": [], "owner": {"reputation": 2815, "user_id": 8592647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b767a670f36224da825fc41092e5934e?s=128&d=identicon&r=PG&f=1", "display_name": "SaiBot", "link": "https://stackoverflow.com/users/8592647/saibot"}, "is_accepted": false, "score": 0, "last_activity_date": 1514893930, "creation_date": 1514893930, "answer_id": 48060480, "question_id": 47979061, "link": "https://stackoverflow.com/questions/47979061/efficiently-finding-all-paths-between-2-nodes-in-a-directed-graph-rgl-gem/48060480#48060480", "title": "Efficiently Finding all paths between 2 nodes in a directed graph - RGL Gem", "body": "<p>The main problem is that the number of paths between two nodes grows exponentially in the number of overall nodes. Thus any algorithm finding all paths between two nodes, will be very slow on larger graphs. </p>\n\n<p><strong>Example:</strong></p>\n\n<p>As an example imagine a grid of n x n nodes each connected to their 4 neighbors. Now you want to find all paths from the bottom left node to the top right node. Even when you only allow for moves to the right (r) and moves up (u) your resulting paths can be described by any string of length 2n with equal number of (r)'s and (u)'s. This will give you \"2n choose n\" number of possible paths (ignoring other moves and cycles)  </p>\n"}], "owner": {"reputation": 5727, "user_id": 6548745, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ohYaFCalmPo/AAAAAAAAAAI/AAAAAAAAC9Y/Uamy4dkGW_0/photo.jpg?sz=128", "display_name": "Md. Farhan Memon", "link": "https://stackoverflow.com/users/6548745/md-farhan-memon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514893930, "creation_date": 1514293523, "last_edit_date": 1514293903, "question_id": 47979061, "link": "https://stackoverflow.com/questions/47979061/efficiently-finding-all-paths-between-2-nodes-in-a-directed-graph-rgl-gem", "title": "Efficiently Finding all paths between 2 nodes in a directed graph - RGL Gem", "body": "<p>I am struggling to find 1 efficient algorithm which will give me all possible paths between 2 nodes in a directed graph.</p>\n\n<p>I found <a href=\"https://github.com/monora/rgl\" rel=\"nofollow noreferrer\">RGL gem</a>, fastest so far in terms of calculations. I am able to find the shortest path using the <code>Dijkstras Shortest Path Algorithm</code> from the gem.</p>\n\n<p>I googled, inspite of getting many solutions (ruby/non-ruby), either couldn't convert the code or the code is taking forever to calculate (inefficient).</p>\n\n<p>I am here primarily if someone can suggest to find all paths using/tweaking various algorithms from <code>RGL</code> gem itself (if possible) or some other efficient way.</p>\n\n<p>Input of directed graph can be an array of arrays..</p>\n\n<p><code>[[1,2], [2,3], ..]</code></p>\n\n<p>P.S. : Just to avoid negative votes/comments, unfortunately I don't have inefficient code snippet to show as I discarded it days ago and didn't save it anywhere for the record or reproduce here.</p>\n"}, {"tags": ["ruby", "rspec", "jruby"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 6213176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5524a528bd15219e53c4ad75e1408bcd?s=128&d=identicon&r=PG&f=1", "display_name": "Noobie", "link": "https://stackoverflow.com/users/6213176/noobie"}, "edited": false, "score": 0, "creation_date": 1514289746, "post_id": 47978290, "comment_id": 82925380, "body": "Umm, when I query the record it does work <code>Admins::Setting.term_sbc_ip =&gt; #&lt;Admins::Setting:0x5edacf20  id: 2,  title: &quot;term-sbc-ips&quot;,  config: &quot;[{&#39;192.168.1.79&#39; =&gt; &#39;104.197.17.91&#39;},{&#39;192.168.1.42&#39; =&gt; &#39;104.196.101.235&#39;}]&quot;,  created_at: &quot;2017-12-26T12:01:11.808Z&quot;,  updated_at: &quot;2017-12-26T12:01:11.808Z&quot;&gt;</code>"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "reply_to_user": {"reputation": 197, "user_id": 6213176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5524a528bd15219e53c4ad75e1408bcd?s=128&d=identicon&r=PG&f=1", "display_name": "Noobie", "link": "https://stackoverflow.com/users/6213176/noobie"}, "edited": false, "score": 0, "creation_date": 1514290120, "post_id": 47978290, "comment_id": 82925522, "body": "try without any record in the database, as in your tests, it returns an array, but you&#39;re expecting <code>nil</code>."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 1, "last_activity_date": 1514289255, "creation_date": 1514289255, "answer_id": 47978290, "question_id": 47978179, "link": "https://stackoverflow.com/questions/47978179/unable-to-pass-the-following-rspec/47978290#47978290", "title": "Unable to pass the following rspec", "body": "<p>The <code>scope</code> method in the Rails(ActiveRecord) always returns an array(AR collection), no matter what are you setting <code>.last</code> or <code>.first</code>.</p>\n\n<pre><code>scope :term_sbc_ip, -&gt;  { where(title: 'term-sbc-ips'.freeze).first }\n                                                             ^^^^^# not works\n</code></pre>\n\n<p>So your specs are wrong, here is how it must be written: </p>\n\n<pre><code>it 'should return an empty array' do\n  record = Admins::Setting.term_sbc_ip.first\n  record.destroy\n  expect(Admins::Setting.term_sbc_ip).to eq([])\nend\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 6213176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5524a528bd15219e53c4ad75e1408bcd?s=128&d=identicon&r=PG&f=1", "display_name": "Noobie", "link": "https://stackoverflow.com/users/6213176/noobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47978290, "answer_count": 1, "score": 0, "last_activity_date": 1514289255, "creation_date": 1514288683, "last_edit_date": 1514289078, "question_id": 47978179, "link": "https://stackoverflow.com/questions/47978179/unable-to-pass-the-following-rspec", "title": "Unable to pass the following rspec", "body": "<pre><code>class Admins::Setting &lt; ActiveRecord::Base\n  serialize :config\n  scope :default_ip,  -&gt; ()  { where(title: 'default-route-ip'.freeze).first }\n  scope :term_sbc_ip, -&gt; ()  { where(title: 'term-sbc-ips'.freeze).first }\nend\n</code></pre>\n\n<hr>\n\n<pre><code>describe 'Admins::Setting' do\n   before(:each) do\n     Admins::Setting.create(title: 'default-route-ip', config: '192.168.1.65')\n     Admins::Setting.create(title: 'term-sbc-ips', config: \"[{'192.168.1.79' =&gt; '104.197.17.91'},{'192.168.1.42' =&gt; '104.196.101.235'}]\")\n   end \n\n   describe '#term_sbc_ip' do\n     context 'when terminating ip is not present' do\n      it 'should return nil' do\n        Admins::Setting.term_sbc_ip.destroy\n        expect(Admins::Setting.term_sbc_ip).to eq(nil)\n      end\n    end\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>When I run the following test I get the following error.</p>\n\n<pre><code>Failures:\n\n  1) Admins::Setting#term_sbc_ip when terminating ip is not present should return nil\n     Failure/Error: expect(Admins::Setting.term_sbc_ip).to eq(nil)\n\n       expected: nil\n            got: #&lt;ActiveRecord::Relation [#&lt;Admins::Setting id: 5, title: \"default-route-ip\", config: \"192.168.1.65\", created_at: \"2017-12-26 11:38:03\", updated_at: \"2017-12-26 11:38:03\"&gt;]&gt;\n\n       (compared using ==)\n     # ./spec/models/admins/setting_spec.rb:30:in `block in (root)\n</code></pre>\n\n<p>Note sure why when I delete the <code>term_sbc_ip</code> record the scope retrieve the <code>default-route-ip</code> object.</p>\n\n<p><strong>Rspec Version</strong>: <code>3.3.2</code></p>\n\n<p><strong>ActiveRecord</strong>: </p>\n\n<pre><code>  activerecord (4.2.0)\n\n  activerecord-jdbc-adapter (1.3.19)\n\n  activerecord-jdbcpostgresql-adapter (1.3.19)\n</code></pre>\n\n<p><strong>jruby</strong>: <code>9.0.5.0</code></p>\n\n<p><strong>rails</strong>: <code>No its not a rails application</code> </p>\n\n<p><strong>postgres</strong>: <code>9.5.9</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "get", "restful-authentication"], "comments": [{"owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "edited": false, "score": 0, "creation_date": 1514289034, "post_id": 47977940, "comment_id": 82925136, "body": "Is <code>QuestionsController</code> in api/v1/ folder?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1514291659, "post_id": 47977940, "comment_id": 82926064, "body": "you could paste the actual response JSON instead of the image."}, {"owner": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514292409, "post_id": 47977940, "comment_id": 82926328, "body": "I believe the <code>QuestionsController</code> is in the wrong directory. it should be in the <code>app&#47;controllers&#47;api&#47;v1&#47;</code> directory"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7302976, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3cf8cb323789e580d5973eaefd335642?s=128&d=identicon&r=PG&f=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/7302976/paddy"}, "edited": false, "score": 0, "creation_date": 1514294803, "post_id": 47978340, "comment_id": 82927113, "body": "Thats exactly what I have. But my file name is QuestionController. I just started learning ruby, could the file name be the problem The location of the file is the same as you said.  config/routes.rb, and app/controllers/api/v1/QuestionsController.rb. I am sending a request to <a href=\"http://localhost:3000/api/v1/questions\" rel=\"nofollow noreferrer\">localhost:3000/api/v1/questions</a>"}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "reply_to_user": {"reputation": 113, "user_id": 7302976, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3cf8cb323789e580d5973eaefd335642?s=128&d=identicon&r=PG&f=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/7302976/paddy"}, "edited": false, "score": 0, "creation_date": 1514295528, "post_id": 47978340, "comment_id": 82927392, "body": "@paddy Rails is a convention-over-configuration framework. Filename is preferably lower case. Here is some great [docs] <a href=\"http://guides.rubyonrails.org/layouts_and_rendering.html#rendering-by-default-convention-over-configuration-in-action\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a>)"}, {"owner": {"reputation": 113, "user_id": 7302976, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3cf8cb323789e580d5973eaefd335642?s=128&d=identicon&r=PG&f=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/7302976/paddy"}, "edited": false, "score": 0, "creation_date": 1514296285, "post_id": 47978340, "comment_id": 82927645, "body": "Thanks. Any chance you could suggest me any fixes for my code?  <a href=\"https://www.youtube.com/watch?v=QojnRc7SS9o\" rel=\"nofollow noreferrer\">youtube.com/watch?v=QojnRc7SS9o</a> This is the guy I was following. Tried to use my own thing that I wanted to code. I did it without checking with PHPAdmin though. Could it be an issue with my database?"}, {"owner": {"reputation": 113, "user_id": 7302976, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3cf8cb323789e580d5973eaefd335642?s=128&d=identicon&r=PG&f=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/7302976/paddy"}, "edited": false, "score": 0, "creation_date": 1514299814, "post_id": 47978340, "comment_id": 82928832, "body": "I finally got it omg. Not sure what was wrong. Just did it from the start. Thanks everyone above. I think it was a matter of restarting my Postman. Just need to make a error handling thing now (To throw an error if its out of range)"}], "tags": [], "owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1514289789, "last_edit_date": 1514289789, "creation_date": 1514289528, "answer_id": 47978340, "question_id": 47977940, "link": "https://stackoverflow.com/questions/47977940/ruby-rails-getting-404-not-found-on-http-get-request/47978340#47978340", "title": "Ruby Rails getting 404 Not found on HTTP GET Request", "body": "<p>I used your code, no errors happen. My code is</p>\n\n<p>config/routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  namespace 'api' do\n    namespace 'v1' do\n      resources :questions\n    end\n  end\nend\n</code></pre>\n\n<p>app/controllers/api/v1/questions_controller.rb</p>\n\n<pre><code>module Api\n  module V1\n    class QuestionsController &lt; ApplicationController\n      def index\n        #questions = Question.order('created_at DESC');\n        render json: {status: 'SUCCESS', message:' Loaded Questions', data: 'data'}, status: :ok\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I think you may get your paths wrong.</p>\n"}], "owner": {"reputation": 113, "user_id": 7302976, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3cf8cb323789e580d5973eaefd335642?s=128&d=identicon&r=PG&f=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/7302976/paddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514289789, "creation_date": 1514287595, "last_edit_date": 1514289343, "question_id": 47977940, "link": "https://stackoverflow.com/questions/47977940/ruby-rails-getting-404-not-found-on-http-get-request", "title": "Ruby Rails getting 404 Not found on HTTP GET Request", "body": "<p>I am trying my hand at Ruby Rails. I am trying to render my Database in JSON Format. For some reason whenever I send a GET request from Postman I keep getting a routing error. When I type in \"rails routes\", I get proper routes. Image of which is defined below.\nCode for my route.db is given below and screenshot of the error. I would be grateful if someone could guide me on this.</p>\n\n<p>Code for routes.db</p>\n\n<pre><code>Rails.application.routes.draw do\n\n namespace 'api' do\n  namespace 'v1' do\n   resources :questions\n  end\n end\nend\n</code></pre>\n\n<p>Code for Controller</p>\n\n<pre><code>module Api\n module V1\n  class QuestionsController &lt; ApplicationController\n   def index\n    questions = Question.order('created_at DESC');\n    render json: {status: 'SUCCESS', message:' Loaded Questions', data: questions}, status: :ok\n   end\n  end\n end\nend\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/5XiRF.png\" alt=\"Image of Error I am getting\"></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "elasticsearch", "where"], "comments": [{"owner": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514292662, "post_id": 47977917, "comment_id": 82926407, "body": "does <code>deleted_at: nil</code> means <code>inactive: true</code> here ?"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514293440, "post_id": 47977917, "comment_id": 82926640, "body": "No. If account is deleted then <code>deleted_at is not NULL</code> and <code>inactive: true</code>. If account is active then <code>deleted_at is NULL</code> and <code>inactive: false</code>."}, {"owner": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514298361, "post_id": 47977917, "comment_id": 82928337, "body": "so you&#39;re trying to get records with <code>inactive: true</code> and <code>deleted_at: nil</code>. this seems pretty opposite condition. I think it should be inactive true and deleted_at is not nil. and if you&#39;re looking for active records then it should be inactive false and deleted_at is nil. let me know if I am understanding it wrong"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514353171, "post_id": 47977917, "comment_id": 82942527, "body": "Yes. You are right. If I try with <code>where: {inactive: false, deleted_at: nil}</code> then I am getting an error like <code>Searchkick::InvalidQueryError ([400] {&quot;error&quot;:{&quot;root_cause&quot;:[{&quot;type&quot;:&quot;query_shard_exception&quot;,&quot;rea&zwnj;&#8203;son&quot;:&quot;failed to create query: {\\n  \\&quot;bool\\&quot; ...</code>"}, {"owner": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514376919, "post_id": 47977917, "comment_id": 82952204, "body": "can you show the full exception ?"}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "reply_to_user": {"reputation": 182, "user_id": 6071580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3d669f89b8f9c0fd29c068969ad569?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/6071580/kushal"}, "edited": false, "score": 0, "creation_date": 1514379608, "post_id": 47977917, "comment_id": 82953402, "body": "Now I am trying with string field instead of boolean. So I have raised separate question <a href=\"https://stackoverflow.com/questions/47992634/rails-how-to-filter-a-string-field-in-searchkick\" title=\"rails how to filter a string field in searchkick\">stackoverflow.com/questions/47992634/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 8608623, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vT47uFvmnRo/AAAAAAAAAAI/AAAAAAAABBI/LfctXKOBBRY/photo.jpg?sz=128", "display_name": "Suvarna Swami", "link": "https://stackoverflow.com/users/8608623/suvarna-swami"}, "edited": false, "score": 1, "creation_date": 1514615662, "post_id": 47977917, "comment_id": 83033338, "body": "Refer this for the answer- <a href=\"https://stackoverflow.com/questions/47977917/rails-how-to-add-more-fields-for-filter-in-searchkick\" title=\"rails how to add more fields for filter in searchkick\">stackoverflow.com/questions/47977917/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1514288867, "post_id": 47978080, "comment_id": 82925081, "body": "Again same zero results. Also I have tried by <code>reindex()</code> the model, but same issue."}], "tags": [], "owner": {"reputation": 5998, "user_id": 1172125, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82b341477c74888442fe70db563dac26?s=128&d=identicon&r=PG", "display_name": "Bengineer", "link": "https://stackoverflow.com/users/1172125/bengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514288285, "creation_date": 1514288285, "answer_id": 47978080, "question_id": 47977917, "link": "https://stackoverflow.com/questions/47977917/rails-how-to-add-more-fields-for-filter-in-searchkick/47978080#47978080", "title": "Rails - How to add more fields for filter in searchkick?", "body": "<p>Actually, the fields used in the <code>where</code> clause are indexed differently.\nYou have to define those fields as <code>filterable</code>:</p>\n\n<pre><code>searchkick word_start: [:name], filterable: [:active, :inactive, :deleted_at]\n</code></pre>\n\n<p>This should work.</p>\n\n<p>BTW: You don't need both \"active\" and \"inactive\" attributes. If the \"active\" attribute is false, you know it is inactive.</p>\n"}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 499, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514288285, "creation_date": 1514287489, "question_id": 47977917, "link": "https://stackoverflow.com/questions/47977917/rails-how-to-add-more-fields-for-filter-in-searchkick", "title": "Rails - How to add more fields for filter in searchkick?", "body": "<p>In rails, I am using <code>searchkick</code> gem for search. When I am adding more fields for where clause then returning zero results.</p>\n\n<p>Actually search is working for below method(User.rb), </p>\n\n<pre><code>searchkick word_start: [:name]\n\ndef initialize(name, limit = User::SUGGESTION_LIMIT, page = nil)\n  @name = name\n  @limit = limit\n  @page = page\n  @per_page = limit.to_i\nend\n\nquery = {\n    match: :word_start,\n    fields: [{ emails: \"exact\" }, \"name^5\"],\n    misspellings: { prefix_length: 2 },\n    load: false\n}\n\nUser.search(name, query).records\n</code></pre>\n\n<p>When I add condition like <code>where: {active: false, inactive: true, deleted_at: nil}</code> it returns no data.</p>\n\n<pre><code>query = {\n    match: :word_start,\n    where: {active: false, inactive: true, deleted_at: nil},\n    fields: [{ emails: \"exact\"}, \"name^5\"],\n    misspellings: { prefix_length: 2 },\n    load: false\n}\n</code></pre>\n\n<p>Is there any mistake in above <code>where</code> condition? Please help me to solve this issue. I am using this gem for the first time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "net-sftp"], "answers": [{"comments": [{"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514357047, "post_id": 47982135, "comment_id": 82943785, "body": "Yes, you are right, I&#39;m logging in with different user. Secondly, I do use <code>file_data</code>, but I didn&#39;t post that code as it was not relevant to the context, my focus is to delete file from SFTP server."}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514357201, "post_id": 47982135, "comment_id": 82943841, "body": "My main intention is to delete the file from SFTP server so that I don&#39;t read it again."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 1, "creation_date": 1514377631, "post_id": 47982135, "comment_id": 82952540, "body": "By the way, Ruby provides <code>File.read</code> and <code>File.readlines</code> methods that eliminate the need to explicitly open the file."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514377697, "post_id": 47982135, "comment_id": 82952571, "body": "@Abhi You did not address my suggestions. Do you have any questions about them?"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514462297, "post_id": 47982135, "comment_id": 82982292, "body": "I tried to set the permission of the files with the local user instead of <b>root</b>, but it didn&#39;t work. Also, I found this post bit helpful <a href=\"https://stackoverflow.com/a/1619146/2968762\">stackoverflow.com/a/1619146/2968762</a>. But, I had to use <code>sftp.send(:exec, &quot;rm full_path_to_#{source_file}&quot;)</code>, because <b>exec</b> a private method. And for some unknown reason after removing the first file, due to the above code, the loop breaks out without error. I&#39;m clueless."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514466458, "post_id": 47982135, "comment_id": 82984297, "body": "It would be helpful at this point for you to put your code up where we could see it. Using a gist (a single fragment of code or text, often containing the contents of a file) on Github is great for this; it color codes your code, and keeps history. If you don&#39;t have a Github id, I recommend registering for one, and then go to gist.github.com and adding a gist."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514466918, "post_id": 47982135, "comment_id": 82984508, "body": "If you are going to execute code on that server, I recommend using <code>ssh</code>, as that&#39;s one of its intended purposes (unlike sftp). Normally, <code>ssh</code> and <code>sftp</code> will normally put you in the home directory of the user with which you&#39;ve logged in. You don&#39;t really even need a library if your OS has <code>ssh</code> and <code>sftp</code> commands; you can build and execute an external command such as ` <code>ssh user@host rm #{filespec_to_delete}</code> `; though in general using a Ruby library is better when possible."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "edited": false, "score": 0, "creation_date": 1514466957, "post_id": 47982135, "comment_id": 82984530, "body": "Regarding my comment about a gist, posting the code here on Stack Overflow is better when possible. I mention a gist in case it&#39;s a <i>lot</i> of code."}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1514311591, "creation_date": 1514311591, "answer_id": 47982135, "question_id": 47977875, "link": "https://stackoverflow.com/questions/47977875/sftp-remove-permission-denied/47982135#47982135", "title": "SFTP remove permission denied", "body": "<p>I'll assume you are logging in to the remote host as a user other than root. Is this correct?</p>\n\n<p>Your problem is that root is the owner of those files on the remote host, and as a user other than root you are not authorized to delete them.</p>\n\n<p>If you are in control of the remote files, you might want to save them by a user other than root -- one whom you can log in as to delete them but one whom others cannot, assuming you don't want others to be able to delete files.</p>\n\n<p>If you log in to that server as root, you should be able to delete the files.</p>\n\n<p>Regarding this code:</p>\n\n<pre><code>df = File.open(destination_file, \"r\")\nfile_data = df.read\nFile.delete(df) # deleted from tmp\n</code></pre>\n\n<p>This is an overly complicated way to accomplish deleting the file. You are reading the file's data into <code>file_data</code> but not doing anything with it. Also, there is no need to open a file to delete it -- you can call <code>File.delete</code> on a filespec rather than a File object.</p>\n"}], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2641, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1514878293, "creation_date": 1514287283, "last_edit_date": 1514878293, "question_id": 47977875, "link": "https://stackoverflow.com/questions/47977875/sftp-remove-permission-denied", "title": "SFTP remove permission denied", "body": "<p>I'm using <a href=\"https://github.com/net-ssh/net-sftp\" rel=\"nofollow noreferrer\">SFTP</a> client for fetching files froma SFTP server. I'm able to successfully read the file and store it, but I'm unsable to delete it from SFTP server after I'm done saving it.</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>require 'net/sftp'\n\nclass Sftp\n  def self.save\n    Net::SFTP.start(somehost, ****, password: ****) do |sftp|\n      sftp.dir.foreach(\"/files\") do |entry|\n        next unless entry.file?\n\n        file_name = entry.name\n        source_file = \"/files/#{file_name}\"\n        destination_file = \"tmp/#{file_name}\"\n\n        sftp.download!(source_file, destination_file)\n\n        df = File.open(destination_file, \"r\")\n        file_data = df.read\n\n        # Some logic to utilise read file info. in variable \"file_data\"\n\n        File.delete(df) # deleted from tmp\n        sftp.remove!(source_file) # deleted from sftp server\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When the line <code>sftp.remove!(source_file)</code> is executed, I get error like:</p>\n\n<blockquote>\n  <p>\"Net::SFTP::StatusException (3, \\\"permission denied\\\")\"</p>\n</blockquote>\n\n<p>Permission for <strong>files</strong> directory</p>\n\n<pre><code>drwxr-xr-x  2 root    root    4096 Dec 22 10:54 files\n</code></pre>\n\n<p>Permission for files inside the <strong>files</strong> directory:</p>\n\n<pre><code>drwxr-xr-x 2 root root   4096 Dec 22 10:54 .\ndrwxr-xr-x 4 root root   4096 Dec 18 15:29 ..\n-rwxrwxrwx 1 root root 749199 Dec 18 14:39 a.pdf\n-rwxrwxrwx 1 root root   7945 Dec 18 15:41 b.pdf\n-rwxrwxrwx 1 root root   7945 Dec 22 10:54 c.pdf\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I replaced the following line of code</p>\n\n<pre><code>sftp.remove!(source_file)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>sftp.send(:exec, \"sudo rm /var/sftp/#{source_file}\")\n</code></pre>\n\n<p>Now, the removal works, but only for the first file. Then the loop exits without any error.</p>\n\n<p>What may be the reason?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 412, "user_id": 5947585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUkEe.jpg?s=128&g=1", "display_name": "Ishtiaque05", "link": "https://stackoverflow.com/users/5947585/ishtiaque05"}, "edited": false, "score": 0, "creation_date": 1514285029, "post_id": 47977321, "comment_id": 82923558, "body": "Point the active admin gem in gemfile to master branch and see if it resolves the issue."}, {"owner": {"reputation": 1133, "user_id": 4840615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObOwb.jpg?s=128&g=1", "display_name": "Gaurav Gupta", "link": "https://stackoverflow.com/users/4840615/gaurav-gupta"}, "reply_to_user": {"reputation": 412, "user_id": 5947585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUkEe.jpg?s=128&g=1", "display_name": "Ishtiaque05", "link": "https://stackoverflow.com/users/5947585/ishtiaque05"}, "edited": false, "score": 0, "creation_date": 1514285542, "post_id": 47977321, "comment_id": 82923794, "body": "Its still not working :("}, {"owner": {"reputation": 412, "user_id": 5947585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mUkEe.jpg?s=128&g=1", "display_name": "Ishtiaque05", "link": "https://stackoverflow.com/users/5947585/ishtiaque05"}, "edited": false, "score": 0, "creation_date": 1514285981, "post_id": 47977321, "comment_id": 82923970, "body": "Did you use devise with active admin then point it to the master branch too."}, {"owner": {"reputation": 480, "user_id": 7268990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9444ee428f6a19a3ff4d47d6ac73773d?s=128&d=identicon&r=PG", "display_name": "Iulian Dogariu", "link": "https://stackoverflow.com/users/7268990/iulian-dogariu"}, "edited": false, "score": 0, "creation_date": 1514293654, "post_id": 47977321, "comment_id": 82926712, "body": "Please post your Gemfile and also a stack trace of the error"}, {"owner": {"reputation": 865, "user_id": 2034261, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EfGmY.png?s=128&g=1", "display_name": "Bengala", "link": "https://stackoverflow.com/users/2034261/bengala"}, "edited": false, "score": 0, "creation_date": 1517446881, "post_id": 47977321, "comment_id": 84104051, "body": "Hey @GauravGupta did you manage to fix this?"}, {"owner": {"reputation": 1133, "user_id": 4840615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObOwb.jpg?s=128&g=1", "display_name": "Gaurav Gupta", "link": "https://stackoverflow.com/users/4840615/gaurav-gupta"}, "reply_to_user": {"reputation": 865, "user_id": 2034261, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EfGmY.png?s=128&g=1", "display_name": "Bengala", "link": "https://stackoverflow.com/users/2034261/bengala"}, "edited": false, "score": 0, "creation_date": 1517837457, "post_id": 47977321, "comment_id": 84243990, "body": "@Bengala bundle update worked for me."}], "answers": [{"tags": [], "owner": {"reputation": 32, "user_id": 8378322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17240c7ad10f9053e586f18e2d1214bd?s=128&d=identicon&r=PG&f=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/8378322/parry"}, "is_accepted": false, "score": 0, "last_activity_date": 1514297435, "creation_date": 1514297435, "answer_id": 47979761, "question_id": 47977321, "link": "https://stackoverflow.com/questions/47977321/undefined-method-alias-method-chain-after-upgrading-rails/47979761#47979761", "title": "undefined method `alias_method_chain&#39; after upgrading rails", "body": "<p><code>alias_method_chain</code> has been deprecated in rails 5. Try updating the <code>activeadmin</code> gem using <code>bundle update activeadmin</code></p>\n"}], "owner": {"reputation": 1133, "user_id": 4840615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ObOwb.jpg?s=128&g=1", "display_name": "Gaurav Gupta", "link": "https://stackoverflow.com/users/4840615/gaurav-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1702, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514297435, "creation_date": 1514284663, "question_id": 47977321, "link": "https://stackoverflow.com/questions/47977321/undefined-method-alias-method-chain-after-upgrading-rails", "title": "undefined method `alias_method_chain&#39; after upgrading rails", "body": "<p>I just updated my rails from 4.2 to 5.1.4, I successfully update the rails version and gem dependencies but after running server I am getting following error.</p>\n\n<pre><code>Bundler::GemRequireError: There was an error while trying to load the gem 'activeadmin'.\nGem Load Error is: undefined method `alias_method_chain' for  #&lt;Class:ActiveRecord::Associations::JoinDependency&gt;\nDid you mean?  alias_method\n</code></pre>\n\n<p>Any body help me what I am missing here and why I am getting this error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "web", "model-view-controller"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 2, "last_activity_date": 1514282705, "creation_date": 1514282705, "answer_id": 47976882, "question_id": 47976816, "link": "https://stackoverflow.com/questions/47976816/why-is-wrong-redirecting/47976882#47976882", "title": "Why is wrong redirecting?", "body": "<p>Rails routes are matched in the order they are specified, so if you have a <code>resources :tasks</code> above a get <code>'task/:id'</code> the show action's route for the resources line will be matched before the get line. </p>\n\n<p>Try to change the endpoint, for example:</p>\n\n<pre><code>get 'change_to_done/:id', to: 'tasks#change_to_done', as: 'change_to_done'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1514282936, "creation_date": 1514282936, "answer_id": 47976949, "question_id": 47976816, "link": "https://stackoverflow.com/questions/47976816/why-is-wrong-redirecting/47976949#47976949", "title": "Why is wrong redirecting?", "body": "<p>You might have <code>resources :tasks</code> in your routes file. Rails resolves this, and ignore <code>get 'tasks/:id', to: 'tasks#change_to_done', as: 'change_to_done'</code> this route. You should specify the exact action <code>get 'tasks/:id/change_to_done', to: 'tasks#change_to_done', as: 'change_to_done'</code></p>\n"}], "owner": {"reputation": 29, "user_id": 5322249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2696e5ddc8dbd02d1850823390235a21?s=128&d=identicon&r=PG", "display_name": "asda111sd", "link": "https://stackoverflow.com/users/5322249/asda111sd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 47976882, "answer_count": 2, "score": 1, "last_activity_date": 1514284001, "creation_date": 1514282414, "last_edit_date": 1514284001, "question_id": 47976816, "link": "https://stackoverflow.com/questions/47976816/why-is-wrong-redirecting", "title": "Why is wrong redirecting?", "body": "<p>Have model with tasks they are done and todo. In view have link and when click the link it must change task from todo to done. It's my routes</p>\n\n<pre><code>get 'tasks/:id', to: 'tasks#change_to_done', as: 'change_to_done'\n</code></pre>\n\n<p>my view</p>\n\n<pre><code>&lt;% unless task.done %&gt;\n        &lt;td&gt;&lt;%= check_box_tag \"cb_tasks[]\", task.id %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to task.title, task %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_task_path(task.id) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Done', change_to_done_path(task.id) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', task, method: :delete, data: {confirm: 'Are you sure?'} %&gt;&lt;/td&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p>and my controller </p>\n\n<pre><code>  def change_to_done\n    @task = Task.find(params[:id])\n    @task.done = true\n    @task.save\n  end\n</code></pre>\n\n<p>when clicking the link redirecting to the show path</p>\n\n<pre><code>Started GET \"/tasks/32\" for 127.0.0.1 at 2017-12-26 11:59:06 +0200\nProcessing by TasksController#show as HTML\n  Parameters: {\"id\"=&gt;\"32\"}\n  Task Load (0.1ms)  SELECT  \"tasks\".* FROM \"tasks\" WHERE \"tasks\".\"id\" = ? LIMIT ?  [[\"id\", 32], [\"LIMIT\", 1]]\n  Rendering tasks/show.html.erb within layouts/application\n  Rendered tasks/show.html.erb within layouts/application (0.7ms)\nCompleted 200 OK in 57ms (Views: 55.0ms | ActiveRecord: 0.1ms)\n</code></pre>\n\n<p>What's wrong? I need only to change field state from false to true.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "design-patterns"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1514276817, "post_id": 47975820, "comment_id": 82920742, "body": "There is a <a href=\"http://trailblazer.to/\" rel=\"nofollow noreferrer\">trailblazer.to</a> gem/framework which implements the pattern you&#39;re looking for. It has <code>Operation</code> class, which has multiple steps, which can return either <code>success</code> or <code>failure</code>. More info you&#39;re able to find on official site."}, {"owner": {"reputation": 1, "user_id": 9140874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5ca77bb7e09aaa2029770af6635030?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/9140874/maxk"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1514278495, "post_id": 47975820, "comment_id": 82921174, "body": "@nattfodd Thank you for answer. But I try to find way remove trailblaizer  from my application."}, {"owner": {"reputation": 530, "user_id": 4714655, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/wbq5r.png?s=128&g=1", "display_name": "eugene", "link": "https://stackoverflow.com/users/4714655/eugene"}, "edited": false, "score": 0, "creation_date": 1514280124, "post_id": 47975820, "comment_id": 82921712, "body": "Why don&#39;t you find out how does trailblazer team implement Operation and do it your self?"}], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 0, "last_activity_date": 1514281135, "creation_date": 1514281135, "answer_id": 47976552, "question_id": 47975820, "link": "https://stackoverflow.com/questions/47975820/chain-of-methods-in-rails-call-methods-by-step/47976552#47976552", "title": "Chain of methods in rails ( call methods by step)", "body": "<p>Save errors and shared attributes to variables (how you do it now). Unite methods to chain of methods:</p>\n\n<pre><code>def call \n  check_params &amp;&amp; calc_smthing &amp;&amp; write_in_db\nend\n\ndef valid?\n  errors.blank?\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9140874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5ca77bb7e09aaa2029770af6635030?s=128&d=identicon&r=PG&f=1", "display_name": "MaxK", "link": "https://stackoverflow.com/users/9140874/maxk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514281135, "creation_date": 1514276661, "question_id": 47975820, "link": "https://stackoverflow.com/questions/47975820/chain-of-methods-in-rails-call-methods-by-step", "title": "Chain of methods in rails ( call methods by step)", "body": "<p>I try to find how to best way implement chain of methods in Ruby( Rails application) \nlike this</p>\n\n<pre><code>class Foo\n  attr_accessor :errors\n  attr_accessor :shared_params\n\n  def initialize(..)\n    ..\n  end\n\n  def call \n    check_params\n    calc_smthing\n    write_in_db\n  end\n\n  prviate\n\n  def check_params\n    ..\n  end\n\n  def calc_smthing\n    ..\n  end\n\n  def write_in_db\n    ..\n  end\nend\n</code></pre>\n\n<p>main ideas:</p>\n\n<ul>\n<li><p>if something fail( or not fail but return false) in some step others steps doesnt call, \nof course I dont want to add multiple ifs to check state and think about how implement it in one place</p></li>\n<li><p>I need to save errors </p></li>\n<li>It would be great to find way to share params between methods.</li>\n</ul>\n\n<p>I can write in simple( ugly) way with ifs \nbut I try to find more elegant way or pattern because problem not so specific I think.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "chef-infra", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6945509, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154227839278300/picture?type=large", "display_name": "Aner Izraeli", "link": "https://stackoverflow.com/users/6945509/aner-izraeli"}, "edited": false, "score": 0, "creation_date": 1514288690, "post_id": 47976822, "comment_id": 82925015, "body": "First of all - thanks! its working! i had more &#39;ugly&#39; ideas in mind, thought maybe there are more legit ways.. im happy with ur way, but more is welcome."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1514282424, "creation_date": 1514282424, "answer_id": 47976822, "question_id": 47975743, "link": "https://stackoverflow.com/questions/47975743/print-yaml-version-on-outputs-header/47976822#47976822", "title": "Print %YAML &lt;version&gt; on output`s header", "body": "<p>I would probably just do it the brute-force way:</p>\n\n<pre><code>content \"%YAML 1.1\\n\" + node['myproduct']['config'].to_hash.to_yaml\n</code></pre>\n\n<p>I'm sure there is a better way, but that works so ... :)</p>\n"}], "owner": {"reputation": 21, "user_id": 6945509, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154227839278300/picture?type=large", "display_name": "Aner Izraeli", "link": "https://stackoverflow.com/users/6945509/aner-izraeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554455524, "creation_date": 1514276106, "last_edit_date": 1554455524, "question_id": 47975743, "link": "https://stackoverflow.com/questions/47975743/print-yaml-version-on-outputs-header", "title": "Print %YAML &lt;version&gt; on output`s header", "body": "<p>This is the code:</p>\n\n<pre><code>file '/etc/myproduct/myfile.yaml' do\n  content node['myproduct']['config'].to_hash.to_yaml( :UseVersion =&gt; true, :UseHeader =&gt; true )\n  mode 0644\n  owner 'root'\n  group 'root'\nend\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>---\nvars:\naddress-groups:\n</code></pre>\n\n<p>Im trying to add %YAML 1.1 above --- so it will look like this:</p>\n\n<pre><code>%YAML 1.1\n---\nvars:\naddress-groups:\n</code></pre>\n\n<p>also tried <em>to_yaml</em> only - no good.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller"], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275407, "post_id": 47973669, "comment_id": 82920340, "body": "The OP clearly stated they want to use a namespace. The advice \u201cjust don\u2019t use namespaces\u201d is plain wrong."}, {"owner": {"reputation": 744, "user_id": 6359122, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5c9b3a7658196858f0f4ffc6896082c1?s=128&d=identicon&r=PG&f=1", "display_name": "hermt2", "link": "https://stackoverflow.com/users/6359122/hermt2"}, "edited": false, "score": 0, "creation_date": 1514304981, "post_id": 47973669, "comment_id": 82930609, "body": "Yeah it works without namespaces. But I would much prefer to use them."}], "tags": [], "owner": {"reputation": 2294, "user_id": 2245697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931e42fa59a041551b7f63e703ea909a?s=128&d=identicon&r=PG&f=1", "display_name": "Tan", "link": "https://stackoverflow.com/users/2245697/tan"}, "is_accepted": false, "score": -1, "last_activity_date": 1514259707, "creation_date": 1514259707, "answer_id": 47973669, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47973669#47973669", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>Defining service like this is enough. There's no need namespace for this:</p>\n\n<pre><code>class UserService\nend\n\n# using\n@service = UserService.new(user_params)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275369, "post_id": 47973801, "comment_id": 82920327, "body": "Wrong. If <code>UserService</code> name was corresponding the file name and the path was included into auto-loaded path (or the file was required explicitly,) ruby constant would be successfully resolved."}, {"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277882, "post_id": 47973801, "comment_id": 82921010, "body": "@mudasobwa Thanks, but <code>UserService</code> is not corresponding the file name in auto-loaded path. My answer is right for the issue."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277991, "post_id": 47973801, "comment_id": 82921043, "body": "Different file name would prevent autoloading at all."}], "tags": [], "owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1514261366, "creation_date": 1514261366, "answer_id": 47973801, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47973801#47973801", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>Should be <code>::Services::UserService.new(user_params)</code>, Ruby assume you declare this class in the Api::V1 module, <code>::</code> means the root module. Or you can declare your service like this: </p>\n\n<p><code>class Api::V1::Services::UserService\n end\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": false, "score": 0, "last_activity_date": 1514270473, "last_edit_date": 1514270473, "creation_date": 1514261575, "answer_id": 47973819, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47973819#47973819", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>I think it is because of defined namespace. It will work by simply putting your service class directly in service directory is enough. Check for <code>ActiveSupport::Dependencies.autoload_paths</code> for a basic idea of which folders are included. Even if you are using namespace then you need to update for the autoload path with it.\nsomething like below</p>\n\n<pre><code>config.autoload_paths += %W( #{config.root}/app/your_xyz_path )\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275292, "post_id": 47974410, "comment_id": 82920307, "body": "\u201cthere should be no namespace\u201d\u2014plain wrong. Everybody has a right to use namespaces."}, {"owner": {"reputation": 32, "user_id": 8378322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17240c7ad10f9053e586f18e2d1214bd?s=128&d=identicon&r=PG&f=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/8378322/parry"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514296967, "post_id": 47974410, "comment_id": 82927856, "body": "In service class, if using namespace then the directory structure should be also similar to the namespace.  Eg:-  <code>module Services   class UserService   end end</code>  Here, directory structure should be app/services/services/user_service.rb"}], "tags": [], "owner": {"reputation": 32, "user_id": 8378322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17240c7ad10f9053e586f18e2d1214bd?s=128&d=identicon&r=PG&f=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/8378322/parry"}, "is_accepted": false, "score": -2, "last_activity_date": 1514267771, "creation_date": 1514267771, "answer_id": 47974410, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47974410#47974410", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>The code under app directory is autoloaded and all the directories too. So there should be no namespace in your service class.</p>\n\n<pre><code>class UserService\nend\n</code></pre>\n\n<p>and this should work in any controller or model/class like</p>\n\n<pre><code>user_service = UserService.new\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275222, "post_id": 47974436, "comment_id": 82920284, "body": "Sounds like \u201cuse global variables everywhere!\u201c The OP clearly stated they want to use a namespace/fq-name. The advice \u201cjust don\u2019t use namespaces\u201d looks as an off-topic to me."}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514276740, "post_id": 47974436, "comment_id": 82920716, "body": "@mudasobwa, he is just asking for what is the error for &quot;Api::V1::UsersController::Services&quot;, And I didn&#39;t suggest do not use namespace, I just give the solution of error. And you can put your own opinion, please don&#39;t down vote the answer as per your personal opinion."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514276898, "post_id": 47974436, "comment_id": 82920759, "body": "Please don\u2019t tell me what I am to do. This answer is of very low quality, it does not explain what the real issue is and, after all, it does not solve the issue. Also, \u201cI didn&#39;t suggest do not use namespace\u201d is a lie, you might want to re-read the very first sentence of your answer."}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277125, "post_id": 47974436, "comment_id": 82920812, "body": "You also do not need to tell me, &quot;No need to define namespace&quot;, I give the solution as per error, I didn&#39;t mean that you cant use namespace."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277193, "post_id": 47974436, "comment_id": 82920830, "body": "You gave the <i>wrong solution</i>. Read the answer by @kiddorails for the correct one."}, {"owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277254, "post_id": 47974436, "comment_id": 82920845, "body": "I dont want t say anything to you man. You just come and downvote all the answer."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514277304, "post_id": 47974436, "comment_id": 82920857, "body": "I have downvoted all the incorrect answers, yes. And I upvoted the correct one. That\u2019s how voting on SO works."}], "tags": [], "owner": {"reputation": 1812, "user_id": 4627335, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/kZFZA.jpg?s=128&g=1", "display_name": "ashvin", "link": "https://stackoverflow.com/users/4627335/ashvin"}, "is_accepted": false, "score": -1, "last_activity_date": 1514267991, "creation_date": 1514267991, "answer_id": 47974436, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47974436#47974436", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>No need to define namespace, just write it with your service name, like following</p>\n\n<pre><code>class UserService\n\n  attr_reader :session, :user\n\n  def initialize(params)\n    # @user_id = params[:id]\n    @params = params\n  end\n\n  def create\n     user = User.create(@params)\n       if user.save\n            return user\n       else\n            false\n       end\n  end\n\nend\n</code></pre>\n\n<p>And call it using <code>UserService.new(params)</code>\nAnd for production mode define it in <code>application.rb</code> file to autoload the service like following\n<code>config.autoload_paths += Dir[Rails.root.join('app', 'services')]</code></p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275483, "post_id": 47975567, "comment_id": 82920362, "body": "Wow, the 6th answer is the first one <i>almost</i> correct :) Please also advise to triple-check that <code>services</code> directory is included to the list of autoloaded paths."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514275645, "post_id": 47975567, "comment_id": 82920400, "body": ":) I avoided writing it since all sub-directories in <code>app&#47;</code> are autoloaded by default (dont&#39; remember the behavior of &lt; Rails 4). Am I wrong?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1514275769, "post_id": 47975567, "comment_id": 82920429, "body": "Ah, indeed. I missed that it\u2019s <code>app&#47;services</code>, not just <code>services</code>. Anyway, I have it upvoted already."}, {"owner": {"reputation": 744, "user_id": 6359122, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5c9b3a7658196858f0f4ffc6896082c1?s=128&d=identicon&r=PG&f=1", "display_name": "hermt2", "link": "https://stackoverflow.com/users/6359122/hermt2"}, "edited": false, "score": 0, "creation_date": 1514305254, "post_id": 47975567, "comment_id": 82930704, "body": "I tried adding the module and it still wouldn&#39;t work. If I remove all modules/namespaces and just reference UserService then it works. But I really don&#39;t want to do this. I want to use namespaces. It seems that it makes the code much more organized and maintainable."}, {"owner": {"reputation": 744, "user_id": 6359122, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5c9b3a7658196858f0f4ffc6896082c1?s=128&d=identicon&r=PG&f=1", "display_name": "hermt2", "link": "https://stackoverflow.com/users/6359122/hermt2"}, "edited": false, "score": 0, "creation_date": 1514305316, "post_id": 47975567, "comment_id": 82930727, "body": "I did update the file name to <code>user_service.rb</code> as well"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1514305511, "post_id": 47975567, "comment_id": 82930783, "body": "are you still creating the class by <code>class Services::UserService</code> ?"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": false, "score": 3, "last_activity_date": 1514275413, "last_edit_date": 1514275413, "creation_date": 1514274950, "answer_id": 47975567, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails/47975567#47975567", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>I think, problem is with your filename: <code>app/services/users_service.rb</code>. Since your class name is <code>UserService</code>, it should rather be: <code>app/services/user_service.rb</code> (<code>user_service</code> instead of <code>users_service</code>). </p>\n\n<p><code>UserService</code> will expect to load the class from a file called as <code>user_service.rb</code> in autoload path. </p>\n\n<p>Define your service as following:<br>\nFilename: <code>app/services/user_service.rb</code>.<br>\nDefinition:</p>\n\n<pre><code>module Services\n  class UserService\n    attr_reader :session, :user\n\n    def initialize(params)\n      # @user_id = params[:id]\n      @params = params\n    end\n\n    def create\n      user = User.create(@params)\n      if user.save\n        return user\n      else\n        false\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><code>Services::UserService.new(user_params)</code> should work as intended.</p>\n"}], "owner": {"reputation": 744, "user_id": 6359122, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5c9b3a7658196858f0f4ffc6896082c1?s=128&d=identicon&r=PG&f=1", "display_name": "hermt2", "link": "https://stackoverflow.com/users/6359122/hermt2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 1, "answer_count": 6, "score": 3, "last_activity_date": 1514275413, "creation_date": 1514258645, "last_edit_date": 1514273277, "question_id": 47973606, "link": "https://stackoverflow.com/questions/47973606/how-do-you-reference-another-class-from-a-controller-in-ruby-on-rails", "title": "How do you reference another class from a controller in ruby on rails?", "body": "<p>I am trying to use a service class inside of my controller. I cannot figure out how to reference other classes in rails. Here is my <code>users_controller</code>, located under <code>app/controllers/api/v1</code>:</p>\n\n<pre><code>class Api::V1::UsersController &lt; ApplicationController\n  respond_to :json\n  skip_before_filter :verify_authenticity_token\n  before_filter :initialize_user_service\n\n  def create\n    @service.create\n    render json: CustomResponse.new(\n      {\n        user: @service.user,\n      }\n    )\n  end\n\n  def initialize_user_service\n    @service = Services::UserService.new(user_params)\n  end\n\n  def user_params\n    params.permit(:email, :password, :password_confirmation, :first_name, :last_name)\n  end\nend\n</code></pre>\n\n<p>I am attempting to reference this <code>users_service.rb</code> class located in <code>app/services/users_service.rb</code>:</p>\n\n<pre><code>class Services::UserService\n  attr_reader :session, :user\n\n  def initialize(params)\n    # @user_id = params[:id]\n    @params = params\n  end\n\n  def create\n    user = User.create(@params)\n    if user.save\n      return user\n    else\n      false\n    end\n  end\nend\n</code></pre>\n\n<p>But I get the following error in the console:</p>\n\n<pre><code>NameError (uninitialized constant Api::V1::UsersController::Services):\n</code></pre>\n\n<p>Does anyone know what I can do to access this class? I cannot find a solution. I imagine it may have something to do with my <code>config/application.rb</code> file, but I am not sure what.</p>\n"}, {"tags": ["ruby", "class", "oop", "getter-setter", "object-oriented-analysis"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1514257836, "post_id": 47973447, "comment_id": 82916653, "body": "Keep in mind the only things in Ruby that are logically false are <code>nil</code> and <code>false</code> so unless there&#39;s some way that things like <code>right_child</code> can ever be literally <code>false</code> it&#39;s not necessary nor recommended to do comparisons like <code>== nil</code>. This not only clutters your code up and raises questions about what values that property can contain, but runs the risk of an accidental assignment if you type <code>= nil</code> by mistake."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1514258032, "post_id": 47973447, "comment_id": 82916679, "body": "@tadman Hey! I wanted to give a review if the OP took it over to CR.se! ;)"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1514258498, "post_id": 47973447, "comment_id": 82916739, "body": "@thesecretmaster That&#39;s just the beginning. There&#39;s a lot you could convey here to make it more Ruby-like."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1514258552, "post_id": 47973447, "comment_id": 82916746, "body": "@tadman I know, I was just kidding."}], "answers": [{"comments": [{"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1514257490, "post_id": 47973506, "comment_id": 82916622, "body": "Once you&#39;ve got <i>completely working code</i>, you can also post on <a href=\"https://codereview.stackexchange.com\">Code Review</a> for a review (I&#39;d be happy to give you one)."}, {"owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514257983, "post_id": 47973506, "comment_id": 82916672, "body": "I have added the screenshots of the POODR book by Sandi Metz which says never to use an instance variable in your code.It&#39;s not recommended."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514258166, "post_id": 47973506, "comment_id": 82916697, "body": "The phrasing is ... not the best. I&#39;ll add an explanation to my answer."}, {"owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514258351, "post_id": 47973506, "comment_id": 82916722, "body": "My concern is if getter and setter methods are available, even if I am wrapping, why is it not working and updating the values?"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514258609, "post_id": 47973506, "comment_id": 82916754, "body": "The getters and setters are there to allow you to access the instance variables from <i>outside</i> that instance. As I mentioned in my answer, they effectively define methods that allow direct manipulation of instance variables."}, {"owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514258710, "post_id": 47973506, "comment_id": 82916773, "body": "It&#39;s saying hide variables even from the class itself as illustrated on page 25. And yeah that&#39;s only a good practice. That&#39;s not the main concern. My main concern is why won&#39;t it work if I am using the wrapper as getter and setters instead of using instance variable or self. to access them."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514258741, "post_id": 47973506, "comment_id": 82916776, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/161948/discussion-between-thesecretmaster-and-saurav-prakash\">continue this discussion in chat</a>."}, {"owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514262213, "post_id": 47973506, "comment_id": 82917218, "body": "Found out, ruby treats assignment as assignment to a new variable and not the instance variable if we do root = Node.new(5). For that reason we need to pass self.root = Node.new(5). And from your last explanation, it makes sense that in the start if I pass a nil, it will give me an error. Bcoz root is nil.so assignment will return no value for nil. Afterwards when we pass the root, now its an instance.  Thanks man!"}, {"owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1514262768, "post_id": 47973506, "comment_id": 82917297, "body": "posted the working code on CR. Will appreciate your reviews. <a href=\"https://codereview.stackexchange.com/questions/183630/ruby-bst-code-for-insertion-implementation\" title=\"ruby bst code for insertion implementation\">codereview.stackexchange.com/questions/183630/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "is_accepted": true, "score": 2, "last_activity_date": 1514259503, "last_edit_date": 1514259503, "creation_date": 1514257152, "answer_id": 47973506, "question_id": 47973447, "link": "https://stackoverflow.com/questions/47973447/why-attr-accessor-wont-work-in-setting-methods/47973506#47973506", "title": "Why attr_accessor won&#39;t work in setting methods", "body": "<p>It's actually <em>totally</em> OK to use instance variables within instance methods. In fact, that's what they're for! Setters and getters allow things outside the instance to access variables inside the instance. They (basically) define instance methods for the class like this:</p>\n\n<pre><code>class Foo\n  # getter -- Same as attr_reader :root\n  def root\n    @root\n  end\n\n  # setter -- Same as attr_writer :root\n  def root=(root)\n    @root = root\n  end\n\n  # attr_accessor defines a setter *and* a getter.\nend\n</code></pre>\n\n<p>So, you could simplify your code by defining <code>#insert</code> so that it only takes one argument (<code>value</code>) and replace every place where you reference <code>node</code> with a reference to <code>@root</code>.</p>\n\n<p>The way that I think you're looking for (but is not the \"right\" way, and I wouldn't recommend) is to call the <code>root</code> and <code>root=</code> methods defined by the accessor.</p>\n\n<p>If you took this route, you'd also have to define <code>#insert</code> to only take <code>value</code> as an argument and replace every place that you reference <code>node</code> with <code>root</code>. This will work, but it's not the right way to solve the problem. If you solve it this way, please ask a question on CodeReview.se so I can clarify how you can make the code better.</p>\n\n<h2>Why it's not working</h2>\n\n<p>In the #insert method, you're manipulating the <code>node</code> parameter that was passed to the method, not <code>root</code>. Ruby is pass by value not pass by reference (sorta), so when you pass <code>mybst.root</code> to <code>#insert</code>, you're effectively passing <code>nil</code> because <code>mybst.root == nil</code>. Then the <code>mybst.insert</code> call returns a new Node, but you don't do anything with that return value. If you wanted to set <code>root</code> to that return value, you could do:</p>\n\n<pre><code>mybst = BST.new\np mybst.root\nmybst.root = mybst.insert(1, mybst.root)\nmybst.root = mybst.insert(2, mybst.root)\nmybst.root = mybst.insert(10, mybst.root)\nmybst.root = mybst.insert(12, mybst.root)\n\np mybst\n</code></pre>\n\n<h2>Explanation of what that textbook is <em>trying</em> to say</h2>\n\n<p>I think that the confusing part here is where the textbook says:</p>\n\n<blockquote>\n  <p>Hide the variables, even from the class that defines them</p>\n</blockquote>\n\n<p>This is correct, but I think you're misinterpreting it. This section is saying that you should hide instance variables <em>from anything outside of that instance</em>. Within that instance, it's totally OK to use them, and that's actually the reason why instance variables exist -- to store state within the instance. It's just considered better to define methods for behaviors rather than directly exposing the instance variables. Of course, this is just one rule to keep in mind -- I'm sure you'll come across a situation where this advice does not apply, but generally you want to keep instance variables internal.</p>\n"}], "owner": {"reputation": 877, "user_id": 4586117, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/921578031200237/picture?type=large", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4586117/saurav-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 47973506, "answer_count": 1, "score": 0, "last_activity_date": 1514259503, "creation_date": 1514256352, "last_edit_date": 1514258040, "question_id": 47973447, "link": "https://stackoverflow.com/questions/47973447/why-attr-accessor-wont-work-in-setting-methods", "title": "Why attr_accessor won&#39;t work in setting methods", "body": "<p>I am implementing BST in ruby and writing insert method using recursion. </p>\n\n<p>I am trying to use attr_accessor for setting and getting root but it doesn't work. Can anyone help out?</p>\n\n<pre><code>class Node \n  attr_accessor :value, :left_child, :right_child\n\n  def initialize (value)\n    @value = value \n    @left_child = nil \n    @right_child = nil \n  end\nend \n\nclass BST \n  attr_accessor :root \n\n  def initialize\n    @root = nil\n  end \n\n\n\n  def insert(value, node)\n\n    if node == nil \n      node = Node.new(value)\n      return node\n    end \n\n    return node if node.value == value\n\n    if node.value &gt; value\n      if node.left_child == nil \n        node.left_child = Node.new(value)\n        return\n      else \n        insert(value, node.left_child) \n      end \n\n    else\n\n      if node.right_child == nil \n        node.right_child = Node.new(value)\n        return\n      else \n        insert(value, node.right_child) \n      end\n    end \n  end \nend \n\n\nmybst = BST.new\np mybst.root\nmybst.insert(1, mybst.root)\nmybst.insert(2, mybst.root)\nmybst.insert(10, mybst.root)\nmybst.insert(12, mybst.root)\n\np mybst\n</code></pre>\n\n<p>The code above shows a simple implementation of Node class and a BST class with insert method. Gives me <code>#&lt;BST:0x00557398d02378 @root=nil&gt;</code></p>\n\n<p>If I use a self.root it works. </p>\n\n<p>One can use @root to access the root but a class should not interact with its instance variables directly. That's why we need a getter and setter method provided by attr_accessor. But it's not working. What I am missing ?</p>\n\n<p>Below are the screenshots of the book POODR. It says never to use instance variables directly even in class.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oerps.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oerps.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/PF1Gx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PF1Gx.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dropdown"], "answers": [{"tags": [], "owner": {"reputation": 1812, "user_id": 9104680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e2d06cc56c31f995950c00602a0e7d?s=128&d=identicon&r=PG", "display_name": "Derek Hopper", "link": "https://stackoverflow.com/users/9104680/derek-hopper"}, "is_accepted": false, "score": 0, "last_activity_date": 1514249873, "creation_date": 1514249873, "answer_id": 47973029, "question_id": 47972886, "link": "https://stackoverflow.com/questions/47972886/ruby-on-rails-set-local-variable-from-drop-down/47973029#47973029", "title": "Ruby on Rails set local variable from drop-down", "body": "<p>Based on how you wrote your question, it sounds like you'll want a solution that uses some JavaScript. Ruby executes on the server. If you want your server to know what the user selected, you'll have to send data to your server. That's why the other tutorials you've read <code>POST</code> data to the server.</p>\n\n<p>Here's a way you could do this with a little bit of JavaScript:</p>\n\n<pre><code>const year = 2017\nconst my_age = document.getElementById(\"my_age\")\n\nmy_age.addEventListener(\"change\", (evt) =&gt; {\n    const age = evt.target.value\n    const birth_year = year - age\n    console.log(\"You were born in \" + birth_year)\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1684, "user_id": 2330824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57e6b87b180cd3ee1079be83bca74f7?s=128&d=identicon&r=PG", "display_name": "Tendy Teslo", "link": "https://stackoverflow.com/users/2330824/tendy-teslo"}, "is_accepted": false, "score": 0, "last_activity_date": 1514250335, "creation_date": 1514250335, "answer_id": 47973062, "question_id": 47972886, "link": "https://stackoverflow.com/questions/47972886/ruby-on-rails-set-local-variable-from-drop-down/47973062#47973062", "title": "Ruby on Rails set local variable from drop-down", "body": "<p>Since you are talking about local variable it is only live in one instance call. With saying that means variable you want use is rendered once before the view is called.<br>\nDropdown you are referring to is form element which should be passed through the form submit. Therefore, it should reload every time you want change <code>birth_year</code>. It is no significant different approach if you're using either GET or POST in this case.</p>\n\n<p>In a view:</p>\n\n<pre><code>&lt;%= form_tag(\"/myaction\", method: \"get\") do %&gt;\n    &lt;p&gt;What is your age?&lt;/p&gt;\n    &lt;%= select_tag \"my_age\", raw(\"&lt;option&gt;1&lt;/option&gt;&lt;option&gt;2&lt;/option&gt;        \n    &lt;option&gt;3&lt;/option&gt;\") %&gt;\n    &lt;%= puts \"You were born in #{@birth_year}\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In a controller:</p>\n\n<pre><code>def myaction\n    year = Date.today.year\n    age = params[:my_age]\n    @birth_year = year - age\nend\n</code></pre>\n\n<p>On the other hand, if you are planning to use variable in as soon as in client page(frontend) you need set value in Javascript or any other client side frameworks that you are using.</p>\n"}], "owner": {"reputation": 51, "user_id": 4093033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/50168641c092caa4e7e390a650b67daa?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Levitt", "link": "https://stackoverflow.com/users/4093033/theodore-levitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514250335, "creation_date": 1514247384, "question_id": 47972886, "link": "https://stackoverflow.com/questions/47972886/ruby-on-rails-set-local-variable-from-drop-down", "title": "Ruby on Rails set local variable from drop-down", "body": "<p>I'm trying to get the value from a drop down, set it equal to a local variable and display it. All the tutorials I have found use the Post method to store the value in a database. </p>\n\n<p>Is it possible for me to set a local variable equal to what the user selects in the dropdown?</p>\n\n<p>Here is some example code that illustrates what I'm trying to do, I just don't know how to set the selected dropdown value equal to the variable age...</p>\n\n<pre><code>&lt;% year = 2017 %&gt;\n&lt;p&gt;What is your age?&lt;/p&gt;\n&lt;%= select_tag \"my_age\", raw(\"&lt;option&gt;1&lt;/option&gt;&lt;option&gt;2&lt;/option&gt;&lt;option&gt;3&lt;/option&gt;\") %&gt;\n&lt;% birth_year = year - age %&gt;\n&lt;%= puts \"You were born in #{birth_year}\" %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation", "model"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "edited": false, "score": 0, "creation_date": 1514249428, "post_id": 47972998, "comment_id": 82915606, "body": "Thank you very much for your precious help!"}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 2, "last_activity_date": 1514249293, "creation_date": 1514249293, "answer_id": 47972998, "question_id": 47972828, "link": "https://stackoverflow.com/questions/47972828/rails-validation-with-lots-of-format/47972998#47972998", "title": "Rails: Validation with lots of format", "body": "<p>Your first regex covers everything:</p>\n\n<pre><code>format: { with: /\\A[a-zA-Z0-9]+\\Z/ }\n</code></pre>\n\n<p>but you probably want <code>\\z</code> instead of <code>\\Z</code> to avoid issues with trailing newlines. Anything that matches <code>/\\A[a-zA-Z0-9]+\\z/</code> won't contain any space characters so the <code>/\\s/</code> test is already covered, similarly for the punctuation test.</p>\n\n<p>Also, you've misspelled <code>uniqueness</code> as <code>unniqueness</code> so you'll want to fix that too.</p>\n\n<p>That would leave you with just:</p>\n\n<pre><code>validates :nickname, presence: true, uniqueness: true, format: { with: /\\A[a-zA-Z0-9]+\\Z/ }\n</code></pre>\n\n<p>If you really did have multiple regexes to test then you could do it in a custom method:</p>\n\n<pre><code>validate :nickname_format\n\ndef nickname_format\n  return if(!nickname) # The `presence: true` takes care of complaining about this.\n  if(nickname ~! ...)\n    errors.add(:nickname, 'blah blah')\n  elsif(...)\n    ...\n  end\nend\n</code></pre>\n\n<p>so that you could check each regex individually.</p>\n"}], "owner": {"reputation": 387, "user_id": 8152465, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/17b78615d8f648d8b9745b530b880422?s=128&d=identicon&r=PG&f=1", "display_name": "rod", "link": "https://stackoverflow.com/users/8152465/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47972998, "answer_count": 1, "score": 0, "last_activity_date": 1514249293, "creation_date": 1514246484, "question_id": 47972828, "link": "https://stackoverflow.com/questions/47972828/rails-validation-with-lots-of-format", "title": "Rails: Validation with lots of format", "body": "<p>I want to validate a Nickname but I have a lot of format like this:</p>\n\n<pre><code>validates :nickname, presence: true, unniqueness: true, format: { with: /\\A[a-zA-Z0-9]+\\Z/ }, format: {  without: /\\s/ }, format: { without: /[!-\\/\\@\\^\\~\\`\\(\\)\\[\\]\\&gt;\\&lt;\\=]/ }\n\nwarning: key :format is duplicated and overwritten on line 38\nwarning: key :format is duplicated and overwritten on line 38\n</code></pre>\n\n<p>Obviously down't work in this way, how can I solve it? Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "passenger"], "answers": [{"comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 1, "creation_date": 1523891688, "post_id": 47972768, "comment_id": 86736527, "body": "Unfortunately, the problem has returned. See <a href=\"https://github.com/travis-ci/travis-ci/issues/8978\" rel=\"nofollow noreferrer\">github.com/travis-ci/travis-ci/issues/8978</a>."}], "tags": [], "owner": {"reputation": 1018, "user_id": 1418886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0e51dd7a2cb0aa4c9e42c3e7fe9907?s=128&d=identicon&r=PG", "display_name": "Exsemt", "link": "https://stackoverflow.com/users/1418886/exsemt"}, "is_accepted": true, "score": 32, "last_activity_date": 1514245636, "creation_date": 1514245636, "answer_id": 47972768, "question_id": 47972479, "link": "https://stackoverflow.com/questions/47972479/after-ruby-update-to-2-5-0-require-bundler-setup-raise-exception/47972768#47972768", "title": "After ruby update to 2.5.0, require &#39;bundler/setup&#39; raise exception", "body": "<p>Fix is simple: update RubyGems min up to 2.7.4 version</p>\n\n<pre><code>gem update --system\n</code></pre>\n\n<p><a href=\"http://blog.rubygems.org/2017/12/25/2.7.4-released.html\" rel=\"noreferrer\">RubyGems 2.7.4 includes bug fixes.</a></p>\n"}, {"tags": [], "owner": {"reputation": 7503, "user_id": 139607, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/223395b4fdae9ca2b8512f8c1378d705?s=128&d=identicon&r=PG", "display_name": "Matthew O&#39;Riordan", "link": "https://stackoverflow.com/users/139607/matthew-oriordan"}, "is_accepted": false, "score": 1, "last_activity_date": 1524175630, "creation_date": 1524175630, "answer_id": 49930928, "question_id": 47972479, "link": "https://stackoverflow.com/questions/47972479/after-ruby-update-to-2-5-0-require-bundler-setup-raise-exception/49930928#49930928", "title": "After ruby update to 2.5.0, require &#39;bundler/setup&#39; raise exception", "body": "<p>Sadly the only solution here is to upgrade Bundler to >= 1.16.1. See <a href=\"https://github.com/heroku/heroku-buildpack-ruby/pull/738\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-ruby/pull/738</a> for an example where this is fixed in theory, but is blocked by Heroku unfortunately.</p>\n\n<p>Upgrade to Bundler 1.16.1+ and you won't have any more issues.</p>\n"}], "owner": {"reputation": 1018, "user_id": 1418886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f0e51dd7a2cb0aa4c9e42c3e7fe9907?s=128&d=identicon&r=PG", "display_name": "Exsemt", "link": "https://stackoverflow.com/users/1418886/exsemt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8477, "favorite_count": 0, "accepted_answer_id": 47972768, "answer_count": 2, "score": 11, "last_activity_date": 1524175630, "creation_date": 1514241612, "question_id": 47972479, "link": "https://stackoverflow.com/questions/47972479/after-ruby-update-to-2-5-0-require-bundler-setup-raise-exception", "title": "After ruby update to 2.5.0, require &#39;bundler/setup&#39; raise exception", "body": "<p>Call <code>rake</code> from rails app after ruby 2.5.0 update, does not work.</p>\n\n<pre><code>$ rake\nTraceback (most recent call last):\n    22: from ./bin/rake:4:in `&lt;main&gt;'\n    21: from ./bin/rake:4:in `require_relative'\n    20: from /Users/user/work/hw/relocations_app/config/boot.rb:5:in `&lt;top (required)&gt;'\n    19: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:39:in `require'\n    18: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:135:in `rescue in require'\n    17: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:135:in `require'\n    16: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/setup.rb:10:in `&lt;top (required)&gt;'\n    15: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler.rb:107:in `setup'\n    14: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:20:in `setup'\n    13: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/runtime.rb:108:in `block in definition_method'\n    12: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:226:in `requested_specs'\n    11: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:237:in `specs_for'\n    10: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:170:in `specs'\n     9: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:247:in `resolve'\n     8: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:806:in `converge_locked_specs'\n     7: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:874:in `expand_dependencies'\n     6: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:874:in `each'\n     5: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:887:in `block in expand_dependencies'\n     4: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:887:in `each'\n     3: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/bundler-1.16.1/lib/bundler/definition.rb:888:in `block (2 levels) in expand_dependencies'\n     2: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:39:in `require'\n     1: from /Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:135:in `rescue in require'\n/Users/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:135:in `require': cannot load such file -- bundler/dep_proxy (LoadError)\n</code></pre>\n\n<p>config/boot.rb</p>\n\n<pre><code># frozen_string_literal: true\n\nENV['BUNDLE_GEMFILE'] ||= File.expand_path('../Gemfile', __dir__)\n\nrequire 'bundler/setup' # Set up gems listed in the Gemfile.\n</code></pre>\n\n<p><code>bundler/setup</code> can not be required.</p>\n\n<p>A same problem is with passenger, to start rails app with that:</p>\n\n<pre><code>Error ID: 309814d3\n  Error details saved to: /tmp/passenger-error-yCUWSg.html\n  Message from application: cannot load such file -- bundler/setup (LoadError)\n  /var/www/vhosts/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n  /var/www/vhosts/user/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:456:in `activate_gem'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:323:in `block in run_load_path_setup_code'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:461:in `running_bundler'\n  /usr/lib/ruby/vendor_ruby/phusion_passenger/loader_shared_helpers.rb:322:in `run_load_path_setup_code'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:100:in `preload_app'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:156:in `&lt;module:App&gt;'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:30:in `&lt;module:PhusionPassenger&gt;'\n  /usr/share/passenger/helper-scripts/rack-preloader.rb:29:in `&lt;main&gt;'\n</code></pre>\n\n<p>Have anybody a same problem with ruby 2.5.0?</p>\n"}, {"tags": ["arrays", "ruby", "indexing"], "answers": [{"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1514242448, "post_id": 47972350, "comment_id": 82914698, "body": "Funny thing is, four lines earlier they still knew that."}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": false, "score": 1, "last_activity_date": 1514239936, "creation_date": 1514239936, "answer_id": 47972350, "question_id": 47972231, "link": "https://stackoverflow.com/questions/47972231/ruby-get-value-from-array-using-index/47972350#47972350", "title": "Ruby get value from array using index", "body": "<p>You have to use <code>puts x.at(input - 1)</code> because of <a href=\"https://docs.ruby-lang.org/en/2.0.0/Array.html\" rel=\"nofollow noreferrer\">Ruby arrays' indexing starts with 0</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8231954, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o4x_NT8QwBs/AAAAAAAAAAI/AAAAAAAABQg/PTRVnysdcY4/photo.jpg?sz=128", "display_name": "Mindaugas Pranaitis", "link": "https://stackoverflow.com/users/8231954/mindaugas-pranaitis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "closed_date": 1514285019, "answer_count": 1, "score": -2, "last_activity_date": 1514244114, "creation_date": 1514238492, "last_edit_date": 1514244114, "question_id": 47972231, "link": "https://stackoverflow.com/questions/47972231/ruby-get-value-from-array-using-index", "closed_reason": "Needs details or clarity", "title": "Ruby get value from array using index", "body": "<p>Given an array of letters:</p>\n\n<pre><code>@recipients_list = [\"Mum and Dad\", \"my best friend\", \"Brother\"]\n\n# &gt; Here are the letters available to ship, select one by number\n# &gt; 1. Mum and Dad\n# &gt; 2. My best friend\n# &gt; 3. Brother\n</code></pre>\n\n<p>As a user I then enter 3 (notice that Brother in this case is the recipient name). My code:</p>\n\n<pre><code>x = @recipient_list.each_with_index do |value, i|\n  index_start = i + 1\n  puts \"#{index_start}.#{value}\"\nend\ninput = gets.chomp.to_i\nputs x.at(input)\n</code></pre>\n\n<p>How to get brother value from array when user press 3? Anyone can help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5", "blocking"], "comments": [{"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "edited": false, "score": 0, "creation_date": 1514253384, "post_id": 47972179, "comment_id": 82916094, "body": "Merry Christmas, though I am a Chinese. You may need an authorization gem named cancancan."}], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 2601689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KKSIm.jpg?s=128&g=1", "display_name": "Designer", "link": "https://stackoverflow.com/users/2601689/designer"}, "edited": false, "score": 0, "creation_date": 1514410168, "post_id": 47973311, "comment_id": 82966115, "body": "Wow thanks mate! Many options \ud83d\ude05 I\u2019m going to research these directions deeper as I have no idea how to do any of them now \ud83d\ude05"}], "tags": [], "owner": {"reputation": 326, "user_id": 3013354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9dbf3df6d9dc0944bb224014a3bc2b?s=128&d=identicon&r=PG", "display_name": "nekogami", "link": "https://stackoverflow.com/users/3013354/nekogami"}, "is_accepted": true, "score": 0, "last_activity_date": 1514254180, "creation_date": 1514254180, "answer_id": 47973311, "question_id": 47972179, "link": "https://stackoverflow.com/questions/47972179/blocking-public-access-to-my-website-with-coming-soon-page/47973311#47973311", "title": "Blocking public access to my website with Coming-Soon page", "body": "<p>Well, merry Xmas to you too.</p>\n\n<p>As for your question there are a lot of various solution here.\nYou could do it directly through your HTTP Server, for exemple, tell you server to automaticaly redirect to /coming_soon if a defined HTTP HEADER is not found in the request.</p>\n\n<p>You could also set a custom cookie value in you browser with a randomized string and check the value in a before_filter \n(see <a href=\"https://stackoverflow.com/questions/4281685/how-to-access-cookies-from-applicationcontroller-rails\">How to access cookies from ApplicationController (Rails)</a> ) </p>\n\n<p>Or use an authorization gem like cancancan or pundit (I do prefer the latter over the former but it's more a matter of taste) to define your redirection rules (I do think it would be overkill to use these gem only for that behavior though)</p>\n"}], "owner": {"reputation": 849, "user_id": 2601689, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/KKSIm.jpg?s=128&g=1", "display_name": "Designer", "link": "https://stackoverflow.com/users/2601689/designer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47973311, "answer_count": 1, "score": 0, "last_activity_date": 1514260678, "creation_date": 1514237770, "last_edit_date": 1514260678, "question_id": 47972179, "link": "https://stackoverflow.com/questions/47972179/blocking-public-access-to-my-website-with-coming-soon-page", "title": "Blocking public access to my website with Coming-Soon page", "body": "<p>I have a Rails website and it is live under root url. I want to block public access to it. Preferably with a Coming Soon page. But I still want to access it \"maybe with a login, or any other way\" so that I can deploy my codes, continue adding content until I'm ready for public release.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1514218291, "post_id": 47970197, "comment_id": 82909762, "body": "You&#39;d better include some <code>button_attributes</code> in your example data."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1514218465, "post_id": 47970197, "comment_id": 82909803, "body": "As Stefan pointed out, there <i>is no such key in your entire data structure</i>, so there is no way to find it. If you do a simple text search for <code>button_attributes</code>, you will find that the only hits are in the textual description of your question, but it <i>does not appear</i> in the code you posted. It is simply not there, ergo, there is no way to find it, since it doesn&#39;t exist."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514218528, "post_id": 47970197, "comment_id": 82909809, "body": "Also, your hash doesn&#39;t have <code>:letter</code> as key."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1514223173, "post_id": 47970197, "comment_id": 82910880, "body": "This is a pure-Ruby question so it should not have a Rails tag. When giving an example please pare it down to its essentials. For example,  many of the nested key-value pairs are not relevant to the question, so should be removed. Similarly, there was no need to make the value of <code>&quot;authenticity_token&quot;</code> an 88-character string when, say, &quot;XsZ&quot; would have sufficed."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1514232051, "post_id": 47970197, "comment_id": 82912820, "body": "@CarySwoveland How do you know it&#39;s a pure-Ruby question? I see their inclusion of that tag as indication that they&#39;re using this in Rails and thus can take advantage of the functionality that Rails adds to Ruby. And that answers are therefore very welcome to take advantage of that added functionality. And for that I think including the Rails tag is beneficial and appropriate. No?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514235111, "post_id": 47970197, "comment_id": 82913511, "body": "@Stefan, yes, the Rails tag should stay."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 4207278, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/77bdfbdfe529a0403e3596e1827f9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "nico_lrx", "link": "https://stackoverflow.com/users/4207278/nico-lrx"}, "edited": false, "score": 0, "creation_date": 1514218926, "post_id": 47970225, "comment_id": 82909909, "body": "Thank you, exactly what I was looking for."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1514218326, "creation_date": 1514218326, "answer_id": 47970225, "question_id": 47970197, "link": "https://stackoverflow.com/questions/47970197/rails-ruby-how-to-retrieve-hash-key-with-unknown-id/47970225#47970225", "title": "Rails/ruby: how to retrieve hash key with unknown id", "body": "<p>The key is to use <a href=\"https://ruby-doc.org/core/Hash.html#method-i-values\" rel=\"nofollow noreferrer\"><code>Hash#values</code></a> to retrieve <em>values</em> for the hash with an unknown <em>key</em>.</p>\n\n<pre><code>input[\"letter\"][\"cards_attributes\"].\n  values.   # \u21d0 HERE\n  map { |hash| hash[\"buttons_attributes\"] }.\n  compact   # to eliminate those having no such entry\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 4207278, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/77bdfbdfe529a0403e3596e1827f9ddb?s=128&d=identicon&r=PG&f=1", "display_name": "nico_lrx", "link": "https://stackoverflow.com/users/4207278/nico-lrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 47970225, "answer_count": 1, "score": -1, "last_activity_date": 1514218326, "creation_date": 1514218061, "question_id": 47970197, "link": "https://stackoverflow.com/questions/47970197/rails-ruby-how-to-retrieve-hash-key-with-unknown-id", "title": "Rails/ruby: how to retrieve hash key with unknown id", "body": "<p>I would like to check if there is <code>button_attributes</code> in my parameters. However, there is a random id for the array so I can't verify if <code>button_attributes</code>is present or not.</p>\n\n<p>Here is the parameters:</p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\",\n \"authenticity_token\"=&gt;\"XsZyQxt0JcV/bD3joM+B0gHMu+GUf1FPcCpWltXGRa9ROs5ei8iG4EgkLz/thogng1cafWVg+5bYAcJulTGdsQ==\",\n \"letter\"=&gt;\n  {\"campaign_name\"=&gt;\"\",\n   \"scheduled_at\"=&gt;\"\",\n   \"filters_attributes\"=&gt;{\"0\"=&gt;{\"gender\"=&gt;\"Select Gender\", \"creation_date_start\"=&gt;\"\", \"creation_date_finish\"=&gt;\"\", \"timezone\"=&gt;[\"\"], \"locale\"=&gt;[\"\"], \"segment\"=&gt;[\"\"]}},\n   \"nb_recipients\"=&gt;\"1\",\n   \"core_bot_id\"=&gt;\"1\",\n   \"messages_attributes\"=&gt;{\"0\"=&gt;{\"content\"=&gt;\"fdsfdfd\", \"buttons_attributes\"=&gt;{\"0\"=&gt;{\"button_text\"=&gt;\"\", \"button_url\"=&gt;\"\", \"_destroy\"=&gt;\"false\"}}, \"_destroy\"=&gt;\"false\"}},\n   \"cards_attributes\"=&gt;\n    {\"1514217785795\"=&gt;\n      {\"title\"=&gt;\"sdffsdfsd\",\n       \"subtitle\"=&gt;\"fsdfdsdsf\",\n       \"button_share\"=&gt;\"false\",\n       \"buttons_attributes\"=&gt;{\"0\"=&gt;{\"button_text\"=&gt;\"test\", \"button_url\"=&gt;\"http://www.sddssd.fr\", \"_destroy\"=&gt;\"false\"}},\n       \"remote_image_url\"=&gt;\"\",\n       \"_destroy\"=&gt;\"false\"}}},\n \"time\"=&gt;\"now\",\n \"commit\"=&gt;\"Save Draft\"}\n</code></pre>\n\n<p>What I would need is <code>params[:letter]['cards_attributes']['1514217785795']['buttons_attributes']</code> but I can't know \"1514217785795\". </p>\n\n<p>Any idea how to verify is there are buttons_attributes in my params?</p>\n"}, {"tags": ["ruby", "redirect", "web-scraping", "web-crawler", "http-status-code-301"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9076903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ad9301cee6f2457feeb6abc10ddb10?s=128&d=identicon&r=PG&f=1", "display_name": "m.l", "link": "https://stackoverflow.com/users/9076903/m-l"}, "edited": false, "score": 0, "creation_date": 1514290040, "post_id": 47971824, "comment_id": 82925487, "body": "Haha, you&#39;re right, I have no idea how that 0 got stuck to the end of the link, I must have typed it manually at some point and didn&#39;t notice. And, yes, grabbing the actual list of contracts seems like a much more reasonable idea than checking like 1.5 million url&#39;s for validity, I don&#39;t know why that&#39;s not what the guy does in his tutorial, probably just to show the difference between net/http and nokogiri. Thank you!"}, {"owner": {"reputation": 13, "user_id": 9076903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ad9301cee6f2457feeb6abc10ddb10?s=128&d=identicon&r=PG&f=1", "display_name": "m.l", "link": "https://stackoverflow.com/users/9076903/m-l"}, "edited": false, "score": 0, "creation_date": 1514291035, "post_id": 47971824, "comment_id": 82925842, "body": "Oh, I rechecked and back when he wrote the tutorial contract id&#39;s topped at just 4653, so it wasn&#39;t such an insane thing to do."}], "tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 0, "last_activity_date": 1514233846, "creation_date": 1514233846, "answer_id": 47971824, "question_id": 47969865, "link": "https://stackoverflow.com/questions/47969865/ruby-nethttp-and-redirects/47971824#47971824", "title": "Ruby: Net::HTTP and redirects", "body": "<p>It doesn't seem like Ruby issue but just www.defense.gov manner. <code>https://www.defense.gov/News/Contracts/Contract-View/Article/14038760</code> gives redirect (301) and then 404 despite the way to get it. </p>\n\n<p><code>https://www.defense.gov/News/Contracts/Contract-View/Article/14038760</code> seems like a url to some missing data but <code>https://www.defense.gov/News/Contracts/Contract-View/Article/1403876/</code> works fine (actual for 26.17.2017 03:24 +7). Why do you think the url with id 14038760 is valid?</p>\n\n<p>I've found out that <code>https://www.defense.gov/News/Contracts/Contract-View/Article/1403876</code> redirects to <code>https://www.defense.gov/News/Contracts/Contract-View/Article/1403876/</code> (the same url but with trailing slash) while the url with trailing slash gives 200 response immediately. </p>\n\n<p>What you can do? Try to get here <code>https://www.defense.gov/News/Contracts/source/nav/</code> a list of actual contracts first and then request each of them with separated requests.</p>\n"}], "owner": {"reputation": 13, "user_id": 9076903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9ad9301cee6f2457feeb6abc10ddb10?s=128&d=identicon&r=PG&f=1", "display_name": "m.l", "link": "https://stackoverflow.com/users/9076903/m-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 47971824, "answer_count": 1, "score": 1, "last_activity_date": 1514233846, "creation_date": 1514215028, "last_edit_date": 1514228905, "question_id": 47969865, "link": "https://stackoverflow.com/questions/47969865/ruby-nethttp-and-redirects", "title": "Ruby: Net::HTTP and redirects", "body": "<p>I'm working through tutorials at <a href=\"http://ruby.bastardsbook.com/chapters/web-crawling/\" rel=\"nofollow noreferrer\">http://ruby.bastardsbook.com/chapters/web-crawling/</a> and would like a little clarification on the Handling Redirects one, because the DOD website that the author uses as an example has been remade since the time of writing and I have run into some unexpected results while adjusting his code to work with the current version. (Please note that I don't need help rewriting the code, I'm just wondering why the stuff that happens here happens)</p>\n\n<p>Specifically, I get code 301 no matter whether the page I'm trying to get with <code>Net::HTTP.get_response</code> exists or not. For example:</p>\n\n<pre><code>require 'net/http'\n\nVALID = 'https://www.defense.gov/News/Contracts/Contract-View/Article/14038760'\nINVALID = 'https://www.defense.gov/News/Contracts/Contract-View/Article/14038759'\n\nresp = Net::HTTP.get_response(URI.parse(VALID))\nputs resp.code # 301\n\nresp = Net::HTTP.get_response(URI.parse(INVALID))\nputs resp.code # 301\n</code></pre>\n\n<p>So, why does a valid address return a 301 Moved Permanently? And not only that, but actually trying to follow that redirect (useless in the scope of that tutorial, since the whole point was to skip anything that isn't a 2xx) as suggested here <a href=\"https://stackoverflow.com/questions/7210232/ruby-nethttp-following-301-redirects\">Ruby Net::HTTP - following 301 redirects</a> gives me a 404, presumably because the redirect link has a trailing slash.</p>\n\n<pre><code>if resp.code == '301'\n  resp = Net::HTTP.get_response(URI.parse(resp.header['location']))\nend\nputs resp.code # 404\n</code></pre>\n\n<p>Even more puzzling to me is that when I looked at <code>resp.body</code> I found that despite that 404 error, I had, in fact, successfully downloaded the page's contents.</p>\n\n<p>I would be very grateful if somebody walked me through whatever exactly is going on here. Thank you for your help and for taking your time in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1514214231, "creation_date": 1514214231, "answer_id": 47969774, "question_id": 47969741, "link": "https://stackoverflow.com/questions/47969741/nomethoderror-in-postindex-undefined-method-each-for-post0x9c01d58/47969774#47969774", "title": "NoMethodError in Post#index undefined method `each&#39; for #&lt;Post:0x9c01d58&gt;", "body": "<blockquote>\n  <p>I don't know what is the error</p>\n</blockquote>\n\n<p><code>Post.find</code> returns one post. Naturally, it doesn't respond to <code>each</code>, since it's just one post, not a collection of posts.</p>\n\n<p>What you probably wanted is this:</p>\n\n<pre><code>@posts = Post.where(topic_id: params[:topic_id])\n</code></pre>\n\n<p>but it's hard to tell.</p>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": true, "score": 1, "last_activity_date": 1514214248, "creation_date": 1514214248, "answer_id": 47969781, "question_id": 47969741, "link": "https://stackoverflow.com/questions/47969741/nomethoderror-in-postindex-undefined-method-each-for-post0x9c01d58/47969781#47969781", "title": "NoMethodError in Post#index undefined method `each&#39; for #&lt;Post:0x9c01d58&gt;", "body": "<p><code>Post.find(params[:topic_id])</code> retrieves one instance of <code>Post</code> model, not array.</p>\n\n<p><code>@posts = Post.all</code> retrieves all posts</p>\n\n<p><code>@posts = Post.where(topic_id: params[:topic_id])</code> retrieves all posts for topic</p>\n\n<p><code>@posts = Post.where(user_id: params[:user_id])</code> retrieves all user's posts </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8927599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 47969781, "answer_count": 2, "score": 0, "last_activity_date": 1527179852, "creation_date": 1514213946, "last_edit_date": 1527179852, "question_id": 47969741, "link": "https://stackoverflow.com/questions/47969741/nomethoderror-in-postindex-undefined-method-each-for-post0x9c01d58", "title": "NoMethodError in Post#index undefined method `each&#39; for #&lt;Post:0x9c01d58&gt;", "body": "<p>I am a beginner in Rails. I want to show the list of post which comes under specific topic.\nThis is my controller:</p>\n\n<pre><code>      def index\n        @posts = Post.find(params[:topic_id])\n      end\n</code></pre>\n\n<p>This is my view: </p>\n\n<pre><code>     &lt;% @posts.each do |p| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt; &lt;%= p.user_id %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= p.title %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= p.content %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;i&gt; &lt;%= p.created_at %&gt; &lt;/i&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= link_to 'Show Post', post_path(p) %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= link_to 'Delete Post', post_path(p), method: :delete %&gt; &lt;/td&gt;\n          &lt;td&gt; &lt;%= link_to 'Update Post', edit_post_path(p) %&gt; &lt;/td&gt;\n        &lt;/tr&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p>I am receiving an error which is <code>NoMethodError in Post#index (undefined method 'each' for #&lt;Post:0x9c01d58&gt;)</code>. I don't know what is the error. Can you please explain where the error is?</p>\n"}, {"tags": ["ruby", "login", "mechanize", "spotify"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1514214035, "creation_date": 1514214035, "answer_id": 47969757, "question_id": 47969603, "link": "https://stackoverflow.com/questions/47969603/ruby-login-to-spotify-using-mechanize/47969757#47969757", "title": "Ruby login to spotify using mechanize", "body": "<p>You are trying to call the <code>[]=</code> method on an object which does not understand that method, in particular, you are trying to call it on the object <code>nil</code> which is an object that represents the absence of something.</p>\n\n<p>There are two places where you call the <code>[]=</code> method, on lines 9 and 10, both times on the same object, namely on the object referenced by the variable <code>form</code>. So, your problem is that <code>form</code> is <code>nil</code> for some reason.</p>\n\n<p>Where does <code>form</code> come from? It is assigned on line 7 to the result of calling the <code>first</code> method on the <code>forms</code> accessor of the <code>page</code> object. Ergo, for some reason, <code>first</code> returns <code>nil</code>.</p>\n\n<p>And it's easy to see why: the page you linked to doesn't <em>have</em> a form, so it clearly also doesn't have a first form.</p>\n\n<p>Ergo, you get the error because you expect there to be a form where there isn't any.</p>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1514226075, "post_id": 47969778, "comment_id": 82911549, "body": "However, even the ECMAScript-generated DOM doesn&#39;t contain a form, and even if it did, the ID of the login and password fields aren&#39;t <code>username</code> and <code>password</code>. Practically, <i>every single assumption</i> the script makes is wrong."}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 1, "creation_date": 1514503873, "post_id": 47969778, "comment_id": 83000561, "body": "I see a form, and I see username and password. I can open up a js console and inspect it with <code>$(&#39;[name=password]&#39;)</code> - the problem is, mechanize can&#39;t see it."}], "tags": [], "owner": {"reputation": 2386, "user_id": 2933305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/223ba397b1fef4a7bec7bfc59ca74f11?s=128&d=identicon&r=PG", "display_name": "maicher", "link": "https://stackoverflow.com/users/2933305/maicher"}, "is_accepted": true, "score": 1, "last_activity_date": 1514214243, "creation_date": 1514214243, "answer_id": 47969778, "question_id": 47969603, "link": "https://stackoverflow.com/questions/47969603/ruby-login-to-spotify-using-mechanize/47969778#47969778", "title": "Ruby login to spotify using mechanize", "body": "<p>Check out the body of the page (<code>page.body</code>) and you will see that it's empty.</p>\n\n<p>This is because the body of that page, including form, is rendered by javascript (Angular).</p>\n\n<p>Since Mechanize can't handle javascript you need another solution. Check out: <a href=\"https://stackoverflow.com/questions/802225/how-do-i-use-mechanize-to-process-javascript\">How do I use Mechanize to process JavaScript?</a></p>\n"}], "owner": {"reputation": 88, "user_id": 7867240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3U9py.jpg?s=128&g=1", "display_name": "henrik", "link": "https://stackoverflow.com/users/7867240/henrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 47969778, "answer_count": 2, "score": 0, "last_activity_date": 1514214243, "creation_date": 1514212907, "question_id": 47969603, "link": "https://stackoverflow.com/questions/47969603/ruby-login-to-spotify-using-mechanize", "title": "Ruby login to spotify using mechanize", "body": "<p>I am making a script that requires a spotify login, and I have this code:</p>\n\n<pre><code>require 'mechanize'\n\nmechanize = Mechanize.new\n\npage = mechanize.get('https://accounts.spotify.com/en/login')\n\nform = page.forms.first\n\nform['username'] = 'username'\nform['password'] = 'password'\n\npage = form.submit\n</code></pre>\n\n<p>this code leaves me with this error:</p>\n\n<pre><code>:in `&lt;top (required)&gt;': undefined method `[]=' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>however, if I try the same code on facebook (of course chaning the names), or any other site I've tried I get no error. Could this have something to do with spotifys form not having a post method? I am not too familiar with this kind of stuff, and help would be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "has-many", "belongs-to", "sti"], "answers": [{"tags": [], "owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "is_accepted": true, "score": 0, "last_activity_date": 1514218882, "creation_date": 1514218882, "answer_id": 47970290, "question_id": 47969048, "link": "https://stackoverflow.com/questions/47969048/rails-has-many-sti-with-sub-sti/47970290#47970290", "title": "Rails has_many STI with sub STI", "body": "<p>I think I solved it.</p>\n\n<p>By adding this to <code>venue.rb</code></p>\n\n<pre><code>has_many :apis, :dependent =&gt; :destroy\nhas_many :photos, :through =&gt; :apis, :source =&gt; :api_photos\n</code></pre>\n\n<p>By calling <code>venue.photos[0].url</code> call the right Class based on the <code>type</code> field of the <code>ApiPhoto</code></p>\n"}], "owner": {"reputation": 205, "user_id": 8931936, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10215078780069919/picture?type=large", "display_name": "Daniel Costa", "link": "https://stackoverflow.com/users/8931936/daniel-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 1, "accepted_answer_id": 47970290, "answer_count": 1, "score": 1, "last_activity_date": 1514218882, "creation_date": 1514208200, "last_edit_date": 1514208623, "question_id": 47969048, "link": "https://stackoverflow.com/questions/47969048/rails-has-many-sti-with-sub-sti", "title": "Rails has_many STI with sub STI", "body": "<p>I think it is more of a \"Model Design\" issue than a rails issue.</p>\n\n<p>For clarity sake here is the business logic: I've Venues and I want to implement multiple APIs to get data about those venues. All this APIs have a lot in common, therefore I used STI.</p>\n\n<pre><code># /app/models/venue.rb\nclass Venue &lt; ApplicationRecord\n  has_one :google_api\n  has_one :other_api\n  has_many :apis\nend\n\n# /app/models/api.rb\nclass Api &lt; ApplicationRecord\n  belongs_to :venue\nend\n\n# /app/models/google_api.rb\nclass GoogleApi &lt; Api\n  def find_venue_reference\n    # ...\n  end\n  def synch_data\n    # ...\n  end\nend\n\n# /app/models/other_api.rb\nclass OtherApi &lt; Api\n  def find_venue_reference\n    # ...\n  end\n  def synch_data\n    # ...\n  end\nend\n</code></pre>\n\n<p>That part works, now what I'm trying to add is Photos to the venue. I will be fetching those photos from the API and I realise that every API might be different. I thought about using STI for that as well and I will end up with something like that</p>\n\n<pre><code># /app/models/api_photo.rb\nclass ApiPhoto &lt; ApplicationRecord\n  belongs_to :api\nend\n\n# /app/models/google_api_photo.rb\nclass GoogleApiPhoto &lt; ApiPhoto\n  def url\n    \"www.google.com/#{reference}\"\n  end\nend\n\n# /app/models/other_api_photo.rb\nclass OtherApiPhoto &lt; ApiPhoto\n  def url\n    self[url] || nil\n  end\nend\n</code></pre>\n\n<p>My goal being to have this at the end\n    # /app/models/venue.rb\n    class Venue &lt; ApplicationRecord\n      has_one :google_api\n      has_one :other_api\n      has_many :apis\n      has_many :photos :through => :apis\n    end</p>\n\n<pre><code># /app/views/venues/show.html.erb\n&lt;%# ... %&gt;\n@venue.photos.each do |photo|\n   photo.url\nend\n&lt;%# ... %&gt;\n</code></pre>\n\n<p>And photo.url will give me the right formatting that is dependent of the api it is.</p>\n\n<p>As I'm going deeper in the integration, something seems not right. If I had to <code>Api</code> the <code>has_many :google_api_photo</code> then every Api will have GoogleApiPhoto. What does not make sense to me.</p>\n\n<p>Any idea how I should proceed from here?</p>\n"}, {"tags": ["ruby", "logging"], "answers": [{"tags": [], "owner": {"reputation": 2093, "user_id": 3309314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3683a7a05e7e97a67c262b774db00d08?s=128&d=identicon&r=PG&f=1", "display_name": "user3309314", "link": "https://stackoverflow.com/users/3309314/user3309314"}, "is_accepted": true, "score": 1, "last_activity_date": 1514207995, "last_edit_date": 1514207995, "creation_date": 1514207193, "answer_id": 47968937, "question_id": 47968880, "link": "https://stackoverflow.com/questions/47968880/what-is-the-uid-in-the-logger-library-in-ruby/47968937#47968937", "title": "What is the UID in the logger library in ruby", "body": "<p>It's a <a href=\"https://ruby-doc.org/stdlib-2.1.0/libdoc/logger/rdoc/Logger.html#class-Logger-label-Format\" rel=\"nofollow noreferrer\">pid of ruby process</a>. You can check it with <code>Process.pid</code></p>\n"}], "owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 47968937, "answer_count": 1, "score": 0, "last_activity_date": 1514207995, "creation_date": 1514206685, "question_id": 47968880, "link": "https://stackoverflow.com/questions/47968880/what-is-the-uid-in-the-logger-library-in-ruby", "title": "What is the UID in the logger library in ruby", "body": "<p>I read an article on how to login ruby <a href=\"https://www.sitepoint.com/rubyists-love-logging/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>class MyLog\n  def self.log\n    if @logger.nil?\n      @logger = Logger.new STDOUT\n      @logger.level = Logger::DEBUG\n      @logger.datetime_format = '%Y-%m-%d %H:%M:%S '\n    end\n    @logger\n  end\nend\n</code></pre>\n\n<p>Here are some lines from the log that was created when I used the code:</p>\n\n<pre><code>D, [2017-12-25 14:50:48 #39617] DEBUG -- : Module: ......\nD, [2017-12-25 14:50:48 #39617] DEBUG -- : Module: ......\n</code></pre>\n\n<p>Any idea what is creating the value <strong>39617</strong> ? As far as I can tell, only the format of the date and time is defined. What is controlling the inclusion of this number?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "graphql", "graphql-ruby"], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 8903213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10155717958227660/picture?type=large", "display_name": "Michael Economy", "link": "https://stackoverflow.com/users/8903213/michael-economy"}, "is_accepted": false, "score": 0, "last_activity_date": 1516554109, "last_edit_date": 1516554109, "creation_date": 1515118008, "answer_id": 48106263, "question_id": 47968504, "link": "https://stackoverflow.com/questions/47968504/graphql-ruby-use-not-relay-mutations-dry-with-or-without-graphqlfunction/48106263#48106263", "title": "graphql-ruby. Use (not Relay) mutations DRY. With or without GraphQL::Function?", "body": "<p>Heres what mine currently look like:</p>\n\n<p>blah_schema.rb</p>\n\n<pre><code>BlahSchema = GraphQL::Schema.define do\n  ...\n  query(Types::QueryType)\n</code></pre>\n\n<p>mutation_type.rb</p>\n\n<pre><code>Types::MutationType = GraphQL::ObjectType.define do\n  name \"Mutation\"\n\n\n  field :comment, !Types::CommentType do\n    argument :resource_type, !types.String\n    argument :resource_id,  !types.ID\n    argument :comment, !types.String\n\n    resolve ResolverErrorHandler.new -&gt;(obj, args, ctx) do\n      ctx[:current_user].comments.\n        create!(resource_id: args[:resource_id],\n          resource_type: args[:resource_type],\n          comment: args[:comment])\n    end\n  end\n\n  field :destroy_comment, !Types::CommentType do\n    argument :id, !types.ID\n    resolve ResolverErrorHandler.new -&gt;(obj, args, ctx) do\n      comment = ctx[:current_user].comments.where(id: args[:id]).first\n      if !comment\n        raise ActiveRecord::RecordNotFound.new(\n          \"couldn't find comment for id #{args[:id]} belonging to #{current_user.id}\")\n      end\n\n      comment.destroy!\n      comment\n    end\n  end\nend\n</code></pre>\n\n<p>resolver_error_handler.rb</p>\n\n<pre><code>class ResolverErrorHandler\n\n  def initialize(resolver)\n    @r = resolver\n  end\n\n  def call(obj, args, ctx)\n    @r.call(obj, args, ctx)\n  rescue ActiveRecord::RecordNotFound =&gt; e\n    GraphQL::ExecutionError.new(\"Missing Record: #{e.message}\")\n  rescue AuthorizationError =&gt; e\n    GraphQL::ExecutionError.new(\"sign in required\")\n  rescue ActiveRecord::RecordInvalid =&gt; e\n    # return a GraphQL error with validation details\n    messages = e.record.errors.full_messages.join(\"\\n\")\n    GraphQL::ExecutionError.new(\"Validation failed: #{messages}\")\n  rescue StandardError =&gt; e\n    # handle all other errors\n    Rails.logger.error \"graphql exception caught: #{e} \\n#{e.backtrace.join(\"\\n\")}\"\n    Raven.capture_exception(e)\n\n    GraphQL::ExecutionError.new(\"Unexpected error!\")\n  end\nend\n</code></pre>\n\n<p>So yes it is different - I'm not sure it's better, it's just what i came up with.  My mutation_type.rb is a lot fatter which i don't like.</p>\n\n<p>You didn't clearly spell out any goals or problems so that might help you get a more specific answer.</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 464792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e07d107a684a01166e426d176f9266?s=128&d=identicon&r=PG", "display_name": "Pelted", "link": "https://stackoverflow.com/users/464792/pelted"}, "is_accepted": false, "score": 0, "last_activity_date": 1515525999, "creation_date": 1515525999, "answer_id": 48175344, "question_id": 47968504, "link": "https://stackoverflow.com/questions/47968504/graphql-ruby-use-not-relay-mutations-dry-with-or-without-graphqlfunction/48175344#48175344", "title": "graphql-ruby. Use (not Relay) mutations DRY. With or without GraphQL::Function?", "body": "<p>There is another method I've been utilizing recently. We also do not use React, and it seemed odd to be using <code>GraphQL::Relay::Mutation.define</code> for describing mutations.</p>\n\n<p>Instead we describe the <code>fields</code>. (for example: <strong><code>app/graphql/mutations/create_owner.rb</code></strong>)</p>\n\n<pre><code>Mutations::CreateOwner = GraphQL::Field.define do\n  name 'CreateOwner'\n  type Types::OwnerType\n  description 'Update owner attributes'\n\n  argument :name, !types.String\n  argument :description, types.String\n\n  resolve -&gt;(_obj, args, _ctx) do\n    Owner.create!(args.to_h)\n  end\nend\n</code></pre>\n\n<p>Then in your <strong><code>app/graphql/types/mutation_type.rb</code></strong> you add:</p>\n\n<pre><code>field :createOwner, Mutations::CreateOwner\n</code></pre>\n\n<p>This can be refactored further by extracting resolvers into their own resolver classes.</p>\n\n<p>Without some defined best practices that I've been able to locate, this has been a pretty clean way of dealing with this issue.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 11275596, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gewiN2n-1YI/AAAAAAAAAAI/AAAAAAAAAAc/sBC2tJTStP0/photo.jpg?sz=128", "display_name": "Povilas Jur\u010dys", "link": "https://stackoverflow.com/users/11275596/povilas-jur%c4%8dys"}, "is_accepted": false, "score": 1, "last_activity_date": 1560143831, "creation_date": 1560143831, "answer_id": 56520841, "question_id": 47968504, "link": "https://stackoverflow.com/questions/47968504/graphql-ruby-use-not-relay-mutations-dry-with-or-without-graphqlfunction/56520841#56520841", "title": "graphql-ruby. Use (not Relay) mutations DRY. With or without GraphQL::Function?", "body": "<p>You should try <a href=\"https://github.com/samesystem/graphql_rails\" rel=\"nofollow noreferrer\">https://github.com/samesystem/graphql_rails</a> gem. It has MVC structure on graphql side, so your GraphQL will be almost the same as your RoR code.</p>\n\n<blockquote>\n  <p>And what if I want a unique file for all link operations (CRUD)?</p>\n</blockquote>\n\n<p>GraphqlRails has controllers instead of resolvers. You could have something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CommentsController &lt; GraphqlRails::Controller\n  action(:create).permit(:article_id, :body).returns(!Types::CommentType)\n  action(:update).permit(:id, :body).returns(!Types::CommentType)\n\n  def create\n    Comment.create!(params)\n  end\n\n  def update\n    Comment.find(params[:id]).update!(params)\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1292, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1560143831, "creation_date": 1514204002, "question_id": 47968504, "link": "https://stackoverflow.com/questions/47968504/graphql-ruby-use-not-relay-mutations-dry-with-or-without-graphqlfunction", "title": "graphql-ruby. Use (not Relay) mutations DRY. With or without GraphQL::Function?", "body": "<p><em><strong>I'M NOT USING RELAY.</strong></em></p>\n\n<p>I have read some tutorials. Many use this way for mutations:</p>\n\n<p><strong>app/graphql/graphql_tutorial_schema.rb</strong></p>\n\n<pre><code>GraphqlTutorialSchema = GraphQL::Schema.define do\n  query(Types::QueryType)\n  mutation(Types::MutationType)\nend\n</code></pre>\n\n<p><strong>app/graphql/resolvers/create_link.rb</strong></p>\n\n<pre><code>class Resolvers::CreateLink &lt; GraphQL::Function\n  argument :description, !types.String\n  argument :url, !types.String\n\n  type Types::LinkType\n\n  def call(_obj, args, _ctx)\n    Link.create!(\n      description: args[:description],\n      url: args[:url],\n    )\n  end\nend\n</code></pre>\n\n<p>and finally they have:</p>\n\n<p><strong>app/graphql/types/mutation_type.rb</strong></p>\n\n<pre><code>Types::MutationType = GraphQL::ObjectType.define do\n  name 'Mutation'\n\n  field :createLink, function: Resolvers::CreateLink.new\nend\n</code></pre>\n\n<p>So they are using a <code>GraphQL::Function</code>.</p>\n\n<p><strong>Is this the way to go?</strong> If I'm not using Relay this is just the only way to go?</p>\n\n<p>And what if I want a unique file for all <code>link</code> operations (CRUD)?</p>\n\n<p>Other tutorials (<a href=\"http://tech.eshaiju.in/blog/2017/05/15/graphql-mutation-query-implementation-ruby-on-rails/\" rel=\"nofollow noreferrer\">http://tech.eshaiju.in/blog/2017/05/15/graphql-mutation-query-implementation-ruby-on-rails/</a>) use this:</p>\n\n<p><strong>app/graphql/mutations/comment_mutations.rb</strong></p>\n\n<pre><code>module CommentMutations\n  Create = GraphQL::Relay::Mutation.define do\n    name \"AddComment\"\n\n    # Define input parameters\n    input_field :articleId, !types.ID\n    input_field :userId, !types.ID\n    input_field :comment, !types.String\n\n    # Define return parameters\n    return_field :article, ArticleType\n    return_field :errors, types.String\n\n    resolve -&gt;(object, inputs, ctx) {\n      article = Article.find_by_id(inputs[:articleId])\n      return { errors: 'Article not found' } if article.nil?\n\n      comments = article.comments\n      new_comment = comments.build(user_id: inputs[:userId], comment: inputs[:comment])\n      if new_comment.save\n        { article: article }\n      else\n        { errors: new_comment.errors.to_a }\n      end\n    }\n  end\nend\n</code></pre>\n\n<p>and <strong>app/graphql/mutations/mutation_type.rb</strong></p>\n\n<pre><code>MutationType = GraphQL::ObjectType.define do\n  name \"Mutation\"\n  # Add the mutation's derived field to the mutation type\n  field :addComment, field: CommentMutations::Create.field\nend\n</code></pre>\n\n<p>so I can add also:</p>\n\n<pre><code>MutationType = GraphQL::ObjectType.define do\n  name \"Mutation\"\n  field :addComment, field: CommentMutations::Create.field\n  field :updateComment, field: CommentMutations::Update.field\n  field :deleteComment, field: CommentMutations::Delete.field\nend\n</code></pre>\n\n<p>But this works good just with <code>Create = GraphQL::Relay::Mutation.define</code>: <strong>I'm not using Relay</strong>!</p>\n\n<p>In your docs I find nothing related to this problem.</p>\n\n<p><strong>I have to always use GraphQL::Functions?</strong></p>\n\n<p>Or maybe I can use it this way:</p>\n\n<pre><code>MutationType = GraphQL::ObjectType.define do\n  name \"Mutation\"\n  field :addComment, field: CommentMutations::Create\n  field :updateComment, field: CommentMutations::Update\n  field :deleteComment, field: CommentMutations::Delete\nend\n</code></pre>\n\n<p>and have this (code is an example):</p>\n\n<pre><code>module Mutations::commentMutations\n  Createcomment = GraphQL::ObjectType.define do\n    name \"Createcomment\"\n\n    input_field :author_id, !types.ID\n    input_field :post_id, !types.ID\n\n    return_field :comment, Types::commentType\n    return_field :errors, types.String\n\n    resolve -&gt;(obj, inputs, ctx) {\n      comment = comment.new(\n        author_id: inputs[:author_id],\n        post_id: inputs[:post_id]\n      )\n\n      if comment.save\n        { comment: comment }\n      else\n        { errors: comment.errors.to_a }\n      end\n    }\n  end\n\nUpdatecomment = GraphQL::ObjectType.define do\n    name \"Updatecomment\"\n\n    input_field :author_id, !types.ID\n    input_field :post_id, !types.ID\n\n    return_field :comment, Types::commentType\n    return_field :errors, types.String\n\n    resolve -&gt;(obj, inputs, ctx) {\n      comment = comment.new(\n        author_id: inputs[:author_id],\n        post_id: inputs[:post_id]\n      )\n\n      if comment.update\n        { comment: comment }\n      else\n        { errors: comment.errors.to_a }\n      end\n    }\n  end\nend\n</code></pre>\n\n<p><strong>Is this another way?</strong></p>\n"}, {"tags": ["arrays", "ruby", "loops", "count", "integer"], "comments": [{"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1514200476, "post_id": 47968011, "comment_id": 82905601, "body": "add your <code>squarenumbers</code> array as well."}, {"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1514201038, "post_id": 47968011, "comment_id": 82905741, "body": "what d is doing? you are converting it to string? why? 2nd thing <code>squarenumbers.map { |a| a.to_s }</code> doesnt change <code>squarenumbers</code> squarenumbers is still an array of numbers. 3rd thing <code>squarenumbers[k]</code> will never have <code>&#39;d&#39;</code> in it so it will always return 0"}, {"owner": {"reputation": 129, "user_id": 9137141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb156e6cf5fd74311ee5b9967c96ee85?s=128&d=identicon&r=PG&f=1", "display_name": "rb20", "link": "https://stackoverflow.com/users/9137141/rb20"}, "reply_to_user": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 0, "creation_date": 1514202734, "post_id": 47968011, "comment_id": 82906185, "body": "@Manishh I converted d to a string because the way I was going to do this was convert the square numbers to strings and then use include? to count the number of times the number d appears in the numbers, but I&#39;ve realised this won&#39;t work as it won&#39;t count repeats. Why does map not change the elements? Do I need to store this in a separate array? Why will it return zero if I use include and check each element of the array?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1514225053, "post_id": 47968011, "comment_id": 82911304, "body": "You need to replace the first sentence with a better description of the problem. My answer begins with one possible interpretation."}], "answers": [{"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1514203062, "post_id": 47968361, "comment_id": 82906260, "body": "Or just <code>[&#39;hello&#39;,&#39;one&#39;,&#39;two&#39;].join.count(&#39;o&#39;)</code>."}, {"owner": {"reputation": 129, "user_id": 9137141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb156e6cf5fd74311ee5b9967c96ee85?s=128&d=identicon&r=PG&f=1", "display_name": "rb20", "link": "https://stackoverflow.com/users/9137141/rb20"}, "edited": false, "score": 0, "creation_date": 1514205338, "post_id": 47968361, "comment_id": 82906813, "body": "@SagarPandya Thanks for your answer, I have now edited my code, to this \tsquarenumbers = []   for k in 1..n \tsquarenumbers &lt;&lt; k**2 \tend   strings = Array.new   strings = squarenumbers.map {|a| a.to_s}   d.to_s   print strings.count(d)                                                                                               The count is returning nil though, why is this?"}], "tags": [], "owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "is_accepted": false, "score": 0, "last_activity_date": 1514202868, "creation_date": 1514202868, "answer_id": 47968361, "question_id": 47968011, "link": "https://stackoverflow.com/questions/47968011/counting-the-number-of-times-a-character-appears-in-an-array-of-strings-in-ruby/47968361#47968361", "title": "Counting the number of times a character appears in an array of strings in Ruby", "body": "<blockquote>\n  <p>I'm writing a method that needs to check every element in an array for\n  a given character and return the number of times the character appears\n  altogether in the elements of the array.</p>\n</blockquote>\n\n<p>Assuming you have an array of strings then you can use <code>sum</code> and <code>count</code>.</p>\n\n<pre><code>['hello','one','two'].sum { |s| s.count('o') }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1514261450, "last_edit_date": 1514261450, "creation_date": 1514226710, "answer_id": 47971114, "question_id": 47968011, "link": "https://stackoverflow.com/questions/47968011/counting-the-number-of-times-a-character-appears-in-an-array-of-strings-in-ruby/47971114#47971114", "title": "Counting the number of times a character appears in an array of strings in Ruby", "body": "<p>My answer assumes that the problem is as follows: \"Given an array of natural numbers (non-negative integers) and a digit <code>d</code> (an integer <code>0-9</code>), compute the total number of digits  equal to <code>d</code> for each element of the array and sum those totals over all elements of the array\".</p>\n\n<p>Note that this description makes no reference to perfect squares. That's because the way the array of natural numbers is constructed is irrelevant.</p>\n\n<p>Let's first construct a method that computes the number of times a given digit <code>d</code> appears in a natural number <code>n</code>.</p>\n\n<pre><code>def digit_in_number_count(n, digit)\n  n.digits.count(digit)\nend\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Integer.html#method-i-digits\" rel=\"nofollow noreferrer\">Integer#digits</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-count\" rel=\"nofollow noreferrer\">Array#count</a>.</p>\n\n<p>It's now just a matter of summing those counts over all elements in the array. Let <code>a</code> denote an array of natural numbers.</p>\n\n<pre><code>def digit_in_array_count(a, digit)\n  a.sum { |n| digit_in_number_count(n, digit) }\nend\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-sum\" rel=\"nofollow noreferrer\">Array#sum</a>. </p>\n\n<p>Here's an example.</p>\n\n<pre><code>a = [123425, 622252, 136407]\ndigit = 2\n\ndigit_in_number_count(123425, digit)\n  #=&gt; 2\ndigit_in_array_count(a, digit)\n  #=&gt; 6\n</code></pre>\n\n<p><code>Integer#digits</code> and <code>Array#sum</code> both made their debut in Ruby v2.4. To support earlier versions of Ruby, you could modify the methods as follows.</p>\n\n<pre><code>def digit_in_number_count(n, digit)\n  n.to_s.count(digit.to_s)\nend\n\ndef digit_in_array_count(a, digit)\n  a.reduce(0) { |t,n| t + digit_in_number_count(n, digit) }\nend\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">Enumerable#reduce</a> (<a href=\"https://en.wikipedia.org/wiki/Aka\" rel=\"nofollow noreferrer\">a.k.a.</a> <code>inject</code>) and <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-count\" rel=\"nofollow noreferrer\">String#count</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 286, "user_id": 8735137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8858ce3c6545c51df9ce5466692d3680?s=128&d=identicon&r=PG&f=1", "display_name": "ishando", "link": "https://stackoverflow.com/users/8735137/ishando"}, "is_accepted": false, "score": 0, "last_activity_date": 1514264607, "creation_date": 1514264607, "answer_id": 47974054, "question_id": 47968011, "link": "https://stackoverflow.com/questions/47968011/counting-the-number-of-times-a-character-appears-in-an-array-of-strings-in-ruby/47974054#47974054", "title": "Counting the number of times a character appears in an array of strings in Ruby", "body": "<p>For an array of numbers you could do:</p>\n\n<pre><code>squarenumbers.sum {|e| e.to_a.count(d)}\n</code></pre>\n\n<p>If <code>d</code> is numeric, you would want to change it to <code>d.to_s</code></p>\n"}], "owner": {"reputation": 129, "user_id": 9137141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb156e6cf5fd74311ee5b9967c96ee85?s=128&d=identicon&r=PG&f=1", "display_name": "rb20", "link": "https://stackoverflow.com/users/9137141/rb20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1369, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1514264607, "creation_date": 1514199871, "last_edit_date": 1514203939, "question_id": 47968011, "link": "https://stackoverflow.com/questions/47968011/counting-the-number-of-times-a-character-appears-in-an-array-of-strings-in-ruby", "title": "Counting the number of times a character appears in an array of strings in Ruby", "body": "<p>Hi I'm writing a method that needs to check every element in an array for a given character and return the number of times the character appears altogether in the elements of the array.</p>\n\n<p>For creating <code>squarenumbers</code> array I have this code:</p>\n\n<pre><code> squarenumbers = []\n for k in 1..n\n   squarenumbers &lt;&lt; k**2\n end\n squarenumbers.map { |a| a.to_s }\n d.to_s\n</code></pre>\n\n<p>And to count the digit so far I have written:</p>\n\n<pre><code>for k in 0..n-1\n   count =+1 if squarenumbers[k].include?\"d\" \nend \n</code></pre>\n\n<p>I have created an array of size <code>n</code> containing the square numbers from <code>1 to n</code> and I am now having trouble counting how many times the number <code>d</code> appears in each element.</p>\n\n<p>I converted <code>d</code> to a string in the method and cannot understand why the count is not working. I apologise I'm a beginner but I thought what I've written would check each element in the array for the character d and add 1 to the counter every time a string contains it.</p>\n\n<p>Thanks for all your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 31555, "user_id": 677684, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5a785c03c08d7de6a15aaea326835cd6?s=128&d=identicon&r=PG", "display_name": "Tilo", "link": "https://stackoverflow.com/users/677684/tilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1514207288, "creation_date": 1514207288, "answer_id": 47968943, "question_id": 47967947, "link": "https://stackoverflow.com/questions/47967947/upgrade-rails-version-permission-denied-rvm-folder-bin-rails/47968943#47968943", "title": "Upgrade rails version permission denied rvm folder /bin/rails", "body": "<ul>\n<li>check if you are logged in as the correct user</li>\n<li>check if the permissions of the user\u2019s home directory are correct, e.g. /home/xxx/</li>\n<li>remove the ruby under /usr/local/bin</li>\n<li>reinstall rvm if all fails</li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 8065996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25b3d44087ff4d6d4c9f772f73f9d7e4?s=128&d=identicon&r=PG&f=1", "display_name": "Alessio Varalta", "link": "https://stackoverflow.com/users/8065996/alessio-varalta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514207288, "creation_date": 1514199352, "question_id": 47967947, "link": "https://stackoverflow.com/questions/47967947/upgrade-rails-version-permission-denied-rvm-folder-bin-rails", "title": "Upgrade rails version permission denied rvm folder /bin/rails", "body": "<p>I try to install rails 3.2.20 with ruby2.2.0.</p>\n\n<p>So with rvm I make</p>\n\n<p>rvm install 2.2.0</p>\n\n<p>After I make</p>\n\n<p>gem install rails -v 3.2.20</p>\n\n<p>After rvm use default ruby-2.2.2</p>\n\n<p>But when I try rails -v, I have the error</p>\n\n<p>-bash: /home/xxx/.rvm/gems/ruby-2.2.0/bin/rails: Permission denied</p>\n\n<p>Why? I try also chmod -R 777 on .rvm but nothing change</p>\n\n<p>If I try</p>\n\n<p>which ruby I have </p>\n\n<p>/usr/local/rvm/rubies/ruby-2.2.0/bin/ruby</p>\n\n<p>If I try whch rails I have nothing</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1514199341, "post_id": 47967924, "comment_id": 82905319, "body": "&quot;What am I doing differently?&quot; - order of the operands."}], "answers": [{"tags": [], "owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "is_accepted": true, "score": 4, "last_activity_date": 1514199287, "creation_date": 1514199287, "answer_id": 47967939, "question_id": 47967924, "link": "https://stackoverflow.com/questions/47967924/string-cant-be-coerced-into-fixnum-trying-to-create-padding-of-spaces/47967939#47967939", "title": "String can&#39;t be coerced into Fixnum (trying to create padding of spaces)", "body": "<p>Just reverse the sequence of <code>' '</code> and <code>5</code> it will work.</p>\n\n<pre><code>spaces = \" \"\nmultiplied_spaces = spaces * 5\n=&gt; \"     \"\n</code></pre>\n"}], "owner": {"reputation": 816, "user_id": 5006720, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/9pfXu.png?s=128&g=1", "display_name": "ARL", "link": "https://stackoverflow.com/users/5006720/arl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47967939, "answer_count": 1, "score": -2, "last_activity_date": 1514199287, "creation_date": 1514199109, "question_id": 47967924, "link": "https://stackoverflow.com/questions/47967924/string-cant-be-coerced-into-fixnum-trying-to-create-padding-of-spaces", "title": "String can&#39;t be coerced into Fixnum (trying to create padding of spaces)", "body": "<p>I dont understand why I get the following error:</p>\n\n<pre><code>irb(main):001:0&gt; spaces = \" \"\n=&gt; \" \"\nirb(main):002:0&gt; multiplied_spaces = 5 * spaces\nTypeError: String can't be coerced into Fixnum\n    from (irb):2:in `*'\n    from (irb):2\n    from /usr/local/opt/ruby@2.2/bin/irb:11:in `&lt;main&gt;'\nirb(main):003:0&gt;\n</code></pre>\n\n<p>spaces represents a string, and from what I can see in many other questions here is one <a href=\"https://stackoverflow.com/a/3179198/5006720\">example</a>, this should work</p>\n\n<p>What am I doing differently?</p>\n"}, {"tags": ["javascript", "jquery", "css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1308, "user_id": 3759158, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/70BLw.jpg?s=128&g=1", "display_name": "Manishh", "link": "https://stackoverflow.com/users/3759158/manishh"}, "edited": false, "score": 1, "creation_date": 1514193358, "post_id": 47967266, "comment_id": 82904005, "body": "did you tried adding owl.theme as well?"}, {"owner": {"reputation": 2459, "user_id": 4335939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb0b29c3e5f8bfb6df024db43a0d091?s=128&d=identicon&r=PG", "display_name": "Nathaniel Flick", "link": "https://stackoverflow.com/users/4335939/nathaniel-flick"}, "edited": false, "score": 1, "creation_date": 1514194662, "post_id": 47967266, "comment_id": 82904284, "body": "Do you have a url we can see this in action? Do you have any js errors or missing files?"}], "owner": {"reputation": 1, "user_id": 7733914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd230e2cba575c712a141e1d71f369f8?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/7733914/malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514193172, "creation_date": 1514193172, "question_id": 47967266, "link": "https://stackoverflow.com/questions/47967266/owl-carousel-slider-not-working-in-ruby-on-rails-5-1-4", "title": "Owl Carousel Slider not working in Ruby on Rails 5.1.4", "body": "<p>I'm trying to implement owl carousel in my rails app.but the owl carousel won't display. In my <code>gem file</code> i have added the following gems.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>gem 'jquery-rails', '~&gt; 4.3', '&gt;= 4.3.1'\r\ngem 'popper_js', '~&gt; 1.12.9'\r\ngem 'bootstrap', '~&gt; 4.0.0.beta2.1'\r\ngem 'owlcarousel-rails', '~&gt; 1.1', '&gt;= 1.1.3.3'</code></pre>\r\n</div>\r\n</div>\r\n\nAnd in <code>application.js</code> the code looks like </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>//= require jquery3\r\n//= require popper\r\n//= require bootstrap\r\n//= require owl.carousel\r\n//= require active\r\n//= require rails-ujs\r\n//= require turbolinks</code></pre>\r\n</div>\r\n</div>\r\n And my <code>active.js</code> contains this code </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>(function ($) {\r\n    'use strict';\r\n\r\n    \r\n// :: 1.0 Owl Carousel Active Code\r\n    if ($.fn.owlCarousel) {\r\n        $(\".welcome_slides\").owlCarousel({\r\n            items: 1,\r\n            loop: true,\r\n            autoplay: true,\r\n            smartSpeed: 1500,\r\n            nav: true,\r\n            navText: [\"&lt;i class='pe-7s-angle-left'&lt;/i&gt;\", \"&lt;i class='pe-7s-angle-right'&lt;/i&gt;\"]\r\n        });\r\n        $(\".app_screenshots_slides\").owlCarousel({\r\n            items: 1,\r\n            loop: true,\r\n            autoplay: true,\r\n            smartSpeed: 800,\r\n            margin: 30,\r\n            center: true,\r\n            dots: true,\r\n            responsive: {\r\n                0: {\r\n                    items: 1\r\n                },\r\n                480: {\r\n                    items: 3\r\n                },\r\n                992: {\r\n                    items: 5\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n})(jQuery);</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Code of <code>application.css</code> is </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code> *= require_tree .\r\n *= require_self</code></pre>\r\n</div>\r\n</div>\r\n And in <code>Style.css.scss</code> i have to import these two css. </p>\n\n<pre><code>@import \"bootstrap\";\n@import \"owl.carousel\";\n</code></pre>\n\n<p>And in my <code>index.html.erb</code> file code is </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"container-fluid\"&gt;\r\n            &lt;div class=\"row\"&gt;\r\n                &lt;div class=\"col-12\"&gt;\r\n                    &lt;!-- App Screenshots Slides  --&gt;\r\n                    &lt;div class=\"app_screenshots_slides owl-carousel\"&gt;\r\n                        &lt;div class=\"single-shot\"&gt;\r\n                            \r\n                            &lt;%=image_tag(\"scr-img/1.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;div class=\"single-shot\"&gt;\r\n                            &lt;%=image_tag(\"scr-img/2.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;div class=\"single-shot\"&gt;\r\n                            &lt;%=image_tag(\"scr-img/3.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;div class=\"single-shot\"&gt;\r\n                            &lt;%=image_tag(\"scr-img/4.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n                        &lt;div class=\"single-shot\"&gt;\r\n                            &lt;%=image_tag(\"scr-img/1.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n\t\t\t\t\t\t&lt;div class=\"single-shot\"&gt;\r\n                            &lt;%=image_tag(\"scr-img/3.png\", alt: \"\")%&gt;\r\n                        &lt;/div&gt;\r\n                    &lt;/div&gt;\r\n                &lt;/div&gt;\r\n            &lt;/div&gt;\r\n        &lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n\nMy rails version is 5.1.4 and ruby version is 2.4.3p205.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "email", "devise"], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1514192616, "creation_date": 1514192616, "answer_id": 47967199, "question_id": 47966920, "link": "https://stackoverflow.com/questions/47966920/holding-sending-reset-password-emails-until-some-indecator-devise-rails/47967199#47967199", "title": "Holding sending reset password emails until some indecator devise rails", "body": "<p>You can use <a href=\"https://github.com/plataformatec/devise/blob/f39c6fd92774cb66f96f546d8d5e8281542b4e78/lib/devise/models/recoverable.rb#L77-L79\" rel=\"nofollow noreferrer\"><code>user.reset_password_period_valid?</code></a></p>\n\n<pre><code>def reset_password_period_valid?\n  reset_password_sent_at &amp;&amp; reset_password_sent_at.utc &gt;= self.class.reset_password_within.ago.utc\nend\n</code></pre>\n\n<p>This is essentially exactly the implementation you were suggesting; but it's already built-in if you're using the <code>Rcoverable</code> devise module!</p>\n"}], "owner": {"reputation": 536, "user_id": 8436554, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/d3XUa.jpg?s=128&g=1", "display_name": "Amr Adel", "link": "https://stackoverflow.com/users/8436554/amr-adel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47967199, "answer_count": 1, "score": 0, "last_activity_date": 1514192616, "creation_date": 1514189904, "question_id": 47966920, "link": "https://stackoverflow.com/questions/47966920/holding-sending-reset-password-emails-until-some-indecator-devise-rails", "title": "Holding sending reset password emails until some indecator devise rails", "body": "<p>I have a <code>PasswordController</code> inherit from <code>Devise::PasswordsController</code>, I made a <code>create</code> function that helps me to send user reset password notification email, its implementation:</p>\n\n<pre><code>  def create\n    # I need to put some condition on the next line\n    self.resource = resource_class.send_reset_password_instructions(resource_params)\n    if successfully_sent?(resource)\n      render :json =&gt; \"Request successfully sent\"\n    else\n      render :json =&gt; resource.errors, :status =&gt; 422\n    end\n  end\n</code></pre>\n\n<p>It works fine but if user clicked on reset password 5 times 5 emails will be sent to him (If a delay happened or something <strong>users never waits, they need fast resposne</strong>) and the last one will only work, So I want to disable sending email until this token expired or something, I searched about it but couldn't find anything, I thought about make a new attribute inside user table which will be a <code>datetime</code> to indicate when was the last time the email has been sent but i'm asking if there is a better way to make using devise.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "edited": false, "score": 0, "creation_date": 1514187780, "post_id": 47966679, "comment_id": 82902876, "body": "Does the string always start with <code>da_report&#47;GY4LFDN6&#47;</code>?"}, {"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 1, "creation_date": 1514187840, "post_id": 47966679, "comment_id": 82902888, "body": "What are the rules?"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1514188241, "post_id": 47966679, "comment_id": 82902965, "body": "yes, it always start with <code>da_report&#47;GY4LFDN6&#47;</code>"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514188408, "post_id": 47966679, "comment_id": 82902990, "body": "@CodaChang Even so, it doesn&#39;t mean that it would be good practice to hard code these values, unless you only want to target these types of paths in particular."}], "answers": [{"tags": [], "owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "is_accepted": false, "score": 0, "last_activity_date": 1514187822, "creation_date": 1514187822, "answer_id": 47966719, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression/47966719#47966719", "title": "Ruby extract string via regular expression", "body": "<p>Use <code>/(?&lt;=GY4LFDN6\\/)(.*)(?=\\/index.html)/</code></p>\n\n<pre><code>str = 'da_report/GY4LFDN6/2017_11/view_mission_join_player_count2017_11/index.html'\nstr[/(?&lt;=GY4LFDN6\\/)(.*)(?=\\/index.html)/]\n =&gt; \"2017_11/view_mission_join_player_count2017_11\"\n</code></pre>\n\n<p>live demo:  <a href=\"http://rubular.com/r/Ued6UOXWDf\" rel=\"nofollow noreferrer\">http://rubular.com/r/Ued6UOXWDf</a></p>\n"}, {"tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 0, "last_activity_date": 1514188970, "last_edit_date": 1514188970, "creation_date": 1514188193, "answer_id": 47966742, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression/47966742#47966742", "title": "Ruby extract string via regular expression", "body": "<p>This answer assumes that you want to capture beginning with the third component of the path, up to and including the last component of the path before the filename.  If so, then we can use the following regex pattern:</p>\n\n<pre><code>(?:[^/]*/){2}(.*)/.*\n</code></pre>\n\n<p>The quantity in parentheses is the capture group, i.e. what you want to extract from the entire path.</p>\n\n<pre><code>str = 'da_report/GY4LFDN6/2017_11/view_mission_join_player_count2017_11/index.html'\nputs str[/(?:[^\\/]*\\/){2}(.*)\\/.*/, 1]\n</code></pre>\n\n<p><a href=\"http://rextester.com/FITL31956\" rel=\"nofollow noreferrer\"><h2>Demo</h2></a></p>\n"}, {"tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 0, "last_activity_date": 1514188974, "last_edit_date": 1514188974, "creation_date": 1514188317, "answer_id": 47966748, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression/47966748#47966748", "title": "Ruby extract string via regular expression", "body": "<p>If you are looking for the values at the end of the string like in the format <code>string/string</code> followed by <code>/filename.extension</code>, you could use a positive lookahead for a file name.</p>\n\n<p><a href=\"http://rubular.com/r/J1Gz2eyTq6\" rel=\"nofollow noreferrer\"><code>\\w+\\/\\w+(?=\\/\\w+\\.\\w+$)</code></a></p>\n\n<p><a href=\"http://rextester.com/LKPRV86878\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1514188826, "post_id": 47966769, "comment_id": 82903076, "body": "Oh, I know this way, and it&#39;s a great answer. But I just want to try the regex way."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 1, "creation_date": 1514188926, "post_id": 47966769, "comment_id": 82903099, "body": "<code>str[%r|(?&lt;=\\Ada_report&#47;GY4LFDN6&#47;)\\w+&#47;\\w+|]</code> (\u201cI just want to use a regexp\u201c sounds a bit silly to me; regexp is <i>not</i> a way to go here.)"}, {"owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "edited": false, "score": 0, "creation_date": 1514190197, "post_id": 47966769, "comment_id": 82903341, "body": "Thanks, I will change my way to achieve that."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514196673, "post_id": 47966769, "comment_id": 82904693, "body": "@mudasobwa I disagree with your notion of using regex here.  If the OP wanted to filter paths using names, then a string join approach would not be workable.  Regex is not prone to error if the person using it knows regex."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514197322, "post_id": 47966769, "comment_id": 82904855, "body": "@TimBiegeleisen if that was a different task, the different ways to solve it would probably be better. Also, I never said \u201cregexp is prone to errors,\u201d I said \u201chere it\u2019s prone to error.\u201d Also, it\u2019s noticeably slower."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1514188874, "last_edit_date": 1514188874, "creation_date": 1514188490, "answer_id": 47966769, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression/47966769#47966769", "title": "Ruby extract string via regular expression", "body": "<p>Regular expression is an overkill here, and i prone to errors.</p>\n\n<pre><code>input = [\n  \"da_report/GY4LFDN6/\" \\\n  \"2017_11/view_mission_join_player_count2017_11\" \\\n  \"/index.html\",\n  \"da_report/GY4LFDN6/\" \\\n  \"2017_11/activily_time2017_11\" \\\n  \"/index.html\"\n]  \n\ninput.map { |str| str.split('/')[2..3].join('/') }\n#\u21d2 [\n#   [0] \"2017_11/view_mission_join_player_count2017_11\",\n#   [1] \"2017_11/activily_time2017_11\"\n# ]\n</code></pre>\n\n<p>or, more elegant:</p>\n\n<pre><code>input.map { |str| str.split('/').grep(/2017_/).join('/') }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1514266509, "creation_date": 1514266509, "answer_id": 47974246, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression/47974246#47974246", "title": "Ruby extract string via regular expression", "body": "<p>Based on your examples, you may be able to use a very simple regex.</p>\n\n<pre><code>def extract(str)\n  str[/\\d{4}_\\d{2}.+\\d{4}_\\d{2}/]\nend\n\nextract 'da_report/GY4LFDN6/2017_11/view_mission_join_player_count2017_11/index.html'\n  #=&gt; \"2017_11/view_mission_join_player_count2017_11\"\nextract 'da_report/GY4LFDN6/2017_11/activily_time2017_11/index.html'\n  #=&gt; \"2017_11/activily_time2017_11\"\n</code></pre>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47966769, "answer_count": 5, "score": 0, "last_activity_date": 1514266509, "creation_date": 1514187546, "last_edit_date": 1514190039, "question_id": 47966679, "link": "https://stackoverflow.com/questions/47966679/ruby-extract-string-via-regular-expression", "title": "Ruby extract string via regular expression", "body": "<p>I have these strings:</p>\n\n<pre><code>'da_report/GY4LFDN6/2017_11/view_mission_join_player_count2017_11/index.html'\n'da_report/GY4LFDN6/2017_11/activily_time2017_11/index.html'\n</code></pre>\n\n<p>From these two strings, I want to extract these two file names:</p>\n\n<pre><code>'2017_11/view_mission_join_player_count2017_11'\n'2017_11/activily_time2017_11'\n</code></pre>\n\n<p>I wrote some regular expressions, but they seem wrong.</p>\n\n<pre><code>str = 'da_report/GY4LFDN6/2017_11/view_mission_join_player_count2017_11/index.html'\nstr[/([^\\/index.html]+)/, 1] # =&gt; \"a_r\"\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "aws-sdk", "amazon-sns"], "answers": [{"tags": [], "owner": {"reputation": 4786, "user_id": 907201, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7E2LT.png?s=128&g=1", "display_name": "gmaliar", "link": "https://stackoverflow.com/users/907201/gmaliar"}, "is_accepted": false, "score": 0, "last_activity_date": 1514193054, "creation_date": 1514193054, "answer_id": 47967253, "question_id": 47962827, "link": "https://stackoverflow.com/questions/47962827/aws-sdk-for-ruby-how-to-set-message-attributes-to-awssnsclient/47967253#47967253", "title": "aws-sdk for Ruby: how to set message_attributes to Aws::SNS::Client?", "body": "<p>Have a look at <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/SNS/Client.html#set_sms_attributes-instance_method\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/sdkforruby/api/Aws/SNS/Client.html#set_sms_attributes-instance_method</a></p>\n\n<pre><code>resp = client.set_sms_attributes({\n  attributes: {\n    \"DefaultSenderID\" =&gt; \"Your ID\",\n  },\n})\n</code></pre>\n"}], "owner": {"reputation": 800, "user_id": 2357117, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fe14d5dc3536d1c33d722c8387dfd991?s=128&d=identicon&r=PG", "display_name": "yskkin", "link": "https://stackoverflow.com/users/2357117/yskkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514193054, "creation_date": 1514137622, "last_edit_date": 1514178899, "question_id": 47962827, "link": "https://stackoverflow.com/questions/47962827/aws-sdk-for-ruby-how-to-set-message-attributes-to-awssnsclient", "title": "aws-sdk for Ruby: how to set message_attributes to Aws::SNS::Client?", "body": "<p>I would like to set <code>AWS.SNS.SMS.SenderID</code> when sending SMS via Amazon SNS.</p>\n\n<p>This code successfully send message, but sender ID wan not <code>MySenderID</code> and instead phone number is shown.</p>\n\n<pre><code>@sns_client ||= Aws::SNS::Client.new(region: \"ap-northeast-1\", credentials: credentials)\n@sns_client.publish(\n  phone_number: \"+81xxxxxxxxxx\",\n  message: message,\n  message_attributes: {\n    \"AWS.SNS.SMS.SMSType\" =&gt; { data_type: \"String\", string_value: \"Transactional\" },\n    \"AWS.SNS.SMS.SenderID\" =&gt; { data_type: \"String\", string_value: \"MySenderID\" }\n  }\n)\n</code></pre>\n\n<p>Since I can successfully set sender ID via web console, there should be a way to set it programaticcally in Ruby.</p>\n\n<p>How can I set senderID?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1514136940, "post_id": 47962614, "comment_id": 82894701, "body": "Surely. Check the source code."}, {"owner": {"reputation": 25043, "user_id": 1417223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbdfe3d2d5f87f172757ada1438f3d16?s=128&d=identicon&r=PG", "display_name": "Fellow Stranger", "link": "https://stackoverflow.com/users/1417223/fellow-stranger"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514136999, "post_id": 47962614, "comment_id": 82894722, "body": "Haha, yes of course. Forgot to mention the obvious."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1514137243, "post_id": 47962614, "comment_id": 82894778, "body": "It does not seem to make a request, but it does <a href=\"https://github.com/cloudinary/cloudinary_gem/blob/master/lib/cloudinary/utils.rb#L335\" rel=\"nofollow noreferrer\">a hell lot of configuration</a> so I would not suggest to just construct the <code>url</code> yourself."}], "answers": [{"tags": [], "owner": {"reputation": 4538, "user_id": 809830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd9801d2717096282258b192edc7793?s=128&d=identicon&r=PG", "display_name": "Alex Kojin", "link": "https://stackoverflow.com/users/809830/alex-kojin"}, "is_accepted": false, "score": 1, "last_activity_date": 1514137146, "creation_date": 1514137146, "answer_id": 47962762, "question_id": 47962614, "link": "https://stackoverflow.com/questions/47962614/detecting-network-request/47962762#47962762", "title": "Detecting network request", "body": "<p>Cloudinary is using <code>RestClient</code> gem. It allows set global logging.</p>\n\n<p><a href=\"https://github.com/rest-client/rest-client#logging\" rel=\"nofollow noreferrer\">https://github.com/rest-client/rest-client#logging</a></p>\n\n<blockquote>\n  <p>To enable logging globally you can:</p>\n  \n  <p>set RestClient.log with a Ruby Logger, or set an environment variable</p>\n  \n  <p>to avoid modifying the code (in this case you can use a file name,\n  \"stdout\" or \"stderr\"): </p>\n  \n  <p>$ RESTCLIENT_LOG=stdout path/to/my/program</p>\n</blockquote>\n"}], "owner": {"reputation": 25043, "user_id": 1417223, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dbdfe3d2d5f87f172757ada1438f3d16?s=128&d=identicon&r=PG", "display_name": "Fellow Stranger", "link": "https://stackoverflow.com/users/1417223/fellow-stranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514137203, "creation_date": 1514136069, "last_edit_date": 1514137203, "question_id": 47962614, "link": "https://stackoverflow.com/questions/47962614/detecting-network-request", "title": "Detecting network request", "body": "<p>When using gems for external services, sometimes I don't know whether a method does a trip to the service or just returns some local computation.</p>\n\n<p>An example - I'm using an image hosting service (Cloudinary) that has a Ruby wrapper for their API. The following command returns a complete URL to a hosted image when providing an image_id:</p>\n\n<pre><code>Cloudinary::Utils.cloudinary_url(image_id)\n#=&gt; \"http://res.cloudinary.com/my_service/image/upload/v1/some_image_id\"\n</code></pre>\n\n<p>I'd probably construct that URL manually to skip a HTTP request (if that what's what happens).</p>\n\n<p>So to my question - is there any faster way than digging in the source code or unplugging internet access to detect if network request is made before returning a value?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1514135399, "post_id": 47962470, "comment_id": 82894280, "body": "Not much to go on here. How is <code>.fblink</code> defined?"}, {"owner": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1514136099, "post_id": 47962470, "comment_id": 82894459, "body": "i have updated code @lurker"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "edited": false, "score": 0, "creation_date": 1514137566, "post_id": 47962689, "comment_id": 82894847, "body": "hey @fool it worked but the problem is it&#39;s linking to  <code>http:&#47;&#47;localhost:3000&#47;users&#47;www.facebook.com&#47;example</code>"}, {"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "reply_to_user": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "edited": false, "score": 0, "creation_date": 1514137941, "post_id": 47962689, "comment_id": 82894945, "body": "@NoorAliKhan I have updated my answer you can follow this"}, {"owner": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "edited": false, "score": 0, "creation_date": 1514138437, "post_id": 47962689, "comment_id": 82895062, "body": "it worked...you should change your name dude...you are no fool you are freaking genius..."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "edited": false, "score": 0, "creation_date": 1514138550, "post_id": 47962689, "comment_id": 82895082, "body": "@NoorAliKhan it would be better user interface if you will use client side validation for <code>url</code> instead of server side as i discussed below."}], "tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": true, "score": 2, "last_activity_date": 1517735603, "last_edit_date": 1517735603, "creation_date": 1514136581, "answer_id": 47962689, "question_id": 47962470, "link": "https://stackoverflow.com/questions/47962470/rails-external-url-work-as-a-link-in-views/47962689#47962689", "title": "Rails external URL work as a link in views", "body": "<p>If your form is inserted data properly then, You can work on defining a helper class for link like</p>\n\n<pre><code>#=&gt; helpers/application_helper.rb\ndef fb_link(user_fb)\n    link_to \"Facebook\", \"#{url_with_protocol(user_fb)}\", class: \"your-class\", target: \"new\"\nend\n#=&gt; url helper\ndef url_with_protocol(url)\n    /^http/.match(url) ? url : \"http://#{url}\"\nend\n</code></pre>\n\n<p>Then from view</p>\n\n<pre><code>= fb_link(@user.fblink)\n</code></pre>\n\n<p>Or you can work like this </p>\n\n<pre><code>= link_to \"Facebook\", \"#{url_with_protocol(@user.fblink)}\", class: \"your-class\", target: \"new\"\n</code></pre>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 621, "user_id": 1690384, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4187ec71a8ae5536ad9c319cb5535d14?s=128&d=identicon&r=PG", "display_name": "Junan Chakma", "link": "https://stackoverflow.com/users/1690384/junan-chakma"}, "is_accepted": false, "score": 0, "last_activity_date": 1514169001, "last_edit_date": 1514169001, "creation_date": 1514137094, "answer_id": 47962755, "question_id": 47962470, "link": "https://stackoverflow.com/questions/47962470/rails-external-url-work-as-a-link-in-views/47962755#47962755", "title": "Rails external URL work as a link in views", "body": "<p>Try <code>&lt;%= link_to 'Facebook', @user.fblink %&gt;</code></p>\n\n<p>The first parameter of <code>link_to</code> method will display the value of the link. In this case it is <code>Facebook</code>. The second parameter is the <code>url_path</code>. When user click to the <code>Facebook</code> link it will go the <code>url_path</code>. In this case it is <code>@user.fblink</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1514138206, "creation_date": 1514138206, "answer_id": 47962896, "question_id": 47962470, "link": "https://stackoverflow.com/questions/47962470/rails-external-url-work-as-a-link-in-views/47962896#47962896", "title": "Rails external URL work as a link in views", "body": "<p>it will not work as link untill unless its not been saved as <code>http</code>, </p>\n\n<p>for example if you want Facebook link to work its should be saved in db as <code>https://www.facebook.com/example</code></p>\n\n<p>so here for this you need a <a href=\"https://jqueryvalidation.org/url-method/\" rel=\"nofollow noreferrer\">jquery form validation</a> on your form input field:</p>\n\n<p>and after that in your view page simply you can use it like</p>\n\n<blockquote>\n  <p> my link &lt;%=@user.@user.fblink%></p>\n</blockquote>\n\n<p>do not use <code>link_to</code> or any rails view helper here as its complete link is been alredy saved in database.</p>\n\n<pre><code>&lt;script&gt;\n$( \"#myform\" ).validate({\n  rules: {\n    field: {\n      required: true,\n      url: true\n    }\n  }, \n message: {\n   field:{ required: 'fb link can't be blank!', url: 'Please enter valid url'}\n  }\n});\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9106398, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/814701882042945/picture?type=large", "display_name": "Noor Ali Khan", "link": "https://stackoverflow.com/users/9106398/noor-ali-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 47962689, "answer_count": 3, "score": 2, "last_activity_date": 1517735603, "creation_date": 1514134797, "last_edit_date": 1517398608, "question_id": 47962470, "link": "https://stackoverflow.com/questions/47962470/rails-external-url-work-as-a-link-in-views", "title": "Rails external URL work as a link in views", "body": "<p>In my rails app, I have added a string that users can add the link to there facebook profile, it's a simple text field, but in the view I want them to have a link.</p>\n\n<p>For example, if the user adds <strong>www.facebook.com/example</strong> I want it to appear as a link in the views for that I have tried the <code>link_to</code> approch but instead of pointing a link to the users profile it just refresh the page.</p>\n\n<p><em>This is what I tried</em></p>\n\n<pre><code>&lt;%= link_to(@user.fblink) %&gt;\n</code></pre>\n\n<p><strong>migration</strong></p>\n\n<pre><code>class AddFblinkToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :fblink, :string\n  end\nend\n</code></pre>\n\n<p><strong>user controller prams</strong></p>\n\n<pre><code>def user_params\n  params.require(:user).permit(:description, :avatar, :location, :fblink, :twlink, :ytlink, :username)\nend\n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "twitter-bootstrap"], "answers": [{"comments": [{"owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "reply_to_user": {"reputation": 41, "user_id": 8323501, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aba0af8515b2e63460eb165f6d83ad9d?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Malik", "link": "https://stackoverflow.com/users/8323501/sam-malik"}, "edited": false, "score": 1, "creation_date": 1514134549, "post_id": 47962363, "comment_id": 82894080, "body": "This is directly from the jquery-rails documentation at rubygems.org:  <code>And if you want to use jQuery 3, you can require jquery3:  &#47;&#47;= require jquery3 &#47;&#47;= require jquery_ujs</code>  <a href=\"https://github.com/rails/jquery-rails\" rel=\"nofollow noreferrer\">jquery-rails gem documentation</a>"}], "tags": [], "owner": {"reputation": 2060, "user_id": 3944700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4df64cd1de5941fb49263a19d80f1482?s=128&d=identicon&r=PG&f=1", "display_name": "hashrocket", "link": "https://stackoverflow.com/users/3944700/hashrocket"}, "is_accepted": false, "score": 0, "last_activity_date": 1514133698, "creation_date": 1514133698, "answer_id": 47962363, "question_id": 47962323, "link": "https://stackoverflow.com/questions/47962323/third-party-javascript-not-working-in-ruby-on-rails-app/47962363#47962363", "title": "Third party JavaScript not working in ruby on rails app", "body": "<p>According to the jquery-rails gem documentation, you also need to add</p>\n\n<pre><code>//= require jquery_ujs\n</code></pre>\n\n<p>to your application.js file. Try that and see if it works.</p>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 4735914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d998392dbbbd8061d2ef13ea60955633?s=128&d=identicon&r=PG&f=1", "display_name": "jdgray", "link": "https://stackoverflow.com/users/4735914/jdgray"}, "is_accepted": false, "score": 0, "last_activity_date": 1514148951, "creation_date": 1514148951, "answer_id": 47963950, "question_id": 47962323, "link": "https://stackoverflow.com/questions/47962323/third-party-javascript-not-working-in-ruby-on-rails-app/47963950#47963950", "title": "Third party JavaScript not working in ruby on rails app", "body": "<p>It doesn't look like your javascript code is being loaded as when I inspect the console on your Heroku app I see:</p>\n\n<pre><code>Uncaught ReferenceError: WOW is not defined\n</code></pre>\n\n<p>Looks like your <code>WOW</code> code exists in your <code>plugins.js</code> (also where your <code>Owl Carousel</code> source code lives).</p>\n\n<p>In your <code>application.js</code> file add the <code>plugins.js</code> to ensure that it is loaded prior to the <code>active.js</code> file.</p>\n\n<pre><code>//= require plugins\n//= require_tree .\n</code></pre>\n\n<p>(I would probably remove the <code>require_tree</code> and include each of your files separately dependent on what needs to be loaded in order).</p>\n\n<p>Next, change your <code>Owl</code> js code similar to the snippet within the <a href=\"https://github.com/OwlCarousel2/OwlCarousel2#usage\" rel=\"nofollow noreferrer\">Usage</a> section from the documentation. It should be something like this to ensure that it will load properly.</p>\n\n<pre><code>$(document).ready(function() {\n  $(\".app_screenshots_slides\").owlCarousel({\n    items: 1,\n    loop: true,\n    autoplay: true,\n    smartSpeed: 800,\n    margin: 30,\n    center: true,\n    dots: true,\n    responsive: {\n      0: {\n        items: 1\n      },\n      480: {\n        items: 3\n      },\n      992: {\n        items: 5\n      }\n    }\n  });\n});\n</code></pre>\n\n<p>FWIW you have extra errors in the console as well (custom fonts not loaded and other jQuery errors). There also looks like some unused JS within your <code>active.js</code> file as well. This answer only includes what you have asked. </p>\n\n<p>As an aside instead of having all the source js code in <code>plugins.js</code>, you can use Rails Assets to help you manage your dependencies better, here is the link for <a href=\"https://rails-assets.org/#/components/OwlCarousel2\" rel=\"nofollow noreferrer\">OwlCarousel2</a> if you are interested.</p>\n"}], "owner": {"reputation": 41, "user_id": 8323501, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aba0af8515b2e63460eb165f6d83ad9d?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Malik", "link": "https://stackoverflow.com/users/8323501/sam-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514174541, "creation_date": 1514133332, "last_edit_date": 1514174541, "question_id": 47962323, "link": "https://stackoverflow.com/questions/47962323/third-party-javascript-not-working-in-ruby-on-rails-app", "title": "Third party JavaScript not working in ruby on rails app", "body": "<p>I'm using Bootstrap 4 in a Ruby on Rails app. I'm facing the problem is my 3rd party JavaScript files are not working in my app. The 3rd party JS file contains a carousel effect that is not working. My <code>application.js</code>contains</p>\n\n<pre><code>//= require jquery3\n//= require popper\n//= require bootstrap-sprockets\n//= require slick\n//= require rails-ujs\n//= require turbolinks\n//= require_tree .\n</code></pre>\n\n<p><a href=\"https://bit-app.herokuapp.com/\" rel=\"nofollow noreferrer\">Deploy on Heroku</a>, <a href=\"https://github.com/asdimalix/bit.app\" rel=\"nofollow noreferrer\">Github Repository</a>.</p>\n\n<p>Why isn't this working?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 6018313, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/krXMH.jpg?s=128&g=1", "display_name": "Kevin Etore", "link": "https://stackoverflow.com/users/6018313/kevin-etore"}, "edited": false, "score": 0, "creation_date": 1514192602, "post_id": 47966670, "comment_id": 82903864, "body": "Hi Wasif, thanks for your response. I like your second example, all tho I would like to return the object for each group where the <code>resource_owner_id</code> == <code>User.id</code>. So imagine I have 2 groups that go by the application_id: 2 and one by application_id: 3 with both the same resource_owner_id. I would like to return the <code>access_token</code> object in that case for ID 2 and 3."}, {"owner": {"reputation": 856, "user_id": 6018313, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/krXMH.jpg?s=128&g=1", "display_name": "Kevin Etore", "link": "https://stackoverflow.com/users/6018313/kevin-etore"}, "edited": false, "score": 1, "creation_date": 1514196338, "post_id": 47966670, "comment_id": 82904616, "body": "<code>oauth_tokens.group(:application_id).pluck(&#39;MAX(id)&#39;)</code> works, it gives me the correct ids back like I wanted as I mentioned above. Now I just have to figure out how to return the whole object instead of the ID only, that will save me from some unnecessary db queries, thanks Wasif!"}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "reply_to_user": {"reputation": 856, "user_id": 6018313, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/krXMH.jpg?s=128&g=1", "display_name": "Kevin Etore", "link": "https://stackoverflow.com/users/6018313/kevin-etore"}, "edited": false, "score": 0, "creation_date": 1514202805, "post_id": 47966670, "comment_id": 82906202, "body": "Please check the updated section in the answer. Thanks"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1514202774, "last_edit_date": 1514202774, "creation_date": 1514187471, "answer_id": 47966670, "question_id": 47962015, "link": "https://stackoverflow.com/questions/47962015/select-highest-id-from-group/47966670#47966670", "title": "Select highest ID from group", "body": "<p>Given that <code>id</code> is the primary key of <code>:users</code> table and <code>oauth_access_tokens.resource_owner_id</code> points to <code>users.id</code>, something like this should work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n  ...\n  def last_token\n    # 'id' (or, self.id) in 'resource_owner_id: id' points to the user id, i.e. 'User.first.id' in 'User.first.last_token'\n    Doorkeeper::AccessToken.group(:application_id).where(resource_owner_id: id).pluck('max(id)').first\n  end\n  ...\nend\n</code></pre>\n\n<hr>\n\n<p>Though the above solution should work, but you can improve the query writing to a more readable way by defining the associations inside corresponding models like below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n  ...\n  has_many :access_tokens,\n    class_name: 'Doorkeeper::AccessToken',\n    foreign_key: :resource_owner_id\n  ...\n  def last_token\n    access_tokens.group(:application_id).pluck('max(id)').first\n  end\n  ...\nend\n\nclass Doorkeeper::AccessToken &lt; ApplicationRecord\n  ...\n  self.table_name = 'oauth_access_tokens'\n  belongs_to :resource_owner, class_name: 'User'\n  ...\nend\n</code></pre>\n\n<p>In both cases, <code>User.first.last_token</code> will return <code>28</code> as you would expect.</p>\n\n<hr>\n\n<h3>Update</h3>\n\n<p>You are only 1 query away to get the access_token instances instead of mere ids. The method will now return an <code>ActiveRecord::Relation</code> of <code>Doorkeeper::AccessToken</code> instances which meet the defined criteria.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def last_tokens # pluralized method name\n  token_ids = access_tokens.group(:application_id).pluck('max(id)')\n  Doorkeeper::AccessToken.where(id: token_ids)\nend\n</code></pre>\n"}], "owner": {"reputation": 856, "user_id": 6018313, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/krXMH.jpg?s=128&g=1", "display_name": "Kevin Etore", "link": "https://stackoverflow.com/users/6018313/kevin-etore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 958, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514202774, "creation_date": 1514130488, "last_edit_date": 1514143062, "question_id": 47962015, "link": "https://stackoverflow.com/questions/47962015/select-highest-id-from-group", "title": "Select highest ID from group", "body": "<p>I'm trying to group a table (<code>oauth_access_tokens</code>) by <code>application_id</code> and select the highest record by ID from the corresponding group (see the complete model below). I've seen <a href=\"https://stackoverflow.com/questions/21289319/how-to-get-the-latest-record-from-each-group-in-activerecord\">this post</a>, which explains how to get the highest ID from the group, but sadly it's not working for my case.</p>\n\n<p>I have a table called <code>oauth_access_tokens</code> with the following attributes: <code>id</code>, <code>resource_owner_id</code>, <code>application_id</code>, <code>token</code>, <code>refresh_token</code>, <code>expires_in</code>, <code>scopes</code> and <code>revoked_at</code>.</p>\n\n<p>The method I have in my model: </p>\n\n<pre><code>def last_token\n  Doorkeeper::AccessToken.group(:application_id).having('id = MAX(id)')\nend\n</code></pre>\n\n<p>After calling it like so: <code>User.first.last_token</code> (I made sure that there are a few records in the database present).</p>\n\n<p><a href=\"https://i.stack.imgur.com/ibMLq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ibMLq.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>sql output:</strong> </p>\n\n<pre><code>Doorkeeper::AccessToken Load (0.5ms)  SELECT `oauth_access_tokens`.* FROM `oauth_access_tokens` GROUP BY `oauth_access_tokens`.`application_id` HAVING id = MAX(id)\n</code></pre>\n\n<p><strong>Output:</strong> <code>#&lt;ActiveRecord::Relation []&gt;</code></p>\n\n<p>Why don't I get the record with the highest ID? When I run <code>User.first.last_token</code> I expect to see the <code>access_token</code> with the <code>id</code> of 28.</p>\n\n<p>Happy holidays!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1514123913, "post_id": 47961167, "comment_id": 82891492, "body": "Dynamically building variable names feels wrong to me. Why do you need to do that? Why can&#39;t you use a hash or a similar data structure with the month used as the key? What do you try to achieve?"}, {"owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1514126169, "post_id": 47961167, "comment_id": 82892029, "body": "well, it is to call a partial.  The partial has locals which whould allow to grab only the selected elements.  It seemed more natural and efficient to have the controller method generate the selected elements, rather than doing the filtering process at view-build time."}, {"owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "edited": false, "score": 1, "creation_date": 1514127098, "post_id": 47961167, "comment_id": 82892300, "body": "Try <code>instance_variable_set(&quot;@events&quot;, instance_variable_get(&quot;@events_&quot; + month_id.to_s))</code>. Anyway, it looks weird and wrong."}, {"owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "edited": false, "score": 0, "creation_date": 1514127441, "post_id": 47961167, "comment_id": 82892407, "body": "Weird, but functional. Post suggestion as answer for upvote please. I guess performance in the end will be the measure of what is best..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1514127639, "post_id": 47961167, "comment_id": 82892463, "body": "The proper way to achieve this would be to use the array for <code>@events</code> and to get/set <code>@events[month_id]</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1514127675, "post_id": 47961167, "comment_id": 82892472, "body": "I would argue that readability and maintainability are important too (and most of the time are more important than performance). Perhaps there is is a better solution. What is <code>month_id</code>? Where is it coming from? And how do you generate the various <code>@events_</code> instance variables?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1514127858, "post_id": 47961167, "comment_id": 82892531, "body": "FWIW, besides <code>instance_variable_get</code>, <code>myevents = eval(&quot;@events_#{month_id}&quot;)</code> would work."}, {"owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "edited": false, "score": 0, "creation_date": 1514128144, "post_id": 47961167, "comment_id": 82892609, "body": "useful points.  Admittedly, the question was vague on this point. month_id is actually not an object attribute, only a counter of months into the future."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1514135318, "post_id": 47961167, "comment_id": 82894260, "body": "Even if <code>month_id</code> is a random value from the interval <code>[0...Float::INFINITY)</code>, the way to go is an array with <code>month_id</code> being an index."}], "owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514126012, "creation_date": 1514123682, "last_edit_date": 1514126012, "question_id": 47961167, "link": "https://stackoverflow.com/questions/47961167/instance-variable-defined-by-concatenation-of-strings", "title": "instance variable defined by concatenation of strings", "body": "<p>Needing to generate a partial with content dynamically-defined by input parameter <code>month_id</code>, I attempted te set an instance variable needed to the collection_select menu, based on a concatenation of strings.   </p>\n\n<pre><code>&lt;%= myevents = \"@events_\" + month_id.to_s %&gt;\n\n&lt;% instance_variable_set(\"@events\", myevents) %&gt;\n&lt;%= f.collection_select(:event_id, @events, [...]\n</code></pre>\n\n<p>However, rails complains that is is handling a string <code>undefined method</code>map' for \"@events_01\":String`, rather than the desired collection. so how can this instance variable be dynamically called then?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514122375, "post_id": 47960988, "comment_id": 82891104, "body": "Which Rails version did you install? 5.4.1? that version doesn&#39;t exist - still, can you see what&#39;s in the output of <code>gem list --local | grep rails</code>?"}, {"owner": {"reputation": 11, "user_id": 9136336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21efd8352c072341ba86b7cd7167d13?s=128&d=identicon&r=PG&f=1", "display_name": "Johanna Q.", "link": "https://stackoverflow.com/users/9136336/johanna-q"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514122943, "post_id": 47960988, "comment_id": 82891256, "body": "sorry I meant version 5.1.4 and if I run the gem list i get: &gt; coffee-rails (4.2.2) &gt; rails-dom-testing (2.0.3) &gt; rails-html-sanitizer (1.0.3) &gt; sprockets-rails (3.2.1)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514123589, "post_id": 47960988, "comment_id": 82891402, "body": "There&#39;s no Rails there, can you try by running <code>gem install rails</code>, this should install the latest version 5.1.4, then run the previous command again."}, {"owner": {"reputation": 11, "user_id": 9136336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21efd8352c072341ba86b7cd7167d13?s=128&d=identicon&r=PG&f=1", "display_name": "Johanna Q.", "link": "https://stackoverflow.com/users/9136336/johanna-q"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514123852, "post_id": 47960988, "comment_id": 82891479, "body": "If i run it this error occurs:   ERROR:  While executing gem ... (Errno::EACCES)     Permission denied @ rb_sysopen - /Users/$USER_NAME/.rbenv/versions/2.3.5/lib/ruby/gems/2.3.0/&zwnj;&#8203;gems/rails-5.1.4/REA&zwnj;&#8203;DME.md"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514123960, "post_id": 47960988, "comment_id": 82891503, "body": "Have you tried giving permission to the <code>.rbenv</code>, or in last case by using sudo?"}, {"owner": {"reputation": 11, "user_id": 9136336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21efd8352c072341ba86b7cd7167d13?s=128&d=identicon&r=PG&f=1", "display_name": "Johanna Q.", "link": "https://stackoverflow.com/users/9136336/johanna-q"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514124806, "post_id": 47960988, "comment_id": 82891708, "body": "Thank you very much!! It worked using sudo, still don&#39;t really understand why it happend in the first place but at least now it is working! Thank you! The only thing is that in my .bin/rails file the code didn&#39;t change and is different to the one of previous applications and I don&#39;t know if this will be a problem."}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514125589, "post_id": 47960988, "comment_id": 82891897, "body": "Maybe because of different Rails version?, most probably you installed rbenv by using sudo or any other unaccessible user, you could try by giving permissions to the folder to not worry about the sudo."}, {"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1514262126, "post_id": 47960988, "comment_id": 82917208, "body": "@SebastianPalma please post your response as the correct answer."}], "owner": {"reputation": 11, "user_id": 9136336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21efd8352c072341ba86b7cd7167d13?s=128&d=identicon&r=PG&f=1", "display_name": "Johanna Q.", "link": "https://stackoverflow.com/users/9136336/johanna-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514122866, "creation_date": 1514122122, "last_edit_date": 1514122866, "question_id": 47960988, "link": "https://stackoverflow.com/questions/47960988/failed-to-install-rails-gem", "title": "Failed to install rails gem", "body": "<p>I am trying to create a new Rails application. After I ran the command </p>\n\n<pre><code>rails new $APP_NAME -T \u2014database=postgresql \n</code></pre>\n\n<p>This error occurs:</p>\n\n<blockquote>\n  <p>Errno::EACCES: Permission denied @ rb_sysopen -\n  /Users/$USER_NAME/.rbenv/versions/2.3.5/lib/ruby/gems/2.3.0/gems/rails-5.1.4/README.md\n  An error occurred while installing rails (5.1.4), and Bundler\n  cannot continue.\n  Make sure that <code>gem install rails -v '5.1.4'</code> succeeds before bundling.</p>\n</blockquote>\n\n<p>I have installed Rails (version 5.1.4) but if I run <code>rails -v</code> in my app directory it is not working because it is asking me to run <code>bundle install</code> which if I do gives me the same error as mentioned above. I checked my Gemfile and there is the Rails gem.</p>\n\n<p>But if I go to bin/rails there is a problem. Here it is not recognising the Ruby (version 2.3.5) code. Only giving me this:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nAPP_PATH = File.expand_path('../config/application', __dir__)\nrequire_relative '../config/boot'\nrequire \u2018rails/commands'\n</code></pre>\n\n<p>This is my first application with a new computer so I might have done something wrong with the setup or installation but I also tried to uninstall/install Rails again. I really tried a lot and don\u2019t know what could be the issue. Any help would be highly appreciated. Thank you!</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1514225018, "post_id": 47960758, "comment_id": 82911290, "body": "(pssst. it&#39;s the <code>splat</code> operator)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1514225663, "last_edit_date": 1514225663, "creation_date": 1514119961, "answer_id": 47960758, "question_id": 47960300, "link": "https://stackoverflow.com/questions/47960300/rails-dynamic-params-require-permit-syntax/47960758#47960758", "title": "Rails dynamic params.require(...).permit(...) syntax?", "body": "<p>It doesn't work because <code>permit</code> doesn't expect a hash as an argument, but a list of parameters.</p>\n\n<p>Collect your arguments in an array and split that array with the splat operator (<code>*</code>) to list or arguments:</p>\n\n<pre><code>premit_params = [:param_a, { :param_c_attributes: [] }]\npremit_params = [:param_a, :param_d] if params.dig(:something, :param_d)\nparams.require(:something).permit(*premit_params)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 7031459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8550277cbdaa8f68308e8f390f4244?s=128&d=identicon&r=PG&f=1", "display_name": "Tasnim Marwan", "link": "https://stackoverflow.com/users/7031459/tasnim-marwan"}, "is_accepted": false, "score": 0, "last_activity_date": 1514202133, "creation_date": 1514202133, "answer_id": 47968272, "question_id": 47960300, "link": "https://stackoverflow.com/questions/47960300/rails-dynamic-params-require-permit-syntax/47968272#47968272", "title": "Rails dynamic params.require(...).permit(...) syntax?", "body": "<p>You can check if the parameter you want exits </p>\n\n<p>For Example:</p>\n\n<pre><code>if (user_params.has_key?(:name))\n\nend\n</code></pre>\n\n<p>Moreover, parameters are saved in hash so you have different methods you can use to apply your logic\n<a href=\"https://ruby-doc.org/core-1.9.3/Hash.html\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-1.9.3/Hash.html</a></p>\n"}], "owner": {"reputation": 339, "user_id": 3991243, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d7cf7db01c87223c5724bab8aa7ba3c?s=128&d=identicon&r=PG&f=1", "display_name": "Ziv Barber", "link": "https://stackoverflow.com/users/3991243/ziv-barber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 47960758, "answer_count": 2, "score": 1, "last_activity_date": 1514225663, "creation_date": 1514115880, "question_id": 47960300, "link": "https://stackoverflow.com/questions/47960300/rails-dynamic-params-require-permit-syntax", "title": "Rails dynamic params.require(...).permit(...) syntax?", "body": "<p>I can do this code:</p>\n\n<pre><code>params.require(:something).permit(:param_a,:param_b)\n</code></pre>\n\n<p>And this:</p>\n\n<pre><code>params.require(:something).permit(:param_a,:param_c_attributes:[])\n</code></pre>\n\n<p>My problem is that I need to select the permit parameters depending if some parameter exists. So I tried:</p>\n\n<pre><code>premit_params = {:param_a,:param_c_attributes:[]}\npremit_params = {:param_a,:param_d} if params[:something] &amp;&amp; params[:something][:param_d]\nparams.require(:something).permit(premit_params)\n</code></pre>\n\n<p>But it's not working.</p>\n\n<p>BTW: Using Rails 5.1</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "graphql", "graphql-ruby"], "answers": [{"tags": [], "owner": {"reputation": 15527, "user_id": 210171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MeyGM.png?s=128&g=1", "display_name": "nielsbot", "link": "https://stackoverflow.com/users/210171/nielsbot"}, "is_accepted": false, "score": 0, "last_activity_date": 1515147614, "creation_date": 1515147614, "answer_id": 48111499, "question_id": 47960194, "link": "https://stackoverflow.com/questions/47960194/graphql-ruby-date-or-datetime-type/48111499#48111499", "title": "graphql-ruby, Date or Datetime type", "body": "<p>Not sure I have a better explanation, but I did get it to work by pasting the code from above to define my own scalar <code>DateTimeType</code>:</p>\n\n<pre><code>DateTimeType = GraphQL::ScalarType.define do\n  name 'DateTime'\n\n  coerce_input -&gt;(value, _ctx) { Time.zone.parse(value) }\n  coerce_result -&gt;(value, _ctx) { value.utc.iso8601 }\nend\n\nMyType = ::GraphQL::ObjectType.define do\n  name 'MyType'\n  field :when, type: !DateTimeType\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 4494634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f394df507ac8d92917be3000702071b8?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisK", "link": "https://stackoverflow.com/users/4494634/chrisk"}, "is_accepted": false, "score": 2, "last_activity_date": 1517491641, "creation_date": 1517491641, "answer_id": 48563896, "question_id": 47960194, "link": "https://stackoverflow.com/questions/47960194/graphql-ruby-date-or-datetime-type/48563896#48563896", "title": "graphql-ruby, Date or Datetime type", "body": "<p>The type declaration should properly work. Keep in mind that the DateTimeType you pasted is in the module \"Types\". Use it like this:</p>\n\n<pre><code>Types::PlayerType = GraphQL::ObjectType.define do\n  name 'Player'\n\n  field :id, !types.ID\n  field :birth_date, Types::DateTimeType\n  field :death_date, Types::DateTimeType\n  field :note, types.String\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8357184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_LKwY9S0dws/AAAAAAAAAAI/AAAAAAAAAAA/a1m_4RPoHr8/photo.jpg?sz=128", "display_name": "Andy Wang", "link": "https://stackoverflow.com/users/8357184/andy-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1518055117, "creation_date": 1518055117, "answer_id": 48676269, "question_id": 47960194, "link": "https://stackoverflow.com/questions/47960194/graphql-ruby-date-or-datetime-type/48676269#48676269", "title": "graphql-ruby, Date or Datetime type", "body": "<p>According to <a href=\"https://github.com/rmosolgo/graphql-ruby/blob/719b5eda918d71ce7e6695939653f2371f95e607/lib/graphql/define/type_definer.rb\" rel=\"nofollow noreferrer\">source code</a>, there are only 5 types(Int, String, Float, Boolean, ID) defined as method which means you cannot use <code>types.DateTime</code>.</p>\n\n<p>To customize DateTimeType, you could reference its <a href=\"http://www.rubydoc.info/gems/graphql/1.7.8/GraphQL/ScalarType\" rel=\"nofollow noreferrer\">document</a> of the gem and implement as the above you've mentioned about (<strong>date_time_type.rb</strong>), then you can use it like this:</p>\n\n<p><code>field :birth_date, Types::DateTimeType</code></p>\n"}, {"tags": [], "owner": {"reputation": 1416, "user_id": 1263087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5e51e5329af4a8f6ab4ffbf85e2d1b?s=128&d=identicon&r=PG", "display_name": "dostu", "link": "https://stackoverflow.com/users/1263087/dostu"}, "is_accepted": false, "score": 27, "last_activity_date": 1580903168, "last_edit_date": 1580903168, "creation_date": 1532276085, "answer_id": 51466970, "question_id": 47960194, "link": "https://stackoverflow.com/questions/47960194/graphql-ruby-date-or-datetime-type/51466970#51466970", "title": "graphql-ruby, Date or Datetime type", "body": "<p><code>GraphQL::Types::ISO8601DateTime</code> and <code>GraphQL::Types::ISO8601Date</code> recently got added to graphql ruby library (<a href=\"https://github.com/rmosolgo/graphql-ruby/pull/2471\" rel=\"noreferrer\">Pull Request</a>).</p>\n\n<p>Usage example:</p>\n\n<pre><code>field :created_at, GraphQL::Types::ISO8601DateTime, null: false\nfield :starts_on, GraphQL::Types::ISO8601Date, null: false\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4412054"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5629, "favorite_count": 0, "answer_count": 4, "score": 15, "last_activity_date": 1580903168, "creation_date": 1514114927, "question_id": 47960194, "link": "https://stackoverflow.com/questions/47960194/graphql-ruby-date-or-datetime-type", "title": "graphql-ruby, Date or Datetime type", "body": "<p>I'm not the only one who doesn't know how to use <code>Datetime</code> types with GraphQL-Ruby: <a href=\"https://github.com/rmosolgo/graphql-ruby-demo/issues/27\" rel=\"noreferrer\">https://github.com/rmosolgo/graphql-ruby-demo/issues/27</a>, as you can see there are 18 people like me.</p>\n\n<p>How can I use Datetime to some fields like this?</p>\n\n<pre><code>Types::PlayerType = GraphQL::ObjectType.define do\n  name 'Player'\n\n  field :id, !types.ID\n  field :birth_date, types.Datetime #or what?\n  field :death_date, !types.Datetime #or what?\n  field :note, types.String\nend\n</code></pre>\n\n<p>Maybe I have to use this (<a href=\"https://github.com/howtographql/graphql-ruby/blob/master/app/graphql/types/date_time_type.rb\" rel=\"noreferrer\">https://github.com/howtographql/graphql-ruby/blob/master/app/graphql/types/date_time_type.rb</a>):</p>\n\n<p><strong>date_time_type.rb</strong>:</p>\n\n<pre><code>Types::DateTimeType = GraphQL::ScalarType.define do\n  name 'DateTime'\n\n  coerce_input -&gt;(value, _ctx) { Time.zone.parse(value) }\n  coerce_result -&gt;(value, _ctx) { value.utc.iso8601 }\nend\n</code></pre>\n\n<p><strong>Can someone explain it better?</strong></p>\n"}, {"tags": ["ruby", "nokogiri", "mechanize", "libxml2"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1514504535, "post_id": 47959583, "comment_id": 83000727, "body": "I&#39;m not seeing this problem with ruby 2.4 and mechanize 2.7.5. Just as an idea though, try: <code>agent.default_encoding=&#39;Shift_JIS&#39;</code>"}, {"owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1516543503, "post_id": 47959583, "comment_id": 83721784, "body": "Thank you for comment!! It looks the page change return content now, but I don&#39;t get this error any more :)"}], "owner": {"reputation": 912, "user_id": 5992952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Vkiy.png?s=128&g=1", "display_name": "Matsumoto Kazuya", "link": "https://stackoverflow.com/users/5992952/matsumoto-kazuya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514115751, "creation_date": 1514108837, "last_edit_date": 1514115751, "question_id": 47959583, "link": "https://stackoverflow.com/questions/47959583/ruby-mechanize-stop-with-encoding-error-input-conversion-failed-due-to-input-e", "title": "Ruby Mechanize stop with encoding error : input conversion failed due to input error, bytes 0xFA 0xBA 0x3C 0x2F", "body": "<p>I use Ruby mechanize(Ruby version: 2.3.1p112, Mehanize version: 2.7.5) to scrape web page.\nSome page crushes with \"input conversion failed due to input error\"\nThe page I want to scrape is <a href=\"http://www.jra.go.jp/JRADB/accessD.html\" rel=\"nofollow noreferrer\">http://www.jra.go.jp/JRADB/accessD.html</a>\nand My code and execute logs below.</p>\n\n<pre><code>agent = Mechanize.new\nagent.log = Logger.new(STDOUT)\nagent.post('http://www.jra.go.jp/JRADB/accessD.html', { \"cname\" =&gt; \"pw01bmd0006201705080220171224/7A\" })\n\nD, [2017-12-24T18:34:32.039095 #37600] DEBUG -- : query: \"cname=pw01bmd0006201705080220171224%2F7A\"\nI, [2017-12-24T18:34:32.039562 #37600]  INFO -- : Net::HTTP::Post: /JRADB/accessD.html\nD, [2017-12-24T18:34:32.039657 #37600] DEBUG -- : request-header: accept-encoding =&gt; gzip,deflate,identity\nD, [2017-12-24T18:34:32.039742 #37600] DEBUG -- : request-header: accept =&gt; */*\nD, [2017-12-24T18:34:32.039873 #37600] DEBUG -- : request-header: user-agent =&gt; Mechanize/2.7.5 Ruby/2.3.1p112 (http://github.com/sparklemotion/mechanize/)\nD, [2017-12-24T18:34:32.039996 #37600] DEBUG -- : request-header: accept-charset =&gt; ISO-8859-1,utf-8;q=0.7,*;q=0.7\nD, [2017-12-24T18:34:32.040105 #37600] DEBUG -- : request-header: accept-language =&gt; en-us,en;q=0.5\nD, [2017-12-24T18:34:32.040209 #37600] DEBUG -- : request-header: host =&gt; www.jra.go.jp\nD, [2017-12-24T18:34:32.040323 #37600] DEBUG -- : request-header: referer =&gt; http://www.jra.go.jp/JRADB/accessD.html\nD, [2017-12-24T18:34:32.040428 #37600] DEBUG -- : request-header: content-type =&gt; application/x-www-form-urlencoded\nD, [2017-12-24T18:34:32.040547 #37600] DEBUG -- : request-header: content-length =&gt; 40\nI, [2017-12-24T18:34:32.093773 #37600]  INFO -- : status: Net::HTTPOK 1.1 200 OK\nD, [2017-12-24T18:34:32.094155 #37600] DEBUG -- : response-header: server =&gt; Apache\nD, [2017-12-24T18:34:32.094296 #37600] DEBUG -- : response-header: x-frame-options =&gt; SAMEORIGIN\nD, [2017-12-24T18:34:32.094736 #37600] DEBUG -- : response-header: content-encoding =&gt; gzip\nD, [2017-12-24T18:34:32.094953 #37600] DEBUG -- : response-header: content-length =&gt; 13989\nD, [2017-12-24T18:34:32.095272 #37600] DEBUG -- : response-header: content-type =&gt; text/html\nD, [2017-12-24T18:34:32.095590 #37600] DEBUG -- : response-header: date =&gt; Sun, 24 Dec 2017 09:34:32 GMT\nD, [2017-12-24T18:34:32.095980 #37600] DEBUG -- : response-header: connection =&gt; keep-alive\nD, [2017-12-24T18:34:32.096387 #37600] DEBUG -- : response-header: vary =&gt; Accept-Encoding\nD, [2017-12-24T18:34:32.096894 #37600] DEBUG -- : Read 6790 bytes (6790 total)\nD, [2017-12-24T18:34:32.105888 #37600] DEBUG -- : Read 7199 bytes (13989 total)\nD, [2017-12-24T18:34:32.106710 #37600] DEBUG -- : gzip response\nencoding error : input conversion failed due to input error, bytes 0xFA 0xBA 0x3C 0x2F\n</code></pre>\n\n<p>I understand this is cause of character-encoding problem and I want to ignore if parsing error is occured. How can I do this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1514109624, "post_id": 47959517, "comment_id": 82888466, "body": "Post code, not pictures of code"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1514172934, "post_id": 47959517, "comment_id": 82900795, "body": "1. &quot;please&quot; should come right before the verb &quot;tell&quot;. 2. The auxiliary verb &quot;am&quot; should not be inverted in embedded interrogatives. 3. The entire interrogative should end with a question mark. So, it should be: <i>Can anyone please tell me what I am doing wrong ...?</i>"}], "answers": [{"tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": false, "score": 1, "last_activity_date": 1514116024, "creation_date": 1514116024, "answer_id": 47960319, "question_id": 47959517, "link": "https://stackoverflow.com/questions/47959517/please-can-anyone-tell-me-what-am-i-doing-wrong-running-this-ruby-script-from-ir/47960319#47960319", "title": "Please can anyone tell me what am I doing wrong running this Ruby script from IRB", "body": "<p>1) <code>Sports</code> with an uppercase defines a class or module, use <code>sports</code> for variables.\n2) you opened irb and entered a string, you didn\u2019t try and require the file or run it. I recommend you DONT open irb and instead run <code>ruby sports.rb</code> from the directory</p>\n"}], "owner": {"reputation": 9, "user_id": 9133574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3adb9b559e5c6882171a08c76a413c37?s=128&d=identicon&r=PG&f=1", "display_name": "willofGod", "link": "https://stackoverflow.com/users/9133574/willofgod"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1514129788, "answer_count": 1, "score": -4, "last_activity_date": 1514116024, "creation_date": 1514108129, "last_edit_date": 1514109642, "question_id": 47959517, "link": "https://stackoverflow.com/questions/47959517/please-can-anyone-tell-me-what-am-i-doing-wrong-running-this-ruby-script-from-ir", "closed_reason": "Not suitable for this site", "title": "Please can anyone tell me what am I doing wrong running this Ruby script from IRB", "body": "<p>I am new to Ruby and programing in general. I am trying to execute a simple ruby command from a ruby file from irb.</p>\n\n<p>I have created a file sports.rb . it contains some hashes and a line of command to puts tennis as seen below.\n<a href=\"https://i.stack.imgur.com/wNBQ0.png\" rel=\"nofollow noreferrer\">enter image description here</a>\nBut When I tried to execute the script I get the image below.\n<a href=\"https://i.stack.imgur.com/TlNWF.png\" rel=\"nofollow noreferrer\">enter image description here</a>\nAccording to the written command, I am suppose to get \"long hours\" when I run the script but its not happening. Can anyone please tell me what I </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 4388, "user_id": 3813411, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c25e3810f837ed8fbc62985c83cb6855?s=128&d=identicon&r=PG&f=1", "display_name": "rb612", "link": "https://stackoverflow.com/users/3813411/rb612"}, "edited": false, "score": 0, "creation_date": 1514100928, "post_id": 47958882, "comment_id": 82886942, "body": "Ah! Thank you! So it will basically automatically reload upon next execution if it doesn\u2019t succeed the first time?"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 4388, "user_id": 3813411, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c25e3810f837ed8fbc62985c83cb6855?s=128&d=identicon&r=PG&f=1", "display_name": "rb612", "link": "https://stackoverflow.com/users/3813411/rb612"}, "edited": false, "score": 1, "creation_date": 1514101106, "post_id": 47958882, "comment_id": 82886972, "body": "@rb612 Yes. In development mode, Rails do not load all the constants by default. It loads them on-demand when referenced anywhere. So, if it encounters <code>Article</code>, it will check if this constant is loaded in memory, if not, it will check the presence of file in <code>$LOAD_PATH</code>, if found, it will try to load it and will create a constant <code>Article</code> with the said code. In first case, since the latter part failed, <code>Article</code> constant was never created, so when you fix the code and do <code>Article.first</code> again, it will load the class correctly with updated code."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1514100769, "creation_date": 1514100769, "answer_id": 47958882, "question_id": 47958606, "link": "https://stackoverflow.com/questions/47958606/ruby-on-rails-inconsistency-when-needing-to-reload-model/47958882#47958882", "title": "Ruby on Rails - inconsistency when needing to reload model?", "body": "<p>In your first example, Rails was not able to load the class because it raised an error. After fixing the error there was no need to class reload because the class was not loaded successfully before. </p>\n\n<p>In your second example, the class was loaded successfully. Therefore you need to call <code>reload!</code> to tell Rails to reload the class into memory.</p>\n"}], "owner": {"reputation": 4388, "user_id": 3813411, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c25e3810f837ed8fbc62985c83cb6855?s=128&d=identicon&r=PG&f=1", "display_name": "rb612", "link": "https://stackoverflow.com/users/3813411/rb612"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 47958882, "answer_count": 1, "score": 1, "last_activity_date": 1514100769, "creation_date": 1514098005, "question_id": 47958606, "link": "https://stackoverflow.com/questions/47958606/ruby-on-rails-inconsistency-when-needing-to-reload-model", "title": "Ruby on Rails - inconsistency when needing to reload model?", "body": "<p>I found something which seems a bit confusing to me being new to Rails. I was told I need to do <code>reload!</code> in the console whenever I made a change in the model.</p>\n\n<p>Let's assume I call <code>reload!</code> before these two senarios.</p>\n\n<p>Let's say I have scenario A, with a model with a specific syntax error as such:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  validator :title, presence: true\nend\n</code></pre>\n\n<p>Running <code>Article.new(title: \"Test 1\")</code> will throw a <code>NoMethodError</code>, as it understandably would. But if I then go in and fix the error, even if I don't run <code>reload!</code>, running <code>Article.new(title: \"Test 1\")</code> works now.</p>\n\n<p>Scenario B, going in the opposite direction. I have a model with the correct syntax as such:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  validates :title, presence: true\nend\n</code></pre>\n\n<p>Running <code>Article.new(title: \"Test 1\")</code> will work with no error, as it should. But if I then go in and change <code>validates</code> to <code>validator</code>. If I don't run <code>reload!</code>, running <code>Article.new(title: \"Test 1\")</code> still works despite the <code>article.rb</code> file having a syntax error. It isn't until I run <code>reload!</code> explicitly that I now get a <code>NoMethodError</code>. </p>\n\n<p>What's exactly going on here? I know it's very specific, but I don't see why this would be the case. It seems like sometimes you have to run <code>reload!</code> to update the model (like scenario B) and sometimes, like in scenario A, you don't.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1514105828, "post_id": 47958400, "comment_id": 82887819, "body": "What operation system do you use?"}, {"owner": {"reputation": 21, "user_id": 7161170, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1ElH1.png?s=128&g=1", "display_name": "Thallius", "link": "https://stackoverflow.com/users/7161170/thallius"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1514140598, "post_id": 47958400, "comment_id": 82895605, "body": "Mac OS [High Sierra]is my operating system"}], "answers": [{"tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": false, "score": 1, "last_activity_date": 1514115828, "creation_date": 1514115828, "answer_id": 47960291, "question_id": 47958400, "link": "https://stackoverflow.com/questions/47958400/rails-new-error-puma/47960291#47960291", "title": "Rails new ERROR [Puma]", "body": "<p>You can try with this</p>\n\n<pre><code>gem install puma -- --with-cppflags=-I/usr/local/opt/openssl/include\nbundle install #=&gt; inside project\n</code></pre>\n\n<p>I don't know which OS you using</p>\n\n<p><strong>For Windows</strong></p>\n\n<p>Install <a href=\"https://github.com/hicknhack-software/rails-disco/wiki/Installing-puma-on-windows\" rel=\"nofollow noreferrer\">PUMA GEM</a></p>\n\n<p><strong>For MAC OS</strong></p>\n\n<p>Install <a href=\"https://github.com/puma/puma/issues/783#issuecomment-141254723\" rel=\"nofollow noreferrer\">PUMA GEM</a></p>\n\n<p>I think will help</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13430212, "user_type": "registered", "profile_image": "https://graph.facebook.com/1328889910577679/picture?type=large", "display_name": "L&#234; Tr\u1ecdng Nguy\u1ec5n", "link": "https://stackoverflow.com/users/13430212/l%c3%aa-tr%e1%bb%8dng-nguy%e1%bb%85n"}, "is_accepted": false, "score": 0, "last_activity_date": 1592447354, "last_edit_date": 1592447354, "creation_date": 1588132835, "answer_id": 61494005, "question_id": 47958400, "link": "https://stackoverflow.com/questions/47958400/rails-new-error-puma/61494005#61494005", "title": "Rails new ERROR [Puma]", "body": "<p>This work for me</p>\n\n<ol>\n<li>install ruby with DevKit</li>\n<li>gem install openssl -v 2.1.0</li>\n<li>gem install puma</li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 7161170, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/1ElH1.png?s=128&g=1", "display_name": "Thallius", "link": "https://stackoverflow.com/users/7161170/thallius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592447354, "creation_date": 1514095123, "last_edit_date": 1514095837, "question_id": 47958400, "link": "https://stackoverflow.com/questions/47958400/rails-new-error-puma", "title": "Rails new ERROR [Puma]", "body": "<p>Steps to reproduce\nrails new test_file</p>\n\n<p>Expected rails to create the files and install the gemfile with no errors.</p>\n\n<p>Actual behavior\nThe dependency tzinfo-data (>= 0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mingw32, x86-mswin32, x64-mingw32, java. To add those platforms to the bundle, run bundle lock --add-platform x86-mingw32 x86-mswin32 x64-mingw32 java.</p>\n\n<p>Fetching puma 3.11.0\nInstalling puma 3.11.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.</p>\n\n<p>An error occurred while installing puma (3.11.0), and Bundler cannot\ncontinue.\nMake sure that gem install puma -v '3.11.0' succeeds before bundling.</p>\n\n<p>System configuration\nRuby version: 2.3.0\nRails version: 5.4.1\nPuma version: 3.10.0</p>\n"}, {"tags": ["ruby", "email", "unix"], "comments": [{"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "edited": false, "score": 0, "creation_date": 1514086971, "post_id": 47957816, "comment_id": 82885079, "body": "It would be nice to know why the downvotes."}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1514087306, "post_id": 47957816, "comment_id": 82885121, "body": "What makes using \u201cmail\u201d generic but using \u201cNet::SMTP\u201d not? You seem to be asking for a mythical external program that doesn\u2019t exist."}, {"owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1514088048, "post_id": 47957816, "comment_id": 82885199, "body": "@Joe:  I&#39;m a bit confused by this remark - mail(1) has been a part of Unix since I&#39;ve ever known it (since ca. 1980 or so)., so I think it <i>can</i> be regarded as &quot;standard&quot;.  I mentioned the mail(1) program for precisely this reason, but I&#39;m willing to consider other solutions, as long as they don&#39;t involve installing some other random program that may exist on some specific version of some random platform."}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1514090373, "post_id": 47957816, "comment_id": 82885491, "body": "Voting to close : &quot;Questions asking us to recommend or find a book, <b>tool, software library, tutorial</b> or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.&quot;. Please read  <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> , <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> , <a href=\"https://stackoverflow.com/help/dont-ask\">stackoverflow.com/help/dont-ask</a> ,  <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> before posting more Qs. Tnx"}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1514089004, "creation_date": 1514089004, "answer_id": 47958026, "question_id": 47957816, "link": "https://stackoverflow.com/questions/47957816/portable-way-of-programmatically-sending-an-e-mail-with-an-attachment-under-unix/47958026#47958026", "title": "Portable way of programmatically sending an e-mail with an attachment under Unix", "body": "<p><code>mail</code> command will work only if it can find a SMTP host. There is a number of ways it can be done (sSMTP, Postfix, sendmail). The most \"normal\" way is to have <code>sendmail</code> running on your computer, which means <code>localhost</code> itself is an SMTP server. I don't know of a way of getting the SMTP configuration automatically if you don't have <code>sendmail</code> installed.</p>\n\n<p>Therefore, assuming you know the SMTP server (<code>localhost</code> in this example), from <a href=\"https://www.tutorialspoint.com/ruby/ruby_sending_email.htm\" rel=\"nofollow noreferrer\">Tutorials Point</a> a pure Ruby mail attachment:</p>\n\n<pre><code>require 'net/smtp'\n\nfilename = \"/tmp/test.txt\"\n# Read a file and encode it into base64 format\nfilecontent = File.read(filename)\nencodedcontent = [filecontent].pack(\"m\")   # base64\n\nmarker = \"AUNIQUEMARKER\"\nbody = &lt;&lt;EOF\nThis is a test email to send an attachement.\nEOF\n\n# Define the main headers.\npart1 = &lt;&lt;EOF\nFrom: Private Person &lt;me@fromdomain.net&gt;\nTo: A Test User &lt;test@todmain.com&gt;\nSubject: Sending Attachement\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary = #{marker}\n--#{marker}\nEOF\n\n# Define the message action\npart2 = &lt;&lt;EOF\nContent-Type: text/plain\nContent-Transfer-Encoding:8bit\n\n#{body}\n--#{marker}\nEOF\n\n# Define the attachment section\npart3 = &lt;&lt;EOF\nContent-Type: multipart/mixed; name = \\\"#{filename}\\\"\nContent-Transfer-Encoding:base64\nContent-Disposition: attachment; filename = \"#{filename}\"\n\n#{encodedcontent}\n--#{marker}--\nEOF\n\nmailtext = part1 + part2 + part3\n\n# Let's put our code in safe area\nbegin \n   Net::SMTP.start('localhost') do |smtp|\n      smtp.sendmail(mailtext, 'me@fromdomain.net', ['test@todmain.com'])\n   end\nrescue Exception =&gt; e  \n   print \"Exception occured: \" + e  \nend\n</code></pre>\n"}], "owner": {"reputation": 2050, "user_id": 4488070, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/343f7e053fbfad125f237b9178e5b688?s=128&d=identicon&r=PG&f=1", "display_name": "varro", "link": "https://stackoverflow.com/users/4488070/varro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1514089004, "creation_date": 1514085777, "question_id": 47957816, "link": "https://stackoverflow.com/questions/47957816/portable-way-of-programmatically-sending-an-e-mail-with-an-attachment-under-unix", "title": "Portable way of programmatically sending an e-mail with an attachment under Unix", "body": "<p>I wish to have a portable Unix way of programmatically sending an e-mail with an attachment.  The \"standard\" Unix way of sending an e-mail seems to be mail(1), but there seems to be no portable way of specifying an attachment.  (Yes, I know that <em>some</em> versions of mail(1) have an <code>-a</code> or an <code>-A</code> option, but that's not standard, so I cannot rely on it.)</p>\n\n<p>I'll be using ruby for this, but I want a <em>generic</em> solution, i.e., a special ruby configuration involving (say) using Net::SMTP and specifying details like the SMTP server &amp;c. should <em>not</em> be in the application, but the application should issue a command like <code>mail &lt;some other stuff here&gt;</code> and from there the system should deliver the mail (with a suitable ~/.mailrc or whatever).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514084316, "creation_date": 1514084316, "question_id": 47957729, "link": "https://stackoverflow.com/questions/47957729/undefined-instance-method-for-factory-girl-class-when-using-spring-prelaoder", "title": "undefined instance method for Factory Girl class when using spring prelaoder", "body": "<p>I have a class defined inside my Factory girl definition as follows</p>\n\n<pre><code>factory :user, class: User do\n trait :successful do\n  after(:build) do |u|\n    u.calling_method_from_external_concerns_or_mockey_pached_method\n  end\nend\n</code></pre>\n\n<p>and created the factor object as follows</p>\n\n<pre><code>@user        = build(:user,         :successful)\n</code></pre>\n\n<p>it always pass without the spring preloader, but when I run with spring, it only pass for the first time, after the first time and I make any change in the repo it raises a undefined method (calling_method_from_external_concerns_or_mockey_pached_method) when creating the factory girl object. NOTE: This happens when I make any change in my repo (adding extra line or any other changes), if I stop the preloader run again it would pass.</p>\n\n<p>inside the after build block</p>\n\n<pre><code> after(:build) do |u|\n    u.methods.include?(:calling_method_from_external_concerns_or_mockey_pached_method)\n    # returns false\n\n    User.new.include?(:calling_method_from_external_concerns_or_mockey_pached_method)\n    # returns true\n end\n</code></pre>\n\n<p>The undefined method is defined inside a module which is included before the test</p>\n\n<pre><code>  module Mock\n   def calling_method_from_external_concerns_or_mockey_pached_method; end\n  end\n</code></pre>\n\n<p>Also tried monkey patch as follows inside a different class file, I get the same pattern as mentioned before</p>\n\n<pre><code>  class User\n     def calling_method_from_external_concerns_or_mockey_pached_method; end\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby", "rake-task"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1514088499, "post_id": 47957725, "comment_id": 82885266, "body": "should one <code>Item</code> store the entire HTML?"}, {"owner": {"reputation": 355, "user_id": 2112204, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/6e131ead37a7d2311b317f1a3c61a167?s=128&d=identicon&r=PG", "display_name": "Ruel Nopal", "link": "https://stackoverflow.com/users/2112204/ruel-nopal"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1514093221, "post_id": 47957725, "comment_id": 82885847, "body": "I&#39;m not sure about your questions. @Anthony There are many data but my primary focus is the <code>item_details</code> since its the only data that has arrays. that&#39;s why I don&#39;t need to put all other data which is not relevant to the question. hope that clarify things for you."}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5804032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1086758154668612/picture?type=large", "display_name": "Junsuk Park", "link": "https://stackoverflow.com/users/5804032/junsuk-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1514094665, "creation_date": 1514094665, "answer_id": 47958373, "question_id": 47957725, "link": "https://stackoverflow.com/questions/47957725/how-to-save-json-array-into-html-format-in-rails/47958373#47958373", "title": "How to save Json Array into HTML format in Rails?", "body": "<p>I'm not sure what you tried to do. </p>\n\n<p>Please check below codes and give me a feedback.\nHappy coding :)</p>\n\n<pre><code>&lt;!-- language: ruby --&gt;\nrequire 'json'\n\nclass MyJsonParser\n  def initialize\n    @items = []\n  end\n\n  def parse(json)\n    result = JSON.parse(json)\n    generate_items(result)\n\n    items\n  end\n\n  private\n\n  attr_reader :items\n\n  def generate_items(result)\n    result['mods']['listItems'].each {|item_detail| items &lt;&lt; Item.new(item_detail)}\n  end\nend\n\nclass Item\n  attr_reader :details\n\n  def initialize(detail='')\n    @details = ''\n    before_initialize\n    details &lt;&lt; detail\n    after_initialize\n  end\n\n  private\n\n  def before_initialize\n    details &lt;&lt; '&lt;li&gt;'\n  end\n\n  def after_initialize\n    details &lt;&lt; '&lt;/li&gt;'\n  end\nend\n\njson_str = '{\n  \"mods\": {\n    \"listItems\":\n      [\n        \"Can also work with any bluetooth-enabled smartphones and\\ntablets\",\n        \"For calls and music, Hands-free\",\n        \"Very stylish design and lightweight\",\n        \"Function:Bluetooth,Noise Cancelling,Microphone\",\n        \"Compatible:For Any Device With Bluetooth Function\",\n        \"Chipset: CSR4.0\",\n        \"Bluetooth Version:Bluetooth 4.0\",\n        \"Transmission Distance:10 Meters\"\n      ]\n  }\n}'\n\nresult = MyJsonParser.new.parse(json_str)\nresult.each do |i|\n  p i.details\nend\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 2112204, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/6e131ead37a7d2311b317f1a3c61a167?s=128&d=identicon&r=PG", "display_name": "Ruel Nopal", "link": "https://stackoverflow.com/users/2112204/ruel-nopal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514099100, "creation_date": 1514084265, "last_edit_date": 1514099100, "question_id": 47957725, "link": "https://stackoverflow.com/questions/47957725/how-to-save-json-array-into-html-format-in-rails", "title": "How to save Json Array into HTML format in Rails?", "body": "<p>Hello Ruby users i have Json Array format</p>\n\n<pre><code>[\n\"Can also work with any bluetooth-enabled smartphones and\\ntablets\",\n \"For calls and music, Hands-free\", \n\"Very stylish design and lightweight\", \n\"Function:Bluetooth,Noise Cancelling,Microphone\", \n\"Compatible:For Any Device With Bluetooth Function\", \n\"Chipset: CSR4.0\", \"Bluetooth Version:Bluetooth 4.0\", \n\"Transmission Distance:10 Meters\"\n]\n</code></pre>\n\n<p>I want to save this array into html formal using the html format which is below. </p>\n\n<pre><code>&lt;ul&gt;\n    &lt;li&gt;Can also work with any bluetooth-enabled smartphones and\\ntablets&lt;/li&gt; \n    &lt;li&gt;For calls and music, Hands-free&lt;/li&gt; \n    &lt;li&gt;Very stylish design and lightweight&lt;/li&gt; \n    &lt;li&gt;Function:Bluetooth,Noise Cancelling,Microphone&lt;/li&gt; \n    &lt;li&gt;Compatible:For Any Device With Bluetooth Function&lt;/li&gt; \n    &lt;li&gt;Chipset: CSR4.0&lt;/li&gt; \n    &lt;li&gt;Bluetooth Version:Bluetooth 4.0&lt;/li&gt; \n    &lt;li&gt;Transmission Distance:10 Meters&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>This is my current code which is working correctly if i have to save it just the array however i need this to be html format so user can easily read it</p>\n\n<pre><code>result = JSON.parse(jsonparse)\n\nresult[\"mods\"][\"listItems\"].each do |result|\n    @item = Item.new\n    @item.item_details = result[\"description\"]\n\n    @item.save\nend\n</code></pre>\n\n<p><strong>Under my Previous Attempt to solve like this</strong></p>\n\n<pre><code>result = JSON.parse(jsonparse)\n\nresult[\"mods\"][\"listItems\"].each do |result|\n    @item = Item.new\n\n    item_list = result[\"description\"]\n    item_list.each do |list|\n      @item.item_details = \"&lt;li&gt;\"+list+\"&lt;/li&gt;\"\n    end\n\n    @item.save\nend\n</code></pre>\n\n<p>This one only save one of the array and no <code>&lt;ul&gt;</code> head</p>\n\n<p>heres the original code</p>\n\n<pre><code>namespace :scraper do\n  desc \"Scrape Website\"\n  task somesite: :environment do\n\n    require 'open-uri'\n    require 'nokogiri'\n    require 'json'\n\n        url = \"url here!\"\n        page = Nokogiri::HTML(open(url))\n        script = page.search('head script')[2]\n\n        jsonparse = script.content[/\\{\\\"[a-zA-Z0-9\\\"\\:\\-\\,\\ \\=\\(\\)\\.\\_\\D\\/\\[\\]\\}]+/i]\n\n        result = JSON.parse(jsonparse)\n\n        result[\"mods\"][\"listItems\"].each do |result|\n            @item = Item.new\n\n\n            item_details = result[\"description\"].each {|list| \"&lt;li&gt;#{list}&lt;/li&gt;\" }\n            puts item_details\n\n            @item.item_old_price = result[\"originalPrice\"]\n            @item.item_final_price = result[\"price\"]\n\n            @item.save\n        end\n  end\nend\n</code></pre>\n\n<p>The Idea is to save the Array into database with the html format.</p>\n\n<pre><code>    &lt;ul&gt;\n    &lt;li&gt;content 1&lt;/li&gt;\n    &lt;li&gt;content 2&lt;/li&gt;\n    &lt;li&gt;content and soon&lt;/li&gt;\n    &lt;/ul&gt;\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "edited": false, "score": 0, "creation_date": 1514074237, "post_id": 47957005, "comment_id": 82883517, "body": "what is the web driver you are using? is it selenium ?"}, {"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "reply_to_user": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "edited": false, "score": 0, "creation_date": 1514074389, "post_id": 47957005, "comment_id": 82883540, "body": "The web-driver is selenium, correct."}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "edited": false, "score": 0, "creation_date": 1514075588, "post_id": 47957097, "comment_id": 82883678, "body": "This led me to the solution. I found that the driver that Capybara was using was rack_test, which doesn&#39;t support js. Once I registered another driver, it worked. Thanks for the help"}], "tags": [], "owner": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "is_accepted": true, "score": 2, "last_activity_date": 1514089928, "last_edit_date": 1514089928, "creation_date": 1514074517, "answer_id": 47957097, "question_id": 47957005, "link": "https://stackoverflow.com/questions/47957005/rails-cucumber-testing-ajax-using-capybara/47957097#47957097", "title": "Rails Cucumber Testing AJAX using Capybara", "body": "<p>I would normally goes with selenium driver with @javascript tag to test Ajax calls.</p>\n\n<p>In your features/support/capybara.rb </p>\n\n<pre><code>Capybara.default_driver = :selenium\n</code></pre>\n\n<p>Or try @javascript tag above the scenario</p>\n\n<pre><code>@javascript\nScenario: If a shopper selects a different size or color\nGiven the shopper is on the \"shop\" page\n  When the shopper clicks on \"Master Coat\"\n  And the shopper selects a size \"M\"\n  Then the total quantity should change to \"2\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "edited": false, "score": 0, "creation_date": 1514075660, "post_id": 47957154, "comment_id": 82883691, "body": "I started off with select_option but then go to click from troubleshooting. Based on Shani&#39;s advice, I found out it was a driver issue not anything that I had in my code. Thanks for the response."}], "tags": [], "owner": {"reputation": 3272, "user_id": 2389628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4nuI.jpg?s=128&g=1", "display_name": "smallbutton", "link": "https://stackoverflow.com/users/2389628/smallbutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1514075319, "creation_date": 1514075319, "answer_id": 47957154, "question_id": 47957005, "link": "https://stackoverflow.com/questions/47957005/rails-cucumber-testing-ajax-using-capybara/47957154#47957154", "title": "Rails Cucumber Testing AJAX using Capybara", "body": "<p>Maybe you should try selecting the option with <code>.select_option</code> rather than <code>.click</code>. </p>\n\n<pre><code>When /^the shopper selects a size \"(.+)\"$/ do |size|\n   find('.select-size').find(:option, size).select_option\nend\n</code></pre>\n\n<p>(<a href=\"https://stackoverflow.com/questions/20134085/how-to-select-option-in-drop-down-using-capybara\">How to select option in drop down using Capybara</a>)</p>\n"}], "owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 47957097, "answer_count": 2, "score": 1, "last_activity_date": 1514089928, "creation_date": 1514073215, "question_id": 47957005, "link": "https://stackoverflow.com/questions/47957005/rails-cucumber-testing-ajax-using-capybara", "title": "Rails Cucumber Testing AJAX using Capybara", "body": "<p>I am using Rspec, Capybara, and Cucumber to test a feature of my site. Essentially, I have a fashion e-commerce site. I have the shop page which displays all the the items, and when you click on a specific item, it takes you to the detail page for that item, lets say a sweater. For this sweater, as the shopper, you have the option of selecting the size and color that you want. The last option is the quantity that you want of a selected size and color. However, I have JS code that triggers an AJAX call to update the total available quantity if a shopper selects a different size or color. So if you start with a small, blue sweater, and you change the size to medium, the AJAX call will retrieve the total available medium, blue sweaters. So if there are 10 available, then the select option for quantity will go from 1 to 10. Now to test this functionality I have the following:</p>\n\n<pre><code># first create the items for the test db:\nGiven /^there are four total items and three unique item names$/ do\n  create(:product, size: 'M', color: 'Black')\n  create(:product, size: 'M', color: 'Black')\n  create(:product, size: 'S', color: 'Black')\n  create(:product, size: 'S', color: 'White')\n  create(:product, size: 'S', color: 'White', available: false)\n  create(:product, name: 'Alicia Dress', size: 'L', color: 'black', order: 3)\n  create(:product, name: 'Cleopatra Dress', size: 'L', color: 'blue', order: 2)\nend\n</code></pre>\n\n<p>Then I have my cucumber test (note the starting options are small and black, which only has a quantity of 1, but when you change the size option to M, it should go to 2 since there are two M black coats):</p>\n\n<pre><code>Scenario: If a shopper selects a different size or color\n  Given the shopper is on the \"shop\" page\n  When the shopper clicks on \"Master Coat\"\n  And the shopper selects a size \"M\"\n  Then the total quantity should change to \"2\"\n</code></pre>\n\n<p>And my test steps:</p>\n\n<pre><code>When /^the shopper selects a size \"(.+)\"$/ do |size|\n  find('.select-size').find(:option, size).click\nend\n\nThen /^the total quantity should change to \"(.+)\"$/ do |quantity|\n  expect(page).to have_css('option', :text =&gt; quantity)\nend\n</code></pre>\n\n<p>Note, I left out the steps for the Given and When since I know those work. My main issue, is that after the \"And the shopper selects a size M\" the AjAX call is supposed to fire and change the quantity, but in my last step the quantity stays 1 and does not change to 2, as its supposed and as it does when I test it manually. My guess is that either the AJAX isn't firing or its firing after the last test step, and therefore not finishing before the test checks the result. </p>\n\n<p>Am I setting this up correctly? And if so, how can I make my matcher test for the AJAX response? I tried several things but it wasn't working.</p>\n"}, {"tags": ["ruby", "ubuntu", "ruby-2.3", "aptitude", "ubuntu-17.10"], "answers": [{"tags": [], "owner": {"reputation": 419, "user_id": 4427782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/595d46b9161968fbe0262b646e72c41a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Paulin", "link": "https://stackoverflow.com/users/4427782/thomas-paulin"}, "is_accepted": true, "score": 0, "last_activity_date": 1515365674, "creation_date": 1515365674, "answer_id": 48142305, "question_id": 47956424, "link": "https://stackoverflow.com/questions/47956424/aptitude-has-unmet-dependencies-and-encounters-a-segmentation-fault-when-perform/48142305#48142305", "title": "Aptitude has unmet dependencies and encounters a segmentation fault when performing the recommended fix. How do I fix it?", "body": "<p>I ended up removing <code>ri</code>, <code>ruby-full</code>, and the other packages mentioned then ran <code>apt-get update</code>.</p>\n"}], "owner": {"reputation": 419, "user_id": 4427782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/595d46b9161968fbe0262b646e72c41a?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Paulin", "link": "https://stackoverflow.com/users/4427782/thomas-paulin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 48142305, "answer_count": 1, "score": 0, "last_activity_date": 1515365674, "creation_date": 1514066999, "question_id": 47956424, "link": "https://stackoverflow.com/questions/47956424/aptitude-has-unmet-dependencies-and-encounters-a-segmentation-fault-when-perform", "title": "Aptitude has unmet dependencies and encounters a segmentation fault when performing the recommended fix. How do I fix it?", "body": "<p>I am on Ubuntu 17.10, freshly installed and tried to installed Ruby using <code>apt-get install ruby-full</code>. It failed to install and now aptitude says</p>\n\n<blockquote>\n  <p>The following packages have unmet dependencies:\n   ri: Depends: ruby2.3-doc but it is not installed\n  E: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specifiy a solution).</p>\n</blockquote>\n\n<p>I tried the suggested command as well as <code>sudo apt-get install -f -y</code> to no avail: It begins the install process then tells me there was an error processing the ruby2.3-doc archive </p>\n\n<blockquote>\n  <p>Reading package lists... Done<br>\n  Building dependency tree<br>\n  Reading state information... Done<br>\n  Correcting dependencies... Done<br>\n  The following additional packages will be installed:<br>\n  ruby2.3-doc<br>\n  The following NEW packages will be installed:<br>\n   ruby2.3-doc<br>\n  0 upgraded, 1 newly installed, 0 to remove and 17 not upgraded.<br>\n  21 not fully installed or removed.<br>\n  Need to get 0 B/3,382 kB of archives.<br>\n  After this operation, 27.7 MB of additional disk space will be used. \n   (Reading database ... 182724 files and directories currently installed.)\n  Preparing to unpack .../ruby2.3-doc_2.3.3-1ubuntu1_all.deb ...<br>\n  Unpacking ruby2.3-doc (2.3.3-1ubuntu1) ...<br>\n  dpkg: error processing archive /var/cache/apt/archives/ruby2.3-doc_2.3.3-1ubuntu1_all.deb (--unpack):<br>\n   unable to open '/usr/share/ri/2.3.0/system/page-ChangeLog-2_1_0.ri.dpkg->new': Operation not permitted<br>\n  Errors were encountered while processing:<br>\n  /var/cache/apt/archives/ruby2.3-doc_2.3.3-1ubuntu1_all.deb<br>\n  E: Sub-process /usr/bin/dpkg returned an error code (1)  </p>\n</blockquote>\n\n<p>I tried clearing aptitude's cache in case a package failed to download correctly but that did not fix it.</p>\n\n<p>Because this means there are unmet dependencies, I'm unable to run other aptitude operations to try and install new packages or remove <code>ruby-full</code>.</p>\n\n<p>How can I remove this ruby-full package so I can try again using rvm?</p>\n"}, {"tags": ["ruby", "xml", "mechanize", "mechanize-ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1977840"}, "reply_to_user": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "edited": false, "score": 0, "creation_date": 1514249835, "post_id": 47955866, "comment_id": 82915648, "body": "In case anyone comes across this later I used this piece of regexp to fix it: /.*\\&lt;(\\d).*\\&gt;.*\\&lt;\\/(\\1).*&gt;.*/  It works for my predictable pattern of invalid SQL.  I just sub &quot;3&quot;rd for &quot;Thi&quot;rd in both captured groups."}], "answers": [{"tags": [], "owner": {"reputation": 1454, "user_id": 1477940, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f10a7263b299645bfbdcf747c0179297?s=128&d=identicon&r=PG", "display_name": "DonPaulie", "link": "https://stackoverflow.com/users/1477940/donpaulie"}, "is_accepted": false, "score": 0, "last_activity_date": 1514064934, "creation_date": 1514064934, "answer_id": 47956227, "question_id": 47955866, "link": "https://stackoverflow.com/questions/47955866/how-to-parse-an-invalid-xml/47956227#47956227", "title": "How to parse an Invalid XML", "body": "<p><code>Nokogiri::HTML</code> is much more permissive. It'll need some adjustments, but it can parse it. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1977840"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "closed_date": 1514079987, "answer_count": 1, "score": 1, "last_activity_date": 1514064934, "creation_date": 1514061716, "question_id": 47955866, "link": "https://stackoverflow.com/questions/47955866/how-to-parse-an-invalid-xml", "closed_reason": "Duplicate", "title": "How to parse an Invalid XML", "body": "<p>I have a project I'm working on where I request an XML document from a server and parse it to import the data into my system.  I'm using Ruby 2.4.3.  </p>\n\n<p>My issues is that the XML comes in with element tags that have names starting with numbers.  Nokogiri see these tags as part as the previous tag's content and messes up parsing the rest of the document.  </p>\n\n<p>I'm using Mechanize to request the data.  Any ideas of which way to go?</p>\n\n<p>The only thing I can think of is to write a completely custom parser in Mechanize which I would rather not do.  </p>\n\n<p>I was also thinking about parsing the xml as a string first to rename those elements, but wasn't sure if that was the cleanest way to do it.  Any advice is much appreciated.</p>\n\n<p>Here is an example of the data I'm parsing</p>\n\n<pre><code>&lt;Rooms&gt;\\r\n          &lt;2ndBedroomArea&gt;144&lt;/2ndBedroomArea&gt;\\r\n          &lt;2ndKitchenArea&gt;144&lt;/2ndKitchenArea&gt;\\r\n          &lt;3rdBedroomArea&gt;168&lt;/3rdBedroomArea&gt;\\r\n          &lt;4thBedroomArea&gt;156&lt;/4thBedroomArea&gt;\\r\n          &lt;FamilyRoomArea&gt;368&lt;/FamilyRoomArea&gt;\\r\n          &lt;FormalDiningRoomArea&gt;144&lt;/FormalDiningRoomArea&gt;\\r\n          &lt;GreatRoomArea&gt;0&lt;/GreatRoomArea&gt;\\r\n          &lt;InformalDiningRoomArea&gt;187&lt;/InformalDiningRoomArea&gt;\\r\n          &lt;KitchenArea&gt;168&lt;/KitchenArea&gt;\\r\n          &lt;LaundryRoomArea&gt;84&lt;/LaundryRoomArea&gt;\\r\n          &lt;LivingRoomArea&gt;272&lt;/LivingRoomArea&gt;\\r\n          &lt;MasterBedroomArea&gt;238&lt;/MasterBedroomArea&gt;\\r\n          &lt;OfficeArea&gt;144&lt;/OfficeArea&gt;\\r\n          &lt;RecreationRoomArea&gt;0&lt;/RecreationRoomArea&gt;\\r\n          &lt;2ndBedroomDim&gt;12 x 12&lt;/2ndBedroomDim&gt;\\r\n          &lt;2ndKitchenDim&gt;12 x 12&lt;/2ndKitchenDim&gt;\\r\n          &lt;3rdBedroomDim&gt;12 x 14&lt;/3rdBedroomDim&gt;\\r\n          &lt;4thBedroomDim&gt;13 x 12&lt;/4thBedroomDim&gt;\\r\n          &lt;FamilyRoomDim&gt;16 x 23&lt;/FamilyRoomDim&gt;\\r\n          &lt;FormalDiningRoomDim&gt;12 x 12&lt;/FormalDiningRoomDim&gt;\\r\n          &lt;GreatRoomDim&gt;0 x 0&lt;/GreatRoomDim&gt;\\r\n          &lt;InformalDiningRoomDim&gt;17 x 11&lt;/InformalDiningRoomDim&gt;\\r\n          &lt;KitchenDim&gt;14 x 12&lt;/KitchenDim&gt;\\r\n          &lt;LaundryRoomDim&gt;6 x 14&lt;/LaundryRoomDim&gt;\\r\n          &lt;LivingRoomDim&gt;17 x 16&lt;/LivingRoomDim&gt;\\r\n          &lt;MasterBedroomDim&gt;17 x 14&lt;/MasterBedroomDim&gt;\\r\n          &lt;OfficeDim&gt;12 x 12&lt;/OfficeDim&gt;\n          &lt;RecreationRoomDim&gt;0 x 0&lt;/RecreationRoomDim&gt;\\r\n          &lt;2ndBedroomLen&gt;12&lt;/2ndBedroomLen&gt;\\r\n          &lt;2ndKitchenLen&gt;12&lt;/2ndKitchenLen&gt;\\r\n          &lt;3rdBedroomLen&gt;12&lt;/3rdBedroomLen&gt;\\r\n          &lt;4thBedroomLen&gt;13&lt;/4thBedroomLen&gt;\\r\n          &lt;FamilyRoomLen&gt;16&lt;/FamilyRoomLen&gt;\\r\n          &lt;FormalDiningRoomLen&gt;12&lt;/FormalDiningRoomLen&gt;\\r\n          &lt;GreatRoomLen&gt;0&lt;/GreatRoomLen&gt;\\r\n          &lt;InformalDiningRoomLen&gt;17&lt;/InformalDiningRoomLen&gt;\\r\n          &lt;KitchenLen&gt;14&lt;/KitchenLen&gt;\\r\n          &lt;LaundryRoomLen&gt;6&lt;/LaundryRoomLen&gt;\\r\n          &lt;LivingRoomLen&gt;17&lt;/LivingRoomLen&gt;\\r\n          &lt;MasterBedroomLen&gt;17&lt;/MasterBedroomLen&gt;\\r\n          &lt;OfficeLen&gt;12&lt;/OfficeLen&gt;\\r\n          &lt;RecreationRoomLen&gt;0&lt;/RecreationRoomLen&gt;\\r\n          &lt;2ndBedroomWid&gt;12&lt;/2ndBedroomWid&gt;\\r\n          &lt;2ndKitchenWid&gt;12&lt;/2ndKitchenWid&gt;\\r\n          &lt;3rdBedroomWid&gt;14&lt;/3rdBedroomWid&gt;\\r\n          &lt;4thBedroomWid&gt;12&lt;/4thBedroomWid&gt;\\r\n          &lt;FamilyRoomWid&gt;23&lt;/FamilyRoomWid&gt;\\r\n          &lt;FormalDiningRoomWid&gt;12&lt;/FormalDiningRoomWid&gt;\\r\n          &lt;GreatRoomWid&gt;0&lt;/GreatRoomWid&gt;\\r\n          &lt;InformalDiningRoomWid&gt;11&lt;/InformalDiningRoomWid&gt;\\r\n          &lt;KitchenWid&gt;12&lt;/KitchenWid&gt;\\r\n          &lt;LaundryRoomWid&gt;14&lt;/LaundryRoomWid&gt;\\r\n          &lt;LivingRoomWid&gt;16&lt;/LivingRoomWid&gt;\\r\n          &lt;MasterBedroomWid&gt;14&lt;/MasterBedroomWid&gt;\\r\n          &lt;OfficeWid&gt;12&lt;/OfficeWid&gt;\\r\n          &lt;RecreationRoomWid&gt;0&lt;/RecreationRoomWid&gt;\\r\n          &lt;5thBedroomArea&gt;0&lt;/5thBedroomArea&gt;\\r\n          &lt;5thBedroomDim&gt;0 x 0&lt;/5thBedroomDim&gt;\\r\n          &lt;5thBedroomLen&gt;0&lt;/5thBedroomLen&gt;\\r\n          &lt;5thBedroomWid&gt;0&lt;/5thBedroomWid&gt;\\r\n          &lt;6thBedroomArea&gt;0&lt;/6thBedroomArea&gt;\\r\n          &lt;6thBedroomDim&gt;0 x 0&lt;/6thBedroomDim&gt;\\r\n          &lt;6thBedroomLen&gt;0&lt;/6thBedroomLen&gt;\\r\n          &lt;6thBedroomWid&gt;0&lt;/6thBedroomWid&gt;\\r\n        &lt;/Rooms&gt;\\r\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 389, "user_id": 2743124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/VcxZw.jpg?s=128&g=1", "display_name": "Chetan Datta", "link": "https://stackoverflow.com/users/2743124/chetan-datta"}, "edited": false, "score": 0, "creation_date": 1514064336, "post_id": 47955202, "comment_id": 82881690, "body": "If you have analyzed the above error, in the first line itself, it clearly says its syntax error.. <code>C:&#47;Sites&#47;blog&#47;config&#47;routes.rb:10: syntax error, unexpected end-of-input, expecting keyword_end (SyntaxError)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": false, "score": 0, "last_activity_date": 1514058030, "creation_date": 1514058030, "answer_id": 47955442, "question_id": 47955202, "link": "https://stackoverflow.com/questions/47955202/rails-generate-controller-comments-not-creating-the-files-it-should-create/47955442#47955442", "title": "rails generate controller Comments not creating the files it should create", "body": "<p>Your <code>routes.rb</code> has an error in it somewhere. Backup your existing <code>routes.rb</code> file and then change it to,</p>\n\n<pre><code>Rails.application.routes.draw do\n\nend\n</code></pre>\n\n<p>Then run your generate command. Afterwards, add the previous contents back into <code>routes.rb</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9128564"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514058030, "creation_date": 1514055973, "question_id": 47955202, "link": "https://stackoverflow.com/questions/47955202/rails-generate-controller-comments-not-creating-the-files-it-should-create", "title": "rails generate controller Comments not creating the files it should create", "body": "<p>Am following ruby on rails documentation and am hooked here, it dosen't seem to create expected files, i need some help please.</p>\n\n<pre><code>C:\\Sites\\blog&gt;rails generate controller Comments\n</code></pre>\n\n<p>i ran the code above but got this instead.</p>\n\n<pre><code>C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:286:in `load': C:/Sites/blog/config/routes.rb:10: syntax error, unexpected end-of-input, expecting keyword_end (SyntaxError)\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:286:in `block in load'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:258:in `load_dependency'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:286:in `load'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:55:in `block in load_paths'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:55:in `each'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:55:in `load_paths'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:18:in `reload!'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:41:in `block in updater'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.1.4/lib/active_support/file_update_checker.rb:81:in `execute'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:42:in `updater'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/routes_reloader.rb:31:in `execute_if_updated'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application/finisher.rb:128:in `block in &lt;module:Finisher&gt;'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:30:in `instance_exec'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:30:in `run'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:59:in `block in run_initializers'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `each'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `call'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:58:in `run_initializers'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application.rb:353:in `initialize!'\n        from C:/Sites/blog/config/environment.rb:5:in `&lt;top (required)&gt;'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application.rb:329:in `require'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/application.rb:329:in `require_environment!'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/command/actions.rb:16:in `require_application_and_environment!'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/commands/generate/generate_command.rb:19:in `perform'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/command/base.rb:63:in `perform'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/command.rb:44:in `invoke'\n        from C:/RailsInstaller/Ruby2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.1.4/lib/rails/commands.rb:16:in `&lt;top (required)&gt;'\n        from bin/rails:4:in `require'\n        from bin/rails:4:in `&lt;main&gt;'\n\n - List item\n</code></pre>\n\n<p>Please help me, and is documentation the best place for learning rails</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1514050180, "post_id": 47954513, "comment_id": 82878308, "body": "post the controller code and I am sure you can get the answer"}, {"owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "reply_to_user": {"reputation": 3521, "user_id": 2521680, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/6D935.jpg?s=128&g=1", "display_name": "Rockwell Rice", "link": "https://stackoverflow.com/users/2521680/rockwell-rice"}, "edited": false, "score": 0, "creation_date": 1514050504, "post_id": 47954513, "comment_id": 82878374, "body": "@RockwellRicecontroller code is just an empty &#39;new&#39; method for now which would go to the &#39;new&#39; view which contains the form_with method. so the controller doesnt really contain any useful information"}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "edited": false, "score": 0, "creation_date": 1514051517, "post_id": 47954623, "comment_id": 82878628, "body": "1) is this a case of simply updating the rails gem in this project&#39;s Gemfile  or something more complicated?  2) if i update will this affect other projects i am running locally and/or in production?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "edited": false, "score": 0, "creation_date": 1514053621, "post_id": 47954623, "comment_id": 82879225, "body": "There may be other changes needed when upgrading from 5.0.6 to 5.1.4, check the release notes and changelogs. Upgrading just this one project shouldn&#39;t affect others that you&#39;re running."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 2, "last_activity_date": 1514050980, "creation_date": 1514050980, "answer_id": 47954623, "question_id": 47954513, "link": "https://stackoverflow.com/questions/47954513/why-is-form-with-resulting-in-a-nomethoderror-in-articlesnew/47954623#47954623", "title": "why is form_with resulting in a NoMethodError in Articles#new?", "body": "<p>From the <a href=\"http://edgeguides.rubyonrails.org/5_1_release_notes.html#unification-of-form-for-and-form-tag-into-form-with\" rel=\"nofollow noreferrer\">Rails 5.1 release notes</a>:</p>\n\n<blockquote>\n  <p>Before Rails 5.1, there were two interfaces for handling HTML forms: <code>form_for</code> for model instances and <code>form_tag</code> for custom URLs.</p>\n  \n  <p>Rails 5.1 combines both of these interfaces with <code>form_with</code>, and can generate form tags based on URLs, scopes or models.</p>\n</blockquote>\n\n<p>So yes, <code>form_with</code> is fairly recent and not available in Rails 5.0.6.</p>\n\n<p>You could upgrade (the latest is 5.1.4) or switch to <code>form_tag</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 3167046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWRP9.jpg?s=128&g=1", "display_name": "SrishAkaTux", "link": "https://stackoverflow.com/users/3167046/srishakatux"}, "is_accepted": false, "score": 0, "last_activity_date": 1521156917, "creation_date": 1521156917, "answer_id": 49310977, "question_id": 47954513, "link": "https://stackoverflow.com/questions/47954513/why-is-form-with-resulting-in-a-nomethoderror-in-articlesnew/49310977#49310977", "title": "why is form_with resulting in a NoMethodError in Articles#new?", "body": "<p>If you are using the form_tag syntax, then you will also have to change the syntax for input fields as follows:</p>\n\n<pre><code>&lt;%= form_tag scope: :article, url: articles_path, local: true do |form| %&gt;\n  &lt;p&gt;\n    &lt;%= label_tag(:title) %&gt;&lt;br&gt;\n    &lt;%= text_field_tag(:title) %&gt;\n  &lt;/p&gt;  \n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 82, "user_id": 7493568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36df9f62b4ebd1422de26482eb0d78c?s=128&d=identicon&r=PG", "display_name": "wvinyl", "link": "https://stackoverflow.com/users/7493568/wvinyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1522511291, "creation_date": 1522511291, "answer_id": 49589584, "question_id": 47954513, "link": "https://stackoverflow.com/questions/47954513/why-is-form-with-resulting-in-a-nomethoderror-in-articlesnew/49589584#49589584", "title": "why is form_with resulting in a NoMethodError in Articles#new?", "body": "<p>I ran into this problem running Rails, as 4.2.1 . I needed to update Rails, <strong>but also</strong> to escape my package manager's (apt) repository, which was outdated. This led me to the rvm mananger, the Ruby Version Manager (<a href=\"https://rvm.io/\" rel=\"nofollow noreferrer\">https://rvm.io/</a>). Depending on your operating system, you will have a different guide here: <a href=\"http://railsapps.github.io/updating-rails.html\" rel=\"nofollow noreferrer\">http://railsapps.github.io/updating-rails.html</a>.</p>\n\n<p>You may be experiencing  a development environment without the most current version of all the gems that are needed for development. As is stated in updating rails link : \"Developers often install the newest version of Rails but neglect other components needed for Rails to run successfully.\"</p>\n\n<p>Also I advise starting the tutorial from the beginning creating a <code>rails new blog</code>after updating to ensure you are not using the Gemfile specifications from your previous build.</p>\n"}], "owner": {"reputation": 321, "user_id": 7631261, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/34c3f5c01682697bbf4c010f477c47f1?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7631261/owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2896, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1522511291, "creation_date": 1514050043, "question_id": 47954513, "link": "https://stackoverflow.com/questions/47954513/why-is-form-with-resulting-in-a-nomethoderror-in-articlesnew", "title": "why is form_with resulting in a NoMethodError in Articles#new?", "body": "<p>I am following the getting started section in the rails guides to build a blog. I have reached the first form section 5.2 and when loading the page i get:</p>\n\n<pre><code>NoMethodError in Articles#new\n\nShowing C:/Sites/blog/app/views/articles/new.html.erb where line #1 raised:\n\nundefined method `form_with' for #&lt;#&lt;Class:0x8a44a18&gt;:0xaf1d990&gt;\n\nExtracted source (around line #1):\n\n&lt;%= form_with scope: :article, url: articles_path, local: true do |form| %&gt;\n  &lt;p&gt;\n    &lt;%= form.label :title %&gt;&lt;br&gt;\n    &lt;%= form.text_field :title %&gt;\n  &lt;/p&gt;\n</code></pre>\n\n<p>Is form_with a relatively new method in rails? because i thought form normally use form_for or form_tag. </p>\n\n<p>I installed rails a few months ago and i am using version 5.0.6. </p>\n\n<p>1) should i update to the latest version?</p>\n\n<p>2) is this a case of simply updating the rails gem in this project or something more complicated?</p>\n\n<p>3) if i update will this affect other projects i am running locally and/or in production?</p>\n\n<p>4) is there another reason why this form_with is not working</p>\n"}, {"tags": ["ruby", "cucumber", "haml", "watir"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6676562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-pCI9lQj1zX0/AAAAAAAAAAI/AAAAAAAAAMU/ETqkAO90k64/photo.jpg?sz=128", "display_name": "Apzal Bahin", "link": "https://stackoverflow.com/users/6676562/apzal-bahin"}, "edited": false, "score": 0, "creation_date": 1514375712, "post_id": 47981565, "comment_id": 82951637, "body": "Thank You.You assumption is correct.Is it possible to edit the html coming along with cucumber."}, {"owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "reply_to_user": {"reputation": 61, "user_id": 6676562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-pCI9lQj1zX0/AAAAAAAAAAI/AAAAAAAAAMU/ETqkAO90k64/photo.jpg?sz=128", "display_name": "Apzal Bahin", "link": "https://stackoverflow.com/users/6676562/apzal-bahin"}, "edited": false, "score": 0, "creation_date": 1514502382, "post_id": 47981565, "comment_id": 83000155, "body": "Well it is open source, so it&#39;s possible to do just about anything if you want to fork the code and modify things.  If you are serious about making changes to the HTML results formatter, I&#39;d ask in the cucumber google group.   The other option might be to use a standard format like JUNIT (another option cucumber supports) and then write something to parse the resulting XML and transform it into a report in the format you prefer.    just a question of what use of your time is more valuable, creating tests, or pretty output from the tests."}], "tags": [], "owner": {"reputation": 6589, "user_id": 409820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b01ab32f3a9016b9e2ade35f3aeb4023?s=128&d=identicon&r=PG", "display_name": "Chuck van der Linden", "link": "https://stackoverflow.com/users/409820/chuck-van-der-linden"}, "is_accepted": true, "score": 0, "last_activity_date": 1514308026, "creation_date": 1514308026, "answer_id": 47981565, "question_id": 47953692, "link": "https://stackoverflow.com/questions/47953692/is-there-any-way-to-use-haml-file-with-watir/47981565#47981565", "title": "Is there any way to use haml file with Watir", "body": "<p>So your question doesn't say what you are using to do your testing, but based on the tags I'm going to assume you are using cucumber to express and run your tests, and Watir to drive a browser within the test steps.</p>\n\n<p>If that is correct then I do not know of a way to get output in HAML format.. </p>\n\n<p>Cucumber <em>does</em> offer the option to output the test results in HTML.  That can be specified in the defaults file for cucumber, or from the command line.  To tell cucumber to generate results in HTML format you normally need two switches on the command line, one <code>-f html</code> to specify the format of the output as html, then <code>-o results.html</code> to specify the filename for the output.</p>\n\n<pre><code>cucumber -f html -o results.html\n</code></pre>\n\n<p>If you are new to cucumber I <strong>strongly recommend</strong> purchasing and reading <em>The Cucumber Book</em> it's the best way I know of to get off to a good start and avoid some of the common pitfalls when using the tool. </p>\n"}], "owner": {"reputation": 61, "user_id": 6676562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-pCI9lQj1zX0/AAAAAAAAAAI/AAAAAAAAAMU/ETqkAO90k64/photo.jpg?sz=128", "display_name": "Apzal Bahin", "link": "https://stackoverflow.com/users/6676562/apzal-bahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 47981565, "answer_count": 1, "score": 0, "last_activity_date": 1514308026, "creation_date": 1514042839, "last_edit_date": 1514052784, "question_id": 47953692, "link": "https://stackoverflow.com/questions/47953692/is-there-any-way-to-use-haml-file-with-watir", "title": "Is there any way to use haml file with Watir", "body": "<p>I want to see the test result in a html file,  but I don't know if I can use haml to code the test results.  If there is any possible solution, please intimate.</p>\n"}, {"tags": ["ruby", "performance"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1514042335, "post_id": 47953598, "comment_id": 82876485, "body": "<code>digits</code> builds and populates an array. This isn&#39;t cheap."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514048584, "post_id": 47953598, "comment_id": 82877886, "body": "@SergioTulentsev Then why is <code>b.to_s.chars.map(&amp;:to_i).reverse</code> about five times faster than <code>b.digits</code> for me? That also creates the same array, and in a much more laborious way."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514050348, "post_id": 47953598, "comment_id": 82878339, "body": "@StefanPochmann <a href=\"https://gist.github.com/stulentsev/a48ac7e8406f6ad28b1372e43a73c0c0\" rel=\"nofollow noreferrer\">can&#39;t reproduce</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514050460, "post_id": 47953598, "comment_id": 82878363, "body": "@StefanPochmann: hmm, this number is too small. With longer numbers digits indeed becomes significantly slower. :shrug: Still it builds an array (not cheap). And some other expensive things too :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514050557, "post_id": 47953598, "comment_id": 82878386, "body": "@StefanPochmann: but <code>.to_s.length</code> <a href=\"https://gist.github.com/stulentsev/a48ac7e8406f6ad28b1372e43a73c0c0\" rel=\"nofollow noreferrer\">runs circles around both variants</a> anyway"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514050880, "post_id": 47953598, "comment_id": 82878456, "body": "Frank: while unrelated to this question, just want to let you know that there&#39;s a constant time (yes, O(1)) solution here. Involving a bit of math. :)"}, {"owner": {"reputation": 431, "user_id": 4330906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzUqv.jpg?s=128&g=1", "display_name": "Frank Kair", "link": "https://stackoverflow.com/users/4330906/frank-kair"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514051403, "post_id": 47953598, "comment_id": 82878605, "body": "@SergioTulentsev Seriously? I would certainly like to know!"}, {"owner": {"reputation": 431, "user_id": 4330906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzUqv.jpg?s=128&g=1", "display_name": "Frank Kair", "link": "https://stackoverflow.com/users/4330906/frank-kair"}, "edited": false, "score": 0, "creation_date": 1514051506, "post_id": 47953598, "comment_id": 82878623, "body": "Related to the question... I still don&#39;t get it!"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514051801, "post_id": 47953598, "comment_id": 82878709, "body": "@SergioTulentsev And <a href=\"https://gist.github.com/pochmann/0cee969252f3405a082797f8746be8f4\" rel=\"nofollow noreferrer\"><code>BigDecimal</code> is laughing</a> at <code>to_s</code>."}, {"owner": {"reputation": 431, "user_id": 4330906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzUqv.jpg?s=128&g=1", "display_name": "Frank Kair", "link": "https://stackoverflow.com/users/4330906/frank-kair"}, "edited": false, "score": 0, "creation_date": 1514052077, "post_id": 47953598, "comment_id": 82878783, "body": "Wow! I didn&#39;t know that module. Really performant."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514052360, "post_id": 47953598, "comment_id": 82878854, "body": "Well, presumably <code>BigDecimal</code> stores its data in decimal instead of binary and simply <i>knows</i> the exponent. Base conversion isn&#39;t cheap. That&#39;s also what I suspect is the culprit making <code>digits</code> slow, maybe it uses a different and slower algorithm for base conversion."}], "answers": [{"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1514066481, "post_id": 47955770, "comment_id": 82882169, "body": "<code>max = 10**999</code>"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514072329, "post_id": 47955770, "comment_id": 82883227, "body": "Thomas: Numbers are objects, too, so &quot;do not create objects&quot; isn&#39;t quite right. And I think the string/array creation argument is a red herring, partly because that&#39;s a small part of the work and partly because the numbers do build (internal) arrays as well. But good idea to solve it this way. It&#39;s (unsurprisingly) even faster than my previous winner using <code>BigDecimal</code>, about twice as fast: <a href=\"https://gist.github.com/pochmann/0cee969252f3405a082797f8746be8f4\" rel=\"nofollow noreferrer\">gist.github.com/pochmann/0cee969252f3405a082797f8746be8f4</a>"}], "tags": [], "owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1514283379, "last_edit_date": 1514283379, "creation_date": 1514060824, "answer_id": 47955770, "question_id": 47953598, "link": "https://stackoverflow.com/questions/47953598/rubys-digits-method-performance/47955770#47955770", "title": "Ruby&#39;s digits method performance", "body": "<p>Many ruby methods create objects (strins, arrays, etc.)\nIn ruby, object creation in ruby is \"expensive\".</p>\n\n<p>For instance <code>to_s</code> creates a string and <code>digits</code> creates an array every time the while condition is evaluated.</p>\n\n<p>If you want to optimize your example, you can do the following:</p>\n\n<pre><code># create the smallest possible 1000 digits number\nmax = 10**999\n\nnumber = 3\na = 1\nb = 2\n\n# do not create objects in while condition\nwhile b &lt; max\n  a, b = b, a + b\n  number += 1\nend\nputs number\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514066284, "post_id": 47956172, "comment_id": 82882139, "body": "That documentation sentence describes the result, not the process. Also, I think you&#39;re showing the wrong code. That&#39;s in <code>rb_fix_digits</code>, which as far as I can tell is for Fixnum numbers and thus pretty irrelevant here since Frank&#39;s program does almost nothing with Fixnums."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514066732, "post_id": 47956172, "comment_id": 82882213, "body": "Though I think <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L4810-L4814\" rel=\"nofollow noreferrer\">this</a> is the actually relevant code and it does pretty much the same thing."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1514222230, "post_id": 47956172, "comment_id": 82910677, "body": "You&#39;re right @StefanPochmann. Changed the reference to the right line in <code>numeric.c</code>."}], "tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": false, "score": 1, "last_activity_date": 1514222182, "last_edit_date": 1514222182, "creation_date": 1514064510, "answer_id": 47956172, "question_id": 47953598, "link": "https://stackoverflow.com/questions/47953598/rubys-digits-method-performance/47956172#47956172", "title": "Ruby&#39;s digits method performance", "body": "<p><code>Integer#digits</code> doesn't just \"split\" the number. From the documentation:</p>\n\n<blockquote>\n  <p>Returns the array including the digits extracted by place-value\n  notation with radix base of int.</p>\n</blockquote>\n\n<p>This extraction is done even if a <code>base</code> argument is omitted. The relevant source:</p>\n\n<pre><code># ruby/numeric.c:4809\n\nwhile (!FIXNUM_P(num) || FIX2LONG(num) &gt; 0) {\n    VALUE qr = rb_int_divmod(num, base);\n    rb_ary_push(digits, RARRAY_AREF(qr, 1));\n    num = RARRAY_AREF(qr, 0);\n}\n</code></pre>\n\n<p>As you can see, this process includes repeated modulo arithmetics, which likely accounts for the additional runtime.</p>\n"}, {"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514071632, "post_id": 47956725, "comment_id": 82883117, "body": "@SergioTulentsev It was a bit tedious, but already the joy of seeing &quot;big2str_karatsuba&quot; was worth it :-) (I learned and implemented Karatsuba&#39;s algorithm almost 20 years ago but rarely ever came across it afterwards)."}, {"owner": {"reputation": 431, "user_id": 4330906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzUqv.jpg?s=128&g=1", "display_name": "Frank Kair", "link": "https://stackoverflow.com/users/4330906/frank-kair"}, "edited": false, "score": 0, "creation_date": 1514146608, "post_id": 47956725, "comment_id": 82896925, "body": "Although I&#39;m not a C expert, it was nice trying to read some docs and diving deeper on these algorithms such as Karatsuba and FFT. Thank you @StefanPochmann for this excellent answer!"}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": true, "score": 9, "last_activity_date": 1514079632, "last_edit_date": 1514079632, "creation_date": 1514070038, "answer_id": 47956725, "question_id": 47953598, "link": "https://stackoverflow.com/questions/47953598/rubys-digits-method-performance/47956725#47956725", "title": "Ruby&#39;s digits method performance", "body": "<p>Ruby's <code>digits</code></p>\n\n<ul>\n<li>... is <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L5453\" rel=\"noreferrer\">implemented in <code>rb_int_digits</code></a>.</li>\n<li>Which for non-tiny numbers (i.e., most of your numbers) <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L4848\" rel=\"noreferrer\">uses <code>rb_int_digits_bigbase</code></a>.</li>\n<li>Which extracts digit after digit <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L4810-L4814\" rel=\"noreferrer\">naively with division/modulo by base</a>.</li>\n<li>So it should take <strong>quadratic time</strong> (at least with a small base such as 10).</li>\n</ul>\n\n<p>Ruby's <code>to_s</code></p>\n\n<ul>\n<li>... is <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L5392\" rel=\"noreferrer\">implemented in <code>int_to_s</code></a>.</li>\n<li>Which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L3465\" rel=\"noreferrer\">uses <code>rb_int2str</code></a>.</li>\n<li>Which for non-tiny numbers <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/numeric.c#L3475\" rel=\"noreferrer\">uses <code>rb_big2str</code></a>.</li>\n<li>Which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L5064\" rel=\"noreferrer\">uses <code>rb_big2str1</code></a>.</li>\n<li>Which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L5054\" rel=\"noreferrer\">might use <code>big2str_gmp</code> if available</a> (which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L4982-L5012\" rel=\"noreferrer\">sounds/looks like</a> it uses the fast <a href=\"https://en.wikipedia.org/wiki/GNU_Multiple_Precision_Arithmetic_Library\" rel=\"noreferrer\"><strong>GMP</strong> library</a>) or ...</li>\n<li>... <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L5058\" rel=\"noreferrer\">uses <code>big2str_generic</code></a>.</li>\n<li>Which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L4961\" rel=\"noreferrer\">uses <code>big2str_karatsuba</code></a> (sweet, I recognize that name!).</li>\n<li>Which <a href=\"https://github.com/ruby/ruby/blob/daaebaec79f60796b9c864907ad03d1e02b93fb2/bignum.c#L4738\" rel=\"noreferrer\">looks like</a> it has something to do with ...</li>\n<li>... <a href=\"https://en.wikipedia.org/wiki/Karatsuba_algorithm\" rel=\"noreferrer\"><strong>Karatsuba</strong>'s algorithm</a>, which is a fast multiplication algorithm. If you multiply two n-digit numbers the naive way you learned in school, you take n<sup>2</sup> single-digit products. Karatsuba on the other hand only needs about <strong>n<sup>1.585</sup></strong>, which is quite a lot better. And I didn't read into this further, but I suspect what Ruby does here is also this efficient. <a href=\"https://stackoverflow.com/a/9540587/1672429\">Eric Lippert's answer</a> with a base conversion algorithm uses Karatsuba multiplication and says <em>\"this [base conversion] algorithm is utterly dominated by the cost of the multiplication\"</em>.</li>\n</ul>\n\n<p>Comparing quadratic to n<sup>1.585</sup> over the number lengths from 1 digit to 1000 digits gives factor 15:</p>\n\n<pre><code>(1..1000).sum { |i| i**2 } / (1..1000).sum { |i| i**1.585 }\n=&gt; 15.150583254950678\n</code></pre>\n\n<p>Which is roughly the factor you observed as well. Of course that's a rather naive comparison, but, well, why not.</p>\n\n<p>GMP by the way apparently uses/used a <a href=\"https://stackoverflow.com/questions/9521676/convert-very-huge-number-to-base-10-string/9540587#comment12089322_9540587\">\"near O(n * log(n)) FFT-based multiplication algorithm\"</a>.</p>\n\n<p>Thanks to @Drenmi's <a href=\"https://stackoverflow.com/a/47956172/1672429\">answer</a> for motivating me to dig into the source after all. I hope I did this right, no guarantees, I'm a Ruby beginner. But that's why I left all the links there for you to check for yourself :-P</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1514510703, "last_edit_date": 1514510703, "creation_date": 1514360873, "answer_id": 47988329, "question_id": 47953598, "link": "https://stackoverflow.com/questions/47953598/rubys-digits-method-performance/47988329#47988329", "title": "Ruby&#39;s digits method performance", "body": "<p>I have not answered your question, but wish to suggest an improved algorithm for the problem you have addressed. For a given number of decimal digits, <code>n</code>, I have implemented the following algorithm.</p>\n\n<ul>\n<li>estimate the number <code>f</code> of Fibonacci numbers (\"FNs\") that have <code>n</code> or fewer decimal digits.  </li>\n<li>compute the f<sup>th</sup> and (f-1)<sup>st</sup> FNs, and the number of digits <code>m</code> in the f<sup>th</sup> FN.</li>\n<li>if <code>m &gt;= n</code> back down from  down from the (f-1)<sup>st</sup> FN until the (f-1)<sup>st</sup> FN has fewer than <code>n</code> decimal digits, at which time the f<sup>th</sup> FN is the smallest FN to have <code>n</code> decimal digits.</li>\n<li>if <code>m &lt; n</code> increase the f<sup>th</sup> FN until the it has <code>n</code> decimal digits, at which time it is the smallest FN to have <code>n</code> decimal digits.</li>\n</ul>\n\n<p>The key is to compute a close estimate <code>f</code> in the first step.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>AVG_FNs_PER_DIGIT = 4.784971966781667\n\ndef first_fibonacci_with_n_digits(n)\n  return [1, 1] if n == 1\n  idx = (n * AVG_FNs_PER_DIGIT).round\n  fn, prev_fn = fib(idx)\n  fn.to_s.size &gt;= n ? fib_down(n, fn, prev_fn, idx) : fib_up(n, fn, prev_fn, idx)\nend\n\ndef fib(idx)\n  a = 1\n  b = 2\n  (idx - 2).times {a, b = b, a + b }\n  [b, a] \nend\n\ndef fib_up(n, b, a, idx)\n  loop do\n    a, b = b, a + b\n    idx += 1\n    break [idx, b] if b.to_s.size == n\n  end\nend\n\ndef fib_down(n, b, a, idx)\n  loop do\n    a, b = b - a, a\n    break [idx, b] if a.to_s.size == n - 1\n    idx -= 1\n  end\nend\n</code></pre>\n\n<p><strong>Benchmarks</strong></p>\n\n<p>In computing each Fibonacci number two operations are typically performed:</p>\n\n<ul>\n<li>compute the number of digits in the last-computed Fibonacci number and if that  number is equal to the target number of digits, terminate (for reasons made clear in the <em>Explanation</em> section below, it cannot be larger than the target number); else</li>\n<li>compute the next number in the Fibonacci sequence.</li>\n</ul>\n\n<p>By contrast, the method I have proposed performs the first step a relatively small number of times.</p>\n\n<p>How important is the first step relative to the second and how does the use of  <code>n.digits.size</code> compare with that of <code>n.to_s.size</code> in the first step? Let's run some benchmarks to find out.</p>\n\n<pre><code>def use_to_s(ndigits)\n  case ndigits\n  when 1\n    [1, 1]\n  else\n    a = 1\n    b = 2\n    idx = 3\n    loop do\n      break [idx, b] if b.to_s.length == ndigits\n      a, b = b, a + b\n      idx += 1\n    end\n  end\nend\n\ndef use_digits(ndigits)\n  case ndigits\n  when 1\n    [1, 1]\n  else\n    a = 1\n    b = 2\n    idx = 3\n    loop do\n      break [idx, b] if b.digits.size == ndigits\n      a, b = b, a + b\n      idx += 1\n    end\n  end\nend\n</code></pre>\n\n<p></p>     \n\n<pre><code>require 'fruity'\n\ndef test(ndigits)\n  nfibs, last_fib = use_to_s(ndigits)\n  puts \"\\nndigits = #{ndigits}, nfibs=#{nfibs}, last_fib=#{last_fib}\"\n  compare do\n    try_use_to_s   { use_to_s(ndigits) }\n    try_use_digits { use_digits(ndigits) }\n    try_estimate   { first_fibonacci_with_n_digits(ndigits) }\n  end\nend\n</code></pre>\n\n<p></p> \n\n<pre><code>test 20\nndigits = 20, nfibs=93, last_fib=12200160415121876738\nRunning each test 128 times. Test will take about 1 second.\ntry_estimate is faster than try_use_to_s by 2x \u00b1 0.1\ntry_use_to_s is faster than try_use_digits by 80.0% \u00b1 10.0%\n</code></pre>\n\n<p></p>\n\n<pre><code>test 100\nndigits = 100, nfibs=476, last_fib=13447...37757 (90 digits omitted)\nRunning each test 16 times. Test will take about 4 seconds.\ntry_estimate is faster than try_use_to_s by 5x \u00b1 0.1\ntry_use_to_s is faster than try_use_digits by 10x \u00b1 1.0\n</code></pre>\n\n<p></p>\n\n<pre><code>test 500\nndigits = 500, nfibs=2390, last_fib=13519...63145 (490 digits omitted)\nRunning each test 2 times. Test will take about 27 seconds.\ntry_estimate is faster than try_use_to_s by 9x \u00b1 0.1\ntry_use_to_s is faster than try_use_digits by 60x \u00b1 1.0\n</code></pre>\n\n<p></p>\n\n<pre><code>test 1000\nndigits = 1000, nfibs=4782, last_fib=10700...27816 (990 digits omitted)\nRunning each test once. Test will take about 1 minute.\ntry_estimate is faster than try_use_to_s by 12x \u00b1 10.0\ntry_use_to_s is faster than try_use_digits by 120x \u00b1 100.0\n</code></pre>\n\n<p>There are two main take-aways from these results:</p>\n\n<ul>\n<li>\"try_estimate\" is the fastest because it performs the first step relatively few times; and</li>\n<li>the use of <code>to_s</code> is much faster than that of <code>digits</code>.</li>\n</ul>\n\n<p>Further to the first of these observations note that the initial estimates of  the index of the first FN having a given number of digits, compared to the actual index, are as follows:</p>\n\n<ul>\n<li>for   20 digits:   96 est. vs   93 actual</li>\n<li>for  100 digits:  479 est. vs  476 actual</li>\n<li>for  500 digits: 2392 est. vs 2390 actual</li>\n<li>for 1000 digits: 4785 est. vs 4782 actual</li>\n</ul>\n\n<p>The deviation was at most 3, meaning numbers of digits had to be calculated for at most 3 FNs to obtain the desired result.</p>\n\n<p><strong>Explanation</strong></p>\n\n<p>The only explanation of the methods given in the section <em>Code</em> above is the derivation of the constant <code>AVG_FNs_PER_DIGIT</code>, which is used to calculate an estimate of the index of the first FN having the specified number of digits.</p>\n\n<p>The derivation of this constant derives from the question and selected answer given <a href=\"https://math.stackexchange.com/questions/1834040/relationship-between-decimal-length-and-fibonacci-number\">here</a>. (The <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">Wiki for Fibonacci numbers</a> provides a good overview of the mathematical properties of FNs.)</p>\n\n<p>It is known that the first 7 FNs (including zero) have one digit; thereafter the FNs gain an additional digit every 4 or 5 FNs (i.e., sometimes 4, else 5). Therefore, as a very crude calculation, we see that to calculate the first FN with <code>n</code> digits, <code>n &gt;= 2</code>, it will not be less than the <code>4*n</code>th FN. For <code>n = 1000</code>, that would be 4,000. (In fact, the 4,782nd is the smallest to have 1,000 digits.) In other words, we don't need to calculate the number of digits in the first 4,000 FNs. We can improve on this estimate, however.</p>\n\n<p>As <code>n</code> approaches infinity, the ratio of ranges <code>10**n...10**(n+1)</code> (<code>n</code>-digit intervals) that contain 5 FNs to those that contain 4 FNs can be computed as follows.</p>\n\n<pre><code>LOG_10 = Math.log(10)\n  #=&gt; 2.302585092994046\nGR = (1 + Math.sqrt(5))/2\n  #=&gt; 1.618033988749895\nLOG_GR = Math.log(GR)\n  #=&gt; 0.48121182505960347\n\nRATIO_5to4 = (LOG_10 - 4*LOG_GR)/(5*LOG_GR - LOG_10)\n  #=&gt; 3.6505564183095474\n</code></pre>\n\n<p>where <code>GR</code> is the <a href=\"https://en.wikipedia.org/wiki/Golden_ratio\" rel=\"nofollow noreferrer\">Golden Ratio</a>. </p>\n\n<p>Over a large number of n-digit intervals let n<sub>4</sub> be the number of those intervals containing 4 FNs and n<sub>5</sub> be the number containing 5 FNs. The average number of FNs per interval is therefore (n<sub>4</sub>*4 + n<sub>5</sub>*5)/(n<sub>4</sub> + n<sub>5</sub>). Since n<sub>5</sub>/n<sub>4</sub> converges to <code>RATIO_5to4</code>, n<sub>5</sub> approaches <code>RATIO_5to4</code> * n<sub>4</sub> in the limit (discarding roundoff error). If we substitute out n<sub>5</sub>, and let</p>\n\n<pre><code>b = 1/(1 + RATIO_5to4)\n  #=&gt; 0.21502803321833364\n</code></pre>\n\n<p>we find the average number of FNs per n-digit interval converges to</p>\n\n<pre><code>avg = b * 4 + (1-b) *5\n  #=&gt; 4.784971966781667\n</code></pre>\n\n<p>If <code>fn</code> is the first FN to have <code>n</code> decimal digits, the number of FNs in the sequence up to an including <code>fn</code> can therefore be approximated to be</p>\n\n<pre><code>n * avg\n</code></pre>\n\n<p>If, for example, the estimate of the index of the first FN to have 1000 decimal digits would be <code>1000 * 4.784971966781667).round #=&gt; 4785</code>. </p>\n"}], "owner": {"reputation": 431, "user_id": 4330906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bzUqv.jpg?s=128&g=1", "display_name": "Frank Kair", "link": "https://stackoverflow.com/users/4330906/frank-kair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 47956725, "answer_count": 4, "score": 5, "last_activity_date": 1514510703, "creation_date": 1514042121, "question_id": 47953598, "link": "https://stackoverflow.com/questions/47953598/rubys-digits-method-performance", "title": "Ruby&#39;s digits method performance", "body": "<p>I'm solving some Project Euler problems using Ruby, and specifically here I'm talking about problem 25 (What is the index of the first term in the Fibonacci sequence to contain 1000 digits?).</p>\n\n<p>At first, I was using Ruby <code>2.2.3</code> and I coded the problem as such:</p>\n\n<pre><code>number = 3\na = 1\nb = 2\n\nwhile b.to_s.length &lt; 1000\n  a, b = b, a + b\n  number += 1\nend\nputs number\n</code></pre>\n\n<p>But then I found out that version <code>2.4.2</code> has a method called <code>digits</code> which is exactly what I needed. I transformed to code to:</p>\n\n<pre><code>while b.digits.length &lt; 1000\n</code></pre>\n\n<p>And when I compared the two methods, <code>digits</code> was much slower.</p>\n\n<p><strong>Time</strong></p>\n\n<p><code>./025/problem025.rb  0.13s user 0.02s system 80% cpu 0.190 total</code></p>\n\n<p><code>./025/problem025.rb  2.19s user 0.03s system 97% cpu 2.275 total</code></p>\n\n<p>Does anyone have an idea why? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1514052489, "post_id": 47953304, "comment_id": 82878899, "body": "Don&#39;t change the code like that. It&#39;s now a completely different piece of code, with a completely different error."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514052585, "post_id": 47953304, "comment_id": 82878936, "body": "I took the liberty of rolling back your code changes, because they were disagreeing with the text."}, {"owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514052647, "post_id": 47953304, "comment_id": 82878961, "body": "No the error remained the same, when i pass the pin i get the pin error, that&#39;s what i am saying"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1514052720, "post_id": 47953304, "comment_id": 82878989, "body": "No, you get a completely different pin error. (&quot;can&#39;t call private method <code>pin</code>&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052033, "post_id": 47953342, "comment_id": 82878773, "body": "It is initializes, you have to scroll down a bit at the private pin method"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052269, "post_id": 47953342, "comment_id": 82878826, "body": "@ChristopherBovo: IF you call that method, sure. But you don&#39;t call it (in  your example)"}, {"owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052503, "post_id": 47953342, "comment_id": 82878906, "body": "I replaced the code with the code given by the codeacademy one, and i call the method and it still doesn&#39;t work, also you can&#39;t call the method since it&#39;s private, if anyone can find the error please point me to it"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052641, "post_id": 47953342, "comment_id": 82878959, "body": "@ChristopherBovo: Tom posted working code, compare it with yours and find the difference.  Also see the note at the end of my answer."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1514052920, "last_edit_date": 1514052920, "creation_date": 1514039771, "answer_id": 47953342, "question_id": 47953304, "link": "https://stackoverflow.com/questions/47953304/passing-argument-in-instance-variable-in-ruby-gets-error/47953342#47953342", "title": "Passing argument in instance variable in Ruby gets error", "body": "<blockquote>\n  <p>yet it doesn't work, even though it should, why is that?</p>\n</blockquote>\n\n<p>Because your <code>@pin</code> is never initialized. Something must be different between your code and what they have at codecademy (they likely initialize <code>@pin</code> in the initializer, which you do not).</p>\n\n<blockquote>\n  <p>but when i remove the @ in the pin checks and treat it as a normal variable</p>\n</blockquote>\n\n<p><strong>Wrong.</strong>. This is not a variable. When you make it <code>pin</code> instead of <code>@pin</code>, it starts pointing to that private method of yours. Which returns a pin number. That's why it works.</p>\n\n<hr>\n\n<p>Note that your code will work as-is, if you simply <code>display_balance</code> before making a deposit. This is called \"call order dependency\" and it's bad.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052042, "post_id": 47953345, "comment_id": 82878774, "body": "It is initializes, you have to scroll down a bit at the private pin method"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052180, "post_id": 47953345, "comment_id": 82878801, "body": "No. Defining a method does not initialize the variable. That is precisely the mistake you made, which I have corrected."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514052232, "post_id": 47953345, "comment_id": 82878819, "body": "If you <b>call</b> the method, in the initializer or otherwise, then the variable will be initialized. But you did not call the method anywhere."}, {"owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "edited": false, "score": 0, "creation_date": 1514053016, "post_id": 47953345, "comment_id": 82879066, "body": "By initializing the pin it works, but no such thing was done from the site, so there is a mistake in their code, i submitted a report about it. Thanks"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1514039793, "creation_date": 1514039793, "answer_id": 47953345, "question_id": 47953304, "link": "https://stackoverflow.com/questions/47953304/passing-argument-in-instance-variable-in-ruby-gets-error/47953345#47953345", "title": "Passing argument in instance variable in Ruby gets error", "body": "<p><code>pin_number==@pin</code> will return <code>false</code>, because you never set <code>@pin</code> - so it will still be <code>nil</code>.</p>\n\n<p>Instead of using a private method, you could do something like this:</p>\n\n<pre><code>def initialize(name, pin, balance=100)\n  @name = name\n  @pin = pin\n  @balance = balance\nend\n\n# ...\n\nchecking_account=Account.new(\"bob\", 1, 200)\nchecking_account.deposit(1, 20)\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5919691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10206801827737400/picture?type=large", "display_name": "Christopher Bovo", "link": "https://stackoverflow.com/users/5919691/christopher-bovo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 47953345, "answer_count": 2, "score": -1, "last_activity_date": 1514052920, "creation_date": 1514039432, "last_edit_date": 1514052558, "question_id": 47953304, "link": "https://stackoverflow.com/questions/47953304/passing-argument-in-instance-variable-in-ruby-gets-error", "title": "Passing argument in instance variable in Ruby gets error", "body": "<pre><code>class Account\n attr_reader :name\n attr_reader :balance\n def initialize(name, balance=100)\n   @name = name\n   @balance = balance\n end\n\n public\n def display_balance(pin_number)\n  if pin_number == pin\n   puts \"Balance: $#{@balance}.\"\n  else\n   puts pin_error\n  end\n end\n\n def withdraw(pin_number,amount)\n   if pin_number == @pin\n     @balance -= amount\n     puts \"Withdrew #{amount}.\"\n   else\n     puts pin_error\n   end\n end\n def deposit(pin_number,amount)\n   if pin_number ==@pin\n     @balance+=amount\n     puts\"Deposited\"\n  else\n     puts pin_error\n  end\n end\n\n private\n def pin\n   @pin = 1\n end\n def pin_error\n   return \"Access denied: incorrect PIN.\"\n end \n end\n\nchecking_account=Account.new(\"bob\",200)\nchecking_account.deposit(1,20)\n</code></pre>\n\n<p>When i try deposit i get an error on pin, but when i remove the @ in the pin checks and treat it as a normal variable it works. In codeacademy it shows that the correct way to check the pin is with </p>\n\n<pre><code>  if pin_number==@pin \n</code></pre>\n\n<p>yet it doesn't work, even though it should, why is that?</p>\n"}, {"tags": ["ruby", "ubuntu", "posix", "subshell"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1514058187, "post_id": 47952155, "comment_id": 82880338, "body": "Probably relevant <a href=\"https://stackoverflow.com/questions/6338908/ruby-difference-between-exec-system-and-x-or-backticks\" title=\"ruby difference between exec system and x or backticks\">stackoverflow.com/questions/6338908/&hellip;</a>"}, {"owner": {"reputation": 4235, "user_id": 210029, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5603b531354ca5e45c7adebaf6a7bdd3?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/210029/marcus"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1514149519, "post_id": 47952155, "comment_id": 82897444, "body": "That question doesn&#39;t unfortunately mention the difference, blocking-wise, between the two (it&#39;s only stated that both are blocking)."}], "owner": {"reputation": 4235, "user_id": 210029, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5603b531354ca5e45c7adebaf6a7bdd3?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/210029/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514029053, "creation_date": 1514029053, "question_id": 47952155, "link": "https://stackoverflow.com/questions/47952155/why-in-ruby-backticks-and-system-have-different-blocking-behavior-when-cal", "title": "Why, in Ruby, backticks and `system()` have different blocking behavior when calling `xdg-open`?", "body": "<p>Based on the Ruby documentation, both backticks and <code>system()</code> have the same blocking behavior (that is, they are both blocking calls).</p>\n\n<p>When I use them to execute a call to <code>xdg-open</code> though (which in itself, forks the system process, for example <code>libreoffice</code> and exits), backticks blocks while the system process is executing, while <code>system()</code> blocks only during the system process invocation.</p>\n\n<p>This is a trivial example:</p>\n\n<pre><code>`xdg-open myspreadsheet.ods`        # will block until exiting libreoffice\nsystem 'xdg-open myspreadsheet.ods' # will block until libreoffice is invoked\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044147, "post_id": 47951391, "comment_id": 82876882, "body": "<code>Started POST &quot;&#47;articles&quot; for 127.0.0.1 at 2017-12-23 20:45:56 +0500 Processing by ArticlesController#create as JS   Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;KS6SEc7r+swxe1SKPs2d5gBnmCOKN3z6ewJJB&zwnj;&#8203;GInf0MP&#47;BHs1dyXMOnsF&zwnj;&#8203;Zxcd8ouDVbWJCKIbf8kv&zwnj;&#8203;Jm9EGqQ&#47;A==&quot;, &quot;article&quot;=&gt;{&quot;title&quot;=&gt;&quot;bappa&quot;, &quot;text&quot;=&gt;&quot;peeroun ko main manta hun&quot;}, &quot;commit&quot;=&gt;&quot;Create Article&quot;}   User Load (0.4ms)  SELECT  &quot;users&quot;.* FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; = ? ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT ?  [[&quot;id&quot;, 13], [&quot;LIMIT&quot;, 1]]    (0.1ms)  begin transaction    (0.1ms)  rollback transaction </code>"}, {"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044209, "post_id": 47951391, "comment_id": 82876898, "body": "<code>Rendering articles&#47;new.html.erb within layouts&#47;application   Rendered articles&#47;_form.html.erb (1.9ms)   Rendered articles&#47;new.html.erb within layouts&#47;application (4.6ms) Completed 200 OK in 37ms (Views: 30.5ms | ActiveRecord: 0.6ms)</code> I get this logged into my console. Plus no article is created and I don&#39;t get redirected."}, {"owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "reply_to_user": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044293, "post_id": 47951391, "comment_id": 82876925, "body": "@MuhammadTaha Are you setting other attributes of <code>@article</code>?"}], "tags": [], "owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "is_accepted": true, "score": 0, "last_activity_date": 1514044644, "last_edit_date": 1514044644, "creation_date": 1514022110, "answer_id": 47951391, "question_id": 47951326, "link": "https://stackoverflow.com/questions/47951326/nomethoderror-undefined-method-user-id-for-nilnilclass-in-the-article-con/47951391#47951391", "title": "NoMethodError (undefined method `user_id=&#39; for nil:NilClass): in the article controller", "body": "<p>Apparently you <code>@article</code> is nil. It is throwing you error about calling/accessing <code>user_id</code> of <code>nil</code> object.</p>\n\n<p>You need to make sure you define <code>@article</code> first, something like this</p>\n\n<pre><code>def create\n  @article = Article.new(article_params)\n  @article.user_id = current_user.id\n\n  if @article.save\n    redirect_to @article\n  else\n    render 'new'\n  end      \nend\n\nprivate\ndef article_params\n  params.require(:article).permit(:title, :text)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514026203, "post_id": 47951398, "comment_id": 82873085, "body": "<code>&#47;home&#47;taha&#47;blog&#47;app&#47;controllers&#47;articles_controller.rb:39: syntax error, unexpected tIDENTIFIER, expecting keyword_then or &#39;;&#39; or &#39;\\n&#39; if @article erorrs.any? ^ &#47;home&#47;taha&#47;blog&#47;app&#47;controllers&#47;articles_controller.rb:66: syntax error, unexpected keyword_end, expecting end-of-input</code>"}, {"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "reply_to_user": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514030248, "post_id": 47951398, "comment_id": 82873956, "body": "Typo. I forgot a dot at &#39;@article.errors.any?&#39;. Answer updated"}, {"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044371, "post_id": 47951398, "comment_id": 82876938, "body": "<code>Started POST &quot;&#47;articles&quot; for 127.0.0.1 at 2017-12-23 20:51:20 +0500 Processing by ArticlesController#create as JS   Parameters: {&quot;utf8&quot;=&gt;&quot;\u2713&quot;, &quot;authenticity_token&quot;=&gt;&quot;KS6SEc7r+swxe1SKPs2d5gBnmCOKN3z6ewJJB&zwnj;&#8203;GInf0MP&#47;BHs1dyXMOnsF&zwnj;&#8203;Zxcd8ouDVbWJCKIbf8kv&zwnj;&#8203;Jm9EGqQ&#47;A==&quot;, &quot;article&quot;=&gt;{&quot;title&quot;=&gt;&quot;bappa&quot;, &quot;text&quot;=&gt;&quot;peeroun ko main manta hun&quot;}, &quot;commit&quot;=&gt;&quot;Create Article&quot;}   User Load (0.4ms)  SELECT  &quot;users&quot;.* FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; = ? ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT ?  [[&quot;id&quot;, 13], [&quot;LIMIT&quot;, 1]]    (0.0ms)  begin transaction    (0.2ms)  rollback transaction </code>"}, {"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044401, "post_id": 47951398, "comment_id": 82876948, "body": "<code>No template found for ArticlesController#create, rendering head :no_content Completed 204 No Content in 82ms (ActiveRecord: 2.8ms) </code> This is what I get now."}, {"owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "edited": false, "score": 0, "creation_date": 1514044415, "post_id": 47951398, "comment_id": 82876951, "body": "No redirection. No article creation."}], "tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 0, "last_activity_date": 1514040763, "last_edit_date": 1514040763, "creation_date": 1514022184, "answer_id": 47951398, "question_id": 47951326, "link": "https://stackoverflow.com/questions/47951326/nomethoderror-undefined-method-user-id-for-nilnilclass-in-the-article-con/47951398#47951398", "title": "NoMethodError (undefined method `user_id=&#39; for nil:NilClass): in the article controller", "body": "<p>You have to create an instance of <code>Article</code> first. Then assign <code>user_id</code> and <code>save</code> the record.</p>\n\n<pre><code>def create\n  @article = Article.new\n  @article.user_id = current_user.id\n\n  @article.save\n  if @article.errors.any?\n    # error handling\n  else\n    render 'new'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9133480, "user_type": "registered", "profile_image": "https://graph.facebook.com/1690680324329869/picture?type=large", "display_name": "Muhammad Taha", "link": "https://stackoverflow.com/users/9133480/muhammad-taha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 47951391, "answer_count": 2, "score": 0, "last_activity_date": 1514044644, "creation_date": 1514021561, "question_id": 47951326, "link": "https://stackoverflow.com/questions/47951326/nomethoderror-undefined-method-user-id-for-nilnilclass-in-the-article-con", "title": "NoMethodError (undefined method `user_id=&#39; for nil:NilClass): in the article controller", "body": "<p>I am trying to implement the functionality of creating a new article. However when I click the Submit button it gives me the following error.</p>\n\n<pre><code>Started POST \"/articles\" for 127.0.0.1 at 2017-12-23 14:04:29 +0500\nProcessing by ArticlesController#create as JS\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"lbrD/8QZAlLuxVbw3vmRuKI20zkrckYut4nebyW5hLk6EFkODh4d0IAZ6yms2oRkWGqE3eWlUQwBUrfu1SiAnw==\", \"article\"=&gt;{\"title\"=&gt;\"AYYE\", \"text\"=&gt;\"Ma ka \"}, \"commit\"=&gt;\"Create Article\"}\n  User Load (0.6ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"id\", 13], [\"LIMIT\", 1]]\nCompleted 500 Internal Server Error in 6ms (ActiveRecord: 0.6ms)\n\n\n\nNoMethodError (undefined method `user_id=' for nil:NilClass):\n\napp/controllers/articles_controller.rb:26:in `create'\n</code></pre>\n\n<p>Here's the <code>create</code> method:</p>\n\n<pre><code>def create\n    @article.user_id = current_user.id\n      if @article.create\n         redirect_to @article\n      else\n        render 'new'\n      end\n    end\n</code></pre>\n\n<p>I am just starting out with RoR, hence unable to understand what's the problem here.</p>\n"}, {"tags": ["jquery", "ruby", "click", "ruby-on-rails-2"], "comments": [{"owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "edited": false, "score": 0, "creation_date": 1514017334, "post_id": 47950625, "comment_id": 82871368, "body": "Have you tried removing <code>e.preventDefault();</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3272, "user_id": 2389628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4nuI.jpg?s=128&g=1", "display_name": "smallbutton", "link": "https://stackoverflow.com/users/2389628/smallbutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1514051408, "creation_date": 1514051408, "answer_id": 47954670, "question_id": 47950625, "link": "https://stackoverflow.com/questions/47950625/rails-form-field-validation-and-click-handler/47954670#47954670", "title": "Rails form field validation and click handler", "body": "<p>When you call <code>e.preventDefault()</code> you prevent the default event handling of the browser for the validation and submit.\nIn your example you only call the form submit explicitly but not the validation.</p>\n\n<p>You can either let the browser handle this, by not calling <code>e.preventDefault</code> and <code>submit</code> explicitly or just call the validation programmatically with </p>\n\n<pre><code>$(\"form\")[0].checkValidity();\n</code></pre>\n\n<p>(<a href=\"https://stackoverflow.com/questions/7386817/html5-form-checkvalidity-method-not-found\">source</a>).</p>\n\n<p>Note that you need to call <code>checkValidity()</code> on the browser element and not on the jQuery element.</p>\n\n<p>Depending on what you want to achieve with your code it might also be handy to use the submit API of the form like in <a href=\"https://stackoverflow.com/questions/7002230/trigger-standard-html5-validation-form-without-using-submit-button\">this</a> example, so you do not only link this to the submit button, but call it on form submit.</p>\n"}], "owner": {"reputation": 506, "user_id": 2865795, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6ac71f9f3c18cf6a60ae02f7402953cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bhavya", "link": "https://stackoverflow.com/users/2865795/bhavya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514051408, "creation_date": 1514013638, "question_id": 47950625, "link": "https://stackoverflow.com/questions/47950625/rails-form-field-validation-and-click-handler", "title": "Rails form field validation and click handler", "body": "<p>I have a form_tag  with some mandatory fields as below</p>\n\n<pre><code>&lt;% form_tag url do %&gt;\n  &lt;%= text_field_tag \"user[name]\", user[:name], :required =&gt; true %&gt;\n   &lt;%= submit_tag 'Continue', :class =&gt; 'submit_button' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When i submit the form with just this, it works fine by throwing errors saying that the field is mandatory. But when i bind the submit button with a click event, the <em>required=> true</em> doesnot work anymore. Eg.</p>\n\n<pre><code>$(\".submit_button\").bind(\"click\",function(e){\n   e.preventDefault();\n   //Have some code here, I dont want to put field validations here\n   $(\"form\").submit();\n});\n</code></pre>\n\n<p>I dont want to put js validations for each and every field, so how can i make the default rails required attibute to work. Please suggest if am missing anything here</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514009363, "post_id": 47950202, "comment_id": 82869991, "body": "The query looks fine.  What is the width of the <code>address_line_two</code> column?  Are you sure that this is the actual query which caused the error?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514009620, "post_id": 47950202, "comment_id": 82870042, "body": "@TimBiegeleisen Yes, positive. Between the - and I in the user input data, there is a zero width space that is giving MySQL the error that I posted in the question. It looks to me like a decoding problem but I am not quite sure how to fix the issue."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514011206, "post_id": 47950202, "comment_id": 82870317, "body": "What is the encoding of the table?  Could you make it UTF-8?  As an alternative, can you scrub away those unicode characters?"}], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1514050863, "post_id": 47950712, "comment_id": 82878448, "body": "Will this change the encoding of previously saved text or just new records?"}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1514050873, "post_id": 47950712, "comment_id": 82878453, "body": "This is a production site with a ton of data."}], "tags": [], "owner": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "is_accepted": false, "score": 0, "last_activity_date": 1514014562, "creation_date": 1514014562, "answer_id": 47950712, "question_id": 47950202, "link": "https://stackoverflow.com/questions/47950202/ruby-on-rails-mysql-incorrect-string-value/47950712#47950712", "title": "Ruby on Rails - MySQL Incorrect String Value", "body": "<p>It seems your mysql does not support full Unicode. Should work if you update your encoding settings for the table like below. </p>\n\n<pre><code>ALTER TABLE cart_addresses CONVERT TO CHARACTER SET utf8\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514014562, "creation_date": 1514009186, "question_id": 47950202, "link": "https://stackoverflow.com/questions/47950202/ruby-on-rails-mysql-incorrect-string-value", "title": "Ruby on Rails - MySQL Incorrect String Value", "body": "<p>I'm using MariaDB with Ruby on Rails 5. I got an error for the first time today indicating a invalid character. You can't see it, but there is a zero width space between the \"-\" and \"I\" in the error below. I was able to replicate the issue by submitting my form with the same text. I'm not sure how to fix this. Any help would be appreciated. Thanks in advance! </p>\n\n<pre><code>ActiveRecord::StatementInvalid (Mysql2::Error: Incorrect string value: \n'\\xE2\\x80\\x8BDEI...' for column 'address_line_two' at row 1: UPDATE \n`cart_addresses` SET `address_line_two` = 'D/6: JES - \u200bIEARO\u200b'\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1514006920, "post_id": 47950006, "comment_id": 82869638, "body": "Convert each string input to a number. e.g. <code>first_number.to_i</code>, then do the comparison. And btw use <code>puts</code> instead of <code>print</code> and two-spaces for indentation."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1514007019, "post_id": 47950006, "comment_id": 82869648, "body": "<i>it doesn&#39;t work</i> isn&#39;t a useful problem description. How specifically does it <i>not work</i>?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1514022480, "post_id": 47950006, "comment_id": 82872296, "body": "&quot;it doesn&#39;t work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"tags": [], "owner": {"reputation": 2599, "user_id": 2730399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/55f1223c407a8d06c677fec00c1ed32e?s=128&d=identicon&r=PG", "display_name": "Azsgy", "link": "https://stackoverflow.com/users/2730399/azsgy"}, "is_accepted": false, "score": 1, "last_activity_date": 1514007780, "creation_date": 1514007780, "answer_id": 47950077, "question_id": 47950006, "link": "https://stackoverflow.com/questions/47950006/greater-than-program/47950077#47950077", "title": "Greater Than program", "body": "<p>Since the result of <code>gets.comp</code> is a string, <code>&gt;</code> and <code>&lt;</code> alphabetically compare the inputs like in a dictionary. The following is a list of strings alphabetically sorted:</p>\n\n<pre><code>\"1\"\n\"10\"\n\"1300930184\"\n\"2\"\n\"2139182\"\n\"23\"\n\"3\"\n\"aardvark\"\n\"ab\"\n\"avalanche\"\n\"caramel\"\n</code></pre>\n\n<p>What you want instead is to convert the strings to a whole number (Integer) and then compare those. This can be done e.g. by wrapping the call to chomp like this: <code>first_number = Integer(gets.chomp)</code></p>\n"}, {"comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1514104379, "post_id": 47950217, "comment_id": 82887526, "body": "I realize that the value returned by &lt;=&gt; is not likely to change in future Ruby versions, but I&#39;m still a little paranoid relying on fixed values (i.e. the number 1) here. I&#39;d be more comfortable with a <code>&gt; 0</code> and <code>&lt; 0</code> test. I suppose if we did that then an <code>if</code> clause would make more sense than a <code>case</code> clause."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1514156490, "post_id": 47950217, "comment_id": 82898780, "body": "<code>&lt;=&gt;</code> (defined for various classes) is a widely-used method; you should not hesitate to use it (i.e., get over your reluctance to do so). The class <a href=\"http://ruby-doc.org/core-2.4.0/Integer.html\" rel=\"nofollow noreferrer\">Integer</a> defines  <code>&lt;</code> and <code>&gt;</code>, but for other classes (e.g., custom classes) one defines  <code>&lt;=&gt;</code> for the class and <code>include</code>s the module <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html\" rel=\"nofollow noreferrer\">Comparable</a>. The first paragraph of its doc explains how it that module works. <code>&lt;=&gt;</code> is also commonly used with <a href=\"http://ruby-doc.org/core-2.4.0/Enumerable.html#method-i-sort\" rel=\"nofollow noreferrer\">Enumerable#sort</a> and other methods."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1514175516, "post_id": 47950217, "comment_id": 82901039, "body": "It&#39;s not the &lt;=&gt; operator I tend to avoid, it&#39;s assuming that the value will always be -1, 0, or 1. I prefer tests of &lt; 0, == 0, or &gt; 0. It may be habit from older languages (Java, C++, C, I don&#39;t remember), who had comparison implementations that relied on the subtraction of values for which normalizing to -1 and 1 was unnecessary and time consuming. But I guess if the language states that it is, and always will be -1, 0, or 1, then I shouldn&#39;t hesitate to rely on that. (Does it?)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1514189806, "post_id": 47950217, "comment_id": 82903260, "body": "Yes, the method always returns <code>-1</code>, <code>0</code> or <code>1</code>, nothing else, and if that were ever changed the streets would be filled with Rubiests bearing torches and pitchforks."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 1, "creation_date": 1514232607, "post_id": 47950217, "comment_id": 82912962, "body": "@CarySwoveland Isn&#39;t it spelled Rub<i>yists</i>? Or maybe in that scenario they&#39;d turn into Ru<i>beasts</i> :-)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1514135839, "last_edit_date": 1514135839, "creation_date": 1514009330, "answer_id": 47950217, "question_id": 47950006, "link": "https://stackoverflow.com/questions/47950006/greater-than-program/47950217#47950217", "title": "Greater Than program", "body": "<p>Try this.</p>\n\n<pre><code>print \"Please give me your first number.\"\nfirst_number = gets.to_i \n\nprint \"Please give me your second number.\"\nsecond_number = gets.to_i \n\nputs case first_number &lt;=&gt; second_number\n     when -1\n       \"Your second number is greater.\"\n     when 0\n       \"These two are equal.\"\n     when 1\n       \"Your first number is greater.\"\n     end\n</code></pre>\n\n<p>As others have mentioned, <code>gets</code> returns a string, so for comparisons you must convert the string to an integer. Also, see <a href=\"http://ruby-doc.org/core-2.4.0/Integer.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Integer#&lt;=></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 0, "last_activity_date": 1514104810, "creation_date": 1514104810, "answer_id": 47959234, "question_id": 47950006, "link": "https://stackoverflow.com/questions/47950006/greater-than-program/47959234#47959234", "title": "Greater Than program", "body": "<p>After parsing the inputs (as explained above in other answers) I'd suggest this reporting approach, which more precisely addresses the question, and avoids the need for explicit comparisons:</p>\n\n<pre><code>if first_number == second_number\n  puts \"The numbers are equal.\"\nelse\n  higher_number = [first_number, second_number].max\n  puts \"#{higher_number} is the higher number.\"\nend\n</code></pre>\n\n<p>(Though I admit that getting the max of an array may be a reach for someone on the level of this question.)</p>\n"}], "owner": {"reputation": 1, "user_id": 9133083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4e57e7c56ba78aeb6fc605053b662?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/9133083/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 47950217, "answer_count": 3, "score": -4, "last_activity_date": 1514135839, "creation_date": 1514006735, "last_edit_date": 1514006816, "question_id": 47950006, "link": "https://stackoverflow.com/questions/47950006/greater-than-program", "title": "Greater Than program", "body": "<p>I'm trying to write a program that when given two numbers will tell you witch is greater or if they are equal. When I run the code bellow it doesn't work with any numbers above ten </p>\n\n<pre><code>print \"Please give me your first number.\"\nfirst_number = gets.chomp \n\n\nprint \"Please give me your second number.\"\nsecond_number = gets.chomp \n\nif first_number == second_number\n    print \"These two are equal.\"\nelsif first_number &gt; second_number\n    print \"Your first number is greater.\" \nelsif first_number &lt; second_number\n    print \"Your second number is greater.\"\nend \n</code></pre>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 722, "user_id": 3643211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kEAbU.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3643211/daniel"}, "edited": false, "score": 0, "creation_date": 1513996615, "post_id": 47949102, "comment_id": 82868431, "body": "I guess some javascript code render the stars multiple times."}, {"owner": {"reputation": 1848, "user_id": 4089357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dc1c999e767d7aff0e988631a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/4089357/abdullah"}, "edited": false, "score": 1, "creation_date": 1513996687, "post_id": 47949102, "comment_id": 82868439, "body": "Your code is being executed multiple times, try putting <code>alert(&#39;hello&#39;)</code> in the script to verify."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8443614, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5Zxxs.png?s=128&g=1", "display_name": "dxo", "link": "https://stackoverflow.com/users/8443614/dxo"}, "edited": false, "score": 0, "creation_date": 1514005474, "post_id": 47949790, "comment_id": 82869431, "body": "Thank you so much. I turned off Turbolinks and it went well.\u3000Thank you for answering."}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 1, "last_activity_date": 1514003806, "creation_date": 1514003806, "answer_id": 47949790, "question_id": 47949102, "link": "https://stackoverflow.com/questions/47949102/problems-with-js-and-rails/47949790#47949790", "title": "Problems with JS and Rails", "body": "<p>You're describing an issue common with Turbolinks. Remove Turbolinks from your application.js (or application.coffee) and try it again. Once you're stable, add Turbolinks and read the Turbolinks docs to ensure you don't run into this in prod. :) </p>\n"}], "owner": {"reputation": 31, "user_id": 8443614, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5Zxxs.png?s=128&g=1", "display_name": "dxo", "link": "https://stackoverflow.com/users/8443614/dxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 47949790, "answer_count": 1, "score": -2, "last_activity_date": 1526384774, "creation_date": 1513993700, "last_edit_date": 1526384774, "question_id": 47949102, "link": "https://stackoverflow.com/questions/47949102/problems-with-js-and-rails", "title": "Problems with JS and Rails", "body": "<p>Currently, as a review, we are making a mechanism to evaluate with five star marks, but there are problems that the number of stars increases before the page and five stars.\n<a href=\"https://i.stack.imgur.com/UKI3Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UKI3Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, the number of stars increases steadily as you go through the pages.\nI'd like to solve this problem, but I do not know how to solve it.</p>\n\n<p>view</p>\n\n<pre><code>&lt;div class=\"listing-rate\" id=\"average_star_rate\"&gt;&lt;/div&gt;\n\n&lt;script&gt;\n  $('#average_star_rate').raty({\n    path: '/assets',\n    readOnly: true,\n    score: &lt;%= @listing.average_star_rate %&gt;\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>How can I solve it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1513985715, "post_id": 47948407, "comment_id": 82867010, "body": "Can you show us the <code>initialize</code> method in both cases? Are you using <code>||=</code> in an initialize method?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1513986998, "post_id": 47948407, "comment_id": 82867222, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You&#39;ve given a great explanation of the behaviour, but an incomplete code sample of how you generated it - therefore I don&#39;t know how to <b>reproduce</b> your problem."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1513987198, "post_id": 47948407, "comment_id": 82867260, "body": "At a guess though, is the problem not that you are calling <code>switched?</code> <b>twice</b>, and the variable will be memoized if and only if it&#39;s <code>true</code>? If you randomly choose <code>false</code>, then the <code>||=</code> gets re-evaluated; therefore <code>true</code> will be chosen 75% of the time."}, {"owner": {"reputation": 1091, "user_id": 1893290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd02a775db447cf44762ecb35687b9e1?s=128&d=identicon&r=PG", "display_name": "Jacob Evan Shreve", "link": "https://stackoverflow.com/users/1893290/jacob-evan-shreve"}, "edited": false, "score": 0, "creation_date": 1513987389, "post_id": 47948407, "comment_id": 82867281, "body": "Tom, you nailed it. I was thinking the conditional assignment operator only re-assigns on nil, but you&#39;re right it&#39;s on false as well. 50% the first pass, and 50% the next means about 75% will be switched."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 5, "last_activity_date": 1513988140, "last_edit_date": 1513988140, "creation_date": 1513987674, "answer_id": 47948666, "question_id": 47948407, "link": "https://stackoverflow.com/questions/47948407/ruby-random-number-generator-is-skewed-when-called-from-initializer/47948666#47948666", "title": "Ruby random number generator is skewed when called from initializer", "body": "<p>In ruby, all values other than <code>nil</code> and <code>false</code> are considered \"truthy\".</p>\n\n<p>When you call <code>foo ||= bar</code>, <code>bar</code> will be evaluated if and only if <code>foo</code> is \"falsey\" - i.e. equal to <code>nil</code> <strong>or <code>false</code></strong>. (Or if it's undefined!)</p>\n\n<p>In your code, you have the following:</p>\n\n<pre><code>def switched?\n  @sw ||= [true, false].sample\nend\n</code></pre>\n\n<p>So, the <code>@sw</code> variable will memoize the result of the method call <strong>only if <code>[true, false].sample</code> returns <code>true</code></strong>!!</p>\n\n<p>What this means, then, is that if you call <code>switched?</code> multiple times, you are giving the <code>@sw</code> variable \"multiple attempts\" to randomly choose <code>true</code>.</p>\n\n<p>If you call <code>switched?</code> once, there's a 50% chance of it being <code>true</code>. Call it twice, and there's a 75% chance (as you observed). Call it 3 times, and there's a 87.5% chance. And so on.</p>\n\n<p>In order to memoize a potentially <code>false</code> value, you need to be a little more explicit with the syntax - e.g.</p>\n\n<pre><code>def switched?\n  return @sw if defined?(@sw)\n  @sw = [true, false].sample \nend\n</code></pre>\n\n<p>You can now call <code>switched?</code> multiple times, safely. It will remember its first result, even if <code>false</code>, and not re-calculate it.</p>\n"}], "owner": {"reputation": 1091, "user_id": 1893290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd02a775db447cf44762ecb35687b9e1?s=128&d=identicon&r=PG", "display_name": "Jacob Evan Shreve", "link": "https://stackoverflow.com/users/1893290/jacob-evan-shreve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 47948666, "answer_count": 1, "score": 3, "last_activity_date": 1513988140, "creation_date": 1513984927, "last_edit_date": 1513987204, "question_id": 47948407, "link": "https://stackoverflow.com/questions/47948407/ruby-random-number-generator-is-skewed-when-called-from-initializer", "title": "Ruby random number generator is skewed when called from initializer", "body": "<p>I'm trying to model the Monty Hall problem where a user is asked to select one of three doors, then is offered to switch the door. I'm looking for a random variation of choices, which should be in the range of 50% switched vs. 50% stayed.</p>\n\n<pre><code>class Scenario\n  def initialize\n    # switched?\n  end\n\n  def switched?\n    @sw ||= [true, false].sample\n  end\nend\n\nresults = { switched: [], stayed: [] }\n\n1000.times do\n  s = Scenario.new\n\n  if s.switched?\n    results[:switched].push(s)\n  else\n    results[:stayed].push(s)\n  end\nend\n\nputs results[:switched].count\nputs results[:stayed].count\n</code></pre>\n\n<p>When I inspect the results hash, in this example, the array counts tend to be about 500/500 as expected.</p>\n\n<p>However, if I uncomment <code>switched?</code> in the initializer method, the results tend to be split about 750/250. The results are still random-looking (e.g. 738 to 262), but they are always skewed to be an incorrect solution to this problem.</p>\n\n<p>I have also tried using other mechanisms like <code>rand(2).zero?</code> to generate the data, but the same problem occurs.</p>\n\n<p>Why or how could calling this memoized function in the initializer cause the random variation to be so far, yet consistently off?</p>\n"}]