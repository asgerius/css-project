[{"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1540431340, "post_id": 52979386, "comment_id": 92866555, "body": "When you say &#39;did not work&#39;, can you explain? do you have a stack trace to share?"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1540448583, "post_id": 52979386, "comment_id": 92871022, "body": "There is not currently a supported library for making Chef HTTP calls."}, {"owner": {"reputation": 77, "user_id": 1576738, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8cd9d4c455e18d726645dd02df207a08?s=128&d=identicon&r=PG&f=1", "display_name": "user1576738", "link": "https://stackoverflow.com/users/1576738/user1576738"}, "edited": false, "score": 0, "creation_date": 1540459112, "post_id": 52979386, "comment_id": 92876816, "body": "ERROR: Exception Class: ArgumentError Unhandled exception: wrong number of arguments (given 4, expected 0..2) (from ArgumentError) Backtrace: \t/Users/mauro/.rvm/gems/ruby-2.3.5/gems/chef-12.22.5/lib/che&zwnj;&#8203;f/server_api.rb:32:i&zwnj;&#8203;n `initialize&#39;"}, {"owner": {"reputation": 77, "user_id": 1576738, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8cd9d4c455e18d726645dd02df207a08?s=128&d=identicon&r=PG&f=1", "display_name": "user1576738", "link": "https://stackoverflow.com/users/1576738/user1576738"}, "edited": false, "score": 0, "creation_date": 1540462561, "post_id": 52979386, "comment_id": 92879029, "body": "coderanger, should I assume that I need to find some sort of wrapper/gem to make these chef calls now?"}], "owner": {"reputation": 77, "user_id": 1576738, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8cd9d4c455e18d726645dd02df207a08?s=128&d=identicon&r=PG&f=1", "display_name": "user1576738", "link": "https://stackoverflow.com/users/1576738/user1576738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540424654, "creation_date": 1540424654, "question_id": 52979386, "link": "https://stackoverflow.com/questions/52979386/chef-api-rest-deprecated", "title": "Chef API REST deprecated", "body": "<p>I'm trying to replace my deprecated Chef::REST API call with Chef::ServerAPI but I can't seem to make it work.</p>\n\n<p>I'm initializing it like this:</p>\n\n<pre><code>def initialize(options={})\n\n  @account_name = options[:account_name] or raise 'The chef account name has not been set'\n  @client_name = options[:client_name] or raise 'The chef client name has not been set'\n  @client_key = options[:client_key] or raise 'The chef client key has not been set'\n  @cache = Config[:cache] or raise 'The chef_service client has not been configured'\n  @cache_expiry = Config[:cache_expiry]\n  @chef_status = ChefStatus.new(Config[:chef_status_url], Config[:chef_status_url_expiry])\nend\n</code></pre>\n\n<p>and the actual call is in a method:</p>\n\n<pre><code>def rest\n  @rest ||= Chef::REST.new(api_url, client_name, nil, raw_key: client_key)\nend\n</code></pre>\n\n<p>I thought that I could just call:</p>\n\n<pre><code>def rest\n  @rest ||= Chef::ServerAPI.new(api_url, client_name, nil, raw_key: client_key)\nend\n</code></pre>\n\n<p>But that did not work at all. I would appreciate if someone can give me a pointer. Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums", "ruby-on-rails-5"], "owner": {"reputation": 69, "user_id": 10447327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbae0ed802a138f9f3ecc875095b904?s=128&d=identicon&r=PG&f=1", "display_name": "Nattemando", "link": "https://stackoverflow.com/users/10447327/nattemando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1540424461, "creation_date": 1540421052, "question_id": 52978914, "link": "https://stackoverflow.com/questions/52978914/how-to-name-a-enum-with-the-name-being-different-from-its-name-in-a-database", "title": "How to name a enum with the name being different from its name in a database?", "body": "<p>I have a model with <code>enum</code>:</p>\n\n<pre><code>class MyModel &lt; ApplicationRecord\n  enum my_enum: [:status1, :status2, :status3, :status4]\n\n\n  # .........\nend\n</code></pre>\n\n<p>I want to field in the database to be titled \"status\", whereas in my model it should be titled \"my_enum\"</p>\n\n<p>Is this possible? How to specify the name of the source column in database?</p>\n\n<p>I'm aware of \"_prefix\", \"postfix\" properties of \"enum\" in Rails and this isn't what I need.</p>\n"}, {"tags": ["ruby", "bundler", "zsh", "rubymine", "rbenv"], "comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1540426965, "post_id": 52978870, "comment_id": 92865684, "body": "Your answer might be found among this text: <a href=\"https://github.com/rbenv/rbenv#choosing-the-ruby-version\" rel=\"nofollow noreferrer\">github.com/rbenv/rbenv#choosing-the-ruby-version</a> . Have you tried setting the global rbenv version, to make sure rbenv is picking the right executable?"}, {"owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1540429708, "post_id": 52978870, "comment_id": 92866243, "body": "Yes; I&#39;m only setting the global rbenv version (see edits in post).  I&#39;m seeing different results for <code>which gem</code> and <code>rbenv which gem</code> suggesting the shims aren&#39;t applying to RubyMine.  Likewise, <code>which bundle&#47;bundler</code> is no longer finding anything, while <code>rbenv which bundle&#47;bundler</code> is finding the correct versions."}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1540469954, "post_id": 52978870, "comment_id": 92883280, "body": "Perhaps you want to open a new issue with RubyMine instead. If you figure it out post the answer here too. The things that influence executable and gem selections are PATH and the GEM_* variables. Both need to be the same in order for the right executables and gems to be found. But you have a lot of moving parts here, making it difficult to debug without access to your console. Rbenv in itself is already a complex piece of code, and you have binstubs added on top also."}, {"owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1540478293, "post_id": 52978870, "comment_id": 92889138, "body": "Thanks! I just opened a support ticket, and will describe the results here. In the meantime I&#39;ll do more investigation of those two environment variables."}, {"owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "reply_to_user": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1540483405, "post_id": 52978870, "comment_id": 92892313, "body": "I did some hunting for the environment variables you mentioned and found a couple of things.  First, I don&#39;t see GEM_* set anywhere.  Second, my zsh login shell PATH is missing a couple of entries when run inside RubyMine: ~/.nvm/versions/node/v6.9.0/bin and (!) ~/.rbenv/shims. The next question is -why-.  Exploration documented here: <a href=\"https://gist.github.com/islemaster/6fa6abb0a7386de2277b1d605f6ef53a\" rel=\"nofollow noreferrer\">gist.github.com/islemaster/6fa6abb0a7386de2277b1d605f6ef53a</a>"}, {"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 1, "creation_date": 1540484678, "post_id": 52978870, "comment_id": 92892988, "body": "I think you might be on the right track. Note that GEM_* does not HAVE to be set anywhere. Rbenv will set it when you run it most likely. This is what I mean by layers of complexity. But that the shims path is missing seems relevant to me."}], "answers": [{"comments": [{"owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "edited": false, "score": 0, "creation_date": 1540483051, "post_id": 52993406, "comment_id": 92892093, "body": "Thanks for the pointers!  I have also had to set these in the past. Unfortunately this doesn&#39;t solve my situation, probably because RubyMine can&#39;t find Bundler at all.  I&#39;ve checked <code>bundle exec</code> and manually set the SDK for all of my run configurations, but I&#39;m seeing this problem with tools that aren&#39;t tied to run configurations at all, such as &quot;Tools &gt; Bundler &gt; Install.&quot;"}], "tags": [], "owner": {"reputation": 167, "user_id": 1630875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/YxXAS.jpg?s=128&g=1", "display_name": "awsmsce", "link": "https://stackoverflow.com/users/1630875/awsmsce"}, "is_accepted": false, "score": 1, "last_activity_date": 1540482471, "creation_date": 1540482471, "answer_id": 52993406, "question_id": 52978870, "link": "https://stackoverflow.com/questions/52978870/why-doesnt-rubymine-2018-2-detect-my-gems/52993406#52993406", "title": "Why doesn&#39;t RubyMine 2018.2 detect my gems?", "body": "<p>Been where you are before a bunch of times.</p>\n\n<p>Under the list of scripts you can run, click \"Edit Configurations\". Should be in the main toolbar.</p>\n\n<p><img src=\"https://i.imgur.com/8K020Au.png\" alt=\"edit configuration\"></p>\n\n<p>Double check that you have \"Run the script in context of bundle (bundle exec)\" checked on the bundler tab. This is SUPER important and is not checked by default. Make sure you check for any rake, rails or irb configurations.</p>\n\n<p><img src=\"https://i.imgur.com/MQBIYQu.png\" alt=\"bundler context\"></p>\n\n<p>Keep in mind that the run configuration is where you can override the settings for the project. It will create all kinds of problems if this is not set appropriately.</p>\n\n<p><img src=\"https://i.imgur.com/BjWC0nX.png\" alt=\"project SDK\"></p>\n\n<p>Hope this helps! Bit me a bunch of times.</p>\n"}, {"comments": [{"owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "edited": false, "score": 0, "creation_date": 1540501383, "post_id": 52994317, "comment_id": 92900846, "body": "The old &quot;have you turned it off and on again&quot; :)"}, {"owner": {"reputation": 1859, "user_id": 629636, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4afe2793aff8f858ccb80eb4d21226c9?s=128&d=identicon&r=PG", "display_name": "Lachlan Cotter", "link": "https://stackoverflow.com/users/629636/lachlan-cotter"}, "edited": false, "score": 0, "creation_date": 1588763133, "post_id": 52994317, "comment_id": 109021631, "body": "Thanks for this excellent explanation. Put an end to a long hair-pulling session."}], "tags": [], "owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "is_accepted": true, "score": 2, "last_activity_date": 1540485912, "creation_date": 1540485912, "answer_id": 52994317, "question_id": 52978870, "link": "https://stackoverflow.com/questions/52978870/why-doesnt-rubymine-2018-2-detect-my-gems/52994317#52994317", "title": "Why doesn&#39;t RubyMine 2018.2 detect my gems?", "body": "<p>I got things working!  By signing out and back in. :facepalm:</p>\n\n<p>To be specific, I <em>think</em> the key steps were</p>\n\n<ol>\n<li>Move the <code>$(rbenv init -)</code> step from my <code>.zshrc</code> up to my <code>.zshenv</code> and/or to <code>.profile</code></li>\n<li>Signing out and back in.</li>\n</ol>\n\n<p>The key insight was noticing that <code>~/.rbenv/shims</code> was missing from the RubyMine Gem Environment despite showing up in both interactive and login shells (in and out of RubyMine), and realizing that while <em>new</em> shells were picking up my <code>.profile</code> changes, RubyMine itself was probably inheriting its environment variables from my session and I'd need to log out/in to to pick up the changes.</p>\n\n<p>I now see <code>~/.rbenv/shims</code> in my RubyMine Gem Environment, and both the Bundler Install command and my run configurations are working again.</p>\n\n<p>Thank you <a href=\"https://stackoverflow.com/users/823617/casper\">Casper</a> for pointing me in the right direction!</p>\n"}], "owner": {"reputation": 1315, "user_id": 5000129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1xrDEe5Tohw/AAAAAAAAAAI/AAAAAAAAAO4/N8g5z1pF_7A/photo.jpg?sz=128", "display_name": "Brad Buchanan", "link": "https://stackoverflow.com/users/5000129/brad-buchanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2362, "favorite_count": 0, "accepted_answer_id": 52994317, "answer_count": 2, "score": 1, "last_activity_date": 1540485912, "creation_date": 1540420698, "last_edit_date": 1540455592, "question_id": 52978870, "link": "https://stackoverflow.com/questions/52978870/why-doesnt-rubymine-2018-2-detect-my-gems", "title": "Why doesn&#39;t RubyMine 2018.2 detect my gems?", "body": "<p>I'm trying to debug a Rails project within RubyMine v2018.2 (2018.2.1, 2018.2.4).  When I start the editor I get a warning:</p>\n\n<blockquote>\n  <p>RubyMine Gem Manager: RubyMine has detected that some of the gems required for '<em>project</em>' are not installed.</p>\n</blockquote>\n\n<p>When I try to run RubyMine's Bundler install command I'm told</p>\n\n<pre><code>bash -c \"RBENV_VERSION=2.5.0 /usr/bin/rbenv exec bundle install -V\"\nActivating bundler (&lt; 2) failed:\nCould not find 'bundler' (&lt; 2) among 28 total gem(s)\nChecked in 'GEM_PATH=/home/brad/.gem/ruby/2.5.0:/var/lib/gems/2.5.0:/usr/lib/x86_64-linux-gnu/rubygems-integration/2.5.0:/usr/share/rubygems-integration/2.5.0:/usr/share/rubygems-integration/all', execute `gem env` for more information\n\nTo install the version of bundler this project requires, run `gem install bundler -v '&lt; 2'`\n</code></pre>\n\n<p>...and when I try to run or debug my application from the IDE I'm told \"Could not find bundler (<em>version</em>) required by your <em>project-path</em>/Gemfile.lock.\"</p>\n\n<p>Why doesn't RubyMine detect my installed Gems?</p>\n\n<h2>My environment</h2>\n\n<ul>\n<li>Ubuntu 18.04.01</li>\n<li>zsh 5.4.2</li>\n<li>rbenv 1.0.0</li>\n<li>rbenv-binstubs @ 8ecb7ca8</li>\n<li>Rubymine 2018.2.4</li>\n</ul>\n\n<p>I'm using rbenv to manage my Ruby versions.  The system has Ruby 2.5.1 installed, but my project depends on 2.5.0.  I've set 2.5.0 as the rbenv global version. Configuration for <a href=\"https://github.com/rbenv/rbenv#choosing-the-ruby-version\" rel=\"nofollow noreferrer\">how rbenv chooses a Ruby version</a> seems okay; I get the following results from the noninteractive commands:</p>\n\n<pre><code>&gt; echo $RBENV_VERSION\n(no response)\n\n&gt; cat ~/.rbenv/version\n2.5.0\n\n&gt; rbenv global\n2.5.0\n</code></pre>\n\n<p>After noticing rbenv wasn't working properly in some RubyMine commands I moved the <code>eval \"$(rbenv init -)\"</code> setup step from by <code>~/.zshrc</code> up to <code>~/.zshenv</code> and <code>~/.profile</code> so it will also apply to bash and zsh login shells (per guidance <a href=\"https://github.com/rbenv/rbenv/wiki/unix-shell-initialization\" rel=\"nofollow noreferrer\">here</a>).  I'm now getting matching results for interactive and login shells, but still getting unexpected behavior from the Bundle install command within RubyMine.</p>\n\n<h2>What is working</h2>\n\n<p>My application installs, builds and runs just fine from an interactive shell.</p>\n\n<p>RubyMine's Ruby SDK settings correctly detect rvm and its installed versions, and all of the installed gems for that version.</p>\n\n<p><a href=\"https://i.stack.imgur.com/d1Z23.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d1Z23.png\" alt=\"RubyMine Ruby SDK Settings\"></a></p>\n\n<h2>What I've tried</h2>\n\n<p>The output from the bundle install command claims it's running</p>\n\n<pre><code>bash -c \"RBENV_VERSION=2.5.0 /usr/bin/rbenv exec bundle install\"\n</code></pre>\n\n<p>When I run this from my interactive shell or with RubyMine's \"Run anything\" feature (login shell) this command works fine - as does any of the following:</p>\n\n<pre><code>RBENV_VERSION=2.5.0 /usr/bin/rbenv exec bundle install\n/usr/bin/rbenv exec bundle install\nrbenv exec bundle install\nbundle install\n</code></pre>\n\n<p>So I can't figure out what context RubyMine is using to run this command.  It's clear from the error message that the <code>GEM_PATH</code> is incorrect, causing RubyMine to look in the wrong place for bundler, but I don't know where it's getting this configuration.  If I bring up the \"RubyGems Environment\" view in RubyMine I get:</p>\n\n<pre><code>RUBYGEMS VERSION: 2.7.3\nRUBY VERSION: 2.5.0 (2017-12-25 patchlevel 0) [x86_64-linux]\nINSTALLATION DIRECTORY: /home/brad/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0\nUSER INSTALLATION DIRECTORY: /home/brad/.gem/ruby/2.5.0\nRUBY EXECUTABLE: /home/brad/.rbenv/versions/2.5.0/bin/ruby\nEXECUTABLE DIRECTORY: /home/brad/.rbenv/versions/2.5.0/bin\nSPEC CACHE DIRECTORY: /home/brad/.gem/specs\nSYSTEM CONFIGURATION DIRECTORY: /home/brad/.rbenv/versions/2.5.0/etc\nRUBYGEMS PLATFORMS:\n  ruby\n  x86_64-linux\nGEM PATHS:\n   /home/brad/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0\n   /home/brad/.gem/ruby/2.5.0\n(...)\nSHELL PATH:\n   /home/brad/.rbenv/versions/2.5.0/bin\n   /usr/lib/rbenv/libexec\n   /home/brad/.rbenv/plugins/ruby-build/bin\n   /home/brad/.rbenv/plugins/rbenv-gemset/bin\n   /home/brad/.rbenv/plugins/rbenv-binstubs/bin\n   (...rest of PATH...)\n----------------------\nIDE: RubyMine 2018.2.4, build #RM-182.4505.55\nOS: Linux 4.15.0-38-generic[amd64]\nJava: 1.8.0_152-release-1248-b8\nRubyMine SDK Environment:\nSdk: rbenv: 2.5.0\nSdk Version: ver.2.5.0p0 ( revision 61468) p0\nRuby Interpreter: /home/brad/.rbenv/versions/2.5.0/bin/ruby\nRVM Sdk: Rbenv sdk, gemset nullSdk Language Level: 2.5\nSdk Load Path:\n     ~/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/did_you_mean-1.2.0/lib\n     ~/.rbenv/versions/2.5.0/lib/ruby/site_ruby/2.5.0\n     ~/.rbenv/versions/2.5.0/lib/ruby/site_ruby/2.5.0/x86_64-linux\n     ~/.rbenv/versions/2.5.0/lib/ruby/site_ruby\n     ~/.rbenv/versions/2.5.0/lib/ruby/vendor_ruby/2.5.0\n     ~/.rbenv/versions/2.5.0/lib/ruby/vendor_ruby/2.5.0/x86_64-linux\n     ~/.rbenv/versions/2.5.0/lib/ruby/vendor_ruby\n     ~/.rbenv/versions/2.5.0/lib/ruby/2.5.0\n     ~/.rbenv/versions/2.5.0/lib/ruby/2.5.0/x86_64-linux\n     ~/.local/share/JetBrains/Toolbox/apps/RubyMine/ch-0/182.4505.55/rubystubs25\nSdk Gem paths: \n     ~/.gem/ruby/2.5.0/gems\n     ~/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/bundler/gems\n     ~/.bundle/ruby/2.5.0/gems\n     ~/.bundle/ruby/2.5.0/bundler/gems\n     ~/.gem/ruby/2.5.0/bundler/gems\n     ~/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems\n(full list of gems used for project)\n</code></pre>\n\n<p>So I think that last bit - \"Sdk Gem paths\" - might be the problem point, but I don't see any way to configure it.</p>\n\n<p>I'm also already aware of the YouTrack issue <a href=\"https://youtrack.jetbrains.com/issue/RUBY-22237\" rel=\"nofollow noreferrer\">\"Rubymine 2018.2 release does not take $GEM_HOME environment variable\"</a> and don't think it's quite what's happening here.  It also claims to be fixed in 2018.3 EAP1, so I installed 2018.3 EAP7 but am still seeing this problem.</p>\n"}, {"tags": ["ruby", "rubygems", "bundler", "rbenv"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1540417914, "post_id": 52977784, "comment_id": 92863312, "body": "It is always safe to remove rbenv and all installed rubies, then reinstall from scratch. Strange issues like this are typically resolved by a clean installation."}], "answers": [{"comments": [{"owner": {"reputation": 4402, "user_id": 692622, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/29d3327801aa145c77d873604a2f71c0?s=128&d=identicon&r=PG", "display_name": "iCyborg", "link": "https://stackoverflow.com/users/692622/icyborg"}, "edited": false, "score": 0, "creation_date": 1615237828, "post_id": 52977808, "comment_id": 117624758, "body": "I will advise others to not do this and just run gem install bundle or find a different solution"}], "tags": [], "owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "is_accepted": true, "score": 1, "last_activity_date": 1540414650, "creation_date": 1540414650, "answer_id": 52977808, "question_id": 52977784, "link": "https://stackoverflow.com/questions/52977784/bundle-not-working-with-rbenv-and-cannot-gem-install-bundler/52977808#52977808", "title": "Bundle not working with rbenv and cannot gem install bundler", "body": "<p>However I did find a very manual solution to this.  </p>\n\n<p>I noticed how <code>rbenv whence bundle</code> specified that bundle was active in some ruby versions, but not others. I tracked down <a href=\"https://github.com/rbenv/rbenv/blob/master/libexec/rbenv-whence#L24\" rel=\"nofollow noreferrer\">the portion of rbenv whence command to find out where it was looking</a> and saw that it looked under the following path for each ruby version installed under rbenv: <code>~/.rbenv/versions/$VERSION/bin/</code></p>\n\n<p>If you look under the path for the gem without bundler (for me this was ~/.rbenv/versions/2.5.1/bin/) you will notice that it is not there. However under other versions that whence can recognise you will see the executable is there (for me it was there under <code>~/.rbenv/versions/2.3.1/bin/bundle</code> and <code>~/.rbenv/versions/2.3.1/bin/bundle</code>).</p>\n\n<p>So I copied the executable over from the working ruby version to the one that was broken. Then at the top of the file you will notice sha-bang is set to the other ruby version (for me this was <code>#!/Users/myuser/.rbenv/versions/2.3.1/bin/ruby</code>). Change the version path to the ruby version you want to fix and then it will all magically start working.</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 1630875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/YxXAS.jpg?s=128&g=1", "display_name": "awsmsce", "link": "https://stackoverflow.com/users/1630875/awsmsce"}, "is_accepted": false, "score": 0, "last_activity_date": 1540489250, "creation_date": 1540489250, "answer_id": 52995178, "question_id": 52977784, "link": "https://stackoverflow.com/questions/52977784/bundle-not-working-with-rbenv-and-cannot-gem-install-bundler/52995178#52995178", "title": "Bundle not working with rbenv and cannot gem install bundler", "body": "<p>I would highly recommend that you run your ansible scripts in an environment without rbenv. In other words, it is preferable to be using vagrant or a VM to practice your scripts in. </p>\n\n<p>If your project really needs rbenv, please use the ansible rbenv library to work with it, but running it on your host machine is a dangerous way to develop because it is not easily reversible.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 52977808, "answer_count": 2, "score": 2, "last_activity_date": 1540489250, "creation_date": 1540414471, "question_id": 52977784, "link": "https://stackoverflow.com/questions/52977784/bundle-not-working-with-rbenv-and-cannot-gem-install-bundler", "title": "Bundle not working with rbenv and cannot gem install bundler", "body": "<p>I was running into an issue with bundler when using rbenv.  I had switched from ruby 2.3.1 to 2.5.1 a while ago, but I noticed the following error when trying to run bundler inside of a shell script in an ansible task.</p>\n\n<p>```\nrbenv: bundle: command not found</p>\n\n<pre><code>The `bundle' command exists in these Ruby versions:\n  2.2.2\n  2.3.1\n</code></pre>\n\n<p>```</p>\n\n<p>I saw some solutions to this where you had to install bundler when on a specific ruby version.  However even uninstalling bundler and reinstalling it did not resolve the issue. It seemed due to some gem issue that I could not install bundler on specific ruby versions, thus reinstalling bundler did nothing for me.</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1540415179, "post_id": 52977544, "comment_id": 92862348, "body": "Maybe it should be <code>filetypes = %w(.flac .wv)</code>, instead of <code>a = %w(.flac .wv)</code>?"}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1540415242, "post_id": 52977544, "comment_id": 92862368, "body": "Yes, sorry, I missed that.  Will fix."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1540418465, "post_id": 52977544, "comment_id": 92863466, "body": "In general, I think you would find it more helpful to ask how to achieve a certain end rather than restricting consideration to a specific approach (here using <code>end_with?</code>). The latter are sometimes referred to as <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">&quot;XY problems&quot;</a>."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540418558, "post_id": 52977544, "comment_id": 92863492, "body": "@CarySwoveland OK an enumerable, but no method on the string object.  It seems an Enumerable is the quickest way."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540418751, "post_id": 52977544, "comment_id": 92863542, "body": "@CarySwoveland My question wasn&#39;t how to get this to work as I did in the original post.  That wasn&#39;t my goal.  In my own interest, I was looking to see if there was indeed a method to do this as opposed to any Enumerable."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1540422183, "post_id": 52977544, "comment_id": 92864565, "body": "I was going by the title of the question."}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540415510, "post_id": 52977931, "comment_id": 92862464, "body": "That&#39;s what I was thinking, then wanting that to see an input array somehow expressed as that comma delimited suffices.  But I hope this thread shows the wish to qualify through an array instead of <code>Array.include?(&#39;stringthing&#39;)</code>."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 1, "creation_date": 1540415776, "post_id": 52977931, "comment_id": 92862559, "body": "I have no idea what you were trying to say in this comment and I&#39;ve read it multiple times. If you&#39;re saying you still want to pass an array, then use the splat operator <code>*</code> on your array as demonstrated in the most recent edit to my answer."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540415901, "post_id": 52977931, "comment_id": 92862607, "body": "Sorry, yes, you are right on with what you said.  <code>myarray.*&#39;,&#39;)</code> works."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540416539, "post_id": 52977931, "comment_id": 92862837, "body": "It hasn&#39;t.  If you read the post, there is nothing for a reciprocating iteration through an array of qualifiers.  Yes I have written a workaround, but the question was about a method that iterates through an array.  Please read the original post."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540416714, "post_id": 52977931, "comment_id": 92862898, "body": "OK, you have edited it and you want me to say that you have given me the answer.  You didn&#39;t.  You gave me a workaround instead of a method I thought I missed.  Please stop editing posts then demanding recognition for something you didn&#39;t provide."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540416779, "post_id": 52977931, "comment_id": 92862922, "body": "I have no idea what you mean about a &quot;reciprocating iteration through an array of qualifiers.&quot; If you can explain your question in clear English then I recommend you edit your original question to include that question. The edit you&#39;re referring to was made after you said &quot;Sorry, yes, you are right on with what you said,&quot; indicating it was the correct answer, and was also made to correct multiple transcription errors in your code example."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540417564, "post_id": 52977931, "comment_id": 92863195, "body": "See <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a> -- your original question explicitly asked only one thing: &quot;Am I missing something?&quot; which is a bad question, and implicitly asked one thing: &quot;it suggests an array can be traversed, but it&#39;s not working for me&quot; -- my edit made your implicit question explicit, because <i>Questions</i> should include an actual question."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540419944, "post_id": 52977931, "comment_id": 92863882, "body": "Read the post. What you provided, an iterator, was already in the post.  It is very clean.  Even before you messed with it.  Reading English takes context.  It&#39;s that simple.  If you posted an iterator to answer something that had an iterator in it, you&#39;ve made no sense."}, {"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540420800, "post_id": 52977931, "comment_id": 92864140, "body": "It&#39;s been answered by someone else who got the whole post.  It seems yet again, you aren&#39;t paying attention.  Good luck with that."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540421250, "post_id": 52977931, "comment_id": 92864303, "body": "The other answer says &quot;use the splat operator.&quot; My answer says &quot;use the splat operator.&quot; If you&#39;re confused or don&#39;t understand the example I gave you then I&#39;m happy to explain to you how they are identical answers."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540425821, "post_id": 52977931, "comment_id": 92865457, "body": "I have added an extensive explanation of my answer including multiple examples demonstrating the use of <code>*</code>. I have also included benchmarks showing why the approach is poor. I hope that it will help you to understand both how and why the splat operator works, and enable you to be a better Ruby programmer overall. Good luck."}], "tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": false, "score": 0, "last_activity_date": 1540425654, "last_edit_date": 1540425654, "creation_date": 1540415300, "answer_id": 52977931, "question_id": 52977544, "link": "https://stackoverflow.com/questions/52977544/ruby-string-end-with-array/52977931#52977931", "title": "Ruby String end_with? Array", "body": "<p>You can do this with a simple one-liner that avoids using <code>end_with?</code>:</p>\n\n<pre><code>Dir[Dir.pwd + '/*.{flac,wv}'].each { |filename| pp filename }\n</code></pre>\n\n<p>For your question about what values are accepted by <code>end_with?</code>, the answer is that it accepts a comma-delimited list of values, e.g.:</p>\n\n<pre><code>'foo'.end_with?('a', 'b', 'c')\n=&gt; false\n'foo'.end_with?('a', 'b', 'c', 'o')\n=&gt; true\n</code></pre>\n\n<p>The documentation example of <code>end_with?([suffixes]+) \u2192 true or false</code> can be read as \"<code>end_with?</code> accepts one or more suffixes delimited by commas, which will be treated as an array by the receiving object, and if the string ends with any of the suffixes then return <code>true</code>, else return <code>false</code>.\"</p>\n\n<p>You can also use the <a href=\"https://stackoverflow.com/questions/42158005/what-is-the-standalone-splat-operator-used-for-in-ruby\">splat operator</a> to convert an array to an acceptable value for <code>end_with?</code>:</p>\n\n<pre><code>'foo'.end_with?(*['a', 'b', 'c'])\n=&gt; false\n'foo'.end_with?(*['a', 'b', 'c', 'o'])\n=&gt; true\n</code></pre>\n\n<p><strong>Update for clarification of examples given</strong></p>\n\n<p>Judging from the comments below, Rich_F was extremely confused by this answer about the splat operator so I will clarify my answer to help ensure that no one else is confused by the example I have provided.</p>\n\n<p>The splat operator <code>*</code> in Ruby will convert an array's contents to a comma-delimited list of arguments. It is often used when passing an array as an argument to a method, for example:</p>\n\n<pre><code>array = ['a', 'b', 'c']\n'foo'.end_with?(*array)\n</code></pre>\n\n<p>This will \"splat\" the array into a comma delimited list of arguments, and is functionally equivalent to:</p>\n\n<pre><code>'foo'.end_with?(*['a', 'b', 'c'])\n</code></pre>\n\n<p>Likewise, it is functionally equivalent to:</p>\n\n<pre><code>'foo'.end_with?('a', 'b', 'c')\n</code></pre>\n\n<p>Likewise, it is functionally equivalent to:</p>\n\n<pre><code>array = %w(a b c)\n'foo'.end_with?(*array)\n</code></pre>\n\n<p>Likewise, it is functionally equivalent to:</p>\n\n<pre><code>'foo'.end_with?(*%w(a b c))\n</code></pre>\n\n<p>Likewise, it is functionally equivalent to:</p>\n\n<pre><code>filetypes = %w(.flac .wv)\nfilename.end_with?(*filetypes)\n</code></pre>\n\n<p>Given this knowledge about how the splat operator affects arrays and the examples for passing arrays as arguments to methods, one can deduce that the given code example in the question can be altered as follows:</p>\n\n<pre><code>filetypes = %w(.flac .wv)\nDir.open(Dir.pwd).each do |filename|\n  pp filename if filename.end_with?(*filetypes)\nend\n</code></pre>\n\n<p>The only change is to add <code>*</code>. By adding the splat operator <code>*</code> before the argument <code>filetypes</code>, the <code>filetypes</code> array will be expanded as comma-delimited arguments for the call to <code>end_with?</code>.</p>\n\n<p>This is not an efficient solution to the problem because it requires iterating over the <code>filetypes</code> array once for every iteration of the directory listing and iterates over all objects in the directory regardless of matching, as opposed to using <code>Dir[Dir.pwd + '/*.{flac,wv}'].each { |filename| pp filename }</code> which returns only the relevant files and does not have to iterate over a second array for each iteration. As such, using <code>end_with?</code> in the example given is massively inefficient and should not be used in any real code.</p>\n\n<p>For example, given a directory with 10,000 files ending in <code>.flac</code>:</p>\n\n<pre><code>require 'benchmark'\n\ndir = Dir[Dir.pwd + '/*.{flac,vw}']; nil\n10.times { puts Benchmark.measure { 10000.times { dir.each { |filename| nil } } } }\n  4.271809   0.001728   4.273537 (  4.274684)\n  4.279765   0.002286   4.282051 (  4.283524)\n  4.334877   0.004689   4.339566 (  4.343982)\n  4.269334   0.001593   4.270927 (  4.272033)\n  4.256148   0.001545   4.257693 (  4.258734)\n  4.261371   0.001733   4.263104 (  4.264229)\n  4.254568   0.001085   4.255653 (  4.256379)\n  4.259886   0.001245   4.261131 (  4.261711)\n  4.258024   0.001964   4.259988 (  4.261133)\n  4.236385   0.001142   4.237527 (  4.238184)\n</code></pre>\n\n<p>In comparison to the original example in the question, which is over twice as slow:</p>\n\n<pre><code>require 'benchmark'\n\ndir = Dir[Dir.pwd + '/*']; nil\nfiletypes = %w(flac vw); nil\n10.times { puts Benchmark.measure { 10000.times { dir.each { |filename| nil if filename.end_with?(*filetypes) } } } }\n   9.509041   0.003634   9.512675 (  9.514197)\n   9.484041   0.003079   9.487120 (  9.488686)\n   9.508674   0.002872   9.511546 (  9.512768)\n   9.508382   0.002809   9.511191 (  9.512343)\n   9.762489   0.011043   9.773532 (  9.783415)\n   9.607308   0.005655   9.612963 (  9.616716)\n   9.962166   0.009848   9.972014 (  9.978026)\n   9.621152   0.005883   9.627035 (  9.631075)\n  10.811991   0.010787  10.822778 ( 10.831729)\n  10.461568   0.013571  10.475139 ( 10.487688)\n</code></pre>\n\n<p>The difference becomes much more pronounced when the number of matching files is far below the number of non-matching files. Here, the directory has 1,000 <code>.flac</code> files and 9,000 <code>.txt</code> files:</p>\n\n<pre><code>require 'benchmark'\n\ndir = Dir[Dir.pwd + '/*.{flac,vw}']; nil\n10.times { puts Benchmark.measure { 10000.times { dir.each { |filename| nil } } } }\n  0.384366   0.000210   0.384576 (  0.384669)\n  0.384336   0.000186   0.384522 (  0.384717)\n  0.386674   0.000178   0.386852 (  0.386947)\n  0.383575   0.000075   0.383650 (  0.383671)\n  0.382555   0.000090   0.382645 (  0.382692)\n  0.384618   0.000048   0.384666 (  0.384677)\n  0.384687   0.000199   0.384886 (  0.384976)\n  0.386517   0.000193   0.386710 (  0.386842)\n  0.386167   0.000132   0.386299 (  0.386388)\n  0.390683   0.000093   0.390776 (  0.390817)\n</code></pre>\n\n<p>Compared to the original example using the splat operator, which is over <strong>36 times slower</strong>:</p>\n\n<pre><code>require 'benchmark'\n\ndir = Dir[Dir.pwd + '/*']; nil\nfiletypes = %w(flac vw); nil\n10.times { puts Benchmark.measure { 10000.times { dir.each { |filename| nil if filename.end_with?(*filetypes) } } } }\n  11.182205   0.014303  11.196508 ( 11.210042)\n  11.154286   0.011573  11.165859 ( 11.178611)\n  11.081012   0.009853  11.090865 ( 11.098028)\n  11.084294   0.009361  11.093655 ( 11.101870)\n  10.990442   0.007118  10.997560 ( 11.002036)\n  11.044119   0.009284  11.053403 ( 11.058608)\n  11.072604   0.009114  11.081718 ( 11.087941)\n  11.127151   0.009354  11.136505 ( 11.143270)\n  11.172101   0.012262  11.184363 ( 11.195138)\n  11.126791   0.010767  11.137558 ( 11.145617)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540418678, "post_id": 52978497, "comment_id": 92863524, "body": "OK and we have it.  Exactly what I was looking for.  Thank you."}, {"owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "reply_to_user": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "edited": false, "score": 0, "creation_date": 1540487806, "post_id": 52978497, "comment_id": 92894565, "body": "No problem! Happy to help :)"}], "tags": [], "owner": {"reputation": 1141, "user_id": 3251463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hxssB.png?s=128&g=1", "display_name": "Scott Schupbach", "link": "https://stackoverflow.com/users/3251463/scott-schupbach"}, "is_accepted": true, "score": 3, "last_activity_date": 1540418479, "creation_date": 1540418479, "answer_id": 52978497, "question_id": 52977544, "link": "https://stackoverflow.com/questions/52977544/ruby-string-end-with-array/52978497#52978497", "title": "Ruby String end_with? Array", "body": "<p>You're just missing the splat operator (*):</p>\n\n<pre><code>filetypes = %w(.flac .wv)\n\nDir.open(Dir.pwd).each do |filename|\n  pp(filename) if filename.end_with?(*filetypes)\nend\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 1718633, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/fabe1e6b28afc64cdbd3c071621a7565?s=128&d=identicon&r=PG", "display_name": "Rich_F", "link": "https://stackoverflow.com/users/1718633/rich-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1102, "favorite_count": 0, "accepted_answer_id": 52978497, "answer_count": 2, "score": -1, "last_activity_date": 1540425654, "creation_date": 1540413262, "last_edit_date": 1540416138, "question_id": 52977544, "link": "https://stackoverflow.com/questions/52977544/ruby-string-end-with-array", "title": "Ruby String end_with? Array", "body": "<p>I'm looking for a way to qualify if a filename ends with a suffix inside an array. </p>\n\n<pre><code>filetypes = %w(.flac .wv)\nDir.open(Dir.pwd).each do |filename|\n  q = \".\" + filename.split('.').last.to_s\n  pp filename if filetypes.include?(q)\nend\n</code></pre>\n\n<p>I'm thinking there has to be some kind of built-in iterator that traverses the qualifier array.  Am I missing something here?</p>\n\n<pre><code>filetypes = %w(.flac .wv)\nDir.open(Dir.pwd).each do |filename|\n  pp filename if filename.end_with?(filetypes)\nend\n</code></pre>\n\n<p>This doesn't work.  The docs say this: </p>\n\n<p><code>end_with?([suffixes]+) \u2192 true or false</code></p>\n\n<p>So it suggests an array can be traversed, but it's not working for me. How can I pass an array to <code>end_with?</code>?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1540409084, "post_id": 52976508, "comment_id": 92859598, "body": "<code>numbers.each</code> returns the input, in this case the range <code>1..20</code>. You want <code>numbers.map</code> to accumulate the results of the block into a new array."}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "reply_to_user": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1540409305, "post_id": 52976508, "comment_id": 92859705, "body": "ive changed it to .map but it still says false. Anything else need changing? @ChrisHeald"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1540409939, "post_id": 52976508, "comment_id": 92860007, "body": "<code>puts</code> returns <code>nil</code>, which you could test easily in the REPL (i.e., <code>irb</code>). The REPL is your friend: it allows you to instantly test assumptions if you&#39;re going to actively avoid tutorials or reading the documentation."}], "answers": [{"tags": [], "owner": {"reputation": 263, "user_id": 5979872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEHWa.jpg?s=128&g=1", "display_name": "Adittya Verma", "link": "https://stackoverflow.com/users/5979872/adittya-verma"}, "is_accepted": true, "score": 1, "last_activity_date": 1540409527, "creation_date": 1540409527, "answer_id": 52976643, "question_id": 52976508, "link": "https://stackoverflow.com/questions/52976508/how-to-do-a-simple-test-in-ruby/52976643#52976643", "title": "How to do a simple test in ruby", "body": "<p>Try below code to get your answer :</p>\n\n<pre><code>numbers = (1..20)\ntest = numbers.map{|a| a*a}\nputs test == [1,4,9,16,25,36,49,64,81,100,121,144,169,196,225,256,289,324,361,400]\n</code></pre>\n\n<p>You are using first <strong>test</strong> which contents <code>1..20</code>. So you have to modify your code.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 9777233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072a1b30fe8374a8648623b595ed6135?s=128&d=identicon&r=PG&f=1", "display_name": "Hajar", "link": "https://stackoverflow.com/users/9777233/hajar"}, "is_accepted": false, "score": 1, "last_activity_date": 1540411326, "last_edit_date": 1540411326, "creation_date": 1540410989, "answer_id": 52977010, "question_id": 52976508, "link": "https://stackoverflow.com/questions/52976508/how-to-do-a-simple-test-in-ruby/52977010#52977010", "title": "How to do a simple test in ruby", "body": "<p>In your code <code>numbers.each do |number| .. end</code> returns the range (1..20) and that's the value that test will be assigned to after the loop through <code>numbers</code> is done. So even if you deleted the line <code>puts number* number</code>, test will still have the value (1..20). So using <code>map</code> would be the right choice to keep your values in an array. But you should first delete <code>puts</code>, because it shows the value on the screen but returns <code>nil</code>. So if you used <code>map</code> but didn't delete <code>puts</code> test will be assigned to an array of <code>nil</code>s.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52976643, "answer_count": 2, "score": 0, "last_activity_date": 1540447583, "creation_date": 1540408918, "last_edit_date": 1540447583, "question_id": 52976508, "link": "https://stackoverflow.com/questions/52976508/how-to-do-a-simple-test-in-ruby", "title": "How to do a simple test in ruby", "body": "<p>I have some code below that gives square numbers. I also wrote a simple test that prints <code>true</code> or <code>false</code>.</p>\n\n<pre><code>numbers = (1..20)\ntest=numbers.each do |number|\n  puts number * number\nend\n\nputs test == [1,4,9,16,25,36,49,64,81,100,121,144,169,196,225,256,289,324,361,400]\n</code></pre>\n\n<p>I expect it to print <code>true</code>, but it puts <code>false</code>.</p>\n\n<p>I was wondering if anyone could help to see why.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apipie"], "answers": [{"tags": [], "owner": {"reputation": 11051, "user_id": 347165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4881e74d5b966aca3f5945a974e8d91b?s=128&d=identicon&r=PG", "display_name": "Xodarap", "link": "https://stackoverflow.com/users/347165/xodarap"}, "is_accepted": true, "score": 1, "last_activity_date": 1540420353, "creation_date": 1540420353, "answer_id": 52978802, "question_id": 52976173, "link": "https://stackoverflow.com/questions/52976173/why-are-my-api-pie-parameters-not-showing-up/52978802#52978802", "title": "Why are my API Pie parameters not showing up?", "body": "<p>I ended up needing to add these lines to the initializer:</p>\n\n<pre><code>  config.default_locale          = 'en'\n  config.languages               = ['en']\n</code></pre>\n"}], "owner": {"reputation": 11051, "user_id": 347165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4881e74d5b966aca3f5945a974e8d91b?s=128&d=identicon&r=PG", "display_name": "Xodarap", "link": "https://stackoverflow.com/users/347165/xodarap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 52978802, "answer_count": 1, "score": 1, "last_activity_date": 1540420353, "creation_date": 1540407509, "question_id": 52976173, "link": "https://stackoverflow.com/questions/52976173/why-are-my-api-pie-parameters-not-showing-up", "title": "Why are my API Pie parameters not showing up?", "body": "<p>I created the documentation for my methods, and the top-level method description shows up along with its verb, but when I click on any of these links it tells me \"Oops!! Method <code>create.en</code> not found for resource <code>questions</code>.\"</p>\n\n<p>Here is an example of my code:</p>\n\n<pre><code>  api :DELETE, '/questions/:id', 'Deletes question. Note that the delete cascades and also removes any child questions.'\n  param :id, :number\n  def destroy\n    @question = Question.find(params[:id])\n    @question.destroy_cascade\n    head :ok\n  end\n</code></pre>\n\n<p>And here's what the page looks like \u2013 all of these links take me to an error page</p>\n\n<p><a href=\"https://i.stack.imgur.com/moIMb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/moIMb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Weirdly, if I look at the json version it seems to be fine (i.e. it includes all the information).</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 2, "creation_date": 1540411108, "post_id": 52976149, "comment_id": 92860529, "body": "The plural of <code>child</code> is <code>children</code> - not <code>childs</code>."}, {"owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540481678, "post_id": 52976149, "comment_id": 92891288, "body": "I&#39;m well aware of that, I&#39;m a native English speaker. I just changed the model names for the purpose of this post. As you can see, I figured out my own answer, so I&#39;m good now."}], "answers": [{"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1540408735, "creation_date": 1540408735, "answer_id": 52976460, "question_id": 52976149, "link": "https://stackoverflow.com/questions/52976149/cannot-add-or-update-a-child-row-a-foreign-key-constraint-fails-ruby-on-rails/52976460#52976460", "title": "Cannot add or update a child row: a foreign key constraint fails - Ruby on Rails", "body": "<p>In <a href=\"https://api.rubyonrails.org/v5.2.1/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_for_select\" rel=\"nofollow noreferrer\">options_for_select</a> call you use an array of option texts, which is incorrect. You need to use an array of pairs [option text, option value]:</p>\n\n<pre><code>&lt;%= child.select :parent_id, options_for_select(Parent.all.map { |parent| [\"#{parent.grandparent.name} - #{parent.name}\", parent.id] }), { include_blank: true } %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "is_accepted": false, "score": 1, "last_activity_date": 1540408814, "creation_date": 1540408814, "answer_id": 52976478, "question_id": 52976149, "link": "https://stackoverflow.com/questions/52976149/cannot-add-or-update-a-child-row-a-foreign-key-constraint-fails-ruby-on-rails/52976478#52976478", "title": "Cannot add or update a child row: a foreign key constraint fails - Ruby on Rails", "body": "<p>Figured it out. It was my select form that was wrong. The actual value of the individual select options was not the ID's, so it wasn't able to update the table. Figured it out as so:</p>\n\n<pre><code>&lt;%= child.collection_select(:parent_id, Parent.all, :id, :parent_with_grandparent_name) %&gt;\n\nclass Parent &lt; ActiveRecord::Base\n\n  has_many :childs, :dependent =&gt; :delete_all \n  belongs_to :grandparent\n  def parent_with_grandparent_name\n    grandparent.name + \" - \" + name\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 5331859, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8ddfcdd5d8fc6e4d7cebc17d48a19600?s=128&d=identicon&r=PG&f=1", "display_name": "zasman", "link": "https://stackoverflow.com/users/5331859/zasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1540408814, "creation_date": 1540407378, "question_id": 52976149, "link": "https://stackoverflow.com/questions/52976149/cannot-add-or-update-a-child-row-a-foreign-key-constraint-fails-ruby-on-rails", "title": "Cannot add or update a child row: a foreign key constraint fails - Ruby on Rails", "body": "<p>My \"child\" form contains the following select:</p>\n\n<pre><code>&lt;%= child.select :parent_id, options_for_select(Parent.all.map{ |parent| parent.grandparent.name + \" - \" + parent.name }, {:include_blank =&gt; true}) %&gt;\n</code></pre>\n\n<p>On the \"update\" action, I get the following error:</p>\n\n<pre><code>Cannot add or update a child row: a foreign key constraint fails (`database_name`.`childs`, CONSTRAINT `fk_part2_5` FOREIGN KEY (`parent_id`) REFERENCES `parents` (`id`))\n</code></pre>\n\n<p>Models look like so:</p>\n\n<pre><code>class Child &lt; ApplicationRecord\n  belongs_to :parent\nend\n\nclass Parent &lt; ApplicationRecord\n  has_many :childs, :dependent =&gt; :delete_all \nend\n\nclass GrandParent &lt; ApplicationRecord\n  has_many :parents, :dependent =&gt; :delete_all\nend\n</code></pre>\n"}, {"tags": ["ruby", "web-scraping", "nokogiri"], "comments": [{"owner": {"reputation": 263, "user_id": 5979872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEHWa.jpg?s=128&g=1", "display_name": "Adittya Verma", "link": "https://stackoverflow.com/users/5979872/adittya-verma"}, "edited": false, "score": 0, "creation_date": 1540406207, "post_id": 52975162, "comment_id": 92858246, "body": "Can you share your exact error ?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540407719, "post_id": 52975162, "comment_id": 92858951, "body": "What command are you entering to get the error?  Also please post full stack trace of your error.  I ran <code>College.college</code> and got no error.  Also you don&#39;t need <code>colleges = </code> or the 2 lines after it I don&#39;t think in <code>scrape_colleges</code> method."}, {"owner": {"reputation": 43, "user_id": 10553382, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156409336731273/picture?type=large", "display_name": "Daniel Thomas", "link": "https://stackoverflow.com/users/10553382/daniel-thomas"}, "edited": false, "score": 0, "creation_date": 1540487459, "post_id": 52975162, "comment_id": 92894412, "body": "Thanks for the feedback! So within my console I run my console by entering ./bin/console, and once inside console I am entering College.scrape_college_info to try to access my pry."}, {"owner": {"reputation": 43, "user_id": 10553382, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156409336731273/picture?type=large", "display_name": "Daniel Thomas", "link": "https://stackoverflow.com/users/10553382/daniel-thomas"}, "edited": false, "score": 0, "creation_date": 1540487617, "post_id": 52975162, "comment_id": 92894490, "body": "The exact error I am getting looks like this: [17:11:44] (master) illinois-colleges // \u2665 ./bin/console 2.3.1 :001 &gt; College.scrape_college_info(college) NameError: undefined local variable or method <code>college&#39; for main:Object         from (irb):1         from .&#47;bin&#47;console:14:in </code>&lt;main&gt;&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 263, "user_id": 5979872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AEHWa.jpg?s=128&g=1", "display_name": "Adittya Verma", "link": "https://stackoverflow.com/users/5979872/adittya-verma"}, "is_accepted": false, "score": 1, "last_activity_date": 1540408245, "creation_date": 1540408245, "answer_id": 52976341, "question_id": 52975162, "link": "https://stackoverflow.com/questions/52975162/adding-specific-url-to-base-path-in-order-to-scrape-webpage-using-nokogiri/52976341#52976341", "title": "Adding specific URL to BASE PATH in order to scrape webpage using Nokogiri", "body": "<p>Try below code to get <code>college.link</code>.</p>\n\n<pre><code>if doc.css(\"td\")[0] != nil\n   college.name = doc.css(\"td\")[0].text.strip\n   college.link = doc.css(\"td\")[0].css(\"a\").map{|a| a['href']}[0]\nend\n</code></pre>\n\n<p>Now you can pass college link like :</p>\n\n<pre><code>def self.scrape_college_info(college)\n  doc = Nokogiri::HTML(open(\"https://www.collegesimply.com\" + \"#{college.link}\"))\nend\n</code></pre>\n\n<p>Hope this will solve your problem. Please let me know, if it works for you.</p>\n"}, {"tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 0, "last_activity_date": 1540426611, "creation_date": 1540426611, "answer_id": 52979622, "question_id": 52975162, "link": "https://stackoverflow.com/questions/52975162/adding-specific-url-to-base-path-in-order-to-scrape-webpage-using-nokogiri/52979622#52979622", "title": "Adding specific URL to BASE PATH in order to scrape webpage using Nokogiri", "body": "<p>Try using <code>URI.join</code>:</p>\n\n<pre><code>new_url = URI.join(BASE_PATH, college.link).to_s\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10553382, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156409336731273/picture?type=large", "display_name": "Daniel Thomas", "link": "https://stackoverflow.com/users/10553382/daniel-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1540426611, "creation_date": 1540403320, "last_edit_date": 1540406215, "question_id": 52975162, "link": "https://stackoverflow.com/questions/52975162/adding-specific-url-to-base-path-in-order-to-scrape-webpage-using-nokogiri", "title": "Adding specific URL to BASE PATH in order to scrape webpage using Nokogiri", "body": "<p>I am new to ruby and this site so please bear with me! I have googled endlessly to no fruition.</p>\n\n<p>I am trying to pass in a <code>college</code> object to my class method <code>scrape_college_info</code> that I created in the previous class method <code>scrape_illinois_index_page</code>, so that I may scrape the next level of information for the specific college the user selects using Pry and Nokogiri. Unfortunately, I keep getting an argument error. </p>\n\n<p>I know it isn't the prettiest, but this is my code right now:</p>\n\n<pre><code>    class College\n  attr_accessor :name, :location, :size, :type, :url\n  BASE_PATH = \"https://www.collegesimply.com/colleges/illinois/\"\n\n  def self.college\n    self.scrape_colleges\n  end\n\n  def self.scrape_colleges\n    colleges = self.scrape_illinois_index_page\n\n    colleges\n  end\n\n  def self.scrape_illinois_index_page\n    doc = Nokogiri::HTML(open(BASE_PATH))\n\n    # binding.pry\n\n    colleges = []\n\n    doc.xpath(\"//tr\").each do |doc|\n      college = self.new\n      if doc.css(\"td\")[0] != nil\n        college.name = doc.css(\"td\")[0].text.strip\n      end\n\n      if doc.css(\"td\")[1] != nil\n        college.location = doc.css(\"td\")[1].text.strip\n      end\n\n      if doc.css('table.table tbody tr td:nth-child(1) a')[0] != nil\n        college.link = doc.css('table.table tbody tr td:nth-child(1) a')[0]['href']\n      end\n      colleges &lt;&lt; college\n    end\n    colleges\n  end\n\n  def self.scrape_college_info(college)\n    doc = Nokogiri::HTML(open(BASE_PATH + \"#{college.link}\"))\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "html-safe"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540405708, "post_id": 52974425, "comment_id": 92858009, "body": "maybe have a look at <a href=\"https://edgeapi.rubyonrails.org/classes/Rails/Railtie.html\" rel=\"nofollow noreferrer\">edgeapi.rubyonrails.org/classes/Rails/Railtie.html</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540410001, "post_id": 52974425, "comment_id": 92860037, "body": "Railties are actually something very different from what you want. Railties are the low level components that make up the rails framework stack. For example ActiveRecord and Mongoid are both railties. You can see a list of the railties in <code>&#47;config&#47;application.rb</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540410239, "post_id": 52974425, "comment_id": 92860143, "body": "Since the functionality (a chat server) you&#180;re describing is a part of the application and not the framework itself its not a railtie."}], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540413273, "post_id": 52976574, "comment_id": 92861492, "body": "Make sure you read the <a href=\"https://api.rubyonrails.org/classes/Rails/Engine.html\" rel=\"nofollow noreferrer\">API documentation for Rails::Engine</a> as well."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1540410432, "last_edit_date": 1540410432, "creation_date": 1540409254, "answer_id": 52976574, "question_id": 52974425, "link": "https://stackoverflow.com/questions/52974425/how-to-create-a-rails-specific-rubygem/52976574#52976574", "title": "How to create a Rails-specific Rubygem?", "body": "<blockquote>\n  <p>Engines can be considered miniature applications that provide\n  functionality to their host applications. A Rails application is\n  actually just a \"supercharged\" engine, with the Rails::Application\n  class inheriting a lot of its behavior from Rails::Engine.<br>\n  <a href=\"https://guides.rubyonrails.org/engines.html\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/engines.html</a></p>\n</blockquote>\n\n<p>An engine can contain models, controllers, routes, generators, middleware and any arbitrary code that you can mount in the host application. Engines are usually packaged as gems.</p>\n\n<p>Devise for example is a rails engine that provides authorization.</p>\n\n<p>Rails has a generator command for creating engines:</p>\n\n<pre><code>rails plugin new chatty --mountable\n</code></pre>\n\n<p>For this example lets call it chatty.</p>\n\n<p>Since an engine is mounted in a Rails application you have full access to the Rails stack (such as <code>.html_safe</code>). This also means that you test engines by mounting them in a dummy application.</p>\n\n<p>If you have packaged the application as a gem than you simply mount it in the host application by adding it to the Gemfile.</p>\n\n<p>To make your engine configurable you can follow the <a href=\"https://robots.thoughtbot.com/mygem-configure-block\" rel=\"nofollow noreferrer\">\"MyGem.configure pattern\"</a>:</p>\n\n<pre><code># lib/chatty.rb\nmodule Chatty\n  class &lt;&lt; self\n    attr_accessor :configuration\n  end\n\n  def self.configure\n    self.configuration ||= Configuration.new\n    yield(configuration)\n  end\n\n  class Configuration\n    attr_accessor :foo\n\n    def initialize\n      @foo = 'some_value'\n    end\n  end\nend\n</code></pre>\n\n<p>To create a user configuration file you use a <a href=\"https://guides.rubyonrails.org/generators.html\" rel=\"nofollow noreferrer\">generator</a>:</p>\n\n<pre><code># lib/generators/chatty/install/install_generator.rb\nmodule Chatty\n  class InstallGenerator &lt; Rails::Generators::Base\n    source_root File.expand_path('templates', __dir__)\n\n    desc \"Creates a Chatty initializer.\"\n\n    def copy_initializer\n      template 'chatty.rb', 'config/initializers/chatty.rb'\n    end\n  end\nend\n</code></pre>\n\n<p>And a code template:</p>\n\n<pre><code># /lib/generators/chatty/install/templates/chatty.rb\nChatty.configure do |config|\n  config.foo = \"bar\"\nend\n</code></pre>\n\n<p>You can now run <code>rails g chatty:install</code> and it will create the file in the host application.</p>\n"}], "owner": {"reputation": 4605, "user_id": 1067339, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/3479b6831ccaa6263ed5ca7dab3ba972?s=128&d=identicon&r=PG", "display_name": "Qqwy", "link": "https://stackoverflow.com/users/1067339/qqwy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1540422238, "creation_date": 1540400530, "last_edit_date": 1540422238, "question_id": 52974425, "link": "https://stackoverflow.com/questions/52974425/how-to-create-a-rails-specific-rubygem", "title": "How to create a Rails-specific Rubygem?", "body": "<p>We're building a Chat service, which people are able to use from within their code.</p>\n\n<p>Amongst the tools we're building, we've made a Ruby gem to allow people to quickly add a Chat window to their Ruby web-application.</p>\n\n<p>We'd like to create a Rails-specific wrapper, though, because currently the user has to manually call <code>.html_safe</code>.</p>\n\n<p>How is it possible to use these Rails-specific features from within a Ruby gem? I've heard this might be called 'Railsties' but I have not been able to find any comprehensive documentation about these, and how to use them.</p>\n\n<p>Specifically, we'd like to:</p>\n\n<ul>\n<li>Call <code>html_safe</code> on some string output so the user does not have to do this manually.</li>\n<li>Put some configuration settings in a file in <code>config/initializers/some_name.rb</code> rather than having to specify these inline.</li>\n<li>Potentially create a generator that the user can run to fill this initializer automatically.</li>\n</ul>\n\n<p>How can we use these features? Is there some other gem-dependency we can include in our gem to access these features?</p>\n"}, {"tags": ["ruby", "algorithm", "math", "matrix", "diagonal"], "comments": [{"owner": {"reputation": 1156, "user_id": 6636638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca4dc3546ba881a3958a66dbe89f449?s=128&d=identicon&r=PG&f=1", "display_name": "B. Cratty", "link": "https://stackoverflow.com/users/6636638/b-cratty"}, "edited": false, "score": 2, "creation_date": 1540400780, "post_id": 52974316, "comment_id": 92855408, "body": "Try taking whatever your matrix is and do <code>Matrix[].each(:diagonal).to_a</code>   Look at these links for a better understanding. If they help you out let me know and I will work with you on a soltuion  --<a href=\"https://github.com/ruby/matrix/blob/master/lib/matrix.rb\" rel=\"nofollow noreferrer\">Matrix.rb Implementation</a>    --<a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html#method-c-diagonal\" rel=\"nofollow noreferrer\">Ruby Matrix Methods&amp;Documentation</a>  --(<a href=\"https://stackoverflow.com/questions/36417799/getting-two-diagonals-of-a-matrix\" title=\"getting two diagonals of a matrix\">stackoverflow.com/questions/36417799/&hellip;</a>)"}, {"owner": {"reputation": 1156, "user_id": 6636638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca4dc3546ba881a3958a66dbe89f449?s=128&d=identicon&r=PG&f=1", "display_name": "B. Cratty", "link": "https://stackoverflow.com/users/6636638/b-cratty"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540808778, "post_id": 52974316, "comment_id": 92986140, "body": "@CarySwoveland does the current solution suffice?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540832511, "post_id": 52974316, "comment_id": 93000453, "body": "I assume <code>chess</code> is the given array, but <code>chess_size</code> and <code>tmp</code> are not defined. Incidentally, please ensure all example inputs are valid Ruby objects and have been assigned to a variable. Here you&#39;ve given a picture of the array, meaning that every reader who wants to run code has to convert it to an actual array (<code>[[1,2,3...</code>). Had it been an array we could have just cut and pasted. By assigning it to a variable (e.g. <code>arr = [[1, 2,....</code>) readers could refer to the array in code and comments by that variable without having to define it."}, {"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540916314, "post_id": 52974316, "comment_id": 93035627, "body": "@CarySwoveland Humbledore has provided a solution without creating a matrix. But he claims that it doesn&#39;t work for big test cases."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540415834, "post_id": 52974462, "comment_id": 92862578, "body": "I think you have a good approach but it would be helpful to readers if you would write out the method."}], "tags": [], "owner": {"reputation": 15105, "user_id": 3768871, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Wxgi0.jpg?s=128&g=1", "display_name": "OmG", "link": "https://stackoverflow.com/users/3768871/omg"}, "is_accepted": false, "score": 3, "last_activity_date": 1540400685, "creation_date": 1540400685, "answer_id": 52974462, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/52974462#52974462", "title": "How to get diagonal values from specific point?", "body": "<p>Generally to get the diagonal values from <code>i</code> and <code>j</code>, you can iterate over <code>i</code> and <code>j</code> at the same time up to one of them would be zero. Hence, the main diagonal is <code>(i-1, j-1), (i-2, j-2), ...</code> up to <code>i, j &gt;= 0</code> and <code>(i + 1, j + 1), (i +2, j + 2), ...</code> up to <code>i, j &lt;= n</code>. For the antidiagonal is <code>(i - 1, j + 1), (i - 2, j + 2), ...</code> up to <code>i &gt;= 0</code> and <code>j &lt;= n</code>, and <code>(i + 1, j-1), (i + 2, j - 2), ...</code> up to <code>i &lt;= n</code> and <code>j &gt;= 0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1540471412, "post_id": 52977962, "comment_id": 92884306, "body": "Wow, I&#39;m overwhelmed. I&#39;m gonna put you on hold for a while. I&#39;ve managed to make this problem work in O(n), using just one loop. But its still not perfect yet. Gonna let u know soon."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1540478188, "post_id": 52977962, "comment_id": 92889065, "body": "Have a close look at @OmG\u2019s O(n) solution. I would have given it had he/she not already done so. My answer is less efficient but may be of interest for other reasons."}, {"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1540484417, "post_id": 52977962, "comment_id": 92892852, "body": "Unfortunately, I can&#39;t make it work in O(n). It seems @Humbledore solution looks good."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1540922066, "last_edit_date": 1540922066, "creation_date": 1540415500, "answer_id": 52977962, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/52977962#52977962", "title": "How to get diagonal values from specific point?", "body": "<p>I've just learned from a comment posted by the OP that I've solved the wrong problem, despite the fact that the OP's question seems quite clear, especially the example, and is consistent with my interpretation. I will leave this solution to the following problem: \"Given an array <code>arr</code> such that <code>Matrix(*arr)</code> is an NxM matrix, and a matrix location <code>i,j</code>, return an array <code>[d,a]</code>, where elements <code>d</code> and <code>a</code> are elements on the diagonal and antidiagonal that pass through <code>[d,a]</code> but do not include  <code>[d,a]</code> and are each rotated so that row index of the first element is <code>i+1</code> if <code>i &lt; arr.size-1</code> and is <code>0</code> otherwise.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def diagonals(arr, row_idx, col_idx) \n  ncols = arr.first.size\n  sum_idx = row_idx+col_idx\n  diff_idx = row_idx-col_idx\n  a = Array.new(arr.size * arr.first.size) { |i| i.divmod(ncols) } -[[row_idx, col_idx]]\n  [a.select { |r,c| r-c == diff_idx }, a.select { |r,c| r+c == sum_idx }].\n    map do |b| b.sort_by { |r,_| [r &gt; row_idx ? 0:1 , r] }.\n      map { |r,c| arr[r][c] }\n    end\nend\n</code></pre>\n\n<p>All elements of the array <code>arr</code> must be equal in size but there is no requirement that <code>arr.size = arr.first.size</code>.</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>arr = [\n  [ 1,  2,  3,  4,  5,  6,  7,  8,  9,  10],\n  [11, 12, 13, 14, 15, 16, 17, 18, 19,  20],\n  [21, 22, 23, 24, 25, 26, 27, 28, 29,  30],\n  [31, 32, 33, 34, 35, 36, 37, 38, 39,  40],\n  [41, 42, 43, 44, 45, 46, 47, 48, 49,  50],\n  [51, 52, 53, 54, 55, 56, 57, 58, 59,  60],\n  [61, 62, 63, 64, 65, 66, 67, 68, 69,  70],\n  [71, 72, 73, 74, 75, 76, 77, 78, 79,  80],\n  [81, 82, 83, 84, 85, 86, 87, 88, 89,  90],\n  [91, 92, 93, 94, 95, 96, 97, 98, 99, 100]\n]\n\ndiagonals(arr, 4, 4)\n  #=&gt; [[56, 67, 78, 89, 100, 1, 12, 23, 34],\n  #    [54, 63, 72, 81, 9, 18, 27, 36]]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Suppose</p>\n\n<pre><code>arr = (1..16).each_slice(4).to_a\n  #=&gt; [[ 1,  2,  3,  4],\n  #    [ 5,  6,  7,  8],\n  #    [ 9, 10, 11, 12],\n  #    [13, 14, 15, 16]]\n\nrow_idx = 2\ncol_idx = 1\n</code></pre>\n\n<p>The steps are as follows.</p>\n\n<pre><code>a = Array.new(arr.size) { |i| Array.new(arr.first.size) { |j| [i,j] } }\n  #=&gt; [[[0, 0], [0, 1], [0, 2], [0, 3]],\n  #    [[1, 0], [1, 1], [1, 2], [1, 3]],\n  #    [[2, 0], [2, 1], [2, 2], [2, 3]],\n  #    [[3, 0], [3, 1], [3, 2], [3, 3]]]\nncols = arr.first.size\n  #=&gt; 4\nsum_idx = row_idx+col_idx\n  #=&gt; 3\ndiff_idx = row_idx-col_idx\n  #=&gt; 1\na = Array.new(arr.size * arr.first.size) { |i| i.divmod(ncols) } - [[row_idx, col_idx]]\n  #=&gt; [[0, 0], [0, 1], [0, 2], [0, 3], [1, 0], [1, 1], [1, 2], [1, 3],\n  #    [2, 0], [2, 2], [2, 3], [3, 0], [3, 1], [3, 2], [3, 3]]\n</code></pre>\n\n<p>Select and sort the locations <code>[r, c]</code> on the top-left to bottom-right diagonal that passes through <code>[row_idx, col_idx]</code>.</p>\n\n<pre><code>b = a.select { |r,c| r-c == diff_idx }\n  #=&gt; [[1, 0], [3, 2]]\nc = b.sort_by { |r,_| [r &gt; row_idx ? 0:1 , r] }\n  #=&gt; [[3, 2], [1, 0]]\n</code></pre>\n\n<p>Select and sort the locations <code>[r, c]</code> on the top-right bottom-left diagonal that passes through <code>[row_idx, col_idx]</code>.</p>\n\n<pre><code>d = a.select { |r,c| r+c == sum_idx }\n  #=&gt; [[0, 3], [1, 2], [3, 0]]\ne = d.sort_by { |r,c| [r &gt; row_idx ? 0:1 , r] }\n  #=&gt; [[3, 0], [0, 3], [1, 2]]\n[c, e].map { |f| f.map { |r,c| arr[r][c] }\n  #=&gt; [c, e].map { |f| f.map { |r,c| arr[r][c] } }\n  #=&gt; [[15, 5], [13, 4, 7]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 88, "user_id": 10518584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioGuKQZ7g80/AAAAAAAAAAI/AAAAAAAABh0/RykBEsf_w3c/photo.jpg?sz=128", "display_name": "Humbledore", "link": "https://stackoverflow.com/users/10518584/humbledore"}, "edited": false, "score": 0, "creation_date": 1540484096, "post_id": 52993800, "comment_id": 92892694, "body": "@Cary Swoveland Feedback would be appreciated :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540533738, "post_id": 52993800, "comment_id": 92908780, "body": "After seeing &#39;\u2659&#39;  I was intrigued by your code. Upon running it (v2.5.1), however, I got an exception: <code>TypeError (no implicit conversion of Symbol into Integer)</code>. A transcription error, I assume."}, {"owner": {"reputation": 88, "user_id": 10518584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioGuKQZ7g80/AAAAAAAAAAI/AAAAAAAABh0/RykBEsf_w3c/photo.jpg?sz=128", "display_name": "Humbledore", "link": "https://stackoverflow.com/users/10518584/humbledore"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540916589, "post_id": 52993800, "comment_id": 93035814, "body": "@CarySwoveland Please have a look at my new solution. Problem I&#39;m facing is that it currently wont work on big test cases"}], "tags": [], "owner": {"reputation": 88, "user_id": 10518584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioGuKQZ7g80/AAAAAAAAAAI/AAAAAAAABh0/RykBEsf_w3c/photo.jpg?sz=128", "display_name": "Humbledore", "link": "https://stackoverflow.com/users/10518584/humbledore"}, "is_accepted": false, "score": 1, "last_activity_date": 1540483890, "creation_date": 1540483890, "answer_id": 52993800, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/52993800#52993800", "title": "How to get diagonal values from specific point?", "body": "<p>I've applied the logic that @OmG provided. Not sure how efficient it would be.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def stackOverflow(matrixSize, *args)\n  pos, obstacles = *args\n  chess = (1..(matrixSize * matrixSize)).each_slice(matrixSize).to_a\n  obstacles.each do |l| chess[l[0]][l[1]] = '_' end\n  row, col = pos[:row] - 1, pos[:col] - 1\n  chess[row][col] = '\u2659'\n  directions = [[],[],[],[],[],[],[],[]]\n\n  (1...matrixSize).each do |l|\n    directions[0] &lt;&lt; chess[row + l][col + l] if (row + l) &lt; matrixSize &amp;&amp; (col + l) &lt; chess_size\n    directions[1] &lt;&lt; chess[row - l][col - l] if (row - l) &gt;= 0 &amp;&amp; (col - l) &gt;= 0\n    directions[2] &lt;&lt; chess[row + l][col - l] if (row + l) &lt; matrixSize &amp;&amp; (col - l) &gt;= 0\n    directions[3] &lt;&lt; chess[row - l][col + l] if (row - l) &gt;= 0 &amp;&amp; (col + l) &lt; matrixSize\n    directions[4] &lt;&lt; chess[row + l][col] if row + l &lt; matrixSize\n    directions[5] &lt;&lt; chess[row - l][col] if row - l &gt;= 0\n    directions[6] &lt;&lt; chess[row][col + l] if col + l &lt; matrixSize\n    directions[7] &lt;&lt; chess[row][col - l] if col - l &gt;= 0\n  end\nend\n\nstackOverflow(5, 3, {row: 4, col: 3}, [[4,4],[3,1],[1,2]] )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1540922099, "last_edit_date": 1540922099, "creation_date": 1540533293, "answer_id": 53002300, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/53002300#53002300", "title": "How to get diagonal values from specific point?", "body": "<p>I've just learned from a comment posted by the OP that I've solved the wrong problem, despite the fact that the OP's question seems quite clear, especially the example, and is consistent with my interpretation. I will leave this solution to the following problem: \"Given an array <code>arr</code> such that <code>Matrix(*arr)</code> is an NxM matrix, and a matrix location <code>i,j</code>, return an array <code>[d,a]</code>, where elements <code>d</code> and <code>a</code> are elements on the diagonal and antidiagonal that pass through <code>[d,a]</code> but do not include  <code>[d,a]</code> and are each rotated so that row index of the first element is <code>i+1</code> if <code>i &lt; arr.size-1</code> and is <code>0</code> otherwise.</p>\n\n<p>The following approach uses methods from the <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Matrix.html\" rel=\"nofollow noreferrer\">Matrix</a> class.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>require 'matrix'\n\ndef diagonals(arr, row_idx, col_idx)      \n  [diag(arr, row_idx, col_idx),\n   diag(arr.map(&amp;:reverse).transpose, arr.first.size-1-col_idx, row_idx)]\nend\n\ndef diag(arr, row_idx, col_idx)\n  nrows, ncols = arr.size, arr.first.size\n  lr = [ncols-col_idx, nrows-row_idx].min - 1\n  ul = [col_idx, row_idx].min\n  m = Matrix[*arr]\n  [*m.minor(row_idx+1,  lr, col_idx+1,  lr).each(:diagonal).to_a,\n   *m.minor(row_idx-ul, ul, col_idx-ul, ul).each(:diagonal).to_a]\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>arr = [\n  [ 1,  2,  3,  4,  5,  6,  7,  8,  9,  10],\n  [11, 12, 13, 14, 15, 16, 17, 18, 19,  20],\n  [21, 22, 23, 24, 25, 26, 27, 28, 29,  30],\n  [31, 32, 33, 34, 35, 36, 37, 38, 39,  40],\n  [41, 42, 43, 44, 45, 46, 47, 48, 49,  50],\n  [51, 52, 53, 54, 55, 56, 57, 58, 59,  60],\n  [61, 62, 63, 64, 65, 66, 67, 68, 69,  70],\n  [71, 72, 73, 74, 75, 76, 77, 78, 79,  80],\n  [81, 82, 83, 84, 85, 86, 87, 88, 89,  90],\n  [91, 92, 93, 94, 95, 96, 97, 98, 99, 100]\n]\n\ndiagonals arr, 4, 4\n  #=&gt; [[56, 67, 78, 89, 100, 1, 12, 23, 34], [54, 63, 72, 81, 9, 18, 27, 36]]\ndiagonals arr, 4, 5\n  #=&gt; [[57, 68, 79, 90, 2, 13, 24, 35], [55, 64, 73, 82, 91, 10, 19, 28, 37]]\ndiagonals arr, 0, 9\n  #=&gt; [[], [19, 28, 37, 46, 55, 64, 73, 82, 91]]\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>Suppose the array and target location were as follows.</p>\n\n<pre><code>arr = (1..30).each_slice(6).to_a\n  #=&gt; [[ 1,  2,  3,  4,  5,  6],\n  #    [ 7,  8,  9, 10, 11, 12],\n  #    [13, 14, 15, 16, 17, 18],\n  #    [19, 20, 21, 22, 23, 24],\n  #    [25, 26, 27, 28, 29, 30]]\n\nrow_idx = 2\ncol_idx = 3\n</code></pre>\n\n<p>Note <code>arr[2][3] #=&gt; 16</code>. We obtain the diagonal with negative slope by computing the diagonals of two matrix minors:</p>\n\n<pre><code>[[23, 24],\n [29, 30]]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[[2, 3],\n [8, 9]]\n</code></pre>\n\n<p>giving us</p>\n\n<pre><code>[*[23, 30], *[2, 9]]\n  #=&gt; [23, 30, 2, 9]\n</code></pre>\n\n<p>To obtain the other diagonal we rotate the array anti-clockwise 90 degrees, adjust <code>row_idx</code> and <code>col_idx</code> and repeat the above procedure.</p>\n\n<pre><code>arr.map(&amp;:reverse).transpose\n  #=&gt; [[6, 12, 18, 24, 30],\n  #    [5, 11, 17, 23, 29],\n  #    [4, 10, 16, 22, 28],\n  #    [3,  9, 15, 21, 27],\n  #    [2,  8, 14, 20, 26],\n  #    [1,  7, 13, 19, 25]]\n\nncols = arr.first.size\n  #=&gt; 6\nrow_idx, col_idx = ncols-1-col_idx, row_idx\n  #=&gt; [2, 2]\n</code></pre>\n\n<p>We now extract the diagonals from the matrix minors</p>\n\n<pre><code>[[21, 27],\n [20, 26]]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[[6, 12],\n [5, 11]]\n</code></pre>\n\n<p>to obtain the second diagonal:</p>\n\n<pre><code>[21, 26, 6, 11]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540919878, "post_id": 53068536, "comment_id": 93037661, "body": "Why do you think this is Hackerranks &quot;queens attack&quot; problem (other than use of the word &quot;queen&quot;)? For one, the statement of the question makes no reference to &quot;obstacles&quot;.  If, by &quot;timeout&quot;, you mean that your code takes too long to complete for a given (unknown) test case, I would think that&#39;s an algorithmic efficiency issue, not that you neglected to deal with a particular &quot;constraint&quot;. Incidentally, I think we are given the fact that no obstacles share the queen&#39;s location."}, {"owner": {"reputation": 88, "user_id": 10518584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioGuKQZ7g80/AAAAAAAAAAI/AAAAAAAABh0/RykBEsf_w3c/photo.jpg?sz=128", "display_name": "Humbledore", "link": "https://stackoverflow.com/users/10518584/humbledore"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540920479, "post_id": 53068536, "comment_id": 93037960, "body": "@CarySwoveland Because, I remember reading the problem earlier, and was surfing StackOverflow for some clues, and found that this question resembles the logic very much. And it seems Jamy is only asking questions from hackerrank (checked his backlog). I think your right. But my loop is only O(n) though. Isn&#39;t this efficient in enough?"}, {"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1540920760, "post_id": 53068536, "comment_id": 93038103, "body": "Ah, yh dude. Sorry about that. I&#39;m actually working on that problem. The solutions in hackerrank are quite complex. Needed some explanation."}], "tags": [], "owner": {"reputation": 88, "user_id": 10518584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ioGuKQZ7g80/AAAAAAAAAAI/AAAAAAAABh0/RykBEsf_w3c/photo.jpg?sz=128", "display_name": "Humbledore", "link": "https://stackoverflow.com/users/10518584/humbledore"}, "is_accepted": false, "score": 1, "last_activity_date": 1540916733, "last_edit_date": 1540916733, "creation_date": 1540915860, "answer_id": 53068536, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/53068536#53068536", "title": "How to get diagonal values from specific point?", "body": "<p>@CarySwoveland It seems @Jamy is working on another problem from hackerrank <a href=\"https://www.hackerrank.com/challenges/queens-attack-2/problem\" rel=\"nofollow noreferrer\"><strong><code>queens-attack</code></strong></a>. </p>\n\n<p>The problem is quite hard because the idea is to never create a matrix in the first place. That is, the test cases become very large, and thus the space complexity will be an issue.</p>\n\n<p>I've changed my implementation, yet still, fail because of timeout issue (this is because test cases become very large). I'm not sure how to make it performant.</p>\n\n<p>Before I show the code. Let me explain what I'm trying to do using illustration:</p>\n\n<p>This is our chess:</p>\n\n<pre><code>   ---------------------------\n |  1     2     3     4     5 |\n |  6     7     8     9    10 |\n | 11    12    13    14    15 |\n | 16    17    18    19    20 |\n | 21    22    23    24    25 |\n   ---------------------------\n</code></pre>\n\n<p>And this is where our queen is located: <code>queen[2][3]</code> </p>\n\n<pre><code>   ---------------------------\n |  1     2     3     4     5 |\n |  6     7     8     9    10 |\n | 11    12    13     \u2659    15 |\n | 16    17    18    19    20 |\n | 21    22    23    24    25 |\n   ---------------------------\n</code></pre>\n\n<p>The queen can attack all 8 directions. I.e:</p>\n\n<pre><code> horizontal(x2): \n   1. from queen position to left         : [13, 12, 11]\n   2. from queen position to right        : [15]\n\n vertical(x2):\n   1. from queen position to top          : [9, 4]\n   2. from queen position to bottom       : [19, 24]\n\n diagonal(x2):\n   1. from queen position to bottom-right : [20]\n   2. from queen position to top-left     : [8, 2]\n\n diagonal(x2):\n   1. from queen position to bottom-left  : [18, 22]\n   2. from queen position to top-right    : [10]\n</code></pre>\n\n<p>Because there are no obstacles within those 8 paths, the queen can attack a total of 14 attacks.</p>\n\n<p>Say we have some obstacles:</p>\n\n<pre><code>   ---------------------------\n |  1     2     3     4     5 |\n |  6     7     x     9    10 |\n | 11     x    13     \u2659    15 |\n | 16    17    18    19     x |\n | 21     x    23     x    25 |\n   ---------------------------\n</code></pre>\n\n<p>Now the queen can attack a total of 7 attacks: <code>[13, 18, 19, 15, 10, 9, 4]</code></p>\n\n<h1>Code</h1>\n\n<pre><code>MAXI = 10 ** 5\n\ndef queens_attack(size, number_of_obstacles, queen_pos, obstacles)\n  # exit the function if...\n\n  # size is negative or more than MAXI. Note MAXI has constraint shown in hackerrank\n  return if size &lt; 0 || size &gt; MAXI\n\n  # the obstacles is negative or more than the MAXI\n  return if number_of_obstacles &lt; 0 || number_of_obstacles &gt; MAXI\n\n  # the queen's position is outside of our chess dimension\n  return if queen_pos[:row] &lt; 1 || queen_pos[:row] &gt; size\n  return if queen_pos[:col] &lt; 1 || queen_pos[:col] &gt; size\n\n  # the queen's pos is the same as one of the obstacles\n  return if [[queen_pos[:row], queen_pos[:col]]] - obstacles == []\n\n  row, col = queen_pos[:row], queen_pos[:col]\n\n  # variable to increment how many places the queen can attack\n  attacks = 0\n\n  # the queen can attack on all directions:\n  # horizontals, verticals and both diagonals. So let us create pointers\n  # for each direction. Once the obstacle exists in the path, make the \n  # pointer[i] set to true\n  pointers = Array.new(8, false)\n  (1..size).lazy.each do |i|\n\n    # this is the diagonal from queen's pos to bottom-right\n    if row + i &lt;= size &amp;&amp; col + i &lt;= size &amp;&amp; !pointers[0]\n      # set it to true if there is no obstacle in the current [row + i, col + i]\n      pointers[0] = true unless [[row + i, col + i]] - obstacles != []\n      # now we know the queen can attack this pos\n      attacks += 1 unless pointers[0]\n    end\n\n    # this is diagonal from queen's pos to top-left\n    if row - i &gt; 0 &amp;&amp; col - i &gt; 0 &amp;&amp; !pointers[1]\n      # set it to true if there is no obstacle in the current [row - i, col - i]\n      pointers[1] = true unless [[row - i, col - i]] - obstacles != []\n      # now we know the queen can attack this pos\n      attacks += 1 unless pointers[1]\n    end\n\n    # this is diagonal from queen's pos to bottom-left\n    if row + i &lt;= size &amp;&amp; col - i &gt; 0 &amp;&amp; !pointers[2]\n      pointers[2] = true unless [[row + i, col - i]] - obstacles != []\n      attacks += 1 unless pointers[2]\n    end\n\n    # this is diagonal from queen's pos to top-right\n    if row - i &gt; 0 &amp;&amp; col + i &lt;= size &amp;&amp; !pointers[3]\n      pointers[3] = true unless [[row - i, col + i]] - obstacles != []\n      attacks += 1 unless pointers[3]\n    end\n\n    # this is verticle from queen's pos to bottom\n    if row + i &lt;=size &amp;&amp; !pointers[4]\n      pointers[4] = true unless [[row + i, col]] - obstacles != []\n      attacks += 1 unless pointers[4]\n    end\n\n    # this is verticle from queen's pos to top\n    if row - i &gt; 0 &amp;&amp; !pointers[5]\n      pointers[5] = true unless [[row - i, col]] - obstacles != []\n      attacks += 1 unless pointers[5]\n    end\n\n    # this is horizontal from queen's pos to right\n    if col + i &lt;= size &amp;&amp; !pointers[6]\n      pointers[6] = true unless [[row, col + i]] - obstacles != []\n      attacks += 1 unless pointers[6]\n    end\n\n    # this is horizontal from queen's pos to left\n    if col - i &gt; 0 &amp;&amp; !pointers[7]\n      pointers[7] = true unless [[row, col - i]] - obstacles != []\n      attacks += 1 unless pointers[7]\n    end\n  end\n  p attacks\nend\n</code></pre>\n\n<h1>Problem</h1>\n\n<p>Now the problem is, I don't know why my code is doing a timeout error from hackerrank. I do know it because of the test case, where the dimension of chess can be 10,000 X 10,000. But dont know what constraint I'm missing.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "edited": false, "score": 0, "creation_date": 1540980401, "post_id": 53079252, "comment_id": 93058753, "body": "That&#39;s exactly what I was looking for. Thank you, Cary. Always there to help!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1540984097, "last_edit_date": 1540984097, "creation_date": 1540974914, "answer_id": 53079252, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point/53079252#53079252", "title": "How to get diagonal values from specific point?", "body": "<p>This is a solution to the Hackerrank <a href=\"https://www.hackerrank.com/challenges/queens-attack-2/problem\" rel=\"nofollow noreferrer\">Queen's attack</a> problem.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def count_moves(n, obs, qrow, qcol)\n  qdiff = qrow-qcol\n  qsum =  qrow+qcol  \n  l = u = -1\n  r = d =  n\n  ul = qdiff &gt;= 0 ? qrow-qcol-1 : -1\n  dr = qdiff &gt;= 0 ? n           : qrow+n-qcol\n  ur = qsum &lt; n   ? -1          : qrow-n+qcol\n  dl = qsum &lt; n   ? qrow+qcol+1 : n\n  obs.uniq.each do |i,j|\n    case i &lt;=&gt; qrow\n    when -1               # up\n      case j &lt;=&gt; qcol\n      when -1               # up-left\n        ul = [ul,i].max\n      when 0                # up same col\n        u  = [u,i].max\n      when 1                # up-right\n        ur = [ur,i].max\n      end\n    when 0                # same row\n      j &lt; qcol ? (l = [l,j].max) : r = [r,j].min\n    else                  # down\n      case j &lt;=&gt; qcol\n      when -1               # down-left\n        dl = [dl,i].min\n      when 0                # down same col\n        d  = [d,i].min\n      when 1                # down-right\n        dr = [dr,i].min\n      end\n    end\n  end\n  r + dl + d + dr - l - ul -u - ur - 8\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Suppose the chess board has <code>9</code> rows and columns, with the queen's location shown by the character <code>q</code> and each obstruction shown with the letter <code>o</code>. All other locations are represented by the letter <code>x</code>. We see that the queen has <code>16</code> possible moves (<code>7</code> up and down, <code>6</code> left and right, <code>1</code> on the up-left to down-right diagonal and <code>2</code> on the up-right to down-left diagonal.</p>\n\n<pre><code>arr = [\n  %w| x x x x x x x x x |, # 0\n  %w| o x x x x x x x x |, # 1\n  %w| x o x x x x x x x |, # 2\n  %w| x x o x x x x x o |, # 3\n  %w| x x x o x x x x x |, # 4\n  %w| x x x x x x o x x |, # 5\n  %w| o o x x x q x x x |, # 6\n  %w| x x x x x x o x x |, # 7\n  %w| x x x x x o x x x |  # 8\n#     0 1 2 3 4 5 6 7 8   \n]\n\nqrow = qcol = nil\nobs = []\nn = arr.size\narr.each_with_index do |a,i|\n  a.each_with_index do |c,j|\n    case c\n    when 'o'\n      obs &lt;&lt; [i,j]\n    when 'q'\n      qrow=i\n      qcol=j\n    end\n  end\nend\n</code></pre>\n\n<p></p>\n\n<pre><code>qrow\n  #=&gt; 6\nqcol\n  #=&gt; 5\nobs\n  #=&gt; [[1, 0], [2, 1], [3, 2], [3, 8], [4, 3], [5, 6], [6, 0], [6, 1], [7, 6], [8, 5]]\n\ncount_moves(n, obs, qrow, qcol)\n  #=&gt; 16\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<ul>\n<li><code>l</code> is the largest column index of an obstruction in the queen's row that is less than the queen's column index;</li>\n<li><code>r</code> is the smalles column index of an obstruction in the queens that is greater than the queen's column index;</li>\n<li><code>u</code> is the largest largest row index of an obstruction in the queen's column that is less than the queen's row index;</li>\n<li><code>d</code> is the smallest row index of an obstruction in the queen's column that is greater than the queen's row index;</li>\n<li><code>ul</code> is the greatest row index of an obstruction on the queen's top-left to bottom-right diagonal that is less than the queen's row index;</li>\n<li><code>dr</code> is the smallest row index of an obstruction on the queen's top-left to bottom-right diagonal that is greater than the queen's row index;</li>\n<li><code>ur</code> is the greatest row index of an obstruction on the queen's top-right to bottom-left diagonal that is less than the queen's row index; and</li>\n<li><code>dl</code> is the smallest row index of an obstruction on the queen's top-right to bottom-left diagonal that is greater than the queen's row index.</li>\n</ul>\n\n<p>For the example above, before obstructions are taken into account, these variables are set to the following values.</p>\n\n<pre><code>l  =  0\nr  =  9\nul =  0 \nu  = -1\nur =  2\ndl =  9\nd  =  9\ndr =  9\n</code></pre>\n\n<p>Note that if the queen has row and column indices <code>qrow</code> and <code>qcol</code>,</p>\n\n<ul>\n<li><code>i - j = qrow - qcol</code> for all locations <code>[i, j]</code> on the queen's top-left to bottom- right diagonal; and</li>\n<li><code>i + j = grow + gcol</code> for all locations <code>[i, j]</code> on the queen's top-right to bottom- left diagonal</li>\n</ul>\n\n<p>We then loop through all (unique) obstructions, determining, for each, whether it is in the queen's row, queen's column, or one of the queen's diagonals and then replaces the value of the applicable variable with it's row or column index if it is \"closer\" to the queen than the previously-closest location.</p>\n\n<p>If, for example, the obstruction is in the queen's row and its column index <code>j</code> is less than the queen's column index, the following calculation is made:</p>\n\n<pre><code>l = [l, j].max\n</code></pre>\n\n<p>Similarly, if the obstruction is on the queen's top-left to bottom-right diagonal and its row index <code>i</code> is less than the queen's row index, the calculation would be:</p>\n\n<pre><code>ul = [ul, i].max\n</code></pre>\n\n<p>After all obstructions from the above example have been considered the variables have the following values.</p>\n\n<pre><code>l  #=&gt;  1\nr  #=&gt;  9\nul #=&gt;  4\nu  #=&gt; -1\nur #=&gt;  5\ndl #=&gt;  9\nd  #=&gt;  8\ndr #=&gt;  7\n</code></pre>\n\n<p>Lastly, we compute the total number of squares to which the queen may move.</p>\n\n<pre><code>qcol - l  - 1 +  # left\nr - qcol  - 1 +  # right\nu - qrow  - 1 +  # up\ngrow - d  - 1 +  # down\nul - qrow - 1 +  # up-left\nur - qrow - 1 +  # up-right\nqrow - dl - 1 +  # down-left\nqrow - dr - 1    # down-right\n</code></pre>\n\n<p>which simplifies to</p>\n\n<pre><code>r + dl + d + dr - l - ul -u - ur - 8\n  #=&gt; 9 + 9 + 8 + 7 - 1 - 4 + 1 - 5 - 8 =&gt; 16\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 10533236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f696c3e283dde269dfb45b3747823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jamy", "link": "https://stackoverflow.com/users/10533236/jamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 53079252, "answer_count": 6, "score": 2, "last_activity_date": 1540984097, "creation_date": 1540400069, "last_edit_date": 1540407372, "question_id": 52974316, "link": "https://stackoverflow.com/questions/52974316/how-to-get-diagonal-values-from-specific-point", "title": "How to get diagonal values from specific point?", "body": "<p>Suppose I have 10x10 matrix with the following data:</p>\n\n<pre><code> 1     2     3     4     5     6     7     8     9    10 \n11    12    13    14    15    16    17    18    19    20 \n21    22    23    24    25    26    27    28    29    30 \n31    32    33    34    35    36    37    38    39    40 \n41    42    43    44     _    46    47    48    49    50 \n51    52    53    54    55    56    57    58    59    60 \n61    62    63    64    65    66    67    68    69    70 \n71    72    73    74    75    76    77    78    79    80 \n81    82    83    84    85    86    87    88    89    90 \n91    92    93    94    95    96    97    98    99   100\n</code></pre>\n\n<p>My position is in <code>[4][4]</code>. How can I list the diagonal values from this position?</p>\n\n<p>For example, the expected outcome would be:</p>\n\n<pre><code>[56, 67, 78, 89, 100, 1, 12, 23, 34]\n[54, 63, 72, 81, 9, 18, 27, 36]\n</code></pre>\n\n<h1>My current solution</h1>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def next?(index, row, size)\n    (((row + index) % size) + 1 ) % size\n  end\n\n  (1...chess_size).each do |l|\n    next_el, curr_el = next?(l, row, chess_size), (row + l) % chess_size\n\n    # this gets me the first diagnonal. Note that it prints out wrong value\n    tmp[0] &lt;&lt; chess[curr_el][curr_el]\n\n    # this gets me the values from current row below to up\n    tmp[1] &lt;&lt; chess[(row + l) % chess_size][row]\n    tmp[2] &lt;&lt; chess[-l][l]\n    tmp[3] &lt;&lt; chess[row][(row + l) % chess_size]\n  end\n</code></pre>\n\n<p>Our matrix will always have the same number of rows and columns.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1540399108, "post_id": 52973990, "comment_id": 92854475, "body": "I am sorry your question is unclear to me. What is the input (<code>data</code>?), how does <code>attrs</code> look like? Do you want to update all translations with the <code>attrs</code>? How does the expected output look like?"}, {"owner": {"reputation": 1, "user_id": 10553259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da01c859cbcc50581e8eb6eb60a22fa8?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/10553259/jojo"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1540399444, "post_id": 52973990, "comment_id": 92854678, "body": "@spickermann quiz upd"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1540401409, "post_id": 52973990, "comment_id": 92855711, "body": "But each iteration would override the update done in the iteration before, because the hashes have the same key. Therefore only the last hash will win."}, {"owner": {"reputation": 1, "user_id": 10553259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da01c859cbcc50581e8eb6eb60a22fa8?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/10553259/jojo"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1540401582, "post_id": 52973990, "comment_id": 92855786, "body": "so how to do it ?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1540401846, "post_id": 52973990, "comment_id": 92855932, "body": "What is a translation? Does it have an attribute that is able to store an array of hashes?"}, {"owner": {"reputation": 1480, "user_id": 4741620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/13911648aa5b99a6542494b4c8fcbc38?s=128&d=identicon&r=PG&f=1", "display_name": "jedi", "link": "https://stackoverflow.com/users/4741620/jedi"}, "edited": false, "score": 0, "creation_date": 1540407812, "post_id": 52973990, "comment_id": 92858990, "body": "If client <code>has_many :translations</code> then you probably want to do <code>data.each{ |attrs| client.translations.each {|tr| tr.update(attrs)}}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3385, "user_id": 727067, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/72c0013456102840830eb2059a23dbe5?s=128&d=identicon&r=PG", "display_name": "Manish Das", "link": "https://stackoverflow.com/users/727067/manish-das"}, "is_accepted": false, "score": 1, "last_activity_date": 1540413410, "last_edit_date": 1540413410, "creation_date": 1540412227, "answer_id": 52977332, "question_id": 52973990, "link": "https://stackoverflow.com/questions/52973990/rails-update-associations/52977332#52977332", "title": "Rails update associations", "body": "<p>I think you want to find or initialize by locale of each translation and then update them.</p>\n\n<pre><code>data.each do |attrs|\n  translation = client.translations.find_or_initialize_by(locale: attrs[:locale])\n\n  # it's a good practice to not do mass assignment, if you are not permitting params. \n  translation.name = attrs[:name]\n  translation.image_source_url = attrs[:image_source_url]\n  translation.save\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10553259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da01c859cbcc50581e8eb6eb60a22fa8?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/10553259/jojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1540413410, "creation_date": 1540398828, "last_edit_date": 1540399305, "question_id": 52973990, "link": "https://stackoverflow.com/questions/52973990/rails-update-associations", "title": "Rails update associations", "body": "<p>I want to update association inside loop</p>\n\n<p>need to update each translation with hash attrs</p>\n\n<pre><code>  data =&gt; \n[{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:en},\n{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:\"en-CA\"}, \n{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:\"en-US\"}, \n{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:fr}, \n{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:\"fr-CA\"}, \n{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:es}]\n</code></pre>\n\n<p>So i have tried </p>\n\n<pre><code>client = Client.find(2)\n#Client has columns =&gt; {:name :image_source_url :locale}    \n\ndata.each do |attrs|\n client.translations.update(attrs)\nend\n</code></pre>\n\n<p>but it have updated me only with last locale which is <code>es</code> </p>\n\n<p>i want to update every <code>client=&gt;translation</code></p>\n\n<p>with every field of data \nwhich is <code>{:name=&gt;\"string\", :image_source_url=&gt;\"string\", :locale=&gt;:es}</code></p>\n\n<p>how to do it as i want?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1540398599, "post_id": 52973823, "comment_id": 92854205, "body": "There&#39;s no idiomatic way of doing this, because it&#39;s not a very good idea. You&#39;re producing a function that is difficult to implement, difficult to consume, and difficult to test, for no real benefit. What if somebody invokes <code>dummy_func(1, 2, a: 3, b: 4)</code>? You should have exactly one way of specifying each argument, not two."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1540399121, "post_id": 52973823, "comment_id": 92854486, "body": "In Ruby <code>f(a=1, b=2)</code> does not pass in arguments named <code>a</code> and <code>b</code> like in Python. It assigns values to variables named <code>a</code> and <code>b</code> while passing those arguments in as if <code>f(1,2)</code>. The keyword argument notation is <code>f(a: 1, b: 2)</code>. What&#39;s the purpose of this wrapper function? It seems like it&#39;s going to create a whole lot of ambiguity without providing any real benefits."}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1540398432, "creation_date": 1540398432, "answer_id": 52973870, "question_id": 52973823, "link": "https://stackoverflow.com/questions/52973823/ruby-passing-arbitrary-function-and-parameters-into-another-function/52973870#52973870", "title": "Ruby passing arbitrary function and parameters into another function", "body": "<p>The closest you can get is keyword arguments:</p>\n\n<p><a href=\"https://www.justinweiss.com/articles/fun-with-keyword-arguments/\" rel=\"nofollow noreferrer\">https://www.justinweiss.com/articles/fun-with-keyword-arguments/</a></p>\n\n<pre><code>def hello_message(greeting, time_of_day, first_name:, last_name:)\n  \"#{greeting} #{time_of_day}, #{first_name} #{last_name}!\"\nend\n\nargs = [\"Morning\"]\nkeyword_args = {last_name: \"Weiss\"}\n\nhello_message(\"Good\", *args, first_name: \"Justin\", **keyword_args)\n=&gt; \"Good Morning, Justin Weiss!\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1612216918, "last_edit_date": 1612216918, "creation_date": 1540398748, "answer_id": 52973964, "question_id": 52973823, "link": "https://stackoverflow.com/questions/52973823/ruby-passing-arbitrary-function-and-parameters-into-another-function/52973964#52973964", "title": "Ruby passing arbitrary function and parameters into another function", "body": "<p>The idiomatic way is to instead <a href=\"https://stackoverflow.com/questions/3066703/blocks-and-yields-in-ruby#3066939\">yield to a block</a>.</p>\n<pre><code>def dummy_func(a, b, key:)\n   return a+b+key\nend\n\ndef wrapper\n  puts yield\nend\n\na = 4\nb = 5\nc = 6\nwrapper do\n  dummy_func(a ,b, key: c)\nend\n</code></pre>\n<p>Since the block is closure it can see all the same variables that the call to <code>wrapper</code> can. Now there's no need to pass wrapper's arguments through.</p>\n<hr />\n<p>If you really want to make your wrapper, you can do <a href=\"https://ruby-doc.org/core/Method.html#method-i-parameters\" rel=\"nofollow noreferrer\">some introspection to determine what arguments the wrapped function takes</a>.</p>\n<pre><code>def dummy_func(a, b=23, key: 42)\n   return a+b+key\nend\n\ndef no_keys(a, b=23)\n   return a+b\nend\n\ndef wrapper(func, *array, **hash)\n  method = self.method(func)\n  takes_array = method.parameters.any? { |p| [:req, :opt, :rest].include?(p[0]) }\n  takes_hash = method.parameters.any? { |p| [:keyreq, :key, :keyrest].include?(p[0]) }\n  \n  if takes_array &amp;&amp; takes_hash\n    self.send(func, *array, **hash)\n  elsif takes_array\n    self.send(func, *array)\n  elsif takes_hash\n    self.send(func, **hash)\n  else\n    self.send(func)\n  end\nend\n\na = 4\nb = 5\nc = 6\nputs wrapper(:dummy_func, a, b, key:c)\nputs wrapper(:no_keys, a, b)\n</code></pre>\n<p>But this is quite a bit more complex and less flexible than yielding to a block. This also limits you to &quot;functions&quot; which are really <a href=\"https://stackoverflow.com/questions/917811/what-is-main-in-ruby#917842\">methods on the main object</a> (there are no function references in Ruby). That's why they're called with <code>self.send</code>. Blocks require no assumptions about what is being wrapped.</p>\n"}], "owner": {"reputation": 335, "user_id": 5201059, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1af44edcfddf932a153aa4df0b484ec2?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/5201059/jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 52973964, "answer_count": 2, "score": 0, "last_activity_date": 1612216918, "creation_date": 1540398224, "question_id": 52973823, "link": "https://stackoverflow.com/questions/52973823/ruby-passing-arbitrary-function-and-parameters-into-another-function", "title": "Ruby passing arbitrary function and parameters into another function", "body": "<p>I'm trying to learn Ruby.  I want to pass an arbitrary function and an arbitrary list of arguments and keyword arguments into another function.  </p>\n\n<p>for example, I have this arbitrary function below</p>\n\n<pre><code>def dummy_func(a, b)\n   return a+b\nend\n</code></pre>\n\n<p>And I have this wrapper function</p>\n\n<pre><code>def wrapper(func, *args, **kwargs)\n    func(args, kwargs))\nend\n</code></pre>\n\n<p>I want it so I can pass my arguments in any of the following ways and still return the correct answer</p>\n\n<pre><code>wrapper(dummy_func, a=1, b=2)\nwrapper(dummy_func, 1, b=2)\nwrapper(dummy_func, a=1, b=2)\nwrapper(dummy_func, 1, 2)\n</code></pre>\n\n<p>Is this possible in Ruby?  What would be an idiomatic way of approaching it? </p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "templates", "bootstrap-sass"], "comments": [{"owner": {"reputation": 289, "user_id": 3176899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBH2Q.jpg?s=128&g=1", "display_name": "Jijo Bose", "link": "https://stackoverflow.com/users/3176899/jijo-bose"}, "edited": false, "score": 0, "creation_date": 1540393915, "post_id": 52972316, "comment_id": 92851227, "body": "In case if you&#39;re using rails 5+ , you might need to install <code>gem &#39;jquery-rails&#39; </code>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1540394799, "post_id": 52972316, "comment_id": 92851834, "body": "Do you have the <code>sassc-rails</code> gem (or <code>sass-rails</code>) in your Gemfile?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540394989, "post_id": 52972316, "comment_id": 92851969, "body": "Also make sure that you have removed all the sprockets directives from your stylesheets. They are those strange comments that look like <code>&#47;&#47;*= require_tree .</code>  You need to replace them with SASS <code>@import</code> directives instead."}, {"owner": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "edited": false, "score": 0, "creation_date": 1540395286, "post_id": 52972316, "comment_id": 92852145, "body": "i have got all of these gems and require_tree and @import all files too :("}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "edited": false, "score": 0, "creation_date": 1540394973, "post_id": 52972759, "comment_id": 92851958, "body": "i tried to import styles about 1 milion different way and still have got this errors :("}, {"owner": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "edited": false, "score": 0, "creation_date": 1540395026, "post_id": 52972759, "comment_id": 92851992, "body": "this is a first time than i have got this problems with template :("}, {"owner": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "edited": false, "score": 0, "creation_date": 1540395108, "post_id": 52972759, "comment_id": 92852052, "body": "i tried to create a new project and only import this theme too and same problem"}, {"owner": {"reputation": 670, "user_id": 7753036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xzanDakZBsU/AAAAAAAAAAI/AAAAAAAAAE0/t7hgUGyGIc0/photo.jpg?sz=128", "display_name": "mkrl", "link": "https://stackoverflow.com/users/7753036/mkrl"}, "reply_to_user": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "edited": false, "score": 0, "creation_date": 1540395809, "post_id": 52972759, "comment_id": 92852482, "body": "Can you provide an exact error text that&#39;s being thrown? If it still is &quot;undefiled variable&quot;, double check your imports and make sure you are importing variables before the rest of the styles."}], "tags": [], "owner": {"reputation": 670, "user_id": 7753036, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xzanDakZBsU/AAAAAAAAAAI/AAAAAAAAAE0/t7hgUGyGIc0/photo.jpg?sz=128", "display_name": "mkrl", "link": "https://stackoverflow.com/users/7753036/mkrl"}, "is_accepted": true, "score": 0, "last_activity_date": 1540394844, "creation_date": 1540394844, "answer_id": 52972759, "question_id": 52972316, "link": "https://stackoverflow.com/questions/52972316/problem-with-import-bootstrap-theme-to-ruby-on-rails-app/52972759#52972759", "title": "problem with import bootstrap theme to ruby on rails app", "body": "<p>Porting a template into your Rails application is not hard if you break it down into several imprortant steps:</p>\n\n<ul>\n<li>Import styles. From what I can see, your template is using sass along with plain css style files. You can pick one of those and copy the files into your /app/assets/stylesheets folder and importing them in your <code>application.sass</code>. The <code>Undefined variable: \"$border-color\".</code> points you towards missing variables.scss, which contains all the color variables for your  template.</li>\n<li>See if your template is using any third-party libraries or frameworks. In this particular example, there is a list of them in the repo's \"Built With\" section of the readme. Go through every single one of them and find gem versions of those libraries and add them to your Gemfile.</li>\n<li>Copy non third-party Javascript files into your app/assets/javascripts. Require them in <code>pagedown.coffee.erb</code> along with third-party modules. Be sure to keep non third-party code below other modules to preserve functionality of code that relies on those modules.</li>\n<li>Trim HTML templates into views. Figure out what part of your layout should be preserved for every page and put it into your layout view, break down the rest into controller-specific views.</li>\n</ul>\n\n<p>There can be a lot of problems, but in general, just try to analyze the errors being thrown and solve them one by one.</p>\n"}], "owner": {"reputation": 1, "user_id": 10381094, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IfAJGSwuxcI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMATJEfcHLwh2SI8YbYI_5l5WO2QQ/mo/photo.jpg?sz=128", "display_name": "Mark&#233;ta", "link": "https://stackoverflow.com/users/10381094/mark%c3%a9ta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 52972759, "answer_count": 1, "score": 0, "last_activity_date": 1540409537, "creation_date": 1540393520, "last_edit_date": 1540409537, "question_id": 52972316, "link": "https://stackoverflow.com/questions/52972316/problem-with-import-bootstrap-theme-to-ruby-on-rails-app", "title": "problem with import bootstrap theme to ruby on rails app", "body": "<p>I can't seem to import this bootstrap theme to my rails application. </p>\n\n<p><a href=\"https://github.com/puikinsh/sufee-admin-dashboard\" rel=\"nofollow noreferrer\">https://github.com/puikinsh/sufee-admin-dashboard</a></p>\n\n<p>I am trying to import this template for two days but no luck. It could be easy, but I don\u00b4t know what I\u00b4m doing wrong :( </p>\n\n<p>I receive this error:</p>\n\n<pre><code>Undefined variable: \"$border-color\".\nUndefined mixin ....\n</code></pre>\n\n<p>So I have got a problem with variables and mixins at the first time. I tried another template and it works, so I really don\u00b4t know what to try next. </p>\n\n<p>Any hint or idea about how to solve this problem would be really appreciated.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540395327, "post_id": 52971633, "comment_id": 92852174, "body": "I just tested your code snippet, it seems to be stuck in an infinite loop (which is probably why it&#39;s failing on Codewars)  I just added <code>p primeFactors(8)</code> at the end, and the program gets stuck for ever in the <code>while</code> loop"}], "answers": [{"tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": true, "score": 2, "last_activity_date": 1540394284, "creation_date": 1540394284, "answer_id": 52972591, "question_id": 52971633, "link": "https://stackoverflow.com/questions/52971633/generate-prime-numbers-in-ruby-codewars-kata-primes-in-numbers/52972591#52972591", "title": "Generate prime numbers in Ruby (Codewars kata: Primes in numbers)", "body": "<p>Well for starters you really only need to test to Math.sqrt(n).to_i + 1 that should help for larger n values. </p>\n\n<p>This is because if a factor exists where n = a * b then either</p>\n\n<p>If a == b == sqrt(n) # Basically the defn of sqrt</p>\n\n<p>or</p>\n\n<p>If a != b; a &lt; sqrt(n); b > sqrt(n)</p>\n\n<p>If both a and b are less than sqrt(n) then a * b &lt; n\nand\nIf both a and b are greater than sqrt(n) the a * b > n</p>\n\n<p>Secondly, and this is more complex, you only need to test prime numbers to that limit. I could envision a scheme where primes are cached. </p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1540396774, "post_id": 52973326, "comment_id": 92853129, "body": "some people are just too nice"}], "tags": [], "owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "is_accepted": false, "score": 2, "last_activity_date": 1540396606, "creation_date": 1540396606, "answer_id": 52973326, "question_id": 52971633, "link": "https://stackoverflow.com/questions/52971633/generate-prime-numbers-in-ruby-codewars-kata-primes-in-numbers/52973326#52973326", "title": "Generate prime numbers in Ruby (Codewars kata: Primes in numbers)", "body": "<p>The more advanced option might look like this:</p>\n\n<pre><code># Is this number a prime?\n\nmodule PrimeChecker\n\n  @prime_cache = [2,3]\n\n  def self.prime?(n)\n    search_limit = Math.sqrt(n).to_i + 1\n    last_cache = @prime_cache[-1]\n\n    while last_cache &lt; search_limit do\n      last_cache += 2\n      @prime_cache &lt;&lt; last_cache if PrimeChecker.prime?(last_cache)\n    end\n\n    @prime_cache.each do |pn|\n      return true if pn &gt; search_limit\n      return false if (n % pn) == 0\n    end\n\n    true\n  end\n\nend\n\n# Sample run\n#\n# 31 mysh&gt;%=PrimeChecker.prime?(1_000_000_000_000)\n# false\n# Elapsed execution time = 1.592 seconds.\n#\n</code></pre>\n\n<p>This running on an elderly machine with a slow CORE 2 Duo processor.</p>\n"}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 52972591, "answer_count": 2, "score": 1, "last_activity_date": 1540396606, "creation_date": 1540391580, "question_id": 52971633, "link": "https://stackoverflow.com/questions/52971633/generate-prime-numbers-in-ruby-codewars-kata-primes-in-numbers", "title": "Generate prime numbers in Ruby (Codewars kata: Primes in numbers)", "body": "<p>I have solved a Codewars kata, but I can not submit it because my code takes too long. A lot of people had this problem, but we can not see the solution. The problem is, that generating the prime numbers takes too long (more than 12s) (I generate the primes with a method).</p>\n\n<p>In my computer, I can require the class Prime, and this solves the problem. But in Codewar one can not require the class Prime, therefore, my method of generating prime numbers is too slow.</p>\n\n<p>Any help?</p>\n\n<pre><code>require \"pry\"\n\ndef primeFactors(n)\n  start_time = Time.now\n  puts start_time\n  # find prime numbers smaller than n\n\n  nums = (2..(n-1)).to_a\n  odd_nums = nums.select { |num| num.odd? }\n\n  primes = odd_nums.select do |num|\n    is_prime(num)\n  end\n\n  end_time = Time.now\n  duration = end_time - start_time\n  puts end_time\n\n  # divide until mod is 1\n  dividend = n\n  res_primes = []\n\n  while dividend &gt; 1\n\n    primes.each do |prime| # prime divisor\n      new_dividend = dividend.to_f / prime\n      remainder = dividend % prime\n      if remainder.zero?\n        dividend = new_dividend\n        res_primes &lt;&lt; prime\n        break\n      end\n    end\n  end\n\n  freqs = {}\n  res_primes.each do |res_prime|\n    freqs[res_prime] = res_primes.count(res_prime)\n  end\n\n  res_string = []\n  freqs.keys.each do |key|\n    if freqs[key] == 1\n      res_string &lt;&lt; \"(#{key})\"\n    else\n      res_string &lt;&lt; \"(#{key}**#{freqs[key]})\"\n    end\n  end\n\n  res_string.join\nend\n\n\ndef is_prime(n)\n  (2..n/2).none?{|i| n % i == 0}\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 179, "user_id": 7301532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VKxe0.jpg?s=128&g=1", "display_name": "Getu", "link": "https://stackoverflow.com/users/7301532/getu"}, "edited": false, "score": 0, "creation_date": 1540392921, "post_id": 52971123, "comment_id": 92850536, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20307874/what-is-the-equivalent-of-the-has-many-conditions-option-in-rails-4\">What is the equivalent of the has_many &#39;conditions&#39; option in Rails 4?</a>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1540394740, "post_id": 52971123, "comment_id": 92851796, "body": "What version of Ruby on Rails are you actually using? Are you still on Rails 3 or 4 - like the tags you added? Or are you on an up-to-date version? You cannot use two versions at the same time, so what version exactly?"}, {"owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "edited": false, "score": 0, "creation_date": 1540397473, "post_id": 52971123, "comment_id": 92853581, "body": "I&#39;m migrating to rails 4"}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1540408211, "last_edit_date": 1540408211, "creation_date": 1540394484, "answer_id": 52972655, "question_id": 52971123, "link": "https://stackoverflow.com/questions/52971123/argumenterror-unknown-key-conditions-for-has-many-association-when-upgradin/52972655#52972655", "title": "&quot;ArgumentError: Unknown key: :conditions&quot; for has_many association when upgrading from Rails 3 to Rails 4", "body": "<p>from: <a href=\"https://edgeguides.rubyonrails.org/association_basics.html#scopes-for-has-many\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/association_basics.html#scopes-for-has-many</a> </p>\n\n<p><strong>4.3.3 Scopes for has_many</strong></p>\n\n<p>There may be times when you wish to customize the query used by has_many. Such customizations can be achieved via a scope block. For example:</p>\n\n<pre><code>class Author &lt; ApplicationRecord\n  has_many :books, -&gt; { where processed: true }\nend\n</code></pre>\n"}], "owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540408211, "creation_date": 1540390143, "last_edit_date": 1540403999, "question_id": 52971123, "link": "https://stackoverflow.com/questions/52971123/argumenterror-unknown-key-conditions-for-has-many-association-when-upgradin", "title": "&quot;ArgumentError: Unknown key: :conditions&quot; for has_many association when upgrading from Rails 3 to Rails 4", "body": "<p>I am migrating from Rails 3 to Rails 4 and the following associations from one of my models is causing an error:</p>\n\n<pre><code>has_many :unblocked_items, class_name: 'IncidentItem', \n          conditions: [\n            'incident_items.item_type_id in (?) \\\n              AND (incident_blocking_file_id IS NULL OR incident_blocking_files.way = ? \\\n            )', \n            IncidentItemType.blockable, \n            BlockingWay.unblock\n          ],\n          include: :incident_blocking_file\nhas_many :blocked_items, class_name: 'IncidentItem',\n          conditions: [\n            'incident_items.item_type_id in (?) \\\n              AND (incident_blocking_file_id IS NOT NULL \\\n              AND (incident_blocking_files.way &lt;&gt; ? OR incident_blocking_files.way IS NULL) \\\n            )', \n            IncidentItemType.blockable, \n            BlockingWay.unblock\n          ],\n          include: :incident_blocking_file\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>ArgumentError: Unknown key: :conditions. Valid keys are: :class_name, :anonymous_class, :foreign_key, :validate, :autosave, :table_name, :before_add, :after_add, :before_remove, :after_remove, :extend, :primary_key, :dependent, :as, :through, :source, :source_type, :inverse_of, :counter_cache, :join_table, :foreign_type (ArgumentError)\n</code></pre>\n\n<p>What causes this error? How can I migrate this model and its associations from Rails 3 to Rails 4?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actioncable"], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 6030056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c775b7467b51ad2401710b9b265a4aa1?s=128&d=identicon&r=PG&f=1", "display_name": "Laith Azer", "link": "https://stackoverflow.com/users/6030056/laith-azer"}, "is_accepted": false, "score": 4, "last_activity_date": 1540408516, "creation_date": 1540408516, "answer_id": 52976412, "question_id": 52970959, "link": "https://stackoverflow.com/questions/52970959/what-are-benefits-of-standalone-actioncable-server/52976412#52976412", "title": "What are benefits of standalone ActionCable server?", "body": "<p>The main benefit is separation of concerns and redundancy. Having a standalone ActionCable server allows you to scale that completely independently of your Rails server.</p>\n\n<p>For example, let's you have a memory-leak issue in your ActionCable code and it is deployed in the same container as the Rails server. It will eventually bring the whole application down. If it is separated though, the Rails server will still be running while you can fix the memory issue and redeploy the ActionCable server.</p>\n\n<p>It's better to think of the ActionCable server as a WebSocket server, as that's what it really is. In theory this separation of concerns allows you to relatively quickly change the framework for your WebSocket server, maybe something written in Go. In reality though ActionCable is heavily integrated with Rails code so it's not that straight-forward, but that is one of the main ideas behind it.</p>\n\n<p>In terms of redundancy, let's say you get 10x the amount of HTTP requests compared to WS requests (even though they are not exactly comparable). If the server is separated in a container, we might not want to scale the web Rails server and ActionCable server at the same rate. This allows us to let's say have 6 containers of Rails servers, while only 2 containers of ActionCable servers, thus saving you resources.</p>\n"}], "owner": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540408516, "creation_date": 1540389651, "question_id": 52970959, "link": "https://stackoverflow.com/questions/52970959/what-are-benefits-of-standalone-actioncable-server", "title": "What are benefits of standalone ActionCable server?", "body": "<p>Rails guide describes the opportunity to run ActionCable standalone server with regular Rails app. But I want to understand the benefits of such approach in context of running Rails app in docker containers. Why it may be useful for scaling for example?</p>\n"}, {"tags": ["ruby", "elasticsearch", "chewy-gem"], "answers": [{"comments": [{"owner": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "edited": false, "score": 0, "creation_date": 1540392889, "post_id": 52970968, "comment_id": 92850513, "body": "Thanks for answering my question. I tried it too and it doesn&#39;t work, I get the same error... Is it normal that Elasticsearch won&#39;t let me reindex/reset in my case ? How is it done without Chewy ?"}, {"owner": {"reputation": 2031, "user_id": 2337830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a378c6d6daf4fb5ec84b9079db4d5d60?s=128&d=identicon&r=PG", "display_name": "tombeynon", "link": "https://stackoverflow.com/users/2337830/tombeynon"}, "reply_to_user": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "edited": false, "score": 0, "creation_date": 1540480393, "post_id": 52970968, "comment_id": 92890464, "body": "What about <code>SearchIndex.purge!</code>? That should just recreate the index without reimporting, which might be where it&#39;s failing currently. Without Chewy you would need to use Curl to interact with the ES index, as per <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-index.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/reference/current/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2031, "user_id": 2337830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a378c6d6daf4fb5ec84b9079db4d5d60?s=128&d=identicon&r=PG", "display_name": "tombeynon", "link": "https://stackoverflow.com/users/2337830/tombeynon"}, "is_accepted": false, "score": 1, "last_activity_date": 1540389677, "creation_date": 1540389677, "answer_id": 52970968, "question_id": 52968696, "link": "https://stackoverflow.com/questions/52968696/how-to-update-elasticsearch-field-type-with-chewy/52970968#52970968", "title": "How to update Elasticsearch field type with Chewy", "body": "<p>I haven't used Chewy before, but looking at the documentation you should just be able to call <code>SearchIndex.reset!</code> in a ruby console. Certainly deleting and recreating the index is possible and should be recreated from scratch with your new data type. </p>\n"}, {"tags": [], "owner": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "is_accepted": true, "score": 0, "last_activity_date": 1540485657, "creation_date": 1540485657, "answer_id": 52994271, "question_id": 52968696, "link": "https://stackoverflow.com/questions/52968696/how-to-update-elasticsearch-field-type-with-chewy/52994271#52994271", "title": "How to update Elasticsearch field type with Chewy", "body": "<p>I found out why Elsaticsearch didn't wanted me to change my type. It was because my index got some other type containing the same field (at least the same field name), but with another field type.</p>\n\n<p>So, all the field with the same name must have the same type. Then you will be able to (and you will have to) delete your index and recreate it. (<code>SearchIndex::purge!</code> does the job)</p>\n"}], "owner": {"reputation": 571, "user_id": 4245210, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mcrWI.jpg?s=128&g=1", "display_name": "Elie Teyssedou", "link": "https://stackoverflow.com/users/4245210/elie-teyssedou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 52994271, "answer_count": 2, "score": 1, "last_activity_date": 1540485657, "creation_date": 1540383074, "question_id": 52968696, "link": "https://stackoverflow.com/questions/52968696/how-to-update-elasticsearch-field-type-with-chewy", "title": "How to update Elasticsearch field type with Chewy", "body": "<p>My question is about changing a field type in my elasticsearch index using the elasticsearch ruby client <a href=\"https://github.com/toptal/chewy\" rel=\"nofollow noreferrer\">chewy</a>.</p>\n\n<p>I am trying to update a field type in my index. I am getting this error: <code>illegal_argument_exception</code>.</p>\n\n<p>I have read that it is impossible to change type in an existing index, so I was thinking about reindexing everything: <code>rake chewy:reset</code>. I have tried many things... I can't get my reindexation working.</p>\n\n<p>The detailed error:</p>\n\n<pre><code>Elasticsearch::Transport::Transport::Errors::BadRequest: [400] {\"error\":{\"root_cause\":[{\"type\":\"illegal_argument_exception\",\"reason\":\"mapper [enabled] cannot be changed from type [text] to [boolean]\"}],\"type\":\"illegal_argument_exception\",\"reason\":\"mapper [enabled] cannot be changed from type [text] to [boolean]\"},\"status\":400}\n</code></pre>\n\n<p>My index as it was before (field enabled was a texte, by default):</p>\n\n<pre><code>class SearchIndex &lt; Chewy::Index\n  define_type Company, delete_if: :deleted_at do\n    ...\n    field :enabled\n    ...\n  end\nend\n</code></pre>\n\n<p>My index as I want it to be:</p>\n\n<pre><code>class SearchIndex &lt; Chewy::Index\n  define_type Company, delete_if: :deleted_at do\n    ...\n    field :enabled, type: 'boolean'\n    ...\n  end\nend\n</code></pre>\n\n<p>How can I do with Chewy (without requesting to ElasticSearch via curl, if possible) to get my index reindexed with the new field type ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "exception-handling", "refactoring"], "answers": [{"comments": [{"owner": {"reputation": 923, "user_id": 5743740, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01bc7905723108372964cd2f6261604c?s=128&d=identicon&r=PG&f=1", "display_name": "ugotchi", "link": "https://stackoverflow.com/users/5743740/ugotchi"}, "edited": false, "score": 0, "creation_date": 1540384122, "post_id": 52968561, "comment_id": 92844201, "body": "this looks like a much cleaner and elegant way of reducing code duplication, thanks!"}, {"owner": {"reputation": 1696, "user_id": 2361740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVJGn.jpg?s=128&g=1", "display_name": "rorofromfrance", "link": "https://stackoverflow.com/users/2361740/rorofromfrance"}, "edited": false, "score": 0, "creation_date": 1596624389, "post_id": 52968561, "comment_id": 111869317, "body": "This is much better and also usable outside of controllers (modules, apis etc.)"}], "tags": [], "owner": {"reputation": 211, "user_id": 4207625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b672c1aaa6bf9e222e114ec0d1384da?s=128&d=identicon&r=PG&f=1", "display_name": "V&#225;clav Pruner", "link": "https://stackoverflow.com/users/4207625/v%c3%a1clav-pruner"}, "is_accepted": false, "score": 7, "last_activity_date": 1540385108, "last_edit_date": 1540385108, "creation_date": 1540382679, "answer_id": 52968561, "question_id": 52968156, "link": "https://stackoverflow.com/questions/52968156/refactoring-duplicate-rescue-exception-handlers-in-ruby-on-rails-controller/52968561#52968561", "title": "Refactoring duplicate rescue exception handlers in Ruby on Rails controller", "body": "<p>You could try something like this:  </p>\n\n<pre><code>def wave\n  error_handler do\n    # ...do something here...\n  end\nend\n\ndef run\n  error_handler do\n    # ...do something different here...\n  end\nend\n\ndef error_handler\n  yield\nrescue ActionController::ParameterMissing =&gt; e\n  render :json =&gt; {:error =&gt; e.message}, :status =&gt; 422\nrescue Vendor::ApiError =&gt; e\n  render :json =&gt; {:error =&gt; e.message}, :status =&gt; 500\nend\n</code></pre>\n\n<p>edit: That's just from plain ruby point of view though, maybe rails have something better in place already.</p>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "is_accepted": true, "score": 6, "last_activity_date": 1540384765, "last_edit_date": 1540384765, "creation_date": 1540384371, "answer_id": 52969096, "question_id": 52968156, "link": "https://stackoverflow.com/questions/52968156/refactoring-duplicate-rescue-exception-handlers-in-ruby-on-rails-controller/52969096#52969096", "title": "Refactoring duplicate rescue exception handlers in Ruby on Rails controller", "body": "<p>You can use <a href=\"https://apidock.com/rails/ActiveSupport/Rescuable/ClassMethods/rescue_from\" rel=\"noreferrer\">rescue_from</a> in your controller to rescue from an error in all your controller actions. You would have something like this</p>\n\n<pre><code>class MyController &lt; ApplicationController\n  rescue_from ActionController::ParameterMissing do |exception|\n    render :json =&gt; {:error =&gt; exception.message}, :status =&gt; 422\n  end\n\n  rescue_from Vendor::ApiError do |exception|\n    render :json =&gt; {:error =&gt; exception.message}, :status =&gt; 500\n  end\n\n  def wave\n    # ...\n  end\n\n  # ...\nend\n</code></pre>\n\n<p>You can even put it in your Application Controller if you want this behavior on all controllers (might be useful for rescuing ParameterMissing errors for example)</p>\n"}], "owner": {"reputation": 923, "user_id": 5743740, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01bc7905723108372964cd2f6261604c?s=128&d=identicon&r=PG&f=1", "display_name": "ugotchi", "link": "https://stackoverflow.com/users/5743740/ugotchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 52969096, "answer_count": 2, "score": 2, "last_activity_date": 1540385108, "creation_date": 1540381454, "last_edit_date": 1540382190, "question_id": 52968156, "link": "https://stackoverflow.com/questions/52968156/refactoring-duplicate-rescue-exception-handlers-in-ruby-on-rails-controller", "title": "Refactoring duplicate rescue exception handlers in Ruby on Rails controller", "body": "<p>I have two action methods inside a controller, that have the same duplicated code that rescues two different types of exceptions:</p>\n\n<pre><code>      def wave\n        ...do something here...\n      rescue ActionController::ParameterMissing =&gt; e\n        render :json =&gt; {:error =&gt; e.message}, :status =&gt; 422\n      rescue Vendor::ApiError =&gt; e\n        render :json =&gt; {:error =&gt; e.message}, :status =&gt; 500\n      end\n\n      def run\n        ...do something different here...\n      rescue ActionController::ParameterMissing =&gt; e\n        render :json =&gt; {:error =&gt; e.message}, :status =&gt; 422\n      rescue Vendor::ApiError =&gt; e\n        render :json =&gt; {:error =&gt; e.message}, :status =&gt; 500\n      end\n</code></pre>\n\n<p>Can the rescue handlers just be refactored into a common private method, and called from both <code>run</code> and <code>wave</code> methods?</p>\n"}, {"tags": ["arrays", "json", "ruby", "nested", "logstash"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 1, "creation_date": 1540377127, "post_id": 52965201, "comment_id": 92839767, "body": "If above is ruby hash &#39;h&#39; with all contents as a string, You can get required format by, <code>h[&#39;target&#39;] = [h[&#39;target&#39;].inject({}) { |m, i| m[i.split(&#39; - &#39;)[0]] = i.split(&#39; - &#39;)[1]; m }]</code>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1540382664, "post_id": 52965201, "comment_id": 92843250, "body": "@ray: If the above is a Ruby hash, your code won&#39;t work - you&#39;d need <code>h[:target]</code>, not <code>h[&#39;target&#39;]</code>. :)"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1540387895, "post_id": 52965201, "comment_id": 92846865, "body": "@Amadan I mentioned in comment as taking everything in string because if target is symbol, you cannot write like <code>&#39;target&#39;:</code>, have to use <code>target:</code>. I provided solution for string using <code>&#39;target&#39; =&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540381884, "post_id": 52965442, "comment_id": 92842722, "body": "Are you sure this works on the input data? I think you did it backwards, your input data is the OP desired output."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540382462, "post_id": 52965442, "comment_id": 92843113, "body": "@lacostenycoder: It works on the input data, if you take the natural assumption that both of the parallel structures are JSON, given that OP specifically said the second one is JSON. I see you and ray assumed the first one is Ruby (even though there are no hints one way or another). You both (EDIT: and iGian now as well) also assumed there will only ever be one dash in the input, which I do not (though, to be fair, that&#39;s all that is visible in OP&#39;s example, again, no hints one way or another)."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540382902, "post_id": 52965442, "comment_id": 92843390, "body": "fair enough, however in your answer perhaps you could have given example of how your input data needs to be defined as ruby with a <code>.json</code> on it. Considering the OP is a ruby noob, some explanation couldn&#39;t hurt."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1540383111, "last_edit_date": 1540383111, "creation_date": 1540373083, "answer_id": 52965442, "question_id": 52965201, "link": "https://stackoverflow.com/questions/52965201/ruby-to-convert-nested-array-field-to-nested-json-objects/52965442#52965442", "title": "Ruby to convert nested array field to nested JSON objects", "body": "<p>Assuming input is JSON:</p>\n\n<pre><code>require 'json'\n\njson = &lt;&lt;-EOF\n{\n    \"target\": [\n        \"Sector1 - Subsector1\",\n        \"Sector2 - Subsector2\"\n    ]\n}\nEOF\n\n\ndata = JSON.parse(json)\ndata['target'].map! { |line|\n  line.split(' - ').map { |str| [str[/^.*(?=\\d+$)/], str] }.to_h\n}\njson = JSON.dump(data)\n</code></pre>\n\n<p><code>map!</code> will replace <code>target</code> in-place; for each element, split by dashes, extract the key from each part by leaving out the numbers at the end of the part, and make a hash out of the collection of <code>[key, part]</code> pairs.</p>\n\n<p>EDIT: If input is not JSON, but a Ruby <code>Hash</code> (already in <code>data</code> variable), then change <code>data[\"target\"]</code> to <code>data[:target]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540382998, "last_edit_date": 1540382998, "creation_date": 1540381586, "answer_id": 52968197, "question_id": 52965201, "link": "https://stackoverflow.com/questions/52965201/ruby-to-convert-nested-array-field-to-nested-json-objects/52968197#52968197", "title": "Ruby to convert nested array field to nested JSON objects", "body": "<p>This approach takes your example input data and defines it as a ruby hash, then modifies the data, then formats it back to json. Also the style I've used here is intended to be more readable for a ruby newbie.</p>\n\n<pre><code>require 'json'\n\ndata = {\n    \"target\": [\n        \"Sector1 - Subsector1\",\n        \"Sector2 - Subsector2\"\n    ]\n}\n\ndata[:target] = [\n  data[:target].inject({}) do |str, index|\n    str[index.split(' - ')[0]] = index.split(' - ')[1]\n    str\n  end\n]\n\njson = data.to_json\nputs json\n#=&gt;{\"target\":[{\"Sector1\":\"Subsector1\",\"Sector2\":\"Subsector2\"}]}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10484316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0b803ba092832e2b8689775f87e82?s=128&d=identicon&r=PG&f=1", "display_name": "dx123", "link": "https://stackoverflow.com/users/10484316/dx123"}, "edited": false, "score": 0, "creation_date": 1540431390, "post_id": 52968472, "comment_id": 92866573, "body": "I have to use the Logstash Ruby filter plugin that has its own syntax format: <a href=\"https://www.elastic.co/guide/en/logstash/current/plugins-filters-ruby.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/logstash/current/plugins-filters-ruby.ht&zwnj;&#8203;ml</a>. Your answer looks promising, any chance you can modify your answer to fit this plugin&#39;s syntax?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 33, "user_id": 10484316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0b803ba092832e2b8689775f87e82?s=128&d=identicon&r=PG&f=1", "display_name": "dx123", "link": "https://stackoverflow.com/users/10484316/dx123"}, "edited": false, "score": 0, "creation_date": 1540443844, "post_id": 52968472, "comment_id": 92869373, "body": "I don&#39;t know logstash at all. This is just my guess: maybe you can pass a hash to the fiter and get the json as output? In that case, just try remove <code>.to_json</code> and pass the resulting hash. No need <code>require &#39;json&#39;</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1540382395, "creation_date": 1540382395, "answer_id": 52968472, "question_id": 52965201, "link": "https://stackoverflow.com/questions/52965201/ruby-to-convert-nested-array-field-to-nested-json-objects/52968472#52968472", "title": "Ruby to convert nested array field to nested JSON objects", "body": "<p>Other option:</p>\n\n<pre><code>require 'json'\n\ndata.transform_values { |v| v.map { |e| {Sector: e.split(\" - \").first, Subsector: e.split(\" - \").last } } }.to_json\n\n#=&gt; {\"target\":[{\"Sector\":\"Sector1\",\"Subsector\":\"Subsector1\"},{\"Sector\":\"Sector2\",\"Subsector\":\"Subsector2\"}]}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10484316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe0b803ba092832e2b8689775f87e82?s=128&d=identicon&r=PG&f=1", "display_name": "dx123", "link": "https://stackoverflow.com/users/10484316/dx123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1540383111, "creation_date": 1540372463, "question_id": 52965201, "link": "https://stackoverflow.com/questions/52965201/ruby-to-convert-nested-array-field-to-nested-json-objects", "title": "Ruby to convert nested array field to nested JSON objects", "body": "<p>I'm using ELK Stack Logstash and this is the format of the \"target\" data field that I need to convert now:</p>\n\n<pre><code>{\n    \"target\": [\n        \"Sector1 - Subsector1\",\n        \"Sector2 - Subsector2\"\n    ]\n}\n</code></pre>\n\n<p>The desired JSON Output format that I need:</p>\n\n<pre><code>{\n    \"target\": [{\n        \"Sector\": \"Sector1\",\n        \"Subsector\": \"Subsector1\"\n    }, {\n        \"Sector\": \"Sector2\",\n        \"Subsector\": \"Subsector2\"\n    }]\n}\n</code></pre>\n\n<p>I've done some research and found out that the Logstash Ruby filter is able to perform the conversion, however I am not proficient in Ruby so if any pros here can help with the code it will be very much appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "edited": false, "score": 0, "creation_date": 1540373313, "post_id": 52965316, "comment_id": 92837414, "body": "That works well without any changes, though I already use the dot_env gem. Would it work without the dot_env gem?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "edited": false, "score": 0, "creation_date": 1540373570, "post_id": 52965316, "comment_id": 92837560, "body": "I&#39;d say yes, but dotenv could be very useful anyway :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "edited": false, "score": 0, "creation_date": 1540377347, "post_id": 52965316, "comment_id": 92839927, "body": "@Obromios the dotenv gem populates <code>ENV</code> based on assignments in a <code>.env</code> file (hence the name), making it easier to have per-project environment settings."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 2, "last_activity_date": 1540373799, "last_edit_date": 1540373799, "creation_date": 1540372745, "answer_id": 52965316, "question_id": 52965120, "link": "https://stackoverflow.com/questions/52965120/how-to-set-a-constant-from-the-command-line-when-running-rspec/52965316#52965316", "title": "How to set a constant from the command line when running rspec", "body": "<p>Just try to use that variable in your code with <code>ENV['TEST_COLOR']</code> and see. I mean, you can even write a one line script which makes use of environment variables and it works out of the box, I tried. So I'm reasonably confident this works even in rspec.</p>\n\n<p>One suggestion: given that could be not clear to someone else that rspec needs that environment variable, maybe use <code>ENV.fetch('TEST_COLOR', 'default value')</code>, where 'default value' is a reasonable default, so that if anyone runs rspec without that variable, everything is fine anyway.</p>\n"}], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 52965316, "answer_count": 1, "score": 0, "last_activity_date": 1540373799, "creation_date": 1540372224, "question_id": 52965120, "link": "https://stackoverflow.com/questions/52965120/how-to-set-a-constant-from-the-command-line-when-running-rspec", "title": "How to set a constant from the command line when running rspec", "body": "<p>With some rails commands, it is possible to set a constant from the command line e.g.</p>\n\n<pre><code>RAILS_ENV=production rails server\n</code></pre>\n\n<p>I want to do something similar with rspec; I want to set a constant from the command line that can be used to change some tests, e.g.</p>\n\n<pre><code>TEST_COLOR=red rspec spec\n</code></pre>\n\n<p>and then in a test access the value of <code>TEST_COLOR</code>. Is there a way to do this?</p>\n"}, {"tags": ["ruby", "sinatra", "adal"], "comments": [{"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "edited": false, "score": 0, "creation_date": 1541653026, "post_id": 52961622, "comment_id": 93291884, "body": "I ended up using OAuth2.0 from scratch using this article: <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/active-directory/develop/&hellip;</a> And not using the ADAL library for Ruby at all."}], "answers": [{"comments": [{"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "edited": false, "score": 0, "creation_date": 1540431371, "post_id": 52980107, "comment_id": 92866567, "body": "Note that the sample doesn&#39;t completely work well.  The graph API call at line 78 is out of date."}, {"owner": {"reputation": 509, "user_id": 906397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/be3bb9aa8db8052b8683cbd5774b5449?s=128&d=identicon&r=PG", "display_name": "Colbs", "link": "https://stackoverflow.com/users/906397/colbs"}, "edited": false, "score": 0, "creation_date": 1541521574, "post_id": 52980107, "comment_id": 93241818, "body": "What should the Reply URL be for this sample? I keep getting the error &quot;The reply url specified in the request does not match the reply urls configured for the application&quot;"}, {"owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "reply_to_user": {"reputation": 509, "user_id": 906397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/be3bb9aa8db8052b8683cbd5774b5449?s=128&d=identicon&r=PG", "display_name": "Colbs", "link": "https://stackoverflow.com/users/906397/colbs"}, "edited": false, "score": 0, "creation_date": 1541652947, "post_id": 52980107, "comment_id": 93291870, "body": "@Colbs  It just matters that the Reply URL is identical to the Reply URL configured in your App Registration on the Azure AD portal."}], "tags": [], "owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "is_accepted": false, "score": 0, "last_activity_date": 1540431266, "creation_date": 1540431266, "answer_id": 52980107, "question_id": 52961622, "link": "https://stackoverflow.com/questions/52961622/mapping-adal-sample-for-ruby-sinatra-to-active-directory/52980107#52980107", "title": "Mapping ADAL Sample for Ruby Sinatra to Active Directory", "body": "<p>This seems to work:</p>\n\n<p>CLIENT_ID is the Application ID shown in the settings of the AD App Registration for the configured Web app.</p>\n\n<p>CLIENT_SECRET is a password value a password set in the 'Keys' section of the Web app details.</p>\n\n<p>TENANT should be a registered domain name for the AD tenant.<br>\nSee: <a href=\"https://msdn.microsoft.com/Library/Azure/Ad/Graph/howto/azure-ad-graph-api-operations-overview?f=255&amp;MSPPError=-2147217396#TenantIdentifier\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/Library/Azure/Ad/Graph/howto/azure-ad-graph-api-operations-overview?f=255&amp;MSPPError=-2147217396#TenantIdentifier</a></p>\n"}], "owner": {"reputation": 2278, "user_id": 556644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2pQJ6.jpg?s=128&g=1", "display_name": "Ross Attrill", "link": "https://stackoverflow.com/users/556644/ross-attrill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540431266, "creation_date": 1540358958, "question_id": 52961622, "link": "https://stackoverflow.com/questions/52961622/mapping-adal-sample-for-ruby-sinatra-to-active-directory", "title": "Mapping ADAL Sample for Ruby Sinatra to Active Directory", "body": "<p>I am trying to run the Sinatra sample app given in the Azure Active Directory Library for Ruby: <a href=\"https://github.com/AzureAD/azure-activedirectory-library-for-ruby\" rel=\"nofollow noreferrer\">https://github.com/AzureAD/azure-activedirectory-library-for-ruby</a>.   The sample is here:   <a href=\"https://github.com/AzureAD/azure-activedirectory-library-for-ruby/tree/dev/samples/authorization_code_example\" rel=\"nofollow noreferrer\">https://github.com/AzureAD/azure-activedirectory-library-for-ruby/tree/dev/samples/authorization_code_example</a></p>\n\n<p>The provided README.md file tells me that I need to do this:</p>\n\n<ol>\n<li>Register a web application under your Azure Active Directory account.</li>\n<li>Replace <code>CLIENT_ID</code>, <code>CLIENT_SECRET</code> and <code>TENANT</code> with your values.</li>\n</ol>\n\n<p>My problem is that it is not clear how to map any 3 of these values to the various fields available for the Web App that I have setup in Active Directory.</p>\n\n<ul>\n<li><p>I am guessing that <code>TENANT</code> maps to a URL that will point my app to our ActiveDirectory configuration.</p></li>\n<li><p>I am guessing that <code>CLIENT_ID</code> maps to the application id of my web app</p></li>\n<li><p>I am very unsure about the <code>CLIENT_SECRET</code></p></li>\n</ul>\n\n<p>I am looking for clarity on these three fields and anything else I need to do to make this sample work. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1540358998, "post_id": 52961313, "comment_id": 92829949, "body": "this will only work if current_tags has exactly 1 element. I would recommend not using <code>include?</code> here"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1540362276, "post_id": 52961313, "comment_id": 92831076, "body": "What&#39;s the expected behavior if <code>current_tags</code> is empty \u2013 should the conditional evaluate or skip the code block in that case?"}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1540454354, "post_id": 52961313, "comment_id": 92874102, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3533186/finding-what-is-common-to-two-arrays\">Finding what is common to two arrays</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1540358892, "post_id": 52961328, "comment_id": 92829908, "body": "This doesn&#39;t work if current_tags has more than 1 element - <code>include?</code> takes 1 and only 1 arg"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 1, "last_activity_date": 1540356945, "creation_date": 1540356945, "answer_id": 52961328, "question_id": 52961313, "link": "https://stackoverflow.com/questions/52961313/how-to-check-if-array-shares-elements-with-another-array-in-ruby/52961328#52961328", "title": "How to check if array shares elements with another array in Ruby?", "body": "<p>Add one more condition if <code>current_tags.present?</code></p>\n\n<pre><code>if current_tags.present? &amp;&amp; @user.tags.include?(*current_tags)\n    # code\nend\n</code></pre>\n\n<p>As </p>\n\n<pre><code>2.3.1 :002 &gt; [].present?\n =&gt; false \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 3, "last_activity_date": 1540358800, "creation_date": 1540358800, "answer_id": 52961601, "question_id": 52961313, "link": "https://stackoverflow.com/questions/52961313/how-to-check-if-array-shares-elements-with-another-array-in-ruby/52961601#52961601", "title": "How to check if array shares elements with another array in Ruby?", "body": "<p>Another trick to do the same is:</p>\n\n<pre><code>if current_tags.any? { |tag| @user.tags.include?(tag) }\n  ...\nend\n</code></pre>\n\n<p>if you want to be sure that at least one of the <code>current_tags</code> is in the array of <code>@user.tags</code>, or</p>\n\n<pre><code>if current_tags.all? { |tag| @user.tags.include?(tag) }\n  ...\nend\n</code></pre>\n\n<p>in case all tags should be there.</p>\n\n<p>Works fine with empty <code>current_tags</code> as well.</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 3624321, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1390780727/picture?type=large", "display_name": "Alvaro Alday", "link": "https://stackoverflow.com/users/3624321/alvaro-alday"}, "edited": false, "score": 0, "creation_date": 1540363208, "post_id": 52961615, "comment_id": 92831508, "body": "All the answers were good, but this is the simplest, easiest to understand. Thanks."}], "tags": [], "owner": {"reputation": 33152, "user_id": 322122, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f855324f298eb7708e39ea117477cbd5?s=128&d=identicon&r=PG", "display_name": "d11wtq", "link": "https://stackoverflow.com/users/322122/d11wtq"}, "is_accepted": true, "score": 9, "last_activity_date": 1540358915, "creation_date": 1540358915, "answer_id": 52961615, "question_id": 52961313, "link": "https://stackoverflow.com/questions/52961313/how-to-check-if-array-shares-elements-with-another-array-in-ruby/52961615#52961615", "title": "How to check if array shares elements with another array in Ruby?", "body": "<p>You can use an intersection to solve this problem instead. The intersection of two arrays is an array containing only the elements present in both. If the intersection is empty, the arrays had nothing in common, else the arrays had the elements from the result in common:</p>\n\n<pre><code>if (current_tags &amp; @user.tags).any?\n  # ok\nend\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3624321, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1390780727/picture?type=large", "display_name": "Alvaro Alday", "link": "https://stackoverflow.com/users/3624321/alvaro-alday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 1, "accepted_answer_id": 52961615, "answer_count": 3, "score": 1, "last_activity_date": 1540369648, "creation_date": 1540356826, "last_edit_date": 1540369648, "question_id": 52961313, "link": "https://stackoverflow.com/questions/52961313/how-to-check-if-array-shares-elements-with-another-array-in-ruby", "title": "How to check if array shares elements with another array in Ruby?", "body": "<p>I'm currently trying to see if an array of records shares elements with another array.</p>\n\n<p>I'm using the splat operator for a conditional like this:</p>\n\n<pre><code>if @user.tags.include?(*current_tags)\n    # code\nend\n</code></pre>\n\n<p>This works when tags are present, but returns this error when <code>current_tags</code> are empty. </p>\n\n<blockquote>\n  <p>wrong number of arguments (given 0, expected 1)</p>\n</blockquote>\n\n<p>This happens a lot in my app so I was wondering if there are any alternatives to achieving this same functionality but in other way that won't blow up if <code>current_tags</code> is an empty array. </p>\n"}, {"tags": ["ruby", "chef-infra"], "comments": [{"owner": {"reputation": 1328, "user_id": 542995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPDiC.jpg?s=128&g=1", "display_name": "zdk", "link": "https://stackoverflow.com/users/542995/zdk"}, "edited": false, "score": 0, "creation_date": 1540350887, "post_id": 52959956, "comment_id": 92828024, "body": "Please provide more details like how do you define target, how your recipe look like and logs."}, {"owner": {"reputation": 93, "user_id": 9618664, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZZMpawJn8yY/AAAAAAAAAAI/AAAAAAAAACo/0eiVPNcpzrY/photo.jpg?sz=128", "display_name": "deepak singla", "link": "https://stackoverflow.com/users/9618664/deepak-singla"}, "reply_to_user": {"reputation": 1328, "user_id": 542995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPDiC.jpg?s=128&g=1", "display_name": "zdk", "link": "https://stackoverflow.com/users/542995/zdk"}, "edited": false, "score": 0, "creation_date": 1540351427, "post_id": 52959956, "comment_id": 92828107, "body": "updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4512954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94380e0fb75af6016f9dac7cfca06fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MyYyY", "link": "https://stackoverflow.com/users/4512954/myyyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1540396492, "last_edit_date": 1540396492, "creation_date": 1540390302, "answer_id": 52971176, "question_id": 52959956, "link": "https://stackoverflow.com/questions/52959956/replace-the-value-in-xml-using-chef/52971176#52971176", "title": "Replace the value in xml using Chef", "body": "<p>It looks like your xml is not valid\nIt should look like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;shelves&gt;\n&lt;bookshelf&gt;\n    &lt;Name&gt;First Bookshelf&lt;/Name&gt;\n    &lt;book&gt;\n        &lt;author&gt;Conway, Damien&lt;/author&gt;\n        &lt;title&gt;Perl Best Practices&lt;/title&gt;\n    &lt;/book&gt;\n    &lt;book&gt;\n        &lt;author&gt;Atwood, Margaret&lt;/author&gt;\n        &lt;title&gt;Perl Best Practices&lt;/title&gt;\n    &lt;/book&gt;\n&lt;/bookshelf&gt;\n&lt;bookshelf&gt;\n    &lt;Name&gt;Second Bookshelf&lt;/Name&gt;\n    &lt;book&gt;\n        &lt;author&gt;Conway, Damien&lt;/author&gt;\n        &lt;title&gt;Perl Best Practices&lt;/title&gt;\n    &lt;/book&gt;\n    &lt;book&gt;\n        &lt;author&gt;Atwood, Margaret&lt;/author&gt;\n        &lt;title&gt;Perl Best Practices&lt;/title&gt;\n    &lt;/book&gt;\n&lt;/bookshelf&gt;\n&lt;/shelves&gt;\n</code></pre>\n\n<p>With that in mind you can do:</p>\n\n<pre><code>xml_edit 'change title' do\n    path 'C:\\\\testing\\\\text.xml'\n    target '/shelves/bookshelf[Name[text()=\\'Second Bookshelf\\']]/book[author[text()=\\'Atwood, Margaret\\']]/title'\n    fragment '&lt;title&gt;Hello World&lt;/title&gt;'\n    action :replace\nend\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9618664, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZZMpawJn8yY/AAAAAAAAAAI/AAAAAAAAACo/0eiVPNcpzrY/photo.jpg?sz=128", "display_name": "deepak singla", "link": "https://stackoverflow.com/users/9618664/deepak-singla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540396492, "creation_date": 1540345040, "last_edit_date": 1540369831, "question_id": 52959956, "link": "https://stackoverflow.com/questions/52959956/replace-the-value-in-xml-using-chef", "title": "Replace the value in xml using Chef", "body": "<p>I am using <a href=\"https://github.com/martinb3-cookbooks/xmledit-cookbook/issues/18\" rel=\"nofollow noreferrer\">xml_edit</a> to change the value of xml. This is not working with below scenario.</p>\n\n<p>I want to change the title of <strong>Atwood, Margaret</strong> author in <strong>Second Bookshelf</strong> in below xml:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n&lt;bookshelf&gt;\n   &lt;Name&gt;First Bookshelf&lt;/Name&gt;\n   &lt;book&gt;\n      &lt;author&gt;Conway, Damien&lt;/author&gt;\n      &lt;title&gt;Perl Best Practices&lt;/title&gt;\n   &lt;/book&gt;\n   &lt;book&gt;\n      &lt;author&gt;Atwood, Margaret&lt;/author&gt;\n      &lt;title&gt;Perl Best Practices&lt;/title&gt;\n   &lt;/book&gt;\n&lt;/bookshelf&gt;\n&lt;bookshelf&gt;\n   &lt;Name&gt;Second Bookshelf&lt;/Name&gt;\n   &lt;book&gt;\n      &lt;author&gt;Conway, Damien&lt;/author&gt;\n      &lt;title&gt;Perl Best Practices&lt;/title&gt;\n   &lt;/book&gt;\n   &lt;book&gt;\n      &lt;author&gt;Atwood, Margaret&lt;/author&gt;\n      &lt;title&gt;Perl Best Practices&lt;/title&gt;\n   &lt;/book&gt;\n&lt;/bookshelf&gt;\n</code></pre>\n\n<p>I am trying to use below recipe. I do't know, how could I verify the <strong>Name and auther</strong> of second bookshelf.</p>\n\n<pre><code>xml_edit 'change title' do\n    path 'C:\\\\testing\\\\text.xml'\n    target '/bookshelf/book/title[text()=\\'Perl Best Practices\\']'\n    fragment '&lt;title&gt;Hello World&lt;/title&gt;'\n    action :replace\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1540348527, "post_id": 52959887, "comment_id": 92827576, "body": "See <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question?</a> As-is, this question is unlikely to generate a response."}], "answers": [{"tags": [], "owner": {"reputation": 1319, "user_id": 5060959, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/2d7af66fc79160e5872515869fad813c?s=128&d=identicon&r=PG&f=1", "display_name": "thedudecodes", "link": "https://stackoverflow.com/users/5060959/thedudecodes"}, "is_accepted": false, "score": 0, "last_activity_date": 1540358273, "creation_date": 1540358273, "answer_id": 52961523, "question_id": 52959887, "link": "https://stackoverflow.com/questions/52959887/paying-before-registration-information-is-saved-to-the-db/52961523#52961523", "title": "Paying before registration information is saved to the DB", "body": "<p>As a general Idea what you can do is one registration of user on business account take the card information also for billing.</p>\n\n<p>On submit of that information it will go to a controller action with all the params of registration and billing. </p>\n\n<p>Try to charge the card through brain tree and if they payment is successfull you can register the user because you have access to the params and you can save this transaction for the user also.</p>\n\n<p>Its just a general idea that how can you implement it. </p>\n"}, {"tags": [], "owner": {"reputation": 986, "user_id": 8304905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YpAOE.jpg?s=128&g=1", "display_name": "EmmanuelB", "link": "https://stackoverflow.com/users/8304905/emmanuelb"}, "is_accepted": false, "score": 0, "last_activity_date": 1540395815, "creation_date": 1540395815, "answer_id": 52973091, "question_id": 52959887, "link": "https://stackoverflow.com/questions/52959887/paying-before-registration-information-is-saved-to-the-db/52973091#52973091", "title": "Paying before registration information is saved to the DB", "body": "<p>As one of the comments say, you question is vague. </p>\n\n<p>What I would do is to have a column in that table that tells whether the record has payed or not.</p>\n\n<p>If it hasn't payed then restrict its ability to log in. This way you can still record its information and it may be usefull for some cases, say to remind that user through an email that he/she should complete its payment.</p>\n"}], "owner": {"reputation": 51, "user_id": 10194603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hWN495rXPto/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oz4MmZglF5X8q3slj4NuIVT7_CBg/mo/photo.jpg?sz=128", "display_name": "James Smith", "link": "https://stackoverflow.com/users/10194603/james-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1540395815, "creation_date": 1540344385, "question_id": 52959887, "link": "https://stackoverflow.com/questions/52959887/paying-before-registration-information-is-saved-to-the-db", "title": "Paying before registration information is saved to the DB", "body": "<p>So I have everything implemented with braintree and rails. However, I wanted to switch it up a little. I have a user role which is a business account. When someone wants to sign up as a business account I want them to pay before the devise registration is actually saved? I've seen it on a lot of website but cant really find any resources online how to do it. Someone please give an example of how it can work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-routing"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 2, "creation_date": 1540357740, "post_id": 52959662, "comment_id": 92829548, "body": "<a href=\"https://github.com/norman/friendly_id\" rel=\"nofollow noreferrer\">github.com/norman/friendly_id</a> try this."}], "answers": [{"tags": [], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "is_accepted": false, "score": 2, "last_activity_date": 1540368746, "creation_date": 1540368746, "answer_id": 52963965, "question_id": 52959662, "link": "https://stackoverflow.com/questions/52959662/how-to-hide-id-in-rails-url/52963965#52963965", "title": "How to hide :id in rails url?", "body": "<p><code>gem 'friendly_id'</code> lets you create pretty URLs and work with human-friendly strings as if they were numeric ids.</p>\n\n<p><a href=\"https://github.com/norman/friendly_id\" rel=\"nofollow noreferrer\">https://github.com/norman/friendly_id</a></p>\n"}, {"comments": [{"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1540397920, "post_id": 52964151, "comment_id": 92853815, "body": "Thank you! I actually left this part out of the question (since it felt extraneous), but I actually am storing the relevant IDs in a session variable. The whole thing is built up in a multistep form wizard and then gets propagated to db only after everything has been successfully added. I am still confused about how to hide the ID from the url. Don&#39;t I need to pass the ID in the form?"}, {"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1540434471, "post_id": 52964151, "comment_id": 92867237, "body": "i&#39;m still sort of confused. both <code>first_object</code> and <code>second_object</code> are picked by the user from a list of similar objects, and i cannot pass either to session without passing them as an argument to <code>form_for</code>. how can i assign them in the controller?"}], "tags": [], "owner": {"reputation": 898, "user_id": 967478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/90116df265c64c73cb428802fb567491?s=128&d=identicon&r=PG", "display_name": "shashwat", "link": "https://stackoverflow.com/users/967478/shashwat"}, "is_accepted": true, "score": 2, "last_activity_date": 1540369360, "creation_date": 1540369360, "answer_id": 52964151, "question_id": 52959662, "link": "https://stackoverflow.com/questions/52959662/how-to-hide-id-in-rails-url/52964151#52964151", "title": "How to hide :id in rails url?", "body": "<p>You have a set of possible solutions:</p>\n\n<ol>\n<li><p>As mentioned, you can convert the IDs into something like a slug, or something else, which is what the other answer has mentioned: <a href=\"https://github.com/norman/friendly_id\" rel=\"nofollow noreferrer\">https://github.com/norman/friendly_id</a></p></li>\n<li><p>You can store the IDs of the selected objects in session cookies. That way, the client is still sending the relevant data, but it doesn't really appear in the URL.</p></li>\n<li><p>You can have an ephemeral <code>Transaction</code> table, where you can store the first object and the second object. That way, the routes will deal with the transaction_id, while the first_object_id and second_object_id are abstracted away within the table. This will also allow you to store other metadata related to the transaction or the trade process.</p></li>\n<li><p>You can create a separate endpoint not linked with the <code>shares</code> controller, where you can accept two (optional) query params: <code>/sharetransaction/trade?first_object_id=113&amp;second_object_id=106</code>. That way, the URL reflects what is actually happening, rather than changing IDs in the middle for no discernible reason.</p></li>\n</ol>\n\n<p>The approach you go for depends on your use-case.</p>\n"}], "owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1556, "favorite_count": 0, "accepted_answer_id": 52964151, "answer_count": 2, "score": -1, "last_activity_date": 1540369360, "creation_date": 1540342299, "last_edit_date": 1540347964, "question_id": 52959662, "link": "https://stackoverflow.com/questions/52959662/how-to-hide-id-in-rails-url", "title": "How to hide :id in rails url?", "body": "<p>I have these nested routes, and I want to hide the <code>id</code> param from the url.</p>\n\n<pre><code>resources :shares, only: [:index, :create, :update] do \n  resource :wizard, path: \"trade\" do\n    get :first_object\n    get :second_object\n    get :confirmation\n    post :validate_step\n  end\nend\n</code></pre>\n\n<p>Each page has a <code>form_for</code> that looks like this up top:</p>\n\n<pre><code>&lt;%= form_for [@object, @trade_wizard], as: :trade_wizard, url: validate_step_share_wizard_path(@object) do |f| %&gt;\n</code></pre>\n\n<p>So the user adds the <code>first_object</code> to the wizard, and gets redirected to the following url: <code>/shares/113/trade/second_object</code>. After adding <code>second_object</code> (which is obviously different from the first), the user is redirected to to <code>/shares/106/trade/confirmation</code>. I'm not sure if this represents a potential security violation, and my tests seem to work just fine, so I'm thinking it should be ok if I find some way to hide that id part of the url?</p>\n\n<p>Or is my use case for nested routes incorrect?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540342790, "post_id": 52959661, "comment_id": 92826518, "body": "Delete file <code>gemfile.lock</code> then do a <code>bundle install</code> again. If it fails, kill <code>gemfile.lock</code> again and version your gems differently : <code>gem &#39;rails&#39;, &#39;= 5.2.0&#39;</code> <code>gem &#39;simple_form&#39;</code> (no version for this gem)"}, {"owner": {"reputation": 317, "user_id": 7341067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fce45159be2fa7f551e677d49ce1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luc", "link": "https://stackoverflow.com/users/7341067/luc"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540343844, "post_id": 52959661, "comment_id": 92826690, "body": "Hi @Maxence, thanks for you reply. Unfortunately it didn&#39;t work. I had already tried deleting gemfile.lock and setting those versions for the gems didn&#39;t work. Any other idea? I&#39;m still getting this actionpack error."}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540344097, "post_id": 52959661, "comment_id": 92826740, "body": "Try killing the <code>git_source</code> line. And version as per my previous comment then bundle install again."}, {"owner": {"reputation": 317, "user_id": 7341067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fce45159be2fa7f551e677d49ce1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luc", "link": "https://stackoverflow.com/users/7341067/luc"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540344725, "post_id": 52959661, "comment_id": 92826856, "body": "Still getting the same errors, and a bunch more now, @Maxence. I was so excited to start learning rails, but this is such a turn off."}, {"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540345042, "post_id": 52959661, "comment_id": 92826921, "body": "Try a <code>bundle update</code>"}, {"owner": {"reputation": 317, "user_id": 7341067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fce45159be2fa7f551e677d49ce1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luc", "link": "https://stackoverflow.com/users/7341067/luc"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1540351471, "post_id": 52959661, "comment_id": 92828116, "body": "No luck, bundle update gives me the same error"}, {"owner": {"reputation": 1479, "user_id": 7265539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31eec411bb48a64b76830217b2d23a89?s=128&d=identicon&r=PG&f=1", "display_name": "mochi", "link": "https://stackoverflow.com/users/7265539/mochi"}, "edited": false, "score": 0, "creation_date": 1540353359, "post_id": 52959661, "comment_id": 92828485, "body": "Try uninstalling all gems <code>gem uninstall -aIx</code>, delete the gemfile lock and bundle again <code>bundle install</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1540369388, "post_id": 52959661, "comment_id": 92834986, "body": "Can everyone suggesting to &quot;delete everything and start again&quot; please <b>stop</b>? Read the error message. It states that there is an incompatibility between the rails and simple_form versions. If you think that the error message is unclear, perhaps you could raise this with the bundler team, and suggest a better format. Personally, I think it&#39;s perfectly understandable."}], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 10014963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x6ekF.png?s=128&g=1", "display_name": "MibraDev", "link": "https://stackoverflow.com/users/10014963/mibradev"}, "reply_to_user": {"reputation": 317, "user_id": 7341067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fce45159be2fa7f551e677d49ce1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luc", "link": "https://stackoverflow.com/users/7341067/luc"}, "edited": false, "score": 0, "creation_date": 1540462713, "post_id": 52963123, "comment_id": 92879130, "body": "Glad to help :)"}, {"owner": {"reputation": 175, "user_id": 4949887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b-MBYZruWrM/AAAAAAAAAAI/AAAAAAAAAD8/v7P08JEdRRU/photo.jpg?sz=128", "display_name": "Ahmed J.", "link": "https://stackoverflow.com/users/4949887/ahmed-j"}, "edited": false, "score": 0, "creation_date": 1588348769, "post_id": 52963123, "comment_id": 108868935, "body": "Thanks MibraDev, you saved me time and effort."}], "tags": [], "owner": {"reputation": 731, "user_id": 10014963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x6ekF.png?s=128&g=1", "display_name": "MibraDev", "link": "https://stackoverflow.com/users/10014963/mibradev"}, "is_accepted": true, "score": 4, "last_activity_date": 1540365813, "creation_date": 1540365813, "answer_id": 52963123, "question_id": 52959661, "link": "https://stackoverflow.com/questions/52959661/bundler-install-could-not-find-compatible-versions-for-gem-actionpack-rail/52963123#52963123", "title": "Bundler install - could not find compatible versions for gem &quot;actionpack&quot; - Rails 5", "body": "<p>The problem is that <strong>devise</strong> and <strong>simple_form</strong> gems are outdated and not compatible with the current version of rails.</p>\n\n<p>You could try to install newer versions like this:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.1'\n\ngem 'rails', '~&gt; 5.2.0'\ngem 'sqlite3'\ngem 'puma', '~&gt; 3.11'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\n\ngem 'coffee-rails', '~&gt; 4.2'\ngem 'turbolinks', '~&gt; 5'\ngem 'jbuilder', '~&gt; 2.5'\ngem 'devise', '~&gt; 4.5.0'\ngem 'simple_form', '~&gt; 4.0.1'\ngem 'haml', '~&gt; 4.0.5'\n\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  gem 'capybara', '&gt;= 2.15', '&lt; 4.0'\n  gem 'selenium-webdriver'\n  gem 'chromedriver-helper'\nend\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>then run <code>bundle install</code></p>\n\n<p>Also consider updating the <strong>haml</strong> gem if you want:</p>\n\n<p><code>gem 'haml', '~&gt; 5.0.4'</code> instead of <code>gem 'haml', '~&gt; 4.0.5'</code></p>\n\n<p>then run <code>bundle update</code></p>\n"}], "owner": {"reputation": 317, "user_id": 7341067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40fce45159be2fa7f551e677d49ce1dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luc", "link": "https://stackoverflow.com/users/7341067/luc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3793, "favorite_count": 0, "accepted_answer_id": 52963123, "answer_count": 1, "score": 2, "last_activity_date": 1540365813, "creation_date": 1540342296, "last_edit_date": 1540348597, "question_id": 52959661, "link": "https://stackoverflow.com/questions/52959661/bundler-install-could-not-find-compatible-versions-for-gem-actionpack-rail", "title": "Bundler install - could not find compatible versions for gem &quot;actionpack&quot; - Rails 5", "body": "<p>I'm trying to set up ruby on rails to start studying it but I keep getting this error when I run bundle install.</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"actionpack\":\n  In Gemfile:\n    rails (~&gt; 5.2.0) was resolved to 5.2.0, which depends on\n      actionpack (= 5.2.0)\n\n    simple_form (~&gt; 3.0.2) was resolved to 3.0.4, which depends on\n      actionpack (~&gt; 4.0)\n\nBundler could not find compatible versions for gem \"rails\":\n  In Gemfile:\n    rails (~&gt; 5.2.0)\n\nCould not find gem 'rails (~&gt; 5.2.0)' in any of the sources.\n</code></pre>\n\n<p>My Gemfile is this:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.1'\n\ngem 'rails', '~&gt; 5.2.0'\ngem 'sqlite3'\ngem 'puma', '~&gt; 3.11'\ngem 'sass-rails', '~&gt; 5.0'\ngem 'uglifier', '&gt;= 1.3.0'\n\ngem 'coffee-rails', '~&gt; 4.2'\ngem 'turbolinks', '~&gt; 5'\ngem 'jbuilder', '~&gt; 2.5'\ngem 'devise', '~&gt; 3.4.1'\ngem 'simple_form', '~&gt; 3.0.2'\ngem 'haml', '~&gt; 4.0.5'\n\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\ngroup :development, :test do\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  gem 'capybara', '&gt;= 2.15', '&lt; 4.0'\n  gem 'selenium-webdriver'\n  gem 'chromedriver-helper'\nend\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>Can somebody help me out?\nI'm really new to rails, in fact I'm trying to start learning it, so I have no clue on how to solve this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5", "friendly-id"], "comments": [{"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1540341846, "post_id": 52959236, "comment_id": 92826322, "body": "I think <code>@employer_review.employer_id = @employer_review.id</code> in <code>EmployerReviewsController#create</code>  is a bug"}], "answers": [{"comments": [{"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "edited": false, "score": 0, "creation_date": 1540343678, "post_id": 52959593, "comment_id": 92826659, "body": "Controllers should be separate for sure. Currently your controllers are ok. Just change routing."}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1540347296, "post_id": 52959593, "comment_id": 92827364, "body": "I tried your approach and made some progress. The issue that I&#39;m having now, is the the validation is showing blank and returning back to the new action. Which probably means one of the model ids are not saving to the form before insertion. I tried to create the record inside of the console and it worked without issue. The employer_id is not &lt;%= link_to &quot;Review Company&quot;, new_employer_employer_review_path(@employer), class: &#39;bttn-bordered bttn-md bttn-royal&#39; %&gt; is not storing the employer_id. What can I do to get the value to store before the form commits?"}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1540347371, "post_id": 52959593, "comment_id": 92827381, "body": "I removed the @employer variable from the form as you asked. Now its just &lt;%= simple_form_for(@employer_review) %&gt; What do I do next?"}, {"owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1540347984, "post_id": 52959593, "comment_id": 92827483, "body": "For the employer_review migration. Its set to t.references :user and t.references :employer. Both should be available by default to the form. That&#39;s most likely why its not working correctly. I need to get a reference id from employers."}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "edited": false, "score": 0, "creation_date": 1540350250, "post_id": 52959593, "comment_id": 92827907, "body": "Let&#39;s go to <a href=\"https://chat.stackoverflow.com/rooms/182392/room-for-ilya-konyukhov-and-cole-phiper\">chat</a>"}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 2, "last_activity_date": 1540341667, "creation_date": 1540341667, "answer_id": 52959593, "question_id": 52959236, "link": "https://stackoverflow.com/questions/52959236/activerecordrecordnotfound-couldnt-find-employer-without-an-id-while-using/52959593#52959593", "title": "ActiveRecord::RecordNotFound (Couldn&#39;t find Employer without an ID) while using form Rails 5", "body": "<p>Your <code>employers</code> and <code>employer_reviews</code> resources are not nested. It means <code>employer_id</code> param in your <code>EmployerReviewsController</code> is <code>nil</code> (if it is not set explicitly in query string). Calling <code>set_employer</code> filter has no effect and <code>@employer</code> instance variable is <code>nil</code>. That's why <code>simple_form</code> cannot find that employer (without id).</p>\n\n<p>You either have to turn <code>employer_reviews</code> to <a href=\"https://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested resource</a> of <code>employers</code>, or remove <code>@employer</code> variable from <code>EmployerReviewsController</code> and use <code>simple_form</code> solely for <code>@employer_review</code>.</p>\n"}], "owner": {"reputation": 349, "user_id": 10113461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d10ba7f075a993b14e5d70e166a912a?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Phiper", "link": "https://stackoverflow.com/users/10113461/cole-phiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540348511, "creation_date": 1540338446, "last_edit_date": 1540348511, "question_id": 52959236, "link": "https://stackoverflow.com/questions/52959236/activerecordrecordnotfound-couldnt-find-employer-without-an-id-while-using", "title": "ActiveRecord::RecordNotFound (Couldn&#39;t find Employer without an ID) while using form Rails 5", "body": "<p>I checked various solutions that are available, but none seem to address the issue that I am having with my project. I am trying to allow the user to create reviews through the <code>EmployerReview</code> model for the employer. When I pass the <code>employer_id</code> to the <code>form_for</code> in the <code>employer_reviews_controller</code> it claims that it cannot find an employer without an ID. The id is being passed with the <code>@employer</code> instance variable. I don't get why it's not working. Lastly, I am using <code>friendly_id</code>, and it shows at the end of the new employer review address <strong>employer_reviews/new.bryers</strong>. How can I stop this error from occurring?</p>\n\n<p><strong>schema</strong></p>\n\n<pre><code>create_table \"employer_reviews\", force: :cascade do |t|\n    t.text \"review_body\"\n    t.string \"review_title\"\n    t.bigint \"user_id\"\n    t.bigint \"employer_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"employer_id\"], name: \"index_employer_reviews_on_employer_id\"\n    t.index [\"user_id\"], name: \"index_employer_reviews_on_user_id\"\n  end\n</code></pre>\n\n<p><strong>employer_review.rb</strong></p>\n\n<pre><code>class EmployerReview &lt; ApplicationRecord\n  belongs_to :employer\n  belongs_to :user\nend\n</code></pre>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :employer_reviews, dependent: :destroy\nend\n</code></pre>\n\n<p><strong>employer.rb</strong></p>\n\n<pre><code>class Employer &lt; ApplicationRecord\n  extend FriendlyId\n  friendly_id :username, use: [:slugged, :finders]\n  has_many :employer_reviews, dependent: :destroy\nend\n</code></pre>\n\n<p><strong>employers_controller.rb</strong></p>\n\n<pre><code>class EmployersController &lt; ApplicationController\n  before_action :set_employer, only: [:show]\n\n  def show\n    impressionist(@employer)\n  end\n\n\n  private\n\n  def set_employer\n    @employer = Employer.find(params[:id])\n  end\nend\n</code></pre>\n\n<p><strong>employer_reviews_controller.rb</strong></p>\n\n<pre><code>class EmployerReviewsController &lt; ApplicationController\n  before_action :set_employer_review, only: [:show, :edit, :update, :destroy]\n  before_action :set_employer\n  before_action :authenticate_user!\n\n  # GET /employer_reviews/1\n  # GET /employer_reviews/1.json\n  def show\n  end\n\n  # GET /employer_reviews/new\n  def new\n    @employer_review = EmployerReview.new\n  end\n\n  # GET /employer_reviews/1/edit\n  def edit\n  end\n\n  # POST /employer_reviews\n  # POST /employer_reviews.json\n  def create\n    @employer_review = EmployerReview.new(employer_review_params)\n    @employer_review.user_id = current_user.id\n    @employer_review.employer_id = @employer_review.id\n\n    respond_to do |format|\n      if @employer_review.save\n        format.html {redirect_to @employer_review, notice: 'Employer review was successfully created.'}\n        format.json {render :show, status: :created, location: @employer_review}\n      else\n        format.html {render :new}\n        format.json {render json: @employer_review.errors, status: :unprocessable_entity}\n      end\n    end\n  end\n\n  # PATCH/PUT /employer_reviews/1\n  # PATCH/PUT /employer_reviews/1.json\n  def update\n    respond_to do |format|\n      if @employer_review.update(employer_review_params)\n        format.html {redirect_to @employer_review, notice: 'Employer review was successfully updated.'}\n        format.json {render :show, status: :ok, location: @employer_review}\n      else\n        format.html {render :edit}\n        format.json {render json: @employer_review.errors, status: :unprocessable_entity}\n      end\n    end\n  end\n\n  # DELETE /employer_reviews/1\n  # DELETE /employer_reviews/1.json\n  def destroy\n    @employer_review.destroy\n    respond_to do |format|\n      format.html {redirect_to employer_reviews_url, notice: 'Employer review was successfully destroyed.'}\n      format.json {head :no_content}\n    end\n  end\n\n  private\n\n  # Use callbacks to share common setup or constraints between actions.\n  def set_employer_review\n    @employer_review = EmployerReview.find(params[:id])\n  end\n\n  def set_employer\n    @employer = Employer.find(params[:employer_id])\n  end\n\n  # Never trust parameters from the scary internet, only allow the white list through.\n  def employer_review_params\n    params.require(:employer_review).permit([:review_title, :review_body])\n  end\nend\n</code></pre>\n\n<p><strong>employer show.html.erb</strong></p>\n\n<pre><code>&lt;%= link_to 'Write a review', new_employer_review_path(@employer) %&gt;\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>resources :employers\nresources :employer_reviews\n</code></pre>\n\n<p><strong>review form</strong></p>\n\n<pre><code>&lt;%= simple_form_for([@employer, @employer_review]) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label&gt;Review Title&lt;/label&gt;\n    &lt;%= f.input :review_title, class: 'form-control', placeholder: 'Add a review title' %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;label&gt;Tell us about your experience&lt;/label&gt;\n    &lt;%= f.input :review_body, :as =&gt; :text, :input_html =&gt; { 'rows' =&gt; 5, 'cols' =&gt; 10 }, class: 'form-control', placeholder: 'Add a review title' %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>UPDATE 1:\nI'm receiving the error below when I use both @employer_review and @employer in the simple_form.</p>\n\n<pre><code>ActionView::Template::Error (undefined method `model_name' for nil:NilClass):\n    1: &lt;%= simple_form_for([@employer_review, @employer]) do |f| %&gt;\n    2:   &lt;%= f.error_notification %&gt;\n    3:   &lt;div class=\"form-group\"&gt;\n    4:     &lt;label&gt;Review Title&lt;/label&gt;\n\napp/views/employer_reviews/_form.html.erb:1:in `_app_views_employer_reviews__form_html_erb__154747394_155744960'\napp/views/employer_reviews/new.html.erb:3:in `_app_views_employer_reviews_new_html_erb__376973310_155859880'\nProcessing by ExceptionHandler::ExceptionsController#show as HTML\n  Parameters: {\"employer_id\"=&gt;\"test_employer\"}\nCompleted 500 Internal Server Error in 404ms (ActiveRecord: 0.0ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1540341917, "post_id": 52959247, "comment_id": 92826339, "body": "ok so all you&#39;ve done is moved the parenthesis... but like... why does that work??? why did mine not?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1540346615, "post_id": 52959247, "comment_id": 92827225, "body": "james, I was in a rush when I posted my answer,  so didn&#39;t look at your solution carefully. I just did an edit to explain why your code didn&#39;t work."}, {"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1540402976, "post_id": 52959247, "comment_id": 92856561, "body": "oh... the string vs symbol is also a symptom of some code was copied/pasted, some was just hastily written here..."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1540403453, "last_edit_date": 1540403453, "creation_date": 1540338535, "answer_id": 52959247, "question_id": 52959159, "link": "https://stackoverflow.com/questions/52959159/correct-my-code-sort-by-2-attributes-first-attribute-defers-to-second-attribut/52959247#52959247", "title": "Correct my code: Sort_by 2 attributes, first attribute defers to second attribute if it&#39;s one of TWO values", "body": "<p>The problem with your code (aside from a missing <code>end</code> statement, which I expect didn't survive a cut-and-paste) is that the hashes do not have keys <code>\"payment_method\"</code> and <code>\"amount\"</code> (<code>charges.first.keys #=&gt; [:payment_method, :amount]</code>). :-)</p>\n\n<p>With the correction your code works fine:</p>\n\n<pre><code>charges.sort_by {|h| [[\"card\", \"stripe\"].include?(h[:payment_method]) ? 0 : 1, h[:amount]]}\n  # [{:payment_method=&gt;\"stripe\", :amount=&gt; 500},\n  #  {:payment_method=&gt;\"card\",   :amount=&gt;1000},\n  #  {:payment_method=&gt;\"stripe\", :amount=&gt;1500},\n  #  {:payment_method=&gt;\"card\",   :amount=&gt;2000}, \n  #  {:payment_method=&gt;\"cash\",   :amount=&gt; 200},\n  #  {:payment_method=&gt;\"cash\",   :amount=&gt;4000}]\n</code></pre>\n\n<p>Let's look more closely at what your code was doing.</p>\n\n<p>Because the hashes do not have keys <code>\"paymment_method\"</code> and <code>\"amount\"</code>, <code>obj[\"paymment_method\"] #=&gt; nil</code> and <code>obj[\"amount\"] #=&gt; nil</code> for all <code>obj</code>. Therefore,</p>\n\n<pre><code>[\"card\",\"stripe\"].include? obj[\"payment_method\"]\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>[\"card\",\"stripe\"].include? nil\n</code></pre>\n\n<p>which is <code>false</code> for all <code>obj</code>. Therefore, the first element of the sorting array used by <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a> is always <code>1</code>.</p>\n\n<p><code>sort_by</code> uses <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Array#&lt;=></a> for ordering arrays.<sup>1</sup> When comparing <code>obj1[\"amount\"]</code> and <code>obj2[\"amount\"]</code>, the instance method <code>&lt;=&gt;</code> defined on the class of <code>obj1</code> and <code>obj2</code> is employed. In this case</p>\n\n<pre><code> obj1[\"amount\"] &lt;=&gt; obj2[\"amount\"] #=&gt; nil &lt;=&gt; nil\n</code></pre>\n\n<p>We see from</p>\n\n<pre><code>nil.method(:&lt;=&gt;).owner #=&gt; Kernel\nArray.ancestors        #=&gt; [Array, Enumerable, Object, Kernel, BasicObject]\n</code></pre>\n\n<p>that <code>NilClass</code> has an instance method <code>&lt;=&gt;</code> that it gets from <code>Kernel</code> (<a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Object#&lt;=></a><sup>2</sup>) that returns zero whenever the objects being compared are equal (here <code>nil &lt;=&gt; nil #=&gt; 0</code>). The sorting comparison, therefore, is always <code>[1, nil] &lt;=&gt; [1, nil]</code>, meaning that the sort is effectively random.</p>\n\n<p><sup>1 See the latter doc--specifically, the third paragraph--for an explanation of how that is done.</sup></p>\n\n<p><sup>2 To understand why <code>Kernel#&lt;=&gt;</code> is documented in <a href=\"http://ruby-doc.org/core-2.5.1/Object.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">Object</a> see the third paragraph at the link.</sup></p>\n"}], "owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 52959247, "answer_count": 1, "score": 0, "last_activity_date": 1540403453, "creation_date": 1540337826, "question_id": 52959159, "link": "https://stackoverflow.com/questions/52959159/correct-my-code-sort-by-2-attributes-first-attribute-defers-to-second-attribut", "title": "Correct my code: Sort_by 2 attributes, first attribute defers to second attribute if it&#39;s one of TWO values", "body": "<p>Given:</p>\n\n<pre><code>charges = [\n  {payment_method:\"card\",amount:1000},\n  {payment_method:\"stripe\",amount:500},\n  {payment_method:\"stripe\",amount:1500},\n  {payment_method:\"card\",amount:2000},\n  {payment_method:\"cash\",amount:200},\n  {payment_method:\"cash\",amount:4000},\n]\n</code></pre>\n\n<p>I want to sort according to 2 rules:</p>\n\n<ol>\n<li>Card OR stripe payment methods should show up first, and then be sorted by amount, lowest to highest</li>\n<li>Any other payment methods should show up last, and then be sorted by amount, lowest to highest</li>\n</ol>\n\n<p>My current code is moving card or stripe to the front, but not sorting by the amount:</p>\n\n<pre><code>charges.sort_by do |obj| \n  [ \n    ([\"card\",\"stripe\"].include? obj[\"payment_method\"]) ? 0 : 1 , \n    obj[\"amount\"]\n  ]\n\n# result of MY sort:\ncharges = [\n  {:payment_method=&gt;\"card\", :amount=&gt;1000},\n  {:payment_method=&gt;\"stripe\", :amount=&gt;500},\n  {:payment_method=&gt;\"stripe\", :amount=&gt;1500},\n  {:payment_method=&gt;\"card\", :amount=&gt;2000},\n  {:payment_method=&gt;\"cash\", :amount=&gt;200},\n  {:payment_method=&gt;\"cash\", :amount=&gt;4000},\n]\n\n# result of DESIRED sort:\ncharges = [\n  {:payment_method=&gt;\"stripe\", :amount=&gt;500},\n  {:payment_method=&gt;\"card\", :amount=&gt;1000},\n  {:payment_method=&gt;\"stripe\", :amount=&gt;1500},\n  {:payment_method=&gt;\"card\", :amount=&gt;2000},\n  {:payment_method=&gt;\"cash\", :amount=&gt;200},\n  {:payment_method=&gt;\"cash\", :amount=&gt;4000},\n]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1540335277, "post_id": 52958813, "comment_id": 92824963, "body": "It <i>looks</i> like <code>:-</code> is the binary <code>a - b</code> operator and <code>:-@</code> is the unary <code>-a</code> operator."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540335344, "post_id": 52958813, "comment_id": 92824977, "body": "see <a href=\"https://www.tutorialspoint.com/ruby/ruby_operators.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/ruby/ruby_operators.htm</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1540335387, "post_id": 52958813, "comment_id": 92824988, "body": "Do you know what <code>list.map(&amp;:foo)</code> does?"}, {"owner": {"reputation": 511, "user_id": 2364401, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BeNhZ.png?s=128&g=1", "display_name": "xander-miller", "link": "https://stackoverflow.com/users/2364401/xander-miller"}, "edited": false, "score": 0, "creation_date": 1540335743, "post_id": 52958813, "comment_id": 92825076, "body": "ampersand colon would call the meth foo as a proc <a href=\"https://stackoverflow.com/questions/1961030/ruby-ampersand-colon-shortcut\" title=\"ruby ampersand colon shortcut\">stackoverflow.com/questions/1961030/&hellip;</a>"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1540375876, "post_id": 52958813, "comment_id": 92839021, "body": "You can check with any number as <code>23.methods =&gt; [:to_s, :inspect, :-@, ..</code> It is mandatory for list to have all objects which supports method  &#39;-@&#39;"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1540585952, "post_id": 52958813, "comment_id": 92935480, "body": "@xander-miller: So, if <code>list.map(&amp;:foo)</code> calls a method named <code>foo</code> on every element, then what does <code>list.map(&amp;:@-)</code> do?"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 2364401, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BeNhZ.png?s=128&g=1", "display_name": "xander-miller", "link": "https://stackoverflow.com/users/2364401/xander-miller"}, "edited": false, "score": 1, "creation_date": 1540336131, "post_id": 52958883, "comment_id": 92825162, "body": "I found my answer in the comments on codeWars. <code>-@</code> is actually a method on integer. If you call <code>1.methods</code> you can see it. The method inverts the value of the integer."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 511, "user_id": 2364401, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BeNhZ.png?s=128&g=1", "display_name": "xander-miller", "link": "https://stackoverflow.com/users/2364401/xander-miller"}, "edited": false, "score": 0, "creation_date": 1540336272, "post_id": 52958883, "comment_id": 92825203, "body": "yes that was clearly explained in the link I commented on your question but this clearly illustrates a use case IMHO."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 511, "user_id": 2364401, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BeNhZ.png?s=128&g=1", "display_name": "xander-miller", "link": "https://stackoverflow.com/users/2364401/xander-miller"}, "edited": false, "score": 2, "creation_date": 1540337519, "post_id": 52958883, "comment_id": 92825449, "body": "@xander-miller It is not specific to Integer, it is merely a syntax for defining unary operators, not just <code>-</code>. Think of a vector class, you would likely define unary negation, and they are not integers. It is just another method name, with some different syntax on how to clarify it from a binary operator."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540335485, "creation_date": 1540335485, "answer_id": 52958883, "question_id": 52958813, "link": "https://stackoverflow.com/questions/52958813/what-is-in-ruby/52958883#52958883", "title": "What is `-@` in ruby?", "body": "<p>Here's an example of how you can use it</p>\n\n<pre><code>[1,2].map(&amp;:-@) #=&gt; [-1, -2]\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 2364401, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BeNhZ.png?s=128&g=1", "display_name": "xander-miller", "link": "https://stackoverflow.com/users/2364401/xander-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1540335322, "answer_count": 1, "score": 1, "last_activity_date": 1540362433, "creation_date": 1540334875, "last_edit_date": 1540362433, "question_id": 52958813, "link": "https://stackoverflow.com/questions/52958813/what-is-in-ruby", "closed_reason": "Duplicate", "title": "What is `-@` in ruby?", "body": "<p>I ran into this code snippet in a codeWars solution.</p>\n\n<pre><code>def invert(list)\n  list.map(&amp;:-@)\nend\n</code></pre>\n\n<p>I've never seen the <code>@</code> before in ruby. It looks like it lets you specify an operation on the iterator in a <code>&amp;:</code> anonymous function call.</p>\n\n<p>I'm trying to work on my ruby terminology. What is the <code>@</code> called in Ruby and when was it introduced?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540335301, "post_id": 52958213, "comment_id": 92824970, "body": "Not directly related to your question, but consider putting all of a book&#39;s attributes in a hash with keys <code>:name</code>, <code>:address</code> and so on. Note that <code>attr_accessor :book_id</code> makes your getter method <code>book_id</code> redundant."}, {"owner": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540377571, "post_id": 52958213, "comment_id": 92840059, "body": "@CarySwoveland Just done it, thank you :-)"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "edited": false, "score": 0, "creation_date": 1540378186, "post_id": 52958659, "comment_id": 92840429, "body": "Hi, thanks for your reply, I just tried your code, but it said  <b>coursework2/user.rb:24:in <code>userlist&#39;: undefined method </code>name&#39; for #&lt;Book:0x00007fbe9b909be0&gt; (NoMethodError) from coursework2/user.rb:46:in `&lt;main&gt;&#39;</b>, maybe there is some problem with <b>borrow.name</b>? Because I feel <b>name</b> here is library user&#39;s name, but not book&#39;s name, I am going to write code gives me result of book&#39;s name. :-)"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "edited": false, "score": 0, "creation_date": 1540379375, "post_id": 52958659, "comment_id": 92841109, "body": "Yeah I had a mistake on line 24, it&#39;s fixed now. I updated my code. Try it."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1540379348, "last_edit_date": 1540379348, "creation_date": 1540333658, "answer_id": 52958659, "question_id": 52958213, "link": "https://stackoverflow.com/questions/52958213/how-to-use-attribute-in-different-files/52958659#52958659", "title": "how to use attribute in different files?", "body": "<pre><code>#user.rb\nrequire_relative 'book.rb'\n\nclass User\n  attr_accessor :name, :address, :gender, :age, :id, :borrow\n\n  def initialize(name, address, gender, age, id, borrow)\n    @name = name\n    @address = address\n    @gender = gender\n    @age = age\n    @id = id\n    @borrow = borrow\n  end\n\n  def userlist\n    @name = @name.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @address = @address.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @age.to_s\n    @id.to_s\n\n    if borrow.nil?\n      puts \"nothing\"\n    elsif borrow\n      puts borrow.title\n    else\n      puts \"error\"\n    end\n  end\nend\n\n@book = Book.new('Book1', 'Auth1', 'EN', 'fiction', 'isb123', 1, 'borrowed')\n@user = User.new('Mr Foo', '123 st', 'male', 23, 123, nil)\n@user.borrow=@book\n@user.userlist \n#=&gt;Book1\n</code></pre>\n\n<p>But you might instead want to send an array of books, then you'll need to modify your method to handle array</p>\n\n<pre><code>def userlist\n  @name = @name.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n  @address = @address.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n  @age.to_s\n  @id.to_s\n\n  if borrow.nil?\n    puts \"nothing\"\n  elsif borrow.length &gt; 0 # checks if anythint in the array\n    borrow.each{ |b| puts b.title }\n  else\n    puts \"error\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9711242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RfjDb.jpg?s=128&g=1", "display_name": "seki", "link": "https://stackoverflow.com/users/9711242/seki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52958659, "answer_count": 1, "score": 0, "last_activity_date": 1540379348, "creation_date": 1540330838, "question_id": 52958213, "link": "https://stackoverflow.com/questions/52958213/how-to-use-attribute-in-different-files", "title": "how to use attribute in different files?", "body": "<p>I am finishing my coursework, a simple library system.</p>\n\n<p>I am facing a problem like below:</p>\n\n<p><em>book.rb</em></p>\n\n<pre><code>class Book\n  attr_accessor :title, :author, :language, :classification, :isbn, :book_id, :borrow_status\n\n\n\n  def initialize(title, author, language, classification, isbn, book_id, borrow_status)\n    @title = title\n    @author = author\n    @language = language\n    @classification = classification\n    @isbn = isbn\n    @book_id = book_id\n    @borrow_status = borrow_status\n  end\n\n  def bookid\n    @book_id\n  end\n\n  def booklist\n    @title = @title.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @author = @author.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @language = @language.capitalize!\n    @isbn.to_s\n    @book_id.to_s\n\n    {\n        \"Title\" =&gt; @title,\n        \"Author\" =&gt; @author,\n        \"Language\" =&gt; @language,\n        \"Classification\" =&gt; @classification,\n        \"ISBN\" =&gt; @isbn,\n        \"Book ID\" =&gt; @book_id,\n        \"Status\" =&gt; @borrow_status,\n    }\n  end\n\n\nend\n</code></pre>\n\n<p><em>user.rb</em></p>\n\n<pre><code>require_relative 'book.rb'\n\nclass User\n  attr_accessor :name, :address, :gender, :age, :id, :borrow\n\n  def initialize(name, address, gender, age, id, borrow)\n    @name = name\n    @address = address\n    @gender = gender\n    @age = age\n    @id = id\n    @borrow = borrow\n  end\n\n  def userlist\n    @name = @name.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @address = @address.split(/ |\\_|\\-/).map(&amp;:capitalize).join(\" \")\n    @age.to_s\n    @id.to_s\n\n    if @borrow.nil?\n      puts \"nothing\"\n    elsif\n      puts #I wish I can put book's name here, if I entered correct @borrow. eg.,for user3's @borrow=4(in top.rb), user3.@borrow=book4.@book_id, then print @name of book4\n    else\n      puts \"error\"\n    end\n</code></pre>\n\n<p>the problem is inside user.rb, in if-elsif-else loop, which is </p>\n\n<blockquote>\n  <p>I wish I can put book's name here, if I entered correct @borrow.\n  eg.,for user3's @borrow=4(in top.rb), user3.@borrow=book4.@book_id,\n  then print @name of book4</p>\n</blockquote>\n\n<p>any solution?</p>\n"}, {"tags": ["ruby", "command-line", "terminal"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1540376417, "post_id": 52958073, "comment_id": 92839331, "body": "Adding simplification to method - <code>def squre(n); 1.upto(n) { |x| puts x*x }; end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1540330178, "post_id": 52958094, "comment_id": 92823540, "body": "@b.herring Wait you want the someone to run it? One second I will update my answer."}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1540330264, "post_id": 52958094, "comment_id": 92823572, "body": "yeah, i want someone else to use it in the terminal. i&#39;ve made it work with gets.chomp. but i was just wondering if you could do it literally by just typing squares(3) in the terminal."}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1540330508, "post_id": 52958094, "comment_id": 92823647, "body": "@b.herring I have updated my answer. What you are asking for is achievable is using <code>eval</code> but not recommended."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "is_accepted": true, "score": 0, "last_activity_date": 1540330940, "last_edit_date": 1540330940, "creation_date": 1540330101, "answer_id": 52958094, "question_id": 52958073, "link": "https://stackoverflow.com/questions/52958073/calling-a-ruby-method-in-the-ruby-terminal/52958094#52958094", "title": "calling a ruby method in the ruby terminal", "body": "<p>You can use <code>gets</code> method to get user input then parse it as int and call <code>squares</code> on it.</p>\n\n<p>Try this</p>\n\n<pre><code>def squares(input)\n  numbers = (1..input)\n  numbers.each do |number|\n    puts number * number\n  end\nend\n\ndef setup_input_loop\n  loop do\n    puts \"Print square from 1 to n. Please enter n.\"\n    input = gets.chomp.to_i\n    squares(input)\n    puts\n  end\nend\n\nsetup_input_loop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 205702, "user_id": 7552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b60298053f87465641c1b1192338c8cd?s=128&d=identicon&r=PG", "display_name": "glenn jackman", "link": "https://stackoverflow.com/users/7552/glenn-jackman"}, "is_accepted": false, "score": 2, "last_activity_date": 1540331448, "last_edit_date": 1540331448, "creation_date": 1540330855, "answer_id": 52958217, "question_id": 52958073, "link": "https://stackoverflow.com/questions/52958073/calling-a-ruby-method-in-the-ruby-terminal/52958217#52958217", "title": "calling a ruby method in the ruby terminal", "body": "<p>If you want a <em>shell</em> function that calls that ruby method:</p>\n\n<pre><code>squares() {\n    ruby -e '\n      def squares(input)\n        numbers = (1..input)\n        numbers.each do |number|\n          puts number * number\n        end\n      end\n      squares ARGV.shift.to_i\n    ' -- \"$1\"\n}\n</code></pre>\n\n<p>then</p>\n\n<pre><code>$ squares 3\n1\n4\n9\n</code></pre>\n\n<hr>\n\n<p>If, by \"ruby terminal\", you mean <code>irb</code> then add that method to your <code>~/.irbrc</code> file, then you can do</p>\n\n<pre><code>$ cat ~/.irbrc\ndef squares(input)\n  numbers = (1..input)\n  numbers.each do |number|\n    puts number * number\n  end\nend\n\n$ irb\nirb(main):001:0&gt; squares(3)\n1\n4\n9\n=&gt; 1..3\nirb(main):002:0&gt; \n</code></pre>\n\n<hr>\n\n<p>Just for fun, monkey patching the Integer class:</p>\n\n<pre><code>$ cat ~/.irbrc\nclass Integer\n  def squares\n    1.upto(self) {|n| puts n * n}\n    self\n  end\nend\n</code></pre>\n\n\n\n<pre><code>$ irb\nirb(main):001:0&gt; 3.squares\n1\n4\n9\n=&gt; 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540334576, "creation_date": 1540334576, "answer_id": 52958780, "question_id": 52958073, "link": "https://stackoverflow.com/questions/52958073/calling-a-ruby-method-in-the-ruby-terminal/52958780#52958780", "title": "calling a ruby method in the ruby terminal", "body": "<p>Here's a variation that can be executed without prepending <code>ruby</code> to the filename and also doesn't make an infinite loop.</p>\n\n<pre><code># make a file called square_loop.rb\n\n#!/usr/bin/env ruby\ndef squares(input)\n  numbers = (1..input)\n  numbers.each do |number|\n    puts number * number\n  end\nend\n\ndef setup_input_loop\n  loop do\n    puts \"Print square from 1 to n. Please enter n or X to exit\"\n    input = gets.chomp\n    exit if input.downcase == 'x' \n    squares(input.to_i)\n    puts\n  end\nend\n\nsetup_input_loop\n</code></pre>\n\n<p>Then just make it executable with</p>\n\n<pre><code>chmod +x square_loop.rb\n</code></pre>\n\n<p>Then call it from your terminal with \n    ./square_loop.rb</p>\n\n<p>Though prepending ruby works too</p>\n\n<pre><code>ruby square_loop.rb\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 52958094, "answer_count": 3, "score": 0, "last_activity_date": 1540334576, "creation_date": 1540329989, "question_id": 52958073, "link": "https://stackoverflow.com/questions/52958073/calling-a-ruby-method-in-the-ruby-terminal", "title": "calling a ruby method in the ruby terminal", "body": "<p>i have a method that gives an amount of square numbers depending on the number a user gives. eg if the users input is 5, the result will be 1, 4, 9, 16, 25.\nThe method works. i was just wondering how to run this in the terminal. I know i need to do ruby squares.rb, which is the file name, but that just doesn't do anything afterwards. What i would like to happen is that someone could type squares(3), in the terminal, and get the result below it. im sure this is very simple aha, thanks.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>def squares(input)\r\n  numbers = (1..input)\r\n  numbers.each do |number|\r\n    puts number * number\r\n  end\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 10542565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KHCz54uDY7Q/AAAAAAAAAAI/AAAAAAAAAo0/jDTOYj3g8As/photo.jpg?sz=128", "display_name": "Nathan Kontny", "link": "https://stackoverflow.com/users/10542565/nathan-kontny"}, "is_accepted": false, "score": 0, "last_activity_date": 1540332504, "creation_date": 1540332504, "answer_id": 52958496, "question_id": 52957897, "link": "https://stackoverflow.com/questions/52957897/how-can-i-store-or-keep-in-memory-loaded-images-in-a-rails-app/52958496#52958496", "title": "How can I store or keep in memory loaded images in a rails app", "body": "<p>This sounds on the surface like a bad idea without knowing more about why you want to do this? Any reason these images aren't just in say S3? I say that because using something like S3 to serve up files is a much more efficient use of resources than having Rails shuffle huge files back in its responses. </p>\n\n<p>Also when you say \"in memory\", that can mean a lot of things. Like you could mean cache this giant list of image tags in Memcache or Redis. So you could fragment cache around images_base64 in your HAML file with something like <code>cache document do</code> That would store a chunk of image_tag html with the base64 image strings in your cache store. </p>\n\n<p>And this is a worse idea: you could memoize the images into memory. Here's a link on doing memoization with parameters: <a href=\"http://gavinmiller.io/2013/advanced-memoization-in-ruby/\" rel=\"nofollow noreferrer\">http://gavinmiller.io/2013/advanced-memoization-in-ruby/</a>. I only mention this because you said \"memory loaded\". But I really don't think you want this approach. </p>\n"}], "owner": {"reputation": 65, "user_id": 9749097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3995f74020227617b95fc7cd1ee5a85?s=128&d=identicon&r=PG&f=1", "display_name": "luftgekuhltlover", "link": "https://stackoverflow.com/users/9749097/luftgekuhltlover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540332504, "creation_date": 1540328978, "question_id": 52957897, "link": "https://stackoverflow.com/questions/52957897/how-can-i-store-or-keep-in-memory-loaded-images-in-a-rails-app", "title": "How can I store or keep in memory loaded images in a rails app", "body": "<p>I have this defined: </p>\n\n<pre><code>def images_base64(images)\n  images.map {|image| image.image}\nend\n</code></pre>\n\n<p>and then I load images like this in the haml file: </p>\n\n<pre><code>  - images_base64(@document.meta.images).each do |image|\n      = image_tag \"data:image/png;base64, #{image}\", width: '600px'\n</code></pre>\n\n<p>is there a way to store or keep in memory loaded images in rails? </p>\n"}, {"tags": ["html", "ruby-on-rails", "json", "ruby", "string"], "answers": [{"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 3, "last_activity_date": 1540334222, "last_edit_date": 1540334222, "creation_date": 1540326451, "answer_id": 52957364, "question_id": 52956925, "link": "https://stackoverflow.com/questions/52956925/using-ruby-grab-value-from-html-string-inside-a-json-response/52957364#52957364", "title": "Using Ruby, grab value from HTML string inside a JSON response", "body": "<p>If the response format remains the same with every request, you could use a plain regexp expression to fetch your data, even without parsing JSON. Example:</p>\n\n<pre><code>response = \"&lt;Data&gt;&lt;Entry Key=\\\"utm_campaign\\\" Value=\\\"j2c\\\" /&gt;&lt;Entry Key=\\\"utm_medium\\\" Value=\\\"cpc\\\" /&gt;&lt;Entry Key=\\\"utm_source\\\" Value=\\\"j2c\\\" /&gt;&lt;Entry Key=\\\"job_id\\\" Value=\\\"300_xxxx_10703\\\" /&gt;&lt;/Data&gt;\"\nmatch = response.match(%r{job_id\\\\?\"\\s+Value=\\\\?\"(.+)\\\\?\"}i)\nmatch[1] if match # =&gt; \"300_xxxx_10703\"\n</code></pre>\n\n<p>If the response format can change (for example, if the order of the attributes of <code>Entry</code> element can change), then you need to parse JSON and use some HTML parser, such as <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">Nokigiri</a>, to fetch required attrbute. Code example:</p>\n\n<pre><code>parsed_response = JSON.parse(response)\ndoc = Nokogiri::HTML(parsed_response['AdditionalData'])\n\njob_id = nil\ndoc.css('Entry').each do |el|\n  if el['Key'] == 'job_id'\n    job_id = el['Value']\n    break\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8980969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ec241825e8558496443203777a49fe?s=128&d=identicon&r=PG&f=1", "display_name": "gingerninja1", "link": "https://stackoverflow.com/users/8980969/gingerninja1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 52957364, "answer_count": 1, "score": 3, "last_activity_date": 1540422463, "creation_date": 1540324603, "last_edit_date": 1540422463, "question_id": 52956925, "link": "https://stackoverflow.com/questions/52956925/using-ruby-grab-value-from-html-string-inside-a-json-response", "title": "Using Ruby, grab value from HTML string inside a JSON response", "body": "<p>I have searched what I can and I don't seem to be finding the answer I need. Granted I may not be wording it properly. I have tried using <code>.find</code> or even <code>.rindex</code> to count backwards, but no such luck. The value I receive from the JSON looks something like this:</p>\n\n<pre><code>\"AdditionalData\":\"&lt;Data&gt;&lt;Entry Key=\\\"utm_campaign\\\" Value=\\\"j2c\\\" /&gt; \n&lt;Entry Key=\\\"utm_medium\\\" Value=\\\"cpc\\\" /&gt;&lt;Entry Key=\\\"utm_source\\\" \nValue=\\\"j2c\\\" /&gt;&lt;Entry Key=\\\"job_id\\\" Value=\\\"300_xxxx_10703\\\" /&gt;&lt;/Data&gt;\"\n</code></pre>\n\n<p>I need to be able to grab the value for the key \"job_id\", so the \"300_xxxx_11233\". This value will change per object returned by the JSON response. Any help would be appreciated, and please let me know if this is already out there and I just missed it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540322227, "post_id": 52955577, "comment_id": 92820253, "body": "can you post full stack trace on failed test?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540328513, "post_id": 52955577, "comment_id": 92822982, "body": "I&#39;ve updated my answer see below"}], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540320580, "post_id": 52955858, "comment_id": 92819447, "body": "That won&#39;t work because login_user is in a ControllerMacros, which is extended like this: config.extend ControllerMacros, type: :controller"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540320872, "post_id": 52955858, "comment_id": 92819580, "body": "ok but your test results indicate you don&#39;t have a logged in user, so you need to remedy that. can you post your routes.rb?"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540325345, "post_id": 52955858, "comment_id": 92821678, "body": "devise_for :users, controllers: {       sessions: &#39;users/sessions&#39;,       passwords: &#39;users/passwords&#39;,       registrations: &#39;users/registrations&#39;   }"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540326057, "post_id": 52955858, "comment_id": 92822052, "body": "also inside the test i checked valid? on user and it returned true"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540327449, "post_id": 52955858, "comment_id": 92822577, "body": "you still didn&#39;t post your routes.rb code. you should have something like <code>root to: &#39;some_place&#39;</code>"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540327697, "post_id": 52955858, "comment_id": 92822676, "body": "Yes I have it: root :to =&gt; &quot;home#index&quot;"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540327714, "post_id": 52955858, "comment_id": 92822686, "body": "Everything works fine outside of the test. Just I cannot log in via the test."}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1540338326, "post_id": 52955858, "comment_id": 92825606, "body": "The User model overrode the devise method active_for_authentication? with an adidtional attribute to verify! That is what the problem was! I only realized this after I created a sample app to try to reproduce the issue but I could not. The sample app worked. So then I returned to the user model and started searching through it until I found this override."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540328398, "last_edit_date": 1540328398, "creation_date": 1540320069, "answer_id": 52955858, "question_id": 52955577, "link": "https://stackoverflow.com/questions/52955577/controller-test-to-capture-unauthorized-response/52955858#52955858", "title": "Controller Test to capture unauthorized response", "body": "<p>UPDATED:  You don't need the 3rd test as that is view logic not controller and also alerts should work as expected in rails. However you just need to test that you're redirected as you'd expect.  Try this:</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe CodesController, type: :controller do\n  login_user\n\n  describe \"Get index\" do\n    subject { get :index }  \n\n    it 'denies access to marketing user' do\n      subject\n      expect(response.status).to be == 302\n    end\n\n    it 'redirects user to home page' do\n      expect(subject).to redirect_to(root_url)\n    end\n\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540328398, "creation_date": 1540319133, "last_edit_date": 1540326411, "question_id": 52955577, "link": "https://stackoverflow.com/questions/52955577/controller-test-to-capture-unauthorized-response", "title": "Controller Test to capture unauthorized response", "body": "<p>I am using Rspec to test controller behavior. When a user visits an unauthorized page, they are redirected to root_url and handed a message \"you are unauthorized\", as specified in my cancan (gem) rescue block:</p>\n\n<pre><code>rescue_from CanCan::AccessDenied do |exception|\n  redirect_to root_url, alert: exception.message\nend\n</code></pre>\n\n<p>I now want to test that they are redirected to root_url and that the response contains the message \"You are not authorized to access this page.\".\nHowever, the tests fail:</p>\n\n<pre><code>expected: \"http://test.host/\"\ngot: \"http://test.host/users/sign_in\"\n</code></pre>\n\n<p>And the other failure:</p>\n\n<pre><code>expected \"&lt;html&gt;&lt;body&gt;You are being &lt;a href=\\\"http://test.host/users/sign_in\\\"&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;\" to include \"You are not authorized to access this page.\"\n</code></pre>\n\n<p>These are the specs:</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe CodesController, type: :controller do\n  login_user\n\n  describe \"Get index\" do\n    it 'denies access to marketing user' do\n      get :index\n      expect(response.status).to be == 302\n    end\n\n    it 'redirects user to home page' do\n      get :index\n      expect(response.location).to eq(root_url)\n    end\n\n    it 'alerts user of unauthorized access' do\n      get :index\n      expect(response.body).to include('You are not authorized to access this page.')\n    end\n  end\nend\n</code></pre>\n\n<p>The first test passes. The second two fail. Yet, when I log in the website as marketing user, it does not redirect me to the sign_in page. It goes to the root_path as shown by the CanCan block. What I am not understanding about the response object in Rspec tests?</p>\n\n<p>This is where login_user is coming from:</p>\n\n<pre><code>module ControllerMacros\n  def login_user\n    before :example do\n      @request.env[\"devise.mapping\"] = Devise.mappings[:user]\n      marketing = create :marketing\n      sign_in marketing\n    end\n  end\nend\n</code></pre>\n\n<p>rails_helper.rb:</p>\n\n<pre><code>config.extend ControllerMacros, type: :controller\n</code></pre>\n\n<p>I am using:</p>\n\n<pre><code>rspec-rails 3.8.0  \ndevise 4.5.0\nrails 4.2.10\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1540318939, "post_id": 52955470, "comment_id": 92818676, "body": "It&#39;s a duplicate so whatever, but what if you have an unmatched bracket? <code>[foo] like [ this [&#47;foo]</code>"}, {"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1540319038, "post_id": 52955470, "comment_id": 92818725, "body": "If you have an unmatched bracket, this approach breaks."}, {"owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "edited": false, "score": 0, "creation_date": 1540319596, "post_id": 52955470, "comment_id": 92818982, "body": "Yeah that could be the case, so any instance of <code>[</code> or <code>]</code> would break the regex. But wouldn&#39;t it be possible to change <code>([^\\[\\]]*?)</code> to something that don&#39;t just ban <code>[</code> and <code>]</code>, but <code>[&#47;foo]</code>?"}, {"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1540319842, "post_id": 52955470, "comment_id": 92819105, "body": "Sure, you can implement something using lookahead, like <code>\\[foo\\]((?:[^\\[]|\\[(?!\\&#47;foo))+?)\\[\\&#47;foo\\]</code>, which also allows an opening bracket unless it&#39;s followed by <code>&#47;foo</code> inside."}], "tags": [], "owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "is_accepted": false, "score": 0, "last_activity_date": 1540318778, "creation_date": 1540318778, "answer_id": 52955470, "question_id": 52955412, "link": "https://stackoverflow.com/questions/52955412/how-to-capture-everything-inside-tags-like-e-g-foo-capture-this-foo/52955470#52955470", "title": "How to capture everything (.*) inside tags, like e.g. [foo] Capture this [/foo] [foo] and this [/foo]", "body": "<p>Change your regular expression so you don't match \"everything\" but just match \"everything except brackets\":</p>\n\n<pre><code>\\[foo\\]([^\\[\\]]*?)\\[\\/foo\\]\n</code></pre>\n"}], "owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1540318766, "answer_count": 1, "score": 0, "last_activity_date": 1540318778, "creation_date": 1540318560, "question_id": 52955412, "link": "https://stackoverflow.com/questions/52955412/how-to-capture-everything-inside-tags-like-e-g-foo-capture-this-foo", "closed_reason": "Duplicate", "title": "How to capture everything (.*) inside tags, like e.g. [foo] Capture this [/foo] [foo] and this [/foo]", "body": "<p>Inside my string there a one or more occurrences of a tag starting with <code>[foo]</code> and ending with <code>[/foo]</code>. So imagine a string like this:</p>\n\n<pre><code>string = \"[foo] Text inside tags [/foo] Text between tags [foo] Text inside tags [/foo]\"\n</code></pre>\n\n<p>I want to capture the text inside each occurrence. If there were just one occurrence my regex could simply be:</p>\n\n<pre><code>regex = /\\[foo\\](.*)\\[\\/foo\\]/\n</code></pre>\n\n<p>As anything could be inside the tags I have to capture it with <code>.*</code>. However by doing that I end up capturing everything between the first <code>[foo]</code> and the last <code>[/foo]</code>:</p>\n\n<pre><code>&lt; string.scan(regex)\n=&gt; [[\" Text inside tags [/foo] Text between tags [foo] Text inside tags \"]]\n</code></pre>\n\n<p><a href=\"http://rubular.com/r/YEi6XOFgAg\" rel=\"nofollow noreferrer\">Link to the regex at Rubular</a></p>\n\n<p>How do I avoid this?</p>\n"}, {"tags": ["ruby", "activerecord", "ruby-on-rails-5", "rails-activerecord"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1540317252, "post_id": 52954835, "comment_id": 92817883, "body": "Are you asking for <code>some_object.class &lt; ActiveRecord::Base</code>? <a href=\"https://ruby-doc.org/core-2.2.0/Module.html#method-i-3C\" rel=\"nofollow noreferrer\"><code>Module#&lt;</code></a> if you only care that there is an <code>id</code> then why not just <code>some_object.respond_to?(:id)</code>"}, {"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1540319824, "post_id": 52954835, "comment_id": 92819087, "body": "Oh cool, I wondered if I could save navigate <code>.id</code>, but assumed it wasn&#39;t possible. Thanks for that!"}, {"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1540320684, "post_id": 52954835, "comment_id": 92819499, "body": "safe navigate* :)"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "edited": false, "score": 0, "creation_date": 1540319899, "post_id": 52955100, "comment_id": 92819133, "body": "Awesome! I knew there was a simple solution. Thanks for answering"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1540369023, "post_id": 52955100, "comment_id": 92834758, "body": "By the way, this will <i>not</i> (as the OP asked) &quot;determine if a <b>variable</b> is an activerecord object or not&quot; (<b>bold</b> emphasis mine), it will instead determine if the <b>object</b> that is <b>referenced</b> by the variable is an activerecord object or not. A variable will <i>never</i> be an activerecord object. A variable will always be a variable. In fact, variables aren&#39;t really &quot;things&quot; in the Ruby language at runtime that you can manipulate. They are very restricted in what you can do: assign, dererefence, that&#39;s it. In particular, they are not objects."}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1540397492, "post_id": 52955100, "comment_id": 92853592, "body": "@J&#246;rgWMittag Have you already opened a ticket to rename <code>is_a?</code> method to <code>is_a_reference_to_an_object_of?</code> in <code>Object</code> class?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1540410897, "post_id": 52955100, "comment_id": 92860444, "body": "Why would I do that? It makes no sense. The <code>Object#is_a?</code> method tests whether an object is an instance of a module. It does not test whether an object is a reference to an object. In fact, only variables can be references to an object, and variables aren&#39;t objects, so clearly such a method cannot possibly exist."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 5, "last_activity_date": 1540514882, "last_edit_date": 1540514882, "creation_date": 1540317337, "answer_id": 52955100, "question_id": 52954835, "link": "https://stackoverflow.com/questions/52954835/is-it-possible-to-determine-if-a-variable-is-an-activerecord-object-or-not/52955100#52955100", "title": "Is it possible to determine if a variable is an activerecord object or not?", "body": "<p><a href=\"https://ruby-doc.org/core-2.5.3/Object.html#method-i-is_a-3F\" rel=\"nofollow noreferrer\">Object.is_a?</a> to the rescue:</p>\n\n<pre><code>user = User.first\nstr = \"Hello\"\n\nuser.is_a?(ActiveRecord::Base) # true\nstr.is_a?(ActiveRecord::Base)  # false\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 1562489, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ApdKz.jpg?s=128&g=1", "display_name": "David Sigley", "link": "https://stackoverflow.com/users/1562489/david-sigley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 52955100, "answer_count": 1, "score": 0, "last_activity_date": 1540514882, "creation_date": 1540316138, "question_id": 52954835, "link": "https://stackoverflow.com/questions/52954835/is-it-possible-to-determine-if-a-variable-is-an-activerecord-object-or-not", "title": "Is it possible to determine if a variable is an activerecord object or not?", "body": "<p>I'm trying to make a super generic class that when inherited from I can call a generic Sidekiq worker.</p>\n\n<p>The idea would be to have all my services able to be called either normally or asynchronously. The problem is I would like to pass objects to the service but I can only pass pointers to the worker. </p>\n\n<p>So if my service needs a <code>User</code> and a <code>String</code> I would currently have:</p>\n\n<pre><code>*args = [#&lt;User:y6t4ert56uu6&gt;, \"I'm a string\"]\n</code></pre>\n\n<p>For this to work I will need to make this array:</p>\n\n<pre><code>[{activerecord: true, class: \"User\", value: user_id}, {activerecord: false, class: \"String\", value: \"I'm a string\"}]\n</code></pre>\n\n<p>Once I know <code>User</code> is an activerecord object I can safely assume there's an <code>id</code> (presuming I'm only passing saved objects). Otherwise I would just output the value of the variable.</p>\n\n<p>An idea of the perfect solution would be: (without the important code)</p>\n\n<pre><code>user = User.first\nstr = \"Hello\"\n\nis_activerecord(user) # returns true\nis_activerecord(str) # returns false\n</code></pre>\n\n<p>Can anyone suggest ideas on how to do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 21, "user_id": 10012324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce5b0c19559bd4074a4768b81b28259?s=128&d=identicon&r=PG", "display_name": "Yevgen", "link": "https://stackoverflow.com/users/10012324/yevgen"}, "edited": false, "score": 0, "creation_date": 1540315063, "post_id": 52954538, "comment_id": 92816795, "body": "in development env everythin works fine"}, {"owner": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "edited": false, "score": 4, "creation_date": 1540315463, "post_id": 52954538, "comment_id": 92816996, "body": "Please share your <code>database.yml</code> file."}, {"owner": {"reputation": 21, "user_id": 10012324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce5b0c19559bd4074a4768b81b28259?s=128&d=identicon&r=PG", "display_name": "Yevgen", "link": "https://stackoverflow.com/users/10012324/yevgen"}, "reply_to_user": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "edited": false, "score": 0, "creation_date": 1540315603, "post_id": 52954538, "comment_id": 92817074, "body": "default: &amp;default   adapter: postgresql   encoding: unicode   pool: &lt;%= ENV.fetch(&quot;RAILS_MAX_THREADS&quot;) { 5 } %&gt;  production:   host:     localhost   database: magnetcoin_production   pool:     10   timeout:  10000   username: magnetcoin   password: magnetcoin   template: template0   development:   &lt;&lt;: *default   database: magnetcoin_development  test:   &lt;&lt;: *default   database: magnetcoin_test"}, {"owner": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "edited": false, "score": 0, "creation_date": 1540315747, "post_id": 52954538, "comment_id": 92817156, "body": "Add database.yml file to your original question with proper formatting otherwise, no can help you."}, {"owner": {"reputation": 21, "user_id": 10012324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce5b0c19559bd4074a4768b81b28259?s=128&d=identicon&r=PG", "display_name": "Yevgen", "link": "https://stackoverflow.com/users/10012324/yevgen"}, "reply_to_user": {"reputation": 1903, "user_id": 2578693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a7a908dd876ba5168b5ba618ccae256?s=128&d=identicon&r=PG&f=1", "display_name": "Engr. Hasanuzzaman Sumon", "link": "https://stackoverflow.com/users/2578693/engr-hasanuzzaman-sumon"}, "edited": false, "score": 0, "creation_date": 1540316658, "post_id": 52954538, "comment_id": 92817594, "body": "updated&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "is_accepted": false, "score": 2, "last_activity_date": 1540316528, "creation_date": 1540316528, "answer_id": 52954930, "question_id": 52954538, "link": "https://stackoverflow.com/questions/52954538/trying-to-start-rails-server-in-production-environment/52954930#52954930", "title": "Trying to start rails server in production environment", "body": "<p>As per you logs you did not define the adaptor for your production env database config. You added the adaptor in default block but did not import default to production block. Just import default block in production block and every thing works fine. </p>\n\n<pre><code>default: &amp;default \n  adapter: postgresql \n  encoding: unicode \n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt; \n\nproduction: &lt;&lt;: *default\n  host: localhost \n  database: magnetcoin_production \n  pool: 10 \n  timeout: 10000 \n  username: magnetcoin \n  password: magnetcoin \n  template: template0 \n\ndevelopment: &lt;&lt;: *default \n  database: magnetcoin_development \n\ntest: &lt;&lt;: *default \n  database: magnetcoin_test\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10012324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce5b0c19559bd4074a4768b81b28259?s=128&d=identicon&r=PG", "display_name": "Yevgen", "link": "https://stackoverflow.com/users/10012324/yevgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540349165, "creation_date": 1540315035, "last_edit_date": 1540349165, "question_id": 52954538, "link": "https://stackoverflow.com/questions/52954538/trying-to-start-rails-server-in-production-environment", "title": "Trying to start rails server in production environment", "body": "<p>Rails server doesn't starting in production environment, i think that there is a conflict with databases, should i migrate them or smth else?</p>\n\n<pre><code>=&gt; Booting Puma\n=&gt; Rails 5.0.6 application starting in production on http://0.0.0.0:3000\n=&gt; Run `rails server -h` for more startup options\nExiting\n/home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.6/lib/active_record/connection_adapters/connection_specification.rb:170:in\n`spec': database configuration does not specify adapter\n(ActiveRecord::AdapterNotSpecified)\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.6/lib/active_record/connection_handling.rb:53:in `establish_connection'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.6/lib/active_record/railtie.rb:125:in `block (2 levels) in &lt;class:Railtie&gt;'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:69:in `instance_eval'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:69:in `block in execute_hook'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:60:in `with_execution_control'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:65:in `execute_hook'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:41:in `block in on_load'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:40:in `each'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activesupport-5.0.6/lib/active_support/lazy_load_hooks.rb:40:in `on_load'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/activerecord-5.0.6/lib/active_record/railtie.rb:121:in `block in &lt;class:Railtie&gt;'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/initializable.rb:30:in `instance_exec'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/initializable.rb:30:in `run'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `each'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `call'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/initializable.rb:54:in `run_initializers'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/application.rb:352:in `initialize!'\n    from /home/user/Desktop/upgraded-carnival/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /home/user/Desktop/upgraded-carnival/config.ru:3:in `require_relative'\n    from /home/user/Desktop/upgraded-carnival/config.ru:3:in `block in &lt;main&gt;'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/builder.rb:55:in `instance_eval'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/builder.rb:55:in `initialize'\n    from /home/user/Desktop/upgraded-carnival/config.ru:in `new'\n    from /home/user/Desktop/upgraded-carnival/config.ru:in `&lt;main&gt;'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/builder.rb:49:in `eval'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/builder.rb:49:in `new_from_string'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/builder.rb:40:in `parse_file'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/server.rb:219:in `app'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/server.rb:84:in `app'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/server.rb:354:in `wrapped_app'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/rack-2.0.3/lib/rack/server.rb:283:in `start'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/server.rb:104:in `start'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/commands_tasks.rb:90:in `block in server'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/commands_tasks.rb:85:in `tap'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/commands_tasks.rb:85:in `server'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands/commands_tasks.rb:49:in `run_command!'\n    from /home/user/.rbenv/versions/2.3.3/lib/ruby/gems/2.3.0/gems/railties-5.0.6/lib/rails/commands.rb:18:in `&lt;top (required)&gt;'\n    from bin/rails:4:in `require'\n    from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>My database.yml :</p>\n\n<pre><code>default: &amp;default   \n  adapter: postgresql   \n  encoding: unicode\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n\nproduction:\n  host: localhost\n  database: magnetcoin_production  \n  pool:     10   \n  timeout:  10000   \n  username: magnetcoin   \n  password:\n  magnetcoin   template: template0\n\ndevelopment:   &lt;&lt;: *default   \n  database: magnetcoin_development\n\ntest:   &lt;&lt;: *default   \n  database: magnetcoin_test\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 2, "last_activity_date": 1540314968, "last_edit_date": 1540314968, "creation_date": 1540314492, "answer_id": 52954408, "question_id": 52954372, "link": "https://stackoverflow.com/questions/52954372/ruby-on-rails-5-error-expecting-keyword-do-or-or/52954408#52954408", "title": "Ruby On Rails 5 Error expecting keyword_do or &#39;{&#39; or &#39;(&#39;", "body": "<p>You need to wrap block arguments in <code>|</code>, not <code>l</code></p>\n\n<pre><code>Movie.select(:rating).distinct.inject([]) { |a, m| a.push m.rating}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10547673, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nrtd3GNCLr8/AAAAAAAAAAI/AAAAAAAAAHY/gOs8QHUIT6Y/photo.jpg?sz=128", "display_name": "anna", "link": "https://stackoverflow.com/users/10547673/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540325580, "creation_date": 1540314320, "last_edit_date": 1540325580, "question_id": 52954372, "link": "https://stackoverflow.com/questions/52954372/ruby-on-rails-5-error-expecting-keyword-do-or-or", "title": "Ruby On Rails 5 Error expecting keyword_do or &#39;{&#39; or &#39;(&#39;", "body": "<p><strong>THIS IS MY CODE</strong></p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n\n   def self.ratings\n       Movie.select(:rating).distinct.inject([]) { la, ml a.push m.rating}\n   end  \nend\n</code></pre>\n\n<p><strong>THIS IS THE ERROR I AM GETTING</strong></p>\n\n<pre><code>app/models/movie.rb:3: syntax error, unexpected tIDENTIFIER,\n\nexpecting keyword_do or '{' or '(' distinct.inject([]) { la, ml a.push m.rating} ^\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "tooltip", "lazy-high-charts"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9636518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c8ecc604249dce409689055524f7af?s=128&d=identicon&r=PG&f=1", "display_name": "Polo M2B", "link": "https://stackoverflow.com/users/9636518/polo-m2b"}, "is_accepted": false, "score": 0, "last_activity_date": 1540309880, "creation_date": 1540309880, "answer_id": 52953179, "question_id": 52952697, "link": "https://stackoverflow.com/questions/52952697/rails-lazy-high-charts-how-to-format-tooltip-label/52953179#52953179", "title": "Rails lazy_high_charts: how to format tooltip label", "body": "<p>Maybe you could introduce two variables, <code>data_hours</code> and <code>data_minutes</code>, and write a string interpolation with theses variables.</p>\n\n<pre><code>data_hours = data_value.to_i\ndata_minutes = ((data_value - data_hours) * 60).to_i\ndata_to_display = \"#{data_hours} h #{data_minutes} m\"\n</code></pre>\n\n<p>Hope it will help !</p>\n\n<p>Written in 0.12 hours ;)</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1540310625, "creation_date": 1540310625, "answer_id": 52953423, "question_id": 52952697, "link": "https://stackoverflow.com/questions/52952697/rails-lazy-high-charts-how-to-format-tooltip-label/52953423#52953423", "title": "Rails lazy_high_charts: how to format tooltip label", "body": "<pre><code>[\"dev: 27.5 h\", \"dev: 22 h\", \"dev: 0.3h\"].map do |s|\n  s.gsub(/\\d+(\\.\\d+)?\\s*h/i) do |h|\n    h, m = h.to_f.divmod(1)\n    [\n      (\"#{h} h\" unless h.zero?),\n      (\"#{(60 * m).round} m\" unless m.zero?)\n    ].compact.join(\" \")\n  end\nend\n#\u21d2 [\"dev: 27 h 30 m\", \"dev: 22 h\", \"dev: 18 m\"]\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6804217, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/cvtcW.jpg?s=128&g=1", "display_name": "sirion1987", "link": "https://stackoverflow.com/users/6804217/sirion1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540374418, "creation_date": 1540308327, "last_edit_date": 1540374418, "question_id": 52952697, "link": "https://stackoverflow.com/questions/52952697/rails-lazy-high-charts-how-to-format-tooltip-label", "title": "Rails lazy_high_charts: how to format tooltip label", "body": "<p>I would to print into my charts the hours and minutes, for example \"development: 27 h 30 m\".</p>\n\n<p>Now I have this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ldRvX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ldRvX.png\" alt=\"enter image description here\"></a></p>\n\n<p>In my script \"data\" represents \"hours\"</p>\n\n<pre><code>{\n  name: value.blank? ? \"other\" : value,\n  data: all_weeks.merge(data_weeks.to_h).values.map do |data_value|\n    data_value.nil? ? 0 : ( data_value.to_f / 60 ).round(2)\n  end\n}\n....\nf.tooltip(\n   pointFormat: \"&lt;span style='color:{series.color}'&gt;{series.name}&lt;/span&gt;: &lt;b&gt;{point.y} h&lt;/b&gt;&lt;br/&gt;\",\n   split: true\n)\n</code></pre>\n\n<p>I have tried to set <code>point.y</code> into <code>pointFormat</code> but no have effects. ( Edit: pointFormat would a generic string! ) </p>\n\n<p>How can I solve? Thanks in advance.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>I solved adding:</p>\n\n<pre><code>LazyHighCharts::HighChart.new(\"container\") do |f|\n  f.tooltip(\n    formatter: \"\\\n      function() { \\\n        var s = []; \\\n        s.push(this.x); \\\n        this.points.forEach(function(point) { \\\n          s.push('&lt;b&gt;' + point.series.name + '&lt;/b&gt;: ' + Math.floor(point.y) + ' h ' + Math.floor((point.y % 1) * 60)  + ' m'); \\\n        }); \\\n        return s; \\\n      }\".js_code,\n    split: true\n  )\n  ....\nend\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Phzeh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Phzeh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "drop-down-menu", "textfield", "search-form"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1540305378, "post_id": 52951375, "comment_id": 92811256, "body": "Your ERB seems invalid. You&#39;re currently producing <code>&lt;div class=&quot;col-md-6&quot;&gt;&lt;form&gt;&lt;&#47;div&gt;&lt;&#47;form&gt;</code> (simplified it a bit). Since you close the div inside the form you should also open it in the form. Alternatively you can move the div closing tag outside of the form."}, {"owner": {"reputation": 1, "user_id": 10546794, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CghIBuJ5Q58/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDduy965F_wneI859vNtvYaFFGs2g/mo/photo.jpg?sz=128", "display_name": "rails beginner", "link": "https://stackoverflow.com/users/10546794/rails-beginner"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1540306815, "post_id": 52951375, "comment_id": 92812202, "body": "So that seemed like a logical thing to me too. Having a form start in one div and end in another shouldn&#39;t work. However, it does. I checked and verified and the search form works with both inputs. Which is why I was trying to understand why"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1540309795, "post_id": 52951375, "comment_id": 92814072, "body": "The resulting HTML should be valid though. The reason it might work is because HTML is not strict XML anymore. Therefore the browser might interpret the closing tag. When pulling your current code through <a href=\"https://validator.w3.org\" rel=\"nofollow noreferrer\">validator.w3.org</a> it results in the <a href=\"https://i.imgur.com/KED099l.png\" rel=\"nofollow noreferrer\">following errors</a>, where the result should be something like <a href=\"https://i.imgur.com/Bqu9OVw.png\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1540305176, "creation_date": 1540305176, "answer_id": 52951651, "question_id": 52951375, "link": "https://stackoverflow.com/questions/52951375/how-does-submit-tag-know-what-info-to-submit-in-case-of-several-inputs-text-fie/52951651#52951651", "title": "How does submit_tag know what info to submit in case of several inputs (text_field_tag, select_tag etc)?", "body": "<p>All of the <code>&lt;input&gt;</code> tags inside your <code>&lt;form&gt;</code> will be submitted when you submit the form. The only thing that Rails is doing behind the scenes is generating the HTML for your form, so a quick read through this might clarify a few things about HTML forms: <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms</a></p>\n\n<p>Your form is perfectly valid. You might consider adding some logic to your controller that searches by the parameters supplied.</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 7301532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VKxe0.jpg?s=128&g=1", "display_name": "Getu", "link": "https://stackoverflow.com/users/7301532/getu"}, "is_accepted": false, "score": 0, "last_activity_date": 1540306974, "creation_date": 1540306974, "answer_id": 52952249, "question_id": 52951375, "link": "https://stackoverflow.com/questions/52951375/how-does-submit-tag-know-what-info-to-submit-in-case-of-several-inputs-text-fie/52952249#52952249", "title": "How does submit_tag know what info to submit in case of several inputs (text_field_tag, select_tag etc)?", "body": "<p>When you submit a form, Rails interprets it as a Hash of key-values called <code>params</code>. In your case, it will submit (with its correspondant values):</p>\n\n<pre><code>params: {\n\"search_field\" =&gt; \"\",\n\"search_dropdown\" =&gt; \"\"\n}\n</code></pre>\n\n<p>then, in the controller, it's up to you what to do with the params they give. perhaps return a list of objects with the <code>search_field</code> or to create or update an object in the DB. The submit_tag button does the same as a form submit; keep in mind that those form helpers are just methods to output HTML in a simpler way for Rails to understand.</p>\n\n<p>more info related on forms <a href=\"https://guides.rubyonrails.org/v5.2/form_helpers.html\" rel=\"nofollow noreferrer\">here</a>. </p>\n"}], "owner": {"reputation": 1, "user_id": 10546794, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CghIBuJ5Q58/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDduy965F_wneI859vNtvYaFFGs2g/mo/photo.jpg?sz=128", "display_name": "rails beginner", "link": "https://stackoverflow.com/users/10546794/rails-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540306974, "creation_date": 1540304373, "question_id": 52951375, "link": "https://stackoverflow.com/questions/52951375/how-does-submit-tag-know-what-info-to-submit-in-case-of-several-inputs-text-fie", "title": "How does submit_tag know what info to submit in case of several inputs (text_field_tag, select_tag etc)?", "body": "<p>I was recently working on a demo web app to try to learn more about ruby on rails and I was trying to implement a search page where users could search by two attributes at the same time - search courses by course name and by subject id. I had already dealt with the associations on the backend for the database and got a working search form after trial and error for a few hours.\nHowever, I want to understand how and why it works, and also how specifically the submit_tag at the end knows what input to submit.</p>\n\n<pre><code>&lt;div class = \"row\", id = \"search_filter\"&gt;\n    &lt;div class = \"col-md-6\"&gt;\n        &lt;%= form_tag(\"/courses\", method: \"get\") do %&gt;\n            &lt;%= label_tag :search_field, \"Search by course name:\" %&gt;\n            &lt;%= text_field_tag :search_field, params[:search_field] %&gt;            \n    &lt;/div&gt;\n    &lt;div class = \"col-md-6\"&gt;\n        &lt;%= label_tag :search_dropdown, \"Search by subject:\" %&gt;\n        &lt;%= select_tag :search_dropdown, options_from_collection_for_select(Subject.all, \"id\", \"name\", params[:search_field]) %&gt;   \n    &lt;/div&gt;\n    &lt;%= submit_tag 'Search', class: \"btn btn-md btn-primary\", name: nil %&gt;\n\n    &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The layout looks a bit odd because I wanted the text_field and dropdown menu to be side by side and the search button below them. Is this a good implementation for a form or is there a better way to go about it (i.e. using a form_for). A lot of it was built by taking bits of advice from different places online, so I don't know if everything I've included is necessary. Thanks!</p>\n"}, {"tags": ["json", "ruby", "rack"], "comments": [{"owner": {"reputation": 1875, "user_id": 8803266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PJdh.png?s=128&g=1", "display_name": "Oliver Baumann", "link": "https://stackoverflow.com/users/8803266/oliver-baumann"}, "edited": false, "score": 0, "creation_date": 1540304756, "post_id": 52951371, "comment_id": 92810835, "body": "Hi and welcome to StackOverflow! Please edit your question and account for two things: check code indentation and eliminate any redundant whitespace/new lines that hamper reading and understanding your code; and provide indications on any error-messages, line numbers etc. you encounter. It is often easier for users here to not have to run the code to understand what the exact problem is."}, {"owner": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "reply_to_user": {"reputation": 1875, "user_id": 8803266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0PJdh.png?s=128&g=1", "display_name": "Oliver Baumann", "link": "https://stackoverflow.com/users/8803266/oliver-baumann"}, "edited": false, "score": 0, "creation_date": 1540307144, "post_id": 52951371, "comment_id": 92812399, "body": "Hi Oliver and thank you for the tips. I have gotten rid of unnecessary white spaces. As for the error-message, there seems to be none, my answers.json file just returns  {&quot;email&quot;:null,&quot;nationality&quot;:null,&quot;employed&quot;:null,&quot;income&quot;:nu&zwnj;&#8203;ll} instead of returning the responses filled out."}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1540307672, "post_id": 52951371, "comment_id": 92812721, "body": "@testprogrammer What do you mean by &quot;json file returns null&quot; ?"}, {"owner": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "reply_to_user": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1540307763, "post_id": 52951371, "comment_id": 92812784, "body": "@Rashmirathi I have updated my question."}, {"owner": {"reputation": 1253, "user_id": 704515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f563d99bc6daa3bc4223274c7578f70?s=128&d=identicon&r=PG", "display_name": "Viktor Nonov", "link": "https://stackoverflow.com/users/704515/viktor-nonov"}, "edited": false, "score": 0, "creation_date": 1540308128, "post_id": 52951371, "comment_id": 92813015, "body": "@testprogrammer Would you be able to post the contents of admin.rb and route.rb template.rb. Also I believe that the file containing the App class is called config.ru and not app.rb."}, {"owner": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "reply_to_user": {"reputation": 1253, "user_id": 704515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f563d99bc6daa3bc4223274c7578f70?s=128&d=identicon&r=PG", "display_name": "Viktor Nonov", "link": "https://stackoverflow.com/users/704515/viktor-nonov"}, "edited": false, "score": 0, "creation_date": 1540308509, "post_id": 52951371, "comment_id": 92813262, "body": "@ViktorNonov hi Viktor I&#39;ve added the required files."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1540308546, "post_id": 52951371, "comment_id": 92813288, "body": "Tip: Define an <code>as_json</code> method that returns the properties you want and then <code>JSON.dump(self)</code> or <code>self.to_json</code> will return just those properties."}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "edited": false, "score": 0, "creation_date": 1540309666, "post_id": 52951371, "comment_id": 92813997, "body": "@testprogrammer you are not passing any data to <code>Survey.new</code>, So <code>{&quot;email&quot;:null,&quot;nationality&quot;:null,&quot;employed&quot;:null,&quot;income&quot;:nu&zwnj;&#8203;ll}</code> is expected I think"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "edited": false, "score": 0, "creation_date": 1540309277, "post_id": 52952681, "comment_id": 92813736, "body": "Hi brad and thanks for the answer. I&#39;ve moved     survey = Survey.new &#39;&#39; survey.save  in the call method. Also I&#39;ve tried your solution and my answer.json file is still returning     {&quot;email&quot;:null,&quot;nationality&quot;:null,&quot;employed&quot;:null,&quot;income&quot;:nu&zwnj;&#8203;ll}"}, {"owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "reply_to_user": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "edited": false, "score": 0, "creation_date": 1540309625, "post_id": 52952681, "comment_id": 92813973, "body": "Ok i thought the problem was nothing was getting into your json file at all. well you are calling args[&#39;something&#39;] but you never set any values to args, so of course it will be null. <code>When you call Survey.new &#39;&#39;</code> you are passing <code>&#39;&#39;</code> as the args. Im not to familar using rack directly so dont know if there is some other magic supposed to happen, but looks like you need to pass args in when you call survey new e.g. <code>survey new {nationality:&#39;some nationality&#39;, etc}</code>"}], "tags": [], "owner": {"reputation": 5471, "user_id": 6019903, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7h7I.png?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6019903/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1540308267, "creation_date": 1540308267, "answer_id": 52952681, "question_id": 52951371, "link": "https://stackoverflow.com/questions/52951371/how-can-i-save-the-form-responses-in-a-json-file-in-ruby/52952681#52952681", "title": "how can I save the form responses in a JSON file in ruby?", "body": "<p>Perhaps you could try the following:</p>\n\n<pre><code>file = File.open(File.dirname(__FILE__) + '/answers.json', 'a+')\nfile.write json\nfile.write \"\\n\"\nfile.close\n</code></pre>\n\n<p>Ensure that <code>json</code> is actually getting populated in the first place, you can check this by either <code>puts json</code> or if you are using rubymine, you can run in debug mode and stick a breakpoint on it.</p>\n\n<p>Also you can't just have code lying around in a class and expect it to be executed.</p>\n\n<p>Move:</p>\n\n<pre><code>survey = Survey.new ''  \nsurvey.save\n</code></pre>\n\n<p>into a method and call it specifically, or include it in the call method.</p>\n\n<p>Let me know if it works</p>\n"}], "owner": {"reputation": 5, "user_id": 10541351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w69Mpu30S0o/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA-xt4Fo5pTfRSM-dUgBI3ioXAoRA/mo/photo.jpg?sz=128", "display_name": "testprogrammer", "link": "https://stackoverflow.com/users/10541351/testprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540308428, "creation_date": 1540304365, "last_edit_date": 1540308428, "question_id": 52951371, "link": "https://stackoverflow.com/questions/52951371/how-can-i-save-the-form-responses-in-a-json-file-in-ruby", "title": "how can I save the form responses in a JSON file in ruby?", "body": "<p>I'm trying to store the responses that are submitted on my form/survey to a JSON file. Currently my JSON file returns null. I'm having trouble figuring out how to save responses on my form to a JSON file.</p>\n\n<h1>survey.rb</h1>\n\n<pre><code>require 'json'       \n\nclass Survey\n  attr_reader :nationality, :employed, :income, :email\n\n  def initialize(args={})\n    @nationality = args[\"nationality\"]\n    @employed = args[\"employed\"]\n    @income = args [\"income\"]\n    @email =args [\"email\"]\n  end\n\n\n    def save\n      json = {\n        email: @email,\n        nationality: @nationality,\n        employed: @employed,\n        income: @income\n      }.to_json\n\n      open('answers.json', 'a') do |file|\n        file.puts json\n      end\n    end\n\nend\n</code></pre>\n\n<h1>app.rb</h1>\n\n<pre><code>require 'rack'\nrequire_relative 'route'\nrequire_relative 'template'\nrequire_relative 'admin'\nrequire_relative 'survey'\n\n\nclass App\n\n  def call(env)\n    response_headers = {}\n\n    request_cookies = Rack::Utils.parse_cookies(env)\n    route = Route.new(env)\n    status = route.name =~ /^\\d\\d\\d$/ ? route.name.to_i : 200\n    template = Template.new(route.name, visit_count: request_cookies[\"session_count\"].to_i+1)\n\n    [status, response_headers, [template.render]]\n\n  end\n\n\n\n  survey = Survey.new ''  \n  survey\n  survey.save\n\nend\n</code></pre>\n\n<h1>admin.rb</h1>\n\n<pre><code>require 'sinatra/base'\nrequire 'rack'\nrequire 'erb'\nrequire_relative 'route'\n\nclass Admin &lt; Sinatra::Base\n\n\n\n\n\n\n  use Rack::Auth::Basic, \"Protected Area\" do |username, password|\n    username == 'minhaj' &amp;&amp; password == 'minhaj'\n  end\n\n  get '/'  do\n    \"&lt;div&gt;hi for some reason I don't need to put this in a string #{5+5}&lt;/div&gt;\n        &lt;p&gt;\n        &lt;/div&gt;hello&lt;/div&gt;\n        &lt;/p&gt;\n\n    \"\n  end\n\nend\n</code></pre>\n\n<h1>route.rb</h1>\n\n<pre><code>class Route\n  ROUTES = {\n    \"GET\" =&gt; {\n      \"/\"  =&gt; :home,\n      \"/admin\"  =&gt; :admin,\n      \"/authentication\" =&gt; :authentication,\n    },\n    \"POST\" =&gt; {\n      \"/check\" =&gt; :check\n    }\n  }\n\n  attr_accessor :name\n\n  def initialize(env)\n    path = env[\"PATH_INFO\"]\n    http_method = env[\"REQUEST_METHOD\"]\n    @name = (ROUTES[http_method] &amp;&amp; ROUTES[http_method][path]) || :not_found\n  end\nend\n</code></pre>\n\n<h1>config.ru</h1>\n\n<pre><code>#! usr/bin/env ruby\nrequire 'rack'\nload 'admin.rb'\nload 'visit_counter.rb'\nload 'app.rb'\n\n\n\n\nrequire File.expand_path '../admin.rb', __FILE__\n\nuse Rack::Static, :urls =&gt; ['/stylesheet/style.css'], :root =&gt; 'public'\n\n\nrun Admin.new\nrun App.new\nuse VisitCounter\n\nrun Rack::URLMap.new({ \"/admin\" =&gt; Admin.new, \"/\" =&gt; App.new })\n</code></pre>\n\n<p>This is how it looks so far and as previously mentioned when I run my app, my answers.json returns </p>\n\n<p><code>{\"email\":null,\"nationality\":null,\"employed\":null,\"income\":null}</code></p>\n\n<p>instead of returning the values submitted on my form page.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 6, "creation_date": 1540299773, "post_id": 52949734, "comment_id": 92807422, "body": "<code>sort</code> is just in the wrong place; should be inside the parens to sort the <code>Array</code>. e.g. <code>options_for_select([[&#39;Z&#39;, &#39;Z&#39;], [&#39;T&#39;, &#39;T&#39;], [&#39;P&#39;, &#39;P&#39;], [&#39;B&#39;, &#39;B&#39;], [&#39;X&#39;, &#39;X&#39;],[&#39;OTHERS&#39;, &#39;OTHERS&#39;]].sort)</code>"}, {"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1540300243, "post_id": 52949734, "comment_id": 92807768, "body": "Yes, it is working as expected."}, {"owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1540358100, "post_id": 52949734, "comment_id": 92829657, "body": "Thanks for the help and better post your answer."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "is_accepted": true, "score": 0, "last_activity_date": 1541048618, "creation_date": 1541048618, "answer_id": 53095449, "question_id": 52949734, "link": "https://stackoverflow.com/questions/52949734/options-for-select-to-sort-in-alphabetical-order-in-ruby-on-rails/53095449#53095449", "title": "options_for_select to sort in alphabetical order in ruby on rails", "body": "<p>Actually the .sort method was misplaced so it was throwing me the error.</p>\n\n<p>When I placed .sort method properly it worked as expected, which is shown as below;</p>\n\n<pre><code>options_for_select([['Z', 'Z'], ['T', 'T'], ['P', 'P'], ['B', 'B'], ['X', 'X'],['OTHERS', 'OTHERS']].sort)\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 1919995, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/59f2e666102af47b6d8e989f7f435327?s=128&d=identicon&r=PG", "display_name": "Muhammad Yaseen", "link": "https://stackoverflow.com/users/1919995/muhammad-yaseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 53095449, "answer_count": 1, "score": 0, "last_activity_date": 1541048618, "creation_date": 1540299565, "question_id": 52949734, "link": "https://stackoverflow.com/questions/52949734/options-for-select-to-sort-in-alphabetical-order-in-ruby-on-rails", "title": "options_for_select to sort in alphabetical order in ruby on rails", "body": "<p>I have the select for customer with options_for_select as below;</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n    &lt;%= f.label :customer %&gt;&lt;br&gt;\n    &lt;%= f.select(:customer, options_for_select([['Z', 'Z'], ['T', 'T'], ['P', 'P'], ['B', 'B'], ['X', 'X'],['OTHERS', 'OTHERS']]).sort, {}, {class: \"form-control\", id: \"recamount_customer\"}) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>It allows a user to select a customer but not in alphabetical order but I want to display it in alphabetical order.</p>\n\n<p>I tried with .sort method but it did not work.</p>\n\n<p>It gives me the error as <code>undefined method sort</code></p>\n\n<p>I searched thoroughly but unable to find anywhere.</p>\n\n<p>Any suggestions are most welcome.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ruby", "activesupport"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 4, "creation_date": 1540294923, "post_id": 52948089, "comment_id": 92804314, "body": "What&#39;s wrong with <code>1.year.from_now.year</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 3, "last_activity_date": 1540294907, "creation_date": 1540294907, "answer_id": 52948157, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number/52948157#52948157", "title": "Get current 1 year from_now as number", "body": "<pre><code>1.year.from_now.year\n</code></pre>\n\n<p>does the job.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540303517, "post_id": 52948161, "comment_id": 92810004, "body": "FYI: <a href=\"http://ruby-doc.org/stdlib-2.5.3/libdoc/date/rdoc/DateTime.html#class-DateTime-label-When+should+you+use+DateTime+and+when+should+you+use+Time-3F\" rel=\"nofollow noreferrer\">When should you use <code>DateTime</code> and when should you use <code>Time</code>?</a> (and since you aren&#39;t interested in the time part at all, you should probably just use <code>Date</code>)"}], "tags": [], "owner": {"reputation": 655, "user_id": 6046641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c716b970d2d8e6ca81ed19a4b0c26fb1?s=128&d=identicon&r=PG", "display_name": "Umesh Malhotra", "link": "https://stackoverflow.com/users/6046641/umesh-malhotra"}, "is_accepted": false, "score": -1, "last_activity_date": 1540294916, "creation_date": 1540294916, "answer_id": 52948161, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number/52948161#52948161", "title": "Get current 1 year from_now as number", "body": "<p>Use this code: <code>DateTime.now.year + 1</code></p>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 1, "creation_date": 1540320423, "post_id": 52949007, "comment_id": 92819379, "body": "Upvoting for <code>Time.now.year + 1</code> - answers the question, zero dependencies, always works."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "edited": false, "score": 2, "creation_date": 1540320961, "post_id": 52949007, "comment_id": 92819638, "body": "@BartoszPietraszko I agree. Also <code>Time.now.year.next</code>"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1540324043, "post_id": 52949007, "comment_id": 92821080, "body": "@iGian thank you very much, I completely forgot about <code>Integer#next</code> and never used it in this context before. <code>Time.now.year.next</code> hits the spot for me."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 6, "last_activity_date": 1540297419, "creation_date": 1540297419, "answer_id": 52949007, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number/52949007#52949007", "title": "Get current 1 year from_now as number", "body": "<p>Use <code>Time.now.next_year</code> (activesupport needed) and if you want only year then go with <code>Time.now.year + 1</code></p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 4, "last_activity_date": 1540297566, "creation_date": 1540297566, "answer_id": 52949059, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number/52949059#52949059", "title": "Get current 1 year from_now as number", "body": "<p>Other option</p>\n\n<pre><code>require 'date'\nDate.today.next_year.year\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 392, "user_id": 9910110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTTsN.jpg?s=128&g=1", "display_name": "Sandra", "link": "https://stackoverflow.com/users/9910110/sandra"}, "is_accepted": false, "score": 0, "last_activity_date": 1540305662, "creation_date": 1540305662, "answer_id": 52951806, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number/52951806#52951806", "title": "Get current 1 year from_now as number", "body": "<p>Any expression returns now + <code>.next_year</code> + <code>.year</code></p>\n\n<pre><code>Time.now.next_year.year\nDate.current.next_year.year\nDateTime.current.next_year.year\n</code></pre>\n\n<p>etc. and all others solutions proposed.</p>\n\n<p>I hope it useful for you. :)</p>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1540305662, "creation_date": 1540294634, "last_edit_date": 1540294919, "question_id": 52948089, "link": "https://stackoverflow.com/questions/52948089/get-current-1-year-from-now-as-number", "title": "Get current 1 year from_now as number", "body": "<p>How I can get the next year from now?</p>\n\n<pre><code>1.year.from_now\n</code></pre>\n\n<p>I need to get only 2019 as a result from the above code.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1540297232, "post_id": 52947998, "comment_id": 92805730, "body": "Its because you are mapping keys and keys are two, if <code>data</code> does not contain the <code>hash.values.first</code> then it returns <code>nil</code>. But do you really need an hash with keys since keys are already keys in data?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10545835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJccIp_REsg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCLouY49iqUF_QViIqXSQpFOU9lYQ/mo/photo.jpg?sz=128", "display_name": "Paul Clark", "link": "https://stackoverflow.com/users/10545835/paul-clark"}, "edited": false, "score": 0, "creation_date": 1540301193, "post_id": 52948882, "comment_id": 92808415, "body": "Thanks, very helpful!"}], "tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 0, "last_activity_date": 1540297012, "creation_date": 1540297012, "answer_id": 52948882, "question_id": 52947998, "link": "https://stackoverflow.com/questions/52947998/how-to-remove-extra-array-level-with-nil-value-from-a-returned-array/52948882#52948882", "title": "How to remove extra array level with nil value from a returned array", "body": "<p>You're almost there, just needed a fine-tuning:</p>\n\n<pre><code>def merge_data(keys, data)\n  merged_data = keys.map {|hash| data.first.map {|k,v| if hash.values.first == k then hash.merge(v) end }.compact[0] }\nend\n\nkeys = [{:first_name =&gt; \"blake\"}, {:first_name =&gt; \"ashley\"}]\n\ndata = [\n  {\"blake\" =&gt; {\n       :awesomeness =&gt; 10,\n            :height =&gt; \"74\",\n         :last_name =&gt; \"johnson\"},\n   \"ashley\" =&gt; {\n       :awesomeness =&gt; 9,\n            :height =&gt; 60,\n         :last_name =&gt; \"dubs\"}\n  }]\n\nputs  merge_data(keys, data).inspect\n\n#=&gt;\n[ \n  {\n    :first_name=&gt;\"blake\",\n    :awesomeness=&gt;10,\n    :height=&gt;\"74\",\n    :last_name=&gt;\"johnson\"},\n  {\n    :first_name=&gt;\"ashley\",\n    :awesomeness=&gt;9,\n    :height=&gt;60,\n    :last_name=&gt;\"dubs\"\n  }\n]\n</code></pre>\n\n<p><strong>What was changed??</strong></p>\n\n<p>Added <code>.compact[0]</code> in the inner block.</p>\n\n<p>Why? Because it is a <code>map</code> running on each key and each data values. Returning nil for one that does not match the other and returning an array each time instead of a <code>Hash</code> object.</p>\n\n<p>However, we can create a custom class and reconstruct the data later:</p>\n\n<pre><code>class Person\n  attr_reader :first_name, :last_name, :height, :awesomeness\n  def initialize(first_name)\n    @first_name = first_name\n  end\n\n  def update(info)\n    info.each do |key, value|\n      instance_variable_set(\"@#{key}\", value) if respond_to?(key)\n    end\n  end\n\n  def to_h\n    { first_name: self.first_name, last_name: self.last_name, awesomeness: self.awesomeness, height: self.height }\n  end\nend\n\npeople = keys.each_with_object({}) do |k, person_map|\n  person_map[k[:first_name]] = Person.new(k[:first_name])\nend\n\ndata.each do |people_info|\n  people_info.each do |first_name, info|\n    if people[first_name]\n      people[first_name].update(info)\n    end\n  end\nend\n\np people.values.map{ |p| p.to_h }\n\n#=&gt; [{:first_name=&gt;\"blake\", :last_name=&gt;\"johnson\", :awesomeness=&gt;10, :height=&gt;\"74\"}, {:first_name=&gt;\"ashley\", :last_name=&gt;\"dubs\", :awesomeness=&gt;9, :height=&gt;60}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 10545835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJccIp_REsg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCLouY49iqUF_QViIqXSQpFOU9lYQ/mo/photo.jpg?sz=128", "display_name": "Paul Clark", "link": "https://stackoverflow.com/users/10545835/paul-clark"}, "edited": false, "score": 0, "creation_date": 1540301145, "post_id": 52949524, "comment_id": 92808382, "body": "Thanks, it was because I had to merge that other <i>pointless</i> hash in"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1540305235, "last_edit_date": 1540305235, "creation_date": 1540298962, "answer_id": 52949524, "question_id": 52947998, "link": "https://stackoverflow.com/questions/52947998/how-to-remove-extra-array-level-with-nil-value-from-a-returned-array/52949524#52949524", "title": "How to remove extra array level with nil value from a returned array", "body": "<p>Given the data set:</p>\n\n<pre><code>data = {\n        \"blake\" =&gt; {\n            :awesomeness =&gt; 10,\n                 :height =&gt; \"74\",\n              :last_name =&gt; \"johnson\"},\n        \"ashley\" =&gt; {\n            :awesomeness =&gt; 9,\n                 :height =&gt; 60,\n              :last_name =&gt; \"dubs\"}\n        }\n</code></pre>\n\n<p>Why not just like this?</p>\n\n<pre><code>data.map { |h| h.last.merge({first_name: h.first}) }\n\n#=&gt; [{:awesomeness=&gt;10, :height=&gt;\"74\", :last_name=&gt;\"johnson\", :first_name=&gt;\"blake\"}, {:awesomeness=&gt;9, :height=&gt;60, :last_name=&gt;\"dubs\", :first_name=&gt;\"ashley\"}]\n</code></pre>\n\n<p><hr>\n<strong>Edit</strong></p>\n\n<p>So, if I understand well your data structure, try <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>:</p>\n\n<pre><code>def merge_data(keys, data)\n  keys.each_with_object([]) { |hash, obj| data.first.map { |k,v| if hash.values.first == k then obj &lt;&lt; hash.merge(v) end } }\nend\n\nkeys = [\n         {:first_name =&gt; \"blake\"},\n         {:first_name =&gt; \"ashley\"}\n       ]\n\ndata = [{\n        \"blake\" =&gt; {\n            :awesomeness =&gt; 10,\n            :height =&gt; \"74\",\n            :last_name =&gt; \"johnson\"},\n        \"ashley\" =&gt; {\n            :awesomeness =&gt; 9,\n            :height =&gt; 60,\n            :last_name =&gt; \"dubs\"}\n        }]\n\nmerge_data(keys, data)\n\n#=&gt; [{:first_name=&gt;\"blake\", :awesomeness=&gt;10, :height=&gt;\"74\", :last_name=&gt;\"johnson\"}, {:first_name=&gt;\"ashley\", :awesomeness=&gt;9, :height=&gt;60, :last_name=&gt;\"dubs\"}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1540326732, "last_edit_date": 1540326732, "creation_date": 1540319326, "answer_id": 52955640, "question_id": 52947998, "link": "https://stackoverflow.com/questions/52947998/how-to-remove-extra-array-level-with-nil-value-from-a-returned-array/52955640#52955640", "title": "How to remove extra array level with nil value from a returned array", "body": "<pre><code>keys = [{ :first_name=&gt; \"ashley\" }, { :first_name=&gt;\"blake\" }]    \ndata = [{ \"blake\"  =&gt; { :awesomeness=&gt;10, :height=&gt;\"74\", :last_name=&gt;\"johnson\" },\n          \"margo\"  =&gt; { :awesomeness=&gt;30, :height=&gt;\"63\", :last_name=&gt;\"magpie\"  },\n          \"ashley\" =&gt; { :awesomeness=&gt;9,  :height=&gt;\"60\", :last_name=&gt;\"dubs\"    } }]\n</code></pre>\n\n<p>I suggest doing this in two steps. The first is to construct a more suitable data structure for the contents of <code>data</code>, namely, a hash:</p>\n\n<pre><code>data_adj = data.reduce(&amp;:merge)\n   #=&gt; {\"blake\" =&gt;{:awesomeness=&gt;10, :height=&gt;\"74\", :last_name=&gt;\"johnson\"},\n   #    \"margo\" =&gt;{:awesomeness=&gt;30, :height=&gt;\"63\", :last_name=&gt;\"magpie\"},\n   #    \"ashley\"=&gt;{:awesomeness=&gt;9,  :height=&gt;\"60\", :last_name=&gt;\"dubs\"}}\n</code></pre>\n\n<p>The second is to merge the hashes in <code>keys</code> with the appropriate values of <code>data_adj</code>:</p>\n\n<pre><code>keys.map { |h| h.merge(data_adj[h[:first_name]]) }\n  #=&gt; [{:first_name=&gt;\"ashley\", :awesomeness=&gt;9,  :height=&gt;\"60\", :last_name=&gt;\"dubs\"},\n  #    {:first_name=&gt;\"blake\",  :awesomeness=&gt;10, :height=&gt;\"74\", :last_name=&gt;\"johnson\"}]\n</code></pre>\n\n<p>This approach would be particularly efficient if the merging operation were to be performed repeatedly, for different values of <code>keys</code>, as <code>data_adj</code> need only be computed once. Dividing the problem into two also speeds testing.</p>\n"}], "owner": {"reputation": 51, "user_id": 10545835, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cJccIp_REsg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCLouY49iqUF_QViIqXSQpFOU9lYQ/mo/photo.jpg?sz=128", "display_name": "Paul Clark", "link": "https://stackoverflow.com/users/10545835/paul-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1540326732, "creation_date": 1540294311, "question_id": 52947998, "link": "https://stackoverflow.com/questions/52947998/how-to-remove-extra-array-level-with-nil-value-from-a-returned-array", "title": "How to remove extra array level with nil value from a returned array", "body": "<p>I have this code which is <em>almost</em> giving me what I want.     </p>\n\n<pre><code>def merge_data(keys, data)\n\nmerged_data = keys.map {|hash| data.first.map {|k,v| if hash.values.first == k then hash.merge(v) end}}\n\nend\n</code></pre>\n\n<p>See below for the difference between the expected (first) and actual return value: </p>\n\n<pre><code>-[{:awesomeness=&gt;10,\n   -  :first_name=&gt;\"blake\",\n   -  :height=&gt;\"74\",\n   -  :last_name=&gt;\"johnson\"},\n   - {:awesomeness=&gt;9, :first_name=&gt;\"ashley\", :height=&gt;60, :last_name=&gt;\"dubs\"}]\n\n   +[[{:awesomeness=&gt;10,\n   +   :first_name=&gt;\"blake\",\n   +   :height=&gt;\"74\",\n   +   :last_name=&gt;\"johnson\"},\n   +  nil],\n   + [nil,\n   +  {:awesomeness=&gt;9, :first_name=&gt;\"ashley\", :height=&gt;60, :last_name=&gt;\"dubs\"}]]\n</code></pre>\n\n<p>If anyone could explain why I'm getting an extra array level with an index of nil it would be much appreciated!</p>\n\n<p>Based upon the below data:</p>\n\n<pre><code>let(:keys) {[\n       {:first_name =&gt; \"blake\"},\n       {:first_name =&gt; \"ashley\"}\n]}\n\n  let(:data) {[\n       {\"blake\" =&gt; {\n            :awesomeness =&gt; 10,\n                 :height =&gt; \"74\",\n              :last_name =&gt; \"johnson\"},\n        \"ashley\" =&gt; {\n            :awesomeness =&gt; 9,\n                 :height =&gt; 60,\n              :last_name =&gt; \"dubs\"}\n    }\n ]}\n\n  let(:merged_data) {[\n       {:first_name =&gt; \"blake\",\n        :awesomeness =&gt; 10,\n             :height =&gt; \"74\",\n          :last_name =&gt; \"johnson\"},\n\n       {:first_name =&gt; \"ashley\",\n        :awesomeness =&gt; 9,\n             :height =&gt; 60,\n          :last_name =&gt; \"dubs\"}\n]}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1540293632, "post_id": 52947640, "comment_id": 92803522, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52947659/ruby-nested-transaction-will-transaction-inside-will-roll-back-if-transaction-o\">Ruby Nested transaction: will transaction inside will roll back if transaction outside is rolled back?</a>"}, {"owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1540293753, "post_id": 52947640, "comment_id": 92803599, "body": "@kiddorails yes both are same when I try to edit the Sub. I created a new link, instead of updating."}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1540294628, "last_edit_date": 1540294628, "creation_date": 1540293996, "answer_id": 52947875, "question_id": 52947640, "link": "https://stackoverflow.com/questions/52947640/ruby-nested-transaction-will-nested-transaction-roll-back-if-outside-transactio/52947875#52947875", "title": "Ruby Nested transaction: will nested transaction roll back if outside transaction is rolled back?", "body": "<p>If the error occurs in the second transactional block, the error is effectively rescued by that block, meaning the first transaction block thinks everything is hunky dory, goes ahead and commits the transactions - <strong>including those that should be rolled back in the second transactional block</strong>.</p>\n\n<p>You have to be very careful when nesting transactions. The short answer is it varies depending on how the nesting is structured. Some good reading:</p>\n\n<p><a href=\"https://pragtob.wordpress.com/2017/12/12/surprises-with-nested-transactions-rollbacks-and-activerecord/\" rel=\"nofollow noreferrer\">https://pragtob.wordpress.com/2017/12/12/surprises-with-nested-transactions-rollbacks-and-activerecord/</a></p>\n"}], "owner": {"reputation": 752, "user_id": 4645982, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/6R1yX.jpg?s=128&g=1", "display_name": "Neelabh Singh", "link": "https://stackoverflow.com/users/4645982/neelabh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540294628, "creation_date": 1540293292, "question_id": 52947640, "link": "https://stackoverflow.com/questions/52947640/ruby-nested-transaction-will-nested-transaction-roll-back-if-outside-transactio", "title": "Ruby Nested transaction: will nested transaction roll back if outside transaction is rolled back?", "body": "<pre><code>model1.rb\ndef method1\n   Model1.transaction do\n      model2_ref_obj = Model2.find(some_id)\n      model2_ref_obj.method1\n  end\nend\n\n\nmodel2.rb\ndef method1\n   Model2.transaction do\n   ## so some work\n   self.save!\n   end\nend\n</code></pre>\n\n<p>However, due to some issue, model1's transaction rollback, will inner transaction will also roll-back.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4.2", "http-delete", "typhoeus"], "comments": [{"owner": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1540302377, "post_id": 52946799, "comment_id": 92809241, "body": "How can I send body/payload with a Typhoeus Delete request"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "edited": false, "score": 0, "creation_date": 1540360848, "post_id": 52951407, "comment_id": 92830518, "body": "The other end point expects a DELETE request. I have previously used em-http-request and mechanize and they worked flawlessly by sending a payload with the DELETE request.  In Typhoeus documentation, it says, a body can be send [<a href=\"https://www.rubydoc.info/github/typhoeus/typhoeus/Typhoeus%2FRequest%2FActions:delete]\" rel=\"nofollow noreferrer\">rubydoc.info/github/typhoeus/typhoeus/&hellip;</a>  <code>respond_to do |format| \t\t\tformat.json do \t\t\t\tbody_hash = params[:bodyHash] end end</code>  If it can not happen, I would wrap it around a post method"}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "edited": false, "score": 0, "creation_date": 1540361447, "post_id": 52951407, "comment_id": 92830753, "body": "The HTTP request to the web server usually goes through multiple gateways, and even on the web-server is being processed by several programs. Just a guess, it can be an Apache or Nginx. No matter of which soft is on your web server, it has thier own opinion about how to process incoming DELETE request."}, {"owner": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "edited": false, "score": 0, "creation_date": 1540361743, "post_id": 52951407, "comment_id": 92830862, "body": "I don&#39;t think it would be the case, since right now I am testing it on localhost.  I have updated my question for the other end&#39;s code."}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1540304462, "creation_date": 1540304462, "answer_id": 52951407, "question_id": 52946799, "link": "https://stackoverflow.com/questions/52946799/payload-in-typhoeus-ruby-delete-request/52951407#52951407", "title": "Payload in Typhoeus Ruby Delete Request", "body": "<p>Let me cite the <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.5\" rel=\"nofollow noreferrer\">specification</a>:</p>\n\n<blockquote>\n  <p>A payload within a DELETE request message has no defined semantics;\n  sending a payload body on a DELETE request might cause some existing\n  implementations to reject the request.</p>\n</blockquote>\n\n<p>I would NOT say it can be called as explicit permission to send payload with DELETE request. It tells you MAY send a payload, but the processing of such a request remains entirely at the discretion of the server.</p>\n\n<p>And this is what happens:</p>\n\n<blockquote>\n  <p>At the other side, it comes in an encoded way, where I can not retrieve it</p>\n</blockquote>\n\n<p>Why can't you send your payload as a part of POST request, which is guaranteed to be processed by the server normally?</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "is_accepted": true, "score": 0, "last_activity_date": 1540451164, "creation_date": 1540451164, "answer_id": 52983294, "question_id": 52946799, "link": "https://stackoverflow.com/questions/52946799/payload-in-typhoeus-ruby-delete-request/52983294#52983294", "title": "Payload in Typhoeus Ruby Delete Request", "body": "<p>I finally looked at all my requests in which I was payload (POST and PUT) and observed that I was not sending headers along with this DELETE request.</p>\n\n<p>It looks something like this:</p>\n\n<pre><code>query_body = {:bodyHash =&gt; body}\n\n    request = Typhoeus::Request.new(\n        url,\n        body: JSON.dump(query_body),\n        method: :delete,\n        ssl_verifypeer: false,\n        ssl_verifyhost: 0,\n        verbose: true,\n        headers: {'X-Requested-With' =&gt; 'XMLHttpRequest', 'Content-Type' =&gt; 'application/json; charset=utf-8', 'Accept' =&gt; 'application/json, text/javascript, */*', 'enctype' =&gt; 'application/json'}\n    )\n\n    request.run\n    response = request.response\n    http_status = response.code\n    response.total_time\n    response.headers\n    result = JSON.parse(response.body)\n</code></pre>\n\n<p>Just adding headers to it, made it work</p>\n"}], "owner": {"reputation": 43, "user_id": 4023298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b118bc44f898b9343d53aa7e76f4bca?s=128&d=identicon&r=PG&f=1", "display_name": "Devyani", "link": "https://stackoverflow.com/users/4023298/devyani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 52983294, "answer_count": 2, "score": 0, "last_activity_date": 1540451164, "creation_date": 1540290510, "last_edit_date": 1540361528, "question_id": 52946799, "link": "https://stackoverflow.com/questions/52946799/payload-in-typhoeus-ruby-delete-request", "title": "Payload in Typhoeus Ruby Delete Request", "body": "<p>I am trying to send request payload(like in a post call) with Typhoeus Delete call. \nAs far as I know, The latest update to the HTTP 1.1 specification (RFC 7231) explicitly permits an entity body in a DELETE request:</p>\n\n<pre><code>A payload within a DELETE request message has no defined semantics; sending a payload body on a DELETE request might cause some existing implementations to reject the request.\n</code></pre>\n\n<p>I tried this code, but body/payload is not retrievable</p>\n\n<pre><code>    query_body = {:bodyHash =&gt; body}\n\n    request = Typhoeus::Request.new(\n        url,\n        body: JSON.dump(query_body),\n        method: :delete,\n        ssl_verifypeer: false,\n        ssl_verifyhost: 0,\n        verbose: true,\n    )\n\n    request.run\n    response = request.response\n    http_status = response.code\n    response.total_time\n    response.headers\n    result = JSON.parse(response.body)\n</code></pre>\n\n<p>At the other side, It comes in an encoded way, where I can not retrieve it</p>\n\n<p>Other side code is like :</p>\n\n<pre><code>def destroy\n        respond_to do |format|\n            format.json do\n                body_hash = params[:bodyHash]\n                #do stuff\n                render json: {msg: 'User Successfully Logged out', status: 200}, status: :ok\n            end\n            format.all {render json: {msg: 'Only JSON types are supported', status: 406}.to_json, status: :ok}\n        end\n    end\n</code></pre>\n"}, {"tags": ["ruby", "rabbitmq", "bunny"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8930162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf49b5bf3ba72d75140b8ff2fe968fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yeezus", "link": "https://stackoverflow.com/users/8930162/yeezus"}, "edited": false, "score": 0, "creation_date": 1540295464, "post_id": 52947850, "comment_id": 92804641, "body": "Thanks for the answer! I tried the first method and it works as expected. Would you still advocate for 1 channel per consumer if the number of consumers is &quot;huge&quot;?"}, {"owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "reply_to_user": {"reputation": 75, "user_id": 8930162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf49b5bf3ba72d75140b8ff2fe968fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yeezus", "link": "https://stackoverflow.com/users/8930162/yeezus"}, "edited": false, "score": 0, "creation_date": 1540296832, "post_id": 52947850, "comment_id": 92805515, "body": "Yes.  channels are lightweight and rabbitmq is very memory efficient.  You need to read up on the implications of concurrent message delivery and acknowledgement modes and be sure you understand the implications before doing multiplexing over a channel.  1 channel per consumer is simpler and while more resource intensive it compartmentalises workers from eachother."}], "tags": [], "owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "is_accepted": true, "score": 3, "last_activity_date": 1540293968, "creation_date": 1540293968, "answer_id": 52947850, "question_id": 52946274, "link": "https://stackoverflow.com/questions/52946274/rabbitmq-bunny-parallel-consumers/52947850#52947850", "title": "RabbitMQ Bunny Parallel Consumers", "body": "<p>RabbitMQ works off the back of the concept of <code>channels</code>, and channels are generally intended to <em>not</em> be shared between threads.  Moreover, channels by default have a work thread pool size of one.  A channel is an analog to a session.</p>\n\n<p>In your case, you have multiple consumers sharing a queue and channel, and performing a long-duration job within the event handler for the channel.</p>\n\n<p>There are two ways to work around this:</p>\n\n<ol>\n<li>Allocate a channel per consumer, or </li>\n<li>Set the work pool size of the channel on creation <a href=\"http://rubybunny.info/articles/concurrency.html#consumer_work_pools\" rel=\"nofollow noreferrer\">See this documentation</a></li>\n</ol>\n\n<p>I would advocate 1 channel per consumer since it has a lower chance of causing unintended side-effects.</p>\n"}], "owner": {"reputation": 75, "user_id": 8930162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf49b5bf3ba72d75140b8ff2fe968fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yeezus", "link": "https://stackoverflow.com/users/8930162/yeezus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 52947850, "answer_count": 1, "score": 2, "last_activity_date": 1540293968, "creation_date": 1540288860, "question_id": 52946274, "link": "https://stackoverflow.com/questions/52946274/rabbitmq-bunny-parallel-consumers", "title": "RabbitMQ Bunny Parallel Consumers", "body": "<p>I have built an application which consists of one publisher, several queues and several consumers for each queue. Consumers on a queue (including the queue) share the channel. Other queues use a different channel. I am observing that for different queues, tasks are being worked on parallel but for a specific queue this is not happening. If I publish several messages at once to a specific queue, only one consumer works while the other ones wait until the work is ended. What should I do in order for consumers to work on parallel? </p>\n\n<pre><code>workers.each do |worker|\n  worker.on_delivery() do |delivery_info, metadata, payload|\n    perform_work(delivery_info, metadata, payload)\n  end\n  queue.subscribe_with(worker)\nend\n</code></pre>\n\n<p>This is how I register all the consumers for a specific queue. The operation <code>perform_work(_,_,_)</code> is rather expensive and takes several seconds to complete.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1540293683, "creation_date": 1540293683, "answer_id": 52947760, "question_id": 52945707, "link": "https://stackoverflow.com/questions/52945707/carrierwave-returning-wrong-file-sizes/52947760#52947760", "title": "Carrierwave returning wrong file sizes", "body": "<p>For anyone else losing their mind - tested with various different files - file size seems to come back in bits.</p>\n"}], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52947760, "answer_count": 1, "score": 0, "last_activity_date": 1540293683, "creation_date": 1540287119, "question_id": 52945707, "link": "https://stackoverflow.com/questions/52945707/carrierwave-returning-wrong-file-sizes", "title": "Carrierwave returning wrong file sizes", "body": "<p>I have the following model:</p>\n\n<pre><code>class Asset &lt; ApplicationRecord\n  ## Associations ##\n  belongs_to :assetable, polymorphic: true, optional: true\n\n  ## Validations ##\n  validate { |a| a.blank_to_nil :description }\n  validate :file_size\n\n  ## Callbacks ##\n  before_save :default_attrs\n\n  ## Misc ##\n  mount_base64_uploader :attachment, AttachmentUploader\n\n  ## Methods ##\n  def version_url(ver)\n    return nil unless attachment.versions[:images].send(ver)\n    attachment.versions[:images].send(ver).url\n  end\n\n  private\n\n  def assetable_const\n    assetable_type.constantize\n  end\n\n  def attachment_size\n    attachment.size\n  end\n\n  def assetable_max_file_size\n    return 0.0 unless assetable_type\n    assetable_type.constantize.max_file_size\n  end\n\n  def default_attrs\n    self.alt = default_file_name if alt.blank?\n    self.title = default_file_name if title.blank?\n  end\n\n  def default_file_name\n    \"#{default_assetable_name}-#{default_assetable_stamp}\"\n  end\n\n  def default_assetable_name\n    \"#{assetable_type.downcase}-#{assetable_id}\"\n  end\n\n  def default_assetable_stamp\n    \"#{Time.now.strftime('%d%m%y')}-#{attachment.filename}\"\n  end\n\n  # for now add to attachment and title\n  # error doesnt show on CMS under attachment\n  def file_size\n    return if attachment_size.to_f &lt;= assetable_max_file_size.megabyte.to_f\n    errors.add(\n      :attachment,\n      I18n.t(\n        'validations.assets.max_file_size',\n        value: assetable_max_file_size.to_s\n      )\n    )\n  end\nend\n</code></pre>\n\n<p>My problem comes from the last method, validating the file size. I have a separate method in each model that includes assets, max_file_size:</p>\n\n<pre><code>class Content::Panels::ImageOnly &lt; Content::Panel\n  ## Includes ##\n  include Assetable\n\n  ## Associations ##\n  belongs_to :panel_holder, polymorphic: true\n\n  ## Validations ##\n  validates_presence_of :asset\n\n  ## Misc ##\n  set_assetables :asset\n\n  ## Methods ##\n  def self.max_file_size\n    1.0\n  end\n</code></pre>\n\n<p>I'm uploading the image I've attached - 680 KB. When I put a binding.pry in my 'file_size' method, I can see the attachment.size returns a value over 1MB:</p>\n\n<pre><code>pry(#&lt;Asset&gt;)&gt; attachment.size.to_f\n=&gt; 2481189.0\n</code></pre>\n\n<p>Is this value being returned in bits of bytes? If bits it appears it's half the real file size (which may be possible due to compression magic) but I'd assumed it would return bytes..</p>\n\n<p>My method fails every time unless I increase the max file size:</p>\n\n<pre><code>def max_file_size\n  3.0\nend\n</code></pre>\n\n<p>Setting it to 3MB makes the validation pass. 2MB fails. Any help is greatly appreciated</p>\n\n<p>EDIT: Image being uploaded:\n<a href=\"https://imgur.com/a/3TG9rLt\" rel=\"nofollow noreferrer\">https://imgur.com/a/3TG9rLt</a></p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1540287038, "post_id": 52945501, "comment_id": 92799314, "body": "What do you mean by &quot;ids&quot; \u2013 all the numbers or maybe just the first number in each subarray? What&#39;s your expected result and what have you tried so far?"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 8, "last_activity_date": 1540286715, "creation_date": 1540286715, "answer_id": 52945553, "question_id": 52945501, "link": "https://stackoverflow.com/questions/52945501/how-to-get-all-elements-from-this-array-with-ruby/52945553#52945553", "title": "How to get all elements from this array with ruby?", "body": "<p>Given <code>a</code> your array</p>\n\n<pre><code>a.flatten.uniq\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 6, "creation_date": 1540292730, "post_id": 52945561, "comment_id": 92802982, "body": "in emoji style: <code>ary.reduce([], :|)</code> \ud83d\ude10"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1540294481, "last_edit_date": 1540294481, "creation_date": 1540286729, "answer_id": 52945561, "question_id": 52945501, "link": "https://stackoverflow.com/questions/52945501/how-to-get-all-elements-from-this-array-with-ruby/52945561#52945561", "title": "How to get all elements from this array with ruby?", "body": "<pre><code>[[], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2]].\n  reduce([]) { |acc, e| acc | e }\n  # or (credit goes to @Stefan)\n  # reduce([], :|)\n\n#\u21d2\u00a0[1, 2, 3, 4, 5, 6, 7, 8]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1540292569, "creation_date": 1540292569, "answer_id": 52947435, "question_id": 52945501, "link": "https://stackoverflow.com/questions/52945501/how-to-get-all-elements-from-this-array-with-ruby/52947435#52947435", "title": "How to get all elements from this array with ruby?", "body": "<p>For completeness sake a Micro-Benchmark that shows yet another solution: use inplace versions of <code>uniq!</code> which will be slightly faster.</p>\n\n<p>If it is okay to change the original array you can also use</p>\n\n<p><code>\narray.flatten!\narray.uniq!\n</code>\nbut be aware that this modifies the <code>array</code> and this might be unwanted, especially if it is a paramter to a method.</p>\n\n<p>Here is a micro-benchmark:</p>\n\n<pre><code>require \"benchmark/ips\"\n# ARRAY = [[], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2]].freeze\nARRAY = [[], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2], [], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2], [], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2], [], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2],[], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2]].freeze\n\nBenchmark.ips do |x|\n    x.compare!\n\n    x.report(\"flatten.uniq\") { ARRAY.flatten.uniq }\n    x.report(\"flatten.uniq!\") { ARRAY.flatten.uniq! }\n    x.report(\"reduce\") { ARRAY.reduce([]) { |acc, e| acc | e } }\nend\n</code></pre>\n\n<p>And here are the results:</p>\n\n<pre><code>Comparison:\n       flatten.uniq!:   107888.3 i/s\n        flatten.uniq:   105813.6 i/s - same-ish: difference falls within error\n              reduce:    49892.6 i/s - 2.16x  slower\n</code></pre>\n\n<p>Note that the <code>reduce</code> variant might actually be faster if there are fewer elements. But it will only work with one level of nesting whereas the other versions will work for all levels. So <code>[[[1]]]</code> will not work with the <code>reduce</code> variant.</p>\n"}], "owner": {"reputation": 421, "user_id": 10130996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58411fd54b0352f580242debb34e4583?s=128&d=identicon&r=PG&f=1", "display_name": "zseikyocho", "link": "https://stackoverflow.com/users/10130996/zseikyocho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52945553, "answer_count": 3, "score": -2, "last_activity_date": 1540294481, "creation_date": 1540286485, "last_edit_date": 1540287363, "question_id": 52945501, "link": "https://stackoverflow.com/questions/52945501/how-to-get-all-elements-from-this-array-with-ruby", "title": "How to get all elements from this array with ruby?", "body": "<p>Want to get all the unique ids from this type of array:</p>\n\n<pre><code>[[], [1], [2], [1, 3, 2], [4, 5, 6, 7, 8, 1], [2, 4], [3], [2]]\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "thread-synchronization"], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 1, "last_activity_date": 1540298116, "creation_date": 1540298116, "answer_id": 52949247, "question_id": 52945374, "link": "https://stackoverflow.com/questions/52945374/how-to-test-threads/52949247#52949247", "title": "How to test threads", "body": "<p>Test the results of method calls separately outside of the thread logic.</p>\n\n<p>Then test the thread creation logic separately with something like:</p>\n\n<pre><code>let(:thread) { double }\nit 'creates threads' do\n  expect(Thread).to receive(:new).exactly(5).times.and_return(thread)\n  expect(thread).to receive(:join).exactly(5).times.and_return(true)\n  expect(Task).to receive(:execute).exactly(5).times.and_return(\"xyz\")\n  expect(subject.execute).to eq \"xyz\"\nend\n</code></pre>\n"}], "owner": {"reputation": 426, "user_id": 8287207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PZ5Cf.jpg?s=128&g=1", "display_name": "Alexey Strizhak", "link": "https://stackoverflow.com/users/8287207/alexey-strizhak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 52949247, "answer_count": 1, "score": -2, "last_activity_date": 1540298116, "creation_date": 1540286099, "last_edit_date": 1540288366, "question_id": 52945374, "link": "https://stackoverflow.com/questions/52945374/how-to-test-threads", "title": "How to test threads", "body": "<p>We have threads:</p>\n\n<pre><code>module Task\n  def self.execute\n    \"result\"\n  end\nend\n\nthreads = []\nthreads &lt;&lt; Thread.new { Task.execute }\n</code></pre>\n\n<p>We need to specify the test that checks the result:</p>\n\n<pre><code>expect(Task.execute).to eq(\"result\")\n</code></pre>\n\n<p>We added a thread inside a thread:</p>\n\n<pre><code>threads &lt;&lt; Thread.new do\n  deep_thread = Thread.new { Task.execute }\n  deep_thread.join\nend\n</code></pre>\n\n<p>How can we check the result of method calls inside a thread? How can we check that the two threads finished, and also check the result of <code>deep_thread</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2", "ajaxform"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1540285528, "post_id": 52944951, "comment_id": 92798358, "body": "<code>data taken using GET request from another object</code> what does that mean?"}, {"owner": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1540285967, "post_id": 52944951, "comment_id": 92798600, "body": "Iam having an object called entry.It consists of 3 fields.I want to use this object along with my new form fields.So that i can post/submit this data"}, {"owner": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1540287178, "post_id": 52944951, "comment_id": 92799430, "body": "Thank you @Gabbar"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "edited": false, "score": 0, "creation_date": 1540287017, "post_id": 52945415, "comment_id": 92799300, "body": "Thank you .But my doubt is iam having hpentry object in another page.It consists  &lt;br/&gt;of name,location,model field data.In view Iam displaying it as &lt;%= @hpentry.HPEntry_Id if @hpentry.HPEntry_Id.present? %&gt;                                                                           I want to submit this object data with my form data."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "edited": false, "score": 0, "creation_date": 1540287197, "post_id": 52945415, "comment_id": 92799446, "body": "@Chaitanya you can use hidden field to send any extra data with form."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "edited": false, "score": 0, "creation_date": 1540287304, "post_id": 52945415, "comment_id": 92799516, "body": "<code>= f.hidden_field :another_field, :value =&gt; @hpentry.HPEntry_Id.present? ? @hpentry.HPEntry_Id : nil</code>"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "edited": false, "score": 0, "creation_date": 1540287377, "post_id": 52945415, "comment_id": 92799563, "body": "@Chaitanya I guess i have given answer that you have mentioned in question, consider this to accepted, before any new question."}, {"owner": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "edited": false, "score": 0, "creation_date": 1540287741, "post_id": 52945415, "comment_id": 92799818, "body": "Thank you...It Worked!!! However it shown the following output   &quot;another_field&quot;=&gt;{&quot;{:value=&gt;69652}&quot;=&gt;&quot;&quot;}                                                                But it&#39;s showing nil after my value"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 0, "last_activity_date": 1540287470, "last_edit_date": 1540287470, "creation_date": 1540286238, "answer_id": 52945415, "question_id": 52944951, "link": "https://stackoverflow.com/questions/52944951/submitting-form-data-which-is-already-existed-as-objectrails3-22/52945415#52945415", "title": "Submitting Form Data which is already existed as object(rails3.22)", "body": "<p>1 => For <code>GET request</code> use <code>method: :get</code></p>\n\n<p>2 => For Ajax submit use <code>:remote =&gt; true</code></p>\n\n<pre><code>&lt;%= form_for @object, url: create_object_path, :remote =&gt; true, method: :get do |f| %&gt;\n  &lt;%=f.text_field :field_1%&gt;\n  &lt;%=f.text_field :field_2%&gt;\n  &lt;%=f.text_field :field_3%&gt;\n  &lt;%= f.hidden_field :another_field, :value @hpentry.HPEntry_Id.present? ? @hpentry.HPEntry_Id : nil%&gt;\n  &lt;%=f.submit :submit%&gt;\n&lt;%end%&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8846738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6cc38c676776af160ac90af5da3158?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/8846738/chaitanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 52945415, "answer_count": 1, "score": 0, "last_activity_date": 1540288593, "creation_date": 1540284832, "last_edit_date": 1540288593, "question_id": 52944951, "link": "https://stackoverflow.com/questions/52944951/submitting-form-data-which-is-already-existed-as-objectrails3-22", "title": "Submitting Form Data which is already existed as object(rails3.22)", "body": "<p>How can I submit a form with data taken using GET request from another object? Could anyone help on how to implement this with ajax and create a method in controller?</p>\n"}, {"tags": ["ruby", "docker"], "comments": [{"owner": {"reputation": 15564, "user_id": 6394722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/117654f31d6ad5c9b2b0e00dcf4b24f3?s=128&d=identicon&r=PG&f=1", "display_name": "atline", "link": "https://stackoverflow.com/users/6394722/atline"}, "edited": false, "score": 1, "creation_date": 1540285547, "post_id": 52944722, "comment_id": 92798365, "body": "Post your <code>Dockerfile</code> please."}, {"owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "edited": false, "score": 0, "creation_date": 1540289824, "post_id": 52944722, "comment_id": 92801215, "body": "Are you running <code>ruby -v</code> and <code>bundler -v</code> in the docker container or in your host machine."}, {"owner": {"reputation": 71, "user_id": 9526188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9baf627bcfe014d5aed22963bb8a08f4?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoMan", "link": "https://stackoverflow.com/users/9526188/potatoman"}, "edited": false, "score": 0, "creation_date": 1540309321, "post_id": 52944722, "comment_id": 92813772, "body": "@Iagom my dockerfile is as follows:  <code>FROM rails:onbuild  RUN bundler install</code>"}, {"owner": {"reputation": 71, "user_id": 9526188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9baf627bcfe014d5aed22963bb8a08f4?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoMan", "link": "https://stackoverflow.com/users/9526188/potatoman"}, "reply_to_user": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "edited": false, "score": 0, "creation_date": 1540309450, "post_id": 52944722, "comment_id": 92813848, "body": "@mcfinnigan I&#39;m running it on the host machine. I tried adding <code>RUN bundler install</code> to my dockerfile so that it would update in the docker container but it still runs into the same issue."}, {"owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "edited": false, "score": 0, "creation_date": 1540373044, "post_id": 52944722, "comment_id": 92837235, "body": "Do you have a .ruby-version file locally? It would be helpful if you could post your Dockerfile and the various config files from your root directory."}], "owner": {"reputation": 71, "user_id": 9526188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9baf627bcfe014d5aed22963bb8a08f4?s=128&d=identicon&r=PG&f=1", "display_name": "PotatoMan", "link": "https://stackoverflow.com/users/9526188/potatoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 600, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540311085, "creation_date": 1540284050, "last_edit_date": 1540311085, "question_id": 52944722, "link": "https://stackoverflow.com/questions/52944722/docker-returning-non-zero-code-even-though-ruby-and-bundler-are-updated", "title": "Docker returning non-zero code even though ruby and bundler are updated", "body": "<p>I'm trying to dockerize my rail application using this command: \n<code>docker build -t nilocstore .</code> within my root rails app folder. </p>\n\n<p>However, I continue to get this error when I do so: </p>\n\n<blockquote>\n  <p>Warning: the running version of Bundler (1.13.7) is older than the\n  version that created the lockfile (1.16.6). We suggest you upgrade to\n  the latest version of Bundler by running 'gem install bundler'. Your\n  Ruby version is 2.3.3, but your Gemfile specified 2.5.1 The command\n  '/bin/sh -c bundle install' returned a non-zero code: 18</p>\n</blockquote>\n\n<p>When I run <code>ruby -v</code> and <code>bundler -v</code> I get this: </p>\n\n<blockquote>\n  <p>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-darwin18]</p>\n  \n  <p>Bundler version 1.16.6</p>\n</blockquote>\n\n<p>According to what that says, both my bundler and ruby are both updated, so why is it throwing me this error?</p>\n\n<p><strong>Edit</strong> - Here are the contents of my Dockerfile: </p>\n\n<p><code>FROM rails:onbuild</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pdf", "minimagick"], "comments": [{"owner": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 0, "creation_date": 1540277539, "post_id": 52941984, "comment_id": 92793886, "body": "Have you checked what the value of <code>file_name(name)</code> is?"}, {"owner": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 0, "creation_date": 1540277615, "post_id": 52941984, "comment_id": 92793920, "body": "Alternatively, you can try using <code>send_file</code> and set the <code>url_based_filename</code> option to <code>false</code> - <a href=\"https://apidock.com/rails/ActionController/DataStreaming/send_file\" rel=\"nofollow noreferrer\">apidock.com/rails/ActionController/DataStreaming/send_file</a>"}, {"owner": {"reputation": 253, "user_id": 7064890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Afx.jpg?s=128&g=1", "display_name": "Qubis741", "link": "https://stackoverflow.com/users/7064890/qubis741"}, "reply_to_user": {"reputation": 1111, "user_id": 834459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e439ef4645473b8a95fb2cf36ab15559?s=128&d=identicon&r=PG", "display_name": "Vidur", "link": "https://stackoverflow.com/users/834459/vidur"}, "edited": false, "score": 0, "creation_date": 1540278425, "post_id": 52941984, "comment_id": 92794338, "body": "@Vidur I have edited my question, it was my function for stripping stuff"}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "edited": false, "score": 1, "creation_date": 1540301863, "post_id": 52941984, "comment_id": 92808845, "body": "It seems not possible with ImageMagick in the first place; see <a href=\"https://stackoverflow.com/questions/14921618/set-a-document-name-when-creating-a-pdf-from-an-image\" title=\"set a document name when creating a pdf from an image\">stackoverflow.com/questions/14921618/&hellip;</a>"}], "owner": {"reputation": 253, "user_id": 7064890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Afx.jpg?s=128&g=1", "display_name": "Qubis741", "link": "https://stackoverflow.com/users/7064890/qubis741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540280266, "creation_date": 1540274039, "last_edit_date": 1540280266, "question_id": 52941984, "link": "https://stackoverflow.com/questions/52941984/edit-metadata-of-pdf-in-ruby-created-with-minimagick", "title": "Edit metadata of PDF in Ruby created with minimagick", "body": "<p>I need to edit metadata of PDF file created with minimagick, to be specific, title of pdf. I can set filename, no problem, but I haven't found any solution how to change that title. For example it apears in chrome pdf title thing when PDF is open.</p>\n\n<p>This is snippet of my code:</p>\n\n<pre><code>pdf = MiniMagick::Image.open(template_image_path)\n\npdf.combine_options do |c|\n  calibrate_name_text(c, name)\nend\nresult.format 'pdf'\n\nFile.open(result.path, 'r') do |f|\n  send_data f.read, type: 'application/pdf', filename: 'pdf_file.pdf'\nend\n</code></pre>\n\n<p>This is title, even when pdf name if for example 'pdf_file':\n<a href=\"https://i.stack.imgur.com/KVwew.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KVwew.png\" alt=\"wrong title\"></a></p>\n\n<p>When I use send_file function like this I got error in console:</p>\n\n<pre><code>send_file result.path, type: 'application/pdf', filename: 'pdf_file.pdf', url_based_filename: false\n</code></pre>\n\n<p>composite: gAMA: CRC error `' @ warning/png.c/MagickPNGWarningHandler/1746.</p>\n\n<p>And pdf file has status 'Failed - Network error'</p>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 3047, "user_id": 10388629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/My8T3.png?s=128&g=1", "display_name": "Pika the Master of the Whales", "link": "https://stackoverflow.com/users/10388629/pika-the-master-of-the-whales"}, "edited": false, "score": 0, "creation_date": 1540267447, "post_id": 52940917, "comment_id": 92790577, "body": "I&#39;m not sure, to be honest. I just don&#39;t understand why you would want to use two different names for the same variable. I can imagine cases, but if it&#39;s entirely up to you, I think the easiest way forward is just to rename <code>@bg_color</code> to <code>@background</code>. Why not?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540267907, "post_id": 52940917, "comment_id": 92790674, "body": "<code>attr_accessor</code> only creates the two methods, not the instance variable: <code>class K; attr_accessor :cat; end; K.new.instance_variables #=&gt;[]; class K; def initialize; @cat = 1; end; end; K.new.instance_variables #=&gt; [:@cat]</code>. You could instead write <code>attr_accessor &#39;cat&#39;</code>."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540268510, "post_id": 52940917, "comment_id": 92790802, "body": "Well, it &quot;defines a named attribute&quot;: <a href=\"https://ruby-doc.org/core-2.0.0/Module.html#method-i-attr_accessor\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.0.0/Module.html#method-i-attr_accessor</a>  This works: <code>class K; attr_accessor :cat; end; felix = K.new; felix.cat = &#39;felix&#39;;</code> All done without adding <code>@cat</code> anywhere."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1540274591, "post_id": 52940917, "comment_id": 92792561, "body": "That&#39;s curious that the doc for <code>attr_accessor</code> states that it creates the instance variable, yet , as I mentioned, <code>K.new.instance_variables #=&gt;[]</code>."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540274865, "post_id": 52940917, "comment_id": 92792681, "body": "Maybe the point is that <code>attr_accessor</code> makes the variable accessible (so I can add <code>felix.instance_variables</code> to my script and get <code>#=&gt; [:@cat]</code>; it wasn&#39;t <i>declared</i> when I wrote <code>felix.cat = &#39;felix&#39;</code>, it was <i>assigned</i> then), whether or not it is accessed. But if it isn&#39;t accessed, it isn&#39;t assigned and in that sense it isn&#39;t created, as you demonstrated. So it&#39;s a semantic issue."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 3, "creation_date": 1540277985, "post_id": 52940917, "comment_id": 92794127, "body": "Instances variables are created when they are first assigned. So, the first call to <code>#background=</code> will create the instance variable, unless of course it has been created earlier by a different assignment. <code>attr</code>, <code>attr_writer</code>, and <code>attr_accessor</code> do <i>not</i> create instance variables. That would be a waste of space, since oftentimes, setters aren&#39;t actually called and dereferencing a non-existent instance variable is perfectly safe (it will just evaluate to <code>nil</code> but not raise an exception). So, there is no need to create an instance variable right away, you only need to create it when it \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1540277993, "post_id": 52940917, "comment_id": 92794132, "body": "\u2026 actually has a value."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540300807, "post_id": 52940917, "comment_id": 92808157, "body": "Cary and Jorg are raising a point it&#39;s impossible to gainsay. I&#39;m just trying to understand what the Ruby doc might mean. One way to think about what the Ruby doc is getting at is that, in my example, <code>felix.cat = &#39;felix&#39;</code> would raise an error without <code>attr_accessor :cat</code> in the class definition. Ruby requires the accessor in order to make the attribute value available to set; it isn&#39;t like JavaScript, where <code>felix.cat = &#39;felix&#39;</code> would be perfectly fine."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540301588, "post_id": 52940917, "comment_id": 92808671, "body": "I.e., it would be perfectly fine without any mention of <code>cat</code> in the original object or prototype definition."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1540407975, "post_id": 52940917, "comment_id": 92859069, "body": "@globewalldesk This is not an answer to the question. You are asking &quot;Why don&#39;t you just change the name?&quot; without providing an answer to the original question. Requests for clarification on questions should be added as comments to the original question, not posted as answers. See <a href=\"https://stackoverflow.com/help/how-to-answer\">How do I write a good answer?</a> and <a href=\"https://stackoverflow.com/help/privileges/comment\">When should I comment?</a>: &quot;You should submit a comment if you want to request clarification from the author.&quot;"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1540505462, "post_id": 52940917, "comment_id": 92902221, "body": "Sorry, @anothermh I thought I was just imitating all the programmers I\u2019ve asked \u201chow do I?\u201d questions of, when they answered, \u201cwell, you shouldn\u2019t be doing that.\u201d Clearly I haven\u2019t learned all of the many rules of this website!"}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540505617, "post_id": 52940917, "comment_id": 92902292, "body": "Should I try to delete my answer?"}], "tags": [], "owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "is_accepted": false, "score": 1, "last_activity_date": 1540301476, "last_edit_date": 1540301476, "creation_date": 1540266879, "answer_id": 52940917, "question_id": 52940599, "link": "https://stackoverflow.com/questions/52940599/defining-non-standard-accessor-methods-using-attr-accessor/52940917#52940917", "title": "Defining non-standard accessor methods using &#39;attr_accessor&#39;", "body": "<p><code>attr_accessor</code> <a href=\"https://ruby-doc.org/core-2.0.0/Module.html#method-i-attr_accessor\" rel=\"nofollow noreferrer\">creates the instance variable</a> (here, <code>@bg_color</code>; or more precisely, makes it accessible to call on the object, though as Cary and J\u00f6rg point out below, the instance variable isn't strictly created until it is assigned) and reader and writer methods named after the symbol arguments you use. If you want it to be named <code>background</code>, why don't you just change the name?</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1540274798, "post_id": 52941686, "comment_id": 92792654, "body": "Note that <code>alias_attribute</code> is a Rails&#39; method."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1540272272, "creation_date": 1540272272, "answer_id": 52941686, "question_id": 52940599, "link": "https://stackoverflow.com/questions/52940599/defining-non-standard-accessor-methods-using-attr-accessor/52941686#52941686", "title": "Defining non-standard accessor methods using &#39;attr_accessor&#39;", "body": "<p>You want an attr_accessor to define the methods background and background=. attr_accessor is used to define getter and setter for instance variable &amp; method is something which return value but you cannot have setter like background= for method.</p>\n\n<p>Please check with <a href=\"https://apidock.com/rails/ActiveModel/AttributeMethods/ClassMethods/alias_attribute\" rel=\"nofollow noreferrer\">alias_attribute</a> &amp; <a href=\"https://apidock.com/ruby/Module/alias_method\" rel=\"nofollow noreferrer\">alias_method</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 1, "last_activity_date": 1540280407, "creation_date": 1540280407, "answer_id": 52943622, "question_id": 52940599, "link": "https://stackoverflow.com/questions/52940599/defining-non-standard-accessor-methods-using-attr-accessor/52943622#52943622", "title": "Defining non-standard accessor methods using &#39;attr_accessor&#39;", "body": "<pre><code>attr_accessor :background\n</code></pre>\n\n<p>is a just a simple macro that generates these two methods for you:</p>\n\n<pre><code>def background\n  @background\nend\n\ndef background=(value)\n  @background = value\nend\n</code></pre>\n\n<p>When you want to have a getter and a setter method with a specific name but assign the value to a variable with a different name then just write the methods yourself - for example like this:</p>\n\n<pre><code>def background\n  @bg_color\nend\n\ndef background=(value)\n  @bg_color = value\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1540349665, "creation_date": 1540349665, "answer_id": 52960441, "question_id": 52940599, "link": "https://stackoverflow.com/questions/52940599/defining-non-standard-accessor-methods-using-attr-accessor/52960441#52960441", "title": "Defining non-standard accessor methods using &#39;attr_accessor&#39;", "body": "<p>Use <code>attr_accessor</code> in conjunction with <code>alias_method</code>. For example:</p>\n\n<pre><code>class Foo\n  attr_accessor :bar\n\n  alias_method :baz, :bar\n  alias_method :baz=, :bar=\n\n  def initialize\n  end\nend\n</code></pre>\n\n<p>Then verify it works as expected:</p>\n\n<pre><code>foo = Foo.new\n=&gt; #&lt;Foo:0x00007fabb12229a0&gt;\nfoo.bar = 'foobar'\n=&gt; 'foobar'\nfoo.baz\n=&gt; 'foobar'\nfoo.baz = 'barfoo'\n=&gt; 'barfoo'\nfoo.bar\n=&gt; 'barfoo'\n</code></pre>\n"}], "owner": {"reputation": 3047, "user_id": 10388629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/My8T3.png?s=128&g=1", "display_name": "Pika the Master of the Whales", "link": "https://stackoverflow.com/users/10388629/pika-the-master-of-the-whales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 52960441, "answer_count": 4, "score": 1, "last_activity_date": 1540349665, "creation_date": 1540264354, "last_edit_date": 1540281212, "question_id": 52940599, "link": "https://stackoverflow.com/questions/52940599/defining-non-standard-accessor-methods-using-attr-accessor", "title": "Defining non-standard accessor methods using &#39;attr_accessor&#39;", "body": "<p>I'm wondering if it is possible to use <code>attr_accessor</code> to reference an attribute with a different name than the methods it will define. For example, I have a class <code>GameWindow</code> with an attribute <code>bg_color</code>, and I want <code>attr_accessor</code> to define methods <code>background</code> and <code>background=</code>. Is there any way to do this, or do I have to define the methods myself?</p>\n"}, {"tags": ["ruby", "loops", "hash", "tic-tac-toe", "minimax"], "comments": [{"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540267132, "post_id": 52940424, "comment_id": 92790504, "body": "What loop are you referring to? <code>spots.each</code>, perhaps?"}, {"owner": {"reputation": 21, "user_id": 10543742, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hdPWU_A28pM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCpNtKBS0xxPRrGjyQr2sXHsXs5Dw/mo/photo.jpg?sz=128", "display_name": "gkaur", "link": "https://stackoverflow.com/users/10543742/gkaur"}, "reply_to_user": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540268680, "post_id": 52940424, "comment_id": 92790831, "body": "yes thats right. once it comes out of spots.each scores is empty."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1540269180, "post_id": 52940424, "comment_id": 92790913, "body": "The only possibility why it could happen is <code>spots</code> is empty there and the loop is not entered at all. Check <code>spots</code>."}, {"owner": {"reputation": 514, "user_id": 6856276, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ecAKM.jpg?s=128&g=1", "display_name": "globewalldesk", "link": "https://stackoverflow.com/users/6856276/globewalldesk"}, "edited": false, "score": 0, "creation_date": 1540269957, "post_id": 52940424, "comment_id": 92791085, "body": "Ugh. Debugging recursive functions can be seriously mind-bending in my experience..."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7507549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oBl6O.png?s=128&g=1", "display_name": "crice1988", "link": "https://stackoverflow.com/users/7507549/crice1988"}, "is_accepted": false, "score": 0, "last_activity_date": 1540508294, "creation_date": 1540508294, "answer_id": 52999229, "question_id": 52940424, "link": "https://stackoverflow.com/questions/52940424/minimax-algorithm-ruby-tic-tac-toe/52999229#52999229", "title": "Minimax algorithm Ruby Tic Tac Toe", "body": "<p>It looks like you are passing an empty hash back into best_move every time. What you're probably wanting to do is pass scores in on each recurrence to build up an object with moves and scores.</p>\n\n<p><code>scores[move] = best_move(spots[1..-1], mark, other_mark, depth += 1, scores)</code></p>\n"}], "owner": {"reputation": 21, "user_id": 10543742, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hdPWU_A28pM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCpNtKBS0xxPRrGjyQr2sXHsXs5Dw/mo/photo.jpg?sz=128", "display_name": "gkaur", "link": "https://stackoverflow.com/users/10543742/gkaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1540508294, "creation_date": 1540262605, "last_edit_date": 1540263220, "question_id": 52940424, "link": "https://stackoverflow.com/questions/52940424/minimax-algorithm-ruby-tic-tac-toe", "title": "Minimax algorithm Ruby Tic Tac Toe", "body": "<p>I am writing unbeatable tic tac toe game using minimax algorithm. For some reason my scores hash lose its value as it comes out for the loop. If it is happening then I must be doing something wrong that I am unable to catch. I am new to coding. Need help!!!</p>\n\n<p>mark is the mark for current player</p>\n\n<p>mark1 and mark2 are the two marks for player1 and player2 respectively</p>\n\n<p>spots is the empty spots on the board</p>\n\n<pre><code>require_relative 'board'\n\nclass ComputerPlayer\n  attr_reader :board\n\n  def initialize\n    @board = Board.new\n    @optimal_moves = [0, 2, 4, 6, 8]\n  end\n\n  def get_position(name, spots, mark, mark1, mark2)\n    position = nil\n    other_mark = nil\n    mark == mark1 ? other_mark = mark2 : other_mark = mark1\n    if spots.length == 9\n      position = @optimal_moves.sample.to_i\n    else\n      position = best_move(spots, mark, other_mark)\n    end\n    print \"Enter your move #{name}: #{position}\\n\"\n    position\n  end\n\n  def best_move(spots, mark, other_mark, depth = 0, scores = {})\n    return 1 if board.winner == mark\n    return 0 if board.draw?\n    return -1 if board.winner == other_mark\n\n    spots.each do |move|\n      board.place_mark(move, mark)\n      scores[move] = best_move(spots[1..-1], mark, other_mark, depth += 1, {})\n      board.reset_position(move)\n    end\n\n    # it does not keep the value of scores. scores here is {}\n    return scores.max_by { |key, value| value }[0] if depth == 0\n    return scores.max_by { |key, value| value }[1] if depth &gt; 0\n    return scores.min_by { |key, value| value }[1] if depth &lt; 0\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "multithreading", "exception"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 2, "creation_date": 1540255632, "post_id": 52939370, "comment_id": 92787987, "body": "why not use a well supported background job gem like <a href=\"https://github.com/mperham/sidekiq\" rel=\"nofollow noreferrer\">github.com/mperham/sidekiq</a> ?"}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "edited": false, "score": 0, "creation_date": 1540257759, "post_id": 52939370, "comment_id": 92788481, "body": "you can send those photos in a bunch of 3 via ajax. This will reduce the time and will provide some feedback to the user as well."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540261567, "post_id": 52939370, "comment_id": 92789390, "body": "Like @lacostenycoder said, use Sidekiq or Resque or another asynchronous job processor."}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 4188532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abfe90024d7e2b7d5f565ad3c9b1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Prince Bansal", "link": "https://stackoverflow.com/users/4188532/prince-bansal"}, "is_accepted": false, "score": 0, "last_activity_date": 1540270613, "creation_date": 1540270613, "answer_id": 52941436, "question_id": 52939370, "link": "https://stackoverflow.com/questions/52939370/rails-running-threads-after-method-has-exited/52941436#52941436", "title": "Rails - running threads after method has exited", "body": "<p>I also faced the same problem in a project. I came  accross a solution using AWS lambda. You can use carrierwave gem/ rails 5 active storage module if you are using rails to upload image on S3. If you are not using rails then use AWS-SDK for ruby to upload files on S3. You can bind events whenever a file created/modified on S3. Whenever a file created it will invoke lambda function and your work is done. can bind them to lambda function. In lambda function you can write logic to create files and upload it back to s3. You can write lambda code in ruby, node and python. </p>\n\n<p>This strategy may help you.</p>\n"}, {"tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1540272681, "creation_date": 1540272681, "answer_id": 52941753, "question_id": 52939370, "link": "https://stackoverflow.com/questions/52939370/rails-running-threads-after-method-has-exited/52941753#52941753", "title": "Rails - running threads after method has exited", "body": "<p>You need to use delayed_job or whenever gem for background task, but I would like suggest <a href=\"https://itnext.io/sidekiq-overview-and-how-to-deploy-it-to-heroku-b8811fea9347\" rel=\"nofollow noreferrer\">sidekiq</a></p>\n"}], "owner": {"reputation": 2337, "user_id": 346613, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ulyAz.png?s=128&g=1", "display_name": "Bazley", "link": "https://stackoverflow.com/users/346613/bazley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540272681, "creation_date": 1540253866, "question_id": 52939370, "link": "https://stackoverflow.com/questions/52939370/rails-running-threads-after-method-has-exited", "title": "Rails - running threads after method has exited", "body": "<p>When the client changes his profile picture it hits the <code>update</code> method, which responds with <code>update.js.erb</code>. This is a fast and straightforward process. However, behind the scenes on the server, a bunch of files (10 of them) is generated from the profile picture and these need to be uploaded to an Amazon bucket from the server. This a lengthy process and I don't want to make the client wait until it is finished. Moreover, the file uploads often fail with a <code>RequestTimeoutException</code> because they take longer than 15 seconds.</p>\n\n<p>All this raises many questions:</p>\n\n<p>How do you do the 10 file generation/upload after the <code>update</code> method has exited? Threads are killed after the main method has finished.</p>\n\n<p>How do you catch an exception inside a thread? The following code does not catch the timeout exceptions.</p>\n\n<pre><code>threads = []\n\nthreads &lt;&lt; Thread.new {\n  begin\n    # upload file 1 ....\n  rescue Rack::Timeout::RequestTimeoutException =&gt; e\n    # try to upload again ....\n  else\n  ensure\n  end\n}\n\nthreads &lt;&lt; Thread.new {\n  begin\n    # upload file 2 ....\n  rescue Rack::Timeout::RequestTimeoutException =&gt; e\n    # try to upload again ....\n  else\n  ensure\n  end\n}\n\nthreads.each { |thr|\n  thr.join\n}\n</code></pre>\n\n<p>What's the best way to try to upload a file again if it timed out?</p>\n\n<p>What is the best solution to this problem?</p>\n"}, {"tags": ["ruby", "selenium", "automation", "capybara", "minitest"], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1845, "user_id": 574923, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YGvbp.jpg?s=128&g=1", "display_name": "Nils_e", "link": "https://stackoverflow.com/users/574923/nils-e"}, "edited": false, "score": 0, "creation_date": 1540320298, "post_id": 52939253, "comment_id": 92819319, "body": "@Nils_e Note: the next Capybara release (3.10) will probably (it&#39;s in the master branch currently) have assert_any_of_selectors to complement the already existing assert_all_of_selectors and assert_none_of_selectors so that will be able to be used for the same thing."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1540253223, "last_edit_date": 1540253223, "creation_date": 1540252784, "answer_id": 52939253, "question_id": 52939191, "link": "https://stackoverflow.com/questions/52939191/how-to-assert-one-of-two-selectors-with-capybara-minitest/52939253#52939253", "title": "How to assert one of two selectors with capybara + minitest", "body": "<p>Capybara does support <code>or</code> but only when using RSpec matchers (<code>expect(page).to have_selector(selector_1).or(have_selector(selector_2))</code>)  since minitest doesn't have simultaneous evaluation <code>or</code> support. Assuming <code>selector_1</code> and <code>selector_2</code> are CSS selectors then the easiest solution here is to use the CSS comma and do</p>\n\n<pre><code>assert_selector(\"#{selector_1}, #{selector_2}\")\n</code></pre>\n\n<p>which will check for an element matching either of the two selectors.</p>\n"}], "owner": {"reputation": 1845, "user_id": 574923, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YGvbp.jpg?s=128&g=1", "display_name": "Nils_e", "link": "https://stackoverflow.com/users/574923/nils-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 52939253, "answer_count": 1, "score": 0, "last_activity_date": 1540253223, "creation_date": 1540252320, "question_id": 52939191, "link": "https://stackoverflow.com/questions/52939191/how-to-assert-one-of-two-selectors-with-capybara-minitest", "title": "How to assert one of two selectors with capybara + minitest", "body": "<p>I currently have a def that does this below, but i feel this is inefficient and there could be another way to do it. I know Rspec has the or() function to help it, but capybara doesn't seem to have this.</p>\n\n<pre><code>def assert_either_selector(selector_1, selector_2)\n  if has_selector?(selector_1, wait: false)\n    assert_selector(selector_1)\n  elsif has_selector?(selector_2, wait: false)\n    assert_selector(selector_2)\n  else\n    flunk(\"Failed to match either selector \\nExpected to find either: \\n\\t#{selector_1} or #{selector_2}\")\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540276550, "post_id": 52939136, "comment_id": 92793414, "body": "Could you provide an example containing a hash and the expected result?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1540276671, "post_id": 52939136, "comment_id": 92793469, "body": "BTW, what&#39;s your use case? Why are you interested in the key&#39;s <i>index</i>? I cannot think of any practical use for it :-)"}, {"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540298140, "post_id": 52939136, "comment_id": 92806297, "body": "@Stephan I&#39;m writing an open-source pentesting tool, and need to arranged data in an orderly fashion."}], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 4, "last_activity_date": 1540252266, "creation_date": 1540252266, "answer_id": 52939186, "question_id": 52939136, "link": "https://stackoverflow.com/questions/52939136/how-to-get-the-index-of-a-key-in-a-hash/52939186#52939186", "title": "How to get the index of a key in a hash?", "body": "<p>There are at least a couple ways you can get this information, the 2 that come to mind are Enumerable's <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-find_index\" rel=\"nofollow noreferrer\"><code>find_index</code></a> method to pass each element to a block and check for your key:</p>\n\n<pre><code>hash.find_index { |key, _| key == 'Done' }\n</code></pre>\n\n<p>or you could get all the <a href=\"https://ruby-doc.org/core/Hash.html#method-i-keys\" rel=\"nofollow noreferrer\"><code>keys</code></a> from your hash as an array and then look up the index as you've been doing:</p>\n\n<pre><code>hash.keys.index('Done')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 4, "last_activity_date": 1540252344, "creation_date": 1540252344, "answer_id": 52939193, "question_id": 52939136, "link": "https://stackoverflow.com/questions/52939136/how-to-get-the-index-of-a-key-in-a-hash/52939193#52939193", "title": "How to get the index of a key in a hash?", "body": "<p>Hashes aren't usually treated as ordered structures, they simply have a list of keys and values corresponding to those keys. </p>\n\n<p>It's true that in Ruby hashes are technically ordered, but there's very rarely an actual use case for treating them as such.</p>\n\n<p>If what you want to do is find the <em>key</em> corresponding to a <em>value</em> in a hash, you can simply use the <a href=\"https://ruby-doc.org/core-2.5.1/Hash.html#method-i-key\" rel=\"nofollow noreferrer\">Hash#key</a> method:</p>\n\n<pre><code>hash = { a: 1, b: 2 }\nhash.key(1) # =&gt; :a\n</code></pre>\n\n<p>I suppose you could use <code>hash.keys.index(hash.key(1))</code> to get <code>0</code> since it's the first value, but again, I wouldn't advise doing this because it's not typical use of the data structure</p>\n"}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 52939193, "answer_count": 2, "score": 0, "last_activity_date": 1541021416, "creation_date": 1540251801, "last_edit_date": 1541021416, "question_id": 52939136, "link": "https://stackoverflow.com/questions/52939136/how-to-get-the-index-of-a-key-in-a-hash", "title": "How to get the index of a key in a hash?", "body": "<p>I'm trying to get the index of a key in a hash. </p>\n\n<p>I know how to do this in an array:</p>\n\n<pre><code>arr = ['Done', 13, 0.4, true]\n\na = arr.index('Done')\n\nputs a\n</code></pre>\n\n<p>Is there a method or some sort of way to do this something like this with a key in a hash? Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540256573, "post_id": 52938640, "comment_id": 92788207, "body": "search your project and see if <code>flash.notice</code> is being set anywhere else or somehow duplicated by multiple controllers.  Also see <a href=\"https://api.rubyonrails.org/classes/ActionDispatch/Flash.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionDispatch/Flash.html</a>"}, {"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540303571, "post_id": 52938640, "comment_id": 92810046, "body": "This is most likely related to Turbolinks: &quot;<code>Turbolinks will immediately restore the page from cache and display it as a preview while simultaneously loading a fresh copy from the network. This gives the illusion of instantaneous page loads for frequently accessed locations.</code>&quot;. You can check workarounds to the caching issue here: <a href=\"https://github.com/turbolinks/turbolinks/issues/309#issuecomment-360278366\" rel=\"nofollow noreferrer\">github.com/turbolinks/turbolinks/issues/&hellip;</a>"}, {"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540303791, "post_id": 52938640, "comment_id": 92810204, "body": "You can also check the following question: <a href=\"https://stackoverflow.com/questions/42542471/rails-turbolinks-5-flash-messages\" title=\"rails turbolinks 5 flash messages\">stackoverflow.com/questions/42542471/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 845, "user_id": 4077574, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/orn50.png?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/4077574/galaxy"}, "is_accepted": false, "score": 2, "last_activity_date": 1540303049, "last_edit_date": 1540303049, "creation_date": 1540272623, "answer_id": 52941739, "question_id": 52938640, "link": "https://stackoverflow.com/questions/52938640/rails-flash-notice-briefly-appearing-after-reloads/52941739#52941739", "title": "Rails flash.notice briefly appearing after reloads", "body": "<p>If you don't want the flash to show up again, use <code>flash.now</code> instead:</p>\n\n<pre><code>flash.now[:notice] = 'Successfully registered!'\n</code></pre>\n\n<p>As you are doing session detection directly in your controller methods, I highly recomend you to use action filters:</p>\n\n<pre><code>before_action :logged_in, only: [:register]\n\n# ...\n\ndef register\n  # ...\nend\n</code></pre>\n\n<p>Here <code>logged_in</code> should be a method to make sure user is registered and logged in. Check <a href=\"https://guides.rubyonrails.org/action_controller_overview.html#filters\" rel=\"nofollow noreferrer\">Filters</a> for more information.</p>\n"}], "owner": {"reputation": 73, "user_id": 6036645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i8Q7oZ6d1NA/AAAAAAAAAAI/AAAAAAAAAEE/yulFb5FQK6g/photo.jpg?sz=128", "display_name": "Sam S.", "link": "https://stackoverflow.com/users/6036645/sam-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540303049, "creation_date": 1540247774, "question_id": 52938640, "link": "https://stackoverflow.com/questions/52938640/rails-flash-notice-briefly-appearing-after-reloads", "title": "Rails flash.notice briefly appearing after reloads", "body": "<p>I have a controller action in Rails as follows: </p>\n\n<pre><code>def register\n if logged_in?\n   current_user().courses &lt;&lt; Course.find(params[:course_id])\n   flash.notice = 'Successfully registered!'\n   redirect_to '/'\n else\n   flash.alert = \"You must be logged in\"\n   redirect_to '/courses'\n end\nend\n</code></pre>\n\n<p>This is rendered in the <code>/courses</code> view as </p>\n\n<pre><code>&lt;% if flash[:notice] %&gt;\n   &lt;div class=\"notice\"&gt;&lt;%= flash[:notice] %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>However, when I go to a different route and then return to <code>/courses</code>, the notice briefly flashes before going away. Is this normal behavior? If so, why is it occurring? If not, what am I doing wrong? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "factory-bot"], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1540260282, "creation_date": 1540260282, "answer_id": 52940117, "question_id": 52938344, "link": "https://stackoverflow.com/questions/52938344/unable-to-build-has-and-belongs-to-many-relation-in-rspec-with-factorybot/52940117#52940117", "title": "Unable to build has_and_belongs_to_many relation in Rspec with FactoryBot", "body": "<p>Not sure if this will work but since a user can have many roles you probably need to add a role as a single array item</p>\n\n<pre><code>FactoryBot.define do\n  factory :user, aliases: [:marketing] do\n    email { 'marketing@mysite.io' }\n    password { '123456' }\n    password_confirmation { '123456' }\n    roles { [ role ] }\n  end\nend\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>FactoryBot.define do\n  factory :user, aliases: [:marketing] do\n    email { 'marketing@mysite.io' }\n    password { '123456' }\n    password_confirmation { '123456' }\n    roles { [ create(role) ] }\n  end\nend\n</code></pre>\n\n<p>The reason for your error is you can't call <code>@user.role</code> but you can call <code>@user.roles</code> with HABTM relation.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 52940117, "answer_count": 1, "score": 0, "last_activity_date": 1540260282, "creation_date": 1540245659, "question_id": 52938344, "link": "https://stackoverflow.com/questions/52938344/unable-to-build-has-and-belongs-to-many-relation-in-rspec-with-factorybot", "title": "Unable to build has_and_belongs_to_many relation in Rspec with FactoryBot", "body": "<p>I read the documentation of FactoryBot here: <a href=\"https://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md</a></p>\n\n<p>I have users and roles and it is a has_and_belongs_to_many relation. I have tried many steps from the documentation to setup this relation but nothing works.</p>\n\n<p>First, I tried this technique:</p>\n\n<pre><code>FactoryBot.define do\n  factory :role do\n    name { \"marketing\" }\n\n    factory :admin_role do\n      name { \"admin\" }\n    end\n  end\nend\n\nFactoryBot.define do\n  factory :user, aliases: [:marketing] do\n    email { 'marketing@mysite.io' }\n    password { '123456' }\n    password_confirmation { '123456' }\n    association :role\n  end\nend\n</code></pre>\n\n<p>But it gives me:</p>\n\n<pre><code>NoMethodError: undefined method `role=' for #&lt;User:0x007f9743449198&gt;\n</code></pre>\n\n<p>Second, I tried this technique:</p>\n\n<pre><code>FactoryBot.define do\n  factory :role do\n    name { \"marketing\" }\n\n    factory :admin_role do\n      name { \"admin\" }\n    end\n  end\nend\n\nFactoryBot.define do\n  factory :user, aliases: [:marketing] do\n    email { 'marketing@mysite.io' }\n    password { '123456' }\n    password_confirmation { '123456' }\n    role\n  end\nend\n</code></pre>\n\n<p>But again I get this error:</p>\n\n<pre><code>NoMethodError: undefined method `role=' for #&lt;User:0x007f9743449198&gt;\n</code></pre>\n\n<p>Third, I tried this technique of pluralizing the relation:</p>\n\n<pre><code>FactoryBot.define do\n  factory :role do\n    name { \"marketing\" }\n\n    factory :admin_role do\n      name { \"admin\" }\n    end\n  end\nend\n\nFactoryBot.define do\n  factory :user, aliases: [:marketing] do\n    email { 'marketing@mysite.io' }\n    password { '123456' }\n    password_confirmation { '123456' }\n    role\n  end\nend\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>ArgumentError: Trait not registered: roles\n</code></pre>\n\n<p>Yet when I read the documentation, it suggests I can use these methods. So what am I doing wrong?</p>\n"}, {"tags": ["ruby", "windows", "path", "require"], "answers": [{"comments": [{"owner": {"reputation": 732, "user_id": 900636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b975aa9ef8bb47e8c66047cde0282d1?s=128&d=identicon&r=PG", "display_name": "matekus", "link": "https://stackoverflow.com/users/900636/matekus"}, "edited": false, "score": 0, "creation_date": 1540254731, "post_id": 52939308, "comment_id": 92787829, "body": "Yes. Is it possible to set a root directory (here lib) from which the require imports are relatively positioned and, if so, how?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 732, "user_id": 900636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b975aa9ef8bb47e8c66047cde0282d1?s=128&d=identicon&r=PG", "display_name": "matekus", "link": "https://stackoverflow.com/users/900636/matekus"}, "edited": false, "score": 0, "creation_date": 1540255419, "post_id": 52939308, "comment_id": 92787950, "body": "I can&#39;t imagine why anyone would create a script in such a chaotic file structure.  Furthermore, I would surely not execute such a script without knowing what might be hidden in this crazy rats nest."}, {"owner": {"reputation": 732, "user_id": 900636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b975aa9ef8bb47e8c66047cde0282d1?s=128&d=identicon&r=PG", "display_name": "matekus", "link": "https://stackoverflow.com/users/900636/matekus"}, "edited": false, "score": 0, "creation_date": 1540256457, "post_id": 52939308, "comment_id": 92788185, "body": "Forget the naming convention I used - original project is from an MIT research project - I am not worried about its provenance. Can I set a &#39;load path&#39; root directory from which all requires are relatively located? Any experience with <a href=\"https://rubygems.org/gems/pathological\" rel=\"nofollow noreferrer\">Pathological</a>?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 732, "user_id": 900636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b975aa9ef8bb47e8c66047cde0282d1?s=128&d=identicon&r=PG", "display_name": "matekus", "link": "https://stackoverflow.com/users/900636/matekus"}, "edited": false, "score": 0, "creation_date": 1540256707, "post_id": 52939308, "comment_id": 92788242, "body": "I haven&#39;t use that gem but give it a shot, though it has not been updated in a long time. If it doesn&#39;t work, try a fork which will support newer ruby versions. <a href=\"https://github.com/ooyala/pathological/pull/6\" rel=\"nofollow noreferrer\">github.com/ooyala/pathological/pull/6</a>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1540253218, "creation_date": 1540253218, "answer_id": 52939308, "question_id": 52937717, "link": "https://stackoverflow.com/questions/52937717/ruby-require-fails-to-import-need-to-set-root-directory/52939308#52939308", "title": "Ruby: Require Fails To Import - Need To Set Root Directory", "body": "<p>If this is the code inside of __init.rb, it won't work.</p>\n\n<pre><code>require \"charlie/delta/echo/__init\"\n__init.rb\nrequire \"bravo/golf\"\n</code></pre>\n\n<p><code>require</code> tells ruby to load the code inside a ruby file.  In order for it to work, the files need to be organized correctly.  You can also use <code>require_relative</code> but they still need a relative path from the file calling them.  See <a href=\"https://stackoverflow.com/questions/3672586/what-is-the-difference-between-require-relative-and-require-in-ruby#3672600\">What is the difference between require_relative and require in Ruby?</a>  </p>\n"}], "owner": {"reputation": 732, "user_id": 900636, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2b975aa9ef8bb47e8c66047cde0282d1?s=128&d=identicon&r=PG", "display_name": "matekus", "link": "https://stackoverflow.com/users/900636/matekus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 52939308, "answer_count": 1, "score": 1, "last_activity_date": 1540253218, "creation_date": 1540242152, "last_edit_date": 1540243186, "question_id": 52937717, "link": "https://stackoverflow.com/questions/52937717/ruby-require-fails-to-import-need-to-set-root-directory", "title": "Ruby: Require Fails To Import - Need To Set Root Directory", "body": "<p>Forgive my inexperience with Ruby, but I am unable to run a script within a third-party project with the following structure:</p>\n\n<pre><code>\u02c5 alpha\n  \u02c5 lib\n     \u02c5 bravo\n        golf.rb\n     \u02c5 charlie\n        \u02c3 delta\n           \u02c5 echo\n              foxtrot.rb\n              require \"charlie/delta/echo/__init\"\n              __init.rb\n              require \"bravo/golf\"\n</code></pre>\n\n<p>What should my command-line be to run the script, '<strong>foxtrot.rb</strong>', as the following generates an error:</p>\n\n<pre><code>ruby \"c:\\arby\\lib\\bravo\\charlie\\delta\\echo\\foxtrot.rb\"\n\n\"'require': cannot load such file -- charlie/delta/echo/__init (LoadError)\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540240675, "post_id": 52937262, "comment_id": 92783948, "body": "why are you assigning <code>@bookings</code> 2x? The 2nd one will overwrite the first one."}], "answers": [{"comments": [{"owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "edited": false, "score": 0, "creation_date": 1540241938, "post_id": 52937500, "comment_id": 92784517, "body": "Welcome to Stackoverflow!  This is a good suggestion, however it doesn\u2019t answer the specific question at hand which is probably why someone left that downvote. Consider adding it as a comment, or editing your current answer to address the specific problem the OP asked about. Happy hacking."}, {"owner": {"reputation": 21, "user_id": 10542804, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OKLHylDy1aE/AAAAAAAAAAI/AAAAAAAAAEA/HZ-c88ju8vU/photo.jpg?sz=128", "display_name": "caramori", "link": "https://stackoverflow.com/users/10542804/caramori"}, "reply_to_user": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "edited": false, "score": 2, "creation_date": 1540243802, "post_id": 52937500, "comment_id": 92785168, "body": "Thank you for pointing it out. I mischecked the variable being iterated on the <code>html</code>. Fixed the answer for a proper one, and added my previous answer as a suggestion to avoid future complications. Sorry for my mistakes"}, {"owner": {"reputation": 117, "user_id": 10161978, "user_type": "registered", "profile_image": "https://graph.facebook.com/716372562027755/picture?type=large", "display_name": "Linda Kadz", "link": "https://stackoverflow.com/users/10161978/linda-kadz"}, "edited": false, "score": 0, "creation_date": 1540470867, "post_id": 52937500, "comment_id": 92883914, "body": "Thanks! I hadn&#39;t seen that! I just now have to figure out how to get the info printed out on my html file. It&#39;s totally not reading anything!"}, {"owner": {"reputation": 21, "user_id": 10542804, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OKLHylDy1aE/AAAAAAAAAAI/AAAAAAAAAEA/HZ-c88ju8vU/photo.jpg?sz=128", "display_name": "caramori", "link": "https://stackoverflow.com/users/10542804/caramori"}, "edited": false, "score": 0, "creation_date": 1540497820, "post_id": 52937500, "comment_id": 92899359, "body": "Let me see if I can help you with that. I don&#39;t know exactly how you declared your <code>@bookings</code> variable, but suposing you used the same method as the first time you declared it on the presented <code>def index</code>, using the <code>user_id</code>. Are you sure this User actually has Bookings? Or, I suppose you are using <code>gem &#39;enumerize&#39;</code> for the booking status. In your enumerize declaration, did you set the values as symbles? If so, when checking for the booking.status, compare it to a lowercase value. If you could update the files above, I may be able to help you more. Sorry for long reply lol."}], "tags": [], "owner": {"reputation": 21, "user_id": 10542804, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OKLHylDy1aE/AAAAAAAAAAI/AAAAAAAAAEA/HZ-c88ju8vU/photo.jpg?sz=128", "display_name": "caramori", "link": "https://stackoverflow.com/users/10542804/caramori"}, "is_accepted": false, "score": 1, "last_activity_date": 1540243435, "last_edit_date": 1540243435, "creation_date": 1540240997, "answer_id": 52937500, "question_id": 52937262, "link": "https://stackoverflow.com/questions/52937262/recurring-action-template-error-ruby-on-rails/52937500#52937500", "title": "Recurring Action template error ruby on rails", "body": "<p>You are not declairing the @bookings variable on your <code>show</code> method, which explains the crash. It appears you are declaring it as you wanted it on the first line of your <code>index</code> method. Just change where you declare it, and it shall be alright.</p>\n\n<p>Also, to avoid further headaches, you should refactor the <code>set_booking</code> method to:</p>\n\n<pre><code>def set_booking\n @booking = Booking.find_by(id: params[:id])\nend\n</code></pre>\n\n<p>by deafult <code>.find()</code> will crash your view if it doesn't find anything</p>\n\n<p><code>.find_by</code>, on the other hand, will return an empty answer, so it won't crash. Also, it's more versatile, since this way you can search from innumerous other variables set in your model, i.e. <code>name</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 310, "user_id": 10445527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pQjXF.jpg?s=128&g=1", "display_name": "Mihail Panayotov", "link": "https://stackoverflow.com/users/10445527/mihail-panayotov"}, "is_accepted": false, "score": 0, "last_activity_date": 1540243042, "last_edit_date": 1540243042, "creation_date": 1540241352, "answer_id": 52937574, "question_id": 52937262, "link": "https://stackoverflow.com/questions/52937262/recurring-action-template-error-ruby-on-rails/52937574#52937574", "title": "Recurring Action template error ruby on rails", "body": "<p>By convention in Rails controller actions (<code>index</code> and <code>show</code> in your case) render views with same names, in your case those might be <code>intex.html.erb</code> and <code>show.html.erb</code>. In your show method you define two variables: <code>@bed</code> and <code>@booking</code> and in your view (<code>show.html.erb</code>) you try to loop variable <code>@bookings</code> which you have not defined in your controller action. Thus, you are getting this error. </p>\n\n<p>Looks like you need to rename <code>show.html.erb</code> to <code>index.html.erb</code> as you are listing bookings and their information in it.</p>\n"}], "owner": {"reputation": 117, "user_id": 10161978, "user_type": "registered", "profile_image": "https://graph.facebook.com/716372562027755/picture?type=large", "display_name": "Linda Kadz", "link": "https://stackoverflow.com/users/10161978/linda-kadz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540243435, "creation_date": 1540239882, "question_id": 52937262, "link": "https://stackoverflow.com/questions/52937262/recurring-action-template-error-ruby-on-rails", "title": "Recurring Action template error ruby on rails", "body": "<p>I keep on having this error </p>\n\n<blockquote>\n  <p>ActionView::Template::Error (undefined method `each' for nil:NilClass):</p>\n</blockquote>\n\n<p>Here's my show.html.erb </p>\n\n<pre><code>&lt;% @bookings.each do |booking| %&gt;\n  &lt;% if booking.checkin_on &gt; Date.today %&gt;\n  &lt;% if booking.status == \"Confirmed\" %&gt;\n  &lt;li class=\"dashboard\"&gt;\n  &lt;%= cl_image_tag(booking.bed.photo.path, width: 400, height: 300, crop: :fill, class: \"pdt-image hidden-xs\" ) %&gt;\n  &lt;div class='product-body'&gt;\n    &lt;h2&gt;&lt;%= booking.bed.title %&gt;&lt;/h2&gt;\n    &lt;p&gt;City: &lt;strong&gt;&lt;%= booking.bed.city %&gt;&lt;/strong&gt;&lt;/p&gt;\n    &lt;p&gt;Address: &lt;strong&gt;&lt;%= booking.bed.address %&gt;&lt;/strong&gt;&lt;/p&gt;\n    &lt;p&gt;Total price: &lt;strong&gt;&lt;%= booking.value %&gt; \u20ac&lt;/strong&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n    &lt;ul class=\"list-unstyled hidden-sm hidden-xs padded\"&gt;\n      &lt;li&gt;&lt;strong&gt;Your booking is confirmed !&lt;/strong&gt;&lt;/li&gt;\n      &lt;li class=\"text-right\"&gt;&lt;%= link_to \"Delete this booking\", booking_path(booking), method: :delete, class:\"btn btn-default\", data: {confirm: \"Are you sure\"} %&gt; &lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n  &lt;/li&gt;\n  &lt;% end %&gt;\n\n  &lt;% if booking.status == \"Canceled\" %&gt;\n  &lt;li class=\"dashboard\"&gt;\n  &lt;%= cl_image_tag(booking.bed.photo.path, width: 400, height: 300, crop: :fill, class: \"pdt-image hidden-xs\" ) %&gt;\n  &lt;div class='product-body'&gt;\n    &lt;h2&gt;&lt;%= booking.bed.title %&gt;&lt;/h2&gt;\n    &lt;p&gt;City: &lt;strong&gt;&lt;%= booking.bed.city %&gt;&lt;/strong&gt;&lt;/p&gt;\n    &lt;p&gt;Address: &lt;strong&gt;&lt;%= booking.bed.address %&gt;&lt;/strong&gt;&lt;/p&gt;\n    &lt;p&gt;Total price: &lt;strong&gt;&lt;%= booking.value %&gt; \u20ac&lt;/strong&gt;&lt;/p&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n    &lt;ul class=\"list-unstyled hidden-sm hidden-xs padded\"&gt;\n      &lt;li&gt;&lt;p&gt;&lt;%= booking.bed.user.first_name%&gt; canceled your booking &lt;/p&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n  &lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>And here's my my_bookings controller</p>\n\n<pre><code>class My::BookingsController &lt; ApplicationController\n  def index\n   @bookings = Booking.where(user_id: current_user.id)\n   @bookings = Booking.all\n   @beds = Bed.all\n  end\n\n  def show\n   set_booking\n   @bed = @booking.bed\n  end\n\nprivate\n def set_booking\n  @booking = Booking.find(params[:id])\n end\nend\n</code></pre>\n\n<p>Any suggestions? Or anything I can't see? I have tried almost everything I can think of at the moment. Thanks!</p>\n"}, {"tags": ["ruby", "linux", "windows", "rspec"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540239092, "post_id": 52936884, "comment_id": 92783275, "body": "please post stack trace errors or we are shooting in the dark"}], "answers": [{"comments": [{"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1540244191, "post_id": 52937722, "comment_id": 92785283, "body": "so I do get the same errors when I try to load the files in the irb console on the server. It really makes no sense given that it works fine on the PC. As for the permissions, they are the same on both systems. 644."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1540246449, "post_id": 52937722, "comment_id": 92785975, "body": "Did you run <code>bundle install</code>? Are you using bundler? If so also try prepend <code>bundle exec rspec</code>"}, {"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1540326945, "post_id": 52937722, "comment_id": 92822387, "body": "Sorry I thought I posted this comment yesterday. I did both and verified that I&#39;m using the same versions of all gems on both machines."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540242163, "creation_date": 1540242163, "answer_id": 52937722, "question_id": 52936884, "link": "https://stackoverflow.com/questions/52936884/uninitialized-constant-error-when-running-ruby-specs-on-linux-not-on-windows/52937722#52937722", "title": "Uninitialized constant error when running ruby specs on linux, not on windows", "body": "<p>Stack trace tells you error is on line 21 of <code>spec_helper</code></p>\n\n<p>The error somewhere in here:</p>\n\n<pre><code>Dir[File.dirname(__FILE__) + '/page_objects/*/*.rb'].each do |page_object|\n  require page_object\nend\n</code></pre>\n\n<p>If you're able to get into the server console, see what this actually returns and compare to your windows environment.</p>\n\n<pre><code>Dir[File.dirname(__FILE__) + '/page_objects/*/*.rb']\n</code></pre>\n\n<p>It seems like the load order of your requires are not firing correctly.  Is it possible there are permission errors on the directories you're trying to read/load from?</p>\n"}], "owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540242163, "creation_date": 1540238150, "last_edit_date": 1540239584, "question_id": 52936884, "link": "https://stackoverflow.com/questions/52936884/uninitialized-constant-error-when-running-ruby-specs-on-linux-not-on-windows", "title": "Uninitialized constant error when running ruby specs on linux, not on windows", "body": "<p>I have a series of selenium/capybara specs that I'm running via rspec in a ruby project. Thus far I have been running them exclusively on a windows machine without issue. Now I am trying to migrate to a Linux machine and I'm running into issues all over the place. </p>\n\n<p>In my <code>spec_helper.rb</code> which every one of my test files requires, I start off with this bit below. Yet when I run my tests on the Linux server, I'm getting a dozens of uninitialized constant errors. Basically the first class the code hits is being declared uninitialized despite having been initialized elsewhere. </p>\n\n<pre><code># frozen-string-literal: true\n\nrequire 'rspec'\nrequire 'capybara/rspec'\nrequire 'capybara-screenshot/rspec'\nrequire 'capybara/dsl'\nrequire 'selenium-webdriver'\nrequire 'site_prism'\n\nDir[File.dirname(__FILE__) + '/helpers/*.rb'].each do |helper|\n  require helper\nend\n\nDir[File.dirname(__FILE__) + '/page_objects/mixins/*.rb'].each do |page_object|\n  require page_object\nend\nDir[File.dirname(__FILE__) + '/page_objects/sections/*.rb'].each do |page_object|\n  require page_object\nend\n\nDir[File.dirname(__FILE__) + '/page_objects/*/*.rb'].each do |page_object|\n  require page_object\nend\n</code></pre>\n\n<p>one such stacktrace:</p>\n\n<p>An error occurred while loading ./demo_spec.rb.</p>\n\n<pre><code>Failure/Error: iframe :export_modal, Pages::ExportModal, :xpath, '//*[@id=\"qPopupWindow\"]/iframe'\n\nNameError:\n  uninitialized constant Pages::ExportModal\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/page_objects/pages/entity_gl_periods.rb:18:in `&lt;class:EntityGlPeriods&gt;'\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/page_objects/pages/entity_gl_periods.rb:2:in `&lt;module:Pages&gt;'\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/page_objects/pages/entity_gl_periods.rb:1:in `&lt;top (required)&gt;'\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/spec_helper.rb:22:in `block in &lt;top (required)&gt;'\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/spec_helper.rb:21:in `each'\n# /dr01/bamboo/xml-data/build-dir/DEVSYS-RSM2FT-JOB1/spec/spec_helper.rb:21:in `&lt;top (required)&gt;'\n# ./demo_spec.rb:1:in `&lt;top (required)&gt;'\nNo examples found.\n</code></pre>\n"}, {"tags": ["ruby", "string", "performance", "split", "ruby-1.8.7"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540236770, "post_id": 52936151, "comment_id": 92782107, "body": "why can&#39;t you use newer ruby? and can you give exact example of a line from file you&#39;re working with?"}, {"owner": {"reputation": 53, "user_id": 6491246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28c6e1a2932e9827c6627dc9fb80af3?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Johnson", "link": "https://stackoverflow.com/users/6491246/brad-johnson"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540237424, "post_id": 52936151, "comment_id": 92782457, "body": "Because I have no control over the environment I&#39;m writing this code for. I can&#39;t give an exact example, because the data I&#39;m working with is sensitive information. However, I can say that each line is around 1600 characters long. I would chalk this up to the file being massive, but running Ruby&#39;s native String.split function doesn&#39;t take nearly as long as my custom split function, so I have to assume there&#39;s a faster way to do this."}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540238850, "last_edit_date": 1540238850, "creation_date": 1540237844, "answer_id": 52936820, "question_id": 52936151, "link": "https://stackoverflow.com/questions/52936151/ruby-custom-split-function-slow/52936820#52936820", "title": "Ruby custom split function slow", "body": "<p>You want <code>.squeeze</code> and <code>.strip</code></p>\n\n<pre><code>str = \"  field0     field1 [ [field2a] [field2b] ] field3\"\n\nputs str.squeeze.strip\n#=&gt; \"field0 field1 [ [field2a] [field2b] ] field3\"\n</code></pre>\n\n<p>Squeeze compresses any extra white space to just 1.\nStrip will remove leading and trailing space of the line.</p>\n\n<p>From there you should be able to use regex pattern matching to parse each line into the data structure you're trying to create, but I can't help with that without knowing how to parse the data.</p>\n\n<p>You also should try to raise expectations sooner, no need to iterate over the entire file. </p>\n\n<p>If you know you're line will match this pattern in your example:</p>\n\n<pre><code>if str.squeeze!.strip! !str[/\\w+\\ +\\[\\ +\\[+\\w+\\]\\ \\[+\\w+\\]\\ \\]\\ \\w+/]\n  raise StandardError, \"Raise this string pattern is wrong #{str}\"\nend\n</code></pre>\n\n<p>If you're good then you can split or whatever:</p>\n\n<pre><code>str.split(' ')\n#=&gt;[\"field0\", \"field1\", \"[\", \"[field2a]\", \"[field2b]\", \"]\", \"field3\"] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3773, "user_id": 991903, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J12Hi.jpg?s=128&g=1", "display_name": "Meier", "link": "https://stackoverflow.com/users/991903/meier"}, "is_accepted": false, "score": 0, "last_activity_date": 1540242835, "creation_date": 1540242835, "answer_id": 52937844, "question_id": 52936151, "link": "https://stackoverflow.com/questions/52936151/ruby-custom-split-function-slow/52937844#52937844", "title": "Ruby custom split function slow", "body": "<p>To really tune your code, you can use the benchmark module to find the bottleneck.</p>\n\n<p>But I expect that the biggest problem of your code is the string adding:</p>\n\n<pre><code>rowsplit[i] += byte\n</code></pre>\n\n<p>the ruby interpreter translates this to</p>\n\n<pre><code>rowsplit[i] = rowsplit[i] + byte\n</code></pre>\n\n<p>This creates a new string object for each byte in your input file. So a 7MB file creates and destroys seven million string objects...\nYou probably get fast enough by using the string concatenation method:</p>\n\n<pre><code>rowsplit[i] &lt;&lt; byte\n</code></pre>\n\n<p>Beware that the <code>&lt;&lt;</code> changes the original object, this is not a problem in you program, but may be a problem when you use it in other contexts.</p>\n"}], "owner": {"reputation": 53, "user_id": 6491246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28c6e1a2932e9827c6627dc9fb80af3?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Johnson", "link": "https://stackoverflow.com/users/6491246/brad-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540242835, "creation_date": 1540235056, "last_edit_date": 1540240393, "question_id": 52936151, "link": "https://stackoverflow.com/questions/52936151/ruby-custom-split-function-slow", "title": "Ruby custom split function slow", "body": "<p>I have a large file of mostly space-delimited data I want to parse into a hash. The problem is this is <strong>mostly</strong> space-delimited, so a simple <code>string.split</code> isn't going to work. </p>\n\n<p>Here's a simplified example of one of the lines in the file: </p>\n\n<pre><code>field0 field1 [ [field2a] [field2b] ] field3\n</code></pre>\n\n<p>The contents contained by the outer brackets (including the outer brackets) need to be a hash member.</p>\n\n<p>I wrote the following function, which works, but is very slow: </p>\n\n<pre><code># row = String to be split\n# fields = Integer indicating expected number of fields\ndef mysplit (row, fields)\n\n # Variable to keep track of brackets\n b = 0\n\n # Variable to keep track of iterations for array index\n i = 0\n\n rowsplit = Array.new(fields)\n rowsplit[0] = \"\"\n row.each_char do |byte|\n\n  case byte\n\n   when ' '\n    if b == 0\n     i += 1\n     rowsplit[i] = \"\"\n    else\n     rowsplit[i] += byte\n    end\n\n   when '['\n    b += 1\n    rowsplit[i] += byte\n\n   when ']'\n    b -= 1\n    rowsplit[i] += byte\n\n   else\n    rowsplit[i] += byte\n\n  end\n\n end\n\n if i != fields - 1\n  raise StandardError,\n   \"Resulting fields do not match expected fields: #{rowsplit}\",\n   caller\n elsif b != 0\n  raise StandardError, \"Bracket never closed.\", caller\n else\n  return rowsplit\n end\n\nend\n</code></pre>\n\n<p>It takes 36 seconds to run this on a 7 MB file 6600 lines long.\nIt's worth mentioning that my environment is running Ruby 1.8.7, which I have no control over. </p>\n\n<p>Is it possible to make this faster? </p>\n"}, {"tags": ["javascript", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 10537059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kIKUU.jpg?s=128&g=1", "display_name": "Adam Cobain", "link": "https://stackoverflow.com/users/10537059/adam-cobain"}, "edited": false, "score": 0, "creation_date": 1540236633, "post_id": 52936382, "comment_id": 92782021, "body": "Thanks, I&#39;ll be more attentive. Prompt, and whether it is possible to return result in the form: <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]</code>, now the output is comma-separated and in a strange way?"}, {"owner": {"reputation": 73252, "user_id": 3874623, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6df0aa136ee42f4ea24ef08b7c348e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3874623/mark"}, "reply_to_user": {"reputation": 89, "user_id": 10537059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kIKUU.jpg?s=128&g=1", "display_name": "Adam Cobain", "link": "https://stackoverflow.com/users/10537059/adam-cobain"}, "edited": false, "score": 0, "creation_date": 1540236679, "post_id": 52936382, "comment_id": 92782050, "body": "Hey @AdamCobain -- I noticed that too. See the second code snippet."}], "tags": [], "owner": {"reputation": 73252, "user_id": 3874623, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6df0aa136ee42f4ea24ef08b7c348e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3874623/mark"}, "is_accepted": true, "score": 2, "last_activity_date": 1540236477, "last_edit_date": 1540236477, "creation_date": 1540236011, "answer_id": 52936382, "question_id": 52936104, "link": "https://stackoverflow.com/questions/52936104/call-stack-size-exceeded-when-porting-ruby-code-to-javascript/52936382#52936382", "title": "&quot;Call stack size exceeded&quot; when porting Ruby code to JavaScript", "body": "<p>You need to <em>call</em> the <code>shift</code> function with <code>shift()</code>. Without that you don't remove en element from the array and get a stack overflow because you keep sending the same array through the recursion:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function transpose(a) {\r\n    return a.length === 0 ? a : a[0].map((col, i) =&gt; a.map((row) =&gt; row[i]))\r\n}\r\n\r\nfunction f(a) {\r\n    return a.length === 0 ? [] : a.shift() + f(transpose(a).reverse());\r\n} \r\n\r\nconsole.log(f([[1, 2, 3, 4], [12, 13, 14, 5], [11, 16, 15, 6], [10, 9, 8, 7]]));</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>You can fix the commas by keeping the return value as a flat array until the end, then making a string:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function transpose(a) {\r\n    return a.length === 0 ? a : a[0].map((col, i) =&gt; a.map((row) =&gt; row[i]))\r\n}\r\n\r\nfunction f(a) {\r\n    return a.length === 0 ? [] : [...a.shift(), ...f(transpose(a).reverse())];\r\n} \r\nlet arr = f([[1, 2, 3, 4], [12, 13, 14, 5], [11, 16, 15, 6], [10, 9, 8, 7]])\r\nconsole.log(arr.join(','));</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 89, "user_id": 10537059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kIKUU.jpg?s=128&g=1", "display_name": "Adam Cobain", "link": "https://stackoverflow.com/users/10537059/adam-cobain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52936382, "answer_count": 1, "score": 1, "last_activity_date": 1540277271, "creation_date": 1540234876, "last_edit_date": 1540277271, "question_id": 52936104, "link": "https://stackoverflow.com/questions/52936104/call-stack-size-exceeded-when-porting-ruby-code-to-javascript", "title": "&quot;Call stack size exceeded&quot; when porting Ruby code to JavaScript", "body": "<p>This is a function of bypassing the two-dimensional array (matrix) in a spiral clockwise: (<a href=\"https://ideone.com/SYmf7W\" rel=\"nofollow noreferrer\">demo</a>)</p>\n\n<pre><code>entryArray = [\n  [ 1,  2,  3, 4],\n  [12, 13, 14, 5],\n  [11, 16, 15, 6],\n  [10,  9,  8, 7]\n]\n\ndef f(a)\n  a.empty? ? [] : a.shift+f(a.transpose.reverse)\nend\n\nf(entryArray)\n#=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n</code></pre>\n\n<p>I tried to make an analog in JavaScript:</p>\n\n<pre><code>function transpose(a) {\n    return a.length === 0 ? a : a[0].map((col, i) =&gt; a.map((row) =&gt; row[i]))\n}\n\nfunction f(a) {\n    return a.length === 0 ? [] : a.shift + f(transpose(a).reverse());\n} \n\nf([[1, 2, 3, 4], [12, 13, 14, 5], [11, 16, 15, 6], [10, 9, 8, 7]]);\n</code></pre>\n\n<p>but it did not work, an error appears in the console:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wfM5I.png\" alt=\"Error\"></p>\n\n<p>Please tell me what the problem is, and is it possible to do it on JS? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1540261837, "post_id": 52936057, "comment_id": 92789445, "body": "Do not make a screenshot of your console. Copy and paste the relevant text into your question so that others can search for and find this question and its accepted answer. The only useful diagnostic information is in the screenshot."}], "answers": [{"tags": [], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "is_accepted": true, "score": 1, "last_activity_date": 1540238142, "creation_date": 1540238142, "answer_id": 52936881, "question_id": 52936057, "link": "https://stackoverflow.com/questions/52936057/error-while-installing-rails-gem-on-windows/52936881#52936881", "title": "Error while installing Rails gem on Windows", "body": "<p>As mentioned in <a href=\"https://stackoverflow.com/questions/26782334/error-to-installing-sass-with-gem-in-windows-8-1\">this link</a></p>\n\n<p>Run this command: </p>\n\n<pre><code>chcp 1252\n</code></pre>\n\n<p>And run your command again. </p>\n"}], "owner": {"reputation": 13, "user_id": 10027796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6bfad4264b50eb4aae51a26f6afc354?s=128&d=identicon&r=PG&f=1", "display_name": "fatima mukhtar", "link": "https://stackoverflow.com/users/10027796/fatima-mukhtar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 52936881, "answer_count": 1, "score": 1, "last_activity_date": 1540262204, "creation_date": 1540234676, "last_edit_date": 1540262204, "question_id": 52936057, "link": "https://stackoverflow.com/questions/52936057/error-while-installing-rails-gem-on-windows", "title": "Error while installing Rails gem on Windows", "body": "<p>I'm trying to install Ruby on Rails on Windows. After successfully installing Ruby, when I run <code>ruby -v</code> , it returns <code>ruby 2.4.4</code> as expected. The <code>gem</code> application is installed and is version 2.77. But when I try executing the command:</p>\n\n<pre><code>gem install rails\n</code></pre>\n\n<p>it gives the following error:</p>\n\n<pre><code>C:\\&gt;gem install rails\nERROR:  Loading command: install (ArgumentError)\n        unknown encoding name - CP720\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n\n<p>How do I fix this error so I can install Ruby on Rails on Windows?</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "edited": false, "score": 0, "creation_date": 1540234744, "post_id": 52935861, "comment_id": 92781165, "body": "You&#39;ve not loaded the DSL (domain-specific language) for Sinatra, which defines the <code>post</code> method: <code>require &#39;sinatra&#39;</code>"}, {"owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "reply_to_user": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "edited": false, "score": 0, "creation_date": 1540235513, "post_id": 52935861, "comment_id": 92781505, "body": "@Cam Still show me same error =("}], "owner": {"reputation": 1431, "user_id": 729535, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5593abb6ec21bc7a9c2070a82a27e4e3?s=128&d=identicon&r=PG", "display_name": "Luiz Carvalho", "link": "https://stackoverflow.com/users/729535/luiz-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540279962, "creation_date": 1540233873, "last_edit_date": 1540279962, "question_id": 52935861, "link": "https://stackoverflow.com/questions/52935861/how-to-add-a-extra-route-in-a-sinatra-project", "title": "How to add a extra route in a Sinatra project?", "body": "<p>How can I <code>prepend</code> a extra route in Sinatra class of another gem?</p>\n\n<p><strong>How I'm tring</strong></p>\n\n<pre><code>module StealthWebhook\n  module Route\n    post '/api/v1/webhook' do\n      response_status, response_body = Webhook.send_request(request)\n\n      status response_status\n      body response_body\n    end\n  end\nend\n\n\nmodule Stealth\n  class Server &lt; Sinatra::Base\n    prepend StealthWebhook::Route\n  end\nend\n</code></pre>\n\n<p>I need add this route in <a href=\"https://github.com/hellostealth/stealth/blob/master/lib/stealth/server.rb\" rel=\"nofollow noreferrer\">this class</a> </p>\n\n<p>but I receive this error:</p>\n\n<pre><code>bundler: failed to load command: puma (/usr/local/bundle/bin/puma)\nbot_1       | NoMethodError: undefined method `post' for StealthWebhook::Route:Module\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook/route.rb:6:in `&lt;module:Route&gt;'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook/route.rb:4:in `&lt;module:StealthWebhook&gt;'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook/route.rb:3:in `&lt;top (required)&gt;'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook/base.rb:5:in `require_relative'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook/base.rb:5:in `&lt;top (required)&gt;'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook.rb:1:in `require_relative'\nbot_1       |   /bot/lib/stealth-webhook/lib/stealth-webhook.rb:1:in `&lt;top (required)&gt;'\nbot_1       |   /bot/lib/aggregator.rb:5:in `require_relative'\nbot_1       |   /bot/lib/aggregator.rb:5:in `&lt;top (required)&gt;'\nbot_1       |   /bot/config/initializers/overridings.rb:1:in `require_relative'\nbot_1       |   /bot/config/initializers/overridings.rb:1:in `&lt;top (required)&gt;'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:85:in `require_relative'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:85:in `block in require_directory'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:93:in `each'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:93:in `for_each_file_in'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:85:in `require_directory'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:66:in `load_environment'\nbot_1       |   /usr/local/bundle/gems/stealth-1.0.4/lib/stealth/base.rb:33:in `boot'\nbot_1       |   /bot/config/boot.rb:6:in `&lt;top (required)&gt;'\nbot_1       |   config.ru:2:in `require_relative'\nbot_1       |   config.ru:2:in `block in &lt;main&gt;'\nbot_1       |   /usr/local/bundle/gems/rack-2.0.5/lib/rack/builder.rb:55:in `instance_eval'\nbot_1       |   /usr/local/bundle/gems/rack-2.0.5/lib/rack/builder.rb:55:in `initialize'\nbot_1       |   config.ru:in `new'\nbot_1       |   config.ru:in `&lt;main&gt;'\nbot_1       |   /usr/local/bundle/gems/rack-2.0.5/lib/rack/builder.rb:49:in `eval'\nbot_1       |   /usr/local/bundle/gems/rack-2.0.5/lib/rack/builder.rb:49:in `new_from_string'\nbot_1       |   /usr/local/bundle/gems/rack-2.0.5/lib/rack/builder.rb:40:in `parse_file'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/configuration.rb:318:in `load_rackup'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/configuration.rb:243:in `app'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/runner.rb:145:in `load_and_bind'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/single.rb:96:in `run'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/launcher.rb:184:in `run'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/lib/puma/cli.rb:78:in `run'\nbot_1       |   /usr/local/bundle/gems/puma-3.12.0/bin/puma:10:in `&lt;top (required)&gt;'\nbot_1       |   /usr/local/bundle/bin/puma:29:in `load'\nbot_1       |   /usr/local/bundle/bin/puma:29:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I solved using <code>Stealth::Server.post</code>. This is the best way?</p>\n\n<pre><code>module StealthWebhook\n  module Route\n    Stealth::Server.post '/api/v1/webhook' do\n      response_status, response_body = Webhook.send_request(request)\n\n      status response_status\n      body response_body\n    end\n  end\nend\n\n\nmodule Stealth\n  class Server &lt; Sinatra::Base\n    prepend StealthWebhook::Route\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540234963, "post_id": 52935620, "comment_id": 92781264, "body": "Its not really clear what you mean by &quot;if the current record is in a different month than the last record...&quot; - what does the current record mean in this context? What is the desired result? Do you want the records grouped by month?"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1540233768, "last_edit_date": 1540233768, "creation_date": 1540233382, "answer_id": 52935732, "question_id": 52935620, "link": "https://stackoverflow.com/questions/52935620/find-the-last-record-in-previous-month-to-compare-with-in-ruby/52935732#52935732", "title": "Find the last record in previous month to compare with in ruby", "body": "<p>You can scope by date range</p>\n\n<pre><code>start_date = 1.month.ago.beginning_of_month\nend_date = 1.month.ago.end_of_month\n\nMetric.where(created_at: start_date..end_date)\n      .order(created_at: :desc).first\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540234376, "post_id": 52935792, "comment_id": 92780966, "body": "You can also do this by extracting the year and month using the date functions in the database which is handy if you need to use it in a group clause. Unfortunatly they are not that standardized and you need a db specific solution."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1540233882, "last_edit_date": 1540233882, "creation_date": 1540233595, "answer_id": 52935792, "question_id": 52935620, "link": "https://stackoverflow.com/questions/52935620/find-the-last-record-in-previous-month-to-compare-with-in-ruby/52935792#52935792", "title": "Find the last record in previous month to compare with in ruby", "body": "<pre><code>last_month = Time.current - 1.month\nMetric.order(\"created_at\").where(\n  created_at: last_month.beginning_of_month..last_month.end_of_month\n).last\n</code></pre>\n\n<p>Using <a href=\"https://ruby-doc.org/core-2.2.0/Range.html\" rel=\"nofollow noreferrer\">a range</a> creates a <code>WHERE created_at BETWEEN a AND b</code> clause.</p>\n"}], "owner": {"reputation": 31, "user_id": 2448679, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c9bc9e5508a347d4e101bd7ccf8eab26?s=128&d=identicon&r=PG", "display_name": "Gareth Burrows", "link": "https://stackoverflow.com/users/2448679/gareth-burrows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1540233882, "creation_date": 1540232963, "question_id": 52935620, "link": "https://stackoverflow.com/questions/52935620/find-the-last-record-in-previous-month-to-compare-with-in-ruby", "title": "Find the last record in previous month to compare with in ruby", "body": "<p>Bit of a strange one. Assume I have a database table in a rails 4 app like this. </p>\n\n<p><a href=\"https://i.stack.imgur.com/xJQVt.png\" rel=\"nofollow noreferrer\">data table</a></p>\n\n<p>And this table is represented by a model, being <code>Metric</code>. You can see that the last metric for the previous month had a value for <code>total_users</code> of 100, and the most recent value for <code>total_users</code> is 105.</p>\n\n<p>What I need to be able to do is compare the most recent value of <code>total_users</code> with the last one for the previous month and come up with the difference. So if we call this variable <code>@net_addition</code>, at the moment the value should be '5', being the difference between 100 and 105. </p>\n\n<p>Obviously the latest record is easy, being <code>Metric.order(\"created_at\").last</code>. </p>\n\n<p>Where I am having a brain block is in finding the last record for the previous month. I'm thinking I need to group the data by month somehow, then find the most recent(but not the current) group, and within that find the last record?</p>\n\n<p>the other thing I thought about was maybe looking to see if the current record is in a different month than the last record and somehow marking that record as being the one for comparison if so, so the last record in each month would end up with a flag against it?</p>\n\n<p>Can anyone get me started?</p>\n"}, {"tags": ["html", "ruby"], "comments": [{"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 1, "creation_date": 1540232658, "post_id": 52935495, "comment_id": 92780110, "body": "What&#39;s the HTML rendered by that <code>link_to</code>? In other words, what&#39;s sent to the browser? Is it the same locally and on Heroku?"}, {"owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540234011, "post_id": 52935495, "comment_id": 92780767, "body": "Looks like your assets are not compiled on Heroku. Could you try <code>heroku run rake assets:precompile</code>?"}, {"owner": {"reputation": 1, "user_id": 10542122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3YaDcBcC4gk/AAAAAAAAAAI/AAAAAAAAABs/OeG6eP5iByU/photo.jpg?sz=128", "display_name": "Runjie Lu", "link": "https://stackoverflow.com/users/10542122/runjie-lu"}, "reply_to_user": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1540234275, "post_id": 52935495, "comment_id": 92780908, "body": "@tompave The HTML is the header of the application and after log out, the user should be linked back to the root page <code>log_out</code> and then <code>redirect_to root_url</code>"}, {"owner": {"reputation": 1, "user_id": 10542122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3YaDcBcC4gk/AAAAAAAAAAI/AAAAAAAAABs/OeG6eP5iByU/photo.jpg?sz=128", "display_name": "Runjie Lu", "link": "https://stackoverflow.com/users/10542122/runjie-lu"}, "reply_to_user": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540234475, "post_id": 52935495, "comment_id": 92781023, "body": "@Vasiliy Ermolovich I will try to do the precompile on Heroku. What does this line mean? I am a new learner of Ruby on Rails and thank you so much for helping me"}, {"owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540235001, "post_id": 52935495, "comment_id": 92781281, "body": "@RunjieLu since you run your app in production mode on Heroku you need to compile your assets (that&#39;s how Rails expects them to be in production <a href=\"https://guides.rubyonrails.org/asset_pipeline.html#in-production\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/asset_pipeline.html#in-production</a>). And you need to do it because when you use <code>method: :delete</code> in your link Rails uses JavaScript to send DELETE request since if you can&#39;t do it without JS with <code>&lt;a&gt;</code> tag."}, {"owner": {"reputation": 1, "user_id": 10542122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3YaDcBcC4gk/AAAAAAAAAAI/AAAAAAAAABs/OeG6eP5iByU/photo.jpg?sz=128", "display_name": "Runjie Lu", "link": "https://stackoverflow.com/users/10542122/runjie-lu"}, "reply_to_user": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540236092, "post_id": 52935495, "comment_id": 92781752, "body": "@VasiliyErmolovich Should I include some new lines in the application.js before doing the precompile? Thanks a lot for sharing this document to me."}, {"owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540236146, "post_id": 52935495, "comment_id": 92781781, "body": "@RunjieLu I think everything is included in new application"}, {"owner": {"reputation": 1, "user_id": 10542122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3YaDcBcC4gk/AAAAAAAAAAI/AAAAAAAAABs/OeG6eP5iByU/photo.jpg?sz=128", "display_name": "Runjie Lu", "link": "https://stackoverflow.com/users/10542122/runjie-lu"}, "reply_to_user": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 1, "creation_date": 1540237028, "post_id": 52935495, "comment_id": 92782239, "body": "@VasiliyErmolovich It works!! Thank you so much for helping!!"}, {"owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "edited": false, "score": 0, "creation_date": 1540237860, "post_id": 52935495, "comment_id": 92782705, "body": "@RunjieLu awesome! I&#39;ll post it as an answer so you can accept it and other people could find it."}], "answers": [{"tags": [], "owner": {"reputation": 23594, "user_id": 336626, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/608b32640d0fca097b40bc6a28cadc5f?s=128&d=identicon&r=PG", "display_name": "Vasiliy Ermolovich", "link": "https://stackoverflow.com/users/336626/vasiliy-ermolovich"}, "is_accepted": true, "score": 0, "last_activity_date": 1540238012, "creation_date": 1540238012, "answer_id": 52936858, "question_id": 52935495, "link": "https://stackoverflow.com/questions/52935495/heroku-cannot-recognize-delete-of-html-for-ruby-on-rails-application/52936858#52936858", "title": "Heroku cannot recognize DELETE of HTML for Ruby on Rails application", "body": "<p>Since you run your app in production mode on Heroku you need to compile your assets. And you need to do it because when you use <code>method: :delete</code> in your link helper Rails uses JavaScript to send DELETE request since you can't do it without JavaScript with <code>&lt;a&gt;</code> tag.</p>\n\n<p>So you need to run <code>heroku run rake assets:precompile</code> to compile them. </p>\n"}], "owner": {"reputation": 1, "user_id": 10542122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3YaDcBcC4gk/AAAAAAAAAAI/AAAAAAAAABs/OeG6eP5iByU/photo.jpg?sz=128", "display_name": "Runjie Lu", "link": "https://stackoverflow.com/users/10542122/runjie-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 52936858, "answer_count": 1, "score": 0, "last_activity_date": 1540238012, "creation_date": 1540232493, "question_id": 52935495, "link": "https://stackoverflow.com/questions/52935495/heroku-cannot-recognize-delete-of-html-for-ruby-on-rails-application", "title": "Heroku cannot recognize DELETE of HTML for Ruby on Rails application", "body": "<p>I have a question about deploying an application on Heroku. When I use DELETE method to kill the current login session, Heroku will instead make a GET call. It works fine in my local apps and fails when deployed on Heroku. I have no idea what I should do under this scenario.  </p>\n\n<p>Here is the code in routes.rb:</p>\n\n<pre><code>get    '/login',   to: 'sessions#new'\npost   '/login',   to: 'sessions#create'\ndelete '/logout',  to: 'sessions#destroy'\n</code></pre>\n\n<p>Here is the HTML code in _header.html.erb:</p>\n\n<pre><code>&lt;li&gt;\n    &lt;%= link_to \"Log out\", logout_path, method: :delete %&gt;\n&lt;/li&gt;\n</code></pre>\n"}, {"tags": ["ruby", "graphql", "graphql-ruby"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 1781803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33eb05f10f2b71b9272ab3da9c379616?s=128&d=identicon&r=PG", "display_name": "unlimitedfocus", "link": "https://stackoverflow.com/users/1781803/unlimitedfocus"}, "is_accepted": true, "score": 1, "last_activity_date": 1540828966, "creation_date": 1540828966, "answer_id": 53049448, "question_id": 52935158, "link": "https://stackoverflow.com/questions/52935158/how-can-i-have-one-field-updating-changing-another-one/53049448#53049448", "title": "How can I have one field updating/changing another one?", "body": "<p>What you want is returning posts with total, page, per_page without re-running database query.</p>\n\n<p>I'd like to modify query definition, because posts, total, page, per_page should be combined in type.</p>\n\n<p>like this: <em>Types::PostListType</em></p>\n\n<pre><code>Types::PostListType = GraphQL::ObjectType.define do\n  name 'PostList'\n\n  field :total, !types.Int\n  field :page, !types.Int\n  field :per_page, !types.Int\n  field :posts, types[Types::PostType]\nend\n</code></pre>\n\n<p>Then return object in resolve which contains <em>posts, total, page, per_page</em></p>\n\n<pre><code>Types::QueryType = GraphQL::ObjectType.define do\n  name \"Query\"\n\n  field :postlist, Types::PostListType do\n    argument :page, types.Int, default_value: 1\n    argument :per_page, types.Int, default_value: 1\n    argument :filter, types.String\n    resolve -&gt;(_obj, args, _ctx) {\n      result = Post.paginate(page: args[:page], per_page: args[:per_page])\n      Posts = Struct.new(:posts, :page, :per_page, :total)\n      Posts.new(\n        result,\n        args[:page],\n        args[:per_page],\n        result.total_entries\n      )\n    }\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>It's also possible define an object and return. <em>Wrapper::PostList</em></p>\n\n<pre><code>module Wrapper\n  class PostList\n    attr_accessor :posts, :total, :page, :per_page\n    def initialize(posts, page, per_page)\n      @posts = posts\n      @total = posts.total_entries\n      @page = page\n      @per_page = per_page\n    end\n  end\nend\n\n...\n  field :postlist, Types::PostListType do\n    argument :page, types.Int, default_value: 1\n    argument :per_page, types.Int, default_value: 1\n    argument :filter, types.String\n    resolve -&gt;(_obj, args, _ctx) {\n      Wrapper::PostList.new(Post.paginate(page: args[:page], per_page: args[:per_page]), args[:page], args[:per_page])\n    }\n...\n</code></pre>\n"}], "owner": {"reputation": 791, "user_id": 129699, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/2iEv8.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/129699/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "accepted_answer_id": 53049448, "answer_count": 1, "score": 6, "last_activity_date": 1540960166, "creation_date": 1540231195, "last_edit_date": 1540960166, "question_id": 52935158, "link": "https://stackoverflow.com/questions/52935158/how-can-i-have-one-field-updating-changing-another-one", "title": "How can I have one field updating/changing another one?", "body": "<p>I'd like to get fields resolved by another field.</p>\n\n<p>I have a list generated according to some arguments and would like to update the total field</p>\n\n<p>My approach is probably incorrect.</p>\n\n<p>Obviously, I'm trying to avoid re-running the same database query and passing filter up a level in the query string.</p>\n\n<p>So assume the following ruby type for my query:</p>\n\n<pre><code>Types::PostListType = GraphQL::ObjectType.define do\n    name 'PostList'\n\n    field :total, !types.Int, default_value: 0 # &lt;-- this is what I'd like to update in :posts resolution\n    field :page, !types.Int, default_value: 0 # &lt;-- this is what I'd like to update in :posts resolution\n    field :per_page, !types.Int, default_value: 0 # &lt;-- this is what I'd like to update in :posts resolution\n\n    field :posts, types[Types::PostType] do\n        argument :page, types.Int, default_value: 1\n        argument :per_page, types.Int, default_value: 10 # &lt;-- also need a limit here (hence why I need a field to tell what's been used in the end)\n        argument :filter, types.String, default_value: ''\n        resolve -&gt;(user, *_args) {\n            posts = function_to_filter(args[:filter])\n            # how do I update total with posts.count here?\n            posts.paginate(page: args[:page], per_page: args[:per_page])\n            # how do I update per_page and page?\n        }\n    end\n\nend\n</code></pre>\n\n<p>My query is something like this:</p>\n\n<pre><code>query ProspectList {\n  posts(filter:\"example\", page: 2) {\n    total\n    page\n    per_page\n    posts {\n      id\n      ...\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "doorkeeper"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540231985, "post_id": 52934716, "comment_id": 92779841, "body": "Its covered in the section <code>Limiting scopes per Application</code> in the wiki page that you linked to. I think you&#39;re just thinking about it wrong. <code>default_scopes</code> it just for setting the default scopes when an application is created in doorkeeper or if the column is empty. Think of it like the default on a database column. To set the scopes per app you alter the database table - not the configuration."}, {"owner": {"reputation": 33, "user_id": 10541936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216ee7deceedcc1e01e28fa0b5968eb3?s=128&d=identicon&r=PG", "display_name": "groe", "link": "https://stackoverflow.com/users/10541936/groe"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540291930, "post_id": 52934716, "comment_id": 92802480, "body": "@max So the <code>default_scopes</code> should not be relevant if the <code>scopes</code> column of the oauth application is populated? My oauth application instance is populated with &quot;identity full_access&quot; scopes, yet when I create a token without explicitely providing the <code>scope</code> parameter, the token is issued with only the &quot;identity&quot; scope, which matches my <code>default_scopes :identity</code> config... It seems like the <code>scopes</code> attribute of an application is meant as a whitelist to requestable scopes, not as a list of default scopes to be applied when the client does explicitely request one."}], "owner": {"reputation": 33, "user_id": 10541936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216ee7deceedcc1e01e28fa0b5968eb3?s=128&d=identicon&r=PG", "display_name": "groe", "link": "https://stackoverflow.com/users/10541936/groe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540229351, "creation_date": 1540229351, "question_id": 52934716, "link": "https://stackoverflow.com/questions/52934716/how-to-define-application-specific-default-scopes-with-doorkeeper", "title": "How to define application-specific default scopes with Doorkeeper?", "body": "<p>I am using doorkeeper for authorization with (trusted) mobile apps and remote webapps.</p>\n\n<p><a href=\"https://github.com/doorkeeper-gem/doorkeeper/wiki/Using-Scopes\" rel=\"nofollow noreferrer\">There are options</a> to:</p>\n\n<ul>\n<li>define default scopes to be used when the client does not provide a <code>scope</code> parameter (<code>default_scopes</code>)</li>\n<li>define additional scopes clients can request (<code>optional_scopes</code>)</li>\n<li>limit scopes that are allowed for each application (attribute <code>scopes</code> of each <code>Doorkeeper::Application</code> instance)</li>\n</ul>\n\n<p>But is there a way to <strong>define default scopes for each application <em>individually</em>?</strong></p>\n\n<p>For <em>most</em> apps I want to provide only the bare minimum as default scopes, and everything else as additional options. <em>Some</em> legacy clients (old mobile app versions), however, need access to many scopes which they do not request explicitely. Is that possible?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "relationship"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1540230237, "post_id": 52934707, "comment_id": 92779053, "body": "Your error is misleading. Did you get that error while doing <code>City.all.joins(:state).order(&#39;state.id&#39;)</code>?"}, {"owner": {"reputation": 4769, "user_id": 9541423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f816e0659e0cf40bbe0ef7224a3a56a0?s=128&d=identicon&r=PG", "display_name": "Sovalina", "link": "https://stackoverflow.com/users/9541423/sovalina"}, "edited": false, "score": 1, "creation_date": 1540230618, "post_id": 52934707, "comment_id": 92779209, "body": "<code>belongs_to :state, through: :city</code> just note that <code>through</code> is not an option for a <code>belongs_to</code> association"}, {"owner": {"reputation": 930, "user_id": 3577922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eURpm.jpg?s=128&g=1", "display_name": "Masa Sakano", "link": "https://stackoverflow.com/users/3577922/masa-sakano"}, "edited": false, "score": 0, "creation_date": 1540257597, "post_id": 52934707, "comment_id": 92788436, "body": "The statement in your example alone would never raise an SQL error (<b>except when you run it in console</b>). Perhaps you can clarify exactly what error you get when you run exactly what statement. Presenting the returned string of <code>City.all.joins(:state).order(&#39;state.id&#39;).explain</code> would help."}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1540271013, "post_id": 52934707, "comment_id": 92791394, "body": "It should be &#39;states.id&#39; instead of &#39;state.id&#39;. Order clause expects table name not the association name"}, {"owner": {"reputation": 84, "user_id": 9347193, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514243305340265/picture?type=large", "display_name": "Rafael Baldasso Audibert", "link": "https://stackoverflow.com/users/9347193/rafael-baldasso-audibert"}, "reply_to_user": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1540309796, "post_id": 52934707, "comment_id": 92814074, "body": "@AkshayGoyal, if you could write it as a real answer, I can mark it as accepted, cause it was just this, really thanks"}, {"owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "edited": false, "score": 0, "creation_date": 1540351754, "post_id": 52934707, "comment_id": 92828166, "body": "I am glad i could help. Added an answer."}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7786120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acd54907ef6cb3d7de0ebd91177850d?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Goyal", "link": "https://stackoverflow.com/users/7786120/akshay-goyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1540310643, "creation_date": 1540310643, "answer_id": 52953429, "question_id": 52934707, "link": "https://stackoverflow.com/questions/52934707/ordering-some-data-with-information-from-another-table/52953429#52953429", "title": "Ordering some data with information from another table", "body": "<p>It should be <code>order('states.id')</code> instead of <code>order('state.id')</code>. Order clause expects table name not the association name.</p>\n"}], "owner": {"reputation": 84, "user_id": 9347193, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514243305340265/picture?type=large", "display_name": "Rafael Baldasso Audibert", "link": "https://stackoverflow.com/users/9347193/rafael-baldasso-audibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52953429, "answer_count": 1, "score": 0, "last_activity_date": 1540310643, "creation_date": 1540229320, "last_edit_date": 1540259384, "question_id": 52934707, "link": "https://stackoverflow.com/questions/52934707/ordering-some-data-with-information-from-another-table", "title": "Ordering some data with information from another table", "body": "<p>there are other questions just like mine here, but none of them actually work for me.</p>\n\n<p>I have a Rails project, with 3 models: Unity, City, State, which have their relationships as below:</p>\n\n<pre><code>class City &lt; ApplicationRecord\n  belongs_to :state\n  has_many :unities\nend\n\nclass State &lt; ApplicationRecord\n    has_many :cities\nend\n\nclass Unity &lt; ApplicationRecord\n    belongs_to :city\n    belongs_to :state, through: :city\nend\n</code></pre>\n\n<p>I wish I could be able to order my unities with respect to their city.name or state.name, as well as to order the cities according to their state.name. But I just can't figure it out. I tried, for example, <code>City.all.joins(:state).order('state.id')</code> as suggested in some question here at StackOverflow, but it gives me <code>missing FROM clause entry for 'city'</code>. How could I make it?</p>\n"}, {"tags": ["json", "ruby", "file", "insert", "append"], "answers": [{"tags": [], "owner": {"reputation": 921, "user_id": 4276844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f448f2372792762904abfe0dd26366ce?s=128&d=identicon&r=PG&f=1", "display_name": "Cam", "link": "https://stackoverflow.com/users/4276844/cam"}, "is_accepted": false, "score": 0, "last_activity_date": 1540228835, "creation_date": 1540228835, "answer_id": 52934596, "question_id": 52934330, "link": "https://stackoverflow.com/questions/52934330/is-there-any-way-to-insert-a-node-at-the-begin-of-the-json-file/52934596#52934596", "title": "is there any way to insert a node at the begin of the JSON file?", "body": "<p>To add your node to insert first instead of last, why not flip the order of your first two lines (with minor alterations)?</p>\n\n<pre><code>jsonArray = [node_to_insert] # initialize to array with your first row\njsonArray.push( *JSON.parse(File.open(JSON_filePath).read) ) # push results,\n               # use the splat operator (*) to avoid array nesting\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8575623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-owg8enGL44s/AAAAAAAAAAI/AAAAAAAAEdc/DXvUS3zt4No/photo.jpg?sz=128", "display_name": "Joshua Brice&#241;o Z", "link": "https://stackoverflow.com/users/8575623/joshua-brice%c3%b1o-z"}, "edited": false, "score": 0, "creation_date": 1542226892, "post_id": 52944312, "comment_id": 93497012, "body": "Also we can use:   <code>jsonArray.unshift(node_to_insert)</code>"}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1540282867, "creation_date": 1540282867, "answer_id": 52944312, "question_id": 52934330, "link": "https://stackoverflow.com/questions/52934330/is-there-any-way-to-insert-a-node-at-the-begin-of-the-json-file/52944312#52944312", "title": "is there any way to insert a node at the begin of the JSON file?", "body": "<p>Instead of <code>&lt;&lt;</code> use <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-prepend\" rel=\"nofollow noreferrer\">Array#prepend</a>. This will insert/prepend instead of append.</p>\n\n<pre><code>jsonArray = JSON.parse(File.open(JSON_filePath).read)\njsonArray.prepend(node_to_insert)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8575623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-owg8enGL44s/AAAAAAAAAAI/AAAAAAAAEdc/DXvUS3zt4No/photo.jpg?sz=128", "display_name": "Joshua Brice&#241;o Z", "link": "https://stackoverflow.com/users/8575623/joshua-brice%c3%b1o-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540282867, "creation_date": 1540227681, "question_id": 52934330, "link": "https://stackoverflow.com/questions/52934330/is-there-any-way-to-insert-a-node-at-the-begin-of-the-json-file", "title": "is there any way to insert a node at the begin of the JSON file?", "body": "<p>is there any way to insert a node at the begin of the JSON file?</p>\n\n<pre><code>jsonArray = JSON.parse(File.open(JSON_filePath).read)\njsonArray &lt;&lt; node_to_insert\n\nFile.open(JSON_FilePath,\"w\") do |f|\n   f.write(JSON.pretty_generate(jsonArray))\nend\n</code></pre>\n\n<p>The script inserts ok, but at the end of the file, I would like to insert at the begin like a first record in the JSON file. </p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-ec2", "vagrant"], "answers": [{"comments": [{"owner": {"reputation": 1511, "user_id": 1979665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb45b0396e6579f551c10aa3d77e6a4?s=128&d=identicon&r=PG", "display_name": "umbe1987", "link": "https://stackoverflow.com/users/1979665/umbe1987"}, "edited": false, "score": 0, "creation_date": 1540272175, "post_id": 52940366, "comment_id": 92791740, "body": "Damn it, copy and paste you did it again! Thanks will try that later."}, {"owner": {"reputation": 1511, "user_id": 1979665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb45b0396e6579f551c10aa3d77e6a4?s=128&d=identicon&r=PG", "display_name": "umbe1987", "link": "https://stackoverflow.com/users/1979665/umbe1987"}, "edited": false, "score": 0, "creation_date": 1540365761, "post_id": 52940366, "comment_id": 92832887, "body": "That indeed made the trick. I had hard times with SSH and group security but this is another thing... Thanks for helping me out!"}, {"owner": {"reputation": 2194, "user_id": 2142505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f16433508978bc7ab06ee6fd8f124b?s=128&d=identicon&r=PG", "display_name": "davejagoda", "link": "https://stackoverflow.com/users/2142505/davejagoda"}, "reply_to_user": {"reputation": 1511, "user_id": 1979665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb45b0396e6579f551c10aa3d77e6a4?s=128&d=identicon&r=PG", "display_name": "umbe1987", "link": "https://stackoverflow.com/users/1979665/umbe1987"}, "edited": false, "score": 0, "creation_date": 1540389152, "post_id": 52940366, "comment_id": 92847799, "body": "Great news! Glad you figured it out."}], "tags": [], "owner": {"reputation": 2194, "user_id": 2142505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f16433508978bc7ab06ee6fd8f124b?s=128&d=identicon&r=PG", "display_name": "davejagoda", "link": "https://stackoverflow.com/users/2142505/davejagoda"}, "is_accepted": true, "score": 1, "last_activity_date": 1540262178, "creation_date": 1540262178, "answer_id": 52940366, "question_id": 52933132, "link": "https://stackoverflow.com/questions/52933132/using-vagrant-with-amazon-ec2/52940366#52940366", "title": "Using vagrant with Amazon EC2", "body": "<p>You have some 'smart quotes' instead of single quotes. Change all of these:</p>\n\n<pre><code>\u2019\n</code></pre>\n\n<p>To be like this:</p>\n\n<pre><code>'\n</code></pre>\n\n<p>Regular double quotes should also work, just no smart quotes.</p>\n"}], "owner": {"reputation": 1511, "user_id": 1979665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb45b0396e6579f551c10aa3d77e6a4?s=128&d=identicon&r=PG", "display_name": "umbe1987", "link": "https://stackoverflow.com/users/1979665/umbe1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 52940366, "answer_count": 1, "score": 1, "last_activity_date": 1540262178, "creation_date": 1540223109, "last_edit_date": 1540246744, "question_id": 52933132, "link": "https://stackoverflow.com/questions/52933132/using-vagrant-with-amazon-ec2", "title": "Using vagrant with Amazon EC2", "body": "<p>I am new to Amazon AWS and Vagrant.</p>\n\n<p>I opened a 12-moths free account and I'd like to test EC2 for my personal project.\nI'd need to test <a href=\"https://docs.qgis.org/2.8/en/docs/user_manual/working_with_ogc/ogc_server_support.html\" rel=\"nofollow noreferrer\">QGIS Server</a> software.</p>\n\n<p>Instead of creating a new instance and installing all the dependencies from scratch, I thought to use <a href=\"https://github.com/elpaso/qgis3-server-vagrant\" rel=\"nofollow noreferrer\">this repo</a>, which ships a Vagrant image of QGIS Server and all the needed software to test it out.</p>\n\n<p>I probably would be able to do this on my personal laptop but I am unsure on how to proceed with a EC2 instance.</p>\n\n<p>Looking at <a href=\"https://stackoverflow.com/a/16873065/1979665\">this SO answer</a> it seems I can use <a href=\"https://github.com/mitchellh/vagrant-aws\" rel=\"nofollow noreferrer\">vagrant-aws</a> plugin to do it.</p>\n\n<p>However, it teh README also reads:</p>\n\n<blockquote>\n  <p>Of course prior to doing this, you'll need to obtain an AWS-compatible box file for Vagrant.</p>\n</blockquote>\n\n<p>What does that supposed to mean?</p>\n\n<p>Could anyone with some experience help me understanding what do I need besides the Vagrant file and the Amazon AWS account to accomplish this task?</p>\n\n<p>Do I need to create an instance first or should I do it using the vagrant-aws plugin?</p>\n\n<p>Many thanks in advance.</p>\n\n<p><strong>EDIT1</strong></p>\n\n<p>I think I made huge improvements.</p>\n\n<p>So I read through tons of docs, and I finally ended up with a Vagrantfile that is a mix between the one from <a href=\"https://github.com/mitchellh/vagrant-aws\" rel=\"nofollow noreferrer\">mitchellh/vagrant-aws</a> and the one from <a href=\"https://github.com/elpaso/qgis3-server-vagrant/blob/master/Vagrantfile\" rel=\"nofollow noreferrer\">elpaso/qgis3-server-vagrant</a>.</p>\n\n<p>Then I am supposed to run <code>vagrant up --provider=aws</code> but I get some syntax errors. I think my lack of knowledge in Ruby is my main obstacle here.</p>\n\n<p>Here is my MODIFIED <code>Vagrantfile</code> (without the SECRET AWS stuff):</p>\n\n<pre><code># -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Require the AWS provider plugin\nrequire \u2018vagrant-aws\u2019\n\n# Creating and configuring the AWS instance\nVagrant.configure(\u20182\u2019) do |config|\n\n\n  # Use dummy AWS box\n  config.vm.box = \u2018aws\u2019\n\n  # Disk space (free tier ebs is limited to 30!!!)\n  config.disksize.size = '20GB'\n\n  # (taken from https://github.com/elpaso/qgis3-server-vagrant)\n  config.vm.network \"forwarded_port\", guest: 80, host: 8080 # nginx fastcgi\n  config.vm.network \"forwarded_port\", guest: 81, host: 8081 # apache fastcgi\n  config.vm.network \"forwarded_port\", guest: 82, host: 8082 # nginx uwsgi\n  config.vm.network \"forwarded_port\", guest: 83, host: 8083 # nginx mapproxy\n\n  # Specify configuration of AWS provider\n  config.vm.provider \u2018aws\u2019 do |aws, override|\n    # Read AWS authentication information from environment variables\n    aws.access_key_id = \u2018MY_ACCESS_ID\u2019\n    aws.secret_access_key = \u2018MY_SECRET_ID\u2019\n    # Specify SSH keypair to use\n    aws.keypair_name = \u2018MY_KEY\u2019\n    # Specify region, AMI ID, Instance and security group\n    aws.region = \u2018eu-west-3\u2019\n    aws.ami = \u2018ami-38a01045\u2019\n    aws.instance_type = \u2018t2.micro\u2019\n    # Specify username and private key path\n    override.ssh.username = \u2018umberto\u2019\n    override.ssh.private_key_path = \u2018path/to/my/key/pair\u2019\n  end\n\n    # Install the required software\n  config.vm.provision \"shell\",\n    path: \"provisioning/setup.sh\",\n    args: ENV['SHELL_ARGS']\n\n  # Run every time the VM starts\n  config.vm.provision \"shell\",\n    path: \"provisioning/job.sh\",\n    args: ENV['SHELL_ARGS'],\n    run: \"always\"\n\nend\n</code></pre>\n\n<p>The errors I am getting are:</p>\n\n<pre><code>There is a syntax error in the following Vagrantfile. The syntax error\nmessage is reproduced below for convenience:\n\n/home/umberto/Documents/amazon_aws/qgis3-server-vagrant-AWS/Vagrantfile:35: syntax error, unexpected tIDENTIFIER, expecting keyword_end\n  aws.region = \u2018eu-west-3\u2019\n                              ^\n/home/umberto/Documents/amazon_aws/qgis3-server-vagrant-AWS/Vagrantfile:36: syntax error, unexpected tIDENTIFIER, expecting keyword_end\n  aws.ami = \u2018ami-38a01045\u2019\n                              ^\n/home/umberto/Documents/amazon_aws/qgis3-server-vagrant-AWS/Vagrantfile:42: syntax error, unexpected keyword_end, expecting end-of-input\n  end\n     ^\n</code></pre>\n\n<p>Can anybody with a bit of Ruby knowledge help me please? I think I am stuck in what seems the very last step...</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-admin", "rails-api"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540223408, "post_id": 52933013, "comment_id": 92775654, "body": "Did you <code>include Knock::Authenticable</code> in your ApplicationController? You have to include the helpers manually since Knock does not monkeypatch your controllers like Devise does."}, {"owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540223527, "post_id": 52933013, "comment_id": 92775722, "body": "Hi @max, thank you very much for your help ! yes, I did add <code>include Knock::Authenticable</code> in my application controller."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540223975, "post_id": 52933013, "comment_id": 92775952, "body": "Oh yeah, you&#180;re using <code>ActiveAdmin</code>. In that case you need to configure AA to use the correct method by setting <code>config.current_user_method = :current_user</code> in <code>config&#47;initializers&#47;active_admin.rb.</code>. <a href=\"https://activeadmin.info/1-general-configuration.html#authentication\" rel=\"nofollow noreferrer\">activeadmin.info/1-general-configuration.html#authentication</a>"}, {"owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540224225, "post_id": 52933013, "comment_id": 92776085, "body": "no I am using rails admin: <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow noreferrer\">github.com/sferik/rails_admin</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540224843, "post_id": 52933013, "comment_id": 92776426, "body": "Sorry, my bad. Try setting <code>config.current_user_method(&amp;:current_user)</code> in <code>config&#47;initializers&#47;rails_admin.rb</code>."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540224964, "post_id": 52933013, "comment_id": 92776500, "body": "Also you should <code>raise RailsAdmin::ActionNotAllowed</code> not <code>ActionController::RoutingError</code>. <code>404 - Not Found</code> is not the correct response."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540225259, "post_id": 52933013, "comment_id": 92776650, "body": "Also using knock for your admin interface is not really going to work that well out of the box. Knock is stateless so clients need to send credentials for every request which means you need to use a SPA, while RailsAdmin is meant for &quot;classical apps&quot;  with server side rendering and session based auth."}, {"owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540225383, "post_id": 52933013, "comment_id": 92776723, "body": "adding <code>config.current_user_method(&amp;:current_user)</code> gave me the same error output unfortunately :(. I know this isn&#39;t the correct response but I would like to raise 404 error so that people think there isn&#39;t any <code>&#47;admin</code> page.  Regarding Knock, it is the only tutorial I found to have a proper React + Rails authentication. If you know any better solution, I&#39;ll take it :)"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540226254, "post_id": 52933013, "comment_id": 92777112, "body": "I don&#39;t think just slapping RailsAdmin on is really going to do that much for you. You need to add a session based authentication system for the admin section like Warden/Devise/roll your own. This also requires adding back a bunch of the middleware which API apps skirt."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540226440, "post_id": 52933013, "comment_id": 92777210, "body": "You could consider creating a seperate app for the admin interface which is a &quot;classical&quot; rails app with Devise/Warden for authentication and then splitting your models into a gem for reuse - but I would consider if creating your own React admin UI is actually less work in the end."}], "owner": {"reputation": 1411, "user_id": 6776035, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/33c72abeb78d3742e8c0064bed548b8e?s=128&d=identicon&r=PG", "display_name": "Uj Corb", "link": "https://stackoverflow.com/users/6776035/uj-corb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 499, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540223218, "creation_date": 1540222674, "last_edit_date": 1540223218, "question_id": 52933013, "link": "https://stackoverflow.com/questions/52933013/user-authorization-rails-admin-rails-api-react-js", "title": "User authorization Rails Admin + Rails API + React JS", "body": "<p>I made a custom authentication system for my app (Rails API backend + React front end) using the <code>bcript</code> and <code>knock</code> gems. (see tutorial: <a href=\"https://ericlondon.com/2018/03/18/rails-5-api-and-react-frontend-jwt-token-authentication.html\" rel=\"nofollow noreferrer\">here</a>)</p>\n\n<p>I added <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow noreferrer\">Rails Admin</a> to have a ready-to-use Admin interface, and I am now trying to manage authorization: I want only my users with the field <code>is_admin</code> set to <code>true</code> to be able to access the admin pages. </p>\n\n<p>Hence I added this to my config/initializers/rails_admin.rb: </p>\n\n<pre><code>  config.authorize_with do |controller|\n    if current_user.nil? || !current_user.is_admin\n      raise ActionController::RoutingError.new('Not Found')\n    end\n  end\n</code></pre>\n\n<p>But when I try to access my admin pages in development I get the following error: </p>\n\n<p><code>NameError in RailsAdmin::MainController#dashboard</code>\n<code>undefined local variable or method 'current_user' for #&lt;RailsAdmin::MainController:0x007feeec371b98&gt; Did you mean? _current_user</code></p>\n\n<p>using <code>_current_user</code> does not seem to solve the problem. </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1540224364, "post_id": 52932516, "comment_id": 92776158, "body": "Please (edit to) clarify &quot;function executions&quot; in the first sentence."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1540224598, "post_id": 52932516, "comment_id": 92776277, "body": "Note: Ruby uses two spaces for indentation."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1540224869, "post_id": 52932516, "comment_id": 92776441, "body": "In the first case you&#39;re calling <code>wrap</code> before the method&#39;s defined, in the second after. Does this have something to do with the difference?"}, {"owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "edited": false, "score": 0, "creation_date": 1540226798, "post_id": 52932516, "comment_id": 92777391, "body": "In the first case I&#39;m calling <code>wrap</code> with hard coded arguments. But I want to call <code>wrap</code> without listing all method names individually. <code>instance_methods(false)</code> returns an array of all defined instance_method names of a class. But If I call <code>instance_methods(false)</code> on top of the class definition, it returns an empty array because the methods are not defined yet - the are getting defined below. If I call it at the bottom of the class, it will work because the methods have been defined above."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1540230599, "post_id": 52932516, "comment_id": 92779199, "body": "This is, presumably, instrumentation for testing. Does it make sense to call <code>wrap instance_methods(false)</code> inside the class definition? Would it instead normally be called on the class by something testing the class? <code>wrap TestClass, TestClass.instance_methods(false)</code>?"}, {"owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "edited": false, "score": 0, "creation_date": 1540234832, "post_id": 52932516, "comment_id": 92781205, "body": "I want to use it for error handling and logging. And I want to use the wrapper like a Rails callback.. I see your point, but I need to call wrap inside of the class definition."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "edited": false, "score": 0, "creation_date": 1540298579, "post_id": 52944676, "comment_id": 92806601, "body": "The <code>method_added</code> hook worked for me! Thank you so much. I will update my post with my current solution within the next hours."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 1, "last_activity_date": 1540283936, "creation_date": 1540283936, "answer_id": 52944676, "question_id": 52932516, "link": "https://stackoverflow.com/questions/52932516/get-all-instance-methods-on-top-of-the-class-definition/52944676#52944676", "title": "Get all instance methods on top of the class definition", "body": "<p>You could use the <a href=\"https://ruby-doc.org/core-2.5.0/Module.html#method-i-method_added\" rel=\"nofollow noreferrer\">Module#method_added</a> hook to automatically wrap any methods that are added.</p>\n\n<p>You will need some magic to not get a stack overflow from an infinite loop.</p>\n\n<p>Another option is to use <a href=\"https://ruby-doc.org/core-2.5.0/TracePoint.html\" rel=\"nofollow noreferrer\">TracePoint</a> to trigger the wrapping once the class has been defined. You can use the <code>Module#extended</code> to set up the tracepoint. Something like:</p>\n\n<pre><code>module Finalizer\n  def self.extended(obj)\n    TracePoint.trace(:end) do |t|\n      if obj == t.self\n        obj.finalize\n        t.disable\n      end\n    end\n  end\n\n  def finalize\n    wrap(*instance_methods(false))\n  end\nend\n</code></pre>\n\n<p>Classes are usually not exactly \"closed\" unless you explicitly <code>.freeze</code> them so it's a bit of a hacky solution and will not trigger if methods are added afterwards. <code>method_added</code> is probably your best bet.</p>\n"}], "owner": {"reputation": 327, "user_id": 4942323, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxEAB.jpg?s=128&g=1", "display_name": "Sepp", "link": "https://stackoverflow.com/users/4942323/sepp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52944676, "answer_count": 1, "score": 2, "last_activity_date": 1540333129, "creation_date": 1540220914, "last_edit_date": 1592644375, "question_id": 52932516, "link": "https://stackoverflow.com/questions/52932516/get-all-instance-methods-on-top-of-the-class-definition", "title": "Get all instance methods on top of the class definition", "body": "<p>I'm trying to wrap all instance methods of <code>TestClass</code> to perform code <em>before</em> and <em>after</em> an instance method is called. So far, this code is working:</p>\n<pre><code>module Wrapper\n  def wrap(*methods)\n    prependable_module = Module.new do\n      methods.each do |m|\n        define_method(m) do |*args, &amp;block|\n          p 1\n          super(*args, &amp;block)\n          p 3\n        end\n      end\n    end\n\n    prepend prependable_module\n  end\nend\n\nclass TestClass\n  extend Wrapper\n  wrap :instance_method1\n\n  def instance_method1\n    p 2\n  end\nend\n\nTestClass.new.instance_method1 # =&gt; 1, 2, 3\n</code></pre>\n<p>I can call <code>wrap</code> with all method names as arguments. If I try to wrap all methods without listing them individually, I need to call it using <code>instance_methods(false)</code> at the bottom of the class definition.</p>\n<pre><code>class TestClass\n  extend Wrapper\n    \n  def instance_method1\n    p 2\n  end\n  \n  wrap(*instance_methods(false))\nend\n</code></pre>\n<p>In Rails, all callback methods like <code>before_action</code> or <code>after_create</code> are usually called on top of the class definition. <strong>My goal is to call <code>wrap</code> on top of the class definition</strong> as well (without listing all methods individually). In this case, I can't call <code>instance_methods(false)</code> on top of the class definition, because at this point no method has been defined.</p>\n<p>Thanks for your help!</p>\n<h1>Update</h1>\n<p>Thanks to <a href=\"https://stackoverflow.com/a/52944676/4942323\">Kimmo Lehto's</a> approach I can wrap every instance method using the <code>method_added</code> hook. I don't want to prepend a new module for every defined method, so I add all overridden methods to the same module.</p>\n<pre><code>module Wrapper\n  def method_added(method_name)\n    tmp_module = find_or_initialize_module\n    return if tmp_module.instance_methods(false).include?(method_name)\n\n    tmp_module.define_method(method_name) do |*args, &amp;block|\n      p 1\n      super(*args, &amp;block)\n      p 3\n    end\n  end\n\n  def find_or_initialize_module\n    module_name  = &quot;#{name}Wrapper&quot;\n    module_idx   = ancestors.map(&amp;:to_s).index(module_name)\n\n    unless module_idx\n      prepend Object.const_set(module_name, Module.new)\n      return find_or_initialize_module\n    end\n\n    ancestors[module_idx]\n  end\nend\n\nclass TestClass\n  extend Wrapper\n\n  def instance_method1\n    p 2\n  end\nend\n\ntc = TestClass.new\ntc.instance_method1 # =&gt; 1, 2, 3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "authentication"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540227162, "post_id": 52931805, "comment_id": 92777582, "body": "There are many different ways to do this - which is why this question is off topic. The simpest solution is to use JWT&#39;s for authentication on the API app but there is also the option of setting up a seperate authentication service which serves both apps (a third app) - which works like having your own OAuth service."}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540228240, "post_id": 52931805, "comment_id": 92778109, "body": "That&#39;s why I asked those who had an experience of building such systems. Single Sign On is cool, but it seems a bit of overkill for me. My initial idea was about using JWT tokens, but maybe it could be possible with reusing cookies as well"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540228529, "post_id": 52931805, "comment_id": 92778251, "body": "&quot;Whats the best way to do X?&quot; type questions are <a href=\"https://stackoverflow.com/help/dont-ask\">off-topic on Stackoverflow</a> since its a Q&amp;A site for questions that can be answered and not just discussed. You might want to try reddit or somewhere else for general advice."}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540230082, "post_id": 52931805, "comment_id": 92778981, "body": "Just found <a href=\"https://stackoverflow.com/questions/10960131/authentication-authorization-and-session-management-in-traditional-web-apps-and?rq=1\">some</a> <a href=\"https://stackoverflow.com/questions/20689759/api-authentication-for-user-logged-in-to-a-web-app-server?rq=1\">questions</a> about the same topic which are even more generic but were warmly welcomed here. But they are old :("}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540230546, "post_id": 52931805, "comment_id": 92779182, "body": "SO was a lot more lax when it was a small - but as it grew we need to become more selective as a community to avoid it becoming a discussion forum or garbage heap of unanswerable questions."}], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540218677, "creation_date": 1540218677, "question_id": 52931805, "link": "https://stackoverflow.com/questions/52931805/how-to-authenticate-user-logged-into-main-app-to-access-api-on-another-server", "title": "How to authenticate user, logged into main app, to access API on another server?", "body": "<p>I want to refactor my Ruby on Rails application and split it into 2 parts.</p>\n\n<p>Currently, it's a monolithic app that incorporates user registration/authentication, resource management, report sending by mail and rich UI. Usually, a page of the application is a container with widgets; every widget fetches data from the server using some internal API that feeds client with data in JSON format. These widgets are too many and their API is a significant part of the app. I want to extract that API into a separate application. The main application will continue to serve user requests at <strong>www.app.com</strong> address, and API will be available at <strong>api.app.com</strong></p>\n\n<p>Question: how to protect API app and prevent unauthorized access? The main app uses sessions (with cookies). Now, these sessions are being validated when a request to API is processed. Since it will be a new app living on another server, I'm not sure I could validate those sessions. So what's the option? Using JWT tokens or? Could you share examples from your <strong>experience</strong> please?</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1540219160, "post_id": 52931686, "comment_id": 92773067, "body": "Not sure what you mean by &#39;one go&#39;."}, {"owner": {"reputation": 1782, "user_id": 200136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7dd81a5c9b3e188d470be58740f3377?s=128&d=identicon&r=PG", "display_name": "Andrew McGuinness", "link": "https://stackoverflow.com/users/200136/andrew-mcguinness"}, "reply_to_user": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1540220128, "post_id": 52931686, "comment_id": 92773704, "body": "Maybe you should add to your question what you think should be happening."}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1540220501, "post_id": 52931686, "comment_id": 92773919, "body": "Done. Looking for a return of even numbers in the array."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1540225535, "post_id": 52931686, "comment_id": 92776794, "body": "@DaveNewton \u201cYou yield the array\u201d\u2014nope, it\u2019s <code>Enumerator</code> instance returned by <code>select</code> what gets yielded."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1540226553, "post_id": 52931686, "comment_id": 92777263, "body": "@AlekseiMatiushkin Whoops, yep, missed the <code>.select</code> somehow :/"}], "tags": [], "owner": {"reputation": 1782, "user_id": 200136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7dd81a5c9b3e188d470be58740f3377?s=128&d=identicon&r=PG", "display_name": "Andrew McGuinness", "link": "https://stackoverflow.com/users/200136/andrew-mcguinness"}, "is_accepted": false, "score": 0, "last_activity_date": 1540218305, "creation_date": 1540218305, "answer_id": 52931686, "question_id": 52931622, "link": "https://stackoverflow.com/questions/52931622/undefined-method-error-when-using-yield-and-even/52931686#52931686", "title": "Undefined method error when using &#39;yield&#39; and &#39;even?&#39;", "body": "<p>yield(array) is passing the whole array in one go to the block given to the method, so it is trying to call even? on the array. </p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1540225458, "creation_date": 1540225458, "answer_id": 52933783, "question_id": 52931622, "link": "https://stackoverflow.com/questions/52931622/undefined-method-error-when-using-yield-and-even/52933783#52933783", "title": "Undefined method error when using &#39;yield&#39; and &#39;even?&#39;", "body": "<ul>\n<li><code>Array#select</code> returns an <code>Enumerator</code> instance if no block was given to it</li>\n<li>then you call <code>selection</code> method passing the result of call to <code>collection.select</code> as an argument and <code>{ |num| num.even? }</code> as block</li>\n<li>inside your <code>selection</code> function you <code>yield</code> the argument (an <code>Enumerator</code> instance) to the block</li>\n<li>in the block you call <code>even?</code> on the block argument, resulting in the error message you receive.</li>\n</ul>\n\n<p>I am unsure what\u2019s wrong with <code>collection.select(&amp;:even?)</code>, but if you want to re-implement it yourself, here you go:</p>\n\n<pre><code>def selection(array)\n  # convention: return enumerator unless block is given\n  return enum_for(:selection) unless block_given?\n\n  enumerator = array.each\n  result = []\n\n  loop do\n    (value = enumerator.next) rescue return result\n    result.push(value) if yield value\n  end\nend\n\nselection([1,2,3,4,5]) { |num| num.even? }\n#\u21d2 [2, 4]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1540311183, "post_id": 52933923, "comment_id": 92814871, "body": "Yes thank you. I realized that I had to have a conditional for this. Oh and a simple call without the &#39;puts&#39; returns the selected array."}, {"owner": {"reputation": 100, "user_id": 10463251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff958d5dc3d428d04f1cce2f80433712?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W.", "link": "https://stackoverflow.com/users/10463251/kevin-w"}, "reply_to_user": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1540340401, "post_id": 52933923, "comment_id": 92826062, "body": "Glad it helped! Please, consider accepting my answer."}], "tags": [], "owner": {"reputation": 100, "user_id": 10463251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff958d5dc3d428d04f1cce2f80433712?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin W.", "link": "https://stackoverflow.com/users/10463251/kevin-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1540226354, "last_edit_date": 1540226354, "creation_date": 1540225995, "answer_id": 52933923, "question_id": 52931622, "link": "https://stackoverflow.com/questions/52931622/undefined-method-error-when-using-yield-and-even/52933923#52933923", "title": "Undefined method error when using &#39;yield&#39; and &#39;even?&#39;", "body": "<p>You are seeing this error because you are passing an enumerator object in to your \"selection\" method ... that is, the result of \"collection.select\" is an Enumerator and enumerators do not implement an \"even\" method.</p>\n\n<p>I believe that you are trying to implement your own version of \"select\".  The following is one way to achieve your stated intent:  \"I'm looking for a return of even numbers in the array.\"</p>\n\n<pre><code>def selection(array)\n\n  results = []\n  for item in array do\n    results &lt;&lt; item if yield item \n  end\n  results\nend\n\ncollection = [1,2,3,4,5]\nputs selection(collection) { |num| num.even? }\n\n# =&gt; [2,4]\n</code></pre>\n\n<p><a href=\"https://mixandgo.com/learn/mastering-ruby-blocks-in-less-than-5-minutes\" rel=\"nofollow noreferrer\">https://mixandgo.com/learn/mastering-ruby-blocks-in-less-than-5-minutes</a> is a nice reference</p>\n"}], "owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 52933923, "answer_count": 3, "score": 1, "last_activity_date": 1540282764, "creation_date": 1540218120, "last_edit_date": 1540282764, "question_id": 52931622, "link": "https://stackoverflow.com/questions/52931622/undefined-method-error-when-using-yield-and-even", "title": "Undefined method error when using &#39;yield&#39; and &#39;even?&#39;", "body": "<p>When I try to call a method with <code>select</code> and <code>num.even?</code> as follows,</p>\n\n<pre><code>def selection(array)\n  puts \"This is inside the method\"\n  return yield(array)\nend\n\ncollection = [1,2,3,4,5]\nselection(collection.select) { |num| num.even? } \n</code></pre>\n\n<p>I get a no defined Method error:</p>\n\n<pre><code>undefined method `even?' for #&lt;Enumerator: [1, 2, 3, 4, 5]:select&gt;  \n</code></pre>\n\n<p>I'm looking for a return of even numbers in the array. I can get the <code>select</code> <code>even?</code> combo work in other examples of an array.</p>\n"}, {"tags": ["ruby", "webarchive"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5456259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dhh1k.jpg?s=128&g=1", "display_name": "nealmegh", "link": "https://stackoverflow.com/users/5456259/nealmegh"}, "edited": false, "score": 1, "creation_date": 1540219566, "post_id": 52930953, "comment_id": 92773348, "body": "Thanks you are a GEM. :D"}], "tags": [], "owner": {"reputation": 4754, "user_id": 1209628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa17169df5962bb7d05e661c3b6ba4f1?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/1209628/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1540215986, "creation_date": 1540215986, "answer_id": 52930953, "question_id": 52930742, "link": "https://stackoverflow.com/questions/52930742/wayback-machine-donwloader-giving-an-error-trying-to-download-http-mexiko-lex/52930953#52930953", "title": "wayback_machine_donwloader giving an error trying to download &quot;http://mexiko-lexikon.de&quot; from web archive", "body": "<p>Give a try to this one:</p>\n\n<pre><code>wayback_machine_downloader https://www.mexiko-lexikon.de --from 20120624174321\n</code></pre>\n\n<p>Sidenote: change the <code>http</code> protocoll to <code>https</code>!</p>\n\n<p>Result:</p>\n\n<pre><code>Downloading https://www.mexiko-lexikon.de to websites/www.mexiko-lexikon.de/ from Wayback Machine archives.\n\nGetting snapshot pages.. found 32 snaphots to consider.\n\n1 files to download:\nhttp://mexiko-lexikon.de/ -&gt; websites/www.mexiko-lexikon.de/index.html (1/1)\n\nDownload completed in 3.46s, saved in websites/www.mexiko-lexikon.de/ (1 files)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5456259, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dhh1k.jpg?s=128&g=1", "display_name": "nealmegh", "link": "https://stackoverflow.com/users/5456259/nealmegh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 52930953, "answer_count": 1, "score": 1, "last_activity_date": 1540215986, "creation_date": 1540215330, "last_edit_date": 1540215570, "question_id": 52930742, "link": "https://stackoverflow.com/questions/52930742/wayback-machine-donwloader-giving-an-error-trying-to-download-http-mexiko-lex", "title": "wayback_machine_donwloader giving an error trying to download &quot;http://mexiko-lexikon.de&quot; from web archive", "body": "<p><a href=\"https://i.stack.imgur.com/vtuwT.png\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n\n<p>Any idea why I am getting this? </p>\n\n<pre><code>Getting snapshot pagesTraceback (most recent call last):\n        16: from C:/Ruby25-x64/bin/wayback_machine_downloader:23:in `&lt;main&gt;'\n        15: from C:/Ruby25-x64/bin/wayback_machine_downloader:23:in `load'\n        14: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/bin/wayback_machine_downloader:72:in `&lt;top (required)&gt;'\n        13: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader.rb:192:in `download_files'\n        12: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader.rb:309:in `file_list_by_timestamp'\n        11: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader.rb:168:in `get_file_list_by_timestamp'\n        10: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader.rb:105:in `get_file_list_curated'\n         9: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader.rb:88:in `get_all_snapshots_to_consider'\n         8: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/wayback_machine_downloader-2.2.1/lib/wayback_machine_downloader/archive_api.rb:8:in `get_raw_list_from_api'\n         7: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:35:in `open'\n         6: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:735:in `open'\n         5: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:165:in `open_uri'\n         4: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:224:in `open_loop'\n         3: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:224:in `catch'\n         2: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:226:in `block in open_loop'\n         1: from C:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:755:in `buffer_open'\nC:/Ruby25-x64/lib/ruby/2.5.0/open-uri.rb:377:in `open_http': 403 Forbidden (OpenURI::HTTPError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "edited": false, "score": 0, "creation_date": 1540210719, "post_id": 52928599, "comment_id": 92767457, "body": "Why there is <code>Leave.new</code> ?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "reply_to_user": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "edited": false, "score": 0, "creation_date": 1540211564, "post_id": 52928599, "comment_id": 92767991, "body": "In other place, in an index view, admin creates new leave request for employee. Well... I think I shouldn&#39;t put it here(I mean in this question). Probably I&#39;ll remove this option, will see."}], "answers": [{"comments": [{"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540213186, "post_id": 52929503, "comment_id": 92769044, "body": "Thanks for superb explanations, these are really helpful unfortunately I received an error message <a href=\"https://imgur.com/2K9V1HO\" rel=\"nofollow noreferrer\">param is missing or the value is empty: leave</a> after pushed the filter button."}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540213319, "post_id": 52929503, "comment_id": 92769130, "body": "why are you using <code>leave_params</code> for index page?"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540214383, "post_id": 52929503, "comment_id": 92769874, "body": "I don&#39;t know to be honest, my controller looks exactly the same as in the first post, I removed all from view except this form_tag but it didn&#39;t helped. Maybe you will find something in my controller? <a href=\"https://imgur.com/MMn5UST\" rel=\"nofollow noreferrer\">first</a> <a href=\"https://imgur.com/7U52Mgn\" rel=\"nofollow noreferrer\">second</a>"}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540215291, "post_id": 52929503, "comment_id": 92770528, "body": "I&#39;ve updated the answer, change <code>url</code> with index method path for leaves_controller. you can check by running <code>rails routes</code> in the terminal"}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540215501, "post_id": 52929503, "comment_id": 92770685, "body": "what is the url you&#39;re hitting? your url should be <code>localhost:3000&#47;leaves</code> and if you&#39;re submitting the form it should hit <code>index</code> method but it&#39;s hitting <code>create</code> method. Change the url in form_tag and let me know."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540216695, "post_id": 52929503, "comment_id": 92771466, "body": "Actually it&#39;s is in <code>localhost:3000&#47;admin&#47;leaves</code> so I&#39;ve changed <code>url</code> to the <code>admin_leave_path</code> <a href=\"https://imgur.com/NrzR6HG\" rel=\"nofollow noreferrer\">as in routes</a> but it didn&#39;t helped either, still same error."}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "reply_to_user": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540216790, "post_id": 52929503, "comment_id": 92771537, "body": "make it <code>admin_leaves_path</code>"}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540218068, "post_id": 52929503, "comment_id": 92772369, "body": "Yup, my mistake but it was <code>admin_leaves_path</code> instead of <code>admin_leave_path</code> at the beginning so the same error, again."}, {"owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "edited": false, "score": 0, "creation_date": 1540221040, "post_id": 52929503, "comment_id": 92774269, "body": "It works! I just have to restart server and use <code>spring stop</code> - after that it&#39;s working as it should be! Thank you so much for your assist."}], "tags": [], "owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "is_accepted": true, "score": 1, "last_activity_date": 1540216764, "last_edit_date": 1540216764, "creation_date": 1540211640, "answer_id": 52929503, "question_id": 52928599, "link": "https://stackoverflow.com/questions/52928599/rails-select-tag-to-using-scope-to-simple-filter/52929503#52929503", "title": "Rails select_tag to using scope to simple filter", "body": "<p>Change your code to this</p>\n\n<pre><code>def index\n  @leave = Leave.new # as you have added it, won't affect what we want to achieve.\n  #if params have status then only you've to show \n  #the selected ones otherwise you'll be showing all \n  #of them. right?\n  if params[:status].present?\n    @leaves = Leave.where(status: params[:status])\n    #dont use find_by it will return only one record instead of array.\n  else\n    @leaves = Leave.includes(:user).order(created_at: :desc)\n  end\nend\n\n\n&lt;%= form_tag(url: admin_leaves_path, method: :get) do %&gt;\n  &lt;div class=\"input-group\"&gt;\n    #Leave.approved will hit database from view. which is not recommended \n    #instead of that try using values which will be accessed in controller\n    #via params and then you can perform actions according to it.\n    &lt;%= select_tag :status, options_for_select([['Approved', true], ['Pending', false]]) %&gt;\n    &lt;%= submit_tag 'Filter' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1285, "user_id": 10443890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de817ef35c4a2bdd0501efbdc6d9a338?s=128&d=identicon&r=PG&f=1", "display_name": "mr_muscle", "link": "https://stackoverflow.com/users/10443890/mr-muscle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "accepted_answer_id": 52929503, "answer_count": 1, "score": 1, "last_activity_date": 1540216764, "creation_date": 1540208800, "question_id": 52928599, "link": "https://stackoverflow.com/questions/52928599/rails-select-tag-to-using-scope-to-simple-filter", "title": "Rails select_tag to using scope to simple filter", "body": "<p>I'm still learning Rails and in my project app admin should be able to filter all holiday leave requests by status (boolean field in db) using dropdown list (approved for true, pending for false). I think I have declared everything right in my controller and model however I have no idea how to implement this to the view. I was trying to follow up <a href=\"https://www.austinstory.com/rails-select-tag-and-options-for-select-explained/\" rel=\"nofollow noreferrer\">Austin's story blog</a> and <a href=\"https://stackoverflow.com/questions/44643436/using-select-tag-multiple-true-to-get-a-combined-scope\">Using select_tag multiple => true to get a combined scope</a> topic but still I don't figured how to do it.</p>\n\n<p>leaves controller:</p>\n\n<pre><code>def index\n @leave = Leave.new\n @leaves = Leave.all.order(created_at: :desc).includes(:user)\n\n @leaves = Leave.find_by('select = ?', params[:status])\nend\n</code></pre>\n\n<p>model leave.rb</p>\n\n<pre><code>scope :approved, -&gt; { where(status: true) }\nscope :pending, -&gt; { where(status: false) }\n\nbelongs_to :user, optional: true\n</code></pre>\n\n<p>view index.html.erb</p>\n\n<pre><code>&lt;%= form_tag(action: :index) do %&gt;\n &lt;div class=\"input-group\"&gt;\n  &lt;%= select_tag :status, options_for_select([['Approved', Leave.approved], ['Pending', Leave.pending]]) %&gt;\n  &lt;%= submit_tag 'Filter' %&gt;\n &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1540278761, "last_edit_date": 1540278761, "creation_date": 1540208720, "answer_id": 52928574, "question_id": 52928428, "link": "https://stackoverflow.com/questions/52928428/nomethoderror-undefined-method-borrower-individuals-for-individualactive/52928574#52928574", "title": "NoMethodError - undefined method `borrower_individuals&#39; for #&lt;Individual::ActiveRecord_AssociationRelation:0x000000000dc58660&gt;", "body": "<p><code>@individual</code> doesn't hold single <code>Individual</code> instance, it contains <code>Relation</code> instead, on which you can't call <code>Individual</code> instance methods, obviously. You can set your <code>@roles</code> in a little bit different way, for example:</p>\n\n<pre><code>@roles = BorrowerIndividual.where(individual_id: @individuals.pluck(:id))\n</code></pre>\n\n<p>But to be honest, I don't know if it's necessary in your situation, because it seems to me you try to solve rather simple problem in a little bit overcomplicated way. </p>\n"}, {"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1540212026, "post_id": 52928815, "comment_id": 92768315, "body": "<code>@roles = @individuals.map(&amp;:borrower_individuals).flatten</code> will cause N + 1 unless you change the line that sets <code>@individuals</code>. Plus, with this approach, <code>@roles</code> is not relation - it&#39;s usually better to hold &quot;bunch of <code>ActiveRecord</code> objects&quot; as relation instead of array, for a couple of reasons."}, {"owner": {"reputation": 165, "user_id": 5072324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52beaa2468b3057ca981b58cbf189acd?s=128&d=identicon&r=PG", "display_name": "Jegan", "link": "https://stackoverflow.com/users/5072324/jegan"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1540213300, "post_id": 52928815, "comment_id": 92769114, "body": "Sorry I forgot  to mention the use of includes while finding CompanyBorrower object"}], "tags": [], "owner": {"reputation": 165, "user_id": 5072324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52beaa2468b3057ca981b58cbf189acd?s=128&d=identicon&r=PG", "display_name": "Jegan", "link": "https://stackoverflow.com/users/5072324/jegan"}, "is_accepted": true, "score": 1, "last_activity_date": 1540214233, "last_edit_date": 1540214233, "creation_date": 1540209563, "answer_id": 52928815, "question_id": 52928428, "link": "https://stackoverflow.com/questions/52928428/nomethoderror-undefined-method-borrower-individuals-for-individualactive/52928815#52928815", "title": "NoMethodError - undefined method `borrower_individuals&#39; for #&lt;Individual::ActiveRecord_AssociationRelation:0x000000000dc58660&gt;", "body": "<pre><code>@borrower = CompanyBorrower.find(params[:id])\n@individuals = @borrower.individuals.all\n@roles = @individuals.borrower_individuals.all\n</code></pre>\n\n<p>Here You are calling the association method on <strong>ActiveRecordRelation object</strong> not on <strong>Active Record object</strong>.i.e You are calling it on colletion of ActiveRecords not on single record.You need to call association method on single record.\n     @individuals = @borrower.individuals.all</p>\n\n<p>Here you have called individulas(association method) on single active record object(@borrower).It will return colletion of ActiveRecords (ActiveRecord_Relation object) if records are present(if records are not present , it will return empty active record relation object). In the next line you are trying to call the\nborrower_individuals(association method) on the rective record relation object.That's why it throws error</p>\n\n<pre><code>@roles = @individuals.borrower_individuals.all\n</code></pre>\n\n<p>you need to rewrite above code </p>\n\n<pre><code>@roles = @individuals.map(&amp;:borrower_individuals).flatten\n</code></pre>\n\n<p>As Marek Lipka mentioned , it will cause N+1 query and return the array object.\nIn order to avoid N+1 query, we can change it</p>\n\n<pre><code>@borrower = CompanyBorrower.find(params[:id])\n@individuals = @borrower.individuals.all\n@roles = @individuals.borrower_individuals.all\n\n@borrower = CompanyBorrower.includes(individuals: [:borrower_individuals]).find(params[:id])\n@individuals = @borrower.individuals.all\n@roles = @individuals.map(&amp;:borrower_individuals).flatten # will return array object.\n</code></pre>\n\n<p>you can avoid @individuals and @roles variable if you are going to use it in html page.It depends on how you are going to use it </p>\n"}], "owner": {"reputation": 145, "user_id": 8371714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41001419cf5313eb31a80621923535eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimBob", "link": "https://stackoverflow.com/users/8371714/jimbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 52928815, "answer_count": 2, "score": 0, "last_activity_date": 1540278761, "creation_date": 1540208174, "question_id": 52928428, "link": "https://stackoverflow.com/questions/52928428/nomethoderror-undefined-method-borrower-individuals-for-individualactive", "title": "NoMethodError - undefined method `borrower_individuals&#39; for #&lt;Individual::ActiveRecord_AssociationRelation:0x000000000dc58660&gt;", "body": "<p>I can't work out why this is not working</p>\n\n<p><strong>Models</strong></p>\n\n<pre><code>class CompanyBorrower &lt; ApplicationRecord\n    has_many :borrower_individuals\n    has_many :individuals, -&gt; { distinct }, :through =&gt; :borrower_individuals\nend\n\nclass BorrowerIndividual &lt; ApplicationRecord\n    belongs_to :company_borrower, optional: true\n    belongs_to :individual, optional: true\nend\n\nclass Individual &lt; ApplicationRecord\n    has_many :borrower_individuals\n    has_many :company_borrowers, :through =&gt; :borrower_individuals\nend\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>@borrower = CompanyBorrower.find(params[:id])\n@individuals = @borrower.individuals.all\n@roles = @individuals.borrower_individuals.all\n</code></pre>\n\n<p><strong>And I get the error...</strong></p>\n\n<pre><code>undefined method `borrower_individuals' for #&lt;Individual::ActiveRecord_AssociationRelation:0x000000000dc58660&gt;\n</code></pre>\n\n<p>The error is happening on @roles - if I remove, the error disappears</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540206129, "post_id": 52927390, "comment_id": 92764876, "body": "Ill add the attributes array is populated correctly with the address split up"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540207715, "post_id": 52927390, "comment_id": 92765732, "body": "Why do you store the address as a single comma separated string?"}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540208492, "post_id": 52927390, "comment_id": 92766150, "body": "because geocoder allows it with comma&#39;s and i cant split with &quot; &quot; incase of multiple words in the street name or city"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540227699, "post_id": 52927390, "comment_id": 92777840, "body": "Storing the address as a single concatenated comma seperated string seems like a really bad idea since addresses may actually contains commas (<code>596 Ocean Blvd, APT 162</code>) for example. The idea of being able to parse addresses with simple methods is utterly flawed. You&#39;re basically taking good seperated data and turing it into junk."}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540261128, "post_id": 52927390, "comment_id": 92789305, "body": "@max ok seems fair, how would you suggest i go about it?"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1540278733, "post_id": 52927390, "comment_id": 92794507, "body": "Use separate columns for each segment of the address of course and combine them for geocoder."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540209177, "post_id": 52928011, "comment_id": 92766587, "body": "can&#39;t write unknown attribute <code>field</code>"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540209220, "post_id": 52928011, "comment_id": 92766618, "body": "sorry, there was a bug, fixed. Try again"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540209246, "post_id": 52928011, "comment_id": 92766637, "body": "Should had been <code>self[field]</code> instead of <code>self[:field]</code>"}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540209615, "post_id": 52928011, "comment_id": 92766866, "body": "now its throwing &quot;*** ActiveModel::MissingAttributeError Exception: can&#39;t write unknown attribute <code>number</code>&quot;   In byebug i can set self.number to 3 and then self[field] is showing nil and it should be 3. Im a bit confused!"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540213011, "post_id": 52928011, "comment_id": 92768912, "body": "Are <code>number</code>, <code>street_name</code>, ... etc virtual attributes or actual fields on the model?"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540213721, "post_id": 52928011, "comment_id": 92769404, "body": "If you are trying to just set virtual attributes, try <code>self.public_send(&quot;#{field}=&quot;, attributes[index])</code> instead of  <code>self[field] = attributes[index]</code>"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540225316, "post_id": 52928011, "comment_id": 92776684, "body": "@johnseymour Any luck?"}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540261214, "post_id": 52928011, "comment_id": 92789319, "body": "sorry asleep let try shortly and ill get back to you. Yes they are virtual attributes"}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540261603, "post_id": 52928011, "comment_id": 92789399, "body": "yes great this has worked, can you write an answer ill mark it complete. thanks"}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 0, "creation_date": 1540283074, "post_id": 52928011, "comment_id": 92796768, "body": "@johnseymour I have updated the answer but do you understand why my solutions works and yours don&#39;t?"}, {"owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "edited": false, "score": 1, "creation_date": 1540299671, "post_id": 52928011, "comment_id": 92807340, "body": "So i think i understand it, basically i was storing the values of the variables in the array, not setter methods. so by calling public send(number, 4) on the user object its effectively calling the setter method in this case?"}], "tags": [], "owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "is_accepted": true, "score": 1, "last_activity_date": 1540283027, "last_edit_date": 1540283027, "creation_date": 1540206871, "answer_id": 52928011, "question_id": 52927390, "link": "https://stackoverflow.com/questions/52927390/setting-multiple-model-attributes-at-once-via-loop/52928011#52928011", "title": "Setting multiple model attributes at once via loop", "body": "<p>When you are passing <code>[self.number, self.street_name]</code> etc you are passing the value of those attributes (which are nil and hence immutable).</p>\n\n<p>Try this</p>\n\n<pre><code>def populate_address_attributes\n  if address == nil || address == \"\"\n    return false\n  else\n    attributes = address.split(\",\")\n    [:number, :street_name, :area, :postcode, :state].each_with_index do |field, index|\n      self.public_send(\"#{field}=\", attributes[index])\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 8725207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7f4084b5adc3677e77b5b27ca8710db4?s=128&d=identicon&r=PG&f=1", "display_name": "john seymour ", "link": "https://stackoverflow.com/users/8725207/john-seymour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52928011, "answer_count": 1, "score": 0, "last_activity_date": 1540283027, "creation_date": 1540204825, "question_id": 52927390, "link": "https://stackoverflow.com/questions/52927390/setting-multiple-model-attributes-at-once-via-loop", "title": "Setting multiple model attributes at once via loop", "body": "<p>Im using virtual attributes to concat and form a address before i save the user. So when they click edit user i would like to populate the fields in the form again. Every time i try to assign them they come back nil?  </p>\n\n<p>This is what i call from devise registrations controller before_action edit:</p>\n\n<pre><code>def test\n resource.populate_address_attributes\nend\n</code></pre>\n\n<p>and here is the method im trying to work with: </p>\n\n<pre><code>def populate_address_attributes\n  if address == nil || address == \"\"\n    return false\n  else\n    attributes = address.split(\",\")\n    [self.number, self.street_name, self.area, self.postcode, self.state].each { |x| x = attributes.delete_at[0]}\n  end\nend\n</code></pre>\n\n<p>all i'm getting is this: </p>\n\n<pre><code>=&gt; [nil, nil, nil, nil, nil]\n</code></pre>\n\n<p>maybe i'm trying to make it to complicated?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540207258, "post_id": 52927041, "comment_id": 92765455, "body": "Why would you <i>not</i> want to update the <code>updated_at</code> field when changing the user&#39;s attributes in the first place?"}, {"owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540207701, "post_id": 52927041, "comment_id": 92765723, "body": "Hi, because I need updated_at field for some other purpose in my Admin Dashboard, that is another story :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540207984, "post_id": 52927041, "comment_id": 92765867, "body": "You might consider using a custom field for that purpose instead. It&#39;s usually easier to follow the conventions instead of using low-level methods in order to circumvent them ;-)"}, {"owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540209670, "post_id": 52927041, "comment_id": 92766898, "body": "right! l&#39;ll definitely follow conventions in my new projects but as this project is already up and running so I am hoping to get a work around without fixing my noob mistakes."}], "answers": [{"tags": [], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "is_accepted": true, "score": 2, "last_activity_date": 1540204155, "creation_date": 1540204155, "answer_id": 52927191, "question_id": 52927041, "link": "https://stackoverflow.com/questions/52927041/increment-field-by-some-number-without-updating-timestamps/52927191#52927191", "title": "increment field by some number without updating timestamps", "body": "<p>Nevermind, found the solution. So, apparently, <code>update_counters</code> method is doing exactly what I needed. </p>\n\n<pre><code>User.update_counters :id,:reputation =&gt; 10\n</code></pre>\n\n<p>Thanks.</p>\n\n<p>Link: <a href=\"https://apidock.com/rails/ActiveRecord/CounterCache/update_counters\" rel=\"nofollow noreferrer\">Rail Update Counters method</a></p>\n"}], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 52927191, "answer_count": 1, "score": 1, "last_activity_date": 1540204342, "creation_date": 1540203647, "last_edit_date": 1540204342, "question_id": 52927041, "link": "https://stackoverflow.com/questions/52927041/increment-field-by-some-number-without-updating-timestamps", "title": "increment field by some number without updating timestamps", "body": "<p>I have to update <code>reputation</code> attribute of <code>User</code> model after he create a <code>Post</code>. \nHere is what I have tried so far: </p>\n\n<p>Simple solution is:</p>\n\n<pre><code>User.find(id).increment!(reputation: 10)\n</code></pre>\n\n<p>But, this also, updates the <code>updated_at</code> field. </p>\n\n<p>I looked up for a way to update counter without updating timestamps, and found this:</p>\n\n<pre><code>User.increment_counter(:reputation, id)\n</code></pre>\n\n<p>But this method increments <code>reputation</code> by 1. </p>\n\n<p>I also, found out that <code>update_column</code> method doesn't updates timestamps.\nBut, I can't seem to use it as one-liner query. </p>\n\n<p>As, I have to update the reputation of User after he creates a post. So, in my <code>Post</code> model, </p>\n\n<pre><code>after_create_commit { self.user.update_column(reputation: (self.user.reputation + 10))} \n</code></pre>\n\n<p>This query is calling <code>self.user</code> (to get associated user of current post) 2 times, how can I avoid this.</p>\n\n<p>OR</p>\n\n<p>Is there any other method to increment without updating timestamps.</p>\n\n<p>Thanks</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Found one solution, <code>update_counters</code> method (added in the answers below).</p>\n\n<p>If someone knows about any other method, or can help me with how can I user update_column without calling <code>self.user</code> two times, please help me out. \nThanks</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 1027, "user_id": 4658312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84ae7846ab7b8381cfe9876eeb009326?s=128&d=identicon&r=PG&f=1", "display_name": "krithikaGopalakrisnan", "link": "https://stackoverflow.com/users/4658312/krithikagopalakrisnan"}, "edited": false, "score": 0, "creation_date": 1540203577, "post_id": 52926484, "comment_id": 92763413, "body": "I guess your substring search doesnt work, try. <code>substring(content, length(&#39;1899-12-31T&#39;)+1, 5)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10539763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GoSNVRh_ons/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDiY34zIC8CohdHVX3Xsmdct9FmmA/mo/photo.jpg?sz=128", "display_name": "Jaydev Shiroya", "link": "https://stackoverflow.com/users/10539763/jaydev-shiroya"}, "edited": false, "score": 0, "creation_date": 1540204017, "post_id": 52926909, "comment_id": 92763646, "body": "yes datatype is string, and please describe what this line does <code>option.content[11..15]</code>"}, {"owner": {"reputation": 141, "user_id": 4140718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ba69bc5807252c67bd5de5f34f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhuja Selvaraj", "link": "https://stackoverflow.com/users/4140718/sindhuja-selvaraj"}, "reply_to_user": {"reputation": 47, "user_id": 10539763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GoSNVRh_ons/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDiY34zIC8CohdHVX3Xsmdct9FmmA/mo/photo.jpg?sz=128", "display_name": "Jaydev Shiroya", "link": "https://stackoverflow.com/users/10539763/jaydev-shiroya"}, "edited": false, "score": 0, "creation_date": 1540209444, "post_id": 52926909, "comment_id": 92766768, "body": "Option.each will fetch all Option records one by one and inside the loop I&#39;m referring Option record as option (check for the case) ..once it comes inside the loop am Updating the record&#39;s content value as content[11..15]  content[11..15] = will fetch content&#39;s string from 11th index to 15th index(which is the time)"}], "tags": [], "owner": {"reputation": 141, "user_id": 4140718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ba69bc5807252c67bd5de5f34f0f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sindhuja Selvaraj", "link": "https://stackoverflow.com/users/4140718/sindhuja-selvaraj"}, "is_accepted": true, "score": 2, "last_activity_date": 1540203699, "last_edit_date": 1540203699, "creation_date": 1540203193, "answer_id": 52926909, "question_id": 52926484, "link": "https://stackoverflow.com/questions/52926484/rails-console-update-column-values-with-trimmed-values/52926909#52926909", "title": "Rails console: update column values with trimmed values", "body": "<p>Is the datatype is string? because it looks kind of datetime if it is string and it is of same length in all records then you can use some method like</p>\n\n<pre><code>Option.each do |option|\n option.update(content: option.content[11..15])\nend\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10539763, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GoSNVRh_ons/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDiY34zIC8CohdHVX3Xsmdct9FmmA/mo/photo.jpg?sz=128", "display_name": "Jaydev Shiroya", "link": "https://stackoverflow.com/users/10539763/jaydev-shiroya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52926909, "answer_count": 1, "score": 0, "last_activity_date": 1540203699, "creation_date": 1540201714, "question_id": 52926484, "link": "https://stackoverflow.com/questions/52926484/rails-console-update-column-values-with-trimmed-values", "title": "Rails console: update column values with trimmed values", "body": "<p>I have some records with incorrect data in column values</p>\n\n<pre><code>:content =&gt; \"1899-12-31T05:24:00+00:00\"\n:content =&gt; \"1899-12-31T03:25:00+00:00\"\n:content =&gt; \"1899-12-31T01:12:00+00:00\"\n</code></pre>\n\n<p>i need to trim the front part and rear part and update data to look like this</p>\n\n<pre><code>:content =&gt; \"05:24\"\n:content =&gt; \"03:25\"\n:content =&gt; \"01:12\"\n</code></pre>\n\n<p>this can be achieved with trimming the front part <strong>1899-12-31T</strong> and rear part <strong>:00+00:00</strong></p>\n\n<p>please note the \"content\" is <strong>string</strong> type column,</p>\n\n<p>i tried the following query but it does nothing</p>\n\n<pre><code>Option.where(\"content like '1899-12-31T%'\").update_all(\"content = SUBSTRING(content, 1,LENGTH(content) - 6)\")\n</code></pre>\n\n<p>Any help/suggestion will appreciated. </p>\n"}, {"tags": ["ruby", "intellij-idea", "extjs", "ant", "minify"], "comments": [{"owner": {"reputation": 61, "user_id": 5099615, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200717425215885/picture?type=large", "display_name": "Jeffy Jahfar", "link": "https://stackoverflow.com/users/5099615/jeffy-jahfar"}, "reply_to_user": {"reputation": 2555, "user_id": 7155440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb210585dc7f208df45f080502df576?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy.....", "link": "https://stackoverflow.com/users/7155440/sandy"}, "edited": false, "score": 0, "creation_date": 1540208777, "post_id": 52926303, "comment_id": 92766327, "body": "yes, the solution was similar. i had added in system variable but was still not working till i restarted idea intellij"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5099615, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200717425215885/picture?type=large", "display_name": "Jeffy Jahfar", "link": "https://stackoverflow.com/users/5099615/jeffy-jahfar"}, "is_accepted": false, "score": 0, "last_activity_date": 1540203023, "creation_date": 1540203023, "answer_id": 52926866, "question_id": 52926303, "link": "https://stackoverflow.com/questions/52926303/sencha-app-build-from-intellij-ant-build-throwing-error-ruby-not-detected/52926866#52926866", "title": "Sencha app build from Intellij Ant build throwing error ruby not detected", "body": "<p>This worked after I added ruby path to User Defined variables in addition to system variables and restarted Intellij</p>\n"}], "owner": {"reputation": 61, "user_id": 5099615, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200717425215885/picture?type=large", "display_name": "Jeffy Jahfar", "link": "https://stackoverflow.com/users/5099615/jeffy-jahfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "closed_date": 1540208796, "answer_count": 1, "score": 1, "last_activity_date": 1540203023, "creation_date": 1540201093, "question_id": 52926303, "link": "https://stackoverflow.com/questions/52926303/sencha-app-build-from-intellij-ant-build-throwing-error-ruby-not-detected", "closed_reason": "Duplicate", "title": "Sencha app build from Intellij Ant build throwing error ruby not detected", "body": "<p>I am trying to run the Build - Production target in my extjs application by importing the sencha build.xml file as the ant configuration file. Most of the targets run except one in slice-impl.xml by giving this error: </p>\n\n<pre><code>\\application\\path\\.sencha\\app\\slice-impl.xml:127: com.sencha.exceptions.ExNotFound: Failed to detect ruby\n</code></pre>\n\n<p>The detailed stack is as follows:</p>\n\n<p>Did not find a system installed ruby runtime\nPlease install ruby for this platform and ensure that\na ruby command compatible with 1.8 or 1.9 is available\non the system path.</p>\n\n<blockquote>\n  <p>com.sencha.exceptions.ExNotFound: Failed to detect ruby\n      at com.sencha.command.compass.BaseRubyCommands.runRubyCommand(BaseRubyCommands.java:110)\n      at com.sencha.command.compass.CompassCommands$BaseCompassCommand.execute(CompassCommands.java:123)\n      at com.sencha.command.compass.ant.BaseCompassTask.doExecute(BaseCompassTask.java:99)\n      at com.sencha.ant.BaseAntTask.execute(BaseAntTask.java:34)\n      at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)\n      at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n      at java.lang.reflect.Method.invoke(Method.java:498)\n      at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n      at org.apache.tools.ant.Task.perform(Task.java:348)\n      at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)\n      at net.sf.antcontrib.logic.IfTask.execute(IfTask.java:217)\n      at sun.reflect.GeneratedMethodAccessor40.invoke(Unknown Source)\n      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n      at java.lang.reflect.Method.invoke(Method.java:498)\n      at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n      at org.apache.tools.ant.TaskAdapter.execute(TaskAdapter.java:154)\n      at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)\n      at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n      at java.lang.reflect.Method.invoke(Method.java:498)\n      at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n      at org.apache.tools.ant.Task.perform(Task.java:348)\n      at org.apache.tools.ant.Target.execute(Target.java:435)\n      at org.apache.tools.ant.Target.performTasks(Target.java:456)\n      at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1393)\n      at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)</p>\n</blockquote>\n\n<p>ruby installation directory is already part of my System variable Path. What else should be configured to get this work from Intellij?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1540196422, "post_id": 52924841, "comment_id": 92759332, "body": "Why is this tagged as <code>ruby-on-rails-4</code> <i>and</i> <code>ruby-on-rails-5</code>? The solution probably doesn&#39;t make a difference in this case, but it&#39;s advisable to actually specify the version you&#39;re using."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 4, "creation_date": 1542306598, "post_id": 52924841, "comment_id": 93532070, "body": "The last <code>has_many</code> with <code>foreign_key</code> and <code>primary_key</code> works for me, what issues are you having? Specifying <code>class_name</code> is not necessary, tested with Rails 5.1.4."}, {"owner": {"reputation": 1465, "user_id": 892754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82c1b4e0c8d5da1d6b2756d0bfe0b03?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/892754/derek"}, "edited": false, "score": 1, "creation_date": 1542687762, "post_id": 52924841, "comment_id": 93648030, "body": "Agree, the last <code>has_many</code> works for me and also works w/o the <code>primary_key</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2366, "user_id": 2876134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b732ddf9b8ccefd8ddba85c9a33447?s=128&d=identicon&r=PG&f=1", "display_name": "Cong Chen", "link": "https://stackoverflow.com/users/2876134/cong-chen"}, "is_accepted": false, "score": 1, "last_activity_date": 1542699856, "creation_date": 1542699856, "answer_id": 53388341, "question_id": 52924841, "link": "https://stackoverflow.com/questions/52924841/has-one-has-many-rails-association-with-alternate-source-id-other-then-primary-k/53388341#53388341", "title": "has_one/has_many rails association with alternate source ID other then primary key", "body": "<p>An example, Teacher and Student models belong to Group, Teacher has many Student:</p>\n\n<pre><code>class Group &lt; ApplicationRecord\n  has_many :teachers\n  has_many :students\nend\n\nclass Teacher &lt; ApplicationRecord\n  belongs_to :group\n  has_many :students, :foreign_key =&gt; 'group_id', :primary_key =&gt; 'group_id'\nend\n\nclass Student &lt; ApplicationRecord\n  belongs_to :group\nend\n</code></pre>\n\n<p>And you can retrieve a teacher's students in a group like this:</p>\n\n<pre><code>teacher = Teacher.find(:teacher_id)\nstudents = teacher.students\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 308, "user_id": 7945232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BWX0S.jpg?s=128&g=1", "display_name": "MrCodeX", "link": "https://stackoverflow.com/users/7945232/mrcodex"}, "edited": false, "score": 0, "creation_date": 1542836260, "post_id": 53420652, "comment_id": 93715999, "body": "If the solution is necessarily through active records relation point it out so I may remove this answer."}, {"owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "edited": false, "score": 0, "creation_date": 1542918903, "post_id": 53420652, "comment_id": 93749079, "body": "Thank you for the answer. But Solution regarding AR Association is required. Method base approach can be done in multiple ways but it removes all the flexibility which AR associations provide"}], "tags": [], "owner": {"reputation": 308, "user_id": 7945232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BWX0S.jpg?s=128&g=1", "display_name": "MrCodeX", "link": "https://stackoverflow.com/users/7945232/mrcodex"}, "is_accepted": false, "score": 0, "last_activity_date": 1542835407, "creation_date": 1542835407, "answer_id": 53420652, "question_id": 52924841, "link": "https://stackoverflow.com/questions/52924841/has-one-has-many-rails-association-with-alternate-source-id-other-then-primary-k/53420652#53420652", "title": "has_one/has_many rails association with alternate source ID other then primary key", "body": "<p>Following your example of classes A,B &amp; C and changing only the implementation of class A.</p>\n\n<pre><code>class A\n  belongs_to :b\n\n  def cs\n    self.id = b_id\n    b_cast = self.becomes(B)\n    b_cast.cs\n  end\nend\n</code></pre>\n\n<p>Console</p>\n\n<pre><code>A.first                    ==&gt;#&lt;A id: 105, b_id: 1 ...&gt;\nB.first                    ==&gt;#&lt;B id: 1 ...&gt;\nC.all                      ==&gt;#&lt;C id: 1, b_id: 1 ...&gt;, \n                              #&lt;C id: 2, b_id: 1 ...&gt;, \n                              #&lt;C id: 3, b_id: 1 ...&gt;, \n                              #&lt;C id: 4, b_id: 1 ...&gt;\n\n\n\nA.first.cs\nA Load (0.2ms)  SELECT  \"as\".* FROM \"as\" ORDER BY \"as\".\"id\" ASC LIMIT ?  [[\"LIMIT\", 1]]\nC Load (0.1ms)  SELECT  \"cs\".* FROM \"cs\" WHERE \"cs\".\"b_id\" = ? LIMIT ?  [[\"b_id\", 1], [\"LIMIT\", 11]]                 \n\nA.first.cs                 ==&gt;#&lt;C id: 1, b_id: 1 ...&gt;, \n                              #&lt;C id: 2, b_id: 1 ...&gt;, \n                              #&lt;C id: 3, b_id: 1 ...&gt;, \n                              #&lt;C id: 4, b_id: 1 ...&gt;\n</code></pre>\n\n<p>Official #becomes(klass) documentation can be found \n<a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-becomes\" rel=\"nofollow noreferrer\">here</a>!</p>\n\n<p>On other end, the same effect can be achieved creating an instance of the class B and giving it the id stored in A.first.b_id as follows:</p>\n\n<pre><code>B.new(id: A.first.b_id).cs\nA Load (0.2ms)  SELECT  \"as\".* FROM \"as\" ORDER BY \"as\".\"id\" ASC LIMIT ?  [[\"LIMIT\", 1]]\nC Load (0.1ms)  SELECT  \"cs\".* FROM \"cs\" WHERE \"cs\".\"b_id\" = ? LIMIT ?  [[\"b_id\", 1], [\"LIMIT\", 11]]                 \n\nB.new(id: A.first.b_id).cs ==&gt;#&lt;C id: 1, b_id: 1 ...&gt;, \n                              #&lt;C id: 2, b_id: 1 ...&gt;, \n                              #&lt;C id: 3, b_id: 1 ...&gt;, \n                              #&lt;C id: 4, b_id: 1 ...&gt;\n</code></pre>\n"}], "owner": {"reputation": 2224, "user_id": 4269732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/swGs5.jpg?s=128&g=1", "display_name": "Qaisar Nadeem", "link": "https://stackoverflow.com/users/4269732/qaisar-nadeem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1542835407, "creation_date": 1540195774, "question_id": 52924841, "link": "https://stackoverflow.com/questions/52924841/has-one-has-many-rails-association-with-alternate-source-id-other-then-primary-k", "title": "has_one/has_many rails association with alternate source ID other then primary key", "body": "<p>I have 3 models. </p>\n\n<p>Model A belongs to model B and model B has many model C </p>\n\n<p>by using <code>through</code> I can set in model A class <code>has_many :c,through: :b</code> </p>\n\n<p>Now whenever I call <code>a_instance.cs</code> It would JOIN with table B unnecessarily What I want is direct association of <code>A</code> &amp; <code>C</code> using <code>b_id</code> in both A &amp; C class. </p>\n\n<p>So how can I write a has_one/has_many rails association without <code>through</code> clause when both Source and Destination entities has same foreign_key of 3rd entity?  (<code>b_id</code> for this example)</p>\n\n<pre><code>class C\n  belongs_to :b #b_id column is there in DB\nend\n\nclass B\n  has_many :cs\nend\n\nclass A\n  belongs_to :b #b_id column is there in DB\n  has_many :cs , through: :b #This is the association in Question\n\n  #WHAT I WANT TO DO. So something in place of primary_key which would fetch C class directly.\n  has_many :cs ,class_name: 'C',foreign_key: 'b_id',primary_key: 'b_id'\nend\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu", "rubygems", "vagrant"], "comments": [{"owner": {"reputation": 2517, "user_id": 2129097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f7076b34edaf161f394be22dbd7cbd?s=128&d=identicon&r=PG", "display_name": "Jan Myszkier", "link": "https://stackoverflow.com/users/2129097/jan-myszkier"}, "edited": false, "score": 0, "creation_date": 1540195838, "post_id": 52924471, "comment_id": 92759013, "body": "this seems to be non-vagrant issue:<a href=\"https://github.com/binarylogic/authlogic/issues/479\" rel=\"nofollow noreferrer\">github.com/binarylogic/authlogic/issues/479</a>"}, {"owner": {"reputation": 11, "user_id": 7745555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c1833b4daa549c33bfacc5dde66c01?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay  Shalnev", "link": "https://stackoverflow.com/users/7745555/nikolay-shalnev"}, "reply_to_user": {"reputation": 2517, "user_id": 2129097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5f7076b34edaf161f394be22dbd7cbd?s=128&d=identicon&r=PG", "display_name": "Jan Myszkier", "link": "https://stackoverflow.com/users/2129097/jan-myszkier"}, "edited": false, "score": 0, "creation_date": 1540197228, "post_id": 52924471, "comment_id": 92759739, "body": "I install ruby-net-ssh, dut it not work too."}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1540211566, "post_id": 52924471, "comment_id": 92767994, "body": "Your issee is probably occurring before the output you displayed above."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7745555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c1833b4daa549c33bfacc5dde66c01?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay  Shalnev", "link": "https://stackoverflow.com/users/7745555/nikolay-shalnev"}, "is_accepted": false, "score": 0, "last_activity_date": 1540220843, "creation_date": 1540220843, "answer_id": 52932495, "question_id": 52924471, "link": "https://stackoverflow.com/questions/52924471/how-install-vagrant-2-2-0-on-ubuntu-18-04/52932495#52932495", "title": "How install vagrant 2.2.0 on ubuntu 18.04?", "body": "<p>Problem fix.\nFound a solution to the problem in this issue <a href=\"https://github.com/hashicorp/vagrant/issues/10119\" rel=\"nofollow noreferrer\">https://github.com/hashicorp/vagrant/issues/10119</a></p>\n"}, {"tags": [], "owner": {"reputation": 756, "user_id": 8247133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6SM3.jpg?s=128&g=1", "display_name": "Touseef Murtaza", "link": "https://stackoverflow.com/users/8247133/touseef-murtaza"}, "is_accepted": false, "score": 0, "last_activity_date": 1541760453, "creation_date": 1541760453, "answer_id": 53224240, "question_id": 52924471, "link": "https://stackoverflow.com/questions/52924471/how-install-vagrant-2-2-0-on-ubuntu-18-04/53224240#53224240", "title": "How install vagrant 2.2.0 on ubuntu 18.04?", "body": "<p>You need to remove <code>vagrant</code> gem by doing <code>gem uninstall vagrant</code> after that you should install it system wide, in ubuntu you can download your <code>deb</code> file from\n<a href=\"https://www.vagrantup.com/downloads.html\" rel=\"nofollow noreferrer\">https://www.vagrantup.com/downloads.html</a>\nAfter successful installation of vagrant you can use command <code>vagrant init hashicorp/precise64</code> to create a VegrantFile which contains information about your Virtual Machine.</p>\n\n<p>Now boot-up your VM through vagrant by running <code>vagrant up</code>, if you want to ssh then type <code>vagrant ssh</code>.</p>\n\n<p>P.S. I am using Ubuntu 18.04, please make sure you will not get into trouble after gem uninstall.</p>\n"}, {"tags": [], "owner": {"reputation": 1050, "user_id": 6244201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EuVjr.jpg?s=128&g=1", "display_name": "Gitau Harrison", "link": "https://stackoverflow.com/users/6244201/gitau-harrison"}, "is_accepted": false, "score": 0, "last_activity_date": 1601341933, "last_edit_date": 1601341933, "creation_date": 1601341361, "answer_id": 64111488, "question_id": 52924471, "link": "https://stackoverflow.com/questions/52924471/how-install-vagrant-2-2-0-on-ubuntu-18-04/64111488#64111488", "title": "How install vagrant 2.2.0 on ubuntu 18.04?", "body": "<p>To confirm whether you have <code>vagrant</code> installed or not, run</p>\n<pre><code>$ vagrant --version\n</code></pre>\n<p>Personally check for the latest available developer version (as mentioned), consider <a href=\"https://www.vagrantup.com/downloads.html\" rel=\"nofollow noreferrer\">HashiCorp Downloads</a>. Find one appropriate for your OS.</p>\n<p><strong>Install Vagrant on Ubuntu 18.04</strong></p>\n<p>Install <code>virtualbox</code> which allows you to run an OS on top of another OS by creating a virtual OS</p>\n<pre><code>$ sudo apt install virtualbox\n</code></pre>\n<p>Look for any updates before downloading <code>vagrant</code>:</p>\n<pre><code>$ sudo apt update\n$ curl -O https://releases.hashicorp.com/vagrant/2.2.10/vagrant_2.2.10_x86_64.deb\n</code></pre>\n<p>Note: You can get the version you want by replacing <code>2.2.10</code> to <code>2.2.x</code>. This will download the version (or latest version) after checking the downloads page.</p>\n<p>Once the <code>.deb</code> is downloaded, install <code>vagrant</code> by running:</p>\n<pre><code>$ sudo apt install ./vagrant_2.2.10_x86_64.deb\n</code></pre>\n<p>Again, making sure that you look at the version you downloaded earlier (<code>2.2.x</code>)</p>\n<p><strong>Verify vagrant installation</strong></p>\n<pre><code>$ vagrant --version\n</code></pre>\n<p><strong>Getting started with Vagrant</strong></p>\n<pre><code>$ mkdir my_new_project\n$ cd my_new_project\n</code></pre>\n<p>Next, initialize a new Vagrantfile using <code>vagrant init</code> and specify the box you want to use. Boxes are the package format for the Vagrant environments and are provider-specific. You can find a list of publicly available Vagrant Boxes on the <a href=\"https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&amp;sort=downloads&amp;provider=&amp;q=Ubuntu%2018.04\" rel=\"nofollow noreferrer\">Vagrant box catalog page</a>.</p>\n<pre><code>$ vagrant init ubuntu/bionic64\n</code></pre>\n<p>Better still, while within your project directory, you can create a <code>VagrantFile</code> and add vagrant configurations there as follows:</p>\n<pre><code>$ touch Vagrantfile\n</code></pre>\n<p>Your configurations, specifying your preferred box (and, by extension) your IP:</p>\n<pre><code>Vagrant.configure(&quot;2&quot;) do |config|\n    config.vm.box = &quot;ubuntu/bionic64&quot;\n    config.vm.network &quot;private_network&quot;, ip: &quot;x.x.x.x&quot;\n    config.vm.provider &quot;virtualbox&quot; do |vb|\n        vb.memory =  '1024'\n    end\nend\n</code></pre>\n<p>Run the <code>vagrant up</code> command to create and configure the virtual machine as specified in the vagrant file:</p>\n<pre><code>$ vagrant up\n</code></pre>\n<p>Vagrant also mounts the project directory at <code>/vagrant</code> in the virtual machine which allows you to work on your project\u2019s files on your host machine.To ssh into the virtual machine, run:</p>\n<pre><code>$ vagrant ssh\n</code></pre>\n<p>You can stop the virtual machine with the following command:</p>\n<pre><code>$ vagrant halt\n</code></pre>\n<p>Terminally, you can stop the machine from running and destroy all the resources created using:</p>\n<pre><code>$ vagrant destroy\n</code></pre>\n<p><strong>Uninstall vagrant</strong></p>\n<p>If at one point you would like to uninstall <code>vagrant</code>, you can run these commands (adding <code>sudo</code> privileges if you'd want):</p>\n<pre><code>$ rm -rf /opt/vagrant\n$ rm -f /usr/bin/vagrant\n</code></pre>\n<p>Check for successful uninstall:</p>\n<pre><code>$ which vagrant\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7745555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c1833b4daa549c33bfacc5dde66c01?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolay  Shalnev", "link": "https://stackoverflow.com/users/7745555/nikolay-shalnev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1161, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1601341933, "creation_date": 1540194135, "last_edit_date": 1540197243, "question_id": 52924471, "link": "https://stackoverflow.com/questions/52924471/how-install-vagrant-2-2-0-on-ubuntu-18-04", "title": "How install vagrant 2.2.0 on ubuntu 18.04?", "body": "<p>I have problem from install vagrant on ubuntu 18.04.</p>\n\n<p>I download vagrant 2.2.0 => install his.</p>\n\n<p>But have error run vagrant up</p>\n\n<blockquote>\n<pre><code>&gt; ==&gt; default: Destroying VM and associated drives...  /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/agent.rb:128:in\n&gt; `block in identities': can't modify frozen NilClass (RuntimeError) \n&gt; from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/agent.rb:122:in\n&gt; `times'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/agent.rb:122:in\n&gt; `identities' from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/key_manager.rb:104:in\n&gt; `each_identity'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/methods/publickey.rb:19:in\n&gt; `authenticate'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:85:in\n&gt; `block in authenticate'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:71:in\n&gt; `each'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh/authentication/session.rb:71:in\n&gt; `authenticate'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/net-ssh-5.0.2/lib/net/ssh.rb:246:in\n&gt; `start'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/plugins/communicators/ssh/communicator.rb:415:in\n&gt; `block (2 levels) in connect'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:93:in `block in\n&gt; timeout'  from /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in\n&gt; `block in catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in `catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in `catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:108:in `timeout'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/plugins/communicators/ssh/communicator.rb:389:in\n&gt; `block in connect'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/lib/vagrant/util/retryable.rb:17:in\n&gt; `retryable'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/plugins/communicators/ssh/communicator.rb:388:in\n&gt; `connect'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/plugins/communicators/ssh/communicator.rb:84:in `block in wait_for_ready'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:93:in `block in\n&gt; timeout'  from /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in\n&gt; `block in catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in `catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:33:in `catch'  from\n&gt; /opt/vagrant/embedded/lib/ruby/2.4.0/timeout.rb:108:in `timeout'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/plugins/communicators/ssh/communicator.rb:62:in `wait_for_ready'  from\n&gt; /opt/vagrant/embedded/gems/2.2.0/gems/vagrant-2.2.0/lib/vagrant/action/builtin/wait_for_communicator.rb:16:in\n&gt; `block in call'\n</code></pre>\n</blockquote>\n\n<p>\"Vagrant up --debug\" ends the same way.\nI tried to put the gems separately, but it does not help.</p>\n\n<p>What am i doing wrong?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1540194121, "post_id": 52924272, "comment_id": 92758117, "body": "Does it contain only 1 &amp; 0 ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1540215441, "post_id": 52924272, "comment_id": 92770643, "body": "What&#39;s the expected result for the given matrix? <code>[1,1,1,1]</code>, <code>Vector[1,1,1,1]</code>, <code>2</code> (the row&#39;s zero-based index) or maybe something else?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "edited": false, "score": 0, "creation_date": 1540194357, "post_id": 52924485, "comment_id": 92758244, "body": "yes , i need to create a array boolean 2d array where each row is sorted and then find the max 1s"}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "edited": false, "score": 2, "creation_date": 1540194922, "post_id": 52924485, "comment_id": 92758581, "body": "Do you need to find the row index or what?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1540200717, "post_id": 52924485, "comment_id": 92761787, "body": "I can&#39;t test right now but you might be able to use <code>...max_by(&amp;:sum)</code> too."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1540201526, "post_id": 52924485, "comment_id": 92762251, "body": "@SagarPandya It is valid only for a binary matrix. Unfortunately, the question does not have info about that."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 5, "last_activity_date": 1540194170, "creation_date": 1540194170, "answer_id": 52924485, "question_id": 52924272, "link": "https://stackoverflow.com/questions/52924272/how-to-find-the-row-with-maximum-number-of-1s-in-a-matrix/52924485#52924485", "title": "How to find the row with maximum number of 1s in a matrix", "body": "<p>The simplest approach probably is</p>\n\n<pre><code>m1.row_vectors.max_by { |e| e.count(1) }\n#=&gt; Vector[1, 1, 1, 1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 0, "last_activity_date": 1540200081, "creation_date": 1540200081, "answer_id": 52926022, "question_id": 52924272, "link": "https://stackoverflow.com/questions/52924272/how-to-find-the-row-with-maximum-number-of-1s-in-a-matrix/52926022#52926022", "title": "How to find the row with maximum number of 1s in a matrix", "body": "<p>Optimized solution: - Start checking from top right corner and traverse to the left of matrix till you are getting <code>1</code>. When 0 is encountered, traverse down the matrix and repeat. </p>\n\n<pre><code>row = nil\nj = m1.row_count - 1\n(0...m1.row_count).each.with_index do |i|\n  while m1[i,j] == 1 do\n    row = i\n    j -= 1\n  end\nend\nputs row\n</code></pre>\n\n<p>Assumptions:<br>\n1. Rows are sorted.<br>\n2. It's nxn matrix.  </p>\n\n<p>For more, refer <a href=\"https://www.geeksforgeeks.org/find-row-number-binary-matrix-maximum-number-1s/\" rel=\"nofollow noreferrer\">this</a></p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1540226247, "creation_date": 1540226247, "answer_id": 52933971, "question_id": 52924272, "link": "https://stackoverflow.com/questions/52924272/how-to-find-the-row-with-maximum-number-of-1s-in-a-matrix/52933971#52933971", "title": "How to find the row with maximum number of 1s in a matrix", "body": "<pre><code>m1.row_vectors.max_by(&amp;:sum)\n  #=&gt; Vector[1, 1, 1, 1]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>m1.to_a.max_by(&amp;:sum)\n  #=&gt; [1,1,1,1]\n</code></pre>\n\n<p>depending on requirements.</p>\n"}], "owner": {"reputation": 107, "user_id": 6807622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11676840a0756b0771decb53406ff33c?s=128&d=identicon&r=PG&f=1", "display_name": "Penny", "link": "https://stackoverflow.com/users/6807622/penny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 52926022, "answer_count": 3, "score": -3, "last_activity_date": 1575304173, "creation_date": 1540193344, "last_edit_date": 1540196340, "question_id": 52924272, "link": "https://stackoverflow.com/questions/52924272/how-to-find-the-row-with-maximum-number-of-1s-in-a-matrix", "title": "How to find the row with maximum number of 1s in a matrix", "body": "<p>I have a matrix with boolean values:</p>\n\n<pre><code>require 'matrix'\nm1 = Matrix[[0,1,1,1],[0,0,1,1],[1,1,1,1],[0,0,0,0]]\n</code></pre>\n\n<p>I want to find the row with the maximum number of <code>1</code>s. Can anyone help me?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540195329, "post_id": 52923826, "comment_id": 92758787, "body": "Quick idea that I haven&#39;t tested (and might not be the best one for your needs): you could compare the <code>created_at</code> and <code>updated_at</code> columns: if they&#39;re the same, it&#39;s a record that was just created, if they&#39;re different, it&#39;s a record that was updated. (now that I think about it, this might not be a very clean solution)"}, {"owner": {"reputation": 17, "user_id": 4088652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qnywz87Szkw/AAAAAAAAAAI/AAAAAAAABA4/rSsrTSfnRT8/photo.jpg?sz=128", "display_name": "Andr&#233; Hatlo-Johansen", "link": "https://stackoverflow.com/users/4088652/andr%c3%a9-hatlo-johansen"}, "reply_to_user": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540196919, "post_id": 52923826, "comment_id": 92759590, "body": "Thats actually a very good idea. Will test it now. Thank you!"}, {"owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540214709, "post_id": 52923826, "comment_id": 92770098, "body": "Did you have any luck?"}, {"owner": {"reputation": 17, "user_id": 4088652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qnywz87Szkw/AAAAAAAAAAI/AAAAAAAABA4/rSsrTSfnRT8/photo.jpg?sz=128", "display_name": "Andr&#233; Hatlo-Johansen", "link": "https://stackoverflow.com/users/4088652/andr%c3%a9-hatlo-johansen"}, "reply_to_user": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "edited": false, "score": 0, "creation_date": 1540216462, "post_id": 52923826, "comment_id": 92771312, "body": "It worked as a charm! Post it as answer and i will mark it :)"}], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1540195190, "creation_date": 1540195190, "answer_id": 52924717, "question_id": 52923826, "link": "https://stackoverflow.com/questions/52923826/track-count-of-the-new-and-updated-records-seperatly/52924717#52924717", "title": "Track count of the new and updated records seperatly", "body": "<p>I don't know if this can help you but in these cases I use <code>persisted?</code> method.</p>\n\n<pre><code>person = Person.new(id: 1, name: 'bob')\nperson.persisted? # =&gt; false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 8905332, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qSGD6IOatlQ/AAAAAAAAAAI/AAAAAAAAAOA/lcytjZkeivA/photo.jpg?sz=128", "display_name": "ldeld", "link": "https://stackoverflow.com/users/8905332/ldeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1540224133, "creation_date": 1540224133, "answer_id": 52933435, "question_id": 52923826, "link": "https://stackoverflow.com/questions/52923826/track-count-of-the-new-and-updated-records-seperatly/52933435#52933435", "title": "Track count of the new and updated records seperatly", "body": "<p>You have several choices here:</p>\n\n<p>A simple option, as per my comment, is simply to check the <code>created_at</code> and <code>updated_at</code> columns after the record is saved. If they're equal, it's a new record, if not, it means the record already existed and was updated. You would have something along these lines:</p>\n\n<pre><code>if product.created_at == product.updated_at\n   new_product_count += 1\nelse\n  updated_product_count += 1\nend\n</code></pre>\n\n<p>However, there might be better ways to do this. Just as an example: If I understand correctly you keep track of the number of saved products by creating a new 'save' event. You could instead have two types of events: <code>created</code> and <code>updated</code>. (This would have the added benefit of allowing you to count how many times a product has been updated since it was created)</p>\n"}], "owner": {"reputation": 17, "user_id": 4088652, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qnywz87Szkw/AAAAAAAAAAI/AAAAAAAABA4/rSsrTSfnRT8/photo.jpg?sz=128", "display_name": "Andr&#233; Hatlo-Johansen", "link": "https://stackoverflow.com/users/4088652/andr%c3%a9-hatlo-johansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52933435, "answer_count": 2, "score": 1, "last_activity_date": 1540224133, "creation_date": 1540191587, "question_id": 52923826, "link": "https://stackoverflow.com/questions/52923826/track-count-of-the-new-and-updated-records-seperatly", "title": "Track count of the new and updated records seperatly", "body": "<p>Currently working on a project where any admin can import a xlsx product sheet into active record. I've developed it so that the xlsx parser hands each unique product row to a job which either updates an existing product or creates a new based on the attributes given.</p>\n\n<p>I would like to keep track of the count of products either updated and created per sheet imported, assets added etc, to display in the admin panel. </p>\n\n<p>The method i use now is simply creating events with an associated product id's that respond to a <code>save</code> record conditional, which i then count up and display after the import is done. </p>\n\n<pre><code>if product.save\n  product.events.new(payload: 'save')\nend\n</code></pre>\n\n<p>The problem with this technique is that i can't differentiate between if the product is new or has been updated.</p>\n\n<p>Are there better techniques that are more suitable to achieve counting products saved while differentiating between if its updated or new?</p>\n\n<p>TDLR;\nImporting products to active record (1 job per product) from an excel sheet. What are the better practise's/techniques for keeping count of new and updated records seperatly per import.</p>\n"}, {"tags": ["ruby", "testing", "rspec", "gulp", "jekyll"], "comments": [{"owner": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "edited": false, "score": 1, "creation_date": 1540198174, "post_id": 52923471, "comment_id": 92760231, "body": "You are using <code>chromedriver 2.0</code>. The current one is <code>2.4.3</code>: <a href=\"http://chromedriver.chromium.org/\" rel=\"nofollow noreferrer\">chromedriver.chromium.org</a> Please update and check if you still experience issues."}, {"owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "reply_to_user": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "edited": false, "score": 0, "creation_date": 1540232820, "post_id": 52923471, "comment_id": 92780189, "body": "damn, thanks a lot mate."}], "owner": {"reputation": 660, "user_id": 2349963, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2FISz.jpg?s=128&g=1", "display_name": "Rohit Hazra", "link": "https://stackoverflow.com/users/2349963/rohit-hazra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540189773, "creation_date": 1540189773, "question_id": 52923471, "link": "https://stackoverflow.com/questions/52923471/writing-tests-for-a-basic-jekyll-site", "title": "Writing tests for a basic jekyll site", "body": "<p>I wanted to experiment on some UI testing on web, basically Jekyll, I found a blog <a href=\"https://medium.com/espark-engineering-blog/testing-your-jekyll-site-the-ruby-way-ccfa386a8318\" rel=\"nofollow noreferrer\">here</a> but my site won't build as it uses gulp to do so.</p>\n\n<pre><code>Configuration file: /Users/rohithazra/Work/zivost/zivost-com/_config.yml\nGenerating site: /Users/rohithazra/Work/zivost/zivost-com -&gt; /Users/rohithazra/Work/zivost/zivost-com/_site\nCapybara starting Puma...\n* Version 3.12.0 , codename: Llamas in Pajamas\n* Min threads: 0, max threads: 4\n* Listening on tcp://127.0.0.1:56328\nF\n\nFailures:\n\n  1) sample has the page title\n     Failure/Error: visit '/'\n\n     Selenium::WebDriver::Error::UnknownError:\n       unknown error: unable to discover open pages\n         (Driver info: chromedriver=2.0,platform=Mac OS X 10.14.0 x86_64)\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/response.rb:69:in `assert_ok'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/response.rb:32:in `initialize'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/http/common.rb:84:in `new'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/http/common.rb:84:in `create_response'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/http/default.rb:104:in `request'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/http/common.rb:62:in `call'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/bridge.rb:164:in `execute'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/bridge.rb:97:in `create_session'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/remote/bridge.rb:53:in `handshake'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/chrome/driver.rb:48:in `initialize'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/common/driver.rb:44:in `new'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver/common/driver.rb:44:in `for'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/selenium-webdriver-3.14.1/lib/selenium/webdriver.rb:86:in `for'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/capybara-3.9.0/lib/capybara/selenium/driver.rb:27:in `browser'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/capybara-3.9.0/lib/capybara/selenium/driver.rb:46:in `visit'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/capybara-3.9.0/lib/capybara/session.rb:265:in `visit'\n     # /Users/rohithazra/.rvm/gems/ruby-2.5.1/gems/capybara-3.9.0/lib/capybara/dsl.rb:51:in `block (2 levels) in &lt;module:DSL&gt;'\n     # ./spec/sample_spec.rb:3:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 22.71 seconds (files took 3.81 seconds to load)\n1 example, 1 failure\n\nFailed examples:\n\nrspec ./spec/sample_spec.rb:2 # sample has the page title\n</code></pre>\n\n<p>I am unsure on how to approach this and it would be helpful if someone can point me in the right direction.</p>\n\n<p>code repo - <a href=\"https://github.com/zivost/zivost-com\" rel=\"nofollow noreferrer\">https://github.com/zivost/zivost-com</a> .<br>\nI am writing the test code via the blog above.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "trix"], "comments": [{"owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "edited": false, "score": 0, "creation_date": 1541505335, "post_id": 52923416, "comment_id": 93232418, "body": "For those still struggling with this, I replaced src from images on content with image_url. That way it was able to fetch image from absolute path and worked perfectly."}], "owner": {"reputation": 335, "user_id": 7397660, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/41bca4edee3203ddfa4ed21b501e1bbe?s=128&d=identicon&r=PG&f=1", "display_name": "Code father", "link": "https://stackoverflow.com/users/7397660/code-father"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540189450, "creation_date": 1540189450, "question_id": 52923416, "link": "https://stackoverflow.com/questions/52923416/how-to-use-absolute-url-in-trix-image-path", "title": "How to use absolute url in trix image path?", "body": "<p>I have used gem 'trix' to integrate trix-editor feature in rails app.</p>\n\n<p>However while testing on staging environment, the trix_editor content field shows the relative path of image.</p>\n\n<pre><code>&lt;img src=\"/images/2036780.jpg\" style=\"height: 400px; width: 600px;\"&gt;\n</code></pre>\n\n<p>Is there a way I can use image_url or something to define absolute path of image for images inside trix_editor content field as in</p>\n\n<pre><code>&lt;img src=\"https://asdf.cloudfront.net/images/2036780.jpg\" style=\"height: 400px; width: 600px;\"&gt;\n</code></pre>\n"}, {"tags": ["ruby", "testing", "rspec", "mocking"], "answers": [{"tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": true, "score": 2, "last_activity_date": 1540192258, "creation_date": 1540192258, "answer_id": 52924008, "question_id": 52923352, "link": "https://stackoverflow.com/questions/52923352/what-is-the-argument-passed-into-rspecs-double-method-used-for/52924008#52924008", "title": "What is the argument passed into RSpec&#39;s double method used for?", "body": "<p>It sets a title for the double to be used in error messages.</p>\n\n<pre><code>#&lt;Double \"A Double\"&gt; received unexpected message :foo with (no args)\n</code></pre>\n\n<p>If you have multiple doubles, it will help you to figure out which one received an unexpected message.</p>\n\n<p>In addition to the title, you can make your double respond in a predefined way to a method without using something like <code>allow(double_x).to receive(:foo).and_return('bar')</code> to set it up:</p>\n\n<pre><code>let(:double_x) { double(\"Double X\", foo: 'bar') }\n# double_x.foo \n# =&gt; \"bar\"\n</code></pre>\n\n<p>The title is optional and can be left out.</p>\n"}], "owner": {"reputation": 940, "user_id": 5788024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13mIY.png?s=128&g=1", "display_name": "CaTs", "link": "https://stackoverflow.com/users/5788024/cats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 52924008, "answer_count": 1, "score": 0, "last_activity_date": 1540192258, "creation_date": 1540189151, "question_id": 52923352, "link": "https://stackoverflow.com/questions/52923352/what-is-the-argument-passed-into-rspecs-double-method-used-for", "title": "What is the argument passed into RSpec&#39;s double method used for?", "body": "<p>When creating a Test Double in RSpec, I have the option to pass in a string which seems to \"name\" the double. I'm finding it hard to find documentation about this argument, <a href=\"https://relishapp.com/rspec/rspec-mocks/docs/basics/test-doubles\" rel=\"nofollow noreferrer\">the top result on google</a> doesn't seem to mention it.</p>\n\n<p>I made a test to play around with it and as far as I can tell it just used to for presentation/printing purposes. Does it have any use outside of this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Wwd4c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wwd4c.png\" alt=\"double example\"></a></p>\n"}, {"tags": ["javascript", "ruby", "xml", "xcode", "nativescript"], "comments": [{"owner": {"reputation": 4254, "user_id": 3840213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634292034686babc667bc3b9b43c33a2?s=128&d=identicon&r=PG&f=1", "display_name": "Narendra", "link": "https://stackoverflow.com/users/3840213/narendra"}, "edited": false, "score": 0, "creation_date": 1540189209, "post_id": 52923211, "comment_id": 92755808, "body": "which version of NS are you using?"}, {"owner": {"reputation": 4254, "user_id": 3840213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634292034686babc667bc3b9b43c33a2?s=128&d=identicon&r=PG&f=1", "display_name": "Narendra", "link": "https://stackoverflow.com/users/3840213/narendra"}, "edited": false, "score": 1, "creation_date": 1540191025, "post_id": 52923211, "comment_id": 92756541, "body": "try to do a clean build. tns platform remove ios and after that tns run ios"}, {"owner": {"reputation": 462, "user_id": 5531716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13a93b5c890662ee4578a71b4fa8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Baskar Rao", "link": "https://stackoverflow.com/users/5531716/baskar-rao"}, "edited": false, "score": 0, "creation_date": 1540223078, "post_id": 52923211, "comment_id": 92775488, "body": "Also try using tns run ios --bundle if you are using Vue. tns run ios command will not work for vue."}, {"owner": {"reputation": 11, "user_id": 10538790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad263f6903f75cc5cbf1205955f81879?s=128&d=identicon&r=PG&f=1", "display_name": "Amando Garza", "link": "https://stackoverflow.com/users/10538790/amando-garza"}, "edited": false, "score": 0, "creation_date": 1540326684, "post_id": 52923211, "comment_id": 92822287, "body": "Thanks for the help but I figured it out, it was trying to run a ruby command with xcodeproj but I hadn&#39;t installed xcodeproj. The command that fixed it was &quot;sudo gem install xcodeproj&quot;"}], "owner": {"reputation": 11, "user_id": 10538790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad263f6903f75cc5cbf1205955f81879?s=128&d=identicon&r=PG&f=1", "display_name": "Amando Garza", "link": "https://stackoverflow.com/users/10538790/amando-garza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540188436, "creation_date": 1540188289, "last_edit_date": 1540188436, "question_id": 52923211, "link": "https://stackoverflow.com/questions/52923211/not-able-to-emulate-nativescript-hello-world-on-ios", "title": "Not able to emulate Nativescript hello world on ios", "body": "<p>When trying to test out a new client app stack known as Nativescript I got this build error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RQoGz.png\" alt=\"Terminal Screenshot\">.</p>\n\n<p>I tried running a build from a different project on an ios emulator which then got the same error. When running the nativescript CLI command <em>tns doctor</em>(command which checks to see if the Nativescript CLI is properly installed)it seemed to be installed correctly. I can see that some ruby command wasn't being executed correctly but don't know how I would go about fixing it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "controller", "routes", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 310, "user_id": 10445527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pQjXF.jpg?s=128&g=1", "display_name": "Mihail Panayotov", "link": "https://stackoverflow.com/users/10445527/mihail-panayotov"}, "is_accepted": false, "score": 0, "last_activity_date": 1604828647, "last_edit_date": 1604828647, "creation_date": 1540231176, "answer_id": 52935148, "question_id": 52921299, "link": "https://stackoverflow.com/questions/52921299/rails-conventions-for-complex-nested-routes-non-resourceful/52935148#52935148", "title": "Rails - Conventions for Complex &amp; Nested Routes (non-resourceful)", "body": "<p>Path variables are used to specify resources and usually one variable specify one resource. For example:</p>\n<pre><code>get '/publishers/:publisher_id/articels/:article_id/comments/:id'\n</code></pre>\n<p>In your setup you have <code>places</code> as a resource.</p>\n<p>So, in this endpoint <code>get '/places/:id'</code> :id specifies which place should be retrieved.</p>\n<p>Regarding your first route it would be most appropriate to leave just one get endpoint:</p>\n<pre><code>resource :places, only: [:show] # =&gt; get '/places/:id'\n</code></pre>\n<p>and pass the id of the parent or grandparent as :id whenever you need to retrieve the parent or grandparent place. That way you won't need any conditions in set_place method and so have:</p>\n<pre><code>def set_place\n  @place = Place.find(params[:id])\nend\n</code></pre>\n<p>In case you need to access parents or grandparents of a place object you can build:</p>\n<pre><code> get '/places/:place_id/parents/:parent_id/grandparents/:id'\n</code></pre>\n<p>or just leave <code>get '/places/:place_id/parents/:id'</code> and whenever you need to access a grandparent just make the call starting from your parent place instead of the child. Route setups can vary depending on your needs. Rails provides various examples on that matter: <a href=\"https://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">Rails Routing from the Outside In</a></p>\n<p>Regarding the helpers, there isn't a general rule for overriding or not your path methods and again it mostly depends on the application's needs. I think it is a good practice to keep them intact as much as possible. In your case instead of overriding the path method you can place:</p>\n<pre><code>thread_posts_path(thread) + '#post-' + post.id # =&gt; /threads/7/posts#post-15\n</code></pre>\n<p>directly in your view, for example:</p>\n<pre><code>link_to 'MyThredPost', thread_posts_path(thread) + '#post-' + post.id\n</code></pre>\n"}], "owner": {"reputation": 564, "user_id": 651314, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c3925ca02512cb9e6517b27861797afd?s=128&d=identicon&r=PG&f=1", "display_name": "Kobius", "link": "https://stackoverflow.com/users/651314/kobius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1604828647, "creation_date": 1540171142, "question_id": 52921299, "link": "https://stackoverflow.com/questions/52921299/rails-conventions-for-complex-nested-routes-non-resourceful", "title": "Rails - Conventions for Complex &amp; Nested Routes (non-resourceful)", "body": "<p>I have some more complex routes setup in my app, that I'm wondering could be turned into resourceful routes.</p>\n\n<p>What are the ideal Rails conventions for turning these into resourceful routes?</p>\n\n<p><strong>Route 1: /grandparent-place/parent-place/place/</strong></p>\n\n<p>These routes are at the bottom of my routes.rb file, as they pull from the root path and are scoped by parents and children.</p>\n\n<p>Routes.rb</p>\n\n<pre><code>get ':grandparent_id/:parent_id/:id', to: 'places#show', as: :grandparent_place\nget ':parent_id/:id', to: 'places#show', as: :parent_place\nget ':id', to: 'places#show', as: :place\n</code></pre>\n\n<p>Places_Controller.rb</p>\n\n<pre><code>def set_place\n  if params[:parent_id].nil? &amp;&amp; params[:grandparent_id].nil?\n    @place            = Place.find(params[:id])\n\n  elsif params[:grandparent_id].nil?\n    @parent           = Place.find(params[:parent_id])\n    @place            = @parent.children.find(params[:id])\n\n  else\n    @grandparent      = Place.find(params[:grandparent_id])\n    @parent           = @grandparent.children.find(params[:parent_id])\n    @place            = @parent.children.find(params[:id])\n\n  end\nend\n</code></pre>\n\n<p>Application_Helper.rb</p>\n\n<pre><code>def place_path(place)\n    '/' + place.ancestors.map{|x| x.id.to_s}.join('/') + '/' + place.id.to_s\nend\n</code></pre>\n\n<p><strong>Route 2: /thread#post-123</strong></p>\n\n<p>These routes are meant to allow for only specific actions, using the parent module to specify the controller directory - and using a # anchor to scroll to the specified post.</p>\n\n<p>Routes.rb</p>\n\n<pre><code>resources :threads, only: [:show] do\n  resources :posts, module: :threads, only: [:show, :create, :update, :destroy]\nend\n</code></pre>\n\n<p>Application_Helper.rb</p>\n\n<pre><code>def thread_post_path(thread, post)\n  thread_path(thread) + '#post-' + post.id.to_s\nend\n</code></pre>\n\n<p>Is it convention to override the route paths in the application helper, or is there a better way to generate the correct URLs without overriding the helpers?</p>\n"}, {"tags": ["arrays", "ruby", "optimization", "set", "combinations"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540174337, "post_id": 52921238, "comment_id": 92752494, "body": "do the <code>all_numbers</code> input values change?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1540181657, "post_id": 52921238, "comment_id": 92753877, "body": "This number is mathematically calculable without looping, and fixed. Why would you run it more than once? (Also, the last <code>.to_a</code> is eating up both your memory and execution time needlessly)"}, {"owner": {"reputation": 149, "user_id": 1741832, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/6510cc16f4c3bb7e2e5e8b488bc62fe6?s=128&d=identicon&r=PG", "display_name": "Vinny Glennon", "link": "https://stackoverflow.com/users/1741832/vinny-glennon"}, "edited": false, "score": 0, "creation_date": 1540216949, "post_id": 52921238, "comment_id": 92771645, "body": "Good spot on the unnecessary to_a. I want to see all the lines which have match 3 numbers, hence the current looping. I placed in an extra trailing count, which is confusing the question. Sorry"}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1540223070, "post_id": 52921238, "comment_id": 92775481, "body": "@VinnyGlennon, could you add a smaller example with the desired output?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 0, "creation_date": 1540225153, "post_id": 52921238, "comment_id": 92776599, "body": "@JosephWood that&#39;s not hard to do.  Just change <code>1..49</code> to something smaller like <code>1..19</code>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540225300, "post_id": 52921238, "comment_id": 92776678, "body": "Can you explain HOW <code>needle</code> might change? Give examples. Also is <code>all_numbers</code> exactly what you have here?"}, {"owner": {"reputation": 149, "user_id": 1741832, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/6510cc16f4c3bb7e2e5e8b488bc62fe6?s=128&d=identicon&r=PG", "display_name": "Vinny Glennon", "link": "https://stackoverflow.com/users/1741832/vinny-glennon"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540227754, "post_id": 52921238, "comment_id": 92777864, "body": "@lacostenycoder Examples of needles can be got from (1..49).to_a.shuffle.first(6).sort"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540233020, "post_id": 52921238, "comment_id": 92780287, "body": "@VinnyGlennon it sounds then like this is finite data. If so, can&#39;t you just pre-calculate it all and store it as a data structure?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 1741832, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/6510cc16f4c3bb7e2e5e8b488bc62fe6?s=128&d=identicon&r=PG", "display_name": "Vinny Glennon", "link": "https://stackoverflow.com/users/1741832/vinny-glennon"}, "edited": false, "score": 0, "creation_date": 1540227812, "post_id": 52922557, "comment_id": 92777894, "body": "Thanks @Amadan. Goal is to find the matching sets, rather than count of sets, hence why I have to loop over millions of records, hence the requirment to optimise it. My bad in causing confusion with my question."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 149, "user_id": 1741832, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/6510cc16f4c3bb7e2e5e8b488bc62fe6?s=128&d=identicon&r=PG", "display_name": "Vinny Glennon", "link": "https://stackoverflow.com/users/1741832/vinny-glennon"}, "edited": false, "score": 0, "creation_date": 1540299507, "post_id": 52922557, "comment_id": 92807221, "body": "@VinnyGlennon see updated answer... this is blazing! Nice one!"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1540235475, "last_edit_date": 1540235475, "creation_date": 1540183590, "answer_id": 52922557, "question_id": 52921238, "link": "https://stackoverflow.com/questions/52921238/check-matches-with-3s-in-a-set-of-6-numbers-across-49-number-draws/52922557#52922557", "title": "Check matches with 3&#39;s in a set of 6 numbers across 49 number draws", "body": "<p>Assuming all of <code>needle</code> is members of <code>all_numbers</code>:</p>\n\n<p>For three to be correct, that's a 3-combination of 6:</p>\n\n<pre><code>(6*5*4) / (1*2*3) = 20\n</code></pre>\n\n<p>For the remaining three to be incorrect, that's a 3-combination of the remaining (49-6):</p>\n\n<pre><code>(43*42*41) / (1*2*3) = 12341\n</code></pre>\n\n<p>Thus, the total number of combinations is</p>\n\n<pre><code>12341 * 20 = 246820\n</code></pre>\n\n<p>In code:</p>\n\n<pre><code>require 'benchmark'\n\nsize_all = 49\nsize_needle = 6\nrequired = 3\n\ndef binomial(n, k)\n  ((n - k + 1)..n).inject(&amp;:*) / (1..k).inject(&amp;:*)\nend\n\nBenchmark.bm do |x|\n  x.report {\n    binomial(size_needle, required) * binomial(size_all - size_needle, required)\n  }\nend\n\n#        user     system      total        real\n#   0.000026   0.000006   0.000032 (  0.000030)\n</code></pre>\n\n<p>Slightly faster.</p>\n\n<p>EDIT: After the requirements are changed:</p>\n\n<pre><code>class Array\n  def semimatching_combination(needle, num_total, num_needle)\n    unless block_given?\n      return to_enum(__method__, needle, num_total, num_needle) do\n        binomial(needle.size, num_needle) *\n          binomial(self.size - needle.size, num_total - num_needle)\n      end\n    end\n\n    needle.combination(num_needle) do |needle_comb|\n      (self - needle).combination(num_total - num_needle) do |other_comb|\n        yield (needle_comb + other_comb).sort\n      end\n    end\n  end\nend\n\n(1..49).to_a.semimatching_combination((1..6).to_a, 6, 3).size\n# =&gt; 246820\n(1..49).to_a.semimatching_combination((1..6).to_a, 6, 3).to_a\n# =&gt; [[1, 2, 3, 7, 8, 9], ...]\n</code></pre>\n\n<p>You can replace <code>sort</code> with <code>to_set</code> (with <code>require 'set'</code>) if you want, depending on what you want to generate.</p>\n"}], "owner": {"reputation": 149, "user_id": 1741832, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/6510cc16f4c3bb7e2e5e8b488bc62fe6?s=128&d=identicon&r=PG", "display_name": "Vinny Glennon", "link": "https://stackoverflow.com/users/1741832/vinny-glennon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 52922557, "answer_count": 1, "score": -2, "last_activity_date": 1540235475, "creation_date": 1540170271, "last_edit_date": 1540227614, "question_id": 52921238, "link": "https://stackoverflow.com/questions/52921238/check-matches-with-3s-in-a-set-of-6-numbers-across-49-number-draws", "title": "Check matches with 3&#39;s in a set of 6 numbers across 49 number draws", "body": "<p>I am using <code>select</code> within Sidekiq:</p>\n\n<pre><code>require 'set'\nrequire 'benchmark'\n\nall_numbers = (1..49).to_a.combination(6)\nneedle = [1,2,3,4,5,6].to_set\n\nBenchmark.bm do |x|\n x.report { all_numbers.select{|z| (needle &amp; z).count == 3}  }\nend\n\n# user     system      total        real\n# 74.200000   3.040000  77.240000 ( 78.901259)\n</code></pre>\n\n<p>I want to check thousands of such needles quickly. Is there a different way to find out this information? Is converting to C an option?</p>\n\n<p>Note:\n    all_numbers is a variable that does not change, and is as above always.\n    Goal is to display all the sets which have 3 matches.\n    Examples of needles can be got from:</p>\n\n<pre><code>(1..49).to_a.shuffle.first(6).sort\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2473, "user_id": 3788685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0153b937db548cca172e6a78e71eabe3?s=128&d=identicon&r=PG&f=1", "display_name": "user3788685", "link": "https://stackoverflow.com/users/3788685/user3788685"}, "edited": false, "score": 0, "creation_date": 1540178608, "post_id": 52920838, "comment_id": 92753242, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52921638/how-to-add-loop-on-ruby-calculator\">how to add loop on ruby calculator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7623670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7389ffca8a00ec2bad585785a73baa?s=128&d=identicon&r=PG&f=1", "display_name": "D.Granulo", "link": "https://stackoverflow.com/users/7623670/d-granulo"}, "edited": false, "score": 0, "creation_date": 1540166213, "post_id": 52920903, "comment_id": 92751231, "body": "Where would I put that in the program?"}, {"owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "reply_to_user": {"reputation": 1, "user_id": 7623670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7389ffca8a00ec2bad585785a73baa?s=128&d=identicon&r=PG&f=1", "display_name": "D.Granulo", "link": "https://stackoverflow.com/users/7623670/d-granulo"}, "edited": false, "score": 0, "creation_date": 1540167000, "post_id": 52920903, "comment_id": 92751344, "body": "Around all checking: <code>until (which_operation = gets.chomp).empty?    if which_operation == &quot;+&quot;    ...    if which_operation == &quot;-&quot;    ...    if which_operation == &quot;*&quot;    ...    if which_operation == &quot;&#47;&quot;    ...  end</code>"}, {"owner": {"reputation": 1, "user_id": 7623670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7389ffca8a00ec2bad585785a73baa?s=128&d=identicon&r=PG&f=1", "display_name": "D.Granulo", "link": "https://stackoverflow.com/users/7623670/d-granulo"}, "edited": false, "score": 0, "creation_date": 1540167294, "post_id": 52920903, "comment_id": 92751388, "body": "Everywhere I would put it, it would just say syntax error. Can you write the whole code out and put the edit you said would work? Thanks"}, {"owner": {"reputation": 1, "user_id": 7623670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7389ffca8a00ec2bad585785a73baa?s=128&d=identicon&r=PG&f=1", "display_name": "D.Granulo", "link": "https://stackoverflow.com/users/7623670/d-granulo"}, "edited": false, "score": 0, "creation_date": 1540171724, "post_id": 52920903, "comment_id": 92752074, "body": "It doesn&#39;t continue the program it just stops asking questions. Maybe if you write every line of code down than it will work"}], "tags": [], "owner": {"reputation": 665, "user_id": 10306509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dEjY3.jpg?s=128&g=1", "display_name": "Ivan Olshansky", "link": "https://stackoverflow.com/users/10306509/ivan-olshansky"}, "is_accepted": false, "score": 0, "last_activity_date": 1540177573, "last_edit_date": 1540177573, "creation_date": 1540166008, "answer_id": 52920903, "question_id": 52920838, "link": "https://stackoverflow.com/questions/52920838/how-to-add-a-loop-in-calculator-program/52920903#52920903", "title": "How to add a loop in calculator program", "body": "<p>For example:<br>\n<code>until (which_operation = gets.chomp).empty?\n    if which_operation == \"+\"\n      ...\n    end\n    if which_operation == \"-\"\n      ...\n    end\n    if which_operation == \"*\"\n      ...\n    end\n    if which_operation == \"/\"\n      ...\n    end\n end</code><br>\nThis loop will work until you press Enter without entering any text before it.<br><br>\nP.S.: Better use <strong>case</strong> operator instead of multiple <strong>if</strong>.<br><br>\nP.P.S.: All your code, after loop addition and without <strong>case</strong> operator, will be:</p>\n\n<pre>puts \"Hello, My name is Calvin The Calculator and I am a calculator that can do basic functions such as Adding, Subtracting, Multiplying and Dividing\"\nputs \"Press a and enter to enable my services\"\n\nuntil gets.chomp == \"a\"\n  puts \"I'm Waiting...\"\nend\nputs \"Choose which operation you want to do. + for adding, - for subtraction, * for multiplication and / for division\"\n\nuntil (which_operation = gets.chomp).empty?\n  if which_operation == \"+\"\n    puts \"What is the first number you want to add\"\n    adding_first_number = gets.chomp.to_i\n    puts \"What is the second number you want to add to #{adding_first_number}\"\n    adding_second_number = gets.chomp.to_i\n    puts \"#{adding_first_number} + #{adding_second_number} is #{adding_first_number + adding_second_number}\"\n  elsif which_operation == \"-\"\n    puts \"What is the first number you want to subtract\"\n    subtracting_first_number = gets.chomp.to_i\n    puts \"What is the number you want to subtract from #{subtracting_first_number}\"\n    subtracting_second_number = gets.chomp.to_i\n    puts \"#{subtracting_first_number} -  #{subtracting_second_number} is #{subtracting_first_number - subtracting_second_number}\"\n  elsif which_operation == \"*\"\n    puts \"What is the first number you want to multiple\"\n    multiplying_first_number = gets.chomp.to_i\n    puts \"What is the number you want to multiple #{multiplying_first_number} by\"\n    multiplying_second_number = gets.chomp.to_i\n    puts \"#{multiplying_first_number} * by #{multiplying_second_number} is #{multiplying_first_number * multiplying_second_number}\"\n  elsif which_operation == \"/\"\n    puts \"What is the first number to your divison question?\"\n    dividing_first_number = gets.chomp.to_i\n    puts \"What is the divisor?\"\n    dividing_second_number = gets.chomp.to_i\n    puts \"#{dividing_first_number} divided by #{dividing_second_number} is #{dividing_first_number / dividing_second_number}\"\n  end\n  puts \"\\nLet's try again: \"\nend</pre>\n"}], "owner": {"reputation": 1, "user_id": 7623670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7389ffca8a00ec2bad585785a73baa?s=128&d=identicon&r=PG&f=1", "display_name": "D.Granulo", "link": "https://stackoverflow.com/users/7623670/d-granulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540177573, "creation_date": 1540165346, "last_edit_date": 1540166461, "question_id": 52920838, "link": "https://stackoverflow.com/questions/52920838/how-to-add-a-loop-in-calculator-program", "title": "How to add a loop in calculator program", "body": "<p>I created a calculator in ruby. I am wondering how to put this in a loop so I don't have to run it constantly. I am new to programming so please understand I am I just trying to learn. I would appreciate any help provided. </p>\n\n<pre><code>puts \"Hello, My name is Calvin The Calculator and I am a calculator that can do basic functions such as Adding, Subtracting, Multiplying and Dividing\"\nputs \"Press a and enter to enable my services\"\n\nenable = gets.chomp\nif enable == \"a\"\n  puts \"Choose which operation you want to do. + for adding, - for subtraction, * for multiplication and / for division\"\nelse\n  \"Puts Im Waiting...\"\nend\n\nwhich_operation = gets.chomp\nif which_operation == \"+\"\n  puts \"What is the first number you want to add\"\n  adding_first_number = gets.chomp.to_i\n  puts \"What is the second number you want to add to #{adding_first_number}\"\n  adding_second_number = gets.chomp.to_i\n  puts \"#{adding_first_number} + #{adding_second_number} is #{adding_first_number + adding_second_number}\" \nelse\n\nend\n\nif which_operation == \"-\"\n  puts \"What is the first number you want to subtract\"\n  subtracting_first_number = gets.chomp.to_i\n  puts \"What is the number you want to subtract from #{subtracting_first_number}\"\n  subtracting_second_number = gets.chomp.to_i\n  puts \"#{subtracting_first_number} -  #{subtracting_second_number} is #{subtracting_first_number - subtracting_second_number}\"\nelse\n\nend\n\nif which_operation == \"*\"\n  puts \"What is the first number you want to multiple\"\n  multiplying_first_number = gets.chomp.to_i\n  puts \"What is the number you want to multiple #{multiplying_first_number} by\"\n  multiplying_second_number = gets.chomp.to_i\n  puts \"#{multiplying_first_number} * by #{multiplying_second_number} is #{multiplying_first_number * multiplying_second_number}\"\nelse\n\nend\n\nif which_operation == \"/\"\n  puts \"What is the first number to your divison question?\"\n  dividing_first_number = gets.chomp.to_i\n  puts \"What is the divisor?\"\n  dividing_second_number = gets.chomp.to_i\n  puts \"#{dividing_first_number} divided by #{dividing_second_number} is #{dividing_first_number / dividing_second_number}\"\nelse\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 7024562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ef9429ef24e0c0977d72918e5ceaa3?s=128&d=identicon&r=PG&f=1", "display_name": "J.Krzus", "link": "https://stackoverflow.com/users/7024562/j-krzus"}, "edited": false, "score": 0, "creation_date": 1540157960, "post_id": 52919806, "comment_id": 92749695, "body": "First example worked after adding \\ before . <code>assert_match &#47;http:\\&#47;\\&#47;loremflickr\\.com\\&#47;300\\&#47;300\\?random=\\d{1,3}&#47;</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "reply_to_user": {"reputation": 124, "user_id": 7024562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ef9429ef24e0c0977d72918e5ceaa3?s=128&d=identicon&r=PG&f=1", "display_name": "J.Krzus", "link": "https://stackoverflow.com/users/7024562/j-krzus"}, "edited": false, "score": 1, "creation_date": 1540158736, "post_id": 52919806, "comment_id": 92749869, "body": "Sorry, I forgot escaping the dot. Edited. Thanks!"}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 4, "last_activity_date": 1540158741, "last_edit_date": 1540158741, "creation_date": 1540155344, "answer_id": 52919806, "question_id": 52919767, "link": "https://stackoverflow.com/questions/52919767/how-to-correctly-use-regex-in-ruby-test/52919806#52919806", "title": "How to correctly use regex in ruby test", "body": "<p>You can use <a href=\"https://apidock.com/ruby/MiniTest/Assertions/assert_match\" rel=\"nofollow noreferrer\"><code>assert_match</code></a> and avoid having to handle manually that procedure, making that more verbose. If your regular expression works fine, then:</p>\n\n<pre><code>assert_match /http:\\/\\/loremflickr\\.com\\/300\\/300\\?random=\\d{1,3}/, @tester.image\n</code></pre>\n\n<p>Or for not having to escape specific characters:</p>\n\n<pre><code>%r{http://loremflickr\\.com/300/300\\?random=\\d{1,3}}\n</code></pre>\n"}], "owner": {"reputation": 124, "user_id": 7024562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ef9429ef24e0c0977d72918e5ceaa3?s=128&d=identicon&r=PG&f=1", "display_name": "J.Krzus", "link": "https://stackoverflow.com/users/7024562/j-krzus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52919806, "answer_count": 1, "score": 1, "last_activity_date": 1540187021, "creation_date": 1540155100, "last_edit_date": 1540187021, "question_id": 52919767, "link": "https://stackoverflow.com/questions/52919767/how-to-correctly-use-regex-in-ruby-test", "title": "How to correctly use regex in ruby test", "body": "<p>In a test, there is a random number at the end of a function output. I need to use regex. When I check the output manually, it works as intended. But my tests don't pass. Here's how it looks:</p>\n\n<pre><code>assert @tester.image == \"http://loremflickr.com/300/300?random=#{/\\d{1,3}/}\"\n</code></pre>\n\n<p>The end of the url contains 1-3 digits. Example:</p>\n\n<pre><code>...random=476\n</code></pre>\n\n<p>How can I use regex properly in this context?</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "postgresql", "rails-activerecord"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153028, "post_id": 52919375, "comment_id": 92748533, "body": "Can you please make clear the logic you want to use to update the data? Also why do you need a field in the story if you already have that data in the user model?  Is there a reason you want to duplicate data in the DB ?"}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153151, "post_id": 52919375, "comment_id": 92748568, "body": "In the database, I want to iterate over each story, and update its user_name attribute. Each story belongs to a user, so I want to set each user_name to each story&#39;s user.name value."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1540153226, "post_id": 52919375, "comment_id": 92748594, "body": "But why duplicate this data if you already have a user that has a name? Also, when should this data migration happen? It sounds like you just need to write a data migration."}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153309, "post_id": 52919375, "comment_id": 92748609, "body": "I no longer want to show all the user data for each story, since that data includes email addresses and other info that I don&#39;t need or want in the API endpoint. I just want each story to have a user_name attribute."}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153417, "post_id": 52919375, "comment_id": 92748640, "body": "My question is: how can I use update_all to update attributes dynamically?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153583, "post_id": 52919375, "comment_id": 92748679, "body": "You can&#39;t do this with <code>update_all</code>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1540153729, "post_id": 52919375, "comment_id": 92748713, "body": "@EthanRyan, can you elaborate in &quot;dynamically&quot;. Anyways, this is invalid syntax: <code>update_all(&#39;user_name = Story.user.name&#39;)</code>, try <code>update_all(user_name: Story.user.name)</code>, where Story.user.name is evaluated as isn&#39;t within quotes."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1540153794, "post_id": 52919375, "comment_id": 92748734, "body": "<code>Story.user</code> implies <code>user</code> is a class method.. this can&#39;t be right can it? @SebastianPalma wouldn&#39;t this update all the records to a single <code>user_name</code> ?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540153969, "post_id": 52919375, "comment_id": 92748784, "body": "It would also be helpful if you clarify the relations between stories and users... are the both HABTM ?"}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540154539, "post_id": 52919375, "comment_id": 92748907, "body": "stories belong to users, and users have many stories"}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540154688, "post_id": 52919546, "comment_id": 92748945, "body": "Thanks, this is great! I was hoping to use update_all because it doesn&#39;t update the updated_at timestamp field, according to the first comment here: <a href=\"https://apidock.com/rails/ActiveRecord/Relation/update_all\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Relation/update_all</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540154874, "post_id": 52919546, "comment_id": 92749001, "body": "There is a way to do this with sql but not quite so simple. But why do you care about the timestamp? Is this a one off run? It is more recommended to to this in a migration if this is in production data."}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540154962, "post_id": 52919546, "comment_id": 92749019, "body": "It is a one off run, but I&#39;m sorting my stories by updated_at in a table on the frontend, so didn&#39;t want to update their timestamps. But if there isn&#39;t an easy want to update the user_name attribute without also updating the updated_at value, I&#39;ll mark this as correct."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540155026, "post_id": 52919546, "comment_id": 92749035, "body": "There is a way, but that is a separate question."}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540155101, "post_id": 52919546, "comment_id": 92749053, "body": "Is that a separate question? My question is: How can I iterate through all my stories in my Postgresql database and dynamically update each story&#39;s user_name value?  I want to use something like ActiveRecord&#39;s update_all method, but with a dynamic argument."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "edited": false, "score": 0, "creation_date": 1540155140, "post_id": 52919546, "comment_id": 92749067, "body": "Dynamic does not automatically imply &quot;don&#39;t touch timestamps&quot; and we already determined you can&#39;t really use <code>update_all</code> for this purpose."}, {"owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1540155332, "post_id": 52919546, "comment_id": 92749115, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/182232/discussion-between-ethan-ryan-and-lacostenycoder\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1540155752, "last_edit_date": 1540155752, "creation_date": 1540153521, "answer_id": 52919546, "question_id": 52919375, "link": "https://stackoverflow.com/questions/52919375/update-rails-activerecord-sql-database-dynamically/52919546#52919546", "title": "update Rails / ActiveRecord / SQL database dynamically", "body": "<p>The easiest way is to iterate over all records in the stories table:</p>\n\n<pre><code>Story.find_each {|story| story.update(user_name: story.user.name)}\n</code></pre>\n\n<p>If your goal is not to touch timestamps or validations as with <code>update_all</code> you can do</p>\n\n<pre><code>Story.find_each {|story| story.update_column(:user_name, story.user.name)}\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 6893951, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tq6_mOEOo1g/AAAAAAAAAAI/AAAAAAAAANg/XrBJWhlzvvc/photo.jpg?sz=128", "display_name": "Ethan Ryan", "link": "https://stackoverflow.com/users/6893951/ethan-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 52919546, "answer_count": 1, "score": -2, "last_activity_date": 1540155752, "creation_date": 1540152266, "question_id": 52919375, "link": "https://stackoverflow.com/questions/52919375/update-rails-activerecord-sql-database-dynamically", "title": "update Rails / ActiveRecord / SQL database dynamically", "body": "<p>I have a database full of stories, and each story belongs to a user.</p>\n\n<p>I already have a user_id attribute for each story.</p>\n\n<p>I recently added a user_name attribute to all my stories as well.</p>\n\n<p>Now all of those user_name attributes are nil.</p>\n\n<p>In the console, I can do <code>Story.first.user_name = Story.first.user.name</code> to set the user_name attribute to the first story's user.name value.</p>\n\n<p>How can I iterate through all my stories in my Postgresql database and dynamically update each story's user_name value?</p>\n\n<p>I want to use something like ActiveRecord's update_all method, but with a dynamic argument.</p>\n\n<p>I tried in the Rails console:</p>\n\n<p><code>Story.update_all('user_name = Story.user.name')</code></p>\n\n<p>but that returned:</p>\n\n<p><code>SQL (36.2ms)  UPDATE \"stories\" SET user_name = Story.user.name\nActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR:  missing FROM-clause entry for table \"user\"\nLINE 1: UPDATE \"stories\" SET user_name = Story.user.name\n                                         ^\n: UPDATE \"stories\" SET user_name = Story.user.name\n    from (irb):14</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/akGGl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/akGGl.png\" alt=\"SQL-error-missing-FROM-clause\"></a></p>\n\n<p>Not sure how to use the FROM in raw SQL, or how to write the correct command in ActiveRecord.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1540148552, "post_id": 52918753, "comment_id": 92747430, "body": "Have you read <a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">Active Record Associations</a>?"}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1540166518, "post_id": 52918753, "comment_id": 92751281, "body": "Yes. It&#39;s what helped me design this. However, I&#39;m still struggling to conceptualize it all and put it to use."}], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1540168726, "post_id": 52919457, "comment_id": 92751615, "body": "Thanks for your response. I&#39;ll let you know how it works out for me. Is there a reason you say 2 tables instead of 3?"}, {"owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "reply_to_user": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 1, "creation_date": 1540192778, "post_id": 52919457, "comment_id": 92757369, "body": "Sorry for the confusion, I said 2 tables earlier and then I realized we need a third in-between table for associations. updating my answer, thanks for pointing it out."}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1540262662, "post_id": 52919457, "comment_id": 92789619, "body": "Food pluralizes to foods. And apparently recipe_id and food_id need to be singular in the ingredients table. The query &quot;Recipe.first.ingredients.count&quot; errored because it was singularizing those ids."}, {"owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "edited": false, "score": 0, "creation_date": 1540262708, "post_id": 52919457, "comment_id": 92789627, "body": "Thanks for the help. That got me where I wanted to be."}], "tags": [], "owner": {"reputation": 909, "user_id": 9534861, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HEqJQasw6sM/AAAAAAAAAAI/AAAAAAAABHA/HiEIzDPH-l0/photo.jpg?sz=128", "display_name": "Saqib Shahzad", "link": "https://stackoverflow.com/users/9534861/saqib-shahzad"}, "is_accepted": true, "score": 1, "last_activity_date": 1540267753, "last_edit_date": 1540267753, "creation_date": 1540152820, "answer_id": 52919457, "question_id": 52918753, "link": "https://stackoverflow.com/questions/52918753/how-to-use-a-link-table-with-active-record-query-interface/52919457#52919457", "title": "How to use a Link table with Active Record query interface", "body": "<p>so what I understand from your question is you want to get results like: \n<code>Peppered Lettuce, 5 tbsp pepper, 10 oz Lettuce</code> in which Peppered Lettuce is <code>Recipe</code> name, and Pepper and Lettuce are <code>Food</code> items with numeric quantities of ingredients. </p>\n\n<p>You don't need 4 tables to obtain this result. You only need 3. <code>Food</code>, <code>Recipe</code> and an in-between table for their many-to-many association.</p>\n\n<p><code>Recipe</code> can have multiple <code>Food</code> items in it and 1 <code>Food</code> item can be a part of multiple <code>Recipe</code> objects. So <code>Food</code> and <code>Recipe</code> model will have a <code>many-to-many</code> association. And for this kind of association, you need another table. You can name it <code>Foods_Recipes</code> or simply <code>Ingredients</code>.<br>\nYour <code>Ingredient</code> model will then have a <code>food_id</code>,<code>recipe_id</code>,<code>numeric_quantity</code> and <code>unit_type</code></p>\n\n<p>The Schema would look like this: </p>\n\n<pre><code>create_table \"foods\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"ingredients\", force: :cascade do |t|\n    t.bigint \"recipe_id\"\n    t.bigint \"food_id\"\n    t.decimal \"quantity\"\n    t.string \"unit_type\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"food_id\"], name: \"index_ingredients_on_food_id\"\n    t.index [\"recipe_id\"], name: \"index_ingredients_on_recipe_id\"\n  end\n\n  create_table \"recipes\", force: :cascade do |t|\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"name\"\n  end\n</code></pre>\n\n<p>Your models would look like this: \nFood model: </p>\n\n<pre><code>class Recipe &lt; ApplicationRecord\n has_many :ingredients\n has_many :foods,through: :ingredients\nend\n</code></pre>\n\n<p>Ingredient model:</p>\n\n<pre><code>class Ingredient &lt; ApplicationRecord\n belongs_to :recipe\n belongs_to :food\nend\n</code></pre>\n\n<p>Food model:</p>\n\n<pre><code>class Food &lt; ApplicationRecord\n has_many :ingredients\n has_many :recipes,through: :ingredients\nend\n</code></pre>\n"}], "owner": {"reputation": 509, "user_id": 7254473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fkwvm.jpg?s=128&g=1", "display_name": "Jonny B", "link": "https://stackoverflow.com/users/7254473/jonny-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52919457, "answer_count": 1, "score": 1, "last_activity_date": 1540267753, "creation_date": 1540148044, "last_edit_date": 1540156434, "question_id": 52918753, "link": "https://stackoverflow.com/questions/52918753/how-to-use-a-link-table-with-active-record-query-interface", "title": "How to use a Link table with Active Record query interface", "body": "<p>I am still relatively new to Active Record and have a (hopefully simple) question. </p>\n\n<p>I have four tables <code>Recipes</code>(Name of recipe), <code>Food</code>(lettuce, Pepper), <code>Units</code>(oz, tbsp), and <code>Ingredients</code>(Id's of the other tables and the numeric quantity).</p>\n\n<p>What I'd like to do is something like this <code>Recipes.Ingredients</code> and get \"Peppered Lettuce, 5 tbsp pepper, 10 oz Lettuce\". </p>\n\n<p>How would I accomplishes that with the following schema. And if not possible with this schema what should I build in its place.</p>\n\n<p>The Schema looks like this:</p>\n\n<pre><code>  create_table \"food\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"ingredients\", force: :cascade do |t|\n    t.bigint \"recipes_id\"\n    t.bigint \"units_id\"\n    t.bigint \"food_id\"\n    t.decimal \"quantity\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"food_id\"], name: \"index_ingredients_on_food_id\"\n    t.index [\"recipes_id\"], name: \"index_ingredients_on_recipes_id\"\n    t.index [\"units_id\"], name: \"index_ingredients_on_units_id\"\n  end\n\n  create_table \"recipes\", force: :cascade do |t|\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.string \"name\"\n  end\n\n  create_table \"units\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n"}]