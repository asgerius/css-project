[{"tags": ["ruby", "linux", "windows"], "comments": [{"owner": {"reputation": 4288, "user_id": 527152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c784b2e1c3fb28d8bad8f50ca0282b4?s=128&d=identicon&r=PG", "display_name": "Azolo", "link": "https://stackoverflow.com/users/527152/azolo"}, "edited": false, "score": 0, "creation_date": 1434056249, "post_id": 30769350, "comment_id": 49632123, "body": "This is one of those situations where traditional Ruby thinking, using system tools and capabilities instead of language features, kind of falls flat when you try to be platform inclusive. It&#39;s just a trade off of being pragmatic or thorough."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "edited": false, "score": 0, "creation_date": 1433982753, "post_id": 30769531, "comment_id": 49591090, "body": "Just another little tidbit, your <code>find</code> would also give names starting with <code>.</code>, but the <code>Dir.glob</code> wouldn&#39;t unless rewritten as: <code>Dir.glob(&quot;#{path}&#47;**&#47;**&quot;, File::FNM_DOTMATCH)</code>, AND you would need to ignore paths ending in <code>&quot;&#47;.&quot;</code> or <code>&quot;&#47;..&quot;</code>."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1433982790, "post_id": 30769531, "comment_id": 49591096, "body": "Thanks, it works like a charm. Is there a fast way to generate a tree-like view with this ? (see my edit)"}, {"owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 1, "creation_date": 1433983510, "post_id": 30769531, "comment_id": 49591263, "body": "I added a bit of code, it should have parts that you can use for a tree of dir or file nodes in your own code."}], "tags": [], "owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "is_accepted": true, "score": 1, "last_activity_date": 1433983261, "last_edit_date": 1433983261, "creation_date": 1433981948, "answer_id": 30769531, "question_id": 30769350, "link": "https://stackoverflow.com/questions/30769350/ruby-on-rails-cross-platform-win-linux-script/30769531#30769531", "title": "Ruby on rails cross-platform win/linux script", "body": "<p>I wouldn't use a subcommand at all. The builtin <code>Dir.glob</code> should work in this case.</p>\n\n<p>Something like:</p>\n\n<pre><code>Dir.glob(\"#{path}/**/**\").each { |fileOrDir| do_something }\n</code></pre>\n\n<p>In any case, your <code>find</code> is recursive, but your <code>dir</code> wouldn't be.</p>\n\n<p>If you <em>really</em> want to know if running on Windows, there are some Ruby-centric ways, but for years I have been checking for the <code>WINDIR</code> variable in the environment, e.g.</p>\n\n<pre><code>if ENV[\"WINDIR\"]\n    puts \"On Windows\"\nelse\n    puts \"Not Windows *probably*\"\nend\n</code></pre>\n\n<p>EDIT:  Here is a tool I wrote years ago that generates a tree of Nodes and then displays them sorted in various ways.</p>\n\n<pre><code>def usage\n    puts &lt;&lt;END\nRecursive listing of files or dirs, sortable by date or size or count.\n    rl [-cdfnrsuv] [-p pathname] [pathname ...]\nWhere:\n    pathname = Dir or file to process; default is \".\".\n    -c = Sort by file count; default is sort by date.\n    -d = List dirs only, with their contents sizes and counts.\n    -f = List files only, no dirs or links.\n    -n = Sort by name; default is sort by date.\n    -p = Add pathname even if it starts with \"-\".\n    -r = Reverse sort order; default order is desc, except by name is asc.\n    -s = Sort by size; default is sort by date.\n    -u = Unsorted; default is sort by date.\n    -v = Verbose, including type, perms, and owner.\nEND\n    exit(1)\nend # usage\n\nclass Node\n    attr_reader :path, :stat\n    def load(path)\n        @path, @stat, @children = path, File.lstat(path), []\n        @stat.directory? and Dir.glob(\"#{path}/*\", File::FNM_DOTMATCH).each { |sub_path|\n            sub_path[-2,2] != \"/.\" &amp;&amp; sub_path[-3,3] != \"/..\" and @children &lt;&lt; Node.new.load(sub_path)\n        }\n        self\n    end\n    def size\n        @size or @size = self.stat.directory? ? (@children.inject(0) { |acc, child| acc + child.size }) : @stat.size\n    end\n    def count\n        @count or @count = self.stat.directory? ? (@children.inject(0) { |acc, child| acc + child.count }) : 1\n    end\n    def to_a\n        @children.map { |child| child.to_a }.flatten + [self]\n    end\nend # Node\n\nonly_dirs = only_files = by_count = by_name = by_sz = verbose = false; sort = 1; paths = []\nwhile (arg = ARGV.shift)\n    arg =~ /^-[^-]*[h?]/ and usage\n    arg =~ /^-[^-]*c/ and by_count = true\n    arg =~ /^-[^-]*d/ and only_dirs = true\n    arg =~ /^-[^-]*f/ and only_files = true\n    arg =~ /^-[^-]*n/ and by_name = true\n    arg =~ /^-[^-]*r/ and sort *= -1\n    arg =~ /^-[^-]*s/ and by_sz = true\n    arg =~ /^-[^-]*u/ and sort = 0\n    arg =~ /^-[^-]*v/ and verbose = true\n    arg =~ /^-[^-]*p/ and paths &lt;&lt; ARGV.shift\n    arg !~ /^-/       and paths &lt;&lt; arg\nend\nnodes = (paths.empty? ? [\".\"] : paths).map { |path| Node.new.load(path).to_a }.flatten\nif sort != 0\n    if    by_sz    then nodes.sort! { |a, b| sort * (2 * (b.size &lt;=&gt; a.size) + (a.path &lt;=&gt; b.path)) }\n    elsif by_count then nodes.sort! { |a, b| sort * (2 * (b.count &lt;=&gt; a.count) + (a.path &lt;=&gt; b.path)) }\n    elsif by_name  then nodes.sort! { |a, b| sort * (a.path &lt;=&gt; b.path) }\n    else  nodes.sort! { |a, b| sort * (2 * (b.stat.mtime &lt;=&gt; a.stat.mtime) + (a.path &lt;=&gt; b.path)) }\n    end\nend\nfor node in nodes\n    next if only_dirs &amp;&amp; ! node.stat.directory?\n    next if only_files &amp;&amp; ! node.stat.file?\n    puts \"%s %11s %6s %s%s\" % [\n        node.stat.mtime.strftime(\"%Y-%m-%d %H:%M:%S\"),\n        node.size.to_s.reverse.gsub(/(\\d{3})(?=\\d)(?!\\d*\\.)/, \"\\\\1,\").reverse,\n        node.count.to_s.reverse.gsub(/(\\d{3})(?=\\d)(?!\\d*\\.)/, \"\\\\1,\").reverse,\n        verbose ? \"%-9s %6o %4d %4d \" % [:ftype, :mode, :uid, :gid].map { |v| node.stat.send(v) } : \"\",\n        node.path]\nend\n</code></pre>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30769531, "answer_count": 1, "score": 2, "last_activity_date": 1433983261, "creation_date": 1433980742, "last_edit_date": 1433982741, "question_id": 30769350, "link": "https://stackoverflow.com/questions/30769350/ruby-on-rails-cross-platform-win-linux-script", "title": "Ruby on rails cross-platform win/linux script", "body": "<p>I want to list the files/directories in a subdirectory using a Ruby on Rails application, but I don't know if the script will run under Linux or Windows.</p>\n\n<p>On linux this is easy, I can just do a </p>\n\n<pre><code>`find my_path`.split(\"\\n\").each{|line| do_sthing_with_line}\n</code></pre>\n\n<p>On windows, the equivalent would be to use the <code>dir</code> command. But even after reading many posts on this, I can't figure out a way to make it work correctly</p>\n\n<pre><code>`dir my_path` will output a string that is recognized as ruby as utf-8, but which in reality isn't.\n</code></pre>\n\n<p>What's the correct way to make it work on windows ?\nIs there a quick way to check if I'm on windows or not ? <code>on_windows? dir_command : find_command</code></p>\n\n<p>EDIT : and is there a fast way to generate a tree view of the content of a directory like this ?</p>\n\n<pre><code>-- rails_app\n-- -- app/\n-- -- -- models/\n-- -- -- controllers/\n-- -- -- views/\n-- -- bin/\n-- -- config/\netc.\n</code></pre>\n"}, {"tags": ["ruby", "mongodb-ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1433989533, "post_id": 30769193, "comment_id": 49592694, "body": "The error is telling you that the driver doesn&#39;t know how to put a <code>Tile</code> instance into MongoDB, MongoDB doesn&#39;t know what to do with <code>Tile</code>s and no one will automatically call <code>to_json</code> for you."}, {"owner": {"reputation": 4607, "user_id": 434171, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dXoTt.jpg?s=128&g=1", "display_name": "Enrique Marcos", "link": "https://stackoverflow.com/users/434171/enrique-marcos"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1434009616, "post_id": 30769193, "comment_id": 49600444, "body": "I&#39;ve tried calling to_json, but it inserts the content as a String (a json string), not as an Array."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1434042679, "post_id": 30769193, "comment_id": 49624057, "body": "<code>to_json</code> returns a string, <code>as_json</code> returns a Hash. Yes, the naming is a bit confusing. Sorry, that wasn&#39;t my clearest comment ever."}], "answers": [{"comments": [{"owner": {"reputation": 4607, "user_id": 434171, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dXoTt.jpg?s=128&g=1", "display_name": "Enrique Marcos", "link": "https://stackoverflow.com/users/434171/enrique-marcos"}, "edited": false, "score": 0, "creation_date": 1434009541, "post_id": 30769527, "comment_id": 49600404, "body": "(I cannot prove the code right now) But that would insert a (json )string and not an array, right? I&#39;m aware of Mongoid, I just thought my problem was easy enough to use the native driver :p Thanks!"}, {"owner": {"reputation": 761, "user_id": 1214335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/334dd93f5dec5a64e9c69f6b6358bebe?s=128&d=identicon&r=PG", "display_name": "Rostyslav Diachok", "link": "https://stackoverflow.com/users/1214335/rostyslav-diachok"}, "reply_to_user": {"reputation": 4607, "user_id": 434171, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dXoTt.jpg?s=128&g=1", "display_name": "Enrique Marcos", "link": "https://stackoverflow.com/users/434171/enrique-marcos"}, "edited": false, "score": 0, "creation_date": 1434023523, "post_id": 30769527, "comment_id": 49609894, "body": "@enrmarc You are almost right. There was a problem in my solution. It was transforming <code>tiles</code> to array of strings. But now I modified it to return an array of hashes"}], "tags": [], "owner": {"reputation": 761, "user_id": 1214335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/334dd93f5dec5a64e9c69f6b6358bebe?s=128&d=identicon&r=PG", "display_name": "Rostyslav Diachok", "link": "https://stackoverflow.com/users/1214335/rostyslav-diachok"}, "is_accepted": true, "score": 2, "last_activity_date": 1434023365, "last_edit_date": 1434023365, "creation_date": 1433981920, "answer_id": 30769527, "question_id": 30769193, "link": "https://stackoverflow.com/questions/30769193/insert-an-array-of-ruby-objects-in-a-mongo-database/30769527#30769527", "title": "Insert an array of Ruby objects in a Mongo database", "body": "<p>You can simply transform @board.tiles from collection of <code>Objects</code> to collection of ruby <code>Hashes</code>:</p>\n\n<pre><code>class Tile\n  def initialize()\n    @x = 1, @y = 1\n  end\n  def raw_data\n    {\"x\" =&gt; @x, \"y\" =&gt; @y}\n  end\nend\n\ndb.insert_one({\n  'game_id' =&gt; @token,\n  'board' =&gt; {\n    'tiles' =&gt; @board.tiles.map(&amp;:raw_data)\n  }\n})\n</code></pre>\n\n<p>For more complex thing I recommend you to use mongoid <a href=\"http://mongoid.org/en/mongoid/\" rel=\"nofollow\">http://mongoid.org/en/mongoid/</a></p>\n"}], "owner": {"reputation": 4607, "user_id": 434171, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/dXoTt.jpg?s=128&g=1", "display_name": "Enrique Marcos", "link": "https://stackoverflow.com/users/434171/enrique-marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1101, "favorite_count": 0, "accepted_answer_id": 30769527, "answer_count": 1, "score": 0, "last_activity_date": 1434023365, "creation_date": 1433979855, "question_id": 30769193, "link": "https://stackoverflow.com/questions/30769193/insert-an-array-of-ruby-objects-in-a-mongo-database", "title": "Insert an array of Ruby objects in a Mongo database", "body": "<p>So, I'm using the Ruby MongoDB driver and I want to insert and object like this:</p>\n\n<pre><code> db.insert_one({\n  'game_id' =&gt; @token,\n  'board' =&gt; {\n    'tiles' =&gt; @board.tiles\n  }\n})\n</code></pre>\n\n<p>where @board is an instance of a Board class.</p>\n\n<pre><code>class Board\n attr_accessor :tiles\n  def initialize()\n    @tiles = [Tile.new, Tile.new]\n  end\nend\n</code></pre>\n\n<p>and Tile</p>\n\n<pre><code>class Tile\n  def initialize()\n    @x = 1, @y = 1\n  end\n  def to_json(options)\n    {\"x\" =&gt; @x, \"y\" =&gt;\u00a0@y}.to_json\n  end\nend\n</code></pre>\n\n<p>So at the end, 'tiles' field should look like this:</p>\n\n<pre><code>'tiles': [{x:1, y:1}, {x:1, y:1}]\n</code></pre>\n\n<p>I'm getting this error: </p>\n\n<pre><code>undefined method `bson_type' for #&lt;Tile:0x007ff7148d2440&gt;\n</code></pre>\n\n<p>The gems I'm using: 'sinatra', 'mongo (2.0.4)' and 'bson_ext' (all required using Bundler.require). Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "edited": false, "score": 0, "creation_date": 1433980223, "post_id": 30769073, "comment_id": 49590472, "body": "What does the schema look like for <code>Store</code>?"}, {"owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "reply_to_user": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "edited": false, "score": 0, "creation_date": 1433980355, "post_id": 30769073, "comment_id": 49590508, "body": "It has a <code>name:string</code>, and <code>open:boolean</code>, and id."}, {"owner": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "edited": false, "score": 0, "creation_date": 1433980603, "post_id": 30769073, "comment_id": 49590574, "body": "Can you have many open stores?"}, {"owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "reply_to_user": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "edited": false, "score": 0, "creation_date": 1433980727, "post_id": 30769073, "comment_id": 49590603, "body": "@locoboy, Yes there can be many open stores at a time"}], "answers": [{"comments": [{"owner": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "edited": false, "score": 0, "creation_date": 1433980758, "post_id": 30769296, "comment_id": 49590612, "body": "gah beat me to it :P. Also needs to be <code>joins</code> not <code>join</code> ;)"}], "tags": [], "owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "is_accepted": true, "score": 2, "last_activity_date": 1434056077, "last_edit_date": 1434056077, "creation_date": 1433980434, "answer_id": 30769296, "question_id": 30769073, "link": "https://stackoverflow.com/questions/30769073/has-many-and-no-method-error-issue/30769296#30769296", "title": "has_many and No method error issue", "body": "<p>Not a very easy thing to do - <code>products</code> is a method defined on an instance of <code>Store</code> and you are calling it on the relation. I would probably go with:</p>\n\n<pre><code>Product.where(store_id: Store.where(open:true).pluck(:id)).where(\"created_at &lt;= ?\", 1.month.ago)\n</code></pre>\n\n<p>which would generate two db calls, but also returns a clean and easy to query scope. Another approach would be to use join:</p>\n\n<pre><code>Product.joins(:store).where(store: { open: true }).where(\"created_at &lt;= ?\", 1.month.ago)\n</code></pre>\n\n<p>This will do the work with one query, but due to the join it won't be that easy to manipulate the resulting scope that easily.</p>\n"}, {"tags": [], "owner": {"reputation": 34778, "user_id": 382906, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c054847fb6fd89d40f3f4ad44d6daaf1?s=128&d=identicon&r=PG", "display_name": "locoboy", "link": "https://stackoverflow.com/users/382906/locoboy"}, "is_accepted": false, "score": 2, "last_activity_date": 1433980741, "creation_date": 1433980741, "answer_id": 30769349, "question_id": 30769073, "link": "https://stackoverflow.com/questions/30769073/has-many-and-no-method-error-issue/30769349#30769349", "title": "has_many and No method error issue", "body": "<p>You have it backwards. Since you can have many stores, Rails will not return all the products where <code>open: true</code>. </p>\n\n<p>You need to join and lookup the products where the store is open. </p>\n\n<pre><code>Product.joins(:store).where(store: {open: true}).where(\"created_at &lt;= ?\", 1.month.ago)\n</code></pre>\n"}], "owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 30769296, "answer_count": 2, "score": 0, "last_activity_date": 1434056077, "creation_date": 1433979082, "last_edit_date": 1433979568, "question_id": 30769073, "link": "https://stackoverflow.com/questions/30769073/has-many-and-no-method-error-issue", "title": "has_many and No method error issue", "body": "<p>I have two tables: Stores and products. The store model has a <code>has_many :products</code> and the products has a <code>belongs_to :store</code></p>\n\n<p>I'm trying to do this though in the rails console:</p>\n\n<pre><code>Store.where(open: true).products.where(\"created_at &lt;= ?\", 1.month.ago)\n</code></pre>\n\n<p>and get the error (paraphrased a bit): <code>NoMethodError: undefined method products for #&lt;Store</code></p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433979169, "post_id": 30769013, "comment_id": 49590170, "body": "Where is you jQuery AJAX call?"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "reply_to_user": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433979369, "post_id": 30769013, "comment_id": 49590229, "body": "@whitelettersandblankspaces I thought it gets passed through the HTTP request?"}, {"owner": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433979622, "post_id": 30769013, "comment_id": 49590291, "body": "what I mean is the part of the code that contains :<a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow noreferrer\">api.jquery.com/jquery.ajax</a>"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "reply_to_user": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433980437, "post_id": 30769013, "comment_id": 49590528, "body": "I have never seen this before, where is that supposed to go?"}, {"owner": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433980708, "post_id": 30769013, "comment_id": 49590601, "body": "That function is the jQuery function that is responsible of creating an AJAX call. If you really use jQuery for AJAX in your project, there is certainly a part of your code that contains that function. In the link i gave you, there is full explanation of this function parameters and by tuning them you can control AJAX. (For example, using <code>complete</code> help declaring the function to be called when the request finishes)"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433980985, "post_id": 30769013, "comment_id": 49590673, "body": "@whitelettersandblankspaces - form has remote option set to true - it will automatically make an AJAX request without any additional js code."}, {"owner": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433981198, "post_id": 30769013, "comment_id": 49590726, "body": "@BroiSatse,  but I feel we need to see the body of the success handler. Am  I wrong?"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433981388, "post_id": 30769013, "comment_id": 49590759, "body": "I believe the issue is with my link."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433981587, "post_id": 30769013, "comment_id": 49590796, "body": "@whitelettersandblankspaces - The server will respond with a javascript script which is to be called on the client-side on success. This is what is being built within <code>destroy.js.erb</code> file. :)"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433981679, "post_id": 30769013, "comment_id": 49590817, "body": "@JonathanMusso - do you see any errors in the console? Also check the network tab to see what has been returned by the server (it might be 500)"}, {"owner": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433981827, "post_id": 30769013, "comment_id": 49590855, "body": "I never used rubyon rails, but I feel OP should show us the code inside the second parameter of <code>link_to</code> so that we see the handler on complete.good night"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "reply_to_user": {"reputation": 4708, "user_id": 1276136, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1a14a725e82d65e1e655fcc84f2bc8ff?s=128&d=identicon&r=PG&f=1", "display_name": "Adib Aroui", "link": "https://stackoverflow.com/users/1276136/adib-aroui"}, "edited": false, "score": 0, "creation_date": 1433982432, "post_id": 30769013, "comment_id": 49591016, "body": "@whitelettersandblankspaces - second parameter is just an object and it is used to generate the url for the link. There really is no need for more code in rails to make successful AJAX calls."}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433982446, "post_id": 30769013, "comment_id": 49591020, "body": "@BroiSatse Rails trace everything is working fine. In chrome inspector no errors. I believe in my loop I have done something wrong, I should not use &#39;i&#39;."}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433982576, "post_id": 30769013, "comment_id": 49591053, "body": "@JonathanMusso - can you see the server response to the call in the network tab? My experience would be that it is not piggy-backing the method param correctly."}], "answers": [{"comments": [{"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433982701, "post_id": 30769502, "comment_id": 49591079, "body": "&#39;which is not good, since it means delete request gets resent on page refresh&#39; - agree for the html format, not for js. Flash is set automatically, and will be removed after the next request - it is available straight away though."}, {"owner": {"reputation": 481, "user_id": 4035867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9df68fbefedfd1086ad0ff30701b8afc?s=128&d=identicon&r=PG&f=1", "display_name": "AOG", "link": "https://stackoverflow.com/users/4035867/aog"}, "reply_to_user": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433982894, "post_id": 30769502, "comment_id": 49591120, "body": "yes, right, I completely missed the request being js before editing the answer. I guess the first part of my answer is moot now. Thanks!"}, {"owner": {"reputation": 39050, "user_id": 2336231, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/d7kOQ.jpg?s=128&g=1", "display_name": "BroiSatse", "link": "https://stackoverflow.com/users/2336231/broisatse"}, "edited": false, "score": 0, "creation_date": 1433983036, "post_id": 30769502, "comment_id": 49591159, "body": "Good spot in the edit - you need to use erb syntax though instead of interpolation."}], "tags": [], "owner": {"reputation": 481, "user_id": 4035867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9df68fbefedfd1086ad0ff30701b8afc?s=128&d=identicon&r=PG&f=1", "display_name": "AOG", "link": "https://stackoverflow.com/users/4035867/aog"}, "is_accepted": true, "score": 4, "last_activity_date": 1433983073, "last_edit_date": 1495541718, "creation_date": 1433981726, "answer_id": 30769502, "question_id": 30769013, "link": "https://stackoverflow.com/questions/30769013/why-does-my-rails-ajax-delete-method-only-work-if-i-refresh/30769502#30769502", "title": "Why does my Rails AJAX delete method only work if I refresh?", "body": "<p>Flash sets the message for the next request, this is why it works correctly in your create action (because you are redirecting). In your destroy action, you are rendering (which is not good, since it means delete request gets resent on page refresh, you should be redirecting here too) and setting flash, so it shows up on next request (refresh). If you want to send message for the response to the current request, you have to use <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#flash-now\" rel=\"nofollow noreferrer\">flash.now</a> :</p>\n\n<pre><code>flash.now[:notice] = \"\\\"#{@item.name}\\\" was ...\"\n</code></pre>\n\n<p>Again, you should use flash and redirect on success and use flash.now and render on request failure.</p>\n\n<p><strong>EDIT</strong>:</p>\n\n<p><strong><em>The above paragraphs only apply to html requests. I initially missed the point of the question!</em></strong> Thanks <a href=\"https://stackoverflow.com/users/2336231/broisatse\">BroiSatse</a></p>\n\n<p>Looking at your display code, you dont seem to be setting the <code>\"#item-@item.id\"</code>, so your return js does nothing. Add it like this:</p>\n\n<pre><code>&lt;p id=\"item-&lt;%= i.id %&gt;\"&gt;&lt;%= i.name %&gt; | ...\n</code></pre>\n"}], "owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 2, "accepted_answer_id": 30769502, "answer_count": 1, "score": 1, "last_activity_date": 1433983073, "creation_date": 1433978680, "question_id": 30769013, "link": "https://stackoverflow.com/questions/30769013/why-does-my-rails-ajax-delete-method-only-work-if-i-refresh", "title": "Why does my Rails AJAX delete method only work if I refresh?", "body": "<p>I just incorporated the DESTROY method for items in my school project. It worked fine, but now I must use AJAX to complete the action. After implementing this code, it only displays on the browser when I refresh the page, and not instantly when I delete an item. If I did not include enough information please let me know.</p>\n\n<p><strong>_item.html.erb</strong></p>\n\n<pre><code>&lt;% item.each do |i| %&gt;\n  &lt;p&gt;&lt;%= i.name %&gt; | &lt;%= link_to \"Complete\", i, method: :delete, remote: true, class: 'glyphicon glyphicon-ok' %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>destroy.js.erb</strong></p>\n\n<pre><code>&lt;% if @item.destroyed? %&gt;\n  $('#item-' +&lt;%= @item.id %&gt;).hide();\n&lt;% else %&gt;\n  $('#item-' +&lt;%= @item.id %&gt;).prepend(\"&lt;%= flash[:error] %&gt;\");\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>items_controller.rb</strong></p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n  def index\n    @items = Item.all\n  end\n\n  def show\n    @item = Item.find(params[:id])\n  end\n\n  def new\n    @item = Item.new\n  end\n\n  def edit\n    @item = Item.find(params[:id])\n  end\n\n  def create\n    @item = Item.new(params.require(:item).permit(:name))\n\n    if @item.save\n      flash[:notice] = \"The item was added to your list.\"\n      redirect_to current_user\n    else\n      flash[:error] = \"There was a problem creating your item.\"\n      redirect_to current_user\n    end\n  end\n\n  def destroy\n    @item = Item.find(params[:id])\n\n    if @item.destroy\n      flash[:notice] = \"\\\"#{@item.name}\\\" was completed and destroyed.\"\n    else\n      flash[:error] = \"There was an error completing the item.\"\n    end\n\n    respond_to do |format|\n      format.html\n      format.js\n    end\n\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1433978461, "post_id": 30768900, "comment_id": 49589946, "body": "<a href=\"http://stackoverflow.com/questions/827649/what-is-the-ruby-spaceship-operator\" title=\"what is the ruby spaceship operator\">stackoverflow.com/questions/827649/&hellip;</a>"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 1, "creation_date": 1433980688, "post_id": 30768900, "comment_id": 49590597, "body": "See the 2nd answer in the link provided by @AndreyDeineko.  By implementing <code>&lt;=&gt;</code> and including the <code>Comparable</code> module you get all sorts of nice stuff."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1433982517, "post_id": 30768900, "comment_id": 49591033, "body": "@pjs, answers to SO questions don&#39;t respond to <code>&lt;=&gt;</code>, insofar as order of appearance is concerned. :-)"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433987273, "post_id": 30768900, "comment_id": 49592164, "body": "@CarySwoveland Should have said 2nd most popular..."}], "answers": [{"tags": [], "owner": {"reputation": 1125, "user_id": 3354209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddRMd.png?s=128&g=1", "display_name": "yossarian", "link": "https://stackoverflow.com/users/3354209/yossarian"}, "is_accepted": false, "score": -1, "last_activity_date": 1433978806, "last_edit_date": 1592644375, "creation_date": 1433978806, "answer_id": 30769025, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator/30769025#30769025", "title": "Why do we need spaceship operator?", "body": "<p>The &quot;spaceship&quot; operator is for <strong>comparison</strong>, not <strong>equality</strong>. It's similar in concept to C's <a href=\"http://www.cplusplus.com/reference/cstring/strcmp/\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> function.</p>\n<p>From the <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\"><code>String</code></a> class:</p>\n<blockquote>\n<p><code>string &lt;=&gt; other_string</code> \u2192 -1, 0, +1 or nil</p>\n<p>Comparison \u2014 Returns -1, 0, +1 or nil depending on whether string is less than, equal to, or greater than other_string.</p>\n</blockquote>\n<p>In short, <code>==</code> returns a boolean expressing equality, while <code>&lt;=&gt;</code> returns a number expressing comparative value. If the first object is of greater value than the second, <code>&lt;=&gt;</code> returns <code>+1</code>. If it's of lesser value, <code>-1</code> is returned. If the two have the same value, <code>0</code> is returned.</p>\n<p>The &quot;value&quot; of an object can be defined to be just about anything. For <code>String</code>, however, <code>&lt;=&gt;</code> checks the <a href=\"https://en.wikipedia.org/wiki/Lexicographical_order/\" rel=\"nofollow noreferrer\">lexicographic ordering</a> of the two arguments.</p>\n<p>Therefore:</p>\n<pre><code>&quot;abc&quot; == &quot;abc&quot; # true\n(&quot;abc&quot; &lt;=&gt; &quot;abc&quot;) == 0 # true\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433982182, "post_id": 30769210, "comment_id": 49590956, "body": "I don&#39;t understand your point. We certainly need the method <code>&lt;=&gt;</code> as other built-in methods rely on it. And yes, the result of <code>&lt;=&gt;</code> could be obtained in other ways, but the same could be said about nearly all built-in methods."}, {"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433982813, "post_id": 30769210, "comment_id": 49591102, "body": "@CarySwoveland I see your point. The way I understood the question, OP was confused about what <code>&lt;=&gt;</code> did. To me it seemed like he was under the impression that &lt;=&gt; let you do something you could&#39;t do with <code>&lt;</code>,<code>&gt;</code>, and <code>=</code>. That was the premise under which I chose my wording."}, {"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433982931, "post_id": 30769210, "comment_id": 49591133, "body": "@CarySwoveland I mean&#39;t &quot;don&#39;t need&quot; the same way we &quot;don&#39;t need&quot; <code>or</code> because we have <code>not</code> + <code>and</code>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433983603, "post_id": 30769210, "comment_id": 49591293, "body": "@CarySwoveland I think LukeP means &quot;we don&#39;t need [to explicitly define] <code>&lt;=&gt;</code> [given that <code>&lt;</code>, <code>==</code>, and <code>&gt;</code> are defined].&quot;"}], "tags": [], "owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "is_accepted": false, "score": 1, "last_activity_date": 1433979936, "creation_date": 1433979936, "answer_id": 30769210, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator/30769210#30769210", "title": "Why do we need spaceship operator?", "body": "<p>we <strong>Don't</strong> need <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-3C-3D-3E\" rel=\"nofollow\"><code>&lt;=&gt;</code></a>.</p>\n\n<pre><code>a&lt;=&gt;b\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>if a&lt;b\n  return -1\nelsif a&gt;b \n  return 1\nelse\n  return 0\nend\n</code></pre>\n\n<p>It is there for convenience and it was taken from perl.</p>\n"}, {"tags": [], "owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "is_accepted": false, "score": -1, "last_activity_date": 1433983906, "last_edit_date": 1433983906, "creation_date": 1433980796, "answer_id": 30769361, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator/30769361#30769361", "title": "Why do we need spaceship operator?", "body": "<p>This operator is sometimes called a \"signum\" function. It provides the most concise way to customize sort order. For example:</p>\n\n<pre><code>require \"ostruct\"\n\n# Fake \"rows\" with OpenStructs\nmy_data = [\n    OpenStruct.new({ :name =&gt; \"Ben\", :age =&gt; 50 }),\n    OpenStruct.new({ :name =&gt; \"Abe\", :age =&gt; 50 }),\n    OpenStruct.new({ :name =&gt; \"Cab\", :age =&gt; 51 })\n]\n\n# Sort by age descending, then name ascending\nputs my_data.sort { |a, b| 2 * (b.age &lt;=&gt; a.age) + (a.name &lt;=&gt; b.name) }\n</code></pre>\n\n<p>This works because the value from <code>&lt;=&gt;</code> is always -1, 0, or 1. I don't know of a more efficient way to do general-purpose sorting.</p>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": -1, "last_activity_date": 1433980877, "creation_date": 1433980877, "answer_id": 30769373, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator/30769373#30769373", "title": "Why do we need spaceship operator?", "body": "<p>You are correct that there is redundancy between <code>&lt;</code>, <code>==</code>, <code>&gt;</code> and <code>&lt;=&gt;</code>. In fact, when <code>&lt;</code>, <code>==</code>, <code>&gt;</code> are defined, <code>&lt;=&gt;</code> is automatically defined.</p>\n"}, {"tags": [], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1433981705, "creation_date": 1433981705, "answer_id": 30769499, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator/30769499#30769499", "title": "Why do we need spaceship operator?", "body": "<p><code>&lt;=&gt;</code> is the basis of <a href=\"http://ruby-doc.org/core-2.2.0/Comparable.html\" rel=\"nofollow\">Comparable</a>, so you don't have to implement all of the compare functions yourself. It's easier and less error-prone to just implement one function instead of three.</p>\n"}], "owner": {"reputation": 21398, "user_id": 1136700, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/e484894210178f84679e4e35695ff8ac?s=128&d=identicon&r=PG", "display_name": "Adam Lee", "link": "https://stackoverflow.com/users/1136700/adam-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "closed_date": 1433994728, "answer_count": 5, "score": 1, "last_activity_date": 1433983906, "creation_date": 1433978027, "last_edit_date": 1433980466, "question_id": 30768900, "link": "https://stackoverflow.com/questions/30768900/why-do-we-need-spaceship-operator", "closed_reason": "Duplicate", "title": "Why do we need spaceship operator?", "body": "<p>If we have <code>&lt;</code>, <code>&gt;</code>, and <code>==</code>, the total order is determined by those. Why do we need <code>&lt;=&gt;</code>?</p>\n"}, {"tags": ["ruby", "github-archive"], "comments": [{"owner": {"reputation": 197, "user_id": 3188943, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22bf7660c8ae7e7e5daa19f708f7f15e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Kwong", "link": "https://stackoverflow.com/users/3188943/andy-kwong"}, "edited": false, "score": 0, "creation_date": 1434055591, "post_id": 30768876, "comment_id": 49631801, "body": "This question has been answered on another page. <a href=\"http://stackoverflow.com/questions/30789924/url-encoding-issues-with-curly-braces&#39;\">Link to Answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 3188943, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22bf7660c8ae7e7e5daa19f708f7f15e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Kwong", "link": "https://stackoverflow.com/users/3188943/andy-kwong"}, "edited": false, "score": 0, "creation_date": 1433978989, "post_id": 30768934, "comment_id": 49590109, "body": "Uncommented uri = URI.encode(url) and it&#39;s getting a 404 error now."}], "tags": [], "owner": {"reputation": 11, "user_id": 4997023, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/62087b6332e6bf2b6aa0b121249fc87a?s=128&d=identicon&r=PG", "display_name": "user4997023", "link": "https://stackoverflow.com/users/4997023/user4997023"}, "is_accepted": false, "score": 1, "last_activity_date": 1433978196, "creation_date": 1433978196, "answer_id": 30768934, "question_id": 30768876, "link": "https://stackoverflow.com/questions/30768876/github-archive-issues-with-retrieving-data-with-ranges/30768934#30768934", "title": "GitHub Archive - Issues with retrieving data with ranges", "body": "<p>I believe brackets are not allowed in URL, so maybe you should try urlencoding it?</p>\n"}], "owner": {"reputation": 197, "user_id": 3188943, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/22bf7660c8ae7e7e5daa19f708f7f15e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Kwong", "link": "https://stackoverflow.com/users/3188943/andy-kwong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1434132644, "creation_date": 1433977877, "last_edit_date": 1434132644, "question_id": 30768876, "link": "https://stackoverflow.com/questions/30768876/github-archive-issues-with-retrieving-data-with-ranges", "title": "GitHub Archive - Issues with retrieving data with ranges", "body": "<p>I am trying to retrieve data from [GitHub Archive]: <a href=\"https://www.githubarchive.org/\" rel=\"nofollow\">https://www.githubarchive.org/</a> and is having trouble retrieving data when I add a range. It works when I use <a href=\"http://data.githubarchive.org/2015-01-01-15.json.gz\" rel=\"nofollow\">http://data.githubarchive.org/2015-01-01-15.json.gz</a>, but getting a `open_http': 404 Not Found (OpenURI::HTTPError) message when using <a href=\"http://data.githubarchive.org/2015-01-01-\" rel=\"nofollow\">http://data.githubarchive.org/2015-01-01-</a>{0..23}.json.gz.</p>\n\n<p>Using curl <a href=\"http://data.githubarchive.org/2015-01-01-\" rel=\"nofollow\">http://data.githubarchive.org/2015-01-01-</a>{0..23}.json.gz seems to be working. </p>\n\n<p>Basically, my goal is to write a program to retrieve the top 42 most active repositories over a certain time range.</p>\n\n<p>Here's my code, please let me know I'm using the API incorrectly or code issues.</p>\n\n<pre><code>require 'open-uri'\nrequire 'zlib'\nrequire 'yajl'\nrequire 'pry'\nrequire 'date'\n\nevents = Hash.new(0)\ntype = 'PushEvent'\n\nafter = '2015-01-01T13:00:00Z'\nbefore = '2015-01-02T03:12:14-03:00'\nf_after_time = DateTime.parse(after).strftime('%Y-%m-%d-%H')\nf_after_time = DateTime.parse(before).strftime('%Y-%m-%d-%H')\n\nbase = 'http://data.githubarchive.org/'\n# query = '2015-01-01-15.json.gz'\nquery = '2015-01-01-{0..23}.json.gz'\nurl = base + query\nuri = URI.encode(url)\ngz = open(uri)\njs = Zlib::GzipReader.new(gz).read\n\nYajl::Parser.parse(js) do |event|\n  if event['type'] == type\n    if event['repository']\n      repo_name = event['repository']['url'].gsub('https://github.com/', '')\n      events[repo_name] +=1\n    elsif event['repo'] #to account for older api\n      repo_name = event['repo']['url'].gsub('https://github.com/', '')\n      events[repo_name] +=1\n    end\n  end\nend\n\n# Sort events based on # of events and return top 42 repos\nsorted_events = events.sort_by {|_key, value| value}.reverse.first(42)\n\nsorted_events.each { |e| puts \"#{e[0]} - #{e[1]} events\" }\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "image"], "comments": [{"owner": {"reputation": 4533, "user_id": 1095101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l04Lp.jpg?s=128&g=1", "display_name": "aze&#243;s", "link": "https://stackoverflow.com/users/1095101/aze%c3%b3s"}, "edited": false, "score": 0, "creation_date": 1433996744, "post_id": 30768576, "comment_id": 49594380, "body": "What language are you using? Please add it as a tag."}, {"owner": {"reputation": 2577, "user_id": 4808760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80b515f16a4318101aa19c7c2cbd5098?s=128&d=identicon&r=PG&f=1", "display_name": "666", "link": "https://stackoverflow.com/users/4808760/666"}, "edited": false, "score": 0, "creation_date": 1433997491, "post_id": 30768576, "comment_id": 49594607, "body": "what do u mean by image_tag?"}, {"owner": {"reputation": 8678, "user_id": 4381665, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/tu4EZ.jpg?s=128&g=1", "display_name": "Alexander Solonik", "link": "https://stackoverflow.com/users/4381665/alexander-solonik"}, "edited": false, "score": 0, "creation_date": 1433998374, "post_id": 30768576, "comment_id": 49594864, "body": "@nour Why would you want to add a src attribute to a <code>div</code> ??"}], "answers": [{"tags": [], "owner": {"reputation": 8678, "user_id": 4381665, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/tu4EZ.jpg?s=128&g=1", "display_name": "Alexander Solonik", "link": "https://stackoverflow.com/users/4381665/alexander-solonik"}, "is_accepted": false, "score": 0, "last_activity_date": 1433998269, "creation_date": 1433998269, "answer_id": 30771819, "question_id": 30768576, "link": "https://stackoverflow.com/questions/30768576/change-div-data-src-to-image-tag/30771819#30771819", "title": "change div data-src to image_tag", "body": "<p>you can have a html structure like below : </p>\n\n<pre><code>&lt;img src=\"add the gif image\" data-src=\"add the actual image you want loaded\"&gt;\n</code></pre>\n\n<p>and then add some fancy JS code like below : </p>\n\n<pre><code>$(function () {\n\n    str_src = $('img').data('src');\n\n    console.log(str_src);\n    var source = $('img').attr('data-src');\n    console.log(source);\n\n    if (source) {\n        setTimeout(function(){\n              $('img').attr(\"src\", source);    \n        },2000);    \n    };\n\n});\n</code></pre>\n\n<p><strong><a href=\"http://jsfiddle.net/5mv66sf4/3/\" rel=\"nofollow\">FIDDLE HERE .</a></strong></p>\n"}], "owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1267, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434063358, "creation_date": 1433976235, "last_edit_date": 1434063358, "question_id": 30768576, "link": "https://stackoverflow.com/questions/30768576/change-div-data-src-to-image-tag", "title": "change div data-src to image_tag", "body": "<p>How do I change div data-src to image_tag?</p>\n\n<pre>div data-src=\"images/index_slide01.jpg\"></pre>\n\n<p>I tried this :</p>\n\n<pre>%= image_tag \"index_slide01.jpg\", data: { src: \"index_slide01\"} %></pre> \n\n<p>But it's not working.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "performance"], "answers": [{"comments": [{"owner": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1433977395, "post_id": 30768692, "comment_id": 49589608, "body": "Hey @caspg thanks for your answer. Why the collect instead of pluck?"}, {"owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "reply_to_user": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1433977503, "post_id": 30768692, "comment_id": 49589648, "body": "<code>pluck</code> is a  shortcut to select one or more attributes, but it query a db, and <code>collect</code> is just a ruby method <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#collect-method\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1433977637, "post_id": 30768692, "comment_id": 49589696, "body": "Nice one mate, makes sense. Let me try it out."}, {"owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "reply_to_user": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1433977692, "post_id": 30768692, "comment_id": 49589712, "body": "Now we grab all necessary ecommerce records just once, then assign them to variable, and we can manipulate with this variable without touching database."}, {"owner": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1434082803, "post_id": 30768692, "comment_id": 49639664, "body": "Works well mate. What kind of performance difference do you think it&#39;ll make?"}, {"owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "reply_to_user": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "edited": false, "score": 0, "creation_date": 1434095533, "post_id": 30768692, "comment_id": 49644730, "body": "I&#39;m not sure what do you mean, but I think it depends on size of your db."}], "tags": [], "owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "is_accepted": true, "score": 0, "last_activity_date": 1433976820, "creation_date": 1433976820, "answer_id": 30768692, "question_id": 30768514, "link": "https://stackoverflow.com/questions/30768514/slow-performance-from-rake-task-how-to-streamline-these-rails-queries/30768692#30768692", "title": "Slow performance from rake task - How to streamline these Rails queries", "body": "<p>this should help a little:</p>\n\n<pre><code>ecommerce_array =  Ecommerce.where(legacy_id: legacy_id, company: company)\nif ecommerce_array.any?\n  historical_interest = ecommerce_array.pluck(:interest)\n  return unless interest == historical_interest\n  ecommerce_array.update_all(....)\nelse\n  #....\n</code></pre>\n\n<p>EDIT:\nchange this <code>historical_interest = ecommerce_array.pluck(:interest)</code> into this <code>historical_interest = ecommerce_array.collect(&amp;:interest)</code></p>\n"}], "owner": {"reputation": 1704, "user_id": 3900606, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c302f96e748480965d4190fcff8e347b?s=128&d=identicon&r=PG&f=1", "display_name": "bnussey", "link": "https://stackoverflow.com/users/3900606/bnussey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 30768692, "answer_count": 1, "score": 0, "last_activity_date": 1433976820, "creation_date": 1433975913, "question_id": 30768514, "link": "https://stackoverflow.com/questions/30768514/slow-performance-from-rake-task-how-to-streamline-these-rails-queries", "title": "Slow performance from rake task - How to streamline these Rails queries", "body": "<p>I am experiencing slow performance on a rake task. Upon review, it looks like the same item is being queried 3 times. Is there a way to simplify this so only one query is executed? Would this have a significant performance improvement? Would love to hear your ideas. </p>\n\n<p>Here's a breakdown...</p>\n\n<p>So I check if it exists:</p>\n\n<pre><code>if Ecommerce.exists?(:legacy_id =&gt; legacy_id, :company =&gt; company)\n</code></pre>\n\n<p>Then the same item is queried again to pluck a value needed:</p>\n\n<pre><code>  historical_interest = Ecommerce.where(:legacy_id =&gt; legacy_id, :company =&gt; company).pluck(:interest)\n</code></pre>\n\n<p>Then if the plucked value is different, the record is updated:</p>\n\n<pre><code>  if interest != historical_interest\n    Ecommerce.where(:legacy_id =&gt; legacy_id, :company =&gt; company).update_all(:interest =&gt; interest, :end_date =&gt; end_date, :revenue =&gt; revenue)\n  end\nelse\n#other stuff\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>if Ecommerce.exists?(:legacy_id =&gt; legacy_id, :company =&gt; company)\n  # It exists.\n  historical_interest = Ecommerce.where(:legacy_id =&gt; legacy_id, :company =&gt; company).pluck(:interest)       \n  # Another statement to check that the Interest != UnitSold\n  if interest != historical_interest\n    Ecommerce.where(:legacy_id =&gt; legacy_id, :company =&gt; company).update_all(:interest =&gt; interest, :end_date =&gt; end_date, :revenue =&gt; revenue)\n  end\nelse\n#other stuff\n</code></pre>\n"}, {"tags": ["ruby", "variable-assignment"], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 2877322, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/kOvqY.jpg?s=128&g=1", "display_name": "thesowismine", "link": "https://stackoverflow.com/users/2877322/thesowismine"}, "edited": false, "score": 0, "creation_date": 1433975584, "post_id": 30768410, "comment_id": 49588977, "body": "Yea thats what i thought, I guess im just confused by the layout of the function.  Could you possibly explain what exactly the if is asking? I see the &amp;&amp;, but it seems like theres more than that?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433976286, "post_id": 30768410, "comment_id": 49589212, "body": "The first <code>if</code> is equivalent to <code>data = ...</code> followed by <code>if data; user.email = ...</code>."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1433976142, "last_edit_date": 1433976142, "creation_date": 1433975357, "answer_id": 30768410, "question_id": 30768362, "link": "https://stackoverflow.com/questions/30768362/why-does-single-work-in-if-statement/30768410#30768410", "title": "Why does single `=` work in `if` statement?", "body": "<p>In Ruby, a single equals sign is used for <em>assignment</em>. The expression </p>\n\n<pre><code>data = session[\"devise.facebook_data\"]\n</code></pre>\n\n<p>assigns the result of evaluating <code>session[\"devise.facebook_data\"]</code> to a local variable named <code>data</code>.</p>\n\n<p>If the <code>session</code> hash doesn't have a <code>\"devise.facebook_data\"</code> key, it will return <code>nil</code> and <code>data</code> will be assigned <code>nil</code>. Assignments evaluate to the value being assigned, so the assignment will evaluate to <code>nil</code> as well. <code>nil</code> is considered falsey in a boolean context, so the right operand of the <code>&amp;&amp;</code> will not be evaluated. That way, you won't get a <code>NoMethodError</code> trying to call <code>nil[\"extra\"][\"raw_info\"]</code>.</p>\n\n<p>If the <code>session</code> hash <em>does</em> have a <code>\"devise.facebook_data\"</code> key, <code>data</code> will be set to the value associated with it. Any value other than <code>nil</code> and <code>false</code> is considered truthy, therefore the right-hand operand of the <code>&amp;&amp;</code> operator will be evaluated.</p>\n\n<p>If the condition is truthy, the <code>then</code> clause will be evaluated, which uses the <code>data</code> variable assigned in the condition.</p>\n\n<hr>\n\n<p>Note: I believe one could also use the <code>data</code> variable within the right-hand side of the <code>&amp;&amp;</code> operator, i.e. the condition could read like this instead:</p>\n\n<pre><code>if data = session[\"devise.facebook_data\"] &amp;&amp; data[\"extra\"][\"raw_info\"]\n</code></pre>\n\n<p>But I'll have to check that.</p>\n"}, {"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1433975425, "creation_date": 1433975425, "answer_id": 30768425, "question_id": 30768362, "link": "https://stackoverflow.com/questions/30768362/why-does-single-work-in-if-statement/30768425#30768425", "title": "Why does single `=` work in `if` statement?", "body": "<p>A assignment operator (<code>=</code>) returns the assigned value, which is then evaluated by the <code>if</code>. In ruby, only <code>false</code> and <code>nil</code> are considered as <code>false</code>. Everything else evaluates to <code>true</code> in a boolean context (like an <code>if</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1433981469, "post_id": 30768457, "comment_id": 49590767, "body": "Actually, whether or not a value is falesy or not <b>is determined by its type (class)</b>, i.e., if it is an instance of <code>NilClass</code> or <code>FalseClass</code>, then it is falesy."}], "tags": [], "owner": {"reputation": 2781, "user_id": 199791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d23f681084f2cd1f490866ad94774e?s=128&d=identicon&r=PG", "display_name": "Julien Portalier", "link": "https://stackoverflow.com/users/199791/julien-portalier"}, "is_accepted": false, "score": 0, "last_activity_date": 1433975608, "creation_date": 1433975608, "answer_id": 30768457, "question_id": 30768362, "link": "https://stackoverflow.com/questions/30768362/why-does-single-work-in-if-statement/30768457#30768457", "title": "Why does single `=` work in `if` statement?", "body": "<p>Ruby doesn't care about types in conditionals, unlike Java. As long as the value is neither nil or false then it will pass.</p>\n\n<p>In your example you actually discriminate against nil: the if conditionnal ensures that data actually exists and isn't nil, so we can use it, assuming it's a hash. This is a common pattern in Ruby.</p>\n"}, {"comments": [{"owner": {"reputation": 742, "user_id": 2877322, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/kOvqY.jpg?s=128&g=1", "display_name": "thesowismine", "link": "https://stackoverflow.com/users/2877322/thesowismine"}, "edited": false, "score": 0, "creation_date": 1433976091, "post_id": 30768481, "comment_id": 49589142, "body": "Thanks!! Makes sense now, you explained that perfectly."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1433981290, "post_id": 30768481, "comment_id": 49590743, "body": "Not sure what you mean by &quot;necessary thing ... to be valid is a boolean expression.&quot; Any object can appear after <code>if</code>. Is there any &quot;non-boolean&quot; object that you have in mind that would make an <code>if</code> condition illegal?"}, {"owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1433981361, "post_id": 30768481, "comment_id": 49590752, "body": "@sawa When I&#39;m near a machine I can revise that part."}], "tags": [], "owner": {"reputation": 95978, "user_id": 1079354, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17dd9cf3e2322be19639e96da9f3eb3?s=128&d=identicon&r=PG", "display_name": "Makoto", "link": "https://stackoverflow.com/users/1079354/makoto"}, "is_accepted": true, "score": 7, "last_activity_date": 1433975767, "creation_date": 1433975767, "answer_id": 30768481, "question_id": 30768362, "link": "https://stackoverflow.com/questions/30768362/why-does-single-work-in-if-statement/30768481#30768481", "title": "Why does single `=` work in `if` statement?", "body": "<p>The only necessary thing for an <code>if</code> statement to be valid is a boolean expression.  In this case, since <code>=</code> returns the result of the assignment, what's actually being tested is the falsiness of <code>session[\"devise.facebook_data\"]</code>.</p>\n\n<p>IntelliJ has a good point to lodge a complaint about code like this, as it's difficult to read without knowing a thing or two about Ruby.  A recommendation would be to move that to an explicit assignment statement instead.  This has the added benefit of DRYing up a reference to it twice.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      data = session[\"devise.facebook_data\"]\n      if data &amp;&amp; data[\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 742, "user_id": 2877322, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/kOvqY.jpg?s=128&g=1", "display_name": "thesowismine", "link": "https://stackoverflow.com/users/2877322/thesowismine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 30768481, "answer_count": 4, "score": 7, "last_activity_date": 1433981203, "creation_date": 1433975121, "last_edit_date": 1433981203, "question_id": 30768362, "link": "https://stackoverflow.com/questions/30768362/why-does-single-work-in-if-statement", "title": "Why does single `=` work in `if` statement?", "body": "<p>This code is provided as an example in for use with devise and OmniAuth, it works in <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth:-Overview\" rel=\"nofollow\">my project</a>.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      if data = session[\"devise.facebook_data\"] &amp;&amp; session[\"devise.facebook_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I don't know why it's a single equals sign as apposed to a double equals sign, which I thought was necessary for <code>if</code>-statements. My IDE \"intelliJ IDEA\" agrees with my concerns.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "transactions", "controller", "rescue"], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 2118999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4f02d8edfacb99ee6b70a1efafe4d875?s=128&d=identicon&r=PG", "display_name": "MDekker", "link": "https://stackoverflow.com/users/2118999/mdekker"}, "edited": false, "score": 0, "creation_date": 1434009242, "post_id": 30768545, "comment_id": 49600196, "body": "Thanks! As I understand  I better wrap all the code in the transaction block in a single method inside my model and call that method from inside my controller so that there is only one call left in my update controller. Am I correct?"}, {"owner": {"reputation": 2781, "user_id": 199791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d23f681084f2cd1f490866ad94774e?s=128&d=identicon&r=PG", "display_name": "Julien Portalier", "link": "https://stackoverflow.com/users/199791/julien-portalier"}, "reply_to_user": {"reputation": 413, "user_id": 2118999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4f02d8edfacb99ee6b70a1efafe4d875?s=128&d=identicon&r=PG", "display_name": "MDekker", "link": "https://stackoverflow.com/users/2118999/mdekker"}, "edited": false, "score": 1, "creation_date": 1434016668, "post_id": 30768545, "comment_id": 49605160, "body": "Notre necessarily a single method, there might be multiple methods, each doing different actions. That depends on your model design."}, {"owner": {"reputation": 3950, "user_id": 319302, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/19774763833bc515bdb35787c4234fa7?s=128&d=identicon&r=PG", "display_name": "Cagatay Kalan", "link": "https://stackoverflow.com/users/319302/cagatay-kalan"}, "edited": false, "score": 8, "creation_date": 1486563916, "post_id": 30768545, "comment_id": 71399913, "body": "No. Controller is the best place to begin/end the transaction because transactions must be kept out of the business logic. Normally transactions are handled by the service layer or in languages like .NET or Java, they are usually handled by interceptors at the service or controller layer. Since in Rails, controllers (by convention) take the role of the service layer, controller is the best place to wrap a single unit of work within a transaction ( if you don&#39;t have a separate service layer)"}], "tags": [], "owner": {"reputation": 2781, "user_id": 199791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d23f681084f2cd1f490866ad94774e?s=128&d=identicon&r=PG", "display_name": "Julien Portalier", "link": "https://stackoverflow.com/users/199791/julien-portalier"}, "is_accepted": false, "score": 4, "last_activity_date": 1433976111, "creation_date": 1433976111, "answer_id": 30768545, "question_id": 30768344, "link": "https://stackoverflow.com/questions/30768344/using-transaction-in-ruby-on-rails-controller-method/30768545#30768545", "title": "Using transaction in Ruby On Rails controller method", "body": "<p>Transactions should be kept at the model level as much as possible, since they are related to the model, not to the logic. A transaction in a controller is like a SQL request in a controller: it feels out of place.</p>\n\n<p>That being said, there is nothing wrong with your solution, but maybe having methods on your models (or a service layer) would help keep things clean in your controller? Methods like <code>User#update_x_and_create_coupon</code> and <code>User#update_x_and_create_history_item</code> for example.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4989046, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VJH0lF1Wk0A/AAAAAAAAAAI/AAAAAAAAADs/pFs2H-vedC8/photo.jpg?sz=128", "display_name": "Archie Reyes", "link": "https://stackoverflow.com/users/4989046/archie-reyes"}, "is_accepted": false, "score": 1, "last_activity_date": 1434010852, "creation_date": 1434010852, "answer_id": 30775337, "question_id": 30768344, "link": "https://stackoverflow.com/questions/30768344/using-transaction-in-ruby-on-rails-controller-method/30775337#30775337", "title": "Using transaction in Ruby On Rails controller method", "body": "<p>You can use <code>Transaction</code> in your controller if you want to,but it's a bad practice, but if you want to do it, just wrap it with <code>User.transaction do</code>.</p>\n\n<p>The reason this is a bad practice is that it doesn't properly separate concerns according to the MVC paradigm. Your controller shouldn't be concerned with your data persistence implementation. A better approach would be to add a method to <code>User</code>. </p>\n"}], "owner": {"reputation": 413, "user_id": 2118999, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4f02d8edfacb99ee6b70a1efafe4d875?s=128&d=identicon&r=PG", "display_name": "MDekker", "link": "https://stackoverflow.com/users/2118999/mdekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8812, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1444773550, "creation_date": 1433975037, "last_edit_date": 1444773550, "question_id": 30768344, "link": "https://stackoverflow.com/questions/30768344/using-transaction-in-ruby-on-rails-controller-method", "title": "Using transaction in Ruby On Rails controller method", "body": "<p>I love Ruby On Rails and every day I am learning and improving my skills. Currently I am working on an application that is used by several clients and I want to refactor my code so I can feel confident about the quality of my code. </p>\n\n<p>I am struggling with how I should implement exception handling and make use of Transactions. I have a controller that has to create and update three objects.To simplify my situation.</p>\n\n<p>in my controller:</p>\n\n<pre><code>def update\n  @user.change_value_x  #(1) effects Model 'User'\n  if condition == y \n    @user.create_coupon #(2) effects Model 'Coupon' via Model 'User' \n  end\n  create_a_history_item #(3) effect Model 'History' \nend\n</code></pre>\n\n<p>The first (1) and the second method (2) are located in the User Model and the third method (3) is also used by other controllers and is located in a Module in the /lib directory. All methods are updating/saving/creating database items.</p>\n\n<p>And if one of the actions fails all database actions should roll back and give feedback about the problem.</p>\n\n<p>I know that 'transaction' is a good solution for this and I have also red, in different posts, that a transaction should not be used in a controller.<br>\n<strong>Question</strong>: Why is this?</p>\n\n<p>So I guess this code is not the right way to implement transaction.</p>\n\n<pre><code>def update\n  ActiveRecord::Base.transaction do\n    @user.change_value_x  #(1) effects Model 'User'\n    if condition == y \n      @user.create_coupon #(2) effects Model 'Coupon' via Model 'User' \n    end\n    create_a_history_item #(3) effect Model 'History'\n  end\n  rescue\n  #some code that gives feedback to user about the problem\nend\n</code></pre>\n\n<p>What is the best/right way to handle this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook", "devise"], "answers": [{"comments": [{"owner": {"reputation": 42675, "user_id": 454049, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/90d79935ce8f6d048b46683ce6cc9cdf?s=128&d=identicon&r=PG", "display_name": "LuckyLuke", "link": "https://stackoverflow.com/users/454049/luckyluke"}, "edited": false, "score": 0, "creation_date": 1434010133, "post_id": 30769147, "comment_id": 49600741, "body": "Ok, but spotify and such apps automagically logs you in? They do something different then I guess?"}], "tags": [], "owner": {"reputation": 445, "user_id": 4368245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h0TDk.jpg?s=128&g=1", "display_name": "spectre6000", "link": "https://stackoverflow.com/users/4368245/spectre6000"}, "is_accepted": false, "score": 0, "last_activity_date": 1433979538, "creation_date": 1433979538, "answer_id": 30769147, "question_id": 30768308, "link": "https://stackoverflow.com/questions/30768308/already-logged-in-on-facebook-why-the-need-to-re-authenticate-when-using-devise/30769147#30769147", "title": "Already logged in on Facebook, why the need to re-authenticate when using Devise", "body": "<p>It's expected. That's facebook's way of making sure you a user is actually trying to give someone access to their information.</p>\n"}, {"comments": [{"owner": {"reputation": 445, "user_id": 4368245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h0TDk.jpg?s=128&g=1", "display_name": "spectre6000", "link": "https://stackoverflow.com/users/4368245/spectre6000"}, "edited": false, "score": 1, "creation_date": 1434047576, "post_id": 30777967, "comment_id": 49627041, "body": "I just implemented this in an app a few days ago. As I recall, a user has to provide their password to (facebook) the first time to authorize transmission of data and to create the user. Subsequent times they don&#39;t though because they&#39;ve already done so and it&#39;s just creating a session instead of a new user. Testing it in my own app, that&#39;s exactly how it went down. This comes from doing it and my recollection of the documentation of either OA or FB&#39;s API. Digging into source on either side may prove that incorrect."}], "tags": [], "owner": {"reputation": 42675, "user_id": 454049, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/90d79935ce8f6d048b46683ce6cc9cdf?s=128&d=identicon&r=PG", "display_name": "LuckyLuke", "link": "https://stackoverflow.com/users/454049/luckyluke"}, "is_accepted": false, "score": 0, "last_activity_date": 1434017704, "creation_date": 1434017704, "answer_id": 30777967, "question_id": 30768308, "link": "https://stackoverflow.com/questions/30768308/already-logged-in-on-facebook-why-the-need-to-re-authenticate-when-using-devise/30777967#30777967", "title": "Already logged in on Facebook, why the need to re-authenticate when using Devise", "body": "<p>As it turns out using this method:</p>\n\n<pre><code>&lt;%= link_to 'Sign in', volunteer_omniauth_authorize_path(:facebook) %&gt;\n</code></pre>\n\n<p>It works as expected. When a user is logged in to Facebook he/she does not have to reenter authentication information. When signing out of Facebook the user has to reauthenticate. </p>\n\n<p>Awesome.</p>\n"}], "owner": {"reputation": 42675, "user_id": 454049, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/90d79935ce8f6d048b46683ce6cc9cdf?s=128&d=identicon&r=PG", "display_name": "LuckyLuke", "link": "https://stackoverflow.com/users/454049/luckyluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434017704, "creation_date": 1433974860, "question_id": 30768308, "link": "https://stackoverflow.com/questions/30768308/already-logged-in-on-facebook-why-the-need-to-re-authenticate-when-using-devise", "title": "Already logged in on Facebook, why the need to re-authenticate when using Devise", "body": "<p>I am using Devise and omniauth-facebook gem. I have successfully configured it. However, I wonder why I need to re-authenticate when I click the sign-in link in my app, when I am already logged in on Facebook on another tab in my browser? Shouldn't it be some magic here? Or is that expected behaviour?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "notifications", "comments"], "comments": [{"owner": {"reputation": 185, "user_id": 2546939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36183d073a1e7df25a08233638dad527?s=128&d=identicon&r=PG", "display_name": "maringan", "link": "https://stackoverflow.com/users/2546939/maringan"}, "edited": false, "score": 0, "creation_date": 1433980656, "post_id": 30768230, "comment_id": 49590589, "body": "ActiveRecord#reload (In rails console can help <a href=\"http://apidock.com/rails/ActiveRecord/Base/reload\" rel=\"nofollow noreferrer\">apidock.com/rails/ActiveRecord/Base/reload</a>) can help in Rails Console.  [Off-topic] this tutorial is very bad. IMHO this is better alternative <a href=\"http://railscasts.com/episodes/406-public-activity\" rel=\"nofollow noreferrer\">railscasts.com/episodes/406-public-activity</a>"}, {"owner": {"reputation": 339, "user_id": 4515528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TfEIc2wwaJI/AAAAAAAAAAI/AAAAAAAAAsM/sQFC1KjoZtA/photo.jpg?sz=128", "display_name": "pauloancheta", "link": "https://stackoverflow.com/users/4515528/pauloancheta"}, "edited": false, "score": 0, "creation_date": 1433981752, "post_id": 30768230, "comment_id": 49590837, "body": "I&#39;m not sure but i think if you use <code>@user = current_user</code> on your comment.rb, it should fix the problem. <code>User.find_by(@valuation.user_id).id</code> finds who made the Valuation..."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 339, "user_id": 4515528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TfEIc2wwaJI/AAAAAAAAAAI/AAAAAAAAAsM/sQFC1KjoZtA/photo.jpg?sz=128", "display_name": "pauloancheta", "link": "https://stackoverflow.com/users/4515528/pauloancheta"}, "edited": false, "score": 0, "creation_date": 1433986172, "post_id": 30768230, "comment_id": 49591887, "body": "Sorry @pauloancheta are you saying <code>@user = current_user.find_by(@valuation.user_id).id</code> because that&#39;s giving an error?"}], "answers": [{"tags": [], "owner": {"reputation": 328, "user_id": 1060871, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/15203750/picture?type=large", "display_name": "rkamun1", "link": "https://stackoverflow.com/users/1060871/rkamun1"}, "is_accepted": true, "score": 0, "last_activity_date": 1433996777, "last_edit_date": 1433996777, "creation_date": 1433995916, "answer_id": 30771444, "question_id": 30768230, "link": "https://stackoverflow.com/questions/30768230/how-to-set-user-id-with-comment-notifications/30771444#30771444", "title": "How to set :user_id with comment notifications?", "body": "<p>This</p>\n\n<pre><code>@valuation = Valuation.find_by(self.valuation_id)\n@user = User.find_by(@valuation.user_id).id\n\nNotification.create(\n     valuation_id: self.valuation_id,\n     user_id: @user,\n     comment_id: self,\n     read: false\n    )\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>self.notifications.create(\n  valuation: self.valuation,\n  user: self.valuation.user\n)\n</code></pre>\n\n<p>in your migration file set:</p>\n\n<pre><code>t.boolean read, default: false\n</code></pre>\n\n<p>in your controller: </p>\n\n<pre><code>def index\n  @notifications = Notification.where(:user_id =&gt; current_user.id)\n  @notifications.each do |notification|\n    notification.update_attribute(:read, true)\n  end\nend\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>def index\n  @notifications = current_user.notifications\n  @notifications.each do |notification|\n    notification.update_attribute(:read, true) \n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 30771444, "answer_count": 1, "score": 0, "last_activity_date": 1433996777, "creation_date": 1433974416, "last_edit_date": 1433978985, "question_id": 30768230, "link": "https://stackoverflow.com/questions/30768230/how-to-set-user-id-with-comment-notifications", "title": "How to set :user_id with comment notifications?", "body": "<p>Whenever a notification is created how can we set the <code>:user_id</code> for the user who made the comment (and in affect the notification)?</p>\n\n<p>When I check <code>rails console</code> for some reason all <code>Notifications</code> are showing up as <code>user_id: 1</code> when some of them should be <code>user_id: 2</code> since the latter was the one who did the commenting.</p>\n\n<p>I'm probably just not understanding the code well enough because I followed along <strong><a href=\"http://evanamccullough.com/2014/11/ruby-on-rails-simple-notifications-system-tutorial/\" rel=\"nofollow\">this tutorial</a></strong> inputting my own version along the way.</p>\n\n<p><strong>comment.rb</strong></p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  after_create :create_notification\n  has_many :notifications\n  has_many :comment_likes   \n  has_many :likers, through: :comment_likes, class_name: 'User', source: :liker\n  belongs_to :valuation\n  belongs_to :user\n  validates :user, presence: true\n\nprivate\n\n  def create_notification # I replaced the tutorial's \"Post\" with my \"Valuation\"\n    @valuation = Valuation.find_by(self.valuation_id)\n    @user = User.find_by(@valuation.user_id).id\n    Notification.create(\n     valuation_id: self.valuation_id,\n     user_id: @user,\n     comment_id: self,\n     read: false\n    )\n  end\nend\n</code></pre>\n\n<p><strong>notifications_controller</strong></p>\n\n<pre><code>class NotificationsController &lt; ApplicationController\n  before_action :correct_user, only: [:destroy]\n\n    def index\n    @notifications = Notification.where(:user_id =&gt; current_user.id)\n    @notifications.each do |notification|\n        notification.update_attribute(:read, true)\n    end\n    end\n\n\n    def destroy\n      @notification = Notification.find(params[:id])\n      @notification.destroy\n      redirect_to :back\n    end\n\nprivate\n\n  def correct_user\n    @notification = current_user.notifications.find_by(id: params[:id])\n    redirect_to root_url, notice: \"Not authorized to edit this notification\" if @notification.nil?\n  end\nend\n</code></pre>\n\n<p><strong>notifications/_notification</strong></p>\n\n<pre><code>&lt;%= link_to Comment.find_by(notification.comment_id).user.name, user_path(Comment.find_by(notification.comment_id).user.id) %&gt; commented on &lt;%= link_to \"your value\", notification_valuation_path(notification, notification.valuation_id) %&gt;\n</code></pre>\n\n<p>Please let me know if you need further explanation or code to help you help me :-]</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "edited": false, "score": 0, "creation_date": 1433990561, "post_id": 30768007, "comment_id": 49592904, "body": "Try <code>require &quot;markio&quot;</code> in your model first?   Actually, looks like <code>Markio::Link</code> should be <code>Markio::Bookmark</code>"}, {"owner": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "reply_to_user": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "edited": false, "score": 0, "creation_date": 1433990858, "post_id": 30768007, "comment_id": 49592976, "body": "That&#39;s not the problem, i have the Markio gem installed because i have an import option working but i have no idea how to setup it up so users can export."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "edited": false, "score": 0, "creation_date": 1433991120, "post_id": 30770667, "comment_id": 49593033, "body": "If i do that i get the error undefined local variable or method `title&#39;. So it&#39;s not reading the title field in my database from my Link Model."}, {"owner": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "reply_to_user": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "edited": false, "score": 0, "creation_date": 1433992791, "post_id": 30770667, "comment_id": 49593429, "body": "Your method is defined as a class method <code>def self.to_csv</code>, so therefore there is no <code>title</code> method on the class itself.  Define it as an instance method <code>def to_csv</code> instead."}, {"owner": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "edited": false, "score": 0, "creation_date": 1433993309, "post_id": 30770667, "comment_id": 49593546, "body": "Ok so now i get downloaded file but the contents read out like this #&lt;Link:0x007fd0c45a6878&gt;. It&#39;s also downloading a .txt file not an .html"}, {"owner": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "reply_to_user": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "edited": false, "score": 0, "creation_date": 1433994514, "post_id": 30770667, "comment_id": 49593819, "body": "Where is <code>Markio::Link</code> defined?  It doesn&#39;t look like it&#39;s part of the Markio gem.  This could explain the na&#239;ve <code>to_s</code> representation of it in the file."}, {"owner": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "edited": false, "score": 0, "creation_date": 1433994975, "post_id": 30770667, "comment_id": 49593912, "body": "It&#39;s not defined but my rails model is called link so i thought maybe I would do that but thats not right. Im not really sure what i am doing."}], "tags": [], "owner": {"reputation": 4853, "user_id": 126636, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d69d23d8e811e8ab2a8593380d6ede63?s=128&d=identicon&r=PG", "display_name": "jemminger", "link": "https://stackoverflow.com/users/126636/jemminger"}, "is_accepted": false, "score": 0, "last_activity_date": 1433990682, "creation_date": 1433990682, "answer_id": 30770667, "question_id": 30768007, "link": "https://stackoverflow.com/questions/30768007/how-to-export-a-html-file-in-rails/30770667#30770667", "title": "How to export a HTML file in Rails?", "body": "<p>Shouldn't <code>Markio::Link</code> be <code>Markio::Bookmark</code>?  I don't see a <code>Link</code> object in their API.</p>\n"}], "owner": {"reputation": 177, "user_id": 4982261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/YwA7X.gif?s=128&g=1", "display_name": "EliteViper7777", "link": "https://stackoverflow.com/users/4982261/eliteviper7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433990682, "creation_date": 1433973396, "last_edit_date": 1433974390, "question_id": 30768007, "link": "https://stackoverflow.com/questions/30768007/how-to-export-a-html-file-in-rails", "title": "How to export a HTML file in Rails?", "body": "<p>I am trying to export links that are in my database into a HTML Netscape Bookmark File using <a href=\"https://github.com/spajus/markio\" rel=\"nofollow\">Markio</a>.</p>\n\n<p>This following Ruby code is from <a href=\"https://github.com/spajus/markio\" rel=\"nofollow\">Markio</a>. I'm not sure how to get it to work with Rails so I can export links from my database to a file the user can download.</p>\n\n<pre><code>builder = Markio::Builder.new\nbuilder.bookmarks &lt;&lt; Markio::Bookmark.create({\n  :title =&gt; \"Google\",\n  :href =&gt; \"http://google.com\"\n})\nfile_contents = builder.build_string\nFile.open('/path/to/bookmarks.html', 'w') { |f| f.write file_contents }\n</code></pre>\n\n<p>This is what I have so far in my Rails app. I am most likely going about it completely wrong because I only know how to do it with CSV and Excel. Each Link in my Rails database has a <code>title</code> and a <code>url</code>.</p>\n\n<p>If I navigate to links/export in my browser it should download a file but I get the error \"uninitialized constant Markio::Link\". </p>\n\n<p>This is my Links controller:</p>\n\n<pre><code>def export\n    @links = Link.all\n    respond_to do |format|\n        format.html { send_data @links.to_csv }\n    end\nend\n</code></pre>\n\n<p>This is my Links model:</p>\n\n<pre><code>def self.to_csv(options = {})\n    builder = Markio::Builder.new\n    builder.bookmarks &lt;&lt; Markio::Link.create({\n      :title =&gt; title,\n      :href =&gt; url\n    })\n    file_contents = builder.build_string\n    File.open('/path/to/bookmarks.html', 'w') { |f| f.write\n    file_contents }\nend\n</code></pre>\n"}, {"tags": ["ruby", "windows", "postgresql", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "edited": false, "score": 0, "creation_date": 1433978616, "post_id": 30768955, "comment_id": 49590002, "body": "I just thought also, you should make sure your variable names all contain some value, and none are empty. You could set a var and output before the <code>system</code> call:  <code>cmd = &quot;createdb #{DB_NAME} --username #{DB_USERNAME} -w --no-password&quot;; puts cmd</code>"}, {"owner": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "edited": false, "score": 0, "creation_date": 1433979259, "post_id": 30768955, "comment_id": 49590192, "body": "I suspect I need to break up the system() line as well but when I tried to input your suggested changes it shows me syntax error in the terminal with the equals sign. It says the equals signs are &quot;unexpected.&quot; I think Windows can take &amp;&amp; but I don&#39;t know what it means by &quot;too many&quot; arguments. Is there a way to find out the max # of arguments createdb can take?"}, {"owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "reply_to_user": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "edited": false, "score": 0, "creation_date": 1433979536, "post_id": 30768955, "comment_id": 49590272, "body": "Syntax error, that&#39;s a surprise. What is the full error text? What do you mean &quot;in the terminal&quot;? You&#39;re right, Windows 7 cmd.exe does seem happy with the <code>&amp;&amp;</code>, so that would suggest some &quot;wrong&quot; <code>createdb</code> being called."}, {"owner": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "edited": false, "score": 0, "creation_date": 1433980198, "post_id": 30768955, "comment_id": 49590466, "body": "I meant in the command terminal by running bundle exec rake db:create in cmd.exe. I suspect the option flags must be written incorrectly. Looking at this reference: <a href=\"http://www.commandprompt.com/ppbook/x17149\" rel=\"nofollow noreferrer\">commandprompt.com/ppbook/x17149</a>, if I have something like --username, it&#39;s supposed to be --username = #{DB_NAME} and not have the space like that. It looks like the syntax is mixed up between the single flags and double flags. I&#39;ll try rewriting it some more. I think I can keep &amp;&amp; but I need to edit the flags so createdb understands the syntax."}, {"owner": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "edited": false, "score": 0, "creation_date": 1433980669, "post_id": 30768955, "comment_id": 49590592, "body": "Got it! This is the correct syntax: system(&quot;createdb #{DB_NAME} --username=#{DB_USERNAME} &amp;&amp; createdb #{TEST_DB_NAME} --username=#{DB_USERNAME}&quot;). For some reason, that method doesn&#39;t like having any option flags for passwords so that must be completely removed. In addition, whoever wrote this file didn&#39;t put in the correct equals signs to use with the --username option flags so createdb.exe was getting hung up on that. The #{DB_USERNAME} string wasn&#39;t supposed to be another argument but without the equals sign, createdb.exe was looking at it as a separate argument."}, {"owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "reply_to_user": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "edited": false, "score": 0, "creation_date": 1433981146, "post_id": 30768955, "comment_id": 49590714, "body": "Congrats. Nice debugging."}], "tags": [], "owner": {"reputation": 174, "user_id": 4996615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f2d1a33af3282a81eb8fbf4c1405d3?s=128&d=identicon&r=PG", "display_name": "lilole", "link": "https://stackoverflow.com/users/4996615/lilole"}, "is_accepted": false, "score": 0, "last_activity_date": 1433979281, "last_edit_date": 1433979281, "creation_date": 1433978326, "answer_id": 30768955, "question_id": 30767865, "link": "https://stackoverflow.com/questions/30767865/createdb-too-many-command-line-arguments/30768955#30768955", "title": "createdb: too many command line arguments", "body": "<p>Since you are on Windows, there may be an issue with the syntax of the line:</p>\n\n<pre><code>system(\"createdb #{DB_NAME} --username #{DB_USERNAME} -w --no-password &amp;&amp; createdb #{TEST_DB_NAME} --username #{DB_USERNAME} -w --no-password\")\n</code></pre>\n\n<p>If Ruby uses the default Windows <code>cmd.exe</code> to run the command, the <code>&amp;&amp;</code> operator won't work.</p>\n\n<p>I would probably break it up into 2 statements:</p>\n\n<pre><code>ok   = system(\"createdb #{DB_NAME} --username #{DB_USERNAME} -w --no-password\")\nok &amp;&amp;= system(\"createdb #{TEST_DB_NAME} --username #{DB_USERNAME} -w --no-password\")\n# ...can check \"ok\" for success of both calls if you like...\n</code></pre>\n\n<p>Finally, if the problem persists, then there must be another <code>createdb</code> executable in the PATH which is hit before your Postgres binaries path. You could try <code>system(\"path\")</code> and see what the output is, and check those dirs for a conflicting <code>createdb</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "is_accepted": false, "score": 0, "last_activity_date": 1434662043, "creation_date": 1434662043, "answer_id": 30925927, "question_id": 30767865, "link": "https://stackoverflow.com/questions/30767865/createdb-too-many-command-line-arguments/30925927#30925927", "title": "createdb: too many command line arguments", "body": "<p>The Rakefile \"create\" task uses createdb.exe from PostgreSQL. system() takes in options for createdb.exe. Those options are described in these resources: </p>\n\n<ul>\n<li>PostgreSQL 9.4 documentation: <a href=\"http://www.postgresql.org/docs/9.4/static/app-createdb.html\" rel=\"nofollow\">http://www.postgresql.org/docs/9.4/static/app-createdb.html</a></li>\n<li>Practical PostgreSQL, Ch 9: Database Management, under the section titled \"Using createdb\": <a href=\"http://www.commandprompt.com/ppbook/x17149\" rel=\"nofollow\">http://www.commandprompt.com/ppbook/x17149</a></li>\n</ul>\n\n<p>For this specific Rakefile, the option flags are incorrectly formatted so createdb.exe is not able to understand the command-line arguments it is being given. Specifically, single option flags and double option flags are being used together incorrectly: </p>\n\n<ul>\n<li>--username must be set equal to a value</li>\n<li>-w and --no-password mean the same thing and are redundant. You should use one or the other if you are going to use this option flag, but not both.</li>\n</ul>\n\n<p>The correct syntax for system() in this Rakefile is:</p>\n\n<pre><code>system(\"createdb #{DB_NAME} --username=#{DB_USERNAME} &amp;&amp; createdb #{TEST_DB_NAME} --username=#{DB_USERNAME}\")\n</code></pre>\n\n<p>You may be able to keep -w or --no-password flags, but if you continue receiving command terminal errors regarding the command-line arguments, remove both of those flags completely as shown above and let the command terminal ask you for the password to the postgres server as it does by default. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5374933, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153209471806139/picture?type=large", "display_name": "Chris Gripeos", "link": "https://stackoverflow.com/users/5374933/chris-gripeos"}, "is_accepted": false, "score": 0, "last_activity_date": 1443165820, "last_edit_date": 1443165820, "creation_date": 1443160906, "answer_id": 32775770, "question_id": 30767865, "link": "https://stackoverflow.com/questions/30767865/createdb-too-many-command-line-arguments/32775770#32775770", "title": "createdb: too many command line arguments", "body": "<p>I just went through this on a Windows 7 machine. </p>\n\n<p>The correct answer is:</p>\n\n<pre><code>system(\"createdb --no-password --username=#{DB_USERNAME} #{DB_NAME} &amp;&amp; createdb --no-password --username=#{DB_USERNAME} #{TEST_DB_NAME} \")\n</code></pre>\n\n<p>I got this from your posts and from reading the <code>dbcreate --help</code>. The arguments were in the wrong order; notice the <code>DB_NAME</code> is at the end as a final argument <strong>after</strong> all the options.</p>\n"}], "owner": {"reputation": 31, "user_id": 4992261, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/02d8e3ff7ec2122840e16ce38feb0265?s=128&d=identicon&r=PG&f=1", "display_name": "user4992261", "link": "https://stackoverflow.com/users/4992261/user4992261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1251, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1443165820, "creation_date": 1433972764, "last_edit_date": 1495542798, "question_id": 30767865, "link": "https://stackoverflow.com/questions/30767865/createdb-too-many-command-line-arguments", "title": "createdb: too many command line arguments", "body": "<p>I'm a newbie to Ruby and web development. I'm using Windows 7 64-bit with Ruby 2.0 and I have PostgreSQL 9.4 installed. </p>\n\n<p>I'm trying to use ActiveRecord to create a database. I checked that my postgresql server is running and I did bundle install to make sure I had all the required gems. When I run \"bundle exec rake db:create,\" it looks like rake is able to find createdb.exe in the PostgreSQL directory, but for some reason it's telling me that I have too many command line arguments:</p>\n\n<pre><code>C:\\Users\\MH\\Desktop\\activerecord-template&gt; bundle exec rake db:create\nCreating activerecord-template development and test databases if they don't exist...\n'createdb': too many command line-arguments (first is \"postgres\")\n</code></pre>\n\n<p>My Gemfile, Rakefile, and config.rb file are here in my prior post: <a href=\"https://stackoverflow.com/questions/30742806/createdb-not-recognized-as-a-command-when-using-activerecord\">createdb not recognized as a command when using ActiveRecord</a> </p>\n\n<p>I think the issue might be in the Rakefile here:</p>\n\n<pre><code>desc \"Create #{APP_NAME} databases\"\n      task \"create\" do\n        puts \"Creating #{APP_NAME} development and test databases if they don't exist...\"\n        system(\"createdb #{DB_NAME} --username #{DB_USERNAME} -w --no-password &amp;&amp; createdb #{TEST_DB_NAME} --username #{DB_USERNAME} -w --no-password\")\n      end\n</code></pre>\n\n<p>I tried deleting and changing the order of -w as referenced here: <a href=\"https://stackoverflow.com/questions/11865596/pg-dump-too-many-command-line-arguments\">pg_dump: too many command line arguments</a>, but that didn't fix the issue.</p>\n\n<p>There was also some discussion about putting \"your options before your option-less arguments\" and the wrong order for options in these links: </p>\n\n<p><a href=\"http://grokbase.com/t/postgresql/pgsql-general/07avnzajn7/createdb-argument-question\" rel=\"nofollow noreferrer\">http://grokbase.com/t/postgresql/pgsql-general/07avnzajn7/createdb-argument-question</a> </p>\n\n<p><a href=\"http://postgresql.nabble.com/pgpass-does-not-work-for-createlang-td2118667.html\" rel=\"nofollow noreferrer\">http://postgresql.nabble.com/pgpass-does-not-work-for-createlang-td2118667.html</a></p>\n\n<p>but I don't really get what that means for my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1433974351, "post_id": 30767854, "comment_id": 49588537, "body": "Please show a sample of your input data and what you want the output CSV to look like. That helps avoid guesses or people trying to write your specs for you."}], "answers": [{"comments": [{"owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "edited": false, "score": 0, "creation_date": 1434033759, "post_id": 30771858, "comment_id": 49617875, "body": "I&#39;m unsure how this works.  Where do I call the percentage_to_true_false method?"}], "tags": [], "owner": {"reputation": 328, "user_id": 1060871, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/15203750/picture?type=large", "display_name": "rkamun1", "link": "https://stackoverflow.com/users/1060871/rkamun1"}, "is_accepted": false, "score": 0, "last_activity_date": 1433998480, "creation_date": 1433998480, "answer_id": 30771858, "question_id": 30767854, "link": "https://stackoverflow.com/questions/30767854/csv-export-changing-a-boolean-column-from-true-false-to-yes-no/30771858#30771858", "title": "CSV export changing a boolean column from true/false to yes/no", "body": "<pre><code>def data_point_columns\n  [\"id\", \"category\", \"subcategory\", \"percentage_to_true_false\"]\nend\n</code></pre>\n\n<p>in <code>DataPoint</code> model</p>\n\n<pre><code>def percentage_to_true_false\n case percentage\n when yes\n   'true'\n when 'no'\n   'false'\n end\n</code></pre>\n\n<p>You might have to modify how you load the CSV row.</p>\n"}, {"tags": [], "owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "is_accepted": true, "score": 0, "last_activity_date": 1434050977, "creation_date": 1434050977, "answer_id": 30789802, "question_id": 30767854, "link": "https://stackoverflow.com/questions/30767854/csv-export-changing-a-boolean-column-from-true-false-to-yes-no/30789802#30789802", "title": "CSV export changing a boolean column from true/false to yes/no", "body": "<p>I was able to do this by replacing</p>\n\n<p><code>d.attributes.values_at(*DataPoint.data_point_columns)</code></p>\n\n<p>with: </p>\n\n<pre><code>def to_csv(data)\n  CSV.generate do |csv|\n    csv &lt;&lt; DataPoint.data_point_columns\n    data.all.each do |d|\n      percentage = d.percentage ? \"Yes\" : \"No\"\n      csv &lt;&lt; [d.id, d.category, d.subcategory, percentage]\n    end\n  end\nend\n\ndef data_point_columns\n  [\"id\", \"category\", \"subcategory\", \"percentage\"]\nend\n</code></pre>\n"}], "owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1326, "favorite_count": 1, "accepted_answer_id": 30789802, "answer_count": 2, "score": 1, "last_activity_date": 1434050977, "creation_date": 1433972706, "last_edit_date": 1433990166, "question_id": 30767854, "link": "https://stackoverflow.com/questions/30767854/csv-export-changing-a-boolean-column-from-true-false-to-yes-no", "title": "CSV export changing a boolean column from true/false to yes/no", "body": "<p>When I export my CSV, I want to change a boolean column to read \"Yes\" or \"No\".</p>\n\n<p>My CSV code is simple:</p>\n\n<pre><code>def to_csv(data)\n  CSV.generate do |csv|\n    csv &lt;&lt; DataPoint.data_point_columns\n    data.all.each do |d|\n      csv &lt;&lt; d.attributes.values_at(*DataPoint.data_point_columns)\n    end\n  end\nend\n\ndef data_point_columns\n  [\"id\", \"category\", \"subcategory\", \"percentage\"]\nend\n\ndata = [#&lt;DataPoint:0x007fc77d1ffc60\nid: 20,\ncategory: \"Cat 1\",\nsubcategory: \"Cat 2\",\npercentage: true\n&gt;,\n#&lt;DataPoint:0x007fc77d1ff878\nid: 22,\ncategory: \"Cat 1\",\nsubcategory: \"Cat 2\",\npercentage: false\n&gt;]\n</code></pre>\n\n<p>I want the csv to look like this\n<img src=\"https://i.stack.imgur.com/SSZhi.png\" alt=\"expected csv\"></p>\n\n<p>How can I do this if \"percentage\" is a boolean?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "activerecord"], "comments": [{"owner": {"reputation": 1036, "user_id": 4465049, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/92iYb.jpg?s=128&g=1", "display_name": "Chitra", "link": "https://stackoverflow.com/users/4465049/chitra"}, "edited": false, "score": 0, "creation_date": 1434084351, "post_id": 30767766, "comment_id": 49640009, "body": "As there is no need to add foreign_key: :assignment_id in course model. It automatically be understandable when you define has_many relationship.Please make sure your course table has assignment_id as a column. Please write down the required migration if possible."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1433973193, "post_id": 30767910, "comment_id": 49588114, "body": "but I am getting this error unknown attribute: assignment_id"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "edited": false, "score": 0, "creation_date": 1433973370, "post_id": 30767910, "comment_id": 49588170, "body": "In both table Course and Assignment, I have 4 columns id, name, created_at and updated_at"}, {"owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "edited": false, "score": 0, "creation_date": 1433973593, "post_id": 30767910, "comment_id": 49588260, "body": "So this is it. You have create a migration, and add foreign key (<code>assignment_id </code>) to <code>Course</code>. Check <a href=\"http://guides.rubyonrails.org/association_basics.html#the-belongs-to-association\" rel=\"nofollow noreferrer\">this</a> for references"}], "tags": [], "owner": {"reputation": 399, "user_id": 4886550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fd001763e76e8d61e86462321582a?s=128&d=identicon&r=PG&f=1", "display_name": "caspg", "link": "https://stackoverflow.com/users/4886550/caspg"}, "is_accepted": false, "score": 0, "last_activity_date": 1433973231, "last_edit_date": 1433973231, "creation_date": 1433972960, "answer_id": 30767910, "question_id": 30767766, "link": "https://stackoverflow.com/questions/30767766/activerecordunknownattributeerror-in-rails-application/30767910#30767910", "title": "ActiveRecord::UnknownAttributeError in rails application", "body": "<p>You don't have to specify <code>class_name</code> and <code>foreign_key</code>, when you follow convention, as it is in your case.</p>\n\n<p><code>@assignment = @course.assignments.build</code> is a right way, because you want to specify relationship between course and assignment. You can do this: <code>@assignment = Assignment.new(course: @course)</code>, but use first method.</p>\n\n<p>Edit: I assume that you have <code>assignment_id</code> attribute in <code>Course</code>:)</p>\n"}, {"tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1433973758, "creation_date": 1433973758, "answer_id": 30768084, "question_id": 30767766, "link": "https://stackoverflow.com/questions/30767766/activerecordunknownattributeerror-in-rails-application/30768084#30768084", "title": "ActiveRecord::UnknownAttributeError in rails application", "body": "<p>The <code>belongs_to</code> table MUST have the foreign keys defined as columns in the table. How do you think the records will be linked, otherwise?</p>\n\n<p>So your <code>assignments</code> table should have an integer column <code>course_id</code>.  Create it with a migration.</p>\n\n<p>Then all you need is...</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  has_many :assignments, dependent: :destroy\n</code></pre>\n\n<p>and...</p>\n\n<pre><code>class Assignment &lt; ActiveRecord::Base\n  belongs_to :course\n</code></pre>\n\n<p>Then this will work...</p>\n\n<pre><code>@assignment = @course.assignments.build\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433973758, "creation_date": 1433972293, "question_id": 30767766, "link": "https://stackoverflow.com/questions/30767766/activerecordunknownattributeerror-in-rails-application", "title": "ActiveRecord::UnknownAttributeError in rails application", "body": "<p>I have two model, one as follow</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  has_many :assignments, class_name: 'Assignment', foreign_key: :assignment_id, dependent: :destroy\n  has_many :groups, class_name: 'Group', foreign_key: :group_id, dependent: :destroy\nend\n</code></pre>\n\n<p>And another model</p>\n\n<pre><code>class Assignment &lt; ActiveRecord::Base\n  belongs_to :course, class_name: 'Course', foreign_key: :course_id\n  has_many :questions, class_name: 'Question', foreign_key: :question_id, dependent: :destroy\nend\n</code></pre>\n\n<p>These two has relationship one to many i.e a course can have many assignments but an assignment belongs to a course. </p>\n\n<p>In my <code>assignment/index.html.erb</code> view I have following form</p>\n\n<pre><code>&lt;%= form_tag({controller: \"assignments\", action: \"new\"}, method: \"get\", class: \"nifty_form\") do %&gt;\n    &lt;%= select_tag \"course\", options_from_collection_for_select(Course.all, :id, :name) %&gt; &lt;br /&gt;&lt;br /&gt;\n    &lt;%= submit_tag(\"New Assignment\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>New method of my assignments_controller.rb </p>\n\n<pre><code>def new\n    @course = Course.find(params[:course])\n    @assignment = @course.assignments.build\n  end\n</code></pre>\n\n<p>When I submit the above form I get error at this line <code>@assignment = @course.assignments.build</code></p>\n\n<pre><code>ActiveRecord::UnknownAttributeError in AssignmentsController#new\nunknown attribute: assignment_id\n</code></pre>\n\n<p>assignment_id and course_id are not a column in the any of the table. How to fix this error?</p>\n\n<p>Also I am new to rails. Since I have one to many relation, I am trying to create database as <code>@assignment = @course.assignments.build</code> is this the right way? I mean do I have to write <code>@course.assignments.build</code> or just <code>@assignment = Assignment.new</code> is okay? Also the way I wrote the relationships with foreign key is it correct?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching"], "comments": [{"owner": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1433974927, "post_id": 30767423, "comment_id": 49588766, "body": "Can you post the code where you update the status ?"}, {"owner": {"reputation": 27877, "user_id": 231588, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/k2iEi.png?s=128&g=1", "display_name": "grautur", "link": "https://stackoverflow.com/users/231588/grautur"}, "reply_to_user": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1434082960, "post_id": 30767423, "comment_id": 49639704, "body": "@Thomas Haratyk: Added the code. The status simply gets updated when the user fills out a form for the task response and submits."}, {"owner": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1434099045, "post_id": 30767423, "comment_id": 49646604, "body": "Is there a reason for storing the number instead of using a simple count ? Because you&#39;ll have to handle every kind of status update and row deletion etc.... Are you concerned by performance ?"}, {"owner": {"reputation": 27877, "user_id": 231588, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/k2iEi.png?s=128&g=1", "display_name": "grautur", "link": "https://stackoverflow.com/users/231588/grautur"}, "reply_to_user": {"reputation": 6267, "user_id": 1144104, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c135bc644610fabc6e059b73fdd7f8ad?s=128&d=identicon&r=PG", "display_name": "jazzytomato", "link": "https://stackoverflow.com/users/1144104/jazzytomato"}, "edited": false, "score": 0, "creation_date": 1434316605, "post_id": 30767423, "comment_id": 49713780, "body": "Yup, I&#39;m storing a counter instead of counting every time for performance reasons. (I make these calls a lot.)"}], "owner": {"reputation": 27877, "user_id": 231588, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/k2iEi.png?s=128&g=1", "display_name": "grautur", "link": "https://stackoverflow.com/users/231588/grautur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1434082906, "creation_date": 1433970815, "last_edit_date": 1434082906, "question_id": 30767423, "link": "https://stackoverflow.com/questions/30767423/counters-not-counting-correctly-in-rails-app-am-i-supposed-to-use-increment", "title": "Counters not counting correctly in rails app -- am I supposed to use increment?", "body": "<p>I have a Rails app that has the following models:</p>\n\n<ul>\n<li><code>Project</code> (which has many tasks)</li>\n<li><code>Task</code> (which belongs to a project, and has many task responses)</li>\n<li><code>TaskResponse</code> (which belongs to a task)</li>\n</ul>\n\n<p>For example, I might have a project where I ask people to take pictures of an animal. I want three different people to take pictures of each animal, so a task to take a picture of a butterfly might have three different task responses associated with it.</p>\n\n<p>I want to keep track of the total number of completed responses, so I have the following code:</p>\n\n<pre><code>class TaskResponse &lt; ActiveRecord::Base\n  belongs_to :task\n\n  before_save :update_responses_completed\n  before_save :update_responses_in_progress\n\n  # Statuses\n  IN_PROGRESS = 1\n  COMPLETED = 2\n  SKIPPED = 3\n\n  def update_responses_completed\n    ActiveRecord::Base.transaction do\n      if self.status == TaskResponse::COMPLETED &amp;&amp; self.status_changed?\n        # Update task &amp; project counters\n        self.task.num_responses_completed += 1\n        self.project.num_responses_completed += 1\n\n        self.task.save!\n        self.project.save!\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>However, these counters don't seem to be consistent. I <em>should</em> have:</p>\n\n<ul>\n<li><code>self.project.num_responses_completed == self.project.tasks.map(&amp;:num_responses_completed).inject(0, :+)</code></li>\n<li><code>self.task.num_responses_completed == self.task.task_responses.select { |tr| tr.status == TaskResponse::COMPLETED }.size</code></li>\n</ul>\n\n<p>But these don't seem to be true.</p>\n\n<p>I can't figure out what's wrong. I'm not sure if there's some issue with caching, whether the <code>+=1</code> is being applied to an old cached value, or what. I see that there are <code>increment</code> and <code>increment_counter</code> methods in Rails, but I can't understand what the difference is between using those and <code>+= 1</code> (are they reloading the models or avoiding race conditions or something? I've searched StackOverflow, but I see inconsistent answers).</p>\n\n<p>Any suggestions?</p>\n\n<p>UPDATE:</p>\n\n<p>I update a task response's status in the update function in my controller (which gets hit after a user submits a response). So it looks something like:</p>\n\n<pre><code>class TaskResponsesController\n  def update\n    tr = TaskResponse.find(params[:id])\n    tr.update!(params)\n    tr.status = TaskResponse::COMPLETED\n    tr.save!\n    redirect_to(tr)\n  end\nend\n</code></pre>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "twitter-bootstrap", "devise"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433971342, "post_id": 30767385, "comment_id": 49587219, "body": "You&#39;re calling <code>get_company</code> with an argument when it doesn&#39;t accept one. Are you sure this is the right code? All I see is code for your <code>home</code> action, and nothing for <code>edit</code>."}, {"owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433971654, "post_id": 30767385, "comment_id": 49587396, "body": "Sorry @tadman you&#39;re right.  I did take out the current_user argument from passing in pages_controller as I was posting this.  I&#39;m on my phone now, otherwise I&#39;d edit.  It&#39;s now &#39;@company = get_company&#39;"}, {"owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433971880, "post_id": 30767385, "comment_id": 49587517, "body": "Edited the pages_controller"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1433972294, "post_id": 30767385, "comment_id": 49587711, "body": "Still pretty sure none of that code is running as the action in the controller does not match the view name."}, {"owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433972581, "post_id": 30767385, "comment_id": 49587856, "body": "I think that&#39;s my problem, hence the question.  The devise view is outside of pages_controller which is why &#39;@locations&#39; is kicking the problem in the partial view once it&#39;s being rendered.  Is there a way to make the instance variable accessibly from across the board no matter what view I&#39;m in and controller is being called?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433972683, "post_id": 30767385, "comment_id": 49587915, "body": "Instance variables defined in controllers are available to all views regardless of file location. What I&#39;m saying is you need to make those names the same, pick one of either <code>edit</code> or <code>home</code>. If you have a method called <code>home</code>, Rails will load the view for <code>edit</code> and render it without calling that, so none of your variables are defined. Make the names match if you&#39;re looking to have the controller <i>control</i> the associated view."}, {"owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433972836, "post_id": 30767385, "comment_id": 49587976, "body": "So I need to add something to the devise edit method for my user?  Sorry... New to devise."}, {"owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433973259, "post_id": 30767385, "comment_id": 49588137, "body": "I think this is the similar problem I&#39;m facing: <a href=\"http://stackoverflow.com/questions/15965127/where-is-the-controller-of-devise-how-to-add-data-from-other-models-in-users-e\" title=\"where is the controller of devise how to add data from other models in users e\">stackoverflow.com/questions/15965127/&hellip;</a> so I have to override the devise controller?"}], "answers": [{"tags": [], "owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "is_accepted": true, "score": 1, "last_activity_date": 1433978605, "last_edit_date": 1495540414, "creation_date": 1433978605, "answer_id": 30769004, "question_id": 30767385, "link": "https://stackoverflow.com/questions/30767385/instance-variable-in-partial-view/30769004#30769004", "title": "Instance variable in partial view", "body": "<p>Ok, seems that <a href=\"https://stackoverflow.com/questions/15965127/where-is-the-controller-of-devise-how-to-add-data-from-other-models-in-users-e\">Where is the controller of Devise ? how to add data from other models in users/edit page?</a> was helpful.  I had to do the following to make this work in the partial for the devise views:</p>\n\n<p><code>rails g devise:controllers users -c registrations</code> </p>\n\n<p>which made a registrations controller under <strong>controllers/users/registrations.rb</strong>, then i was able to add the instance variables I needed do the <code>edit</code> method:</p>\n\n<pre><code>def edit\n  @company = get_company\n  @locations = get_locations(@company)\nend\n</code></pre>\n\n<p>Had to also change the <strong>route.rb</strong> file around a little to facilitate the new controller:</p>\n\n<pre><code>devise_for :users, skip: [:sessions],\n                   controllers: {\n                     registrations: 'users/registrations'\n                   }\n</code></pre>\n"}], "owner": {"reputation": 2074, "user_id": 688071, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1229375604/picture?type=large", "display_name": "Godzilla74", "link": "https://stackoverflow.com/users/688071/godzilla74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 30769004, "answer_count": 1, "score": 0, "last_activity_date": 1433978605, "creation_date": 1433970672, "last_edit_date": 1433971854, "question_id": 30767385, "link": "https://stackoverflow.com/questions/30767385/instance-variable-in-partial-view", "title": "Instance variable in partial view", "body": "<p>I have a navbar that is a partial view that I need to render on a devise page for the user to edit their profile.  As it is, I only have one page, but adding the path to perform account maintenance has messed up my navbar loading because of the instance variable not being present.  How can I get a global instance variable that works across the board for my navbar, no matter what?</p>\n\n<p><strong>application_helper.rb</strong></p>\n\n<pre><code>def get_company\n  @company = current_user.company\nend\n\ndef get_locations(company)\n  @locations = if @company\n    current_user.company_locations.order(:name)\n  else\n    []\n  end\nend\n</code></pre>\n\n<p><strong>pages_controller.rb</strong></p>\n\n<pre><code>def home\n  @company = get_company\n  @locations = get_locations(@company)\n  @reports = if @company\n    @company.reports.order(\"created_at DESC\").limit(5)\n  else\n    []\n  end\nend\n</code></pre>\n\n<p><strong>views/devise/registrations/edit.html.erb</strong></p>\n\n<pre><code>&lt;%= render partial: \"pages/navigation\" %&gt;\n... devise form ....\n</code></pre>\n\n<p><strong>pages/_navigation.html.erb</strong></p>\n\n<pre><code>&lt;li class=\"right-menu-item\"&gt;\n      &lt;button class=\"btn dropdown-toggle \" type=\"button\" id=\"dropdownMenu1\" data-toggle=\"dropdown\"&gt;\n        &lt;% if @company %&gt;\n          &lt;%= @company.name %&gt;\n        &lt;% else %&gt;\n          &lt;%= current_user.email %&gt;\n        &lt;% end %&gt;\n        &lt;span class=\"caret\"&gt;&lt;/span&gt;\n      &lt;/button&gt;\n      &lt;ul class=\"dropdown-menu dropdown-menu-right\" role=\"menu\" aria-labelledby=\"dropdownMenu1\"&gt;\n        &lt;% @locations.each do |location| %&gt;\n          &lt;li role=\"presentation\"&gt;\n            &lt;%= link_to root_path(location_id: location.id), role: \"menuitem\", tabindex: \"-1\" do %&gt;\n              &lt;%= image_tag \"check-green.svg\" if location == @location %&gt;\n              &lt;span&gt;&lt;%= location.name %&gt;&lt;/span&gt;\n            &lt;% end %&gt;\n          &lt;/li&gt;\n        &lt;% end %&gt;\n      &lt;/ul&gt;\n</code></pre>\n\n<p><strong>Where the issue lies:</strong>\n<img src=\"https://i.stack.imgur.com/mtn8q.png\" alt=\"enter image description here\"></p>\n\n<p>What am I missing here to get this working across all views?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 1019, "user_id": 1742321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ab9ae0af880d77c4cca7f6a70bc8c76e?s=128&d=identicon&r=PG", "display_name": "Jo.P", "link": "https://stackoverflow.com/users/1742321/jo-p"}, "edited": false, "score": 0, "creation_date": 1434055057, "post_id": 30772114, "comment_id": 49631487, "body": "Hmm, a follow-up Q...how would you do the <code>create</code>? Would passing <code>box_params</code> to <code>Box.new()</code> suffice? Do I need to say <code>Box.new(box_params)</code> and <code>Toy.new(toys_attributes)</code>?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 1019, "user_id": 1742321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ab9ae0af880d77c4cca7f6a70bc8c76e?s=128&d=identicon&r=PG", "display_name": "Jo.P", "link": "https://stackoverflow.com/users/1742321/jo-p"}, "edited": false, "score": 0, "creation_date": 1434079645, "post_id": 30772114, "comment_id": 49638993, "body": "@Jo.P I updated the <code>create</code> method for you.If you provide the <code>attributes</code> for <code>box</code> and <code>toy</code>,i will modify the <code>box_params</code> too :)"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1434079556, "last_edit_date": 1434079556, "creation_date": 1433999818, "answer_id": 30772114, "question_id": 30767325, "link": "https://stackoverflow.com/questions/30767325/how-can-i-render-a-form-file-from-a-different-controller-without-having-conflic/30772114#30772114", "title": "How can I render a _form file from a different controller without having conflicting form_for&#39;s?", "body": "<p>You should be using <code>accepts_nested_attributes_for</code> along with <code>fields_for</code>.Assuming your associations are like this</p>\n\n<pre><code>#box.rb\nClass Box &lt; ActiveRecord::Base\n  has_many :toys\n  accepts_nested_attributes_for :toys\nend\n\n#toy.rb\nClass Toy &lt; ActiveRecord::Base\n  belongs_to :box\nend\n\n\n#box_controller.rb\n\ndef new\n @box = Box.new\n @toy = @box.toys.build\nend\n\ndef create\n  @box = Box.new(box_params)\n  if @box.save\n    -----\n  else\n    -----\n  end\nend\n\nprivate\n\ndef box_params\n  params.require(:box).permit(:box_attribute_1,:box_attribute_2,:more_box_attributes, toys_attributes: [:toy_attribute_1,:more_toy_attributes])\nend\n</code></pre>\n\n<p>In your <code>box/form</code>,you can do like this</p>\n\n<pre><code>  &lt;%= form_for(@box) do |f| %&gt;\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.label :box_attribute_1 %&gt;&lt;br /&gt;\n        &lt;%= f.text_field :box_attribute_1 %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.label :box_attribute_2 %&gt;&lt;br /&gt;\n        &lt;%= f.text_field :box_attribute_2 %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.label :box_attribute_3 %&gt;&lt;br /&gt;\n        &lt;%= f.text_field :box_attribute_3 %&gt;\n    &lt;/div&gt;\n\n    &lt;%= f.fields_for @toy do |builder| %&gt;\n        &lt;%= render 'toys/form', :f =&gt; builder %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1019, "user_id": 1742321, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ab9ae0af880d77c4cca7f6a70bc8c76e?s=128&d=identicon&r=PG", "display_name": "Jo.P", "link": "https://stackoverflow.com/users/1742321/jo-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 30772114, "answer_count": 1, "score": 0, "last_activity_date": 1434079556, "creation_date": 1433970477, "question_id": 30767325, "link": "https://stackoverflow.com/questions/30767325/how-can-i-render-a-form-file-from-a-different-controller-without-having-conflic", "title": "How can I render a _form file from a different controller without having conflicting form_for&#39;s?", "body": "<p>Let's say I have 2 models, Box.rb and Toy.rb. Rails gives me pages and methods to create new toys and boxes independently. However, I would like to ensure/provide the ability to create a box's first toy <em>when creating a box for the first time</em>.</p>\n\n<p>In line with DRY, I wanted to simply put <code>&lt;%= render \"Toy/form\" %&gt;</code> inside the <code>_form.html.erb</code> file that is made for <code>Box</code>.</p>\n\n<p>The problem is that Toy's <code>_form</code> file contains, well, a <code>form_for</code> method for obvious reasons. It's a problem for what I am trying to do because I will end up with 1 form nested in the other, while all I really want is to get the Toy fields while keeping to DRY\u2026? </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3171, "user_id": 2610043, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jIN0G.jpg?s=128&g=1", "display_name": "hedgesky", "link": "https://stackoverflow.com/users/2610043/hedgesky"}, "edited": false, "score": 1, "creation_date": 1433971315, "post_id": 30766903, "comment_id": 49587202, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/27055024/rails-find-with-a-block\">Rails find with a block</a>"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1433981990, "post_id": 30766903, "comment_id": 49590913, "body": "I don&#39;t think it&#39;s an exact duplicate, but the answer can indeed be found in the above link."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1433971071, "creation_date": 1433971071, "answer_id": 30767485, "question_id": 30766903, "link": "https://stackoverflow.com/questions/30766903/why-did-my-rails-find-query-select-all-records/30767485#30767485", "title": "Why did my Rails find query select all records?", "body": "<p>Passing a block to <code>find</code> changes the behaviour of the method. What ends up happening is it will load all models, then return only those for which the supplied block returns <code>true</code>, not unlike how <code>Enumerable#find</code> works.</p>\n\n<p>If you did something like:</p>\n\n<pre><code>MyUserModel.find { |m| [1,2,3].include?(m.id) }\n</code></pre>\n\n<p>Then you'd have an equivalent version, though this one is way slower since all records must be loaded rather than filtering at the database level.</p>\n\n<p>Generally you'd want to write this as:</p>\n\n<pre><code>MyUserModel.where(id: [ 1, 2, 3 ]).each do |model|\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 7054, "user_id": 88696, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/53e20180f0c292fcb589f77f738ed402?s=128&d=identicon&r=PG", "display_name": "Jesse Aldridge", "link": "https://stackoverflow.com/users/88696/jesse-aldridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 30767485, "answer_count": 1, "score": 3, "last_activity_date": 1433971071, "creation_date": 1433968896, "last_edit_date": 1433970954, "question_id": 30766903, "link": "https://stackoverflow.com/questions/30766903/why-did-my-rails-find-query-select-all-records", "title": "Why did my Rails find query select all records?", "body": "<p>I ran some code along these lines:</p>\n\n<pre><code>MyUserModel.find([id1, id2, id3]) do |record| send_email(record) end\n</code></pre>\n\n<p>As you can see, I forgot to include <code>.each</code> after the <code>find</code>.  This seems to have resulted in <code>send_email</code> being called on <strong>every record</strong> in the <code>my_user_model</code> table.  I don't understand why this happened.  Can someone explain?</p>\n\n<p>I'm new to ruby and rails, so I assume I'm just not understanding something about how blocks work or something like that.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-4", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1433970492, "post_id": 30767084, "comment_id": 49586789, "body": "This <i>should</i> work, as far as I can tell, according to the bottom of this page: <a href=\"http://apidock.com/rails/v4.0.2/ActionView/Helpers/FormOptionsHelper/collection_check_boxes\" rel=\"nofollow noreferrer\">apidock.com/rails/v4.0.2/ActionView/Helpers/FormOptionsHelpe&zwnj;&#8203;r/&hellip;</a> but it doesn&#39;t :-( This doesn&#39;t throw up any errors, but it doesn&#39;t make any apparent difference either."}, {"owner": {"reputation": 285, "user_id": 4607022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01d1ea629cc21bebca1b81f030250cb7?s=128&d=identicon&r=PG&f=1", "display_name": "WhyEnBe", "link": "https://stackoverflow.com/users/4607022/whyenbe"}, "reply_to_user": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1433971511, "post_id": 30767084, "comment_id": 49587319, "body": "<code>&lt;%= b.label(class: &quot;checkbox-inline&quot;) { b.check_box(:&quot;data-value&quot; =&gt; b.value) + b.text } %&gt;</code>"}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1433972853, "post_id": 30767084, "comment_id": 49587983, "body": "Sorry, doesn&#39;t make any difference either :-("}], "tags": [], "owner": {"reputation": 285, "user_id": 4607022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01d1ea629cc21bebca1b81f030250cb7?s=128&d=identicon&r=PG&f=1", "display_name": "WhyEnBe", "link": "https://stackoverflow.com/users/4607022/whyenbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1433969520, "creation_date": 1433969520, "answer_id": 30767084, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form/30767084#30767084", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<p>This should be closer to what you were looking for:</p>\n\n<pre><code>&lt;%= b.label(class: \"checkbox-inline\", :\"data-value\" =&gt; b.value) { b.check_box + b.text } %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434274950, "post_id": 30816158, "comment_id": 49701243, "body": "No change I&#39;m afraid :-("}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": false, "score": 1, "last_activity_date": 1434180296, "creation_date": 1434180296, "answer_id": 30816158, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form/30816158#30816158", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<p>Try changing your <code>_edit_word_form.html.erb</code> like this</p>\n\n<pre><code>&lt;%= form_for(@word) do |f| %&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= f.label(:title, \"Word:\") %&gt;&lt;br&gt;\n      &lt;%= f.text_field(:title, id: \"new_word\", required: true, autofocus: true, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= f.label(:description, \"Definition:\") %&gt;&lt;br&gt;\n      &lt;%= f.text_area(:description, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n\n  &lt;%= f.fields_for :category do |category_form| %&gt;\n    &lt;% if current_user.word_list.categories.count &gt; 0 %&gt;\n      &lt;div class=\"field form-group\"&gt;\n        &lt;%= category_form.label(:title, \"Choose from existing Categories:\") %&gt;&lt;br&gt;\n        &lt;%= category_form.collection_check_boxes(:category_ids, current_user.word_list.categories.all, :id, :title) do |b| %&gt;\n          &lt;%= b.label(class: \"checkbox-inline\") { b.check_box + b.text } %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n    &lt;h4&gt;AND/OR...&lt;/h4&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= category_form.label(:title, \"Create and Use a New Category:\") %&gt;&lt;br&gt;\n      &lt;%= category_form.text_field(:title, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit(\"Update!\", class: \"btn btn-block btn-primary btn-lg\") %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434415726, "post_id": 30850509, "comment_id": 49757579, "body": "Thanks but didn&#39;t work :-( Got a NoMethodError &quot;undefined method `merge&#39; for :title:Symbol&quot;"}], "tags": [], "owner": {"reputation": 1054, "user_id": 648337, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/9d2fd8b7a031c14e2ee737ceaab47448?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Barron", "link": "https://stackoverflow.com/users/648337/dan-barron"}, "is_accepted": false, "score": 1, "last_activity_date": 1434395963, "last_edit_date": 1434395963, "creation_date": 1434386492, "answer_id": 30850509, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form/30850509#30850509", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<p>So user is editing a word from their word list, but you want to show checkboxes for all categories for all the words in their word list, checking those categories attached to the word being editing. Is that correct?</p>\n\n<p>It looks like you're missing out the first parameter in #collection_check_boxes, which should be the object you call :category_ids on.</p>\n\n<p>If the object is the user's word_list, then something like:</p>\n\n<pre><code>&lt;%= category_form.collection_check_boxes(current_user.word_list, :category_ids, current_user.word_list.categories.all, :id, :title) do |b| %&gt;\n</code></pre>\n\n<p>May not be the exact answer--I can't test it--but hope it gives you something to go on.</p>\n"}, {"comments": [{"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434711712, "post_id": 30923269, "comment_id": 49907729, "body": "I get an &quot;undefined method `merge&#39; for :title:Symbol&quot;; seems to be arising from line 15"}, {"owner": {"reputation": 3290, "user_id": 1214951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313ce4fdeb46839023cc31357b72710b?s=128&d=identicon&r=PG", "display_name": "chad_", "link": "https://stackoverflow.com/users/1214951/chad"}, "reply_to_user": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434712839, "post_id": 30923269, "comment_id": 49908415, "body": "Oops, I think it should be fixed now. Sorry."}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434713178, "post_id": 30923269, "comment_id": 49908633, "body": "Nope, same. Line 15 is the line after the label line :-("}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434713619, "post_id": 30923269, "comment_id": 49908941, "body": "PS for your information, in the console, Word.first.categories works, and Word.first.category_ids returns an array of category ids, and Word.first.categories[1].id returns 48 (a category id). I don&#39;t know why your solution isn&#39;t working either"}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434713949, "post_id": 30923269, "comment_id": 49909152, "body": "Don&#39;t know if it helps, but I&#39;ve added the word_lists controller and word_list model to the question"}, {"owner": {"reputation": 3290, "user_id": 1214951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313ce4fdeb46839023cc31357b72710b?s=128&d=identicon&r=PG", "display_name": "chad_", "link": "https://stackoverflow.com/users/1214951/chad"}, "reply_to_user": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434720199, "post_id": 30923269, "comment_id": 49913302, "body": "What does Word.first.categories.first.title return?"}, {"owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "edited": false, "score": 0, "creation_date": 1434830186, "post_id": 30923269, "comment_id": 49949290, "body": "it returns &quot;animal&quot; - works as you hoped, chad_yesterday"}], "tags": [], "owner": {"reputation": 3290, "user_id": 1214951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313ce4fdeb46839023cc31357b72710b?s=128&d=identicon&r=PG", "display_name": "chad_", "link": "https://stackoverflow.com/users/1214951/chad"}, "is_accepted": false, "score": 1, "last_activity_date": 1434743889, "last_edit_date": 1434743889, "creation_date": 1434652918, "answer_id": 30923269, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form/30923269#30923269", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<h3>What's wrong</h3>\n\n<p>When you are calling <code>category_form.collection_check_boxes(:category_ids, current_user.word_list.categories.all, :id, :title)</code> within the <code>fields_for :category</code>, you are saying there is a method on <code>@word.category</code> called <code>category_ids</code> which will return the ids of the categories related to <code>@word.category</code>. The checkbox will be checked if there is a matching id both in <code>category_ids</code> results and in <code>current_user.word_list.categories.all</code>.</p>\n\n<p>I don't think there is a <code>@word.category</code> or a <code>@word.category.category_ids</code>. I think there's <code>@word.categories</code> though.</p>\n\n<h3>How to fix it</h3>\n\n<p>That being said, my instinct tells me that you need to use something like:</p>\n\n<pre><code>&lt;%= form_for(@word) do |f| %&gt;\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= f.label(:title, \"Word:\") %&gt;&lt;br&gt;\n      &lt;%= f.text_field(:title, id: \"new_word\", required: true, autofocus: true, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= f.label(:description, \"Definition:\") %&gt;&lt;br&gt;\n      &lt;%= f.text_area(:description, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n\n    &lt;% if current_user.word_list.categories.count &gt; 0 %&gt;\n      &lt;div class=\"field form-group\"&gt;\n        &lt;%= f.label(:categories, \"Choose from existing Categories:\") %&gt;&lt;br&gt;\n        &lt;%= f.collection_check_boxes(:category_ids, current_user.word_list.categories.all, :id, :title) %&gt;\n\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit(\"Update!\", class: \"btn btn-block btn-primary btn-lg\") %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note that I've moved the <code>collection_check_boxes</code> to the <code>@word</code>'s form builder, as you are hoping to build the \"categories\" value for the current <code>@word</code>. I think this should be a step in the right direction anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8284259, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KDiRRMVBLpE/AAAAAAAAAAI/AAAAAAAAAGc/cSnYIu5S79I/photo.jpg?sz=128", "display_name": "Harold Asai", "link": "https://stackoverflow.com/users/8284259/harold-asai"}, "is_accepted": false, "score": 3, "last_activity_date": 1607070741, "last_edit_date": 1607070741, "creation_date": 1502523583, "answer_id": 45647806, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form/45647806#45647806", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<p>The discussion might not be active anymore but I'll share my answer for the future visitors.</p>\n<p>Adding &quot;{ checked: @array.map(&amp;:to_param) }&quot; option as the last argument of collection_check_boxes may resolve your problem. Refer this <a href=\"https://github.com/bootstrap-ruby/rails-bootstrap-forms/issues/151\" rel=\"nofollow noreferrer\">link</a>.</p>\n<p>Example: <br/>\nSuppose you have Software model and Platform(OS) model and want to choose one or more OS that support your software.</p>\n<pre><code>#views/softwares/edit.html.erb\n\n&lt;%= form_for @software do |f| %&gt;\n  ...\n  &lt;%= f.label :supported_platform %&gt;\n  &lt;%= f.collection_check_boxes(:platform_ids, @platforms, :id, :platform_name, { checked: @software.platform_ids.map(&amp;:to_param) }) %&gt;\n  ...\n  &lt;%= f.submit &quot;Save&quot;, class: 'btn btn-success' %&gt;\n&lt;% end %&gt;\n</code></pre>\n<p>note: <br/>\n@software.platform_ids should be an array. If you are using SQLite, you have to convert string into array when you pull the data out. I tested it with SQLite and confirmed working as well. See <a href=\"http://www.letmefix-it.com/2017/08/11/how-to-use-collection_check_boxes-ruby-on-rails/\" rel=\"nofollow noreferrer\">my post</a> for more detail.</p>\n"}], "owner": {"reputation": 1603, "user_id": 4111480, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/efe2b8fc71222d6b38cf9f0e866a9878?s=128&d=identicon&r=PG&f=1", "display_name": "Yorkshireman", "link": "https://stackoverflow.com/users/4111480/yorkshireman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3004, "favorite_count": 0, "answer_count": 5, "score": 5, "last_activity_date": 1607070741, "creation_date": 1433968424, "last_edit_date": 1452179663, "question_id": 30766766, "link": "https://stackoverflow.com/questions/30766766/how-to-pre-populate-collection-check-boxes-in-an-edit-form", "title": "How to pre-populate collection_check_boxes in an edit form?", "body": "<p>GitHub repo: <a href=\"https://github.com/Yorkshireman/mywordlist\" rel=\"nofollow\">https://github.com/Yorkshireman/mywordlist</a></p>\n\n<p>I've googled the hell out of this one. I'm sure there's a way, possibly requiring some code inside a html options hash, but I can't work it out. Any ideas?</p>\n\n<p>When visiting the _edit_word_form.html.erb partial for a Word that DOES have one or more categories, the Categories checkboxes are all unchecked, requiring the user to select them again, even if they don't want to change the Categories.</p>\n\n<p>The text fields for the :title and :description ARE pre-populated (thankfully).</p>\n\n<p>_edit_word_form.html.erb:</p>\n\n<pre><code>&lt;%= form_for(@word) do %&gt;\n\n  &lt;%= fields_for :word, @word do |word_form| %&gt;\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= word_form.label(:title, \"Word:\") %&gt;&lt;br&gt;\n      &lt;%= word_form.text_field(:title, id: \"new_word\", required: true, autofocus: true, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= word_form.label(:description, \"Definition:\") %&gt;&lt;br&gt;\n      &lt;%= word_form.text_area(:description, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n\n  &lt;%= fields_for :category, @category do |category_form| %&gt;\n    &lt;% if current_user.word_list.categories.count &gt; 0 %&gt;\n      &lt;div class=\"field form-group\"&gt;\n        &lt;%= category_form.label(:title, \"Choose from existing Categories:\") %&gt;&lt;br&gt;\n        &lt;%= category_form.collection_check_boxes(:category_ids, current_user.word_list.categories.all, :id, :title) do |b| %&gt;\n          &lt;%= b.label(class: \"checkbox-inline\") { b.check_box + b.text } %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n    &lt;h4&gt;AND/OR...&lt;/h4&gt;\n\n    &lt;div class=\"field form-group\"&gt;\n      &lt;%= category_form.label(:title, \"Create and Use a New Category:\") %&gt;&lt;br&gt;\n      &lt;%= category_form.text_field(:title, class: \"form-control\") %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= submit_tag(\"Update!\", class: \"btn btn-block btn-primary btn-lg\") %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Relevant part of the words/index.html.erb:</p>\n\n<pre><code>&lt;% current_user.word_list.words.alphabetical_order_asc.each do |word| %&gt;\n              &lt;tr&gt;\n                &lt;td&gt;\n                  &lt;%= link_to edit_word_path(word) do %&gt;\n                    &lt;%= word.title %&gt;\n                    &lt;span class=\"glyphicon glyphicon-pencil\"&gt;&lt;/span&gt;\n                  &lt;% end %&gt;\n                &lt;/td&gt;\n                &lt;td&gt;&lt;%= word.description %&gt;&lt;/td&gt;\n                &lt;td&gt;\n                  &lt;% word.categories.alphabetical_order_asc.each do |category| %&gt;\n                    &lt;a class=\"btn btn-info btn-sm\", role=\"button\"&gt;\n                      &lt;%= category.title %&gt;\n                    &lt;/a&gt;\n                  &lt;% end %&gt;\n                &lt;/td&gt;\n                &lt;td&gt;\n                  &lt;%= link_to word, method: :delete, data: { confirm: 'Are you sure?' } do %&gt;\n                    &lt;span class=\"glyphicon glyphicon-remove\"&gt;&lt;/span&gt;\n                  &lt;% end %&gt;\n                &lt;/td&gt;\n              &lt;/tr&gt;\n            &lt;% end %&gt;\n</code></pre>\n\n<p>words_controller.rb:</p>\n\n<pre><code>class WordsController &lt; ApplicationController\n  before_action :set_word, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_user!\n\n  # GET /words\n  # GET /words.json\n  def index\n    @words = Word.all\n    @quotes = Quote.all\n  end\n\n  # GET /words/1\n  # GET /words/1.json\n  def show\n  end\n\n  # GET /words/new\n  def new\n    @word = current_user.word_list.words.build\n  end\n\n  # GET /words/1/edit\n  def edit\n  end\n\n  # POST /words\n  # POST /words.json\n  def create\n    @word = Word.new(word_params)\n\n    respond_to do |format|\n      if @word.save\n        format.html { redirect_to @word, notice: 'Word was successfully created.' }\n        format.json { render :show, status: :created, location: @word }\n      else\n        format.html { render :new }\n        format.json { render json: @word.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /words/1\n  # PATCH/PUT /words/1.json\n  def update\n    #need to first remove categories from the word\n    @word.categories.each do |category|\n      @word.categories.delete category\n    end\n\n    #then push categories in from the category_params\n    if params[\"category\"].include?(:category_ids)\n      (params[\"category\"])[\"category_ids\"].each do |i|\n        next if i.to_i == 0\n        @word.categories &lt;&lt; Category.find(i.to_i) unless @word.categories.include?(Category.find(i.to_i))\n      end\n    end\n\n    if category_params.include?(:title) &amp;&amp; ((params[\"category\"])[\"title\"]) != \"\"\n      @word.categories &lt;&lt; current_user.word_list.categories.build(title: (params[\"category\"])[\"title\"])\n    end\n\n    respond_to do |format|\n      if @word.update(word_params)\n        format.html { redirect_to words_path, notice: 'Word was successfully updated.' }\n        format.json { render :show, status: :ok, location: @word }\n      else\n        format.html { render :edit }\n        format.json { render json: @word.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /words/1\n  # DELETE /words/1.json\n  def destroy\n    @word.destroy\n    respond_to do |format|\n      format.html { redirect_to words_url, notice: 'Word was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_word\n      @word = Word.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def word_params\n      params.require(:word).permit(:title, :description, :category_ids)\n    end\n\n    def category_params\n      params.require(:category).permit(:title, :category_ids, :category_id)\n    end\nend\n</code></pre>\n\n<p>categories_controller.rb:</p>\n\n<pre><code>class CategoriesController &lt; ApplicationController\n  before_action :set_category, only: [:show, :edit, :update, :destroy]\n\n  # GET /categories\n  # GET /categories.json\n  def index\n    @categories = Category.all\n  end\n\n  # GET /categories/1\n  # GET /categories/1.json\n  def show\n  end\n\n  # GET /categories/new\n  def new\n    @category = current_user.word_list.categories.build\n  end\n\n  # GET /categories/1/edit\n  def edit\n  end\n\n  # POST /categories\n  # POST /categories.json\n  def create\n    @category = Category.new(category_params)\n\n    respond_to do |format|\n      if @category.save\n        format.html { redirect_to @category, notice: 'Category was successfully created.' }\n        format.json { render :show, status: :created, location: @category }\n      else\n        format.html { render :new }\n        format.json { render json: @category.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /categories/1\n  # PATCH/PUT /categories/1.json\n  def update\n    respond_to do |format|\n      if @category.update(category_params)\n        format.html { redirect_to @category, notice: 'Category was successfully updated.' }\n        format.json { render :show, status: :ok, location: @category }\n      else\n        format.html { render :edit }\n        format.json { render json: @category.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /categories/1\n  # DELETE /categories/1.json\n  def destroy\n    @category.destroy\n    respond_to do |format|\n      format.html { redirect_to categories_url, notice: 'Category was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_category\n      @category = Category.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def category_params\n      params.require(:category).permit(:title, :word_list_id, :category_ids)\n    end\nend\n</code></pre>\n\n<p>word_lists_controller.rb:</p>\n\n<pre><code>class WordListsController &lt; ApplicationController\n  before_action :set_word_list, only: [:show, :edit, :update, :destroy]\n\n\n  def from_category\n    @selected = current_user.word_list.words.joins(:categories).where( categories: {id: (params[:category_id])} )\n    respond_to do |format|\n      format.js\n    end\n  end\n\n  def all_words\n    respond_to do |format|\n      format.js\n    end\n  end\n\n  # GET /word_lists\n  # GET /word_lists.json\n  def index\n    @word_lists = WordList.all\n  end\n\n  # GET /word_lists/1\n  # GET /word_lists/1.json\n  def show\n    @words = Word.all\n    @word_list = WordList.find(params[:id])\n  end\n\n  # GET /word_lists/new\n  def new\n    @word_list = WordList.new\n  end\n\n  # GET /word_lists/1/edit\n  def edit\n  end\n\n  # POST /word_lists\n  # POST /word_lists.json\n  def create\n    @word_list = WordList.new(word_list_params)\n\n    respond_to do |format|\n      if @word_list.save\n        format.html { redirect_to @word_list, notice: 'Word list was successfully created.' }\n        format.json { render :show, status: :created, location: @word_list }\n      else\n        format.html { render :new }\n        format.json { render json: @word_list.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /word_lists/1\n  # PATCH/PUT /word_lists/1.json\n  def update\n    respond_to do |format|\n      if @word_list.update(word_list_params)\n        format.html { redirect_to @word_list, notice: 'Word list was successfully updated.' }\n        format.json { render :show, status: :ok, location: @word_list }\n      else\n        format.html { render :edit }\n        format.json { render json: @word_list.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /word_lists/1\n  # DELETE /word_lists/1.json\n  def destroy\n    @word_list.destroy\n    respond_to do |format|\n      format.html { redirect_to word_lists_url, notice: 'Word list was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_word_list\n      @word_list = WordList.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def word_list_params\n      params[:word_list]\n    end\nend\n</code></pre>\n\n<p>word_list.rb:</p>\n\n<pre><code>class WordList &lt; ActiveRecord::Base\n\n    belongs_to :user\n\n    has_many :words\n\n    has_many :categories\n\nend\n</code></pre>\n\n<p>word.rb:</p>\n\n<pre><code>class Word &lt; ActiveRecord::Base\n\n  belongs_to :word_list\n\n  has_and_belongs_to_many :categories\n\n  validates :title, presence: true\n\n  scope :alphabetical_order_asc, -&gt; { order(\"title ASC\") }\n\nend\n</code></pre>\n\n<p>category.rb:</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n\n    has_and_belongs_to_many :words\n\n    belongs_to :word_list\n\n    validates :title, presence: true\n\n    scope :alphabetical_order_asc, -&gt; { order(\"title ASC\") }\n\nend\n</code></pre>\n\n<p>schema.rb:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20150609234013) do\n\n  create_table \"categories\", force: :cascade do |t|\n    t.string   \"title\"\n    t.datetime \"created_at\",   null: false\n    t.datetime \"updated_at\",   null: false\n    t.integer  \"word_list_id\"\n  end\n\n  add_index \"categories\", [\"word_list_id\"], name: \"index_categories_on_word_list_id\"\n\n  create_table \"categories_words\", id: false, force: :cascade do |t|\n    t.integer \"category_id\"\n    t.integer \"word_id\"\n  end\n\n  add_index \"categories_words\", [\"category_id\"], name: \"index_categories_words_on_category_id\"\n  add_index \"categories_words\", [\"word_id\"], name: \"index_categories_words_on_word_id\"\n\n  create_table \"quotes\", force: :cascade do |t|\n    t.text     \"content\"\n    t.string   \"author\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n\n  create_table \"users\", force: :cascade do |t|\n    t.string   \"email\",                  default: \"\", null: false\n    t.string   \"encrypted_password\",     default: \"\", null: false\n    t.string   \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer  \"sign_in_count\",          default: 0,  null: false\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\"\n    t.string   \"last_sign_in_ip\"\n    t.datetime \"created_at\",                          null: false\n    t.datetime \"updated_at\",                          null: false\n  end\n\n  add_index \"users\", [\"email\"], name: \"index_users_on_email\", unique: true\n  add_index \"users\", [\"reset_password_token\"], name: \"index_users_on_reset_password_token\", unique: true\n\n  create_table \"word_lists\", force: :cascade do |t|\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer  \"user_id\"\n  end\n\n  create_table \"words\", force: :cascade do |t|\n    t.string   \"title\"\n    t.text     \"description\"\n    t.datetime \"created_at\",   null: false\n    t.datetime \"updated_at\",   null: false\n    t.integer  \"word_list_id\"\n  end\n\n  add_index \"words\", [\"word_list_id\"], name: \"index_words_on_word_list_id\"\n\nend\n</code></pre>\n\n<p>routes.rb:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :quotes\n  resources :categories\n  resources :words\n  devise_for :users, controllers: { registrations: \"users/registrations\" }\n\n  # The priority is based upon order of creation: first created -&gt; highest priority.\n  # See how all your routes lay out with \"rake routes\".\n\n  # You can have the root of your site routed with \"root\"\n  # root 'welcome#index'\n  root 'pages#home'\n\n  post 'create_word_and_category' =&gt; 'new_word#create_word_and_category'\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "string", "environment-variables", "rake"], "answers": [{"comments": [{"owner": {"reputation": 838, "user_id": 3904392, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/655c5717c3eaed5807ab199604a096ad?s=128&d=identicon&r=PG", "display_name": "shroy", "link": "https://stackoverflow.com/users/3904392/shroy"}, "edited": false, "score": 0, "creation_date": 1433968396, "post_id": 30766643, "comment_id": 49585592, "body": "Just tried it and still doesn&#39;t work. <code>FG_DOMAIN</code> still outputs as double-string."}], "tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": false, "score": 0, "last_activity_date": 1433967959, "creation_date": 1433967959, "answer_id": 30766643, "question_id": 30766597, "link": "https://stackoverflow.com/questions/30766597/rails-env-variable-failure-outputs-double-string/30766643#30766643", "title": "Rails: ENV variable failure outputs double string", "body": "<p>Remove the quotes from the export statements.  They should look like:</p>\n\n<pre><code>export FG_PASSWORD=mysecret\nexport FG_USERNAME=username@secret.com\nexport FG_DOMAIN=secret\n</code></pre>\n"}], "owner": {"reputation": 838, "user_id": 3904392, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/655c5717c3eaed5807ab199604a096ad?s=128&d=identicon&r=PG", "display_name": "shroy", "link": "https://stackoverflow.com/users/3904392/shroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433967959, "creation_date": 1433967836, "question_id": 30766597, "link": "https://stackoverflow.com/questions/30766597/rails-env-variable-failure-outputs-double-string", "title": "Rails: ENV variable failure outputs double string", "body": "<p>I have a rake task that requires 3 of my environment variables. 2 of them pass fine but one keeps outputting inside a double-string causing an error. </p>\n\n<p>Here is a what I have in my <code>.bash_profile</code></p>\n\n<pre><code>export FG_PASSWORD=\u201cmysecret\u201d\nexport FG_USERNAME=\u201cusername@secret.com\u201d\nexport FG_DOMAIN=\u201csecret\u201d\n</code></pre>\n\n<p>In Rails I setup them up here..</p>\n\n<p><strong>config/initializers/api.rb</strong></p>\n\n<pre><code>FG_PASSWORD = ENV[\"FG_PASSWORD\"]\nFG_USERNAME = ENV[\"FG_USERNAME\"]\nFG_DOMAIN = ENV[\"FG_DOMAIN\"]\n</code></pre>\n\n<p>My rake task...</p>\n\n<p><strong>lib/rake/upload_files.rake</strong></p>\n\n<pre><code>namespace :upload_files do\n    task :upload_base =&gt; :environment do\n        c = Foldergrid::Connection.new(FG_PASSWORD, FG_USERNAME, FG_DOMAIN)\n        p FG_DOMAIN\n\n        ....some code...\n    end\nend\n</code></pre>\n\n<p>The culprit is the <code>FG_DOMAIN</code>. It works when hard-coded. The <code>p FG_DOMAIN</code> line outputs the variable as <code>\"\"secret\"\"</code> hence the double-string. </p>\n\n<p>Any insight?</p>\n"}, {"tags": ["arrays", "ruby", "string", "boolean"], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "edited": false, "score": 0, "creation_date": 1433968198, "post_id": 30766612, "comment_id": 49585463, "body": "Got it, thanks! I just assumed it would logically &quot;a&quot; seemed smaller than &quot;Z&quot;, should have looked it up. :]"}], "tags": [], "owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "is_accepted": true, "score": 1, "last_activity_date": 1433968217, "last_edit_date": 1433968217, "creation_date": 1433967873, "answer_id": 30766612, "question_id": 30766374, "link": "https://stackoverflow.com/questions/30766374/checking-strings/30766612#30766612", "title": "Checking strings", "body": "<ul>\n<li><p>\"Z\" is <a href=\"http://www.ascii-code.com/\" rel=\"nofollow\">smaller</a> than \"a\".</p></li>\n<li><p>If both sides must to be <code>+</code>, and you check for mismatch, the logical connection is OR (= if either of those things are true).</p>\n\n<pre><code>if ((str_array[i-1] != \"+\") || (str_array[i+1] != \"+\"))\n</code></pre></li>\n</ul>\n\n<p>note: you don't need to <code>split</code>, you can index into strings.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1433968007, "creation_date": 1433968007, "answer_id": 30766660, "question_id": 30766374, "link": "https://stackoverflow.com/questions/30766374/checking-strings/30766660#30766660", "title": "Checking strings", "body": "<p>This is best handled by a regular expression:</p>\n\n<pre><code>def simple_symbol?(str)\n  !!str.match(/\\A(\\+[a-zA-Z](?:\\+[a-zA-Z])*\\+)\\z/)\nend\n\n[\n  '+a+b+c+',\n  '+a+b+c',\n  'a+b',\n  'abc++d+',\n  '+',\n  'abc',\n  ''\n].each do |string|\n  puts '%-12s %s' % [ string, simple_symbol?(string) ]\nend\n\n# =&gt; +a+b+c+      true\n# =&gt; +a+b+c       false\n# =&gt; a+b          false\n# =&gt; abc++d+      false\n# =&gt; +            false\n# =&gt; abc          false\n# =&gt;              false\n</code></pre>\n\n<p>Note that Ruby's convention for method names is to use <code>underscore_type_names</code>, as <code>CamelCase</code> is reserved for classes and modules.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1433997858, "creation_date": 1433997858, "answer_id": 30771741, "question_id": 30766374, "link": "https://stackoverflow.com/questions/30766374/checking-strings/30771741#30771741", "title": "Checking strings", "body": "<p>I agree with @tadman that a regular expression should be used here. Here's another way, that looks for a letter that is not bracketed by <code>+</code>'s:</p>\n\n<pre><code>R = /\n    (?:     # begin a non-capture group\n      \\A    # match beginning of string\n      |     # or\n      [^+] # match any character other than +\n    )       # end non-capture group\n    [a-b]   # match a letter\n    |       # or\n    [a-b]   # match a letter\n    (?:     # begin a non-capture group\n      [^+] # match any character other than +\n      |     # or\n      \\z    # match end of string\n    )       # end non-capture group\n    /xi     # use extended mode (x) and make case insensitive (i)\n\ndef letters_bracketed?(str)\n   str !~ R\nend\n\nletters_bracketed?('+a+')         #=&gt; true \nletters_bracketed?('+a+b+')       #=&gt; true \nletters_bracketed?('+a+937+b+!!') #=&gt; true \nletters_bracketed?('a+b+')        #=&gt; false \nletters_bracketed?('+a+b')        #=&gt; false \nletters_bracketed?('+?a+b+')      #=&gt; false \nletters_bracketed?('+ab+')        #=&gt; false \n</code></pre>\n\n<p>Note that <code>+</code> need not be escaped in a character class.</p>\n"}], "owner": {"reputation": 551, "user_id": 4613575, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/94ee57c5cea9f3b94b68b7e5cf76369e?s=128&d=identicon&r=PG&f=1", "display_name": "hackrnaut", "link": "https://stackoverflow.com/users/4613575/hackrnaut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 30766612, "answer_count": 3, "score": 0, "last_activity_date": 1433997858, "creation_date": 1433967090, "question_id": 30766374, "link": "https://stackoverflow.com/questions/30766374/checking-strings", "title": "Checking strings", "body": "<p>The function is supposed to return true only if all letters have \"+\" on both sides, but I always get true as my value... What's the flaw in my code?</p>\n\n<pre><code>def SimpleSymbol?(str)\nstr_array = str.split(\"\")\ni = 0\nwhile i &lt; str_array.length-1\n    if ((str_array[i]  &gt;= \"a\") &amp;&amp; (str_array[i] &lt;= \"Z\"))\n        if  ((i == 0) || (i == str_array.length-1))\n            return false\n        end\n\n        if ((str_array[i-1] != \"+\") &amp;&amp; (str_array[i+1] != \"+\"))\n            return false \n        end\n\n    end\ni += 1\nend\n\nreturn true\nend\n\nputs SimpleSymbol?(\"ads++d+\")\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 1086, "user_id": 1327379, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZrNi8.jpg?s=128&g=1", "display_name": "andreofthecape", "link": "https://stackoverflow.com/users/1327379/andreofthecape"}, "is_accepted": true, "score": 0, "last_activity_date": 1434041272, "creation_date": 1434041272, "answer_id": 30786757, "question_id": 30766331, "link": "https://stackoverflow.com/questions/30766331/rails-give-a-value-to-a-variable/30786757#30786757", "title": "Rails give a value to a variable", "body": "<p>Not sure if I understand the whole problem here, but you can remove 'name' from the Section schema and just use a method to infer the value:</p>\n\n<pre><code>#Section.rb\ndef name\n  \"#{loc_dep} - #{loc_arr}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4915624, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/990798734264208/picture?type=large", "display_name": "Furla94", "link": "https://stackoverflow.com/users/4915624/furla94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 30786757, "answer_count": 1, "score": 0, "last_activity_date": 1434041272, "creation_date": 1433966949, "last_edit_date": 1433968186, "question_id": 30766331, "link": "https://stackoverflow.com/questions/30766331/rails-give-a-value-to-a-variable", "title": "Rails give a value to a variable", "body": "<p>I'm doing a web page in rails were a driver can select a bus stop, I have the models driver.rb , reservation.rb and sections.rb.\nWhen a driver watches the list of the reservations I want him to be able to see the name of the section. I use the delegate method to use the section name.\nThe problem is that I want to assign at the name the value of the attributes loc_dep and loc_arr (both are strings).\nHere is the code:</p>\n\n<p>driver.rb</p>\n\n<pre><code>class Driver &lt; ActiveRecord::Base\n    before_save { self.email = email.downcase }\n    has_many :reservations\n    has_secure_password\n    attr_accessible :name, :surname, :address, :birth_date, :id,\n                    :email, :password, :password_confirmation\n    validates_uniqueness_of :email\n    validates :password, :length =&gt; { :minimum =&gt; 5 } , length: { maximum: 20 }\n    validates :name, presence: true, length: { maximum: 20 }\n    validates :surname, presence: true, length: { maximum: 20 }\n    validates :email, presence: true, length: { maximum: 50 }, uniqueness: { case_sensitive: false }\n    validates :birth_date, presence: true              \nend\n</code></pre>\n\n<p>reservation.rb</p>\n\n<pre><code>class Reservation &lt; ActiveRecord::Base\n    belongs_to :driver\n    belongs_to :section\n    belongs_to :leaving\n    attr_accessible :id, :date, :section_id, :driver_id, :leaving_id\n    delegate :name, :to =&gt; :driver, prefix: true, :allow_nil =&gt; false\n    delegate :name, :to =&gt; :section, prefix: true, :allow_nil =&gt; false\nend\n</code></pre>\n\n<p>section.rb</p>\n\n<pre><code>class Section &lt; ActiveRecord::Base\n    self.inheritance_column = nil\n    has_many :reservations\n    has_many :stops\n    has_one :leaving\n    attr_accessible :id, :loc_dep, :loc_arr, :type, :time, :leaving_id, :name\n    validates :type, inclusion: { in: %w(weekday holiday daily scholastic)} , :allow_nil =&gt; false\n    validates :loc_dep, presence: true\n    validates :loc_arr, presence: true\n    validates :time, presence: true\n    def as_field \n        \"#{loc_dep} - #{loc_arr} (#{type} - #{time} min)\"\n    end \nend\n</code></pre>\n\n<p>reservation_controller.rb</p>\n\n<pre><code>class ReservationsController &lt; ApplicationController\n  before_action :set_reservation, only: [:show, :edit, :update, :destroy]\n\n  # GET /reservations\n  # GET /reservations.json\n  def index\n    if current_driver.admin\n        @reservations = Reservation.all\n    else\n        @reservations = current_driver.reservations\n    end \n  end\n\n  # GET /reservations/1\n  # GET /reservations/1.json\n  def show\n  end\n\n  # GET /reservations/new\n  def new\n    @reservation = Reservation.new\n  end\n\n  # GET /reservations/1/edit\n  def edit\n   @sections=Section.all\n  end\n\n  # POST /reservations\n  # POST /reservations.json\n  def create\n    @reservation = current_driver.reservations.build(reservation_params)\n    respond_to do |format|\n      if @reservation.save\n        format.html { redirect_to @reservation, notice: 'Reservation was successfully created.' }\n        format.json { render :show, status: :created, location: @reservation }\n      else\n        format.html { render :new }\n        format.json { render json: @reservation.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /reservations/1\n  # PATCH/PUT /reservations/1.json\n  def update\n    respond_to do |format|\n      if @reservation.update(reservation_params)\n        format.html { redirect_to @reservation, notice: 'Reservation was successfully updated.' }\n        format.json { render :show, status: :ok, location: @reservation }\n      else\n        format.html { render :edit }\n        format.json { render json: @reservation.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /reservations/1\n  # DELETE /reservations/1.json\n  def destroy\n    @reservation.destroy\n    respond_to do |format|\n      format.html { redirect_to reservations_url, notice: 'Reservation was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_reservation\n      @reservation = Reservation.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    private\n    def reservation_params\n      params.require(:reservation).permit(:date, :section_id)\n    end\nend\n</code></pre>\n\n<p>For example:\nSection(loc_dep=\"New York\" , loc_arr=\"Boston\" , type=\"scholastic\", time=\"50\") ---> all values are selected by the driver</p>\n\n<p>I want the name to have the value \"New York - Boston\".</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "tweetstream"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3712330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c89a9baa3b8d9cdbc769f855aa34a98?s=128&d=identicon&r=PG&f=1", "display_name": "StephenMcMurtry", "link": "https://stackoverflow.com/users/3712330/stephenmcmurtry"}, "edited": false, "score": 0, "creation_date": 1433967696, "post_id": 30766223, "comment_id": 49585132, "body": "This is good information, especially what exactly can be shown in the view (db call, helper, instance variable).  However, I want to run the stream persistently in the background and receive updated counts whenever I refresh the view.  This makes me thing that the controller shouldn&#39;t be the one operating the stream, but I&#39;m still lost beyond that."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 3712330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c89a9baa3b8d9cdbc769f855aa34a98?s=128&d=identicon&r=PG&f=1", "display_name": "StephenMcMurtry", "link": "https://stackoverflow.com/users/3712330/stephenmcmurtry"}, "edited": false, "score": 0, "creation_date": 1433968130, "post_id": 30766223, "comment_id": 49585423, "body": "There&#39;s nothing wrong with the controller operating the stream directly, but it&#39;s got to ensure that the stream doesn&#39;t run forever. If you&#39;re using <a href=\"https://github.com/tweetstream/tweetstream\" rel=\"nofollow noreferrer\">this module</a>, then that appears to be EventMachine-based and may not play nicely inside your Rails application. The standard pattern to apply here is to have a polling script that writes things to a database, and the controller retrieves those things for display. ActiveRecord makes that pretty easy to do."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1433966635, "creation_date": 1433966635, "answer_id": 30766223, "question_id": 30766070, "link": "https://stackoverflow.com/questions/30766070/where-in-rails-project-to-place-code/30766223#30766223", "title": "Where in Rails Project to Place Code", "body": "<p>There's a few things you need to keep in mind when creating controller code:</p>\n\n<ul>\n<li>Everything you want to appear in a view must be provided by a database call, a helper method or an instance variable.</li>\n<li>The controller must complete whatever operation it's scheduled to perform in a timely manner. Infinite loops and long running operations taking several minutes are severely problematic.</li>\n<li>Views can do their own computation, generally they're free to run arbitrary Ruby code, but it's considered bad form to do the heavy lifting there as that's the primary responsibility of the controller.</li>\n</ul>\n\n<p>So in general terms, your controller code might look like:</p>\n\n<pre><code>def index\n  @client = Twitter::Streaming::Client.new do |config|\n    # ... (Configuration)\n  end\n\n  @count = 0\n  @geo = 0\n\n  client.filter(track: \"cat\") do |tweet|\n    @count += 1\n\n    if (tweet.place)\n      @geo += 1\n    end\n\n    break if (@count &gt; 10)\n  end\nend\n</code></pre>\n\n<p>This presumes the <code>client.filter</code> operation can produce ten results in a short period of time.</p>\n"}], "owner": {"reputation": 11, "user_id": 3712330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c89a9baa3b8d9cdbc769f855aa34a98?s=128&d=identicon&r=PG&f=1", "display_name": "StephenMcMurtry", "link": "https://stackoverflow.com/users/3712330/stephenmcmurtry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433966635, "creation_date": 1433966122, "question_id": 30766070, "link": "https://stackoverflow.com/questions/30766070/where-in-rails-project-to-place-code", "title": "Where in Rails Project to Place Code", "body": "<p>I am attempting to classify whether or not tweets are geo-tagged based on certain keywords using the Ruby Twitter Gem.  I can do this just fine from the rails console, but I went to reflect my findings in a view, and I just don't know how to do that.</p>\n\n<p>Here is what I am doing on the command line:</p>\n\n<p>I begin by setting up my streaming client:</p>\n\n<pre><code>client = Twitter::Streaming::Client.new do |config|\n  config.consumer_key        = \"MYCODE\"\n  config.consumer_secret     = \"NOTYOURS\"\n  config.access_token        = \"HANSHOT\"\n  config.access_token_secret = \"FIRST\"\nend\n</code></pre>\n\n<p>Then I initialize my counts:</p>\n\n<pre><code>count = 0\ngeo = 0\n</code></pre>\n\n<p>And finally I paste in my brief script and run enter:</p>\n\n<pre><code>client.filter(:track =&gt; \"cat\") do |tweet|\n    count += 1\n\n    if(tweet.place.nil?)\n      # Do nothing\n    else\n      geo += 1\n    end\nend\n</code></pre>\n\n<p>To access my results, I need to Ctrl+C and type 'geo' or 'count' into the console.</p>\n\n<p>In an ideal world, I'd have a view that displayed the count and geo numbers.  Said view would refresh with the updated numbers whenever I refreshed the view.</p>\n\n<p>I tried throwing this in a controller, but then the page never loads, because presumably, the controller is infinitely parsing the stream and never gets a chance to render.</p>\n\n<p>I stuck it in a model file, but that also did nothing.</p>\n\n<p>So, am I going about this the totally wrong way?  Is getting these numbers impossible from anywhere but the IRB?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "answers": [{"tags": [], "owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "is_accepted": false, "score": 0, "last_activity_date": 1433968736, "creation_date": 1433968736, "answer_id": 30766860, "question_id": 30766016, "link": "https://stackoverflow.com/questions/30766016/do-sidekiq-jobs-run-inside-a-large-transaction/30766860#30766860", "title": "Do sidekiq jobs run inside a large transaction?", "body": "<p>No.  You control the DB transactional boundaries within the perform method using <code>Model.transaction { }</code>.  Sidekiq never touches the database.</p>\n"}, {"tags": [], "owner": {"reputation": 200, "user_id": 1068754, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/60bd932f4071e624f8a4f1b45a32219b?s=128&d=identicon&r=PG", "display_name": "ancoanco", "link": "https://stackoverflow.com/users/1068754/ancoanco"}, "is_accepted": true, "score": 1, "last_activity_date": 1433975122, "creation_date": 1433975122, "answer_id": 30768366, "question_id": 30766016, "link": "https://stackoverflow.com/questions/30766016/do-sidekiq-jobs-run-inside-a-large-transaction/30768366#30768366", "title": "Do sidekiq jobs run inside a large transaction?", "body": "<p>No, Sidekiq does not inherently wrap it's jobs in a transaction. Ensure you don't have your loop, or the method calling your loop, wrapped in a transaction.</p>\n"}], "owner": {"reputation": 3027, "user_id": 1005669, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ohqRg.jpg?s=128&g=1", "display_name": "Robbie Guilfoyle", "link": "https://stackoverflow.com/users/1005669/robbie-guilfoyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "accepted_answer_id": 30768366, "answer_count": 2, "score": 0, "last_activity_date": 1433975122, "creation_date": 1433965986, "question_id": 30766016, "link": "https://stackoverflow.com/questions/30766016/do-sidekiq-jobs-run-inside-a-large-transaction", "title": "Do sidekiq jobs run inside a large transaction?", "body": "<p>I have a large record import job running on our web application. The import is run by a PORO which calculates how many objects it needs to import and divides the number by an index of the current object it is presently on, leaving me with a clean way to calculate the percentage complete. After it does this calculation I am saving this percentage to the database in order to poll it and let the user know how far along this import has come. </p>\n\n<p>It doesn't appear that sidekiq allows for these database writes to touch the database until the entire job is over, leaving me with this quesiton: </p>\n\n<p><strong>Is every sidekiq job wrapped entirely in a transaction?</strong></p>\n\n<p><em>(I'm not lazy I just don't have a lot of time to go through the code and discover this myself.)</em></p>\n"}, {"tags": ["ruby", "tdd", "cucumber", "bdd", "gherkin"], "answers": [{"tags": [], "owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "is_accepted": false, "score": 0, "last_activity_date": 1433965629, "creation_date": 1433965629, "answer_id": 30765912, "question_id": 30765683, "link": "https://stackoverflow.com/questions/30765683/is-there-a-way-to-create-a-custom-cucumber-formatter-that-prints-the-given-when/30765912#30765912", "title": "Is there a way to create a custom cucumber formatter that prints the Given, When and Then steps", "body": "<p>A good example of this is to use cucumbers own included formatters as examples.</p>\n\n<p><a href=\"https://github.com/cucumber/cucumber/tree/master/lib/cucumber/formatter\" rel=\"nofollow\">https://github.com/cucumber/cucumber/tree/master/lib/cucumber/formatter</a></p>\n\n<p>Take a look at the <a href=\"https://github.com/cucumber/cucumber/blob/master/lib/cucumber/formatter/pretty.rb\" rel=\"nofollow\">\"pretty\" formatter</a>. It likely has most of what you need.</p>\n\n<p>Of particular interest to your question are the methods:</p>\n\n<ul>\n<li>before_step</li>\n<li>before_step_result</li>\n<li>step_name</li>\n</ul>\n"}], "owner": {"reputation": 1094, "user_id": 2386620, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/65ad9f1a1aafff45f439ab9d622e00ac?s=128&d=identicon&r=PG", "display_name": "adbarads", "link": "https://stackoverflow.com/users/2386620/adbarads"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 679, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433965629, "creation_date": 1433964887, "question_id": 30765683, "link": "https://stackoverflow.com/questions/30765683/is-there-a-way-to-create-a-custom-cucumber-formatter-that-prints-the-given-when", "title": "Is there a way to create a custom cucumber formatter that prints the Given, When and Then steps", "body": "<p>I am trying to create a customer cucumber formatter and found this: <a href=\"http://www.relishapp.com/cucumber/cucumber/docs/extending-cucumber/custom-formatter\" rel=\"nofollow\">http://www.relishapp.com/cucumber/cucumber/docs/extending-cucumber/custom-formatter</a></p>\n\n<p>I noticed the documentation provided an example that only showed how to print the \"Feature\" name and \"Scenario\" name.</p>\n\n<p>I am trying to also print the Given, When, and Then steps. Can someone provide me an example of that?</p>\n"}, {"tags": ["ruby", "heroku", "sinatra", "heroku-postgres", "sinatra-activerecord"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 1, "creation_date": 1433965305, "post_id": 30765662, "comment_id": 49583790, "body": "Can you log the entire HTTP response header your server creates for <code>&#47;login</code> before its sent?"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1433965988, "post_id": 30765662, "comment_id": 49584190, "body": "How would I do that?"}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1433966195, "post_id": 30765662, "comment_id": 49584289, "body": "I am not familiar with Ruby, so I couldn&#39;t say, but in node.js you&#39;d do something like <code>console.log(JSON.stringify(res.headers));</code>"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1433966421, "post_id": 30765662, "comment_id": 49584397, "body": "I do not know how to do that, but will look into it."}, {"owner": {"reputation": 154, "user_id": 4656475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7oAWq.jpg?s=128&g=1", "display_name": "Zara Kay", "link": "https://stackoverflow.com/users/4656475/zara-kay"}, "edited": false, "score": 0, "creation_date": 1433978462, "post_id": 30765662, "comment_id": 49589947, "body": "Have you tried reading the Heroku documentation <a href=\"https://devcenter.heroku.com/articles/error-codes#h17-poorly-formatted-http-response\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "edited": false, "score": 0, "creation_date": 1433988954, "post_id": 30765662, "comment_id": 49592555, "body": "I doesn&#39;t give any advise on how to fix the error, at least as far as I read. If you see something I didn&#39;t please let me."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 1981108, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/2vg8f.jpg?s=128&g=1", "display_name": "Brett C", "link": "https://stackoverflow.com/users/1981108/brett-c"}, "edited": false, "score": 2, "creation_date": 1459426435, "post_id": 30803226, "comment_id": 60288213, "body": "sounds like <code>heroku restart</code> is what fixed it, not the irrelevant edits."}, {"owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "reply_to_user": {"reputation": 251, "user_id": 1981108, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/2vg8f.jpg?s=128&g=1", "display_name": "Brett C", "link": "https://stackoverflow.com/users/1981108/brett-c"}, "edited": false, "score": 0, "creation_date": 1459427382, "post_id": 30803226, "comment_id": 60288952, "body": "@BrettC Thats what I think too"}], "tags": [], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "is_accepted": true, "score": 1, "last_activity_date": 1472565589, "last_edit_date": 1472565589, "creation_date": 1434112530, "answer_id": 30803226, "question_id": 30765662, "link": "https://stackoverflow.com/questions/30765662/lots-of-h17-heroku-errors/30803226#30803226", "title": "Lots of H17 Heroku Errors", "body": "<p>I solved my problem by just making some other irrelevant edits and pushing to heroku again which caused a dyno restart which is what I believe solved the problem. Now it works just fine. If anyone can come up with an explanation for this that would be much appreciated.</p>\n\n<p>And if it could be added as an answer it would be accepted! I find this very weird.</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 1248595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd4d48e31256493bfb75042a7a97f2b?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1248595/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1438777130, "creation_date": 1438777130, "answer_id": 31832332, "question_id": 30765662, "link": "https://stackoverflow.com/questions/30765662/lots-of-h17-heroku-errors/31832332#31832332", "title": "Lots of H17 Heroku Errors", "body": "<p>In my case this was happening with a POST request to which my dyno was not returning a response code. It was fixed by returning a valid response code, such as 200. For example:</p>\n\n<pre><code>post '/user/:user_id/favourites/:item_id' do\n\n  [add the favourite, and if successful...]\n\n  200\n\nend\n</code></pre>\n"}], "owner": {"reputation": 1887, "user_id": 4948732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ZnN3lJjklJg/AAAAAAAAAAI/AAAAAAAAAWE/zqGtDAyXfjo/photo.jpg?sz=128", "display_name": "thesecretmaster", "link": "https://stackoverflow.com/users/4948732/thesecretmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "accepted_answer_id": 30803226, "answer_count": 2, "score": 4, "last_activity_date": 1472565614, "creation_date": 1433964828, "last_edit_date": 1472565614, "question_id": 30765662, "link": "https://stackoverflow.com/questions/30765662/lots-of-h17-heroku-errors", "title": "Lots of H17 Heroku Errors", "body": "<p>I am working on a ruby project using sinatra, heroku, activerecord, and postgresql. I am consistantly getting this error:</p>\n\n<pre><code>2015-06-10T19:30:52.015492+00:00 heroku[router]: http_error=\"Invalid HTTP status line\" at=error code=H17 desc=\"Poorly formatted HTTP response\" method=POST path=\"/login\" host=myapp.herokuapp.com request_id=e5c29131-1c22-47d7-84a4-b1b51e4a3905 fwd=\"74.71.233.85\" dyno=web.1 connect=1ms service=135ms status=503 bytes=862\n</code></pre>\n\n<p>I cannot find out how to fix it. If anyone needs any more information to fix it, I would be happy to provide it.</p>\n"}, {"tags": ["php", "ruby"], "comments": [{"owner": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 1, "creation_date": 1433965043, "post_id": 30765604, "comment_id": 49583662, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/4619996/how-to-run-ruby-python-scripts-from-inside-php-passing-and-receiving-parameters\">How to run Ruby/Python scripts from inside PHP passing and receiving parameters?</a>"}, {"owner": {"reputation": 11433, "user_id": 571648, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c8aa5f38b7aee1d95b797718d38cf45?s=128&d=identicon&r=PG", "display_name": "erdomester", "link": "https://stackoverflow.com/users/571648/erdomester"}, "reply_to_user": {"reputation": 5139, "user_id": 1735262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Reinstate Monica -- notmaynard", "link": "https://stackoverflow.com/users/1735262/reinstate-monica-notmaynard"}, "edited": false, "score": 0, "creation_date": 1433965265, "post_id": 30765604, "comment_id": 49583763, "body": "That is a fantastic tutorial to send and receive data and that&#39;s where I come from. I tried it, received <code>command returned 1</code> message so I decided to try out the simple script. And here I am now."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433970710, "post_id": 30765604, "comment_id": 49586892, "body": "Looks like you&#39;re not allowed to read that file as the user running the PHP script."}, {"owner": {"reputation": 11433, "user_id": 571648, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c8aa5f38b7aee1d95b797718d38cf45?s=128&d=identicon&r=PG", "display_name": "erdomester", "link": "https://stackoverflow.com/users/571648/erdomester"}, "edited": false, "score": 0, "creation_date": 1434000340, "post_id": 30765604, "comment_id": 49595522, "body": "That&#39;s right. It has -rw-rw-r-- permissions. What I did is that I copied it into the public_html folder where I have permission to run it. However, in order to run the ruby script now from php I should add the absolute path of all the gems that I use. What&#39;s the better way here, solving the permission issue or setting path for all gems?"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 6136189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1300042436676175/picture?type=large", "display_name": "Akif Hazarvi", "link": "https://stackoverflow.com/users/6136189/akif-hazarvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1475655785, "creation_date": 1475655785, "answer_id": 39868856, "question_id": 30765604, "link": "https://stackoverflow.com/questions/30765604/running-a-ruby-script-from-php/39868856#39868856", "title": "Running a ruby script from php", "body": "<pre><code>exec(rubyfile.rb);\n</code></pre>\n\n<p>Just add this code and it will execute your ruby file.</p>\n"}], "owner": {"reputation": 11433, "user_id": 571648, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c8aa5f38b7aee1d95b797718d38cf45?s=128&d=identicon&r=PG", "display_name": "erdomester", "link": "https://stackoverflow.com/users/571648/erdomester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475655785, "creation_date": 1433964639, "last_edit_date": 1434001651, "question_id": 30765604, "link": "https://stackoverflow.com/questions/30765604/running-a-ruby-script-from-php", "title": "Running a ruby script from php", "body": "<p>Ruby is installed here:</p>\n\n<pre><code>.rvm/rubies/ruby-2.2.1/bin\n</code></pre>\n\n<p>Ruby script:</p>\n\n<pre><code>puts \"Hello world\"\n</code></pre>\n\n<p>Php script:</p>\n\n<pre><code>&lt;?php\n    $cmd = \"ruby /home/balint/rubytest.rb\";     \n    echo system($cmd);\n?&gt;\n</code></pre>\n\n<p>I can run <code>sudo php /home/name/public_html/phprubytest.php</code> from CLI but not from the browser.</p>\n\n<p>I reach the server via Putty and use Filezilla to put all my website-related files to the public_html folder.</p>\n\n<p>I logged out the error and it turned out I have a permission error:</p>\n\n<pre><code>ruby: Permission denied -- /home/balint/rubytest.rb (LoadError)\n</code></pre>\n\n<p>This means as a user running the php script from the browser I have no access to that directory on the server.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "grape-api"], "comments": [{"owner": {"reputation": 899, "user_id": 1355590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iFzVG.gif?s=128&g=1", "display_name": "debbie", "link": "https://stackoverflow.com/users/1355590/debbie"}, "edited": false, "score": 0, "creation_date": 1440750945, "post_id": 30765321, "comment_id": 52412360, "body": "HI, Have you solved the problem? I meet too."}], "answers": [{"tags": [], "owner": {"reputation": 899, "user_id": 1355590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iFzVG.gif?s=128&g=1", "display_name": "debbie", "link": "https://stackoverflow.com/users/1355590/debbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1440751444, "creation_date": 1440751444, "answer_id": 32266881, "question_id": 30765321, "link": "https://stackoverflow.com/questions/30765321/serving-an-image-with-grape/32266881#32266881", "title": "Serving an image with Grape", "body": "<p>You cando like this, Add <code>content_type :png, \"image/png\"</code> before it.</p>\n\n<pre><code>content_type :png, \"image/png\"\nget :image do\n  content_type 'image/png'\n  File.binread \"image.png\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5354754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7990d56cf0c96b52406e1ea88181c850?s=128&d=identicon&r=PG&f=1", "display_name": "IBmeister", "link": "https://stackoverflow.com/users/5354754/ibmeister"}, "is_accepted": false, "score": 0, "last_activity_date": 1465419441, "creation_date": 1465419441, "answer_id": 37712787, "question_id": 30765321, "link": "https://stackoverflow.com/questions/30765321/serving-an-image-with-grape/37712787#37712787", "title": "Serving an image with Grape", "body": "<p>For anyone who might run into this in the future, the correct solution is adding a line for the header property, like so:</p>\n\n<pre><code>header['Content-Disposition'] = \"attachment; filename=filename.png\"\n</code></pre>\n\n<p>\"attachment\" can be switched to \"inline\" if you want the file displayed on the browser.</p>\n"}], "owner": {"reputation": 2676, "user_id": 1456004, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8bc8096bf315be2fb658f246ae9f4ef0?s=128&d=identicon&r=PG", "display_name": "Fran b", "link": "https://stackoverflow.com/users/1456004/fran-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 850, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1465419441, "creation_date": 1433963717, "question_id": 30765321, "link": "https://stackoverflow.com/questions/30765321/serving-an-image-with-grape", "title": "Serving an image with Grape", "body": "<p>I have a GET service who should serve an image. Following the Grape readme:\n<a href=\"https://github.com/intridea/grape#user-content-sending-raw-or-no-data\" rel=\"nofollow\">https://github.com/intridea/grape#user-content-sending-raw-or-no-data</a></p>\n\n<pre><code>get :image do\n  content_type 'application/octet-stream'\n  File.binread \"image.png\"\nend\n</code></pre>\n\n<p>But when I download the image is missing its extension (.png) and the filename.</p>\n\n<p>I have tried too:</p>\n\n<pre><code>get :image do\n  content_type 'image/png'\n  File.binread \"image.png\"\nend\n</code></pre>\n\n<p>But it returns the error:</p>\n\n<pre><code>Encoding::UndefinedConversionError (\"\\x89\" from ASCII-8BIT to UTF-8)\n</code></pre>\n\n<p>How should send the image for avoiding to lose extension and filename?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubymine"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4927142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3782f2e1b7f630186fc1a1a69ba336a9?s=128&d=identicon&r=PG&f=1", "display_name": "Mo Jaimangal", "link": "https://stackoverflow.com/users/4927142/mo-jaimangal"}, "is_accepted": false, "score": 1, "last_activity_date": 1453097677, "last_edit_date": 1453097677, "creation_date": 1453095231, "answer_id": 34847878, "question_id": 30765073, "link": "https://stackoverflow.com/questions/30765073/rubymine-expected-or-end-of-line-error-after-some-colon/34847878#34847878", "title": "RubyMine: expected ; or end of line error after some colon", "body": "<p>With later RubyMine versions on Mac: Go to Preferences -> 'Language &amp; Frameworks' -> 'Ruby SDK and Gems', and change to Ruby 2.0 SDK Restart and it should work.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1670773"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1453097677, "creation_date": 1433962889, "question_id": 30765073, "link": "https://stackoverflow.com/questions/30765073/rubymine-expected-or-end-of-line-error-after-some-colon", "title": "RubyMine: expected ; or end of line error after some colon", "body": "<p>My rails project works just fine. But rubymine highlights error <code>expected ; or end of line</code> after some <code>colon :</code>. For example </p>\n\n<pre><code>before_action :set_answer, only: [:show, :edit, :update, :destroy]\nformat.html { redirect_to @answer, notice: 'Answer was successfully created.' }\n</code></pre>\n\n<p>In above rubymine highlights error after <code>only:</code>  and <code>notice:</code>. But it doesn't highlight error after <code>:set_answer, :show, :edit, :update or :destroy</code>.</p>\n\n<p>What is the reason for this and How can I fix this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 4368245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h0TDk.jpg?s=128&g=1", "display_name": "spectre6000", "link": "https://stackoverflow.com/users/4368245/spectre6000"}, "is_accepted": true, "score": 3, "last_activity_date": 1433962922, "creation_date": 1433962922, "answer_id": 30765083, "question_id": 30765005, "link": "https://stackoverflow.com/questions/30765005/rails-dont-know-how-to-save-data-from-a-form-into-another-model/30765083#30765083", "title": "Rails - Don&#39;t know how to save data from a form into another model", "body": "<p>You want to create a nested form. You'll need to add <code>accepts_nested_attributes_for :actors</code> to the movie model, then build a subform within the form... Better explanation here:</p>\n\n<p><a href=\"http://www.theodinproject.com/ruby-on-rails/advanced-forms\" rel=\"nofollow\">http://www.theodinproject.com/ruby-on-rails/advanced-forms</a></p>\n\n<p>Scroll down to \"Nested Forms\".</p>\n"}], "owner": {"reputation": 513, "user_id": 3866214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/43167464533036306044429bd947e7fa?s=128&d=identicon&r=PG&f=1", "display_name": "Banner", "link": "https://stackoverflow.com/users/3866214/banner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 30765083, "answer_count": 1, "score": 1, "last_activity_date": 1433962922, "creation_date": 1433962693, "last_edit_date": 1495542709, "question_id": 30765005, "link": "https://stackoverflow.com/questions/30765005/rails-dont-know-how-to-save-data-from-a-form-into-another-model", "title": "Rails - Don&#39;t know how to save data from a form into another model", "body": "<p>I have a Movie model and an Actor model:</p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n\nbelongs_to :genre\nhas_many :reviews \nhas_many :actors\n\nend\n\n\n\nclass Actor &lt; ActiveRecord::Base\n\nbelongs_to :movies\n\nend\n</code></pre>\n\n<p>These are the attributes for each model:</p>\n\n<pre><code>create_table \"actors\", force: :cascade do |t|\nt.string   \"name\"\nt.text     \"bio\"\nt.datetime \"created_at\", null: false\nt.datetime \"updated_at\", null: false\nt.integer  \"movie_id\"\nend\n\ncreate_table \"movies\", force: :cascade do |t|\nt.string   \"title\"\nt.integer  \"duration\"\nt.date     \"release_date\"\nt.text     \"plot\"\nt.string   \"director\"\nt.text     \"cast\"\nt.datetime \"created_at\",   null: false\nt.datetime \"updated_at\",   null: false\nend\n</code></pre>\n\n<p>When a user fills out the form to create a new movie, I want the input from the 'cast' field to save to the Actor model. What action(s) would I need in my controller and what would I need to do in my form? </p>\n\n<p>I've looked at and tried the following and I'm still stuck:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5587398/rails-updating-data-in-one-model-from-another-models-controller\">Rails Updating Data in one Model from another Model&#39;s Controller</a></p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/19167482/how-can-i-update-and-save-one-model-from-another-in-rails\">How can I update and save one model from another in Rails?</a></p>\n\n<p><a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\" rel=\"nofollow noreferrer\">http://railscasts.com/episodes/196-nested-model-form-part-1</a></p>\n\n<p>Any help is greatly appreciated, thanks!</p>\n"}, {"tags": ["ruby", "open-uri"], "comments": [{"owner": {"reputation": 11433, "user_id": 571648, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c8aa5f38b7aee1d95b797718d38cf45?s=128&d=identicon&r=PG", "display_name": "erdomester", "link": "https://stackoverflow.com/users/571648/erdomester"}, "edited": false, "score": 0, "creation_date": 1433968700, "post_id": 30764104, "comment_id": 49585774, "body": "I was blind. I should have used <code>:allow_redirections =&gt; :all</code> instead of <code>:allow_redirections =&gt; :safe</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1433974475, "post_id": 30764104, "comment_id": 49588584, "body": "Nokogiri has no connection or influence on reading a page. It <i>ONLY</i> retrieves data from the IO that OpenURI, or whatever you&#39;re using to read a page or file, hands it. In other words, Nokogiri isn&#39;t the problem, it&#39;s how you&#39;re reading the file. Originally, a lot of libraries would allow redirections from HTTP &lt;--&gt; HTTPs but that was deemed a confusing behavior so allowing that was discouraged, which is why <code>:safe</code> is the default and we have to explicitly turn on <code>:all</code>."}, {"owner": {"reputation": 1365, "user_id": 1570893, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/PKUfW.jpg?s=128&g=1", "display_name": "Abhiram", "link": "https://stackoverflow.com/users/1570893/abhiram"}, "edited": false, "score": 1, "creation_date": 1448190795, "post_id": 30764104, "comment_id": 55472486, "body": "To use this :allow_redirection =&gt; :all, add a path by installing this gem <a href=\"https://github.com/open-uri-redirections/open_uri_redirections\" rel=\"nofollow noreferrer\">github.com/open-uri-redirections/open_uri_redirections</a>"}], "owner": {"reputation": 11433, "user_id": 571648, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3c8aa5f38b7aee1d95b797718d38cf45?s=128&d=identicon&r=PG", "display_name": "erdomester", "link": "https://stackoverflow.com/users/571648/erdomester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2376, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1433974481, "creation_date": 1433959820, "last_edit_date": 1433974481, "question_id": 30764104, "link": "https://stackoverflow.com/questions/30764104/open-uri-nokogiri-redirection-problems", "title": "open_uri / Nokogiri redirection problems", "body": "<p>I am using Nokogiri for scraping a webpage that works fine unless the page has a redirection loop.</p>\n\n<p>So when I scraping this site: <a href=\"https://www.cardcomplete.com/besuchen-isie-uns-auf-facebook/\" rel=\"nofollow\">https://www.cardcomplete.com/besuchen-isie-uns-auf-facebook/</a></p>\n\n<p>I get this error</p>\n\n<pre><code>/home/balint/.rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/open-uri.rb:224:in open_loop': redirection forbidden: https://www.cardcomplete.com/besuchen-isie-uns-auf-facebook/ -&gt; http://www.facebook.com/cardcomplete (RuntimeError)\n</code></pre>\n\n<p>But when I try to scrape this site I get the same error but now it is redirected to the https version of the facebook page:</p>\n\n<pre><code>/home/balint/.rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/open-uri.rb:224:in `open_loop': redirection forbidden: http://www.facebook.com/cardcomplete -&gt; https://www.facebook.com/cardcomplete (RuntimeError)\n</code></pre>\n\n<p>Of course, scraping the https version of the facebook page works.</p>\n\n<p>I installed <a href=\"https://github.com/open-uri-redirections/open_uri_redirections\" rel=\"nofollow\">this open_uri_redirections</a> gem that works for the facebook http->https redirection but not for the first link:</p>\n\n<pre><code>doc = Nokogiri::HTML(open('https://www.cardcomplete.com/besuchen-isie-uns-auf-facebook/', :allow_redirections =&gt; :safe))\n</code></pre>\n\n<p>How to solve this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433960933, "post_id": 30764080, "comment_id": 49581332, "body": "What is &quot;it&quot; in &quot;...or it&#39;s a <code>Test::C</code> object&quot;?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1433961405, "post_id": 30764080, "comment_id": 49581630, "body": "This question is very unclear since you specify <code>update</code> at the highest level but then call it inside <code>Test::A#foo</code> and you never actually call the <code>foo</code> method anywhere so nothing is actually happening here. If <code>Test::A#foo</code> should only be called from <code>Test::C#foo</code> then that is where you implement it. If <code>Test::A</code> does not need to update and <code>Test::B</code> does not need to update why would you put the logic at such a high level? Also this does not seem to have anything to do with recursion at all"}], "answers": [{"comments": [{"owner": {"reputation": 11990, "user_id": 492767, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/446bc7fb73e79a187d60c977a7092527?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/492767/victor"}, "edited": false, "score": 0, "creation_date": 1433960336, "post_id": 30764140, "comment_id": 49580946, "body": "I could probably do this <code>update(@x) if self.is_a?(Test::C)</code>, but is there a better way to write it? Actually don&#39;t need to worry about the value, but my end goal is: everytime <code>Test::C</code> is initialized, it should run <code>foo</code> based on <code>Test::C</code> once, then run it again as <code>Test::B</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11990, "user_id": 492767, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/446bc7fb73e79a187d60c977a7092527?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/492767/victor"}, "edited": false, "score": 3, "creation_date": 1433962929, "post_id": 30764140, "comment_id": 49582509, "body": "While you <i>can</i> do that, it doesn&#39;t mean you <i>should</i>. Generally it&#39;s best to put class-specific logic in the subclass and have the parent class unconcerned with those details. Translating your goal to Ruby, that&#39;d imply you do something inside <code>Test::C#initialize</code>, for example."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1433959946, "creation_date": 1433959946, "answer_id": 30764140, "question_id": 30764080, "link": "https://stackoverflow.com/questions/30764080/recursive-method-with-condition/30764140#30764140", "title": "Recursive method with condition", "body": "<p>The parent class should not have to care about subclasses. This design you have here implies it needs to know, which is broken and over-complicates things.</p>\n\n<p>In any case, if you do need to trap certain cases:</p>\n\n<pre><code>case (self)\nwhen Test::A, Test::B\n  # ... Do stuff\n  update(@x)\nend\n</code></pre>\n\n<p>If <code>Test::A</code> and <code>Test::B</code> care about that operation, they should call it when necessary:</p>\n\n<pre><code>def foo\n  @x += 1\n  super\n  update(x)\nend\n</code></pre>\n"}], "owner": {"reputation": 11990, "user_id": 492767, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/446bc7fb73e79a187d60c977a7092527?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/492767/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433959946, "creation_date": 1433959730, "question_id": 30764080, "link": "https://stackoverflow.com/questions/30764080/recursive-method-with-condition", "title": "Recursive method with condition", "body": "<p>Using Ruby 2.0. Here's my code:</p>\n\n<pre><code>module Test\n  class A\n    def initialize(x)\n      @x = x\n      foo\n    end\n\n    def foo\n      p @x\n      update(@x) # only if it's a Test::C object or called from Test::C\n    end\n  end\nend\n\nmodule Test\n  class B &lt; A\n    def foo\n      @x += 2\n      super\n    end\n  end\nend\n\nmodule Test\n  class C &lt; A\n    def foo\n      @x += 1\n      super\n    end\n  end\nend\n\ndef update(x)\n  if x &gt; 100\n    Test::B.new(x)\n  else\n    Test::C.new(x)\n  end\nend\n\nx = 100\nupdate(x)\n</code></pre>\n\n<p>Here's what I am trying to achieve:</p>\n\n<p><strong>In <code>Test::A#foo</code>, <code>update(@x)</code> should be called only if it were called from <code>Test::C#foo</code> or it's a <code>Test::C</code> object.</strong></p>\n\n<p>The first time <code>update(x)</code> is called, <code>x = 100</code>, so the operation should <code>+1</code> and then move on to <code>Test::B#foo</code> once. How do I achieve this?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 3232, "user_id": 2689002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zIvab.jpg?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2689002/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1433959560, "post_id": 30763931, "comment_id": 49580442, "body": "try this <code>Product.all.group_by(&amp;:product_type)</code> or `Product.all.group_by(&amp;:product_type).limit(1)"}, {"owner": {"reputation": 133, "user_id": 4723216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45ec5d596276d6d5ff060da32070d2af?s=128&d=identicon&r=PG&f=1", "display_name": "kali", "link": "https://stackoverflow.com/users/4723216/kali"}, "reply_to_user": {"reputation": 3232, "user_id": 2689002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zIvab.jpg?s=128&g=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/2689002/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1433960028, "post_id": 30763931, "comment_id": 49580745, "body": "whats is &amp; is used for in &amp;:product_type ?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1433960030, "post_id": 30763931, "comment_id": 49580746, "body": "<code>group</code> would be the query method but you would then have to exclude all other columns what is the desired end result? Is <code>ProductType</code> a defined class? Also <code>*_type</code> columns have inherent implications in <code>rails</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1433960195, "post_id": 30763931, "comment_id": 49580848, "body": "<code>limit(1)</code> limits to one result, period, not one result per type. When you say you want one product of each type, you&#39;ll need to specify how you&#39;re selecting which one. Lowest ID? Alphabetically? Random?"}, {"owner": {"reputation": 133, "user_id": 4723216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45ec5d596276d6d5ff060da32070d2af?s=128&d=identicon&r=PG&f=1", "display_name": "kali", "link": "https://stackoverflow.com/users/4723216/kali"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433960402, "post_id": 30763931, "comment_id": 49580987, "body": "@tadman exactly....random will do or very first row...I want only one result per type"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1433962277, "post_id": 30763931, "comment_id": 49582125, "body": "what @tadman is trying to tell you is you will not get 1 result per type you will get 1 result all together."}, {"owner": {"reputation": 11246, "user_id": 1074361, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/6e1d31995b215ae8469a24980555df2d?s=128&d=identicon&r=PG", "display_name": "Pedro Nascimento", "link": "https://stackoverflow.com/users/1074361/pedro-nascimento"}, "edited": false, "score": 0, "creation_date": 1433963484, "post_id": 30763931, "comment_id": 49582836, "body": "Is <code>product_type</code> a string or an association?"}], "answers": [{"tags": [], "owner": {"reputation": 8871, "user_id": 4381282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-rIutmC2tG4M/AAAAAAAAAAI/AAAAAAAAAE4/wicIrC8KhUs/photo.jpg?sz=128", "display_name": "Pawe\u0142 Dawczak", "link": "https://stackoverflow.com/users/4381282/pawe%c5%82-dawczak"}, "is_accepted": true, "score": 0, "last_activity_date": 1433969503, "creation_date": 1433969503, "answer_id": 30767079, "question_id": 30763931, "link": "https://stackoverflow.com/questions/30763931/group-by-class-in-rails-4-0/30767079#30767079", "title": "Group by class in Rails 4.0", "body": "<p>What you really need is actually:</p>\n\n<pre><code>Product.group(:product_type)\n</code></pre>\n\n<p>Let's assume we have data like this:</p>\n\n<pre><code>Product.create(name: \"TV\",     product_type: \"Electronics\")\nProduct.create(name: \"Diablo\", product_type: \"Computer Games\")\nProduct.create(name: \"Basics\", product_type: \"Books\")\n\nProduct.create(name: \"Radio\",     product_type: \"Electronics\")\nProduct.create(name: \"Assassins\", product_type: \"Computer Games\")\nProduct.create(name: \"Cooking\",   product_type: \"Books\")\n</code></pre>\n\n<p>When you perform code you've provided it returns single result:</p>\n\n<pre><code>result = Product.group(:product_type).limit(1)\nresult.each { |p| puts \"#{p.name} - #{p.product_type}\" }\n# =&gt; Cooking - Books\n</code></pre>\n\n<p>but</p>\n\n<pre><code>result = Product.group(:product_type)\nresult.each { |p| puts \"#{p.name} - #{p.product_type}\" }\n# =&gt; Cooking - Books\n#    Assassins - Computer Games\n#    Radio - Electronics\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 133, "user_id": 4723216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45ec5d596276d6d5ff060da32070d2af?s=128&d=identicon&r=PG&f=1", "display_name": "kali", "link": "https://stackoverflow.com/users/4723216/kali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 30767079, "answer_count": 1, "score": 0, "last_activity_date": 1433969503, "creation_date": 1433959335, "last_edit_date": 1433960148, "question_id": 30763931, "link": "https://stackoverflow.com/questions/30763931/group-by-class-in-rails-4-0", "title": "Group by class in Rails 4.0", "body": "<p>I have Product model in my project. And it has product_type as a field. I want only one product from all types of products. I tried doing this,</p>\n\n<pre><code>Product.group_by(:product_type).limit(1)\n</code></pre>\n\n<p>This did not work. How can i achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "feed"], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1433958056, "post_id": 30763506, "comment_id": 49579498, "body": "Thanks abm for some reason it needed to be user_id instead of just ids :)"}], "tags": [], "owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "is_accepted": true, "score": 1, "last_activity_date": 1433958057, "last_edit_date": 1433958057, "creation_date": 1433957867, "answer_id": 30763506, "question_id": 30763417, "link": "https://stackoverflow.com/questions/30763417/activity-ordercreated-at-desc-wherehow-to-include-current-user-following/30763506#30763506", "title": "Activity.order(&quot;created_at desc&quot;).where(How to include current_user &amp; following_ids?)", "body": "<p>You can just add the <code>current_user</code> to the <code>following_ids</code></p>\n\n<p><code>where(user_id: current_user.following_ids + [current_user.id])</code></p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 30763506, "answer_count": 1, "score": 0, "last_activity_date": 1433958057, "creation_date": 1433957614, "question_id": 30763417, "link": "https://stackoverflow.com/questions/30763417/activity-ordercreated-at-desc-wherehow-to-include-current-user-following", "title": "Activity.order(&quot;created_at desc&quot;).where(How to include current_user &amp; following_ids?)", "body": "<p>This shows on the feed all the activities by the users you are following, but I want it to include the posts from the <strong>users you are following + your own</strong>.</p>\n\n<pre><code>class ActivitiesController &lt; ApplicationController\n    def index\n        @activities = Activity.order(\"created_at desc\").where(user_id: current_user.following_ids).paginate(:page =&gt; params[:page]) # If I take out following_ids it will list out only the activities from the current_user. We need both.\n    end\n</code></pre>\n\n<p><strong>activity.rb</strong></p>\n\n<pre><code>class Activity &lt; ActiveRecord::Base\n  self.per_page = 20\n  belongs_to :user\n  belongs_to :habit\n  belongs_to :comment\n  belongs_to :valuation\n  belongs_to :quantified\n  belongs_to :trackable, polymorphic: true\n\n  def conceal\n    trackable.conceal\n  end\n\n  def page_number\n    (index / per_page.to_f).ceil\n  end\n\nprivate\n\n  def index\n    Activity.order(created_at: :desc).index self\n  end\nend\n</code></pre>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  acts_as_tagger\n  acts_as_taggable\n  has_many :notifications\n  has_many :activities\n  has_many :activity_likes\n  has_many :liked_activities, through: :activity_likes, class_name: 'Activity',   source: :liked_activity\n  has_many :liked_comments, through: :comment_likes, class_name: 'Comment', source: :liked_comment\n  has_many :valuation_likes\n  has_many :habit_likes\n  has_many :goal_likes\n  has_many :quantified_likes\n  has_many :comment_likes\n  has_many :authentications\n  has_many :habits, dependent: :destroy\n  has_many :levels\n  has_many :combine_tags\n  has_many :valuations, dependent: :destroy\n  has_many :comments\n  has_many :goals, dependent: :destroy\n  has_many :quantifieds, dependent: :destroy\n  has_many :results, through: :quantifieds\n  has_many :notes\n  accepts_nested_attributes_for :habits, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  accepts_nested_attributes_for :notes, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  accepts_nested_attributes_for :quantifieds, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  accepts_nested_attributes_for :results, :reject_if =&gt; :all_blank, :allow_destroy =&gt; true\n  has_many :active_relationships, class_name:  \"Relationship\",\n                                  foreign_key: \"follower_id\",\n                                  dependent:   :destroy\n  has_many :passive_relationships, class_name:  \"Relationship\",\n                                   foreign_key: \"followed_id\",\n                                   dependent:   :destroy\n  has_many :following, through: :active_relationships,  source: :followed\n  has_many :followers, through: :passive_relationships, source: :follower\n  attr_accessor :remember_token, :activation_token, :reset_token\n  before_save   :downcase_email\n  before_create :create_activation_digest\n  validates :name,  presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 },\n                    format: { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }, unless: -&gt; { from_omniauth? }\n  has_secure_password\n  validates :password, length: { minimum: 6 }\n  scope :publish, -&gt;{ where(:conceal =&gt; false) }\n  User.tag_counts_on(:tags)\n\n  def count_mastered\n    @res = habits.reduce(0) do |count, habit|\n    habit.current_level == 6 ? count + 1 : count\n    end\n  end\n\n  def count_challenged\n    @challenged_count = habits.count - @res\n  end\n\n    def self.from_omniauth(auth)\n      where(provider: auth.provider, uid: auth.uid).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.image = auth.info.image\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.password = (0...8).map { (65 + rand(26)).chr }.join\n        user.email = (0...8).map { (65 + rand(26)).chr }.join+\"@mailinator.com\"\n        user.save!\n      end\n    end\n\n  def self.koala(auth)\n    access_token = auth['token']\n    facebook = Koala::Facebook::API.new(access_token)\n    facebook.get_object(\"me?fields=name,picture\")\n  end\n\n\n  # Returns the hash digest of the given string.\n  def User.digest(string)\n    cost = ActiveModel::SecurePassword.min_cost ? BCrypt::Engine::MIN_COST :\n                                                  BCrypt::Engine.cost\n    BCrypt::Password.create(string, cost: cost)\n  end\n\n  # Returns a random token.\n  def User.new_token\n    SecureRandom.urlsafe_base64\n  end\n\n  # Remembers a user in the database for use in persistent sessions.\n  def remember\n    self.remember_token = User.new_token\n    update_attribute(:remember_digest, User.digest(remember_token))\n  end\n\n  # Forgets a user. NOT SURE IF I REMOVE\n  def forget\n    update_attribute(:remember_digest, nil)\n  end\n\n  # Returns true if the given token matches the digest.\n  def authenticated?(attribute, token)\n    digest = send(\"#{attribute}_digest\")\n    return false if digest.nil?\n    BCrypt::Password.new(digest).is_password?(token)\n  end\n\n  # Activates an account.\n  def activate\n    update_attribute(:activated,    true)\n    update_attribute(:activated_at, Time.zone.now)\n  end\n\n  # Sends activation email.\n  def send_activation_email\n    UserMailer.account_activation(self).deliver_now\n  end\n\n  def create_reset_digest\n    self.reset_token = User.new_token\n    update_attribute(:reset_digest,  User.digest(reset_token))\n    update_attribute(:reset_sent_at, Time.zone.now)\n  end\n\n  # Sends password reset email.\n  def send_password_reset_email\n    UserMailer.password_reset(self).deliver_now\n  end\n\n   # Returns true if a password reset has expired.\n  def password_reset_expired?\n    reset_sent_at &lt; 2.hours.ago\n  end\n\n  def good_results_count\n    results.good_count\n  end\n\n  # Follows a user.\n  def follow(other_user)\n    active_relationships.create(followed_id: other_user.id)\n  end\n\n  # Unfollows a user.\n  def unfollow(other_user)\n    active_relationships.find_by(followed_id: other_user.id).destroy\n  end\n\n  # Returns true if the current user is following the other user.\n  def following?(other_user)\n    following.include?(other_user)\n  end\n\nprivate \n\n    def from_omniauth? \n      provider &amp;&amp; uid \n    end\n\n      # Converts email to all lower-case.\n    def downcase_email \n      self.email = email.downcase unless from_omniauth? \n    end\n\n    # Creates and assigns the activation token and digest.\n    def create_activation_digest\n      self.activation_token  = User.new_token\n      self.activation_digest = User.digest(activation_token)\n    end\nend\n</code></pre>\n\n<p>Please let me know if you need any further explanation or code to help you help me =]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433957540, "post_id": 30763338, "comment_id": 49579203, "body": "where is users_controller?"}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433957614, "post_id": 30763338, "comment_id": 49579251, "body": "is @items defined in users_controller show action?"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "reply_to_user": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433957721, "post_id": 30763338, "comment_id": 49579312, "body": "@test I just added it now to the question."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433957752, "post_id": 30763338, "comment_id": 49579325, "body": "@JonathanMusso I gave you solution.. did you try ? You can&#39;t pass instance variables to the <i>partial</i>, but using local variable you can&#39;t pass it."}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433957886, "post_id": 30763338, "comment_id": 49579398, "body": "add @items = Item.all in users_controller show action"}], "answers": [{"comments": [{"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433957803, "post_id": 30763371, "comment_id": 49579354, "body": "Thank you. I have now added this. I will edit the question. Currently I get this-  undefined local variable or method `items&#39;"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433958014, "post_id": 30763371, "comment_id": 49579477, "body": "Ah. I fixed the typo. Now I see undefined method `each&#39; for nil:NilClass so my object is blank."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433958396, "post_id": 30763371, "comment_id": 49579734, "body": "@JonathanMusso did you add it to the controller action as I said..?"}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433958558, "post_id": 30763371, "comment_id": 49579837, "body": "Thank you kindly. So my biggest issues here was that I was incorrectly using my partial render and I did not define the @item instance in my Users show?"}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "edited": false, "score": 0, "creation_date": 1433958698, "post_id": 30763371, "comment_id": 49579932, "body": "@JonathanMusso It seems you got confused.. Let me know if you need any more help."}, {"owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433958798, "post_id": 30763371, "comment_id": 49579990, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/80214/discussion-between-jonathan-musso-and-arup-rakshit\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": true, "score": 0, "last_activity_date": 1433958043, "last_edit_date": 1433958043, "creation_date": 1433957482, "answer_id": 30763371, "question_id": 30763338, "link": "https://stackoverflow.com/questions/30763338/what-is-causing-nomethoderror-in-my-crud/30763371#30763371", "title": "What is causing NoMethodError in my CRUD?", "body": "<p>You need to use local variable <code>item</code>, which you passed to the <em>partial</em> <code>_item.html.erb</code>. :</p>\n\n<pre><code>&lt;% item.each do |i| %&gt;\n  &lt;%= i.name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and ...</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def show\n    @user = User.find(params[:id])\n    @new_item = Item.new\n    @items = Item.all\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 30763371, "answer_count": 1, "score": 0, "last_activity_date": 1433958043, "creation_date": 1433957403, "last_edit_date": 1433957864, "question_id": 30763338, "link": "https://stackoverflow.com/questions/30763338/what-is-causing-nomethoderror-in-my-crud", "title": "What is causing NoMethodError in my CRUD?", "body": "<p>I am student working on my first project on my own. The user is supposed to be able to create a to-do list. I have my form partial displayed and am trying to now render the list items through a partial. After altering my routes.rb and items_controller.rb I still receive NoMethodError.</p>\n\n<p>Here is the stack trace.</p>\n\n<pre><code>Completed 500 Internal Server Error in 23ms (ActiveRecord: 0.2ms)\n\nActionView::Template::Error (undefined local variable or method `items' for #&lt;#&lt;Class:0x007fa1c3b4e238&gt;:0x007fa1bd6f2258&gt;):\n    1: &lt;% items.each do |i| %&gt;\n    2:   &lt;%= i.name %&gt;\n    3: &lt;% end %&gt;\n  app/views/items/_item.html.erb:1:in `_app_views_items__item_html_erb___4201771908086516106_70166314068980'\n  app/views/users/show.html.erb:5:in `_app_views_users_show_html_erb__1693372631105662933_70166313045680'\n</code></pre>\n\n<p><strong>items_controller.rb</strong></p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n  def index\n    @items = Item.all\n  end\n\n  def show\n    @item = Item.find(params[:id])\n  end\n\n  def new\n    @item = Item.new\n  end\n\n  def edit\n    @item = Item.find(params[:id])\n  end\n\n  def create\n    @item = Item.new(params.require(:item).permit(:name))\n\n    if @item.save\n      flash[:notice] = \"The item was added to your list.\"\n      redirect_to :show\n    else\n      flash[:error] = \"There was a problem creating your item.\"\n      redirect_to :new\n    end\n  end\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  get 'welcome/index'\n  get 'welcome/about'\n\n  # resources :welcome, only: [] do\n  #   collection do\n  #     get 'about'\n  #     get 'index'\n  #   end\n  # end\n\n  devise_for :users\n\n  resources :users, only: [:show] \n  resources :items\n\n  root to: 'welcome#index'\nend\n</code></pre>\n\n<p><strong>users/show.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;Welcome &lt;%= current_user.name %&gt;&lt;/h1&gt;\n&lt;p&gt;Add an item&lt;/p&gt;\n\n&lt;%= render partial: 'items/form', locals: { item: @new_item } %&gt;\n&lt;%= render partial: 'items/item', locals: { item: @items } %&gt;\n</code></pre>\n\n<p><strong>items/_item.html.erb</strong></p>\n\n<pre><code>&lt;% items.each do |i| %&gt;\n  &lt;%= i.name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>EDIT: Here is my <strong>users_controller.rb</strong></p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def show\n    @user = User.find(params[:id])\n    @new_item = Item.new\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "comments": [{"owner": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1433957049, "post_id": 30763098, "comment_id": 49578908, "body": "you can try writing the unprocessed rows in a new file.  Then after that, use <code>FileUtils.mv</code> to move the newly written file to the old file."}, {"owner": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "reply_to_user": {"reputation": 28138, "user_id": 337166, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fKzgt.jpg?s=128&g=1", "display_name": "jvnill", "link": "https://stackoverflow.com/users/337166/jvnill"}, "edited": false, "score": 0, "creation_date": 1433959190, "post_id": 30763098, "comment_id": 49580249, "body": "@jvnill mmphh, ok I think I need push to an array value of row can&#39;t import, and after finish import, I need open new file csv and each an array to write it and save."}], "owner": {"reputation": 1179, "user_id": 2858044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b99bf8baf41337577e4e425677080472?s=128&d=identicon&r=PG&f=1", "display_name": "itx", "link": "https://stackoverflow.com/users/2858044/itx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433956673, "creation_date": 1433956673, "question_id": 30763098, "link": "https://stackoverflow.com/questions/30763098/delete-values-of-row-when-import-csv", "title": "Delete values of row when import csv", "body": "<p>I have import csv file method with carrierwave and it's works. And now I want to delete values of row when that have been successful imported to database.</p>\n\n<pre><code>csv_text = File.read(file_csv.current_path)\ncsv = CSV.parse(csv_text)\ncsv.each_with_index do |row, index|\n  @foo = Foo.new(bar: row[0])\n  if @foo.save\n    # delete values of row\n  else\n    next\n  end\nend\n</code></pre>\n\n<p>Example I have a file csv containing :    </p>\n\n<pre><code>lenovo z360, black, 14\nasus a46, blue, nil\nMacBook Pro, silver\n</code></pre>\n\n<p>lenovo z360 and MacBook Pro has been successful import, and the end of process import file will be like this :</p>\n\n<pre><code>asus a46, blue, nil\n</code></pre>\n\n<p>Is it possible ? How would I be able just to read, write/delete and manipule a file with many of row?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "edited": false, "score": 0, "creation_date": 1473929914, "post_id": 30762448, "comment_id": 66330289, "body": "I don&#39;t think the change in title is right and voted against it. There is a better way of doing what is being asked for by using MySQL to do most of the work. So the original title is good IMO."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1433955094, "creation_date": 1433955094, "answer_id": 30762587, "question_id": 30762448, "link": "https://stackoverflow.com/questions/30762448/count-the-occurence-of-values-in-ruby/30762587#30762587", "title": "Count the occurence of values in Ruby", "body": "<p>There's some room for cleaning up here. The most obvious part is that long, clunky <code>if</code> statement. The test vs <code>nil?</code> is pointless, remember in Ruby the <em>only</em> things that are logically false are <code>false</code> and <code>nil</code>, so since <code>false</code> is never going to show up here, the test vs. <code>nil</code> specifically can be removed.</p>\n\n<p>More than that, though, you're on the right track with the custom <code>Hash.new</code> call, but you don't go far enough. Why not initialize the second tier with zero?</p>\n\n<p>That results in code that looks like:</p>\n\n<pre><code>result = [\n  { :column1 =&gt; \"2\", :column2 =&gt; \"3\", :column3 =&gt; \"1\"},\n  { :column1 =&gt; \"2\", :column2 =&gt; \"3\", :column3 =&gt; \"1\"},\n  { :column1 =&gt; \"1\", :column2 =&gt; \"2\", :column3 =&gt; \"3\"}\n]\n\n# Init hash\nfinal_result = Hash.new { |h, k| h[k] = Hash.new(0) }\n\n# Loop result columns\nresult.each do |single_column|\n  single_column.each do |r|\n    final_result[r[0]][r[1]] += 1\n  end\nend\n\nputs final_result.inspect\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "is_accepted": false, "score": 1, "last_activity_date": 1473929634, "creation_date": 1473929634, "answer_id": 39506841, "question_id": 30762448, "link": "https://stackoverflow.com/questions/30762448/count-the-occurence-of-values-in-ruby/39506841#39506841", "title": "Count the occurence of values in Ruby", "body": "<p>Have a look at the active record <code>count</code> method (<a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-count\" rel=\"nofollow\">doc link</a>). You can use that in combination with <code>group</code> to do what you are trying to achieve.</p>\n\n<pre><code>[:column1, :column2, :column3].inject({}) do |hash, column|\n  hash[column] = Model.group(column).count\n  hash\nend\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 1337113, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/84573d7afe6b2689dfc3dd4e7828adba?s=128&d=identicon&r=PG", "display_name": "Esa M&#228;kinen", "link": "https://stackoverflow.com/users/1337113/esa-m%c3%a4kinen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473929634, "creation_date": 1433954676, "last_edit_date": 1473929448, "question_id": 30762448, "link": "https://stackoverflow.com/questions/30762448/count-the-occurence-of-values-in-ruby", "title": "Count the occurence of values in Ruby", "body": "<p>I'm trying to count numbers of different values in mysql table columns. Range of possible values is integer and from 0-10. The following code is working, but I'm wondering if there is a more elegant way to do this?</p>\n\n<pre><code># Example data from Mysql\nresult = [{ :column1 =&gt; \"2\", :column2 =&gt; \"3\", :column3 =&gt; \"1\"},{ :column1 =&gt; \"2\", :column2 =&gt; \"3\", :column3 =&gt; \"1\"},{ :column1 =&gt; \"1\", :column2 =&gt; \"2\", :column3 =&gt; \"3\"}]\n\n# Init hash\nfinal_result = Hash.new { |h, k| h[k] = {  } }\n\n# Loop result columns\nresult.each do |single_column|\n\n    # Loop single items inside columns\n    single_column.each do |single_result|\n\n            # Create column if does not exist\n            if final_result[single_result[0]][single_result[1]].nil? then\n                final_result[single_result[0]][single_result[1]] = 1\n            else\n                final_result[single_result[0]][single_result[1]] += 1\n            end\n    end\nend\n\nputs final_result\n# =&gt; {:column1=&gt;{\"2\"=&gt;2, \"1\"=&gt;1}, :column2=&gt;{\"3\"=&gt;2, \"2\"=&gt;1}, :column3=&gt;{\"1\"=&gt;2, \"3\"=&gt;1}}\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "logic"], "comments": [{"owner": {"reputation": 3736, "user_id": 1031061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/8IZUV.jpg?s=128&g=1", "display_name": "Pardeep Dhingra", "link": "https://stackoverflow.com/users/1031061/pardeep-dhingra"}, "edited": false, "score": 3, "creation_date": 1433953295, "post_id": 30761910, "comment_id": 49576553, "body": "This will reduce your code <code>row.index(0)</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1433954706, "post_id": 30761910, "comment_id": 49577445, "body": "It&#39;s worth noting that your program only displays the zeroes, it doesn&#39;t actually alter the arrays."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4733222"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433954806, "post_id": 30761910, "comment_id": 49577503, "body": "@tadman can you help how to do that"}, {"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "edited": false, "score": 2, "creation_date": 1433958941, "post_id": 30761910, "comment_id": 49580095, "body": "I&#39;m assuming the answer should be able to handle arrays that contain multiple zero&#39;s right? Your code as it stands can not handle this case."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1434042541, "post_id": 30761910, "comment_id": 49623967, "body": "I would like to offer some advice on posing questions: 1) Always begin by explaining what you are trying to do in words. Here, you might say, &quot;If a two-dimensional array contains a zero, I would like to convert all elements in the associated row and column to zero&quot;. (That&#39;s not quite precise, as arrays don&#39;t have rows and columns, but it get&#39;s the idea across.) 2) Add an example with the expected result. You&#39;ve done that, but the example should refer to valid Ruby objects. In part, that is so that readers can cut and paste. Also, give input values names, so  answers can refer to them (cont..)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1434042976, "post_id": 30761910, "comment_id": 49624228, "body": "(cont..) Here you might have <code>arr = [[1,2,3,4],[5,6,7,8],..]</code>. That way, answers can be like <code>arr.each_with_object...</code>, without having to state what <code>arr</code> is. The expected result should also be a valid Ruby object, but you don&#39;t have to give it a name (e.g., <code>[[1,2,0,4],...]</code>). 3) After you&#39;ve done the foregoing, present your code and explain what the problem is. As it is now, the reader is asked to go through your code to figure out what you are trying to do (cont..)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1434044267, "post_id": 30761910, "comment_id": 49625006, "body": "(cont..) 4) When readers ask questions, answer them by editing your question. Here readers want to know if you are only concerned with the &quot;first&quot; zero in the array or all of them. You need to clarify that. When editing, it is often good practice to indicate that you are doing so. For example, you could write, &quot;Edit: I am only concerned with the first zero in <code>arr.flatten</code>.&quot; or &quot;Edit: I wish to zero all rows and columns that contain a zero.&quot;"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4733222"}, "edited": false, "score": 0, "creation_date": 1433954620, "post_id": 30762382, "comment_id": 49577391, "body": "this code is working fine but can we reduce one more loop to search &#39;0&#39;"}], "tags": [], "owner": {"reputation": 157, "user_id": 1843919, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/993a0.png?s=128&g=1", "display_name": "Rebel Rider", "link": "https://stackoverflow.com/users/1843919/rebel-rider"}, "is_accepted": false, "score": 1, "last_activity_date": 1433954475, "creation_date": 1433954475, "answer_id": 30762382, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0/30762382#30762382", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>Try this code:</p>\n\n<pre><code>req_row = req_col = -1\n\na.each_with_index do |row, index|\n    req_col = row.index(0) # searching index having value 0.\n    if req_col\n        req_row =  index \n        break\n    end \nend\na.each_with_index do |row,index|\n    row.each_with_index do |col, i|\n        print ((req_row == index or i == req_col) ? 0 : col).to_s + \" \"\n    end\n    puts \"\\r\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "is_accepted": false, "score": 0, "last_activity_date": 1433959416, "last_edit_date": 1433959416, "creation_date": 1433954829, "answer_id": 30762499, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0/30762499#30762499", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>Here's what I came up with:</p>\n\n<pre><code>zero_rows=[]\na.map do |col| \n   col.each_with_index do |el, index|\n     zero_rows.push(index) if el==0 \n   end\n   col.fill(0) if col.include?(0)\nend\n\na.map{|col| zero_rows.each{|index| col[index]=0} }\n</code></pre>\n\n<p>First, use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-map\" rel=\"nofollow\"><code>map</code></a> to iterate through the columns and <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-fill\" rel=\"nofollow\"><code>fill</code></a> them with zeros if they contain at least one 0. but, while doing so, add the indexes which contain a 0 to the <code>zero_rows</code> array. </p>\n\n<p>Afterwards, iterate through the array once more and set the indexes of each column that match an index in <code>zero_rows</code> to 0. </p>\n\n<p>You may know the <code>map</code> method as <code>collect</code>. They do the same thing.</p>\n\n<h2>Side Note:</h2>\n\n<p><strong>If an array contains multiple zero's this code will zero out every applicable column.</strong>  OP's example and some other answers here will only zero out the first column in which a 0 is found. If this is the behavior you are expecting, then see @Doguita's answer.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433955415, "post_id": 30762616, "comment_id": 49577879, "body": "Loos good, but the <code>return</code> statements are pretty heavy handed by Ruby standards. It&#39;s implicit if at the end of a method. Not sure why <code>matrix.size.times</code> was used when <code>matrix.each { |r| r[col] = val }</code> would do the same job."}, {"owner": {"reputation": 3066, "user_id": 293248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15fc023b1e0a3324440cc63d7239b2?s=128&d=identicon&r=PG", "display_name": "sczizzo", "link": "https://stackoverflow.com/users/293248/sczizzo"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433956036, "post_id": 30762616, "comment_id": 49578281, "body": "Factored in your suggestions."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1433956099, "post_id": 30762616, "comment_id": 49578325, "body": "Looking pretty lean and mean now."}], "tags": [], "owner": {"reputation": 3066, "user_id": 293248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15fc023b1e0a3324440cc63d7239b2?s=128&d=identicon&r=PG", "display_name": "sczizzo", "link": "https://stackoverflow.com/users/293248/sczizzo"}, "is_accepted": false, "score": 1, "last_activity_date": 1433955977, "last_edit_date": 1433955977, "creation_date": 1433955183, "answer_id": 30762616, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0/30762616#30762616", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>Based on the title of your question, here's solution that searches for positions of the zero values (<code>fixate</code>), then actually zeros out the appropriate row and column (<code>clear</code>, more aligned with the contents of your question):</p>\n\n<pre><code>def fixate matrix, search=0, replace=0\n  rcs = []\n\n  matrix.each_with_index do |row,r|\n    row.each_with_index do |col,c|\n      rcs &lt;&lt; [ r, c ] if col == search\n    end\n  end\n\n  rcs.each do |(row, col)|\n    clear matrix, row, col, replace\n  end\n\n  matrix\nend\n\ndef clear matrix, row, col, val=0\n  matrix[row].map! { |_| val }     # Clear rows\n  matrix.each { |r| r[col] = val } # Clear columns\n  matrix\nend\n</code></pre>\n\n<p>Quick test:</p>\n\n<pre><code>fixate [               # [\n  [ 1,  2,  3,  4  ],  #   [ 1,  2,  0, 4  ],\n  [ 5,  6,  7,  8  ],  #   [ 5,  6,  0, 8  ],\n  [ 9,  10, 0,  11 ],  #   [ 0,  0,  0, 0  ],\n  [ 12, 13, 14, 15 ]   #   [ 12, 13, 0, 15 ]\n]                      # ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "edited": false, "score": 0, "creation_date": 1433958272, "post_id": 30763558, "comment_id": 49579644, "body": "this doesn&#39;t work if an array contains more than one 0"}, {"owner": {"reputation": 13376, "user_id": 3357295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3PzYS.jpg?s=128&g=1", "display_name": "Doguita", "link": "https://stackoverflow.com/users/3357295/doguita"}, "reply_to_user": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "edited": false, "score": 0, "creation_date": 1433958761, "post_id": 30763558, "comment_id": 49579972, "body": "@LukeP I know, but it fits in the OP example. Are you sure you need to search for more than one 0?"}, {"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "edited": false, "score": 0, "creation_date": 1433958901, "post_id": 30763558, "comment_id": 49580063, "body": "I can only assume so. A good answer should also be more robust, so as to be more helpful to future readers. I will ask for clarification in the comments though."}, {"owner": {"reputation": 5017, "user_id": 3581485, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/bEEKZ.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/3581485/luke"}, "edited": false, "score": 0, "creation_date": 1433959287, "post_id": 30763558, "comment_id": 49580300, "body": "In the mean time, i can only undo my down vote if you edit your answer. (SO has locked my vote)"}], "tags": [], "owner": {"reputation": 13376, "user_id": 3357295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3PzYS.jpg?s=128&g=1", "display_name": "Doguita", "link": "https://stackoverflow.com/users/3357295/doguita"}, "is_accepted": false, "score": 0, "last_activity_date": 1433959926, "last_edit_date": 1433959926, "creation_date": 1433958036, "answer_id": 30763558, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0/30763558#30763558", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>I don't know if this code is better than the other answers. I will test it later:  </p>\n\n<pre><code>ary = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 0, 11], [12, 13, 14, 15]]\ncol = nil\nrow = ary.index{ |a| col = a.index(0) }\nary.each_with_index { |a, i| i == row ? a.fill(0) : a[col] = 0 } if col\n\np ary\n# =&gt; [[1, 2, 0, 4], [5, 6, 0, 8], [0, 0, 0, 0], [12, 13, 0, 15]] \n</code></pre>\n\n<p>Obs: This answer assumes there's only one 0 to search in the array</p>\n"}, {"comments": [{"owner": {"reputation": 3066, "user_id": 293248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a15fc023b1e0a3324440cc63d7239b2?s=128&d=identicon&r=PG", "display_name": "sczizzo", "link": "https://stackoverflow.com/users/293248/sczizzo"}, "edited": false, "score": 0, "creation_date": 1434039964, "post_id": 30766321, "comment_id": 49622480, "body": "I&#39;ve been a Rubyist for a while now and never came across the Matrix class, very cool."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 4, "last_activity_date": 1433988899, "last_edit_date": 1433988899, "creation_date": 1433966926, "answer_id": 30766321, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0/30766321#30766321", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>I'm surprised the <a href=\"http://ruby-doc.org/stdlib-2.2.0/libdoc/matrix/rdoc/Matrix.html\" rel=\"nofollow\">Matrix</a> class is not used more:</p>\n\n<pre><code>a = [[ 1,  2,  3,  4],\n     [ 5,  6,  7,  8],\n     [ 9, 10,  0, 11],\n     [12, 13, 14, 15]]\n\nrequire 'matrix'\n\nm = Matrix.rows(a)\n  #=&gt; Matrix[[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 0, 11], [12, 13, 14, 15]]\n\nr, c = m.index(0)\n  #=&gt; [2, 2]\n\nMatrix.build(m.row_count, m.column_count) {|i,j| (i==r || j==c) ? 0 : m[i,j]}.to_a\n  #=&gt; [[ 1,  2, 0,  4],\n  #    [ 5,  6, 0,  8],\n  #    [ 0,  0, 0,  0],\n  #    [12, 13, 0, 15]] \n</code></pre>\n\n<p>Note <code>Matrix</code> objects are immutable. To change individual elements you must create a new matrix.</p>\n\n<p>A slight modification is required if you wish to do this for every zero in the matrix:</p>\n\n<pre><code>a = [[ 1,  2,  3,  4],\n     [ 5,  6,  7,  8],\n     [ 9, 10,  0, 11],\n     [ 0, 13, 14, 15]]\n\nrequire 'set'\n\nm = Matrix.rows(a)\n  #=&gt; Matrix[[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 0, 11], [0, 13, 14, 15]]\n\nzero_rows = Set.new\nzero_columns = Set.new\nm.each_with_index { |e,i,j| (zero_rows &lt;&lt; i; zero_columns &lt;&lt; j) if e.zero? }\nzero_rows\n  #=&gt; #&lt;Set: {2, 3}&gt; \nzero_columns\n  #=&gt; #&lt;Set: {2, 0}&gt;     \n\nMatrix.build(m.row_count, m.column_count) do |i,j|\n  (zero_rows.include?(i) || zero_columns.include?(j)) ? 0 : m[i,j]\nend.to_a\n  #=&gt; [[0, 2, 0, 4],\n  #    [0, 6, 0, 8],\n  #    [0, 0, 0, 0],\n  #    [0, 0, 0, 0]] \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4733222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 30766321, "answer_count": 5, "score": 6, "last_activity_date": 1433988899, "creation_date": 1433953051, "last_edit_date": 1433955940, "question_id": 30761910, "link": "https://stackoverflow.com/questions/30761910/search-for-zero-in-2d-array-and-make-a-corresponding-row-and-col-0", "title": "Search for zero in 2D array and make a corresponding row and col 0", "body": "<p>This is my code, which works, but it's too big. I want to refactor it.</p>\n\n<pre><code>req_row = -1\nreq_col = -1\n\na.each_with_index do |row, index|\n  row.each_with_index do |col, i|\n     if col == 0\n        req_row = index\n        req_col = i\n        break\n     end\n  end\nend\n\nif req_col &gt; -1 and req_row &gt; -1\n  a.each_with_index do |row,index|\n    row.each_with_index do |col, i|\n      print (req_row == index or i == req_col) ? 0 : col\n       print \" \"\n    end\n    puts \"\\r\"\n  end\nend\n</code></pre>\n\n<p>Input: 2D Array</p>\n\n<pre><code>1  2  3  4 \n5  6  7  8\n9  10 0 11\n12 13 14 15  \n</code></pre>\n\n<p>Required output: </p>\n\n<pre><code>1  2  0  4 \n5  6  0  8\n0  0  0  0\n12 13 0  15  \n</code></pre>\n"}, {"tags": ["ruby", "capistrano", "capistrano3", "devops"], "comments": [{"owner": {"reputation": 3074, "user_id": 1833232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/48vBr.jpg?s=128&g=1", "display_name": "Naim Rajiv", "link": "https://stackoverflow.com/users/1833232/naim-rajiv"}, "edited": false, "score": 0, "creation_date": 1433956610, "post_id": 30761684, "comment_id": 49578641, "body": "Did you created a folder named <code>reputationmonitor-api</code> on the server? and also make sure that you create it the right location that you have specified on the script like:  <code>&#47;home&#47;deployer&#47;apps&#47;reputationmonitor-api</code>"}, {"owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "reply_to_user": {"reputation": 3074, "user_id": 1833232, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/48vBr.jpg?s=128&g=1", "display_name": "Naim Rajiv", "link": "https://stackoverflow.com/users/1833232/naim-rajiv"}, "edited": false, "score": 0, "creation_date": 1434009506, "post_id": 30761684, "comment_id": 49600386, "body": "Of course, deploy:check does it"}, {"owner": {"reputation": 816, "user_id": 3652877, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4be128616eaef305121e691fc5efc?s=128&d=identicon&r=PG", "display_name": "jgraft", "link": "https://stackoverflow.com/users/3652877/jgraft"}, "edited": false, "score": 0, "creation_date": 1444046384, "post_id": 30761684, "comment_id": 53720849, "body": "@ngw did you ever figure this out?  I am having the same issue."}, {"owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "edited": false, "score": 0, "creation_date": 1444209264, "post_id": 30761684, "comment_id": 53801246, "body": "I did, but the problem can be pretty much everything: it was failing before symlinking the current dir. I suggest you go backwards and repeat every capistrano command in your production/staging shell until you find what&#39;s wrong that makes the deploy fail."}, {"owner": {"reputation": 846, "user_id": 2976571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7de8ced72ddb356e876cb5d09359177?s=128&d=identicon&r=PG", "display_name": "karolus", "link": "https://stackoverflow.com/users/2976571/karolus"}, "edited": false, "score": 0, "creation_date": 1505061237, "post_id": 30761684, "comment_id": 79247740, "body": "I might add that the link depends heavily upon your specific web server setup. I was getting the same types of failures until I went through and made all the links direct. You may have to go to your desired destination folder, and run <code>pwd</code> to get this, but after I had set it up, things were working fine."}, {"owner": {"reputation": 387, "user_id": 2332589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jqMqC.jpg?s=128&g=1", "display_name": "Eric V.", "link": "https://stackoverflow.com/users/2332589/eric-v"}, "edited": false, "score": 0, "creation_date": 1516371415, "post_id": 30761684, "comment_id": 83671492, "body": "Same problem here deploy:check helped me. My error was due to failed attempt to connect to gitlab server."}], "owner": {"reputation": 1100, "user_id": 1584736, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8c4392528b20b47726142f7a20c7cd?s=128&d=identicon&r=PG", "display_name": "ngw", "link": "https://stackoverflow.com/users/1584736/ngw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1625, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1433952452, "creation_date": 1433952452, "question_id": 30761684, "link": "https://stackoverflow.com/questions/30761684/capistrano-current-directory-doesnt-get-created", "title": "Capistrano current/ directory doesn&#39;t get created", "body": "<p>The current directory doesn't get created by capistrano when trying to deploy for the first time.</p>\n\n<p>I try to deploy:check the project and everything is just fine, but when I actually deploy the process ends up in error:</p>\n\n<pre><code>DEBUG [8d5bfb3a]    Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\ncap aborted!\nif test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi exit status: 1\nif test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi stdout: Nothing written\nif test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi stderr: Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/command.rb:98:in `exit_status='\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:142:in `block (4 levels) in _execute'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/channel.rb:551:in `call'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/channel.rb:551:in `do_request'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/sshDEBUG [ac4ea3f3] Finished in 0.053 seconds with exit status 0 (successful).\nINFO unicorn is running...\n/connection/session.rb:561:in `channel_request'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:465:in `dispatch_incoming_packets'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:221:in `preprocess'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:205:in `process'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `block in loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/channel.rb:269:in `wait'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:164:in `block (2 levels) in _execute'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/channel.rb:514:in `call'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/channel.rb:514:in `do_open_confirmation'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:545:in `channel_open_confirmation'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:465:in `dispatch_incoming_packets'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:221:in `preprocess'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:205:in `process'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `block in loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/net-ssh-2.9.0/lib/net/ssh/connection/session.rb:169:in `loop'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:166:in `block in _execute'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:123:in `tap'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:123:in `_execute'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:66:in `execute'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/abstract.rb:75:in `within'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/capistrano3-unicorn-0.1.1/lib/capistrano3/tasks/unicorn.rake:17:in `block (3 levels) in &lt;top (required)&gt;'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:54:in `instance_exec'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/backends/netssh.rb:54:in `run'\n/Users/ngw/.rvm/gems/ruby-2.1.1@ec-api/gems/sshkit-1.4.0/lib/sshkit/runners/parallel.rb:12:in `block (2 levels) in execute'\nTasks: TOP =&gt; unicorn:start\n(See full trace by running task with --trace)\nThe deploy has failed with an error: #&lt;SSHKit::Command::Failed: if test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi exit status: 1\nif test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi stdout: Nothing written\nif test ! -d /home/deployer/apps/reputationmonitor-api/current; then echo \"Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\" 1&gt;&amp;2; false; fi stderr: Directory does not exist '/home/deployer/apps/reputationmonitor-api/current'\n</code></pre>\n\n<p>From my experience it's normally caused by a previous problem that didn't let the deploy end, but I can't really see any noticeable exception or error (but I might be missing something obvious).</p>\n\n<pre><code>lock '3.2.1'\n\nset :application,                 'reputationmonitor-api'\n\nset :scm,                         :git\nset :repo_url,                    'git@github.com:thefoolsrl/EngagementConsole-API'\nset :ssh_options,                 {user: 'deployer', forward_agent: true}\n\nset :stages,                      %w(staging demo production)\nset :default_stage,               'staging'\n\nset :user,                        'deployer'\nset :group,                       'deployer'\n\nset :deploy_to,                   '/home/deployer/apps/reputationmonitor-api'\n\nset :format,                      :pretty\nset :log_level,                   :debug\n\nset :linked_files,                %w{config/database.yml config/redis.yml config/unicorn.rb}\nset :linked_dirs,                 %w{bin log sockets tmp/pids tmp/sockets}\n\nset :redis_config, \"#{shared_path}/config/redis.yml\"\nset :unicorn_config_path, \"#{deploy_to}/shared/config/unicorn.rb\"\n\nset :sidekiq_timeout, 30\nset :sidekiq_options, \" -e #{fetch(:stage)} -C #{current_path}/config/sidekiq.yml -r #{current_path}/config/environment.rb -L #{shared_path}/log/sidekiq.log\"\n\nset :rvm_ruby_version,            '2.1.1'\n\nset :keep_releases, 5\n\nnamespace :deploy do\n\n  desc 'Start application'\n  task :start do\n    on roles(:app), in: :sequence, wait: 5 do\n      execute \"sudo service nginx start\"\n    end\n  end\n\n  desc 'Stop application' do\n    task :stop do\n      on roles(:app), in: :sequence, wait: 5 do\n        execute 'sudo service nginx stop'\n      end\n    end\n  end\n\n  desc 'Restart application'\n  task :restart do\n    on roles(:app), in: :sequence, wait: 5 do\n      execute 'sudo service nginx reload'\n    end\n  end\n\n  task :migrate do\n    on roles(:app), in: :sequence, wait: 5 do\n      within release_path do\n        with rack_env: fetch(:rack_env) do\n          execute :rake, \"db:migrate\"\n        end\n      end\n    end\n  end\nend\n\nnamespace :remote_invoker do\n\n  desc 'Restart RemoteCallbackInvoker Daemon'\n    task :restart do\n      on roles(:app), in: :sequence, wait: 5 do\n      within release_path do\n        with rack_env: fetch(:rack_env) do\n          execute :ruby, \"./scripts/callback_invoker restart\"\n        end\n      end\n    end\n  end\nend\n\nafter 'deploy:updated', 'deploy:migrate'\nafter \"deploy:updated\", \"deploy:cleanup\" \nafter 'deploy:migrate', 'unicorn:restart'\nafter 'unicorn:restart', 'remote_invoker:restart'\n</code></pre>\n\n<p>Does anybody have any clue what can I look to debug this?</p>\n"}, {"tags": ["ruby", "rspec", "factory-bot", "padrino"], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 4995725, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VVnw39rs050/AAAAAAAAAAI/AAAAAAAAAhk/ukAYsLTcqrk/photo.jpg?sz=128", "display_name": "Mauricio Klein", "link": "https://stackoverflow.com/users/4995725/mauricio-klein"}, "is_accepted": true, "score": 0, "last_activity_date": 1434040006, "creation_date": 1434040006, "answer_id": 30786346, "question_id": 30761534, "link": "https://stackoverflow.com/questions/30761534/padrino-factorygirl-not-performing-lazy-loading/30786346#30786346", "title": "Padrino + FactoryGirl not performing Lazy Loading", "body": "<p>For those who it may interest, here is the solution I'm adopting to solve this problem:</p>\n\n<p>In User factory, instead:</p>\n\n<pre><code>after(:create) do |user, evaluator|\n  create_list(:rate, evaluator.rates_count, user: user)\nend\n</code></pre>\n\n<p>Do:</p>\n\n<pre><code>after(:create) do |user, evaluator|\n  user.rates &lt;&lt; create_list(:rate, evaluator.rates_count, user: user)\nend\n</code></pre>\n\n<p>It's not a proper solution, but solved my problem for now.</p>\n\n<p>Cheers o/</p>\n"}], "owner": {"reputation": 435, "user_id": 4995725, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VVnw39rs050/AAAAAAAAAAI/AAAAAAAAAhk/ukAYsLTcqrk/photo.jpg?sz=128", "display_name": "Mauricio Klein", "link": "https://stackoverflow.com/users/4995725/mauricio-klein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 30786346, "answer_count": 1, "score": 1, "last_activity_date": 1434040006, "creation_date": 1433952073, "question_id": 30761534, "link": "https://stackoverflow.com/questions/30761534/padrino-factorygirl-not-performing-lazy-loading", "title": "Padrino + FactoryGirl not performing Lazy Loading", "body": "<p>I'm developing my thesis on Padrino, using Active Record as ORM and FactoryGirl as Mocking framework.</p>\n\n<p>I'm facing a strange behavior.</p>\n\n<p>I've two models: User and Rate.</p>\n\n<pre><code>- User has a 'has_many :rates' association;\n- Rate has a 'belongs_to :user' association;\n- 'rates' table has an integer attribute named 'user_id' (not created with 'references' on migration, but directly with 'integer').\n</code></pre>\n\n<p>My association is working well, but only after performing a reload on parent object.</p>\n\n<p>Here are the snippets related to this issue:\n<a href=\"https://bitbucket.org/snippets/cuscos/MbdAK\" rel=\"nofollow\">https://bitbucket.org/snippets/cuscos/MbdAK</a></p>\n\n<p>If I start a 'Padrino Console' and create a user manually, this is the current behavior:</p>\n\n<pre><code>$ user = FactoryGirl.create(:user_with_rates)\n$ user.rates.length          # Received '0', but expected '1'\n$ user.rates.all.length     # Received '1', OK\n$ user.reload!\n$ user.rates.length          # Now I'm receiving '1' correctly\n</code></pre>\n\n<p>It seems that ActiveRecord isn't performing the Lazy Loading for any reason.</p>\n\n<p>Does anyone know why is this happening?</p>\n\n<p>Thanks for all support so far.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1433952390, "creation_date": 1433952390, "answer_id": 30761652, "question_id": 30761499, "link": "https://stackoverflow.com/questions/30761499/change-value-in-hash-using-an-array-of-keys-in-ruby/30761652#30761652", "title": "change value in hash using an array of keys in ruby", "body": "<p>Use all but the last key to get the most deeply nested Hash, then assign normally using the last key.</p>\n\n<pre><code>keys[0...-1].inject(hash, :fetch)[keys.last] = value\n</code></pre>\n\n<p>Ruby doesn't have references so you can't reassign the value directly. Instead you have to reassign the object pointer, which means going up one level of nesting.</p>\n"}], "owner": {"reputation": 430, "user_id": 2600803, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100000555733116/picture?type=large", "display_name": "Mario P. Waxenegger", "link": "https://stackoverflow.com/users/2600803/mario-p-waxenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 30761652, "answer_count": 1, "score": 1, "last_activity_date": 1433952390, "creation_date": 1433951966, "last_edit_date": 1495541158, "question_id": 30761499, "link": "https://stackoverflow.com/questions/30761499/change-value-in-hash-using-an-array-of-keys-in-ruby", "title": "change value in hash using an array of keys in ruby", "body": "<p>i was wondering if it is possible to access an value of a hash with an array of keys as described in the post <a href=\"https://stackoverflow.com/questions/17535215/ruby-use-array-tvalues-to-index-nested-hash-of-hash\">ruby use array tvalues to index nested hash of hash</a>. My aim is not just to access this value but to change this value.\nAs I understood</p>\n\n<pre><code>keys.inject(hash, :fetch)\n</code></pre>\n\n<p>returns the value of the hash-value determined by the key-array and not it's reference. How can I accomplish to modify this value?</p>\n\n<p>I know it's bad style to modify an object instead of making a copy and working with immutables but in severel cases it seems much more comfortable to do it the short way.</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1433951922, "post_id": 30761222, "comment_id": 49575665, "body": "On what line are you getting there error?"}, {"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "reply_to_user": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1433952038, "post_id": 30761222, "comment_id": 49575736, "body": "@JeffPrice I obtain the error when I try to access <code>localhost:4567&#47;block_key</code> (4567 is the default port where Sinatra runs) and after I have generated some keys"}, {"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "reply_to_user": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "edited": false, "score": 0, "creation_date": 1433952073, "post_id": 30761222, "comment_id": 49575759, "body": "@YuHao I have added more of the code. The remaining is, I am sure, irrelevant to my problem"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1433957070, "post_id": 30761222, "comment_id": 49578919, "body": "instead of <code>to_a.sample(1)</code> why not <code>keys.sample(1)</code> since you only care about the key anyway? Also <code>get_available_key</code> will return a <code>Hash</code> that is <code>@blocked_keys</code> or a <code>String</code> in the event <code>generated_keys</code> is empty. Is that the intended result because the method name suggests it should return a single key? Also returning 2 different object types from the same method will make handling a little more complex"}], "answers": [{"comments": [{"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1433952647, "post_id": 30761545, "comment_id": 49576151, "body": "<code>hash.to_a.sample(1)</code> returns a 2 dimensional array and not an element. So if I access <code>new_key[0]</code>, I will be accessing another array"}, {"owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "edited": false, "score": 0, "creation_date": 1434001128, "post_id": 30761545, "comment_id": 49595818, "body": "<code>new_key[0].class</code> returns <code>Array</code> while <code>new_key[0][0].class</code> returns <code>String</code>"}], "tags": [], "owner": {"reputation": 191, "user_id": 4987274, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/eaaee67835027c503d4634fbec58c9e3?s=128&d=identicon&r=PG", "display_name": "user4987274", "link": "https://stackoverflow.com/users/4987274/user4987274"}, "is_accepted": false, "score": 1, "last_activity_date": 1433952676, "last_edit_date": 1433952676, "creation_date": 1433952097, "answer_id": 30761545, "question_id": 30761222, "link": "https://stackoverflow.com/questions/30761222/to-obtain-random-pair-from-hash/30761545#30761545", "title": "To obtain random pair from Hash", "body": "<p><code>hash.to_a.sample</code> evaluates to a two-element array where the first element is some key and the second is the corresponding value.</p>\n\n<p>When you call delete you should be using <code>hash.delete(new_key[0])</code> instead of <code>hash.delete(new_key[0][0].to_s)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1433958579, "last_edit_date": 1433958579, "creation_date": 1433957569, "answer_id": 30763400, "question_id": 30761222, "link": "https://stackoverflow.com/questions/30761222/to-obtain-random-pair-from-hash/30763400#30763400", "title": "To obtain random pair from Hash", "body": "<p>To get a random element from a <code>Hash</code> to return as a <code>Hash</code> you could simply patch <code>Hash</code> to do this like </p>\n\n<pre><code>class Hash\n  def sample(n)\n    Hash[to_a.sample(n)]\n  end\nend\n</code></pre>\n\n<p>Then call like </p>\n\n<pre><code>h = {a: 1, b: 2, c: 3} \nh.sample(1)\n#=&gt; {b: 2}\nh.sample(2) \n#=&gt; {:b=&gt;2, :a=&gt;1}\n</code></pre>\n\n<p><strong>Note:</strong> I used <code>Hash::[]</code> for compatibility purposes in Ruby 2.X you could use <code>to_h</code> instead.</p>\n\n<p>Other than that I think there might be a few more issues with your code and it's return values.</p>\n\n<p>If I were to refactor your code the sample code above would not be needed I would instead go with something like it would be something like </p>\n\n<pre><code>def get_available_key\n  if(generated_keys.empty?)\n    {\"error\" =&gt; \"404. No keys available\"}\n  else\n    new_key = @generated_keys.keys.sample(1)\n    @generated_keys.delete(new_key)\n    @blocked_keys.merge!({new_key =&gt; Time.now})[new_key]\n  end\nend\n</code></pre>\n\n<p>This way it will always respond with a <code>Hash</code> object for handling purposes and it need not worry about multidimensional arrays at all. </p>\n\n<p>I would also change the initial code to be more like this </p>\n\n<pre><code>def create_new_key \n  key = SecureRandom.urlsafe_base64\n  purged_keys.include?(key) ? create_new_key  : key\nend\ndef generate_key\n  key = create_new_key \n  #add new key to hashes that maintain records\n  @generated_keys.merge!({key =&gt; Time.now})\n  @all_keys.merge!(@generated_keys) { |key, v1, v2| v1 }\n  key\nend\ndef add_to_key_chain(length)\n  @generated_keys ||= {}\n  length.times do \n    create_new_key\n  end\nend\n</code></pre>\n\n<p>Although I don't know what the <code>purged_keys</code> method looks like.</p>\n"}], "owner": {"reputation": 807, "user_id": 2651076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3274dc805ba25f33023bee2a4d32d6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Sinstein", "link": "https://stackoverflow.com/users/2651076/sinstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 0, "accepted_answer_id": 30763400, "answer_count": 2, "score": 1, "last_activity_date": 1433958579, "creation_date": 1433951240, "last_edit_date": 1495541238, "question_id": 30761222, "link": "https://stackoverflow.com/questions/30761222/to-obtain-random-pair-from-hash", "title": "To obtain random pair from Hash", "body": "<p>Part of <code>class KeyServer</code></p>\n\n<pre><code>@generated_keys = Hash.new\n\ndef generate_key\n    key = SecureRandom.urlsafe_base64\n    while(purged_keys.include?(key))\n      key = SecureRandom.urlsafe_base64\n    end\n    #add new key to hashes that maintain records\n    @generated_keys.merge!({key =&gt; Time.now})\n    @all_keys.merge!(@generated_keys) { |key, v1, v2| v1 }\n    return key\n  end\n</code></pre>\n\n<p>And I use the generated keys here: (I need a random pair to be selected and allotted to user)</p>\n\n<pre><code>def get_available_key\n    if(generated_keys.empty?)\n      return \"404. No keys available\"\n    else\n      new_key = @generated_keys.to_a.sample(1)\n      @generated_keys.delete(new_key[0][0].to_s)\n      @blocked_keys.merge!({new_key[0][0].to_s =&gt; Time.now})\n    end\n  end\n</code></pre>\n\n<p>This is how I use it in <code>Sinatra</code></p>\n\n<pre><code>api = KeyServer.new\nget '/block_key' do \n  api.get_available_key\nend\n</code></pre>\n\n<p>I tried the solution mentioned in this <a href=\"https://stackoverflow.com/questions/15454632/is-there-an-equivalent-to-arraysample-for-hashes-in-ruby\">question</a> but when I run this as part of my <code>Sinatra</code> server I obtain an <code>Internal Server Error: No implicit conversion from Array to String</code> </p>\n\n<p>How do I make this work? Any other method to obtain a random pair from a <code>Hash</code> would be welcome.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 4711, "user_id": 83729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5071d40db06ac987180c40e675b7193b?s=128&d=identicon&r=PG", "display_name": "msergeant", "link": "https://stackoverflow.com/users/83729/msergeant"}, "is_accepted": false, "score": 1, "last_activity_date": 1433951476, "creation_date": 1433951476, "answer_id": 30761289, "question_id": 30761113, "link": "https://stackoverflow.com/questions/30761113/how-to-parse-a-time-in-ruby-which-takes-a-string-in-hhmm-and-calculate-seconds/30761289#30761289", "title": "how to parse a time in Ruby which takes a string in HH:MM and calculate seconds into the day", "body": "<pre><code>Time.strptime(myString, \"%H:%M\") - Time.now.beginning_of_day\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4995127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77993c98eba39654674355f23cf498ae?s=128&d=identicon&r=PG&f=1", "display_name": "ruby learning", "link": "https://stackoverflow.com/users/4995127/ruby-learning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "closed_date": 1433956017, "answer_count": 1, "score": 0, "last_activity_date": 1433951476, "creation_date": 1433950938, "question_id": 30761113, "link": "https://stackoverflow.com/questions/30761113/how-to-parse-a-time-in-ruby-which-takes-a-string-in-hhmm-and-calculate-seconds", "closed_reason": "Duplicate", "title": "how to parse a time in Ruby which takes a string in HH:MM and calculate seconds into the day", "body": "<p>I have method which takes a string in HH:MM format and it should calculate how many seconds into the day it is</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 4463793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/de8b40388abdd390764991faae45f3ca?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/4463793/richard"}, "is_accepted": true, "score": 0, "last_activity_date": 1433951945, "creation_date": 1433951945, "answer_id": 30761490, "question_id": 30760959, "link": "https://stackoverflow.com/questions/30760959/updating-params-in-url-after-forced-manual-input/30761490#30761490", "title": "Updating params in URL after forced/manual input", "body": "<p>After MUCH frustration, I figured out that <code>params[:id]</code> returns a string and NOT an integer, therefore <code>to_i</code> is required to compare the two.</p>\n\n<p>Correct code: </p>\n\n<pre><code>#app/assets/controllers/profiles_controller.rb\ndef edit\n    ...\n    @profile = current_tutor.profile\n    if @profile.id != params[:id].to_i   # convert params[:id] to an integer value\n        redirect_to edit_profile_path(@profile.id)\n    end\n    ...\nend \n</code></pre>\n"}], "owner": {"reputation": 550, "user_id": 4463793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/de8b40388abdd390764991faae45f3ca?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/4463793/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 1, "accepted_answer_id": 30761490, "answer_count": 1, "score": 0, "last_activity_date": 1433951945, "creation_date": 1433950545, "question_id": 30760959, "link": "https://stackoverflow.com/questions/30760959/updating-params-in-url-after-forced-manual-input", "title": "Updating params in URL after forced/manual input", "body": "<p>I am currently using the Devise user system to set up a model <code>Tutor</code> which is associated to a model <code>Profile</code> whereby <code>Tutor has_one :profile</code> and <code>Profile belongs_to :tutor</code>. Therefore a tutor_id foreign key associates each profile entry to a tutor entry. </p>\n\n<p>In the <code>Profile</code> model, I have the usual Rails REST methods <code>new</code>, <code>edit</code>, <code>show</code>, <code>create</code> and <code>update</code>.</p>\n\n<p>When accessing <code>profile#edit</code> via the URI <code>/profiles/:id/edit</code>, edits are made correctly to the corresponding Tutor model of the profile regardless of what's entered in place of <code>:id</code> in the URL, but it seems kind of awkward for the URL to not reflect this.</p>\n\n<p>So if the <code>tutor</code> with <code>tutor_id: 2</code> and a profile <code>id: 2</code> is signed in, accessing the <code>edit</code> action via <code>/profiles/4/edit</code> or <code>/profiles/afjsdjfdsj/edit</code> somehow produces the same result as accessing the proper URL <code>/profiles/2/edit</code> and will still update the correct profile of the tutor.</p>\n\n<p>What I want to do is to update the URL in the address bar to reflect profile <code>id: 2</code>. I've tried using <code>redirect_to</code> in my <code>edit</code> method in my <code>ProfilesController</code> to no avail:</p>\n\n<pre><code>#app/assets/controllers/profiles_controller.rb\ndef edit\n    ...\n    @profile = current_tutor.profile\n    if @profile.id != params[:id]\n        redirect_to edit_profile_path(@profile.id)\n    end\n    ...\nend \n</code></pre>\n\n<p>Here is the profiles_controller.rb</p>\n\n<pre><code># app/assets/controllers/profiles_controller.rb\nclass ProfilesController &lt; ApplicationController\n  before_action :authenticate_tutor!, except: [:show]\n\n  # Everything handled by edit page\n  def new\n    @tutor = current_tutor\n\n    if (@tutor.profile.nil?)\n      @profile = @tutor.build_profile\n    else\n      @profile = @tutor.profile\n      redirect_to edit_profile_path(@profile.id)\n    end\n  end\n\n  def edit\n    @tutor = current_tutor\n\n    if (@tutor.profile.nil?)\n      redirect_to new_profile_path\n    else\n        @profile = @tutor.profile\n    end\n  end\n\n  def show\n    if tutor_signed_in?\n      @tutor = Tutor.find(current_tutor.id)\n      @profile = Profile.find(@tutor.profile.id)\n    else\n      @profile = Profile.find(params[:id])\n    end\n  end\n\n    # POST /tutors\n  # POST /tutors.json\n  def create\n    @profile = current_tutor.build_profile(profile_params)\n    if @profile.save\n      flash[:success] = \"Profile created!\"\n      redirect_to tutors_dashboard_path\n    else\n      render 'new'\n    end\n  end\n\n    # PATCH/PUT /tutors/1\n  # PATCH/PUT /tutors/1.json\n  def update\n    @profile = Profile.find(current_tutor.id)\n    if @profile.update(profile_params)\n     flash[:success] = \"Profile updated!\"\n     redirect_to tutors_dashboard_path\n   else\n     render 'edit'\n   end\n end\n\n private \n\n def profile_params\n   params.require(:profile).permit(:first_name, :last_name, :postal_code, :gender, :dob, :rate, :alma_mater, :major, :degree, :address, :phone_num, :travel_radius, :bio)\n end\n\nend\n</code></pre>\n\n<p>Here is the routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  root 'pages#home'\n\n  get '/about' =&gt; 'pages#about'\n  get '/contact' =&gt; 'pages#contact'\n  get '/about-tutors' =&gt; 'pages#about_tutors'\n  get '/about-students' =&gt; 'pages#about_students'\n\n  devise_for :tutors, controllers: {\n    confirmations: 'tutors/confirmations',\n    passwords: 'tutors/passwords',\n    registrations: 'tutors/registrations',\n    sessions: 'tutors/sessions'\n  }\n\n  get '/tutors/dashboard' =&gt; 'tutors#dashboard'\n\n  resources :profiles\nend\n</code></pre>\n"}, {"tags": ["ruby", "vagrant", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 1003, "user_id": 858944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3eea165e5121368690c56a08a226a403?s=128&d=identicon&r=PG", "display_name": "awm", "link": "https://stackoverflow.com/users/858944/awm"}, "edited": false, "score": 0, "creation_date": 1433956405, "post_id": 30761117, "comment_id": 49578516, "body": "Strange I copied it from the chef documentation <code>environment  { &#39;VAR&#39; =&gt; &#39;whatever&#39; }</code>...Anyway it is not giving me a no method found error. <code>: undefined method </code>environment&#39; for Chef::Resource::Git`"}], "tags": [], "owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "is_accepted": false, "score": 0, "last_activity_date": 1433950942, "creation_date": 1433950942, "answer_id": 30761117, "question_id": 30760561, "link": "https://stackoverflow.com/questions/30760561/unexpected-tassoc-in-a-chef-recipe-whats-wrong/30761117#30761117", "title": "Unexpected tASSOC, in a chef recipe. What&#39;s wrong?", "body": "<p>The correct syntax would be either</p>\n\n<pre><code>environment({ 'VAR' =&gt; 'whatever' })\n</code></pre>\n\n<p>or</p>\n\n<pre><code>environment 'VAR' =&gt; 'whatever'\n</code></pre>\n"}], "owner": {"reputation": 1003, "user_id": 858944, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3eea165e5121368690c56a08a226a403?s=128&d=identicon&r=PG", "display_name": "awm", "link": "https://stackoverflow.com/users/858944/awm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433950942, "creation_date": 1433949530, "question_id": 30760561, "link": "https://stackoverflow.com/questions/30760561/unexpected-tassoc-in-a-chef-recipe-whats-wrong", "title": "Unexpected tASSOC, in a chef recipe. What&#39;s wrong?", "body": "<p>I keep getting the an error when I try to use the <code>environment</code> attribute in a chef recipe:</p>\n\n<pre><code>git name do\n        repository repo_url \n        revision \"master\"\n        environment  { 'VAR' =&gt; 'whatever' }\n        action :sync\n      end\n</code></pre>\n\n<p>The error is :</p>\n\n<pre><code>ERROR: /tmp/vagrant-chef-3/chef-solo-3/cookbooks/JandJ/recipes/git_repo.rb:11: syntax error, unexpected tASSOC, expecting '}'\n==&gt; default:            environment  { 'VAR' =&gt; 'whatever' }\n</code></pre>\n\n<p>I copied the example from the chef docs <a href=\"https://docs.chef.io/resource_git.html\" rel=\"nofollow\">here</a> </p>\n"}, {"tags": ["javascript", "arrays", "ruby", "object", "hash"], "comments": [{"owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1433948109, "post_id": 30759908, "comment_id": 49572863, "body": "what is your expected output?"}, {"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "edited": false, "score": 0, "creation_date": 1433948277, "post_id": 30759908, "comment_id": 49573000, "body": "What have you tried so far? That code would almost work as-is in Ruby if you made a couple minor modifications to the for loops and dropped the <code>var</code> keyword. (Though of course, there&#39;s also a much more idiomatic way of doing it.)"}, {"owner": {"reputation": 141, "user_id": 4448738, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/508300561/picture?type=large", "display_name": "Iain Watt", "link": "https://stackoverflow.com/users/4448738/iain-watt"}, "edited": false, "score": 0, "creation_date": 1433948408, "post_id": 30759908, "comment_id": 49573093, "body": "an array (total) that is only the prices of the items in the basket"}, {"owner": {"reputation": 141, "user_id": 4448738, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/508300561/picture?type=large", "display_name": "Iain Watt", "link": "https://stackoverflow.com/users/4448738/iain-watt"}, "reply_to_user": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "edited": false, "score": 0, "creation_date": 1433948569, "post_id": 30759908, "comment_id": 49573219, "body": "@Ajedi32, I have tried something very similar but what happens is that instead of &#39;pushing&#39; the value of the hash that corresponds to the array it just pushes all the values. I am not familiar with the syntax so dont think I am being spcific enough about the iterations? Maybe"}, {"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "edited": false, "score": 0, "creation_date": 1433948820, "post_id": 30759908, "comment_id": 49573435, "body": "@IainWatt If you edit the actual code Ruby code you tried into the question we can definitely help you understand what&#39;s wrong with it and what changes you would need to make it work. Without that though, your question reads kind of like &quot;hey, port this code to Ruby for me&quot;, which some people will happily do, but doesn&#39;t make for a good question."}, {"owner": {"reputation": 141, "user_id": 4448738, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/508300561/picture?type=large", "display_name": "Iain Watt", "link": "https://stackoverflow.com/users/4448738/iain-watt"}, "reply_to_user": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "edited": false, "score": 0, "creation_date": 1433949948, "post_id": 30759908, "comment_id": 49574269, "body": "@Ajedi32, yes I know i was sort of asking that... sorry, will explain more with the next question"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1433949614, "post_id": 30760176, "comment_id": 49574048, "body": "or even more concisely <code>pCodePrice.values_at(*basket) #=&gt;[3.11, 5, 3.11, 3.11, 11.23]</code>"}, {"owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "edited": false, "score": 0, "creation_date": 1433951854, "post_id": 30760176, "comment_id": 49575613, "body": "engineersmnky, Thanks! I wasn&#39;t familiar with values_at. What a nice method."}], "tags": [], "owner": {"reputation": 3129, "user_id": 227397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVdnG.jpg?s=128&g=1", "display_name": "Jeff Price", "link": "https://stackoverflow.com/users/227397/jeff-price"}, "is_accepted": true, "score": 4, "last_activity_date": 1433948505, "creation_date": 1433948505, "answer_id": 30760176, "question_id": 30759908, "link": "https://stackoverflow.com/questions/30759908/nested-loop-in-ruby-hash-and-array/30760176#30760176", "title": "Nested Loop in Ruby, Hash and Array", "body": "<p>It's pretty simple in ruby using map.</p>\n\n<pre><code>pCodePrice = { 'GR1' =&gt; 3.11, 'SR1' =&gt; 5, 'CF1' =&gt; 11.23 }\n =&gt; {\"GR1\"=&gt;3.11, \"SR1\"=&gt;5, \"CF1\"=&gt;11.23} \nbasket = ['GR1','SR1','GR1','GR1','CF1']\n =&gt; [\"GR1\", \"SR1\", \"GR1\", \"GR1\", \"CF1\"] \ntotal = basket.map { |code| pCodePrice[code] }\n =&gt; [3.11, 5, 3.11, 3.11, 11.23] \n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 4448738, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/508300561/picture?type=large", "display_name": "Iain Watt", "link": "https://stackoverflow.com/users/4448738/iain-watt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 30760176, "answer_count": 1, "score": -1, "last_activity_date": 1433948505, "creation_date": 1433947923, "question_id": 30759908, "link": "https://stackoverflow.com/questions/30759908/nested-loop-in-ruby-hash-and-array", "title": "Nested Loop in Ruby, Hash and Array", "body": "<p>How can i do this in Ruby </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var pCodePrice = {\r\n  'GR1': 3.11,\r\n  'SR1': 5,\r\n  'CF1': 11.23\r\n};\r\nvar basket = ['GR1', 'SR1', 'GR1', 'GR1', 'CF1'];\r\nvar total = [];\r\n\r\n\r\nfor (i = 0, x = basket.length; i &lt; x; i++) {\r\n  for (var prop in pCodePrice) {\r\n    if (basket[i] == prop) {\r\n      total.push(pCodePrice[prop])\r\n    }\r\n\r\n  }\r\n\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This loops through the array and checks to see if the item matches the key of the hash in the inner loop, if so it pushes the value into a new array. </p>\n\n<p>I just cant get it in Ruby,</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 21831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413faf211358af7cae68c1f2137de0f8?s=128&d=identicon&r=PG", "display_name": "Mel", "link": "https://stackoverflow.com/users/21831/mel"}, "is_accepted": false, "score": 0, "last_activity_date": 1461880707, "creation_date": 1461880707, "answer_id": 36926224, "question_id": 30759673, "link": "https://stackoverflow.com/questions/30759673/rails-actionmailer-receive-method-does-nothing/36926224#36926224", "title": "Rails ActionMailer receive method does nothing", "body": "<p>I think you want to refer to Action Mailer Basics Guide: <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html#receiving-emails\" rel=\"nofollow\">http://guides.rubyonrails.org/action_mailer_basics.html#receiving-emails</a></p>\n\n<p>I'm interpreting their suggestion to mean: Configure your mail server/process to \"pipe into\" a Rails runner script... That would account for the STDIN.read; the contents of the mail message would be passed into the script.</p>\n\n<p>HTH.</p>\n"}], "owner": {"reputation": 1929, "user_id": 2599875, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8df321b0acd6bc227bafe0ff4bd0ac5d?s=128&d=identicon&r=PG", "display_name": "mariowise", "link": "https://stackoverflow.com/users/2599875/mariowise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1461880707, "creation_date": 1433947330, "question_id": 30759673, "link": "https://stackoverflow.com/questions/30759673/rails-actionmailer-receive-method-does-nothing", "title": "Rails ActionMailer receive method does nothing", "body": "<p>I'm following the Rails official doc about <a href=\"https://github.com/rails/rails/tree/master/actionmailer#receiving-emails\" rel=\"nofollow\">action mailer receive method</a> and testing with the <code>rails runner 'UserMailer.receive(STDIN.read)'</code> command but <strong>nothing happens</strong>.</p>\n\n<pre><code>class UserMailer &lt; ActionMailer::Base\n  add_template_helper EmailHelper\n  default from: \"xx@xxx.xxx\"\n\n  def user_created(params)\n    @user = User.find params[0]\n    @creator = User.find params[1]\n    if @user &amp;&amp; @creator\n        mail(to: @user.email, subject: \"......\").deliver\n    else\n        logger.info \"......\"\n    end\n  end\n\n  def receive(email)\n    puts YAML::dump email\n  end\nend\n</code></pre>\n\n<p>Here's the detail about my Rails app</p>\n\n<pre><code>rails@4.1.6\nactionmailer@4.1.5\n</code></pre>\n\n<p>The <code>UserMailer</code> actually sends emails but can not receive them. Any ideas?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "view-helpers"], "answers": [{"tags": [], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "is_accepted": true, "score": 0, "last_activity_date": 1438264434, "creation_date": 1438264434, "answer_id": 31725706, "question_id": 30759658, "link": "https://stackoverflow.com/questions/30759658/rails-loading-modals/31725706#31725706", "title": "Rails loading modals", "body": "<p>This seems to work</p>\n\n<p>application_helper.rb</p>\n\n<pre><code>  def load_modal(*args)\n    unless (@modals ||= []).include?(args.first)\n      @modals.push(*args)\n    end\n  end\n</code></pre>\n\n<p>application.html.erb</p>\n\n<pre><code>&lt;% if @modals\n    @modals.each do |modal_with_args| %&gt;\n      &lt;%= render(modal_with_args) %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 31725706, "answer_count": 1, "score": 0, "last_activity_date": 1438264434, "creation_date": 1433947295, "question_id": 30759658, "link": "https://stackoverflow.com/questions/30759658/rails-loading-modals", "title": "Rails loading modals", "body": "<p>I have some views which require a lot of partials, which in turn require several bootstrap modals to work correctly.</p>\n\n<p>However, loading modals is a bit painful, because if I load them in the wrong tag, it can completely screw them up, and duplicate them.</p>\n\n<p>I'd like to have a nice helper <code>load_modal</code>, which would actually save a list of modals which need to be loaded. Then, in a part of my HTML of my choosing, I can choose to iterate over this list to load the partials</p>\n\n<p><strong>MY PROBLEM</strong></p>\n\n<p>How can I store the list of partials to be called AS WELL AS THEIR ARGUMENTS ?</p>\n\n<p>I have thought of the following, (deliberately using non-working syntax as I didn't know how to do otherwise)</p>\n\n<p><em>application_helper.rb</em></p>\n\n<pre><code># Input should look like \n# =&gt; 'path_to_partial', {locals}\ndef load_modal(*args)\n  unless (@modals ||= []).include?(args.first)\n    @modals &lt;&lt; args\n  end\nend\n</code></pre>\n\n<p><em>some_partial.html.erb</em></p>\n\n<pre><code>&lt;% load_modals('project/deadline', project: @project) %&gt;\n</code></pre>\n\n<p><em>application.html</em></p>\n\n<pre><code>&lt;% if @modals\n    @modals.each do |modal| %&gt;\n        &lt;%= render(modal) %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note : the current error with this code is </p>\n\n<pre><code>'\"project/deadline\"' is not an ActiveModel-compatible object. It must implement :to_partial_path.\n</code></pre>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1433974823, "post_id": 30760050, "comment_id": 49588714, "body": "Is this your answer, or the code that should have been included in the question?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1433974929, "post_id": 30760050, "comment_id": 49588767, "body": "Don&#39;t do things like <code>jersery.text == jersey_number</code>. The <code>text</code> can contain whitespace, such as spaces, tabs, new-lines, carriage-returns, non-breaking-spaces, i.e., things that are NOT what you want to compare to. Instead, clean up your text before comparing."}, {"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1434013343, "post_id": 30760050, "comment_id": 49602863, "body": "@theTinMan, this is an answer - it returns what i wanted, but I think it&#39;s not great...what you said about jersey.text is maybe one of the reasons why.  thanks for that tip though, i will keep that in mind going forward"}], "tags": [], "owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "is_accepted": false, "score": 0, "last_activity_date": 1433948240, "creation_date": 1433948240, "answer_id": 30760050, "question_id": 30759418, "link": "https://stackoverflow.com/questions/30759418/searching-a-list-of-similar-elements-for-a-given-value/30760050#30760050", "title": "Searching a list of similar elements for a given value", "body": "<p>This works, but I expect there is a better way to go about it: </p>\n\n<pre><code>jersey_number = '23'\nplayers = feed.xpath(\"/Team[@uID='#{team_uid}']//Player\")\nplayer = players.xpath(\"//Stat[@Type='jersey_num']\").detect do |jersery|\n  jersery.text == jersey_number\nend\nplayer\n#=&gt;#&lt;Nokogiri::XML::Element:0x95e8f4 name=\"Stat\" attributes=[#&lt;Nokogiri::XML::Attr:0x9407dc name=\"Type\" value=\"jersey_num\"&gt;] children=[#&lt;Nokogiri::XML::Text:0x940048 \"23\"&gt;]&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 1, "creation_date": 1434015678, "post_id": 30768810, "comment_id": 49604520, "body": "that works beautifully, i knew it could be done with xpath alone.  thank you"}], "tags": [], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "is_accepted": true, "score": 2, "last_activity_date": 1434002994, "last_edit_date": 1434002994, "creation_date": 1433977509, "answer_id": 30768810, "question_id": 30759418, "link": "https://stackoverflow.com/questions/30759418/searching-a-list-of-similar-elements-for-a-given-value/30768810#30768810", "title": "Searching a list of similar elements for a given value", "body": "<blockquote>\n  <p>\"... but I want to find a player with a given jersey number, and then pull its uID\"</p>\n</blockquote>\n\n<p>Then the xpath parameter should look about like this :</p>\n\n<pre><code>/Team[@uID='#{team_uid}']//Player[Stat[@Type='jersey_num' and .='#{jersey_num}']]/@uID\n</code></pre>\n\n<p>or maybe without trailing <code>/@uID</code> to get <code>Player</code> element, and then do further extraction from ruby code. Notice that <code>Stat[....]</code> part in the above xpath filters <code>Stat</code> element by <code>Type</code> attribute value and by value of the element itself.</p>\n"}], "owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 30768810, "answer_count": 2, "score": 0, "last_activity_date": 1436991657, "creation_date": 1433946686, "last_edit_date": 1436991657, "question_id": 30759418, "link": "https://stackoverflow.com/questions/30759418/searching-a-list-of-similar-elements-for-a-given-value", "title": "Searching a list of similar elements for a given value", "body": "<p>I have some XML like this:</p>\n\n<pre><code>&lt;Team ...some attributes...&gt;\n  &lt;Name&gt;My Team&lt;/Name&gt;\n  &lt;Player uID=\"player1\"&gt;\n    &lt;Name&gt;Name&lt;/Name&gt;\n    &lt;Position&gt;Goalkeeper&lt;/Position&gt;\n    &lt;Stat Type=\"first_name\"&gt;Name&lt;/Stat&gt;\n    &lt;Stat Type=\"last_name\"&gt;Last&lt;/Stat&gt;\n    &lt;Stat Type=\"birth_date\"&gt;bday&lt;/Stat&gt;\n    &lt;Stat Type=\"birth_place\"&gt;bplace&lt;/Stat&gt;\n    &lt;Stat Type=\"weight\"&gt;84&lt;/Stat&gt;\n    &lt;Stat Type=\"height\"&gt;183&lt;/Stat&gt;\n    &lt;Stat Type=\"jersey_num\"&gt;1&lt;/Stat&gt;\n  &lt;/Player&gt;\n  &lt;Player uID=\"player2\"&gt;\n    ...\n  &lt;/Player&gt;\n  ...\n&lt;/Team&gt;\n</code></pre>\n\n<p>I want to search for players by <code>jersey_num</code>.  I'm using Nokogiri and this code gets me sort of close:</p>\n\n<pre><code>feed.xpath(\"/Team[@uID='#{team_uid}']//Player/Stat[@Type='jersey_num']\")\n</code></pre>\n\n<p>That returns all the players in a given team, and an array of their jersey number attribute rows, but I want to find a player with a given jersey number, and then pull its <code>uID</code>.</p>\n\n<p>I can do that with ancestor, but first I need this search to yield only one matching player.  I realize at the moment I'm not searching for it, but I'm not sure how to search given the <code>Stat Type</code> syntax.</p>\n"}, {"tags": ["ruby", "performance", "io", "network-programming"], "answers": [{"tags": [], "owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "is_accepted": false, "score": 0, "last_activity_date": 1433948320, "creation_date": 1433948320, "answer_id": 30760091, "question_id": 30758927, "link": "https://stackoverflow.com/questions/30758927/does-a-process-waiting-on-a-network-response-take-cpu-ram-resources/30760091#30760091", "title": "Does a process waiting on a network response take cpu/ram resources?", "body": "<p>It doesn't consume your CPU but it will not free the memory that is already allocated. It will just wait (sleep) till the data is available.</p>\n"}], "owner": {"reputation": 762, "user_id": 4949386, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a4f78608dae9e9cf14a732e366ea016a?s=128&d=identicon&r=PG&f=1", "display_name": "zino", "link": "https://stackoverflow.com/users/4949386/zino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433948320, "creation_date": 1433945626, "question_id": 30758927, "link": "https://stackoverflow.com/questions/30758927/does-a-process-waiting-on-a-network-response-take-cpu-ram-resources", "title": "Does a process waiting on a network response take cpu/ram resources?", "body": "<p>For example, a Ruby script that sends an HTTP GET request. Whilst waiting/receiving the response, is that process using CPU or RAM resources?</p>\n\n<p>If the response takes 500ms, does that mean thats 500ms CPU/RAM is taken and cannot be used? Or does the process go into a kind of \"sleep\" state until the request is received, freeing up resources in the mean time?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1433945632, "post_id": 30758837, "comment_id": 49570829, "body": "What about this: <a href=\"http://stackoverflow.com/questions/15763965/how-can-i-calculate-the-median-of-values-in-sqlite\" title=\"how can i calculate the median of values in sqlite\">stackoverflow.com/questions/15763965/&hellip;</a>"}, {"owner": {"reputation": 2678, "user_id": 2483138, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1320d18fa8806488f96baad70b29ce4c?s=128&d=identicon&r=PG", "display_name": "ABMagil", "link": "https://stackoverflow.com/users/2483138/abmagil"}, "edited": false, "score": 0, "creation_date": 1433947198, "post_id": 30758837, "comment_id": 49572095, "body": "Do you want to calculate in memory or database?"}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1481034346, "post_id": 30758837, "comment_id": 69203813, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14859120/calculating-median-in-ruby\">Calculating Median in Ruby</a>"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4797451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/94c36ab94de5f1979c6d0dac5e584fbf?s=128&d=identicon&r=PG&f=1", "display_name": "WallE", "link": "https://stackoverflow.com/users/4797451/walle"}, "edited": false, "score": 0, "creation_date": 1434032266, "post_id": 30758910, "comment_id": 49616771, "body": "Thanks, I am working with a  group of objects so I adjusted this as such:  \t           def self.median(relation, column_name) \t\tarray = [] \t\trelation.select(column_name).each do |x| \t\t\tarray &lt;&lt; x.send(column_name) \t\tend   \t\tsorted = array.sort   \t\tlen = sorted.length   \t\treturn (sorted[(len - 1) / 2] + sorted[len / 2]) / 2.0 \tend"}], "tags": [], "owner": {"reputation": 2227, "user_id": 4723393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c0ZUW.jpg?s=128&g=1", "display_name": "Akshay Borade", "link": "https://stackoverflow.com/users/4723393/akshay-borade"}, "is_accepted": true, "score": 0, "last_activity_date": 1433945590, "creation_date": 1433945590, "answer_id": 30758910, "question_id": 30758837, "link": "https://stackoverflow.com/questions/30758837/how-to-calculate-median-in-a-rails-app-that-uses-sqlite3/30758910#30758910", "title": "How to calculate median in a Rails app that uses SQLite3?", "body": "<p>Try this to calculate median</p>\n\n<pre><code>def median(array)\n  sorted = array.sort\n  len = sorted.length\n  return (sorted[(len - 1) / 2] + sorted[len / 2]) / 2.0\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4797451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/94c36ab94de5f1979c6d0dac5e584fbf?s=128&d=identicon&r=PG&f=1", "display_name": "WallE", "link": "https://stackoverflow.com/users/4797451/walle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 30758910, "answer_count": 1, "score": 0, "last_activity_date": 1433945590, "creation_date": 1433945387, "question_id": 30758837, "link": "https://stackoverflow.com/questions/30758837/how-to-calculate-median-in-a-rails-app-that-uses-sqlite3", "title": "How to calculate median in a Rails app that uses SQLite3?", "body": "<p>Is there a way to do a median calc in a Rails 4 app that uses the default SQLite3 database?</p>\n\n<p>I've built the app already but would like to add a median function, and I see that the active_median gem only works with PostgreSQL for now:</p>\n\n<p><a href=\"https://github.com/ankane/active_median\" rel=\"nofollow\">https://github.com/ankane/active_median</a></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "nginx"], "comments": [{"owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1433944638, "post_id": 30758402, "comment_id": 49570084, "body": "How large is the production database? Is the database properly indexed? What&#39;s the definition of <code>get_products</code>?"}, {"owner": {"reputation": 965, "user_id": 1164983, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c265439c89d470145c8b393f4c44312f?s=128&d=identicon&r=PG", "display_name": "DEREK N", "link": "https://stackoverflow.com/users/1164983/derek-n"}, "reply_to_user": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1433945003, "post_id": 30758402, "comment_id": 49570378, "body": "I have updated my question to show the definition of get_products method inside Product model. Regarding the database, it is absolutely new (only a handful of records - less than 50) and is indexed."}, {"owner": {"reputation": 324, "user_id": 905987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0c7d88ecacb16e0fa21b4d43446425?s=128&d=identicon&r=PG", "display_name": "Ollie", "link": "https://stackoverflow.com/users/905987/ollie"}, "edited": false, "score": 0, "creation_date": 1433945456, "post_id": 30758402, "comment_id": 49570702, "body": "How does log_info look like? Does it hang if you disable it, too?"}, {"owner": {"reputation": 965, "user_id": 1164983, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c265439c89d470145c8b393f4c44312f?s=128&d=identicon&r=PG", "display_name": "DEREK N", "link": "https://stackoverflow.com/users/1164983/derek-n"}, "edited": false, "score": 0, "creation_date": 1433945681, "post_id": 30758402, "comment_id": 49570868, "body": "log_info just has a single line calling the Rails logger. Here it is:         Rails.logger.info &quot;[INFO][#{Time.current}][#{module_name}][#{message}]&quot;.  I have not tried disabling it, but then I do not suspect it to be the issue, because it is just a logger call. I added calls to log_info to debug the issue. The problem existed before these calls to log_info were added."}, {"owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "edited": false, "score": 0, "creation_date": 1433948877, "post_id": 30758402, "comment_id": 49573475, "body": "It looks like it does something else before actually calling your action. Do you have any before filter, perhaps authentication? Also do you have any external session/cache store...? I would also try to use profiler. Often it can show you the exact spot that takes the most time..."}, {"owner": {"reputation": 965, "user_id": 1164983, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c265439c89d470145c8b393f4c44312f?s=128&d=identicon&r=PG", "display_name": "DEREK N", "link": "https://stackoverflow.com/users/1164983/derek-n"}, "reply_to_user": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "edited": false, "score": 0, "creation_date": 1433951104, "post_id": 30758402, "comment_id": 49575078, "body": "Thanks a lot @evgeny.myasishchev. The problem was caused because of a before filter in application controller. Commenting it out solves the issue. Could you please post your comment as an answer so that I can select it as the right one? Thanks again."}, {"owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "edited": false, "score": 0, "creation_date": 1434011562, "post_id": 30758402, "comment_id": 49601672, "body": "sure, just added it as an answer"}], "answers": [{"tags": [], "owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "is_accepted": true, "score": 1, "last_activity_date": 1434011357, "creation_date": 1434011357, "answer_id": 30775524, "question_id": 30758402, "link": "https://stackoverflow.com/questions/30758402/rails-controller-action-hanging/30775524#30775524", "title": "Rails controller action hanging", "body": "<p>Please check if there are any before filters, quite often they can be the reason of such hangs.</p>\n"}], "owner": {"reputation": 965, "user_id": 1164983, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c265439c89d470145c8b393f4c44312f?s=128&d=identicon&r=PG", "display_name": "DEREK N", "link": "https://stackoverflow.com/users/1164983/derek-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 30775524, "answer_count": 1, "score": 0, "last_activity_date": 1434011357, "creation_date": 1433944382, "last_edit_date": 1433945363, "question_id": 30758402, "link": "https://stackoverflow.com/questions/30758402/rails-controller-action-hanging", "title": "Rails controller action hanging", "body": "<p>I am a newbie in ruby/rails and have been breaking my head with a problem for the past 2 days and am hoping that someone in this forum can help me out with it. </p>\n\n<p>I am working on rails 4 and running an application in production using Passenger + Nginx with Mysql database (mysql2 adapter). I have following code in my ProductsController.rb (log_info is my custom logging wrapper that just calls the Rails logger):</p>\n\n<pre><code>def index\n    log_info(\"ProductsController\", \"Getting Products...\")\n    @products = Product.get_products(params[:offset])\n    log_info(\"ProductsController\", \"Got all Products...\")\n\n    # populate access_url before sending the data through\n    update_products_with_access_url(@products)\nend\n</code></pre>\n\n<p>Here is the definition of get_products function inside Product model:</p>\n\n<pre><code>def self.get_products(products_offset)\n    products_offset ||= 0\n\n    Product.includes(:categories, :suppliers).\n            where(active: true).order(updated_at: :desc).\n            limit(20).\n            offset(products_offset * 20)\nend\n</code></pre>\n\n<p>The problem is that my application hangs in production (works fine in dev) for a few mins when the index action is called. This behaviour is happening almost half the time - it works fine the other half of time. </p>\n\n<p>I can see in the log that the action has been called but is not getting executed. Here is a snippet from the log file:</p>\n\n<pre><code>I, [2015-06-10T13:31:01.802673 #14916]  INFO -- : Processing by ProductsController#index as HTML\nI, [2015-06-10T13:33:09.718339 #14916]  INFO -- : [INFO][2015-06-10 13:33:09 UTC][ProductsController][Getting Products...]\nI, [2015-06-10T13:33:09.719365 #14916]  INFO -- : [INFO][2015-06-10 13:33:09 UTC][ProductsController][Got all Products...]\nD, [2015-06-10T13:33:09.720980 #14916] DEBUG -- :   Product Load (0.8ms)  SELECT  `products`.* FROM `products` WHERE `products`.`active` = 1  ORDER BY `products`.`updated_at` DESC LIMIT 12 OFFSET 0\nD, [2015-06-10T13:33:09.725110 #14916] DEBUG -- :   ProductCategory Load (0.5ms)  SELECT `product_categories`.* FROM `product_categories` WHERE `product_categories`.`product_id` IN (30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19)\n</code></pre>\n\n<p>As you can see there is difference of at least 2 mins between the first two lines of log file above. And the log shows that index action had received the call, but I am not sure why it is taking so long (sometimes more than 5 mins.) to execute the very first line in that index action. I suspect there is some kind of caching happening. I was earlier thinking that the call might be hanging in connecting with MySQL database, but now am not sure. Am I missing something here? </p>\n\n<p>Can someone please help me out in fixing this application hang issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "heroku", "rack"], "comments": [{"owner": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "edited": false, "score": 0, "creation_date": 1433943854, "post_id": 30757805, "comment_id": 49569424, "body": "Have you tried the <a href=\"https://github.com/mattolson/heroku_rails_deflate\" rel=\"nofollow noreferrer\">heroku_rails_deflate</a> gem?"}, {"owner": {"reputation": 1, "user_id": 1532801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc82c4e70702ec257385e9c91610ccd?s=128&d=identicon&r=PG", "display_name": "Ary Ribeiro Rabelo", "link": "https://stackoverflow.com/users/1532801/ary-ribeiro-rabelo"}, "reply_to_user": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "edited": false, "score": 0, "creation_date": 1433948721, "post_id": 30757805, "comment_id": 49573355, "body": "I&#39;ve tried rack-zippy, but now i&#39;m trying to use Cloudfront pointing to Amazon S3"}], "owner": {"reputation": 1, "user_id": 1532801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc82c4e70702ec257385e9c91610ccd?s=128&d=identicon&r=PG", "display_name": "Ary Ribeiro Rabelo", "link": "https://stackoverflow.com/users/1532801/ary-ribeiro-rabelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433942880, "creation_date": 1433942880, "question_id": 30757805, "link": "https://stackoverflow.com/questions/30757805/rails-app-hosted-in-heroku-with-cloudfront-giving-neterr-invalid-chunked-enc", "title": "Rails App hosted in heroku, with Cloudfront, giving net::ERR_INVALID_CHUNKED_ENCODING", "body": "<p>When i try to serve Gzipped assets, i'm getting <strong>net::ERR_INVALID_CHUNKED_ENCODING</strong> randomly in my assets. Now I'm using Rack zippy gem, I've tried to use Rack deflate and gives the same error. My cloudfront is pointing to Heroku. \nMore info and relevant source codes:</p>\n\n<p><code>$ rake middleware</code>                                                 </p>\n\n<pre><code>use Honeybadger::Rack::UserInformer\nuse Honeybadger::Rack::UserFeedback\nuse Honeybadger::Rack::ErrorNotifier\nuse Rack::Sendfile\nuse Rack::Zippy::AssetServer\nuse Rack::Lock\nuse #&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x00000008358600&gt;\n(...)\n</code></pre>\n\n<h3>config.ru</h3>\n\n<pre><code># This file is used by Rack-based servers to start the application.\nrequire ::File.expand_path('../config/environment',  __FILE__)\nuse Rack::Chunked\nuse Rack::Deflater\nrun Soprojetos::Application\n</code></pre>\n\n<h3>initializer rack_zippy.ru</h3>\n\n<pre><code>Rails.application.config.middleware.swap(ActionDispatch::Static, Rack::Zippy::AssetServer)\n\nRack::Zippy.configure do |config|\n  config.static_extensions &lt;&lt; 'xml'\nend\n</code></pre>\n\n<h3>enviroments/production.rb</h3>\n\n<pre><code>(...)\n  config.assets.compress = true\n  # Disable Rails's static asset server (Apache or nginx will already do this).\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS.\n  config.assets.js_compressor = :uglifier\n  # config.assets.css_compressor = :sass\n\n  # Do not fallback to assets pipeline if a precompiled asset is missed.\n  config.assets.compile = false\n\n  # Generate digests for assets URLs.\n  config.assets.digest = true\n\n  (...)\n\n  config.middleware.use Rack::Attack\n\n  config.middleware.insert_before ActionDispatch::Static, Rack::SSL, :exclude =&gt; proc { |env| env['HTTPS'] != 'on' }\n(...)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "solr", "sunspot", "sunspot-rails"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 3907709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nt4qg.jpg?s=128&g=1", "display_name": "AmitejKalra", "link": "https://stackoverflow.com/users/3907709/amitejkalra"}, "is_accepted": false, "score": 0, "last_activity_date": 1434004676, "creation_date": 1434004676, "answer_id": 30773385, "question_id": 30757510, "link": "https://stackoverflow.com/questions/30757510/query-always-the-same-with-sunspot-solr-on-rails/30773385#30773385", "title": "Query always the same with Sunspot/Solr on rails", "body": "<p>I think the params you are using for search are not correct. </p>\n\n<pre><code>&lt;%= search_field_tag :term,\"#{@term}\", class: 'form-control' %&gt;\n</code></pre>\n\n<p>means that the params that you are passing back to the controller is [:term],</p>\n\n<p>so the code should be something like:</p>\n\n<pre><code>if params[:term].present?\n            pictograms = Array.new\n            @term = params[:term]\n            search = Tag.search do\n                fulltext params[:term]\n            end\n</code></pre>\n\n<p>and not params[:search] and params[:query] like you have tried.</p>\n"}], "owner": {"reputation": 471, "user_id": 4524405, "user_type": "registered", "accept_rate": 9, "profile_image": "https://lh5.googleusercontent.com/-fjErJCkTgpE/AAAAAAAAAAI/AAAAAAAAEA0/Yuvi6mOQONs/photo.jpg?sz=128", "display_name": "Gregory Frerot", "link": "https://stackoverflow.com/users/4524405/gregory-frerot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434004676, "creation_date": 1433942205, "question_id": 30757510, "link": "https://stackoverflow.com/questions/30757510/query-always-the-same-with-sunspot-solr-on-rails", "title": "Query always the same with Sunspot/Solr on rails", "body": "<p>I have a problem with sunspot. When i do a SOLR request i have always the same query.</p>\n\n<p><code>SOLR Request (3.7ms)  [ path=select parameters={fq: [\"type:Tag\"], start: 0, rows: 30, q: \"*:*\"} ]</code></p>\n\n<p>No matter what I type in the search field , it's always the same query</p>\n\n<p>Here my code : </p>\n\n<p><strong>tag.rb</strong></p>\n\n<pre><code>class Tag &lt; ActiveRecord::Base\n    belongs_to :pictogram\n    searchable do\n        text :name\n    end\nend\n</code></pre>\n\n<p><strong>searchs_controller.rb</strong></p>\n\n<pre><code>class SearchsController &lt; ApplicationController\n    def index\n        if params[:search]\n            pictograms = Array.new\n            @term = params[:query]\n            search = Tag.search do\n                fulltext @term\n            end\n\n\n            index = 0\n            search.results.each do |t|\n                if !pictograms.include? t.pictogram\n                    pictograms[index] = t.pictogram\n                    index = index + 1\n                end\n            end\n\n            @results = pictograms.group_by { |p| p.category }\n            @search_mode = true\n        end\n    end\nend\n</code></pre>\n\n<p><strong>index.html</strong></p>\n\n<pre><code>&lt;%= form_tag result_search_path do %&gt;\n    &lt;div class=\"input-group input-group-lg\"&gt;\n        &lt;%= search_field_tag :term,\"#{@term}\", class: 'form-control' %&gt;\n        &lt;span class=\"input-group-btn\"&gt;\n            &lt;%= submit_tag \"Search\", :class =&gt; 'btn btn-primary btn' %&gt;\n        &lt;/span&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "gem"], "answers": [{"tags": [], "owner": {"reputation": 5183, "user_id": 799618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/449b61e3b1906e8198b18b338259808c?s=128&d=identicon&r=PG", "display_name": "Ryan-Neal Mes", "link": "https://stackoverflow.com/users/799618/ryan-neal-mes"}, "is_accepted": false, "score": 4, "last_activity_date": 1433942552, "creation_date": 1433942552, "answer_id": 30757647, "question_id": 30757126, "link": "https://stackoverflow.com/questions/30757126/why-the-module-classmethods-defined-and-extended-in-the-same-namespace/30757647#30757647", "title": "Why the module `ClassMethods` defined and extended in the same namespace?", "body": "<p>Looking more at the <a href=\"https://github.com/peter-murach/github/blob/master/lib/github_api/api.rb\" rel=\"nofollow\">repo</a> there is another class <code>Github::API</code>. This class seems to require functionality of the <code>Github::ClassMethods</code> module. </p>\n\n<pre><code>module Github\n  # Core class responsible for api interface operations\n  class API\n    extend Github::ClassMethods\n</code></pre>\n\n<p>So it makes sense that it's own own module. It gives the ability to only import those methods. If the methods from <code>class &lt;&lt; self</code> were included, they would become available which is probably not wanted.</p>\n\n<p>It may have been better to have the module in it's own class or named something else. But I guess that is just personal choice.</p>\n"}, {"comments": [{"owner": {"reputation": 5183, "user_id": 799618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/449b61e3b1906e8198b18b338259808c?s=128&d=identicon&r=PG", "display_name": "Ryan-Neal Mes", "link": "https://stackoverflow.com/users/799618/ryan-neal-mes"}, "edited": false, "score": 1, "creation_date": 1433943463, "post_id": 30757763, "comment_id": 49569061, "body": "That makes sense. I am a little confused about the method <code>self.included(base)</code>, could you maybe explain what that is for and how it relates to module <code>M</code> or class <code>P</code>"}, {"owner": {"reputation": 25560, "user_id": 14253, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/235c58ad566abb4c7979bc7033e9882c?s=128&d=identicon&r=PG", "display_name": "DGM", "link": "https://stackoverflow.com/users/14253/dgm"}, "edited": false, "score": 5, "creation_date": 1433944113, "post_id": 30757763, "comment_id": 49569632, "body": "when <code>P</code>  calls <code>include M</code>, ruby automatically calls  <code>included</code> on <code>M</code> if it is defined.   It is a callback of the include method.   This is use to extend the module&#39;s class methods onto <code>P</code>.   See: <a href=\"http://ruby-doc.org/core-2.2.0/Module.html#method-i-included\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Module.html#method-i-included</a>"}, {"owner": {"reputation": 5183, "user_id": 799618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/449b61e3b1906e8198b18b338259808c?s=128&d=identicon&r=PG", "display_name": "Ryan-Neal Mes", "link": "https://stackoverflow.com/users/799618/ryan-neal-mes"}, "edited": false, "score": 1, "creation_date": 1434099241, "post_id": 30757763, "comment_id": 49646719, "body": "Is there any chance you could point me to a practical example of this? I am still not clear on the situations it would be used in. I am sure i just need to see a practical example to understand it&#39;s true application."}], "tags": [], "owner": {"reputation": 2785, "user_id": 2733119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4HDSo.jpg?s=128&g=1", "display_name": "art-solopov", "link": "https://stackoverflow.com/users/2733119/art-solopov"}, "is_accepted": true, "score": 19, "last_activity_date": 1433942784, "creation_date": 1433942784, "answer_id": 30757763, "question_id": 30757126, "link": "https://stackoverflow.com/questions/30757126/why-the-module-classmethods-defined-and-extended-in-the-same-namespace/30757763#30757763", "title": "Why the module `ClassMethods` defined and extended in the same namespace?", "body": "<pre><code>module MyModule\n  class &lt;&lt; self\n    def included(base)\n      base.extend ClassMethods # what would this be for?\n    end\n    &lt;...&gt;\n  end\n  &lt;...&gt;\nend\n</code></pre>\n\n<p>This is actually a pretty common practice in Ruby. Basically, what it's saying is: when some object performs <code>include MyModule</code>, make it also <code>extend MyModule::ClassMethods</code>. Such a feat is useful if you want a mixin that adds some methods not just to the instances of a class, but to the class itself.</p>\n\n<p>A short example:</p>\n\n<pre><code>module M\n  # A normal instance method\n  def mul\n    @x * @y\n  end\n\n  module ClassMethods\n    # A class method\n    def factory(x)\n      new(x, 2 * x)\n    end\n  end\n\n  def self.included(base)\n    base.extend ClassMethods\n  end\nend\n\nclass P\n  include M\n  def initialize(x, y)\n    @x = x\n    @y = y\n  end\n\n  def sum\n    @x + @y\n  end\nend\n\np1 = P.new(5, 15)\nputs \"#{p1.sum} #{p1.mul}\"\n\n# Calling the class method from the module here!\np2 = P.factory(10)\nputs \"#{p2.sum} #{p2.mul}\"\n</code></pre>\n"}], "owner": {"reputation": 5183, "user_id": 799618, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/449b61e3b1906e8198b18b338259808c?s=128&d=identicon&r=PG", "display_name": "Ryan-Neal Mes", "link": "https://stackoverflow.com/users/799618/ryan-neal-mes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7402, "favorite_count": 6, "accepted_answer_id": 30757763, "answer_count": 2, "score": 20, "last_activity_date": 1433951829, "creation_date": 1433941189, "last_edit_date": 1433951829, "question_id": 30757126, "link": "https://stackoverflow.com/questions/30757126/why-the-module-classmethods-defined-and-extended-in-the-same-namespace", "title": "Why the module `ClassMethods` defined and extended in the same namespace?", "body": "<p>I am trying to understand code from github <a href=\"https://github.com/peter-murach/github/blob/master/lib/github_api.rb#L15\" rel=\"noreferrer\">repo</a>. It's the main module of the gem to setup the client.</p>\n\n<pre><code>module Github\n  # more code\n  class &lt;&lt; self\n    def included(base)\n      base.extend ClassMethods # what would this be for?\n    end\n    def new(options = {}, &amp;block)\n      Client.new(options, &amp;block)\n    end\n    def method_missing(method_name, *args, &amp;block)\n      if new.respond_to?(method_name)\n        new.send(method_name, *args, &amp;block)\n      elsif configuration.respond_to?(method_name)\n        Github.configuration.send(method_name, *args, &amp;block)\n      else\n        super\n      end\n    end\n    def respond_to?(method_name, include_private = false)\n      new.respond_to?(method_name, include_private) ||\n      configuration.respond_to?(method_name) ||\n      super(method_name, include_private)\n    end\n  end\n\n  module ClassMethods\n    def require_all(prefix, *libs)\n      libs.each do |lib|\n        require \"#{File.join(prefix, lib)}\"\n      end\n    end\n    # more methods ...\n  end\n\n  extend ClassMethods\n  require_all LIBDIR,\n    'authorization',\n    'validations',\n    'normalizer',\n    'parameter_filter',\n    'api',\n    'client',\n    'pagination',\n    'request',\n    'response',\n    'response_wrapper',\n    'error',\n    'mime_type',\n    'page_links',\n    'paged_request',\n    'page_iterator',\n    'params_hash'\n\nend\n</code></pre>\n\n<ol>\n<li>Why is <code>class &lt;&lt; self</code> and <code>module ClassMethods</code> used, and then extended instead of being included in the <code>class &lt;&lt; self</code> part?</li>\n<li>There is a class method <code>def included(base)</code>. This seems to add the class methods into a specific object. Why is it like this? It could relate to the functionality of the class, but I do not understand it.</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "angularjs", "html"], "comments": [{"owner": {"reputation": 82, "user_id": 4403281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a77630a2855c3bf1b8a8478c562fdc13?s=128&d=identicon&r=PG&f=1", "display_name": "lugreen", "link": "https://stackoverflow.com/users/4403281/lugreen"}, "edited": false, "score": 2, "creation_date": 1433940972, "post_id": 30756893, "comment_id": 49567009, "body": "Try adding this CSS -webkit-perspective: 1000;   -webkit-font-smoothing: antialiased !important;"}, {"owner": {"reputation": 1781, "user_id": 2652371, "user_type": "registered", "profile_image": "https://graph.facebook.com/660356706/picture?type=large", "display_name": "PiniH", "link": "https://stackoverflow.com/users/2652371/pinih"}, "reply_to_user": {"reputation": 82, "user_id": 4403281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a77630a2855c3bf1b8a8478c562fdc13?s=128&d=identicon&r=PG&f=1", "display_name": "lugreen", "link": "https://stackoverflow.com/users/4403281/lugreen"}, "edited": false, "score": 0, "creation_date": 1433941074, "post_id": 30756893, "comment_id": 49567092, "body": "Is it per element that appears deformed or for the whole page? because it&#39;s not the only element."}, {"owner": {"reputation": 82, "user_id": 4403281, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a77630a2855c3bf1b8a8478c562fdc13?s=128&d=identicon&r=PG&f=1", "display_name": "lugreen", "link": "https://stackoverflow.com/users/4403281/lugreen"}, "edited": false, "score": 0, "creation_date": 1433941277, "post_id": 30756893, "comment_id": 49567283, "body": "Try adding it to the elements, it may not work anyway. I&#39;m not to sure."}], "owner": {"reputation": 1781, "user_id": 2652371, "user_type": "registered", "profile_image": "https://graph.facebook.com/660356706/picture?type=large", "display_name": "PiniH", "link": "https://stackoverflow.com/users/2652371/pinih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1433940648, "creation_date": 1433940648, "question_id": 30756893, "link": "https://stackoverflow.com/questions/30756893/deformed-text-in-chrome", "title": "Deformed text in chrome", "body": "<p>We have a very weird behavior in our application, sorry I can't give examples but it's closed.</p>\n\n<p>We see some extremely deformed texts, for example: <img src=\"https://i.stack.imgur.com/irpyN.png\" alt=\"enter image description here\"></p>\n\n<p>Which SHOULD have been Edit Columns, but you can see what happens, when clicking inspect element, it shows everything is fine, and sometimes it fixes it self. </p>\n\n<p>Few notes:</p>\n\n<p>We are running a little bit old Ruby on Rails (1.9.3 Ruby, 3.2.17 Rails). \nThe script is rendered by Angular but it sometimes happen in plain hamls as well (But more rarely).</p>\n\n<p>It doesn't happen all the time.</p>\n\n<p>It's possible it only happens on Chrome (since it's not persistent it's hard to make sure it really didn't happen).</p>\n\n<p>Any ideas or suggestions or event hints will be extremely valuable, I am at a complete loss here.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user592638"}, "edited": false, "score": 0, "creation_date": 1433937152, "post_id": 30755534, "comment_id": 49564240, "body": "The pluck function is awesome!"}, {"owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "edited": false, "score": 0, "creation_date": 1433937630, "post_id": 30755534, "comment_id": 49564588, "body": "Glad it helped, please accept the answer if it really helped you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user592638"}, "edited": false, "score": 0, "creation_date": 1433937692, "post_id": 30755534, "comment_id": 49564620, "body": "and if you do use yalm like this: &quot;y Order.where(campaign_id: 46).pluck(:email)&quot; you get a nice format output. Do you know how do number every output when using yalm?"}], "tags": [], "owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1433937165, "last_edit_date": 1433937165, "creation_date": 1433937116, "answer_id": 30755534, "question_id": 30755429, "link": "https://stackoverflow.com/questions/30755429/rails-3-join-where-query-print-only-on-row/30755534#30755534", "title": "Rails 3 join where query - print only on row", "body": "<p>Try this</p>\n\n<pre><code>Order.where(campaign_id: 46).pluck(:email)\n</code></pre>\n\n<p>This will return an array of emails of orders with specific email</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 3459, "user_id": 3185510, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nlb4D.jpg?s=128&g=1", "display_name": "webster", "link": "https://stackoverflow.com/users/3185510/webster"}, "is_accepted": false, "score": 0, "last_activity_date": 1433939149, "creation_date": 1433939149, "answer_id": 30756319, "question_id": 30755429, "link": "https://stackoverflow.com/questions/30755429/rails-3-join-where-query-print-only-on-row/30756319#30756319", "title": "Rails 3 join where query - print only on row", "body": "<p>You can use <code>collect</code> also:</p>\n\n<pre><code>Order.where(campaign_id: 46).collect(&amp;:email)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user592638"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 30755534, "answer_count": 2, "score": 0, "last_activity_date": 1433942170, "creation_date": 1433936887, "last_edit_date": 1433942170, "question_id": 30755429, "link": "https://stackoverflow.com/questions/30755429/rails-3-join-where-query-print-only-on-row", "title": "Rails 3 join where query - print only on row", "body": "<p>I have two models, <strong>Campaigns</strong> and <strong>Orders</strong></p>\n\n<p>I would like to find a specific campaign with it orders and print all emails.</p>\n\n<p>I tried this in the console but get all the orders data when I only want the row :email</p>\n\n<pre><code>Campaign.find_by_id(46).orders(:email)\n</code></pre>\n\n<p>How to print only the emails of those orders? </p>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1433936993, "post_id": 30755383, "comment_id": 49564121, "body": "Why not use <code>list.sort</code>?"}, {"owner": {"reputation": 5770, "user_id": 2980246, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/hpOec.png?s=128&g=1", "display_name": "jayelm", "link": "https://stackoverflow.com/users/2980246/jayelm"}, "reply_to_user": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1433937383, "post_id": 30755383, "comment_id": 49564420, "body": "@floum presumably for practice reasons."}, {"owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "reply_to_user": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 0, "creation_date": 1433937523, "post_id": 30755383, "comment_id": 49564525, "body": "@floum @Jesse Mu is right, I know how to use <code>sort</code> method, just want to practice algorithm."}], "answers": [{"tags": [], "owner": {"reputation": 2314, "user_id": 2882921, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ffb2397ff2a97e133bdaa6cb2b449b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Kruczek", "link": "https://stackoverflow.com/users/2882921/piotr-kruczek"}, "is_accepted": false, "score": 1, "last_activity_date": 1433938544, "creation_date": 1433938544, "answer_id": 30756097, "question_id": 30755383, "link": "https://stackoverflow.com/questions/30755383/implement-shell-sort-by-ruby/30756097#30756097", "title": "implement shell sort by ruby", "body": "<p>I think your algorithm needs a little tweaking. </p>\n\n<p>The reason it fails is simply because on the last run (when <code>d == 1</code>) the smallest element (<code>1</code>) isn't near enough the first element to swap it in in one go.</p>\n\n<p>The easiest way to make it work is to \"restart\" your inner loop whenever elements switch places. So, a little bit rough solution would be something like</p>\n\n<pre><code>(0...(list.length-d)).each do |j|\n  if list[j] &gt;= list[j+d]\n    list[j], list[j+d] = list[j+d], list[j]\n    d *= 2\n    break\n  end\nend\n</code></pre>\n\n<p>This solution is of course far from optimal, but should achieve required results with as little code as possible.</p>\n"}, {"tags": [], "owner": {"reputation": 4557, "user_id": 1847280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4124a0c3fbe08db2e0021e3e09b76e7f?s=128&d=identicon&r=PG", "display_name": "Yevgeniy Anfilofyev", "link": "https://stackoverflow.com/users/1847280/yevgeniy-anfilofyev"}, "is_accepted": false, "score": 0, "last_activity_date": 1433947250, "creation_date": 1433947250, "answer_id": 30759641, "question_id": 30755383, "link": "https://stackoverflow.com/questions/30755383/implement-shell-sort-by-ruby/30759641#30759641", "title": "implement shell sort by ruby", "body": "<p>You should just do a last run on array. To simplify your code I extracted exchange part into standalone fucntion so you could see now where you should do this:</p>\n\n<pre><code>def exchange e, list\n  (0...(list.length-e)).each do |j|\n    if list[j] &gt;= list[j+e]\n      list[j], list[j+e] = list[j+e], list[j]\n    end\n  end\nend\n\ndef shell_sort(list)\n  d = list.length\n  return -1 if d == 0\n  (0...list.length).each do |i|\n    d = d / 2\n    puts \"d:#{d}\"\n    exchange(d, list)\n    puts list.inspect\n    if d == 1\n      exchange(d, list)\n      break\n    end\n  end\n  list\nend\n\narr = [10,9,8,7,6,5,4,3,2,1]\np shell_sort(arr)\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>#&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1739, "user_id": 2863439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c95bb944bbbe597543ae8a88987995?s=128&d=identicon&r=PG&f=1", "display_name": "limekin", "link": "https://stackoverflow.com/users/2863439/limekin"}, "is_accepted": true, "score": 1, "last_activity_date": 1433951115, "last_edit_date": 1433951115, "creation_date": 1433950235, "answer_id": 30760835, "question_id": 30755383, "link": "https://stackoverflow.com/questions/30755383/implement-shell-sort-by-ruby/30760835#30760835", "title": "implement shell sort by ruby", "body": "<p>I referenced Shell Sort in here : <a href=\"http://en.wikipedia.org/wiki/Shellsort\" rel=\"nofollow\">Shell Sort - Wikepedia</a>, and from that I have understood your algorithm is wrong. Iteration of gap sequence is alright, I mean you iterate only upto <code>d/2 == 1</code>.</p>\n\n<p>But for a gap, let's say 2, you simply iterate from <code>0</code> to <code>list.length-2</code> and swap every <code>j</code> and <code>j+2</code> elements if <code>list[j]</code> is greater than <code>list[j+2]</code>. That isn't even a proper insertion sort, and Shell Sort requires Insertion sorts on gaps. Also Shell Sort requires that after you do an x gap sort, every xth element, starting from anywhere will be sorted (see the example run on the link and you can verify yourself).</p>\n\n<p>A case where it can wrong in a 2 gap sort pass :</p>\n\n<pre><code>list = 5,4,3,2,1\nj = 0 passed :\nlist = 3,4,5,2,1\nj = 1 passed : \nlist = 3,2,5,4,1\nj = 2 passed\nlist = 3,2,1,4,5\n</code></pre>\n\n<p>After it completes, you can see that every 2nd element starting from 0 isn't in a sorted order. I suggest that you learn Insertion Sort first, then understand where and how it is used in Shell Sort, and try again, if you want to do it by yourself.</p>\n\n<p>Anyway, I have written one (save it for later if you want) taking your method as a base, with a lot of comments. Hope you get the idea through this. Also tried to make the outputs clarify the how the algorithm works.</p>\n\n<pre><code>def shell_sort(list)\n  d = list.length\n  return -1 if d == 0\n\n  # You select and iterate over your gap sequence here.\n  until d/2 == 0 do\n    d = d / 2\n\n    # Now you pick up an index i, and make sure every dth element,\n    # starting from i is sorted.\n    # i = 0\n    # while i &lt; list.length do\n    0.step(list.length) do |i|\n\n      # Okay we picked up index i. Now it's just plain insertion sort.\n      # Only difference is that we take elements with constant gap, \n      # rather than taking them up serially.\n      # igap = i + d\n      # while igap &lt; list.length do\n      (i+d).step(list.length-1, d) do |igap| \n\n         # Just like insertion sort, we take up the last most value.\n         # So that we can shift values greater than list[igap] to its side,\n         # and assign it to a proper position we find for it later.\n         temp = list[igap]\n         j = igap\n         while j &gt;= i do\n           break if list[j] &gt;= list[j - d]\n           list[j] = list[j-d]\n           j -= d\n        end\n        # Okay this is where it belongs.\n        list[j] = temp\n\n        #igap += d\n      end\n\n      # i += 1\n    end\n    puts \"#{d} sort done, the list now : \"\n    puts list.inspect\n   end\n   list\nend\n\nlist = [10,9,8,7,6,5,4,3,2,1]\nputs \"List before sort : \"\nputs list.inspect\nshell_sort(list)\nputs \"Sorted list : \"\nputs list.inspect\n</code></pre>\n"}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 30760835, "answer_count": 3, "score": 0, "last_activity_date": 1433951115, "creation_date": 1433936770, "last_edit_date": 1433937688, "question_id": 30755383, "link": "https://stackoverflow.com/questions/30755383/implement-shell-sort-by-ruby", "title": "implement shell sort by ruby", "body": "<p>I try to implement shell sort by ruby.</p>\n\n<pre><code>def shell_sort(list)\n  d = list.length\n  return -1 if d == 0\n  (0...list.length).each do |i|\n    d = d / 2\n    puts \"d:#{d}\"\n    (0...(list.length-d)).each do |j|\n      if list[j] &gt;= list[j+d]\n         list[j], list[j+d] = list[j+d], list[j]\n      end\n    end\n    puts list.inspect\n    break if d == 1\n  end\n  list\nend\n\nputs shell_sort([10,9,8,7,6,5,4,3,2,1]).inspect\n</code></pre>\n\n<p>but the result is incorrect.</p>\n\n<pre><code>=&gt;[2, 1, 3, 4, 5, 7, 6, 8, 9, 10]\n</code></pre>\n\n<p>I don't know where going wrong, hope someone can help me. Thanks in advance!</p>\n"}, {"tags": ["ruby", "sinatra", "daemon"], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 916462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f7d929f676f6bfb3be7f8a140ad5c4?s=128&d=identicon&r=PG", "display_name": "Steeve McCauley", "link": "https://stackoverflow.com/users/916462/steeve-mccauley"}, "edited": false, "score": 2, "creation_date": 1457361023, "post_id": 30755440, "comment_id": 59357851, "body": "This is not a daemon, it&#39;s just a process running in the background with its standard output/error going to the console.  And once the shell is closed the sessions will receive a HUP signal and close the ruby process.  At the very least one should do something like &quot;nohup ruby server.rb &gt; /var/tmp/server.out 2&gt;&amp;1 &amp;&quot; to prevent the process from closing on the hangup signal."}], "tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 3, "last_activity_date": 1457361486, "last_edit_date": 1457361486, "creation_date": 1433936899, "answer_id": 30755440, "question_id": 30754900, "link": "https://stackoverflow.com/questions/30754900/sinatra-start-as-daemon-programmatically/30755440#30755440", "title": "sinatra start as daemon programmatically", "body": "<p>You can daemonize any ruby process from within your code by using <a href=\"http://ruby-doc.org/core-2.2.2/Process.html#method-c-daemon\" rel=\"nofollow\">Process#daemon</a></p>\n"}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1696, "favorite_count": 0, "accepted_answer_id": 30755440, "answer_count": 1, "score": 1, "last_activity_date": 1457361486, "creation_date": 1433935566, "last_edit_date": 1433944647, "question_id": 30754900, "link": "https://stackoverflow.com/questions/30754900/sinatra-start-as-daemon-programmatically", "title": "sinatra start as daemon programmatically", "body": "<p>Right now, after having loaded everything my executable runs my app like this:</p>\n\n<pre><code>Rack::Handler::pick(['puma']).run VCK::App\n</code></pre>\n\n<p>and it works, but it blocks the terminal (which is ok for development)</p>\n\n<p>How do I get this to start as a daemon programmatically from within my executable?</p>\n\n<p>EDIT:</p>\n\n<p>Code I use to start sinatra as a daemon:</p>\n\n<pre><code>    if options[:daemonize]\n        pid = fork {Rack::Handler::pick(['puma']).run VCK::App}\n        File.open(pid_file_loc, 'w') {|f| f.write(pid)}\n        Process.detach(pid)\n    else\n        Rack::Handler::pick(['puma']).run VCK::App\n    end\n</code></pre>\n\n<p>Code I use to stop Sinatra Daemon:</p>\n\n<pre><code>Process.kill(15, File.read(pid_file_loc).to_i)\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 3092, "user_id": 3535931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/isOaa.jpg?s=128&g=1", "display_name": "p4sh4", "link": "https://stackoverflow.com/users/3535931/p4sh4"}, "edited": false, "score": 0, "creation_date": 1433935000, "post_id": 30754627, "comment_id": 49562768, "body": "Perhaps you meant <code>before_save { self.email.downcase! }</code>?"}, {"owner": {"reputation": 930, "user_id": 4821694, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fhrxp56k1ZQ/AAAAAAAAAAI/AAAAAAAAAsY/GY0GrUdSKCI/photo.jpg?sz=128", "display_name": "\u0424\u0435\u0434\u043e\u0440 \u0423\u0441\u0430\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/4821694/%d0%a4%d0%b5%d0%b4%d0%be%d1%80-%d0%a3%d1%81%d0%b0%d0%ba%d0%be%d0%b2"}, "reply_to_user": {"reputation": 3092, "user_id": 3535931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/isOaa.jpg?s=128&g=1", "display_name": "p4sh4", "link": "https://stackoverflow.com/users/3535931/p4sh4"}, "edited": false, "score": 0, "creation_date": 1433938440, "post_id": 30754627, "comment_id": 49565121, "body": "Sure! Thanks a lot! I&#39;m an truly an idiot :("}], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4821694, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fhrxp56k1ZQ/AAAAAAAAAAI/AAAAAAAAAsY/GY0GrUdSKCI/photo.jpg?sz=128", "display_name": "\u0424\u0435\u0434\u043e\u0440 \u0423\u0441\u0430\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/4821694/%d0%a4%d0%b5%d0%b4%d0%be%d1%80-%d0%a3%d1%81%d0%b0%d0%ba%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1433938412, "post_id": 30754749, "comment_id": 49565104, "body": "God bless your sharp eyes! I looked at this code for hundred times, but haven&#39;t seen this obvious issue!!! Have to stop drinking vodka for breakfast :("}], "tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1433935134, "creation_date": 1433935134, "answer_id": 30754749, "question_id": 30754627, "link": "https://stackoverflow.com/questions/30754627/ruby-on-rails-cant-create-a-record-in-database/30754749#30754749", "title": "Ruby on Rails. Can&#39;t create a record in database", "body": "<p><code>!self.email.downcase</code> will return <code>true</code> or <code>false</code></p>\n\n<p>use <code>self.email.downcase!</code> to change the email into smallcase.</p>\n"}], "owner": {"reputation": 930, "user_id": 4821694, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-fhrxp56k1ZQ/AAAAAAAAAAI/AAAAAAAAAsY/GY0GrUdSKCI/photo.jpg?sz=128", "display_name": "\u0424\u0435\u0434\u043e\u0440 \u0423\u0441\u0430\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/4821694/%d0%a4%d0%b5%d0%b4%d0%be%d1%80-%d0%a3%d1%81%d0%b0%d0%ba%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 30754749, "answer_count": 1, "score": 0, "last_activity_date": 1433935134, "creation_date": 1433934821, "question_id": 30754627, "link": "https://stackoverflow.com/questions/30754627/ruby-on-rails-cant-create-a-record-in-database", "title": "Ruby on Rails. Can&#39;t create a record in database", "body": "<p>Having a problem while creating a new record in database.<br>\nModel currently looks like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n      VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-]+(\\.[a-z\\d\\-]+)*\\.[a-z]+\\z/i\n\n      before_save {!self.email.downcase}\n\n      validates :name, presence: true, length: {maximum: 50}\n      validates :email, presence: true, length: {maximum: 255}, format: {with: VALID_EMAIL_REGEX}, uniqueness: {case_sensitive: false}\n\n      has_secure_password\n      validates :password, presence: true, length: {minimum: 6}\nend\n</code></pre>\n\n<p>Initially tried to create a record from the code, but failed without any errors.\nAs a next step I tried to create a record manually in console, but still with the same result. No errors available. Skipping validations, reseting database, restarting server or excluding email REGEXP (always a source of troubles for me) from validations doesn't help...</p>\n\n<pre><code>user = User.new(name: \"Fedor U\", email: \"fredy@mail.ru\", password: \"asdzxc123\", password_confirmation: \"asdzxc123\")\n=&gt; #&lt;User id: nil, name: \"Fedor U\", email: \"fredy@mail.ru\", created_at: nil, updated_at: nil, password_digest: \"$2a$10$89SABxu2lOo3gj6DiqLZEOlSheAfEk0ex.5GYmJ5e8i...\"&gt;\n\n&gt;&gt; user.save\n(0.2ms)  begin transaction\nUser Exists (0.2ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"email\") = LOWER('fredy@mail.ru') LIMIT 1\n(0.1ms)  rollback transaction\n=&gt; false\n&gt;&gt; user.errors.any?\n=&gt; false\nuser.errors.full_messages\n=&gt; []\n\n&gt;&gt; user.save(validation: false)\n(0.1ms)  begin transaction\nUser Exists (0.2ms)  SELECT  1 AS one FROM \"users\" WHERE LOWER(\"users\".\"email\") = LOWER('fredy@mail.ru') LIMIT 1\n(0.1ms)  rollback transaction\n=&gt; false\n</code></pre>\n\n<p>Any ideas what am I doing wrong? Rails 4.2.0, bcrypt 3.1.7. <br>Database is empty at the moment. </p>\n"}, {"tags": ["ruby", "watir-webdriver", "centos6", "headless", "xvfb"], "answers": [{"tags": [], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "is_accepted": true, "score": 3, "last_activity_date": 1437494940, "last_edit_date": 1437494940, "creation_date": 1435064735, "answer_id": 31003621, "question_id": 30754358, "link": "https://stackoverflow.com/questions/30754358/ruby-headless-watir-webdriver-xvfb-zombies/31003621#31003621", "title": "Ruby headless watir-webdriver Xvfb zombies", "body": "<p><strong>UPDATE:</strong> A <a href=\"https://github.com/leonid-shevtsov/headless/pull/59\" rel=\"nofollow\">pull request</a> submitted to Headless to wait by default was accepted. Woo!</p>\n\n<hr>\n\n<p>The gem headless <a href=\"https://github.com/leonid-shevtsov/headless/commit/2886098dbf9a6ac63045a4a1fb8de40f03d5b67f\" rel=\"nofollow\">changed the way it starts, stops (kills) and verifies the Xvfb process</a>. Though I'm not entirely sure why, but on CentOS 6 this causes the process to zombify. Since the <code>.destroy</code> wasn't causing issues previously, it must be related to the way headless starts the Xvfb process (which was re-written simultaneously). </p>\n\n<p>However, the gem simultaneously introduced <code>.destroy_sync</code>, which waits for the process to die, and does not create zombies. </p>\n\n\n\n<pre><code>require 'headless'\nrequire 'watir-webdriver'\nrequire 'yaml'\n\nzombies_at_start = `ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'`.split(\"\\n\").count\n\n5.times do\n  begin\n    d = YAML.load_file(\"/path/to/config/headless.yml\")['build_number'] #=&gt; \"98\"\n    h = Headless.new(:display =&gt; d) \n    h.start\n    b = Watir::Browser.new :firefox\n    b.goto 'http://google.com'\n    sleep(0.5)\n  ensure\n    b.close\n    # h.destroy\n    h.destroy_sync\n  end\n  sleep(0.5)\nend\n\nzombies_at_end = `ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'`.split(\"\\n\").count\n\nputs \"Created #{zombies_at_end - zombies_at_start} more zombies.\" \n#=&gt; Created 0 more zombies.\n</code></pre>\n"}], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 1, "accepted_answer_id": 31003621, "answer_count": 1, "score": 1, "last_activity_date": 1437494940, "creation_date": 1433934029, "last_edit_date": 1434114257, "question_id": 30754358, "link": "https://stackoverflow.com/questions/30754358/ruby-headless-watir-webdriver-xvfb-zombies", "title": "Ruby headless watir-webdriver Xvfb zombies", "body": "<p>I have two apps running on a single server that perform headless browsing tasks. Each time one browses, the Xvfb process is not dying and instead becomes a zombie. I can confirm this with the following script.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'headless'\nrequire 'watir-webdriver'\nrequire 'yaml'\n\nzombies_at_start = `ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'`.split(\"\\n\").count\n\n5.times do\n  begin\n    d = YAML.load_file(\"/path/to/config/headless.yml\")['build_number'] #=&gt; \"98\"\n    h = Headless.new(:display =&gt; d) \n    h.start\n    b = Watir::Browser.new :firefox\n    b.goto 'http://google.com'\n    sleep(0.5)\n  ensure\n    b.close\n    h.destroy\n  end\n  sleep(0.5)\nend\n\nzombies_at_end = `ps axo pid=,stat= | awk '$2~/^Z/ { print $1 }'`.split(\"\\n\").count\n\nputs \"Created #{zombies_at_end - zombies_at_start} more zombies.\" \n#=&gt; Created 5 more zombies.\n</code></pre>\n\n<p>Why? How can I fix this?</p>\n\n<hr>\n\n<p>Version info:</p>\n\n<ul>\n<li>xorg-x11-server-Xvfb-1.15.0-26.el6.centos.i686</li>\n<li>CentOS release 6.5 (Final)</li>\n<li>ruby-2.0.0-p353</li>\n<li>rvm 1.25.25</li>\n<li>selenium-webdriver (2.45.0, 2.44.0)</li>\n<li>watir-webdriver (0.7.0)</li>\n<li>headless (2.1.0)</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "collections", "routes", "member"], "answers": [{"tags": [], "owner": {"reputation": 2982, "user_id": 3176055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c976138fc7bd60baa57b22e334816a44?s=128&d=identicon&r=PG&f=1", "display_name": "jon snow", "link": "https://stackoverflow.com/users/3176055/jon-snow"}, "is_accepted": true, "score": 1, "last_activity_date": 1433934362, "last_edit_date": 1433934362, "creation_date": 1433933897, "answer_id": 30754315, "question_id": 30754267, "link": "https://stackoverflow.com/questions/30754267/rails-combine-member-collection-in-routes-rb/30754315#30754315", "title": "Rails combine member &amp; collection in routes.rb", "body": "<p>Combine <code>member</code> and <code>collection</code> in <code>resources</code> block. Like this,</p>\n\n<pre><code>resources :conversations, only: [:index, :show, :destroy] do\n  member do\n    post :reply\n    post :restore\n  end\n  collection do\n    delete :empty_trash\n  end\nend\n</code></pre>\n\n<p>Or you may combine it like this also,</p>\n\n<pre><code>resources :conversations, only: [:index, :show, :destroy] do\n  post :reply, on: :member\n  post :restore, on: :member\n  delete :empty_trash, on: :collection\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1433934225, "creation_date": 1433934225, "answer_id": 30754419, "question_id": 30754267, "link": "https://stackoverflow.com/questions/30754267/rails-combine-member-collection-in-routes-rb/30754419#30754419", "title": "Rails combine member &amp; collection in routes.rb", "body": "<p>try this</p>\n\n<pre><code>resources :conversations, only: [:index, :show, :destroy] do\n  member { \n    post :reply\n    post :restore \n  }       \n  collection {\n     delete :empty_trash\n  }   \nend\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 4608099, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9b888c60b26a4812e6a53fa9980a17f5?s=128&d=identicon&r=PG&f=1", "display_name": "Shalafister", "link": "https://stackoverflow.com/users/4608099/shalafister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 30754315, "answer_count": 2, "score": 0, "last_activity_date": 1433936816, "creation_date": 1433933764, "last_edit_date": 1433936816, "question_id": 30754267, "link": "https://stackoverflow.com/questions/30754267/rails-combine-member-collection-in-routes-rb", "title": "Rails combine member &amp; collection in routes.rb", "body": "<p>I am trying to combine collection and member in the conversations path. But I could not figure it out,</p>\n\n<pre><code>resources :conversations, only: [:index, :show, :destroy] do\n\n  member do\n    post :reply\n    post :restore\n  end\nend\n</code></pre>\n\n<p>and;</p>\n\n<pre><code>resources :conversations, only: [:index, :show, :destroy] do\n  collection do\n    delete :empty_trash\n  end\nend\n</code></pre>\n\n<p>When I combine them it does not work, and obviously this one is wrong too!. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "haml"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4892751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78fffce872cea0b8c8c2cd2273d39826?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/4892751/pingu"}, "is_accepted": true, "score": 1, "last_activity_date": 1433934834, "creation_date": 1433934834, "answer_id": 30754636, "question_id": 30753968, "link": "https://stackoverflow.com/questions/30753968/cant-convert-html-erbs-to-haml-with-the-erb2haml-gem-on-windows/30754636#30754636", "title": "Can&#39;t convert html.erb&#39;s to haml with the &quot;erb2haml&quot; gem on Windows", "body": "<p>I found a really easy and good way. First install the \"haml-rails\" gem if you haven't already, then just insert </p>\n\n<pre><code>rake haml:erb2haml\n</code></pre>\n\n<p>in the Console. It converts all .erb views into .haml .\nWorks very fast and flawless.</p>\n\n<p>~ Cheers</p>\n"}], "owner": {"reputation": 11, "user_id": 4892751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78fffce872cea0b8c8c2cd2273d39826?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/4892751/pingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 30754636, "answer_count": 1, "score": 0, "last_activity_date": 1433934875, "creation_date": 1433932814, "last_edit_date": 1592644375, "question_id": 30753968, "link": "https://stackoverflow.com/questions/30753968/cant-convert-html-erbs-to-haml-with-the-erb2haml-gem-on-windows", "title": "Can&#39;t convert html.erb&#39;s to haml with the &quot;erb2haml&quot; gem on Windows", "body": "<h1>Solved. Look at my answer below.</h1>\n<p>My Problem: I just can't convert all my html.erb's to haml. I tried the erb2haml gem with the &quot;rake haml:replace_erbs&quot; command but it doesn't work. Here is the full error:\n\u00a0\n\u00a0\n\u00a0</p>\n<pre><code>C:\\xampp\\htdocs\\Ruby&gt;rake haml:replace_erbs --trace\n** Invoke haml:replace_erbs (first_time)\n** Execute haml:replace_erbs\nrake aborted!\nErrno::ENOENT: No such file or directory - which html2haml\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/erb2haml-0.1.5/lib/erb2haml/railties/erb2haml.rake:46:in ``'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/erb2haml-0.1.5/lib/erb2haml/railties/erb2haml.rake:46:in `block (2 levels) i\nn &lt;top (required)&gt;'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:240:in `call'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:240:in `block in execute'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:235:in `each'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:235:in `execute'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:179:in `block in invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:172:in `invoke_with_call_chain'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/task.rb:165:in `invoke'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:150:in `invoke_task'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:106:in `block (2 levels) in top_level'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:106:in `each'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:106:in `block in top_level'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:115:in `run_with_threads'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:100:in `top_level'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:78:in `block in run'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:176:in `standard_exception_handling'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/lib/rake/application.rb:75:in `run'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-10.4.2/bin/rake:33:in `&lt;top (required)&gt;'\nC:/Ruby193/bin/rake:23:in `load'\nC:/Ruby193/bin/rake:23:in `&lt;main&gt;'\nTasks: TOP =&gt; haml:replace_erbs\n</code></pre>\n<p>It seems that the gem tries to use the &quot;which&quot; command on my Windows machine, what wouldn't make sense because it doesn't exist on Windows. Is there maybe a way to replace the linux/mac &quot;which&quot; command with the Windows &quot;where&quot; command ? If not, is there a other way to replace all html.erbs to haml's at once ?</p>\n<p>I hope you can help me. Thanks.</p>\n<p><em>- Moe</em></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 17201, "user_id": 788770, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cf81cd99ac72c57c62d7c0c329e16518?s=128&d=identicon&r=PG", "display_name": "Pierre-Louis Gottfrois", "link": "https://stackoverflow.com/users/788770/pierre-louis-gottfrois"}, "edited": false, "score": 0, "creation_date": 1433932044, "post_id": 30753534, "comment_id": 49561049, "body": "You should probably think about how you store your data before thinking about how you can make the code look better."}, {"owner": {"reputation": 2314, "user_id": 2882921, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ffb2397ff2a97e133bdaa6cb2b449b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Kruczek", "link": "https://stackoverflow.com/users/2882921/piotr-kruczek"}, "edited": false, "score": 1, "creation_date": 1433932087, "post_id": 30753534, "comment_id": 49561070, "body": "Are you sure populating an array with 20 exactly the same elements is wise? For the multiple variables use a collection, like a <code>Hash</code>."}, {"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 2, "creation_date": 1433932113, "post_id": 30753534, "comment_id": 49561089, "body": "Digits in variable names are already a sign of something odd going on. Most of the time."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 2, "creation_date": 1433932584, "post_id": 30753534, "comment_id": 49561373, "body": "If i was you i would take a step back and describe the problem you are trying to solve, rather than saying &quot;here&#39;s a load of code which doesn&#39;t really make sense, how do i improve it?&quot;.  We don&#39;t know what you want to achieve."}, {"owner": {"reputation": 129, "user_id": 4944830, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c7d7f2db1547d4b79429f6709f21b8bb?s=128&d=identicon&r=PG&f=1", "display_name": "kaka", "link": "https://stackoverflow.com/users/4944830/kaka"}, "edited": false, "score": 0, "creation_date": 1433934719, "post_id": 30753534, "comment_id": 49562608, "body": "I do not know why I got down voted."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 4944830, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c7d7f2db1547d4b79429f6709f21b8bb?s=128&d=identicon&r=PG&f=1", "display_name": "kaka", "link": "https://stackoverflow.com/users/4944830/kaka"}, "edited": false, "score": 0, "creation_date": 1433934625, "post_id": 30754044, "comment_id": 49562563, "body": "Great, I never thought about hashes."}], "tags": [], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1433933061, "creation_date": 1433933061, "answer_id": 30754044, "question_id": 30753534, "link": "https://stackoverflow.com/questions/30753534/better-way-to-write-this-code-in-ruby-on-rails-4/30754044#30754044", "title": "Better way to write this code in Ruby on Rails 4", "body": "<p>I think you would be better holding the data like so:</p>\n\n<pre><code>strombezugsvermeidung_kWh_a_eco = {\n  4 =&gt; {\n    1 =&gt; &lt;val a&gt;,\n    2 =&gt; &lt;val b&gt;,\n    etc\n  6 =&gt; {\n    1 =&gt; &lt;val c&gt;,\n    2 =&gt; &lt;val d&gt;,\n    etc\n  },\n  etc\n}\n</code></pre>\n\n<p>Then, your code will have things like</p>\n\n<pre><code>strombezugsvermeidung_kWh_a_eco[8][3]\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>strombezugsvermeidung_kWh_a_eco8[3]\n</code></pre>\n\n<p>This way you have a single variable holding the data, instead of loads of variables with numbers in their names, which is usually a bad idea.</p>\n\n<p>you can do this like so:</p>\n\n<pre><code>autarkie_eco = {4 =&gt; &lt;val a&gt;, 6 =&gt; &lt;val b&gt;, 8 =&gt; &lt;val c&gt;, etc - set this in your code however}\n\nstrombezugsvermeidung_kWh_a_eco = {}\neco_values = [4,6,8,10,12,14,16]\neco_values.each do |eco_value|\n  for i in 0..19\n    strombezugsvermeidung_kWh_a_eco[eco_value] ||= {}\n    strombezugsvermeidung_kWh_a_eco[eco_value][i] = autarkie_eco[eco_value]/100 * jahrstromverbrauch\n  end\nend\n</code></pre>\n\n<p>I don't know your codebase, just guessing, but you might want to further move data from out of variable names and into the variable value by having something like </p>\n\n<pre><code>strombezugsvermeidung[:kWh][:a][:eco][8][3] =&gt; val\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 4944830, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c7d7f2db1547d4b79429f6709f21b8bb?s=128&d=identicon&r=PG&f=1", "display_name": "kaka", "link": "https://stackoverflow.com/users/4944830/kaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 30754044, "answer_count": 1, "score": -3, "last_activity_date": 1434981841, "creation_date": 1433931654, "last_edit_date": 1434981841, "question_id": 30753534, "link": "https://stackoverflow.com/questions/30753534/better-way-to-write-this-code-in-ruby-on-rails-4", "title": "Better way to write this code in Ruby on Rails 4", "body": "<p>I am new to Ruby and I am working on a project and at the same time learning.\nI have written code in the past using Matlab and C.</p>\n\n<p>For this project in Ruby I am saving variables in arrays, which is common for me but somehow I think this is not a good idea using Ruby.</p>\n\n<p>That's why I require from your help.</p>\n\n<p>Do you have a better idea how to write the following for loop? I don' want to repeat code (I want to use DRY principle) and I think there should be a better way to shorten the code.</p>\n\n<pre><code>strombezugsvermeidung_kWh_a_eco4 = Array.new()\nstrombezugsvermeidung_kWh_a_eco6 = Array.new()\nstrombezugsvermeidung_kWh_a_eco8 = Array.new()\nstrombezugsvermeidung_kWh_a_eco10 = Array.new()\nstrombezugsvermeidung_kWh_a_eco12 = Array.new()\nstrombezugsvermeidung_kWh_a_eco14 = Array.new()\nstrombezugsvermeidung_kWh_a_eco16 = Array.new()\n\n\nfor i in 0..19\n    strombezugsvermeidung_kWh_a_eco4[i] = (autarkie_eco4 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco6[i] = (autarkie_eco6 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco8[i] = (autarkie_eco8 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco10[i] = (autarkie_eco10 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco12[i] = (autarkie_eco12 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco14[i] = (autarkie_eco14 / 100) * jahrstromverbrauch\n    strombezugsvermeidung_kWh_a_eco16[i] = (autarkie_eco16 / 100) * jahrstromverbrauch\nend\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 16234, "user_id": 2202702, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lTGWe.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/2202702/arslan-ali"}, "is_accepted": false, "score": 2, "last_activity_date": 1433929894, "creation_date": 1433929894, "answer_id": 30752911, "question_id": 30752852, "link": "https://stackoverflow.com/questions/30752852/activerecordstatementinvalid-in-controllermethod/30752911#30752911", "title": "ActiveRecord::StatementInvalid in controller#method", "body": "<p>You can not name your column <code>in</code>. Because this is reserved keyword in SQLite, and it will generate errors as it is causing right now. </p>\n"}, {"tags": [], "owner": {"reputation": 2966, "user_id": 308523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qOeK7.jpg?s=128&g=1", "display_name": "Fer", "link": "https://stackoverflow.com/users/308523/fer"}, "is_accepted": false, "score": 1, "last_activity_date": 1433930319, "last_edit_date": 1433930319, "creation_date": 1433929923, "answer_id": 30752918, "question_id": 30752852, "link": "https://stackoverflow.com/questions/30752852/activerecordstatementinvalid-in-controllermethod/30752918#30752918", "title": "ActiveRecord::StatementInvalid in controller#method", "body": "<p><code>in</code> is a reserved word in sql. You have to quote it so it is taken as a column name.</p>\n\n<p>Using standard arel notation would be properly quoted</p>\n\n<pre><code>where(:in =&gt; @cisearch.in)\n</code></pre>\n\n<p>or quoting it manually with the backtick\n<code>\nwhere(\"`in` = ?\",@cisearch.in)\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "is_accepted": true, "score": 5, "last_activity_date": 1433929927, "creation_date": 1433929927, "answer_id": 30752921, "question_id": 30752852, "link": "https://stackoverflow.com/questions/30752852/activerecordstatementinvalid-in-controllermethod/30752921#30752921", "title": "ActiveRecord::StatementInvalid in controller#method", "body": "<p><a href=\"http://webcheatsheet.com/sql/interactive_sql_tutorial/sql_in.php\" rel=\"noreferrer\"><code>in</code> is an SQL operator</a>. While technically you can use it as a column name, to do so, you have to escape it. And that's why I try to avoid using plain SQL in my queries.</p>\n\n<p>Replace <code>@evms.where('in=?',@cisearch.in)</code> with <code>@evms.where(in: @cisearch.in)</code>. That way it will be escaped properly.</p>\n"}, {"tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 2, "last_activity_date": 1433930098, "creation_date": 1433930098, "answer_id": 30752981, "question_id": 30752852, "link": "https://stackoverflow.com/questions/30752852/activerecordstatementinvalid-in-controllermethod/30752981#30752981", "title": "ActiveRecord::StatementInvalid in controller#method", "body": "<p><a href=\"https://www.sqlite.org/lang_keywords.html\" rel=\"nofollow\"><code>in</code></a> is a reserved keyword. That's why SQLite or any DBMS which has <code>in</code> as its one of the keywords, will throw this error. I'd recommend you to change the column name to something else, for example <code>within</code>. Otherwise you'll have to make sure you escape(quote:``) it all the time in your queries. </p>\n"}], "owner": {"reputation": 2602, "user_id": 3565829, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/88236592cc604cf1becc585717ca8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "yerassyl", "link": "https://stackoverflow.com/users/3565829/yerassyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 30752921, "answer_count": 4, "score": 1, "last_activity_date": 1433930319, "creation_date": 1433929728, "last_edit_date": 1433929975, "question_id": 30752852, "link": "https://stackoverflow.com/questions/30752852/activerecordstatementinvalid-in-controllermethod", "title": "ActiveRecord::StatementInvalid in controller#method", "body": "<p>I am doing complex search, and for that I have special model:</p>\n\n<pre><code>create_table \"cmdb_searches\", force: :cascade do |t|\n  t.string   \"client\"\n  t.string   \"in\"\n  t.datetime \"created_at\", null: false\n  t.datetime \"updated_at\", null: false\nend\n</code></pre>\n\n<p>and method search inside evms_controller:</p>\n\n<pre><code>def search\n  @cisearch = CmdbSearch.new(search_params)\n  @evms = Evm.order('id DESC')\n  @evms = @evms.where('client_name=?',@cisearch.client) if #cisearch.client.present?\n  @evms = @evms.where('in=?',@cisearch.in) if @cisearch.in.present?\n  respond_to do |format|\n    format.js\n  end\nend\n</code></pre>\n\n<p>and my js file fills the apropriate div with the response. It works if I leave form empty or fill only :client field, BUT if i fill :in field it will return me an error:</p>\n\n<pre><code>SQLite3::SQLException: near \"in\": syntax error: SELECT \"evms\".* FROM \"evms\" WHERE (in='234543')  ORDER BY id DESC\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 13534, "user_id": 644810, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ADwSQ.png?s=128&g=1", "display_name": "Rustam A. Gasanov", "link": "https://stackoverflow.com/users/644810/rustam-a-gasanov"}, "is_accepted": true, "score": 12, "last_activity_date": 1433929584, "last_edit_date": 1433929584, "creation_date": 1433929027, "answer_id": 30752590, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/30752590#30752590", "title": "How to iterate over an array skipping every second element?", "body": "<p>You can specify <code>.step</code> size as an argument actually:</p>\n\n<pre><code>(0...arr.length).step(2) { |i| puts arr[i] }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1433929581, "post_id": 30752611, "comment_id": 49559400, "body": "You should show that this yields the indices and you have to do the array look-up in addition."}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "reply_to_user": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1433929822, "post_id": 30752611, "comment_id": 49559565, "body": "@undur_gongor I didn&#39;t get you"}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1433930405, "post_id": 30752611, "comment_id": 49559981, "body": "<code>arr.each { | n | p n }</code> prints the array elements. <code>(0...arr.length).step(2) { |n| p n }</code> prints not the (even) elements but the indices. You&#39;d need <code>(0...arr.length).step(2) { |n| p arr[n] }</code>."}], "tags": [], "owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "is_accepted": false, "score": 2, "last_activity_date": 1433930505, "last_edit_date": 1433930505, "creation_date": 1433929098, "answer_id": 30752611, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/30752611#30752611", "title": "How to iterate over an array skipping every second element?", "body": "<pre><code>(0...arr.length).step(2) do |n|\nend\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>for i in (0...arr.length).step(2) do\n    puts arr[i]\nend\n</code></pre>\n\n<p>step is used for incrementing n value and this loop will continue till arr.length</p>\n"}, {"comments": [{"owner": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 2, "creation_date": 1433930763, "post_id": 30752723, "comment_id": 49560235, "body": "upvoted this one, I&#39;d just clean the last part <code>arr.each_slice(2).map(&amp;:first)</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1099, "user_id": 2799029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eea432dc7b47d95cba6b39b0446feb5e?s=128&d=identicon&r=PG&f=1", "display_name": "floum", "link": "https://stackoverflow.com/users/2799029/floum"}, "edited": false, "score": 1, "creation_date": 1434168952, "post_id": 30752723, "comment_id": 49677576, "body": "@floum, I think xdazz means <code>arr.each_slice(2) { |n| &lt; do something with n.first &gt; }</code>. You could also write it <code>arr.each_slice(2) { |f,_| &lt; do something with f &gt; }</code>"}], "tags": [], "owner": {"reputation": 149047, "user_id": 762073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fb6b9bc012cd839a99ba778c722c5a7?s=128&d=identicon&r=PG", "display_name": "xdazz", "link": "https://stackoverflow.com/users/762073/xdazz"}, "is_accepted": false, "score": 10, "last_activity_date": 1433929381, "creation_date": 1433929381, "answer_id": 30752723, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/30752723#30752723", "title": "How to iterate over an array skipping every second element?", "body": "<p>Another way is to use <strong><a href=\"http://ruby-doc.org/core-2.2.2/Enumerable.html#method-i-each_slice\">Array::each_slice</a></strong>:</p>\n\n<pre><code> arr.each_slice(2) { |n| p n.first }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 2, "last_activity_date": 1433932404, "last_edit_date": 1433932404, "creation_date": 1433931990, "answer_id": 30753661, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/30753661#30753661", "title": "How to iterate over an array skipping every second element?", "body": "<p>You can try this too:</p>\n\n<pre><code>&gt; arr = Array('a'..'z')\n#=&gt; [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\"] \n&gt; arr.select.each_with_index{|k,i| k if i.even?} \n#=&gt; [\"a\", \"c\", \"e\", \"g\", \"i\", \"k\", \"m\", \"o\", \"q\", \"s\", \"u\", \"w\", \"y\"]\n</code></pre>\n\n<p>I love <code>step</code> and <code>slice</code> method by which already answered so this is just another approach. ;)</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1433950177, "creation_date": 1433950177, "answer_id": 30760812, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/30760812#30760812", "title": "How to iterate over an array skipping every second element?", "body": "<p>A million and one ways to solve Array problems. If you don't actually need the loop this will pull the values easily</p>\n\n<pre><code>a = (0..20).to_a\na.values_at(*(0..a.size).step(2))\n#=&gt; =&gt; [0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 6366580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIEHS.jpg?s=128&g=1", "display_name": "rawatsandeep1989", "link": "https://stackoverflow.com/users/6366580/rawatsandeep1989"}, "edited": false, "score": 0, "creation_date": 1523340540, "post_id": 49746473, "comment_id": 86507190, "body": "where 2 is the step you would like to take."}], "tags": [], "owner": {"reputation": 55, "user_id": 6366580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIEHS.jpg?s=128&g=1", "display_name": "rawatsandeep1989", "link": "https://stackoverflow.com/users/6366580/rawatsandeep1989"}, "is_accepted": false, "score": 0, "last_activity_date": 1523340504, "creation_date": 1523340504, "answer_id": 49746473, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element/49746473#49746473", "title": "How to iterate over an array skipping every second element?", "body": "<p>Using while loop it can be done as follows:-</p>\n\n<pre><code>#!/usr/bin/ruby\narr=[1,2,3,4,5,6]  \ni=0\nbegin\n    puts arr.at(i*2)\ni += 1\nputs \"value of i is #{i}\" \nend while (i*2) &lt; arr.length\n</code></pre>\n"}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2883, "favorite_count": 1, "accepted_answer_id": 30752590, "answer_count": 6, "score": 3, "last_activity_date": 1523340504, "creation_date": 1433928855, "last_edit_date": 1433929429, "question_id": 30752531, "link": "https://stackoverflow.com/questions/30752531/how-to-iterate-over-an-array-skipping-every-second-element", "title": "How to iterate over an array skipping every second element?", "body": "<p>How to write this type of for loop in ruby?</p>\n\n<pre><code>for(i = 0; i &lt; arr.length; i = i+2) {\n}\n</code></pre>\n\n<p>I know how to write it if step is 1, but if step > 1, how to make it?</p>\n"}, {"tags": ["jquery", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1433928179, "post_id": 30752247, "comment_id": 49558385, "body": "Please post some code to show your efforts first."}, {"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "reply_to_user": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1433928648, "post_id": 30752247, "comment_id": 49558725, "body": "cookies[:test] = {value: &quot;test123&quot;, domain: :all} . i create this cookie and i want when i close the broswer , the is not available there . and when user log in i set current user with session (session[:user_id= @user.id) and i want  when i close the browser , session[:user_id] should be nil."}, {"owner": {"reputation": 2447, "user_id": 4786273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d430245706eaa71e471c7b72eba6b78f?s=128&d=identicon&r=PG", "display_name": "Random", "link": "https://stackoverflow.com/users/4786273/random"}, "edited": false, "score": 0, "creation_date": 1433928893, "post_id": 30752247, "comment_id": 49558912, "body": "@PardeepSaini I edited your answer. Please edit your answer when giving such informations, don&#39;t post code in comments. detail as much as you can your question."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1433929182, "post_id": 30752247, "comment_id": 49559130, "body": "@PardeepSaini : setting cookies without an expire time will be deleted once the <b>browser</b> (<b>not</b> the <b>tab</b> or <b>window</b>) is closed. Did you try to close the browser and checked for the existence of cookie in next request?"}, {"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "edited": false, "score": 0, "creation_date": 1433929564, "post_id": 30752247, "comment_id": 49559387, "body": "yes, checked everything. I close the browser and reopen but cookies are still there."}, {"owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "edited": false, "score": 0, "creation_date": 1433950566, "post_id": 30752247, "comment_id": 49574703, "body": "Usually browsers (Firefox and Chrome for sure) will delete such cookies (without an expire date) only if you fully close the browser (eg all tabs and windows). So solution proposed by @mr-h is a better option IMHO"}], "answers": [{"comments": [{"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "edited": false, "score": 0, "creation_date": 1433932498, "post_id": 30753382, "comment_id": 49561326, "body": "i try onbeforeload event but fire when we refresh page."}, {"owner": {"reputation": 2979, "user_id": 1053931, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mp3h1.jpg?s=128&g=1", "display_name": "evgeny.myasishchev", "link": "https://stackoverflow.com/users/1053931/evgeny-myasishchev"}, "edited": false, "score": 0, "creation_date": 1433950656, "post_id": 30753382, "comment_id": 49574753, "body": "there are tricks to detect it. Please check <a href=\"http://stackoverflow.com/questions/568977/identifying-between-refresh-and-close-browser-actions\" title=\"identifying between refresh and close browser actions\">stackoverflow.com/questions/568977/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4984, "user_id": 415038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/19555464959dab287601521181e5cece?s=128&d=identicon&r=PG", "display_name": "Mr H", "link": "https://stackoverflow.com/users/415038/mr-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1433931185, "creation_date": 1433931185, "answer_id": 30753382, "question_id": 30752247, "link": "https://stackoverflow.com/questions/30752247/how-to-destroy-session-and-cookies-on-browser-close-in-rails-4/30753382#30753382", "title": "How to destroy session and cookies on browser close in rails 4", "body": "<p>Just a quick suggestion:</p>\n\n<p>I think if you use something like AngularJS or even jQuery, then you can fire a trigger when browser about to close to trigger a function to remove the cookies for you.</p>\n\n<p>Regarding the Sessions you can use the same theory only you need to trigger Ajax as Session variables can be removed by Rails. </p>\n"}], "owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433931185, "creation_date": 1433928122, "last_edit_date": 1433930333, "question_id": 30752247, "link": "https://stackoverflow.com/questions/30752247/how-to-destroy-session-and-cookies-on-browser-close-in-rails-4", "title": "How to destroy session and cookies on browser close in rails 4", "body": "<p>I want to destroy user session and expire cookies whenever i close the browser. To expire cookies i try to create cookies without expiration time but not work. </p>\n\n<p><strong>EDIT :</strong></p>\n\n<pre><code>cookies[:test] = {value: \"test123\", domain: :all}\n</code></pre>\n\n<p>I create this cookie and i want when i close the broswer , the is not available there . and when user log in i set current user with session (<code>session[:user_id= @user.id</code>) and I want when I close the browser , <code>session[:user_id]</code> should be null.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "character-encoding", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 547173, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a13366ad98cfd2fde3a7904d0fbb1aa?s=128&d=identicon&r=PG", "display_name": "Denis Washington", "link": "https://stackoverflow.com/users/547173/denis-washington"}, "is_accepted": true, "score": 3, "last_activity_date": 1435095134, "creation_date": 1435095134, "answer_id": 31013922, "question_id": 30751208, "link": "https://stackoverflow.com/questions/30751208/rails-activerecord-string-field-encoding-vs-ruby-string-encoding/31013922#31013922", "title": "Rails ActiveRecord string field encoding vs Ruby String encoding", "body": "<p>The simplest and, arguably, cleanest solution to this problem would be to not call <code>Encoding.find</code> directly, but have an utility method (perhaps in a module located at <code>lib/yourapp</code>) which knows about the encoding name differences you care about and falls back to <code>Encoding.find</code> for all other inputs:</p>\n\n<pre><code>module YourApp\n  module DatabaseStringEncoding\n    def find(name)\n      case name\n      when 'UTF8'\n        Encoding::UTF_8\n      ...\n      else\n        Encoding.find(name)\n      end \n    end\n  end\n</code></pre>\n\n<p>This is both easy to understand and discover (as opposed to modifying <code>Encoding</code> directly, which is not visible to the reader of the code which does the encoding). Based on such a <code>find</code> method, you could then go further and implement a method which automatically recodes a string to the database's string encoding using <code>YourRecord.connection.encoding</code>.</p>\n\n<p>I know it would be more exciting to get <code>Encoding.find</code> to do exactly what you want, but I would argue that this \"dumber\" approach would actually be the better one. :-)</p>\n"}], "owner": {"reputation": 8490, "user_id": 674064, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bf2cf5a797565e548088053644704e7?s=128&d=identicon&r=PG", "display_name": "das-g", "link": "https://stackoverflow.com/users/674064/das-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 1, "accepted_answer_id": 31013922, "answer_count": 1, "score": 5, "last_activity_date": 1435095134, "creation_date": 1433925419, "question_id": 30751208, "link": "https://stackoverflow.com/questions/30751208/rails-activerecord-string-field-encoding-vs-ruby-string-encoding", "title": "Rails ActiveRecord string field encoding vs Ruby String encoding", "body": "<h1>Context: Transcoding a string from an external source for saving in the database</h1>\n\n<p>From a gem, I get a string <code>s</code> that has <code>latin-1</code>-encoded content and that I want to store in a Rails model.</p>\n\n<pre><code>r = MyRecord.new(mystring: s)\n# ...\nr.save\n</code></pre>\n\n<p>Because my PostgreSQL database uses <code>UTF-8</code> encoding, saving the model after setting its string field to the string causes an error when that string contains certain non-ASCII characters:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ActiveRecord::StatementInvalid: PG::CharacterNotInRepertoire: ERROR:  invalid byte sequence for encoding \"UTF8\": 0xdf 0x65\n...\n</code></pre>\n\n<p>I can solve this easily by transcoding the string:</p>\n\n<pre><code>r = MyRecord.new(mystring: s.encode(Encoding::UTF_8, Encoding::ISO_8859_1))\n# ...\nr.save\n</code></pre>\n\n<p>(Because <code>r.encoding</code> returns <em><code>#&lt;Encoding:ASCII-8BIT&gt;</code></em> instead of <em><code>#&lt;Encoding:ISO-8859-1&gt;</code></em>, I'm <a href=\"http://ruby-doc.org/core-2.2.2/String.html#method-i-encode\" rel=\"noreferrer\">passing the source encoding as the second argument</a>. The gem that produced <code>s</code> probably isn't aware that the file it read the string from is <code>latin1</code> encoded.)</p>\n\n<h1>Challenge: Avoid hard-coding the destination encoding</h1>\n\n<p>It occurred to me, that knowledge about the database's string encoding does not belong in the part of the code where I do this persisting and thus also the transcoding.</p>\n\n<p>I can ask the model's class for the database's encoding:</p>\n\n<pre><code>MyRecord.connection.encoding\n</code></pre>\n\n<p>This doesn't return a <a href=\"http://ruby-doc.org/core-2.2.2/Encoding.html\" rel=\"noreferrer\">Ruby <code>Encoding</code></a> object though, it returns a string containing the encoding's name. Fortunately, the <code>Encoding</code> class <a href=\"http://ruby-doc.org/core-2.2.2/Encoding.html#method-c-find\" rel=\"noreferrer\">can be queried with names</a> (and <a href=\"http://ruby-doc.org/core-2.2.2/Encoding.html#method-i-names\" rel=\"noreferrer\">some aliases</a>) to look up encodings:</p>\n\n<pre><code>Encoding.find 'UTF-8' # returns #&lt;Encoding:UTF-8&gt;, the value of Encoding::UTF_8\n</code></pre>\n\n<p>Unfortunately, <strong>different naming conventions are used:</strong> <code>MyRecord.connection.encoding</code> returns <code>'UTF8'</code> (<strong>no</strong> minus sign) while <code>Encoding.find(...)</code> needs to be passed <code>'UTF-8'</code> (<strong>with</strong> minus sign) or <code>'CP65001'</code> if we want it to return <em><code>#&lt;Encoding:UTF-8&gt;</code></em>.)</p>\n\n<p>Sooooo close.</p>\n\n<h1>Question: Is there a clean and/or recommended way</h1>\n\n<p><strong>to avoid the hard-coding of the destination encoding and instead dynamically determine and use the the database's encoding for that?</strong></p>\n\n<h2>Discarded ideas</h2>\n\n<p>I don't feel doing string manipulation or pattern matching on the result of <code>MyRecord.connection.encoding</code> or on the contents of <a href=\"http://ruby-doc.org/core-2.2.2/Encoding.html#method-c-aliases\" rel=\"noreferrer\"><code>Encoding.aliases()</code></a> would be any better than just leaving the hard-coded values in the code.</p>\n\n<p>Modifying <code>Encoding.aliases()</code>'s return value doesn't have any effect:</p>\n\n<pre><code>Encoding.aliases['UTF8'] = 'UTF-8'\nEncoding.find 'UTF8' # ArgumentError: unknown encoding name - UTF8\n</code></pre>\n\n<p>(and doesn't feel right either, anyway), nor does modifying the return value of <a href=\"http://ruby-doc.org/core-2.2.2/Encoding.html#method-i-names\" rel=\"noreferrer\"><code>#names</code></a>:</p>\n\n<pre><code>Encoding::UTF_8.names.push('UTF8')\nEncoding.find 'UTF8'# ArgumentError: unknown encoding name - UTF8\n</code></pre>\n\n<p>I guess both only return dynamically generated collections or copies of the underlying collections, and for a good reason.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linux", "shell", "image-processing"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 2, "creation_date": 1433925432, "post_id": 30751175, "comment_id": 49556581, "body": "i would look into rmagick, it&#39;s a very powerful image processor"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1433925478, "post_id": 30751175, "comment_id": 49556611, "body": "By combine images, did you mean that make 1 image from 4 images? Try rmagick."}, {"owner": {"reputation": 324, "user_id": 905987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0c7d88ecacb16e0fa21b4d43446425?s=128&d=identicon&r=PG", "display_name": "Ollie", "link": "https://stackoverflow.com/users/905987/ollie"}, "edited": false, "score": 0, "creation_date": 1433944782, "post_id": 30751175, "comment_id": 49570197, "body": "Try composite! <a href=\"https://rmagick.github.io/image1.html#composite_bang\" rel=\"nofollow noreferrer\">rmagick.github.io/image1.html#composite_bang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 1, "creation_date": 1433928780, "post_id": 30751381, "comment_id": 49558828, "body": "btw, the rmagick gem will also require you to install ImageMagick, which does the actual work (rmagick just provides a friendly ruby interface for ImageMagick).  Installing ImageMagick traditionally used to be a pain in the ass (whenever i did it anyway), but nowadays i think it&#39;s much easier to install."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1433930882, "post_id": 30751381, "comment_id": 49560322, "body": "@MaxWilliams : Yes I am agree with you. <code>ImageMagick</code> should be installed"}, {"owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "edited": false, "score": 1, "creation_date": 1433954987, "post_id": 30751381, "comment_id": 49577613, "body": "I tried that, but I get an image of 2048x2048 with 4 images each on top the the other. I do not want them on top, I need first on top 0,0, second one on top 0, 2048, third one on top 2048, 0 and last one on top 2048, 2048.  Basically, I want to form a square image from 4 smaller square images, each of the 4 being a quarter of the new one"}], "tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": true, "score": 7, "last_activity_date": 1433925944, "last_edit_date": 1495539958, "creation_date": 1433925944, "answer_id": 30751381, "question_id": 30751175, "link": "https://stackoverflow.com/questions/30751175/how-to-combine-images-in-ruby/30751381#30751381", "title": "How to combine images in Ruby", "body": "<p>Try: <strong><a href=\"https://rubygems.org/gems/rmagick/versions/2.15.2\" rel=\"nofollow noreferrer\">'rmagick' gem</a></strong></p>\n\n<pre><code>require 'rmagick'\n\nimage_list = Magick::ImageList.new(\"image1.png\", \"image2.png\", \"image3.png\")\nimage_list.write(\"combine.png\")\n</code></pre>\n\n<p>You can also refer this <strong><a href=\"https://stackoverflow.com/questions/1736944/combine-thumbnails-to-one-large-image-with-rmagick\">SO Question</a></strong> it's similar to yours.</p>\n"}, {"tags": [], "owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "is_accepted": false, "score": 5, "last_activity_date": 1433971607, "creation_date": 1433971607, "answer_id": 30767596, "question_id": 30751175, "link": "https://stackoverflow.com/questions/30751175/how-to-combine-images-in-ruby/30767596#30767596", "title": "How to combine images in Ruby", "body": "<p>I marked the accepted answer because was the starting point for solving my problem. I will also post the complete working solution here:</p>\n\n<pre><code>require 'rmagick'\nclass Combiner\ninclude Magick\n\n  def self.combine\n    #this will be the final image\n    big_image = ImageList.new\n\n    #this is an image containing first row of images\n    first_row = ImageList.new\n    #this is an image containing second row of images\n    second_row = ImageList.new\n\n    #adding images to the first row (Image.read returns an Array, this is why .first is needed)\n    first_row.push(Image.read(\"1.png\").first)\n    first_row.push(Image.read(\"2.png\").first)\n\n    #adding first row to big image and specify that we want images in first row to be appended in a single image on the same row - argument false on append does that\n    big_image.push (first_row.append(false))\n\n    #same thing for second row\n    second_row.push(Image.read(\"3.png\").first)\n    second_row.push(Image.read(\"4.jpg\").first)\n    big_image.push(second_row.append(false))\n\n    #now we are saving the final image that is composed from 2 images by sepcify append with argument true meaning that each image will be on a separate row\n    big_image.append(true).write(\"big_image.jpg\")\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 2137426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33ea5c12d767bfd1253940a960274f5?s=128&d=identicon&r=PG", "display_name": "An RMagick User", "link": "https://stackoverflow.com/users/2137426/an-rmagick-user"}, "is_accepted": false, "score": 1, "last_activity_date": 1434132893, "creation_date": 1434132893, "answer_id": 30809701, "question_id": 30751175, "link": "https://stackoverflow.com/questions/30751175/how-to-combine-images-in-ruby/30809701#30809701", "title": "How to combine images in Ruby", "body": "<p>You might also try the <a href=\"https://rmagick.github.io/ilist.html#montage\" rel=\"nofollow\">montage</a> method. </p>\n"}, {"comments": [{"owner": {"reputation": 510, "user_id": 1934269, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbe8a33f0e36546291047500a0bd999b?s=128&d=identicon&r=PG", "display_name": "Myk Klemme", "link": "https://stackoverflow.com/users/1934269/myk-klemme"}, "edited": false, "score": 0, "creation_date": 1529555073, "post_id": 50960351, "comment_id": 88917535, "body": "I haven&#39;t looked at the code under the hood, but this might save more memory than doing a <code>File.open</code> inside a <code>&amp;block</code>"}, {"owner": {"reputation": 510, "user_id": 1934269, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbe8a33f0e36546291047500a0bd999b?s=128&d=identicon&r=PG", "display_name": "Myk Klemme", "link": "https://stackoverflow.com/users/1934269/myk-klemme"}, "edited": false, "score": 0, "creation_date": 1529555167, "post_id": 50960351, "comment_id": 88917557, "body": "Use the <code>tile</code> option to achieve the question&#39;s desired layout. <code>image.tile &quot;2x2&quot;</code>"}, {"owner": {"reputation": 1049, "user_id": 2842966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mZBtJ.jpg?s=128&g=1", "display_name": "Ben-Hur Batista", "link": "https://stackoverflow.com/users/2842966/ben-hur-batista"}, "edited": false, "score": 0, "creation_date": 1548358786, "post_id": 50960351, "comment_id": 95523435, "body": "To get proccessed_image into a blob you needs to add image.stdout at end"}], "tags": [], "owner": {"reputation": 510, "user_id": 1934269, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dbe8a33f0e36546291047500a0bd999b?s=128&d=identicon&r=PG", "display_name": "Myk Klemme", "link": "https://stackoverflow.com/users/1934269/myk-klemme"}, "is_accepted": false, "score": 3, "last_activity_date": 1529554998, "creation_date": 1529554998, "answer_id": 50960351, "question_id": 30751175, "link": "https://stackoverflow.com/questions/30751175/how-to-combine-images-in-ruby/50960351#50960351", "title": "How to combine images in Ruby", "body": "<p>For anyone landing here from Google and might be using a newer version of <code>MiniMagick (4.8.0)</code> &amp; <code>Rails (5.2.0)</code>, I was able to combine images horizontally using this code:</p>\n\n<pre><code># Replace this with the path to the images you want to combine\nimages = [\n  \"image1.jpg\",\n  \"image2.jpg\"\n]\n\nprocessed_image = MiniMagick::Tool::Montage.new do |image|\n  image.geometry \"x700+0+0\"\n  image.tile \"#{images.size}x1\"\n  images.each {|i| image &lt;&lt; i}\n  image &lt;&lt; \"output.jpg\"\nend\n</code></pre>\n\n<p>Check out the <a href=\"https://www.imagemagick.org/script/command-line-processing.php#geometry\" rel=\"nofollow noreferrer\">documentation</a> for <code>#geometry</code> options to handle resizing and placement. The current example will resize images to a <code>700px</code> height while maintaining the image's aspect ratio. <code>+0+0</code> will place the image with no gaps between them.</p>\n"}], "owner": {"reputation": 3028, "user_id": 1300223, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a24c84d319acafeba6f4c31db82672f8?s=128&d=identicon&r=PG", "display_name": "Eduard", "link": "https://stackoverflow.com/users/1300223/eduard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4602, "favorite_count": 3, "accepted_answer_id": 30751381, "answer_count": 4, "score": 7, "last_activity_date": 1529554998, "creation_date": 1433925327, "question_id": 30751175, "link": "https://stackoverflow.com/questions/30751175/how-to-combine-images-in-ruby", "title": "How to combine images in Ruby", "body": "<p>I have 4 square images, 1,2,3 and 4 each with 2048x2048px.</p>\n\n<p>I need to combine those into a 4096x4096px image, like this:</p>\n\n<pre><code> 1 2\n 3 4\n</code></pre>\n\n<p>Right now I am doing this manually with Gimp, but the amount processing is growing and I would like to implement an automated solution.</p>\n\n<p>Is there an easy way to do this in Ruby? (Rails gem would be ok or any shell command that can be run from inside a Rails app) </p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "sql-server", "json"], "comments": [{"owner": {"reputation": 2484, "user_id": 1926109, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Lj9G2.jpg?s=128&g=1", "display_name": "Akhil", "link": "https://stackoverflow.com/users/1926109/akhil"}, "edited": false, "score": 0, "creation_date": 1433929302, "post_id": 30750885, "comment_id": 49559193, "body": "What is the problem in saving the where condition as it is in a plain string form?"}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 2484, "user_id": 1926109, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Lj9G2.jpg?s=128&g=1", "display_name": "Akhil", "link": "https://stackoverflow.com/users/1926109/akhil"}, "edited": false, "score": 1, "creation_date": 1433929436, "post_id": 30750885, "comment_id": 49559288, "body": "In that case I have to parse those strings to find, say whether query was ran for a particular date. Want to have a structured approach, queries can be little complex as well."}], "owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1433924912, "creation_date": 1433924476, "last_edit_date": 1433924912, "question_id": 30750885, "link": "https://stackoverflow.com/questions/30750885/storing-sql-conditions-in-json", "title": "Storing SQL Conditions in JSON", "body": "<p>I have a use-case where I want to search all the <code>SQL</code> queries on an entity in database, and later I want to query on which fields and for which values that query had been executed. I am developing this in ruby.</p>\n\n<p>For example, Following queries were ran:</p>\n\n<pre><code>select * from entity where created_at &gt; \"2015-03-01\" and  created_at &lt; \"2015-03-03\" ;\nselect * from entity where created_at &gt; \"2015-03-03\" and  created_at &lt; \"2015-03-04\" and type in ('forward');\nselect * from entity where created_at &gt; \"2015-03-01\" and  created_at &lt; \"2015-03-03\" and type in ('reverse');\n</code></pre>\n\n<p>Later on, I should be able to fetch for which dates on <code>created_at</code>, these queries were ran. This can be queried for type as well, so want to keep it completely generic.</p>\n\n<p>So, I was thinking to save conditions of these queries in <code>JSON</code> format. Let me know if you know of any format or <code>gem</code>, which can help for such case.</p>\n\n<p>I was thinking of constructing <code>JSON</code> for these queries in following format:</p>\n\n<pre><code>{\n    \"query\": [\n        {\n            \"field\": \"created_at\",\n            \"value_more_than\": \"2015-03-03\",\n            \"value_less_than\": \"2015-03-04\",\n            \"type\" : \"date\"\n        },\n        {\n            \"field\": \"type\",\n            \"value_in\": \"forward\",\n            \"type\" : \"String\"\n        }\n    ]\n}\n</code></pre>\n\n<p>And saving these for future reference and querying on these when asked for. Please let me know, of you are familiar with a better format or can suggest some improvement overall.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 1, "creation_date": 1433924814, "post_id": 30750867, "comment_id": 49556205, "body": "<code>format.html { redirect_to @sample, uuid: @sample.uuid }</code> and in view <code>&lt;%= flash[:uuid] %&gt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": true, "score": 2, "last_activity_date": 1433924815, "creation_date": 1433924815, "answer_id": 30750994, "question_id": 30750867, "link": "https://stackoverflow.com/questions/30750867/how-i-can-pass-a-value-in-format-html-with-redirect-to-in-rails/30750994#30750994", "title": "How I can pass a value in format.html with redirect_to in rails", "body": "<p>To be able to access those values via flash, try the following:</p>\n\n<pre><code>format.html { redirect_to @sample, flash: { uuid: @sample.uuid, msg: @sample.msg } }\n</code></pre>\n\n<p>You can then access them via <code>&lt;%= flash[:uuid] %&gt;</code> or <code>&lt;%= flash[:msg] %&gt;</code></p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 127, "user_id": 4343492, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/2a83ede110258ecda61062307db5d219?s=128&d=identicon&r=PG", "display_name": "Pepeng Agimat", "link": "https://stackoverflow.com/users/4343492/pepeng-agimat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 2, "accepted_answer_id": 30750994, "answer_count": 1, "score": 1, "last_activity_date": 1433924815, "creation_date": 1433924412, "question_id": 30750867, "link": "https://stackoverflow.com/questions/30750867/how-i-can-pass-a-value-in-format-html-with-redirect-to-in-rails", "title": "How I can pass a value in format.html with redirect_to in rails", "body": "<p>I tried to pass uuid and msg in the <code>format.html { redirect_to @sample, notice: { uuid: @sample.uuid, msg: @sample.msg }</code> to display in the view but I think it's not the proper way of passing a value. </p>\n\n<p>And when I want to access in the view</p>\n\n<p><code>&lt;%= flash[:notice][:code] %&gt;</code>\n<code>&lt;%= flash[:notice][:id] %&gt;</code></p>\n\n<p>doesn't display the flash..</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433924454, "post_id": 30750599, "comment_id": 49555975, "body": "what&#39;s the foreign key in the <code>relationships</code> table ?"}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433925230, "post_id": 30750599, "comment_id": 49556458, "body": "That you need to mention in your <code>belongs_to</code> as <code>.., foreign_key: source</code>"}, {"owner": {"reputation": 5922, "user_id": 3632206, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70c95cfa616112abaa8c04a878c256ed?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Zeki", "link": "https://stackoverflow.com/users/3632206/sebastian-zeki"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433925646, "post_id": 30750599, "comment_id": 49556696, "body": "I have done this. As I have said in the question the problem is not the query output which is fine, it is in what the hash loop does. It is the hash that is producing too many nodes -the part of the statement as here: each_with_object(Hash.new{|h, k| h[k] = []}) do |a, obj|"}, {"owner": {"reputation": 2314, "user_id": 2882921, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ffb2397ff2a97e133bdaa6cb2b449b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Kruczek", "link": "https://stackoverflow.com/users/2882921/piotr-kruczek"}, "edited": false, "score": 0, "creation_date": 1433926068, "post_id": 30750599, "comment_id": 49556972, "body": "How is the output different than expected? I don&#39;t see anything wrong with the loop. Show us a small sample of what&#39;s returned vs what was expected"}, {"owner": {"reputation": 5922, "user_id": 3632206, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70c95cfa616112abaa8c04a878c256ed?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Zeki", "link": "https://stackoverflow.com/users/3632206/sebastian-zeki"}, "edited": false, "score": 0, "creation_date": 1433927198, "post_id": 30750599, "comment_id": 49557706, "body": "Having looked at this it must be the query that is incorrect. What I want is the relationship table result and one &#39;name&#39; and &#39;group&#39; from the User table for each relationship.source. At the moment I am getting a repeated name from the User table for each row of the relationship table. This must be a problem with the join I am using in the query?"}], "owner": {"reputation": 5922, "user_id": 3632206, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/70c95cfa616112abaa8c04a878c256ed?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Zeki", "link": "https://stackoverflow.com/users/3632206/sebastian-zeki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433927186, "creation_date": 1433923564, "last_edit_date": 1433927186, "question_id": 30750599, "link": "https://stackoverflow.com/questions/30750599/rails-query-producing-incorrect-result", "title": "Rails query producing incorrect result", "body": "<p>I have two tables in a rails application as follows:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20150603200530) do  \n  create_table \"relationships\", force: true do |t|\n    t.integer \"source\"\n    t.integer \"target\"\n    t.integer \"value\"\n  end\n\n  create_table \"users\", force: true do |t|\n    t.string  \"name\"\n    t.integer \"group\"\n  end\nend\n</code></pre>\n\n<p>One User has many relationships (User.id=relationship.source).</p>\n\n<p>I have populated the database as follows with a populate.rake file</p>\n\n<pre><code>namespace :db do\n  desc \"Erase and fill database\"\n  task :populate =&gt; :environment do\n    require 'populator'\n    require 'faker'\n\n    [User, Relationship].each(&amp;:delete_all)\n\n\n\n   User.populate 5 do |user|\n      user.name = Populator.words(1..3).titleize\n      user.group =1..5\n    Relationship.populate 1..5 do |relationship|\n        relationship.source = rand(1..5)\n        relationship.target = rand(1..5)\n        relationship.value = rand(1..5)\n        end\n    end\n  end\n</code></pre>\n\n<p>I am trying to get a database query result into a specific format for json (the actual json formatting is done elsewhere) and this requires name and group to be under 'node' and source, target and value under 'links'. In my user model I have queried the database as follows.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :relationships\n\n  def self.including_relationships\n    User.joins(\"INNER JOIN relationships ON users.id = relationships.source\").select(\"users.name, users.`group`, relationships.source, relationships.target, relationships.value\").each_with_object(Hash.new{|h, k| h[k] = []}) do |a, obj| \n\n\n      obj['nodes'] &lt;&lt; a.slice('name','group')\n      obj['links'] &lt;&lt; a.slice('source', 'target', 'value')\n    end\n  end\nend\n</code></pre>\n\n<p>This produces usable json output. The query before the each_with_object part works fine and gives me the expected results in rails console. However when I run it in the brower, it produces an incorrect number of names.  I think the problem must lie in the way the array works as the query is fine but I am getting too many nodes and links. The query output from the rails console is here:</p>\n\n<p>[#, #, #, #, #, #, #, #, #, #, #, #, #, #] </p>\n\n<p>The json output I am currently getting is here:</p>\n\n<pre><code>{\"nodes\":[{\"name\":\"A Voluptatem Quo\",\"group\":2},{\"name\":\"Debitis Ut\",\"group\":1},{\"name\":\"A Voluptatem Quo\",\"group\":2},{\"name\":\"Eos\",\"group\":1},{\"name\":\"Eos\",\"group\":1},{\"name\":\"Debitis Ut\",\"group\":1},{\"name\":\"Debitis Ut\",\"group\":1},{\"name\":\"Placeat Aliquam Cumque\",\"group\":5},{\"name\":\"Placeat Aliquam Cumque\",\"group\":5},{\"name\":\"Placeat Aliquam Cumque\",\"group\":5},{\"name\":\"Debitis Ut\",\"group\":1},{\"name\":\"Error In\",\"group\":4},{\"name\":\"Eos\",\"group\":1},{\"name\":\"A Voluptatem Quo\",\"group\":2}],\"links\":[{\"source\":1,\"target\":1,\"value\":4},{\"source\":4,\"target\":1,\"value\":4},{\"source\":1,\"target\":3,\"value\":4},{\"source\":3,\"target\":5,\"value\":2},{\"source\":3,\"target\":5,\"value\":4},{\"source\":4,\"target\":1,\"value\":5},{\"source\":4,\"target\":5,\"value\":1},{\"source\":5,\"target\":5,\"value\":2},{\"source\":5,\"target\":5,\"value\":1},{\"source\":5,\"target\":3,\"value\":5},{\"source\":4,\"target\":4,\"value\":3},{\"source\":2,\"target\":2,\"value\":5},{\"source\":3,\"target\":1,\"value\":5},{\"source\":1,\"target\":5,\"value\":2}]}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "capistrano"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2450797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jdptR.jpg?s=128&g=1", "display_name": "denstepa", "link": "https://stackoverflow.com/users/2450797/denstepa"}, "is_accepted": false, "score": 1, "last_activity_date": 1433925151, "creation_date": 1433925151, "answer_id": 30751100, "question_id": 30750524, "link": "https://stackoverflow.com/questions/30750524/where-is-capistrano-3s-deploycold-defined/30751100#30751100", "title": "Where is Capistrano 3&#39;s `deploy:cold` defined?", "body": "<p>actually there's no such task in capistrano 3.\nYou can see all task with command: </p>\n\n<pre><code>cap -T\n</code></pre>\n\n<p>for deploying i usually start with </p>\n\n<pre><code>cap production setup # Server setup tasks\ncap production deploy:check # Check required files and directories exist\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3724, "user_id": 2409515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a33T6.jpg?s=128&g=1", "display_name": "Rokibul Hasan", "link": "https://stackoverflow.com/users/2409515/rokibul-hasan"}, "is_accepted": false, "score": 1, "last_activity_date": 1433935838, "creation_date": 1433935838, "answer_id": 30755002, "question_id": 30750524, "link": "https://stackoverflow.com/questions/30750524/where-is-capistrano-3s-deploycold-defined/30755002#30755002", "title": "Where is Capistrano 3&#39;s `deploy:cold` defined?", "body": "<p>There is no such task like <code>deploy:cold</code> in <code>capistrano 3</code> rather you can use the following command for the same thing </p>\n\n<pre><code>bundle exec cap production deploy setup\n</code></pre>\n\n<p>You can read the task definition in the lib files located in </p>\n\n<pre><code>lib/capistrano/tasks/deploy.rake\n</code></pre>\n"}], "owner": {"reputation": 7734, "user_id": 2490003, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/3dRD0.png?s=128&g=1", "display_name": "user2490003", "link": "https://stackoverflow.com/users/2490003/user2490003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1433935838, "creation_date": 1433923357, "question_id": 30750524, "link": "https://stackoverflow.com/questions/30750524/where-is-capistrano-3s-deploycold-defined", "title": "Where is Capistrano 3&#39;s `deploy:cold` defined?", "body": "<p>Capistrano on the whole is a very useful tool, but the definitions are so modular and distributed it can be difficult (or near impossible) to find the definition of a task when needed, or easily piece together the order of events.</p>\n\n<p>I had only vaguely worked with Capistrano before v3, and I recall there being a \"cold deploy\" task.</p>\n\n<p>However, I can't seem to find it anywhere within the capistrano repository, nor within any of the plugins (<code>capistrano/rvm</code>, <code>capistrano/bundler</code>, <code>capistrano/rails</code>, etc...). A <a href=\"https://github.com/capistrano/capistrano/search?utf8=%E2%9C%93&amp;q=cold\" rel=\"nofollow\">simple repository search for the term 'cold' yields nothing</a></p>\n\n<p>Where is this task defined? Does it exist in Capistrano v3? And is there an easy way to visualize all the tasks, in order, that run when I execute a certain command (e.g. <code>bundle exec cap production deploy</code> would list all 10,000+ deploy tasks)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 19, "user_id": 4840699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f98ed42ea2d35ee9ed693c6710ed9128?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan Kumar IL", "link": "https://stackoverflow.com/users/4840699/chethan-kumar-il"}, "reply_to_user": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433922453, "post_id": 30750155, "comment_id": 49554675, "body": "but here the process exited with status 0 .is that same , i will try it thanks for reply"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4840699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f98ed42ea2d35ee9ed693c6710ed9128?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan Kumar IL", "link": "https://stackoverflow.com/users/4840699/chethan-kumar-il"}, "edited": false, "score": 0, "creation_date": 1434024115, "post_id": 30751309, "comment_id": 49610338, "body": "source &#39;<a href=\"https://rubygems.org\" rel=\"nofollow noreferrer\">rubygems.org</a>&#39;  gem &#39;rails&#39;, &#39;3.2.3&#39;  # Bundle edge Rails instead: # gem &#39;rails&#39;, :git =&gt; &#39;git://github.com/rails/rails.git&#39;   gem &#39;mysql2&#39; gem &#39;rake&#39;, &#39;=0.9.2.2&#39; gem &quot;breadcrumbs_on_rails&quot; # Gems used only for assets and not required # in production environments by default. group :assets do   gem &#39;sass-rails&#39;,   &#39;~&gt; 3.2.3&#39;   gem &#39;coffee-rails&#39;, &#39;~&gt; 3.2.1&#39;    # See <a href=\"https://github.com/sstephenson/execjs#readme\" rel=\"nofollow noreferrer\">github.com/sstephenson/execjs#readme</a> for more supported runtimes   # gem &#39;therubyracer&#39;, :platform =&gt; :ruby    gem &#39;uglifier&#39;, &#39;&gt;= 1.0.3&#39; end"}, {"owner": {"reputation": 19, "user_id": 4840699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f98ed42ea2d35ee9ed693c6710ed9128?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan Kumar IL", "link": "https://stackoverflow.com/users/4840699/chethan-kumar-il"}, "edited": false, "score": 0, "creation_date": 1434024170, "post_id": 30751309, "comment_id": 49610378, "body": "gem &#39;jquery-rails&#39; gem &#39;execjs&#39; gem &#39;therubyracer&#39; gem &#39;paperclip&#39;,&quot;~&gt; 2.3&quot; gem &#39;event-calendar&#39;, :require =&gt; &#39;event_calendar&#39;  gem &quot;authlogic&quot;, &#39;3.1.0&#39; gem &quot;rails3-generators&quot; gem &#39;paperclip&#39;,&quot;~&gt; 2.3&quot; gem &quot;ckeditor&quot;, &quot;3.7.3&quot; gem &#39;wkhtmltopdf-binary&#39; gem &#39;will_paginate&#39;, &#39;~&gt; 3.0&#39; gem &#39;calendar_date_select&#39;, :git =&gt; &#39;<a href=\"http://github.com/paneq/calendar_date_select.git\" rel=\"nofollow noreferrer\">github.com/paneq/calendar_date_select.git</a>&#39; gem &quot;dynamic_form&quot;, &quot;~&gt; 1.1.4&quot; gem &quot;wicked_pdf&quot;, &quot;~&gt; 0.9.4&quot; gem &#39;will_paginate-bootstrap&#39;"}, {"owner": {"reputation": 19, "user_id": 4840699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f98ed42ea2d35ee9ed693c6710ed9128?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan Kumar IL", "link": "https://stackoverflow.com/users/4840699/chethan-kumar-il"}, "edited": false, "score": 0, "creation_date": 1434024191, "post_id": 30751309, "comment_id": 49610394, "body": "gem &#39;turbolinks&#39; # To use ActiveModel has_secure_password # gem &#39;bcrypt-ruby&#39;, &#39;~&gt; 3.0.0&#39;  # To use Jbuilder templates for JSON # gem &#39;jbuilder&#39;  # Use unicorn as the app server # gem &#39;unicorn&#39;  # Deploy with Capistrano # gem &#39;capistrano&#39;  # To use debugger # gem &#39;ruby-debug19&#39;, :require =&gt; &#39;ruby-debug&#39; gem &quot;private_pub&quot; gem &quot;faye&quot;  group :production do gem &#39;thin&#39; gem &#39;pg&#39; gem &#39;rails_12factor&#39; end group :test do   # Pretty printed test output   gem &#39;turn&#39;, :require =&gt; false end"}], "tags": [], "owner": {"reputation": 11, "user_id": 2450797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jdptR.jpg?s=128&g=1", "display_name": "denstepa", "link": "https://stackoverflow.com/users/2450797/denstepa"}, "is_accepted": false, "score": 0, "last_activity_date": 1433925740, "creation_date": 1433925740, "answer_id": 30751309, "question_id": 30750155, "link": "https://stackoverflow.com/questions/30750155/css-and-javascripts-not-loading-in-heroku-after-deployed-to-heroku/30751309#30751309", "title": "css and javascripts not loading in heroku after deployed to heroku", "body": "<p>What version of rails are you useing?</p>\n\n<p>Did you add 'rails_12factor' gem to your Gemfile ?</p>\n"}], "owner": {"reputation": 19, "user_id": 4840699, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f98ed42ea2d35ee9ed693c6710ed9128?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan Kumar IL", "link": "https://stackoverflow.com/users/4840699/chethan-kumar-il"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433926921, "creation_date": 1433922250, "last_edit_date": 1433922329, "question_id": 30750155, "link": "https://stackoverflow.com/questions/30750155/css-and-javascripts-not-loading-in-heroku-after-deployed-to-heroku", "title": "css and javascripts not loading in heroku after deployed to heroku", "body": "<p>css and java scripts are not loading in <strong>heroku</strong> , once i run the application i am getting like this in the backend </p>\n\n<p>2015-06-09T13:36:38.985035+00:00 heroku[web.1]: State changed from up to starting\n2015-06-09T13:36:41.933838+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2015-06-09T13:36:44.109165+00:00 heroku[web.1]: Process exited with status 0\n2015-06-09T13:36:46.815199+00:00 heroku[web.1]: Starting process with command <code>bundle exec thin start -R config.ru -e production -p 56008</code>\n2015-06-09T13:36:52.415454+00:00 heroku[web.1]: State changed from starting to up</p>\n\n<p>i am getting <strong>Stopping all processes with SIGTERM</strong>  <strong>Process exited with status 0</strong> please suggest me how to correct it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433920399, "post_id": 30749478, "comment_id": 49553288, "body": "<code>config.generators.stylesheets = false config.generators.javascripts = false</code> add in application.rb and it will not generate stylesheets and javascripts"}, {"owner": {"reputation": 1395, "user_id": 1658796, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6cdcc36f7302b72109e2b231c3f9f39c?s=128&d=identicon&r=PG", "display_name": "Chris Valentine", "link": "https://stackoverflow.com/users/1658796/chris-valentine"}, "reply_to_user": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433920449, "post_id": 30749478, "comment_id": 49553322, "body": "wow thanks and fast."}], "answers": [{"comments": [{"owner": {"reputation": 1395, "user_id": 1658796, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6cdcc36f7302b72109e2b231c3f9f39c?s=128&d=identicon&r=PG", "display_name": "Chris Valentine", "link": "https://stackoverflow.com/users/1658796/chris-valentine"}, "edited": false, "score": 0, "creation_date": 1433921384, "post_id": 30749537, "comment_id": 49553962, "body": "this was a good answer, but I marked the other since this one is deprecated now."}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "reply_to_user": {"reputation": 1395, "user_id": 1658796, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6cdcc36f7302b72109e2b231c3f9f39c?s=128&d=identicon&r=PG", "display_name": "Chris Valentine", "link": "https://stackoverflow.com/users/1658796/chris-valentine"}, "edited": false, "score": 0, "creation_date": 1433921672, "post_id": 30749537, "comment_id": 49554164, "body": "you can check other one"}], "tags": [], "owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "is_accepted": false, "score": 2, "last_activity_date": 1433921663, "last_edit_date": 1433921663, "creation_date": 1433920477, "answer_id": 30749537, "question_id": 30749478, "link": "https://stackoverflow.com/questions/30749478/set-defaults-for-generator-per-application/30749537#30749537", "title": "Set defaults for generator per application", "body": "<pre><code>config.generators.stylesheets = false \nconfig.generators.javascripts = false\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>config.generators.assets = false\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>rails g controller foo --skip-assets\n</code></pre>\n\n<p>add to application.rb</p>\n"}, {"comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 1395, "user_id": 1658796, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6cdcc36f7302b72109e2b231c3f9f39c?s=128&d=identicon&r=PG", "display_name": "Chris Valentine", "link": "https://stackoverflow.com/users/1658796/chris-valentine"}, "edited": false, "score": 0, "creation_date": 1433921207, "post_id": 30749665, "comment_id": 49553850, "body": "The config.generators block goes back to 3.0 I think. Not sure how long the stylesheets option has been there but it is described in the 3.2 version of the configuring rails app guide"}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 3, "last_activity_date": 1433921382, "last_edit_date": 1433921382, "creation_date": 1433920856, "answer_id": 30749665, "question_id": 30749478, "link": "https://stackoverflow.com/questions/30749478/set-defaults-for-generator-per-application/30749665#30749665", "title": "Set defaults for generator per application", "body": "<p>The generators can be configured in application.rb, in the <code>config.generators</code> block, in particular</p>\n\n<pre><code>config.generators do |g|\n  g.stylesheets false\nend\n</code></pre>\n\n<p>Will suppress generation of stylesheets. You can read about the other options available in the <a href=\"http://guides.rubyonrails.org/configuring.html#configuring-generators\" rel=\"nofollow\">configuring rails applications</a> guide.</p>\n"}], "owner": {"reputation": 1395, "user_id": 1658796, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6cdcc36f7302b72109e2b231c3f9f39c?s=128&d=identicon&r=PG", "display_name": "Chris Valentine", "link": "https://stackoverflow.com/users/1658796/chris-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 2, "accepted_answer_id": 30749665, "answer_count": 2, "score": 0, "last_activity_date": 1433921663, "creation_date": 1433920289, "question_id": 30749478, "link": "https://stackoverflow.com/questions/30749478/set-defaults-for-generator-per-application", "title": "Set defaults for generator per application", "body": "<p><strong>Is there way to set a default flag for all generator commands in a specific app?</strong></p>\n\n<p>With Rubygems you can save the --no-rdoc to the .gemrc file and it will then apply that to all your gem commands later.</p>\n\n<p>Can you do this with rails generate, so that a flag, such as --no-stylesheets is applied to all rails g scaffold commands for the life of that app?</p>\n\n<pre><code>rails g scaffold Model field field2 field3 --no-stylesheets\n</code></pre>\n\n<p>If I'm using boostrap/foundation I know from the very beginning I don't want that ever generated for the app, seems a waste to have to type it every time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3397, "user_id": 2563282, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/nCJrZ.jpg?s=128&g=1", "display_name": "G.B", "link": "https://stackoverflow.com/users/2563282/g-b"}, "edited": false, "score": 1, "creation_date": 1433919486, "post_id": 30748947, "comment_id": 49552688, "body": "did you reset your server ?"}, {"owner": {"reputation": 3397, "user_id": 2563282, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/nCJrZ.jpg?s=128&g=1", "display_name": "G.B", "link": "https://stackoverflow.com/users/2563282/g-b"}, "edited": false, "score": 0, "creation_date": 1433919503, "post_id": 30748947, "comment_id": 49552700, "body": "and where is <code>Simulator</code> file placed ?"}, {"owner": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "edited": false, "score": 0, "creation_date": 1433921015, "post_id": 30748947, "comment_id": 49553718, "body": "Yes, and can you include the contents of that file?"}, {"owner": {"reputation": 66, "user_id": 4993506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nl54rRfYk6A/AAAAAAAAAAI/AAAAAAAAABI/OwB3UxvVMkY/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u0422\u0438\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/4993506/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%a2%d0%b8%d1%82%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1433950208, "post_id": 30748947, "comment_id": 49574455, "body": "It&#39;s okey with Simulator class and path to this file (it is in root app&#39;s folder with other files, which it uses).  I launched this code with ruby in console (ruby simulator.rb) and it works fine. About Rails problem: Full error message is: &quot;Undefines symbol in GameController::Simulator&quot;. I think, there are problems in namespaces. Now i am reading about ActiveSupprot::Dependencies."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1433950576, "post_id": 30748947, "comment_id": 49574707, "body": "place it in lib not root and then add lib to autoload_paths or require the file where needed eg. <code>require Rails.root.join(&quot;lib&quot;,&quot;your_file_name&quot;).to_s</code>"}, {"owner": {"reputation": 66, "user_id": 4993506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nl54rRfYk6A/AAAAAAAAAAI/AAAAAAAAABI/OwB3UxvVMkY/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u0422\u0438\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/4993506/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%a2%d0%b8%d1%82%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1433964053, "post_id": 30748947, "comment_id": 49583160, "body": "Now, it&#39;s work, but very strange. As define, Simulator uses 2 files as input. And Controller presets these 2 files. And after that Controller calls Simulator.  Now: When files are updated(it&#39;s ok), Simulator working, like he had old versions of these files. (it&#39;s not ok).  I found very funny solution(but this is not what I&#39;m looking for): &quot;system(&#39;ruby D:\\AI&#91;AI]Processing\\cmd.rb&#39;)&quot;"}, {"owner": {"reputation": 66, "user_id": 4993506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nl54rRfYk6A/AAAAAAAAAAI/AAAAAAAAABI/OwB3UxvVMkY/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u0422\u0438\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/4993506/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%a2%d0%b8%d1%82%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1434003600, "post_id": 30748947, "comment_id": 49596875, "body": "I need to reload input files every times, when Simulator start working (with Controller Actions). How to do this?"}], "owner": {"reputation": 66, "user_id": 4993506, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Nl54rRfYk6A/AAAAAAAAAAI/AAAAAAAAABI/OwB3UxvVMkY/photo.jpg?sz=128", "display_name": "\u0410\u043b\u0435\u043a\u0441\u0435\u0439 \u0422\u0438\u0442\u043e\u0432", "link": "https://stackoverflow.com/users/4993506/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b9-%d0%a2%d0%b8%d1%82%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433950443, "creation_date": 1433918758, "last_edit_date": 1433950443, "question_id": 30748947, "link": "https://stackoverflow.com/questions/30748947/name-error-unitialized-constant", "title": "Name Error | Unitialized constant", "body": "<p>Description:\nI have a <strong>file with code in Ruby with Class <code>Simulator</code></strong>, which <strong>include some other files with many other classes</strong>.\nNow, I am trying to <strong>use class <code>Simulator</code> in my Rails app</strong>. More precisely, in controller. These classes are correct.</p>\n\n<p>I am trying to create <code>Simulator</code> object and call method for that in my controller.</p>\n\n<p>Every time, I get an error </p>\n\n<blockquote>\n  <p>\"Unitialized constant\" for Simulator, or for classes that it uses.</p>\n</blockquote>\n\n<p>I tried many things, like:</p>\n\n<ol>\n<li><code>config.autoload_paths +=</code></li>\n<li><code>require_dependence \"simulator.rb\"</code></li>\n<li><code>config.cache_classes = false</code></li>\n</ol>\n\n<p>But it still does not work.</p>\n\n<p><strong>Format of simulator.rb</strong></p>\n\n<pre><code>require 'other_classes...'\nclass Simulator\n   \"Using other_classes\"\n   \"Some specific methods\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing"], "answers": [{"comments": [{"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433920121, "post_id": 30749399, "comment_id": 49553095, "body": "I did so but this did not help. Thanks for the link - I will have a look."}, {"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433920464, "post_id": 30749399, "comment_id": 49553337, "body": "According to your link on uniqueness I tried &quot;uniqueness: { case_sensitive: false }&quot; which also fails"}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433920918, "post_id": 30749399, "comment_id": 49553656, "body": "That&#39;s interesting. I just checked Hartl&#39;s implementation and <code>uniqueness: { case_sensitive: false }</code> should work. Can you post how you created <code>@user</code> in your test?"}, {"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433921556, "post_id": 30749399, "comment_id": 49554071, "body": "require &#39;test_helper&#39;      class UserTest &lt; ActiveSupport::TestCase    \tdef setup \t\t@user = User.new(name: &quot;Example User&quot;, email: &quot;user@example.com&quot;) \tend"}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433922987, "post_id": 30749399, "comment_id": 49555009, "body": "Have you tried saving the initial @user to the test database by calling <code>create</code> instead of <code>new</code>? I think this should work, because when the <code>duplicate_user</code> is being saved, it has nothing to compare to when Rails looks in the test db for records to compare for uniqueness. Hope that does it."}, {"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433923976, "post_id": 30749399, "comment_id": 49555684, "body": "Is it possible that the error arises because I used MySQL instead on SQLight?"}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433924128, "post_id": 30749399, "comment_id": 49555787, "body": "Oh that could be a possibility. Did you make sure to update your <code>config&#47;database.yml</code> test adapter to use mysql instead of sqlite?"}, {"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433924891, "post_id": 30749399, "comment_id": 49556253, "body": "Sorry about that - I just saw in config.yml that I&#39;m using SQLite3 not only for testing but also for the application...."}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433924956, "post_id": 30749399, "comment_id": 49556284, "body": "It&#39;s no problem :) Let me know if that worked so I could update the answer for anyone else who might see this in the future."}, {"owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "edited": false, "score": 0, "creation_date": 1433937104, "post_id": 30749399, "comment_id": 49564205, "body": "now it works - nothing changed afaik - can&#39;t tell why. Thanks for your help"}], "tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": false, "score": 1, "last_activity_date": 1433921351, "last_edit_date": 1433921351, "creation_date": 1433920043, "answer_id": 30749399, "question_id": 30748878, "link": "https://stackoverflow.com/questions/30748878/rails-test-fails-hartl-tutorial-ch-6-page-256-257/30749399#30749399", "title": "Rails Test Fails - Hartl Tutorial Ch. 6 Page 256/257", "body": "<p>Try enveloping <code>case_sensitive</code> in brackets, like so:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 },\n                  format: { with: VALID_EMAIL_REGEX },\n                  uniqueness: { case_sensitive: false }\nend\n</code></pre>\n\n<p>More info on <code>uniqueness</code> <a href=\"http://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow\">here</a></p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5437703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/818550f41e18bab29f9edecab8d79056?s=128&d=identicon&r=PG&f=1", "display_name": "M K", "link": "https://stackoverflow.com/users/5437703/m-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1452218997, "creation_date": 1452218997, "answer_id": 34668393, "question_id": 30748878, "link": "https://stackoverflow.com/questions/30748878/rails-test-fails-hartl-tutorial-ch-6-page-256-257/34668393#34668393", "title": "Rails Test Fails - Hartl Tutorial Ch. 6 Page 256/257", "body": "<p>the problem may be because you might have included the line\nattr_accessor :name, :email in the user model.</p>\n\n<p>If you remove that line then there should not be any error.</p>\n\n<p>Hope this will help</p>\n"}], "owner": {"reputation": 1178, "user_id": 2656732, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/F6V3N.jpg?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/2656732/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452218997, "creation_date": 1433918485, "last_edit_date": 1433936163, "question_id": 30748878, "link": "https://stackoverflow.com/questions/30748878/rails-test-fails-hartl-tutorial-ch-6-page-256-257", "title": "Rails Test Fails - Hartl Tutorial Ch. 6 Page 256/257", "body": "<p>According to Hartl uniqueness: is infered by Ruby as true in ruby.rb.\nNevertheless my test only passes when I set it to false explicetly.\nCan you spot the error?</p>\n\n<p>The REGEX part is correct - it is only about this line:\n uniqueness: case_sensitive: false</p>\n\n<p>Test:</p>\n\n<pre><code>test \"email addresses should be unique\" do\n    duplicate_user = @user.dup\n    duplicate_user.email = @user.email.upcase\n    @user.save\n    assert_not duplicate_user.valid?\nend\n</code></pre>\n\n<p>Model: (ruby.rb)</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, length: { maximum: 255 },\n                  format: { with: VALID_EMAIL_REGEX },\n                  uniqueness: { case_sensitive: false }\nend\n</code></pre>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "mysql-connector"], "answers": [{"tags": [], "owner": {"reputation": 1615, "user_id": 2524123, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gVqbX.jpg?s=128&g=1", "display_name": "rick", "link": "https://stackoverflow.com/users/2524123/rick"}, "is_accepted": false, "score": 0, "last_activity_date": 1433916403, "last_edit_date": 1433916403, "creation_date": 1433915269, "answer_id": 30748042, "question_id": 30747849, "link": "https://stackoverflow.com/questions/30747849/fresh-ruby-on-rails-install-on-windows-msql-gem-not-working/30748042#30748042", "title": "Fresh Ruby on Rails Install on Windows: MSQL Gem Not Working", "body": "<p>Follow this steps,</p>\n\n<ul>\n<li><code>gem uninstall mysql2</code></li>\n<li>Download last MySQL connector from <a href=\"http://cdn.mysql.com/Downloads/Connector-C/mysql-connector-c-noinstall-6.0.2-win32.zip\" rel=\"nofollow\">http://cdn.mysql.com/Downloads/Connector-C/mysql-connector-c-noinstall-6.0.2-win32.zip</a></li>\n<li>Extract it to C:\\connector-6.0.2</li>\n<li><code>gem install mysql2 --platform=ruby -- '--with-mysql-lib=\"C:\\connector-6.0.2\\lib\" --with-mysql-include=\"C:\\connector-6.0.2\\include\" --with-mysql-dir=\"C:\\connector-6.0.2\"'</code></li>\n</ul>\n\n<p>or you can use this shroter,</p>\n\n<pre><code>gem install mysql2 --platform=ruby -- --with-opt-dir=\"C:\\connector-6.0.2\"\n</code></pre>\n\n<p>Let me know if this will solve your problem.</p>\n"}], "owner": {"reputation": 1205, "user_id": 1029091, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e69031ba9491ab832d8dd33b23f2fa72?s=128&d=identicon&r=PG", "display_name": "Mr A", "link": "https://stackoverflow.com/users/1029091/mr-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433916403, "creation_date": 1433914473, "question_id": 30747849, "link": "https://stackoverflow.com/questions/30747849/fresh-ruby-on-rails-install-on-windows-msql-gem-not-working", "title": "Fresh Ruby on Rails Install on Windows: MSQL Gem Not Working", "body": "<p>I need to install Ruby on Windows in order to access the project I am going to work on. I followed the instructions <a href=\"https://www.youtube.com/watch?v=2eRPom3rap4\" rel=\"nofollow\">here</a> on installing it but when I get to write the scaffolding (12:50), I get the error below. </p>\n\n<p><strong>Note:</strong> I did the instructions as mentioned in the video. The only difference is that instead of installing a dedicated MySQL in my computer, I am using the MySQL I have on my XAMPP installation. </p>\n\n<pre><code>C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.18-x86-mingw32/lib/mysql2/mysql2.rb:2:in `require': cannot load such file -- mysql2/2.2/mysql2 (LoadError)\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.18-x86-mingw32/lib/mysql2/mysql2.rb:2:in `&lt;top (required)&gt;'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.18-x86-mingw32/lib/mysql2.rb:31:in `require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/mysql2-0.3.18-x86-mingw32/lib/mysql2.rb:31:in `&lt;top (required)&gt;'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:76:in `require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:76:in `block (2 levels) in require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:72:in `each'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:72:in `block in require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:61:in `each'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler/runtime.rb:61:in `require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/bundler-1.10.3/lib/bundler.rb:134:in `require'\n    from C:/row/dev/hello_world/config/application.rb:7:in `&lt;top (required)&gt;'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:141:in `require'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:141:in `require_application_and_environment!'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:128:in `generate_or_destroy'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:50:in `generate'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands/commands_tasks.rb:39:in `run_command!'\n    from C:/row/Ruby22/lib/ruby/gems/2.2.0/gems/railties-4.2.1/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n    from bin/rails:4:in `require'\n    from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any advise on how to diagnose this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 1, "creation_date": 1433914100, "post_id": 30747713, "comment_id": 49550147, "body": "You don&#39;t &quot;convert&quot; a date time object.  You <i>display</i> it&#39;s value.  Display it with a particular format, with respect to a particular time zone.  The DateTime method is <code>strftime( format )</code>: <a href=\"https://hackhands.com/format-datetime-ruby/\" rel=\"nofollow noreferrer\">hackhands.com/format-datetime-ruby</a>"}, {"owner": {"reputation": 6503, "user_id": 3675188, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/38ad90bb6d16a1a2201cf88699d0ebf9?s=128&d=identicon&r=PG&f=1", "display_name": "user3675188", "link": "https://stackoverflow.com/users/3675188/user3675188"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1433914235, "post_id": 30747713, "comment_id": 49550200, "body": "sorry for my poor concept"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1433916961, "post_id": 30747713, "comment_id": 49551313, "body": "I expect you will select @Arup&#39;s answer, because it&#39;s the most direct approach, and also because it&#39;s likely to be the only answer. (The alternative is to pull out each piece of the string and join them, which is clunky and unnecessary.) Even so, I suggest you hold off selecting his (or another) answer for awhile.  This is my advice for any question you might post.  There&#39;s no rush, and there are at least two reasons to wait: 1) you don&#39;t want to discourage other (possibly better) answers; and 2) it&#39;s discourteous (imo) to select an answer while some  readers are still preparing theirs."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1433923371, "post_id": 30747713, "comment_id": 49555263, "body": "@paulsm4 You convert date time to a string. Then, you display it. <code>strftime</code> creates a new instance of a string."}], "answers": [{"comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 2, "creation_date": 1433919676, "post_id": 30747737, "comment_id": 49552811, "body": "@Arup : I suggest add one more option <code>(&quot;%a, %d %B %Y&quot;)</code> for full month as OP has mention in expected output full month <code>July</code> instead <code>Jul</code>"}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 5, "last_activity_date": 1433920367, "last_edit_date": 1433920367, "creation_date": 1433914004, "answer_id": 30747737, "question_id": 30747713, "link": "https://stackoverflow.com/questions/30747713/how-do-i-convert-datetime-to-this-format-weekday-day-month-year/30747737#30747737", "title": "How do I convert datetime to this format `WEEKDAY, DAY MONTH YEAR`", "body": "<p>You should use the format string:</p>\n\n<pre><code>require 'date'\n\nDateTime.now.strftime(\"%a, %d %b %Y\")\n# =&gt; \"Wed, 10 Jun 2015\"\nDateTime.now.strftime(\"%a, %d %B %Y\")\n# =&gt; \"Wed, 10 June 2015\"\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 3675188, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/38ad90bb6d16a1a2201cf88699d0ebf9?s=128&d=identicon&r=PG&f=1", "display_name": "user3675188", "link": "https://stackoverflow.com/users/3675188/user3675188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433920720, "creation_date": 1433913853, "question_id": 30747713, "link": "https://stackoverflow.com/questions/30747713/how-do-i-convert-datetime-to-this-format-weekday-day-month-year", "title": "How do I convert datetime to this format `WEEKDAY, DAY MONTH YEAR`", "body": "<p>How do I convert datetime object to this format <code>Thu, 02 July 2015</code></p>\n\n<p>That is <code>WEEKDAY, DAY MONTH YEAR</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433913396, "post_id": 30747468, "comment_id": 49549930, "body": "You want to delete movies or posters ? I got confused about that.. :)"}, {"owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433947880, "post_id": 30747468, "comment_id": 49572654, "body": "I want to delete posters"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "is_accepted": false, "score": 2, "last_activity_date": 1433922520, "last_edit_date": 1433922520, "creation_date": 1433913067, "answer_id": 30747554, "question_id": 30747468, "link": "https://stackoverflow.com/questions/30747468/undefined-method-for-relation-issue/30747554#30747554", "title": "Undefined method for relation issue", "body": "<p>movie.rb</p>\n\n<pre><code>has_many :posters, dependent: destroy\n</code></pre>\n\n<p>poster.rb</p>\n\n<pre><code>belongs_to :movie\n</code></pre>\n\n<p>task file</p>\n\n<pre><code>task remove_faked: :environment do\n   destroyed = Movie.include(:posters).where(fake: true).where(\"created_at &lt; ?\",  1.minute.ago).destroy_all\n   puts \"Done. #{destroyed.length} records deleted.\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 4915627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tgy1p.jpg?s=128&g=1", "display_name": "Darpa", "link": "https://stackoverflow.com/users/4915627/darpa"}, "is_accepted": false, "score": 0, "last_activity_date": 1433922166, "creation_date": 1433922166, "answer_id": 30750123, "question_id": 30747468, "link": "https://stackoverflow.com/questions/30747468/undefined-method-for-relation-issue/30750123#30750123", "title": "Undefined method for relation issue", "body": "<p>Replace    </p>\n\n<pre><code>destroyed = Movie.where(fake: true).posters.where(\"created_at &lt; ?\",  1.minute.ago).destroy_all\n</code></pre>\n\n<p>with</p>\n\n<pre><code>destroyed = Movie.includes(:posters).where(\"fake = ? &amp;&amp; posters.created_at &lt; ?\", true, 1.minute.ago).references(:posters).destroy_all\n</code></pre>\n\n<p>This only destroys fake movies that satisfy the given conditions. If you have used the dependent: :destroy option for movies, in that case the posters belonging to a movie that is being destroyed will be destroyed along with the movie.</p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 0, "last_activity_date": 1433952023, "last_edit_date": 1433952023, "creation_date": 1433951647, "answer_id": 30761369, "question_id": 30747468, "link": "https://stackoverflow.com/questions/30747468/undefined-method-for-relation-issue/30761369#30761369", "title": "Undefined method for relation issue", "body": "<p>Since your comments seem to suggest that you only want to destroy the <code>Poster</code>s and not the <code>Movie</code>s try this:</p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n  has_many :posters      \nend\n\nclass Poster &lt; ActiveRecord::Base\n  belongs_to :movie\n\n  scope :for_fake_movie, -&gt;{ joins(:movie).where(movie:{fake: true}) }\n  scope :since,-&gt;(time_frame){where(\"created_at &lt; ?\", time_frame)}\nend\n</code></pre>\n\n<p>Then the task would look like this </p>\n\n<pre><code>task remove_faked: :environment do\n   destroyed = Poster.for_fake_movie.since(1.minute.ago).destroy_all\n   puts \"Done. #{destroyed.length} records deleted.\"\nend\n</code></pre>\n\n<p>Scoping makes code much clearer and helps move the business logic into the model rather than cluttering controllers, views and in this case rake tasks. If you wanted to delete the movies too I would go with </p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n  has_many :posters, dependent: :destroy \n\n  scope :fake, -&gt;{where(fake: true) }\n  scope :posters_since, -&gt;(time_frame){joins(:posters).where(\"posters.created_at &lt; ?\", time_frame)}\nend\n\nclass Poster &lt; ActiveRecord::Base\n  belongs_to :movie\nend\n</code></pre>\n\n<p>Then the task would be </p>\n\n<pre><code>task remove_faked: :environment do\n   destroyed = Movie.fake.posters_since(1.minute.ago).destroy_all\n   puts \"Done. #{destroyed.length} records deleted.\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "is_accepted": false, "score": 0, "last_activity_date": 1433952672, "creation_date": 1433952672, "answer_id": 30761764, "question_id": 30747468, "link": "https://stackoverflow.com/questions/30747468/undefined-method-for-relation-issue/30761764#30761764", "title": "Undefined method for relation issue", "body": "<p><code>where</code> results in a set of objects. Your <code>posters</code> association is defined on an object itself, so it cannot be applied this way.</p>\n\n<p>I would rather delve into some details about how RDBMSs work.</p>\n\n<p>First of all, I follow a simple rule: query the class instances of which you want to receive. You want <code>Poster</code>s here, but you are querying <code>Movie</code>s. I'm going to do the other way round and query <code>Poster</code>s instead.</p>\n\n<p>You have a powerful concept of <strong>join</strong> in your database, that, obviously, joins rows from two tables together on a specific condition. You could think of it as it takes each pair of rows, checks the condition, and if it's true, puts the combination into the internal buffer. We will still be selecting only posters' fields, but now we can use movies' fields too:</p>\n\n<pre><code>Poster.joins(:movie) # singular, as in association, belongs_to in this case\n</code></pre>\n\n<p>This changes... nothing so far. But now it allows you to impose some conditions on posters, based on associated movies.</p>\n\n<p><code>merge</code> does that, it applies a scope, possibly even from a different model. Without a join that would have given invalid SQL. Not this time!</p>\n\n<pre><code>Poster.joins(:movie).merge(Movie.where(fake: true))\n</code></pre>\n\n<p>What we get here is posters that belong to a movie that has <code>fake: true</code>. Wow, eh? Not just slap your own condition on top of it and do your thing:</p>\n\n<pre><code>Poster.joins(:movie)\n      .merge(Movie.where(fake: true))\n      .where(\"created_at &lt; ?\",  1.minute.ago)\n      .destroy_all\n</code></pre>\n"}], "owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1434047785, "answer_count": 4, "score": 0, "last_activity_date": 1433952672, "creation_date": 1433912616, "question_id": 30747468, "link": "https://stackoverflow.com/questions/30747468/undefined-method-for-relation-issue", "closed_reason": "Duplicate", "title": "Undefined method for relation issue", "body": "<p>I have a standard has_many/belongs_to association in a rails 4 app.</p>\n\n<p>Here's my rake code:</p>\n\n<pre><code>task remove_faked: :environment do\n   destroyed = Movie.where(fake: true).posters.where(\"created_at &lt; ?\",  1.minute.ago).destroy_all\n   puts \"Done. #{destroyed.length} records deleted.\"\nend\n</code></pre>\n\n<p>but I get the error: <code>undefined method posters for #&lt;Movie::ActiveRecord_Relation</code></p>\n\n<p>I checked <code>Poster.last</code> in my console and it has an associated movie_id with a corresponding movie id. I can also do associations within my app like Poster.all.where(movie_id: @movie.id) fine.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redirect", "scope"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 3, "creation_date": 1433911690, "post_id": 30747289, "comment_id": 49549382, "body": "Well, what is your problem ? What is not working?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4993153"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1433913704, "post_id": 30747289, "comment_id": 49550018, "body": "I dont know how redirect to the index view when the person make the research on another page, like show view."}, {"owner": {"reputation": 1219, "user_id": 2463608, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/71a718079ab00b87628fd52df9eb6e42?s=128&d=identicon&r=PG", "display_name": "Daiku", "link": "https://stackoverflow.com/users/2463608/daiku"}, "edited": false, "score": 0, "creation_date": 1433944133, "post_id": 30747289, "comment_id": 49569655, "body": "Show us the error message you are getting.  Or describe what happens instead of the redirect."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4993153"}, "edited": false, "score": 0, "creation_date": 1433970704, "post_id": 30747289, "comment_id": 49586888, "body": "The scope is to filter posts , so obviously it does not work on other pages because the posts are listed in the Index view. The idea is , when someone makes a research on another page , be redirected to Index. But i dont know how redirect."}, {"owner": {"reputation": 34214, "user_id": 1141839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b5c46e3c79ab446329ff05949594cd?s=128&d=identicon&r=PG", "display_name": "PinnyM", "link": "https://stackoverflow.com/users/1141839/pinnym"}, "edited": false, "score": 0, "creation_date": 1433997747, "post_id": 30747289, "comment_id": 49594675, "body": "If this is not an ajax call, there is no need to redirect - the form action should direct the user to this page."}], "owner": {"user_type": "does_not_exist", "display_name": "user4993153"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433995596, "creation_date": 1433911561, "last_edit_date": 1433995596, "question_id": 30747289, "link": "https://stackoverflow.com/questions/30747289/scope-rails-redirect-to-index", "title": "Scope rails redirect to index", "body": "<p>Sorry if this is an easy question, but I've just started to learn Rails.</p>\n\n<p>The app has a scope which works just fine in the Index page.</p>\n\n<p>But I put the search option in the nav bar, so someone can do the search from any page, like show view. I want them to be redirected to the index view with the scope filters.</p>\n\n<p>How do I redirect the user?</p>\n\n<p><strong>Post Controller:</strong></p>\n\n<pre><code>def index\n  @posts = Post.where(nil) # creates an anonymous scope\n  filtering_params(params).each do |key, value|\n    @posts = @posts.public_send(key, value) if value.present?\n  end\nend\n\ndef filtering_params(params)\n  params.slice(:size, :animal, :gender, :starts_with)\nend\n</code></pre>\n\n<p><strong>Post Model:</strong></p>\n\n<pre><code>scope :starts_with, -&gt; (name) { where(\"LOWER(name) like ?\", \"#{name.downcase}%\")}\n</code></pre>\n\n<p><strong>Application view:</strong></p>\n\n<pre><code>&lt;form class=\"navbar-form navbar-left\" role=\"search\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;%= simple_form_for :post, :method =&gt; 'get', :url =&gt; \"/\", :html =&gt; {:class =&gt; 'form-inline'} do |f| %&gt;\n    &lt;%= f.input :starts_with, input_html: { name: 'starts_with', :value =&gt; params[:starts_with] }, label: ('Search:'), :required =&gt; false, :placeholder =&gt; \"Animal name\" %&gt;\n    &lt;%= f.button :submit, ('Search') %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;        \n&lt;/form&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user745235"}, "edited": false, "score": 0, "creation_date": 1433953474, "post_id": 30747209, "comment_id": 49576674, "body": "If I&#39;m not mistaken maybe there is a compatibility option on IE, have you tried that? Also, check the metatag <code>&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot;&#47;&gt;</code> I&#39;m not sure this will fix, it is just a guess =)"}, {"owner": {"reputation": 17529, "user_id": 398606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9922e981f96ab7d809dfdc02c723fd41?s=128&d=identicon&r=PG", "display_name": "Sunil D.", "link": "https://stackoverflow.com/users/398606/sunil-d"}, "edited": false, "score": 1, "creation_date": 1433953720, "post_id": 30747209, "comment_id": 49576833, "body": "It sounds like it&#39;s not able to determine the language from the browser. Have you checked the browser settings or tried this with IE 11 on another computer?"}], "owner": {"reputation": 1, "user_id": 3938573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d7f7827dd21b202228ed7ffe8885f?s=128&d=identicon&r=PG&f=1", "display_name": "Prakash Ramasubramanian", "link": "https://stackoverflow.com/users/3938573/prakash-ramasubramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1433953454, "creation_date": 1433911061, "last_edit_date": 1433953454, "question_id": 30747209, "link": "https://stackoverflow.com/questions/30747209/ie-11-is-not-rendering-attributes-from-en-yml-ruby-file-located-at-config-locale", "title": "IE 11 is not rendering attributes from en.yml ruby file located at config\\locales location", "body": "<p>I have the below Ruby code in an .erb file.</p>\n\n<p><code>&lt;%= label(:product_details_labels, :product_name) %&gt;</code></p>\n\n<p>The labels are defined in <code>en.yml</code> file located at `config\\locales</p>\n\n<p>But the values for these labels are not getting rendered in IE 11 browser and instead I see the label name <strong>product_name</strong> displayed in the website.</p>\n\n<p>This issue is only happening in IE 11 and works fine in IE 9 and Chrome, Firefox browsers. </p>\n\n<p>Any reason why its not rendering in IE11?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 2, "creation_date": 1433912228, "post_id": 30747056, "comment_id": 49549555, "body": "When you write data to a file, that file has to have a certain format. You can invent your own, in which case no-one (including you 6 months later) will know what you wrote; or you can use one of the standard ones, JSON, YAML, XML (all human-readable) or Marshall (not human-readable). Furthermore, it is trivially easy to read/write one of those formats in Ruby, so there is really no reason not to use them unless you are deliberately trying to make things difficult. Do you have any better reason for not wanting to use a standard format beyone &quot;not familiar how either work&quot;?"}, {"owner": {"reputation": 51, "user_id": 4955438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/522c73f9bcd0ee2667fb64d3d3d06b0f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4955438/chris"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1433914682, "post_id": 30747056, "comment_id": 49550355, "body": "@Amadan. Thanks. Makes sense. I&#39;m not against using either of those or learning how they work. But right now I&#39;m trying to work with the data structure that was given with this script because it makes it much easier to import into Neo4j because of how the Neo4j data structure works."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1433914772, "post_id": 30747056, "comment_id": 49550380, "body": "Choosing a standard serialisation format would not change your structure."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1433915551, "post_id": 30747056, "comment_id": 49550670, "body": "Just read it in as YAML (or JSON, or whatever) and manipulate directly as data. Do you have any reason why you would want to read it as lines? What kind of manipulation you want to do in that other script?"}, {"owner": {"reputation": 51, "user_id": 4955438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/522c73f9bcd0ee2667fb64d3d3d06b0f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4955438/chris"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1433915557, "post_id": 30747056, "comment_id": 49550675, "body": "@Amadan Good to know, thanks. And no, I just want to read the entire data block and iterate through it later on."}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "edited": false, "score": 0, "creation_date": 1433938603, "post_id": 30747056, "comment_id": 49565227, "body": "Ruby tip to make your code a bit more expressive: <code>@data.select {|key, _| key == :nodes }.values.flatten.select {|node| node.has_key?(:label) }.each {|node| }</code>"}, {"owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "edited": false, "score": 0, "creation_date": 1433938757, "post_id": 30747056, "comment_id": 49565343, "body": "Also you might want to check out the <code>neo4j</code> / <code>neo4j-core</code> gems.  I&#39;m one of the maintainers and I&#39;m happy to help if you have any questions."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4955438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/522c73f9bcd0ee2667fb64d3d3d06b0f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4955438/chris"}, "edited": false, "score": 0, "creation_date": 1433916482, "post_id": 30747984, "comment_id": 49551092, "body": "Thanks so much for the help and explanation. I had looked at some other YAML examples earlier but couldn&#39;t apply it to this case, seeing your code here really helps."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 1, "last_activity_date": 1433915030, "creation_date": 1433915030, "answer_id": 30747984, "question_id": 30747056, "link": "https://stackoverflow.com/questions/30747056/how-to-read-data-from-a-different-file-without-using-yaml-or-json/30747984#30747984", "title": "How to read data from a different file without using YAML or JSON", "body": "<p>Given that OP said in comments \"I'm not against using either of those\", let's do it in YAML (which preserves the Ruby object structure best). Save it:</p>\n\n<pre><code>@data = {\n        nodes:[\n            {:label=&gt;\"Person\", :title=&gt;\"title_here\", :name=&gt;\"name_here\"}\n        ]\n    } \nrequire 'yaml'\nFile.write('config.yaml', YAML.dump(@data))\n</code></pre>\n\n<p>This will create <code>config.yaml</code>:</p>\n\n<pre><code>---\n:nodes:\n- :label: Person\n  :title: title_here\n  :name: name_here\n</code></pre>\n\n<p>If you read it in, you get exactly what you saved:</p>\n\n<pre><code>require 'yaml'\n@data = YAML.load(File.read('config.yaml'))\nputs @data.inspect\n# =&gt; {:nodes=&gt;[{:label=&gt;\"Person\", :title=&gt;\"title_here\", :name=&gt;\"name_here\"}]}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4955438, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/522c73f9bcd0ee2667fb64d3d3d06b0f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4955438/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 30747984, "answer_count": 1, "score": 0, "last_activity_date": 1433915030, "creation_date": 1433910153, "last_edit_date": 1433910457, "question_id": 30747056, "link": "https://stackoverflow.com/questions/30747056/how-to-read-data-from-a-different-file-without-using-yaml-or-json", "title": "How to read data from a different file without using YAML or JSON", "body": "<p>I'm experimenting with a Ruby script that will add data to a Neo4j database using REST API. (<a href=\"http://www.sitepoint.com/create-neo4j-graph-database-using-rest-api/\" rel=\"nofollow\">Here's the tutorial with all the code if interested.</a>)</p>\n\n<p>The script works if I include the hash data structure in the initialize method but I would like to move the data into a different file so I can make changes to it separately using a different script. </p>\n\n<p>I'm relatively new to Ruby. If I copy the following data structure into a separate file, is there a simple way to read it from my existing script when I call @data? I've heard one could do something with YAML or JSON (not familiar with how either work). What's the easiest way to read a file and how could I go about coding that?</p>\n\n<pre><code>#I want to copy this data into a different file and read it with my script when I call @data.\n{\n  nodes:[\n        {:label=&gt;\"Person\", :title=&gt;\"title_here\", :name=&gt;\"name_here\"}\n        ]\n} \n</code></pre>\n\n<p>And here is part of my code, it should be enough for the purposes of this question.</p>\n\n<pre><code>class RGraph\n\n  def initialize    \n\n    @url = 'http://localhost:7474/db/data/cypher'\n\n    #If I put this hash structure into a different file, how do I make @data read that file?\n    @data = {\n            nodes:[\n                {:label=&gt;\"Person\", :title=&gt;\"title_here\", :name=&gt;\"name_here\"}\n            ]\n            } \n\n\n  end\n\n  #more code here... not relevant to question\n\n  def create_nodes\n    # Scan file, find each node and create it in Neo4j\n    @data.each do |key,value|\n        if key == :nodes\n            @data[key].each do |node| # Cycle through each node\n                next unless node.has_key?(:label) # Make sure this node has a label\n                #WE have sufficient data to create a node\n                label = node[:label]\n                attr = Hash.new\n                node.each do |k,v| # Hunt for additional attributes\n                    next if k == :label # Don't create an attribute for \"label\"\n                    attr[k] = v\n                end\n                create_node(label,attr)\n             end\n          end\n      end\n  end\n\nrGraph = RGraph.new\n\nrGraph.create_nodes\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "hiddenfield"], "comments": [{"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433915722, "post_id": 30747034, "comment_id": 49550748, "body": "paste model and form"}, {"owner": {"reputation": 133, "user_id": 1924630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2366e01d6c9bcab8d78e6d20b84db755?s=128&d=identicon&r=PG", "display_name": "Chong Hui", "link": "https://stackoverflow.com/users/1924630/chong-hui"}, "reply_to_user": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433927507, "post_id": 30747034, "comment_id": 49557923, "body": "Hi I added it to the question"}, {"owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "edited": false, "score": 0, "creation_date": 1433928723, "post_id": 30747034, "comment_id": 49558780, "body": "in student model have you defined association for attendance_lists?"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1924630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2366e01d6c9bcab8d78e6d20b84db755?s=128&d=identicon&r=PG", "display_name": "Chong Hui", "link": "https://stackoverflow.com/users/1924630/chong-hui"}, "edited": false, "score": 0, "creation_date": 1433929876, "post_id": 30752574, "comment_id": 49559598, "body": "The <code>simple_form_for</code> is using <code>attendance_list</code> so do you mean <code>simple_fields</code>? And thanks for spotting that for me! Must have missed that <code>has_many :attendance_lists, :through =&gt; :attendances</code>"}, {"owner": {"reputation": 133, "user_id": 1924630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2366e01d6c9bcab8d78e6d20b84db755?s=128&d=identicon&r=PG", "display_name": "Chong Hui", "link": "https://stackoverflow.com/users/1924630/chong-hui"}, "edited": false, "score": 0, "creation_date": 1433930685, "post_id": 30752574, "comment_id": 49560179, "body": "It doesn&#39;t work because i think the parent of attendance is attendance_sheet."}], "tags": [], "owner": {"reputation": 3587, "user_id": 4918948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db0f565037fbddb5a8d5a30fa1e7273?s=128&d=identicon&r=PG&f=1", "display_name": "Vrushali Pawar", "link": "https://stackoverflow.com/users/4918948/vrushali-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1433928984, "creation_date": 1433928984, "answer_id": 30752574, "question_id": 30747034, "link": "https://stackoverflow.com/questions/30747034/rails-4-dynamic-form-nested-attributes-without-hidden-input/30752574#30752574", "title": "Rails 4 dynamic form nested attributes without hidden input", "body": "<pre><code>class AttendanceList &lt; ActiveRecord::Base\n  belongs_to :classroom\n  has_many :attendances\n  has_many :students, :through =&gt; :attendances\n  accepts_nested_attributes_for :attendances\nend\n\nclass Attendance &lt; ActiveRecord::Base\n  belongs_to :student\n  belongs_to :attendance_list\nend\n\nclass Classroom &lt; ActiveRecord::Base\n  belongs_to :school\n  has_and_belongs_to_many :students\n  has_many :attendance_lists\n\n  validates :class_name, presence: true\nend\n\nclass Student &lt; ActiveRecord::Base\n  has_many :attendances\n  has_many :attendance_lists, :through =&gt; :attendances\nend\n</code></pre>\n\n<p>view file</p>\n\n<pre><code>= simple_form_for @student do |f|\n  = f.simple_fields_for :attendances do |g|\n      ** your code **\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1924630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2366e01d6c9bcab8d78e6d20b84db755?s=128&d=identicon&r=PG", "display_name": "Chong Hui", "link": "https://stackoverflow.com/users/1924630/chong-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433928984, "creation_date": 1433909950, "last_edit_date": 1433927445, "question_id": 30747034, "link": "https://stackoverflow.com/questions/30747034/rails-4-dynamic-form-nested-attributes-without-hidden-input", "title": "Rails 4 dynamic form nested attributes without hidden input", "body": "<p>Previously I asked a question about building an attendance list getting the students and building a check list to mark attendance and came up with this. </p>\n\n<pre><code>def new\n    @attendance_list = @classroom.attendance_lists.new\n\n    @attendance_list.attendances = @classroom.student_ids.map do |student_id|\n      @attendance_list.attendances.build(student_id: student_id)\n    end\nend\n\ndef create\n    @attendance_list = @classroom.attendance_lists.new(attendance_list_params)\n    @attendance_list.classroom_id = params[:classroom_id]\n\n    respond_to do |format|\n\nend\n</code></pre>\n\n<p>params</p>\n\n<pre><code>params.require(:attendance_list)\n  .permit(:post_date, :remark, \n          attendances_attributes: [:student_id, :attended, :remarks ])\n</code></pre>\n\n<p>with simple fields</p>\n\n<pre><code>= simple_form_for [@school, @classroom, @attendance_list] do |f|\n  = f.input :post_date\n  = f.input :remark\n\n    = f.simple_fields_for :attendances do |g|\n      ** you see i needed a hidden student_id **\n      = g.input :student_id, as: :hidden\n      ...... \n</code></pre>\n\n<p>model</p>\n\n<pre><code>class AttendanceList &lt; ActiveRecord::Base\n  belongs_to :classroom\n  has_many :attendances\n  has_many :students, :through =&gt; :attendances\n\n  accepts_nested_attributes_for :attendances\nend\n\nclass Attendance &lt; ActiveRecord::Base\n  belongs_to :student\n  belongs_to :attendance_list\nend\n\nclass Classroom &lt; ActiveRecord::Base\n  belongs_to :school\n  has_and_belongs_to_many :students\n  has_many :attendance_lists\n\n  validates :class_name, presence: true\nend\n</code></pre>\n\n<p>how do I do without the hidden input because this line doesn't seem to work.</p>\n\n<pre><code>build(student_id: student_id)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cron"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 4, "last_activity_date": 1433908401, "creation_date": 1433908401, "answer_id": 30746795, "question_id": 30746764, "link": "https://stackoverflow.com/questions/30746764/destroy-all-issue/30746795#30746795", "title": "Destroy all issue", "body": "<p><code>destroy_all</code> returns an integer and you cannot concatinate strings and integers like that. A simple example to show this problem is:</p>\n\n<pre><code>\"foo\" + 42 + \"bar\"\nTypeError: no implicit conversion of Fixnum into String\n</code></pre>\n\n<p>The solution is to use string interpolation (or the <code>to_s</code> method, but that feels ugly to me):</p>\n\n<pre><code>puts \"Done. #{destroyed.length} records deleted.\"\n</code></pre>\n"}], "owner": {"reputation": 3222, "user_id": 1553293, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/12fbb0c5f237d6e3e6c52941e30b0c2a?s=128&d=identicon&r=PG", "display_name": "Muhambi", "link": "https://stackoverflow.com/users/1553293/muhambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 30746795, "answer_count": 1, "score": 0, "last_activity_date": 1433908401, "creation_date": 1433908181, "question_id": 30746764, "link": "https://stackoverflow.com/questions/30746764/destroy-all-issue", "title": "Destroy all issue", "body": "<p>I have a standard has_many/belongs_to relationship with movies and posters. Each movie can have many posters. I have the following in a rake command:</p>\n\n<pre><code>task remove_movie_posters: :environment do\n   destroyed = Movie.where(fake: true).posters.where(\"created_at &lt; ?\", 1.minute.ago).destroy_all\n   puts \"Done. \" + destroyed.length + \" records deleted.\"\nend\n</code></pre>\n\n<p>but I get the error: <code>TypeError: no implicit conversion of Fixnum into String</code></p>\n"}, {"tags": ["ruby", "bundler"], "comments": [{"owner": {"reputation": 1864, "user_id": 1559501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efac84c7fef4cc4dc9f99d7251597065?s=128&d=identicon&r=PG", "display_name": "aadarshsg", "link": "https://stackoverflow.com/users/1559501/aadarshsg"}, "edited": false, "score": 1, "creation_date": 1433908086, "post_id": 30746680, "comment_id": 49548430, "body": "This should be helpful.    <a href=\"http://stackoverflow.com/questions/11291235/ruby-gem-dependencies-on-offline-server\" title=\"ruby gem dependencies on offline server\">stackoverflow.com/questions/11291235/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 758413, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5VO94.jpg?s=128&g=1", "display_name": "Todd Leo", "link": "https://stackoverflow.com/users/758413/todd-leo"}, "reply_to_user": {"reputation": 1864, "user_id": 1559501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efac84c7fef4cc4dc9f99d7251597065?s=128&d=identicon&r=PG", "display_name": "aadarshsg", "link": "https://stackoverflow.com/users/1559501/aadarshsg"}, "edited": false, "score": 0, "creation_date": 1433908554, "post_id": 30746680, "comment_id": 49548524, "body": "@aadarshs any differences between <code>bundle install --path ...</code> and <code>bundle package</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1864, "user_id": 1559501, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efac84c7fef4cc4dc9f99d7251597065?s=128&d=identicon&r=PG", "display_name": "aadarshsg", "link": "https://stackoverflow.com/users/1559501/aadarshsg"}, "is_accepted": true, "score": 0, "last_activity_date": 1433913640, "creation_date": 1433913640, "answer_id": 30747660, "question_id": 30746680, "link": "https://stackoverflow.com/questions/30746680/ruby-bundle-install-in-deployment-mode/30747660#30747660", "title": "Ruby Bundle Install in deployment mode", "body": "<p><code>bundle install</code> will grab the gems from rubygems when run.</p>\n\n<p><code>bundle package</code> grabs the gems and packages them in vendor/cache.</p>\n\n<p>The <code>package</code> command will copy the <code>.gem</code> files for your gems in the bundle into <code>./vendor/cache</code>. Afterward, when you run <code>bundle install</code>, Bundler will use the gems in the cache in preference to the ones on rubygems.org.</p>\n\n<p><a href=\"http://bundler.io/bundle_package.html\" rel=\"nofollow\">http://bundler.io/bundle_package.html</a></p>\n"}], "owner": {"reputation": 45, "user_id": 758413, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5VO94.jpg?s=128&g=1", "display_name": "Todd Leo", "link": "https://stackoverflow.com/users/758413/todd-leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 30747660, "answer_count": 1, "score": 0, "last_activity_date": 1433913640, "creation_date": 1433907632, "question_id": 30746680, "link": "https://stackoverflow.com/questions/30746680/ruby-bundle-install-in-deployment-mode", "title": "Ruby Bundle Install in deployment mode", "body": "<p>I'm installing a ruby git-repo on several servers which have <strong>no internet</strong> connectivity. I had cloned that repo to my local machine, and used <code>$ bundle install --path vendor/bundle</code> to package all dependencies. Then I copied the whole directory to the target server, and tried <code>$ bundle install --deployment</code>, which still attempting resources from rubygems.org, hence not solving any dependencies as expected:</p>\n\n<blockquote>\n  <p>Fetching source index for <a href=\"https://ruby.taobao.org/\" rel=\"nofollow\">https://ruby.taobao.org/</a>\n  Could not find ffi-1.9.3 in any of the sources</p>\n</blockquote>\n\n<p>According to <a href=\"http://bundler.io/bundle_install.html\" rel=\"nofollow\">bundler.io</a>:</p>\n\n<blockquote>\n  <p>The --deployment flag activates a number of deployment-friendly conventions:<br>\n  Isolate all gems into <strong>vendor/bundle</strong></p>\n</blockquote>\n\n<p>which does not work in my case. Any thing am I doing wrong?</p>\n"}, {"tags": ["ruby", "actionscript-3"], "answers": [{"tags": [], "owner": {"reputation": 37752, "user_id": 2225281, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/71156aec1325d8a1a20751655ef9be44?s=128&d=identicon&r=PG", "display_name": "Aaron Beall", "link": "https://stackoverflow.com/users/2225281/aaron-beall"}, "is_accepted": false, "score": 0, "last_activity_date": 1433947602, "creation_date": 1433947602, "answer_id": 30759787, "question_id": 30746656, "link": "https://stackoverflow.com/questions/30746656/actionscript-ruby/30759787#30759787", "title": "ActionScript + Ruby", "body": "<p>I can't speak for the Ruby side, but in AS3 the <code>URLLoader</code> is not meant to connect to a Web Socket, it's meant to load http resources. For Web Sockets in AS3 you must use a <a href=\"http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/Socket.html\" rel=\"nofollow\"><code>Socket</code></a>. There is no built in implementation of the <a href=\"http://tools.ietf.org/html/rfc6455\" rel=\"nofollow\">Web Socket standard</a> in AS3, but there are 3rd party libraries such as <a href=\"https://github.com/theturtle32/AS3WebSocket\" rel=\"nofollow\">AS3WebSocket</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 4991781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0849911d0054fa2d1ed0d6daf4b529?s=128&d=identicon&r=PG&f=1", "display_name": "wolf", "link": "https://stackoverflow.com/users/4991781/wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433947602, "creation_date": 1433907412, "question_id": 30746656, "link": "https://stackoverflow.com/questions/30746656/actionscript-ruby", "title": "ActionScript + Ruby", "body": "<p>I'm using WebSocket on ruby server.</p>\n\n<pre><code>require          'em-websocket'\n\ndef start_server(host, port)\n  EM.run {\n    EM::WebSocket.run(:host =&gt; host, :port =&gt; port) do |ws|\n      ws.onopen {\n\n      }\n      ws.onmessage {\n      }\n      ws.onclose {\n\n      }\n    end\n    puts 'Server is running at' + Time.now().to_s\n  }\nend\n\nstart_server('localhost', 8090)\n</code></pre>\n\n<p>I need to send request from ActionScript client. How I can do it?\nMy code doesn't work.</p>\n\n<pre><code>var loader:URLLoader = new URLLoader();\n        var request = new URLRequest(\"http://localhost:8090\");\n        request.method = URLRequestMethod.POST;\n        var variables:URLVariables = new URLVariables();\n        variables.exampleSessionId = new Date().getTime();\n        variables.exampleUserLabel = \"guest\";\n        request.data = variables;\n        try {\n            loader.load(request);\n\n        } catch (error:Error) {\n            trace(\"Unable to load requested document.\");\n        }\n</code></pre>\n\n<p>Maybe, you can suggest other implementation of ruby http server. Thank you.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 42085, "user_id": 3444240, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/OjOru.jpg?s=128&g=1", "display_name": "potashin", "link": "https://stackoverflow.com/users/3444240/potashin"}, "edited": false, "score": 1, "creation_date": 1433907382, "post_id": 30746558, "comment_id": 49548266, "body": "So, what is wrong with your attempt?"}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 3, "creation_date": 1433907395, "post_id": 30746558, "comment_id": 49548270, "body": "Your code is kind of rude. You could make your <code>bad_word = [&quot;bad_word1&quot;, &quot;bad_word2&quot;, &quot;bad_word3&quot;]</code> and everybody would understand you."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1433922661, "post_id": 30746558, "comment_id": 49554797, "body": "And \u2026 what is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1529848796, "last_edit_date": 1529848796, "creation_date": 1433907575, "answer_id": 30746672, "question_id": 30746558, "link": "https://stackoverflow.com/questions/30746558/find-bad-word-in-an-array-in-a-file-then-replace-it-by/30746672#30746672", "title": "Find bad word in an Array in a file , then replace it by ***", "body": "<p>I would do something like this:</p>\n\n<pre><code>class BadWordsFilter &lt; Struct(:filename)\n  attr_reader :filename\n\n  BAD_WORDS   = w%[badword1 badword2 badword3 badword4]\n  WORD_REGEXP = Regexp.union(BAD_WORDS)\n\n  def sanitize\n    content  = File.read(filename)\n    filtered = content.gsub(WORD_REGEXP, '***')\n\n    File.write(filename, filtered)\n  end\nend\n\nfilter = BadWordsFilter.new('script.txt')\nfilter.sanitize\n</code></pre>\n"}], "owner": {"reputation": 1246, "user_id": 4516106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/37134b731235c61f94701c9e5d6882cf?s=128&d=identicon&r=PG", "display_name": "khue bui", "link": "https://stackoverflow.com/users/4516106/khue-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529848796, "creation_date": 1433906661, "last_edit_date": 1433908078, "question_id": 30746558, "link": "https://stackoverflow.com/questions/30746558/find-bad-word-in-an-array-in-a-file-then-replace-it-by", "title": "Find bad word in an Array in a file , then replace it by ***", "body": "<p>i am a newbie in ruby , \ni hava an array of bad words, so i want to test a file, if find a bad word then replace it by ***</p>\n\n<pre><code>class BadWord\n  def changeword\n    bad_word = [ \"badword1\", \"badword2\", \"badword3\", \"badword4\" ]\n    data = File.read(\"script.txt\")\n    filterdata = bad_word.map{|item|\n    data.gsub(\"#{item}\",\"***\")\n    File.write(\"script.txt\",filterdata)\n  end\nend\nobj = BadWord.new()\nobj.changeword()\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "rspec"], "comments": [{"owner": {"reputation": 3365, "user_id": 2200277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a95ec105629f01fab28845338ab409?s=128&d=identicon&r=PG", "display_name": "Wally Altman", "link": "https://stackoverflow.com/users/2200277/wally-altman"}, "edited": false, "score": 1, "creation_date": 1433912235, "post_id": 30746504, "comment_id": 49549558, "body": "The file that can&#39;t be loaded is <code>models&#47;address_book.rbrspec</code>\u2014what&#39;s that about?"}], "answers": [{"tags": [], "owner": {"reputation": 20292, "user_id": 29262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42d4590355a1404230fbc9aff4dd377b?s=128&d=identicon&r=PG", "display_name": "Myron Marston", "link": "https://stackoverflow.com/users/29262/myron-marston"}, "is_accepted": false, "score": 0, "last_activity_date": 1433919678, "creation_date": 1433919678, "answer_id": 30749254, "question_id": 30746504, "link": "https://stackoverflow.com/questions/30746504/why-am-i-receiving-a-load-error-in-my-rspec-tests/30749254#30749254", "title": "Why am I receiving a load error in my RSpec tests?", "body": "<p>The error is telling you that it can't load a particular file that you've told it to load.  Notice the error:</p>\n\n<pre><code>cannot load such file -- /Users/ericpark/rails_projects/Address_Bloc/models/address_book.rbrspec (LoadError)\n</code></pre>\n\n<p>And notice your <code>rspec</code> command:</p>\n\n<pre><code>$ rspec spec/address_book_spec.rb models/address_book.rbrspec spec/address_book_spec.rb models/address_book.rb\n</code></pre>\n\n<p>The 2nd argument you are passing to <code>rspec</code> is <code>models/address_book.rbspec</code>, which names a file which does not exist.  RSpec cannot load files that do not exist and this error occurs.  It looks to me like you can simplify your <code>rspec</code> command to:</p>\n\n<pre><code>$ rspec spec/address_book_spec.rb\n</code></pre>\n\n<p>There's no need to pass a 2nd <code>spec/address_book_spec.rb</code> arg like you were doing.  You also shouldn't be passing the path to the implementation file (<code>models/address_book.rb</code>) to RSpec. Instead, you should <code>require 'models/address_book.rb</code> at the top of <code>spec/address_book_spec.rb</code>.</p>\n"}], "owner": {"reputation": 322, "user_id": 4041447, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh3.googleusercontent.com/-7j1JdEaU8x8/AAAAAAAAAAI/AAAAAAAABzc/xynDVLKS1bo/photo.jpg?sz=128", "display_name": "Eric Park", "link": "https://stackoverflow.com/users/4041447/eric-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433919678, "creation_date": 1433906249, "question_id": 30746504, "link": "https://stackoverflow.com/questions/30746504/why-am-i-receiving-a-load-error-in-my-rspec-tests", "title": "Why am I receiving a load error in my RSpec tests?", "body": "<p>I am receiving the following load error when running my RSpec tests: </p>\n\n<pre><code>Eric-Parks-MacBook-Pro-2:Address_Bloc ericpark$ rspec spec/address_book_spec.rb models/address_book.rbrspec spec/address_book_spec.rb models/address_book.rb\n/Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/configuration.rb:1226:in `load': cannot load such file -- /Users/ericpark/rails_projects/Address_Bloc/models/address_book.rbrspec (LoadError)\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/configuration.rb:1226:in `block in load_spec_files'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/configuration.rb:1224:in `each'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/configuration.rb:1224:in `load_spec_files'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/runner.rb:97:in `setup'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/runner.rb:85:in `run'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/runner.rb:70:in `run'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/lib/rspec/core/runner.rb:38:in `invoke'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/gems/rspec-core-3.2.2/exe/rspec:4:in `&lt;top (required)&gt;'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/bin/rspec:23:in `load'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/bin/rspec:23:in `&lt;main&gt;'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/bin/ruby_executable_hooks:15:in `eval'\n    from /Users/ericpark/.rvm/gems/ruby-2.2.0/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>I am not sure how and why a load error occurs? Here is some of my code:</p>\n\n<p>address_book_spec.rb:</p>\n\n<pre><code>RSpec.describe AddressBook do #describe the specific MVC architecture\n  let(:book) { AddressBook.new } #Instantiates book as AddressBook.new removing the need to continually call it\n\n  def check_entry(entry, expected_name, expected_number, expected_email)\n    expect(entry.name).to eql expected_name\n    expect(entry.phone_number).to eql expected_number\n    expect(entry.email).to eql expected_email\n  end\n\n  context \"attributes\" do #RSpec paradigm to name the test\n    it \"should respond to entries\" do #RSpec paradigm to describe the function\n      expect(book).to respond_to(:entries) #Actual code that runs\n    end\n    it \"should initialize entries as an array\" do\n       expect(book.entries).to be_a(Array)\n     end\n\n     it \"should initialize entries as empty\" do\n       expect(book.entries.size).to eq 0\n     end\n  end\n\n  context \".add_entry\" do\n    it \"adds only one entry to the address book\" do\n      book.add_entry('Ada Lovelace', '010.012.1815', 'augusta.king@lovelace.com')\n\n      expect(book.entries.size).to eq 1\n    end\n\n    it \"adds the correct information to entries\" do\n       book.add_entry('Ada Lovelace', '010.012.1815', 'augusta.king@lovelace.com')\n       new_entry = book.entries[0]\n\n       expect(new_entry.name).to eq 'Ada Lovelace'\n       expect(new_entry.phone_number).to eq '010.012.1815'\n       expect(new_entry.email).to eq 'augusta.king@lovelace.com'\n    end\n  end\n\n  context \".remove_entry\" do\n    it \"deletes one entry of the address book\" do\n      book = AddressBook.new\n      book.add_entry('Ada Lovelace', '010.012.1815', 'augusta.king@lovelace.com')\n\n      book.remove_entry('augusta.king@lovelace.com')\n      expect(book.entries.size).to eq(0)\n    end\n  end\n\n  context \".import_from_csv\" do\n     it \"imports the correct number of entries\" do\n       book.import_from_csv(\"entries.csv\")\n       book_size = book.entries.size\n       expect(book_size).to eql 5\n     end\n\n     it \"imports the 1st entry\" do\n       book.import_from_csv(\"entries.csv\")\n       entry_one = book.entries[0]\n       check_entry(entry_one, \"Bill\", \"555-555-5555\", \"bill@blocmail.com\")\n     end\n\n     it \"imports the 2nd entry\" do\n       book.import_from_csv(\"entries.csv\")\n       entry_two = book.entries[1]\n       check_entry(entry_two, \"Bob\", \"555-555-5555\", \"bob@blocmail.com\")\n    end\n\n     it \"imports the 3rd entry\" do\n       book.import_from_csv(\"entries.csv\")\n       entry_three = book.entries[2]\n       check_entry(entry_three, \"Joe\", \"555-555-5555\", \"joe@blocmail.com\")\n     end\n\n     it \"imports the 4th entry\" do\n       book.import_from_csv(\"entries.csv\")\n       entry_four = book.entries[3]\n       check_entry(entry_four, \"Sally\", \"555-555-5555\", \"sally@blocmail.com\")\n     end\n\n     it \"imports the 5th entry\" do\n       book.import_from_csv(\"entries.csv\")\n       entry_five = book.entries[4]\n       check_entry(entry_five, \"Sussie\", \"555-555-5555\", \"sussie@blocmail.com\")\n     end\n   end\n\n   context \".import_from_csv2\" do\n      it \"imports the correct number of entries\" do\n        book.import_from_csv(\"entries_2.csv\")\n        book_size = book.entries.size\n        expect(book_size).to eql 3\n      end\n\n      it \"imports the 1st entry\" do\n        book.import_from_csv(\"entries_2.csv\")\n        entry_one = book.entries[0]\n        check_entry(entry_one, \"Eric\", \"111-111-1111\", \"example1@blocmail.com\")\n      end\n\n      it \"imports the 2nd entry\" do\n        book.import_from_csv(\"entries_2.csv\")\n        entry_two = book.entries[1]\n        check_entry(entry_two, \"Anna\", \"222-222-2222\", \"example2@blocmail.com\")\n     end\n\n      it \"imports the 3rd entry\" do\n        book.import_from_csv(\"entries_2.csv\")\n        entry_three = book.entries[2]\n        check_entry(entry_three, \"Tony\", \"222-222-2222\", \"example3@blocmail.com\")\n      end\n    end\nend\n</code></pre>\n\n<p>address_book.rb: </p>\n\n<pre><code>require_relative \"entry.rb\" #Loading the model's association\nrequire \"csv\"\nclass AddressBook\n  attr_accessor :entries\n\n  def initialize\n    @entries = []\n  end\n\n  def add_entry(name, phone, email)\n    #Create a variable index to store\n    index = 0\n    @entries.each do |entry|\n      if name &lt; entry.name\n        break\n      end\n      index += 1\n    end\n\n    @entries.insert(index,Entry.new(name,phone,email))\n  end\n\n  def import_from_csv(file_name)\n    csv_text = File.read(file_name)\n    csv = CSV.parse(csv_text, headers: true)\n    csv.each do |row|\n      row_hash = row.to_hash\n      add_entry(row_hash[\"name\"], row_hash[\"phone_number\"], row_hash[\"email\"])\n    end\n    return csv.count\n  end\n\n  def binary_search(name)\n    return nil\n  end \nend\n</code></pre>\n\n<p>I have included an entries.csv and an entries_2.csv within the same folder as the application. </p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1433906077, "creation_date": 1433906077, "answer_id": 30746475, "question_id": 30746457, "link": "https://stackoverflow.com/questions/30746457/merging-two-sorted-arrays-not-working/30746475#30746475", "title": "Merging two sorted arrays not working", "body": "<pre><code>while num &gt; arr2[i] &amp;&amp; arr2[i] != nil\n</code></pre>\n\n<p>You are using the wrong condition. According to the <strong>short circuit</strong> rule of <code>&amp;&amp;</code>, put the check for <code>nil</code> on the left:</p>\n\n<pre><code>while arr2[i] != nil &amp;&amp; num &gt; arr2[i]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3512800, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001566521996/picture?type=large", "display_name": "jeremyhcho", "link": "https://stackoverflow.com/users/3512800/jeremyhcho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433944846, "creation_date": 1433905890, "last_edit_date": 1433944846, "question_id": 30746457, "link": "https://stackoverflow.com/questions/30746457/merging-two-sorted-arrays-not-working", "title": "Merging two sorted arrays not working", "body": "<p>Trying to solve a problem involving merging two sorted arrays without using the sort method. Here's my code so far:</p>\n\n<pre><code>def combine(arr1, arr2)\nresult = []\n\ni = 0\narr1.each do |num|\n    while num &gt; arr2[i] &amp;&amp; arr2[i] != nil\n        result &lt;&lt; arr2[i]\n        i += 1\n    end\n    result &lt;&lt; num\nend\n\nresult\nend\n</code></pre>\n\n<p>When I run this with <code>[1, 9, 10, 12], [2, 5, 6, 8]</code> as the two arguments, it gives me a comparison of <code>Fixnum</code> to <code>nil</code> error and I can't wrap my head around it. It seems like an easy fix but nothing seems to be working.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "web-scraping", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 9138821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7QAZX.jpg?s=128&g=1", "display_name": "confetti", "link": "https://stackoverflow.com/users/9138821/confetti"}, "edited": false, "score": 0, "creation_date": 1564626034, "post_id": 30748506, "comment_id": 101095559, "body": "Using <code>gem install watir phantomjs</code> and trying your snippet, I get a <code>&#47;usr&#47;lib&#47;ruby&#47;2.6.0&#47;rubygems&#47;core_ext&#47;kernel_require.rb:54:i&zwnj;&#8203;n &#39;require&#39;: cannot load such file -- selenium&#47;webdriver&#47;phantomjs (LoadError)</code> error. It also spits out a warning about Selenium support for PhantomJS being deprecated."}], "tags": [], "owner": {"reputation": 160, "user_id": 3483708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ipxmS.jpg?s=128&g=1", "display_name": "Maxim Kashchenko", "link": "https://stackoverflow.com/users/3483708/maxim-kashchenko"}, "is_accepted": false, "score": 14, "last_activity_date": 1433952900, "last_edit_date": 1433952900, "creation_date": 1433917076, "answer_id": 30748506, "question_id": 30746397, "link": "https://stackoverflow.com/questions/30746397/can-nokogiri-interpret-javascript-web-scraping/30748506#30748506", "title": "Can Nokogiri interpret javascript? - Web Scraping", "body": "<p><a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"noreferrer\">Nokogiri</a> is just a <a href=\"http://en.wikipedia.org/wiki/Parsing#Parser\" rel=\"noreferrer\">parser</a>. It also allows to search content.  </p>\n\n<p>To interact with web pages you need to use something else, e.g. <a href=\"http://watir.com/\" rel=\"noreferrer\">Watir</a> and <a href=\"http://phantomjs.org/\" rel=\"noreferrer\">PhantomJS</a>.</p>\n\n<p>Combining them all together:</p>\n\n<pre><code>browser = Watir::Browser.new(:phantomjs)\n\nbrowser.goto(your_url_above)\nbrowser.link(text: 'All floorplans').click\n\ndocument = Nokogiri::HTML(browser.html)\ndocument.search(...)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1433975054, "post_id": 30755247, "comment_id": 49588805, "body": "Please take the time to use correct grammar and spelling in your answers. Failing to do so forces us to do it for you which takes away from our time to help others."}, {"owner": {"reputation": 4101, "user_id": 1482055, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f4D9p.jpg?s=128&g=1", "display_name": "Milind", "link": "https://stackoverflow.com/users/1482055/milind"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1434020606, "post_id": 30755247, "comment_id": 49607992, "body": "Thanks @theTinMan,will take care next time :)"}], "tags": [], "owner": {"reputation": 4101, "user_id": 1482055, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f4D9p.jpg?s=128&g=1", "display_name": "Milind", "link": "https://stackoverflow.com/users/1482055/milind"}, "is_accepted": false, "score": 0, "last_activity_date": 1433975281, "last_edit_date": 1433975281, "creation_date": 1433936431, "answer_id": 30755247, "question_id": 30746397, "link": "https://stackoverflow.com/questions/30746397/can-nokogiri-interpret-javascript-web-scraping/30755247#30755247", "title": "Can Nokogiri interpret javascript? - Web Scraping", "body": "<p>Yes, you can do it if the Floorplans have an id/class. You can get those from your page.</p>\n\n<p>You will be needing <a href=\"https://addons.mozilla.org/eN-US/firefox/addon/firepath/\" rel=\"nofollow\">firepath</a> to help you get the XPath of the elements and then you can iterate them using it. For example, recently I worked on <a href=\"https://github.com/mike1011/webpagescraper/tree/master/webpagescraper\" rel=\"nofollow\">webpagescraper</a> to scrape HTML from <a href=\"https://fundly.com/search/%60\" rel=\"nofollow\">fundly.com</a>.</p>\n\n<p>To get all titles, as all <code>titles</code> elements in the HTML had the same class, I was able to get EVERY title on <a href=\"https://fundly.com/search/%60\" rel=\"nofollow\">https://fundly.com/search/%60</a> using that XPath with the class name like:</p>\n\n<pre><code>require 'rubygems'\nrequire 'nokogiri'\nrequire 'open-uri'\n\ndoc.search('h4.f-width-100').each do |title|\n   @campaign_titles &lt;&lt;  title.text\nend  \n</code></pre>\n\n<p>Please refer to my above project if you need any more assistance to grab the values from any website.</p>\n"}], "owner": {"reputation": 319, "user_id": 4883464, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10200587255120272/picture?type=large", "display_name": "AlexWang", "link": "https://stackoverflow.com/users/4883464/alexwang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4341, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1434064089, "creation_date": 1433905486, "last_edit_date": 1434064089, "question_id": 30746397, "link": "https://stackoverflow.com/questions/30746397/can-nokogiri-interpret-javascript-web-scraping", "title": "Can Nokogiri interpret javascript? - Web Scraping", "body": "<p>We are trying to scrape the availabilities on this page:\n<a href=\"http://www.equityapartments.com/new-york/new-york-city-apartments/midtown-west/mantena-apartments.aspx\" rel=\"nofollow\">http://www.equityapartments.com/new-york/new-york-city-apartments/midtown-west/mantena-apartments.aspx</a></p>\n\n<p>I need to use my spider to select on the \"All Floorplans\" and fetch all the availabilities. But the data are actually sent through Javascript request I believe. Is there a way for my Nokogiri spider to render it? Or maybe simulate the process of clicking on buttons?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "actionmailer", "mandrill"], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 682901, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/866bd5cf066ac2959a7d53c91ac68991?s=128&d=identicon&r=PG", "display_name": "EasyCo", "link": "https://stackoverflow.com/users/682901/easyco"}, "is_accepted": false, "score": 2, "last_activity_date": 1433906285, "creation_date": 1433906285, "answer_id": 30746511, "question_id": 30746144, "link": "https://stackoverflow.com/questions/30746144/mandrill-send-email-ruby-on-rails/30746511#30746511", "title": "Mandrill send email ruby on rails", "body": "<p>From <a href=\"https://mandrill.zendesk.com/hc/en-us/articles/205582237-How-do-I-get-rid-of-the-on-behalf-of-message-that-shows-for-some-recipients-\" rel=\"nofollow\">Mandrill KB</a></p>\n\n<blockquote>\n  <p>If your recipients use Outlook, Hotmail (and other Microsoft webmail\n  services), or Gmail, they may see an indication in the email that it\n  was sent by Mandrill on your behalf instead of just your 'from' name\n  and address. Add SPF and DKIM records to your sending domains to\n  remove the 'on behalf of' or 'via' information.</p>\n</blockquote>\n\n<p>Instructions on how do that can be found here: <a href=\"https://mandrill.zendesk.com/hc/en-us/articles/205582277-How-do-I-add-DNS-records-for-my-sending-domains-\" rel=\"nofollow\">https://mandrill.zendesk.com/hc/en-us/articles/205582277-How-do-I-add-DNS-records-for-my-sending-domains-</a></p>\n"}], "owner": {"reputation": 69, "user_id": 4975863, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/da4ac23fd65066d1aa64660bec26dfba?s=128&d=identicon&r=PG&f=1", "display_name": "nour", "link": "https://stackoverflow.com/users/4975863/nour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1433906285, "creation_date": 1433903793, "last_edit_date": 1433905667, "question_id": 30746144, "link": "https://stackoverflow.com/questions/30746144/mandrill-send-email-ruby-on-rails", "title": "Mandrill send email ruby on rails", "body": "<p>Im using mandrill for sending email and it show for some emails that the email From: <code>ma@mail133-28.atl131.mandrillapp.com [mailto:ma@mail133-28.atl131.mandrillapp.com]</code> On Behalf Of <code>info@****.com</code></p>\n\n<p>in my name mailer  <pre>default from: \"info@****.com\"</pre></p>\n\n<p>and in the development.rb</p>\n\n<pre><code>  config.action_mailer.raise_delivery_errors = true\n  config.action_mailer.delivery_method = :letter_opener\n  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.smtp_settings = {\n    :address =&gt; \"smtp.mandrillapp.com\",\n    :port =&gt; 587,\n    :domain =&gt; 'www.****.com',\n    :user_name =&gt; '**@**.ca',\n    :password =&gt; '***',\n    :authentication =&gt; :plain,\n    :enable_starttls_auto =&gt; true \n  }\n</code></pre>\n\n<p>Why is that? i want to show from: <code>info@****.com</code> without this <code>ma@mail133-28.atl131.mandrillapp.com [mailto:ma@mail133-28.atl131.mandrillapp.com]</code> On Behalf Of <code>info@****.com</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "gem", "compass"], "comments": [{"owner": {"reputation": 750, "user_id": 1801879, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d8f2eec3417afa4692430fc0f19d201a?s=128&d=identicon&r=PG", "display_name": "user1801879", "link": "https://stackoverflow.com/users/1801879/user1801879"}, "edited": false, "score": 0, "creation_date": 1433902850, "post_id": 30745982, "comment_id": 49547267, "body": "did you put @import &#39;compass&#39; in application.css.scss"}, {"owner": {"reputation": 462, "user_id": 3288070, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3ec31403370bc858c0524a492f633d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiden Prince", "link": "https://stackoverflow.com/users/3288070/kaiden-prince"}, "edited": false, "score": 0, "creation_date": 1445299299, "post_id": 30745982, "comment_id": 54256233, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22544754/failed-to-build-gem-native-extension-installing-compass\">Failed to build gem native extension (installing Compass)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4595458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iOOF_JaNvfo/AAAAAAAAAAI/AAAAAAAAACc/e91I4iWUvoI/photo.jpg?sz=128", "display_name": "Will M.", "link": "https://stackoverflow.com/users/4595458/will-m"}, "edited": false, "score": 0, "creation_date": 1433913737, "post_id": 30746222, "comment_id": 49550035, "body": "Thank you so much that fixed my problem!"}], "tags": [], "owner": {"reputation": 50185, "user_id": 276949, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52e96d535181560d2b46d4b513454ee5?s=128&d=identicon&r=PG", "display_name": "Martin Konecny", "link": "https://stackoverflow.com/users/276949/martin-konecny"}, "is_accepted": true, "score": 9, "last_activity_date": 1445301001, "last_edit_date": 1445301001, "creation_date": 1433904368, "answer_id": 30746222, "question_id": 30745982, "link": "https://stackoverflow.com/questions/30745982/ruby-compass-error-failed-to-build-gem-native-extension/30746222#30746222", "title": "Ruby Compass ERROR: Failed to build gem native extension", "body": "<blockquote>\n  <p>mkmf.rb can't find header files for ruby at</p>\n</blockquote>\n\n<p>You need the ruby dev headers files to compile gems.</p>\n\n<p>You need the package <code>ruby2.1-dev</code>.</p>\n\n<p>You may also need other packages like <code>build-essential</code>.</p>\n\n<p>Try the following:</p>\n\n<pre><code>sudo apt-get install ruby2.1-dev build-essential\n</code></pre>\n\n<p>On earlier versions of Ubuntu such as 14.04, you will need the <code>ruby2.0-dev</code> package instead.</p>\n\n<pre><code>sudo apt-get install ruby2.0-dev build-essential\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4595458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iOOF_JaNvfo/AAAAAAAAAAI/AAAAAAAAACc/e91I4iWUvoI/photo.jpg?sz=128", "display_name": "Will M.", "link": "https://stackoverflow.com/users/4595458/will-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7298, "favorite_count": 2, "accepted_answer_id": 30746222, "answer_count": 1, "score": 2, "last_activity_date": 1445301001, "creation_date": 1433902514, "question_id": 30745982, "link": "https://stackoverflow.com/questions/30745982/ruby-compass-error-failed-to-build-gem-native-extension", "title": "Ruby Compass ERROR: Failed to build gem native extension", "body": "<p>Hi I am running Ubuntu 15.04 and I am trying to install the Compass gem. I did a gem update like the Compass website told me to do. Then I tried to install Compass and got the following error. </p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing compass:\nERROR: Failed to build gem native extension.\n\n/usr/bin/ruby2.1 -r ./siteconf20150609-16406-5iavn8.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.1.0/gems/ffi-1.9.8 for inspection.\nResults logged to /var/lib/gems/2.1.0/extensions/x86-linux/2.1.0/ffi-1.9.8/gem_make.out\n</code></pre>\n\n<p>This is the output from the gem_make.out file</p>\n\n<pre><code>/usr/bin/ruby2.1 -r ./siteconf20150609-16446-49gin0.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n</code></pre>\n\n<p>Not sure what to do at this point. Thanks!</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1089, "user_id": 441164, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52a75451ba45bf59e0a014224529538a?s=128&d=identicon&r=PG", "display_name": "patnz", "link": "https://stackoverflow.com/users/441164/patnz"}, "edited": false, "score": 0, "creation_date": 1433903540, "post_id": 30746015, "comment_id": 49547415, "body": "Great, thanks. And thanks for the additional examples too, I&#39;ll have a read up on them."}, {"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "reply_to_user": {"reputation": 1089, "user_id": 441164, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52a75451ba45bf59e0a014224529538a?s=128&d=identicon&r=PG", "display_name": "patnz", "link": "https://stackoverflow.com/users/441164/patnz"}, "edited": false, "score": 0, "creation_date": 1433906556, "post_id": 30746015, "comment_id": 49548068, "body": "A hex color is just 3x (r, g, and b) 1-byte values (0-255) encoded as a pair of hexadecimal digits (16^2 = 256). To generate a random color, you can generate 3 values in the 0-255 range and convert each to a hex pair."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433915091, "post_id": 30746015, "comment_id": 49550491, "body": "Is the middle one the same as <code>format &quot;#%06x&quot;, rand(256*256*256-1)  #=&gt; &quot;#dfc29d&quot;</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1433917988, "post_id": 30746015, "comment_id": 49551841, "body": "It should be noted that #2 could be written using <a href=\"http://ruby-doc.org/core-2.2.0/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\">Kernel#sprintf</a> or <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-25\" rel=\"nofollow noreferrer\">String#%</a>, rather than <a href=\"http://ruby-doc.org/core-2.2.0/Kernel.html#method-i-format\" rel=\"nofollow noreferrer\">Kernel#format</a>. (All share the same format string.) For example: <code>&quot;#%06x&quot; % rand(256*256*256-1)</code>."}], "tags": [], "owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "is_accepted": true, "score": 4, "last_activity_date": 1433902798, "creation_date": 1433902798, "answer_id": 30746015, "question_id": 30745974, "link": "https://stackoverflow.com/questions/30745974/ruby-incrementally-assign-the-output-of-a-block-to-an-undeclared-variable/30746015#30746015", "title": "Ruby - incrementally assign the output of a block to an undeclared variable", "body": "<p>The way to do what you're asking is something like:</p>\n\n<pre><code>\"#\" + 6.times.map { \"ABCDEF0123456789\".chars.sample }.join\n</code></pre>\n\n<p>But it might be more correct and easier to do something like:</p>\n\n<pre><code>format \"#%02x%02x%02x\", rand(255), rand(255), rand(255)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>require 'securerandom'\n\"#\" + SecureRandom.hex(3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1433915578, "creation_date": 1433915578, "answer_id": 30748116, "question_id": 30745974, "link": "https://stackoverflow.com/questions/30745974/ruby-incrementally-assign-the-output-of-a-block-to-an-undeclared-variable/30748116#30748116", "title": "Ruby - incrementally assign the output of a block to an undeclared variable", "body": "<p>You could also write:</p>\n\n<pre><code>\"##{ 'Magpie'.gsub(/./) { |c| rand(16).to_s(16) } }\"\n  #=&gt; \"#b1a501\" \n</code></pre>\n\n<p>Tack on <code>.upcase</code> if for some reason you want <code>\"#B1A501\"</code>.</p>\n"}], "owner": {"reputation": 1089, "user_id": 441164, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/52a75451ba45bf59e0a014224529538a?s=128&d=identicon&r=PG", "display_name": "patnz", "link": "https://stackoverflow.com/users/441164/patnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 30746015, "answer_count": 2, "score": 0, "last_activity_date": 1433915578, "creation_date": 1433902470, "question_id": 30745974, "link": "https://stackoverflow.com/questions/30745974/ruby-incrementally-assign-the-output-of-a-block-to-an-undeclared-variable", "title": "Ruby - incrementally assign the output of a block to an undeclared variable", "body": "<p>I'm pretty new to Ruby and a few times lately I've needed to do something like the following:</p>\n\n<p><strong>1)</strong> Declare a variable <strong>2)</strong> Do stuff to variable <strong>3)</strong> Return variable  </p>\n\n<p>when I feel I should be able to  </p>\n\n<p><strong>1)</strong> Do stuff while assigning it incrementally to a variable which is then returned </p>\n\n<p>To illustrate what I mean the example below generates a random hex color. \nI feel this should be a one liner but I'm not sure how.</p>\n\n<pre><code># This example generates a random color \ncolor = \"#\"\n6.times { color &lt;&lt; \"ABCDEF0123456789\".chars.sample }\ncolor #= \"#ABC123\"\n\n\n# The above code seems cumbersome &amp; what I want to do this\n\"#\" &lt;&lt; 6.times { color &lt;&lt; \"ABCDEF0123456789\".chars.sample } #= \"#\\u0006\"\n</code></pre>\n\n<p>I've tried lots of variations of this with no success. Is there a way I can do this? Is the times loop the wrong approach?</p>\n"}, {"tags": ["java", "ruby", "scala", "class"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1433922835, "post_id": 30745874, "comment_id": 49554912, "body": "Note: in your Scala example, you are <i>not</i> adding <code>isCorrect</code> to <code>String</code>. You are creating a new class <code>s</code> which has an <code>isCorrect</code> method, and an implicit conversion from <code>String</code> to <code>s</code>."}, {"owner": {"reputation": 313, "user_id": 3747474, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/ckx4F.jpg?s=128&g=1", "display_name": "Jade Tang", "link": "https://stackoverflow.com/users/3747474/jade-tang"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1433986952, "post_id": 30745874, "comment_id": 49592086, "body": "I know the difference between open class and implicit  conversion, but what I wanna achieve is to add new method to an existing class without writing a sub class."}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 4086943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c263cc17a0f21124e39984326af1ac4?s=128&d=identicon&r=PG&f=1", "display_name": "OscillatingMonkey", "link": "https://stackoverflow.com/users/4086943/oscillatingmonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1433902316, "last_edit_date": 1495542139, "creation_date": 1433902316, "answer_id": 30745949, "question_id": 30745874, "link": "https://stackoverflow.com/questions/30745874/open-class-or-implicit-class-in-java/30745949#30745949", "title": "open class or implicit class in java", "body": "<p>unfortunately Java doesn't allow reopening classes the way Ruby does. I would explain it but to be honest this guy does a great job of it right out.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/6680674/can-a-java-class-add-a-method-to-itself-at-runtime\">Can a Java class add a method to itself at runtime?</a></p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1433923187, "creation_date": 1433923187, "answer_id": 30750478, "question_id": 30745874, "link": "https://stackoverflow.com/questions/30745874/open-class-or-implicit-class-in-java/30750478#30750478", "title": "open class or implicit class in java", "body": "<p>A lot of people have wished for <em>Interface Injection</em> (adding new interfaces to existing classes at runtime) in Java for years (even decades), but so far, nothing has come of it.</p>\n\n<p>If Java gets Interface Injection sometime in the future, then the combination with Default Methods (added in Java 7) would indeed allow adding new methods like in Scala. It would, however, still not allow changing existing methods like in Ruby.</p>\n\n<p>However, until then, the only way is to play around with class reloading via a custom classloader.</p>\n"}], "owner": {"reputation": 313, "user_id": 3747474, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/ckx4F.jpg?s=128&g=1", "display_name": "Jade Tang", "link": "https://stackoverflow.com/users/3747474/jade-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1433923187, "creation_date": 1433901777, "question_id": 30745874, "link": "https://stackoverflow.com/questions/30745874/open-class-or-implicit-class-in-java", "title": "open class or implicit class in java", "body": "<p>There is concept name open class in Ruby which could add new method to an existing class without writing a sub class.</p>\n\n<p>There is also a technique classed implicit class in Scala which could do the same,here are some code snippet: with implicit class s, I actually add a new method isCorrect to the class String.</p>\n\n<pre><code>object ImplicitDemo {\n\n  implicit class s(s:String){\n    def isCorrect = s.startsWith(\"dw_\")\n  }\n\n  def main(args: Array[String]) {\n    println(\"duowan\" isCorrect )\n  }\n\n}\n</code></pre>\n\n<p>So, is there a way I can do the same in pure java?</p>\n"}, {"tags": ["ruby", "oop", "metaclass"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 2513001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9bc58d4c21dce1972d584416e7e0509b?s=128&d=identicon&r=PG", "display_name": "yuzhoul", "link": "https://stackoverflow.com/users/2513001/yuzhoul"}, "edited": false, "score": 1, "creation_date": 1433914904, "post_id": 30746221, "comment_id": 49550426, "body": "Thanks Jim, I&#39;ve done some other experiments with simplified examples shown below and now I think I am very clear on this issue."}], "tags": [], "owner": {"reputation": 10214, "user_id": 1591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e0a92aa779bf439fe972b2b9b46a289?s=128&d=identicon&r=PG", "display_name": "Jim Deville", "link": "https://stackoverflow.com/users/1591/jim-deville"}, "is_accepted": false, "score": 3, "last_activity_date": 1433904366, "creation_date": 1433904366, "answer_id": 30746221, "question_id": 30745662, "link": "https://stackoverflow.com/questions/30745662/define-method-in-a-class-method/30746221#30746221", "title": "define_method in a class method", "body": "<p>Calling <code>extend</code> technically puts the module in the lookup chain of the eigen object it is called on, which in this case is the same as the class object. So you are correct that the context for <code>hash_initialized</code> is the class. Additionally, you are correct that the context for <code>define_method</code> is the class. However, your final step is incorrect. When <code>define_method</code> is called in that context it defines an instance method, not a singleton method.</p>\n\n<p>IOW, when you call <code>define_method</code> in a context, it defines the method in the same place that <code>def</code> would define it at that context.</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 2513001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9bc58d4c21dce1972d584416e7e0509b?s=128&d=identicon&r=PG", "display_name": "yuzhoul", "link": "https://stackoverflow.com/users/2513001/yuzhoul"}, "is_accepted": false, "score": 0, "last_activity_date": 1433914855, "creation_date": 1433914855, "answer_id": 30747940, "question_id": 30745662, "link": "https://stackoverflow.com/questions/30745662/define-method-in-a-class-method/30747940#30747940", "title": "define_method in a class method", "body": "<p>I've made this clear by simplifying the example above and added a few printouts.</p>\n\n<pre><code>class Test\n  def self.define_something\n    define_method(:inside_class_method){puts \"method defined inside a class method\"}\n    puts \"self inside class method \"+self.to_s\n    proc = Proc.new{puts \"method defined using send inside class method\"}\n    self.send(:define_method, :define_using_send_inside_class_method, proc)\n  end\n\n  class &lt;&lt; self\n    puts \"self inside eigen class \"+self.to_s\n  end\n\n  def test\n    puts \"self inside of instance method \"+self.to_s\n  end\n  puts \"self outside of class method \"+self.to_s\n  define_method(:outside_class_method){puts \"method defined outside a class method\"}\n  define_something\nend\n\nTest.new().inside_class_method\nTest.new().outside_class_method\nTest.new().test\nTest.define_using_send_inside_class_method\n</code></pre>\n\n<p>This code produce the following outputs:</p>\n\n<p>self inside eigen class #</p>\n\n<p>self outside of class method Test</p>\n\n<p>self inside class method Test</p>\n\n<p>method defined inside a class method</p>\n\n<p>method defined outside a class method</p>\n\n<p>self inside of instance method #</p>\n\n<p>test.rb:26:in <code>&lt;main&gt;': undefined method</code>define_using_send_inside_class_method' for Test:Class (NoMethodError)</p>\n\n<p>This code:</p>\n\n<pre><code>self.send(:define_method, :define_using_send_inside_class_method, proc)\n</code></pre>\n\n<p>It is also defining an instance method since it is called on self, and self is referring to the class Test. </p>\n\n<p>If we need to define a class method, send needs to be called on the eigen class like this:</p>\n\n<pre><code>class &lt;&lt; self\n  self.send(:define_method, :define_using_send_inside_class_method, proc)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1435524842, "creation_date": 1435524842, "answer_id": 31104641, "question_id": 30745662, "link": "https://stackoverflow.com/questions/30745662/define-method-in-a-class-method/31104641#31104641", "title": "define_method in a class method", "body": "<p>When you encounter seeming conundrums such as this one, try salting your code with <code>puts self</code> statements:</p>\n\n<pre><code>module HashInitialized\n  puts \"self when parsed=#{self}\"\n  def hash_initialized(*fields)\n    puts \"self within hash_initialized=#{self}\"\n    define_method(:initialize) do |h|\n      missing = fields - h.keys\n      raise ArgumentError, \"Not all fields set: #{missing}\" if missing.any?\n      fields.each { |k| instance_variable_set(\"@#{k}\", h[k]) } \n    end\n    private :initialize\n  end\nend\n  #-&gt; self when parsed=HashInitialized\n\nclass Cheese\n  extend HashInitialized\n  attr_accessor :color, :odor, :taste\n  hash_initialized :color, :odor, :taste\nend\n  #-&gt; self within hash_initialized=Cheese\n</code></pre>\n\n<p>As you see, <code>self</code> is the class <code>Cheese</code>, not <code>Cheese</code>'s singleton_class. Hence, the receiver for <a href=\"http://ruby-doc.org/core-2.2.0/Module.html#method-i-define_method\" rel=\"nofollow\">Module#define_method</a> is <code>Cheese</code>, so the method obligingly creates the instance method <code>initialize</code> on <code>Cheese</code>.</p>\n\n<pre><code>Cheese.instance_methods(false)\n  #=&gt; [:color, :color=, :odor, :odor=, :taste, :taste=] \n</code></pre>\n\n<p><code>initialize</code> is not among the instance methods created on <code>Cheese</code> because I modified the code slightly to make it a private method: </p>\n\n<pre><code>Cheese.private_instance_methods(false)\n  #=&gt; [:initialize]\n</code></pre>\n\n<p>I also slightly altered the code that assigns values to the instance variables, and made the type of exception more specific.</p>\n\n<p>If appropriate, you could change your argument test to:</p>\n\n<pre><code>raise ArgumentError, \"Fields #{fields} and keys #{h.keys} don't match\" if\n  (fields-h.keys).any? || (h.keys-fields).any?\n</code></pre>\n\n<p>You may wish to have <code>initialize</code> create the assessors:</p>\n\n<pre><code>module HashInitialized\n  def hash_initialized(*fields)\n    define_method(:initialize) do |h|\n      missing = fields - h.keys\n      raise ArgumentError, \"Not all fields set: #{missing}\" if missing.any?\n      fields.each do |k|\n        instance_variable_set(\"@#{k}\", h[k])\n        self.class.singleton_class.send(:attr_accessor, k)\n      end\n    end\n    private :initialize\n  end\nend\n\nclass Cheese\n  extend HashInitialized\n  hash_initialized :color, :odor, :taste\nend\n\nCheese.new :color=&gt;'blue', odor: 'whew!', taste: \"wow!\"\n  =&gt; #&lt;Cheese:0x007f97fa07d2a0 @color=\"blue\", @odor=\"whew!\", @taste=\"wow!\"&gt; \n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 2513001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9bc58d4c21dce1972d584416e7e0509b?s=128&d=identicon&r=PG", "display_name": "yuzhoul", "link": "https://stackoverflow.com/users/2513001/yuzhoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1411, "favorite_count": 0, "accepted_answer_id": 31104641, "answer_count": 3, "score": 2, "last_activity_date": 1435524842, "creation_date": 1433900376, "last_edit_date": 1433900426, "question_id": 30745662, "link": "https://stackoverflow.com/questions/30745662/define-method-in-a-class-method", "title": "define_method in a class method", "body": "<p>In the following code, the module is extended which means the method hash_initialized is treated as a class method, or an instance method of the eigen class. This is what we need since hash_initialized is called in the context of the eigen class. </p>\n\n<p>What i don't understand is if the context for the module is the eigen class, then define_method should create a instance method called \"initialize\" of the eigen class, or in other words, a class method of class Cheese. Don't we need an instance method \"initialize\" here?</p>\n\n<pre><code>module HashInitialized\n  def hash_initialized(*fields)\n    define_method(:initialize) do |h|\n        missing = fields - h.keys\n      raise Exception, \"Not all fields set: #{missing}\" if missing.any?\n\n      h.each do |k,v|\n        instance_variable_set(\"@#{k}\", v) if fields.include?(k) \n      end\n    end\n  end\nend\n\nclass Cheese\n  extend HashInitialized\n  attr_accessor :color, :odor, :taste\n  hash_initialized :color, :odor, :taste\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 5428, "user_id": 1938097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/928c1abb5e28975cff71561ce3ed98d6?s=128&d=identicon&r=PG", "display_name": "Austio", "link": "https://stackoverflow.com/users/1938097/austio"}, "is_accepted": true, "score": 2, "last_activity_date": 1433900703, "creation_date": 1433900703, "answer_id": 30745715, "question_id": 30745612, "link": "https://stackoverflow.com/questions/30745612/is-there-a-good-rails-gem-to-update-the-database-real-time-securely-using-user-i/30745715#30745715", "title": "Is there a good Rails gem to update the database real-time securely using user input?", "body": "<p>There is no gem that will do all of that for you, you will need to use a frontend framework like angular/ember/react or roll your own with jquery or javascript, then set the database to respond to json and do authorization/authentication on all of the web requests.  </p>\n"}], "owner": {"reputation": 6449, "user_id": 734776, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a14a4787565a4dc11131e5ec3b0a534a?s=128&d=identicon&r=PG", "display_name": "THpubs", "link": "https://stackoverflow.com/users/734776/thpubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 30745715, "answer_count": 1, "score": -3, "last_activity_date": 1478791976, "creation_date": 1433899972, "last_edit_date": 1478791976, "question_id": 30745612, "link": "https://stackoverflow.com/questions/30745612/is-there-a-good-rails-gem-to-update-the-database-real-time-securely-using-user-i", "title": "Is there a good Rails gem to update the database real-time securely using user input?", "body": "<p>I need to update the right record in the database safely (without letting the user tampering with the data and updating the wrong record) in real time. So if the user enter some data to the input field, it should be sent to the server. Server need to update the data and send any validation errors back to the user. Is this possible and is there a good known gem for this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "comments": [{"owner": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1433899015, "post_id": 30745400, "comment_id": 49546366, "body": "What is the issue? In your before_action, you need to return <code>false</code> to prevent the action being called."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 6165, "user_id": 2697183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65255fe741b95ba0c641d96ea6750ea9?s=128&d=identicon&r=PG&f=1", "display_name": "AbM", "link": "https://stackoverflow.com/users/2697183/abm"}, "edited": false, "score": 0, "creation_date": 1433908530, "post_id": 30745400, "comment_id": 49548518, "body": "Is there a way I can check that? I am trying to figure out a way to rewrite the <code>correct_user</code> @AbM so that only the user who created the habit can create or destroy in the DaysMissedController."}, {"owner": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "edited": false, "score": 0, "creation_date": 1433918191, "post_id": 30745400, "comment_id": 49551929, "body": "Can you explain what &quot;missed_days&quot; is in relation to habit? Is it a field? A related model?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "edited": false, "score": 0, "creation_date": 1433951882, "post_id": 30745400, "comment_id": 49575636, "body": "Yea @LannyBose I updated the question now :)"}], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1433956153, "post_id": 30761831, "comment_id": 49578363, "body": "Thanks Lanny putting it in english makes more sense to me :) I got an error tho with your code hopefully we can figure it out. I added it to the question."}, {"owner": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "reply_to_user": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1433959593, "post_id": 30761831, "comment_id": 49580460, "body": "By reading the error, it appears that the params hash is more specific than either you or I were being... it&#39;s sending params[:habit_id]. Edited above."}, {"owner": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "reply_to_user": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 1, "creation_date": 1433962095, "post_id": 30761831, "comment_id": 49582035, "body": "You bet! Happy Rails-ing! :)"}], "tags": [], "owner": {"reputation": 1682, "user_id": 4219209, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8f3e6158829f78389b3d364ae4a247bf?s=128&d=identicon&r=PG", "display_name": "Lanny Bose", "link": "https://stackoverflow.com/users/4219209/lanny-bose"}, "is_accepted": true, "score": 1, "last_activity_date": 1433959631, "last_edit_date": 1433959631, "creation_date": 1433952842, "answer_id": 30761831, "question_id": 30745400, "link": "https://stackoverflow.com/questions/30745400/how-to-only-let-correct-user-create-or-destroy/30761831#30761831", "title": "How to only let correct_user create or destroy?", "body": "<p>So I believe you've correctly identified that the problem lies within your correct_user method:</p>\n\n<pre><code>def correct_user\n  @habit = current_user.habits.missed_days.find_by(id: params[:id])\n  redirect_to habits_path, notice: \"Not authorized to edit this habit\" if @habit.nil?\nend\n</code></pre>\n\n<p>Take a look at your first line, here's what I read in English:</p>\n\n<ul>\n<li>Take the current User</li>\n<li>Get that User's Habits</li>\n<li>Get those Habits' MissedDays</li>\n<li>Find me one of those missed days that matches params[:id]</li>\n</ul>\n\n<p>Which, based on your data model, is sort of non-sensical. Missed Days is an <strong>attribute</strong> of a model, not a model itself. I'm not sure you can even call .find_by on a number, which makes it unsurprising that you keep getting nil.</p>\n\n<p>I bet this'll work instead:</p>\n\n<pre><code>@habit = current_user.habits.find(params[:habit_id])\n</code></pre>\n\n<p><em>Note that the find method always queries by the id attribute. Saved you a few characters. :)</em></p>\n\n<p>One other thing, in both create and destroy, you re-find the habit that you already found in the before_action. Try this:</p>\n\n<pre><code>def create\n  @habit.missed_days = habit.missed_days + 1\n  @habit.save\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 30761831, "answer_count": 1, "score": 1, "last_activity_date": 1433959631, "creation_date": 1433898347, "last_edit_date": 1433956203, "question_id": 30745400, "link": "https://stackoverflow.com/questions/30745400/how-to-only-let-correct-user-create-or-destroy", "title": "How to only let correct_user create or destroy?", "body": "<p>How can we get it where only the <code>correct_user</code> can create or destroy here?</p>\n\n<pre><code>class DaysMissedController &lt; ApplicationController\n  before_action :logged_in_user, only: [:create, :destroy]\n  before_action :correct_user, only: [:create, :destroy]\n\n  def create\n    habit = Habit.find(params[:habit_id])\n    habit.missed_days = habit.missed_days + 1\n    habit.save!\n    level = habit.levels.find(params[:level_id])\n    level.missed_days = level.missed_days + 1\n    if level.missed_days == 3\n      level.missed_days = 0\n      level.days_lost += habit.calculate_days_lost + 1\n    end\n    level.save!\n    head :ok\n  end\n\n  def destroy\n    habit = Habit.find(params[:habit_id])\n    habit.missed_days = habit.missed_days - 1\n    habit.save\n    level = habit.levels.find(params[:level_id])\n    level.missed_days = level.missed_days - 1\n    level.save!\n    head :ok\n  end\n\nprivate\n\n  def correct_user\n    @habit = current_user.habits.missed_days.find_by(id: params[:id]) #I've tried different versions of this line\n    redirect_to habits_path, notice: \"Not authorized to edit this habit\" if @habit.nil?\n  end\nend\n</code></pre>\n\n<p>Depending on what I put in the line where I commented I either get <code>\"Not authorized to edit this habit\"</code> or upon refreshing the page the checkmark I had made disappears even if I am the <code>correct_user</code></p>\n\n<p><strong>habit.js</strong></p>\n\n<pre><code>$(document).ready(function()\n{\n  $(\".habit-check\").change(function()\n  {\n    habit = $(this).parent().siblings(\".habit-id\").first().attr(\"id\");\n    level = $(this).siblings(\".level-id\").first().attr(\"id\");\n    if($(this).is(\":checked\"))\n    {\n       $.ajax(\n       {\n         url: \"/habits/\" + habit + \"/levels/\" + level + \"/days_missed\",\n         method: \"POST\"\n       });\n    }\n    else\n    {\n       $.ajax(\n       {\n         url: \"/habits/\" + habit + \"/levels/\" + level + \"/days_missed/1\",\n         method: \"DELETE\"\n       });\n    }\n  });\n});\n</code></pre>\n\n<p>In habit <strong>show page</strong> this is what I don't want other users to be able to edit via <code>:create</code> &amp; <code>:destroy</code>:</p>\n\n<pre><code> &lt;% if @habit.current_level_strike %&gt; \n    &lt;div class=\"btn\" id=\"red\"&gt; &lt;label id=\"&lt;%= @habit.id %&gt;\" class=\"habit-id\"&gt;Strikes:&lt;/label&gt;\n  &lt;% else %&gt; \n    &lt;div class=\"btn\" id=\"gold\"&gt; &lt;label id=\"&lt;%= @habit.id %&gt;\" class=\"habit-id-two\"&gt;Strikes:&lt;/label&gt;\n  &lt;% end %&gt;\n    &lt;% @habit.levels.each_with_index do |level, index| %&gt;\n      &lt;% if @habit.current_level &gt;= (index + 1) %&gt;\n        &lt;p&gt;\n          &lt;% if @habit.current_level_strike %&gt; \n            &lt;label id=\"&lt;%= level.id %&gt;\" class=\"level-id\"&gt;Level &lt;%= index + 1 %&gt;:&lt;/label&gt; \n          &lt;% else %&gt; \n            &lt;label id=\"&lt;%= level.id %&gt;\" class=\"level-id-two\"&gt;Level &lt;%= index + 1 %&gt;:&lt;/label&gt; \n          &lt;% end %&gt;\n          &lt;%= check_box_tag nil, true, level.missed_days &gt; 0, {class: \"habit-check\"} %&gt;\n          &lt;%= check_box_tag nil, true, level.missed_days &gt; 1, {class: \"habit-check\"} %&gt;\n          &lt;%= check_box_tag nil, true, level.missed_days &gt; 2, {class: \"habit-check\"} %&gt;\n       &lt;/p&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p><strong>rails console</strong> </p>\n\n<pre><code>[2] pry(main)&gt; Habit.find(1)\n  Habit Load (17.7ms)  SELECT  \"habits\".* FROM \"habits\" WHERE \"habits\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n=&gt; #&lt;Habit:0x007f96c7133728\n id: 1,\n conceal: false,\n missed_days: 0,\n likes: 1,\n committed: [\"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"\"],\n date_started: Sun, 07 Jun 2015 00:00:00 UTC +00:00,\n trigger: \"\",\n action: \"test\",\n target: \"\",\n reward: \"\",\n private_submit: nil,\n user_id: 1,\n created_at: Sun, 07 Jun 2015 21:57:04 UTC +00:00,\n updated_at: Wed, 10 Jun 2015 00:45:05 UTC +00:00,\n order: nil&gt;\n[3] pry(main)&gt; Level.find(1)\n  Level Load (14.0ms)  SELECT  \"levels\".* FROM \"levels\" WHERE \"levels\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n=&gt; #&lt;Level:0x007f96c7838c80\n id: 1,\n habit_id: 1,\n missed_days: 0,\n current_level: nil,\n created_at: Sun, 07 Jun 2015 21:57:04 UTC +00:00,\n updated_at: Wed, 10 Jun 2015 00:45:05 UTC +00:00,\n days_lost: 0&gt;\n[4] pry(main)&gt;\n</code></pre>\n\n<p><strong>habits_controller</strong></p>\n\n<pre><code>class HabitsController &lt; ApplicationController\n  before_action :set_habit, only: [:show, :edit, :update, :destroy, :like]\n  before_action :logged_in_user, only: [:create, :destroy]\n  before_action :correct_user, only: [:edit, :update, :destroy]\n\n  def index\n    if params[:tag]\n      @habits = Habit.tagged_with(params[:tag])\n    else\n      @habits = current_user.habits.order(\"date_started DESC\")\n    end\n  end\n\n  def show\n    @habit = Habit.find(params[:id])\n    @notable = @habit\n    @notes = @notable.notes\n    @note = Note.new\n    @commentable = @habit\n    @comments = @commentable.comments\n    @comment = Comment.new\n    @correct_user = current_user.habits.find_by(id: params[:id])\n  end\n\n  def new\n    @habit = current_user.habits.build\n  end\n\n  def edit\n  end\n\n  def create\n    @habit = current_user.habits.build(habit_params)\n    if (params[:commit] == 'conceal')\n      @habit.conceal = true\n      @habit.save_with_current_level\n      redirect_to @habit, notice: 'Habit was successfully created'\n    elsif\n      @habit.save_with_current_level\n      track_activity @habit\n      redirect_to @habit, notice: 'Habit was successfully created'\n    else\n      flash.now[:danger] = 'Required Fields: \"Committed to\", \"Started\", and \"Enter Habit\"'\n      render 'new'\n    end\n  end\n\n  def update\n    if @habit.update(habit_params)\n      redirect_to @habit, notice: 'Habit was successfully updated.'\n    else\n      render action: 'edit'\n    end\n  end\n\n  def destroy\n    @habit.destroy\n    redirect_to habits_url\n  end\n\n  def like\n    @habit = Habit.find(params[:id])\n    @habit_like = current_user.habit_likes.build(habit: @habit)\n    if @habit_like.save\n      @habit.increment!(:likes)\n      flash[:success] = 'Thanks for liking!'\n    else\n      flash[:error] = 'Two many likes'\n    end  \n      redirect_to(:back)\n  end\n\n  private\n    def set_habit\n      @habit = Habit.find(params[:id])\n    end\n\n    def correct_user\n      @habit = current_user.habits.find_by(id: params[:id])\n      redirect_to habits_path, notice: \"Not authorized to edit this habit\" if @habit.nil?\n    end\n\n  def habit_params\n    params.require(:habit).permit(\n      :user_id, \n      :trigger,\n      :tag_list,\n      :current_level,\n      :missed_days,\n      :target, \n      :reward,\n      :comment,\n      :commentable,\n      :like,\n      :likeable,\n      :private,\n      :action,\n      :order,\n      :date_started,\n      :missed_one,\n      :notes_text,\n      :notes_date, \n      :notable, \n      :note, \n      :committed =&gt; [],\n      levels_attributes: [\n      :missed_days,\n      :days_lost], notes_attributes: [:notable, :note, :notes_text, :notes_date, :_destroy])\n  end\nend\n</code></pre>\n\n<p>Here's the <strong><a href=\"https://gist.github.com/RallyWithGalli/c66dee6dfb9ab5d338c2\" rel=\"nofollow\">gist of it</a></strong> (not fully updated but you get the idea)</p>\n\n<p>Please let me know if you need further explanation or code to help you help me :)</p>\n\n<h2>UPDATE ERROR</h2>\n\n<pre><code>Started POST \"/habits/1/levels/2/days_missed\" for 127.0.0.1 at 2015-06-10 13:07:11 -0400\nProcessing by DaysMissedController#create as */*\n  Parameters: {\"habit_id\"=&gt;\"1\", \"level_id\"=&gt;\"2\"}\n  User Load (0.2ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n  Habit Load (0.2ms)  SELECT \"habits\".* FROM \"habits\" WHERE \"habits\".\"user_id\" = ?  [[\"user_id\", 1]]\n  ActsAsTaggableOn::Tag Load (0.2ms)  SELECT \"tags\".* FROM \"tags\" WHERE (LOWER(name) = LOWER('ingrain'))\n  CACHE (0.0ms)  SELECT \"habits\".* FROM \"habits\" WHERE \"habits\".\"user_id\" = ?  [[\"user_id\", 1]]\n  Level Load (0.2ms)  SELECT \"levels\".* FROM \"levels\" WHERE \"levels\".\"habit_id\" = ?  [[\"habit_id\", 1]]\n   (0.2ms)  SELECT COUNT(*) FROM \"habits\" WHERE \"habits\".\"user_id\" = ?  [[\"user_id\", 1]]\nCompleted 404 Not Found in 21ms\n\nActiveRecord::RecordNotFound (Couldn't find Habit without an ID):\n  app/controllers/days_missed_controller.rb:32:in `correct_user'\n</code></pre>\n"}]