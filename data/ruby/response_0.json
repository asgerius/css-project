[{"tags": ["ruby-on-rails", "ruby", "sqlite", "railstutorial.org"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1420686339, "post_id": 27830727, "comment_id": 44070375, "body": "so what does that tell you?  if your schema already has it then you have an extra migration somewhere trying to add the column."}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 1, "creation_date": 1420707290, "post_id": 27830727, "comment_id": 44076842, "body": "Can you try migrating your DB to version=0 and then run &quot;rake db:migrate&quot;"}, {"owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "edited": false, "score": 0, "creation_date": 1420711558, "post_id": 27830727, "comment_id": 44079089, "body": "Or go to the migration you want to run and delete line that generates <code>remember_digest</code> column."}, {"owner": {"reputation": 98, "user_id": 3225814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jpr9X.jpg?s=128&g=1", "display_name": "intrigatory57", "link": "https://stackoverflow.com/users/3225814/intrigatory57"}, "reply_to_user": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1420738769, "post_id": 27830727, "comment_id": 44096297, "body": "@Abhinay That worked!! Thank you so much!!!"}, {"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1420739783, "post_id": 27830727, "comment_id": 44096848, "body": "please accept my answer if it solved your issue. thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "reply_to_user": {"reputation": 411, "user_id": 4583187, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/TLG0l.png?s=128&g=1", "display_name": "Rory Perro", "link": "https://stackoverflow.com/users/4583187/rory-perro"}, "edited": false, "score": 0, "creation_date": 1452837433, "post_id": 27846532, "comment_id": 57352927, "body": "@RoryPerro this answer will help you understand better: <a href=\"http://stackoverflow.com/a/13333716/2545197\">stackoverflow.com/a/13333716/2545197</a>"}, {"owner": {"reputation": 329, "user_id": 7237147, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6f543ab940c1a271e59d435fcebd6021?s=128&d=identicon&r=PG&f=1", "display_name": "That dude", "link": "https://stackoverflow.com/users/7237147/that-dude"}, "edited": false, "score": 0, "creation_date": 1558259340, "post_id": 27846532, "comment_id": 99034884, "body": "@Abhinay you should now you are awesome"}], "tags": [], "owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "is_accepted": true, "score": 14, "last_activity_date": 1420739759, "creation_date": 1420739759, "answer_id": 27846532, "question_id": 27830727, "link": "https://stackoverflow.com/questions/27830727/sqlite3sqlexception-duplicate-column-name-while-migrating/27846532#27846532", "title": "SQLite3::SQLException: duplicate column name while migrating", "body": "<p>try migrating your DB to version=0\nwith command: <code>rake db:migrate VERSION=0</code></p>\n\n<p>and then run \n<code>rake db:migrate</code> </p>\n"}], "owner": {"reputation": 98, "user_id": 3225814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Jpr9X.jpg?s=128&g=1", "display_name": "intrigatory57", "link": "https://stackoverflow.com/users/3225814/intrigatory57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6357, "favorite_count": 3, "accepted_answer_id": 27846532, "answer_count": 1, "score": 3, "last_activity_date": 1420739759, "creation_date": 1420674425, "question_id": 27830727, "link": "https://stackoverflow.com/questions/27830727/sqlite3sqlexception-duplicate-column-name-while-migrating", "title": "SQLite3::SQLException: duplicate column name while migrating", "body": "<p>I am currently following the Ruby on Rails Tutorial and I am at <a href=\"https://www.railstutorial.org/book/updating_and_deleting_users#sec-administrative_users\" rel=\"nofollow\">https://www.railstutorial.org/book/updating_and_deleting_users#sec-administrative_users</a> Every time I run bundle exec rake db:migrate I get the following error:     </p>\n\n<pre><code>SQLite3::SQLException: duplicate column name: remember_digest: ALTER TABLE \"users\" ADD   \"remember_digest\" varchar/home/mclacs14/.rvm/gems/ruby-2.0.0-p481@railstutorial_rails_4_0/gems/sqlite3-1.3.9/lib/sqlite3/database.rb:91:in `initialize'\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "mocking"], "comments": [{"owner": {"reputation": 71, "user_id": 4418097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6252d8c9d892f292965569d89b52b0?s=128&d=identicon&r=PG", "display_name": "Oguz Huner", "link": "https://stackoverflow.com/users/4418097/oguz-huner"}, "edited": false, "score": 0, "creation_date": 1420672070, "post_id": 27830167, "comment_id": 44066547, "body": "Can&#39;t you put :foo, :bar, :baz in an array?"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 71, "user_id": 4418097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b6252d8c9d892f292965569d89b52b0?s=128&d=identicon&r=PG", "display_name": "Oguz Huner", "link": "https://stackoverflow.com/users/4418097/oguz-huner"}, "edited": false, "score": 0, "creation_date": 1420679281, "post_id": 27830167, "comment_id": 44068696, "body": "No, it doesn&#39;t match."}], "answers": [{"comments": [{"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1420679390, "post_id": 27830654, "comment_id": 44068714, "body": "This works. It seems weird to create the array and then use an operator to remove it..."}], "tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": true, "score": 3, "last_activity_date": 1420673969, "creation_date": 1420673969, "answer_id": 27830654, "question_id": 27830167, "link": "https://stackoverflow.com/questions/27830167/how-to-use-let-with-multiple-params-in-rspec-expectation/27830654#27830654", "title": "How to use let with multiple params in RSpec expectation?", "body": "<p>Put the params in an array and use a splat if you want to do something like that. Also, since you're mocking <code>qux</code> you're going to have to stub out the <code>use</code> method:</p>\n\n<pre><code>RSpec.describe 'Spec' do\n    let( :qux    ){ double 'qux' }\n    let( :params ){ [:foo, :bar, :baz] }\n\n    specify 'success' do\n      qux.stub(:use)\n      qux.use :foo, :bar, :baz\n      expect( qux ).to have_received( :use ).with *params\n    end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "edited": false, "score": 0, "creation_date": 1420679325, "post_id": 27830988, "comment_id": 44068702, "body": "This is helpful. Unfortunately, an array is different from the 3 elements."}], "tags": [], "owner": {"reputation": 1468, "user_id": 2057700, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc3457b0253983abc2427306e89114e1?s=128&d=identicon&r=PG&f=1", "display_name": "ianks", "link": "https://stackoverflow.com/users/2057700/ianks"}, "is_accepted": false, "score": 1, "last_activity_date": 1420676137, "creation_date": 1420676137, "answer_id": 27830988, "question_id": 27830167, "link": "https://stackoverflow.com/questions/27830167/how-to-use-let-with-multiple-params-in-rspec-expectation/27830988#27830988", "title": "How to use let with multiple params in RSpec expectation?", "body": "<p><code>let(:var) { .. }</code> is easy to misinterpret, but it's actually pretty simple. You are evaluating a Ruby block, and whatever is returned from the let Ruby block gets assigned to :var.</p>\n\n<p>With that in mind, you need to return an <em>actual</em> Ruby object from the let block.</p>\n\n<p>Try this:</p>\n\n<pre><code>let(:params) do\n  [:foo, :bar, :baz]\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 1, "last_activity_date": 1420711823, "last_edit_date": 1420711823, "creation_date": 1420710913, "answer_id": 27837239, "question_id": 27830167, "link": "https://stackoverflow.com/questions/27830167/how-to-use-let-with-multiple-params-in-rspec-expectation/27837239#27837239", "title": "How to use let with multiple params in RSpec expectation?", "body": "<p>In <a href=\"http://www.relishapp.com/rspec/rspec-mocks/v/3-1/docs/basics/expecting-messages\" rel=\"nofollow\">Rspec 3.0 or greater</a>, you must need to write it as</p>\n\n<pre><code>require 'rspec'\n\nRSpec.describe 'Spec' do\n  let( :qux    ) { double 'qux' }\n  let( :params ) { [:foo, :bar, :baz] }\n\n  it 'success' do\n    expect(qux).to receive(:use).with(*params)\n    qux.use(*params)\n  end\nend\n</code></pre>\n\n<p>And when I'll run this test :-</p>\n\n<pre><code>Arup-iMac:arup_ruby$ rspec spec/test_spec.rb\n.\n\nFinished in 0.04997 seconds (files took 0.0904 seconds to load)\n1 example, 0 failures\n</code></pre>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4466, "favorite_count": 1, "accepted_answer_id": 27830654, "answer_count": 3, "score": 2, "last_activity_date": 1420711823, "creation_date": 1420671376, "question_id": 27830167, "link": "https://stackoverflow.com/questions/27830167/how-to-use-let-with-multiple-params-in-rspec-expectation", "title": "How to use let with multiple params in RSpec expectation?", "body": "<pre><code>  describe 'Spec' do\n    let( :qux    ){ double 'qux' }\n    let( :params ){ :foo, :bar, :baz }\n\n    specify 'success' do\n      qux.use :foo, :bar, :baz\n\n      expect( qux ).to have_received( :use ).with params\n</code></pre>\n\n<p>This generates a syntax error because <code>:foo, :bar, :baz</code> is not valid Ruby.</p>\n\n<p>What is a good way to do this?</p>\n"}, {"tags": ["ruby", "json", "ruby-on-rails-4", "sqlite", "rake"], "answers": [{"tags": [], "owner": {"reputation": 1468, "user_id": 2057700, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc3457b0253983abc2427306e89114e1?s=128&d=identicon&r=PG&f=1", "display_name": "ianks", "link": "https://stackoverflow.com/users/2057700/ianks"}, "is_accepted": true, "score": 1, "last_activity_date": 1420674749, "creation_date": 1420674749, "answer_id": 27830780, "question_id": 27829971, "link": "https://stackoverflow.com/questions/27829971/rake-dbseed-you-must-pass-a-hash-as-an-argument-trying-to-insert-json/27830780#27830780", "title": "Rake db:seed you must pass a hash as an argument - Trying to insert json", "body": "<p>When you loop though the JSON, you will be looping through each key and value within the JSON. This is not what you want. You want to create one character from the data.</p>\n\n<p>It would look something like this:</p>\n\n<pre><code>char_data = JSON.parse(File.read(\"#{Rails.root}/app/assets/seed/netfive.json\"))\nCharacter.create char_data\n</code></pre>\n\n<p>You will have to be careful with data types when you are doing this. i.e. You might have an issue saving <code>items</code> as a String. I would instead look at serializing that data. </p>\n\n<p>Here is a reference for serialization: <a href=\"http://apidock.com/rails/ActiveRecord/AttributeMethods/Serialization/ClassMethods/serialize\" rel=\"nofollow\">http://apidock.com/rails/ActiveRecord/AttributeMethods/Serialization/ClassMethods/serialize</a></p>\n"}], "owner": {"reputation": 113, "user_id": 2834616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100005473592135/picture?type=large", "display_name": "Kevin Ferm", "link": "https://stackoverflow.com/users/2834616/kevin-ferm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 2, "accepted_answer_id": 27830780, "answer_count": 1, "score": 0, "last_activity_date": 1420720879, "creation_date": 1420670439, "last_edit_date": 1420720879, "question_id": 27829971, "link": "https://stackoverflow.com/questions/27829971/rake-dbseed-you-must-pass-a-hash-as-an-argument-trying-to-insert-json", "title": "Rake db:seed you must pass a hash as an argument - Trying to insert json", "body": "<p>I have this json file that I want to put into a database, here it is, <a href=\"http://pastebin.com/m3GsTfdi\" rel=\"nofollow\">http://pastebin.com/m3GsTfdi</a></p>\n\n<p>This is the migration file for the table that I want to store this information in;</p>\n\n<pre><code>create_table :characters do |t|\n  t.string :name\n  t.string :region\n  t.string :realm\n  t.integer :class\n  t.integer :race\n  t.integer :level\n  t.integer :achievementPoints\n  t.string :items\n  t.string :stats\n  t.string :hunterPets\n  t.string :talents\n  t.string :progresison\n\n  t.timestamps null: false\nend\n</code></pre>\n\n<p>And this is how I'm trying to insert a character through seed.rb</p>\n\n<pre><code>JSON.parse(open(\"#{Rails.root}/app/assets/seed/netfive.json\").read).each do |chardata|\n  Character.create(chardata)\nend\n</code></pre>\n\n<p>However I'm getting the error \n\"ArgumentError: When assigning attributes, you must pass a hash as an argument.\"\nwhen I run rake db:seed.</p>\n\n<p>How should I fix it? I'm thinking it's something to do with I'm trying to save an array where it should be a string, but I'm not sure how else to do it.</p>\n\n<p>Edit:\nI managed to fix it doing the seed like this instead;</p>\n\n<pre><code>char_data = JSON.parse(File.read(\"#{Rails.root}/app/assets/seed/netfive.json\"))\nCharacter.new({\n                     name:char_data['name'],\n                     realm:char_data['realm'],\n                     charClass:char_data['class'],\n                     race:char_data['race'],\n                     level:char_data['level'],\n                     achievementPoints:char_data['achievementPoints'],\n                     items:char_data['items'],\n                     stats:char_data['stats'],\n                     hunterPets:char_data['hunterPets'],\n                     talents:char_data['talents'],\n                     progression:char_data['progression'],\n                 }).save\n</code></pre>\n\n<p>I did also use serialization that was previously linked in a comment.</p>\n\n<p>Thank for the help!</p>\n"}, {"tags": ["ruby", "multithreading", "process", "fork"], "answers": [{"tags": [], "owner": {"reputation": 227, "user_id": 3678031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B3Eeo.jpg?s=128&g=1", "display_name": "Mike Goldin", "link": "https://stackoverflow.com/users/3678031/mike-goldin"}, "is_accepted": false, "score": 0, "last_activity_date": 1420838242, "creation_date": 1420838242, "answer_id": 27869391, "question_id": 27829954, "link": "https://stackoverflow.com/questions/27829954/communicating-between-ruby-processes-loops/27869391#27869391", "title": "Communicating between Ruby processes, loops", "body": "<p>Forking may indeed be a good solution for you, and you only need to understand three system calls to make good use of it: fork(), waitpid() and exec(). I'm not a Ruby guy, so hopefully my C-like explanation will make enough sense for you to fill in the blanks.</p>\n\n<p>The way <strong>fork()</strong> works is by the operating system making a byte-for-byte copy of the calling process' virtual memory space as it was when fork() was called and carving out new memory to place the copy into. This creates a new process with its parent's exact state--except for that the child process' fork() call returns 0, while the parent's returns the PID of the new child process. This allows the child process to know that it is a child, and the parent process to know who its children are.</p>\n\n<p>While fork() copies its caller's process image, the <strong>exec()</strong> system call replaces its caller's process image with a brand new one, as specified by its arguments.</p>\n\n<p>The <strong>waitpid()</strong> system call is used by the parent process to wait for a return value from a specific child process (one whose process ID was returned to the parent by the fork() call), and then properly log the process' completion with the OS. Even if you don't need your child process' return value, you should call waitpid() on it anyway so you don't end up accumulating \"zombie processes.\"</p>\n\n<p>Again, I'm not a Ruby guy, so hopefully my C-like pseudocode makes sense. Consider the following server:</p>\n\n<pre><code>while(1) { # an infinite loop\n  # Wait for and accept connections from your web API.\n  pid = fork(); # fork() returns a process ID number\n\n  # If fork() returns a negative number, something went wrong.\n  if(pid &lt; 0) {\n    exit(1);\n  }\n\n  # If fork() returns 0, this is the child process.\n  else if(pid == 0) {\n    # Remember that because fork() copies your program's state,\n    # you can use variables you assigned before the fork to\n    # send to the new process as arguments.\n    exec(./processingscript.rb, \"processingscript.rb\", arg1, arg2, arg3, ...);\n  }\n\n  # If fork() returns a number greater than 0 (the PID of the forked\n  # child process), this is the parent process.\n  else if(pid &gt; 0) {\n    childreturnvalue = waitpid(pid); # parent process hangs here until\n                                     # the process with the ID number\n                                     # pid returns.    \n  }\n}\n</code></pre>\n\n<p>Written this way, your CPU-intenive script only runs when a connection is received from the web API. It does its processing and then terminates, waiting to be called again. You can also specify \"no hang\" options for waitpid() so that you can fork multiple instances of your processing script concurrently without having your server hang every time it needs to wait for an instance of that script to complete.</p>\n\n<p>Hope this helps! Perhaps somebody who knows Ruby can edit this to be a bit more idiomatic to the language.</p>\n"}], "owner": {"reputation": 1, "user_id": 4430791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8326ab68cbea2a78dd17509948308c6b?s=128&d=identicon&r=PG&f=1", "display_name": "George Berunt", "link": "https://stackoverflow.com/users/4430791/george-berunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420838242, "creation_date": 1420670371, "last_edit_date": 1420675915, "question_id": 27829954, "link": "https://stackoverflow.com/questions/27829954/communicating-between-ruby-processes-loops", "title": "Communicating between Ruby processes, loops", "body": "<p>I have a Ruby application which must run 24/7 to process information for a web API, both of which are operating on Google Compute Engine on a Debian Instance - the API is served by Sinatra. When I run this script in <code>loop</code>, it uses up the 1-core vCPU. Using a message queuing system like RabbitMQ to pass messages from the API to the backend script seems to me to skip a learning opportunity for communicating between Ruby scripts natively.</p>\n\n<ol>\n<li><p>How do I keep a script dormant, i.e. awaiting instruction but not consuming memory 99% CPU? I'm assuming it's not going to be in an infinite loop, but I'm stumped on this.</p></li>\n<li><p>How would it be best to communicate this message from one script to another? I read about Kernel#Select and forking of subprocesses, but I haven't encountered any definitive or comprehensible solution.</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "multiple-columns"], "comments": [{"owner": {"reputation": 1532, "user_id": 3209693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sXLfb.jpg?s=128&g=1", "display_name": "Kaspar", "link": "https://stackoverflow.com/users/3209693/kaspar"}, "edited": false, "score": 0, "creation_date": 1420673139, "post_id": 27829563, "comment_id": 44066933, "body": "<a href=\"http://stackoverflow.com/questions/4493337/design-pattern-to-add-columns-in-database-table-dynamically\" title=\"design pattern to add columns in database table dynamically\">stackoverflow.com/questions/4493337/&hellip;</a> Have a look at this."}], "answers": [{"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 0, "last_activity_date": 1420674965, "last_edit_date": 1420674965, "creation_date": 1420674592, "answer_id": 27830749, "question_id": 27829563, "link": "https://stackoverflow.com/questions/27829563/generating-new-columns-from-user-input/27830749#27830749", "title": "Generating New Columns from User Input?", "body": "<p>Consider this:</p>\n\n<pre><code>foo = [%w[action result month]] * 3\n# =&gt; [[\"action\", \"result\", \"month\"],\n#     [\"action\", \"result\", \"month\"],\n#     [\"action\", \"result\", \"month\"]]\n\nfoo.transpose\n# =&gt; [[\"action\", \"action\", \"action\"],\n#     [\"result\", \"result\", \"result\"],\n#     [\"month\", \"month\", \"month\"]]\n</code></pre>\n\n<p><a href=\"http://www.ruby-doc.org/core-2.2.0/Array.html#method-i-transpose\" rel=\"nofollow\"><code>transpose</code></a> is built-into Ruby's Array class. So, at a minimum, you can do your normal database requests to get the information you want into an array of values, then <code>transpose</code> it and output that how you want.</p>\n\n<blockquote>\n  <p>Does one make the change in the index or controller or model?</p>\n</blockquote>\n\n<p>I'd probably do it in the controller.</p>\n\n<p>How to get your bonus table is left to you as a bonus question.</p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 27830749, "answer_count": 1, "score": 0, "last_activity_date": 1420674965, "creation_date": 1420668731, "last_edit_date": 1420674414, "question_id": 27829563, "link": "https://stackoverflow.com/questions/27829563/generating-new-columns-from-user-input", "title": "Generating New Columns from User Input?", "body": "<p>Instead of my _form generating a new row for each new action how can I make it generate a new column?</p>\n\n<p>TABLE #1:</p>\n\n<pre><code>ACTION | RESULT | MONTH    \nACTION | RESULT | MONTH    \nACTION | RESULT | MONTH\n</code></pre>\n\n<p>TABLE #2:</p>\n\n<pre><code>ACTION | ACTION | ACTION    \nRESULT | RESULT | RESULT   \nMONTH  | MONTH  | MONTH\n</code></pre>\n\n<p>Does one make the change in the index or controller or model?</p>\n\n<p>My ultimate goal is to create a dynamic table where the user can see his improvement from month to month regarding his inputted action so for example if his action is \"Mile run\" then from one month to the next he would add his fastest mile time. I'm having a hard time with this because all the tutorials I've looked at adds new rows, not new rows and new columns.</p>\n\n<p>BONUS TABLE #3:</p>\n\n<pre><code>ACTION | ACTION | ACTION\nRESULT | RESULT | RESULT | MONTH (i.e. Jan)\nRESULT | RESULT | RESULT | MONTH (i.e. Dec)\nRESULT | RESULT | RESULT | MONTH (i.e. Nov)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml", "erb"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 3993224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7d81bb21dcc26acfecaa595c4a7511?s=128&d=identicon&r=PG&f=1", "display_name": "Kusha Tavakoli", "link": "https://stackoverflow.com/users/3993224/kusha-tavakoli"}, "is_accepted": false, "score": 4, "last_activity_date": 1420666993, "creation_date": 1420666993, "answer_id": 27829169, "question_id": 27829085, "link": "https://stackoverflow.com/questions/27829085/how-do-i-undo-rails-template-generation-in-haml/27829169#27829169", "title": "How do I undo Rails template generation in Haml?", "body": "<p>Turns out this was as simple as adding the following into <code>class Application</code> in the config/application.rb file:</p>\n\n<pre><code>config.generators do |g|\n   g.template_engine :erb\nend\n</code></pre>\n\n<p>Still not sure why the manual override was necessary, but it is. This fixes it.</p>\n"}], "owner": {"reputation": 181, "user_id": 3993224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea7d81bb21dcc26acfecaa595c4a7511?s=128&d=identicon&r=PG&f=1", "display_name": "Kusha Tavakoli", "link": "https://stackoverflow.com/users/3993224/kusha-tavakoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1420666993, "creation_date": 1420666681, "question_id": 27829085, "link": "https://stackoverflow.com/questions/27829085/how-do-i-undo-rails-template-generation-in-haml", "title": "How do I undo Rails template generation in Haml?", "body": "<p>I installed a new gem to my Rails project - 'phrasing' - which has gem dependencies on multiple Haml gems. I need the gem (it is adding some phenomenal functionality to my project), and need the dependencies to be installed, but now when I run <code>rails generate scaffold</code>, all of the view templates are generated in Haml rather than ERB. I need views to continue to be generated in ERB.</p>\n\n<p>I reviewed several previous StackOverflow articles, but most focus on converting TO Haml, and the answers around making sure that ERB is the default generator refer to removing lines from the config files, which are not there in my case (it appears that the gems are controlling the default layout format somehow).</p>\n\n<p>(<strong>Note:</strong> While I appreciate that there may be several advantages to using Haml, and I might consider using it in a new project, I'd like to keep this one consistent, and it's already 80% finished in ERB.)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 2, "creation_date": 1420687361, "post_id": 27828821, "comment_id": 44070584, "body": "I don&#39;t understand the OO design here.  Wouldn&#39;t a household have many users and a user belong to a household?  It seems like that would solve all your problems."}, {"owner": {"reputation": 5288, "user_id": 1408935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/530667b876aa80627eb484113f282ab5?s=128&d=identicon&r=PG", "display_name": "Sasha", "link": "https://stackoverflow.com/users/1408935/sasha"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1420736426, "post_id": 27828821, "comment_id": 44094928, "body": "Yeah. Sorry. That was dumb. I have a less self-explanatory data model, and figured it made sense to make up a simpler one to exemplify the issue here -- then I screwed it up. It&#39;s basically a has_many and belongs_to. I&#39;ll rewrite this question to better reflect my app. But the question still stands (whether or not it really applies to the above) -- are there good ways to delegate relation methods to other relations?"}], "owner": {"reputation": 5288, "user_id": 1408935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/530667b876aa80627eb484113f282ab5?s=128&d=identicon&r=PG", "display_name": "Sasha", "link": "https://stackoverflow.com/users/1408935/sasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420780848, "creation_date": 1420665498, "last_edit_date": 1420780848, "question_id": 27828821, "link": "https://stackoverflow.com/questions/27828821/ruby-delegating-class-relation-level-methods", "title": "Ruby delegating class/relation-level methods", "body": "<p><strong>EDIT</strong> -- <em>I changed the object-oriented modeling to better reflect the not-particularly-intuitive relationship in my app, (thanks, Anthony) so that this question makes more sense. Sorry about that.</em></p>\n\n<p>In my Rails app, I want certain models to be able to delegate to other models on not just an instance level but also a class/relation level. That is to say, assuming a <code>House</code> model, which <code>has_many</code> <code>Users</code> and defines a class-level method \"<code>addresses</code>\" that's called on relations of <code>houses</code>, I could do this:</p>\n\n<pre><code>users.addresses\n</code></pre>\n\n<p>Behind the scenes, this would actually do two things: 1) run <code>users.houses</code> (which would grab all houses with an ID among those plucked from the <code>house_id</code> column of the relation of users), and 2) call <code>addresses</code> on that relation of houses. </p>\n\n<p>My attempt currently looks something like this:</p>\n\n<pre><code>class House\n  has_many :users\n\n  def self.addresses\n    map(&amp;:address)\n  end\n\n  def address\n    \"#{street_address}, {state}, #{country}\"\n  end\nend\n\nclass User\n\n  belongs_to :house\n\n  delegate :address, to: :house\n\n  class &lt;&lt; self\n    delegate :addresses, to: :houses\n  end\n\n  def self.houses\n   Houses.where(id: pluck(:house_id))\n  end\n\n  ...\n\nend\n</code></pre>\n\n<p>This fundamentally seems to work -- almost. If I have a group of users, I can do <code>users.houses</code> and grab the associated relation of <code>houses</code>. If I call <code>addresses</code> on an unrelated relation of <code>houses</code>, the method works great. If I call, <code>users.addresses</code>, it calls the class-level method of that name in <code>houses.rb</code>. </p>\n\n<p><strong>But</strong>, the method errors when I try to chain these things together.</p>\n\n<p>If I call <code>users.addresses</code> (or <code>users.houses.addresses</code>, so delegation isn't the issue here per se), the <code>House.addresses</code> method is called, but within that method, <code>self</code> seems to be not the <strong>relation</strong> of houses that <code>users.houses</code> should (and generally does) return, but just the House class itself. Consequently, if I call any array methods on <code>self</code> within <code>addresses</code>  (which would work on a relation), the method throws an error such as <code>undefined method 'map' for &lt;Class:0x1230101239123&gt;</code>.</p>\n\n<p>This problem persists even if I take away my fancy class-level delegation logic and replace it with the explicit version:</p>\n\n<pre><code>class User\n  ...\n  def self.addresses\n    houses.addresses\n  end\nend\n</code></pre>\n\n<p>Same error. Also when I just try <code>users.houses.addresses</code>.</p>\n\n<p>The only version that <strong>does</strong> work is the following:</p>\n\n<pre><code>class User\n  ...\n  def self.addresses\n    houses.map(&amp;:address)\n  end\nend\n</code></pre>\n\n<p>In other words, the logic chain seems to be identical, but moving the <code>map</code> into the <code>User</code> method and out of the <code>House</code> method fixes things. </p>\n\n<p>I'm super confused by this, because to my eyes, that last (successful) version should fundamentally be identical to the two failing versions above. The only difference is that in the successful version, I'm repeating logic in a way I'd like to avoid.</p>\n\n<p>So I guess the questions are </p>\n\n<ul>\n<li><p><strong>1)</strong> Why is <code>users.houses</code> returning a relation, but <code>users.addresses</code> (and <code>users.houses.addresses</code>) suddenly calling <code>addresses</code> on the class rather than the relation? </p></li>\n<li><p><strong>2)</strong> Given these issues, is there a better, more Railsy way to set up the relationship between House and User such that I can run these class-level query methods (ie <code>users.houses</code>)?</p></li>\n</ul>\n\n<p>Any opinions on the best way to go about fixing this?</p>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "comments": [{"owner": {"reputation": 10736, "user_id": 2498956, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9eb217f1dbc6265004df4c2d4fb2f3e9?s=128&d=identicon&r=PG", "display_name": "August", "link": "https://stackoverflow.com/users/2498956/august"}, "edited": false, "score": 0, "creation_date": 1420666438, "post_id": 27828771, "comment_id": 44064052, "body": "You could traverse it: <code>document.traverse { |x| match = x if x.to_s == node_to_find }</code>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1420666996, "post_id": 27828771, "comment_id": 44064309, "body": "What&#39;s your question? How do you do it? Perhaps, if you understood better how to use CSS and XPath, you wouldn&#39;t want to do this? In particular, knowing CSS selectors is very useful when dealing with CSS and JavaScript, which are pretty much mandatory skills if you work with internet technologies these days. So those piggyback on each other."}, {"owner": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "edited": false, "score": 0, "creation_date": 1420667594, "post_id": 27828771, "comment_id": 44064581, "body": "#traverse would work even though the id&#39;s are unique?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "edited": false, "score": 0, "creation_date": 1420672609, "post_id": 27830230, "comment_id": 44066763, "body": "I wish I had enough SO points to upvote you! As for your question, I only care about being able to count the total # of descendent nodes. Would that be possible using your solution? I&#39;m sure it is with XML format (am currently trying to work that solution out now)."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "edited": false, "score": 0, "creation_date": 1420728164, "post_id": 27830230, "comment_id": 44089122, "body": "@DrewB: yes, you could use the <code>traverse</code> method again, on the matching node, to simply update a counter with each invocation.  Note that depending on exactly what you want to count (elements, nodes, etc) then you might want to check the node &quot;type&quot; as a predicate."}, {"owner": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "edited": false, "score": 0, "creation_date": 1420737764, "post_id": 27830230, "comment_id": 44095775, "body": "Are you aware of a gem that can convert HTML to xpath? I have a method that someone helped me with, but if there were some standard by which devs go about doing this - it may be better."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "edited": false, "score": 0, "creation_date": 1420740770, "post_id": 27830230, "comment_id": 44097349, "body": "@DrewB: nope, I don&#39;t know of any such gem.  It shouldn&#39;t be a terribly difficult thing to achieve, again depending on specifics.  I&#39;ll update my answer with some thoughts."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1420743165, "last_edit_date": 1420743165, "creation_date": 1420671680, "answer_id": 27830230, "question_id": 27828771, "link": "https://stackoverflow.com/questions/27828771/how-to-find-a-node-given-the-exact-html-tag-as-a-string-using-nokogiri/27830230#27830230", "title": "How to find a node given the exact HTML tag as a string (using Nokogiri)?", "body": "<p>As suggested by commenter @August, you could use <a href=\"http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Node#traverse-instance_method\" rel=\"nofollow\"><code>Node#traverse</code></a> to see if the string representation of any node matches the string form of your target node.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def find_node(html_document, html_fragment)\n  matching_node = nil\n  html_document.traverse do |node|\n    matching_node = node if node.to_s == html_fragment.to_s\n  end\n  matching_node\nend\n</code></pre>\n\n<p>Of course, this approach is fraught with problems that boil down to the <em>canonical representation</em> of the data (do you care about attribute ordering? specific syntax items like quotation marks?  whitespace?).</p>\n\n<p><strong>[Edit]</strong> Here's a prototype of converting an arbitrary HTML element to an XPath expression.  It needs some work but the basic idea (match any element with the node name, specific attributes, and possibly text child) should be a good starting place.</p>\n\n<pre><code>def html_to_xpath(html_string)\n  node = Nokogiri::HTML::fragment(html_string).children.first\n  has_more_than_one_child = (node.children.size &gt; 1)\n  has_non_text_child = node.children.any? { |x| x.type != Nokogiri::XML::Node::TEXT_NODE }\n  if has_more_than_one_child || has_non_text_child\n    raise ArgumentError.new('element may only have a single text child')\n  end\n  xpath = \"//#{node.name}\"\n  node.attributes.each do |_, attr|\n    xpath += \"[#{attr.name}='#{attr.value}']\" # TODO: escaping.\n  end\n  xpath += \"[text()='#{node.children.first.to_s}']\" unless node.children.empty?\n  xpath\nend\nhtml_to_xpath('&lt;title&gt;Wikipedia&lt;/title&gt;') # =&gt; \"//title[text()='Wikipedia']\"\nhtml_to_xpath('&lt;div id=\"foo\"&gt;Foo&lt;/div&gt;')  # =&gt; \"//div[id='foo'][text()='Foo']\"\nhtml_to_xpath('&lt;div&gt;&lt;br/&gt;&lt;/div&gt;') # =&gt; ArgumentError: element may only have a single text child\n</code></pre>\n\n<p>It seems possible that you could build an XPath from <em>any</em> HTML fragment (e.g. not restricted to those with only a single text child, per my prototype above) but I'll leave that as an exercise for the reader ;-)</p>\n"}], "owner": {"reputation": 87, "user_id": 4012502, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VWf2L.jpg?s=128&g=1", "display_name": "Drew B", "link": "https://stackoverflow.com/users/4012502/drew-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 27830230, "answer_count": 1, "score": 2, "last_activity_date": 1420743165, "creation_date": 1420665253, "last_edit_date": 1420667235, "question_id": 27828771, "link": "https://stackoverflow.com/questions/27828771/how-to-find-a-node-given-the-exact-html-tag-as-a-string-using-nokogiri", "title": "How to find a node given the exact HTML tag as a string (using Nokogiri)?", "body": "<p><strong>Question</strong></p>\n\n<p>I need to search a given web page for a particular node when given the exact HTML as a string. For instance, if given:</p>\n\n<pre><code>url = \"https://www.wikipedia.org/\"\nnode_to_find = \"&lt;title&gt;Wikipedia&lt;/title&gt;\"\n</code></pre>\n\n<p>I want to \"select\" the  node on the page (and eventually return its children and sibling nodes). I'm having trouble with the Nokogiri docs, and how to exactly go about this. It seems as though, most of the time, people want to use Xpath syntax or the #css method to find nodes that satisfy a set of conditions. I want to use the HTML syntax and just find the exact match within a webpage.</p>\n\n<hr>\n\n<p><strong>Possible start of a solution?</strong></p>\n\n<p>If I create two Nokogiri::HTML::DocumentFragment objects, they look similar but do not match due to the memory id being different. I think this might be a precursor to solving it?</p>\n\n<pre><code>irb(main):018:0&gt; n = Nokogiri::HTML::DocumentFragment.parse(&lt;title&gt;Wikipedia&lt;/title&gt;\").child\n\n=&gt; #&lt;Nokogiri::XML::Element:0x47e7e4 name=\"title\" children=[ &lt;Nokogiri::XML::Text:0x47e08c \"Wikipedia\"&gt;]&gt;\n\nirb(main):019:0&gt; n.class\n\n=&gt; Nokogiri::XML::Element\n</code></pre>\n\n<p>Then I create a second one using the exact same arguments. Compare them - it returns false:</p>\n\n<pre><code>irb(main):020:0&gt; x = Nokogiri::HTML::DocumentFragment.parse(\"&lt;title&gt;Wikipedia&lt;/title&gt;\").child \n\n=&gt; #&lt;Nokogiri::XML::Element:0x472958 name=\"title\" children=[#&lt;Nokogiri::XML::Text:0x4724a8 \"Wikipedia\"&gt;]&gt;\n\nirb(main):021:0&gt; n == x\n\n=&gt; false\n</code></pre>\n\n<p>So I'm thinking that if I can somehow create a method that can find matches like this, then I can perform operations of that node. In particular - I want to find the descendents (children and next sibling).</p>\n\n<p><strong>EDIT</strong>: I should mention that I have a method in my code that creates a Nokogiri::HTML::Document object from a given URL. So - that will be available to compare with.</p>\n\n<pre><code>class Page\nattr_accessor :url, :node, :doc, :root\n\ndef initialize(params = {})\n  @url = params.fetch(:url, \"\").to_s\n  @node = params.fetch(:node, \"\").to_s\n  @doc = parse_html(@url)\nend\n\ndef parse_html(url)\n  Nokogiri::HTML(open(url).read)  \nend\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["ruby", "arrays", "hash"], "comments": [{"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "edited": false, "score": 0, "creation_date": 1420665508, "post_id": 27828632, "comment_id": 44063584, "body": "Just a fun note: if the ids are not strictly necessary, I recommend using  a <code>Set</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1420665129, "post_id": 27828709, "comment_id": 44063394, "body": "Ahah 41 seconds ahead and the only difference between your answer and mine is the usage of <code>reject</code>/<code>select</code>! You got the credits ;)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1420686960, "post_id": 27828709, "comment_id": 44070511, "body": "Alterntively, <code>eaten_ids = EATEN.flat_map { |burger| burger.values }</code>, so that you needn&#39;t change that line if key names in <code>EATEN</code>&#39;s hashes are changed."}, {"owner": {"reputation": 103, "user_id": 1910067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10061b5904b6c00a4b10647b96f0d69b?s=128&d=identicon&r=PG", "display_name": "pmannion", "link": "https://stackoverflow.com/users/1910067/pmannion"}, "edited": false, "score": 0, "creation_date": 1420709484, "post_id": 27828709, "comment_id": 44077958, "body": "Exactly what I wanted."}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": true, "score": 5, "last_activity_date": 1420665015, "creation_date": 1420665015, "answer_id": 27828709, "question_id": 27828632, "link": "https://stackoverflow.com/questions/27828632/compare-two-arrays-of-hashes-and-return-new-object/27828709#27828709", "title": "Compare two arrays of hashes and return new object", "body": "<p>You're close, to make it easy I'd snag all the \"eaten\" ids into an array, and check for inclusion in that array, like so:</p>\n\n<pre><code>BURGERS = [\n            {:id =&gt; 1, :name =&gt; \"cheese burger\"},\n            {:id =&gt; 2, :name =&gt; \"royale\"},\n            {:id =&gt; 3, :name =&gt; \"big mac\"},\n            {:id =&gt; 4, :name =&gt; \"angus beef\"}\n          ]\n\nEATEN = [\n          {:burger_id =&gt; 1},\n          {:burger_id =&gt; 2}\n        ]\n\ndef burgers_not_eaten\n  eaten_ids = EATEN.map { |e| e[:burger_id] }\n  BURGERS.reject { |burger| eaten_ids.include?(burger[:id]) }\nend\n\nburgers_not_eaten\n# =&gt; [{:id=&gt;3, :name=&gt;\"big mac\"}, {:id=&gt;4, :name=&gt;\"angus beef\"}] \n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 1910067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10061b5904b6c00a4b10647b96f0d69b?s=128&d=identicon&r=PG", "display_name": "pmannion", "link": "https://stackoverflow.com/users/1910067/pmannion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 27828709, "answer_count": 1, "score": 3, "last_activity_date": 1420681041, "creation_date": 1420664743, "last_edit_date": 1420681041, "question_id": 27828632, "link": "https://stackoverflow.com/questions/27828632/compare-two-arrays-of-hashes-and-return-new-object", "title": "Compare two arrays of hashes and return new object", "body": "<p>I have two arrays of hashes.</p>\n\n<pre><code>burgers = [\n            {:id =&gt; 1, :name =&gt; \"cheese burger\"},\n            {:id =&gt; 2, :name =&gt; \"royale\"},\n            {:id =&gt; 3, :name =&gt; \"big mac\"},\n            {:id =&gt; 4, :name =&gt; \"angus beef\"}\n          ]\n\neaten =   [\n            {:burger_id =&gt; 1},\n            {:burger_id =&gt; 2}\n          ]\n</code></pre>\n\n<p>I would like to return an array or uneaten burgers, where <code>burgers[:id]</code> does not equal <code>eaten[:burger_id]</code>. In <code>burgers_not_eaten_method</code>, I have the expected return value.</p>\n\n<pre><code>def burgers_not_eaten\n  #Not sure how to compare burger[:id] with eaten[:burger_id]\n  burgers.reject { |burger| burger[:id] == #eaten burger_id }\n  # Expected:  [{:id =&gt; 3, :name =&gt; \"big mac\"},{:id =&gt; 4, :name =&gt; \"angus beef\"}]\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1420664528, "post_id": 27828541, "comment_id": 44063087, "body": "I think that&#39;s perfectly fine"}, {"owner": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "reply_to_user": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1420665621, "post_id": 27828541, "comment_id": 44063634, "body": "I don&#39;t like the fact that I have to put the single element to be added in an array."}], "answers": [{"comments": [{"owner": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "edited": false, "score": 0, "creation_date": 1420665034, "post_id": 27828588, "comment_id": 44063355, "body": "Anyone care to explain the downvotes?  This is perfectly valid and correct."}, {"owner": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420665496, "post_id": 27828588, "comment_id": 44063575, "body": "I actually like it. Add parentheses before the splat to make it more obvious. [:name, :details, *(@allowed ? :price : nil)]"}, {"owner": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "reply_to_user": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420665642, "post_id": 27828588, "comment_id": 44063646, "body": "@monkbroc I don&#39;t care for unnecessary parens because they are a distraction to anyone who knows their operator precedence. The splat operator is SUPER low in terms of precedence--even lower than <code>?:</code>. I would prefer using the multi-line equivalent over adding superfluous parens."}, {"owner": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420666016, "post_id": 27828588, "comment_id": 44063837, "body": "That&#39;s a matter of preference I suppose. In this case I find it kills two birds with one stone: visually groups the ternary operator and makes it clear that the splat applies to the result of the ternary, not the boolean attribute."}, {"owner": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "reply_to_user": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420666056, "post_id": 27828588, "comment_id": 44063858, "body": "@monkbroc Different strokes, friend :)"}], "tags": [], "owner": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "is_accepted": true, "score": 0, "last_activity_date": 1424989288, "last_edit_date": 1424989288, "creation_date": 1420664558, "answer_id": 27828588, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true/27828588#27828588", "title": "Include value in array if condition is true", "body": "<p>Like so:</p>\n\n<pre><code>def permitted_attributes\n  Array[\n    :name,\n    :details,\n    *@allowed ? :price : nil\n  ]\nend\n</code></pre>\n\n<p>or on one line if you prefer:</p>\n\n<pre><code>def permitted_attributes\n  [:name, :details, *@allowed ? :price : nil]\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "reply_to_user": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420664777, "post_id": 27828610, "comment_id": 44063223, "body": "Unless this is in a rails controller I&#39;d recommend passing that in as an argument then.  At least consider it."}, {"owner": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "edited": false, "score": 0, "creation_date": 1420664800, "post_id": 27828610, "comment_id": 44063234, "body": "This way seems more like you would write it in C++. Ruby tends to have a more functional style using <code>collect</code> and such."}], "tags": [], "owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1420664645, "creation_date": 1420664645, "answer_id": 27828610, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true/27828610#27828610", "title": "Include value in array if condition is true", "body": "<p>Nothing wrong with it, but I have a feeling that method might grow over time and get a bit more confusing.  I'm not sure why <code>@allowed</code> is outside the method, but ignoring that I'd probably do this:</p>\n\n<pre><code>def permitted_attributes\n  permitted = [:name, :details]\n  permitted += :price if @allowed\n  permitted\nend\n</code></pre>\n\n<p>That way you can grow it over time and add other logic, while keeping it readable.</p>\n"}, {"comments": [{"owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "reply_to_user": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "edited": false, "score": 0, "creation_date": 1420665388, "post_id": 27828664, "comment_id": 44063528, "body": "@IronSavior If I remove the last line, <code>permitted_attributes</code> will be <code>nil</code> when <code>@allowed</code> is false."}, {"owner": {"reputation": 3930, "user_id": 1449569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d58c523bfe1f2628000af0759654ee69?s=128&d=identicon&r=PG", "display_name": "Iron Savior", "link": "https://stackoverflow.com/users/1449569/iron-savior"}, "edited": false, "score": 0, "creation_date": 1420665448, "post_id": 27828664, "comment_id": 44063551, "body": "quite right... nevermind.  I need to go eat lunch or something, I&#39;m getting stupid."}], "tags": [], "owner": {"reputation": 36058, "user_id": 1157054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5c9d0ecbe3045579b72f96744c62735c?s=128&d=identicon&r=PG", "display_name": "Ajedi32", "link": "https://stackoverflow.com/users/1157054/ajedi32"}, "is_accepted": false, "score": 1, "last_activity_date": 1420664822, "creation_date": 1420664822, "answer_id": 27828664, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true/27828664#27828664", "title": "Include value in array if condition is true", "body": "<p>Well, you could do something like this...</p>\n\n<pre><code>@allowed = false\ndef permitted_attributes\n  [\n    :name,\n    :details,\n    *(:price if @allowed),\n  ]\nend\n</code></pre>\n\n<p>Honestly that's kind of confusing in my opinion though. Really the best way is probably to just keep it simple:</p>\n\n<pre><code>def permitted_attributes\n  attrs = [:name, :details]\n  attrs &lt;&lt; :price if @allowed\n  attrs\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 2, "creation_date": 1420664892, "post_id": 27828671, "comment_id": 44063285, "body": "why including that in the Array class?  seems like nuclear-level overkill"}, {"owner": {"reputation": 7544, "user_id": 1085998, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/459252fca62e56c1131babdba2b1babe?s=128&d=identicon&r=PG", "display_name": "daremkd", "link": "https://stackoverflow.com/users/1085998/daremkd"}, "reply_to_user": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1420664945, "post_id": 27828671, "comment_id": 44063310, "body": "If this is a nuclear-level overkill, then Rails should have destroyed the world by now."}, {"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "edited": false, "score": 0, "creation_date": 1420665245, "post_id": 27828671, "comment_id": 44063459, "body": "Can&#39;t disagree there, but I&#39;m not one for atomic war.  Why not put this method in application_controller (presuming this snippet is from a controller) if it&#39;s applicable across more than one file?  If not, then just make it a method for <i>this</i> controller."}], "tags": [], "owner": {"reputation": 7544, "user_id": 1085998, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/459252fca62e56c1131babdba2b1babe?s=128&d=identicon&r=PG", "display_name": "daremkd", "link": "https://stackoverflow.com/users/1085998/daremkd"}, "is_accepted": false, "score": 0, "last_activity_date": 1420665687, "last_edit_date": 1420665687, "creation_date": 1420664838, "answer_id": 27828671, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true/27828671#27828671", "title": "Include value in array if condition is true", "body": "<pre><code>class Array\n  def add_object_if(object_to_add)\n    if yield\n      self &lt;&lt; object_to_add\n    else\n      self\n    end\n  end\nend\n\narr = [1,2]\nbool = true\narr.add_object_if(3) { bool }\np arr #=&gt; [1, 2, 3]\nbool = false\narr.add_object_if(4) { bool }\np arr #=&gt; [1, 2, 3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 784, "user_id": 725805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021afc71de4fc022fa9f0f080ae5df11?s=128&d=identicon&r=PG", "display_name": "stringsn88keys", "link": "https://stackoverflow.com/users/725805/stringsn88keys"}, "is_accepted": false, "score": 0, "last_activity_date": 1420666342, "creation_date": 1420666342, "answer_id": 27829014, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true/27829014#27829014", "title": "Include value in array if condition is true", "body": "<p>The only thing I could could think of was maybe wrapping the conditional into a small method of its own, which provides a clearer context of why.</p>\n\n<p>Also thought I'd add a <code>attr_reader</code> to remove the reuse of the instance variable.</p>\n\n<pre><code>class ItemPolicy\n  attr_reader :allowed\n\n  def initialize(user)\n      @user = user\n      @allowed = user.manager?\n  end\n\n  # Suggest improvements to the permitted_attributes method\n  def permitted_attributes\n    [:name, :details] + conditional_attributes\n  end\n\n  def conditional_attributes\n    return [] unless allowed\n    [:price]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 778, "user_id": 1901924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ec534333161d95ff15a80f1c2bcddb?s=128&d=identicon&r=PG", "display_name": "monkbroc", "link": "https://stackoverflow.com/users/1901924/monkbroc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 27828588, "answer_count": 5, "score": 1, "last_activity_date": 1424989288, "creation_date": 1420664370, "last_edit_date": 1420665257, "question_id": 27828541, "link": "https://stackoverflow.com/questions/27828541/include-value-in-array-if-condition-is-true", "title": "Include value in array if condition is true", "body": "<p>What's the idiomatic Ruby way of including a value in an array only if a condition is true?</p>\n\n<pre><code>class ItemPolicy\n    def initialize(user)\n        @user = user\n        @allowed = user.manager?\n    end\n\n    # Suggest improvements to the permitted_attributes method\n    def permitted_attributes\n        [:name, :details] + (@allowed ? [:price] : [])\n    end\nend\n</code></pre>\n\n<p>This doesn't feel very Ruby-ish.</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "erb"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 6, "creation_date": 1420664386, "post_id": 27828463, "comment_id": 44063020, "body": "These are not <i>helpers</i> in the Rails way but just <i>shared partial views</i> and it is perfectly fine to use them like this. Also, you can write HTML in your ruby files (especially in the Helpers since they have direct access to methods like <code>html_safe</code>: <code>def breakline ; &quot;&lt;br&#47;&gt;&quot;.html_safe ; end</code> is a valid rails method outputting HTML-interpreted code)"}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 0, "creation_date": 1420664732, "post_id": 27828463, "comment_id": 44063200, "body": "I agree with MrYoshiji.  Just be sure to keep them together (ie. in &#39;shared&#39;) to keep your sanity."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1420665051, "post_id": 27828463, "comment_id": 44063367, "body": "Yes about HTML in ruby files with html_safe, but it is considered as a string, and it will break syntax highlighting. Also it would mean using <code>\\&quot;</code> for every html attribute <code>class=\\&quot;tedious\\&quot;</code>"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1420665254, "post_id": 27828463, "comment_id": 44063463, "body": "What about <code>content_tag(:br)</code>? Pure ruby code generating HTML. Pretty usefull for constructing tables via helpers, for example"}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1420665585, "post_id": 27828463, "comment_id": 44063615, "body": "Hmm nice I didn&#39;t know about this one. But then I&#39;d rather stick with more &quot;visual&quot; HTML."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1420665708, "post_id": 27828463, "comment_id": 44063676, "body": "Oh yes also when I do <code>optional_param ||= default_value</code>, is it polluting the global view, or does <code>optional_param</code> disappear from memory after the partial is done rendering ?"}], "owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420961310, "creation_date": 1420664078, "last_edit_date": 1420961310, "question_id": 27828463, "link": "https://stackoverflow.com/questions/27828463/rails-bad-habit-of-using-html-erb-as-helpers", "title": "Rails : bad habit of using .html.erb as helpers?", "body": "<p>I am using a lot of .html.erb partials as \"helpers\". I'm not sure if this is a really bad habit or not.</p>\n\n<p><em>main_file.html.erb</em></p>\n\n<pre><code>render 'shared/some_helper.html.erb', \n  param_1: param_1, \n  param_2: param_2,\n  ...,\n  optional_param_1: optional_param_1,\n  ...\n</code></pre>\n\n<p><em>shared/some_helper.html.erb</em></p>\n\n<pre><code>&lt;%\noptional_param_1 ||= optional_param_1_default\noptional_param_2 ||= optional_param_2_default\n...\n# Some additional logic\n%&gt;\n\n&lt;!-- The HTML that uses the params --&gt;\n</code></pre>\n\n<p>I <em>feel</em> this is justified because my helpers are more about HTML than ruby/rails.</p>\n\n<p>But is there actually a better way to do it (that remains as convenient) ? Maybe define some function in applicaton_helper.erb that would output the HTML ? But then I won't be able to write HTML...</p>\n"}, {"tags": ["ruby", "rubymine-7"], "comments": [{"owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "edited": false, "score": 0, "creation_date": 1420662496, "post_id": 27828015, "comment_id": 44061993, "body": "What are you doing to get that error?  Running tests?  Using it from another script?"}, {"owner": {"reputation": 1438, "user_id": 2417756, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/hnmhE.png?s=128&g=1", "display_name": "Waclock", "link": "https://stackoverflow.com/users/2417756/waclock"}, "edited": false, "score": 0, "creation_date": 1420662657, "post_id": 27828015, "comment_id": 44062081, "body": "As the error states, the &quot;require &#39;test/version&#39;&quot; is giving you problems."}, {"owner": {"reputation": 1, "user_id": 3878252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8868b3e236bf01bb3f3d71c0dc28b088?s=128&d=identicon&r=PG&f=1", "display_name": "erlysoft83", "link": "https://stackoverflow.com/users/3878252/erlysoft83"}, "edited": false, "score": 0, "creation_date": 1420686318, "post_id": 27828015, "comment_id": 44070369, "body": "error display then i run program from ruby mine"}], "owner": {"reputation": 1, "user_id": 3878252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8868b3e236bf01bb3f3d71c0dc28b088?s=128&d=identicon&r=PG&f=1", "display_name": "erlysoft83", "link": "https://stackoverflow.com/users/3878252/erlysoft83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420662341, "creation_date": 1420662270, "last_edit_date": 1420662341, "question_id": 27828015, "link": "https://stackoverflow.com/questions/27828015/i-start-new-nulled-gem-project-in-ruby-mine-and-have-error", "title": "i start new nulled gem project in ruby mine and have error", "body": "<p>on os x 10.9.5 i start new gem project in ruby mine </p>\n\n<pre><code>require \"test/version\"\n\nmodule Test\n  puts \"123\"\nend\n</code></pre>\n\n<p>and have error</p>\n\n<pre><code>/usr/bin/ruby -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) /Users/qwerty/Documents/ruby/test/lib/test.rb\n/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require': cannot load such file -- test/version (LoadError)\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in `require'\n    from /Users/qwerty/Documents/ruby/test/lib/test.rb:1:in `&lt;top (required)&gt;'\n    from -e:1:in `load'\n    from -e:1:in `&lt;main&gt;'\n</code></pre>\n\n<p>Process finished with exit code 1</p>\n"}, {"tags": ["ruby", "testing", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 3624381, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f32f44e789d6de3a61c8385f0476b36b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3624381/sandy"}, "edited": false, "score": 0, "creation_date": 1420734649, "post_id": 27827859, "comment_id": 44093654, "body": "The before and after is a good idea. If you didn&#39;t need the file for all your specs, would let work in that case?"}, {"owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "reply_to_user": {"reputation": 679, "user_id": 3624381, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f32f44e789d6de3a61c8385f0476b36b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3624381/sandy"}, "edited": false, "score": 0, "creation_date": 1420746805, "post_id": 27827859, "comment_id": 44100591, "body": "if you don&#39;t need it for all your tests, just use a block as in your example"}], "tags": [], "owner": {"reputation": 9993, "user_id": 2128691, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/YV6xv.jpg?s=128&g=1", "display_name": "dax", "link": "https://stackoverflow.com/users/2128691/dax"}, "is_accepted": true, "score": 3, "last_activity_date": 1420661611, "creation_date": 1420661611, "answer_id": 27827859, "question_id": 27827735, "link": "https://stackoverflow.com/questions/27827735/testing-and-closing-file-objects-while-using-let-in-ruby-rspec/27827859#27827859", "title": "Testing and closing file objects while using let in ruby rspec", "body": "<p>If you're going to use <code>a_file</code> in just one test, then your second example is good.  </p>\n\n<pre><code>it \"is a File\" do\n  Foo.open('blah.txt') do |f|\n    expect(f).to be_a File\n  end\nend\n</code></pre>\n\n<p>If you'll use <code>a_file</code> multiple times, you could do this:</p>\n\n<pre><code>before do \n @file = Foo.open('blah.txt')\nend\n\nafter do\n  @file.close\nend\n\nit \"is a File\" do\n  expect(@file).to be_a File\nend\n\n...\n</code></pre>\n"}], "owner": {"reputation": 679, "user_id": 3624381, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f32f44e789d6de3a61c8385f0476b36b?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3624381/sandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 27827859, "answer_count": 1, "score": 2, "last_activity_date": 1420661611, "creation_date": 1420661100, "last_edit_date": 1495540357, "question_id": 27827735, "link": "https://stackoverflow.com/questions/27827735/testing-and-closing-file-objects-while-using-let-in-ruby-rspec", "title": "Testing and closing file objects while using let in ruby rspec", "body": "<p>If I have a class like this</p>\n\n<pre><code>class Foo &lt; File\n  # fun stuff\nend\n</code></pre>\n\n<p>and I wanted to test that it is indeed inherits from File, I could write</p>\n\n<pre><code>describe Foo\n  let(:a_file) { Foo.open('blah.txt') }\n\n  it \"is a File\" do\n    expect(a_file).to be_a File\n  end\nend\n</code></pre>\n\n<p>My question is, will the let() take care of closing the file after the example is run? Or do I need to explicitly close the file somewhere.</p>\n\n<p>Or would something like this be better,</p>\n\n<pre><code>it \"is a File\" do\n  Foo.open('blah.txt') do |f|\n    expect(f).to be_a File\n  end\nend\n</code></pre>\n\n<p>forgetting about the let() entirely?</p>\n\n<p>I looked at <a href=\"https://stackoverflow.com/questions/5359558/when-to-use-rspec-let\">using let</a> and <a href=\"https://stackoverflow.com/questions/4795447/rubys-file-open-and-the-need-for-f-close\">closing files</a> for reference, but I'm still unsure.</p>\n"}, {"tags": ["ruby", "json", "sockets", "nginx", "puma"], "answers": [{"tags": [], "owner": {"reputation": 2116, "user_id": 994097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a42ff888eb4c942755a0c57c7b95871?s=128&d=identicon&r=PG", "display_name": "Edu Lomeli", "link": "https://stackoverflow.com/users/994097/edu-lomeli"}, "is_accepted": true, "score": 2, "last_activity_date": 1420674039, "creation_date": 1420674039, "answer_id": 27830664, "question_id": 27827551, "link": "https://stackoverflow.com/questions/27827551/nginx-serve-request-to-a-json-api-service-via-sockets-configuration/27830664#27830664", "title": "nginx serve request to a json api service via sockets configuration", "body": "<p>On your code, nginx serves first the static contents of <code>root</code> instead of the <code>upstream my_app</code>. Use the <code>root</code> to serve only the static files and the <code>upstream</code> to route request to the app server. This reduced nginx config might help you:</p>\n\n<pre><code>upstream my_app {\n  server unix:/tmp/my_app.sock;\n}\n\nserver {\n  listen 80;\n  ...\n\n  location / {\n    proxy_pass http://my_app;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 845, "user_id": 4391936, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/2DPM6.jpg?s=128&g=1", "display_name": "Ohad Perry", "link": "https://stackoverflow.com/users/4391936/ohad-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 1, "accepted_answer_id": 27830664, "answer_count": 1, "score": 0, "last_activity_date": 1420674039, "creation_date": 1420660441, "last_edit_date": 1420661810, "question_id": 27827551, "link": "https://stackoverflow.com/questions/27827551/nginx-serve-request-to-a-json-api-service-via-sockets-configuration", "title": "nginx serve request to a json api service via sockets configuration", "body": "<p>my grape app runs on localhost like so:\nbundle exec rackup -p 9292</p>\n\n<p>and after that when going to <code>http://localhost:9292/api/v1/ping</code>,</p>\n\n<p>you get a json response <code>{\"res\":\"pong\"}</code></p>\n\n<p>now,i'm trying to set it up in production. so I decided to run it on puma and nginx config. \ninstalled puma and ran it on a socket. </p>\n\n<pre><code>\u21d2  bundle exec puma -b unix:///tmp/my_app.sock\nPuma starting in single mode...\n* Version 2.10.2 (ruby 2.1.2-p95), codename: Robots on Comets\n* Min threads: 0, max threads: 16\n* Environment: development\nenv :: development\nService started, go to town.\n* Listening on unix:///tmp/my_app.sock\nUse Ctrl-C to stop\n</code></pre>\n\n<p>set up nginx with a config like this:</p>\n\n<pre><code>events {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n\n    upstream my_app {\n        server unix:///tmp/my_app.sock;\n\n   }\n    server {\n        listen       8989;\n        server_name  my_app;\n\n\n    root /Volumes/dev/my_app;\n\n    access_log  /Volumes/dev/my_app/service/log/host.access.log;\n    error_log  /Volumes/dev/my_app/service/log/error.access.log;\n\n    location / {\n       root              /Volumes/dev/my_app/;\n       gzip_static       on;\n       expires           max;\n       add_header        Cache-Control public;\n   }\n\n}\n</code></pre>\n\n<p>and I expect it to act the same. I browsed to \n<code>http://localhost:8989/api/v1/ping</code>\nbut got <code>404 Not Found</code> from nginx . </p>\n\n<p>The error log showed :</p>\n\n<p><code>2015/01/07 21:51:15 [error] 62300#0: *2 open() \"/Volumes/dev/my_app/api/v1/ping\" failed (2: No such file or directory), client: 127.0.0.1, server: my_app, request: \"GET /api/v1/ping HTTP/1.1\", host: \"localhost:8989\"</code></p>\n\n<p>maybe it's thinking it's service static content?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1420660775, "post_id": 27827385, "comment_id": 44061082, "body": "Remember that in this case <code>&quot;#{attr}&quot;</code> is equivalent to the less cluttered <code>attr</code>."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1420660901, "post_id": 27827610, "comment_id": 44061154, "body": "Ah, this would work if the method was called once, but calling it twice creates the loop problem. The <code>alias_method</code> call should be skipped if <code>responds_to?(:old_initialize)</code> is true."}, {"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1420661227, "post_id": 27827610, "comment_id": 44061319, "body": "I&#39;ve modified the line to this <code>alias_method :old_initialize, :initialize unless respond_to? :old_initialize</code> and it doesn&#39;t work yet."}, {"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1420661305, "post_id": 27827610, "comment_id": 44061364, "body": "In response to the answer, I know what&#39;s going on, I don&#39;t know how to fix it. In addition to this, I am using <code>alias_method</code> BEFORE the call to initialize..."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1420663664, "post_id": 27827610, "comment_id": 44062629, "body": "Every time you call <code>custom_attr_accessor</code>, you overwrite the old definition of <code>initialize</code> with a new one which calls the old one. However, for every call except the first one, the new old one will also already call <code>old_initialize</code>, i.e. itself."}, {"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1420664628, "post_id": 27827610, "comment_id": 44063143, "body": "Wow, that post is awesome. I am gonna take a look at it later. But I&#39;ll be back here soon for sure..."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1420667022, "last_edit_date": 1495540256, "creation_date": 1420660656, "answer_id": 27827610, "question_id": 27827385, "link": "https://stackoverflow.com/questions/27827385/extending-initialize/27827610#27827610", "title": "Extending initialize", "body": "<p>You define the method <code>initialize</code> to call <code>old_initialize</code>, but then you <code>alias_method</code> it to <code>old_initialize</code>, so <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code> will call <code>old_initialize</code>\u2026</p>\n\n<p>I wrote a rather lengthy article about the \"right\" way to call an old version of an overwritten method <a href=\"https://stackoverflow.com/a/4471202/2988\">here</a>:</p>\n\n<p>The best way to do this is to simply not do it at all. Don't overwrite methods, override them. Ruby has inheritance, use it:</p>\n\n<pre><code>class Module\n  def custom_attr_accessor(attr)\n    attr_reader attr\n    prepend(Module.new do\n      define_method(:initialize) do |*args|\n        super(*args)\n        instance_variable_set(:\"@#{attr}\", yield)\n      end\n    end)\n  end\nend\n\nclass Foo\n  custom_attr_accessor :foo do 'foo' end\n  custom_attr_accessor :bar do 'bar' end\nend\n\n# It works:\nFoo.new\n# =&gt; #&lt;Foo:0xdeadbeef081542 @foo='foo', @bar='bar'&gt;\n\n# How it works:\nFoo.ancestors\n# =&gt; [#&lt;Module:0xdeadbeef081523&gt;, \n#     #&lt;Module:0xdeadbeef081524&gt;, \n#     Foo, \n#     Object, \n#     Kernel, \n#     BasicObject]\n</code></pre>\n\n<p>We can make this a little nicer by assigning the mixins to constants so they get proper names, and amending the API so that one can create multiple accessors in one go:</p>\n\n<pre><code>class Module\n  def custom_attr_accessor(attr=(no_attr = true), **attr_specs, &amp;blk)\n    attr_specs[attr] = blk unless no_attr\n    attr_specs.each do |attr, blk|\n      attr_reader attr\n      prepend CustomAttrAccessor.(attr, &amp;blk)\n    end\n  end\nend\n\nmodule CustomAttrAccessor\n  def self.call(attr)\n    m = Module.new do\n      define_method(:initialize) do |*args|\n        super(*args)\n        instance_variable_set(:\"@#{attr}\", yield)\n      end\n    end\n    const_set(:\"CustomAttrAccessor_#{attr}_#{m.object_id}\", m)\n  end\nend\n\nclass Foo\n  custom_attr_accessor :foo do 'foo' end\n  custom_attr_accessor :bar do 'bar' end\nend\n\n# It works:\nFoo.new\n# =&gt; #&lt;Foo:0xdeadbeef081542 @foo='foo', @bar='bar'&gt;\n\n# How it works:\nFoo.ancestors\n# =&gt; [CustomAttrAccessor::CustomAttrAccessor_bar_48151623420020, \n#     CustomAttrAccessor::CustomAttrAccessor_foo_48151623420010, \n#     Foo, \n#     Object, \n#     Kernel, \n#     BasicObject]\n\nclass Bar\n  custom_attr_accessor :foo do 'FOO' end\n  custom_attr_accessor :bar do 'BAR' end\n  custom_attr_accessor baz: -&gt; { 'BAZ' }, qux: -&gt; { 'QUX' }\nend\n\n# It works:\nBar.new\n# =&gt; #&lt;Bar:0xdeadbeef081542 @foo='FOO', @bar='BAR' @baz='BAZ', @qux='QUX'&gt;\n\n# How it works:\nBar.ancestors\n# =&gt; [CustomAttrAccessor::CustomAttrAccessor_qux_48151623420060, \n#     CustomAttrAccessor::CustomAttrAccessor_baz_48151623420050, \n#     CustomAttrAccessor::CustomAttrAccessor_bar_48151623420040, \n#     CustomAttrAccessor::CustomAttrAccessor_foo_48151623420030, \n#     Bar, \n#     Object, \n#     Kernel, \n#     BasicObject]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1420661727, "post_id": 27827822, "comment_id": 44061584, "body": "No, this will call the block for the first time when you call the method, not when you initialize it."}, {"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "reply_to_user": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "edited": false, "score": 0, "creation_date": 1420662335, "post_id": 27827822, "comment_id": 44061914, "body": "Can you define, what <code>custom_attr_accessor</code>should define?"}], "tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 0, "last_activity_date": 1420661493, "creation_date": 1420661493, "answer_id": 27827822, "question_id": 27827385, "link": "https://stackoverflow.com/questions/27827385/extending-initialize/27827822#27827822", "title": "Extending initialize", "body": "<p>Do you look for something like this:</p>\n\n<pre><code>class Object\n  def custom_attr_accessor(attr)\n    define_method \"#{attr}=\".to_sym do |val|\n      instance_variable_set(\"@#{attr}\", val)\n    end\n    define_method attr do\n      instance_variable_get(\"@#{attr}\") || yield \n    end\n  end\nend\n\nclass Foo\n  custom_attr_accessor :foo do\n    \"foo\"\n  end\n\n  custom_attr_accessor :bar do\n    \"bar\"\n  end\nend\n\n\nf = Foo.new\nputs f.foo #=&gt; foo\nf.foo = 1\nputs f.foo #=&gt; 1\n\nputs f.bar #=&gt; bar\nf.bar = 2\nputs f.bar #=&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 631, "user_id": 2093346, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/62bd73ee4a132a0cd3d1496598fff329?s=128&d=identicon&r=PG", "display_name": "Quarktum", "link": "https://stackoverflow.com/users/2093346/quarktum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420667022, "creation_date": 1420659839, "question_id": 27827385, "link": "https://stackoverflow.com/questions/27827385/extending-initialize", "title": "Extending initialize", "body": "<p>I am trying to write a custom <code>attr_accessor</code>.</p>\n\n<p>This will receive also a block, and assign the result of this, to the variable I will access later, in the initialization.</p>\n\n<pre><code>class Object\n  def custom_attr_accessor(attr)\n    alias_method :old_initialize, :initialize\n    define_method \"initialize\" do\n      old_initialize\n      instance_variable_set \"@#{attr}\", yield\n    end\n    define_method \"#{attr}\" do\n      instance_variable_get \"@#{attr}\"\n    end\n  end\nend\n\nclass Foo\n  custom_attr_accessor :foo do\n    \"foo\"\n  end\n\n  custom_attr_accessor :bar do\n    \"bar\"\n  end\nend\n\n\n# f = Foo.new\n# puts f.foo \n#   =&gt; \"foo\"\n# puts f.bar\n#   =&gt; \"bar\"\n</code></pre>\n\n<p>But I'm getting</p>\n\n<p><code>stack level too deep (SystemStackError)</code></p>\n\n<p>Anyway, when the class uses one <code>custom_attr_accessor</code>, it works as expected.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 4471, "user_id": 1550398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1793c27571f8787e11e89f7413e59091?s=128&d=identicon&r=PG", "display_name": "Rodrigo Zurek", "link": "https://stackoverflow.com/users/1550398/rodrigo-zurek"}, "edited": false, "score": 0, "creation_date": 1420658918, "post_id": 27827107, "comment_id": 44060041, "body": "post your gemfile and your gemfile.lock also what SO are you running"}, {"owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "edited": false, "score": 1, "creation_date": 1420659626, "post_id": 27827107, "comment_id": 44060433, "body": "Are you sure the actual Gemfile being pushed has 2.2.0?  Smells like you aren&#39;t merged w/master and are pushing something other than what you think."}, {"owner": {"reputation": 3236, "user_id": 456735, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f57871af762854c5d9883ffd393c38d?s=128&d=identicon&r=PG", "display_name": "Anand", "link": "https://stackoverflow.com/users/456735/anand"}, "reply_to_user": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "edited": false, "score": 0, "creation_date": 1420659996, "post_id": 27827107, "comment_id": 44060663, "body": "Yes, @NickVeys you are right. I hadn&#39;t committed that ruby version change. That worked! Thanks."}], "owner": {"reputation": 3236, "user_id": 456735, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f57871af762854c5d9883ffd393c38d?s=128&d=identicon&r=PG", "display_name": "Anand", "link": "https://stackoverflow.com/users/456735/anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420658764, "creation_date": 1420658764, "question_id": 27827107, "link": "https://stackoverflow.com/questions/27827107/heroku-supports-ruby-2-2-0-but-looks-for-2-1-x-and-fails", "title": "Heroku supports ruby 2.2.0 but looks for 2.1.x and fails", "body": "<p>I am trying to deploy my rails (4.1.5) app onto heroku (Cedar stack). The page with <a href=\"https://devcenter.heroku.com/articles/ruby-support#ruby-versions\" rel=\"nofollow\">supported ruby versions on Heroku</a> lists 2.2.0 as supported. </p>\n\n<p>I have 2.2.0 as my active global version in rbenv, and there is no local version specified.</p>\n\n<p>My Gemfile contains <code>ruby '2.2.0'</code> as required by Heroku.</p>\n\n<p>When I call <code>git push heroku master</code>, it fails with the following error:</p>\n\n<pre><code>remote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote:  !\nremote:  !     An error occurred while installing Ruby ruby-2.1.2-p95\nremote:  !     For supported Ruby versions see https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\nremote:  !     Note: Only the most recent version of Ruby 2.1 is supported on Cedar-14\nremote:  !     Command: 'set -o pipefail; curl --fail --retry 3 --retry-delay 1 --connect-timeout 3 --max-time 30 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/cedar-14/ruby-2.1.2-p95.tgz -s -o - | tar zxf - ' failed unexpectedly:\nremote:  !     \nremote:  !     gzip: stdin: unexpected end of file\nremote:  !     tar: Child returned status 1\nremote:  !     tar: Error is not recoverable: exiting now\nremote:  !\nremote: \nremote:  !     Push rejected, failed to compile Ruby app\n</code></pre>\n\n<p>This seems to indicate that heroku is trying to install the older version of ruby on my machine (ruby-2.1.2-p95) and failing, since it is not a supported version. How can I fix this? </p>\n"}, {"tags": ["ruby", "hudson", "jruby", "teradata", "rubymine"], "comments": [{"owner": {"reputation": 7496, "user_id": 120504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429eb788afefe150e1abcbddab57df8d?s=128&d=identicon&r=PG", "display_name": "Rob Paller", "link": "https://stackoverflow.com/users/120504/rob-paller"}, "edited": false, "score": 1, "creation_date": 1420724273, "post_id": 27827098, "comment_id": 44086506, "body": "May I suggest that you replace <code>SELECT TOP 1...</code> with <code>SELECT 1 FROM ALL_WKSCRATCHPAD_DB.MAX_CALL_ATTEMPT_PARAMETERS WHERE 0=1;&#39; for your existence test. It will be less resource intensive than </code>TOP` + <code>MAX</code>. On the surface, the error itself is pretty straightforward, the object you are querying isn&#39;t in the database you specified. But it appears you can query the table directly using SQLA. Is that correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 7496, "user_id": 120504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429eb788afefe150e1abcbddab57df8d?s=128&d=identicon&r=PG", "display_name": "Rob Paller", "link": "https://stackoverflow.com/users/120504/rob-paller"}, "edited": false, "score": 0, "creation_date": 1420726426, "post_id": 27827098, "comment_id": 44087979, "body": "Changing the built in method of the Sequel gem is not possible, nor a good idea, in this case."}, {"owner": {"reputation": 7496, "user_id": 120504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429eb788afefe150e1abcbddab57df8d?s=128&d=identicon&r=PG", "display_name": "Rob Paller", "link": "https://stackoverflow.com/users/120504/rob-paller"}, "edited": false, "score": 0, "creation_date": 1420726479, "post_id": 27827098, "comment_id": 44088008, "body": "Ah. In that case I understand."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "reply_to_user": {"reputation": 7496, "user_id": 120504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429eb788afefe150e1abcbddab57df8d?s=128&d=identicon&r=PG", "display_name": "Rob Paller", "link": "https://stackoverflow.com/users/120504/rob-paller"}, "edited": false, "score": 0, "creation_date": 1420726635, "post_id": 27827098, "comment_id": 44088125, "body": "But the issue is that the table_exists? Method is supposed to run that sequel script, and of our fails ( because the table doesn&#39;t exist) then it rescues the exception that is thrown and then returns false to its caller. Then my unless statement would be aware that the table is non existent."}], "owner": {"user_type": "does_not_exist", "display_name": "user2993456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 516, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420658738, "creation_date": 1420658738, "question_id": 27827098, "link": "https://stackoverflow.com/questions/27827098/test-the-existence-of-a-teradata-table-and-create-the-table-if-non-existent", "title": "Test the existence of a Teradata table and create the table if non-existent", "body": "<p>Our Continuous Inegration server (Hudosn) is having a strange issue when attempting to run a simple create table statement in Teradata. </p>\n\n<p>This statement tests the existence of the max_call table:</p>\n\n<pre><code> unless $teradata_connection.table_exists? :arm_custom_db__max_call_attempt_parameters\n  $teradata_connection.run('CREATE TABLE all_wkscratchpad_db.max_call_attempt_parameters AS (SELECT * FROM arm_custom_db.max_call_attempt_parameters ) WITH NO DATA')\nend\n</code></pre>\n\n<p>The <code>table_exists?</code> method does the following:</p>\n\n<pre><code>def table_exists?(name)\n        v ||= false # only retry once\n        sch, table_name = schema_and_table(name)\n        name = SQL::QualifiedIdentifier.new(sch, table_name) if sch\n        from(name).first\n        true\n      rescue DatabaseError =&gt; e\n        if e.to_s =~ /Operation not allowed for reason code \"7\" on table/ &amp;&amp; v == false\n          # table probably needs reorg\n          reorg(name)\n          v = true\n          retry \n        end\n        false\n      end \n</code></pre>\n\n<p>So as per the <code>from(name).first</code> line, the test which this method is performing is just a simple select statement, which, in SQL, looks like: <code>SELECT TOP 1 MAX(CAST(MAX_CALL_ATTEMPT_CNT AS BIGINT)) FROM ALL_WKSCRATCHPAD_DB.MAX_CALL_ATTEMPT_PARAMETERS</code></p>\n\n<p>The above SQL statement executes perfectly fine within Teradata SQL Assistant, so it's not a SQL syntax issue. The generic ID which our testing suite (Rubymine) uses is also not the issue; that ID has select access to the arm_custom_db. </p>\n\n<p>The exeption which I can see is being thrown (within the builds console output on Hudson) is \n<code>Sequel::DatabaseError: Java::ComTeradataJdbcJdbc_4Util::JDBCException</code>. Since this execption is a subclass of DatabaseError, the exception shouldn't be the problem either. </p>\n\n<p>Also: We use <code>unless</code> statements like this every day for hundreds of different tables, and all except this one work correctly. This statement just seems to be a problem. </p>\n\n<p>The complete error message which appears in the builds console output of Hudson is as follows:</p>\n\n<pre><code>[2015-01-07T13:56:37.947000 #16702] ERROR -- : Java::ComTeradataJdbcJdbc_4Util::JDBCException: [Teradata Database] [TeraJDBC 13.10.00.17] [Error 3807] [SQLState 42S02] Object 'ALL_WKSCRATCHPAD_DB.MAX_CALL_ATTEMPT_PARAMETERS' does not exist.: SELECT TOP 1 MAX(CAST(MAX_CALL_ATTEMPT_CNT AS BIGINT)) FROM ALL_WKSCRATCHPAD_DB.MAX_CALL_ATTEMPT_PARAMETERS\nSequel::DatabaseError: Java::ComTeradataJdbcJdbc_4Util::JDBCException: [Teradata Database] [TeraJDBC 13.10.00.17] [Error 3807] [SQLState 42S02] Object 'ALL_WKSCRATCHPAD_DB.MAX_CALL_ATTEMPT_PARAMETERS' does not exist.\n</code></pre>\n\n<p>I don't understand why this specific bit of code is giving me issues...there does not appear to be anything special about this table or database, and all SQL code executes perfectly fine in Teradata when I am signed in with the same exact user ID that is being used to execute the code from Hudson.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "ruby-on-rails-4", "parameter-passing"], "comments": [{"owner": {"reputation": 10364, "user_id": 877472, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e73a159e3f7790ee019673c37da48a59?s=128&d=identicon&r=PG", "display_name": "Paul Richter", "link": "https://stackoverflow.com/users/877472/paul-richter"}, "edited": false, "score": 3, "creation_date": 1420658218, "post_id": 27826902, "comment_id": 44059653, "body": "Maybe I&#39;m missing something but I don&#39;t see you doing anything like <code>params[:cert]</code> to get the value of <code>:cert</code>; is that what you&#39;re missing?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1420658720, "post_id": 27826902, "comment_id": 44059918, "body": "Your class naming and methods name are pretty confusing. Anyway, it should be this: <code>checking_policy_number = Get_policy_check_digit.new(params[:cert])</code>. The method <code>get_cert_number(cert)</code> is useless here"}], "answers": [{"tags": [], "owner": {"reputation": 433, "user_id": 3194468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1cxVP.jpg?s=128&g=1", "display_name": "Yahor Zhylinski", "link": "https://stackoverflow.com/users/3194468/yahor-zhylinski"}, "is_accepted": false, "score": 2, "last_activity_date": 1420658732, "creation_date": 1420658732, "answer_id": 27827091, "question_id": 27826902, "link": "https://stackoverflow.com/questions/27826902/passing-a-param-from-a-view-to-controller-then-back-to-a-view/27827091#27827091", "title": "Passing a param from a view to controller. Then back to a view", "body": "<p>try to change method show_check_number to this</p>\n\n<pre><code>def show_check_number\n  checking_policy_number = Get_policy_check_digit.new(params[:cert]) \n  @check_number = checking_policy_number.create_check_digit    \nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 4420713, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-8a17W8mns-I/AAAAAAAAAAI/AAAAAAAAAGI/AHFNn0GyHNA/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4420713/nick"}, "edited": false, "score": 0, "creation_date": 1420666892, "post_id": 27827178, "comment_id": 44064248, "body": "I tried to refactor the way you showed but I&#39;m getting an error. &quot;NameError in CheckNumberController#show_check_number&quot; &quot;uninitialized constant CheckNumberController::PolicyCheckDigit&quot;. I don&#39;t see why this should happen. I the spelling is correct since I just did a copy paste of PolicyCheckDigit."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "reply_to_user": {"reputation": 65, "user_id": 4420713, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-8a17W8mns-I/AAAAAAAAAAI/AAAAAAAAAGI/AHFNn0GyHNA/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4420713/nick"}, "edited": false, "score": 0, "creation_date": 1420666939, "post_id": 27827178, "comment_id": 44064273, "body": "You have to restart your server, and eventually put the require inside the class block of the controller (requires the files when the class is loaded and not when the file is read by the system)"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 1, "last_activity_date": 1420659048, "creation_date": 1420659048, "answer_id": 27827178, "question_id": 27826902, "link": "https://stackoverflow.com/questions/27826902/passing-a-param-from-a-view-to-controller-then-back-to-a-view/27827178#27827178", "title": "Passing a param from a view to controller. Then back to a view", "body": "<p>I suggest you this refactor:</p>\n\n<pre><code># controller\nrequire 'app/services/number_check_modulo'    \nclass CheckNumberController &lt; ApplicationController\n\n  def show_check_number\n    policy_check_digit = PolicyCheckDigit.new(params[:cert])\n    @check_number = policy_check_digit.create_check_digit\n  end\nend\n\n# app/services/number_check_modulo\nclass PolicyCheckDigit\n  def initialize(cert_id)\n    @cert = cert_id\n  end\n\n  def create_check_digit\n    cert_id_6 = @cert.to_s\n    cert_id_6.slice!(0)\n    cert_id_6.to_i\n    cert_id_6 % 7\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4420713, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-8a17W8mns-I/AAAAAAAAAAI/AAAAAAAAAGI/AHFNn0GyHNA/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/4420713/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 27827178, "answer_count": 2, "score": 1, "last_activity_date": 1420659259, "creation_date": 1420658021, "last_edit_date": 1420659259, "question_id": 27826902, "link": "https://stackoverflow.com/questions/27826902/passing-a-param-from-a-view-to-controller-then-back-to-a-view", "title": "Passing a param from a view to controller. Then back to a view", "body": "<p>The goal is to capture an input from a form and then after the controller and service are done with it display the result on another view. The main problem is the interaction between the controller and the form view. The view should pass the captured input as a parameter to the controller and go on its merry way. How do I properly capture the parameter and pass it to my controller?</p>\n\n<pre><code># controller\nclass CheckNumberController &lt; ApplicationController\n  require_relative '../services/number_check_modulo'\n  def get_cert_number(cert)\n    @cert_id = cert\n  end\n\n  def show_check_number\n    checking_policy_number = Get_policy_check_digit.new(@cert_id) # Creates a new instance of the \"Get_policy_check_digit\" class\n                                                                 # From number_check.rb\n    @check_number = checking_policy_number.create_check_digit     # Runs the \"create_check_digit\" method from the \"Get_policy_check_digit\" class\n  end\nend\n\n# service 'app/services/number_check_modulo' required in the controller shown above\nclass Get_policy_check_digit\n  def initialize(cert_id)\n    #instance variable\n    @cert = cert_id\n  end\n\n  def create_check_digit\n    cert_id_6 = @cert.to_s\n    cert_id_6.slice!(0)\n    cert_id_6.to_i\n    cert_id_6 % 7\n  end\nend\n</code></pre>\n\n<p>I am currently using the form helper form_tag in my view. After the user submits a number the page will redirect to what will be the output display page.</p>\n\n<pre><code># Form view\n&lt;H1&gt;Enter Cert Number below&lt;/H1&gt;\n\n&lt;%= form_tag('show_check_number', method: 'get') do %&gt;\n    &lt;%= text_field_tag(:cert) %&gt;\n    &lt;%= submit_tag(\"Submit\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This page simply shows the result of the calculations done by the service 'app/services/number_check_modulo'</p>\n\n<pre><code># View that shows the result\n&lt;h1&gt;Your check number is &lt;%= @check_number %&gt;&lt;/h1&gt;\n</code></pre>\n\n<p>I'm fairly new to this but I think I'm on the right track.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "session"], "comments": [{"owner": {"reputation": 14979, "user_id": 291700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e784d62dbda680c5c2ac6d9b9738aa?s=128&d=identicon&r=PG", "display_name": "Charles Caldwell", "link": "https://stackoverflow.com/users/291700/charles-caldwell"}, "edited": false, "score": 1, "creation_date": 1420658109, "post_id": 27826844, "comment_id": 44059599, "body": "With respect to your frustration, this question is a little too broad for this site. The topic of sessions in Rails is a wide one and would be difficult to address in this format."}, {"owner": {"reputation": 89316, "user_id": 238886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/8ca29123b5669b26f9b6ca2c62d9d215?s=128&d=identicon&r=PG", "display_name": "Wayne Conrad", "link": "https://stackoverflow.com/users/238886/wayne-conrad"}, "edited": false, "score": 0, "creation_date": 1420661975, "post_id": 27826844, "comment_id": 44061705, "body": "I think we might need to see some of the API documentation.  &quot;session&quot; here might mean a session <i>with the other server&#39;s API</i>, not a session in your rails server."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "edited": false, "score": 0, "creation_date": 1420660976, "post_id": 27826914, "comment_id": 44061191, "body": "That is definitely what I am trying to do, unfortunately I cannot give out the information as I had to register for it and got my own devID and authKey :(  Basically the url structure is: <a href=\"http://api_stuff_for_the_site/devID/authKey\" rel=\"nofollow noreferrer\">api_stuff_for_the_site/devID/authKey</a>  I tried to do GETs, POSTs / get_response and with the url structure above and had no luck."}, {"owner": {"reputation": 112, "user_id": 1109171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe129bbbd392d145df6e686b6feeca1?s=128&d=identicon&r=PG", "display_name": "johnnadeau", "link": "https://stackoverflow.com/users/1109171/johnnadeau"}, "reply_to_user": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "edited": false, "score": 0, "creation_date": 1420661182, "post_id": 27826914, "comment_id": 44061289, "body": "@DJ DeStefano, great. In the documentation the should be able to point you in the direction of the API call you need to make to get the <i>session_id</i> and how to pass it along with any API calls after that."}, {"owner": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "edited": false, "score": 0, "creation_date": 1420662906, "post_id": 27826914, "comment_id": 44062232, "body": "yeah so the final form is:  http:// api_stuff_for_the_site/create_sesssion_method/devID/authKey  Now what do I do with that?"}, {"owner": {"reputation": 112, "user_id": 1109171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe129bbbd392d145df6e686b6feeca1?s=128&d=identicon&r=PG", "display_name": "johnnadeau", "link": "https://stackoverflow.com/users/1109171/johnnadeau"}, "reply_to_user": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "edited": false, "score": 0, "creation_date": 1420665038, "post_id": 27826914, "comment_id": 44063357, "body": "You make a get/post to that url, you&#39;ll get a session_id in some format(within json, xml, etc) in the response, and you&#39;ll use that id in your next requests to the API for data(directly in the url, as a header, etc). That&#39;s in general terms, you&#39;ll need to work with the documentation/company supplying the API for specifics since you can&#39;t share here. Hope this helps."}, {"owner": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "edited": false, "score": 0, "creation_date": 1420667875, "post_id": 27826914, "comment_id": 44064704, "body": "Ok yeah that is what I have been trying to do and the response I get back does not contain the session_id unfortunately.  I will contact them for the specifics."}], "tags": [], "owner": {"reputation": 112, "user_id": 1109171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe129bbbd392d145df6e686b6feeca1?s=128&d=identicon&r=PG", "display_name": "johnnadeau", "link": "https://stackoverflow.com/users/1109171/johnnadeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1420658054, "creation_date": 1420658054, "answer_id": 27826914, "question_id": 27826844, "link": "https://stackoverflow.com/questions/27826844/creating-a-session-with-ruby-ror/27826914#27826914", "title": "Creating a session with Ruby/RoR", "body": "<p>Sounds more like you need to create a <em>session</em> with the API endpoint you're trying to access and not in your Rails application. If that is the case think of <em>session_id</em> as a token you'll need to pass along with any other API requests that you make. If you include information on the API you're trying to access we can help more(that is if it is a public API you're trying to access)!</p>\n"}], "owner": {"reputation": 53, "user_id": 2725483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bae94c415e678608bb7a95e1ff1e63b9?s=128&d=identicon&r=PG&f=1", "display_name": "DJ DeStefano", "link": "https://stackoverflow.com/users/2725483/dj-destefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1420670366, "answer_count": 1, "score": -1, "last_activity_date": 1420658054, "creation_date": 1420657830, "question_id": 27826844, "link": "https://stackoverflow.com/questions/27826844/creating-a-session-with-ruby-ror", "closed_reason": "Needs more focus", "title": "Creating a session with Ruby/RoR", "body": "<p>I recently received some API documentation from a company that I wanted to pull some data from.  They told me that I need to create a session first, which will return my session_id.  I have no idea what they mean by this?  I tried the googles and got some stuff on RoR that talked about sessions but it sort of went over my head as I haven't done any work with rails before.</p>\n\n<p><a href=\"http://guides.rubyonrails.org/action_controller_overview.html#accessing-the-session\" rel=\"nofollow\">http://guides.rubyonrails.org/action_controller_overview.html#accessing-the-session</a></p>\n\n<p>Can anybody give me some direction here?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "callback"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 3, "creation_date": 1420660617, "post_id": 27826798, "comment_id": 44060996, "body": "<code>before_validation</code> is an <code>ActiveRecord::Callback</code> and your objects are only inheriting from the Reform gem."}], "answers": [{"tags": [], "owner": {"reputation": 9921, "user_id": 488195, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/aa1e7477ba2f6c0ec47ed521f1cf1676?s=128&d=identicon&r=PG", "display_name": "dgilperez", "link": "https://stackoverflow.com/users/488195/dgilperez"}, "is_accepted": false, "score": 11, "last_activity_date": 1422983205, "creation_date": 1422983205, "answer_id": 28304696, "question_id": 27826798, "link": "https://stackoverflow.com/questions/27826798/how-can-i-use-before-validation-callback-with-form-object-in-rails-4/28304696#28304696", "title": "How can I use before validation callback with form object in Rails 4?", "body": "<p>That means that your <code>ServiceFormObject</code> does not include validation callbacks. </p>\n\n<p>Assuming that <code>Reform::Form</code> does handle <code>ActionModel</code> validations (it includes <code>ActionModel::Validations</code>), I'd try to include the <code>ActiveModel::Validations::Callbacks</code> module into your <code>ServiceFormObject</code>, or even better, into your <code>BaseFormObject</code>:</p>\n\n<pre><code>class BaseFormObject &lt; Reform::Form\n  include ActiveModel::Validations::Callbacks\n\n  #...\nend\n</code></pre>\n\n<p>Can you try this out?</p>\n"}], "owner": {"reputation": 1341, "user_id": 3159162, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100001028388133/picture?type=large", "display_name": "leandrotk", "link": "https://stackoverflow.com/users/3159162/leandrotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3492, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1422983205, "creation_date": 1420657636, "last_edit_date": 1420658247, "question_id": 27826798, "link": "https://stackoverflow.com/questions/27826798/how-can-i-use-before-validation-callback-with-form-object-in-rails-4", "title": "How can I use before validation callback with form object in Rails 4?", "body": "<p>I have a Service model/table and its registration form.</p>\n\n<p>In the form I have almost all the Service's fields, but some of them I want to set a value, automatically, before validate the service object.</p>\n\n<ul>\n<li>Example:</li>\n</ul>\n\n<p>-- Service Controller # create Action:</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>def create\n  @service = Service.new\n  @service_form = ServiceFormObject.new(@service)\n\n  @service_form.validate(params[:service_form_object]) and @service_form.save\n  respond_with(@service_form, location: admin_services_path)\nend\n</code></pre>\n\n\n\n<p>Before the @service_form object be validated I want to the @service_form duration_in_hours field be set. So I tried with that code:</p>\n\n<p>-- Service Model:</p>\n\n<pre class=\"lang-css prettyprint-override\"><code># Callbacks\n  before_validation :set_duration\n\n# Instance methods\nprivate\n  def set_duration\n    self.duration_in_hours = (self.end_at - self.start_at) / 3600\n  end\n</code></pre>\n\n\n\n<p>But the set_duration method didn't run (I put the 'byebug' gem to see if the method ran).</p>\n\n<p>I think that the problem is that I create the form with form object (+ reform gem): i'm using form object to validate the service fields, intsead validate inside Service model.</p>\n\n<pre><code>class ServiceFormObject &lt; BaseFormObject\n</code></pre>\n\n<p>The BaseFormObject inherit from Reform::Form:</p>\n\n<pre><code>class BaseFormObject &lt; Reform::Form\n</code></pre>\n\n<p>I tried to put the before_validation and the method inside ServiceFormObject class, but I got an error: <strong>undefined method `before_validation' for ServiceFormObject:Class</strong></p>\n\n<p>How can I use before validation callback with form object in Rails 4?</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1420657940, "post_id": 27826755, "comment_id": 44059505, "body": "out of curiosity I would try <code>grep</code> and compare how much faster it is."}, {"owner": {"reputation": 25335, "user_id": 1118101, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/iiW7i.png?s=128&g=1", "display_name": "theglauber", "link": "https://stackoverflow.com/users/1118101/theglauber"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1420660586, "post_id": 27826755, "comment_id": 44060979, "body": "I was thinking in the same general direction as @akonsu : if the number of records that have &quot;US&quot; are small in comparison to the file&#39;s size, how about opening the file as text, scanning each line for &quot;US&quot;, and CSV-parsing only the records that contain that? On the other hand, is US is half of the file or more, that will probably make it slower."}, {"owner": {"reputation": 1485, "user_id": 2332825, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Ylq7x.jpg?s=128&g=1", "display_name": "T0ny lombardi", "link": "https://stackoverflow.com/users/2332825/t0ny-lombardi"}, "edited": false, "score": 0, "creation_date": 1420661336, "post_id": 27826755, "comment_id": 44061379, "body": "from my last calculation, its about 1,291,791 of the said 6,000,000. I have a similar code in perl that im trying to replicate in ruby. The problem though is speed."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1420666402, "post_id": 27826755, "comment_id": 44064034, "body": "<code>puts &quot;read line&quot;</code> etc. 6,000,000 times takes a lot of time. Better display every 10,000 lines or so."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1420667431, "post_id": 27826755, "comment_id": 44064506, "body": "Have you considered using the native CSV import ability of a database, import your data, then a quick query to extract and export just what you want? Those tools should be running as compiled C or C++ and will be extremely fast."}], "answers": [{"tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": false, "score": 0, "last_activity_date": 1420659427, "creation_date": 1420659427, "answer_id": 27827279, "question_id": 27826755, "link": "https://stackoverflow.com/questions/27826755/ruby-fast-extract-from-csv/27827279#27827279", "title": "Ruby fast extract from csv", "body": "<p><code>awk</code> is probably your best bet if you're on a system with it available.  Try this:</p>\n\n<pre><code>awk -F, '$2 ~ /US/' geoIPCity.csv\n</code></pre>\n\n<p>You can do it within Ruby by doing something like:</p>\n\n<pre><code>out = `awk -F, '$2 ~ /US/' geoIPCity.csv`\n# all the lines of the CSV that matches\n</code></pre>\n\n<p>Could then feed those lines back in your favorite CSV parser if you need to do something w/it.</p>\n"}], "owner": {"reputation": 1485, "user_id": 2332825, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/Ylq7x.jpg?s=128&g=1", "display_name": "T0ny lombardi", "link": "https://stackoverflow.com/users/2332825/t0ny-lombardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420659427, "creation_date": 1420657482, "question_id": 27826755, "link": "https://stackoverflow.com/questions/27826755/ruby-fast-extract-from-csv", "title": "Ruby fast extract from csv", "body": "<p>I have a CSV file with just about 6million lines of data.  Im looking the fastest way to extract rows only with certain info.  One of the Header entries is countries.  Im looking to just extract rows that have country as 'US' </p>\n\n<pre><code>require 'fastest-csv'    \n\nline_num = 1\nFastestCSV.foreach('geoIPCity.csv') do |csv_obj|\n\n  if csv_obj[2] == 'US'\n    us_ips &lt;&lt; csv_obj\n  end\n\n puts \"read line: #{line_num}\"\n line_num += 1\nend\n</code></pre>\n\n<p>this way takes roughly 5-10 mins. </p>\n\n<p>is there anything faster ? </p>\n"}, {"tags": ["ruby", "operator-overloading", "overriding"], "answers": [{"comments": [{"owner": {"reputation": 2171, "user_id": 3005263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ce8d1237d3870df8150038f01d0e739?s=128&d=identicon&r=PG&f=1", "display_name": "Asunez", "link": "https://stackoverflow.com/users/3005263/asunez"}, "edited": false, "score": 0, "creation_date": 1420658606, "post_id": 27826924, "comment_id": 44059859, "body": "Yes, I&#39;m aware. However I need to keep this as simple as possible, hence the custom class.   Your code works as intended, thank you very much!"}, {"owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "reply_to_user": {"reputation": 2171, "user_id": 3005263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ce8d1237d3870df8150038f01d0e739?s=128&d=identicon&r=PG&f=1", "display_name": "Asunez", "link": "https://stackoverflow.com/users/3005263/asunez"}, "edited": false, "score": 0, "creation_date": 1420658683, "post_id": 27826924, "comment_id": 44059894, "body": "Glad I could help, though I&#39;m confused how defining your own classes keeps things simple!"}, {"owner": {"reputation": 2171, "user_id": 3005263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ce8d1237d3870df8150038f01d0e739?s=128&d=identicon&r=PG&f=1", "display_name": "Asunez", "link": "https://stackoverflow.com/users/3005263/asunez"}, "edited": false, "score": 0, "creation_date": 1420891437, "post_id": 27826924, "comment_id": 44153435, "body": "one small question - I can&#39;t find a substitute for my <code>shift_right!</code> method in the default Ruby Vector class. What is the proper way to do this? vec.to_a, then shift/pop on an array and finally copy the modified array to my Vector?"}, {"owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "reply_to_user": {"reputation": 2171, "user_id": 3005263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ce8d1237d3870df8150038f01d0e739?s=128&d=identicon&r=PG&f=1", "display_name": "Asunez", "link": "https://stackoverflow.com/users/3005263/asunez"}, "edited": false, "score": 0, "creation_date": 1420898092, "post_id": 27826924, "comment_id": 44155321, "body": "Probably the easiest way, yeah. You add that method to the built in Vector class too."}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": true, "score": 1, "last_activity_date": 1420658095, "creation_date": 1420658095, "answer_id": 27826924, "question_id": 27826691, "link": "https://stackoverflow.com/questions/27826691/ruby-operator-overloading-not-working-properly-for-a-custom-class-object/27826924#27826924", "title": "Ruby operator-overloading not working properly for a custom class object", "body": "<p>Try this instead:</p>\n\n<pre><code>%i(- +).each do |op|\n  define_method(op) do |v|\n    @coords = @coords.zip(v.coords).map { |a, b| a.send(op, b) }\n    self\n  end\nend\n</code></pre>\n\n<p>You want to <code>zip</code> the array, so calling <code>coords</code> on <code>v</code> makes that work.  Also, <code>map</code> performs the given block and returns the collected results, you were discarding them.</p>\n\n<p>Are you aware that Ruby has a Vector class?</p>\n\n<pre><code>2.1.5 :001 &gt; require 'matrix'\n =&gt; true \n2.1.5 :002 &gt; a = Vector[1,2,3,4]\n =&gt; Vector[1, 2, 3, 4] \n2.1.5 :003 &gt; b = Vector[1,1,1,1]\n =&gt; Vector[1, 1, 1, 1] \n2.1.5 :004 &gt; a - b\n =&gt; Vector[0, 1, 2, 3] \n2.1.5 :005 &gt; a * 3\n =&gt; Vector[3, 6, 9, 12] \n</code></pre>\n"}], "owner": {"reputation": 2171, "user_id": 3005263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ce8d1237d3870df8150038f01d0e739?s=128&d=identicon&r=PG&f=1", "display_name": "Asunez", "link": "https://stackoverflow.com/users/3005263/asunez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 27826924, "answer_count": 1, "score": 1, "last_activity_date": 1420658095, "creation_date": 1420657234, "question_id": 27826691, "link": "https://stackoverflow.com/questions/27826691/ruby-operator-overloading-not-working-properly-for-a-custom-class-object", "title": "Ruby operator-overloading not working properly for a custom class object", "body": "<p>I need some help with my +/- overridden method, it is not affecting the elements of wektor array.</p>\n\n<pre><code>class Wektor\n  attr_accessor :coords\n\n  def initialize(length)\n    @coords = Array.new(length, 0)\n  end\n\n  def set!(w)\n    @coords = w.dup\n\n    self\n  end\n\n  %i(* /).each do |op|\n    define_method(op) do |n|\n      coords.map! { |i| i.send(op, n) }\n\n      self\n    end\n  end\n\n  %i(- +).each do |op|\n    define_method(op) do |v|\n      @coords.zip(v).map { |a, b| a.send(op, b) }\n\n      self\n    end\n  end\n\n  def shift_right!\n    coords.rotate!\n    coords[0] = 0\n\n    self\n  end\n\n\nend\n</code></pre>\n\n<p>So basically if <code>a = Wektor.new(4).set!([1,2,3,4]</code> and <code>b = Wektor.new(4).set!([1,1,1,1]</code> I want <code>a-b</code> to set <code>a = [0,1,2,3]</code> What is wrong with this method? It is not changing anything - <code>a</code> is still set to <code>[1,2,3,4]</code>.</p>\n\n<p>I tried debugging with IRB but it doesn't give me any clue on what is wrong.</p>\n\n<p>The code looks good to me, but I'm a beginner when it comes to writing ruby-way code (I'm not the author of this piece of code) and I have trouble spotting the error.</p>\n\n<p><code>*</code> and <code>/</code> is working OK, the vector is supposed to be multiplied/divided by scalar.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1420656030, "post_id": 27826132, "comment_id": 44058392, "body": "What did your attempt to use a Proc look like? Should be something like <code>algoliasearch index_name: x, &amp;proc</code> where <code>proc</code> is defined as something like <code>lambda { attribute :name ... }</code> and so on."}], "answers": [{"tags": [], "owner": {"reputation": 711, "user_id": 880381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QOfg6.jpg?s=128&g=1", "display_name": "dior001", "link": "https://stackoverflow.com/users/880381/dior001"}, "is_accepted": true, "score": 3, "last_activity_date": 1421536287, "creation_date": 1421536287, "answer_id": 28005356, "question_id": 27826132, "link": "https://stackoverflow.com/questions/27826132/combining-blocks-in-ruby/28005356#28005356", "title": "Combining blocks in Ruby", "body": "<p><a href=\"http://apidock.com/ruby/Object/instance_eval\" rel=\"nofollow\">Instance_eval</a> is the key to solving this.</p>\n\n<blockquote>\n  <p>Evaluates a string containing Ruby source code, or the given block, within the context of the receiver (obj). In order to set the context, the variable self is set to obj while the code is executing, giving the code access to obj\u2019s instance variables. </p>\n</blockquote>\n\n<pre><code>PUBLIC_INDEX_NAME  = \"User_Public_#{Rails.env}\"\nPRIVATE_INDEX_NAME = \"User_Private_#{Rails.env}\"\n\ncommon_index_attributes = Proc.new do\n\n  # Define search attributes.\n\nend\n\nalgoliasearch index_name: PRIVATE_INDEX_NAME, sanitize: true, force_utf8_encoding: true do\n  self.instance_eval &amp;common_index_attributes\n\n  add_index PUBLIC_INDEX_NAME, if: :public? do\n    self.instance_eval &amp;common_index_attributes\n  end\nend\n\nprivate def public?\n  # Excluded for brevity\nend\n</code></pre>\n"}], "owner": {"reputation": 711, "user_id": 880381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QOfg6.jpg?s=128&g=1", "display_name": "dior001", "link": "https://stackoverflow.com/users/880381/dior001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 2, "accepted_answer_id": 28005356, "answer_count": 1, "score": 1, "last_activity_date": 1421536287, "creation_date": 1420655237, "last_edit_date": 1420659058, "question_id": 27826132, "link": "https://stackoverflow.com/questions/27826132/combining-blocks-in-ruby", "title": "Combining blocks in Ruby", "body": "<p>I'm configuring Algolia search for Rails. The algoliasearch method accepts a block which contains index configuration settings. Each of our searchable models has a public and a private index. The configuration of these indexes is identical with the exception that data in the public index is only indexed when the public? method returns true. I'm trying to find a way where I can not repeat the configuration specified for the secured index in the public index so that the code is more DRY. I was thinking along the lines of extracting the configuration into a Proc and using that Proc in both the secured index and public index blocks. I haven't been able to make this work. Does anyone have any suggestions about how to implement this? </p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>algoliasearch index_name: SECURED_INDEX_NAME do\n  # Index configuration. I want to extract this so I can reuse it.\n  attribute :name\n\n  add_index PUBLIC_INDEX_NAME, if: :public? do\n    # Repeat index configuration here.  \n  end\nend\n</code></pre>\n\n\n\n<p><a href=\"https://github.com/algolia/algoliasearch-rails#target-multiple-indexes\" rel=\"nofollow\">https://github.com/algolia/algoliasearch-rails#target-multiple-indexes</a></p>\n\n<p>Here's what I have so far. It doesn't work.</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>module Algolia::UserIndexConcern\n  extend ActiveSupport::Concern\n\n  included do\n    PUBLIC_INDEX_NAME  = \"User_Public_#{Rails.env}\"\n    PRIVATE_INDEX_NAME = \"User_Private_#{Rails.env}\"\n\n    index_config = build_index_config(index_name: PRIVATE_INDEX_NAME) # Obviously can't call method here but need to?\n    algoliasearch index_name: PRIVATE_INDEX_NAME, sanitize: true, force_utf8_encoding: true, &amp;index_config\n\n    private def build_index_config(index_name:)\n      Proc.new do\n        # =====================\n        # Attributes\n        # =====================\n\n        # Searchable.\n\n        attribute :name do\n          full_name\n        end\n\n        attribute :primary_employer do\n          primary_employer.try(:name)\n        end\n\n        attributesToIndex ['unordered(name)', 'unordered(primary_employer)']\n\n        attributesToHighlight [:name, :primary_employer]\n\n        if index_name == PRIVATE_INDEX_NAME\n          index_config = build_index_config(index_name: PUBLIC_INDEX_NAME)\n          add_index PUBLIC_INDEX_NAME, &amp;index_config\n        end\n      end\n    end\n\n    private def public?\n      !exclude_from_search? &amp;&amp; !admin_exclude_from_search?\n    end\n  end\nend\n</code></pre>\n\n\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2859, "user_id": 3945932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1794745acd9e572c24558b78b48d597?s=128&d=identicon&r=PG", "display_name": "ptd", "link": "https://stackoverflow.com/users/3945932/ptd"}, "edited": false, "score": 0, "creation_date": 1420656674, "post_id": 27825957, "comment_id": 44058794, "body": "That&#39;s it. Most likely <code>Admin::BaseController</code> inherits from <code>ApplicationController</code> anyway."}], "answers": [{"tags": [], "owner": {"reputation": 1402, "user_id": 1595029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BBWkv.jpg?s=128&g=1", "display_name": "irruputuncu", "link": "https://stackoverflow.com/users/1595029/irruputuncu"}, "is_accepted": false, "score": 0, "last_activity_date": 1420656289, "creation_date": 1420656289, "answer_id": 27826440, "question_id": 27825957, "link": "https://stackoverflow.com/questions/27825957/rails-change-a-controllers-base-class/27826440#27826440", "title": "Rails - change a controller&#39;s base class", "body": "<p>It is totally fine to change the controller base class afterwards. I even think it is the only way to use the perks of inheritance on controllers as by my knowledge there is no option to let this be done in the 'rails g controller' call.</p>\n\n<p>Always keep in mind that rails often looks like magic but deep down are just some cool ruby code ;) So if you want to change the base class of a rails controller there is nothing more to it than changing the base class of the ruby class that represents said controller.</p>\n"}], "owner": {"reputation": 317, "user_id": 4330536, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2fb796776fa42a1087b4090144c1c921?s=128&d=identicon&r=PG&f=1", "display_name": "Cror2014", "link": "https://stackoverflow.com/users/4330536/cror2014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420658732, "creation_date": 1420654597, "last_edit_date": 1420658732, "question_id": 27825957, "link": "https://stackoverflow.com/questions/27825957/rails-change-a-controllers-base-class", "title": "Rails - change a controller&#39;s base class", "body": "<p>I am new to Ruby on Rails, I am working on an existing project trying to add new features. I have generated a model using:</p>\n\n<pre><code>rails generate model PublisherOrg owner:string\n</code></pre>\n\n<p>I generated the controller using:</p>\n\n<pre><code>rails generate controller admin/publisher_orgs\n</code></pre>\n\n<p>Then in the routes file, I have added the following:</p>\n\n<pre><code>namespace :admin, path: '/admin' do\n  root to: 'dashboard#index'\n\n  resources :carriers\n  resources :publisher_orgs\nend\n</code></pre>\n\n<p>The problem that I have is that the controller file generated starts with </p>\n\n<pre><code>Admin::PublisherOrgsController &lt; ApplicationController\n</code></pre>\n\n<p>For other controllers, however, it is like</p>\n\n<pre><code>Admin::CarriersController &lt; Admin::BaseController\n</code></pre>\n\n<p>The inheritance is different. The problem is in that some of the methods are not visible for <code>PublisherOrgsController</code>.</p>\n\n<p>After changing the controller file manually to start with:</p>\n\n<pre><code>Admin::PublisherOrgsController &lt; Admin::BaseController\n</code></pre>\n\n<p>the \"unknown methods\" errors are resolved. </p>\n\n<p>I want to know if what I have done is ok. I mean is changing the parent class manually enough or I need to do other things as well?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "ssl", "openssl", "net-http", "sslv3"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1420658389, "post_id": 27825940, "comment_id": 44059734, "body": "The explanation does not make much sense: a handshake error will not cause a timeout but instead close the connection immediately. But typical problems for infrequent timeouts are the attempt to use non-blocking SSL sockets with select, see for example <a href=\"https://bugs.ruby-lang.org/issues/8875\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/8875</a>. It might be, that Net::HTTP is doing something like this internally."}, {"owner": {"reputation": 355, "user_id": 2887172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c2cd7a39276b61e8a3eee6e7d29f1c3a?s=128&d=identicon&r=PG", "display_name": "bkahler", "link": "https://stackoverflow.com/users/2887172/bkahler"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1420659930, "post_id": 27825940, "comment_id": 44060619, "body": "Thanks for the comment. I have updated the explanation a bit. The http call is wrapped in a 8 second timeout block."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1420661019, "post_id": 27825940, "comment_id": 44061213, "body": "<i><code>http.verify_mode = OpenSSL::SSL::VERIFY_NONE</code></i> - ice picks in my eyes. See this Ruby question on how to avoid <code>OpenSSL::SSL::VERIFY_NONE</code>: <a href=\"http://stackoverflow.com/q/27795484/608639\">SSLError: hostname \u201cW.X.Y.Z\u201d does not match the server certificate</a>"}], "owner": {"reputation": 355, "user_id": 2887172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c2cd7a39276b61e8a3eee6e7d29f1c3a?s=128&d=identicon&r=PG", "display_name": "bkahler", "link": "https://stackoverflow.com/users/2887172/bkahler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420660153, "creation_date": 1420654540, "last_edit_date": 1420660153, "question_id": 27825940, "link": "https://stackoverflow.com/questions/27825940/ruby-net-http-call-ssl-version-inconsistencies", "title": "Ruby Net HTTP Call SSL Version Inconsistencies", "body": "<p>I have the following code: </p>\n\n<pre><code> http = Net::HTTP.new(parsed_url.host, 443)\n http.use_ssl = true\n http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n protocol = \"https\"\n</code></pre>\n\n<p>In a single day thousands of calls are made. The server receiving the request has disabled <code>SSLv3</code> because of the Poodle Vulnerability. The actual http call is wrapped in a timeout block that waits for 8 seconds for a response from the server. This code executes the request successfully 99% of the time, however occasionally a timeout occurs. After working with the Amazon support team, it was determined that all the calls which timed-out, were made using <code>SSLv3</code>, which caused a handshake error. All the successful calls used <code>TLSv1.1</code> or <code>TLSv1.2</code>. </p>\n\n<p>Can anyone shed some light, on the what might cause ruby to occasionally use SSLv3 in its attempts ? For additional context, this ruby code is being used with Nginx / Phusion Passenger, and being run on an Amazon Ec2 instance. </p>\n"}, {"tags": ["ruby", "mongodb", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 3182, "user_id": 2019162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PfkAm.jpg?s=128&g=1", "display_name": "JoelC", "link": "https://stackoverflow.com/users/2019162/joelc"}, "edited": false, "score": 1, "creation_date": 1420655151, "post_id": 27825589, "comment_id": 44057857, "body": "What exactly isn&#39;t working? Is there an error or something else? Thanks."}, {"owner": {"reputation": 1, "user_id": 2208995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tCDyH.jpg?s=128&g=1", "display_name": "D&#233;rick Hogan Pimenta", "link": "https://stackoverflow.com/users/2208995/d%c3%a9rick-hogan-pimenta"}, "reply_to_user": {"reputation": 3182, "user_id": 2019162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PfkAm.jpg?s=128&g=1", "display_name": "JoelC", "link": "https://stackoverflow.com/users/2019162/joelc"}, "edited": false, "score": 0, "creation_date": 1420713938, "post_id": 27825589, "comment_id": 44080446, "body": "Return this error: undefined method `treatment&#39; for #&lt;Mongoid::Criteria:0x00000005a2a058&gt;"}], "owner": {"reputation": 1, "user_id": 2208995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tCDyH.jpg?s=128&g=1", "display_name": "D&#233;rick Hogan Pimenta", "link": "https://stackoverflow.com/users/2208995/d%c3%a9rick-hogan-pimenta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420653266, "creation_date": 1420653266, "question_id": 27825589, "link": "https://stackoverflow.com/questions/27825589/embedded-class-inside-another-embedded-class", "title": "Embedded class inside another embedded class", "body": "<p>guys. I'm creating a structure where a patient may have several treatments, and treatments can each have only one case history. As follows</p>\n\n<pre><code>class Patient\n  include Mongoid::Document\n  include Mongoid::Slug\n  include Mongoid::Paperclip\n  include Mongoid::Timestamps\n  include SimpleEnum::Mongoid\n\n  embeds_many :addresses\n  embeds_many :treatments\n\nend\n\nclass Treatment\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embedded_in :patient, inverse_of: :treatments\n\n  embeds_one :case_history\n  embeds_one :physical_examination\n  embeds_one :diagnostic_hypothesis\n  embeds_one :evolution\n  embeds_one :prescription\n  embeds_one :certificate\n  embeds_many :attachments\nend\n\n\nclass CaseHistory\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embedded_in :treatments, inverse_of: :case_history\n\n  field :main_complaint\n  field :history\n\nend\n</code></pre>\n\n<p>I trying to create one case_history object as follows:</p>\n\n<pre><code>patient = Patient.find(params[:patient_id])\ntreatment = patient.treatments.find(params[:treatment_id])\ncase_history = patient.treatments.treatment.case_history.create(case_history_params)\n</code></pre>\n\n<p>But it does not work</p>\n\n<p>What could be wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 3976, "user_id": 1210165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f674db9036f7245292bb87295431e31?s=128&d=identicon&r=PG", "display_name": "evanbikes", "link": "https://stackoverflow.com/users/1210165/evanbikes"}, "edited": false, "score": 0, "creation_date": 1420653460, "post_id": 27825242, "comment_id": 44056969, "body": "How does <code>current_user.likes</code> know what tweet it&#39;s referring to? If you&#39;re looping over <code>current_user.likes</code>, Rails will cache it. But if you&#39;re looping over <code>current_user.likes.where(tweet_id: tweet.id)</code>, then you&#39;ll get an extra db call every iteration."}, {"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "reply_to_user": {"reputation": 3976, "user_id": 1210165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f674db9036f7245292bb87295431e31?s=128&d=identicon&r=PG", "display_name": "evanbikes", "link": "https://stackoverflow.com/users/1210165/evanbikes"}, "edited": false, "score": 0, "creation_date": 1420688203, "post_id": 27825242, "comment_id": 44070776, "body": "@evanbikes what is solution? There are a lot of tweets"}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 3207381, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8d1d7d1741b6d353fc66fa732b7af609?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul215", "link": "https://stackoverflow.com/users/3207381/mukul215"}, "is_accepted": false, "score": 1, "last_activity_date": 1420652543, "creation_date": 1420652543, "answer_id": 27825360, "question_id": 27825242, "link": "https://stackoverflow.com/questions/27825242/rails-4-double-has-many-includes/27825360#27825360", "title": "rails 4 double has_many includes", "body": "<p>Try this:</p>\n\n<pre><code>class User\n  has_many :tweets # direct tweets\n  has_many :likes # liked tweets\nend\n\nclass Tweet\n  belongs_to :user \n  has_many :likes, through: :users\n\nclass Like\n  belongs_to :like\n  belongs_to :user\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 0, "creation_date": 1420698840, "post_id": 27832579, "comment_id": 44073724, "body": "This is not a good solution. It can be solved just by right include query."}, {"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 0, "creation_date": 1420702758, "post_id": 27832579, "comment_id": 44075084, "body": "Else one trouble is ability to write <code>@current_user_likes</code> in the many places in the controller"}, {"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 0, "creation_date": 1420708845, "post_id": 27832579, "comment_id": 44077633, "body": "Also here instantiated a lot of AR objects, which are slow too"}], "tags": [], "owner": {"reputation": 3976, "user_id": 1210165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f674db9036f7245292bb87295431e31?s=128&d=identicon&r=PG", "display_name": "evanbikes", "link": "https://stackoverflow.com/users/1210165/evanbikes"}, "is_accepted": false, "score": 0, "last_activity_date": 1420688704, "creation_date": 1420688704, "answer_id": 27832579, "question_id": 27825242, "link": "https://stackoverflow.com/questions/27825242/rails-4-double-has-many-includes/27832579#27832579", "title": "rails 4 double has_many includes", "body": "<p>In your partial, I presume you want the current_user's likes for <em>that</em> tweet.</p>\n\n<p>In that case, I would do this in the view:</p>\n\n<pre><code>current_user_likes_for_tweet = current_user.likes.select { |a| a.tweet_id == tweet.id }\n(tweet.likes &amp; current_user_likes_for_tweet).any?\n</code></pre>\n\n<p>This way, <code>current_user.likes</code> will be cached by Rails and you're just doing a filter on an array in memory.</p>\n\n<p>You could <em>also</em> do this:</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>@current_user_likes = current_user.likes.group_by(&amp;:tweet_id)\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>(tweet.likes &amp; @current_user_likes[tweet.id].to_a).any? # to_a because it might be nil\n</code></pre>\n"}], "owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420688704, "creation_date": 1420652218, "question_id": 27825242, "link": "https://stackoverflow.com/questions/27825242/rails-4-double-has-many-includes", "title": "rails 4 double has_many includes", "body": "<p>I have difficulties with double has_many &amp; includes</p>\n\n<p>There is a twitter-style app (with Users, Tweets, and Likes)</p>\n\n<pre><code>class User\n  has_many :tweets # direct tweets\n  has_many :likes # liked tweets\nend\n\nclass Tweet\n  belongs_to :user \n  has_many :likes\n\nclass Like\n  belongs_to :like\n  belongs_to :user\nend\n</code></pre>\n\n<p>Here is spreads query:</p>\n\n<pre><code>@tweets = Tweet.first(20).includes(:likes) # I need to do includes or joins et.c.\n</code></pre>\n\n<p>I have a partial which rendering one tweet and saying to current_user about his like status to particular tweet (something like that):</p>\n\n<pre><code>(tweet.likes &amp; current_user.likes).any? # I can't do efficient query here\n</code></pre>\n\n<p>And I get classic n+1 query. What should I do to prevent it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1420652085, "post_id": 27825157, "comment_id": 44056190, "body": "Perfect! I was not aware of the term &quot;stopwords&quot;, thanks a lot"}], "tags": [], "owner": {"reputation": 2691, "user_id": 3324630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6gEL.jpg?s=128&g=1", "display_name": "Grych", "link": "https://stackoverflow.com/users/3324630/grych"}, "is_accepted": false, "score": 2, "last_activity_date": 1420651919, "creation_date": 1420651919, "answer_id": 27825157, "question_id": 27825026, "link": "https://stackoverflow.com/questions/27825026/remove-excess-junk-words-from-string-or-array-of-strings/27825157#27825157", "title": "Remove excess junk words from string or array of strings", "body": "<p>All you need is a list of English <em>stopwords</em>. You can find it <a href=\"http://www.ranks.nl/stopwords\" rel=\"nofollow\">here</a>, or google for 'english stopwords list'</p>\n"}, {"comments": [{"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1420656709, "post_id": 27826203, "comment_id": 44058818, "body": "Interesting, I had not considered that the a regex would be faster. I will use that method instead. Thanks!"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1420661089, "post_id": 27826203, "comment_id": 44061239, "body": "regex aren&#39;t faster for simple string lookups, but when you&#39;re dealing with a number of them then patterns suddenly have an advantage. There can be gotchas, for more complex situations, but this is pretty straightforward. I used to do exactly this sort of thing a lot in Perl, and found it was a lot faster."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1420661281, "post_id": 27826203, "comment_id": 44061353, "body": "See the added links in the answer about generating and using complex patterns."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 4, "last_activity_date": 1420688343, "last_edit_date": 1495541859, "creation_date": 1420655488, "answer_id": 27826203, "question_id": 27825026, "link": "https://stackoverflow.com/questions/27825026/remove-excess-junk-words-from-string-or-array-of-strings/27826203#27826203", "title": "Remove excess junk words from string or array of strings", "body": "<p>Dealing with stopwords is easy, but I'd suggest you do it BEFORE you split the string into the component words.</p>\n\n<p>Building a fairly simple regular expression can make short work of the words:</p>\n\n<pre><code>STOPWORDS = /\\b(?:#{ %w[to and or the a].join('|') })\\b/i\n# =&gt; /\\b(?:to|and|or|the|a)\\b/i\n\nclean_string = 'to into and sandbar or forest the thesis a algebra'.gsub(STOPWORDS, '')\n# =&gt; \" into  sandbar  forest  thesis  algebra\"\n\nclean_string.split\n# =&gt; [\"into\", \"sandbar\", \"forest\", \"thesis\", \"algebra\"]\n</code></pre>\n\n<p>How do you handle them if you get them already split? I'd <code>join(' ')</code> the array to turn it back into a string, then run the above code, which returns the array again.</p>\n\n<pre><code>incoming_array = [\n  \"14000\",\n  \"Things\",\n  \"to\",\n  \"Be\",\n  \"Happy\",\n  \"About\",\n]\n\nSTOPWORDS = /\\b(?:#{ %w[to and or the a].join('|') })\\b/i\n# =&gt; /\\b(?:to|and|or|the|a)\\b/i\n\nincoming_array = incoming_array.join(' ').gsub(STOPWORDS, '').split\n# =&gt; [\"14000\", \"Things\", \"Be\", \"Happy\", \"About\"]\n</code></pre>\n\n<p>You could try to use Array's set operations, but you'll run afoul of the case sensitivity of the words, forcing you to iterate over the stopwords and the arrays which will run a LOT slower.</p>\n\n<p>Take a look at these two answers for some added tips on how you can build very powerful patterns making it easy to match thousands of strings:</p>\n\n<ul>\n<li>\"<a href=\"https://stackoverflow.com/questions/8888210/how-do-i-ignore-file-types-in-a-web-crawler/8891145#8891145\">How do I ignore file types in a web crawler?</a>\"</li>\n<li>\"<a href=\"https://stackoverflow.com/questions/5395236/is-there-an-efficient-way-to-perform-hundreds-of-text-substitutions-in-ruby/5395777#5395777\">Is there an efficient way to perform hundreds of text substitutions in Ruby?</a>\"</li>\n</ul>\n"}], "owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 2, "accepted_answer_id": 27826203, "answer_count": 2, "score": 2, "last_activity_date": 1420688343, "creation_date": 1420651475, "last_edit_date": 1420655080, "question_id": 27825026, "link": "https://stackoverflow.com/questions/27825026/remove-excess-junk-words-from-string-or-array-of-strings", "title": "Remove excess junk words from string or array of strings", "body": "<p>I have millions of arrays that each contain about five strings. I am trying to remove all of the \"junk words\" (for lack of a better description) from the arrays, such as all articles of speech, words like  \"to\", \"and\", \"or\", \"the\", \"a\" and so on.</p>\n\n<p>For example, one of my arrays has these six strings:</p>\n\n<pre><code>\"14000\"\n\"Things\"\n\"to\"\n\"Be\"\n\"Happy\"\n\"About\"\n</code></pre>\n\n<p>I want to remove the <code>\"to\"</code> from the array.</p>\n\n<p>One solution is to do:</p>\n\n<pre><code>excess_words = [\"to\",\"and\",\"or\",\"the\",\"a\"]\ncleaned_array = dirty_array.reject {|term| excess_words.include? term}\n</code></pre>\n\n<p>But I am hoping to avoid manually typing every excess word. Does anyone know of a Rails function or helper that would help in this process? Or perhaps an array of \"junk words\" already written?</p>\n"}, {"tags": ["ruby", "arrays", "mongodb", "mongodb-query"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420650967, "post_id": 27824773, "comment_id": 44055529, "body": "You should use <code>coll.find(search_hash).limit(3)</code>."}, {"owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420651253, "post_id": 27824773, "comment_id": 44055689, "body": "Thanks for your answer, but the problem is that the ordering is not correct. In both cases, it returns [&quot;item:10028&quot;, &quot;item:15051&quot;, &quot;item:9802&quot;] in that order, whereas I only want the first hits in my array. limit(1) for example should give [&quot;item:9802&quot;] in the first case, and [&quot;item:2355&quot;] in the second."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420651295, "post_id": 27824773, "comment_id": 44055708, "body": "what should be your ordering output?"}, {"owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420651435, "post_id": 27824773, "comment_id": 44055808, "body": "I want the hits in order of the array. Preferably without looping over the array as it can become quite big, and I only need the first, or first 3."}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1420651531, "post_id": 27824773, "comment_id": 44055855, "body": "Just marked your basic duplicate. That&#39;s how you preserve the order that you provided in your <code>$in</code> clause. Combine this with <a href=\"http://docs.mongodb.org/manual/reference/operator/aggregation/limit/\" rel=\"nofollow noreferrer\"><b><code>$limit</code></b></a> in aggregation as part of what was previously mentioned and you have a complete answer."}, {"owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1420669488, "post_id": 27824773, "comment_id": 44065454, "body": "@NeilLunn, what do you mean by &#39;Just marked your basic duplicate.&#39; Preserving the order is exactly what I need. How do I do that?"}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1420672860, "post_id": 27824773, "comment_id": 44066842, "body": "@Fritzz At that time, your question was marked as a duplicate of <a href=\"http://stackoverflow.com/a/22800784/2313887\">Does MongoDB&#39;s $in clause guarantee order?</a> But appears to have been voted for reopening. Noting that the link has been copied into the answer given but this has nothing to do with that answer. To have the server return the results in order and limit to the first three matches in that list order you would use the &quot;aggregation&quot; approach there and add a <code>{ &quot;$limit&quot; =&gt; 3 }</code> pipeline stage at the end."}], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "edited": false, "score": 0, "creation_date": 1420651618, "post_id": 27825027, "comment_id": 44055910, "body": "This returns all matching documents, in order of id, and only the first 3."}, {"owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "edited": false, "score": 0, "creation_date": 1420651712, "post_id": 27825027, "comment_id": 44055955, "body": "I want the hits in order of the array, in the order of the array as I supply it. Preferably without looping over the array as it can become quite big, and I only need the first, or first 3."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "reply_to_user": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "edited": false, "score": 0, "creation_date": 1420651765, "post_id": 27825027, "comment_id": 44055991, "body": "Your <code>in</code> query gives result as per the DB record.. then order it."}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 0, "last_activity_date": 1420651840, "last_edit_date": 1495540256, "creation_date": 1420651477, "answer_id": 27825027, "question_id": 27824773, "link": "https://stackoverflow.com/questions/27824773/how-can-i-find-the-first-matches-in-an-array-in-mongo/27825027#27825027", "title": "How can I find the first matches in an array in Mongo?", "body": "<p>Your query should be :</p>\n\n<pre><code>search_hash = {id: {$in: [\"item:9802\", \"item:15051\", \"item:10028\", \"item:6575\", \"item:2355\"]}}\ndb.coll.find(search_hash).limit(3).sort({id: 1})\n</code></pre>\n\n<p>Read this <a href=\"http://docs.mongodb.org/manual/reference/method/db.collection.find/#combine-cursor-methods\" rel=\"nofollow noreferrer\">Combine Cursor Methods</a> and <a href=\"https://stackoverflow.com/questions/22797768/does-mongodbs-in-clause-guarantee-order\">Does MongoDB's $in clause guarantee order?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "is_accepted": false, "score": 0, "last_activity_date": 1420728566, "last_edit_date": 1495542508, "creation_date": 1420728566, "answer_id": 27842841, "question_id": 27824773, "link": "https://stackoverflow.com/questions/27824773/how-can-i-find-the-first-matches-in-an-array-in-mongo/27842841#27842841", "title": "How can I find the first matches in an array in Mongo?", "body": "<p>Thanks for your answers and suggestions. The \"aggregation\" approach from <a href=\"https://stackoverflow.com/a/22800784/2313887\">Does MongoDB's $in clause guarantee order?</a> seems to be the best way to do this in Mongo, but I find that pretty cumbersome. I just want to make sure I get a result back, so I'm sending more IDs to look for, to make sure I find at least something. I dont want be bothered with assigning weights to everything. I've decided to just loop over the items, and break if I find something, like this:</p>\n\n<pre><code>item_ids = params['item_ids'].split('&amp;').uniq.first(30).map {|key| \"#{item}:#{key}\"}\nfound = []\nitem_ids.each do |item_id|\n  found = coll.find({id: item_id}).to_a\n  break if found.any?\nend\nif found.any?\n  ## The rest of my logic, using the first hit from my array.\n</code></pre>\n\n<p>For me, this is easiest to read, maintain and understand.\nIf anyone has a better approach which involves only one Mongo query, I'm still very interested.</p>\n"}], "owner": {"reputation": 657, "user_id": 1478067, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/903502d265abfcff376967bc2d175ef3?s=128&d=identicon&r=PG", "display_name": "Fritzz", "link": "https://stackoverflow.com/users/1478067/fritzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420728566, "creation_date": 1420650636, "question_id": 27824773, "link": "https://stackoverflow.com/questions/27824773/how-can-i-find-the-first-matches-in-an-array-in-mongo", "title": "How can I find the first matches in an array in Mongo?", "body": "<p>I have an array of items, of which I would to find the first matches in my mongo db.</p>\n\n<p>The array is like this, but could be very long: [\"item:9802\", \"item:15051\", \"item:10028\", \"item:6575\", \"item:2355\"]\nWhat I need is the first three hits, that can be found in the mongo db. Not all IDs will exist.</p>\n\n<p>I use the github.com/mongodb/mongo-ruby-driver.\nWhat I did was this</p>\n\n<pre><code>search_hash = {:id=&gt;{\"$in\"=&gt;[\"item:9802\", \"item:15051\", \"item:10028\", \"item:6575\", \"item:2355\"]}}\nfound = coll.find(search_hash).to_a\n</code></pre>\n\n<p>But I find that this returns the exact same results (and in the same order) when I use a completely different order, like:</p>\n\n<pre><code>search_hash = {:id=&gt;{\"$in\"=&gt;[\"item:2355\", \"item:6575\", \"item:9802\", \"item:15051\", \"item:10028\"]}}\n</code></pre>\n\n<p>It there anyway to get the first matches without having to loop over the array (which is very long) and perform a find on every loop?\nI'm pretty new to Mongo, so maybe this is a very simple question, but I hope that anyone can help me with this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "api"], "answers": [{"tags": [], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "is_accepted": true, "score": 0, "last_activity_date": 1420654112, "creation_date": 1420654112, "answer_id": 27825826, "question_id": 27824690, "link": "https://stackoverflow.com/questions/27824690/how-to-adapt-db-structure-to-the-expected-api/27825826#27825826", "title": "How to adapt db structure to the expected API", "body": "<p>The rendered json structure is not tied to the database structure you use. The attribute_names can be set in the json render function (and can be same or different from the underlying database field name)</p>\n\n<p>Continuing from the table structure you have:</p>\n\n<pre><code>create_table :foos do |t|\n  t.string :baar\nend\n</code></pre>\n\n<p>This would correspond to the <code>foo</code> model:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  ..\nend\n</code></pre>\n\n<p>The json render function within <code>foos_controller.rb</code> - for the show action (for example)- would be as follows:</p>\n\n<pre><code>class FoosController &lt; &lt; ApplicationController\n\n  def show\n    @foo = Foo.find(1)\n\n    respond_to do |format|\n      format.json { render json: { foo: { baar: @foo.bar } } }\n    end\n  end\nend\n</code></pre>\n\n<p>Here, the json attribute - <code>baar</code> could be anything, and that is being linked to the <code>bar</code> field in the <code>foos</code> table. </p>\n"}], "owner": {"reputation": 1973, "user_id": 806495, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c5c29b306703729375c68f4148527467?s=128&d=identicon&r=PG", "display_name": "Leszek Andrukanis", "link": "https://stackoverflow.com/users/806495/leszek-andrukanis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 27825826, "answer_count": 1, "score": 0, "last_activity_date": 1420654112, "creation_date": 1420650326, "question_id": 27824690, "link": "https://stackoverflow.com/questions/27824690/how-to-adapt-db-structure-to-the-expected-api", "title": "How to adapt db structure to the expected API", "body": "<p>Let's say I have client side app which expects the following JSON structure as show.</p>\n\n<pre><code>{'foo': {'bar': '1'}}\n</code></pre>\n\n<p>I'd like to keep related db structure as:</p>\n\n<pre><code> create_table :foos do |t|\n   t.string :baar\n end\n</code></pre>\n\n<p>so I'd like to use <code>baar</code> instead of <code>bar</code> as name of db column. What do you think about just aliasing this stuff to something like:</p>\n\n<pre><code>alias_attribute :bar, :baar\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth-2.0", "grape", "doorkeeper"], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 980085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59cd634a892061627238b406d4036c7?s=128&d=identicon&r=PG", "display_name": "user980085", "link": "https://stackoverflow.com/users/980085/user980085"}, "is_accepted": false, "score": 0, "last_activity_date": 1423577277, "creation_date": 1423577277, "answer_id": 28433701, "question_id": 27824563, "link": "https://stackoverflow.com/questions/27824563/authenticate-grape-0-10-1-with-doorkeeper-2-0-1/28433701#28433701", "title": "Authenticate Grape 0.10.1 with doorkeeper 2.0.1", "body": "<p>i recently moved from grape-doorkeeper to <a href=\"https://github.com/antek-drzewiecki/wine_bouncer\" rel=\"nofollow\">wine_bouncer</a>.<br>\nit works fine on ruby 2.2.0 and rails 4.2.0, with doorkeeper 2.0.1 and grape 0.10.1.</p>\n"}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423577277, "creation_date": 1420649923, "last_edit_date": 1420702475, "question_id": 27824563, "link": "https://stackoverflow.com/questions/27824563/authenticate-grape-0-10-1-with-doorkeeper-2-0-1", "title": "Authenticate Grape 0.10.1 with doorkeeper 2.0.1", "body": "<p>I'm using grape along with doorkeeper fro OAuth2 authentication. Now, I want to upgrade from grape 0.8 to grape 0.10.1, and doorkeeper to 2.0.1. Unfortunately, I ran into some problems. Before, I could use grape-doorkeeper to integrate doorkeeper easily in grape <a href=\"https://github.com/fuCtor/grape-doorkeeper\" rel=\"nofollow\">https://github.com/fuCtor/grape-doorkeeper</a></p>\n\n<p>But after upgrading, I get some errors like <code>uninitialized constant Doorkeeper::DoorkeeperForBuilder (NameError)</code>, and also the <code>doorkeeper_for</code> helper seems to be removed from doorkeeper and replaced by <code>before_action :doorkeeper_authorize!</code> (see <a href=\"https://github.com/doorkeeper-gem/doorkeeper/blob/master/CHANGELOG.md#backward-incompatible-changes\" rel=\"nofollow\">https://github.com/doorkeeper-gem/doorkeeper/blob/master/CHANGELOG.md#backward-incompatible-changes</a>).</p>\n\n<p>Here <a href=\"https://github.com/intridea/grape#register-custom-middleware-for-authentication\" rel=\"nofollow\">https://github.com/intridea/grape#register-custom-middleware-for-authentication</a> the Grape documentation tells us, that we can use <code>rack-oauth2</code> for OAuth2 authentication, but as far as I see, this lacks of the easy rails integration that doorkeeper provides, right?</p>\n\n<p>So now, I'm a little bit confused, how to integrate doorkeeper 2.0.1 into grape 0.10.1. I already read some tutorials, but they are targeting older versions for this gems. So, any help is appreciated!</p>\n\n<p><strong>Update</strong></p>\n\n<p>I digged into the GrapeDoorkeeper gem, and found the following lines (<a href=\"https://github.com/fuCtor/grape-doorkeeper/blob/master/lib/grape-doorkeeper/oauth2.rb#L64\" rel=\"nofollow\">https://github.com/fuCtor/grape-doorkeeper/blob/master/lib/grape-doorkeeper/oauth2.rb#L64</a>):</p>\n\n<p><code>\n  module OAuth2\n    def doorkeeper_for *args\n      doorkeeper_for = Doorkeeper::DoorkeeperForBuilder.create_doorkeeper_for(*args)\n      use GrapeDoorkeeper::Middleware, doorkeeper: doorkeeper_for\n    end\n  end\n</code></p>\n\n<p>Then I looked into doorkeeper 2.0.1 and noticed, that the class <code>DoorkeeperForBuilder</code> and and the <code>create_doorkeeper_for</code> method are gone. I also couldn't find a replacement or another way to do this. To me, it looks like <code>Doorkeeper::DoorkeeperForBuilder.create_doorkeeper_for</code> returns a middleware that is used by grape. So, how would that be done with the new doorkeeper?</p>\n\n<p>Another question would be, if this line still would work with doorkeeper 2: <a href=\"https://github.com/fuCtor/grape-doorkeeper/blob/master/lib/grape-doorkeeper/oauth2.rb#L73\" rel=\"nofollow\">https://github.com/fuCtor/grape-doorkeeper/blob/master/lib/grape-doorkeeper/oauth2.rb#L73</a></p>\n\n<p><code>\nGrape::API.extend GrapeDoorkeeper::OAuth2\n</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 2, "creation_date": 1420650088, "post_id": 27824523, "comment_id": 44054986, "body": "Don&#39;t keep us hanging :-) does it work?"}], "answers": [{"comments": [{"owner": {"reputation": 3711, "user_id": 731085, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5529fb16cbb4d6dd1450469ea45f9fec?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/731085/jeff"}, "edited": false, "score": 0, "creation_date": 1420650738, "post_id": 27824730, "comment_id": 44055382, "body": "so if I modified the above to <code>file = File.new(&#39;path&#47;to&#47;repo&#47;file.xml&#39;).read</code> then this should work"}], "tags": [], "owner": {"reputation": 2691, "user_id": 3324630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6gEL.jpg?s=128&g=1", "display_name": "Grych", "link": "https://stackoverflow.com/users/3324630/grych"}, "is_accepted": false, "score": 0, "last_activity_date": 1420650482, "creation_date": 1420650482, "answer_id": 27824730, "question_id": 27824523, "link": "https://stackoverflow.com/questions/27824523/does-the-ruby-file-object-constructor-load-the-entire-file-into-memory/27824730#27824730", "title": "Does the ruby File object constructor load the entire file into memory", "body": "<p><code>File.new</code> is lazy and does not load the whole file into to memory. You must <code>read</code> it to get it contents. Do a simple test, create a file, open it with <code>File.new</code> and modify its content before reading.</p>\n"}], "owner": {"reputation": 3711, "user_id": 731085, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5529fb16cbb4d6dd1450469ea45f9fec?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/731085/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420650482, "creation_date": 1420649820, "last_edit_date": 1420649852, "question_id": 27824523, "link": "https://stackoverflow.com/questions/27824523/does-the-ruby-file-object-constructor-load-the-entire-file-into-memory", "title": "Does the ruby File object constructor load the entire file into memory", "body": "<p>I'm trying to understanding what happens when I create a ruby File object.</p>\n\n<p>The case have in mind is whether I can create a File object for a file while on one branch of the source tree and then switch branches and then still be able to access the file from the previous branch via the in initial file object I created.</p>\n\n<p>So something like this: </p>\n\n<pre><code>repo = Rugged::Repository.new('path/to/repo/')\nrepo.checkout(\"test_branch\")\nfile = File.new('path/to/repo/file.xml') \nrepo.checkout(\"master\")\n\nfile.read # hopefully reading a file from the `test_branch` \n</code></pre>\n\n<p>I'm hoping that <code>file.read</code> would now be reading the file from the <code>test_branch</code> even though I checked-out the repo back to master branch.</p>\n\n<p>Will this work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "controller", "actionpack"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420649050, "post_id": 27824136, "comment_id": 44054359, "body": "Almost certainly this line, <code>@newchar.class = charclass</code>, call the attribute something else like <code>character_class</code>."}, {"owner": {"reputation": 368, "user_id": 1349441, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9eac1bf6266131f48b0967697ff07b9d?s=128&d=identicon&r=PG", "display_name": "dhartwich", "link": "https://stackoverflow.com/users/1349441/dhartwich"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420649274, "post_id": 27824136, "comment_id": 44054507, "body": "Changed it and it still appears with the same error, what I also noticed is that If I try to do the same request again the request fails with the error: NoMethodError (undefined method <code>[]&#39; for nil:NilClass):   app&#47;controllers&#47;api&#47;v1&#47;characters_controller.rb:11:in </code>create&#39; which is the line: @newchar = Character.new in my controller"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420649808, "post_id": 27824136, "comment_id": 44054828, "body": "Can you post the full stacktrace please."}, {"owner": {"reputation": 368, "user_id": 1349441, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9eac1bf6266131f48b0967697ff07b9d?s=128&d=identicon&r=PG", "display_name": "dhartwich", "link": "https://stackoverflow.com/users/1349441/dhartwich"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420705288, "post_id": 27824136, "comment_id": 44075980, "body": "This is the full stack trace I got"}], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 2534960, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/2d8lP.jpg?s=128&g=1", "display_name": "Kasperi", "link": "https://stackoverflow.com/users/2534960/kasperi"}, "edited": false, "score": 0, "creation_date": 1433181199, "post_id": 27835729, "comment_id": 49229982, "body": "Can confirm, same problem, same solution."}, {"owner": {"reputation": 329, "user_id": 2044564, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WCppP.jpg?s=128&g=1", "display_name": "David Routen", "link": "https://stackoverflow.com/users/2044564/david-routen"}, "edited": false, "score": 0, "creation_date": 1434168045, "post_id": 27835729, "comment_id": 49677446, "body": "I&#39;ve been tearing my hair out due to this issue (just upgraded to Rails 4.1.2 and was convinced the upgrade was the cause).. thank you SO much for this answer!"}], "tags": [], "owner": {"reputation": 368, "user_id": 1349441, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9eac1bf6266131f48b0967697ff07b9d?s=128&d=identicon&r=PG", "display_name": "dhartwich", "link": "https://stackoverflow.com/users/1349441/dhartwich"}, "is_accepted": true, "score": 2, "last_activity_date": 1420705396, "creation_date": 1420705396, "answer_id": 27835729, "question_id": 27824136, "link": "https://stackoverflow.com/questions/27824136/rails-systemstackerror-stack-level-too-deep-in-actionpack/27835729#27835729", "title": "Rails SystemStackError (stack level too deep) in actionpack", "body": "<p>The answer to this problem was to rename the attribute of Character named class. This has somehow caused the error and after changing it the problem was gone. Thanks to everyone who helped me with this problem.</p>\n"}], "owner": {"reputation": 368, "user_id": 1349441, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9eac1bf6266131f48b0967697ff07b9d?s=128&d=identicon&r=PG", "display_name": "dhartwich", "link": "https://stackoverflow.com/users/1349441/dhartwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2632, "favorite_count": 0, "accepted_answer_id": 27835729, "answer_count": 1, "score": 0, "last_activity_date": 1420705396, "creation_date": 1420648639, "last_edit_date": 1420649390, "question_id": 27824136, "link": "https://stackoverflow.com/questions/27824136/rails-systemstackerror-stack-level-too-deep-in-actionpack", "title": "Rails SystemStackError (stack level too deep) in actionpack", "body": "<p>today I got to an error with my Ruby on Rails API and I can't figure out what the problem is. Whenever I try to create a new Character in my Controller I always get an SystemStackError and I have no Idea why. I will post the relevant Files below.</p>\n\n<p>characters_controller.rb</p>\n\n<pre><code>module Api\nmodule V1\n    class CharactersController &lt; ApplicationController\n        def index\n            @chars = Character.all\n            respond_to do |format|\n                format.json { render :json =&gt; @chars }\n            end\n        end\n        def create\n            @newchar = Character.new\n\n            lastmod = params[:lastModified]\n            charname = params[:name]\n            realm = params[:realm]\n            battlegroup = params[:battlegroup]\n            charclass = params[:class]\n            race = params[:race]\n            gender = params[:gender]\n            level = params[:level]\n            achievement_points = params[:achievementPoints]\n            thumbnailurl = params[:thumbnailurl]\n            itemlvltotal = params[:itemleveltotal]\n            itemlvlequipped = params[:itemlevelequipped]\n            userid = params[:userid]\n\n            @newchar.lastModified = lastmod\n            @newchar.name = charname\n            @newchar.realm = realm\n            @newchar.battlegroup = battlegroup\n            @newchar.class = charclass\n            @newchar.race = race\n            @newchar.gender = gender\n            @newchar.level = level\n            @newchar.achievementPoints = achievement_points\n            @newchar.thumbnailurl = thumbnailurl\n            @newchar.itemleveltotal = itemlvltotal\n            @newchar.itemlevelequipped = itemlvlequipped\n            @newchar.userid = userid\n\n            if @newchar.save!\n                render json: {status: 'success', code: 0, message: 'Character has been saved'}\n            else\n                render json: {status: 'error', code: 1, message: 'Failed to save character'}\n            end\n        end\n        def update \n        end\n        def mychars\n            @chars = Character.where(userid: params[:userid])\n            render json: {characters: @chars}\n        end\n    end\nend\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n namespace :api, :defaults =&gt; {:format =&gt; :json} do\nnamespace :v1 do\n\n    resources :users do\n    collection do\n      post 'register'\n      post 'login'\n      get 'make_moderator'\n    end\n  end\n\n  resources :raids do\n    collection do\n      post 'create'\n      get 'details'\n      post 'sign_up'\n      post 'sign_off'\n      post 'signedup'\n    end\n  end\n\n  resources :characters do\n    collection do\n      get 'mychars'\n      post 'create'\n      post 'update'\n    end\n  end\n\n  end\n end\nend\n</code></pre>\n\n<p>character.rb (my model)</p>\n\n<pre><code>class Character &lt; ActiveRecord::Base\n   belongs_to :user\nend\n</code></pre>\n\n<p>The error (stacktrace) I get is:</p>\n\n<pre><code>Started POST \"/api/v1/characters/create\" for 82.112.107.65 at 2015-01-07 17:30:10 +0100\n  ActiveRecord::SchemaMigration Load (0.2ms)  SELECT \"schema_migrations\".* FROM     \"schema_migrations\"\nProcessing by Api::V1::CharactersController#create as JSON\n  Parameters: {\"lastModified\"=&gt;\"1194551616\", \"name\"=&gt;\"Mortan\", \"realm\"=&gt;\"Kargath\",     \"battlegroup\"=&gt;\"Reckoning / Abrechnung\", \"class\"=&gt;\"5\", \"race\"=&gt;\"4\", \"gender\"=&gt;\"0\", \"level\"=&gt;\"72\", \"achievementPoints\"=&gt;\"7245\", \"thumbnailurl\"=&gt;\"http://eu.battle.net/static-render/eu/kargath/240/386800-avatar.jpg\", \"itemleveltotal\"=&gt;\"137\", \"itemlevelequipped\"=&gt;\"127\", \"userid\"=&gt;\"10\"}\nCompleted 500 Internal Server Error in 26ms\n\nSystemStackError (stack level too deep):\n  actionpack (4.1.8) lib/action_dispatch/middleware/reloader.rb:79\n\n\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-    4.1.8/lib/action_dispatch/middleware/templates/rescues/_source.erb (0.9ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (1.8ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.8ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (29.0ms)\n</code></pre>\n\n<p>Any help is appreciated since I don't know how to handle this problem :) thanks</p>\n\n<p>EDIT: Whenever I try to send the same request again I get a different error:</p>\n\n<pre><code>NoMethodError (undefined method `[]' for nil:NilClass):\n  app/controllers/api/v1/characters_controller.rb:11:in `create'\n\n\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/_source.erb (1.2ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.2ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (1.8ms)\n  Rendered /usr/local/lib/ruby/gems/2.1.0/gems/actionpack-4.1.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (28.3ms)\n</code></pre>\n\n<p>Where line 11 is:</p>\n\n<pre><code>@newchar = Character.new\n</code></pre>\n"}, {"tags": ["ruby", "mongodb", "postgresql", "mongodb-query"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1420650157, "post_id": 27824056, "comment_id": 44055021, "body": "Okay so postgresql uses SQL which is a string you need to construct and yes SQL supports parameter binding. But Ruby is a dynamic language as is the concept behind most ORM&#39;s using a dynamic data construct to form a query. MongoDB just uses the dynamic data construct without translation to a SQL string. So why can you not just interpolate a variable or &quot;cook&quot; the data structure? That&#39;s what I do. All the code I have written cannot be wrong. You got +10 rep for this from someone as of writing, so you probably don&#39;t really want to delete it though."}, {"owner": {"reputation": 10724, "user_id": 3749550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MQMvF.jpg?s=128&g=1", "display_name": "wdberkeley", "link": "https://stackoverflow.com/users/3749550/wdberkeley"}, "edited": false, "score": 0, "creation_date": 1420656380, "post_id": 27824056, "comment_id": 44058597, "body": "Could you include a sample document from your collection in MongoDB?"}], "owner": {"reputation": 85078, "user_id": 31610, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/20571f32acd27d2cf5f1b1f42ea1a75b?s=128&d=identicon&r=PG", "display_name": "Geo", "link": "https://stackoverflow.com/users/31610/geo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420650169, "creation_date": 1420648351, "last_edit_date": 1420650169, "question_id": 27824056, "link": "https://stackoverflow.com/questions/27824056/how-can-i-dynamically-filter-for-dates-using-mongodb", "title": "How can I dynamically filter for dates using mongodb?", "body": "<p>I have the following in postgresql:</p>\n\n<pre><code>where(\"booking.started_at + (interval '1 min' * booking.duration) &lt;= ?\", Time.zone.now)\n</code></pre>\n\n<p>However, I don't know how to express it in mongo. I've seen some posts suggesting to use date ranges, something like:</p>\n\n<pre><code>db.bookings.find({\"started_at\": {\"$gte\": started_at_value, \"$lt\": ?}})\n</code></pre>\n\n<p>Basically, I'd like to find all the bookings that are started, this means (pseudocode) : <code>started_at &lt;= current_time &lt;= started_at + duration</code> . I don't know how to specify the end range of the query. Any pointers?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sprockets"], "answers": [{"comments": [{"owner": {"reputation": 1392, "user_id": 325028, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/caa31faa9e88940a27c37ee758a291b3?s=128&d=identicon&r=PG", "display_name": "Robin Fisher", "link": "https://stackoverflow.com/users/325028/robin-fisher"}, "edited": false, "score": 0, "creation_date": 1420649108, "post_id": 27824193, "comment_id": 44054396, "body": "That directive is where you want Sprockets to compile assets on the fly in production and <a href=\"http://stackoverflow.com/questions/8821864/config-assets-compile-true-in-rails-production-why-not\">that is not good</a>. I am precompiling and MD5 fingerprinted assets are in my public/assets directory."}], "tags": [], "owner": {"reputation": 1053, "user_id": 3210186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251bc7e341ff2f4525e2d5a34b72861a?s=128&d=identicon&r=PG&f=1", "display_name": "Shweta", "link": "https://stackoverflow.com/users/3210186/shweta"}, "is_accepted": false, "score": -2, "last_activity_date": 1420648817, "creation_date": 1420648817, "answer_id": 27824193, "question_id": 27824007, "link": "https://stackoverflow.com/questions/27824007/rails-4-not-requesting-fingerprinted-asset-in-production/27824193#27824193", "title": "Rails 4 not requesting fingerprinted asset in production", "body": "<p>It seems you are not precompiling assets. In your production.rb make following change</p>\n\n<pre><code>config.assets.compile = true\n</code></pre>\n"}], "owner": {"reputation": 1392, "user_id": 325028, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/caa31faa9e88940a27c37ee758a291b3?s=128&d=identicon&r=PG", "display_name": "Robin Fisher", "link": "https://stackoverflow.com/users/325028/robin-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1446754317, "creation_date": 1420648188, "question_id": 27824007, "link": "https://stackoverflow.com/questions/27824007/rails-4-not-requesting-fingerprinted-asset-in-production", "title": "Rails 4 not requesting fingerprinted asset in production", "body": "<p>I've just deployed a Rails 4.1.1 app to a VPS. Running Ruby 2 and Passenger.</p>\n\n<p>My application is not making requests to the fingerprinted version of the asset files. In my <code>application.html.erb</code> I have:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag    \"application\" %&gt;\n&lt;%= stylesheet_link_tag \"slick\" %&gt;\n&lt;%= javascript_include_tag \"vendor/modernizr\" %&gt;\n</code></pre>\n\n<p>Generating output html of:</p>\n\n<pre><code>&lt;link href=\"/stylesheets/application.css\" media=\"screen\" rel=\"stylesheet\" /&gt;\n&lt;link href=\"/stylesheets/slick.css\" media=\"screen\" rel=\"stylesheet\" /&gt;\n&lt;script src=\"/javascripts/vendor/modernizr.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Relevant config is:</p>\n\n<p><strong>production.rb</strong></p>\n\n<pre><code>config.serve_static_assets = false\nconfig.assets.js_compressor = :uglifier\nconfig.assets.compile = false\nconfig.assets.digest = true\nconfig.assets.version = '1.0'\nconfig.assets.precompile += %w( vendor/modernizr.js slick.css )\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "generator"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1420656516, "post_id": 27823942, "comment_id": 44058684, "body": "For testing what? You&#39;re going to generate email addresses in only one of a multitude of formats. The list of acceptable formats is a lot longer than most people realize, which makes it hard to create a validator that is worth anything. If you just need the one form of &quot;user@host.domain&quot;, then sure, your code will work. If you need to test an email gateway or a validator, then no, it won&#39;t."}, {"owner": {"reputation": 6485, "user_id": 2065540, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6f4e6ee47768e4b6304697de935cf00a?s=128&d=identicon&r=PG", "display_name": "Xeen", "link": "https://stackoverflow.com/users/2065540/xeen"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1420698218, "post_id": 27823942, "comment_id": 44073549, "body": "@theTinMan I needed to generate some content to show my client how emails would look like in a given part of a website. I wanted to make them as realistic looking as possible, therefor I did it this way. Basically testing wasn&#39;t the right way to call it I guess, more like testing &quot;will it work out&quot;. ;) Also I didn&#39;t use <code>Faker</code> due to the need to localize those emails."}], "answers": [{"tags": [], "owner": {"reputation": 15962, "user_id": 472768, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L6pgx.png?s=128&g=1", "display_name": "FeifanZ", "link": "https://stackoverflow.com/users/472768/feifanz"}, "is_accepted": false, "score": 1, "last_activity_date": 1420648178, "last_edit_date": 1495535373, "creation_date": 1420648178, "answer_id": 27824004, "question_id": 27823942, "link": "https://stackoverflow.com/questions/27823942/how-to-create-email-address-generator-with-ruby/27824004#27824004", "title": "How to create email address generator with Ruby?", "body": "<p>There's a <a href=\"https://stackoverflow.com/a/377787/472768\">couple ways to join strings in Ruby</a>. Inline placeholders seems to make the most sense here:</p>\n\n<pre><code>@addressess &lt;&lt; \"#{ males.sample }.#{ surnameMales.sample }#{ number }@#{ providers.sample }\"\n</code></pre>\n\n<p>In a double-quoted string, <code>#{ expr }</code> is evaluated and subbed inline. <code>\"#{ 1 + 1 }\"</code> outputs <code>\"2\"</code>, for example.</p>\n\n<p>Also a couple ways you can distinguish male or female \u2014 for example, checking if a random number is even or odd:</p>\n\n<pre><code>name = if rand(1..100) % 2 == 0 ? \"#{ males.sample }.#{ surnameMales.sample }\" : \"#{ females.sample }.#{ surnameFemales.sample }\"\n@addresses &lt;&lt; \"#{ name }#{ number }@#{ providers.sample }\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37399, "user_id": 441387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf2c39b5cc1cb9db06cecb16dc8e665c?s=128&d=identicon&r=PG", "display_name": "Henrik Andersson", "link": "https://stackoverflow.com/users/441387/henrik-andersson"}, "is_accepted": true, "score": 3, "last_activity_date": 1420648551, "last_edit_date": 1420648551, "creation_date": 1420648235, "answer_id": 27824024, "question_id": 27823942, "link": "https://stackoverflow.com/questions/27823942/how-to-create-email-address-generator-with-ruby/27824024#27824024", "title": "How to create email address generator with Ruby?", "body": "<p>Use a combination of string interpolation and <a href=\"http://www.ruby-doc.org/core-2.2.0/Array.html#method-i-sample\" rel=\"nofollow\">Array#sample</a>.</p>\n\n<pre><code>\"#{females.sample}.#{surnameFemales.sample}#{rand(252...4350)}@#{providers.sample}\"\n&gt;&gt; \"rose.rosewelth3266@gmail.com\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3494, "user_id": 796004, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3pFzW.jpg?s=128&g=1", "display_name": "Carson Cole", "link": "https://stackoverflow.com/users/796004/carson-cole"}, "edited": false, "score": 0, "creation_date": 1570546641, "post_id": 27824045, "comment_id": 102942580, "body": "Faker uses a set of domains that can actually be real domains, so make sure you don&#39;t use them in case where you might send an email."}], "tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": false, "score": 11, "last_activity_date": 1420648295, "creation_date": 1420648295, "answer_id": 27824045, "question_id": 27823942, "link": "https://stackoverflow.com/questions/27823942/how-to-create-email-address-generator-with-ruby/27824045#27824045", "title": "How to create email address generator with Ruby?", "body": "<p>Is your goal to do this as an exercise or is this just something you're trying to get done?  If it's the latter, install the <a href=\"https://github.com/stympy/faker\">faker gem</a> and just use it:</p>\n\n<pre><code>Faker::Internet.email #=&gt; \"kirsten.greenholt@corkeryfisher.info\"\n</code></pre>\n\n<p>For 100:</p>\n\n<pre><code>100.times.map { Faker::Internet.email }\n</code></pre>\n"}], "owner": {"reputation": 6485, "user_id": 2065540, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/6f4e6ee47768e4b6304697de935cf00a?s=128&d=identicon&r=PG", "display_name": "Xeen", "link": "https://stackoverflow.com/users/2065540/xeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3706, "favorite_count": 0, "accepted_answer_id": 27824024, "answer_count": 3, "score": 2, "last_activity_date": 1420648551, "creation_date": 1420647961, "question_id": 27823942, "link": "https://stackoverflow.com/questions/27823942/how-to-create-email-address-generator-with-ruby", "title": "How to create email address generator with Ruby?", "body": "<pre><code>  def emails\n    i = 0\n    number = rand(252...4350)\n\n    males = [\"tom\", \"jack\", \"adam\"]\n    females = [\"elizabeth\", \"rose\", \"juliet\"]\n\n    surnameMales = [\"oak\", \"yew\", \"timber\"]\n    surnameFemales = [\"rosewelth\", \"gates\", \"jobs\"]\n\n    providers = [\"gmail.com\", \"hotmail.com\", \"yahoo.com\"]\n\n    while i &lt;= 100 do\n      @addresses &lt;&lt; \n    end\n  end\n</code></pre>\n\n<p>What I want to do is pick a random number, name, surname and provider and put them all together + attach a random number at the end of the surname so that it looks, for example, like this: <code>rose.gates643@gmail.com</code>, but kind of got stuck at the point where I have to put the whole thing together. As you can probably tell, I want to create a <code>100</code> random emails for testing purposes.</p>\n\n<p>Can you please point me out how I could do what I have intended to do with <code>Ruby</code>?</p>\n"}, {"tags": ["ruby", "facebook", "omniauth", "cuba"], "answers": [{"comments": [{"owner": {"reputation": 2676, "user_id": 1456004, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8bc8096bf315be2fb658f246ae9f4ef0?s=128&d=identicon&r=PG", "display_name": "Fran b", "link": "https://stackoverflow.com/users/1456004/fran-b"}, "edited": false, "score": 0, "creation_date": 1420658689, "post_id": 27824077, "comment_id": 44059898, "body": "Just one last bit, it was  <code>on &#39;auth&#47;facebook&#47;callback&#39; do</code> instance of <code>on &#39;&#47;auth&#47;facebook&#47;callback&#39; do</code>. With that two changes, now it is working."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1420648405, "creation_date": 1420648405, "answer_id": 27824077, "question_id": 27823819, "link": "https://stackoverflow.com/questions/27823819/omniauth-argumenterror-wrong-number-of-arguments-1-for-0/27824077#27824077", "title": "Omniauth: ArgumentError: wrong number of arguments (1 for 0)", "body": "<p>There should be one on-get block defining multiple routes:</p>\n\n<pre><code>Cuba.define do\n   on get do\n     on '/auth/facebook/callback' do \n       res.write \"Autentication with Facebook was successful!\"\n     end\n\n     on '/auth/failure' do\n       res.write \"Something was wrong with Facebook authentication\"\n     end\n   end\nend\n</code></pre>\n"}], "owner": {"reputation": 2676, "user_id": 1456004, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8bc8096bf315be2fb658f246ae9f4ef0?s=128&d=identicon&r=PG", "display_name": "Fran b", "link": "https://stackoverflow.com/users/1456004/fran-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 27824077, "answer_count": 1, "score": 0, "last_activity_date": 1420648405, "creation_date": 1420647627, "question_id": 27823819, "link": "https://stackoverflow.com/questions/27823819/omniauth-argumenterror-wrong-number-of-arguments-1-for-0", "title": "Omniauth: ArgumentError: wrong number of arguments (1 for 0)", "body": "<p>I am using Omniauth for login with Facebook but when Callback phase is initiated I get this error:</p>\n\n<pre><code>[2015-01-07T02:26:31.113785 #11509]  INFO -- omniauth: (facebook) Request phase initiated.\n127.0.0.1 - - [07/Jan/2015:02:26:31 +0100] \"GET /auth/facebook HTTP/1.1\" 302 239 0.0097\nI, [2015-01-07T02:26:31.295848 #11509]  INFO -- omniauth: (facebook) Callback phase initiated.\nArgumentError: wrong number of arguments (1 for 0)\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:317:in `get'\n    /home/ciro/workspace/iParty/app.rb:25:in `block in &lt;top (required)&gt;'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:127:in `instance_eval'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:127:in `block in call!'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:126:in `catch'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:126:in `call!'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/cuba-3.3.0/lib/cuba.rb:111:in `call'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/omniauth-1.2.2/lib/omniauth/strategy.rb:404:in `call_app!'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/omniauth-1.2.2/lib/omniauth/strategy.rb:362:in `callback_phase'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/omniauth-oauth2-1.2.0/lib/omniauth/strategies/oauth2.rb:77:in `callback_phase'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/omniauth-facebook-1.6.0/lib/omniauth/strategies/facebook.rb:71:in `callback_phase'\n    /home/ciro/.rvm/gems/ruby-2.1.3/gems/omniauth-1.2.2/lib/omniauth/strategy.rb:227:in `callback_call'\n</code></pre>\n\n<p>I have used <a href=\"https://github.com/soveran/cuba\" rel=\"nofollow\">Cuba framework</a> (which is very similar to Sinatra). This is my configuration:</p>\n\n<p><strong>app.rb</strong></p>\n\n<pre><code>require \"cuba\"\nrequire \"omniauth-facebook\"\n\nCuba.use Rack::Session::Cookie,\n   key: ENV['COOKIE_KEY'],\n   secret: ENV['COOKIE_SECRET'] \n\n Cuba.use OmniAuth::Builder do\n    provider :facebook, ENV['FBK_APP_ID'], ENV['FBK_APP_SECRET']\n end\n\nCuba.define do\n   on get '/auth/facebook/callback' do \n      res.write \"Autentication with Facebook was successful!\"\n   end\n\n   on get '/auth/failure' do\n     res.write \"Something was wrong with Facebook authentication\"\n   end\nend\n</code></pre>\n\n<p>What is missing?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "haml"], "answers": [{"tags": [], "owner": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "is_accepted": true, "score": 0, "last_activity_date": 1421163241, "creation_date": 1421163241, "answer_id": 27925724, "question_id": 27823665, "link": "https://stackoverflow.com/questions/27823665/rails-3-serialized-model-field-form-for-and-field-for-not-generating-correct-nam/27925724#27925724", "title": "Rails 3 serialized model field form_for and field_for not generating correct name", "body": "<p>Here is some information for all that have not understood properly how <code>nested_attributes</code> works, like me.</p>\n\n<p>What I have reported as issue is actually how it is supposed to work. When we have, let say, this model:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base # it has name attribute\n  has_many :larodis\n  accepts_nested_attributes_for :larodi\nend\n\nclass Larodi &lt; ActiveRecord::Base # it has name attribute\n  belongs_to :foo\nend\n</code></pre>\n\n<p>This definition gives me the possibility to create <code>Foo</code> with many <code>Larodi</code>'s just by giving a hash of parameters. For example:</p>\n\n<pre><code>x = Foo.create(name: 'Josh', larodi_attributes: [ {name: 'Wayne'} ]\nx.larodis.map(&amp;:name) # ['Wayne']\n</code></pre>\n\n<p>Now comes the part where <code>#field_for</code> understands if we have nested attribute to work with. We check this by looking for <code>name_attributes=</code> method. If it is defined <code>#fields_for</code> generates form of the type <code>&lt;input ... name=object[name][INDEX][method]&gt;...</code> where index is just an integer. </p>\n\n<p>Keep in mind that when implementing custom <code>name_attibutes(attributes)</code> you must check attributes type - it can be <code>Array</code> like the example, it can be <code>Hash</code> of this type:</p>\n\n<pre><code>{ 1 =&gt; { ... } , 2 =&gt; { ... } }\n</code></pre>\n\n<p>Just like a hash representing array, where the key is index and value is the value for this index.</p>\n\n<p>The answear looks like this:</p>\n\n<p><code>_form.html.haml</code></p>\n\n<pre><code>....\n= crawler_form.fields_for :entry_pages do |entry_page_field|\n  %li\n    =entry_page_field.text_field :url, size: 80\n...\n</code></pre>\n\n<p><code>company_crawler.rb</code></p>\n\n<pre><code>class CompanyCrawler &lt; ActiveRecord::Base\n  ....\n  serialize :entry_pages, Array\n\n  def entry_pages_attributes=(attributes)\n    self.entry_pages = attributes_collection(attributes).map do |attribute|\n      EntryPage.new(attribute[:url])\n    end\n  end\n\n  def entry_pages=(entry_pages)\n    entry_pages = entry_pages.map do |entry_page|\n      cast_entry_page_to_entry_page_object(entry_page)\n    end\n\n    write_attribute(:entry_pages, entry_pages)\n  end\n\n  ...\n\n  private\n\n  def attributes_collection(attributes)\n    case attributes\n    when Array\n      attributes\n    when Hash\n      attributes.values\n    end\n  end\n\n  def cast_entry_page_to_entry_page_object(entry_page)\n    case entry_page\n    when String\n      EntryPage.new(entry_page)\n    when EntryPage\n      entry_page\n    end\n  end\nend\n</code></pre>\n\n<p>For clarity I have removed <code>entry_page_objects</code> and use only <code>entry_pages</code>.</p>\n"}], "owner": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 27925724, "answer_count": 1, "score": 1, "last_activity_date": 1421163241, "creation_date": 1420647175, "question_id": 27823665, "link": "https://stackoverflow.com/questions/27823665/rails-3-serialized-model-field-form-for-and-field-for-not-generating-correct-nam", "title": "Rails 3 serialized model field form_for and field_for not generating correct name", "body": "<p>I have this model:</p>\n\n<pre><code>class CompanyCrawler &lt; ActiveRecord::Base\n  .... \n  serialize :entry_pages, Array\n\n  def entry_page_objects\n    entry_pages.map { |url| EntryPage.new(url) }\n  end\n\n  def entry_page_objects_attributes=(attributes)\n    # ...\n  end\n  ....\nend\n</code></pre>\n\n<p>This form to render the model:</p>\n\n<pre><code>.....\n%p\n  %p\n    = crawler_form.label 'Entry pages'\n  = crawler_form.text_area :entry_pages_text, size: '80x6'\n  %ul.entry-pages\n    = crawler_form.fields_for :entry_page_objects do |entry_page_field|\n      %li=entry_page_field.text_field :url, size: 80\n    %a{href: '#', class: 'add-button'} Add Entry Page\n</code></pre>\n\n<p>The problem I have is that the form renders the <code>entry_page_object</code> input names incorrectly(e.g. <code>company_crawler[entry_page_objects_attributes][0][url]</code> instead of <code>company_crawler[entry_page_objects][0][url]</code>). I am really not sure what to do, I have read the documentation and the example says that just by defining <code>attr_attributes=(attributes)</code> and <code>persisted?</code> I will be able to use <code>fields_for</code> for collections just if they were associations defined with <code>accept_nested_fields</code>.</p>\n\n<p>I have seen different solutions like just giving <code>String</code> <code>'entry_page_objects[]'</code> to <code>fields_for</code> but I want to be consistent with rails naming convention and I know I can use <code>form_tag</code> instead of <code>form_for</code> but I want to make <code>fields_for</code> work as expected.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "arrays", "integer", "range"], "answers": [{"tags": [], "owner": {"reputation": 2691, "user_id": 3324630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6gEL.jpg?s=128&g=1", "display_name": "Grych", "link": "https://stackoverflow.com/users/3324630/grych"}, "is_accepted": false, "score": 1, "last_activity_date": 1420646905, "creation_date": 1420646905, "answer_id": 27823585, "question_id": 27823375, "link": "https://stackoverflow.com/questions/27823375/how-to-create-an-array-with-ranges-using-an-array-with-integer-in-rubyrails/27823585#27823585", "title": "how to create an array with ranges using an array with integer in ruby(rails)?", "body": "<p>You can iterate on all elements of the array and save the previous value in the external variable, like this:</p>\n\n<pre><code>last = -1 \narray.collect {|x| prev = last; last = x; (prev+1..x)}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 2, "last_activity_date": 1420647033, "creation_date": 1420647033, "answer_id": 27823618, "question_id": 27823375, "link": "https://stackoverflow.com/questions/27823375/how-to-create-an-array-with-ranges-using-an-array-with-integer-in-rubyrails/27823618#27823618", "title": "how to create an array with ranges using an array with integer in ruby(rails)?", "body": "<p>Add a helper value of -1, later on remove it.</p>\n\n<pre><code>array = [1,4,10,14,22]\narray.unshift(-1)\nranges = array.each_cons(2).map{|a,b| a+1..b} #=&gt;[0..1, 2..4, 5..10, 11..14, 15..22]\n\narray.shift\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21521, "user_id": 78613, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0fa1dc97175c4cc1ea4ecf506119961c?s=128&d=identicon&r=PG", "display_name": "Nick Veys", "link": "https://stackoverflow.com/users/78613/nick-veys"}, "is_accepted": false, "score": 0, "last_activity_date": 1420665984, "last_edit_date": 1420665984, "creation_date": 1420647041, "answer_id": 27823621, "question_id": 27823375, "link": "https://stackoverflow.com/questions/27823375/how-to-create-an-array-with-ranges-using-an-array-with-integer-in-rubyrails/27823621#27823621", "title": "how to create an array with ranges using an array with integer in ruby(rails)?", "body": "<p>Just keeping track of the previous value takes care of it:</p>\n\n<pre><code>2.1.5 :001 &gt; array = [1,4,10,14,22]\n =&gt; [1, 4, 10, 14, 22] \n2.1.5 :002 &gt; previous = 0\n =&gt; 0 \n2.1.5 :003 &gt; array.map { |i| rng = previous..i; previous = i + 1; rng }\n =&gt; [0..1, 2..4, 5..10, 11..14, 15..22] \n</code></pre>\n\n<p>I imagine there's a slicker way to do it though.</p>\n\n<p>edit: Of course there is, building on @steenslag's answer:</p>\n\n<pre><code>2.1.5 :001 &gt; array = [1, 4, 10, 14, 22]\n =&gt; [1, 4, 10, 14, 22] \n2.1.5 :002 &gt; ([-1] + array).each_cons(2).map { |a,b| (a + 1)..b }\n =&gt; [0..1, 2..4, 5..10, 11..14, 15..22] \n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4067927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0b43a3981d21d45a93a11cc007a9ed07?s=128&d=identicon&r=PG&f=1", "display_name": "anndrew78", "link": "https://stackoverflow.com/users/4067927/anndrew78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 27823618, "answer_count": 3, "score": 0, "last_activity_date": 1420665984, "creation_date": 1420646290, "question_id": 27823375, "link": "https://stackoverflow.com/questions/27823375/how-to-create-an-array-with-ranges-using-an-array-with-integer-in-rubyrails", "title": "how to create an array with ranges using an array with integer in ruby(rails)?", "body": "<p>i have an array with sorted integers</p>\n\n<pre><code>array = [1,4,10,14,22]\n</code></pre>\n\n<p>i would like to create from array before an</p>\n\n<pre><code>array_with_ranges = [[0..1],[2..4],[5..10],[11..14],[15..22]]\n</code></pre>\n\n<p>i cant create a right iterator, i'm newbie in rails. In every ranges i have end_range value, but don't know how to set a start_range value? in most ranges in array_with_ranges the start_range is a end_range before +1 (except [0..1])</p>\n\n<p>any solutions or ideas?</p>\n\n<p>thank you for answers.</p>\n\n<p>p.s.: happy new 2015 year</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1420647100, "post_id": 27823346, "comment_id": 44053089, "body": "not sure I 100% understand the question but have you looked at <code>ransack</code> it has some really nice form builders for advanced searches <a href=\"http://railscasts.com/episodes/370-ransack\" rel=\"nofollow noreferrer\">Railscast #370</a>"}, {"owner": {"reputation": 45, "user_id": 4252379, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-3Do4t8zlL0M/AAAAAAAAAAI/AAAAAAAAAB0/pTXWMhmh5XQ/photo.jpg?sz=128", "display_name": "ingzane", "link": "https://stackoverflow.com/users/4252379/ingzane"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1420648802, "post_id": 27823346, "comment_id": 44054207, "body": "Tks Engin...I&#39;ll take a look. Just need search by genre, location and user using dropdown box. I have the id&#39;s in table Items and also search using 3 text box instead one (codigo, den_cont and marca).."}], "owner": {"reputation": 45, "user_id": 4252379, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-3Do4t8zlL0M/AAAAAAAAAAI/AAAAAAAAAB0/pTXWMhmh5XQ/photo.jpg?sz=128", "display_name": "ingzane", "link": "https://stackoverflow.com/users/4252379/ingzane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420646217, "creation_date": 1420646217, "question_id": 27823346, "link": "https://stackoverflow.com/questions/27823346/search-in-ruby-by-many-fields", "title": "Search in ruby by many fields", "body": "<p>I need to search form multiple fields in my app, using textfield and combo-box. I have Items that belongs to genre, location, user and affectation. This is what I did.  </p>\n\n<p>Item.rb  </p>\n\n<pre><code>def self.search(query)  \nwhere(\"cod ilike :q or den_cont ilike :q or marca ilike :q\", q: \"%#{query}%\")\nend  \n</code></pre>\n\n<p>Item.controller  </p>\n\n<pre><code>@items = Item.joins(\"LEFT JOIN calibrations on items.id = calibrations.item_id\")\n.select(\" items.id, items.codigo, items.numero, items.den_cont, items.marca,     items.modelo, items.nro_serie, items.genre_id, items.state_id, items.affectation_id,    items.sector_id, items.person_id, MAX(calibrations.date_expired) as date_expired,   items.observaciones\")\n.group(\"items.id\")\n.order(\"items.codigo, items.numero\").search(params[:search])\nelse\n...\nend  \n</code></pre>\n\n<p>Index.html  </p>\n\n<pre><code>&lt;%= form_tag(items_path, :method =&gt; \"get\", id: \"search-form\") do %&gt;\n&lt;%= text_field_tag :search, params[:search], placeholder: \"Buscar Items\" %&gt;\n&lt;%= submit_tag \"Buscar\", :name =&gt; nil %&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>As you can see I can search for codigo, den_cont and marca in the same texfield. I need seach for multiples fields, but in deferents text-box and in the case of genre, state..i need a combo-box to select the value and then search. Can you gave me some example or help on this. What about using a gem for this. (searchkick fot example). Tks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "httparty"], "comments": [{"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420646593, "post_id": 27823326, "comment_id": 44052749, "body": "You&#39;re posting to where your app is rooted to, not the post action in your controller.  What is in your routes?"}, {"owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "reply_to_user": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1420646752, "post_id": 27823326, "comment_id": 44052842, "body": "@japed, I did, thanks for the reminder, I&#39;ll add my routes to the question now."}, {"owner": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "edited": false, "score": 0, "creation_date": 1420646830, "post_id": 27823326, "comment_id": 44052904, "body": "where are you posting? does it require you send JSON?"}, {"owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "reply_to_user": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "edited": false, "score": 0, "creation_date": 1420647134, "post_id": 27823326, "comment_id": 44053120, "body": "@neo, no, it doesn&#39;t require me to send JSON. By the way, if it could be helpful - there is a <code>before_filter</code> in pizzas controller, which invokes a method that talks to websockets and creates a record in database."}, {"owner": {"reputation": 758, "user_id": 2109033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8444780b739d772b782d7fa2c954755?s=128&d=identicon&r=PG", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/2109033/alfonso"}, "edited": false, "score": 0, "creation_date": 1420694860, "post_id": 27823326, "comment_id": 44072500, "body": "can you show the function you call on the before_filter?"}, {"owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "reply_to_user": {"reputation": 758, "user_id": 2109033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8444780b739d772b782d7fa2c954755?s=128&d=identicon&r=PG", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/2109033/alfonso"}, "edited": false, "score": 0, "creation_date": 1420872665, "post_id": 27823326, "comment_id": 44149384, "body": "@Alfonso, thank you for trying to help! figures the problem was in authenticity tokens."}], "answers": [{"tags": [], "owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "is_accepted": false, "score": 0, "last_activity_date": 1420872604, "creation_date": 1420872604, "answer_id": 27873643, "question_id": 27823326, "link": "https://stackoverflow.com/questions/27823326/cant-get-200-status-code-from-post-request-to-rails-route/27873643#27873643", "title": "Can&#39;t get 200 status code from post request to Rails route", "body": "<p>It figures I had to get rid of <code>protect_from_forgery</code> line in my <em>application_controller.rb</em>. \nThe <strong>GET</strong> request was passing through because it doesn't require authenticity token (the one that you see in form created by rails helpers).</p>\n"}], "owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420872604, "creation_date": 1420646139, "last_edit_date": 1420646837, "question_id": 27823326, "link": "https://stackoverflow.com/questions/27823326/cant-get-200-status-code-from-post-request-to-rails-route", "title": "Can&#39;t get 200 status code from post request to Rails route", "body": "<p>I have this in my Pizzas controller:</p>\n\n<pre><code>def post\n  render :nothing =&gt; true, status: 200 \nend\n\ndef get\n  render :nothing =&gt; true, status: 200 \nend\n</code></pre>\n\n<p>My routes:</p>\n\n<pre><code> get '/' =&gt; 'pizzas#get'\n post '/' =&gt; 'pizzas#post'\n</code></pre>\n\n<p>And this is how I post to that route:</p>\n\n<pre><code>require 'httparty'\nresponse = HTTParty.post('https://example.com', {})\np response.code #returns 422 (Unprocessable Entity)\n</code></pre>\n\n<p>What is the reason for this? With <strong>GET</strong> request to that route I reliably get <code>200</code>. How to get code <code>200</code>? </p>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 820, "user_id": 2239171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTOJ0.jpg?s=128&g=1", "display_name": "dddd1919", "link": "https://stackoverflow.com/users/2239171/dddd1919"}, "edited": false, "score": 0, "creation_date": 1420708510, "post_id": 27822791, "comment_id": 44077454, "body": "Add <code>bundle exec</code> before each command"}, {"owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "reply_to_user": {"reputation": 820, "user_id": 2239171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTOJ0.jpg?s=128&g=1", "display_name": "dddd1919", "link": "https://stackoverflow.com/users/2239171/dddd1919"}, "edited": false, "score": 0, "creation_date": 1420722648, "post_id": 27822791, "comment_id": 44085396, "body": "can you give me an example ?"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420647267, "post_id": 27822975, "comment_id": 44053206, "body": "can i use : ruby &#39;1.9.3-p484&#39; ? without = sign ? does ruby 2.1.0 will affect usage of older versions of sass or compass ?"}, {"owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420647630, "post_id": 27822975, "comment_id": 44053443, "body": "after modifying : still error : compass watch /var/www/drupal6/sites/all/themes/d6_pf_susy/ LoadError on line [&quot;55&quot;] of /home/webmaster/.rvm/rubies/ruby-1.9.3-p484/lib/ruby/site_ru&zwnj;&#8203;by/1.9.1/rubygems/co&zwnj;&#8203;re_ext/kernel_requir&zwnj;&#8203;e.rb: cannot load such file -- susy"}, {"owner": {"reputation": 16538, "user_id": 2602869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PkMYa.jpg?s=128&g=1", "display_name": "Jikku Jose", "link": "https://stackoverflow.com/users/2602869/jikku-jose"}, "reply_to_user": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420682944, "post_id": 27822975, "comment_id": 44069630, "body": "Can you try to reinstall sass? <code>gem uninstall sass</code> and <code>gem install sass</code>?"}, {"owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420704758, "post_id": 27822975, "comment_id": 44075789, "body": "the issue come from susy : if i do <code>gem list</code> , susy is not in the list, but if i do <code>bundle install</code> , susy is in the list..o_O"}, {"owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420705710, "post_id": 27822975, "comment_id": 44076137, "body": "ok seem to fix it with install of susy gem then reinstall the bundle..no error message on <code>compass watch</code>..hope it will be for long time"}, {"owner": {"reputation": 16538, "user_id": 2602869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PkMYa.jpg?s=128&g=1", "display_name": "Jikku Jose", "link": "https://stackoverflow.com/users/2602869/jikku-jose"}, "reply_to_user": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "edited": false, "score": 0, "creation_date": 1420708282, "post_id": 27822975, "comment_id": 44077338, "body": "Okay, have updated the answer; please mark answer if it fixed your issue."}], "tags": [], "owner": {"reputation": 16538, "user_id": 2602869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PkMYa.jpg?s=128&g=1", "display_name": "Jikku Jose", "link": "https://stackoverflow.com/users/2602869/jikku-jose"}, "is_accepted": true, "score": 1, "last_activity_date": 1420708240, "last_edit_date": 1420708240, "creation_date": 1420645026, "answer_id": 27822975, "question_id": 27822791, "link": "https://stackoverflow.com/questions/27822791/using-a-specific-ruby-version-rvm-and-bundler/27822975#27822975", "title": "Using a specific ruby version : RVM and bundler", "body": "<p>Specify Ruby version as follows in Gemfile:</p>\n\n<pre><code>ruby '1.9.3'\n</code></pre>\n\n<p>Also try:</p>\n\n<pre><code>gem uninstall sass\ngem install sass\n</code></pre>\n\n<p><strong>Note</strong>: You should ideally be using a version of Ruby greater than 2.1.0 by now.</p>\n"}], "owner": {"reputation": 319, "user_id": 2416915, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OrdxO.jpg?s=128&g=1", "display_name": "webmaster pf", "link": "https://stackoverflow.com/users/2416915/webmaster-pf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 27822975, "answer_count": 1, "score": 1, "last_activity_date": 1420708240, "creation_date": 1420644553, "question_id": 27822791, "link": "https://stackoverflow.com/questions/27822791/using-a-specific-ruby-version-rvm-and-bundler", "title": "Using a specific ruby version : RVM and bundler", "body": "<p>i'm a newbie on using RVM and bundler so i face off an issue after install my bundle.\nI created a gemfile like this:</p>\n\n<pre><code>source 'https://rubygems.org'\n\n#ruby-gemset=starter-d6-susy\n\n#ruby=ruby-1.9.3-p484 \n\ngem \"compass\", \"0.12.2\"\ngem \"sass\", \"3.2.12\"\ngem \"susy\", \"1.0.9\"\ngem \"modular-scale\", \"1.0.6\"\ngem \"compass-recipes\", \"0.3.0\"\ngem \"zocial\", \"0.0.3\"\n</code></pre>\n\n<p>and the bundle install do:</p>\n\n<pre><code>Resolving dependencies...\nInstalling chunky_png 1.3.3\nInstalling fssm 0.2.10\nInstalling sass 3.2.12\nInstalling compass 0.12.2\nInstalling compass-normalize 1.5\nInstalling compass-recipes 0.3.0\nInstalling sassy-math 1.5.1\nInstalling modular-scale 1.0.6\nInstalling susy 1.0.9\nInstalling zocial 0.0.3\nUsing bundler 1.7.11\nYour bundle is complete!\n</code></pre>\n\n<p>then when i want to compile my scss to css with compass, i get :</p>\n\n<pre><code>compass watch /var/www/drupal6/sites/all/themes/d6_pf_susy/\nLoadError on line [\"36\"] of /usr/lib/ruby/1.9.1/rubygems/custom_require.rb: cannot load such file -- susy\n</code></pre>\n\n<p>this is because the system doesn't use 1.9.3 but 1.9.1 as i understand..but i've set the right ruby version:</p>\n\n<pre><code> rvm use\nUsing /home/webmaster/.rvm/gems/ruby-1.9.3-p484\n</code></pre>\n\n<p>what can i do to fix this ? why do i get an error if i put 1.9.3 without dash ?</p>\n\n<pre><code>Gemfile syntax error on line 9: no .&lt;digit&gt; floating literal anymore; put 0 before dot\nruby=ruby-1.9.3-p484\n              ^\non line 9: syntax error, unexpected tINTEGER\nruby=ruby-1.9.3-p484\n               ^\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["java", "ruby-on-rails", "ruby", "bash", "scripting"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 4028211, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ejAS.jpg?s=128&g=1", "display_name": "Martin McKeaveney", "link": "https://stackoverflow.com/users/4028211/martin-mckeaveney"}, "edited": false, "score": 0, "creation_date": 1420650347, "post_id": 27824128, "comment_id": 44055129, "body": "Thats it! I was completely unaware of this in ruby. This has fixed a few other problems I was having too. Will keep an eye out for that in my code from now on. Thanks so much."}], "tags": [], "owner": {"reputation": 68627, "user_id": 258523, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/102329bab02333104708ac179f35fd8d?s=128&d=identicon&r=PG&f=1", "display_name": "Etan Reisner", "link": "https://stackoverflow.com/users/258523/etan-reisner"}, "is_accepted": true, "score": 1, "last_activity_date": 1420648607, "creation_date": 1420648607, "answer_id": 27824128, "question_id": 27822657, "link": "https://stackoverflow.com/questions/27822657/filepaths-issue-in-ruby-script-using-ssh-net/27824128#27824128", "title": "Filepaths issue in ruby script using ssh-net", "body": "<p>It would appear that <code>war_file_name</code> has a newline at the end of it.</p>\n\n<p>That would cause the shell to see</p>\n\n<pre><code>sudo mv /tmp/#{war_file_name} /srv/#{$service_dir}/war/\n</code></pre>\n\n<p>as</p>\n\n<pre><code>sudo mv /tmp/#{war_file_name}\n/srv/#{$service_dir}/war/\n</code></pre>\n\n<p>which would give both the <code>mv</code> missing destination error and the \"is a directory\" error from the shell trying to execute a directory as a command.</p>\n\n<p>(In general you don't want to use the output from <code>ls</code> for any scripting work as it is unreliable and unsafe in many cases. In this case the output from <code>echo</code> would work just as well for example, though would still have many/all of the safety problems with \"odd\" filenames. Working around those issues would require some more scripting but is doable.)</p>\n"}], "owner": {"reputation": 458, "user_id": 4028211, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0ejAS.jpg?s=128&g=1", "display_name": "Martin McKeaveney", "link": "https://stackoverflow.com/users/4028211/martin-mckeaveney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 27824128, "answer_count": 1, "score": 1, "last_activity_date": 1420648607, "creation_date": 1420644172, "last_edit_date": 1420644564, "question_id": 27822657, "link": "https://stackoverflow.com/questions/27822657/filepaths-issue-in-ruby-script-using-ssh-net", "title": "Filepaths issue in ruby script using ssh-net", "body": "<p>I am currently writing a ruby script to allow me to upload .war files into a VPC. To update a java service in our cloud I simply build with maven locally and replace the .war file in the VPC with the file I have created via the build. My problem lies in my file paths in my script. It seems that when even trying to run simple bash commands such as 'mv', or 'rm' I am presented with the following error -</p>\n\n<pre><code>mv: missing destination file operand after `/tmp/asset-manager-service-1.0.2-SNAPSHOT.war'\nTry `mv --help' for more information.\nbash: line 1: /srv/asset-manager-service/war/: Is a directory\n</code></pre>\n\n<p>I thought that maybe this may be a problem with the fact I have a variable just before the second <code>mv</code> directory? The same error applies when I try to use 'rm' as well. I am new to ruby, so this may not be pretty, but here is some of the code in question.</p>\n\n<pre><code>#handles the old war file and pushes up the new one.\n  def handle_war(value)\n    war_file_name = File.basename(\"#$warfile\")\n    local_war_path = File.absolute_path(\"#$warfile\")\n    puts File.exist?(local_war_path)\n    remote_war_path = \"/tmp/#{war_file_name}\"\n\n    puts \"IP is \" + value\n    puts \"CONNECTING to ubuntu@#{value}..\"\n    Net::SSH.start(\"#{value}\", \"ubuntu\") do |ssh|\n      puts 'Connected.'\n      puts \"SENDING #{local_war_path} to VPC /tmp folder - #{remote_war_path}\"\n      ssh.sftp.upload!('asset-manager-service-1.0.2-SNAPSHOT.war',\n                       remote_war_path)\n\n      print \"SENT - New .war created at /tmp/#{war_file_name}\"\n\n      old_war_file = ssh.exec!(\"ls /srv/#{$service_dir}/war/*war\")\n      old_war_file_name = File.basename(old_war_file)\n      puts 'What do you want to do with this old war file? - (delete/backup)'\n      puts old_war_file\n      input = gets.chomp\n      if input=='delete'\n        puts ssh.exec!(\"sudo rm #{old_war_file}\")\n        puts 'If no errors thrown - old .war file deleted successfully.'\n      elsif input == 'backup'\n        puts ssh.exec!(\"sudo mv #{old_war_file} srv/#$service_dir/war_backup/#{old_war_file_name}\")\n        puts 'If no errors thrown - old .war file backed up successfully at'\n        puts \"srv/#$service_dir/war_backup/#{old_war_file_name}\"\n      else\n        puts 'no valid option chosen. Leaving .war file as is. You will have to delete or backup the .war manually.'\n      end\n\n      puts \"MOVING the new war file from tmp into #{$service_dir}/war directory\"\n      puts ssh.exec!(\"sudo mv /tmp/#{war_file_name} /srv/#{$service_dir}/war/\")\n      puts 'done!'\n    end\n  end\n</code></pre>\n\n<p>The main issue here I think is that there seems to be some funny business when I use variables as part of the filepaths.. I am unsure as to why this should make any difference though.I understand this question may be a bit hard to grasp out of context but I am really banging my head here. Long story short - </p>\n\n<ol>\n<li>Do filepaths change when using File.basename?</li>\n<li>Is there a difference from using a variable in a filepath as opposed to a hard coded string?</li>\n<li>Are there any glaring mistakes in my code that could be the problem?</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "cancancan"], "comments": [{"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1420644289, "post_id": 27822438, "comment_id": 44051107, "body": "did you try <code>authorize_resource class: false</code> in the controller"}], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 2893728, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/8CJgl.png?s=128&g=1", "display_name": "mgluesenkamp", "link": "https://stackoverflow.com/users/2893728/mgluesenkamp"}, "edited": false, "score": 0, "creation_date": 1420705287, "post_id": 27822742, "comment_id": 44075978, "body": "I get also the error <code>undefined method &#39;authorize_resource&#39; for HomeController:Class</code>. That&#39;s my problem: no method of Cancancan works in the dummy app of the engine. Any other suggestions?"}], "tags": [], "owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "is_accepted": false, "score": 0, "last_activity_date": 1420644446, "creation_date": 1420644446, "answer_id": 27822742, "question_id": 27822438, "link": "https://stackoverflow.com/questions/27822438/cancancan-in-a-engine/27822742#27822742", "title": "Cancancan in a engine", "body": "<p>you have <code>load_and_authorize_resource</code> in your <code>WelcomeController</code>, it's trying to load the <code>Welcome</code> model which doesn't exist. Instead, trying using <code>authorize_resource class: false</code>, so</p>\n\n<pre><code> class WelcomeController &lt; ApplicationController\n   authorize_resource class: false\n   # rest of your code\n end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 485, "user_id": 2893728, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/8CJgl.png?s=128&g=1", "display_name": "mgluesenkamp", "link": "https://stackoverflow.com/users/2893728/mgluesenkamp"}, "is_accepted": true, "score": 1, "last_activity_date": 1424176621, "creation_date": 1424176621, "answer_id": 28561673, "question_id": 27822438, "link": "https://stackoverflow.com/questions/27822438/cancancan-in-a-engine/28561673#28561673", "title": "Cancancan in a engine", "body": "<p>I could solve my problem by updating Cancancan from 1.9.2 to actual 1.10.1 and compare my engine with the one from this post: <a href=\"https://github.com/CanCanCommunity/cancancan/issues/151#issuecomment-69487040\" rel=\"nofollow\">https://github.com/CanCanCommunity/cancancan/issues/151#issuecomment-69487040</a></p>\n"}], "owner": {"reputation": 485, "user_id": 2893728, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/8CJgl.png?s=128&g=1", "display_name": "mgluesenkamp", "link": "https://stackoverflow.com/users/2893728/mgluesenkamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 28561673, "answer_count": 2, "score": 1, "last_activity_date": 1424176621, "creation_date": 1420643566, "question_id": 27822438, "link": "https://stackoverflow.com/questions/27822438/cancancan-in-a-engine", "title": "Cancancan in a engine", "body": "<p>I want to use the rails gem cancancan in an engine (<a href=\"https://github.com/CanCanCommunity/cancancan\" rel=\"nofollow\">https://github.com/CanCanCommunity/cancancan</a>). So I added it to my gemspec file like this:</p>\n\n<pre><code>s.add_dependency \"cancancan\"\n</code></pre>\n\n<p>In the engines dummy app and in a test app I load my engine and I'm getting always errors about undefined methods for every cancancan method.</p>\n\n<pre><code>undefined local variable or method `load_and_authorize_resource'\nundefined local variable or method `can?'\n[...]\n</code></pre>\n\n<p>This is my <code>ability.rb</code> file in the main app:</p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new # guest user (not logged in)\n    can :manage, :all\n  end\nend\n</code></pre>\n\n<p>I tried several solutions for using cancancan in engines but I found no solution for my engine. Here are some examples:</p>\n\n<ul>\n<li><a href=\"http://mx.kelsin.net/2011/08/10/using-cancan-in-a-engine-and-your-app/\" rel=\"nofollow\">http://mx.kelsin.net/2011/08/10/using-cancan-in-a-engine-and-your-app/</a></li>\n<li><a href=\"https://github.com/CanCanCommunity/cancancan/wiki/Authorization-for-Namespaced-Controllers\" rel=\"nofollow\">https://github.com/CanCanCommunity/cancancan/wiki/Authorization-for-Namespaced-Controllers</a></li>\n<li><a href=\"https://github.com/CanCanCommunity/cancancan/wiki/Admin-Namespace\" rel=\"nofollow\">https://github.com/CanCanCommunity/cancancan/wiki/Admin-Namespace</a></li>\n</ul>\n\n<p>Where is my fault? Is one of the posted links really the solution or are they wrong/outdated? Is there a good tutorial to use cancancan in an engine? Thanks!</p>\n"}, {"tags": ["ruby", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 3052, "user_id": 1172095, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qGEeR.jpg?s=128&g=1", "display_name": "astreal", "link": "https://stackoverflow.com/users/1172095/astreal"}, "is_accepted": false, "score": 2, "last_activity_date": 1420643213, "creation_date": 1420643213, "answer_id": 27822331, "question_id": 27822312, "link": "https://stackoverflow.com/questions/27822312/how-can-i-fill-an-array-from-1-to-x-in-ruby/27822331#27822331", "title": "How can I fill an array from 1 to x in ruby?", "body": "<p>The easiest way would be:</p>\n\n<pre><code>ans = (1..3).to_a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "is_accepted": true, "score": 3, "last_activity_date": 1420643214, "creation_date": 1420643214, "answer_id": 27822333, "question_id": 27822312, "link": "https://stackoverflow.com/questions/27822312/how-can-i-fill-an-array-from-1-to-x-in-ruby/27822333#27822333", "title": "How can I fill an array from 1 to x in ruby?", "body": "<p>How about this:</p>\n\n<pre><code>ans = (1..3).to_a\n</code></pre>\n\n<p>This uses what Ruby calls a <a href=\"http://ruby-doc.org/core-2.2.0/Range.html\" rel=\"nofollow\"><code>Range</code></a>.</p>\n\n<p>Depending on what you want to do with <code>ans</code>, you may want to use the range directly without converting it to an array.</p>\n"}, {"tags": [], "owner": {"reputation": 2691, "user_id": 3324630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P6gEL.jpg?s=128&g=1", "display_name": "Grych", "link": "https://stackoverflow.com/users/3324630/grych"}, "is_accepted": false, "score": 2, "last_activity_date": 1420643262, "creation_date": 1420643262, "answer_id": 27822346, "question_id": 27822312, "link": "https://stackoverflow.com/questions/27822312/how-can-i-fill-an-array-from-1-to-x-in-ruby/27822346#27822346", "title": "How can I fill an array from 1 to x in ruby?", "body": "<p>Use range and convert it into an array:</p>\n\n<pre><code>(1..3).to_a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1420647712, "creation_date": 1420647712, "answer_id": 27823854, "question_id": 27822312, "link": "https://stackoverflow.com/questions/27822312/how-can-i-fill-an-array-from-1-to-x-in-ruby/27823854#27823854", "title": "How can I fill an array from 1 to x in ruby?", "body": "<p>Unsplat a range, like this:</p>\n\n<pre><code>ans = *1..3\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 4417588, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/739bd1940d581269f962bec6c00fb60e?s=128&d=identicon&r=PG&f=1", "display_name": "FourScore", "link": "https://stackoverflow.com/users/4417588/fourscore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 27822333, "answer_count": 4, "score": 0, "last_activity_date": 1420647712, "creation_date": 1420643144, "question_id": 27822312, "link": "https://stackoverflow.com/questions/27822312/how-can-i-fill-an-array-from-1-to-x-in-ruby", "title": "How can I fill an array from 1 to x in ruby?", "body": "<p>I currently have this code:</p>\n\n<pre><code>ans = Array.new(3)\n      ans.length.times do |x|\n        ans[x] = x + 1\n      end\n</code></pre>\n\n<p>Is there any faster way to do this?</p>\n"}, {"tags": ["ruby", "csv", "merge", "fastercsv"], "comments": [{"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1420643540, "post_id": 27822129, "comment_id": 44050593, "body": "What have you tried so far? As it stands, this is just requesting that someone do the dirty work for you."}, {"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1420643651, "post_id": 27822129, "comment_id": 44050667, "body": "Is the first file always clean or does it contain potentially stale rows, too? If so, what happens if both files have <code>time</code> in the fourth column for a specific ID?"}, {"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1420644449, "post_id": 27822129, "comment_id": 44051222, "body": "@Anthony I think with &quot;Some are duplicated in each file&quot; he means that an entry can be present in both files."}, {"owner": {"reputation": 145, "user_id": 3900783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd09ec8338e30a466b623cf1a2400e2e?s=128&d=identicon&r=PG", "display_name": "daveaseeman", "link": "https://stackoverflow.com/users/3900783/daveaseeman"}, "reply_to_user": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1421681135, "post_id": 27822129, "comment_id": 44441075, "body": "@PatrickOscity I am just an absolute beginner so I was looking for an example to learn by."}, {"owner": {"reputation": 145, "user_id": 3900783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd09ec8338e30a466b623cf1a2400e2e?s=128&d=identicon&r=PG", "display_name": "daveaseeman", "link": "https://stackoverflow.com/users/3900783/daveaseeman"}, "reply_to_user": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1421681175, "post_id": 27822129, "comment_id": 44441099, "body": "I really appreciate both your answer and the answer @Anthony gave. You were right that I meant an entry could be present in both files."}], "answers": [{"tags": [], "owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "is_accepted": false, "score": 0, "last_activity_date": 1420644375, "creation_date": 1420644375, "answer_id": 27822719, "question_id": 27822129, "link": "https://stackoverflow.com/questions/27822129/how-do-i-merge-two-csvs-with-nearly-identical-sets-using-rules-for-which-data-i/27822719#27822719", "title": "How do I merge two CSV&#39;s with nearly identical sets using rules for which data is kept? (Using Ruby &amp; FasterCSV)", "body": "<p>I won't give you the complete code but here's a general approach to such a problem:</p>\n\n<pre><code>require 'csv'\n\n# list of csv files to read\nfiles = ['a.csv', 'b.csv']\n\n# used to resolve conflicts when we have a existing entry with same id\n# here, we prefer the new entry if its fourth column starts with `'date'`\n# this also means that the last file in the list above wins if both entries are valid.\ndef resolve_conflict(existing_entry, new_entry)\n  if new_entry[3].start_with? 'date'\n    new_entry\n  else\n    existing_entry\n  end\nend\n\n# keep a hash of entries, with the unique id as key.\n# we use this id to detect duplicate entries later on.\nentries = {}\n\nCSV.foreach(file) do |new_entry|\n  # get id (first column) from row\n  id = new_entry[0]\n\n  # see if we have a conflicting entry\n  existing_entry = entries[id]\n  if existing_entry.nil?\n    # no conflict, just save the row\n    entries[id] = new_entry\n  else\n    # resolve conflict and save that\n    entries[id] = resolve_conflict(existing_entry, new_entry)\n  end\nend\n\n# now all conflicts are resolved\n# note that stale rows from the first file could now be in the result\n# you might want to filter them out as well\n# we can now build a new csv file with the result\nCSV.open(\"result.csv\", \"w\") do |csv|\n  entries.values.each do |row|\n    csv &lt;&lt; row\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 0, "last_activity_date": 1420646477, "creation_date": 1420646477, "answer_id": 27823437, "question_id": 27822129, "link": "https://stackoverflow.com/questions/27822129/how-do-i-merge-two-csvs-with-nearly-identical-sets-using-rules-for-which-data-i/27823437#27823437", "title": "How do I merge two CSV&#39;s with nearly identical sets using rules for which data is kept? (Using Ruby &amp; FasterCSV)", "body": "<p>I'm not super happy with my solution but it works:</p>\n\n<pre><code>require 'csv'\n\ndef readcsv(filename)\n  csv = {}\n  CSV.foreach(filename) do |line|\n    csv[line[0]] = { name: line[1], address: line[2], date: line[3] }\n  end\n  csv\nend\n\ncsv1 = readcsv('orders1.csv')\ncsv2 = readcsv('orders2.csv')\n\nresults = {}\ncsv1.each do |id, val|\n  unless csv2[id]\n    results[id] = val # checks to see if it only exists in 1 file\n    next\n  end\n\n  #see if name exists\n  if (val[:name] =~ /name/) &amp;&amp; (csv2[id]) &amp;&amp; (csv2[id][:name] =~ /name/).nil?\n    csv1.delete(id)\n  end\n\n  #missing some if statement regarding date vs. time\nend\n\nresults = results.merge(csv2) # merge together whatever is remaining\n\nCSV.open('newfile.csv', 'w') do |csv|\n  results.each do |key, val|\n    row = []\n    csv &lt;&lt; (row.push(key, val.values)).flatten\n  end\nend\n</code></pre>\n\n<p>Output of <code>newfile.csv</code> :</p>\n\n<pre><code>D601-DS-1991, name2, address2, date2\nD600-DS-1991, name1, address1, time1\nD601-DS-1992, dave1, address2, date2\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3900783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd09ec8338e30a466b623cf1a2400e2e?s=128&d=identicon&r=PG", "display_name": "daveaseeman", "link": "https://stackoverflow.com/users/3900783/daveaseeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 27823437, "answer_count": 2, "score": 0, "last_activity_date": 1420650307, "creation_date": 1420642537, "last_edit_date": 1420650307, "question_id": 27822129, "link": "https://stackoverflow.com/questions/27822129/how-do-i-merge-two-csvs-with-nearly-identical-sets-using-rules-for-which-data-i", "title": "How do I merge two CSV&#39;s with nearly identical sets using rules for which data is kept? (Using Ruby &amp; FasterCSV)", "body": "<p>I have two csv files, each with 13 columns.</p>\n\n<p>The first column of each row contains a unique string. Some are duplicated in each file, some only exist in one file.</p>\n\n<p>If the row exists in only one file I want to keep it in the new file.</p>\n\n<p>If it exists in both I want to keep the one that has a certain value (or lacks a certain value) in a certain column of that same row.</p>\n\n<p>For example:</p>\n\n<p>file 1:</p>\n\n<pre><code>D600-DS-1991, name1, address1, date1\nD601-DS-1991, name2, address2, date2\nD601-DS-1992, name3, address3, date3\n</code></pre>\n\n<p>file 2:</p>\n\n<pre><code>D600-DS-1991, name1, address1, time1\nD601-DS-1992, dave1, address2, date2\n</code></pre>\n\n<p>I would keep the first row of the first file because the fourth column contains <code>date</code> instead of <code>time</code>.\nI would keep the second row of the first file since its first column, first row value is unique.\nI would keep the second row of the second file as the third row of the new file because it contains text other than \"name#\" in the second column.</p>\n\n<p>Should I first map all of the unique values to one another so that each file contains the same number of entries - even if some are blank or just have filler data?</p>\n\n<p>I only know a little ruby and python... but I much prefer to solve this with a single Ruby file if at all possible since I will be able to understand the code better. If you can't do it in Ruby then please feel free to answer differently!</p>\n"}, {"tags": ["ruby", "twilio"], "comments": [{"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 0, "creation_date": 1420651102, "post_id": 27822007, "comment_id": 44055596, "body": "I don&#39;t think you can.  If you just sent 1 you could though - <a href=\"https://www.twilio.com/docs/quickstart/ruby/sms/tracking-conversations\" rel=\"nofollow noreferrer\">twilio.com/docs/quickstart/ruby/sms/tracking-conversations</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4429180"}, "reply_to_user": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 0, "creation_date": 1420706624, "post_id": 27822007, "comment_id": 44076497, "body": "If I want to send more than 1 messages?"}, {"owner": {"reputation": 18773, "user_id": 91830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2505b282d57c29be797dc35b245adb4c?s=128&d=identicon&r=PG", "display_name": "Philip Hallstrom", "link": "https://stackoverflow.com/users/91830/philip-hallstrom"}, "edited": false, "score": 0, "creation_date": 1420737698, "post_id": 27822007, "comment_id": 44095744, "body": "I don&#39;t think it&#39;s possible."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4429180"}, "edited": false, "score": 0, "creation_date": 1420706532, "post_id": 27826078, "comment_id": 44076465, "body": "If I want to send from just only one phone number?"}], "tags": [], "owner": {"reputation": 11724, "user_id": 233337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dqjJ9.jpg?s=128&g=1", "display_name": "Serg Chernata", "link": "https://stackoverflow.com/users/233337/serg-chernata"}, "is_accepted": false, "score": 1, "last_activity_date": 1420655059, "creation_date": 1420655059, "answer_id": 27826078, "question_id": 27822007, "link": "https://stackoverflow.com/questions/27822007/tracking-twilio-messages-response-that-response-belongs-to-which-message/27826078#27826078", "title": "Tracking Twilio messages response that response belongs to which message", "body": "<p>Send the message from different phone numbers?</p>\n"}, {"tags": [], "owner": {"reputation": 168, "user_id": 2531029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MJgVz.jpg?s=128&g=1", "display_name": "srob", "link": "https://stackoverflow.com/users/2531029/srob"}, "is_accepted": true, "score": 1, "last_activity_date": 1420713570, "creation_date": 1420713570, "answer_id": 27838124, "question_id": 27822007, "link": "https://stackoverflow.com/questions/27822007/tracking-twilio-messages-response-that-response-belongs-to-which-message/27838124#27838124", "title": "Tracking Twilio messages response that response belongs to which message", "body": "<p>If you are sending multiple messages to one recipient then there must be some unique identifier for you to work off.</p>\n\n<ol>\n<li>Use a different CLID</li>\n<li>Don't send a message until a reply has been received</li>\n<li>Ask user to quote a reference in the reply</li>\n<li>Match words to expected response text per message</li>\n<li>Set a timeout on sent SMS to receive a reply</li>\n</ol>\n\n<p>Sorry it's not a definitive answer but I think you will struggle to get one for this issue.</p>\n"}, {"tags": [], "owner": {"reputation": 622, "user_id": 670401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16cbb4d910211e50d5f2b86b365b0f7e?s=128&d=identicon&r=PG", "display_name": "beanserver", "link": "https://stackoverflow.com/users/670401/beanserver"}, "is_accepted": false, "score": 0, "last_activity_date": 1420784531, "creation_date": 1420784531, "answer_id": 27854930, "question_id": 27822007, "link": "https://stackoverflow.com/questions/27822007/tracking-twilio-messages-response-that-response-belongs-to-which-message/27854930#27854930", "title": "Tracking Twilio messages response that response belongs to which message", "body": "<p>SMS messages are stateless, so replies back to the same Twilio number for two different messages aren't easily distinguishable.  If possible, use one of the excellent solutions SimonR91 has offered.  If you must use the same Twilio number, a simple way to keep track of conversations between phone numbers is by using HTTP cookies.  The cookies can store a simple value representing the 'step' or 'state' of the message.  Or use it as a key to session or a larger data structure to track a more complex object.  </p>\n\n<p>See the <a href=\"https://www.twilio.com/blog/2014/07/the-definitive-guide-to-sms-conversation-tracking.html\" rel=\"nofollow\">Guide to SMS Conversation Tracking</a> or <a href=\"https://twilio.radicalskills.com/projects/sms-respond/2.html\" rel=\"nofollow\">Twilio Skills Training</a> for more information.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4429180"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 27838124, "answer_count": 3, "score": 1, "last_activity_date": 1420784531, "creation_date": 1420642103, "last_edit_date": 1420646542, "question_id": 27822007, "link": "https://stackoverflow.com/questions/27822007/tracking-twilio-messages-response-that-response-belongs-to-which-message", "title": "Tracking Twilio messages response that response belongs to which message", "body": "<p>I'm using <a href=\"https://www.twilio.com\" rel=\"nofollow\">https://www.twilio.com</a> to send messages.</p>\n\n<p>A user can also reply to a message. The problem is how can I track which message the user is replying to? </p>\n\n<p>For example, I've sent 2 messages to a user then the user response is on twilio phone number. How can I track that this response belong to which message?</p>\n"}, {"tags": ["ruby", "image-processing", "imagemagick", "paperclip"], "answers": [{"tags": [], "owner": {"reputation": 694, "user_id": 4247633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b489ee8b00fb53a9c49bef05f7b71120?s=128&d=identicon&r=PG", "display_name": "Deepak Kabbur", "link": "https://stackoverflow.com/users/4247633/deepak-kabbur"}, "is_accepted": true, "score": 1, "last_activity_date": 1420643077, "creation_date": 1420643077, "answer_id": 27822283, "question_id": 27821932, "link": "https://stackoverflow.com/questions/27821932/ruby-how-to-crop-and-resize-image-from-center/27822283#27822283", "title": "Ruby: how to crop and resize image from center", "body": "<p>You can use,</p>\n\n<pre><code>Magick::ImageList.crop!(CenterGravity,256,256)\n</code></pre>\n\n<p><a href=\"http://www.imagemagick.org/RMagick/doc/image1.html#crop\" rel=\"nofollow\">More options</a></p>\n"}], "owner": {"reputation": 14249, "user_id": 225814, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/UvqyR.png?s=128&g=1", "display_name": "Aly", "link": "https://stackoverflow.com/users/225814/aly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 27822283, "answer_count": 1, "score": 0, "last_activity_date": 1420643077, "creation_date": 1420641835, "question_id": 27821932, "link": "https://stackoverflow.com/questions/27821932/ruby-how-to-crop-and-resize-image-from-center", "title": "Ruby: how to crop and resize image from center", "body": "<p>I am trying to resize an image and crop it from the center. i.e. if the resolution is 1024x512 and I want to resize by 256x256 I would resize the smallest side to 256 and maintain aspect ratio, i.e. resize the image to 512x256 and then I want to crop the 256x256 square from the centre.</p>\n\n<p>I have seen solutions with paperclip but only for Rails, but I'm not sure how to do this in just a regular script.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 41, "user_id": 4189851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHW61.gif?s=128&g=1", "display_name": "Lusekero", "link": "https://stackoverflow.com/users/4189851/lusekero"}, "edited": false, "score": 0, "creation_date": 1420704299, "post_id": 27821774, "comment_id": 44075651, "body": "Thanks for the edit Charles. Much appreciated!"}], "answers": [{"comments": [{"owner": {"reputation": 2091, "user_id": 44317, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b0da7efcad501e9c63e132f580f74491?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/44317/john"}, "edited": false, "score": 1, "creation_date": 1435786315, "post_id": 28998188, "comment_id": 50351858, "body": "It never occurred to me that the answer would be this simple. Thanks!"}], "tags": [], "owner": {"reputation": 1044, "user_id": 770473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f161da08a74b5db7cf4d1b631ef2dd?s=128&d=identicon&r=PG", "display_name": "hanmari", "link": "https://stackoverflow.com/users/770473/hanmari"}, "is_accepted": false, "score": 11, "last_activity_date": 1426111067, "creation_date": 1426111067, "answer_id": 28998188, "question_id": 27821774, "link": "https://stackoverflow.com/questions/27821774/update-alternatives-error-alternative-path-usr-bin-gem1-8-doesnt-exist/28998188#28998188", "title": "update-alternatives: error: alternative path /usr/bin/gem1.8 doesn&#39;t exist", "body": "<p>I ran into a similar error message while putting ruby on rails on AWS:</p>\n\n<pre><code>Setting up rubygems (1.8.25-1bbox3~trusty1) ...\nupdate-alternatives: error: alternative path /usr/bin/gem1.8 doesn't exist\ndpkg: error processing package rubygems (--configure):\nsubprocess installed post-installation script returned error exit status 2\nErrors were encountered while processing:\nrubygems\nE: Sub-process /usr/bin/dpkg returned an error code (1)\n</code></pre>\n\n<p>The solution was to manually install the library for the missing alternative path. in ubuntu:</p>\n\n<pre><code>sudo apt-get install rubygems1.8\n</code></pre>\n\n<p>This allowed my install script to find the requested files.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4162051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/571f9046f8b031971207a103aa03ba29?s=128&d=identicon&r=PG&f=1", "display_name": "robg", "link": "https://stackoverflow.com/users/4162051/robg"}, "is_accepted": false, "score": 5, "last_activity_date": 1438425060, "creation_date": 1438425060, "answer_id": 31760852, "question_id": 27821774, "link": "https://stackoverflow.com/questions/27821774/update-alternatives-error-alternative-path-usr-bin-gem1-8-doesnt-exist/31760852#31760852", "title": "update-alternatives: error: alternative path /usr/bin/gem1.8 doesn&#39;t exist", "body": "<p>This worked for me:</p>\n\n<pre><code>sudo apt-get install rubygems1.8\nupdate-alternatives --set ruby /usr/bin/ruby1.8\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4189851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oHW61.gif?s=128&g=1", "display_name": "Lusekero", "link": "https://stackoverflow.com/users/4189851/lusekero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3356, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1438425060, "creation_date": 1420641337, "last_edit_date": 1420643200, "question_id": 27821774, "link": "https://stackoverflow.com/questions/27821774/update-alternatives-error-alternative-path-usr-bin-gem1-8-doesnt-exist", "title": "update-alternatives: error: alternative path /usr/bin/gem1.8 doesn&#39;t exist", "body": "<p>I am trying to install ruby1.8 on Ubuntu 14.04 so that I can be able to run a work application. When i run this command: </p>\n\n<pre><code>sudo apt-get install build-essential ruby1.8-dev ruby-dev mysql-client mysql-server git-core libmysql-ruby libmysqlclient-dev unzip rubygems\n</code></pre>\n\n<p>I get these errors below:</p>\n\n<blockquote>\n  <p>Building dependency tree    <br>    Reading state information...\n  Done<br> build-essential is already the newest version.<br> git-core\n  is already the newest version.<br> ruby-dev is already the newest\n  version.<br> unzip is already the newest version.<br>\n  libmysqlclient-dev is already the newest version.<br> mysql-client is\n  already the newest version.<br> mysql-server is already the newest\n  version.<br> ruby1.8-dev is already the newest version.<br> rubygems\n  is already the newest version.<br> libmysql-ruby1.8 is already the\n  newest version.<br> 0 upgraded, 0 newly installed, 0 to remove and 161\n  not upgraded.<br> 1 not fully installed or removed.<br> After this\n  operation, 0 B of additional disk space will be used.<br> Do you want\n  to continue? [Y/n] y<br> Setting up rubygems (1.8.25-1bbox3~trusty1)\n  ...<br> update-alternatives: error: alternative path /usr/bin/gem1.8\n  doesn't exist<br> dpkg: error processing package rubygems\n  (--configure):<br>  subprocess installed post-installation script\n  returned error exit status 2<br> Errors were encountered while\n  processing:<br>  rubygems<br> E: Sub-process /usr/bin/dpkg returned an\n  error code (1)<br> lusekero_mwathengere@lusekero:~$ <br></p>\n</blockquote>\n\n<p>Please help....I know ruby1.8 is an old version but this is what we are using at work so I need to succeed in this installation.</p>\n\n<p>Thanks, in advance, for any help rendered. </p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 3052, "user_id": 1172095, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qGEeR.jpg?s=128&g=1", "display_name": "astreal", "link": "https://stackoverflow.com/users/1172095/astreal"}, "is_accepted": false, "score": 2, "last_activity_date": 1420640630, "creation_date": 1420640630, "answer_id": 27821560, "question_id": 27821489, "link": "https://stackoverflow.com/questions/27821489/ruby-koans-how-does-the-solution-to-about-hashes-rb-test-default-value-make-s/27821560#27821560", "title": "Ruby koans: How does the solution to about_hashes.rb &#39;test_default_value&#39; make sense?", "body": "<p>The value given to the <code>new</code> method is the default value for missing keys.</p>\n\n<p>As per the <a href=\"http://www.ruby-doc.org/core-2.1.5/Hash.html#method-c-new\" rel=\"nofollow\">docs</a></p>\n\n<blockquote>\n  <p>If this hash is subsequently accessed by a key that doesn\u2019t correspond\n  to a hash entry, the value returned depends on the style of new used\n  to create the hash. In the first form, the access returns nil. If obj\n  is specified, this single object will be used for all default values.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1777, "user_id": 1845227, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/19dd297b862b6894fe4329f537aad6b0?s=128&d=identicon&r=PG", "display_name": "moosefetcher", "link": "https://stackoverflow.com/users/1845227/moosefetcher"}, "edited": false, "score": 0, "creation_date": 1420640793, "post_id": 27821570, "comment_id": 44048819, "body": "Oh, god. I see. WHY did they seem to imply that Ruby KNEW &#39;dos&#39; is two?? They should have used :banana as the key!"}, {"owner": {"reputation": 1777, "user_id": 1845227, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/19dd297b862b6894fe4329f537aad6b0?s=128&d=identicon&r=PG", "display_name": "moosefetcher", "link": "https://stackoverflow.com/users/1845227/moosefetcher"}, "edited": false, "score": 0, "creation_date": 1420641183, "post_id": 27821570, "comment_id": 44049077, "body": "Thanks for the detailed reply. I completed skipped that it was setting a default value and got pulled into thinking it knew :two should be &quot;dos&quot;. Made me think it was more &#39;Ruby magic&#39;."}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1420640982, "last_edit_date": 1420640982, "creation_date": 1420640675, "answer_id": 27821570, "question_id": 27821489, "link": "https://stackoverflow.com/questions/27821489/ruby-koans-how-does-the-solution-to-about-hashes-rb-test-default-value-make-s/27821570#27821570", "title": "Ruby koans: How does the solution to about_hashes.rb &#39;test_default_value&#39; make sense?", "body": "<p><code>hash2</code> is initialized with a default value <code>\"dos\"</code>.</p>\n\n<pre><code>hash2 = Hash.new(\"dos\") \n</code></pre>\n\n<p>Thus, every time you access a key which has not been explicitly assigned a value, you will get <code>\"dos\"</code> back. Note that every hash has a default value. By default, it is just <code>nil</code>.</p>\n\n<p>The default values are not \"assigned\". When accessing a hash value, Ruby tries to find a value which has explicitly set in the hash first. Only if none was found, it returns the default value.</p>\n\n<p>As a final remark: there is another form to set the default value when creating a hash:</p>\n\n<pre><code>my_hash = Hash.new { |hash, key| hash[key] = \"dos\" }\n</code></pre>\n\n<p>Generally, this form is preferred as here, the default value is a new object each time you access a non-existant key. This is important if you want to change the default value in-place (which you would often do in the case of e.g. an Array or another Hash).</p>\n\n<p>For simple stuff, this might not be important though. Just to keep in mind for later :)</p>\n"}], "owner": {"reputation": 1777, "user_id": 1845227, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/19dd297b862b6894fe4329f537aad6b0?s=128&d=identicon&r=PG", "display_name": "moosefetcher", "link": "https://stackoverflow.com/users/1845227/moosefetcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 27821570, "answer_count": 2, "score": 2, "last_activity_date": 1422032890, "creation_date": 1420640388, "last_edit_date": 1422032890, "question_id": 27821489, "link": "https://stackoverflow.com/questions/27821489/ruby-koans-how-does-the-solution-to-about-hashes-rb-test-default-value-make-s", "title": "Ruby koans: How does the solution to about_hashes.rb &#39;test_default_value&#39; make sense?", "body": "<p>For Ruby koan 40, the command line is telling me the underscore section in this code...</p>\n\n<pre><code>def test_default_value\n    hash1 = Hash.new\n    hash1[:one] = 1\n\n    assert_equal 1, hash1[:one]\n    assert_equal nil, hash1[:two]\n\n    hash2 = Hash.new(\"dos\")\n    hash2[:one] = 1\n\n    assert_equal 1, hash2[:one]\n    assert_equal __, hash2[:two] # &lt;&lt;&lt;&lt; here's the underscore section\nend\n</code></pre>\n\n<p>...should be \"dos\". HOW has Ruby assigned \"dos\" to the :two key, when no key was specified when hash2 was initialized? I'll be very surprised if this makes sense.  </p>\n\n<p>But if you can make it make sense to me, that would be great!</p>\n"}, {"tags": ["ruby", "syntax"], "comments": [{"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 2, "creation_date": 1420641960, "post_id": 27821422, "comment_id": 44049575, "body": "Why do you need to use <code>**opts</code>? <code>*args</code> should work with keyword arguments as well."}, {"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 4, "creation_date": 1420643119, "post_id": 27821422, "comment_id": 44050327, "body": "The longer I think about it, the more I think this might actually be a bug in Ruby. If <code>foo(*[])</code> works, <code>baz(**{})</code> should work, too."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1420650455, "post_id": 27821422, "comment_id": 44055205, "body": "@PatrickOscity Good point with using args. Somehow forgot that. I learned the double splat syntax today and probably became a little single-minded with regards to using it. Simply using <code>*args</code> works for every case I just tried, including mixtures of optional, optional keyword, and required keyword parameters. So I don&#39;t actually need this to work now. But I still agree with your second comment, I think this is unintuitive and it might be unintentional. I&#39;ll look around for it on the bug tracker and file a report."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 0, "creation_date": 1420650612, "post_id": 27821422, "comment_id": 44055304, "body": "Scratch that, <a href=\"https://bugs.ruby-lang.org/issues/10708\" rel=\"nofollow noreferrer\">Damien Robert beat me to it</a>."}, {"owner": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 1, "creation_date": 1420650698, "post_id": 27821422, "comment_id": 44055351, "body": "I think your intuition is wrong here. What would you expect <code>opts</code> hash should expand to ? Array splat operator <code>*</code> can 1:1 convert <code>Array</code> elements into <i>plain arguments list</i>, not possible and unambiguous for a <code>Hash</code>. Hash for its &quot;expansion&quot; needs a container object. Try <code>{key: 123, **opts}</code> and <code>[:key, 123, **opts]</code> to see what I mean."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 1, "creation_date": 1420651015, "post_id": 27821422, "comment_id": 44055553, "body": "@DavidUnric I see what you mean, but with the introduction of keyword arguments I would argue that my intuition is at least as reasonable as yours: <code>*[]</code> expands into zero positional arguments, so <code>**{}</code> should expand into zero named arguments. It arguably depends on your point of view, but in the context of a method call there are reasons to have it behave the way I expected it to work."}, {"owner": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 0, "creation_date": 1420654288, "post_id": 27821422, "comment_id": 44057432, "body": "@Kolja I do understand your logic behind, still doubt that&#39;s a bug not an intention, partially due to compatibility with legacy code handling keyword-like arguments by a Hash parameter. Eager to see devs opinions to the above filled bugreport."}, {"owner": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 0, "creation_date": 1420748752, "post_id": 27821422, "comment_id": 44101642, "body": "@Kolja I&#39;ve put some comment to bug report #10708 and you are welcome to discuss the issue there if interested."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 6881, "user_id": 477047, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qh2bO.gif?s=128&g=1", "display_name": "David Unric", "link": "https://stackoverflow.com/users/477047/david-unric"}, "edited": false, "score": 0, "creation_date": 1420751657, "post_id": 27821422, "comment_id": 44103176, "body": "@DavidUnric Thanks, I just posted my opinions. Since the behavior I expected really is not necessary with what the single splat does, this comes down to a matter of taste/parser implementation. Still, I look forward to what this results in. :-)"}, {"owner": {"reputation": 1584, "user_id": 601976, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/de088f705937dd429b9470ab9b9bbd8b?s=128&d=identicon&r=PG", "display_name": "RoUS", "link": "https://stackoverflow.com/users/601976/rous"}, "edited": false, "score": 0, "creation_date": 1421282720, "post_id": 27821422, "comment_id": 44305170, "body": "The usual expansion container for a hash is an array of arrays.  Try <code>{&#39;z&#39;=&gt;26,&#39;a&#39;=&gt;1}.sort</code> to see what I mean."}, {"owner": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422095803, "post_id": 27821422, "comment_id": 44622539, "body": "The definition of <code>baz</code> is impossible as you have given it. The empty call means you have default argument so this means that calling with just <code>{}</code> is not going to break, please be more accurate of your baz definition."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422189761, "post_id": 27821422, "comment_id": 44644786, "body": "@hakcho I&#39;m not sure what you mean. Calling <code>base</code> with <code>**opts</code> will raise an ArgumentError."}, {"owner": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422195943, "post_id": 27821422, "comment_id": 44646637, "body": "<code>def quux(**opts)   if opts.empty?     baz()   else     baz(**opts)   end end</code> I don get the <code>baz</code> method that will work for this case but not for empty Hash."}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422196051, "post_id": 27821422, "comment_id": 44646670, "body": "@hakcho Yes, as written above that code, <code>quux</code> works, but is verbose."}, {"owner": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422203879, "post_id": 27821422, "comment_id": 44648949, "body": "@Kolija <code>baz</code> does not accept any arguments how can this code work?"}, {"owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "reply_to_user": {"reputation": 1291, "user_id": 2813071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4314026cf587ea9b3947ed1b0437857d?s=128&d=identicon&r=PG", "display_name": "hahcho", "link": "https://stackoverflow.com/users/2813071/hahcho"}, "edited": false, "score": 0, "creation_date": 1422204598, "post_id": 27821422, "comment_id": 44649185, "body": "@hakcho Oh, now I see what you mean. Sorry for being a little slow. You are right, but that&#39;s just in this example. In my real code <code>bar</code> is not known when I write <code>quux</code> (see the remark about the constructor wrapper at the end of my question). Hopefully I made the example a little clearer."}, {"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 0, "creation_date": 1457403534, "post_id": 27821422, "comment_id": 59380880, "body": "This is also confusing because I can call baz(**{}) with no problem, but it is somehow different when called from inside qux."}], "answers": [{"tags": [], "owner": {"reputation": 977, "user_id": 4603039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2-hWqltglJY/AAAAAAAAAAI/AAAAAAAAA28/BWGljEnrSMc/photo.jpg?sz=128", "display_name": "Jacob Murphy", "link": "https://stackoverflow.com/users/4603039/jacob-murphy"}, "is_accepted": false, "score": 0, "last_activity_date": 1425575578, "creation_date": 1425575578, "answer_id": 28883711, "question_id": 27821422, "link": "https://stackoverflow.com/questions/27821422/how-can-i-collapse-double-splat-arguments-into-nothing/28883711#28883711", "title": "How can I collapse double splat arguments into nothing?", "body": "<p>Try the below:</p>\n\n<pre><code>def baz()\nend\n\ndef qux(**opts)\n    baz(*opts)\nend\n\nqux\n</code></pre>\n\n<p>To see a bit more about how *hash works try the below:</p>\n\n<pre><code>h = {}\nputs h # {}\nputs *h # nothing output \nputs **h #{}\n</code></pre>\n"}], "owner": {"reputation": 1131, "user_id": 477199, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5745e2b9f56c35ccfcfb178e6d6fce6c?s=128&d=identicon&r=PG", "display_name": "Kolja", "link": "https://stackoverflow.com/users/477199/kolja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1425575578, "creation_date": 1420640184, "last_edit_date": 1422204489, "question_id": 27821422, "link": "https://stackoverflow.com/questions/27821422/how-can-i-collapse-double-splat-arguments-into-nothing", "title": "How can I collapse double splat arguments into nothing?", "body": "<p>Splat-expanding an empty array in a method call effectively reduces the argument to nothing (empty parentheses added for clarity):</p>\n\n<pre><code>def foo()\nend\n\ndef bar(*args)\n  foo(*args)\nend\n\nbar(1) # ArgumentError, as expected\nbar()  # works\n</code></pre>\n\n<p>But the same does not apply to a hash argument:</p>\n\n<pre><code>def baz()\nend\n\ndef qux(**opts)\n  baz(**opts)\nend\n\nqux # ArgumentError, **opts becomes {}\n</code></pre>\n\n<p>I can work around this by explicitly checking for an empty hash:</p>\n\n<pre><code>def quux(callable, **opts)\n  if opts.empty?\n    callable.()\n  else\n    callable.(**opts)\n  end\nend\n\nc = -&gt;{}\nquux(c) # works\n</code></pre>\n\n<p>But is there a better/nicer way to do this, or is a change to this behavior planned? I don't know the signatures of <code>foo</code> and <code>baz</code> when writing <code>bar</code> and <code>qux</code>, since the latter are part of a factory-like constructor wrapper.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "neo4j", "graph-databases", "neo4j.rb"], "answers": [{"tags": [], "owner": {"reputation": 4762, "user_id": 2105069, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2c107e06ab979c6ef456d76b98e8d114?s=128&d=identicon&r=PG", "display_name": "subvertallchris", "link": "https://stackoverflow.com/users/2105069/subvertallchris"}, "is_accepted": true, "score": 4, "last_activity_date": 1420642842, "creation_date": 1420642842, "answer_id": 27822220, "question_id": 27821121, "link": "https://stackoverflow.com/questions/27821121/neo4j-rb-check-relation-already-exists-between-two-nodes/27822220#27822220", "title": "neo4j.rb check relation already exists between two nodes", "body": "<p>You can do <code>brian.following.include?(chris)</code>. Check out <a href=\"https://github.com/neo4jrb/neo4j/wiki/Optimized-Methods\" rel=\"nofollow\">https://github.com/neo4jrb/neo4j/wiki/Optimized-Methods</a>, it details this and many other helpful methods that are either modified versions of those found in Enumerable and unique to QueryProxy. You'll also find examples of these in <a href=\"https://github.com/neo4jrb/neo4j/blob/master/spec/e2e/query_proxy_methods_spec.rb\" rel=\"nofollow\">https://github.com/neo4jrb/neo4j/blob/master/spec/e2e/query_proxy_methods_spec.rb</a>.</p>\n"}], "owner": {"reputation": 3385, "user_id": 1689539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9905d1270ccf6e9834436f7b97d5f613?s=128&d=identicon&r=PG", "display_name": "Raj Adroit", "link": "https://stackoverflow.com/users/1689539/raj-adroit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 27822220, "answer_count": 1, "score": 1, "last_activity_date": 1420642842, "creation_date": 1420639155, "question_id": 27821121, "link": "https://stackoverflow.com/questions/27821121/neo4j-rb-check-relation-already-exists-between-two-nodes", "title": "neo4j.rb check relation already exists between two nodes", "body": "<p>I Need to check relation between two nodes exists already.</p>\n\n<pre><code>brian.following &lt;&lt; chris\nbrian.following\n#=&gt; chris\n</code></pre>\n\n<p>I Need to check like this</p>\n\n<pre><code>brian.following?(chris)\n#=&gt; true\nbrian.following?(john)\n#=&gt; false\n</code></pre>\n\n<ol>\n<li><p>Any method is there in neo4j.rb for this?</p></li>\n<li><p>if not, How can i write my custom method for this in Neo4j.rb-Rails ?</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid", "activemodel", "rails-activejob"], "answers": [{"comments": [{"owner": {"reputation": 2212, "user_id": 852561, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c44582dd5ee166ebd81fbe9d1ce6200e?s=128&d=identicon&r=PG", "display_name": "SteveO7", "link": "https://stackoverflow.com/users/852561/steveo7"}, "edited": false, "score": 8, "creation_date": 1421202584, "post_id": 27821678, "comment_id": 44267255, "body": "In case it will help someone else, you &quot;mixin&quot; by adding <code>include GlobalID::Identification</code> to the top of your model."}], "tags": [], "owner": {"reputation": 3957, "user_id": 187004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94464371b17302eadec74810ec480aaf?s=128&d=identicon&r=PG", "display_name": "Cristian Bica", "link": "https://stackoverflow.com/users/187004/cristian-bica"}, "is_accepted": true, "score": 16, "last_activity_date": 1420640991, "creation_date": 1420640991, "answer_id": 27821678, "question_id": 27820934, "link": "https://stackoverflow.com/questions/27820934/is-mongoiddocument-a-globalididentification-for-activejobs/27821678#27821678", "title": "Is Mongoid::Document a GlobalID::Identification for ActiveJobs?", "body": "<p>There's a mistake in the guides. <code>GlobalID::Identification</code> has been mixed in <code>ActiveRecord</code>. If you mixin <code>GlobalID::Identification</code> into your mongoid documents it will work automatically as GID requires the instance to respond to <code>id</code> (returning the uniq identifier) and the class to respond to <code>find</code> (passing an <code>id</code> will return a record).</p>\n"}, {"comments": [{"owner": {"reputation": 3957, "user_id": 187004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94464371b17302eadec74810ec480aaf?s=128&d=identicon&r=PG", "display_name": "Cristian Bica", "link": "https://stackoverflow.com/users/187004/cristian-bica"}, "edited": false, "score": 0, "creation_date": 1422878393, "post_id": 28263871, "comment_id": 44908854, "body": "Can you reproduce the <code>SerializationError</code> bug?"}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 3957, "user_id": 187004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94464371b17302eadec74810ec480aaf?s=128&d=identicon&r=PG", "display_name": "Cristian Bica", "link": "https://stackoverflow.com/users/187004/cristian-bica"}, "edited": false, "score": 0, "creation_date": 1422880639, "post_id": 28263871, "comment_id": 44910096, "body": "I&#39;ve already tried with a simple application but it didn&#39;t work. I&#39;m having this problem in a complex application but I haven&#39;t found any reason for this bug to happen. In the engine with this code, it works well, but when I use it inside a Rails app, I can see that my models have <code>GlobalID::Identification</code> but some of them fail to serialize correctly"}, {"owner": {"reputation": 376, "user_id": 277448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88451e8964faf5d2bf25768a1184595d?s=128&d=identicon&r=PG", "display_name": "c.apolzon", "link": "https://stackoverflow.com/users/277448/c-apolzon"}, "edited": false, "score": 5, "creation_date": 1425432800, "post_id": 28263871, "comment_id": 45959152, "body": "I fought with this for a while, and what I saw was that an object pulled off a belongs_to association was not reporting as being a <code>GlobalID::Identification</code> object. My fix was to also include <code>GlobalID::Identification</code> into <code>Mongoid::Relations::Proxy</code>. I believe its related to mongoid&#39;s use of marshalable, but I&#39;m not entirely sure."}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 376, "user_id": 277448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88451e8964faf5d2bf25768a1184595d?s=128&d=identicon&r=PG", "display_name": "c.apolzon", "link": "https://stackoverflow.com/users/277448/c-apolzon"}, "edited": false, "score": 0, "creation_date": 1425471531, "post_id": 28263871, "comment_id": 45974715, "body": "Thanks for your comment @c.apolzon, I&#39;ll try that soon and add it to my post if it works."}, {"owner": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1438189946, "post_id": 28263871, "comment_id": 51352202, "body": "This code should be put in an initializer I guess ?"}, {"owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "reply_to_user": {"reputation": 10377, "user_id": 2832282, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZJ4WG.jpg?s=128&g=1", "display_name": "Cyril Duchon-Doris", "link": "https://stackoverflow.com/users/2832282/cyril-duchon-doris"}, "edited": false, "score": 0, "creation_date": 1438325596, "post_id": 28263871, "comment_id": 51413830, "body": "@CyrilDD I actually load it from another (private) gem which handles all ActiveJob stuff. But you can do it in an initializer also !"}], "tags": [], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "is_accepted": false, "score": 8, "last_activity_date": 1435212540, "last_edit_date": 1435212540, "creation_date": 1422801527, "answer_id": 28263871, "question_id": 27820934, "link": "https://stackoverflow.com/questions/27820934/is-mongoiddocument-a-globalididentification-for-activejobs/28263871#28263871", "title": "Is Mongoid::Document a GlobalID::Identification for ActiveJobs?", "body": "<p>To provide more information to anyone having the same problem, you can make it work by simply adding <code>GlobalID::Identification</code> to your models.</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  include GlobalID::Identification\nend\n</code></pre>\n\n<p>I've actually done that by reopenning <code>Mongoid::Document</code>:</p>\n\n<pre><code>module Mongoid::Document\n  include GlobalID::Identification\nend\n</code></pre>\n\n<p>However, I've got some really weird errors sometimes, with <code>ActiveJob</code> which didn't know how to serialize my models. I tried to debug it, but whenever I came into <code>ActiveJob</code> code I had:</p>\n\n<pre><code>pry&gt; User.is_a? GlobalID::Identification\n=&gt; true\n</code></pre>\n\n<p>But <a href=\"https://github.com/rails/rails/blob/master/activejob/lib/active_job/arguments.rb#L51\" rel=\"noreferrer\">ActiveJob::Arguments.serialize_argument</a> didn't work as expected.</p>\n\n<p>The workaround is also to reopen <code>Mongoid::Relations::Proxy</code>:</p>\n\n<pre><code>class Mongoid::Relations::Proxy\n  include GlobalID::Identification\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10582, "user_id": 142098, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f79b38affe72ea02836f908da90b52e8?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/142098/doug"}, "edited": false, "score": 0, "creation_date": 1525279338, "post_id": 36197146, "comment_id": 87297535, "body": "I get <code>uninitialized constant Mongoid::Relations</code> when I try this."}, {"owner": {"reputation": 918, "user_id": 304434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/702ccb82d20ca07398613252526285d2?s=128&d=identicon&r=PG", "display_name": "Adrien Jarthon", "link": "https://stackoverflow.com/users/304434/adrien-jarthon"}, "edited": false, "score": 3, "creation_date": 1530441562, "post_id": 36197146, "comment_id": 89230158, "body": "For <code>mongoid &gt;= 7</code> it&#39;s <code>Mongoid::Association::Proxy</code> instead of <code>Mongoid::Relations::Proxy</code>"}], "tags": [], "owner": {"reputation": 12666, "user_id": 118007, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/52935e3e301e32e15e17c8971b94461f?s=128&d=identicon&r=PG", "display_name": "sandstrom", "link": "https://stackoverflow.com/users/118007/sandstrom"}, "is_accepted": false, "score": 10, "last_activity_date": 1458812736, "creation_date": 1458812736, "answer_id": 36197146, "question_id": 27820934, "link": "https://stackoverflow.com/questions/27820934/is-mongoiddocument-a-globalididentification-for-activejobs/36197146#36197146", "title": "Is Mongoid::Document a GlobalID::Identification for ActiveJobs?", "body": "<p>Put something like this in your initializer:</p>\n\n<pre><code># config/initalizers/mongoid.rb\n\nif defined?(Mongoid)\n  # GlobalID is used by ActiveJob (among other things)\n  # https://github.com/rails/globalid\n\n  Mongoid::Document.send(:include, GlobalID::Identification)\n  Mongoid::Relations::Proxy.send(:include, GlobalID::Identification)\nend\n</code></pre>\n"}], "owner": {"reputation": 11736, "user_id": 610351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f4ee98206d84b25a83228e285c678f0?s=128&d=identicon&r=PG", "display_name": "Geoffroy", "link": "https://stackoverflow.com/users/610351/geoffroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1474, "favorite_count": 2, "accepted_answer_id": 27821678, "answer_count": 3, "score": 10, "last_activity_date": 1458812736, "creation_date": 1420638539, "last_edit_date": 1431588126, "question_id": 27820934, "link": "https://stackoverflow.com/questions/27820934/is-mongoiddocument-a-globalididentification-for-activejobs", "title": "Is Mongoid::Document a GlobalID::Identification for ActiveJobs?", "body": "<p>According to the <a href=\"http://edgeguides.rubyonrails.org/active_job_basics.html\">ActiveJobs guide</a>, section 8, it says:</p>\n\n<blockquote>\n  <p>This works with any class that mixes in GlobalID::Identification,\n  which by default has been mixed into Active Model classes.</p>\n</blockquote>\n\n<p><code>Mongoid::Document</code> mixes <code>ActiveModel::Model</code>, but I can't find <code>GlobalID::Identification</code> in its included_modules.</p>\n\n<ol>\n<li><p>Where is <code>GlobalID::Identification</code> defined?</p></li>\n<li><p>Can I effectively use any <code>Mongoid::Document</code> for my ActiveJobs?</p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv", "import"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1420638901, "post_id": 27820874, "comment_id": 44047629, "body": "are the headers the same values as your database?"}, {"owner": {"reputation": 447, "user_id": 3957433, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3gA5a.jpg?s=128&g=1", "display_name": "doer123456789", "link": "https://stackoverflow.com/users/3957433/doer123456789"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1420638955, "post_id": 27820874, "comment_id": 44047664, "body": "@Anthony yes, they are"}], "answers": [{"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 2, "last_activity_date": 1420809175, "last_edit_date": 1420809175, "creation_date": 1420639289, "answer_id": 27821161, "question_id": 27820874, "link": "https://stackoverflow.com/questions/27820874/rails-csv-import-with-weird-format/27821161#27821161", "title": "Rails CSV import with weird format", "body": "<p>When you create objects, you really just pass in a hash of values like this:</p>\n\n<pre><code>User.create(name: \"Some name\", age: 18)\n</code></pre>\n\n<p>You can use a ruby script like this:</p>\n\n<pre><code>require 'CSV'\nCSV.foreach('users.csv') do |line|\n  user = line.each_with_object({}) do |val, hash|\n    vals = val.split(':')\n    hash[vals.first] = vals.last\n  end\n  User.create(user)\nend\n</code></pre>\n\n<p>I'm just building a hash of values that look like this:</p>\n\n<pre><code>{\"Name\"=&gt;\"Peanut\", \"Age\"=&gt;\"17\", \"State\"=&gt;\"NY\"}\n{\"Name\"=&gt;\"Donkey\", \"Age\"=&gt;\"23\", \"State\"=&gt;\"NY\"}\n{\"Name\"=&gt;\"Flower\", \"Age\"=&gt;\"18\", \"State\"=&gt;\"NY\"}\n</code></pre>\n\n<p>I'm sending those values into the <code>User.create</code> call.  Regarding your missing data, it would only be a problem if you have validations on your model (ie. <code>validates :age, presence: true</code>) otherwise, if you don't give it a value it will just be nil in your database (which would be accurate if you're not being provided the data). </p>\n"}], "owner": {"reputation": 447, "user_id": 3957433, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3gA5a.jpg?s=128&g=1", "display_name": "doer123456789", "link": "https://stackoverflow.com/users/3957433/doer123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 27821161, "answer_count": 1, "score": 2, "last_activity_date": 1420809175, "creation_date": 1420638295, "last_edit_date": 1420638752, "question_id": 27820874, "link": "https://stackoverflow.com/questions/27820874/rails-csv-import-with-weird-format", "title": "Rails CSV import with weird format", "body": "<p>I am new to RoR</p>\n\n<p>I know how to upload a CSV file into my database, but the CSV file which I have is in a weird format, instead of headers in a header column, the header is in front of the data like this:</p>\n\n<pre><code>Name:Peanut,Age:17,State:NY\nName:Donkey,Age:23,State:NY\nName:Flower,Age:18,State:NY\n</code></pre>\n\n<p>Another problem is some rows don't have all the data so isn't in the same order like this:</p>\n\n<pre><code>Name:Peanut,Age:17,State:NY\nName:Donkey,State:NY\nAge:18,State:NY\n</code></pre>\n\n<p>I guess I would use a loop in the model file to first extract the header but don't have an idea on where to start nor how it should look. Please help?</p>\n"}, {"tags": ["ruby", "rspec", "mocking", "factory-bot"], "comments": [{"owner": {"reputation": 117, "user_id": 4219550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-CSN8lVOmuD4/AAAAAAAAAAI/AAAAAAAABcg/sYHME2tuNOc/photo.jpg?sz=128", "display_name": "user4219550", "link": "https://stackoverflow.com/users/4219550/user4219550"}, "edited": false, "score": 0, "creation_date": 1420654720, "post_id": 27820735, "comment_id": 44057622, "body": "answered my own question as this may help someone who had a similar problem to me."}, {"owner": {"reputation": 26839, "user_id": 1008891, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/BbcgE.jpg?s=128&g=1", "display_name": "Peter Alfvin", "link": "https://stackoverflow.com/users/1008891/peter-alfvin"}, "edited": false, "score": 2, "creation_date": 1420679160, "post_id": 27820735, "comment_id": 44068666, "body": "It&#39;s great that you shared your answer to your own question, but it would help all users (both those seeking an answer and those interested in answer the question themselves) if you would post the information as an actual &quot;answer&quot;."}], "owner": {"reputation": 117, "user_id": 4219550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-CSN8lVOmuD4/AAAAAAAAAAI/AAAAAAAABcg/sYHME2tuNOc/photo.jpg?sz=128", "display_name": "user4219550", "link": "https://stackoverflow.com/users/4219550/user4219550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2225, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1420657822, "creation_date": 1420637826, "last_edit_date": 1592644375, "question_id": 27820735, "link": "https://stackoverflow.com/questions/27820735/using-rspec-with-factory-girl-and-get-a-cant-define-singleton-error", "title": "Using RSpec with Factory Girl and get a can&#39;t define singleton error", "body": "<p>I'm using Factory Girl to generate test date in order to mock a connection to an ldap server (because I don't want the application to make a real ldap connection each time in order to successfully run my tests).</p>\n<p>I want to mock this connection and confirm that this occurred successfully.</p>\n<p>My factory girl data is:</p>\n<p><strong>/factories/connections.rb</strong></p>\n<pre><code>FactoryGirl.define do\n  factory :connection do\n    host &quot;just-ln1-wdc03.company.qube&quot;\n    port 389\n    base &quot;DC=company,DC=qube&quot;\n    username &quot;cat@company.qube&quot;\n    password &quot;cats123&quot;\n  end\nend\n</code></pre>\n<p>and my Rspec test is:</p>\n<p><strong>authenticate_spec.rb</strong></p>\n<pre><code>require 'spec_helper'\n\ndescribe &quot;#is_authenticated_by_ldap&quot; do \n  let(:connection) {FactoryGirl.build(:connection)}\n\n  it &quot;queries ldap server and returns success&quot; do\n    allow(:connection).to receive(:is_authenticated_by_ldap).with(&quot;cat@company.qube&quot;, &quot;cats123&quot;).and_return(true)\n  end\nend\n</code></pre>\n<p><strong>spec_helper.rb</strong></p>\n<pre><code>require 'factory_girl'\nrequire_relative './factories/connections.rb'\n\nRSpec.configure do|config|\n...\n</code></pre>\n<p><strong>authenticate.rb</strong></p>\n<pre><code>def is_authenticated_by_ldap(credentials)\n  full_username = credentials[0] + EXTENSION #EXTENSION = &quot;company.com&quot;\n  ldap = Net::LDAP.new  :host =&gt; &quot;just-ln1-wdc03.company.qube&quot;, # your LDAP host name or IP goes here,\n                        :port =&gt; 389, # your LDAP host port goes here,\n                        # :encryption =&gt; :simple_tls,\n                        :base =&gt; &quot;DC=company,DC=qube&quot;, # the base of your AD tree goes here,\n                        :auth =&gt; {\n                          :method =&gt; :simple,\n                          :username =&gt; full_username, # a user w/sufficient privileges to read from AD goes here,\n                          :password =&gt; credentials[1] # the user's password goes here\n                        }   \n        \n  is_authorized = ldap.bind\n  return is_authorized\nend\n</code></pre>\n<p>parameters passed to the <code>is_authenticated_by_ldap</code> method are essentially username and password effectively credentials[0] and credentials[1] respectively.</p>\n<p>When I run this <code>rspec spec/authenticate_spec.rb</code>, I receive the following error:</p>\n<pre><code>Authenticate\n\u2190[32m  authenticates a user on qube server\u2190[0m\n  #is_authenticated_by_ldap\n\u2190[31m    queries ldap server and returns success (FAILED - 1)\u2190[0m\n\nFailures:\n  1) Authenticate#is_authenticated_by_ldap queries ldap server and returns success\n     \u2190[31mFailure/Error: allow(:connection).to receive(:is_authenticated_by_ldap).with(&quot;cats@company.qube&quot;, &quot;cats123&quot;).and_return(true)\u2190[0m\n     \u2190[31mTypeError:\u2190[0m\n     \u2190[31m  can't define singleton\u2190[0m\n</code></pre>\n<h1>UPDATE</h1>\n<p>I believe I have answered my own question and have posted an explanation here as someone else may have this problem and seek a solution like I did:</p>\n<p>RSpec 3.0 has a feature called an instance double which takes a class name or object as it's first argument and then verifies that any methods being stubbed would be present and execute on an instance of that class.</p>\n<p>So in my case because I had an Authenticate module which handled my authentication feature, I created a dummy class in my Rspec test, which also included the said module.(see code below)</p>\n<h1>authenticate_spec.rb</h1>\n<p>require 'spec_helper'</p>\n<pre><code>class Dummy\n    include Authenticate\nend \n\ndescribe Authenticate do\n\n        let(:dummy_class) {Dummy.new.authenticate}\n        let(:credentials) {FactoryGirl.build_stubbed(:credentials)}\n\n            it &quot;authenticates a user on qube server&quot; do \n\n                expect(:dummy_class).to be\n\n            end \n\n\n        describe &quot;#is_authenticated_by_ldap&quot; do \n\n            it &quot;queries ldap server and returns successful connection&quot; do\n\n                dummy = instance_double(&quot;Dummy&quot;)\n                \n                allow(dummy).to receive(:is_authenticated_by_ldap).with(:credentials).and_return(true)\n            \n                expect(dummy.is_authenticated_by_ldap(:credentials)).to be(true)\n\n            end\n\n    end\n\n\nend\n\n#spec/factories/credentials.rb\n\nFactoryGirl.define do\n  factory :credentials do\n    username &quot;cats@company.com&quot;\n    password &quot;cats123&quot;\n  end\nend \n</code></pre>\n<p>and defined test data using factory_girl (username and password) to pass as a parameter of the is_authenticated_by_ldap method.(this method confirms a successful connection to the ldap server or not). Using RSpec 3.0 syntax, if you use stubs/mocks, the allow method with a receive matcher, tells the fake object to return a value in response to a given message/method. In my case, I would expect the test to pass (successful ldap connection) or fail (unsuccessful ldap connection). To confirm that my mock worked correctly and wasn't a false positive, test data defined by factory girl gem(and not existing on the ldap server) was used and the test passed. I also commented out the source code for the method and reran the test and it failed as expected.</p>\n"}, {"tags": ["ruby", "testing", "ruby-on-rails-4", "rspec", "stripe-payments"], "answers": [{"comments": [{"owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "edited": false, "score": 0, "creation_date": 1420651502, "post_id": 27822125, "comment_id": 44055842, "body": "you didn&#39;t understand the question."}, {"owner": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "edited": false, "score": 0, "creation_date": 1420817483, "post_id": 27822125, "comment_id": 44130023, "body": "Then you should try to explain it better, in my humble opinion, because I agree with @Satya on answer."}], "tags": [], "owner": {"reputation": 4336, "user_id": 574181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c78d396646e7612dead8bcd7c63a4fe?s=128&d=identicon&r=PG", "display_name": "Satya", "link": "https://stackoverflow.com/users/574181/satya"}, "is_accepted": false, "score": 1, "last_activity_date": 1420642527, "creation_date": 1420642527, "answer_id": 27822125, "question_id": 27820033, "link": "https://stackoverflow.com/questions/27820033/making-the-body-of-a-function-use-a-mock-of-an-object/27822125#27822125", "title": "Making the body of a function use a mock of an object", "body": "<pre><code>mock(Stripe::Event).retrieve(any) do\n  event\nend\n</code></pre>\n\n<p>That should return <code>event</code> from any call to <code>retrieve</code> on <code>Stripe::Event</code>. Works with <code>rr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1151, "user_id": 2468200, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AKp0O.jpg?s=128&g=1", "display_name": "Ivan Kolmychek", "link": "https://stackoverflow.com/users/2468200/ivan-kolmychek"}, "is_accepted": false, "score": 1, "last_activity_date": 1420817656, "creation_date": 1420817656, "answer_id": 27863998, "question_id": 27820033, "link": "https://stackoverflow.com/questions/27820033/making-the-body-of-a-function-use-a-mock-of-an-object/27863998#27863998", "title": "Making the body of a function use a mock of an object", "body": "<p>If your concern is only about external requests, you can try something like <a href=\"https://rubygems.org/gems/vcr\" rel=\"nofollow\">Vcr</a> or <a href=\"https://github.com/bblimke/webmock\" rel=\"nofollow\">WebMock</a> to mock the responce.</p>\n"}], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1420817656, "creation_date": 1420635407, "question_id": 27820033, "link": "https://stackoverflow.com/questions/27820033/making-the-body-of-a-function-use-a-mock-of-an-object", "title": "Making the body of a function use a mock of an object", "body": "<p>I have the following method in a controller:</p>\n\n<pre><code>def webhook\n    data_json = JSON.parse(request.body.read) # it comes from the test, it's OK\n    event = Stripe::Event.retrieve(data_json[:id]) # it's not OK, it's a real request to Stripe\n    stripe_cust_id = event.data.object.customer\n    user = User.where(stripe_customer_id: stripe_cust_id)\n    #.....\n</code></pre>\n\n<p>In a spec file I create a mock for <code>event</code> and then make a post request to <code>webhook</code> in a test. I'm not allowed to change the body or signature of <code>webhook</code> because I'm testing it. So how do I make it use the mock I create?</p>\n\n<pre><code>describe '#webhook' do\n    it 'something' do\n      user = FactoryGirl.create(:user)\n      event = StripeMock.mock_webhook_event('invoice.payment_succeeded')\n      post(:webhook, event.to_json)\n\n      #error because webhook makes a real request to Stripe\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "strong-parameters"], "comments": [{"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1420637463, "post_id": 27819801, "comment_id": 44046832, "body": "post your <code>params</code> from the <code>log</code>"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 0, "creation_date": 1420691252, "post_id": 27819801, "comment_id": 44071529, "body": "@RajarshiDas i have updated the question with the error message."}], "answers": [{"tags": [], "owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "is_accepted": true, "score": 0, "last_activity_date": 1420699858, "creation_date": 1420699858, "answer_id": 27834494, "question_id": 27819801, "link": "https://stackoverflow.com/questions/27819801/activemodelforbiddenattributes-error/27834494#27834494", "title": "ActiveModel::ForbiddenAttributes error", "body": "<p>It's a problem with cancan gem. I tried the below skip_load_resource. It's working now.</p>\n\n<pre><code> load_and_authorize_resource skip_load_resource only: [:create] \n</code></pre>\n"}], "owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 27834494, "answer_count": 1, "score": 0, "last_activity_date": 1420699858, "creation_date": 1420634601, "last_edit_date": 1420691176, "question_id": 27819801, "link": "https://stackoverflow.com/questions/27819801/activemodelforbiddenattributes-error", "title": "ActiveModel::ForbiddenAttributes error", "body": "<p>I have done the following things. I installed strong_parameters gem.</p>\n\n<p>1)I created a initializer and added the following line ActiveRecord::Base.send(:include, ActiveModel::ForbiddenAttributesProtection)</p>\n\n<p>2)I removed attr_accessible from model.</p>\n\n<p>Then i was tried to create a new record, it's was not going to the create method itself. it was giving ActiveModel::ForbiddenAttributes error. Please explain me what could be the problem?</p>\n\n<p>Please find the code below:</p>\n\n<p><strong>config/initializers/strong_parameters.rb</strong></p>\n\n<pre><code> ActiveRecord::Base.send(:include, ActiveModel::ForbiddenAttributesProtection)\n</code></pre>\n\n<p><strong>app/models/role.rb</strong></p>\n\n<pre><code> class Role &lt; ActiveRecord::Base\n  #attr_accessible :name, :description\n  validates :name, presence: true, uniqueness: { case_sensitive: false}\n end\n</code></pre>\n\n<p><strong>app/controllers/roles_controller.rb</strong></p>\n\n<pre><code> class RolesController &lt; ApplicationController\n\n  def create\n   @role = Role.new(role_params)\n   if @role.save\n     redirect_to roles_path, notice: t('Role was successfully created.', default: 'Role was successfully created.')\n  else\n     render action: \"new\"\n  end\n end\n\n private\n\n def role_params\n  params.require(:role).permit(:name,:description)\n end\n\nend\n</code></pre>\n\n<p><strong>EDIT</strong> : Please find the error message:</p>\n\n<p><img src=\"https://i.stack.imgur.com/my2ql.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["ruby", "file-io"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420634513, "post_id": 27819217, "comment_id": 44045173, "body": "You must look into the lib <a href=\"http://www.ruby-doc.org/stdlib-2.2.0/libdoc/logger/rdoc/Logger.html#class-Logger-label-Example\" rel=\"nofollow noreferrer\">Logger</a> while writing logs. This is a standard way to do this job."}], "answers": [{"comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 1, "creation_date": 1420634448, "post_id": 27819670, "comment_id": 44045122, "body": "Please don&#39;t rely on any other resources to close your file."}, {"owner": {"reputation": 3052, "user_id": 1172095, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qGEeR.jpg?s=128&g=1", "display_name": "astreal", "link": "https://stackoverflow.com/users/1172095/astreal"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420636616, "post_id": 27819670, "comment_id": 44046335, "body": "Of course you&#39;re absolutely right, I didn&#39;t put it here but that was implicit in my mind. Anyway I&#39;ll update the code."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420637188, "post_id": 27819670, "comment_id": 44046639, "body": "Why <code>file.seek(0)</code> at the beginning ?"}, {"owner": {"reputation": 3052, "user_id": 1172095, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qGEeR.jpg?s=128&g=1", "display_name": "astreal", "link": "https://stackoverflow.com/users/1172095/astreal"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420638334, "post_id": 27819670, "comment_id": 44047314, "body": "for the subsequent loop iteration. we could put it at the end of the loop (but that&#39;s less readability IMO). If we remove it altogether then the writing step will append the text at the end of the existing content instead of replacing it."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420642029, "post_id": 27819670, "comment_id": 44049613, "body": "Humm.. I understood. Tried something differ based on your code. :)"}], "tags": [], "owner": {"reputation": 3052, "user_id": 1172095, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/qGEeR.jpg?s=128&g=1", "display_name": "astreal", "link": "https://stackoverflow.com/users/1172095/astreal"}, "is_accepted": true, "score": 3, "last_activity_date": 1420636629, "last_edit_date": 1420636629, "creation_date": 1420634159, "answer_id": 27819670, "question_id": 27819217, "link": "https://stackoverflow.com/questions/27819217/ruby-overwrite-line-in-file/27819670#27819670", "title": "Ruby: overwrite line in file", "body": "<p>No need to open it each time:</p>\n\n<pre><code>file = File.open('out.log', File::RDWR)\n10.times do |i|\n    file.seek(0) # rewind to the beginning of the file (line in your case)\n    file.write(\"iteration #{i}\") # write what you want\n\n    # the following is just in order to show what was written\n    file.seek(0)\n    puts file.readline\nend\nfile.close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 0, "last_activity_date": 1420641992, "creation_date": 1420641992, "answer_id": 27821977, "question_id": 27819217, "link": "https://stackoverflow.com/questions/27819217/ruby-overwrite-line-in-file/27821977#27821977", "title": "Ruby: overwrite line in file", "body": "<p>You can use <a href=\"http://www.ruby-doc.org/core-2.1.5/IO.html#method-c-open\" rel=\"nofollow\"><code>IO::open</code></a> with block to close the file, when block exits automatically.</p>\n\n<pre><code>File.open(\"#{__dir__}/test.txt\", File::RDWR) do |file|\n  10.times do |i|\n    file.rewind\n    file.puts(\"iteration #{i}\")\n  end\nend\n\nputs File.read(\"#{__dir__}/test.txt\")\n# &gt;&gt; iteration 9\n</code></pre>\n"}], "owner": {"reputation": 14249, "user_id": 225814, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/UvqyR.png?s=128&g=1", "display_name": "Aly", "link": "https://stackoverflow.com/users/225814/aly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1812, "favorite_count": 0, "accepted_answer_id": 27819670, "answer_count": 2, "score": 0, "last_activity_date": 1420641992, "creation_date": 1420632513, "question_id": 27819217, "link": "https://stackoverflow.com/questions/27819217/ruby-overwrite-line-in-file", "title": "Ruby: overwrite line in file", "body": "<p>I am trying to log some state to a file using standard file i/o in ruby. The file will just have one line with a number in it. I want to read in the line and then on each iteration of a loop I want to update this number.</p>\n\n<p>I know I can read in the file with </p>\n\n<pre><code>file = File.open('out.log', 'a+')\nnum = file.readline\n</code></pre>\n\n<p>The problem is, I don't know how to then overwrite the first line in a loop without just re-opening the file every iteration i.e.</p>\n\n<pre><code>file = File.open('out.log', 'w')\n</code></pre>\n\n<p>which will create an empty file</p>\n"}, {"tags": ["ruby", "apache2", "sinatra", "passenger"], "owner": {"reputation": 61, "user_id": 3888415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/453b6b7263e04af9998b04db3f10e419?s=128&d=identicon&r=PG&f=1", "display_name": "user3888415", "link": "https://stackoverflow.com/users/3888415/user3888415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420634636, "creation_date": 1420632250, "last_edit_date": 1420634636, "question_id": 27819132, "link": "https://stackoverflow.com/questions/27819132/whats-going-wrong-with-my-passenger-on-apache2-sinatra-application", "title": "What&#39;s going wrong with my Passenger on Apache2 (Sinatra) application?", "body": "<p>I have a LAMP stack deployed and functioning under www.mydomain.com as is, but when trying to deploy a Sinatra application (for a web API service) I'm not having any luck, despite having followed to the word several tutorials - should www.mydomain.com/api/services/test?id=test not be working with Sinatra deployed - just getting 403 errors. 'rackup' seems to suggest that it's listening on port 9292, but that doesn't seem to be showing any different. All of this was working on my local machine, but deploying to production hasn't worked in the slightest. Is the issue caused by the fact that Apache is already configured to listen on port 80 and direct them to my original site?</p>\n\n<p><strong>Document Structure: (/var/www/sinatra)</strong></p>\n\n<pre><code>-app.rb\n-library.rb\n-config.ru\n-public\n-tmp\n--restart.txt\n</code></pre>\n\n<p><strong>app.rb:</strong></p>\n\n<pre><code>require 'sinatra'\nrequire 'json'\nrequire File.join(File.dirname(__FILE__), 'library.rb')\n\nget '/api/services/test' do\n    data = {:id =&gt; params[:id]}.to_json\nend\n</code></pre>\n\n<p><strong>config.ru:</strong></p>\n\n<pre><code>require 'sinatra'\nrequire File.expand_path '../app.rb', __FILE__\n\nrun Sinatra::Application\n</code></pre>\n\n<p><strong>Virtual Host:</strong></p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerName www.mydomain.com\n        DocumentRoot /var/www/sinatra/public\n        &lt;Directory /var/www/sinatra/public&gt;\n                Order allow,deny\n                allow from all\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4428611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2718bc916a72d6de3ea4fd1b9c6b2d?s=128&d=identicon&r=PG", "display_name": "jackturnbull", "link": "https://stackoverflow.com/users/4428611/jackturnbull"}, "edited": false, "score": 0, "creation_date": 1420632124, "post_id": 27819042, "comment_id": 44043831, "body": "Cannot believe it was that simple (or that I missed it). <b>Thank you!</b>"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "reply_to_user": {"reputation": 3, "user_id": 4428611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2718bc916a72d6de3ea4fd1b9c6b2d?s=128&d=identicon&r=PG", "display_name": "jackturnbull", "link": "https://stackoverflow.com/users/4428611/jackturnbull"}, "edited": false, "score": 0, "creation_date": 1420632221, "post_id": 27819042, "comment_id": 44043896, "body": "you should initialize <code>Cleaner::CSVFile.new</code> in <code>expect</code> block, for success catch errors."}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 3, "last_activity_date": 1420631955, "creation_date": 1420631955, "answer_id": 27819042, "question_id": 27818842, "link": "https://stackoverflow.com/questions/27818842/rspec-hits-an-error-in-code-before-it-is-able-to-expect-an-error-to-be-raised/27819042#27819042", "title": "RSpec hits an error in code, before it is able to expect an error to be raised", "body": "<p><a href=\"https://github.com/rspec/rspec-expectations#expecting-errors\" rel=\"nofollow\"><code>For exceptions you should use block or lambda in expect syntax</code></a>:</p>\n\n<pre><code>it 'raises error' do\n   expect{ Cleaner::CSVFile.new('tmp/file-not-exist.csv') }.to raise_error\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1420632364, "post_id": 27819126, "comment_id": 44043996, "body": "yep <code>stubbing</code> more efficient. +1"}], "tags": [], "owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "is_accepted": false, "score": 1, "last_activity_date": 1420634736, "last_edit_date": 1420634736, "creation_date": 1420632237, "answer_id": 27819126, "question_id": 27818842, "link": "https://stackoverflow.com/questions/27818842/rspec-hits-an-error-in-code-before-it-is-able-to-expect-an-error-to-be-raised/27819126#27819126", "title": "RSpec hits an error in code, before it is able to expect an error to be raised", "body": "<p>You could use <a href=\"https://github.com/rspec/rspec-mocks#method-stubs\" rel=\"nofollow\"><em>stubbing</em></a> also :</p>\n\n<pre><code>require 'spec_helper'\n\nRSpec.describe Cleaner::CSVFile do\n  context 'when CSV file does not exist' do\n    it 'raises error' do\n      allow(described_class).to receive(:new).and_raise(\"File not exist\")\n      expect { described_class.new }.to raise_error(\"File not exist\")\n    end\n  end\nend\n</code></pre>\n\n<p>Read <a href=\"https://www.relishapp.com/rspec/rspec-expectations/v/2-8/docs/built-in-matchers/raise-error-matcher#match-message-with-a-string\" rel=\"nofollow\">match message with a string</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 4428611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce2718bc916a72d6de3ea4fd1b9c6b2d?s=128&d=identicon&r=PG", "display_name": "jackturnbull", "link": "https://stackoverflow.com/users/4428611/jackturnbull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 1, "accepted_answer_id": 27819042, "answer_count": 2, "score": 0, "last_activity_date": 1420634736, "creation_date": 1420631301, "question_id": 27818842, "link": "https://stackoverflow.com/questions/27818842/rspec-hits-an-error-in-code-before-it-is-able-to-expect-an-error-to-be-raised", "title": "RSpec hits an error in code, before it is able to expect an error to be raised", "body": "<p>This is something that I've seen before when using RSpec Rails and I believe that I know what is happening, I just don't know how I can get around it.</p>\n\n<p>To me, it appears that the following test should pass. It expects an error, and an error is raised although I assume that the source of the error is what it is tripping up on.</p>\n\n<p>csv_file_spec.rb</p>\n\n<pre><code>require 'spec_helper'\n\nRSpec.describe Cleaner::CSVFile do\n  context 'when CSV file does not exist' do\n    let(:file) { Cleaner::CSVFile.new('tmp/file-does-not-exist.csv') }\n\n    it 'raises error' do\n      expect(file).to raise_error\n    end\n  end\nend\n</code></pre>\n\n<p>csv_file.rb</p>\n\n<pre><code>module Cleaner\n  # A CSVFile is a CSV file loaded into memory. It exposes the clean method.\n  class CSVFile\n    attr_accessor :raw\n\n    def initialize(file)\n      @raw = File.open(file)\n    end\n  end\nend\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>  1) Cleaner::CSVFile is not valid\n     Failure/Error: expect(Cleaner::CSVFile.new('tmp/file-does-not-exist.csv')).to raise_error\n     Errno::ENOENT:\n       No such file or directory @ rb_sysopen - tmp/file-does-not-exist.csv\n     # ./lib/cleaner/csv_file.rb:8:in `initialize'\n     # ./lib/cleaner/csv_file.rb:8:in `open'\n     # ./lib/cleaner/csv_file.rb:8:in `initialize'\n     # ./spec/csv_file_spec.rb:7:in `new'\n     # ./spec/csv_file_spec.rb:7:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I can see that the CSVFile object is not able to be initialized because the file does not exist and that'll be why RSpesc can't continue the test but what can I do to get around this?</p>\n\n<p>I get the feeling that there is something fundamentally wrong with my approach to testing that I'm not seeing. I'd rather delegate the error to the standard File class, and not raise my own error messages as the error is verbose enough and I'd only be duplicating effort - should I be implementing my own instead?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-document-viewer"], "owner": {"reputation": 1615, "user_id": 2524123, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/gVqbX.jpg?s=128&g=1", "display_name": "rick", "link": "https://stackoverflow.com/users/2524123/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 812, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1420632657, "creation_date": 1420629425, "last_edit_date": 1420632657, "question_id": 27818255, "link": "https://stackoverflow.com/questions/27818255/view-pdf-file-using-google-doc-viewer-rails", "title": "View .pdf file using Google Doc Viewer + Rails", "body": "<p>In my application, I want to view my <code>.pdf</code> file using Google Doc Viewer.</p>\n\n<p>I am using <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow\">Paperclip gem</a> to upload file. In below code, </p>\n\n<p><code>asset.uploaded_file.path</code> will give <code>file:///home/rick/rick/Projects/practice/sharebox/assets/137/Screenshot_from_2014-02-26_18_46_52.png</code></p>\n\n<p>In my asset model,</p>\n\n<pre><code>has_attached_file :uploaded_file,\n:url =&gt; \"/assets/get/:id\",\n:path =&gt; \"#{Rails.root}/assets/:id/:basename.:extension\"\n</code></pre>\n\n<p>In my <code>index.html</code> file</p>\n\n<pre><code>@assets.each do |asset|\n  &lt;iframe src=\"https://docs.google.com/viewer?url=http://localhost:3000/&lt;%= asset.uploaded_file.path %&gt;&amp;embedded=true\" width=\"100%\" height=\"800\" &gt;\n    &lt;p&gt;Your browser does not support iframes.&lt;/p&gt;\n  &lt;/iframe&gt;\nend\n</code></pre>\n\n<p>Using this above code i always get this error 'Apologies.\nThere is no preview available.'</p>\n\n<p>If i will copy this <code>file:///home/rick/rick/Projects/practice/sharebox/assets/137/Screenshot_from_2014-02-26_18_46_52.png</code> and paste in new tab in browser, it will show image.</p>\n\n<p>My assets is stored in the folder that is <code>app_name/assets/id_name/filename</code>.</p>\n\n<p>So How i should pass path of my file to view using Google Viewer?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "relational-database"], "answers": [{"tags": [], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "is_accepted": false, "score": 0, "last_activity_date": 1420802645, "creation_date": 1420802645, "answer_id": 27859500, "question_id": 27818139, "link": "https://stackoverflow.com/questions/27818139/database-design-rails-design-of-balance-between-two-users/27859500#27859500", "title": "Database design/Rails - design of balance between two users", "body": "<p>So, I think I found something pretty neat. It uses the fact that user alice is always the one with the smallest id (via :ensure_alice_before_bob). The rest should be clear. </p>\n\n<p>The User model just has two extra \"has_many :balances_as_alice, has_many :balances_as_bob\". It could work with only one (for instance :balances_as_alice), but with those two present + dependent: :destroy you make sure to avoid orphan balances.</p>\n\n<pre><code># == Schema Information\n#\n# Table name: balances\n#\n#  id          :integer          not null, primary key\n#  alice_id    :integer          not null\n#  bob_id      :integer          not null\n#  alice_value :float            default(\"0.0\")\n#  created_at  :datetime         not null\n#  updated_at  :datetime         not null\n#\n\nclass Balance &lt; ActiveRecord::Base\n  belongs_to :alice, class_name: 'User'\n  belongs_to :bob, class_name: 'User'\n  before_validation :ensure_alice_before_bob\n  validates :alice_id, presence: true\n  validates :bob_id, presence: true, uniqueness: { scope: :alice_id}\n  validate  :different_users\n\n  def value\n    @for_bob ? -alice_value : alice_value\n  end\n\n  def value=(new_val)\n    @for_bob? self.alice_value = -new_val : self.alice_value = new_val\n  end\n\n  def Balance.get_for alice, bob\n    user = 'alice'\n    alice, bob, user = bob, alice, 'bob' if alice.id &gt; bob.id\n    balance= alice.balances_as_alice.find_by(bob: bob) || \n      Balance.new(bob: bob, alice: alice, alice_value: 0.0)\n    balance.send(\"for_#{user}\")\n  end\n\n  def for_bob\n    @for_bob = true; self\n  end\n\n  def for_alice\n    @for_bob = false; self\n  end\n\n  private\n  def ensure_alice_before_bob\n    return if self.alice_id.nil? || self.bob_id.nil?\n    unless self.alice_id &lt; self.bob_id\n      self.bob_id, self.alice_id = self.alice_id, self.bob_id\n    end\n  end\n\n  def different_users\n    if self.alice_id == self.bob_id\n      errors.add(:bob_id, \"Cannot be the same user\")\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1057, "user_id": 2716377, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/0JbwB.png?s=128&g=1", "display_name": "Nicolas Mattia", "link": "https://stackoverflow.com/users/2716377/nicolas-mattia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420802645, "creation_date": 1420629059, "question_id": 27818139, "link": "https://stackoverflow.com/questions/27818139/database-design-rails-design-of-balance-between-two-users", "title": "Database design/Rails - design of balance between two users", "body": "<p>I am looking for a way of designing a Balance model between two users in Ruby on Rails (but could be more general). Two users Alice and Bob would start with a balance of value zero with regards to the other one. Now, if Alice gets a +4, I want Bob to have -4. Here's what I came up with so far:</p>\n\n<ul>\n<li><p>A balance with three fields : user_one, user_two, and one_to_two. That is if I want the balance for user_one to user_two I just take one_to_two, and if I want from two_to_one I take -one_to_two (just a method in the balance model). The problem is that I could not simply use 'has_many balances through' from the User model, since the balance would need to know if it's user_one or user_two who is calling (I would have to pass the User)</p></li>\n<li><p>A balance with three fields again, but completely asymmetric: if I create a balance for Alice to Bob, I would have to create another instance of balance from Bob to Alice. This would double the storage needed for each 'balance' in the database, and would require updating the bob_to_alice everytime I update alice_to_bob.</p></li>\n</ul>\n\n<p>Can anyone come up with something better, or explain the reason for choosing one of the above? Let me know if I can make anything clearer.</p>\n"}, {"tags": ["ruby", "implicit-conversion"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420630438, "post_id": 27817679, "comment_id": 44042839, "body": "Remove trailing bar from <code>col_weeklyTotal|</code> in line 42."}, {"owner": {"reputation": 213, "user_id": 4143037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jd7m791o7_M/AAAAAAAAAAI/AAAAAAAAABU/-MzYst-AOAo/photo.jpg?sz=128", "display_name": "Angela Jonon", "link": "https://stackoverflow.com/users/4143037/angela-jonon"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420631976, "post_id": 27817679, "comment_id": 44043724, "body": "Thanks for getting back to me. Unfortunately that did not work, I think I need that | to enclose the variables (in this case arrays) associated with the collection"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420632137, "post_id": 27817679, "comment_id": 44043842, "body": "Ah, sorry, I did not realize those are part of the previous string. Then simply remove carriage return from previous line."}, {"owner": {"reputation": 213, "user_id": 4143037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jd7m791o7_M/AAAAAAAAAAI/AAAAAAAAABU/-MzYst-AOAo/photo.jpg?sz=128", "display_name": "Angela Jonon", "link": "https://stackoverflow.com/users/4143037/angela-jonon"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420632269, "post_id": 27817679, "comment_id": 44043934, "body": "I only put the return in to screen capture the code, sorry forgot to take that out!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420634197, "post_id": 27817679, "comment_id": 44044990, "body": "Please disregard my comments above. See an answer below."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 4143037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jd7m791o7_M/AAAAAAAAAAI/AAAAAAAAABU/-MzYst-AOAo/photo.jpg?sz=128", "display_name": "Angela Jonon", "link": "https://stackoverflow.com/users/4143037/angela-jonon"}, "edited": false, "score": 0, "creation_date": 1420636507, "post_id": 27819709, "comment_id": 44046277, "body": "I think you are right about the nil value but unfortunately the .to_s stopped the error occuring but the column still did not write to the file. I have a feeling the problem can be fixed with + nil.to_s explicit conversion but I tried this in the .puts and it still did not work. I also changed he weekly total .each do to CSV.foreach(&#39;compareData.csv&#39;, converters: :numeric) do |row| \t weekly_total &lt;&lt; row[0] - row[1] \t end \t weekly_total.each do |i|  \t weeklyStatsFile.puts i   end   to no avail :("}, {"owner": {"reputation": 213, "user_id": 4143037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jd7m791o7_M/AAAAAAAAAAI/AAAAAAAAABU/-MzYst-AOAo/photo.jpg?sz=128", "display_name": "Angela Jonon", "link": "https://stackoverflow.com/users/4143037/angela-jonon"}, "edited": false, "score": 2, "creation_date": 1420713155, "post_id": 27819709, "comment_id": 44079992, "body": "Hey thanks, I have fixed this now. The .to_s worked in the end, it was just that I was putting the variable weekly_total into a separate file first and trying to read the value back. I did this because I didnt know about the converting to string initially and I thought that would fix it. Anyway once I ditched the other file, your answer worked. Cheers!"}, {"owner": {"reputation": 36888, "user_id": 293280, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6e6e22d81a1f4f394f62301be40c2e20?s=128&d=identicon&r=PG", "display_name": "Joshua Pinter", "link": "https://stackoverflow.com/users/293280/joshua-pinter"}, "edited": false, "score": 2, "creation_date": 1514150461, "post_id": 27819709, "comment_id": 82897707, "body": "You could also use <code>.compact</code> on the array to remove any nils: <code>[ ... ].compact.join(&#39;, &#39;)</code>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 24, "last_activity_date": 1457466167, "last_edit_date": 1457466167, "creation_date": 1420634293, "answer_id": 27819709, "question_id": 27817679, "link": "https://stackoverflow.com/questions/27817679/no-implicit-conversion-of-nil-into-string-error/27819709#27819709", "title": "no implicit conversion of nil into String error", "body": "<p>One of (or more) values in string </p>\n\n<pre><code>finalStatsFile.puts col_date+\", \"+col_constant1+\", \"+ col_appYear+\", \"+col_statsDesc+\", \"+col_constant2+\", \"+col_keyStats+\", \"+col_weeklyTotal\n</code></pre>\n\n<p>became <code>nil</code>. To fix the output you should explicitly cast them to strings:</p>\n\n<pre><code>finalStatsFile.puts col_date.to_s + \", \" + \n                    col_constant1.to_s + \", \" + \n                    col_appYear.to_s + \", \" + \n                    col_statsDesc.to_s + \", \" +\n                    col_constant2.to_s + \", \" +\n                    col_keyStats.to_s + \", \" + \n                    col_weeklyTotal.to_s \n</code></pre>\n\n<p>BTW, the whole clause might be rewritten in more rubyish manner:</p>\n\n<pre><code>finalStatsFile.puts [ col_date,\n                      col_constant1,\n                      col_appYear,\n                      col_statsDesc,\n                      col_constant2,\n                      col_keyStats,\n                      col_weeklyTotal ].map(&amp;:to_s).join(', ')\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 4143037, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jd7m791o7_M/AAAAAAAAAAI/AAAAAAAAABU/-MzYst-AOAo/photo.jpg?sz=128", "display_name": "Angela Jonon", "link": "https://stackoverflow.com/users/4143037/angela-jonon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83625, "favorite_count": 0, "accepted_answer_id": 27819709, "answer_count": 1, "score": 20, "last_activity_date": 1457466167, "creation_date": 1420627616, "last_edit_date": 1420628743, "question_id": 27817679, "link": "https://stackoverflow.com/questions/27817679/no-implicit-conversion-of-nil-into-string-error", "title": "no implicit conversion of nil into String error", "body": "<p>I have a ruby script that will create two files by taking and merging values from another file.</p>\n\n<pre><code>#Resources\nrequire 'rubygems'\nrequire 'csv'\n\ncol_date = []\ncol_constant1 = []\ncol_constant2 = []\ncol_appYear = []\ncol_statsDesc = []\ncol_keyStats =[]\ncol_weeklyTotal=[]\n\n\nweekly_total = []\n\nfname = \"finalStats.csv\" #variable for capture file\n        finalStatsFile = File.open(fname, \"w\") #write to capture file\nfname2 = \"weeklyStats.csv\"\n        weeklyStatsFile = File.open(fname2, \"w\")    \nCSV.foreach('compareData.csv', converters: :numeric) do |row|\n    weekly_total &lt;&lt; row[0] - row[1]\n\n    weekly_total.each do |data| \n    data &lt;&lt; weekly_total.shift \n     weeklyStatsFile.puts data\nend \nend\n\n#retrieve stats from original document \n CSV.foreach(\"autoCapture.csv\") {|row| col_date &lt;&lt; row[0]}\n CSV.foreach(\"autoCapture.csv\") {|row| col_constant1 &lt;&lt; row[1]}\n CSV.foreach(\"autoCapture.csv\") {|row| col_appYear &lt;&lt; row[2]}\n CSV.foreach(\"autoCapture.csv\") {|row| col_statsDesc &lt;&lt; row[3]}\n CSV.foreach(\"autoCapture.csv\") {|row| col_constant2 &lt;&lt; row[4]}\n CSV.foreach(\"autoCapture.csv\") {|row| col_keyStats &lt;&lt; row[5]}\n CSV.foreach(\"weeklyStats.csv\") {|row| col_weeklyTotal &lt;&lt; row[0]}\n\n\n\n  col_date.zip(col_constant1, col_appYear, col_statsDesc, col_constant2, col_keyStats, col_weeklyTotal).each do |col_date, col_constant1, col_appYear, col_statsDesc, col_constant2, \n  col_keyStats, col_weeklyTotal|\n\n  finalStatsFile.puts col_date+\", \"+col_constant1+\", \"+ col_appYear+\", \"+col_statsDesc+\", \"+col_constant2+\", \"+col_keyStats+\", \"+col_weeklyTotal\n\n end\n</code></pre>\n\n<p>In one file I wish to subtract the values in row[1] from the values in row[0] to create a new 'weekly_total' value. I then output this array of values in a file called weeklyStats.csv. This will output a column of values fine.</p>\n\n<p>However, I want to join these values with another set from another file (autoCapture.csv) and when I try to zip them as arrays so that they read across in corresponding rows I get the error:</p>\n\n<pre><code>weeklyStats_csv.rb:42:in `+': no implicit conversion of nil into String (TypeError)\n    from weeklyStats_csv.rb:42:in `block in &lt;main&gt;'\n    from weeklyStats_csv.rb:40:in `each'\n    from weeklyStats_csv.rb:40:in `&lt;main&gt;'\n</code></pre>\n\n<p>I gather this means that the array zip will not catch an exception if the one of the values is nil and therefore cannot convert to string. The problem is, I have tried converting weekly_total to string and array as I thought that it may be the problem (a mismatch of types) but I just dont where to go from here. Can anyone help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1420626330, "post_id": 27817224, "comment_id": 44040532, "body": "Do you have <code>Url</code> class? Where is the file with <code>Url</code> class source located? And what&#39;s is this file name?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1420626357, "post_id": 27817224, "comment_id": 44040553, "body": "Add <code>require &#39;uri&#39;</code> somewhere before call to <code>Url#new</code>."}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1420626649, "post_id": 27817224, "comment_id": 44040741, "body": "Thanks @mudasobwa, that didn&#39;t work - although to me it sounds like it should"}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1420626679, "post_id": 27817224, "comment_id": 44040759, "body": "@MarekLipka I don&#39;t have a Url class, I was thinking that it must be &#39;built-in&#39; to ROR, and I just have to reference it somehow"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1420626763, "post_id": 27817224, "comment_id": 44040810, "body": "@Ankur nope, it isn&#39;t. Plus, like Max wrote, <code>Url</code> is reserved."}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1420627064, "post_id": 27817224, "comment_id": 44040983, "body": "@Mareklipka thanks - using something other than Url gave different errors. I&#39;ll keep working through the issues."}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1420627125, "post_id": 27817224, "comment_id": 44041016, "body": "How do you want to use the model (class) you didn&#39;t define?"}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "reply_to_user": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1420627332, "post_id": 27817224, "comment_id": 44041122, "body": "@MarekLipka you&#39;re right. I made the Url class ... but got a different error. I was moving too fast, I need to step back and do some more reading methinks"}], "answers": [{"comments": [{"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "edited": false, "score": 0, "creation_date": 1420626719, "post_id": 27817287, "comment_id": 44040781, "body": "Thanks, I think that this is trying to use the Url class/functionality in ROR - but really have no idea"}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "edited": false, "score": 0, "creation_date": 1420626809, "post_id": 27817287, "comment_id": 44040837, "body": "I see what you mean about it being wierd, maybe I should try a different tutorial"}, {"owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "edited": false, "score": 1, "creation_date": 1420627368, "post_id": 27817287, "comment_id": 44041142, "body": "Thanks @Max ... I guess I should do more reading, was being a bit overambitious. Thanks for your help"}, {"owner": {"reputation": 3768, "user_id": 1029521, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7ce6f2f15a73bb6012b490dcbc4c1ed5?s=128&d=identicon&r=PG", "display_name": "Max Woolf", "link": "https://stackoverflow.com/users/1029521/max-woolf"}, "reply_to_user": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "edited": false, "score": 0, "creation_date": 1420627580, "post_id": 27817287, "comment_id": 44041253, "body": "No problem :) Stick with it, Rails is great!"}], "tags": [], "owner": {"reputation": 3768, "user_id": 1029521, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7ce6f2f15a73bb6012b490dcbc4c1ed5?s=128&d=identicon&r=PG", "display_name": "Max Woolf", "link": "https://stackoverflow.com/users/1029521/max-woolf"}, "is_accepted": false, "score": 6, "last_activity_date": 1420627319, "last_edit_date": 1420627319, "creation_date": 1420626351, "answer_id": 27817287, "question_id": 27817224, "link": "https://stackoverflow.com/questions/27817224/uninitialized-constant-urlscontrollerurl/27817287#27817287", "title": "uninitialized constant UrlsController::Url", "body": "<p>May or may not be the issue you're having, but <code>Url</code> is a reserved word in Rails.</p>\n\n<p>Source: <a href=\"http://bparanj.blogspot.co.uk/2011/07/reserved-words-in-rails.html\" rel=\"nofollow\">http://bparanj.blogspot.co.uk/2011/07/reserved-words-in-rails.html</a></p>\n\n<p>Alternatively, it's weird that calling <code>Url.new</code> is calling <code>new</code> on your <code>UrlsController</code> instead of the <code>Url</code> model. This backs up my idea about using reserved words, it can often cause strange behaviour.</p>\n\n<p>Edit: Oh and it looks like from another comment that you don't have a <code>Url</code> model. You'll need one of those before you can called <code>.new</code> on it. That said, don't create a model called <code>Url</code>, the reserved word thing will probably come back to bite you.</p>\n"}], "owner": {"reputation": 46899, "user_id": 69803, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/eed28c92944b219aa031f96fc6f71577?s=128&d=identicon&r=PG", "display_name": "Ankur", "link": "https://stackoverflow.com/users/69803/ankur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1420627319, "creation_date": 1420626187, "question_id": 27817224, "link": "https://stackoverflow.com/questions/27817224/uninitialized-constant-urlscontrollerurl", "title": "uninitialized constant UrlsController::Url", "body": "<p>I'm new to Ruby and Rails, coming from Java and Playframework.</p>\n\n<p>I'm following a tutorial <code>http://www.sitepoint.com/building-your-first-rails-application-views-and-controllers/</code></p>\n\n<p>I am getting an error on the line <code>@shortened_url = Url.new</code> </p>\n\n<p>The error is :</p>\n\n<pre><code>NameError in UrlsController#new\nuninitialized constant UrlsController::Url    \n</code></pre>\n\n<p>I feel this is something like a ClassNotFoundError in Java ?? not sure ... does anyone know what I have to do. Is it basically a matter of using <code>include</code> or <code>require</code>, with the correct reference.</p>\n\n<p>Apologies for the total newb question but I find it much easier to learn by doing and making mistakes, it sticks - and I reckon others will benefit too.</p>\n\n<pre><code>class UrlsController &lt; ApplicationController\n  def new\n    @shortened_url = Url.new\n  end\n\n  def create\n    @shortened_url = Url.new(params[:url])\n    if @shortened_url.save\n      flash[:shortened_id] = @shortened_url.id\n      redirect_to new_url_url\n    else\n      render :action =&gt; \"new\"\n    end\n  end\n\n  def show\n    @shortened_url = Url.find(params[:id])\n    redirect_to @shortened_url.url\n  end\n\nend\n</code></pre>\n"}, {"tags": ["javascript", "html", "ruby"], "comments": [{"owner": {"reputation": 5032, "user_id": 1664755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6226f6101f38cd27aeb456892754a8de?s=128&d=identicon&r=PG", "display_name": "Will Palmer", "link": "https://stackoverflow.com/users/1664755/will-palmer"}, "edited": false, "score": 0, "creation_date": 1420626026, "post_id": 27816965, "comment_id": 44040367, "body": "Is this answer: <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\" title=\"regex match open tags except xhtml self contained tags\">stackoverflow.com/questions/1732348/&hellip;</a> relevant to your question, or is your question related to a sufficiently-limited case that you don&#39;t expect the mentioned issued to be relevant?"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1420626022, "creation_date": 1420626022, "answer_id": 27817162, "question_id": 27816965, "link": "https://stackoverflow.com/questions/27816965/which-pattern-uses-in-gsub-to-replace-ordered-list-li-tag-html-string-with-or/27817162#27817162", "title": "Which pattern uses in gsub! to replace ordered list (li tag) html string with order number", "body": "<pre><code>s = '&lt;ol&gt;&lt;li&gt;CNN&lt;/li&gt;&lt;li&gt;BBC&lt;/li&gt;&lt;li&gt;Reuters&lt;/li&gt;&lt;/ol&gt;'\ns.gsub(/&lt;ol&gt;(.*)&lt;\\/ol&gt;/) {        # search for OL\n  $counter = 0                    # init counter\n  $~[1].gsub(/&lt;li&gt;(.*?)&lt;\\/li&gt;/) { # search for LI within result\n    '' + ($counter += 1).to_s + ') ' + $~[1] + ' '  \n  } \n}.strip                           # remove trailing space\n\n#\u21d2 \"1) CNN 2) BBC 3) Reuters\"\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 37, "user_id": 4404567, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2ab2444bd4d6c9f05623cdfd817fe26d?s=128&d=identicon&r=PG&f=1", "display_name": "huynhthinh", "link": "https://stackoverflow.com/users/4404567/huynhthinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1420626022, "creation_date": 1420625325, "last_edit_date": 1420625659, "question_id": 27816965, "link": "https://stackoverflow.com/questions/27816965/which-pattern-uses-in-gsub-to-replace-ordered-list-li-tag-html-string-with-or", "title": "Which pattern uses in gsub! to replace ordered list (li tag) html string with order number", "body": "<p>I have an html string as below:</p>\n\n<pre><code>&lt;ol&gt;&lt;li&gt;CNN&lt;/li&gt;&lt;li&gt;BBC&lt;/li&gt;&lt;li&gt;Reuters&lt;/li&gt;&lt;/ol&gt;\n</code></pre>\n\n<p>I need to convert this string to plain text use gsub! method of Ruby. Result will be as below</p>\n\n<pre><code>1) CNN 2) BBC 3) Reuters\n</code></pre>\n\n<p>Like this, i handle convert H1-H6:</p>\n\n<pre><code>text.gsub!(/(&lt;\\/h[1-6]&gt;)/i, \"\\n\\\\1\") # move closing tags to new lines\n    text.gsub!(/[\\s]*&lt;h([1-6]+)[^&gt;]*&gt;[\\s]*(.*)[\\s]*&lt;\\/h[1-6]+&gt;/i) do |s|\n      hlevel = $1.to_i\n\n      htext = $2\n      htext.gsub!(/&lt;br[\\s]*\\/?&gt;/i, \"\\n\") # handle &lt;br&gt;s\n      htext.gsub!(/&lt;\\/?[^&gt;]*&gt;/i, '') # strip tags\n\n      # determine maximum line length\n      hlength = 0\n      htext.each_line { |l| llength = l.strip.length; hlength = llength if llength &gt; hlength }\n      hlength = line_length if hlength &gt; line_length\n      hlength = 3\n\n      case hlevel\n        when 1   # H1, equal below\n          htext = htext.upcase + \"\\n\" + ('=' * hlength)\n        when 2   # H1, dashes below\n          htext = htext.upcase + \"\\n\" + ('-' * hlength)\n        else     # H3-H6, dashes below\n          htext = htext + \"\\n\" + ('-' * hlength)\n      end\n\n      \"\\n\" + htext\n    end\n</code></pre>\n\n<p>input :</p>\n\n<pre><code>&lt;h1&gt;heading 1&lt;/h1&gt;&lt;/div&gt;&lt;h2&gt;heading 2&lt;/h2&gt;&lt;h3&gt;heading 3&lt;/h3&gt;&lt;h4&gt;heading 4&lt;/h4&gt;\n</code></pre>\n\n<p>output: </p>\n\n<pre><code>HEADING 1\n=== \nHEADING 2\n--- \nheading 3\n--- \nheading 4\n---\n</code></pre>\n\n<p>Anybody can help me, Thanks</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "scope"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 0, "last_activity_date": 1420626202, "creation_date": 1420626202, "answer_id": 27817228, "question_id": 27816930, "link": "https://stackoverflow.com/questions/27816930/how-to-create-a-scope-to-order-cities-name/27817228#27817228", "title": "How to create a scope to order cities name?", "body": "<p>So you should join only <code>origin_city</code>:</p>\n\n<pre><code>scope :by_origin_city_name, -&gt; { joins(:origin_city).order('cities.name asc') }\n</code></pre>\n"}], "owner": {"reputation": 1341, "user_id": 3159162, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100001028388133/picture?type=large", "display_name": "leandrotk", "link": "https://stackoverflow.com/users/3159162/leandrotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 27817228, "answer_count": 1, "score": 0, "last_activity_date": 1420626202, "creation_date": 1420625210, "question_id": 27816930, "link": "https://stackoverflow.com/questions/27816930/how-to-create-a-scope-to-order-cities-name", "title": "How to create a scope to order cities name?", "body": "<p>I have two models/tables: Services and City</p>\n\n<p>Service model:</p>\n\n<pre><code>belongs_to :origin_city, class_name: 'City'\nbelongs_to :destiny_city, class_name: 'City'\n</code></pre>\n\n<p>How do I create a scope to order cities name?</p>\n\n<p>I'm trying something like that:</p>\n\n<pre><code>scope :by_city_name, -&gt; { joins(:city).order(\"cities.name asc\") }\n</code></pre>\n\n<p>But I just want to order the service origin city in one scope. And service destiny city in another scope.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "neo4j", "neo4j.rb", "nosql"], "answers": [{"comments": [{"owner": {"reputation": 4762, "user_id": 2105069, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2c107e06ab979c6ef456d76b98e8d114?s=128&d=identicon&r=PG", "display_name": "subvertallchris", "link": "https://stackoverflow.com/users/2105069/subvertallchris"}, "edited": false, "score": 1, "creation_date": 1420647729, "post_id": 27819046, "comment_id": 44053510, "body": "Just submitted the PR to add this to the gem. Check out <a href=\"https://github.com/neo4jrb/neo4j/pull/660\" rel=\"nofollow noreferrer\">github.com/neo4jrb/neo4j/pull/660</a>. I&#39;ll merge it in sometime in the next few hours unless Brian points out mistakes. ;-)"}], "tags": [], "owner": {"reputation": 10388, "user_id": 632454, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94593f750fbdbcfe459d7d16f45780e1?s=128&d=identicon&r=PG", "display_name": "Brian Underwood", "link": "https://stackoverflow.com/users/632454/brian-underwood"}, "is_accepted": true, "score": 5, "last_activity_date": 1444961379, "last_edit_date": 1444961379, "creation_date": 1420631975, "answer_id": 27819046, "question_id": 27816748, "link": "https://stackoverflow.com/questions/27816748/neo4j-rb-create-unique-relationship/27819046#27819046", "title": "Neo4j.rb create unique relationship", "body": "<p>This is something we have an issue open for:</p>\n\n<p><a href=\"https://github.com/neo4jrb/neo4j/issues/473\" rel=\"nofollow\">https://github.com/neo4jrb/neo4j/issues/473</a></p>\n\n<p>For now I would suggest creating a method like this on the <code>User</code> model:</p>\n\n<pre><code>def create_unique_follower(other)\n    Neo4j::Query.match(user: {User: {neo_id: self.neo_id}})\n                .match(other: {User: {neo_id: other.neo_id}})\n                .create_unique('user-[:following]-&gt;other').exec\nend\n</code></pre>\n\n<p><strong>EDIT</strong>: See mrstif's answer for an update</p>\n"}, {"tags": [], "owner": {"reputation": 1460, "user_id": 2194665, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/afb9f5a9148e7cf12514b6607a4eb5db?s=128&d=identicon&r=PG", "display_name": "mrstif", "link": "https://stackoverflow.com/users/2194665/mrstif"}, "is_accepted": false, "score": 6, "last_activity_date": 1444925931, "creation_date": 1444925931, "answer_id": 33153615, "question_id": 27816748, "link": "https://stackoverflow.com/questions/27816748/neo4j-rb-create-unique-relationship/33153615#33153615", "title": "Neo4j.rb create unique relationship", "body": "<p>Just as an update, you can now do the following:</p>\n\n<p>For simple relationships, use <code>unique:true</code>:</p>\n\n<pre><code>class User\n  include Neo4j::ActiveNode\n  has_many :out, :following, type: :following, model_class: 'User', unique: true\nend\n</code></pre>\n\n<p>For declared relationships, use <code>creates_unique</code>:</p>\n\n<pre><code>class Following\n  include Neo4j::ActiveRel\n\n  creates_unique\n\n  from_class User\n  to_class   User\nend\n</code></pre>\n"}], "owner": {"reputation": 3385, "user_id": 1689539, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9905d1270ccf6e9834436f7b97d5f613?s=128&d=identicon&r=PG", "display_name": "Raj Adroit", "link": "https://stackoverflow.com/users/1689539/raj-adroit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 1, "accepted_answer_id": 27819046, "answer_count": 2, "score": 5, "last_activity_date": 1505859906, "creation_date": 1420624641, "last_edit_date": 1506103282, "question_id": 27816748, "link": "https://stackoverflow.com/questions/27816748/neo4j-rb-create-unique-relationship", "title": "Neo4j.rb create unique relationship", "body": "<p>Here is my Neo4j Active Node</p>\n\n<pre><code>class User\ninclude Neo4j::ActiveNode\n  has_many :out, :following, type: :following, model_class: 'User'\nend\n\njohn = User.find(:name =&gt; \"John\")\ntom = User.find(:name =&gt; \"Tom\")\n\n# create following relationship john --&gt; tom\njohn.following &lt;&lt; tom\n# check count\njohn.following.count \n#=&gt; 1\n\n# again create the relationship \njohn.following &lt;&lt; tom\n# again check count\njohn.following.count\n#=&gt; 2\n</code></pre>\n\n<p>I want to create unique relationship.</p>\n\n<p>To avoid duplication we have to use create unique in creating relation cypher query.</p>\n\n<p>Example:</p>\n\n<pre><code>MATCH (root { name: 'root' })\nCREATE UNIQUE (root)-[:LOVES]-(someone)\nRETURN someone\n</code></pre>\n\n<p>refer: <a href=\"http://neo4j.com/docs/stable/query-create-unique.html\" rel=\"nofollow\">http://neo4j.com/docs/stable/query-create-unique.html</a></p>\n\n<p><strong>How can i do this in Neo4j.rb with Rails... ?</strong></p>\n\n<p>Thanks in advance.. </p>\n"}, {"tags": ["ruby", "angularjs", "cucumber", "watir", "page-object-gem"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1420638747, "post_id": 27816575, "comment_id": 44047532, "body": "It would help if you could give more details on how to reproduce the problem. In particular, the HTML/Javascript required to reproduce the problem."}, {"owner": {"reputation": 35, "user_id": 3686624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sf_MiZA2Qdk/AAAAAAAAAAI/AAAAAAAAAF4/qlF49xMyoCw/photo.jpg?sz=128", "display_name": "Spuck", "link": "https://stackoverflow.com/users/3686624/spuck"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1420722106, "post_id": 27816575, "comment_id": 44085031, "body": "I&#39;ve now managed to resolve the question myself. The second iteration of the &#39;Next&#39; button was running on another index, just needed to add an additional selector to catch the visible button."}], "answers": [{"tags": [], "owner": {"reputation": 1410, "user_id": 3890924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uy8Gd.jpg?s=128&g=1", "display_name": "alannichols", "link": "https://stackoverflow.com/users/3890924/alannichols"}, "is_accepted": true, "score": 0, "last_activity_date": 1421410239, "creation_date": 1421410239, "answer_id": 27983680, "question_id": 27816575, "link": "https://stackoverflow.com/questions/27816575/reusing-a-cucumber-step-definition-on-a-single-page-angular-app/27983680#27983680", "title": "Reusing a cucumber step definition on a single page Angular app", "body": "<p>I see that you've answered your question but in case it helps to explain it to anyone else:</p>\n\n<p>The issue is likely that to watir it isn't the same next button on each page and all of the next buttons are in scope all of the time.  Therefore to click the correct one you would have to use the index property of the button you want i.e. index: 1 for the second page and index 2 for the the button on the third page.</p>\n"}], "owner": {"reputation": 35, "user_id": 3686624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sf_MiZA2Qdk/AAAAAAAAAAI/AAAAAAAAAF4/qlF49xMyoCw/photo.jpg?sz=128", "display_name": "Spuck", "link": "https://stackoverflow.com/users/3686624/spuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 1, "accepted_answer_id": 27983680, "answer_count": 1, "score": 0, "last_activity_date": 1421410239, "creation_date": 1420624085, "last_edit_date": 1420628661, "question_id": 27816575, "link": "https://stackoverflow.com/questions/27816575/reusing-a-cucumber-step-definition-on-a-single-page-angular-app", "title": "Reusing a cucumber step definition on a single page Angular app", "body": "<p>I'm using watir-webdriver with the page-object gem to drive cucumber tests for a single web page app built in angular js.</p>\n\n<p>The site uses a multiple stage registration process, filling a series of details each time then clicking a 'next' button. (which is enabled when all details are completed for that page)</p>\n\n<p>The issue occurs when I'm attempting to reuse the following step definition:</p>\n\n<pre><code>And(/^I click next$/) do\n @registration = RegistrationPage.new(@browser)\n @registration.click_next\nend\n</code></pre>\n\n<p>Which calls the page-object:</p>\n\n<pre><code>class RegistrationPage\n  include PageObject\n\n  button(:next, :value =&gt; \"Next\")\n\n  def click_next\n   @browser.wait_while { next_element.disabled? }\n   next_element.click\n  end\nend\n</code></pre>\n\n<p>For the first section, the Next button is found correctly, however on the second call to the step definition, the button cannot be found, despite the button being verifiably enabled and otherwise identical.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "devise", "sendgrid"], "comments": [{"owner": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420624235, "post_id": 27815873, "comment_id": 44039308, "body": "Show me your User class...!!!"}, {"owner": {"reputation": 199, "user_id": 4186847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17170d179356341d550bfa553e710684?s=128&d=identicon&r=PG&f=1", "display_name": "deventhusiast", "link": "https://stackoverflow.com/users/4186847/deventhusiast"}, "reply_to_user": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420626222, "post_id": 27815873, "comment_id": 44040459, "body": "Updated question with user class"}, {"owner": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420627999, "post_id": 27815873, "comment_id": 44041489, "body": "set up your mail setting in config/environments/development.rb then restart your rails server"}, {"owner": {"reputation": 199, "user_id": 4186847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17170d179356341d550bfa553e710684?s=128&d=identicon&r=PG&f=1", "display_name": "deventhusiast", "link": "https://stackoverflow.com/users/4186847/deventhusiast"}, "reply_to_user": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420629164, "post_id": 27815873, "comment_id": 44042163, "body": "Tried it, didn&#39;t work."}, {"owner": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420632038, "post_id": 27815873, "comment_id": 44043772, "body": "which mail service you are using!!!"}, {"owner": {"reputation": 199, "user_id": 4186847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17170d179356341d550bfa553e710684?s=128&d=identicon&r=PG&f=1", "display_name": "deventhusiast", "link": "https://stackoverflow.com/users/4186847/deventhusiast"}, "reply_to_user": {"reputation": 245, "user_id": 2617508, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/5ff8983b81dad5fd0df5cd930ba1196e?s=128&d=identicon&r=PG", "display_name": "RubyOnRails", "link": "https://stackoverflow.com/users/2617508/rubyonrails"}, "edited": false, "score": 0, "creation_date": 1420633190, "post_id": 27815873, "comment_id": 44044476, "body": "I&#39;ve outlined the entire set of steps I took in the question. Maybe I did something wrong there?"}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 4186847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17170d179356341d550bfa553e710684?s=128&d=identicon&r=PG&f=1", "display_name": "deventhusiast", "link": "https://stackoverflow.com/users/4186847/deventhusiast"}, "edited": false, "score": 0, "creation_date": 1420626037, "post_id": 27816256, "comment_id": 44040372, "body": "Thanks for your input. But I have already entered that line of code in the development.rb file as you can see in my question."}], "tags": [], "owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "is_accepted": false, "score": 2, "last_activity_date": 1420627617, "last_edit_date": 1420627617, "creation_date": 1420623176, "answer_id": 27816256, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/27816256#27816256", "title": "Not receiving confirmation mail with devise", "body": "<p>You are running it for development mode. Mails are formed and can be seen in logs but not delivered. They will not be sent in dev mode by default.To enable, use this in development.rb</p>\n\n<pre><code>config.action_mailer.perform_deliveries = true\n</code></pre>\n\n<p>use the below code in config/environments/development.rb</p>\n\n<pre><code>config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.sendgrid.net\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"sendgrid.com\",   \n    :user_name            =&gt; \"\"\n    :password             =&gt; \"\"\n    :authentication       =&gt; 'plain',\n    :enable_starttls_auto =&gt; true  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8281, "user_id": 67834, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/qyict.png?s=128&g=1", "display_name": "Eliot Sykes", "link": "https://stackoverflow.com/users/67834/eliot-sykes"}, "is_accepted": false, "score": 0, "last_activity_date": 1420636741, "creation_date": 1420636741, "answer_id": 27820445, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/27820445#27820445", "title": "Not receiving confirmation mail with devise", "body": "<p>In mail_setup.rb, try changing the first line to:</p>\n\n<pre><code>if Rails.env.development? || Rails.env.production?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3287310, "user_type": "registered", "profile_image": "https://graph.facebook.com/1435503890/picture?type=large", "display_name": "ssjose", "link": "https://stackoverflow.com/users/3287310/ssjose"}, "is_accepted": true, "score": 5, "last_activity_date": 1420642751, "creation_date": 1420642751, "answer_id": 27822194, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/27822194#27822194", "title": "Not receiving confirmation mail with devise", "body": "<p>Check to make sure Sendgrid doesn't have your account on hold. Log in through your Heroku dashboard. Then click on your app. Then under addons, click on Sendgrid. This will take you to their dashboard. If there is a warning saying that your account is on hold pending review, you'll have to contact them and have them remove it.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5275461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37Qgg.png?s=128&g=1", "display_name": "leo", "link": "https://stackoverflow.com/users/5275461/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1441396696, "creation_date": 1441396696, "answer_id": 32405691, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/32405691#32405691", "title": "Not receiving confirmation mail with devise", "body": "<p>I ran into the same problem with <code>:confirmable</code>. I was not able to get the email to send, but I was able to trick the app into thinking that it had been sent and confirmed - and therefore login. </p>\n\n<p><a href=\"http://www.rubydoc.info/github/plataformatec/devise/master/Devise/Models/Confirmable\" rel=\"nofollow\">:confirmable info</a></p>\n\n<p>In the console:</p>\n\n<pre><code>User.find(1).confirm       # returns true unless it's already confirmed\nUser.find(1).confirmed?    # true/false\nUser.find(1).send_confirmation_instructions # manually send instructions\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2725, "user_id": 3145189, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3b7992b5e5cbf3d0e7587f00f1bae5fa?s=128&d=identicon&r=PG&f=1", "display_name": "CMS Signage", "link": "https://stackoverflow.com/users/3145189/cms-signage"}, "is_accepted": false, "score": 0, "last_activity_date": 1544797668, "creation_date": 1544797668, "answer_id": 53781594, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/53781594#53781594", "title": "Not receiving confirmation mail with devise", "body": "<p>In my case, i was using my gmail account with localhost environment, when i check my mail, i show a mail from google saying \"Sign-in attempt was blocked\" due to \"Less secure app blocked\" , you can enable it need to follow instruction as received in    <a href=\"https://support.google.com/a/answer/6260879?authuser=1\" rel=\"nofollow noreferrer\">mail link</a></p>\n"}, {"tags": [], "owner": {"reputation": 431, "user_id": 5043544, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-szFJ_Sj2aGw/AAAAAAAAAAI/AAAAAAAAAVg/yTDBaQo3DKY/photo.jpg?sz=128", "display_name": "charan teja", "link": "https://stackoverflow.com/users/5043544/charan-teja"}, "is_accepted": false, "score": 0, "last_activity_date": 1609255436, "creation_date": 1609255436, "answer_id": 65494487, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise/65494487#65494487", "title": "Not receiving confirmation mail with devise", "body": "<p>In development setup, by default mails are not sent</p>\n<p>we can enable by setting\nconfig.action_mailer.perform_deliveries = true</p>\n<p>if it is still not solved ,we can set</p>\n<p>config.action_mailer.raise_delivery_errors = true</p>\n<p>and we can find the exact issue printed in console</p>\n"}], "owner": {"reputation": 199, "user_id": 4186847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17170d179356341d550bfa553e710684?s=128&d=identicon&r=PG&f=1", "display_name": "deventhusiast", "link": "https://stackoverflow.com/users/4186847/deventhusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1916, "favorite_count": 0, "accepted_answer_id": 27822194, "answer_count": 6, "score": 1, "last_activity_date": 1609255436, "creation_date": 1420621844, "last_edit_date": 1420640092, "question_id": 27815873, "link": "https://stackoverflow.com/questions/27815873/not-receiving-confirmation-mail-with-devise", "title": "Not receiving confirmation mail with devise", "body": "<p>Following a tutorial where I am adding user authentication to a basic rails app.</p>\n\n<p>There is a step where I have to add the following code to a <code>setup_mail.rb</code> file</p>\n\n<pre><code>if Rails.env.development?\n  ActionMailer::Base.delivery_method = :smtp\n  ActionMailer::Base.smtp_settings = {\n    address:        'smtp.sendgrid.net',\n    port:           '587',\n    authentication: :plain,\n    user_name:      ENV['SENDGRID_USERNAME'],\n    password:       ENV['SENDGRID_PASSWORD'],\n    domain:         'heroku.com',\n    enable_starttls_auto: true\n  }\nend\n</code></pre>\n\n<p>I have added the sendgrid addon, and put user id and password on the application.yml file as well. </p>\n\n<p>But when I sign up, I do not receive a confirmation mail. </p>\n\n<p>cross checked the <code>development.rb</code> file as well and made sure the following code was present</p>\n\n<pre><code>....\n   config.action_mailer.default_url_options = { host: 'localhost:3000' }\n   config.action_mailer.delivery_method = :smtp\n   config.action_mailer.perform_deliveries = true\nend\n</code></pre>\n\n<p>Followed the tutorial word to word. Hence really stumped! Google pointed me to a few places and confused me futher!</p>\n\n<p>This is how my migration db file looks like at the moment</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Customization\n       t.string :name\n      ## Database authenticatable\n      t.string :email,              null: false, default: \"\"\n      t.string :encrypted_password, null: false, default: \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Confirmable\n       t.string   :confirmation_token\n       t.datetime :confirmed_at\n       t.datetime :confirmation_sent_at\n       t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is    :failed_attempts\n  # t.string   :unlock_token # Only if unlock strategy is :email or :both\n  # t.datetime :locked_at\n\n\n  t.timestamps\nend\n\nadd_index :users, :email,                unique: true\nadd_index :users, :reset_password_token, unique: true\n# add_index :users, :confirmation_token,   unique: true\n# add_index :users, :unlock_token,         unique: true\n  end\nend\n</code></pre>\n\n<p>Here is my user.rb file as well</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable, :confirmable\nend\n</code></pre>\n\n<p>These are the steps I followed in order</p>\n\n<ol>\n<li>Installed devise gem, ran <code>bundle</code></li>\n<li><code>rails g devise:install</code></li>\n<li>Added the above code to development.rb file</li>\n<li><code>rails g devise:views</code></li>\n<li><code>rails g devise User</code></li>\n<li>Uncommented <code>confirmable</code> in the migration file`</li>\n<li><code>rake db:migrate</code></li>\n<li>Added <code>:confirmable</code> to the User class in user.rb</li>\n<li><code>heroku addons:add sendgrid:starter</code></li>\n<li><code>heroku congif:get SENDGRID_USERNAME</code></li>\n<li><code>heroku config:get SENDGRID_PASSWORD</code></li>\n<li>Created config/initializers/setup_mail.rb and added the above mail settings.</li>\n<li>Installed figaro. </li>\n<li>Added environment variables to application.yml file</li>\n<li>`figaro heroku:set -e production</li>\n</ol>\n\n<p>Update</p>\n\n<p>Added mail settings in development.rb as well, no luck. </p>\n\n<p>Tried changing the domain from <code>domain: 'heroku.com'</code> to <code>domain: 'sendgrid.com'</code>, no luck.</p>\n\n<p>Here is the server log. It appears that the mail has been sent but I cannot find it in the inbox or spam</p>\n\n<pre><code>Sent mail to myemail@gmail.com (2070.9ms)                                                                                                                                                    \nDate: Wed, 07 Jan 2015 13:52:05 +0000                                                                                                                                                             \nFrom: please-change-me-at-config-initializers-devise@example.com                                                                                                                                  \nReply-To: please-change-me-at-config-initializers-devise@example.com                                                                                                                              \nTo: myemailgmail.com                                                                                                                                                                        \nMessage-ID: &lt;54ad3a05d2b29_1ba3fb59082841433253@bloc-ruby-179559.mail&gt;                                                                                                                            \nSubject: Confirmation instructions                                                                                                                                                                \nMime-Version: 1.0                                                                                                                                                                                 \nContent-Type: text/html;                                                                                                                                                                          \n charset=UTF-8                                                                                                                                                                                    \n Content-Transfer-Encoding: 7bit                                                                                                                                                                   \n\n &lt;p&gt;Welcome !&lt;/p&gt;                                                                                                                                                            \n\n&lt;p&gt;You can confirm your account email through the link below:&lt;/p&gt;                                                                                                                                 \n\n &lt;p&gt;&lt;a href=\"http://localhost:3000/users/confirmation? confirmation_token=W3xuYfA8aq2obMBmffghfghQaDt\"&gt;Confirm my account&lt;/a&gt;&lt;/p&gt;                                                                          \n\n   (45.0ms)  commit transaction                                                                                                                                                                   \nRedirected to http://bloc-ruby-179559.apse1.nitrousbox.com/                                                                                                                                       \nCompleted 302 Found in 2872ms (ActiveRecord: 46.4ms)                                                                              \n</code></pre>\n"}, {"tags": ["ruby", "sqlite", "jekyll", "ghost-blog"], "comments": [{"owner": {"reputation": 205, "user_id": 1287889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d8b82740cb7ca994449cccd1dfdef5f?s=128&d=identicon&r=PG", "display_name": "Bret", "link": "https://stackoverflow.com/users/1287889/bret"}, "edited": false, "score": 0, "creation_date": 1420673807, "post_id": 27815264, "comment_id": 44067162, "body": "Did you install all the correct gems?  I&#39;ve never done an import personally, but it looks like its a missing gem error."}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420863585, "post_id": 27815264, "comment_id": 44147917, "body": "@JitendraVyas How did you get the <code>ghost.db</code> file? I mean, did you copy it from <code>content&#47;data</code> or downloaded it using the export button?"}, {"owner": {"reputation": 133646, "user_id": 84201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5cce99e9bf6154703d8ecdf474a750bd?s=128&d=identicon&r=PG", "display_name": "Jitendra Vyas", "link": "https://stackoverflow.com/users/84201/jitendra-vyas"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420863819, "post_id": 27815264, "comment_id": 44147955, "body": "@TamerShlash I download from my ghost installation at DigitalOcean"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420864056, "post_id": 27815264, "comment_id": 44147986, "body": "@JitendraVyas did you find it somewhere like <code>content&#47;data</code> or just logged into your Ghost installation and hit the &quot;export&quot; button?"}, {"owner": {"reputation": 133646, "user_id": 84201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5cce99e9bf6154703d8ecdf474a750bd?s=128&d=identicon&r=PG", "display_name": "Jitendra Vyas", "link": "https://stackoverflow.com/users/84201/jitendra-vyas"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420864218, "post_id": 27815264, "comment_id": 44148014, "body": "@TamerShlash I connect to my ghost directory via SSH and downloaded ghost.db to my systm. Export installation of ghost option doesn&#39;t give ghost.db it gives .json file"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420864503, "post_id": 27815264, "comment_id": 44148061, "body": "@JitendraVyas according to <a href=\"http://support.ghost.org/how-to-upgrade/#backing-up\" rel=\"nofollow noreferrer\">this support page</a>, you should stop your Ghost installation before downloading the database file. Also, your Ghost database should be SQLite."}, {"owner": {"reputation": 133646, "user_id": 84201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5cce99e9bf6154703d8ecdf474a750bd?s=128&d=identicon&r=PG", "display_name": "Jitendra Vyas", "link": "https://stackoverflow.com/users/84201/jitendra-vyas"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1420865697, "post_id": 27815264, "comment_id": 44148265, "body": "@TamerShlash yes I stopped ghost server before to download ghost.db"}, {"owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "edited": false, "score": 1, "creation_date": 1420958290, "post_id": 27815264, "comment_id": 44170785, "body": "@JitendraVyas Use <a href=\"http://sqlitebrowser.org\" rel=\"nofollow noreferrer\">sqlitebrowser.org</a> to inspect and verify that the <code>ghost.db</code> file is in valid format, and that it does contain <code>posts</code> table; that could provide more info about why the import script is failing."}], "answers": [{"comments": [{"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1422303348, "post_id": 27877082, "comment_id": 44687246, "body": "And the bounty as gone. To bad."}], "tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": false, "score": 1, "last_activity_date": 1420898888, "creation_date": 1420898888, "answer_id": 27877082, "question_id": 27815264, "link": "https://stackoverflow.com/questions/27815264/how-to-extract-blog-posts-from-ghost-and-import-in-github-hosted-jekyll/27877082#27877082", "title": "How to extract blog posts from Ghost and import in Github hosted jekyll?", "body": "<p>You have to run your command from the folder where ghost.db is in.</p>\n\n<p>If your not lauching your command from the db folder, you can give an absolute path like</p>\n\n<pre><code>\"dbfile\"   =&gt; \"/home/user/ghost.db\"\n</code></pre>\n\n<p>Or the database name is not the good one. Maybe <code>ghost-dev.db</code> or <code>ghost-prod.db</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 41220, "user_id": 26226, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e53f834643e385cd39c2d9f721071906?s=128&d=identicon&r=PG", "display_name": "jrummell", "link": "https://stackoverflow.com/users/26226/jrummell"}, "is_accepted": false, "score": 0, "last_activity_date": 1536353228, "creation_date": 1536353228, "answer_id": 52229447, "question_id": 27815264, "link": "https://stackoverflow.com/questions/27815264/how-to-extract-blog-posts-from-ghost-and-import-in-github-hosted-jekyll/52229447#52229447", "title": "How to extract blog posts from Ghost and import in Github hosted jekyll?", "body": "<p>Another option is to export your ghost blog to json and then convert that json file into markdown files for Jekyll GitHub pages.</p>\n\n<p>The json file is pretty self explanatory, so you could write a simple program to parse the file and create markdown files from it.</p>\n\n<p>The process would look like this:</p>\n\n<ul>\n<li>read the json file into memory.</li>\n<li>parse the posts from <code>db.data.posts</code>.</li>\n<li>for each post:\n\n<ul>\n<li>the markdown content is in the <code>post</code> <code>markdown</code> property.</li>\n<li>create your front matter from the other <code>post</code> properties.</li>\n<li>write a file with the front matter and original markdown, pre-pending the file name with the date into a <code>_posts</code> folder in your output folder.</li>\n<li>note: if the <code>page</code> property is 0, it's a post, if it's 1 it's a page. If it's a page, the file should go in the root of your output folder without the date in the file name.</li>\n</ul></li>\n</ul>\n\n<p>Each post file should look something like this:</p>\n\n<pre><code>---\nlayout: post\ntitle: Welcome to Ghost\npermalink: /welcome-to-ghost\ndate: 2017-04-25 20:54:20\npublished: false\ntags: \n---\n\nYou're live! Nice. We've put together a little post to introduce you to the Ghost editor and get you started. You can manage your content by signing in to the admin area at `&lt;your blog URL&gt;/ghost/`. When you arrive, you can select this post from a list on the left and see a preview of it on the right. Click the little pencil icon at the top of the preview to edit this post and read the next section!\n</code></pre>\n\n<p>If you're looking for an existing utility, or sample code, try <a href=\"https://github.com/jrummell/GhostToGitHubPagesConverter\" rel=\"nofollow noreferrer\">GhostToGitHubPagesConverter</a>. It's a dotnet core console app that will run on windows, mac or linux. </p>\n\n<p>Full disclosure, this is my github project.</p>\n"}], "owner": {"reputation": 133646, "user_id": 84201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5cce99e9bf6154703d8ecdf474a750bd?s=128&d=identicon&r=PG", "display_name": "Jitendra Vyas", "link": "https://stackoverflow.com/users/84201/jitendra-vyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536353228, "creation_date": 1420619496, "last_edit_date": 1420864992, "question_id": 27815264, "link": "https://stackoverflow.com/questions/27815264/how-to-extract-blog-posts-from-ghost-and-import-in-github-hosted-jekyll", "title": "How to extract blog posts from Ghost and import in Github hosted jekyll?", "body": "<p>Jekyll website has given this instruction but it's not complete. I downloaded ghost.db from ghost blog and Installed <a href=\"http://import.jekyllrb.com/docs/ghost/\" rel=\"nofollow noreferrer\">http://import.jekyllrb.com/docs/ghost/</a> and jekyll-import gem and it's all dependencies. and ran the given command in above link. It ran but it's giving error</p>\n\n<p><img src=\"https://i.stack.imgur.com/aFjux.jpg\" alt=\"enter image description here\"></p>\n\n<p>Also I don't have any local installation of jekyll website. It's hosted on github.</p>\n\n<p>I want to move my blog posts of ghost to github hosted jekyll. </p>\n\n<p>My OS is OSX Yosemite. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5961, "user_id": 2328259, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7f760bec40648f4bda5855cd854612e?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2328259/david"}, "edited": false, "score": 2, "creation_date": 1420619602, "post_id": 27815204, "comment_id": 44036897, "body": "You need information from the server. While, sockets would probably be the way to go (you could use Pusher for help), there are also other techniques, like long-polling, etc."}, {"owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "reply_to_user": {"reputation": 5961, "user_id": 2328259, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7f760bec40648f4bda5855cd854612e?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2328259/david"}, "edited": false, "score": 0, "creation_date": 1420645263, "post_id": 27815204, "comment_id": 44051877, "body": "@David, Pusher was a good advice, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 1080819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c2530da365d5ed7f997727deef4c375?s=128&d=identicon&r=PG", "display_name": "Aventuris", "link": "https://stackoverflow.com/users/1080819/aventuris"}, "edited": false, "score": 0, "creation_date": 1420623204, "post_id": 27816125, "comment_id": 44038751, "body": "Read up on simple ajax requests to the server. Angular seems like too much of an investment for one page."}, {"owner": {"reputation": 1532, "user_id": 3209693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sXLfb.jpg?s=128&g=1", "display_name": "Kaspar", "link": "https://stackoverflow.com/users/3209693/kaspar"}, "reply_to_user": {"reputation": 630, "user_id": 1080819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c2530da365d5ed7f997727deef4c375?s=128&d=identicon&r=PG", "display_name": "Aventuris", "link": "https://stackoverflow.com/users/1080819/aventuris"}, "edited": false, "score": 0, "creation_date": 1420623459, "post_id": 27816125, "comment_id": 44038886, "body": "Might be. But in case @Jayden decides to develop the website further one day, then it would be a lot better solution to have the front-end done with Angular, following proper Angular development patterns. Helps with easier maintenance later on."}], "tags": [], "owner": {"reputation": 1532, "user_id": 3209693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sXLfb.jpg?s=128&g=1", "display_name": "Kaspar", "link": "https://stackoverflow.com/users/3209693/kaspar"}, "is_accepted": false, "score": 1, "last_activity_date": 1420622712, "creation_date": 1420622712, "answer_id": 27816125, "question_id": 27815204, "link": "https://stackoverflow.com/questions/27815204/how-to-make-one-page-real-time-in-rails-app/27816125#27816125", "title": "How to make one page real-time in Rails app?", "body": "<p>Well you could make a small service in Angular that asks the server like every 15 secons or so, to see if there are new pizzas added to the database. (Say the last time you took the pizzas from the server you had 15 of them returned. Now you send that number 15 back with the check request and compare it with the database)</p>\n\n<p>If so, it will call the query method in the pizza Angular service to fetch the new pizzas.\nIf this is a small table with often changing info then I would also suggest to migrate this model into Redis instead. Asking info repeteadly from Redis is a lot cheaper than it is to ask like this from a database.</p>\n"}], "owner": {"reputation": 9327, "user_id": 3192470, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2Qlum.jpg?s=128&g=1", "display_name": "lakesare", "link": "https://stackoverflow.com/users/3192470/lakesare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1420643312, "answer_count": 1, "score": 0, "last_activity_date": 1420622712, "creation_date": 1420619292, "question_id": 27815204, "link": "https://stackoverflow.com/questions/27815204/how-to-make-one-page-real-time-in-rails-app", "closed_reason": "Needs more focus", "title": "How to make one page real-time in Rails app?", "body": "<p>I have an app that is already fully built, the only thing I'd like to add is real-time rendering of one of my pages.<br>\nSuppose it is a page with all the pizzas. When pizza is added to the database, I'd like page to show it without refreshing.</p>\n\n<p>I know you can do it with websockets, but is there any easier way? Could, eg, <em>AngularJS</em> help here (as I understand it refreshes the page contents as soon as model is changed)?</p>\n"}, {"tags": ["ruby", "oop"], "comments": [{"owner": {"reputation": 16538, "user_id": 2602869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PkMYa.jpg?s=128&g=1", "display_name": "Jikku Jose", "link": "https://stackoverflow.com/users/2602869/jikku-jose"}, "edited": false, "score": 1, "creation_date": 1420620918, "post_id": 27815073, "comment_id": 44037487, "body": "This type of data structure is not suitable for your requirement. Store the data in sql and use an ORM to retrieve data as you envision it."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 3, "creation_date": 1420620974, "post_id": 27815073, "comment_id": 44037512, "body": "Please change &quot;sudo&quot; to &quot;pseudo&quot;. It&#39;s driving me crazy. Also, for <code>Sentence</code> and <code>Word</code> to be nested you&#39;d need to define them <code>class Sentence &lt; Paragraph</code> and <code>class Word &lt; Sentence</code>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1420624667, "post_id": 27815073, "comment_id": 44039554, "body": "@CarySwoveland: Omigod, you are a genius. I was banging my head against the wall trying to figure out what this has to do with superuser permissions... But you are wrong in your next remark: OP is nesting not by hierarchy (is-a), but by containment (has-a, in instance variables), and it is the correct thing to do: a <code>Word</code> is certainly not a type of <code>Sentence</code>, nor is a <code>Sentence</code> a kind of <code>Paragraph</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1420626865, "post_id": 27815073, "comment_id": 44040869, "body": "@Amadan, ha!, and thanks for the correction. Now I&#39;m going back to sleepzzzzzzz."}], "answers": [{"comments": [{"owner": {"reputation": 292, "user_id": 1487479, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1aa899e9772cdd977b9d0f60e1ba9daf?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1487479/nathan"}, "edited": false, "score": 0, "creation_date": 1420662365, "post_id": 27815235, "comment_id": 44061928, "body": "Thanks! This seems like straight forward solution (I don&#39;t know why i didn&#39;t think of it) my only objection is it doesn&#39;t seem to be very DRY.  For every class I create I&#39;ve got remember to put a placeholder to the &#39;parent&#39; class.  Maybe this is only possible solution for how OOP is designed but I thought there might be native method.  It seems similar to navigating a web page DOM tree or XML doc.  Not sure if those parsers use pointers as you describe or some other magic."}, {"owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "reply_to_user": {"reputation": 292, "user_id": 1487479, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1aa899e9772cdd977b9d0f60e1ba9daf?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1487479/nathan"}, "edited": false, "score": 0, "creation_date": 1420665194, "post_id": 27815235, "comment_id": 44063429, "body": "Ruby variables are passed by reference by default, so it is very likely a pointer (I don&#39;t know for sure though). I do believe my solution is DRY because there isn&#39;t repeated code."}], "tags": [], "owner": {"reputation": 2623, "user_id": 625354, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xc5hf.jpg?s=128&g=1", "display_name": "Dbz", "link": "https://stackoverflow.com/users/625354/dbz"}, "is_accepted": true, "score": 2, "last_activity_date": 1420619416, "creation_date": 1420619416, "answer_id": 27815235, "question_id": 27815073, "link": "https://stackoverflow.com/questions/27815073/navigating-up-ruby-objects/27815235#27815235", "title": "Navigating up Ruby Objects", "body": "<p>Each word can have a sentence variable that points to the Sentence it is in. Same for Sentence and Paragraph- and Paragraph and Page.</p>\n"}, {"comments": [{"owner": {"reputation": 292, "user_id": 1487479, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1aa899e9772cdd977b9d0f60e1ba9daf?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1487479/nathan"}, "edited": false, "score": 0, "creation_date": 1420661759, "post_id": 27821709, "comment_id": 44061600, "body": "I agree that &#39;nested&#39; isn&#39;t the proper term but not sure how else to describe it.  Can you explain why this is dangerous and what principles it would violate?"}, {"owner": {"reputation": 954, "user_id": 1771495, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c89c739400ad9b6eb5237c760db4ab40?s=128&d=identicon&r=PG", "display_name": "Tetiana Chupryna", "link": "https://stackoverflow.com/users/1771495/tetiana-chupryna"}, "reply_to_user": {"reputation": 292, "user_id": 1487479, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1aa899e9772cdd977b9d0f60e1ba9daf?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1487479/nathan"}, "edited": false, "score": 0, "creation_date": 1420754982, "post_id": 27821709, "comment_id": 44104883, "body": "It&#39;s dangerous because the method Word.is_a_quote relies on supposition then there are some object of Sentence class and it has a parameter @is_a_quote. But what this method return if we delete @is_a_quote from Sentence class or simply try to execute a piece of code that I wrote in my answer? The encapsulation is violated totally. If you want a method `is_a_quote? you have to declare it in the Sentence class at in the most logical place."}], "tags": [], "owner": {"reputation": 954, "user_id": 1771495, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c89c739400ad9b6eb5237c760db4ab40?s=128&d=identicon&r=PG", "display_name": "Tetiana Chupryna", "link": "https://stackoverflow.com/users/1771495/tetiana-chupryna"}, "is_accepted": false, "score": 0, "last_activity_date": 1420641111, "last_edit_date": 1495542508, "creation_date": 1420641111, "answer_id": 27821709, "question_id": 27815073, "link": "https://stackoverflow.com/questions/27815073/navigating-up-ruby-objects/27821709#27821709", "title": "Navigating up Ruby Objects", "body": "<p>First of all, your classes aren't nested. They should be declared inside each other.</p>\n\n<pre><code>class Paragraph \n  @page_number = #1 (default)\n  @sentences = []\n\n    class Sentence\n      @is_a_quote = #false (default)\n      @words = []\n\n        class Word\n          @text =# \"ruby\"\n          @type =# :noun \n        end\n    end\nend\n</code></pre>\n\n<p>But unlike in Java in Ruby you can't access variables of outer class from inner one. <a href=\"https://stackoverflow.com/questions/9788584/ruby-constants-and-nested-classes\">Ruby Constants and Nested Classes</a>\nAnd it's better to use modules than nested classes.</p>\n\n<p>But if you still want to use same hierarchy as in your example be aware of accessing data that is outside your class.\nFor example, you'll get an error if you try to execute this piece of code</p>\n\n<pre><code>class Word\n  @text =# \"ruby\"\n  @type =# :noun \n\n  def in_a_quote?\n    #... return Sentence.@is_a_quote \n  end\nend\n\nw = Word.new\nw.is_a_quote?  \n</code></pre>\n\n<p>This is very dangerous and contradicts to OOP principles. </p>\n"}], "owner": {"reputation": 292, "user_id": 1487479, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1aa899e9772cdd977b9d0f60e1ba9daf?s=128&d=identicon&r=PG", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1487479/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 27815235, "answer_count": 2, "score": 0, "last_activity_date": 1420662618, "creation_date": 1420618758, "last_edit_date": 1420662618, "question_id": 27815073, "link": "https://stackoverflow.com/questions/27815073/navigating-up-ruby-objects", "title": "Navigating up Ruby Objects", "body": "<p>Navigating down inside ruby objects is pretty straight forward.  Given the following pseudo code, and using this paragraph as example input, the following calls makes sense and works:</p>\n\n<pre><code>forth_word = Par.sentence[0].word[3]\nputs forth_word.text #\"ruby\"\nputs forth_word.type #:noun\n</code></pre>\n\n<p>Pseudo code of classes that are contained within each other: (sort of nested but not in strict OOP sense) </p>\n\n<pre><code>class Paragraph \n  @page_number = #1 (default)\n  @sentences = []\nend\n\nclass Sentence\n  @is_a_quote = #false (default)\n  @words = []\nend\n\nclass Word\n  @text =# \"ruby\"\n  @type =# :noun \n\n  def in_a_quote?\n    #... return Sentence.@is_a_quote \n  end\n\n  def on_page\n    #... return Paragraph.Sentence.page\n  end\nend\n</code></pre>\n\n<p>The tricky part becomes when I try to navigating up Ruby object tree...aka ask about from information from inside Word that belongs to Sentence or Paragraph objects.  Any suggestion how I could code the last 2 methods: </p>\n\n<pre><code>puts forth_word.in_a_quote  #false\nputs forth_word.on_page     #1\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec"], "comments": [{"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420619449, "post_id": 27815020, "comment_id": 44036816, "body": "Is the column available while you are using in your Rails console?"}, {"owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "reply_to_user": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420619617, "post_id": 27815020, "comment_id": 44036903, "body": "@ArupRakshit, shouldn&#39;t I reload a schema for the tests somehow?"}, {"owner": {"reputation": 2734, "user_id": 1657639, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/94504d99f1d8559e8cb58591ee42a34b?s=128&d=identicon&r=PG", "display_name": "mr rogers", "link": "https://stackoverflow.com/users/1657639/mr-rogers"}, "edited": false, "score": 0, "creation_date": 1420620519, "post_id": 27815020, "comment_id": 44037306, "body": "Did you run <code>rake db:test:prepare</code>?  Depending on which version of Rails you are using, this might not be necessary, but if you think the test schema is not up to date, maybe that&#39;s the issue."}, {"owner": {"reputation": 109029, "user_id": 2767755, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BkC8q.jpg?s=128&g=1", "display_name": "Arup Rakshit", "link": "https://stackoverflow.com/users/2767755/arup-rakshit"}, "edited": false, "score": 0, "creation_date": 1420621366, "post_id": 27815020, "comment_id": 44037723, "body": "I meant to test in Rails console in Test environment. :-)"}, {"owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "reply_to_user": {"reputation": 2734, "user_id": 1657639, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/94504d99f1d8559e8cb58591ee42a34b?s=128&d=identicon&r=PG", "display_name": "mr rogers", "link": "https://stackoverflow.com/users/1657639/mr-rogers"}, "edited": false, "score": 0, "creation_date": 1420624354, "post_id": 27815020, "comment_id": 44039380, "body": "@mrrogers, the tags say what version of Rails I&#39;m using."}, {"owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "reply_to_user": {"reputation": 2734, "user_id": 1657639, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/94504d99f1d8559e8cb58591ee42a34b?s=128&d=identicon&r=PG", "display_name": "mr rogers", "link": "https://stackoverflow.com/users/1657639/mr-rogers"}, "edited": false, "score": 0, "creation_date": 1420625912, "post_id": 27815020, "comment_id": 44040298, "body": "@mrrogers, it helped."}, {"owner": {"reputation": 280, "user_id": 3629623, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/nITcO.jpg?s=128&g=1", "display_name": "Subomi", "link": "https://stackoverflow.com/users/3629623/subomi"}, "edited": false, "score": 0, "creation_date": 1550599810, "post_id": 27815020, "comment_id": 96325010, "body": "I was faced with this issue, and I solved it by running: ` bin/rails db:schema:load RAILS_ENV=test` It worked for me because the code was working in my dev env but not in my test env."}], "answers": [{"comments": [{"owner": {"reputation": 982, "user_id": 1657686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58cb9814dca3dbfe87aca51a7417e1a?s=128&d=identicon&r=PG", "display_name": "0xtobit", "link": "https://stackoverflow.com/users/1657686/0xtobit"}, "edited": false, "score": 1, "creation_date": 1426536168, "post_id": 27815463, "comment_id": 46404650, "body": "I&#39;m having a similar problem to OP and this did not solve it for me :-/"}, {"owner": {"reputation": 857, "user_id": 2232620, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/843451a0b102eb186b3494e6a009e9e1?s=128&d=identicon&r=PG", "display_name": "Coherent", "link": "https://stackoverflow.com/users/2232620/coherent"}, "edited": false, "score": 1, "creation_date": 1427058471, "post_id": 27815463, "comment_id": 46612056, "body": "I am having the same problem, rspec is not letting me do a failing test for a bad enum type.  It works fine for nil though."}], "tags": [], "owner": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "is_accepted": false, "score": 5, "last_activity_date": 1420620292, "creation_date": 1420620292, "answer_id": 27815463, "question_id": 27815020, "link": "https://stackoverflow.com/questions/27815020/rspec-cant-write-unknown-attribute-enum/27815463#27815463", "title": "RSpec - can&#39;t write unknown attribute (enum)", "body": "<p>It sounds like your test database has not been migrated properly. \nTry running the following command: </p>\n\n<pre><code>bundle exec rake db:migrate RAILS_ENV=test\n</code></pre>\n\n<p>.. and then try to run rspec again.</p>\n"}], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1307, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1420620292, "creation_date": 1420618561, "last_edit_date": 1420619178, "question_id": 27815020, "link": "https://stackoverflow.com/questions/27815020/rspec-cant-write-unknown-attribute-enum", "title": "RSpec - can&#39;t write unknown attribute (enum)", "body": "<p>The model User:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  enum my_enum: [\n    :some_value1,\n    #....\n  ] \n</code></pre>\n\n<p>Also I have a migration which adds <code>my_enum</code> to User:</p>\n\n<pre><code>def change\n  add_column :users, :my_enum, :integer\nend\n</code></pre>\n\n<p>And the fixture for FactoryGirl:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    email { Faker::Internet.email }\n    password { Faker::Internet.password(10) }\n    password_confirmation { password }\n    my_enum { nil }\n  end \nend\n</code></pre>\n\n<p>Everything works fine.  But when I run a test, I get an error: </p>\n\n<pre><code>Failure/Error: paid_user = FactoryGirl.create(:user)\n     ActiveModel::MissingAttributeError:\n       can't write unknown attribute `my_enum`\n</code></pre>\n"}, {"tags": ["ruby", "regex", "editor", "sublimetext2", "textmate"], "comments": [{"owner": {"reputation": 2873, "user_id": 1929959, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/be7c8d8d01d02c41df25100e7f294234?s=128&d=identicon&r=PG", "display_name": "Mihai8", "link": "https://stackoverflow.com/users/1929959/mihai8"}, "edited": false, "score": 1, "creation_date": 1420654799, "post_id": 27814996, "comment_id": 44057661, "body": "some of best editor you can see in <a href=\"http://stackoverflow.com/questions/16991/what-ruby-ide-do-you-prefer\" title=\"what ruby ide do you prefer\">stackoverflow.com/questions/16991/what-ruby-ide-do-you-prefe&zwnj;&#8203;r</a>."}], "answers": [{"comments": [{"owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "edited": false, "score": 0, "creation_date": 1420652361, "post_id": 27816324, "comment_id": 44056338, "body": "looks interesting, but unfortunately only for Emacs. When I find another solution, I&#39;ll post it here"}], "tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": false, "score": 1, "last_activity_date": 1420654359, "last_edit_date": 1420654359, "creation_date": 1420623365, "answer_id": 27816324, "question_id": 27814996, "link": "https://stackoverflow.com/questions/27814996/advanced-search-in-texteditor-over-whole-project/27816324#27816324", "title": "Advanced search in texteditor over whole project", "body": "<blockquote>\n  <p>Is this possible in any editor?</p>\n</blockquote>\n\n<p>Yes. For example, take a look at Emacs with Robe: <a href=\"https://github.com/dgutov/robe\" rel=\"nofollow\">https://github.com/dgutov/robe</a></p>\n"}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1420654359, "creation_date": 1420618423, "question_id": 27814996, "link": "https://stackoverflow.com/questions/27814996/advanced-search-in-texteditor-over-whole-project", "title": "Advanced search in texteditor over whole project", "body": "<p>I'm looking for a way to do searches over all files in a project (ruby) like</p>\n\n<ul>\n<li>search for all class methods (they could begin with <code>def self.</code>, but also be nested inside a <code>class &lt;&lt; self</code>)</li>\n<li>search for class instance variables (<code>@foobar</code> defined at class level)</li>\n<li>search for instance variables (<code>@foobar</code> defined on instance level)</li>\n</ul>\n\n<p>Is this possible in any editor? I'm using textmate and sublime but haven't seen any advanced searches like this. I know regex would be a starting point, but most of the time it's a time consuming, \"I'm not sure if it really works\" issue.</p>\n"}, {"tags": ["ruby", "cryptography", "bit-manipulation", "bitwise-xor"], "comments": [{"owner": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 0, "creation_date": 1420617786, "post_id": 27814716, "comment_id": 44036246, "body": "I&#39;ve looked into <code>ord</code>, which seems like it may be what i need to use to get this working, but after reading about it and trying to implement it, I could not get it working."}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 0, "creation_date": 1420644392, "post_id": 27815999, "comment_id": 44051184, "body": "Thank you! I was able to get it working by changing <code>result</code> in <code>to_hex_array</code> to <code>result = str_hex.unpack(&#39;C*&#39;)</code>, then in <code>xor</code> I changed the final <code>xor</code> variable to <code>xor = xor.pack(&#39;C*&#39;).unpack(&#39;H*&#39;)</code>, which worked. However, I would like <code>to_hex_array</code> to return an array where each index position held a hex value, not a dec value, which <code>C*</code> returns (but returns as an array of individual indices, whereas <code>H*</code> returns an array of a single value, the entire hex string). Does that make sense?"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 0, "creation_date": 1420647365, "post_id": 27815999, "comment_id": 44053275, "body": "an array of integers is neither decimal or hexadecimal - that&#39;s just how ruby chooses to print it to the screen"}, {"owner": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 0, "creation_date": 1420650272, "post_id": 27815999, "comment_id": 44055099, "body": "What I mean is that <code>unpack(&#39;C*&#39;)</code> returns to me an array that looks like <code>[&#39;75&#39;, &#39;36&#39;, &#39;72&#39;, &#39;101&#39;], and </code>unpack(&#39;H*&#39;)` returns to me an array that looks like <code>[&#39;6e32010a&#39;]</code>. I would like the hex representation returned to me as individual indices in the array such that the previous array becomes <code>[&#39;6e&#39;, &#39;32&#39;, &#39;01&#39;, &#39;0a&#39;]</code>. But manipulating the hex array to split up its indices converts the values to strings, and I return to my original problem with XOR"}, {"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "reply_to_user": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 1, "creation_date": 1420656596, "post_id": 27815999, "comment_id": 44058742, "body": "Crucial difference - <code>&quot;hi&quot;.unpack(&#39;C*&#39;)</code> returns returns [104,105] not [&#39;104&#39;, &#39;105&#39;] (array of integers not strings). You don&#39;t need to convert them to hexadecimal"}, {"owner": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "edited": false, "score": 0, "creation_date": 1420663341, "post_id": 27815999, "comment_id": 44062444, "body": "Thank you! That cracked it for me. I didn&#39;t notice that <code>unpack(&#39;C*&#39;)</code> wasn&#39;t returning string indices."}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 2, "last_activity_date": 1420622324, "creation_date": 1420622324, "answer_id": 27815999, "question_id": 27814716, "link": "https://stackoverflow.com/questions/27814716/ruby-xor-bit-wise-manipulation-cryptography-exercise/27815999#27815999", "title": "Ruby XOR bit wise manipulation cryptography exercise", "body": "<p>In your <code>to_hex_array</code> method you shouldn't be converting the bytes to strings (your call to <code>to_s 16</code>) - that's why you end up trying to xor strings rather than integers</p>\n\n<p>That does mean that your <code>xor</code> method will need an extra step to turn the result from an array of integers to a string - something like</p>\n\n<pre><code>array_of_integers.map {|int| int.to_s(16)}.join\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 3720611, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/22a99a039dae9c9ca11d9ae65bb10a24?s=128&d=identicon&r=PG&f=1", "display_name": "artis3n", "link": "https://stackoverflow.com/users/3720611/artis3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 1, "accepted_answer_id": 27815999, "answer_count": 1, "score": 2, "last_activity_date": 1420663296, "creation_date": 1420617055, "last_edit_date": 1420663296, "question_id": 27814716, "link": "https://stackoverflow.com/questions/27814716/ruby-xor-bit-wise-manipulation-cryptography-exercise", "title": "Ruby XOR bit wise manipulation cryptography exercise", "body": "<p>I am trying to convert a message into a ASCII hex value string and back again. However, I am having a lot of trouble with my ^ bit wise XOR operator. I've spent the last 4 hours searching stackoverflow's similar questions on XOR and bit wise manipulation, but no suggestion I've seen has fixed this issue yet.</p>\n\n<p>I have a RakeTest file, which the following made up test:</p>\n\n<pre><code>def test_xor\n    key = 'hi'\n    msg = 'Hello There, how are you?'\n    key_trunc = key\n    key_trunc &lt;&lt; key while key.length &lt; msg.length\n    key_trunc = Decrypt.truncate_key key_trunc, msg.length\n\n    ct = Decrypt.xor msg, key_trunc\n    assert_equal('200c040507493c010d1b0d454801071e48081a0c4810071c57', ct)\nend\n</code></pre>\n\n<p>I've worked out by hand (and verified with an online hex converter) that the correct ASCII hex result should be what is above. Here is my Decrypt module:</p>\n\n<pre><code>module Decrypt\n\n  # Returns an array of ASCII Hex values\n  def self.to_hex_array(str_hex)\n    raise ArgumentError 'Argument is not a string.' unless str_hex.is_a? String\n\n    result = str_hex.unpack('C*').map { |e| e.to_s 16 }\n\n    result\n  end\n\n  def self.to_str_from_hex_array(hex_str)\n    return [hex_str].pack 'H*'\n  end\n\n  def self.xor(msg, key)\n\n    msg = self.to_hex_array msg\n    key = self.to_hex_array key\n    xor = []\n\n    (0...msg.length).each do |i|\n      xor.push msg[i] ^ key[i]\n    end\n\n    return xor.join\n  end\n\n  def self.truncate_key(str, len)\n    str = str.to_s[0...len] if str.length &gt; len\n\n    return str\n\n  end\n\nend\n</code></pre>\n\n<p>I've confirmed in two separate rake test functions that <code>to_hex_array</code> and <code>to_str_from_hex_array</code> are working correctly. When I run the above rake test, I get a <code>'NoMethodError: undefined method '^' for \"48\":String</code>. 48 is the beginning hex value, and obviously Strings cannot undergo bit wise operations, but I have tried every method I could find to convert the values such that '^' will operate correctly.</p>\n\n<p>The closest I can get (no error thrown) is to change the operation inside the loop to <code>msg[i].hex ^ key[i].hex</code>, but that outputs an ASCII dec value.Can anyone help me out?</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Thanks to the suggestions below, I am able to run the following tests successfully:</p>\n\n<pre><code>def test_xor\n    key = 'hi'\n    msg = 'Hello There, how are you?'\n    key_trunc = key\n    key_trunc &lt;&lt; key while key.length &lt; msg.length\n    key_trunc = Decrypt.truncate key_trunc, msg.length\n\n    ct = Decrypt.xor msg, key_trunc\n    assert_equal(['200c040507493c010d1b0d454801071e48081a0c4810071c57'], ct)\nend\n\ndef test_decrypt\n    msg = 'attack at dawn'\n    key = '6c73d5240a948c86981bc294814d'\n    key = [key].pack('H*')\n\n    new_key = Decrypt.xor msg, key\n    assert_equal(['0d07a14569fface7ec3ba6f5f623'], new_key)\n    ct = Decrypt.xor 'attack at dusk', new_key.pack('H*')\n    assert_equal(['6c73d5240a948c86981bc2808548'], ct)\nend\n</code></pre>\n\n<p>For those interested, here is the successful Decrypt module:</p>\n\n<pre><code>module Decrypt\n\n  # Returns an array of ASCII Hex values\n  def self.to_dec_array(str_hex)\n    raise ArgumentError, 'Argument is not a string!' unless str_hex.is_a? String\n\n    dec_array = str_hex.unpack('C*')\n\n    dec_array\n  end\n\n  def self.to_str_from_dec_array(dec_array)\n    raise ArgumentError, 'Argument is not an array!' unless dec_array.is_a? Array\n\n    return dec_array.pack 'C*'\n  end\n\n  def self.print_dec_array(dec_array)\n    return [dec]\n  end\n\n  def self.xor(msg, key)\n\n    msg = self.to_dec_array msg\n    key = self.to_dec_array key\n    xor = []\n\n    (0...msg.length).each do |i|\n      xor.push msg[i] ^ key[i]\n    end\n\n    xor = xor.pack('C*').unpack('H*')\n\n    xor\n  end\n\n  def self.truncate(str, len)\n    str = str.to_s[0...len] if str.length &gt; len\n\n    return str\n\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 16396, "user_id": 2564298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BhG1x.jpg?s=128&g=1", "display_name": "Rajdeep Singh", "link": "https://stackoverflow.com/users/2564298/rajdeep-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1420617718, "last_edit_date": 1420617718, "creation_date": 1420616589, "answer_id": 27814619, "question_id": 27814581, "link": "https://stackoverflow.com/questions/27814581/ruby-hash-to-another-hash-with-certain-keys/27814619#27814619", "title": "Ruby hash to another hash with certain keys", "body": "<p>You can do like this</p>\n\n<pre><code>hash_array = [{\"user_id\"=&gt;\"4672046155508aafb4d01bca27cca8c6\", \"email\"=&gt;\"xxxxxxxxxx@gmail.com\", \"sport\"=&gt;[nil]}, {\"user_id\"=&gt;\"007ba6fd74b3ef3c12734ddd0f2280ae\", \"email\"=&gt;\"xxxxxxxx@yahoo.com\", \"sport\"=&gt;[nil, nil, nil, nil]}, {\"user_id\"=&gt;\"0085e4d74738a384e10042b62acb56e2\", \"email\"=&gt;\"xxxxxxxxxx@gmail.com\", \"sport\"=&gt;[nil, nil, nil]}]\nhash_array.map{ |hash| hash[\"email\"] }\n</code></pre>\n\n<p>It will return an array of all the emails</p>\n"}, {"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 0, "last_activity_date": 1420616609, "creation_date": 1420616609, "answer_id": 27814622, "question_id": 27814581, "link": "https://stackoverflow.com/questions/27814581/ruby-hash-to-another-hash-with-certain-keys/27814622#27814622", "title": "Ruby hash to another hash with certain keys", "body": "<p>It isn't hash, it's an array of hashes. To access first hash <code>email</code>, you can do:</p>\n\n<pre><code>users.first['email']\n</code></pre>\n"}], "owner": {"reputation": 598, "user_id": 3522082, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/73aaa074502f78ed1d5556458ccc2037?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/3522082/navin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 27814619, "answer_count": 2, "score": 0, "last_activity_date": 1420617718, "creation_date": 1420616420, "question_id": 27814581, "link": "https://stackoverflow.com/questions/27814581/ruby-hash-to-another-hash-with-certain-keys", "title": "Ruby hash to another hash with certain keys", "body": "<p>I have a hash like this</p>\n\n<pre><code>[{\"user_id\"=&gt;\"4672046155508aafb4d01bca27cca8c6\", \"email\"=&gt;\"xxxxxxxxxx@gmail.com\", \"sport\"=&gt;[nil]}, {\"user_id\"=&gt;\"007ba6fd74b3ef3c12734ddd0f2280ae\", \"email\"=&gt;\"xxxxxxxx@yahoo.com\", \"sport\"=&gt;[nil, nil, nil, nil]}, {\"user_id\"=&gt;\"0085e4d74738a384e10042b62acb56e2\", \"email\"=&gt;\"xxxxxxxxxx@gmail.com\", \"sport\"=&gt;[nil, nil, nil]}]\n</code></pre>\n\n<p>I need a hash with all email in it , How to do this?...whenever I use</p>\n\n<pre><code>  users[:email]\n</code></pre>\n\n<p>It gives the error cannot convert symbol to integer</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1420616544, "post_id": 27814564, "comment_id": 44035826, "body": "No, not really - especially <code>Float#+</code> is different than <code>Integer#+</code> and both are different than <code>Array#+</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5961, "user_id": 2328259, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7f760bec40648f4bda5855cd854612e?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2328259/david"}, "edited": false, "score": 0, "creation_date": 1420621108, "post_id": 27815102, "comment_id": 44037577, "body": "While this probably suffices for the OP, it should be noted that this just shows which classes actually have the <code>+</code> method. It does not guarantee the same functionality!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5961, "user_id": 2328259, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7f760bec40648f4bda5855cd854612e?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2328259/david"}, "edited": false, "score": 0, "creation_date": 1420621521, "post_id": 27815102, "comment_id": 44037799, "body": "@David I definitely noted it with \u201cactually guarantees nothing\u201d preceeding the snippet :)"}, {"owner": {"reputation": 57, "user_id": 1707018, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ckQze.jpg?s=128&g=1", "display_name": "Sai Prashanth", "link": "https://stackoverflow.com/users/1707018/sai-prashanth"}, "edited": false, "score": 0, "creation_date": 1420621536, "post_id": 27815102, "comment_id": 44037809, "body": "I know that their functionality differs based on which classes they are used with. But I just wanted to see which classes any method can be used upon."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1420618870, "creation_date": 1420618870, "answer_id": 27815102, "question_id": 27814564, "link": "https://stackoverflow.com/questions/27814564/how-do-you-get-the-list-of-objects-on-which-a-method-can-be-called/27815102#27815102", "title": "How do you get the list of objects on which a method can be called?", "body": "<p>There is a hack which actually guarantees nothing, but you might want to try:</p>\n\n<pre><code>\u25b6 ObjectSpace.each_object.select { |obj| \n    Class === obj &amp;&amp; obj.instance_methods.include?(:+) \n  }\n#=&gt; [\n#  [0] Complex &lt; Numeric,\n#  [1] Rational &lt; Numeric,\n#  [2] Time &lt; Object,\n#  [3] Array &lt; Object,\n#  [4] Bignum &lt; Integer,\n#  [5] Float &lt; Numeric,\n#  [6] Fixnum &lt; Integer,\n#  [7] String &lt; Object,\n#  [8] Pathname &lt; Object,\n#  [9] CodeRay::Tokens &lt; Array\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1707018, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ckQze.jpg?s=128&g=1", "display_name": "Sai Prashanth", "link": "https://stackoverflow.com/users/1707018/sai-prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 27815102, "answer_count": 1, "score": 0, "last_activity_date": 1420618870, "creation_date": 1420616368, "last_edit_date": 1420618335, "question_id": 27814564, "link": "https://stackoverflow.com/questions/27814564/how-do-you-get-the-list-of-objects-on-which-a-method-can-be-called", "title": "How do you get the list of objects on which a method can be called?", "body": "<p>Is there a method like <code>+.method</code> which can give a list of classes on which <code>+</code> can be called upon?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "asset-pipeline", "content-for"], "comments": [{"owner": {"reputation": 3053, "user_id": 800526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a475dddebda57b162fa9378363175e81?s=128&d=identicon&r=PG", "display_name": "Thong Kuah", "link": "https://stackoverflow.com/users/800526/thong-kuah"}, "edited": false, "score": 2, "creation_date": 1420616553, "post_id": 27814500, "comment_id": 44035833, "body": "Are you familiar with <a href=\"http://api.rubyonrails.org/classes/ActionController/Streaming.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActionController/Streaming.html</a> ?"}, {"owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "reply_to_user": {"reputation": 3053, "user_id": 800526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a475dddebda57b162fa9378363175e81?s=128&d=identicon&r=PG", "display_name": "Thong Kuah", "link": "https://stackoverflow.com/users/800526/thong-kuah"}, "edited": false, "score": 0, "creation_date": 1420617160, "post_id": 27814500, "comment_id": 44036036, "body": "Honestly, no before you mention it. I just took a look at the ref you shared, and it is excellent. Never knew that by default Rails load template before layout! So streaming is the way to revert this order. Then..?"}, {"owner": {"reputation": 3053, "user_id": 800526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a475dddebda57b162fa9378363175e81?s=128&d=identicon&r=PG", "display_name": "Thong Kuah", "link": "https://stackoverflow.com/users/800526/thong-kuah"}, "edited": false, "score": 0, "creation_date": 1420617305, "post_id": 27814500, "comment_id": 44036094, "body": "That&#39;s just how it&#39;s implemented, the main advantage of streaming is to enable parts of the page (especially header JS) to be streamed back to the browser when it&#39;s ready, rather than waiting for the whole page."}, {"owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "reply_to_user": {"reputation": 3053, "user_id": 800526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a475dddebda57b162fa9378363175e81?s=128&d=identicon&r=PG", "display_name": "Thong Kuah", "link": "https://stackoverflow.com/users/800526/thong-kuah"}, "edited": false, "score": 0, "creation_date": 1420618710, "post_id": 27814500, "comment_id": 44036553, "body": "It sounds better. But what then does the &quot;buffer&quot; there mean? &quot;...concatenate several times to the same buffer when rendering a given template...&quot; It would also be great if you can write it in the answer so I can vote you up or accept the answer to reward you. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 5713, "user_id": 207605, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3f7cfb0f49eb12a666c9ba880d450d67?s=128&d=identicon&r=PG", "display_name": "rtfminc", "link": "https://stackoverflow.com/users/207605/rtfminc"}, "is_accepted": false, "score": 7, "last_activity_date": 1430823444, "last_edit_date": 1495540044, "creation_date": 1430823444, "answer_id": 30051083, "question_id": 27814500, "link": "https://stackoverflow.com/questions/27814500/ruby-on-rails-provide-vs-content-for/30051083#30051083", "title": "Ruby on Rails: provide vs content_for", "body": "<p>Was curious to see what the difference was, and as <a href=\"https://stackoverflow.com/users/800526/thong-kuah\">Thong Kuah</a> pointed to the api, inside the answer:</p>\n\n<blockquote>\n  <p>This means that, if you have yield :title in your layout and you want to use streaming, you would have to render the whole template (and eventually trigger all queries) before streaming the title and all assets, which kills the purpose of streaming. For this reason Rails 3.1 introduces a new helper called provide that does the same as content_for but tells the layout to stop searching for other entries and continue rendering.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 690, "user_id": 1129025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4117d9f1cd22f830532708ab2c4f9c?s=128&d=identicon&r=PG", "display_name": "mmtootmm", "link": "https://stackoverflow.com/users/1129025/mmtootmm"}, "edited": false, "score": 2, "creation_date": 1495788306, "post_id": 32766186, "comment_id": 75407571, "body": "<code>provide</code> also <i>append</i> contents in <code>view_flow</code>. only way to overwrite contents for key is using <code>content_for</code> with option <code>flush: true</code>."}], "tags": [], "owner": {"reputation": 2051, "user_id": 2359793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f7ce5d16560db19111463af1241b294?s=128&d=identicon&r=PG", "display_name": "rodamn", "link": "https://stackoverflow.com/users/2359793/rodamn"}, "is_accepted": true, "score": 27, "last_activity_date": 1443112000, "last_edit_date": 1443112000, "creation_date": 1443111181, "answer_id": 32766186, "question_id": 27814500, "link": "https://stackoverflow.com/questions/27814500/ruby-on-rails-provide-vs-content-for/32766186#32766186", "title": "Ruby on Rails: provide vs content_for", "body": "<p><strong>First of all, what is streaming? Why would you use it?</strong></p>\n\n<p>Streaming is alternate method of rendering pages top-down (outside-in). The default rendering behavior is inside-out. Streaming must be enabled in your controller:</p>\n\n<pre><code>class MyController\n  def action\n    render stream: true # Streaming enabled\n  end\nend\n</code></pre>\n\n<p>According to the <a href=\"http://api.rubyonrails.org/classes/ActionController/Streaming.html\">documentation</a>:</p>\n\n<blockquote>\n  <p>Streaming may be considered to be overkill for lightweight actions\n  like new or edit. The real benefit of streaming is on expensive\n  actions that, for example, do a lot of queries on the database.</p>\n</blockquote>\n\n<p><strong>So, if you're not using streaming, is there still a difference?</strong></p>\n\n<p>Yes.</p>\n\n<p>The difference is a template can define <strong>multiple content blocks</strong> by calling <code>content_for</code> multiple times. Doing so will concatenate the blocks and pass that to the layout:</p>\n\n<pre><code># layout.html.erb\n&lt;div class=\"heading\"&gt;&lt;%= yield :surprise %&gt;&lt;/div&gt;\n&lt;div class=\"body\"&gt;\n   &lt;p&gt;&lt;%= yield %&gt;&lt;/p&gt;\n   &lt;p&gt;But it's not very interesting...&lt;/p&gt;\n&lt;/div&gt;\n\n# template.html.erb\n&lt;%= content_for :surprise, \"Hello\" %&gt;\nI've got your content!\n&lt;%= content_for :surprise, \", World!\" %&gt;\n\n# Generated HTML\n&lt;div class=\"heading\"&gt;Hello, World!&lt;/div&gt;\n&lt;div class=\"body\"&gt;\n   &lt;p&gt;I've got your content!&lt;/p&gt;\n   &lt;p&gt;But it's not very interesting...&lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Since <code>provide</code> <strong>doesn't continue searching</strong> the provided template, only the block passed to the first <code>provide</code> call will be sent to the template:</p>\n\n<pre><code># layout.html.erb\n&lt;div class=\"heading\"&gt;&lt;%= yield :title %&gt;&lt;/div&gt;\n\n# template.html.erb\n&lt;%= provide :title, \"Foo\" %&gt;\n&lt;%= provide :title, \"bar\" %&gt;\n\n# Generated HTML\n&lt;div class=\"heading\"&gt;Foo&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6641, "favorite_count": 9, "accepted_answer_id": 32766186, "answer_count": 2, "score": 28, "last_activity_date": 1443112000, "creation_date": 1420616097, "question_id": 27814500, "link": "https://stackoverflow.com/questions/27814500/ruby-on-rails-provide-vs-content-for", "title": "Ruby on Rails: provide vs content_for", "body": "<p>I came across the view helper function \"provide\" today. By looking into its manual I am still confused on how it is different from \"content_for\".</p>\n\n<blockquote>\n  <p>provide(name, content = nil, &amp;block)</p>\n  \n  <p>The same as content_for but when used with streaming flushes straight\n  back to the layout. In other words, if you want to concatenate several\n  times to the same buffer when rendering a given template, you should\n  use content_for, if not, use provide to tell the layout to stop\n  looking for more contents.</p>\n</blockquote>\n\n<p>Question 1: this is quite abstract to me - could anyone flesh it out by giving a demonstrative example?</p>\n\n<p>Question 2: working with asset pipeline, which performs better and why?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1420620621, "post_id": 27815069, "comment_id": 44037362, "body": "hi, Thank you, this is the answer I need, exactly this &#39;eval&#39; function is what I was searching!!"}], "tags": [], "owner": {"reputation": 131, "user_id": 2279134, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aaba63c4c6d825069a22b3a7ccc9fd5a?s=128&d=identicon&r=PG", "display_name": "Tobias Edwards", "link": "https://stackoverflow.com/users/2279134/tobias-edwards"}, "is_accepted": false, "score": 0, "last_activity_date": 1420618744, "creation_date": 1420618744, "answer_id": 27815069, "question_id": 27814430, "link": "https://stackoverflow.com/questions/27814430/need-to-convert-string-into-hash-and-then-hash-into-string/27815069#27815069", "title": "Need to convert string into hash and then Hash into string", "body": "<p>\nI am not quite sure what the format of your string would be from your question but I will assume you mean a string containing a ruby literal Hash definition. For example:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>hash_string = \"{ 'id' =&gt; 3, 'name' =&gt; 'Fabricio' }\"\n</code></pre>\n\n<p>First of all it is best practice to define a method in ruby with arguments in parentheses:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def to_hash(string)\n  # Contents of method\nend\n</code></pre>\n\n<p>You can interpret the string as if you were defining it in a ruby file using <code>eval</code> (assuming the string is valid ruby syntax), and thus the function could look something like this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def to_hash(string)\n  eval(string)\nend\n\nhash = to_hash(\"{ 'id' =&gt; 3, 'name' =&gt; 'Fabricio' }\")\n\nputs hash['id'] # =&gt; 3\nputs hash['name'] # =&gt; \"Fabricio\"\n</code></pre>\n\n<p>I hope this is what you intended and is of some use to you.</p>\n"}], "owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1420618744, "creation_date": 1420615762, "last_edit_date": 1420618139, "question_id": 27814430, "link": "https://stackoverflow.com/questions/27814430/need-to-convert-string-into-hash-and-then-hash-into-string", "title": "Need to convert string into hash and then Hash into string", "body": "<p>I am passing an argument as shown below</p>\n\n<pre><code>def hi value\n\n   value=(here I need to convert back to Hash from string)\n\n   puts value['key']\n\nend\n\nhi \"h['key']\" #I am passing hash as string\n</code></pre>\n\n<p>I am passing Hash as string and I need to convert back to hash as I have shown above,Is it possible? The reason I am asking this is because the error handling part has to be performed within function.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "email", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 321, "user_id": 3501101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03c9796a9842bb63bbc7fc6438140029?s=128&d=identicon&r=PG&f=1", "display_name": "AlkH", "link": "https://stackoverflow.com/users/3501101/alkh"}, "edited": false, "score": 0, "creation_date": 1420650138, "post_id": 27814130, "comment_id": 44055007, "body": "Check your action_mailer setup for Google. May be you missed domain. E.g. our production setup includes next settings: domain (example@gmail.com), user_name (example), password."}], "owner": {"reputation": 135, "user_id": 4277479, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/2oQns.jpg?s=128&g=1", "display_name": "subhra", "link": "https://stackoverflow.com/users/4277479/subhra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 431, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1420614401, "creation_date": 1420614401, "question_id": 27814130, "link": "https://stackoverflow.com/questions/27814130/how-to-resolve-errnoeconnrefused-in-userscontrollercreate-error-in-ror", "title": "How to resolve Errno::ECONNREFUSED in UsersController#create error in ROR", "body": "<p>Can anybody help me to resolve this following error.I am trying to send an email but it failed to send and throws some error.</p>\n\n<p>Error:</p>\n\n<p>Errno::ECONNREFUSED in UsersController#create\nNo connection could be made because the target machine actively refused it. - connect(2)\napp/controllers/users_controller.rb:8:in `create'</p>\n\n<p>My code snippets are given below.</p>\n\n<p>views/users/index.html.erb</p>\n\n<pre><code>&lt;h1&gt;Send email to your friend&lt;/h1&gt;\n&lt;%= form_for @user,:url =&gt; {:action =&gt; 'create'} do |f| %&gt;\n    &lt;%= f.text_field:name,placeholder:\"Enter your name\" %&gt;&lt;br&gt;\n    &lt;%= f.email_field:email,placeholder:\"Enter your email\" %&gt;&lt;br&gt;\n    &lt;%= f.submit \"Send\" %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>views/users/new.html.erb</p>\n\n<pre><code>&lt;h1&gt;Successfully registered&lt;/h1&gt;\n</code></pre>\n\n<p>views/users/success.html.erb</p>\n\n<pre><code>&lt;h1&gt;Email sent successfully&lt;/h1&gt;\n</code></pre>\n\n<p>controller/users_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def index\n    @user=User.new\n  end\n  def create\n    @user=User.new(users_params)\n    if @user.save\n      UserMailer.registration_confirmation(@user).deliver\n      redirect_to :action =&gt; 'success'\n    else\n      render :'index'\n    end\n  end\n  def new\n\n  end\n  def success\n\n  end\n  private\n  def users_params\n    params.require(:user).permit(:name, :email)\n  end\nend\n</code></pre>\n\n<p>views/user_mailer/registration_confirmation.text.erb</p>\n\n<pre><code>&lt;%= @user.name%&gt;\n&lt;h1&gt;Thank you for registering&lt;/h1&gt;\nClick &lt;%= link_to \"here\",users_new_path %&gt;\n</code></pre>\n\n<p>mailer/user_mailer.rb</p>\n\n<pre><code>class UserMailer &lt; ApplicationMailer\n  default :from =&gt; \"w5call.w5rtc@gmail.com\"\n  def registration_confirmation(user)\n    @user=user\n    mail(:to =&gt; user.email, :subject =&gt; \"Registered\")\n  end\nend\n</code></pre>\n\n<p>config/initializers/setup_mail.rb</p>\n\n<pre><code>config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :user_name            =&gt; \"w5call.w5rtc@gmail.com\",\n    :password             =&gt; \"w5rtc123@\",\n    :authentication       =&gt; \"plain\",\n    :enable_starttls_auto =&gt; true\n}\n\nendActionMailer::Base.default_url_options[:host] = \"localhost:3000\"\n</code></pre>\n\n<p>development.rb</p>\n\n<pre><code>Rails.application.configure do\n  # Settings specified here will take precedence over those in config/application.rb.\n\n  # In the development environment your application's code is reloaded on\n  # every request. This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Do not eager load code on boot.\n  config.eager_load = false\n\n  # Show full error reports and disable caching.\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Don't care if the mailer can't send.\n  config.action_mailer.raise_delivery_errors = true\n\n  # Print deprecation notices to the Rails logger.\n  config.active_support.deprecation = :log\n\n  # Raise an error on page load if there are pending migrations.\n  config.active_record.migration_error = :page_load\n\n  # Debug mode disables concatenation and preprocessing of assets.\n  # This option may cause significant delays in view rendering with a large\n  # number of complex assets.\n  config.assets.debug = true\n\n  # Asset digests allow you to set far-future HTTP expiration dates on all assets,\n  # yet still be able to expire them through the digest params.\n  config.assets.digest = true\n\n  # Adds additional error checking when serving assets at runtime.\n  # Checks for improperly declared sprockets dependencies.\n  # Raises helpful error messages.\n  config.assets.raise_runtime_errors = true\n\n  # Raises error for missing translations\n  # config.action_view.raise_on_missing_translations = true\n  config.action_mailer.delivery_method = :smtp\n\n\n  end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n root 'users#index'\n  post \"users/create\" =&gt; \"users#create\"\n get \"users/success\" =&gt; \"users#success\"\n  get \"users/new\" =&gt; \"users#new\"\nend\n</code></pre>\n\n<p>Actually i was referring this <a href=\"http://railscasts.com/episodes/206-action-mailer-in-rails-3?view=asciicast\" rel=\"nofollow\">tutorial</a>.I am using rails-4 and ruby 1.9.3.Please help me to resolve this error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1401, "user_id": 2723934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/025a08b4c87bf427fffab6600dea6ae8?s=128&d=identicon&r=PG&f=1", "display_name": "miler350", "link": "https://stackoverflow.com/users/2723934/miler350"}, "is_accepted": true, "score": 4, "last_activity_date": 1420612175, "creation_date": 1420612175, "answer_id": 27813648, "question_id": 27813583, "link": "https://stackoverflow.com/questions/27813583/first-field-missing-from-view/27813648#27813648", "title": "First field missing from view", "body": "<p>Typo:</p>\n\n<pre><code>&lt;td &lt;%= @common_linker.cliche %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>&lt;td&gt; &lt;%= @common_linker.cliche %&gt;&lt;/td&gt;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4273344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DfexZ.jpg?s=128&g=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/4273344/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 27813648, "answer_count": 1, "score": 1, "last_activity_date": 1420612175, "creation_date": 1420611873, "question_id": 27813583, "link": "https://stackoverflow.com/questions/27813583/first-field-missing-from-view", "title": "First field missing from view", "body": "<p>The first field \"Cliche\" is refusing to be displayed, the \"description\" field is displaying correctly. Not sure what I am doing wrong. <img src=\"https://i.stack.imgur.com/NCD1a.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>common_linkers/show.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"table-responsive\"&gt;\n  &lt;table class=\"table\"&gt;\n    &lt;tbody&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;strong&gt;Cliche:&lt;/strong&gt;&lt;/td&gt;\n        &lt;td &lt;%= @common_linker.cliche %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;strong&gt;Description:&lt;/strong&gt;&lt;/td&gt;\n        &lt;td&gt; &lt;%= @common_linker.description %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;strong&gt;Created by:&lt;/strong&gt;&lt;/td&gt;\n         &lt;td&gt;&lt;%= @common_linker.user.email %&gt;&lt;/td&gt; \n      &lt;/tr&gt;\n</code></pre>\n\n<p><strong>common_linkers_controller.rb</strong></p>\n\n<pre><code>class CommonLinkersController &lt; ApplicationController\n  before_action :set_common_linker, only: [:show, :edit, :update, :destroy, :votes]\n  before_action :set_movie\n  before_action :authenticate_user!\n  respond_to :html\n\n  def index\n    @common_linkers = CommonLinker.all\n    respond_with(@common_linkers)\n  end\n\n  def show\n    @common_linker = CommonLinker.find(params[:id])\n  end\n\n   def vote\n      value = params[:type] == \"up\" ? 1 : -1\n     @common_linker = CommonLinker.find(params[:id])\n     @common_linker.add_or_update_evaluation(:votes, value, current_user)\n      redirect_to :back, notice: \"thanks for the vote\"\n   end\n\n\n  def new\n    @common_linker = CommonLinker.new\n    respond_with(@common_linker)\n  end\n\n  def edit\n  end\n\n  def create\n    @common_linker = CommonLinker.new(common_linker_params)\n    @common_linker.user_id = current_user.id\n    @common_linker.movie_id = @movie.id\n\n    if @common_linker.save\n        redirect_to @movie\n    else\n      render 'new'\n    end\n  end\n\n  def update\n    @common_linker.update(common_linker_params)\n    respond_with(@common_linker)\n  end\n\n  def destroy\n    @common_linker.destroy\n    respond_with(@common_linker)\n  end\n\n  private\n  def set_common_linker\n    @common_linker = CommonLinker.find(params[:id])\n    end\n\n   def set_movie\n      @movie = Movie.find(params[:movie_id])\n   end\n\n  def common_linker_params\n    params.require(:common_linker).permit(:cliche, :description)\n    end\nend\n</code></pre>\n\n<p><strong>common_linker.rb</strong></p>\n\n<pre><code>class CommonLinker &lt; ActiveRecord::Base\n   belongs_to :user\n   belongs_to :movie\n\n   has_reputation :votes, source: :user, aggregated_by: :sum\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n\n  devise_for :users\n  resources :movies do \n   resources :common_linkers do\n      member { post :vote }\n\n     end\n  end\n   root 'movies#index'\n\n\nend\n</code></pre>\n\n<p>I am still learning, but I feel like I am missing something big here. Any help would be great. Thanks in advance. </p>\n"}, {"tags": ["ruby", "xpath"], "comments": [{"owner": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "edited": false, "score": 0, "creation_date": 1420619981, "post_id": 27813438, "comment_id": 44037053, "body": "Are you using any framework? As far as I can tell you have some syntax errors in your code and also you are not telling us what the method/variable <code>span</code> is in your context."}, {"owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "reply_to_user": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "edited": false, "score": 0, "creation_date": 1420680293, "post_id": 27813438, "comment_id": 44068941, "body": "I am using ruby/selenium/watir."}, {"owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "reply_to_user": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "edited": false, "score": 0, "creation_date": 1420775571, "post_id": 27813438, "comment_id": 44111070, "body": "span \t:personal_details_name, xpath: &#39;//div[@class=&quot;your-details-inner&quot;]/ul[@class=&quot;your-details_&zwnj;&#8203;_list&quot;][1]/li/span[c&zwnj;&#8203;ontains(data-bind, name)]&#39;  def verify_personal_details first_name, last_name, mobile_number, email \t\tpersonal_details_name_element.text=first_name+&quot; &quot;+last_name end   it gives me an error: undefined method `text=&#39; for #&lt;Watir::Span:0x42e3580&gt; (NoMethodError)"}], "owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420611247, "creation_date": 1420611164, "last_edit_date": 1420611247, "question_id": 27813438, "link": "https://stackoverflow.com/questions/27813438/how-to-set-value-to-a-span-tag-in-ruby", "title": "how to set value to a span tag in ruby", "body": "<p>how can you set a value to the span tag instead? </p>\n\n<p>e.g.</p>\n\n<pre><code>span :span_text, xpath: '//span[@class=\"spanClass\"]'\n\ndef set span_text mystring\n  span_text.text=\"#{mystring}\"\nend\n</code></pre>\n\n<p>with the above code, I am getting undefined method 'text=' for \"\":String (NoMethodError)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "redmine", "saml"], "comments": [{"owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "edited": false, "score": 0, "creation_date": 1420612646, "post_id": 27813162, "comment_id": 44034385, "body": "Whats in the <code>Gemfile</code>?"}, {"owner": {"reputation": 529, "user_id": 1320573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/906cedf558955d7c9a1fe04094eb7899?s=128&d=identicon&r=PG&f=1", "display_name": "Chanuka Ranaba", "link": "https://stackoverflow.com/users/1320573/chanuka-ranaba"}, "reply_to_user": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "edited": false, "score": 0, "creation_date": 1420613274, "post_id": 27813162, "comment_id": 44034616, "body": "@PrakashMurthy Which part of the Gemfile I need to consider?"}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 1232147, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PQ7m5.jpg?s=128&g=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/1232147/sai"}, "is_accepted": false, "score": 0, "last_activity_date": 1420612735, "creation_date": 1420612735, "answer_id": 27813776, "question_id": 27813162, "link": "https://stackoverflow.com/questions/27813162/could-not-find-rake-10-4-2-in-any-of-the-sources-bundlergemnotfound/27813776#27813776", "title": "Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>I think you have many rake versions installed in your system</p>\n\n<p>Uninstall all the rake version(s) and try to install your specified version manually and try \nagain</p>\n"}, {"comments": [{"owner": {"reputation": 1852, "user_id": 496969, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/10a0004d585e5f0fca9a6648f61e8470?s=128&d=identicon&r=PG", "display_name": "tobinjim", "link": "https://stackoverflow.com/users/496969/tobinjim"}, "edited": false, "score": 0, "creation_date": 1446578257, "post_id": 28457991, "comment_id": 54797977, "body": "Thanks!  This solved it for me.  I tried all the other suggestions here and on many other related posts."}], "tags": [], "owner": {"reputation": 103, "user_id": 3161873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VCTL.jpg?s=128&g=1", "display_name": "Shafquat", "link": "https://stackoverflow.com/users/3161873/shafquat"}, "is_accepted": false, "score": 2, "last_activity_date": 1423668190, "creation_date": 1423668190, "answer_id": 28457991, "question_id": 27813162, "link": "https://stackoverflow.com/questions/27813162/could-not-find-rake-10-4-2-in-any-of-the-sources-bundlergemnotfound/28457991#28457991", "title": "Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>Try packing the gems into vendor/bundle.</p>\n\n<p>From inside your app directory type this:</p>\n\n<pre><code># bundle install --path vendor/bundle  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3590411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WqBjO.jpg?s=128&g=1", "display_name": "madhu maddy", "link": "https://stackoverflow.com/users/3590411/madhu-maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1426604888, "last_edit_date": 1426604888, "creation_date": 1426603581, "answer_id": 29102194, "question_id": 27813162, "link": "https://stackoverflow.com/questions/27813162/could-not-find-rake-10-4-2-in-any-of-the-sources-bundlergemnotfound/29102194#29102194", "title": "Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>I had this problem using rbenv for my ruby 2.2.0 install. I fixed it through trial and error.</p>\n\n<p>I tried doing <code>gem install rake</code> but this didn't fix it. So I did:</p>\n\n<pre><code>gem uninstall rake\nrbenv global 2.1.1\nrbenv rehash\nrbenv uninstall rake #this time gives error \"rake is a default gem\"\nrbenv global 2.2.0\nrbenv rehash\ngem install rake\nrails s #works this time\n</code></pre>\n\n<p>My expectation is that there was maybe a conflict somewhere in PATH or similar that was resolved with a complete remove</p>\n\n<p>I've had that error with multi_json before. I fixed it by doing a manual install: <code>gem install multi_json</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3409, "user_id": 4579155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Dw6Fx.jpg?s=128&g=1", "display_name": "abarisone", "link": "https://stackoverflow.com/users/4579155/abarisone"}, "edited": false, "score": 0, "creation_date": 1428216476, "post_id": 29454838, "comment_id": 47074771, "body": "Could elaborate more the solution you provide?"}], "tags": [], "owner": {"reputation": 1, "user_id": 3521755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bdb92819b73a295364c70b3ebdde3b4?s=128&d=identicon&r=PG&f=1", "display_name": "BP46", "link": "https://stackoverflow.com/users/3521755/bp46"}, "is_accepted": false, "score": 0, "last_activity_date": 1428216044, "creation_date": 1428216044, "answer_id": 29454838, "question_id": 27813162, "link": "https://stackoverflow.com/questions/27813162/could-not-find-rake-10-4-2-in-any-of-the-sources-bundlergemnotfound/29454838#29454838", "title": "Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>I had this issue, ran <code>gem uninstall rake</code> and then found out I was running 2 versions of rake. Simple prompt followed allowing me to uninstall the version I no longer wanted and keep version 10.4.2</p>\n"}], "owner": {"reputation": 529, "user_id": 1320573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/906cedf558955d7c9a1fe04094eb7899?s=128&d=identicon&r=PG&f=1", "display_name": "Chanuka Ranaba", "link": "https://stackoverflow.com/users/1320573/chanuka-ranaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7433, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1428216044, "creation_date": 1420609678, "last_edit_date": 1420613948, "question_id": 27813162, "link": "https://stackoverflow.com/questions/27813162/could-not-find-rake-10-4-2-in-any-of-the-sources-bundlergemnotfound", "title": "Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)", "body": "<p>I'm using Redmine SAML authentication plugin to integrate redmine with my application inorder to enable Single Sign On(SSO) in redmine which made it possible for users to login with the same username and password. Following ruby and rails versions installed.</p>\n\n<p><strong>ruby -v</strong>: ruby 1.9.2p330 (2014-08-07 revision 47094) [x86_64-linux]</p>\n\n<p><strong>rails -v</strong>: Rails 3.2.19</p>\n\n<p><strong>rake --version</strong>:rake, version 10.4.2</p>\n\n<p>Im getting following exception when application starting.</p>\n\n<pre><code>Could not find rake-10.4.2 in any of the sources (Bundler::GemNotFound)\n\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/spec_set.rb:92:in `block in materialize'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/spec_set.rb:85:in `map!'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/spec_set.rb:85:in `materialize'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/definition.rb:132:in `specs'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/definition.rb:177:in `specs_for'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/definition.rb:166:in `requested_specs'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/environment.rb:18:in `requested_specs'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/runtime.rb:13:in `setup'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler.rb:122:in `setup'\n/home/chanuka/.rvm/gems/ruby-1.9.2-p330@global/gems/bundler-1.7.9/lib/bundler/setup.rb:17:in `&lt;top (required)&gt;'\n/home/chanuka/.rvm/rubies/ruby-1.9.2-p330/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:128:in `require'\n/home/chanuka/.rvm/rubies/ruby-1.9.2-p330/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:128:in `rescue in require'\n/home/chanuka/.rvm/rubies/ruby-1.9.2-p330/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:39:in `require'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/lib/phusion_passenger/loader_shared_helpers.rb:263:in `block in run_load_path_setup_code'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/lib/phusion_passenger/loader_shared_helpers.rb:366:in `running_bundler'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/lib/phusion_passenger/loader_shared_helpers.rb:261:in `run_load_path_setup_code'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/helper-scripts/rack-preloader.rb:100:in `preload_app'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/helper-scripts/rack-preloader.rb:158:in `&lt;module:App&gt;'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/helper-scripts/rack-preloader.rb:29:in `&lt;module:PhusionPassenger&gt;'\n/usr/lib/ruby/gems/ruby-1.9.2-p330/gems/passenger-4.0.57/helper-scripts/rack-preloader.rb:28:in `&lt;main&gt;'\n\nError ID d4b15bdd\n</code></pre>\n\n<p>Application root /opt/redmine/redmine-2.6.0</p>\n\n<p>Environment (value of RAILS_ENV, RACK_ENV, WSGI_ENV, NODE_ENV and PASSENGER_APP_ENV)\nproduction</p>\n\n<p>I tried <code>bundle install rake</code> , <code>bundle update</code> but still doesn't work.</p>\n"}, {"tags": ["ruby", "rbenv"], "comments": [{"owner": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "edited": false, "score": 0, "creation_date": 1420620167, "post_id": 27812921, "comment_id": 44037143, "body": "Maybe this might help you? <a href=\"https://github.com/sstephenson/ruby-build/issues/526\" rel=\"nofollow noreferrer\">github.com/sstephenson/ruby-build/issues/526</a>"}], "answers": [{"tags": [], "owner": {"reputation": 271, "user_id": 3498673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e821aeb9143585b02a77021928059de3?s=128&d=identicon&r=PG", "display_name": "kpopovbg", "link": "https://stackoverflow.com/users/3498673/kpopovbg"}, "is_accepted": false, "score": 1, "last_activity_date": 1467019339, "last_edit_date": 1467019339, "creation_date": 1420713926, "answer_id": 27838215, "question_id": 27812921, "link": "https://stackoverflow.com/questions/27812921/rbenv-ruby-install-fail-ubuntu/27838215#27838215", "title": "rbenv ruby install fail ubuntu", "body": "<p>If you are using Ubuntu and or Debian than you can try to install libffi-dev via apt-get.</p>\n\n<pre><code>$ apt-get install libffi-dev\n</code></pre>\n\n<p>I did a little research around the forums and I found this on the official rbenv Question and Answer section.</p>\n\n<p><a href=\"https://github.com/sstephenson/ruby-build/wiki#build-failure-of-fiddle-with-ruby-220\" rel=\"nofollow\">https://github.com/sstephenson/ruby-build/wiki#build-failure-of-fiddle-with-ruby-220</a></p>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 2975692, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a929a7c3802cc7277952cfeefcaa88f4?s=128&d=identicon&r=PG", "display_name": "Anjan", "link": "https://stackoverflow.com/users/2975692/anjan"}, "is_accepted": true, "score": 8, "last_activity_date": 1422773772, "creation_date": 1422773772, "answer_id": 28260311, "question_id": 27812921, "link": "https://stackoverflow.com/questions/27812921/rbenv-ruby-install-fail-ubuntu/28260311#28260311", "title": "rbenv ruby install fail ubuntu", "body": "<p>install these dependencies first and then retry worked for me on 14.04 for ruby 2.2.0 with rbenv</p>\n\n<pre><code>sudo apt-get install autoconf bison build-essential libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm3 libgdbm-dev\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1172, "user_id": 2975561, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/sUmXF.jpg?s=128&g=1", "display_name": "Hoa Hoang", "link": "https://stackoverflow.com/users/2975561/hoa-hoang"}, "edited": false, "score": 1, "creation_date": 1448211865, "post_id": 30636124, "comment_id": 55479469, "body": "You save my life. Thanks so much"}], "tags": [], "owner": {"reputation": 1033, "user_id": 1467382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d8f6cd1c0d82b8716b5a99522b29e80c?s=128&d=identicon&r=PG", "display_name": "Mauro Dias", "link": "https://stackoverflow.com/users/1467382/mauro-dias"}, "is_accepted": false, "score": 3, "last_activity_date": 1433397876, "creation_date": 1433397876, "answer_id": 30636124, "question_id": 27812921, "link": "https://stackoverflow.com/questions/27812921/rbenv-ruby-install-fail-ubuntu/30636124#30636124", "title": "rbenv ruby install fail ubuntu", "body": "<p>All of other anwsers failed for me...</p>\n\n<p>and after lot of failed attempts and research I found out those workarounds for many versions:</p>\n\n<p><strong>2.1.1</strong></p>\n\n<pre><code>curl -fsSL https://gist.github.com/mislav/a18b9d7f0dc5b9efc162.txt | rbenv install --patch 2.1.1\n</code></pre>\n\n<p><strong>2.0.0-p451</strong></p>\n\n<pre><code>curl -fsSL https://gist.github.com/LeonB/10503374/raw | rbenv install --patch 2.0.0-p451\n</code></pre>\n\n<p><strong>2.0.0-p247</strong></p>\n\n<pre><code>cat &lt;(curl -fsSL https://raw.githubusercontent.com/wayneeseguin/rvm/master/patches/ruby/changeset_r45225.diff) &lt;(curl -fsSL https://raw.githubusercontent.com/wayneeseguin/rvm/master/patches/ruby/changeset_r45240.diff) | sed -E 's/^((---|\\+\\+\\+) )(a|b)\\/([^ ]+\\s+\\(revision [0-9]+\\))$/\\1\\4/' | sed '/rl_delete_text/d' | rbenv install -p 2.0.0-p247\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/sstephenson/ruby-build/issues/526\" rel=\"nofollow\">https://github.com/sstephenson/ruby-build/issues/526</a></p>\n\n<p>Hope i could help anyone.</p>\n"}], "owner": {"reputation": 1366, "user_id": 133059, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f1dce9f8ba8935e237da5890ffe6714a?s=128&d=identicon&r=PG", "display_name": "Jonathan Musso", "link": "https://stackoverflow.com/users/133059/jonathan-musso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2703, "favorite_count": 0, "accepted_answer_id": 28260311, "answer_count": 3, "score": 1, "last_activity_date": 1467019339, "creation_date": 1420608288, "last_edit_date": 1420629096, "question_id": 27812921, "link": "https://stackoverflow.com/questions/27812921/rbenv-ruby-install-fail-ubuntu", "title": "rbenv ruby install fail ubuntu", "body": "<p>Here is the error log</p>\n\n<pre><code>Downloading ruby-2.2.0.tar.gz... -&gt; http://dqw8nmjcqpjn7.cloudfront.net/7671e394abfb5d262fbcd3b27a71bf78737c7e9347fa21c39e58b0bb9c4840fc\nInstalling ruby-2.2.0...\n\nBUILD FAILED (Ubuntu 14.04 using ruby-build 20141225-7-g4aeeac2)\n\nInspect or clean up the working tree at /tmp/ruby-build.20150106233051.25615 Results logged to /tmp/ruby-build.20150106233051.25615.log\n\nLast 10 log lines:\n\ncompiling ossl_x509store.c\ncompiling ossl_engine.c\ncompiling ossl_ocsp.c\ncompiling ossl_config.c\ncompiling ossl_digest.c\ninstalling default openssl libraries\nlinking shared-object openssl.so\nmake[2]: Leaving directory /tmp/ruby-build.20150106233051.25615/ruby-2.2.0/ext/openssl'\nmake[1]: Leaving directory/tmp/ruby-build.20150106233051.25615/ruby-2.2.0'\nmake: *** [build-ext] Error 2\n</code></pre>\n\n<p>I'm not sure what to do here. I tried this but when I type <code>ruby -v</code> it still tells me I have the old version.</p>\n\n<pre><code>sudo apt-get install autoconf bison libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm3 libgdbm-dev \n</code></pre>\n\n<p>Thanks for any comments given, much appreciated.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "join", "activerecord"], "comments": [{"owner": {"reputation": 6651, "user_id": 2440312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QNlkH.jpg?s=128&g=1", "display_name": "Aaditi Jain", "link": "https://stackoverflow.com/users/2440312/aaditi-jain"}, "edited": false, "score": 0, "creation_date": 1420603844, "post_id": 27812226, "comment_id": 44032090, "body": "Please show the relationships between your models :)"}, {"owner": {"reputation": 1483, "user_id": 988176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace6bd5323485ce76e5469e5425b5d92?s=128&d=identicon&r=PG", "display_name": "railsdog", "link": "https://stackoverflow.com/users/988176/railsdog"}, "edited": false, "score": 1, "creation_date": 1420608887, "post_id": 27812226, "comment_id": 44033284, "body": "Opinion: I dislike has_and_belongs_to_many for just this kind of situation. That is usually (but not always) masking another model. Perhaps a User has_many Enrollments, and has_many Courses through Enrollments. Course has_many Enrollments, and has_many Users through Enrollments, and an Enrollment belongs_to Course, and belongs_to User. The explicit Enrollment model lets you store additional attributes (perhaps the users Grade, or Credits, date enrolled, date dropped, or whatever)."}, {"owner": {"reputation": 77, "user_id": 3653246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74d20cc0407583d38fd7b475a8ee914b?s=128&d=identicon&r=PG&f=1", "display_name": "atallest", "link": "https://stackoverflow.com/users/3653246/atallest"}, "reply_to_user": {"reputation": 1483, "user_id": 988176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ace6bd5323485ce76e5469e5425b5d92?s=128&d=identicon&r=PG", "display_name": "railsdog", "link": "https://stackoverflow.com/users/988176/railsdog"}, "edited": false, "score": 0, "creation_date": 1420658713, "post_id": 27812226, "comment_id": 44059913, "body": "@railsdog That&#39;s a very good point. At the present time I don&#39;t have a need for storing these other attributes, but it may be more beneficial in the long run. I&#39;ll look into revising my relationships. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 3653246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74d20cc0407583d38fd7b475a8ee914b?s=128&d=identicon&r=PG&f=1", "display_name": "atallest", "link": "https://stackoverflow.com/users/3653246/atallest"}, "edited": false, "score": 0, "creation_date": 1420605801, "post_id": 27812364, "comment_id": 44032487, "body": "Oh I see! I wasn&#39;t aware of the discrepancy. Thank you for the answer and helpful resource!"}], "tags": [], "owner": {"reputation": 32543, "user_id": 528726, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6307569a99dd77fff0463032051d7e39?s=128&d=identicon&r=PG", "display_name": "joelparkerhenderson", "link": "https://stackoverflow.com/users/528726/joelparkerhenderson"}, "is_accepted": true, "score": 2, "last_activity_date": 1420612075, "last_edit_date": 1420612075, "creation_date": 1420604550, "answer_id": 27812364, "question_id": 27812226, "link": "https://stackoverflow.com/questions/27812226/deleting-an-active-record-entry-from-a-joined-table-without-deleting-the-orginal/27812364#27812364", "title": "Deleting an active record entry from a joined table without deleting the orginal", "body": "<p>Your code is saying to destroy the course, so that's what ActiveRecord is doing.</p>\n\n<p>You want to delete the association, not destroy the user nor the course. </p>\n\n<p>The solution is to use <code>collection.delete(object, \u2026)</code></p>\n\n<ul>\n<li><p>This removes each object from the collection by deleting the association from the join table. </p></li>\n<li><p>This does not destroy the objects.</p></li>\n</ul>\n\n<p>Example code:</p>\n\n<pre><code>def delete_user_course_association(user_id, course_id)\n  user = User.find(user_id)\n  course = user.courses.find(course_id)\n  user.courses.delete(course) if course \nend\n</code></pre>\n\n<p>See <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_and_belongs_to_many\" rel=\"nofollow\">Rails API ActiveRecord Associations has_and_belongs_to_many</a></p>\n"}, {"tags": [], "owner": {"reputation": 1056, "user_id": 4333534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94364e357329372fe537d2789c8127d?s=128&d=identicon&r=PG&f=1", "display_name": "roob", "link": "https://stackoverflow.com/users/4333534/roob"}, "is_accepted": false, "score": 2, "last_activity_date": 1420605198, "creation_date": 1420605198, "answer_id": 27812442, "question_id": 27812226, "link": "https://stackoverflow.com/questions/27812226/deleting-an-active-record-entry-from-a-joined-table-without-deleting-the-orginal/27812442#27812442", "title": "Deleting an active record entry from a joined table without deleting the orginal", "body": "<p>The line below deletes the courses record with id <code>params[:id]</code></p>\n\n<pre><code>current_user.courses.find_by(id: params[:id]).destroy\n</code></pre>\n\n<p>I think you meant to do: </p>\n\n<pre><code>  current_user.courses.delete( params[:id] )\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 3653246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/74d20cc0407583d38fd7b475a8ee914b?s=128&d=identicon&r=PG&f=1", "display_name": "atallest", "link": "https://stackoverflow.com/users/3653246/atallest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "accepted_answer_id": 27812364, "answer_count": 2, "score": 1, "last_activity_date": 1420612075, "creation_date": 1420603344, "last_edit_date": 1420604088, "question_id": 27812226, "link": "https://stackoverflow.com/questions/27812226/deleting-an-active-record-entry-from-a-joined-table-without-deleting-the-orginal", "title": "Deleting an active record entry from a joined table without deleting the orginal", "body": "<p>I am working on a web application written in ruby on rails</p>\n\n<p>There is a model of courses that exists in the database. \nA user has the ability to save courses that he/she plans to take.\nI accomplish this by having a current_user.courses table.  (courses_users)</p>\n\n<p>However, if a user wishes to remove a saved course, and I issue a delete request with that id like so</p>\n\n<pre><code>current_user.courses.find_by(id: params[:id]).destroy\n</code></pre>\n\n<p>I end up deleting both the entry in the joined table and the entry in the courses table. I confirmed this by looking at the server logs and found</p>\n\n<pre><code>DELETE FROM `courses_users` WHERE `courses_users`.`course_id` = 219\nSQL (0.4ms)  DELETE FROM `courses` WHERE `courses`.`id` = 219\n</code></pre>\n\n<p>Doing the two actions described above when I only want the first.</p>\n\n<p>Is there a way to just remove just the entry in the joined table? Or does that go against the nature of a joined table? If so, is there a more efficient way of achieving this functionality?</p>\n\n<p>Any help would be appreciated and if you would have me post anything else please ask.</p>\n\n<p>Thank you,</p>\n\n<p>EDIT: The relationships between the two models:</p>\n\n<p>a user has_and_belongs_to_many courses</p>\n\n<p>and a course has_and_belongs_to_many users</p>\n"}, {"tags": ["ruby", "vagrant", "chef-infra", "chef-solo", "vagrantfile"], "answers": [{"comments": [{"owner": {"reputation": 7030, "user_id": 805031, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/093c4af6a8398df55385798583ab96c4?s=128&d=identicon&r=PG", "display_name": "TryTryAgain", "link": "https://stackoverflow.com/users/805031/trytryagain"}, "reply_to_user": {"reputation": 4171, "user_id": 4599824, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mEYh0.png?s=128&g=1", "display_name": "Fawzan", "link": "https://stackoverflow.com/users/4599824/fawzan"}, "edited": false, "score": 0, "creation_date": 1459988013, "post_id": 27811082, "comment_id": 60540590, "body": "@Fawzan ...the metadata.rb at the root directory of the cookbook you&#39;re having the issue with."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 7, "last_activity_date": 1420601939, "creation_date": 1420601939, "answer_id": 27811082, "question_id": 27810967, "link": "https://stackoverflow.com/questions/27810967/error-cookbook-loaded-at-paths-has-invalid-metadata/27811082#27811082", "title": "ERROR: Cookbook loaded at path(s) has invalid metadata", "body": "<p>As the error mentions, you <em>must</em> add <code>name 'tad-server'</code> the <code>metadata.rb</code> file in this cookbook. In days long past, this was optional so many people didn't put a metadata.rb in their cookbooks at all, but some tools now require this at a minimum. All other fields in the metadata remain optional, though <code>version</code> is highly recommended.</p>\n"}, {"comments": [{"owner": {"reputation": 1310, "user_id": 2618036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdb602439c78c24083769286e12fbb2a?s=128&d=identicon&r=PG", "display_name": "georger", "link": "https://stackoverflow.com/users/2618036/georger"}, "edited": false, "score": 0, "creation_date": 1461764851, "post_id": 30923540, "comment_id": 61347767, "body": "+1 for mentioning to add the name of the cookbook in the metadata.rb. Someting like <code>name &quot;cookbook-name&quot;</code>."}], "tags": [], "owner": {"reputation": 2037, "user_id": 4736211, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/4dwqi.jpg?s=128&g=1", "display_name": "jorfus", "link": "https://stackoverflow.com/users/4736211/jorfus"}, "is_accepted": false, "score": 1, "last_activity_date": 1434653721, "creation_date": 1434653721, "answer_id": 30923540, "question_id": 27810967, "link": "https://stackoverflow.com/questions/27810967/error-cookbook-loaded-at-paths-has-invalid-metadata/30923540#30923540", "title": "ERROR: Cookbook loaded at path(s) has invalid metadata", "body": "<p>You need to add your cookbook name to the metadata.rb file inside the cookbook directory.\nI just ran into this with the chef-client cookbook. Upload failed till I added the following line to chef-client/metadata.rb</p>\n\n<pre><code>name \"chef-client\"\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 2055252, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8f740b1af3815ed9ca61789f376cb590?s=128&d=identicon&r=PG", "display_name": "nisevi", "link": "https://stackoverflow.com/users/2055252/nisevi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 1, "accepted_answer_id": 27811082, "answer_count": 2, "score": 6, "last_activity_date": 1483100814, "creation_date": 1420600983, "last_edit_date": 1483100814, "question_id": 27810967, "link": "https://stackoverflow.com/questions/27810967/error-cookbook-loaded-at-paths-has-invalid-metadata", "title": "ERROR: Cookbook loaded at path(s) has invalid metadata", "body": "<p>When I'm running:</p>\n\n<pre><code>:$ vagrant provision\n</code></pre>\n\n<p>or </p>\n\n<pre><code>:$ vagrant up\n</code></pre>\n\n<p>I have an error:</p>\n\n<pre><code>nisevi@localhost processor (master):$ vagrant provision\nUsing ssh deploy key of: /home/nisevi/.ssh/id_rsa\n==&gt; default: Chef 12.0.3 Omnibus package is already installed.\n==&gt; default: Running provisioner: shell...\n    default: Running: inline script\n==&gt; default: W\n==&gt; default: : \n==&gt; default: Duplicate sources.list entry http://security.ubuntu.com/ubuntu/ trusty-security/multiverse amd64 Packages (/var/lib/apt/lists/security.ubuntu.com_ubuntu_dists_trusty-security_multiverse_binary-amd64_Packages)\n==&gt; default: W\n==&gt; default: : Duplicate sources.list entry http://security.ubuntu.com/ubuntu/ trusty-security/multiverse i386 Packages (/var/lib/apt/lists/security.ubuntu.com_ubuntu_dists_trusty-security_multiverse_binary-i386_Packages)\n==&gt; default: W: Duplicate sources.list entry http://archive.ubuntu.com/ubuntu/ trusty/multiverse amd64 Packages (/var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_trusty_multiverse_binary-amd64_Packages)\n==&gt; default: W: Duplicate sources.list entry http://archive.ubuntu.com/ubuntu/ trusty/multiverse i386 Packages (/var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_trusty_multiverse_binary-i386_Packages)\n==&gt; default: W: Duplicate sources.list entry http://archive.ubuntu.com/ubuntu/ trusty-updates/multiverse amd64 Packages (/var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_trusty-updates_multiverse_binary-amd64_Packages)\n==&gt; default: W: Duplicate sources.list entry http://archive.ubuntu.com/ubuntu/ trusty-updates/multiverse i386 Packages (/var/lib/apt/lists/archive.ubuntu.com_ubuntu_dists_trusty-updates_multiverse_binary-i386_Packages)\n==&gt; default: W: You may want to run apt-get update to correct these problems\n==&gt; default: Running provisioner: chef_solo...\n==&gt; default: Detected Chef (latest) is already installed\nGenerating chef JSON and uploading...\n==&gt; default: Running chef-solo...\n==&gt; default: [2015-01-07T03:09:42+00:00] INFO: Forking chef instance to converge...\n==&gt; default: [2015-01-07T03:09:42+00:00] INFO: *** Chef 12.0.3 ***\n==&gt; default: [2015-01-07T03:09:42+00:00] INFO: Chef-client pid: 1224\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Setting the run_list to [\"role[processor]\"] from CLI options\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Run List is [role[processor]]\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Run List expands to [opsworks_initial_setup, mysql::client, dependencies, opsworks_ganglia::client, deploy::default, ba-processor::setup, ba-processor::deploy, sidekiq::deploy, opsworks_ganglia::configure-client]\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Starting Chef Run for ubuntu1404-opsworks\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Running start handlers\n==&gt; default: [2015-01-07T03:09:50+00:00] INFO: Start handlers complete.\n==&gt; default: [2015-01-07T03:09:51+00:00] WARN: found a directory vendor in the cookbook path, but it contains no cookbook files. skipping.\n==&gt; default: [2015-01-07T03:09:51+00:00] ERROR: Running exception handlers\n==&gt; default: [2015-01-07T03:09:51+00:00] ERROR: Exception handlers complete\n==&gt; default: [2015-01-07T03:09:51+00:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out\n==&gt; default: [2015-01-07T03:09:51+00:00] ERROR: Cookbook loaded at path(s) [/tmp/vagrant-chef-3/chef-solo-2/cookbooks/tad-server] has invalid metadata: The `name' attribute is required in cookbook metadata\n==&gt; default: [2015-01-07T03:09:51+00:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)\nChef never successfully completed! Any errors should be visible in the\noutput above. Please fix your recipes so that they properly complete.\n</code></pre>\n\n<p>Does anyone know what is causing this error or to what is related?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "string", "hex", "pack"], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1420603401, "post_id": 27811085, "comment_id": 44032015, "body": "You are right, and I wasn&#39;t - I deleted my comment. It&#39;s probably something to do with output encoding rather than string encoding itself; <code>puts &quot;&#252;&quot;.encode(&#39;Windows-1252&#39;)</code> also displays <code>?</code> even though it is a valid string."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1420603474, "post_id": 27811085, "comment_id": 44032026, "body": "@Amadan I (hopefully) clarified that bit anyway, unstated assumptions aren&#39;t a good idea."}, {"owner": {"reputation": 147, "user_id": 2193335, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b827b7a5145c2f012ee51d4e9e267e4?s=128&d=identicon&r=PG", "display_name": "Kevin Bende", "link": "https://stackoverflow.com/users/2193335/kevin-bende"}, "edited": false, "score": 0, "creation_date": 1420643551, "post_id": 27811085, "comment_id": 44050598, "body": "@muistooshort - i figured it was because that byte just couldn&#39;t be displayed properly but didn&#39;t understand the reason behind it and now I do.  Thanks for the explanation and clearing up the  confusion."}], "tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 4, "last_activity_date": 1420603431, "last_edit_date": 1420603431, "creation_date": 1420601971, "answer_id": 27811085, "question_id": 27810923, "link": "https://stackoverflow.com/questions/27810923/displaying-the-output-of-the-ruby-command-packh/27811085#27811085", "title": "Displaying the output of the ruby command .pack(&quot;H*&quot;)", "body": "<p><code>irb</code> uses the <code>inspect</code> method to produce strings to show and <code>[\"A\"].pack('H*').inspect</code> is <code>\"\\xA0\"</code>. <code>puts</code> calls <code>to_s</code> on its arguments to convert them to strings, <code>String#to_s</code> doesn't do anything useful (unless returning <code>self</code> is useful) so:</p>\n\n<pre><code>puts [\"A\"].pack('H*')\n</code></pre>\n\n<p>is trying to print the byte <code>\\xA0</code> which doesn't represent anything printable in whatever encoding your terminal is expecting (probably UTF-8 these days but maybe ISO-8859-1 or Windows-CP-1252) so you get the standard \"I don't know what this is\" question mark. <code>puts</code> works fine with <code>[\"0A\"].pack('H*')</code> and <code>[\"54\"].pack('H*')</code> because they produce printable characters.</p>\n"}], "owner": {"reputation": 147, "user_id": 2193335, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b827b7a5145c2f012ee51d4e9e267e4?s=128&d=identicon&r=PG", "display_name": "Kevin Bende", "link": "https://stackoverflow.com/users/2193335/kevin-bende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 27811085, "answer_count": 1, "score": 1, "last_activity_date": 1420644280, "creation_date": 1420600666, "last_edit_date": 1420644280, "question_id": 27810923, "link": "https://stackoverflow.com/questions/27810923/displaying-the-output-of-the-ruby-command-packh", "title": "Displaying the output of the ruby command .pack(&quot;H*&quot;)", "body": "<p>I have a Rails project which requires working with and manipulating Hex strings.  At certain stages I want to print my string for troubleshooting and testing.  But I'm getting weird strings in my output.  For the following example, I am using Rails 3.1.3 and ruby 1.9.3p385.  </p>\n\n<p>Rails console:</p>\n\n<pre><code>[\"A\"].pack('H*')\n=&gt; \"\\xA0\"\n[\"0A\"].pack('H*')\n=&gt; \"\\n\"\n[\"54\"].pack('H*')\n=&gt; \"T\"\n</code></pre>\n\n<p>Run the same commands but this time output it using a <em>puts</em> command:</p>\n\n<pre><code>puts [\"A\"].pack('H*')\n?\n=&gt; nil\nputs [\"0A\"].pack('H*')\n\n=&gt; nil\nputs [\"54\"].pack('H*')\n\"T\"\n=&gt; nil\n</code></pre>\n\n<p>How come for [\"A\"] and [\"0A\"] when I try to print the results using the <em>puts</em> command it doesn't display the same as just running the command without printing it?  And how come [\"54\"] works correctly?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Above I said that <code>puts [\"0A\"].pack('H*')</code> isn't displayed correctly but that is not true.  <code>[\"0A\"].pack('H*')</code> returns a newline byte so when you run <code>puts [\"0A\"].pack('H*')</code> it correctly display the newline byte in string format which appears as nothing but is actually correct.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "geocode"], "comments": [{"owner": {"reputation": 129, "user_id": 6566361, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201844388907310/picture?type=large", "display_name": "Ayodeji", "link": "https://stackoverflow.com/users/6566361/ayodeji"}, "edited": false, "score": 0, "creation_date": 1504698997, "post_id": 27810820, "comment_id": 79109896, "body": "Checkout the solution proposed in <a href=\"https://stackoverflow.com/questions/29655702/geocoding-multiple-addresses-in-one-model\">https://stackoverflow.com/questions/29655702/geocoding-multi&zwnj;&#8203;ple-addresses-in-one&zwnj;&#8203;-model</a> It works like magic"}], "answers": [{"tags": [], "owner": {"reputation": 1056, "user_id": 4333534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94364e357329372fe537d2789c8127d?s=128&d=identicon&r=PG&f=1", "display_name": "roob", "link": "https://stackoverflow.com/users/4333534/roob"}, "is_accepted": false, "score": 2, "last_activity_date": 1420603065, "last_edit_date": 1420603065, "creation_date": 1420602399, "answer_id": 27812114, "question_id": 27810820, "link": "https://stackoverflow.com/questions/27810820/geocoding-multiple-addresses/27812114#27812114", "title": "Geocoding multiple addresses", "body": "<p>Geocoder.search returns an array of location data.</p>\n\n<p>In the sample provided, you can retrieve latitude and longitude with:</p>\n\n<p><code>self.home_latitude  = home_coordinates[0].geometry[\"location\"][\"lat\"]</code>\n  <code>self.home_longitude = home_coordinates[0].geometry[\"location\"][\"lng\"]</code></p>\n"}], "owner": {"reputation": 167, "user_id": 1946244, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/89fe8839f2b7320d704c3926c2f07aef?s=128&d=identicon&r=PG", "display_name": "Taylor", "link": "https://stackoverflow.com/users/1946244/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1470189165, "creation_date": 1420599766, "last_edit_date": 1495542772, "question_id": 27810820, "link": "https://stackoverflow.com/questions/27810820/geocoding-multiple-addresses", "title": "Geocoding multiple addresses", "body": "<p>I have searched high and low for a solution to this without luck, so I'm now posting here... </p>\n\n<p>I'm using the Geocode gem on my RoR app.</p>\n\n<p>This is the approach to geocoding multiple addresses on the same model in the docs and it doesn't work as it only geocodes the last method: </p>\n\n<pre><code>geocoded_by :start_address, latitude: :start_latitude, longitude: :start_longitude\ngeocoded_by :end_address, latitude: :end_latitude, longitude: :end_longitude\n</code></pre>\n\n<p>I have tried to write a custom method to solve this:</p>\n\n<pre><code>geocoded_by :geocode_user_addresses\nafter_validation :geocode\n\ndef geocode_user_addresses\nhome_address_joined = [home_address, city].compact.join(', ')\nwork_address_joined = [work_address, city].compact.join(', ')\nhome_coordinates = Geocoder.search(home_address_joined)\nwork_coordinates = Geocoder.search(work_address_joined)\nself.home_latitude = home_coordinates.latitude\nself.home_longitude = home_coordinates.longitude\nself.work_latitude = work_coordinates.latitude\nself.work_longitude = work_coordinates.longitude\nend\n</code></pre>\n\n<p>That gives me this error when I try to geocode the addresses:</p>\n\n<pre><code>undefined method `latitude'\n</code></pre>\n\n<p>Any ideas on where to begin? There's a similar problem but no solution ended up being shared: <a href=\"https://stackoverflow.com/questions/7510734/rails-geocoder-gem-issues\">Rails geocoder gem issues</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 3763682, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f78eec0fd68366d8b40faacff41433fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3763682", "link": "https://stackoverflow.com/users/3763682/user3763682"}, "edited": false, "score": 0, "creation_date": 1420648825, "post_id": 27810900, "comment_id": 44054220, "body": "Thank you.  That was the issue."}], "tags": [], "owner": {"reputation": 157, "user_id": 1240036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd081551cc149def85dd647b6e9c218?s=128&d=identicon&r=PG", "display_name": "henggana", "link": "https://stackoverflow.com/users/1240036/henggana"}, "is_accepted": true, "score": 0, "last_activity_date": 1420600406, "creation_date": 1420600406, "answer_id": 27810900, "question_id": 27810731, "link": "https://stackoverflow.com/questions/27810731/form-for-renders-get-rather-than-post-using-rails/27810900#27810900", "title": "form_for renders get rather than post, using rails", "body": "<p>Remove <code>&lt;form class=\"form-inline\"&gt;</code> (and the closing tag if any) before <code>form_for</code>. HTML forms can't be nested, thus only the outer form are processed which is have <code>GET</code> method.</p>\n"}, {"tags": [], "owner": {"reputation": 11796, "user_id": 1942551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/97a80fd6531adf0db0c3bc9c7c11a8ea?s=128&d=identicon&r=PG", "display_name": "karlingen", "link": "https://stackoverflow.com/users/1942551/karlingen"}, "is_accepted": false, "score": 1, "last_activity_date": 1420620571, "creation_date": 1420620571, "answer_id": 27815535, "question_id": 27810731, "link": "https://stackoverflow.com/questions/27810731/form-for-renders-get-rather-than-post-using-rails/27815535#27815535", "title": "form_for renders get rather than post, using rails", "body": "<p>Remove the first <code>&lt;form&gt;</code> element and fix your <code>form_for</code> code from:</p>\n\n<pre><code>&lt;%= form_for(@qualifying_event, url: qualifying_events_path, method: =&gt; post) do |f| %&gt;\n</code></pre>\n\n<p>to: </p>\n\n<pre><code>&lt;%= form_for(@qualifying_event, url: qualifying_events_path, method: :post, class: 'form-inline') do |f| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 3763682, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f78eec0fd68366d8b40faacff41433fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3763682", "link": "https://stackoverflow.com/users/3763682/user3763682"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 27810900, "answer_count": 2, "score": 0, "last_activity_date": 1420620571, "creation_date": 1420598947, "question_id": 27810731, "link": "https://stackoverflow.com/questions/27810731/form-for-renders-get-rather-than-post-using-rails", "title": "form_for renders get rather than post, using rails", "body": "<p>I have a long form that auto-fills with information from our database (based upon partial information supplied by a user).  When the user verifies the information and re-submits the form, the information should be saved as the users.  The form - qualifying_events - is a partial that's in the views / shared folder.  The data that autofills it is rendered by the qualifying_events_controller as part of the create method.  The partial is presented for verification in a views / users page that's rendered by the user controller. The initial, partial information input by a user - in a similar partial on the same page - is correctly saving.  Here's the top of the form:</p>\n\n<pre><code>&lt;form class=\"form-inline\"&gt;\n  &lt;%= form_for(@qualifying_event) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n&lt;div &gt;   \n  &lt;div class=\"form-group col-sm-12 text-center\" style=\"margin-bottom: 5px;\"&gt;&lt;h5&gt;\n    &lt;div&gt;\n      &lt;li style=\"list-style-type: none; float: left; display: none; visibility: hidden;\"&gt;\n      &lt;%= current_user %&gt;\n      &lt;/li&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n      &lt;li style=\"list-style-type: none; float: left;\"&gt;\n      &lt;%= f.label :class_date %&gt;&lt;br/&gt;\n      &lt;%= f.text_area :class_date, autofocus: true %&gt;\n      &lt;/li&gt;\n    &lt;/div&gt; \n</code></pre>\n\n<p>Here is the error message:</p>\n\n<pre><code>No route matches [GET] \"/qualifying_events\" \n</code></pre>\n\n<p>Here's what I've tried:<br/>\n1. Explicitly adding a route to the config / routes file although it already showed if I ran rake routes:</p>\n\n<pre><code>post 'qualifying_events_path'     =&gt;  'qualifying_events#create'\n</code></pre>\n\n<p><br/>\n2. Changing the form_for language to explicitly call 'post':</p>\n\n<pre><code>&lt;%= form_for(@qualifying_event, url: qualifying_events_path, method: =&gt; post) do |f| %&gt;\n</code></pre>\n\n<p>I still get the same error message.  Since I have other forms that are saving to the database with the same code, I have to assume something changes when a form is populated from a database and one wants to re-save the information.  I'm using the devise gem so I looked at the registration#edit code, hoping I could follow the format:</p>\n\n<pre><code>  &lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %&gt;\n</code></pre>\n\n<p>Unfortunately, that approach didn't work either.  </p>\n\n<p>For 'completeness', here's the qualifying_events_controller code:</p>\n\n<pre><code>def create \n  @user = current_user\n  @qualifying_event = current_user.qualifying_events.build(qualifying_event_params) \n\n  if @qualifying_event.validated.nil?\n  # Match partial course information from current_user with records in table\n\n  # Get partial record's information\n  active_date = @qualifying_event.class_date\n  active_course = @qualifying_event.course_id\n  active_sponsor = @qualifying_event.sponsor_name\n\n  # Match on class_date, course_id, and sponsor_name\n  @qualifying_event = QualifyingEvent.new\n  @qualifying_event.assign_attributes(QualifyingEvent.\n      where(\"(class_date = :class_date AND course_id = :course_id) \n      OR (class_date = :class_date AND sponsor_name = :sponsor_name) \n      OR (course_id = :course_id AND sponsor_name = :sponsor_name)\",\n      {class_date: active_date, course_id: active_course, \n          sponsor_name: active_sponsor}).first.attributes)\n\n  # render to confirmation form / form for completion\n  flash[:success] = \"Qualifying Event saved for verification!\"\n  respond_to do |format|\n    format.html  {render 'users/user_dashboard' }\n  end\n\nelse\n  # if the record is complete          \n  @qualifying_event.save\n  flash[:success] = \"Qualifying Event created!\"\n  redirect_to user_dashboard_path\nend \n</code></pre>\n\n<p>There may be an error in the 'else' statement.  I haven't yet added the code to verify that all the required information is present, etc.</p>\n\n<p>I can save to and retrieve information from the database, however a re-submit of edited information calls 'get' rather than 'post.'  What am I missing?  Thank you in advance.</p>\n"}, {"tags": ["ruby", "xpath", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1420640026, "post_id": 27810635, "comment_id": 44048341, "body": "Given that these select lists have an opacity of 0, are these really the select lists a user would interact with? Or does the style get overridden (ie the select list becomes visible) by another action (like clicking a button)?"}, {"owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1420680651, "post_id": 27810635, "comment_id": 44069042, "body": "by manually executing, yes.. they are datepicker select lists with days, months, years option values."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "edited": false, "score": 0, "creation_date": 1420611579, "post_id": 27810770, "comment_id": 44034010, "body": "Hi, I dunno if it worked because the whole select tag has style=&quot;opacity: 0;&quot; so I am always given an error &quot;Element is not currently visible and so may not be interacted with...&quot;  above those select tags there is a div class=&quot;selectedOption&quot;.. but all are the same for 3 dropdowns..  how to proceed with this? thanks!"}, {"owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "reply_to_user": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "edited": false, "score": 1, "creation_date": 1420634964, "post_id": 27810770, "comment_id": 44045414, "body": "Can you provide a screenshot ?"}, {"owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "edited": false, "score": 0, "creation_date": 1420689128, "post_id": 27810770, "comment_id": 44071009, "body": "Hi,  I used the original one you gave me but including all the parent elements..which gives me something like:  select_list \t:date_list, xpath:&#39;//*[@id=&quot;hbf-ebs-personalDetails&quot;]/div[2]/form/div/di&zwnj;&#8203;v[1]/div[5]/div[1]/d&zwnj;&#8203;iv[4]/div[1]/div[1]/&zwnj;&#8203;div/div[1]/div[1]/se&zwnj;&#8203;lect[contains(@data-&zwnj;&#8203;bind, dates)]&#39;  i can now select whichever date i pass. thanks!  now i know my original question was answered, but the xpath solution i had is not really &quot;good&quot; as it has indeces in some parent elements.. do you know how can i update this to use the parent/child/sibling relationship?  super thanks!"}, {"owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "reply_to_user": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "edited": false, "score": 0, "creation_date": 1420689621, "post_id": 27810770, "comment_id": 44071128, "body": "It&#39;s really inefficient way too write <code>xpath</code> this way. You can try the following if that works for you <code>&#47;&#47;*[@id=&quot;hbf-ebs-personalDetails&quot;]&#47;&#47;select[contains(@data-bi&zwnj;&#8203;nd, dates)]</code>. Additionally, you can start reading <a href=\"http://www.w3schools.com/xpath/xpath_syntax.asp\" rel=\"nofollow noreferrer\">this</a> to see how to use different xpath functions etc.. If the answer helps you please accept and upvote it"}], "tags": [], "owner": {"reputation": 15014, "user_id": 3821981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/QKE9Z.jpg?s=128&g=1", "display_name": "Saifur", "link": "https://stackoverflow.com/users/3821981/saifur"}, "is_accepted": true, "score": 0, "last_activity_date": 1420682236, "last_edit_date": 1420682236, "creation_date": 1420599285, "answer_id": 27810770, "question_id": 27810635, "link": "https://stackoverflow.com/questions/27810635/xpath-for-select-list-for-date-dropdowns-without-unique-class-names-or-ids/27810770#27810770", "title": "xpath for select_list for date dropdowns without unique class names or ids", "body": "<p>Using <code>contains</code> function you can accomplish that.</p>\n\n<pre><code>//select[contains(@data-bind,'dates')] #change the data-bind value to month or years or whatever\n</code></pre>\n\n<p><strong>Edit: New selector after OP added the screenshots</strong>\nAll you need to do use some waits for the element to exists <strong>(not visible)</strong> and pass the <strong>options value</strong> of the desired country</p>\n\n<p>The following <code>xpath</code> should directly find the option of that <code>select</code> tag</p>\n\n<pre><code>//select[contains(@data-bind,'dates')]/option[@value='\" + country + \"']\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 0, "last_activity_date": 1420729764, "creation_date": 1420729764, "answer_id": 27843238, "question_id": 27810635, "link": "https://stackoverflow.com/questions/27810635/xpath-for-select-list-for-date-dropdowns-without-unique-class-names-or-ids/27843238#27843238", "title": "xpath for select_list for date dropdowns without unique class names or ids", "body": "<p>Instead of having to write the XPath, you could make use of the Watir API.</p>\n\n<p>The three select lists could be found by their data-bind attribute with:</p>\n\n<pre><code>browser.select_list(data_bind: /dates/)\nbrowser.select_list(data_bind: /months/)\nbrowser.select_list(data_bind: /years/)\n</code></pre>\n\n<p>Or if you need to restrict the locating of the select list to a specific element:</p>\n\n<pre><code>browser.element(id: 'hbf-ebs-personalDetails').select_list(data_bind: /dates/)\nbrowser.element(id: 'hbf-ebs-personalDetails').select_list(data_bind: /months/)\nbrowser.element(id: 'hbf-ebs-personalDetails').select_list(data_bind: /years/)\n</code></pre>\n\n<p>Ultimately this is the same as writing your own XPath since Watir creates an XPath from the above lines. However, many will find this easier to read and less error prone than writing XPath.</p>\n"}], "owner": {"reputation": 13, "user_id": 4426157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b855121153f7b8f78cfa8d286a512?s=128&d=identicon&r=PG&f=1", "display_name": "yotsubakoiwai", "link": "https://stackoverflow.com/users/4426157/yotsubakoiwai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 27810770, "answer_count": 2, "score": 1, "last_activity_date": 1420729764, "creation_date": 1420598280, "last_edit_date": 1420601101, "question_id": 27810635, "link": "https://stackoverflow.com/questions/27810635/xpath-for-select-list-for-date-dropdowns-without-unique-class-names-or-ids", "title": "xpath for select_list for date dropdowns without unique class names or ids", "body": "<p>what if the select_list is for date of birth and has the three dropdown lists:</p>\n\n<p>e.g. </p>\n\n<pre><code>select class=\"custom-select__select\" data-bind=\"customSelect, options: dates, optionsText: 'name', optionsValue: 'id', value: date\" style=\"opacity: 0;\"\n\nselect class=\"custom-select__select\" data-bind=\"customSelect, options: months, optionsText: 'name', optionsValue: 'id', value: month\" style=\"opacity: 0;\"\n\nselect class=\"custom-select__select\" data-bind=\"customSelect, options: years, optionsText: 'name', optionsValue: 'id', value: year\" style=\"opacity: 0;\"\n</code></pre>\n\n<p>they only differ in the data-bind options and value attribute.</p>\n\n<p>how can I get the correct <code>xpath</code> for those?</p>\n\n<p>thanks!!</p>\n"}, {"tags": ["ruby", "environment-variables", "shebang"], "comments": [{"owner": {"reputation": 8596, "user_id": 1376896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b783e2a88b07336a730d7b440ad6a96c?s=128&d=identicon&r=PG", "display_name": "Wenbing Li", "link": "https://stackoverflow.com/users/1376896/wenbing-li"}, "edited": false, "score": 0, "creation_date": 1420601140, "post_id": 27810625, "comment_id": 44030656, "body": "What is <code>.&#47;rubyscript</code> in your <code>.&#47;rbs</code> output?"}, {"owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "reply_to_user": {"reputation": 8596, "user_id": 1376896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b783e2a88b07336a730d7b440ad6a96c?s=128&d=identicon&r=PG", "display_name": "Wenbing Li", "link": "https://stackoverflow.com/users/1376896/wenbing-li"}, "edited": false, "score": 0, "creation_date": 1420601250, "post_id": 27810625, "comment_id": 44030674, "body": "Sorry, a typo. I will update it. It is just the ./rbs file."}, {"owner": {"reputation": 1056, "user_id": 4333534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94364e357329372fe537d2789c8127d?s=128&d=identicon&r=PG&f=1", "display_name": "roob", "link": "https://stackoverflow.com/users/4333534/roob"}, "edited": false, "score": 1, "creation_date": 1420603962, "post_id": 27810625, "comment_id": 44032112, "body": "Does <code>&#47;another&#47;.path&#47;to&#47;ruby rbs</code> work?"}], "answers": [{"comments": [{"owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "edited": false, "score": 1, "creation_date": 1420602912, "post_id": 27811041, "comment_id": 44031948, "body": "This is an excellent answer! Thanks, Mark. Your point that shims are scripts that can&#39;t themselves be shebang interpreters makes the perfect sense."}], "tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": true, "score": 7, "last_activity_date": 1422474724, "last_edit_date": 1422474724, "creation_date": 1420601623, "answer_id": 27811041, "question_id": 27810625, "link": "https://stackoverflow.com/questions/27810625/ruby-script-shebang-with-absolute-path-to-ruby-not-working/27811041#27811041", "title": "Ruby script: shebang with absolute path to ruby not working", "body": "<p>The <code>puts: command not found</code> message indicates that your script is not being run by Ruby, but by the shell instead.  So first, I would double-check your shebang line's syntax and path. </p>\n\n<p>Second, note that rbenv uses shims that dynamically find and run the right version of <code>ruby</code> (and associated programs like <code>gem</code>, etc).  But the shims are scripts, and scripts <em>can't themselves be shebang interpreters</em>; you have to find and use the actual path to the ruby executable (as output by <code>rbenv which ruby</code>).</p>\n\n<p>On the other hand, since <code>/usr/bin/env</code> <em>is</em> an executable, you can always use something like <code>#!/usr/bin/env ruby</code>, which will work even if the <code>ruby</code> it finds in the path is itself a script.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 4979247, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/62ee79072657fe96ab28acfdcd61cc1c?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/4979247/gabriel"}, "is_accepted": false, "score": 0, "last_activity_date": 1554170866, "creation_date": 1554170866, "answer_id": 55465952, "question_id": 27810625, "link": "https://stackoverflow.com/questions/27810625/ruby-script-shebang-with-absolute-path-to-ruby-not-working/55465952#55465952", "title": "Ruby script: shebang with absolute path to ruby not working", "body": "<p>I can't comment, (otherwise I'd add as a comment) but I think its worthwhile to add that the </p>\n\n<pre><code>#!/usr/bin/env ruby\n</code></pre>\n\n<p>MUST be the first line of the file. This tripped me up for a while. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/23974431/zsh-ruby-command-not-found?rq=1\">source</a></p>\n"}], "owner": {"reputation": 1346, "user_id": 2889276, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a70a4e6a20aedbb8bc298048bdcceeb?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/2889276/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1895, "favorite_count": 0, "accepted_answer_id": 27811041, "answer_count": 2, "score": 1, "last_activity_date": 1554170866, "creation_date": 1420598163, "last_edit_date": 1420601272, "question_id": 27810625, "link": "https://stackoverflow.com/questions/27810625/ruby-script-shebang-with-absolute-path-to-ruby-not-working", "title": "Ruby script: shebang with absolute path to ruby not working", "body": "<p>I am using Mac OS X. I have two versions (2.1.5 and 2.0.0) of Ruby installed. The former installed at /another/.path/to/ruby (there is a dot before \"path\" to mimic the fact that the path contains a dot-headed directory in between), in addition to the default system one (version 2.0.0) at /usr/bin/ruby. I used rbenv to install Ruby.</p>\n\n<p>After I manually set the PATH environment variable so the default ruby command will be found in another directory: /another/.path/to/ruby. Now I check </p>\n\n<pre><code>which -a ruby\n</code></pre>\n\n<p>It is using correct ruby first, as output. </p>\n\n<pre><code>/another/.path/to/ruby\n/usr/bin/ruby\n</code></pre>\n\n<p>Now I create a script, rbs, with the first line of shebang specifying the ruby to use.</p>\n\n<pre><code>#!/usr/bin/env ruby\nputs 'hey there'\n</code></pre>\n\n<p>Then I run</p>\n\n<pre><code>./rbs\n</code></pre>\n\n<p>it outputs 'hey there'. Good. Meanwhile, the Ruby is using the correct version.</p>\n\n<pre><code>/usr/bin/env ruby --version\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>ruby --version\n</code></pre>\n\n<p>both output 2.1.5. So it does great job to use the new version.</p>\n\n<p>However, here is where the problem occurs: now I update rbs file to be:</p>\n\n<pre><code>#!/another/.path/to/ruby\nputs 'hey there'\n</code></pre>\n\n<p>Note that I updated the shebang to use the absolute path to the desired ruby. then I run</p>\n\n<pre><code>./rbs\n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>./rbs: line 2: puts: command not found\n</code></pre>\n\n<p>which is too weird;</p>\n\n<p>but if I run</p>\n\n<pre><code>ruby ./rbs\n</code></pre>\n\n<p>it outputs 'hey there' as normal. It looks like the shebang works perfect using /usr/bin/env ruby, but not for absolute path for the newly install ruby?</p>\n\n<p>Why is this? Is there a way to fix it so the updated script can still work by typing the following?</p>\n\n<pre><code>./rbs\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations", "relationship", "tabular"], "comments": [{"owner": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "edited": false, "score": 1, "creation_date": 1420598207, "post_id": 27810578, "comment_id": 44029953, "body": "You should try to write some code on your own, then post your code for help if you&#39;re stuck."}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 3728, "user_id": 2612713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0a7f606f9e135589780620d1160d941e?s=128&d=identicon&r=PG&f=1", "display_name": "neo", "link": "https://stackoverflow.com/users/2612713/neo"}, "edited": false, "score": 0, "creation_date": 1420606874, "post_id": 27810578, "comment_id": 44032766, "body": "I tried googling but idk where to go from here or where to start"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1420607681, "post_id": 27810578, "comment_id": 44032962, "body": "Seems easy, you just make a table and populate it with a bunch of strings <code>&quot;Result&quot;</code> unless the column is the last one, in which case you write <code>&quot;Date&quot;</code>. Kidding aside, you need to do a bit better description of your requirements. For instance, what happens if a metric doesn&#39;t have a result on a given date? What happens if it has several? A different number than another metric? What happens if a date doesn&#39;t have any results at all? Real or real-looking data is way more useful than just a static placeholder; the latter hides design complexity."}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488755203, "creation_date": 1420597830, "last_edit_date": 1488755203, "question_id": 27810578, "link": "https://stackoverflow.com/questions/27810578/how-can-i-create-a-relationship-b-n-columns-rows", "title": "How can I Create a Relationship b/n Columns &amp; Rows", "body": "<p>Currently my index page is formatted like this picture:</p>\n\n<p><img src=\"https://i.stack.imgur.com/zh1K3.png\" alt=\"enter image description here\"></p>\n\n<p>But I'd like the page to look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/DCXMJ.png\" alt=\"enter image description here\"></p>\n\n<p>How can I create this relationship where when the _form outputs <strong>name</strong> | <strong>metric</strong> | <strong>result</strong> | <strong>date</strong> that it creates a new row of result &amp; date if their is already a preexisting name &amp; metric in the system?</p>\n\n<p>From what I read this seems like a daunting task so any help would be much appreciated.</p>\n"}, {"tags": ["jquery", "ruby", "shopify", "liquid", "jcarousel"], "answers": [{"tags": [], "owner": {"reputation": 10579, "user_id": 1367622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/596f7b851dee04ff0f9a2e28fe4219fe?s=128&d=identicon&r=PG", "display_name": "Steph Sharp", "link": "https://stackoverflow.com/users/1367622/steph-sharp"}, "is_accepted": true, "score": 0, "last_activity_date": 1420598322, "last_edit_date": 1420598322, "creation_date": 1420597925, "answer_id": 27810591, "question_id": 27810056, "link": "https://stackoverflow.com/questions/27810056/add-links-to-jcarousel-images/27810591#27810591", "title": "Add links to jCarousel Images", "body": "<p>Looks like each slide already has a button with a link that is set in Settings:</p>\n\n<pre><code>&lt;a class=\"btn btn-lg btn-default\" href=\"{{ settings[link] | escape }}\" role=\"button\"&gt;{{ settings[link_text] | escape }}&lt;/a&gt;\n</code></pre>\n\n<p>If you're not already using this functionality for something else, you could modify this code to add the link to the image itself rather than the button. Then you don't need to change anything else.</p>\n\n<p>For example:</p>\n\n<pre><code>&lt;div class=\"item{% if i == 1 %} active {% endif %}\"&gt;\n  &lt;a href=\"{{ settings[link] | escape }}\"&gt;&lt;img src=\"{{ image | asset_url }}\" alt=\"{{ settings[headline] | escape }}\" /&gt;&lt;/a&gt;\n  &lt;div class=\"slide-container\"&gt;\n    ...\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>If you're already using the button to link to something else, you'd need to add additional fields to Settings to hold the product links and do something like this:</p>\n\n<pre><code>{% capture image_link %}slide_{{ i }}_image_link{% endcapture %}\n...\n&lt;a href=\"{{ settings[image_link] | escape }}\"&gt;&lt;img src=\"{{ image | asset_url }}\" alt=\"{{ settings[headline] | escape }}\" /&gt;&lt;/a&gt;\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 2113125, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/dbGvn.png?s=128&g=1", "display_name": "amoeboar", "link": "https://stackoverflow.com/users/2113125/amoeboar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 27810591, "answer_count": 1, "score": 0, "last_activity_date": 1420598322, "creation_date": 1420593859, "question_id": 27810056, "link": "https://stackoverflow.com/questions/27810056/add-links-to-jcarousel-images", "title": "Add links to jCarousel Images", "body": "<p>I am working with jQuery to add a jCarousel to my homepage on Shopify. The carousel displays and scrolls properly, but I need to add links to each of the images so that when the image is clicked, the user is directed to the specific product page.</p>\n\n<p>Shopify uses a templating engine called liquid which is a variant on Ruby. I have no knowledge of Ruby or how to implement the functionality I'm seeking.</p>\n\n<p>Below is the snippet where I am using the jCarousel. Can anyone suggest where to modify the code so that I create links for each of the images?</p>\n\n<pre><code>&lt;div class=\"carousel-inner\"&gt;\n{% for i in (1..4) %}\n{% capture show_slide %}slide_{{ i }}{% endcapture %}\n{% capture image %}slideshow_{{ i }}.jpg{% endcapture %}\n{% capture link %}slide_{{ i }}_link{% endcapture %}\n{% capture link_text %}slide_{{ i }}_link_text{% endcapture %}\n{% capture headline %}slide_{{ i }}_headline{% endcapture %}\n{% capture content %}slide_{{ i }}_content{% endcapture %}\n{% if settings[show_slide] %}\n&lt;div class=\"item{% if i == 1 %} active {% endif %}\"&gt;\n  &lt;img src=\"{{ image | asset_url }}\" alt=\"{{ settings[headline] | escape }}\" /&gt;\n  &lt;div class=\"slide-container\"&gt;\n    &lt;div class=\"container-fluid\"&gt;\n      &lt;div class=\"carousel-caption col-md-5 col-sm-10\"&gt;\n        &lt;h1&gt;{{ settings[headline] | escape }}&lt;/h1&gt;\n        &lt;p&gt;{{ settings[content] | escape }}&lt;/p&gt;\n        &lt;a class=\"btn btn-lg btn-default\" href=\"{{ settings[link] | escape }}\" role=\"button\"&gt;{{ settings[link_text] | escape }}&lt;/a&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n{% endif %}\n{% endfor %}\n</code></pre>\n\n<p>    </p>\n"}, {"tags": ["ruby", "if-statement", "ruby-on-rails-4", "error-handling", "null"], "comments": [{"owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "edited": false, "score": 0, "creation_date": 1420594720, "post_id": 27810052, "comment_id": 44029103, "body": "This issue should be solved before it reaches this piece of code. By means of <a href=\"http://edgeapi.rubyonrails.org/classes/ActionController/Parameters.html#method-i-require\" rel=\"nofollow noreferrer\">strong parameters</a> for example."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "edited": false, "score": 0, "creation_date": 1420595767, "post_id": 27810052, "comment_id": 44029375, "body": "@IvanDenisov No, models can be edited by all sorts of things that don&#39;t go through controllers."}, {"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1420596641, "post_id": 27810052, "comment_id": 44029580, "body": "Thanks, to the point about strong params, I&#39;m not sure why but I have those in place (Ivan&#39;s answer below), yet somehow things are still sneaking in. I&#39;m sure there&#39;s an actual logical reason for this, but I can&#39;t figure it out so this is my stopgap solution"}], "answers": [{"comments": [{"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1420596597, "post_id": 27810131, "comment_id": 44029559, "body": "Hi I did this but slightly different in that I just used a ternary operator <code>rr.delivery_start = (request_params[:deliverydate] != &quot;&quot; &amp;&amp; request_params[:deliverydate] != nil &amp;&amp; request_params[:deliverytime_start] != &quot;&quot; &amp;&amp; request_params[:deliverytime_start] != nil) ? Time.zone.parse(request_params[:deliverydate] + &quot; &quot; + request_params[:deliverytime_start]).utc : nil</code>"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 1, "creation_date": 1420601345, "post_id": 27810131, "comment_id": 44030696, "body": "<code>present?</code> does a check for <code>!= nil &amp;&amp; != &quot;&quot;</code> -&gt; it&#39;s shorter :) plus that&#39;s a hugely long ternary line... remember that code is written primarily for humans to understand, and only secondarily for computers to parse..."}], "tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": true, "score": 1, "last_activity_date": 1420601543, "last_edit_date": 1420601543, "creation_date": 1420594548, "answer_id": 27810131, "question_id": 27810052, "link": "https://stackoverflow.com/questions/27810052/assign-variable-as-either-output-of-equation-or-nil-if-equation-cant-run-circu/27810131#27810131", "title": "Assign variable as either output of equation OR nil if equation can&#39;t run (circumventing NoMethodError)", "body": "<p>How about checking if those params exist instead?</p>\n\n<pre><code>@rentalrequest = RentalRequest.new do |rr|\n  rr.delivery_start = nil\n  if request_params[:deliverydate].present? &amp;&amp; request_params[:deliverytime_start].present?\n    rr.delivery_start = Time.zone.parse(request_params[:deliverydate] + \" \" + request_params[:deliverytime_start]).utc\n  end\n  ...\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 1, "last_activity_date": 1420594559, "creation_date": 1420594559, "answer_id": 27810133, "question_id": 27810052, "link": "https://stackoverflow.com/questions/27810052/assign-variable-as-either-output-of-equation-or-nil-if-equation-cant-run-circu/27810133#27810133", "title": "Assign variable as either output of equation OR nil if equation can&#39;t run (circumventing NoMethodError)", "body": "<p>Your calculation is in the wrong place, your model should be maintaining its own state by itself. Something like this perhaps:</p>\n\n<pre><code>class RentalRequest &lt; ActiveRecord::Base\n  before_validation :set_delivery_start\nprivate\n  def set_delivery_start\n    # Presumably validations will catch these conditions...\n    return if(!deliverydate || !deliverytime_start)\n    self.delivery_start = ... # whatever calculation matches the deliverydate and delivertime_start types goes here\n  end\nend\n</code></pre>\n\n<p>and then you'd have validations to ensure that all three delivery values made sense.</p>\n"}, {"tags": [], "owner": {"reputation": 1382, "user_id": 2886945, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IgtEd.jpg?s=128&g=1", "display_name": "Ivan Denysov", "link": "https://stackoverflow.com/users/2886945/ivan-denysov"}, "is_accepted": false, "score": 1, "last_activity_date": 1420595127, "creation_date": 1420595127, "answer_id": 27810212, "question_id": 27810052, "link": "https://stackoverflow.com/questions/27810052/assign-variable-as-either-output-of-equation-or-nil-if-equation-cant-run-circu/27810212#27810212", "title": "Assign variable as either output of equation OR nil if equation can&#39;t run (circumventing NoMethodError)", "body": "<p>You can <code>require</code> those parameters if <code>new</code> block is in controller.</p>\n\n<pre><code>def request_params\n  params\n    .require(:rental_request)\n    .permit(..., :deliverydate, :deliverytime_start)\n    .require(:deliverydate, :deliverytime_start)\nend\n</code></pre>\n"}], "owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 27810131, "answer_count": 3, "score": 0, "last_activity_date": 1420601543, "creation_date": 1420593831, "question_id": 27810052, "link": "https://stackoverflow.com/questions/27810052/assign-variable-as-either-output-of-equation-or-nil-if-equation-cant-run-circu", "title": "Assign variable as either output of equation OR nil if equation can&#39;t run (circumventing NoMethodError)", "body": "<p>I'm saving an object as such:</p>\n\n<pre><code>@rentalrequest = RentalRequest.new do |rr|\n  rr.delivery_start = Time.zone.parse(request_params[:deliverydate] + \" \" + request_params[:deliverytime_start]).utc\n  ...\nend\n</code></pre>\n\n<p>Every once in a while, my front end validation fails, and somehow, the form is posted even though <code>deliverydate</code> and <code>deliverytime_start</code> are blank. In this case, the controller breaks with a <code>NoMethodError</code> because this statement doesn't make sense:\n    Time.zone.parse(\"\")</p>\n\n<p>However, rather than having to write a rescue for when this happens, I feel like it's so much easier if I can just say <code>rr.delivery_start = nil if Time.zone.parse doesn't work</code>. That way, the back end validation on the @rentalrequest object kicks in and serves as a rescue.</p>\n\n<p>But I'm not sure how to write the <code>rr.delivery_start = nil if Time.zone.parse doesn't work</code> (like... if any part of it doesn't work)</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "passenger", "cpu"], "comments": [{"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1420593984, "post_id": 27809904, "comment_id": 44028912, "body": "any loops in your code?"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1420594015, "post_id": 27809904, "comment_id": 44028918, "body": "If an instance gets into this state, does it ever recover from it (after an hour, a day)? Do you have New Relic or a similar tool running, that might give you insights into slow controller actions? Is it possible that this instances might run extrem complex queries on the database, did you have a look into the database&#39;s log?"}, {"owner": {"reputation": 255, "user_id": 1347348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3dd957698d5f8f2ff674462a3fde700?s=128&d=identicon&r=PG", "display_name": "fedenusy", "link": "https://stackoverflow.com/users/1347348/fedenusy"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1420594164, "post_id": 27809904, "comment_id": 44028952, "body": "Good tips! @Rots, yes, there are lots of loops in my code. The codebase is rather large though, so statically inspecting each loop would take too long."}, {"owner": {"reputation": 255, "user_id": 1347348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3dd957698d5f8f2ff674462a3fde700?s=128&d=identicon&r=PG", "display_name": "fedenusy", "link": "https://stackoverflow.com/users/1347348/fedenusy"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1420594319, "post_id": 27809904, "comment_id": 44028992, "body": "@spickermann AFAIK, the instance never recovers. I do have New Relic, and all my controller actions run in under 1s. Average response time is 150ms (until all the instances get clogged up, anyway). I don&#39;t think there are any extremely complex queries running, but I&#39;ll have a look at the DB logs."}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1420594508, "post_id": 27809904, "comment_id": 44029044, "body": "@fedenusy how about writing to a log file on every loop iteration, perhaps a simple number per loop. Then when you get a 56% cpu you might see a lot of 1&#39;s, or 2&#39;s, to help narrow it down."}, {"owner": {"reputation": 255, "user_id": 1347348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3dd957698d5f8f2ff674462a3fde700?s=128&d=identicon&r=PG", "display_name": "fedenusy", "link": "https://stackoverflow.com/users/1347348/fedenusy"}, "reply_to_user": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1420594948, "post_id": 27809904, "comment_id": 44029162, "body": "@Rots that doesn&#39;t sound like a good idea. With hundreds - thousands of loops in my codebase, it would take a long time to implement. With ~200 requests / minute, the log files would become totally unreadable."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1420595465, "post_id": 27809904, "comment_id": 44029290, "body": "I am not familiar with Passenger, but I would not be surprised if Passenger writes (or can be configured to write) incomming requests into a logfile. Or you could add a before_filter to your app that does this. Searching for the latest entry for a given PID might help to find a pattern."}, {"owner": {"reputation": 255, "user_id": 1347348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3dd957698d5f8f2ff674462a3fde700?s=128&d=identicon&r=PG", "display_name": "fedenusy", "link": "https://stackoverflow.com/users/1347348/fedenusy"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1420595667, "post_id": 27809904, "comment_id": 44029345, "body": "Good idea @spickermann, I&#39;ll add PID to my logs. Might help narrow it down."}, {"owner": {"reputation": 5286, "user_id": 455770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mMHwz.jpg?s=128&g=1", "display_name": "Rots", "link": "https://stackoverflow.com/users/455770/rots"}, "edited": false, "score": 0, "creation_date": 1420602529, "post_id": 27809904, "comment_id": 44031885, "body": "@fedenusy The loop idea does sound like a chore with your codebase. If I was debugging the problem on windows i&#39;d take a memory dump and analyze using windbg, perhaps there are similar tools for your OS."}], "owner": {"reputation": 255, "user_id": 1347348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3dd957698d5f8f2ff674462a3fde700?s=128&d=identicon&r=PG", "display_name": "fedenusy", "link": "https://stackoverflow.com/users/1347348/fedenusy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1420592587, "creation_date": 1420592587, "question_id": 27809904, "link": "https://stackoverflow.com/questions/27809904/passenger-instance-becomes-idle-starts-chewing-up-cpu", "title": "Passenger instance becomes idle, starts chewing up CPU", "body": "<p>Here's the <code>passenger-status</code> output from one of my affected production instances:</p>\n\n<pre><code>Version : 4.0.53\nDate    : 2015-01-07 00:59:55 +0000\nInstance: 6919\n----------- General information -----------\nMax pool size : 8\nProcesses     : 8\nRequests in top-level queue : 0\n\n----------- Application groups -----------\n/home/app/web#default:\n  App root: /home/app/web\n  Requests in queue: 0\n  * PID: 7009    Sessions: 1       Processed: 1607    Uptime: 53m 19s\n    CPU: 7%      Memory  : 217M    Last used: 2m 51s ago\n  * PID: 7021    Sessions: 1       Processed: 1823    Uptime: 53m 19s\n    CPU: 6%      Memory  : 217M    Last used: 2s ago\n  * PID: 7032    Sessions: 0       Processed: 2241    Uptime: 53m 19s\n    CPU: 7%      Memory  : 218M    Last used: 2s ago\n  * PID: 7044    Sessions: 1       Processed: 1539    Uptime: 53m 19s\n    CPU: 15%     Memory  : 209M    Last used: 14m 27s ago\n  * PID: 7057    Sessions: 0       Processed: 1549    Uptime: 53m 19s\n    CPU: 5%      Memory  : 217M    Last used: 1s ago\n  * PID: 7074    Sessions: 1       Processed: 554     Uptime: 53m 18s\n    CPU: 41%     Memory  : 220M    Last used: 41m 37s ago\n  * PID: 7085    Sessions: 1       Processed: 1564    Uptime: 53m 18s\n    CPU: 10%     Memory  : 219M    Last used: 7m 5s ago\n  * PID: 7106    Sessions: 1       Processed: 14      Uptime: 53m 17s\n    CPU: 56%     Memory  : 174M    Last used: 52m 30s ago\n</code></pre>\n\n<p>As you can see, two of the 8 instances have not been used in >40min, and yet they're chewing up most of my machine's CPU. Any tips on how to go about debugging this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "time"], "answers": [{"comments": [{"owner": {"reputation": 5220, "user_id": 2442926, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4b97751a77122dbf89ecb928967efbab?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/2442926/ben"}, "edited": false, "score": 0, "creation_date": 1420593389, "post_id": 27809884, "comment_id": 44028798, "body": "I was missing the comma, for the day before yesterday you can use Visitor.where(&quot;DATE(created_at) = ?&quot;, Date.yesterday-1). It works.thanks"}, {"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 1, "creation_date": 1420662687, "post_id": 27809884, "comment_id": 44062101, "body": "Do not use <code>Date.today</code>, etc as they do not take into account the time zone."}], "tags": [], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "is_accepted": true, "score": 1, "last_activity_date": 1420592470, "last_edit_date": 1495541569, "creation_date": 1420592470, "answer_id": 27809884, "question_id": 27809849, "link": "https://stackoverflow.com/questions/27809849/return-table-columns-done-today-and-yesterday-in-ruby-on-rails/27809884#27809884", "title": "Return table columns done today and yesterday in ruby on rails", "body": "<pre><code>#Today\nVisitor.where(\"DATE(created_at) = ?\", Date.today)\n#Yesterday\nVisitor.where(\"DATE(created_at) = ?\", Date.yesterday)\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>#Today\nVisitor.where(created_at: Date.today...Date.today+1)\n#Yesterday\nVisitor.where(created_at: Date.yesterday...Date.today)\n</code></pre>\n\n<p>Ref: <a href=\"https://stackoverflow.com/questions/3570740/how-can-i-find-records-from-today-yesterday-and-so-on-with-ruby-on-rails\">How can I find records from today, yesterday and so on with Ruby on Rails?</a></p>\n"}, {"tags": [], "owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "is_accepted": false, "score": 1, "last_activity_date": 1420592547, "creation_date": 1420592547, "answer_id": 27809900, "question_id": 27809849, "link": "https://stackoverflow.com/questions/27809849/return-table-columns-done-today-and-yesterday-in-ruby-on-rails/27809900#27809900", "title": "Return table columns done today and yesterday in ruby on rails", "body": "<p>To get visitors created after a certain time, for example the last 2 days:</p>\n\n<pre><code>Visitor.where([\"created_at &gt; ?\", 2.days.ago.midnight])\n</code></pre>\n"}], "owner": {"reputation": 5220, "user_id": 2442926, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4b97751a77122dbf89ecb928967efbab?s=128&d=identicon&r=PG", "display_name": "ben", "link": "https://stackoverflow.com/users/2442926/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 1, "accepted_answer_id": 27809884, "answer_count": 2, "score": 1, "last_activity_date": 1420592547, "creation_date": 1420592228, "question_id": 27809849, "link": "https://stackoverflow.com/questions/27809849/return-table-columns-done-today-and-yesterday-in-ruby-on-rails", "title": "Return table columns done today and yesterday in ruby on rails", "body": "<p>I am trying to get the records created only today, yesterday, and the day before yesterday. My model is <strong>Visitor</strong></p>\n\n<p>For items created today, I am trying </p>\n\n<pre><code>Visitor.where(created_at: Date.today)\n</code></pre>\n\n<p>And then for items created yesterday, I am trying </p>\n\n<pre><code>Visitor.where(created_at: Date.yesterday)\n</code></pre>\n\n<p>But then it is not working because the Created_at column is in form of a timestamp, while Date.today or yesterday is in a date format. How can I make this work.\nAnd also how can I get the items creates the day before yesterday?</p>\n"}, {"tags": ["ruby", "string", "insert", "match"], "answers": [{"comments": [{"owner": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "edited": false, "score": 0, "creation_date": 1420725088, "post_id": 27810471, "comment_id": 44087078, "body": "Thanks Jamin, this code works fine when I use it on bash shell, but not inside a ruby script. How can I reformat this code to use inside a ruby script. Forgive my ignorance on this, I am a newbie in ruby. Also, I have written a code too, which could help me. Please see my update in the original question"}, {"owner": {"reputation": 376, "user_id": 3552599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgUIE.png?s=128&g=1", "display_name": "Jamin Kortegard", "link": "https://stackoverflow.com/users/3552599/jamin-kortegard"}, "reply_to_user": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "edited": false, "score": 0, "creation_date": 1420832076, "post_id": 27810471, "comment_id": 44138126, "body": "Hi, Vikas. See my edit above. Regarding your added code using the &#39;r+&#39; mode for modifying a file in-place, I&#39;ve honestly never done it that way. Maybe it&#39;s out of habit, but I&#39;ve always created temp files with modified content and then renamed them to replace an existing file."}, {"owner": {"reputation": 376, "user_id": 3552599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgUIE.png?s=128&g=1", "display_name": "Jamin Kortegard", "link": "https://stackoverflow.com/users/3552599/jamin-kortegard"}, "reply_to_user": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "edited": false, "score": 0, "creation_date": 1421184022, "post_id": 27810471, "comment_id": 44260894, "body": "I see your edits below (can only comment here). It works, but you could clean it up by using <code>%q</code> instead of <code>%qw</code> on the first line. <code>%qw</code> gives an array of quoted words. If you just want to insert a static block of text, you could use <code>%q</code> (single quote operator) and then later, remove the <code>txt_to_insert.each do |ip| ... end</code> loop and instead just print the whole text block to your file with <code>temp_file.puts txt_to_insert</code>. Keep in mind that <code>%q()</code> keeps line breaks within the parentheses so you should start with <code>%q(nameserver 192.168.181.2</code> then a line break."}, {"owner": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "edited": false, "score": 0, "creation_date": 1421231441, "post_id": 27810471, "comment_id": 44277478, "body": "Perfect, I&#39;ve modified my code as per your suggestions. Thanks."}], "tags": [], "owner": {"reputation": 376, "user_id": 3552599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgUIE.png?s=128&g=1", "display_name": "Jamin Kortegard", "link": "https://stackoverflow.com/users/3552599/jamin-kortegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1420831196, "last_edit_date": 1420831196, "creation_date": 1420597097, "answer_id": 27810471, "question_id": 27809681, "link": "https://stackoverflow.com/questions/27809681/ruby-insert-a-string-after-before-a-pattern/27810471#27810471", "title": "Ruby: Insert a string after/before a pattern", "body": "<p>Here's a Ruby \"one-liner\" that does what I think you're trying to do. I created a <code>resolv.conf</code> file matching your first file contents. Then the following Ruby \"one-liner\", which I broke into several lines for readability, searches for a line that begins with \"nameserver\" and inserts an arbitrary list of new namservers with IPs you define.</p>\n\n<pre><code>$ cat resolv.conf\nsearch reachvikas.com\nnameserver 192.168.1.27\n\n$ ruby -wnl -i.$SECONDS -e '\nBEGIN { server_ips = %w(\n  ip1\n  ip2\n  ip3\n  ) }\nif $_.start_with?(\"nameserver\")\n  server_ips.each{ |ip| puts \"nameserver #{ip}\"; }\nend\nputs $_\n' resolv.conf\n\n$ ls resolv.conf*\nresolv.conf       resolv.conf.27729\n\n$ cat resolv.conf\nsearch reachvikas.com\nnameserver ip1\nnameserver ip2\nnameserver ip3\nnameserver 192.168.1.27\n\n$ cat resolv.conf.27729\nsearch reachvikas.com\nnameserver 192.168.1.27\n</code></pre>\n\n<p>If you truly want it as a one-liner, you have to add semicolons where line breaks are needed:</p>\n\n<pre><code>ruby -wnl -i.$SECONDS -e 'BEGIN { server_ips = %w(ip1 ip2 ip3); }; if $_.start_with?(\"nameserver\") ; server_ips.each{|ip| puts \"nameserver #{ip}\";}; end; puts $_;' resolv.conf\n</code></pre>\n\n<p>The <code>-i.$SECONDS</code> flag tells the Ruby interpreter to modify your input file in-place and to save the original version with a filename extension of <code>$SECONDS</code>, which is the number of seconds your terminal session has been alive. That makes it very unlikely you will permanently clobber a good file with bad code. The backup copies are there if you need them. You just have to clean up afterwards.</p>\n\n<p><strong>EDIT:</strong> Here's a short script that inserts rows into an existing file. Note that this does not save multiple copies of the input file like the one-liner does. This script reads an input file (resolv.conf), saves modified output to a temp file, then renames that temp file, replacing the original file. You would run this in the terminal like this <code>$ ./script.rb resolv.conf</code></p>\n\n<p><strong>Script:</strong></p>\n\n<pre><code>#! /usr/bin/env ruby\n\nrequire 'tempfile'\nrequire 'fileutils'\n\nserver_ips = %w(\n  ip1\n  ip2\n  ip3\n)\n\ninput_file = ARGV[0]\ntemp_file = Tempfile.new(\"#{input_file}.temp\")\nmodified = false\n\nbegin\n  File.open(input_file, 'r') do |file|\n    file.each_line do |line|\n      if modified == false &amp;&amp; line.start_with?('nameserver')\n        server_ips.each do |ip|\n          temp_file.puts \"nameserver #{ip}\"\n        end\n        modified = true\n      end\n      temp_file.print line\n    end\n  end\n  temp_file.close\n  FileUtils.mv(temp_file.path, input_file)\nensure\n  temp_file.close!\nend\n</code></pre>\n\n<p>See the Ruby documentation for the <a href=\"http://www.ruby-doc.org/stdlib-2.1.5/libdoc/tempfile/rdoc/Tempfile.html\" rel=\"nofollow\">Tempfile</a> class for an explanation of the <code>begin... ensure... end</code> usage and the explicit <code>close</code> on the Tempfile object.</p>\n"}, {"tags": [], "owner": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "is_accepted": false, "score": 0, "last_activity_date": 1421231546, "last_edit_date": 1421231546, "creation_date": 1420890689, "answer_id": 27875924, "question_id": 27809681, "link": "https://stackoverflow.com/questions/27809681/ruby-insert-a-string-after-before-a-pattern/27875924#27875924", "title": "Ruby: Insert a string after/before a pattern", "body": "<p>Many thanks Jamin. I have slightly modified your code to suit my future needs as well, like if someone wants to add a block of lines with spaces before a keyword/pattern. This is what I have come up with. May be this helps someone.</p>\n\n<pre><code>txt_to_insert = %q(nameserver 192.168.181.2\nnameserver 8.8.8.8)\n\ninput_file = \"/etc/resolv.conf\"\ntemp_file = Tempfile.new(\"tmp_file.temp\")\nmodified = false\n\nbegin\n  File.open(input_file, 'r') do |file|\n    file.each_line do |line|\n      if modified == false &amp;&amp; line.start_with?('nameserver')\n        temp_file.puts txt_to_insert\n        modified = true\n      end\n     temp_file.print line\n    end\n  end\n  temp_file.close\n  FileUtils.mv(temp_file.path, input_file)\n  ensure\n    temp_file.close!\nend\n</code></pre>\n"}], "owner": {"reputation": 3731, "user_id": 3438276, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d936bbca4445305c07f2292689d271c1?s=128&d=identicon&r=PG", "display_name": "vikas027", "link": "https://stackoverflow.com/users/3438276/vikas027"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "accepted_answer_id": 27810471, "answer_count": 2, "score": 1, "last_activity_date": 1421231546, "creation_date": 1420590926, "last_edit_date": 1420724994, "question_id": 27809681, "link": "https://stackoverflow.com/questions/27809681/ruby-insert-a-string-after-before-a-pattern", "title": "Ruby: Insert a string after/before a pattern", "body": "<p>I know how to add string(or text) to end of the file as well as beginning of the file, but could not google out the way to insert string (with a variable) after/before a pattern.</p>\n\n<p>For example,</p>\n\n<pre><code>root@vikas:~# cat /etc/resolv.conf\nsearch reachvikas.com\nnameserver 192.168.1.27\nroot@vikas:~#\n</code></pre>\n\n<p>Now, I want to add another nameserver like below. </p>\n\n<pre><code>root@vikas:~# cat /etc/resolv.conf\nsearch reachvikas.com\nnameserver 192.168.181.2\nnameserver 192.168.1.27\nroot@vikas:~#\n</code></pre>\n\n<p>I can do this with sed easily, but just looking a way out with Ruby.</p>\n\n<p><strong>Update</strong>: I have written below code, but this replaces the last line does not adds one. I guess tweaking <em>file.seek</em> would help me, but not sure how.   </p>\n\n<pre><code>File.open('/etc/resolv.conf', 'r+') do |file|  \n  count = Integer(0)  \n  file.each do |line|  \n  #puts count  \n    if count == 1  \n      #puts count.to_i  \n      file.seek(-1, IO::SEEK_CUR)  \n      file.puts(\"\\nnameserver 192.168.181.2\")  \n     end  \n   count += 1  \n   end  \nend \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "timezone", "bootstrap-datetimepicker"], "answers": [{"tags": [], "owner": {"reputation": 12345, "user_id": 429758, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ff984622cd3a9ca31bd0e7e034fc8b17?s=128&d=identicon&r=PG", "display_name": "Prakash Murthy", "link": "https://stackoverflow.com/users/429758/prakash-murthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1420591175, "creation_date": 1420591175, "answer_id": 27809713, "question_id": 27809613, "link": "https://stackoverflow.com/questions/27809613/comparing-times-with-time-zones-in-rails/27809713#27809713", "title": "Comparing times with time zones in rails", "body": "<p>Use <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/TimeWithZone.html#method-i-in_time_zone\" rel=\"nofollow\">in_time_zone</a>.</p>\n\n<p>See <a href=\"https://www.reinteractive.net/posts/168-dealing-with-timezones-effectively-in-rails\" rel=\"nofollow\">https://www.reinteractive.net/posts/168-dealing-with-timezones-effectively-in-rails</a> &amp; <a href=\"http://www.elabs.se/blog/36-working-with-time-zones-in-ruby-on-rails\" rel=\"nofollow\">http://www.elabs.se/blog/36-working-with-time-zones-in-ruby-on-rails</a> for good advice on working with timezones in rails.</p>\n"}], "owner": {"reputation": 2071, "user_id": 1499260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cf6ki.jpg?s=128&g=1", "display_name": "jackerman09", "link": "https://stackoverflow.com/users/1499260/jackerman09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2027, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1420591175, "creation_date": 1420590536, "question_id": 27809613, "link": "https://stackoverflow.com/questions/27809613/comparing-times-with-time-zones-in-rails", "title": "Comparing times with time zones in rails", "body": "<p>I am using Ruby 2.1.2 and Rails 4.1.4</p>\n\n<p><strong>tl;dr;</strong> I am getting a date &amp; time from the user that comes into the controller from a form (via params) like this:</p>\n\n<pre><code>pickuptime = params[:appointment][:pickuptime]\n(byebug) pickuptime\n\"01/06/2015 7:26 PM\"\n</code></pre>\n\n<p>and I need to make sure it is in the future so that customers can't create appointments in the past, and I have the customer's time_zone stored in the database because customers may be in different places.</p>\n\n<p><strong>Detail:</strong></p>\n\n<p>I am getting a time in my controller via a form:</p>\n\n<pre><code>pickuptime = params[:appointment][:pickuptime]\n(byebug) pickuptime\n\"01/06/2015 7:26 PM\"\n</code></pre>\n\n<p>I then convert it to a <code>DateTime</code> so that I can build an appointment record:</p>\n\n<pre><code>pickuptime = DateTime.strptime(pickuptime, \"%m/%d/%Y %l:%M %p\")\n@appointment = @car.appointments.build(garage_id: garage_id, pickuptime: pickuptime)\n</code></pre>\n\n<p>My <code>Appointment</code> model has a validation that ensures that you cannot create an appointment in the past:</p>\n\n<pre><code>def pickuptime_is_in_future\n  if pickuptime &lt; Time.current\n    errors.add(:pickuptime, \"Appointment must be in the future\")\n  end\nend\n</code></pre>\n\n<p>I would like to take into account the customer's time_zone (<code>@car.garage.time_zone</code>), which is stored in the database, when building the appointment, e.g.</p>\n\n<pre><code>pry(main)&gt; Garage.first.time_zone\nGarage Load (0.6ms)  SELECT  \"garages\".* FROM \"garages\"   ORDER BY \"garages\".\"id\" ASC LIMIT 1\n=&gt; \"Eastern Time (US &amp; Canada)\"\n</code></pre>\n\n<p>Right now this is not working. When I create an appointment for 1 minute in the future, I get the following:</p>\n\n<pre><code>(byebug) pickuptime\nTue, 06 Jan 2015 19:22:00 UTC +00:00\n(byebug) Time.current\nWed, 07 Jan 2015 00:21:53 UTC +00:00\n</code></pre>\n\n<p>which causes the validation to fail, despite the fact that the appointment was created in the future and should therefore succeed.</p>\n\n<p>Any guidance on how to implement this correctly would be much appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1544, "user_id": 2945764, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed8e3698f939f2431e29d0f6c2f7dcfc?s=128&d=identicon&r=PG", "display_name": "damianesteban", "link": "https://stackoverflow.com/users/2945764/damianesteban"}, "edited": false, "score": 0, "creation_date": 1420591258, "post_id": 27809700, "comment_id": 44028341, "body": "Indeed I had not.  I guess I got confused because I already had <code>click_link &#39;New Comic book&#39;</code>  Thank you."}], "tags": [], "owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "is_accepted": true, "score": 1, "last_activity_date": 1420591074, "creation_date": 1420591074, "answer_id": 27809700, "question_id": 27809580, "link": "https://stackoverflow.com/questions/27809580/basic-spec-failing-with-capybara-rspec-3-rails-4-have-content/27809700#27809700", "title": "Basic spec failing with Capybara / RSpec 3 / Rails 4 (have_content)", "body": "<p>You haven't clicked the button to submit the form, in your test.</p>\n\n<p>It will likely be something like <code>click_button \"Create Comic Book\"</code> after filling in the form.</p>\n"}], "owner": {"reputation": 1544, "user_id": 2945764, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ed8e3698f939f2431e29d0f6c2f7dcfc?s=128&d=identicon&r=PG", "display_name": "damianesteban", "link": "https://stackoverflow.com/users/2945764/damianesteban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 27809700, "answer_count": 1, "score": -1, "last_activity_date": 1420591074, "creation_date": 1420590336, "question_id": 27809580, "link": "https://stackoverflow.com/questions/27809580/basic-spec-failing-with-capybara-rspec-3-rails-4-have-content", "title": "Basic spec failing with Capybara / RSpec 3 / Rails 4 (have_content)", "body": "<p>I'm relatively new to RSpec and Capybara, and I'm making a basic Comic Book Database Application to experiment with them.  For some reason the test is failing (though when I manually create a ComicBook I see the confirmation text).</p>\n\n<p>Here is the test:</p>\n\n<pre><code>require 'spec_helper.rb'\n\nfeature 'Creating Comic Books' do\n  scenario 'can create a comic book' do\n    visit '/'\n\n    click_link 'New Comic book'\n\n    fill_in 'Title', with: 'Batman'\n    fill_in 'Publisher', with: 'DC'\n    fill_in 'Issue number', with: 32\n    fill_in 'Summary', with: 'What a nice comic book'\n\n    expect(page).to have_content(\"Comic book was successfully created.\")\n  end\nend\n</code></pre>\n\n<p>And here is the failing message along with the backtrace:</p>\n\n<pre><code>1) Creating Comic Books can create a comic book\n     Failure/Error: expect(page).to have_content(\"Comic book was successfully created.\")\n       expected to find text \"Comic book was successfully created.\" in \"Toggle navigation Project name Home About Contact New Comic Book Title Publisher Issue number Summary What a nice comic book Back\"\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-expectations-3.1.2/lib/rspec/expectations/fail_with.rb:30:in `fail_with'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-expectations-3.1.2/lib/rspec/expectations/handler.rb:37:in `handle_failure'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-expectations-3.1.2/lib/rspec/expectations/handler.rb:48:in `handle_matcher'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-expectations-3.1.2/lib/rspec/expectations/expectation_target.rb:54:in `to'\n     # ./spec/features/creating_comics_spec.rb:14:in `block (2 levels) in &lt;top (required)&gt;'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:152:in `instance_exec'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:152:in `block in run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:222:in `call'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:222:in `call'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-rails-3.1.0/lib/rspec/rails/adapters.rb:72:in `block (2 levels) in &lt;module:MinitestLifecycleAdapter&gt;'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:322:in `instance_exec'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:322:in `instance_exec'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/hooks.rb:380:in `execute_with'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/hooks.rb:446:in `block (2 levels) in run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:222:in `call'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:222:in `call'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/hooks.rb:447:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/hooks.rb:500:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:331:in `with_around_example_hooks'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example.rb:149:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example_group.rb:490:in `block in run_examples'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example_group.rb:486:in `map'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example_group.rb:486:in `run_examples'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/example_group.rb:453:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:111:in `block (2 levels) in run_specs'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:111:in `map'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:111:in `block in run_specs'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/reporter.rb:53:in `report'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:107:in `run_specs'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:85:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:69:in `run'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/lib/rspec/core/runner.rb:37:in `invoke'\n     # /Users/esteban/.rbenv/versions/2.1.5/lib/ruby/gems/2.1.0/gems/rspec-core-3.1.7/exe/rspec:4:in `&lt;top (required)&gt;'\n     # /Users/esteban/.rbenv/versions/2.1.5/bin/rspec:23:in `load'\n     # /Users/esteban/.rbenv/versions/2.1.5/bin/rspec:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have tried using both capybara-webkit and selenium, I get the error regardless.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 102358, "user_id": 15245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a2a53db8e9b4476038c94a64b32833f?s=128&d=identicon&r=PG", "display_name": "Ryan Bigg", "link": "https://stackoverflow.com/users/15245/ryan-bigg"}, "is_accepted": true, "score": 2, "last_activity_date": 1420590959, "creation_date": 1420590959, "answer_id": 27809684, "question_id": 27809558, "link": "https://stackoverflow.com/questions/27809558/presenter-name-error-uninitialized-constant/27809684#27809684", "title": "Presenter name error uninitialized constant", "body": "<p>Your class is called <code>BidsPresenter</code>, but your error says the code is looking for <code>BidPresenter</code>.</p>\n\n<p>No \"s\".</p>\n"}], "owner": {"reputation": 797, "user_id": 2811283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/427813bc0c42956e5d48c1e85a9c9618?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Taylor", "link": "https://stackoverflow.com/users/2811283/thomas-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 0, "accepted_answer_id": 27809684, "answer_count": 1, "score": 0, "last_activity_date": 1420590959, "creation_date": 1420590157, "question_id": 27809558, "link": "https://stackoverflow.com/questions/27809558/presenter-name-error-uninitialized-constant", "title": "Presenter name error uninitialized constant", "body": "<p>I've started implementing presenters for some of my complex views using the following RailsCast as a guide: <a href=\"http://railscasts.com/episodes/287-presenters-from-scratch\" rel=\"nofollow\">http://railscasts.com/episodes/287-presenters-from-scratch</a></p>\n\n<p>I'm getting the following error <code>NameError at /bids/41 uninitialized constant BidPresenter</code> and can not figure out where I am going wrong! Better Errors tells me it's this line causing the error in the helper: <code>klass ||= \"#{object.class}Presenter\".constantize</code></p>\n\n<pre><code># presenter helper\n# https://www.youtube.com/watch?v=HWN1nUlgQ8Y\ndef present(object, klass = nil)\n  # if a klass isn't specified determine the class based off the object \n  # klass (bids presenter, user presenter etc)\n  klass ||= \"#{object.class}Presenter\".constantize\n  # instantiate presenter\n  presenter = klass.new(object, self)\n  # yield presenter if a block is given\n  yield presenter if block_given?\n  # return presenter back from the method\n  presenter\nend\n</code></pre>\n\n<p>My <code>bids_presenter.rb</code>:</p>\n\n<pre><code>class BidsPresenter\n    def initialize(bid, template)\n        @bid = bid\n        @template = template\n    end\n\n    # h method returns the template object\n    def h\n        @template\n    end\n\n    def bid_data_upper_price_estimate\n        h.number_to_currency(@bid.upper_price_estimate, precision: 2)\n    end\nend\n</code></pre>\n\n<p>My view <code>show.html.erb</code>:</p>\n\n<pre><code>&lt;% present @bid do |bid_presenter| %&gt;\n    &lt;%= bid_presenter.bid_data_upper_price_estimate %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}]