[{"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "scheduling", "rufus-scheduler"], "answers": [{"tags": [], "owner": {"reputation": 3437, "user_id": 10762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d96626e52beb1ff90f57a8e189e1e6f?s=128&d=identicon&r=PG", "display_name": "jmettraux", "link": "https://stackoverflow.com/users/10762/jmettraux"}, "is_accepted": false, "score": 1, "last_activity_date": 1511390900, "last_edit_date": 1511390900, "creation_date": 1511390405, "answer_id": 47444957, "question_id": 47444411, "link": "https://stackoverflow.com/questions/47444411/rufus-scheduler-fires-at-the-scheduled-time-expected-and-fires-again-after-co/47444957#47444957", "title": "Rufus scheduler fires at the scheduled time (expected ) and fires again after completion of previous run", "body": "<p><a href=\"https://github.com/jmettraux/rufus-scheduler#overlap--false\" rel=\"nofollow noreferrer\">https://github.com/jmettraux/rufus-scheduler#overlap--false</a></p>\n\n<pre><code>pin_sampling_job_scheduler = Rufus::Scheduler.new\n\npin_sampling_job_scheduler.cron(\"22 * * * *\", overlap: false) do\n  ts = Time.now.strftime('%Y%m%d%H%M')\n  puts \"#{Time.now} - sampling #{ts} starts...\"\n  DatafetchRedshift.pin_sampling_job\n  puts \"#{Time.now} - sampling #{ts} stopped.\"\nend\n</code></pre>\n\n<blockquote>\n  <p>for hour = 00, the method fires at 22nd min(as expected and assume the job is running for 1.5 hour) For hour =01, method is fires at 22nd min and again at 52nd min (after completion of first run). Why is it happening like this?</p>\n</blockquote>\n\n<p>You can report issues at <a href=\"https://github.com/jmettraux/rufus-scheduler/issues\" rel=\"nofollow noreferrer\">https://github.com/jmettraux/rufus-scheduler/issues</a> (please read <a href=\"https://github.com/jmettraux/rufus-scheduler#getting-help\" rel=\"nofollow noreferrer\">https://github.com/jmettraux/rufus-scheduler#getting-help</a> before filing an issue)</p>\n"}], "owner": {"reputation": 165, "user_id": 4775218, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9d85e523c88577422105b1f3bfd8d20d?s=128&d=identicon&r=PG&f=1", "display_name": "saranya elumalai", "link": "https://stackoverflow.com/users/4775218/saranya-elumalai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511390900, "creation_date": 1511387454, "question_id": 47444411, "link": "https://stackoverflow.com/questions/47444411/rufus-scheduler-fires-at-the-scheduled-time-expected-and-fires-again-after-co", "title": "Rufus scheduler fires at the scheduled time (expected ) and fires again after completion of previous run", "body": "<p>I have scheduled rufus cron to run a method (a method to post a complex query in remote DB, retrieves result and, do some processing ) every hour and 99% of time the methods completes execution &lt;1 hr.</p>\n\n<p>Rufus fires the method fine at every expected time, but the problem is some times (1% fo time) the method wont complete in a hour; the scheduler fires the second one at the expected time and fires the second one again, on completion of previous run.</p>\n\n<p>For example,</p>\n\n<p><code>pin_sampling_job_scheduler = Rufus::Scheduler.new\npin_sampling_job_scheduler.cron(\"22 * * * *\") do\n  puts \"sampling starts\"\n  DatafetchRedshift.pin_sampling_job\nend</code></p>\n\n<p>for hour = 00, the method fires at 22nd min(as expected and assume the job is running for 1.5 hour) For hour =01, method is fires at 22nd min and again at 52nd min (after completion of first run). Why is it happening like this? Any help or suggestion will be appreciated.</p>\n\n<p>Rufus version -3.3.4\nRails - 4.1.6\nRuby 2.2.0</p>\n\n<p>P.S - I wont be able to change the scheduler runs to be more than an hour, since 99% it completes\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8993405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e50b957677e52a1110679ee698cb324?s=128&d=identicon&r=PG&f=1", "display_name": "NiceRice", "link": "https://stackoverflow.com/users/8993405/nicerice"}, "edited": false, "score": 0, "creation_date": 1511394247, "post_id": 47444511, "comment_id": 81846366, "body": "Thank you! That solved my first problem. For the second one, I created a random application through command prompt ruby on rails but I can&#39;t find it in any of my folders? I can access it through the heroku site though. Is the folder suppose to be accessible from heroku&#39;s site because I can&#39;t find the root app anywhere on my computer."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511399079, "post_id": 47444511, "comment_id": 81847522, "body": "If you can find it on Heroku but not locally then you might have just created it on Heroku only. If you created an app locally it would be in what ever folder you were in on the command line when you created it (run <code>pwd</code>)."}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1511420686, "post_id": 47444511, "comment_id": 81853756, "body": "I guess that your app is not really working on heroku it you just created one. You have now the app container. You should create now a new app locally <code>rails new app-name</code> and it will create the skeleton"}, {"owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "edited": false, "score": 0, "creation_date": 1511420826, "post_id": 47444511, "comment_id": 81853813, "body": "The next step would be to add to your git remote an <i>heroku master</i> branch as explained here <a href=\"https://devcenter.heroku.com/articles/git#creating-a-heroku-remote\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/git#creating-a-heroku-remote</a>"}], "tags": [], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "is_accepted": false, "score": 0, "last_activity_date": 1511387904, "creation_date": 1511387904, "answer_id": 47444511, "question_id": 47444371, "link": "https://stackoverflow.com/questions/47444371/following-tutorial-for-installing-ruby-on-rails-for-heroku-currently-stuck/47444511#47444511", "title": "Following tutorial for installing Ruby on Rails for Heroku. Currently stuck", "body": "<p>regarding your first error, the problem is that you are not specifying for which app you want to open the database cli (psql). Hopefully, the solution is easy:</p>\n\n<pre><code>heroku pg:psql --app app_name\n# or\nheroku pg:psql -a app_name\n</code></pre>\n\n<p>About the second question, the tutorial assumes that you have already created an application.</p>\n\n<p>If you go to the root path of your project, you will find some subfolders such as app, config, db, lib, public, tmp, vendor.. Here you will find <code>config\\database.yml</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8993405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e50b957677e52a1110679ee698cb324?s=128&d=identicon&r=PG&f=1", "display_name": "NiceRice", "link": "https://stackoverflow.com/users/8993405/nicerice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511399473, "creation_date": 1511387284, "last_edit_date": 1511399473, "question_id": 47444371, "link": "https://stackoverflow.com/questions/47444371/following-tutorial-for-installing-ruby-on-rails-for-heroku-currently-stuck", "title": "Following tutorial for installing Ruby on Rails for Heroku. Currently stuck", "body": "<p>very new to all this. I am following a tutorial to get Heroku running through ruby on rails.</p>\n\n<p>I have Microsoft Windows so I am currently following Heroku's official tutorial and am <a href=\"https://devcenter.heroku.com/articles/getting-started-with-jruby#run-the-app-locally\" rel=\"nofollow noreferrer\">stuck here</a></p>\n\n<p>I installed PostgresSQL 10.1 using windows installer x86-64 and have noted my login information for Postgres.</p>\n\n<p>However, I do not understand this part:</p>\n\n<blockquote>\n  <p>Remember to update your <code>PATH</code> environment variable to add the bin\n  directory of your Postgres installation. The directory will be similar\n  to this: <code>C:\\Program Files\\PostgreSQL\\&lt;VERSION&gt;\\bin</code>. If you forget to\n  update your <code>PATH</code>, commands like <code>heroku pg:psql</code> won\u2019t work.</p>\n</blockquote>\n\n<p>The closest thing I could find to an explanation and tutorial was this <a href=\"https://www.java.com/en/download/help/path.xml\" rel=\"nofollow noreferrer\">Java site.</a></p>\n\n<p>I went inside Enviromental Variables and set the system path to: <code>C:\\Program Files\\PostgreSQL\\10\\bin</code></p>\n\n<p>However, when I tried testing it out by typing in <code>heroku pg:psql</code>, it said no app specified so I'm unsure if I did it correctly or not. </p>\n\n<p>Also, the next tutorial step is: </p>\n\n<blockquote>\n  <p>Open the config\\database.yml file and set the username and password\n  for your local (development) database. Look for these line:</p>\n</blockquote>\n\n<p>I searched and I have no such file on my computers. Needless to say, I'm stumped. Any assistance to progress through the tutorial is appreciated. Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ahoy"], "comments": [{"owner": {"reputation": 580, "user_id": 6545696, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/20ccef418b14f7c1760c129883fe04f0?s=128&d=identicon&r=PG&f=1", "display_name": "rebbailey", "link": "https://stackoverflow.com/users/6545696/rebbailey"}, "edited": false, "score": 1, "creation_date": 1511387500, "post_id": 47444166, "comment_id": 81844056, "body": "I&#39;m having the same issue. One of my apps which has geocoder installed directly as a gem is allowing me to get back the location params without any trouble on every visit, although that is a rails 4.2.6 application. My rails 5.1.3 app, which is configured the exact same way, is the one with the issues exactly to yours."}], "owner": {"reputation": 1146, "user_id": 4232053, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0986f0e77e408117b8557a825ad84289?s=128&d=identicon&r=PG&f=1", "display_name": "Ctpelnar1988", "link": "https://stackoverflow.com/users/4232053/ctpelnar1988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1511386345, "creation_date": 1511386345, "question_id": 47444166, "link": "https://stackoverflow.com/questions/47444166/unable-to-track-location-using-the-ahoy-gem-rails-5-1-3", "title": "Unable to track location using the Ahoy gem Rails 5.1.3", "body": "<p>I just installed the ahoy gem into my Rails 5.1.3 application. I am getting back the <code>visit</code> and the <code>event</code>, but the visit location attributes always return <code>country: \"Reserved\"</code>, <code>region: nil</code>, <code>city: nil</code>, <code>postal_code: nil</code>. This is what I have implemented following the directions on the Ahoy github. Any body can shed some light on what it is I am missing or doing incorrectly? This is occurring in both production and development env's.</p>\n\n<p><strong>application.js</strong></p>\n\n<pre><code>$(document).ready(function(){\n  ahoy.trackAll();\n});\n</code></pre>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>gem 'ahoy_matey'\n# Did not include geocoder because it is detailed in the documents as a dependency.\n</code></pre>\n\n<p><strong>Example of a Visit:</strong></p>\n\n<pre><code>[2] pry(main)&gt; Visit.last\n  Visit Load (0.5ms)  SELECT  \"visits\".* FROM \"visits\" ORDER BY \"visits\".\"id\" DESC LIMIT $1  [[\"LIMIT\", 1]]\n=&gt; #&lt;Visit:0x007fd045e04b48\n id: 2,\n visit_token: \"7750594c-7163-46c1-8ec7-18f3069619d0\",\n visitor_token: \"efdcb332-742a-4de3-971b-c141f24ff0f6\",\n ip: \"74.174.236.84\",\n user_agent: \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\",\n referrer: nil,\n landing_page: \"http://my_website.com/users/sign_in\",\n user_id: nil,\n referring_domain: nil,\n search_keyword: nil,\n browser: \"Chrome\",\n os: \"Mac OS X\",\n device_type: \"Desktop\",\n screen_height: 800,\n screen_width: 1280,\n country: \"Reserved\",\n region: nil,\n city: nil,\n postal_code: nil,\n latitude: 0.0,\n longitude: 0.0,\n utm_source: nil,\n utm_medium: nil,\n utm_term: nil,\n utm_content: nil,\n utm_campaign: nil,\n started_at: Wed, 22 Nov 2017 21:10:52 UTC +00:00&gt;\n</code></pre>\n"}, {"tags": ["ruby", "macos", "memoization", "ackermann"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511383744, "post_id": 47442959, "comment_id": 81842362, "body": "<i>Sidenote:</i> <code>begin</code>/<code>end</code> in <code>ack</code> is a noop and makes no sense, just <code>if</code> does the same. Also, I do not get why do you call <code>ack</code> \u201cmemoized.\u201d Maybe you wanted to <code>@ack[&quot;#{m}:#{n}:#{p}&quot;] ||= if ...</code> there to actually memoize?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1511383935, "post_id": 47442959, "comment_id": 81842458, "body": "You never use a memoized value. So, your <code>ack</code> method does strictly more work and uses strictly more memory than the <code>raw</code> method, since it computes the exact same thing, but in addition also schlepps around a huge hash with all intermediate results that it <i>never looks at or uses again</i>."}, {"owner": {"reputation": 693, "user_id": 564870, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119f774b39fce2072d94530a83ea1617?s=128&d=identicon&r=PG&f=1", "display_name": "slashlos", "link": "https://stackoverflow.com/users/564870/slashlos"}, "edited": false, "score": 0, "creation_date": 1511533322, "post_id": 47442959, "comment_id": 81904920, "body": "Yes; it&#39;s wrong but where?  the problem I think are these lines: ` @ack ||= {}   @ack[&quot;#{m}:#{n}:#{p}&quot;] = begin` which I can alter the 2nd <b>=</b> to <b>||=</b> to execute block when necessary but yes it&#39;s wrong hence my question; I think the 1st initializes a hash while second conditionally executes the block if the key isn&#39;t found?"}], "owner": {"reputation": 693, "user_id": 564870, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119f774b39fce2072d94530a83ea1617?s=128&d=identicon&r=PG&f=1", "display_name": "slashlos", "link": "https://stackoverflow.com/users/564870/slashlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1512096414, "creation_date": 1511380660, "last_edit_date": 1512096414, "question_id": 47442959, "link": "https://stackoverflow.com/questions/47442959/ruby-memoized-routine-lags", "title": "Ruby memoize&#39;d routine lags?", "body": "<p><strong>REVISION #3</strong></p>\n\n<p>I'm trying to develop an Ackermann in Ruby using original 3-arg model function.  My attempt to do so appears to show the memoize'd version - <strong>ack</strong> taking longer than the raw version - <strong>raw</strong> - so obviously \"something\" is wrong:</p>\n\n<pre><code>1% ruby -v\nruby 2.0.0p648 (2015-12-16 revision 53162) [universal.x86_64-darwin16]\n1% time ruby ackermann3.rb raw silent\nraw 0.107u 0.023s 0:00.13 92.3% 0+0k 0+0io 0pf+0w\n1% time ruby ackermann3.rb ack silent\nack 0.563u 0.049s 0:00.62 96.7% 0+0k 0+0io 0pf+0w\n</code></pre>\n\n<p>for this module Ackermann3.rb</p>\n\n<pre><code>##\n# https://www.saylor.org/site/wp-content/uploads/2013/04/Ackermann-Function.pdf\n#\n# Ackermann's original three-argument function: \u0192(m,n,p) is\n# defined recursively as follows for nonnegative integers m, n, and p:\n#\n#  \u0192(m,n,0) = m + n\n#  \u0192(m,0,1) = 0\n#  \u0192(m,0,2) = 1\n#  \u0192(m,0,p) = m for p &gt; 2\n#  \u0192(m,n,p) = \u0192(m, \u0192(m,n - 1,p), p - 1) for n &gt; 0 and p &gt; 0\n#\n#  Usage: ruby ./ackerman3.rb raw | ack\n#\n# RUBY_THREAD_VM_STACK_SIZE 10M\n##\n\nfun = ARGV[0]\nif fun.nil?\n  puts \"Usage: ruby ./ackermann3.rb {ack | raw} [silent]\"\n  exit 1\nend\n\nlog = ARGV[1]\nif log.nil?\n  silent = false\nelsif 'silent'.match(log.downcase)\n  silent = true\nelse\n  silent = false\nend\n\ndef is_number? string\n  true if Float(string) rescue false\nend\n\ndef filesize(string_size)\n  units = ['B', 'K', 'M', 'G', 'T', 'P', 'E']\n  size = Float(string_size)\n\n  return '0b' if size == 0\n  exp = (Math.log(size) / Math.log(1024)).to_i\n  exp = 6 if exp &gt; 6 \n\n  bits = '%.1f' % [size.to_f / 1024 ** exp]\n  if \"#{bits}\".end_with? \".0\"\n    bits['.0'] = ''\n  end\n  '%s%s' % [bits, units[exp]]\nend\n\nstk = ENV['RUBY_THREAD_VM_STACK_SIZE']\nif stk.nil?\n  stk = \"undef stk\"\nelsif is_number?(stk)\n  stk = \"EOF \" + filesize(stk)\nend\n\ndef ack(m, n, p)\n  @results ||= {}\n  @results[[m,n,p]] ||= begin\n    if p == 0\n      m + n\n    elsif n == 0 &amp;&amp; p &gt; 2\n      m\n    elsif n == 0 &amp;&amp; p &gt; 0\n      p - 1\n    else\n      ack(m, ack(m,n - 1,p), p - 1)\n    end\n  end\nend\n\ndef raw(m, n, p)\n  if p == 0\n    m + n\n  elsif n == 0 &amp;&amp; p &gt; 2\n    m\n  elsif n == 0 &amp;&amp; p &gt; 0\n    p - 1\n  else\n    raw(m, raw(m,n - 1,p), p - 1)\n  end\nend\n\n9.times do |m|\n  9.times do |n|\n    9.times do |p|\n\n      if (m+n+p) &lt; 9\n        print \"#{fun} (#{m}, #{n}, #{p}) =&gt; \" unless silent\n        begin\n          result = Object.send(fun, m, n, p)\n        rescue SystemStackError\n          #yoink\n          result = stk\n        end\n        puts \"#{result}\" unless silent\n      end\n\n    end\n  end\nend\nprint \"#{fun} \" if silent\n</code></pre>\n\n<p>The script is revised to address prior comments - errors I had, but I'm not seeing why the memoized variant isn't effective.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "nested-forms"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1511376761, "post_id": 47441945, "comment_id": 81838940, "body": "How&#39;re you planning to send the params?, within the <code>seasons_attributes</code>? why don&#39;t you try next the <code>:id</code> param?"}, {"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 5, "creation_date": 1511378463, "post_id": 47441945, "comment_id": 81839841, "body": "Maybe in the submitted param<code>:season_start, :season_end</code> are not inside <code>seasons_attributes</code>?"}, {"owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 6, "creation_date": 1511378634, "post_id": 47441945, "comment_id": 81839906, "body": "Post the log message of the parameters received by the server for the request."}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "edited": false, "score": 2, "creation_date": 1511382676, "post_id": 47441945, "comment_id": 81841858, "body": "might be worth adding the code for the form view to your question so we can get an idea of what parameters are being submitted - quite likely the problem resides there."}, {"owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 1, "creation_date": 1511435271, "post_id": 47441945, "comment_id": 81862574, "body": "Ok, so I just found out that for some reason it doesn&#39;t permit datetime format. So basically when I change the datepicker field to a regular input and submit something like &quot;20171123&quot; everything works as expected!"}, {"owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 0, "creation_date": 1511448337, "post_id": 47441945, "comment_id": 81870644, "body": "Still stuck here...I can&#39;t figure out what the issue is! When I submit a datetime with a datepicker (<a href=\"https://github.com/charliekassel/vuejs-datepicker\" rel=\"nofollow noreferrer\">vuejs-datepicker</a>) the params are unpermitted, but when I submit the datetime in the same format with an input field everything works perfectly fine."}, {"owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 0, "creation_date": 1511449122, "post_id": 47441945, "comment_id": 81871109, "body": "Finally got the solution! Apparently the datepicker passed the value as a Date object. Basically I just needed to convert that Date object to a string."}], "owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1511434412, "creation_date": 1511376659, "last_edit_date": 1511434412, "question_id": 47441945, "link": "https://stackoverflow.com/questions/47441945/unpermitted-parameters-even-though-permitted", "title": "Unpermitted parameters even though permitted", "body": "<p>I know, that a lot of questions related to strong params have already been asked, but I'm facing a very strange behavior here. I have a model with nested attributes, permitted the right params (I checked for typos like a hundred times) and still get the error:</p>\n\n<p><code>Unpermitted parameters: :season_start, :season_end</code></p>\n\n<p>The strange thing about this: there is a third variable in the same nested model which gets accepted! </p>\n\n<p>Here's my relevant code:</p>\n\n<pre><code>class Api::HotelsController &lt; ApiController\n\n  ...\n\n  def hotel_params\n    params.require(:hotel).permit(:id, :listing_name, ..., seasons_attributes:[:id, :season_start, :season_end, :period, :_destroy])\n  end\nend\n</code></pre>\n\n<p>And my Model: </p>\n\n<pre><code>class Hotel &lt; ApplicationRecord\n\n  ...\n\n  has_many :seasons, dependent: :destroy\n\n  accepts_nested_attributes_for :seasons, update_only: true, allow_destroy: true\n\nend\n</code></pre>\n\n<p>I have absolutely no idea what could be wrong and tried various things in order to solve the issue but I couldn't figure out, why <code>:period</code> is permitted but <code>:season_start</code> and <code>:season_end</code> are not.</p>\n\n<p>Here's the log message of the received params:</p>\n\n<pre><code>\"seasons_attributes\"=&gt;[{\"period\"=&gt;\"mid-season\", \"season_start\"=&gt;{}, \"season_end\"=&gt;{}}]}\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8992647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd98c332a6969fd776057bf23f19c69d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Andrews", "link": "https://stackoverflow.com/users/8992647/aaron-andrews"}, "edited": false, "score": 0, "creation_date": 1511398063, "post_id": 47444537, "comment_id": 81847298, "body": "You&#39;re right. I removed the depends &#39;apache&#39; line from the metadata.rb file and ran foodcritic . as you suggested. Now I have other issues, but I will need to post another question about it."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 1, "last_activity_date": 1511388019, "creation_date": 1511388019, "answer_id": 47444537, "question_id": 47441894, "link": "https://stackoverflow.com/questions/47441894/chef-metadata-rb-dependency-needs-to-depend-on-itself/47444537#47444537", "title": "Chef metadata.rb dependency needs to depend on itself", "body": "<p>The FC007 activation is wrong. Are you sure you're running <code>foodcritic</code> correctly? Just run <code>foodcritic .</code> on the base of the cookbook folder (i.e. the same place as the <code>metadata.rb</code> is). That should detect the name of the cookbook and not flag the include.</p>\n"}], "owner": {"reputation": 3, "user_id": 8992647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd98c332a6969fd776057bf23f19c69d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Andrews", "link": "https://stackoverflow.com/users/8992647/aaron-andrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 47444537, "answer_count": 1, "score": 0, "last_activity_date": 1511388019, "creation_date": 1511376510, "question_id": 47441894, "link": "https://stackoverflow.com/questions/47441894/chef-metadata-rb-dependency-needs-to-depend-on-itself", "title": "Chef metadata.rb dependency needs to depend on itself", "body": "<p>I am getting a foodcritic error when I try to include a recipie within the default.rb for the apache cookbook lesson:</p>\n\n<pre><code>#\n# Cookbook:: apache\n# Recipe:: default\n#\n# Copyright:: 2017, The Authors, All Rights Reserved.\n# Install apached package\npackage 'apache2' do\n    package_name 'httpd'\n    action :install\nend\nservice 'apache2' do\n    service_name 'httpd'\n    action [:start, :enable]\nend\n\ninclude_recipe 'apache::websites'\n</code></pre>\n\n<p>websites.rb</p>\n\n<pre><code>file 'default www' do\npath '/var/ww/html/index.html'\ncontent 'Hello world!'\nend\n</code></pre>\n\n<p>When I run foodcritic on default.rb</p>\n\n<pre><code>FC007: Ensure recipe dependencies are reflected in cookbook metadata: \ndefault.rb:17\n</code></pre>\n\n<p>When I follow the recomendation and add the dependency in the metadata.rb and run <strong>knife cookbook upload apache</strong> I get this:</p>\n\n<pre><code>ERROR: RuntimeError: Cookbook depends on itself in cookbook apache, please \nremove the this unnecessary self-dependency\n</code></pre>\n\n<p>Below is my metadeta.rb</p>\n\n<pre><code>name 'apache'\nmaintainer 'xxxxx'\nmaintainer_email 'xxxxx'\nlicense 'All Rights Reserved'\ndescription 'Installs/Configures apache'\nlong_description 'Installs/Configures apache'\nversion '0.1.1'\nchef_version '&gt;= 12.1' if respond_to?(:chef_version)\ndepends 'apache'\n\n#The `issues_url` points to the location where issues for this cookbook are\n# tracked.  A `View Issues` link will be displayed on this cookbook's page \nwhen\n# uploaded to a Supermarket.\n#\n# issues_url 'https://github.com/&lt;insert_org_here&gt;/apache/issues'\n\n# The `source_url` points to the development repository for this cookbook.  \nA\n# `View Source` link will be displayed on this cookbook's page when uploaded \nto\n# a Supermarket.\n#\n# source_url 'https://github.com/&lt;insert_org_here&gt;/apache'\n</code></pre>\n\n<p>New to chef and ruby, first question on Stack Overflow.\nAm I adding the dependency wrong?\nDoes anything jump out that would cause this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1511375021, "post_id": 47441525, "comment_id": 81838054, "body": "What do you want exactly?"}, {"owner": {"reputation": 51, "user_id": 3639451, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/73b57b44e79a78d09248355cbb906fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagdsh L K", "link": "https://stackoverflow.com/users/3639451/jagdsh-l-k"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1511375145, "post_id": 47441525, "comment_id": 81838116, "body": "I need to map each param in the &quot;map&quot; with a variable name, which I was not able do it array"}, {"owner": {"reputation": 1100, "user_id": 1415546, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/092770076bb0cf421bacba912565331d?s=128&d=identicon&r=PG", "display_name": "NateSHolland", "link": "https://stackoverflow.com/users/1415546/natesholland"}, "edited": false, "score": 0, "creation_date": 1511375323, "post_id": 47441525, "comment_id": 81838193, "body": "I&#39;m a little bit confused on what you are asking. You only want the first element of the first key?"}, {"owner": {"reputation": 51, "user_id": 3639451, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/73b57b44e79a78d09248355cbb906fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagdsh L K", "link": "https://stackoverflow.com/users/3639451/jagdsh-l-k"}, "edited": false, "score": 0, "creation_date": 1511375412, "post_id": 47441525, "comment_id": 81838229, "body": "No I want first element of all keys with index"}, {"owner": {"reputation": 1100, "user_id": 1415546, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/092770076bb0cf421bacba912565331d?s=128&d=identicon&r=PG", "display_name": "NateSHolland", "link": "https://stackoverflow.com/users/1415546/natesholland"}, "edited": false, "score": 0, "creation_date": 1511375542, "post_id": 47441525, "comment_id": 81838308, "body": "Could you give some extra test cases?"}, {"owner": {"reputation": 51, "user_id": 3639451, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/73b57b44e79a78d09248355cbb906fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagdsh L K", "link": "https://stackoverflow.com/users/3639451/jagdsh-l-k"}, "edited": false, "score": 0, "creation_date": 1511375628, "post_id": 47441525, "comment_id": 81838346, "body": "As result I would be requiring &quot;value1&quot;, &quot;value2&quot;, 1 for first hash and &quot;value1&quot;, &quot;value2&quot;, 2 for second hash"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1511375657, "post_id": 47441525, "comment_id": 81838364, "body": "Your code doesn&#39;t work at all, since <code>variable</code> doesn&#39;t have a <code>values</code> method. So you don&#39;t get what you claim to get."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1511379269, "post_id": 47441525, "comment_id": 81840229, "body": "@JagdshLK Please edit your question and clarify. From your comments I see that you want some index, too. Also fix your code example (variable.values does not work ...). Please update your question and state the <i>exact</i> result you wish to get. We might have language barriers here and there, but if you write in ruby we&#39;ll get it! :)"}], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1511399626, "post_id": 47446095, "comment_id": 81847651, "body": "if your <code>variable</code> was correct and the code you ran/output was wrong (the opposite of the assumption I made on this answer); you can run the above on <code>variable.map { |hash| hash.values.flatten }</code> or <code>variable.map { |hash| hash.values.first }</code> instead of <code>variable.values</code>"}, {"owner": {"reputation": 51, "user_id": 3639451, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/73b57b44e79a78d09248355cbb906fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagdsh L K", "link": "https://stackoverflow.com/users/3639451/jagdsh-l-k"}, "edited": false, "score": 0, "creation_date": 1511475436, "post_id": 47446095, "comment_id": 81882540, "body": "Thank you @simple lime. This is what I was trying to explain in my question but failed."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 0, "last_activity_date": 1511398925, "creation_date": 1511398925, "answer_id": 47446095, "question_id": 47441525, "link": "https://stackoverflow.com/questions/47441525/ruby-index-as-param-in-array-map/47446095#47446095", "title": "Ruby: Index as param in array map", "body": "<p>I'm assuming that <code>variable</code> is actually just a hash, since that fits the code you're running and the results you're seeing the best, if not this answer needs some slight modification, but should as whole still be relevant</p>\n\n<pre><code>variable = { \"Key1\" =&gt; [\"value1\", \"value2\"], \"Key2\" =&gt; [\"value1\", \"value2\"] }\n</code></pre>\n\n<hr>\n\n<p>Usually when you call <code>map</code>, the element being passed in, where applicable can be deconstructed:</p>\n\n<pre><code>variable.values.map { |p1, p2| puts p1 }\n# value1\n# value1\n</code></pre>\n\n<p>However, when you call <code>with_index</code> on it, it changes the behavior so that the first parameter passed is the element in your Enumerable, and the second is the index:</p>\n\n<pre><code>variable.values.map.with_index { |p1, p2| puts p1.inspect }\n# [\"value1\", \"value2\"]\n# [\"value1\", \"value2\"]\n</code></pre>\n\n<p>So, since things get ambiguous if you start trying to deconstruct multiple parameters (for instance, what if that second item, which in this case is an integer index was actually another array; what parameter goes with what array; similarly if your first parameter had 5 elements and you supply 3 parameters to the block, what should the interpreter think you meant to be doing?), you need to use a special syntax. You simply need to wrap the parameter names that should go with the first element in parenthesis:</p>\n\n<pre><code>variable.values.map.with_index do |(param1, param2), index|\n  puts \"p1: #{param1}; p2: #{param2}; index: #{index}\"\nend\n# p1: value1; p2: value2; index: 0\n# p1: value1; p2: value2; index: 1\n</code></pre>\n\n<p>and finally, if you are only interested in the first element of each value array, you can just assign the rest of the array to an unused variable, for instance:</p>\n\n<pre><code>variable.values.map.with_index do |(param1, *), index|\n  puts \"p1: #{param1}; index: #{index}\"\nend\n# p1: value1; index: 0\n# p1: value1; index: 1\n</code></pre>\n\n<p>And naturally, since this isn't actually mapping the values to anything, this is all applicable to <code>each.with_index</code> as well.</p>\n"}], "owner": {"reputation": 51, "user_id": 3639451, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/73b57b44e79a78d09248355cbb906fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagdsh L K", "link": "https://stackoverflow.com/users/3639451/jagdsh-l-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1693, "favorite_count": 0, "accepted_answer_id": 47446095, "answer_count": 1, "score": -3, "last_activity_date": 1511550469, "creation_date": 1511374965, "last_edit_date": 1511550469, "question_id": 47441525, "link": "https://stackoverflow.com/questions/47441525/ruby-index-as-param-in-array-map", "title": "Ruby: Index as param in array map", "body": "<p>I have the following hash keys</p>\n\n<pre><code>variable = { \"Key1\" =&gt; [\"value1\",\"value2\"],\n             \"Key2\" =&gt; [\"value3\",\"value4\"]}\n</code></pre>\n\n<p>I need to iterate through each values of the key with index and print the first <strong>deconstructed parameter</strong>.</p>\n\n<p>I tried </p>\n\n<pre><code>variable.\n values.\n map.\n with_index{|param1, param2, index|\n     puts param1\n }\n</code></pre>\n\n<p>which gives me the output of  </p>\n\n<pre><code>[\"value1\", \"value2\"] \n[\"value3\", \"value4\"]\n</code></pre>\n\n<p>My question is: Why is it printing the full value object?</p>\n\n<p>I just need to get </p>\n\n<pre><code>\"value1\" \n\"value3\"\n</code></pre>\n\n<p>How can I do it?</p>\n"}, {"tags": ["ruby", "monkeypatching", "refinements"], "answers": [{"comments": [{"owner": {"reputation": 8384, "user_id": 627408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/GO0oW.png?s=128&g=1", "display_name": "kreek", "link": "https://stackoverflow.com/users/627408/kreek"}, "edited": false, "score": 0, "creation_date": 1511387235, "post_id": 47443530, "comment_id": 81843941, "body": "Updated the question with a more simple example, which does add the refinement when called from a new instance, might be missing something :)"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1511383129, "creation_date": 1511383129, "answer_id": 47443530, "question_id": 47440936, "link": "https://stackoverflow.com/questions/47440936/refinements-and-namespaces/47443530#47443530", "title": "Refinements and namespaces", "body": "<blockquote>\n  <p>Is this a namespace issue?</p>\n</blockquote>\n\n<p>It is a scope issue. <a href=\"http://ruby-doc.org/core/doc/syntax/refinements_rdoc.html#label-Scope\" rel=\"nofollow noreferrer\">Refinements are lexically scoped</a>:</p>\n\n<pre><code>class Service\n  using NetHttpPatch\n  # Refinement is in scope here\nend\n\n# different lexical scope, Refinement is not in scope here\n\nclass Service\n  # another different lexical scope, Refinement is *not* in scope here!\nend\n</code></pre>\n\n<p>Originally, there was only <code>main::using</code>, which was script-scoped, i.e. the Refinement was in scope for the entire remainder of the script. <code>Module#using</code> came later, it scopes the Refinement to the lexical class definition body.</p>\n"}], "owner": {"reputation": 8384, "user_id": 627408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/GO0oW.png?s=128&g=1", "display_name": "kreek", "link": "https://stackoverflow.com/users/627408/kreek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 47443530, "answer_count": 1, "score": 0, "last_activity_date": 1511388752, "creation_date": 1511372622, "last_edit_date": 1511388752, "question_id": 47440936, "link": "https://stackoverflow.com/questions/47440936/refinements-and-namespaces", "title": "Refinements and namespaces", "body": "<p>Trying to patch net/http and have it only apply to one service class. Refinements seem to be the way to go. The monkey patch below works but the refinement doesn't. Is this a namespace issue? The project is on ruby 2.3.0 but have tried with 2.4.1 as well and only the monkey patch seems to get applied.</p>\n\n<p>With a monkey patch:</p>\n\n<pre><code>module Net\n  class HTTPGenericRequest\n    def write_header(sock, ver, path)\n      puts \"monkey patched!\"\n      # patch stuff...\n    end\n  end\nend\n\nService.new.make_request\n# monkey patched!\n</code></pre>\n\n<p>With a refinement:</p>\n\n<pre><code>module NetHttpPatch\n  refine Net::HTTPGenericRequest do\n    def write_header(sock, ver, path)\n      puts \"refined!\"\n      # patch stuff...\n    end\n  end\nend\n\nclass Service\n  using NetHttpPatch\nend\n\nService.new.make_request\n# :(\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>This seems to be similar scope wise? Obviously more complex things are happening when net/http makes a request does it lose scope then?</p>\n\n<pre><code>module TimeExtension\n  refine Fixnum do\n    def hours\n      self * 60\n    end\n  end\nend\n\nclass Service\n  using TimeExtension\n\n  def one_hour\n    puts 1.hours\n  end\nend\n\nputs Service.new.one_hour\n# 60\n</code></pre>\n\n<p>UPDATE UPDATE:</p>\n\n<p>nvm, I see what's happening now :) have to keep your brain from mixing <code>using</code> up with how mixins work.</p>\n\n<pre><code>module TimeExtension\n  refine Fixnum do\n    def hours\n      self * 60\n    end\n  end\nend\n\nclass Foo\n  def one_hour\n    puts 1.hours\n  end\nend\n\n\nclass Service\n  using TimeExtension\n\n  def one_hour\n    puts 1.hours\n  end\n\n  def another_hour\n    Foo.new.one_hour\n  end\nend\n\nputs Service.new.one_hour\n# 60\nputs Service.new.another_hour\n# undefined method `hours' for 1:Fixnum (NoMethodError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "constants"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511373556, "post_id": 47440848, "comment_id": 81837227, "body": "Constants defined at the top level are attached to <code>Object</code>. e.g. <code>Object::Test == Test</code> so <code>Test::Test</code> works because <code>Test</code> is an <code>Object</code> and <code>Object::Test</code> is a valid constant. This <code>Test::Test::Test</code> should actually warn you that <code>warning: toplevel constant Test referenced by Test::Test</code> but that does not make it invalid"}], "answers": [{"tags": [], "owner": {"reputation": 8384, "user_id": 627408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/GO0oW.png?s=128&g=1", "display_name": "kreek", "link": "https://stackoverflow.com/users/627408/kreek"}, "is_accepted": true, "score": 0, "last_activity_date": 1511373335, "creation_date": 1511373335, "answer_id": 47441113, "question_id": 47440848, "link": "https://stackoverflow.com/questions/47440848/rails-models-and-const-get/47441113#47441113", "title": "Rails models and const_get", "body": "<p><code>Test::const_get(\"Test\")</code> returns the Test class (itself) so it's turtles all the way down.</p>\n\n<pre><code>puts Test::const_get(\"Test\").class\n# Class\nputs Test::const_get(\"Test\").is_a? Class\n# true\n</code></pre>\n"}], "owner": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 47441113, "answer_count": 1, "score": 0, "last_activity_date": 1511373335, "creation_date": 1511372272, "question_id": 47440848, "link": "https://stackoverflow.com/questions/47440848/rails-models-and-const-get", "title": "Rails models and const_get", "body": "<p>Given a Rails model <code>Test</code> just created in a brand new Rails application:</p>\n\n<p>why can I do following? </p>\n\n<p><code>Test::const_get(\"Test\")::const_get(\"Test\")</code> (for as long as I want)</p>\n\n<p>or the following?</p>\n\n<p><code>Test::Test::Test</code> (for as long as I want)</p>\n"}, {"tags": ["ruby", "request"], "comments": [{"owner": {"reputation": 969, "user_id": 387169, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7fd6ad14459f190fffc8afe8f2e8fba7?s=128&d=identicon&r=PG", "display_name": "mhz", "link": "https://stackoverflow.com/users/387169/mhz"}, "edited": false, "score": 1, "creation_date": 1511373039, "post_id": 47439935, "comment_id": 81836969, "body": "I think it depends how you define your <code>parameter_list</code>. Whatever it is, seems like every value parameter needs a key. Sebastian&#39;s example below is one way to join key/value pairs"}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": false, "score": 1, "last_activity_date": 1511372693, "last_edit_date": 1511372693, "creation_date": 1511372271, "answer_id": 47440846, "question_id": 47439935, "link": "https://stackoverflow.com/questions/47439935/ruby-nethttp-api-sending-multiple-parameters-with-get-post/47440846#47440846", "title": "Ruby Net::Http Api , Sending Multiple Parameters with GET/POST", "body": "<p>You can create your own hash by joining <code>parameter_list</code> with <code>value_list</code> and converting it to hash, and then pass it as the form data, like:</p>\n\n<pre><code>parameter_list = %w[from to foo]\nvalue_list = %w[2005-01-01 2005-03-31 bar]\n\nform_data = parameter_list.zip(value_list).to_h\n\np form_data\n# {\"from\"=&gt;\"2005-01-01\", \"to\"=&gt;\"2005-03-31\", \"foo\"=&gt;\"bar\"}\nreq.set_form_data form_data\n</code></pre>\n\n<p>Note a constraint is both arrays must have the same size.</p>\n"}], "owner": {"reputation": 3, "user_id": 8695554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5ff0ab0fe74f3f124240cfc36ee722?s=128&d=identicon&r=PG&f=1", "display_name": "venturemoo", "link": "https://stackoverflow.com/users/8695554/venturemoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511372693, "creation_date": 1511369151, "question_id": 47439935, "link": "https://stackoverflow.com/questions/47439935/ruby-nethttp-api-sending-multiple-parameters-with-get-post", "title": "Ruby Net::Http Api , Sending Multiple Parameters with GET/POST", "body": "<p>I try to create a generic method to send GET/POST data with parameters using Ruby using NET:HTTP api ( <a href=\"https://apidock.com/ruby/Net/HTTP\" rel=\"nofollow noreferrer\">https://apidock.com/ruby/Net/HTTP</a>). Therefore, the number of parameters is not fixed. I know how to add a form data, as it is explained at : <a href=\"https://stackoverflow.com/questions/12847956/get-http-request-in-ruby\">Get HTTP request in Ruby</a>, I use;</p>\n\n<pre><code>uri = URI('http://www.example.com/todo.cgi') \nreq = Net::HTTP::Post.new(uri.path)\nreq.set_form_data('from' =&gt; '2005-01-01', 'to' =&gt; '2005-03-31')\n</code></pre>\n\n<p>However it works when I know how many parameters I will have. I tried this but could not find how to add data instead of replacing.</p>\n\n<pre><code>parameter_list.each_with_index do |param,index|\nreq.set_form_data(param.to_s =&gt; value_list[index])\nend\n</code></pre>\n\n<p>How can I make \"For each parameter in my parameter list, add form data\"? </p>\n"}, {"tags": ["ruby", "if-statement", "foreach", "ternary-operator"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1511370604, "post_id": 47439411, "comment_id": 81835606, "body": "I suggest you create a method with a hash as the argument. For example, <code>def doit(hash);  some code here; end</code>. Then execute <code>doit(condition ? hash_a : hash_b)</code>. This clarifies what you are doing and facilitates testing."}], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 2, "last_activity_date": 1511371000, "creation_date": 1511371000, "answer_id": 47440495, "question_id": 47439411, "link": "https://stackoverflow.com/questions/47439411/ruby-each-iterator-substitute-the-hash-to-iterate-through-based-on-if-conditio/47440495#47440495", "title": "Ruby each Iterator - Substitute the hash to iterate through based on if condition?", "body": "<p>You can directly select the object to call <code>each</code> on with a ternary operator, e.g.:</p>\n\n<pre><code>(SOME_CONDITION ? hash_a : hash_b).each do |x|\n  # some code in here\nend\n</code></pre>\n\n<p>If <code>SOME_CONDITION</code> is rather simple, this is a nice and clean approach. If the condition is more complex, you should either extract the condition or even the whole object selection into their own methods respectively.</p>\n"}], "owner": {"reputation": 13, "user_id": 8707704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0e9d6d1c20f8409093943956404a43?s=128&d=identicon&r=PG&f=1", "display_name": "wells", "link": "https://stackoverflow.com/users/8707704/wells"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47440495, "answer_count": 1, "score": 0, "last_activity_date": 1511371000, "creation_date": 1511367561, "question_id": 47439411, "link": "https://stackoverflow.com/questions/47439411/ruby-each-iterator-substitute-the-hash-to-iterate-through-based-on-if-conditio", "title": "Ruby each Iterator - Substitute the hash to iterate through based on if condition?", "body": "<p>I have two hashes, and need to iterate through one of them based on the result of an if condition. Below is how my code currently looks: </p>\n\n<pre><code>if SOME CONDITION\n  hash_a.each do |x|\n    some code in here\n  end\nelse \n  hash_b.each do |x|\n    the same code in here\n  end\n</code></pre>\n\n<p>There is about 30 lines of code executed for each element, so my question is: is there a way to make the code look something more like this: </p>\n\n<pre><code>SOME CONDITION ? hash_a.each do |x| : hash_b.each do |x|\n  some code in here \nend\n</code></pre>\n\n<p>Or simplify/reduce it in any other way? </p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1511367926, "post_id": 47439348, "comment_id": 81833806, "body": "I&#39;ve fixed the indentation, but you should always do this yourself"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511368253, "post_id": 47439348, "comment_id": 81834032, "body": "I&#39;m voting to close this question as off-topic because you have already asked this question here, under a second account: <a href=\"https://stackoverflow.com/questions/47437332/so-i-want-the-answer-for-the-user-just-to-include-numbers-from-0-to-9-how-do-i/47439077#47439077\" title=\"so i want the answer for the user just to include numbers from 0 to 9 how do i\">stackoverflow.com/questions/47437332/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 8991740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99863d93b1d6670302b59733fe994f37?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Klingser", "link": "https://stackoverflow.com/users/8991740/andy-klingser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1511370385, "answer_count": 0, "score": 0, "last_activity_date": 1511368045, "creation_date": 1511367348, "last_edit_date": 1511368045, "question_id": 47439348, "link": "https://stackoverflow.com/questions/47439348/how-to-force-the-user-to-only-type-numbers", "closed_reason": "Duplicate", "title": "How to force the user to only type numbers", "body": "<p>First, I want to say that I am new to ruby, and I am still learning. I am currently working on a school project where the assignment is to make a program calculate the user's input. </p>\n\n<p>However, in my program I want it to only permit the user to type in numbers. If the user gives any form for letters it will get an error, and make the user try again until he gives a number. Any way of doing this?</p>\n\n<p>Thank you so much, if you can help me:)</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>def calculate_one #method to calculate option 1\n\n  prompt = \"&gt; \" #make it look nice\n  puts \"What is the salary for the accountant? \" \n  print prompt \n  while @accountant = gets.chomp #looping \n\n    if @accountant =~ /\\A\\d+\\z/\n\n      puts \"Error: Only use numbers. Please try again\"\n      print prompt \n\n    else\n      \"What is the salary for the developer? \"\n      print prompt\n\n      while @developer = gets.chomp\n\n        if @developer =~ /\\A\\d+\\z/\n          puts \"Error: Only use numbers. Please try again\"\n          print prompt\n\n        else \n          print \"The salary for an account is #{@accountant}\\nThe salary for an developer is #{@developer}\"\n\n          break\n        end\n      end \n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1511365402, "post_id": 47438266, "comment_id": 81831973, "body": "Why would you want to do this? The purpose of tags is to choose which tests to (not) run, not to determine the behaviour of the test&#39;s steps."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511365928, "post_id": 47438266, "comment_id": 81832376, "body": "If you find it helpful to define some behaviour <i>around</i> tests with specific tags e.g. different logging or &quot;fail fast&quot; then you could consider using tagged hooks: <a href=\"https://github.com/cucumber/cucumber/wiki/Hooks#tagged-hooks\" rel=\"nofollow noreferrer\">github.com/cucumber/cucumber/wiki/Hooks#tagged-hooks</a>"}, {"owner": {"reputation": 670, "user_id": 5244942, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fARol.jpg?s=128&g=1", "display_name": "N..", "link": "https://stackoverflow.com/users/5244942/n"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511366845, "post_id": 47438266, "comment_id": 81833037, "body": "@TomLord I need tags to perform some condition."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511367854, "post_id": 47438266, "comment_id": 81833747, "body": "<i>&quot;some condition&quot;</i> -- What condition? That&#39;s what I was asking."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511367939, "post_id": 47438266, "comment_id": 81833817, "body": "I suspect there is some easy way to express that logic without referencing a tag. E.g. <code>And(&#47;^When I execute any scenario( with foobar)?$&#47;) do |page|</code>"}, {"owner": {"reputation": 670, "user_id": 5244942, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fARol.jpg?s=128&g=1", "display_name": "N..", "link": "https://stackoverflow.com/users/5244942/n"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511367987, "post_id": 47438266, "comment_id": 81833855, "body": "if condition, If it mock then I want to send different user and If it QA I want to send other user.   if we have @ mock tag on scenario, i can read the tag and decide which user I should send and same for @ QA tags"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1511434507, "post_id": 47438266, "comment_id": 81862105, "body": "So as I guessed above, I would implement this as part of the step definition and not rely on the tag. Something like: <code>&#47;^When I execute any scenario for (QA|mock) user$&#47;</code>. You <i>could</i> also store the user in an instance variable, using a tagged hook, but defining &quot;global&quot; behaviour like this could potentially get very messy as your test suite grows."}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1511368174, "last_edit_date": 1511368174, "creation_date": 1511367012, "answer_id": 47439227, "question_id": 47438266, "link": "https://stackoverflow.com/questions/47438266/how-to-get-tag-in-step-definition-from-scenario-ruby/47439227#47439227", "title": "How to get @tag in step definition from scenario ? - Ruby", "body": "<p>Not a direct solution, but hooks (Before, After, AfterStep, etc) can be set to run for specific tags, which allows you to set instance variables that are accessible in the scenario</p>\n\n<pre><code>Before('@my_tag') do  # will only run if the test has @my_tag tag\n   @my_tag = true  # This instance variable will be accessible in the test\nend\n</code></pre>\n\n<p>You could also use the fact that <code>Before</code> hooks get the scenario passed to them and use that to set an instance variable to the tag names</p>\n\n<pre><code>Before do |scenario|\n  @tags = scenario.source_tag_names # @tags instance variable accessible in test\nend\n</code></pre>\n"}], "owner": {"reputation": 670, "user_id": 5244942, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fARol.jpg?s=128&g=1", "display_name": "N..", "link": "https://stackoverflow.com/users/5244942/n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1740, "favorite_count": 0, "accepted_answer_id": 47439227, "answer_count": 1, "score": 2, "last_activity_date": 1511368174, "creation_date": 1511364083, "last_edit_date": 1511364124, "question_id": 47438266, "link": "https://stackoverflow.com/questions/47438266/how-to-get-tag-in-step-definition-from-scenario-ruby", "title": "How to get @tag in step definition from scenario ? - Ruby", "body": "<p>How to get tags from scenario into step definition in Ruby?</p>\n\n<pre><code>**@TAGS**\nScenario: Showing information of the scenario\nWhen I execute any scenario\n</code></pre>\n\n<p>Now my step definition is this:</p>\n\n<pre><code>And(/^When I execute any scenario$/) do |page|\n  How to get tag = @TAGS in step definition..\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511361765, "post_id": 47437332, "comment_id": 81829190, "body": "Right now you are comparing a <code>String</code> ( <code>accountant = gets.chomp</code>) to a <code>Range</code> (<code>(0..9)</code>) which will never be equivalent. What you want is to see if a number is in the range so <code>(0..9).cover?(accountant.to_i)</code> should work for you"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1511361938, "post_id": 47437332, "comment_id": 81829304, "body": "<code>if accountant =~ &#47;\\A\\d+\\z&#47;</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511361979, "post_id": 47437332, "comment_id": 81829342, "body": "Also note that invalid answers will convert to zero - e.g. <code>&quot;a&quot;.to_i == 0</code>. So a regex may be a better approach, as suggested above."}, {"owner": {"reputation": 1, "user_id": 8786272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1ff88122a634eb228c9a6c64c0d2ec?s=128&d=identicon&r=PG&f=1", "display_name": "Anders Klingsholm", "link": "https://stackoverflow.com/users/8786272/anders-klingsholm"}, "edited": false, "score": 0, "creation_date": 1511362027, "post_id": 47437332, "comment_id": 81829377, "body": "I found it out, used this    if accountant =~ /^-?[0-9]+$/"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1511362132, "post_id": 47437332, "comment_id": 81829453, "body": "So a negative salary is permitted. Poor employees :D Anyway, I&#39;d move to <code>&#47;\\A-?[0-9]+\\z&#47;</code> or something with a newline and something that is not a number would match. what @mudasobwa did suggest is good"}, {"owner": {"reputation": 954, "user_id": 8838821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uzgur.png?s=128&g=1", "display_name": "Oli Crt", "link": "https://stackoverflow.com/users/8838821/oli-crt"}, "edited": false, "score": 0, "creation_date": 1511364968, "post_id": 47437332, "comment_id": 81831677, "body": "You could use this <code>if (0..9).map(&amp;:to_s).include?(accountant)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1511366546, "creation_date": 1511366546, "answer_id": 47439077, "question_id": 47437332, "link": "https://stackoverflow.com/questions/47437332/so-i-want-the-answer-for-the-user-just-to-include-numbers-from-0-to-9-how-do-i/47439077#47439077", "title": "So I want the answer for the user just to include numbers from 0 to 9.. How do I do this?", "body": "<p>Your problem is in this line:</p>\n\n<pre><code>if accountant == (0..9)\n</code></pre>\n\n<p>This is checking whether the value is <em>equal</em> to a <em>range</em> - which is not what you wanted.</p>\n\n<p>Since the input from <code>gets.chomp</code> will always be a <em>string</em>, you need to check whether it only contains the characters: <code>\"0\"</code>, <code>\"1\"</code>, <code>\"2\"</code>, ... and <code>\"9\"</code>.</p>\n\n<p>One way to do this is with a regular expression:</p>\n\n<pre><code>if accountant =~ /\\A\\d+\\z/\n</code></pre>\n\n<ul>\n<li><code>\\A</code> means \"start of string\"</li>\n<li><code>\\z</code> means \"end of string\"</li>\n<li><code>\\d+</code> means \"one or more digit\" (0-9)</li>\n</ul>\n\n<hr>\n\n<p>Note that the solution you suggested in the comments, <code>/^-?[0-9]+$/</code>, is flawed since:</p>\n\n<ul>\n<li><code>^</code> means \"start of <em>line</em>\" (so it would be possible to insert arbitrary other characters <em>before a newline</em>)</li>\n<li><code>$</code> means \"end of <em>line</em>\" (so it would be possible to insert arbitrary other characters <em>after a newline</em>)</li>\n<li><code>-?</code> also allows an optional hyphen character. Which is presumably <em>not</em> what you want in this context, since the input is a <em>salary</em> - which surely cannot be negative!</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 954, "user_id": 8838821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uzgur.png?s=128&g=1", "display_name": "Oli Crt", "link": "https://stackoverflow.com/users/8838821/oli-crt"}, "is_accepted": false, "score": 1, "last_activity_date": 1511433303, "last_edit_date": 1511433303, "creation_date": 1511432370, "answer_id": 47453044, "question_id": 47437332, "link": "https://stackoverflow.com/questions/47437332/so-i-want-the-answer-for-the-user-just-to-include-numbers-from-0-to-9-how-do-i/47453044#47453044", "title": "So I want the answer for the user just to include numbers from 0 to 9.. How do I do this?", "body": "<p>A simple solution with no regex would be:</p>\n\n<pre><code>accountant.chars.all?{|n| (\"0\"..\"9\") === n}\n</code></pre>\n\n<p>You may want to read about the \"===\" operator in Ruby if you don't how it works yet as it may be confusing if you come from PHP or Javascript.<br>\n<a href=\"https://stackoverflow.com/questions/4467538/what-does-the-operator-do-in-ruby\">What does the &quot;===&quot; operator do in Ruby?</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 8786272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1ff88122a634eb228c9a6c64c0d2ec?s=128&d=identicon&r=PG&f=1", "display_name": "Anders Klingsholm", "link": "https://stackoverflow.com/users/8786272/anders-klingsholm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1511433303, "creation_date": 1511361413, "question_id": 47437332, "link": "https://stackoverflow.com/questions/47437332/so-i-want-the-answer-for-the-user-just-to-include-numbers-from-0-to-9-how-do-i", "title": "So I want the answer for the user just to include numbers from 0 to 9.. How do I do this?", "body": "<p>So as I ask for in the title. How do I make a loop that breaks when the user has entered some values that contain only number, and if not it will say try again.  </p>\n\n<pre><code>prompt = \"&gt; \"\n    puts \"What is the salary for the accountant: \"\n    print prompt \n    while accountant = gets.chomp\n\n      if accountant == (0..9)\n        puts \"Nice\"\n\n        break\n\n      else \n        \"try again\"\n        print prompt\n      end \n    end \n\n      end \n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "rubyzip"], "answers": [{"comments": [{"owner": {"reputation": 22814, "user_id": 182660, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/75e48a7020624657e5da6033590030ee?s=128&d=identicon&r=PG", "display_name": "SergGr", "link": "https://stackoverflow.com/users/182660/serggr"}, "edited": false, "score": 0, "creation_date": 1511620565, "post_id": 47479299, "comment_id": 81929079, "body": "I don&#39;t know which version @Michael uses but in 0.9.9 there is <a href=\"https://github.com/rubyzip/rubyzip/blob/0.9.9/lib/zip/zip_file.rb#L110-L118\" rel=\"nofollow noreferrer\">following piece of code</a> inside <code>open_buffer</code> which seems to produce this exactly message and it does not expect the String argument to be a file name. So there might be a quite different issue."}, {"owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "edited": false, "score": 0, "creation_date": 1511798962, "post_id": 47479299, "comment_id": 81986160, "body": "Zip::File.open(StringIO.new(my_string)) do |zip|  gives me:  TypeError: no implicit conversion of StringIO into String"}, {"owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "edited": false, "score": 0, "creation_date": 1511947534, "post_id": 47479299, "comment_id": 82054901, "body": "what version of zip are you using? it looks like it&#39;s an old one"}], "tags": [], "owner": {"reputation": 18203, "user_id": 100731, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056c32203f8017f075ac060069823b66?s=128&d=identicon&r=PG", "display_name": "phoet", "link": "https://stackoverflow.com/users/100731/phoet"}, "is_accepted": false, "score": 2, "last_activity_date": 1511553202, "creation_date": 1511553202, "answer_id": 47479299, "question_id": 47437265, "link": "https://stackoverflow.com/questions/47437265/rubyzip-zipzipfile-open-buffer-expects-an-argument-of-class-string-or-io/47479299#47479299", "title": "rubyzip Zip::ZipFile.open_buffer expects an argument of class String or IO", "body": "<p>i think that the main issue here is that the error-message is a bit misleading...</p>\n\n<p>it should say expected filename or io.</p>\n\n<p>in your code, you will need to wrap the content in a <code>StringIO</code> object so it can be treated as a stream. </p>\n\n<p>since <code>open_buffer</code> is deprecated you should use <code>open</code>.</p>\n\n<p>so it would look like <code>open(StringIO.new(my_string)</code></p>\n"}], "owner": {"reputation": 2132, "user_id": 856753, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1c53a71370f55d0f0a4cc7e4b2c06b91?s=128&d=identicon&r=PG", "display_name": "Micheal", "link": "https://stackoverflow.com/users/856753/micheal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1511950389, "creation_date": 1511361243, "last_edit_date": 1511380468, "question_id": 47437265, "link": "https://stackoverflow.com/questions/47437265/rubyzip-zipzipfile-open-buffer-expects-an-argument-of-class-string-or-io", "title": "rubyzip Zip::ZipFile.open_buffer expects an argument of class String or IO", "body": "<p>I am reading blob data from the database which is zipped(the contents of file is in CSV).\nThe result of my variable looks like this:</p>\n\n<blockquote>\n  <p>irb(main):144:0> my_string\n  => \"\\x1F\\x8B\\b\\x00\\xCB'\\xFBY\\x02\\xFF\\xC5R\\xC1n\\xDB0\\f\\xBD\\xF7+\\x04\\xF46\\xA8\\x81d\\xCB\\x96}\\f\\x92\\x15\\xEB\\x90\\xE6\\xB0\\x04\\xD8qPd&amp;\\xD1\\x12K\\xAE$w\\xE8\\xDF\\x8F\\x96\\x9A\\xA2\\x87\\x01\\x03r\\t\\r\\x8B|\\x92H>>\\xD\\x7F\\xC0\\xCB\\b\\xE1\\x03\\x84\\xC1\\xD9\\x00\\x19=z\\xD7o\\xC1\\xF7\\x19m]\\x8Aw*\\xEA\\xE3z\\xECwX%ze\\x83\\xD2\\xD18\\xFB\\xD4\\x91\\x88\\xC7\\xC6\\xE2\\xC5\\xB7\\x01\\x88V\\xBEKA\\x88*\\x8E\\x81D\\xD3c\\x17\\xD5\\x0FD\\xBD\\x82W\\aX\\x1D\\xB2\\xD9\\xAC\\xDE!VM;\\xB9\\xFB\\xD4*\\xC1\\xC1\\xD8\\xC3&lt;\\xD7\\xC8\\x04R\\x9B\\xDE\n  \\x01\\xFCU\\xEFF\\x8B\\xD3\\x98a\\x9E#\\x0F\\xFA\\x9D\\xED\\xCEX\\xD2+M,\\xC4?\\xCE\\x9F\\xC8\\xD1\\x85\\xB8U\\x87\\xE41s\\f\\xE0\\xD1\\x81\\xF7\\xCFAG:\\xD0gc\\xA1#\\xC6\\xBE:\\xA3\\x013pc\\xD2\\xB5#\\xBF\\xDD\\xE8q~rV\\x16\\xAC\\xEA\\xB3\\b\\xDF\\xDC\\xB9\\x03\\xBF\\x9E\n  6@\\xDEOK\\xA2\\xB4\\x8E_m\\xF48\\xBD;\\x81\\xC5f\\xFB\\xA5\\x8A\\x8A\\x84\\xD1\\xEB\\xA3\\xF28\\xD8\\xDE\\x9D\\x8DCxF0B\\xA0\\x0F\\x1E\\xA9\\xA1\\xA4\\xC1DHBbt\\xB0\\xA8\\xB7\\x87\\xAC\\xFD\\x05\\xDD\\xDDc\\xE30\\xD5\\xE1\\xB3\\x8A\\x143.f\\xDB\\x15\\xBA\\xA2\\xBAc\\xF4\\xF2\\xA5\\xA5\\x9C\\xFE\\xA6\\x94\\xAC\\x15\\x92I)(C\\xFB\\xB4\n</blockquote>\n\n<p>Now, I want to read this information in memory, unzip it and parse the csv file.\nI am using rubyzip and tried the following:</p>\n\n<pre><code>Zip::File.open_buffer(my_string) do |zip|\n  zip.each do |entry|\n    decompressed_data += entry.get_input_stream.read\n  end\nend\n</code></pre>\n\n<blockquote>\n  <p>RuntimeError: Zip::ZipFile.open_buffer expects an argument of class\n  String or IO. Found: String from (irb):224</p>\n</blockquote>\n\n<p>Is there a way to retrieve the contents of the zip file?</p>\n"}, {"tags": ["arrays", "ruby", "file", "calculator"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511360080, "post_id": 47436799, "comment_id": 81827940, "body": "Please post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1511360124, "post_id": 47436799, "comment_id": 81827969, "body": "Have you considered writing a book?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511360159, "post_id": 47436799, "comment_id": 81827996, "body": "But in all seriousness though, is this entire post length necessary? Can the problem not be summarised a little more succinctly? :)"}, {"owner": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "edited": false, "score": 0, "creation_date": 1511360271, "post_id": 47436799, "comment_id": 81828079, "body": "well, i&#39;m not sure i understand the problem :D but yeah, i&#39;ll try. just give me few minutes :)"}, {"owner": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "edited": false, "score": 0, "creation_date": 1511361951, "post_id": 47436799, "comment_id": 81829313, "body": "this is the best i could summarise it... it has precisely that matters and what you need in order to run it without any errors and check the problems. thank you"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "edited": false, "score": 0, "creation_date": 1511369240, "post_id": 47438363, "comment_id": 81834683, "body": "Thank you so much!! I wish i was told about serialization before being assigned with this project :D You really helped me a lot."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "edited": false, "score": 0, "creation_date": 1511369347, "post_id": 47438363, "comment_id": 81834772, "body": "@AlinChiver no problem. If this solved your problem, go ahead and click that up arrow and check mark by the top of my answer."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1511365146, "last_edit_date": 1511365146, "creation_date": 1511364397, "answer_id": 47438363, "question_id": 47436799, "link": "https://stackoverflow.com/questions/47436799/ruby-how-can-i-split-arrays-to-collect-data-from-files/47438363#47438363", "title": "Ruby - how can i split arrays to collect data from files", "body": "<p>Your data file <code>html24_projects.txt</code> looks like this</p>\n\n<pre><code>[\"Foobar Inc.\", 1, 2, 3, \"23\"]\n[\"Fizzbuzzsoft\", 2, 34, \"2\"]\n</code></pre>\n\n<p>After you strip and split those lines you end up with arrays like this</p>\n\n<pre><code>['\"Foobar Inc.\"', ' 1', ' 2', ' 3', ' \"23\"']\n</code></pre>\n\n<p>This is an array with five elements. The problem is that you then assign it to <strong>three</strong> varialbes:</p>\n\n<pre><code>_company_name, _set_variable, _hours = array_of_data\n</code></pre>\n\n<p>3\u22605 so Ruby assigns the first three array elements and discards the rest.</p>\n\n<pre><code>x, y, z = [1, 2, 3, 4, 5]\nx == 1\ny == 2\nz == 3\n</code></pre>\n\n<p>You want <code>_set_variable</code> to get all of the elements between the first and last. To do so, use a glob</p>\n\n<pre><code>x, *y, z = [1, 2, 3, 4, 5]\nx == 1\ny == [2, 3, 4]\nz == 5\n# in your case\n_company_name, *_set_variable, _hours = array_of_data\n</code></pre>\n\n<hr>\n\n<p>Please note that there are many more problems with your code than this; not necessarily problems that will cause bugs, but <em>design</em> problems that make the program very hard to understand, modify, and maintain. As you learn more Ruby, try to find and fix such deficiencies. For example:</p>\n\n<ul>\n<li>A project consists of three things: a name, a list of variables, and a number of hours. Currently you store all of these in a single array which makes them easy to mix up and hard to access separately</li>\n<li>What your program is doing is called <em>serialization</em>. That's when you take a data structure (Project) and save/load it from disk. This is a really common task and there are many existing tools for handling it. Writing your own code to do this is tricky and prone to errors (which is why you're here!)</li>\n<li>You're relying a lot on strings to get input from the user. A more robust way to handle string input is using <a href=\"https://ruby-doc.org/core/Regexp.html\" rel=\"nofollow noreferrer\">regular expressions</a>. These allow for more flexible handling of incorrect input</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 8795980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1771772566228868/picture?type=large", "display_name": "Alin Chiver", "link": "https://stackoverflow.com/users/8795980/alin-chiver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 47438363, "answer_count": 1, "score": -2, "last_activity_date": 1511365146, "creation_date": 1511359828, "last_edit_date": 1511363165, "question_id": 47436799, "link": "https://stackoverflow.com/questions/47436799/ruby-how-can-i-split-arrays-to-collect-data-from-files", "title": "Ruby - how can i split arrays to collect data from files", "body": "<p>I am supposed to make a program which can store informations about employees and their salaries. As well as projects of the company with details such as: \nname of the project, required hours and different variables they use for pricing (which are never the same for two projects). Also, we are asked to make it calculate the price for a new project which will use input from the user.</p>\n\n<pre><code>f = File.new(\"html24_projects.txt\", \"a+\")\nclass Project\n\n    def initialize                  \n        @project = Array.new \n    end\n\n\n\ndef company_name \n        puts \"\\nPlease enter the Company's name.\"\n        name_company = gets.chomp\n        @project.push(name_company)\n    end\n</code></pre>\n\n<p>I have a big problem here because, for some reason, it will not be saved in the file as a string eg[\"X\", \"25, 26, 27\", \"10\"]. \n It only saves as [\"X\", 25, 26, 27, \"10\"] and this is a big drag further when i want to split the line</p>\n\n<pre><code>    def set_variable \n            puts \"Please enter as many variables as needed for calculating the pricing on this project.\"\n            puts \"Press 0 to finalize\"\n            variable_price = gets.chomp.to_i\n            @project.push(variable_price)\n        while       \n            case variable_price\n                when 0\n                    @project = @project[0..-2]\n                    puts \"Thank you for your input\"\n                    break\n                else\n                    variable_price = gets.chomp.to_i\n                    @project.push(variable_price)\n            end\n        end\n    end\n\n\n\n\ndef hours\n    puts \"\\nPlease enter the number of hours required for the project. \n          \\n*Note that the number can be changed at any time if needed.\" #Idk how to make it happen, i mean, to be changed later\n    hours= gets.chomp\n    @project.push(hours)\nend\n\n\ndef add_To_File\n    File.open(\"html24_projects.txt\", \"a+\") do | f |\n        f.puts @project.to_s\n    end \nend\nend\n\ndef newProject\n  project = Project.new\n  project.company_name\n  project.set_variable\n  project.hours\n  project.add_To_File\nend\n\ndef listProjects\n    File.foreach(\"html24_projects.txt\") do | line |\n                string_of_data = line.chomp[1..-2]\n                array_of_data  = string_of_data.split(',')\n                _company_name, _hours, _set_variable = array_of_data\n                puts _company_name\n            end\nend\n\n\n\n\n\nwhile true\nputs\nputs \"1. Add a new project\"\nputs \"2. List all projects\"\n\nputs \"\\nPress 0 to exit\"\n\nchoice = gets.chomp.to_i\n\ncase choice\n    when 1\n        puts \n        newProject\n    when 2\n        puts\n        listProjects\n\n        puts \"Check details about a specific project\"\n        puts \"*Please, when you search, use name as stated in the display\"\n        project_to_search = gets.chomp\n\n        searched_project_found = false\n\n\n            File.foreach(\"html24_projects.txt\") do | line |\n                string_of_data = line.chomp[1..-2]\n                array_of_data  = string_of_data.split(',')\n                _company_name, _set_variable, _hours = array_of_data\n</code></pre>\n\n<p>My problem starts here, i can't split the line. Instead of the hours, i have the second value added by the user when he's inserting the \"variable prices\". \n And instead of all the numbers that were inputed, the program only shows the first one. I have tried to use \"string_of_data\" instead of \"_set_variable\" but it'll just show the entire line, so it's also pointless...</p>\n\n<pre><code>                    if _company_name.strip[1..-2] == project_to_search\n\n                    then\n                        searched_project_found = true\n                        puts \"Project #{project_to_search}:\"\n                        puts \"Requires #{_hours} hours.\"\n                        puts \"It has the following variables #{_set_variable}\"\n\n                        break \n                    end\n            end\n        puts \"\\nUnfortunately we don't have any project with that name. \\nEither you wrote it wrong, either we don't have such a project.\" unless searched_project_found    \n\n    when 0\n        puts \"Have a nice day!\"\n        break\nend\nend\n\nfalse\n</code></pre>\n\n<p>Well, basically this is it. I can't save the informations in the file as i am supposed to, therefore i can't use them later in the code. I have explained how they sould be saved and how it actually is. The program it's actually running, so you can just give it a try if you're willing to help a poor student :D</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511359272, "post_id": 47436347, "comment_id": 81827427, "body": "This approach would not scale well if you have more than two types, but have you considered simply introducing a third &quot;combined&quot; type - i.e. <code>AdvertiserBrand &lt; Advertiser</code>, <code>AdvertiserDistributor &lt; Advertiser</code> <i>and</i> <code>AdvertiserBoth &lt; Advertiser</code> (pending a better name...)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511359791, "post_id": 47436347, "comment_id": 81827764, "body": "This approach sort-of relies on multiple inheritance, however, which ruby does not support. (i.e. <code>AdvertiserBoth</code> <i>wants to</i> inherit from <code>AdvertiserBrand</code> <b>and</b> <code>AdvertiserDistributor</code>.) But you could mitigate that by defining the shared logic in modules, and including it to both classes."}, {"owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511361321, "post_id": 47436347, "comment_id": 81828856, "body": "No I haven&#39;t considered this approach !  Seems good to me since I only have two types and I didn&#39;t think it will be more in the futur. I make 3 classes and 2 modules to share business logic. Thanks you Tom :-)"}, {"owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511362256, "post_id": 47436347, "comment_id": 81829539, "body": "(By the way, if somebody have another solution I&#39;m still interested :) )"}], "answers": [{"comments": [{"owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "edited": false, "score": 0, "creation_date": 1511450522, "post_id": 47439022, "comment_id": 81871966, "body": "Actually this won&#39;t work for me because I want the <code>AdvertiserBoth</code> model to have both <code>Brand</code> and <code>Distributor</code> feature. In another language I would have done a multiple inheritance but in ruby the module inclusion solve my problem in a better way"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "is_accepted": false, "score": 0, "last_activity_date": 1511366362, "creation_date": 1511366362, "answer_id": 47439022, "question_id": 47436347, "link": "https://stackoverflow.com/questions/47436347/polymorphic-model-who-can-be-both-types/47439022#47439022", "title": "Polymorphic model who can be both types", "body": "<p>Continuing from @TomLord, why don't you flip the inheritance chain, i.e.</p>\n\n<pre><code>class Advertiser &lt; ActiveRecord::Base\nend\n\nclass AdvertiserBoth &lt; Advertiser\n  # define any association or behavior that you think both of brand and distributor role should have\nend\n\nclass Brand &lt; AdvertiserBoth\n  # define brand-specific relations and behavior\nend\n\nclass Distributor &lt; AdvertiserBoth\n  # define distributor-specific details\nend\n</code></pre>\n\n<p>In this approach, <strong>you don't have to define roles as polymorphic or even no need to define any boolean attributes which merely define the role type</strong>. You can also avoid defining any shared modules for the purpose you discussed in the question comment.</p>\n\n<p>You can also eliminate the <code>AdvertiserBoth</code> class and put all the logics inside the <code>Advertiser</code> class itself if you believe the case could be solved in this way.</p>\n\n<p>The main advantage with this approach is that you can manage all these models in a <strong>single database table</strong>, which is why its called <a href=\"http://guides.rubyonrails.org/association_basics.html#single-table-inheritance\" rel=\"nofollow noreferrer\"><code>Single Table Inheritance (STI)</code></a>.</p>\n"}], "owner": {"reputation": 1337, "user_id": 5422365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52e31b390fd694c2ef039dc1baf59888?s=128&d=identicon&r=PG&f=1", "display_name": "Aschen", "link": "https://stackoverflow.com/users/5422365/aschen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511366362, "creation_date": 1511358490, "question_id": 47436347, "link": "https://stackoverflow.com/questions/47436347/polymorphic-model-who-can-be-both-types", "title": "Polymorphic model who can be both types", "body": "<p>I have a model <code>Advertiser</code> who can be a <code>brand</code> or a <code>distributor</code> but also the both. In my model I have two boolean attributes to find out which roles can have my <code>Advertiser</code>.  </p>\n\n<p>The point is that an <code>Advertiser</code> - <code>distributor</code> have some <code>has_many</code> relations that an <code>Advertiser</code> - <code>brand</code> doesn't have.  </p>\n\n<p>Usually I use a polymorphic model to differenciate the roles but in this case my <code>Advertiser</code> could be both roles at the same time.</p>\n\n<p>Is there any way the have a different behavior for my model based on an instance attribute value ? \nSomething like this maybe :</p>\n\n<pre><code>class Advertiser &lt; ApplicationRecord\n  if instance.distributor == true\n    has_many :managers\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5556, "user_id": 2003070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4a8537918bd20a0575c065a688ec561?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2003070/dmitry"}, "edited": false, "score": 0, "creation_date": 1511354629, "post_id": 47434937, "comment_id": 81824150, "body": "<a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>: 3. Questions asking for homework help must include a <b>summary of the work you&#39;ve done so far to solve the problem</b>, and a description of the difficulty you are having solving it."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1511355204, "post_id": 47434937, "comment_id": 81824531, "body": "To get started, figure out what different entities can be there in your project e.g. users, expenses, etc."}], "answers": [{"tags": [], "owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "is_accepted": true, "score": 0, "last_activity_date": 1511355577, "creation_date": 1511355577, "answer_id": 47435388, "question_id": 47434937, "link": "https://stackoverflow.com/questions/47434937/how-to-calculate-with-input-from-user-in-ruby/47435388#47435388", "title": "How to calculate with input from user in Ruby", "body": "<p>You could do this in a service object, something like: </p>\n\n<pre><code># /services/project_calculator_service.rb\n\nclass ProjectCalculatorService\n  def self.call(values)\n    new(values).call\n  end\n\n  def call \n   # do your calculation here using the @variables\n   # return the result \n  end\n\n  private \n\n  def initialize(values)\n    @developer_salary = values[:developer_salary]\n    @top_management_salary = values[:top_management_salary]\n    # ...\n  end\nend\n</code></pre>\n\n<p>then first display a form to the user, maybe in <code>projects#new</code> then post the params in <code>projects#create</code>, then in your controller: </p>\n\n<pre><code>def create \n  @result = ProjectCalculatorService.call(params[:project]) \n  # Save the result or render it in a view \nend\n</code></pre>\n\n<p>The calculation could also go in the <code>lib</code> folder or in a <code>concern</code> called by the model assuming you have a Project model. </p>\n\n<p>Hope it helps. Don't hesitate to provide more context for a better answer. </p>\n"}], "owner": {"reputation": 1, "user_id": 8789813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/272c11e7debb54e4d2d482b40fecef16?s=128&d=identicon&r=PG&f=1", "display_name": "Frederikstubbe", "link": "https://stackoverflow.com/users/8789813/frederikstubbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "closed_date": 1511355997, "accepted_answer_id": 47435388, "answer_count": 1, "score": -2, "last_activity_date": 1511355577, "creation_date": 1511354263, "question_id": 47434937, "link": "https://stackoverflow.com/questions/47434937/how-to-calculate-with-input-from-user-in-ruby", "closed_reason": "Needs more focus", "title": "How to calculate with input from user in Ruby", "body": "<p>I have to make a ruby program where I have to calculate the cost of a firms project. </p>\n\n<p>Ex of the variables:</p>\n\n<ul>\n<li>Salary of an account manager (It has to be user input but ex 9.250kr\nx2)</li>\n<li>Salary of a developer(It has to be user input but ex 9.250kr x2)</li>\n<li>Salary for the top management (20.000kr)</li>\n<li>Rent of the office space per person; (4.000kr)</li>\n<li>Lunch per person (400kr)</li>\n<li>Administrative costs (4.000kr)</li>\n<li>Other utilities:(1.900kr)</li>\n</ul>\n\n<p>But I'm not quite sure how to start the program, should I put them in classes or?</p>\n\n<p>And I'm not sure how to calculate with a user input. </p>\n\n<p>Please come with some advises! </p>\n"}, {"tags": ["ruby", "heroku", "rubymine"], "owner": {"reputation": 13, "user_id": 8871144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfa4f2574e8a0ac4c8f03831b30c165?s=128&d=identicon&r=PG&f=1", "display_name": "marina", "link": "https://stackoverflow.com/users/8871144/marina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511378773, "creation_date": 1511352885, "question_id": 47434476, "link": "https://stackoverflow.com/questions/47434476/does-heroku-provide-capabilities-for-remote-debugging-for-ruby-applications", "title": "Does Heroku provide capabilities for remote debugging for Ruby applications?", "body": "<p>I'm interested in remote debugging from RubyMine, where is Ruby Remote Debug configuration is used for it. I see mentions about Node.js, Java in Heroku <a href=\"https://devcenter.heroku.com/articles/exec#remote-debugging\" rel=\"nofollow noreferrer\">documentation</a>  and no one about Ruby. \nI tried to follow RubyMine <a href=\"https://www.jetbrains.com/help/ruby/remote-debugging.html\" rel=\"nofollow noreferrer\">instructions</a> and decidied to install ruby-debug-ide inside Heroku dynos through Personal apps -> ruby-app -> Run console -> heroku run bash -> gem install ruby-debug-ide, which is failed with messages: </p>\n\n<blockquote>\n  <p>\"ERROR:  Error installing ruby-debug-ide: \n   ERROR: Failed to build gem native extension.\"</p>\n</blockquote>\n\n<p>Eventually, please let me know if:</p>\n\n<ul>\n<li>Heroku allows to debug Ruby apps remotely</li>\n<li>it possible to install ruby-debug-ide inside dyno</li>\n</ul>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "ubuntu", "ubuntu-16.04", "systemd"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1511366428, "post_id": 47433911, "comment_id": 81832743, "body": "Would <code>type=forking</code> work? I&#39;m not sure how that works with multiple forked processes though."}], "answers": [{"tags": [], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1511357526, "creation_date": 1511357526, "answer_id": 47436037, "question_id": 47433911, "link": "https://stackoverflow.com/questions/47433911/from-within-ruby-how-do-i-spawn-a-process-in-a-different-control-group-than-the/47436037#47436037", "title": "From within ruby: How do I spawn a process in a different control group than the current?", "body": "<p>I didn't find any way to do this. Instead I changed the <code>KillMode</code> of my systemd script to <code>process</code>, this solved the problem: <a href=\"https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd#32209842\">Can&#39;t detach child process when main process is started from systemd</a> </p>\n"}], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511357526, "creation_date": 1511351153, "question_id": 47433911, "link": "https://stackoverflow.com/questions/47433911/from-within-ruby-how-do-i-spawn-a-process-in-a-different-control-group-than-the", "title": "From within ruby: How do I spawn a process in a different control group than the current?", "body": "<p>Using <code>Kernel.spawn</code> I can start a new process from within ruby, executing som arbitrary shell commands. The new process will appear in the same <code>control group</code> as the ruby process. How can I change that to have it go in it's own?</p>\n\n<p>The reason for me wanting this is that my ruby process is managed by <code>systemd</code> and I don't want any of these particular shell command processes to be cleaned up/terminated when the ruby process is restarted.</p>\n"}, {"tags": ["ruby", "proxy", "permissions", "rubygems"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511397585, "post_id": 47433738, "comment_id": 81847193, "body": "Can you run <code>ruby -ropenssl -e &#39;puts OpenSSL::OPENSSL_VERSION&#39;</code> and post the output in your question, also run <code>openssl s_client -host rubygems.org -port 443</code> and post that in your question also?"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511397908, "post_id": 47433738, "comment_id": 81847272, "body": "Also, if you visit <code>https:&#47;&#47;api.rubygems.org&#47;specs.4.8.gz</code> in your browser does it download the .gz file? Or does it give you a cert warning or error?"}, {"owner": {"reputation": 132, "user_id": 4650676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udFip.jpg?s=128&g=1", "display_name": "trashpanda", "link": "https://stackoverflow.com/users/4650676/trashpanda"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511530963, "post_id": 47433738, "comment_id": 81903716, "body": "Hi @Beartech, sorry for the delayed response. I&#39;ve added some more info to the question. And, if I go to <code>https:&#47;&#47;api.rubygems.org&#47;specs.4.8.gz</code> it does download the .gz file - though I can&#39;t install it using the <code>--local</code> option because it needs to connect to the web which gives me the same 407 response."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511645997, "post_id": 47433738, "comment_id": 81936835, "body": "Well I guess the &quot;easy&quot; answer is change your password to something without a special character for the install then change it back."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511646549, "post_id": 47433738, "comment_id": 81936969, "body": "Does your proxy use NTLM authentication? See this thread for issues with NTLM authentication: <a href=\"https://www.ruby-forum.com/topic/163889\" rel=\"nofollow noreferrer\">ruby-forum.com/topic/163889</a>"}, {"owner": {"reputation": 132, "user_id": 4650676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udFip.jpg?s=128&g=1", "display_name": "trashpanda", "link": "https://stackoverflow.com/users/4650676/trashpanda"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511942682, "post_id": 47433738, "comment_id": 82052040, "body": "Thanks for your help @Beartech - managed to solve it just now. I needed to use %5C instead of a backslash! I&#39;ve posted the code in the answer. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 4650676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udFip.jpg?s=128&g=1", "display_name": "trashpanda", "link": "https://stackoverflow.com/users/4650676/trashpanda"}, "is_accepted": true, "score": 1, "last_activity_date": 1511942671, "creation_date": 1511942671, "answer_id": 47547806, "question_id": 47433738, "link": "https://stackoverflow.com/questions/47433738/gem-install-watir-error-while-executing-gem-nethttpserverexception-407-p/47547806#47547806", "title": "gem install watir - ERROR: While executing gem (Net::HTTPServerException) 407 &quot;Proxy Authentication Required&quot;", "body": "<p>Finally solved it! A colleague had similar proxy issues with Atom's plugin list so pointed me in the right direction.</p>\n\n<p>The command is:</p>\n\n<pre><code>gem install --http-proxy http://{domain}%5C{username}:{password}@{proxy.address}:{port}/ watir \n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 4650676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/udFip.jpg?s=128&g=1", "display_name": "trashpanda", "link": "https://stackoverflow.com/users/4650676/trashpanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "accepted_answer_id": 47547806, "answer_count": 1, "score": 1, "last_activity_date": 1582802062, "creation_date": 1511350659, "last_edit_date": 1511533873, "question_id": 47433738, "link": "https://stackoverflow.com/questions/47433738/gem-install-watir-error-while-executing-gem-nethttpserverexception-407-p", "title": "gem install watir - ERROR: While executing gem (Net::HTTPServerException) 407 &quot;Proxy Authentication Required&quot;", "body": "<p>This has been driving me nuts - I've looked everywhere for a solution to this over the last three days... but nothing's worked, so far. </p>\n\n<p>On Monday, I was getting this error when trying to install watir:</p>\n\n<pre><code>C:\\Users\\dan&gt;gem install watir \nERROR: Could not find a valid gem 'watir' (&gt;= 0), here is why: \nUnable to download data from https://rubygems.org/ - timed out \n(https://api.rubygems.org/specs.4.8.gz) \n</code></pre>\n\n<p>So figured it was a firewall / proxy error. To try and get around it, I used the <code>--http-proxy</code> option:</p>\n\n<pre><code>C:\\Ruby24-x64\\bin&gt;gem install watir --http-proxy http://my.awesome.proxy:port\nERROR: While executing gem ... (Net::HTTPServerException)\n407 \"Proxy Authentication Required\"\n</code></pre>\n\n<p>So then I tried running it with my username and password defined, but I've read it won't work if my password contains a special character (which it does):</p>\n\n<pre><code>C:\\Ruby24-x64\\bin&gt;gem install --http-proxy http://myusername:mypassword@my.awesome.proxy:port watir\nERROR: While executing gem ... (Net::HTTPServerException)\n407 \"Proxy Authentication Required\"\n</code></pre>\n\n<p>So then I tried set the proxy, username and password for HTTP and HTTPS using the set option like so:</p>\n\n<pre><code>set HTTP_PROXY=my.awesome.proxy:port\nset HTTP_PROXY_USER=myusername\nset HTTP_PROXY_PASS=mypassword\nset HTTPS_PROXY=my.awesome.proxy:port\nset HTTPS_PROXY_USER=myusername\nset HTTPS_PROXY_PASS=mypassword\n</code></pre>\n\n<p>...but I'm still getting the 407 error. Any ideas?</p>\n\n<p>I'm on Windows 10, my gem environment details are below:</p>\n\n<pre><code>C:\\Ruby24-x64\\bin&gt;gem env\nRubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.2\n  - RUBY VERSION: 2.4.2 (2017-09-14 patchlevel 198) [x64-mingw32]\n  - INSTALLATION DIRECTORY: C:/Ruby24-x64/lib/ruby/gems/2.4.0\n  - USER INSTALLATION DIRECTORY: C:/Users/dan/.gem/ruby/2.4.0\n  - RUBY EXECUTABLE: C:/Ruby24-x64/bin/ruby.exe\n  - EXECUTABLE DIRECTORY: C:/Ruby24-x64/bin\n  - SPEC CACHE DIRECTORY: C:/Users/dan/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: C:/ProgramData\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x64-mingw32\n  - GEM PATHS:\n     - C:/Ruby24-x64/lib/ruby/gems/2.4.0\n     - C:/Users/dan/.gem/ruby/2.4.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n</code></pre>\n\n<p>@Beartech:</p>\n\n<pre><code>C:\\Ruby24-x64&gt;ruby -ropenssl -e 'puts OpenSSL::OPENSSL_VERSION'\nOpenSSL 1.0.2l  25 May 2017\n\nMINGW64 ~\n$ openssl s_client -host rubygems.org -port 443\nconnect: Connection timed out\nconnect:errno=116\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 0, "last_activity_date": 1511353307, "creation_date": 1511353307, "answer_id": 47434617, "question_id": 47433696, "link": "https://stackoverflow.com/questions/47433696/bundle-install-command-error-ruby-version-is-2-2-0-and-rails-version-is-4-1-8/47434617#47434617", "title": "Bundle install command error. Ruby version is 2.2.0 and Rails version is 4.1.8", "body": "<p>You need to upgrade the version of <code>composite_primary_keys</code> gem.</p>\n\n<p>Change it to <code>~&gt; 8.0.0</code> which requires activerecord '~>4.2.0'</p>\n\n<pre><code>gem 'composite_primary_keys',  '~&gt; 8.0.0'\n</code></pre>\n\n<p>Refer <a href=\"https://github.com/composite-primary-keys/composite_primary_keys/blob/v8.0.0/composite_primary_keys.gemspec\" rel=\"nofollow noreferrer\">composite_primary_keys.gemspec</a> </p>\n\n<p>Similarly, for other gems you can do the same.</p>\n\n<p>Or if you are not sure on the gem versions you can just add gem name and leave the versions for <code>bundler</code> to take care of it.</p>\n"}], "owner": {"reputation": 127, "user_id": 4702794, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-OturloCsvZw/AAAAAAAAAAI/AAAAAAAAC-M/wG9vmE7iBKw/photo.jpg?sz=128", "display_name": "Binu Paul", "link": "https://stackoverflow.com/users/4702794/binu-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511353307, "creation_date": 1511350513, "last_edit_date": 1511350976, "question_id": 47433696, "link": "https://stackoverflow.com/questions/47433696/bundle-install-command-error-ruby-version-is-2-2-0-and-rails-version-is-4-1-8", "title": "Bundle install command error. Ruby version is 2.2.0 and Rails version is 4.1.8", "body": "<p>Error running bundle install command. Ruby version is 2.2.0 and Rails version is 4.1.8. Environment is Apple Mac OS Sierra (10.12.5) </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"activerecord\":\n</code></pre>\n\n<p>In Gemfile:\n    composite_primary_keys (= 7.0.15) was resolved to 7.0.15, which depends on\n      activerecord (~> 4.1.7)</p>\n\n<pre><code>rails (= 4.2.4) was resolved to 4.2.4, which depends on\n  activerecord (= 4.2.4)\n</code></pre>\n\n<p>Bundler could not find compatible versions for gem \"rack\":\n  In Gemfile:\n    rack (~> 1.5.3)</p>\n\n<pre><code>omniauth was resolved to 1.7.1, which depends on\n  rack (&lt; 3, &gt;= 1.6.2)\n</code></pre>\n\n<p>Bundler could not find compatible versions for gem \"rails\":\n  In Gemfile:\n    rails (= 4.2.4)</p>\n\n<pre><code>commands was resolved to 0.2.1, which depends on\n  rails (&gt;= 3.2.0)\n\nmodel_tree was resolved to 1.0, which depends on\n  rails\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass", "ubuntu-16.04"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 3381697, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/qP0NE.png?s=128&g=1", "display_name": "user227495", "link": "https://stackoverflow.com/users/3381697/user227495"}, "edited": false, "score": 0, "creation_date": 1511350565, "post_id": 47433695, "comment_id": 81821572, "body": "Thanks. Is it an unstable package ( dev ) ? Just curious."}, {"owner": {"reputation": 177, "user_id": 3381697, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/qP0NE.png?s=128&g=1", "display_name": "user227495", "link": "https://stackoverflow.com/users/3381697/user227495"}, "edited": false, "score": 0, "creation_date": 1511351271, "post_id": 47433695, "comment_id": 81822015, "body": "I got this   $ sudo apt-get install libffi-dev [sudo] password for dna:  Reading package lists... Done Building dependency tree        Reading state information... Done <b>libffi-dev is already the newest version (3.2.1-4).</b> The following packages were automatically installed and are no longer required:   linux-headers-4.4.0-97 linux-headers-4.4.0-97-generic   linux-image-4.4.0-97-generic linux-image-extra-4.4.0-97-generic Use &#39;sudo apt autoremove&#39; to remove them. 0 upgraded, 0 newly installed, 0 to remove and 3 not upgraded."}], "tags": [], "owner": {"reputation": 46, "user_id": 962968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9155e64a7a37a0ca797fa8f96789405?s=128&d=identicon&r=PG", "display_name": "Andrew Fader", "link": "https://stackoverflow.com/users/962968/andrew-fader"}, "is_accepted": false, "score": 1, "last_activity_date": 1511350507, "creation_date": 1511350507, "answer_id": 47433695, "question_id": 47433625, "link": "https://stackoverflow.com/questions/47433625/error-failed-to-build-gem-native-extension-in-16-04/47433695#47433695", "title": "&quot; ERROR: Failed to build gem native extension &quot; in 16.04", "body": "<p>Try installing libffi-dev</p>\n\n<pre><code>sudo apt-get install libffi-dev\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 3381697, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/qP0NE.png?s=128&g=1", "display_name": "user227495", "link": "https://stackoverflow.com/users/3381697/user227495"}, "is_accepted": false, "score": 2, "last_activity_date": 1511351693, "creation_date": 1511351693, "answer_id": 47434100, "question_id": 47433625, "link": "https://stackoverflow.com/questions/47433625/error-failed-to-build-gem-native-extension-in-16-04/47434100#47434100", "title": "&quot; ERROR: Failed to build gem native extension &quot; in 16.04", "body": "<pre><code>sudo apt-get install ruby-dev\n</code></pre>\n\n<p>The above command fixed it for me.</p>\n"}], "owner": {"reputation": 177, "user_id": 3381697, "user_type": "registered", "accept_rate": 10, "profile_image": "https://i.stack.imgur.com/qP0NE.png?s=128&g=1", "display_name": "user227495", "link": "https://stackoverflow.com/users/3381697/user227495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511351693, "creation_date": 1511350281, "last_edit_date": 1511350531, "question_id": 47433625, "link": "https://stackoverflow.com/questions/47433625/error-failed-to-build-gem-native-extension-in-16-04", "title": "&quot; ERROR: Failed to build gem native extension &quot; in 16.04", "body": "<p>I was trying to install Sass. Went through this guide to install Ruby which <a href=\"http://sass-lang.com/install\" rel=\"nofollow noreferrer\">Sass website</a> told is a pre-requisite </p>\n\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-ruby-and-set-up-a-local-programming-environment-on-ubuntu-16-04\" rel=\"nofollow noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-install-ruby-and-set-up-a-local-programming-environment-on-ubuntu-16-04</a></p>\n\n<p>Looks like it went well</p>\n\n<pre><code>$ ruby -v\nruby 2.3.1p112 (2016-04-26) [x86_64-linux-gnu]\n</code></pre>\n\n<p>Now I am stuck at this point. I am not sure how to proceed further. I am using Ubuntu 16.04</p>\n\n<pre><code>$ sudo gem install sass\nBuilding native extensions.  This could take a while...\nERROR:  Error installing sass:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /var/lib/gems/2.3.0/gems/ffi-1.9.18/ext/ffi_c\n/usr/bin/ruby2.3 -r ./siteconf20171122-3627-1olbmft.rb extconf.rb\nmkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h\n\nextconf failed, exit code 1\n\nGem files will remain installed in /var/lib/gems/2.3.0/gems/ffi-1.9.18 for inspection.\nResults logged to /var/lib/gems/2.3.0/extensions/x86_64-linux/2.3.0/ffi-1.9.18/gem_make.out\n</code></pre>\n\n<p>What should I do now ? Please help.</p>\n"}, {"tags": ["ruby", "bundler", "redmine"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1511432827, "post_id": 47433466, "comment_id": 81861014, "body": "Note that bundler 1.16 is currently about the newest released version and thus satisfies the constraint of being newer than 1.5.0 (<code>16</code> is larger than <code>5</code>)"}, {"owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1511442298, "post_id": 47433466, "comment_id": 81866796, "body": "you are right. I reformulated the question to show how weird this server is behaving. If you could help me please...."}], "answers": [{"tags": [], "owner": {"reputation": 1847, "user_id": 1559697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d86210d11e5c5b3b1cba1573a25f2a02?s=128&d=identicon&r=PG", "display_name": "Nanego", "link": "https://stackoverflow.com/users/1559697/nanego"}, "is_accepted": true, "score": 1, "last_activity_date": 1511425137, "creation_date": 1511425137, "answer_id": 47450595, "question_id": 47433466, "link": "https://stackoverflow.com/questions/47433466/upgrade-bundler-for-redmine-latest-version/47450595#47450595", "title": "upgrade bundler for redmine latest version", "body": "<p>Have you tried this ?</p>\n\n<pre><code>gem update bundler\n</code></pre>\n\n<p>You could also use RVM to manage your versions: <a href=\"https://rvm.io/\" rel=\"nofollow noreferrer\">https://rvm.io/</a></p>\n"}], "owner": {"reputation": 3802, "user_id": 2096986, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3a02e7c9d317839db7ad17f840320afd?s=128&d=identicon&r=PG", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2096986/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 47450595, "answer_count": 1, "score": 0, "last_activity_date": 1511442236, "creation_date": 1511349836, "last_edit_date": 1511442236, "question_id": 47433466, "link": "https://stackoverflow.com/questions/47433466/upgrade-bundler-for-redmine-latest-version", "title": "upgrade bundler for redmine latest version", "body": "<p>I am trying to upgrade the redmine and for this I have to upgrade the bundler. The strange thing is that the web error show a different version of the bundler that it is installed.</p>\n\n<p><code>\nRedmine requires Bundler 1.5.0 or higher (you're using 1.3.5).\nPlease update with 'gem update bundler'. (SystemExit)\n  /var/www/redmine-3.2/Gemfile:4:in `abort'\n  /var/www/redmine-3.2/Gemfile:4:in `eval_gemfile'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler/dsl.rb:30:in `instance_eval'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler/dsl.rb:30:in `eval_gemfile'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler/dsl.rb:9:in `evaluate'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler/definition.rb:19:in `build'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler.rb:148:in `definition'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler.rb:116:in `setup'\n  /usr/local/rvm/gems/ruby-1.9.3-p484/gems/bundler-1.3.5/lib/bundler/setup.rb:17:in `&lt;top (required)&gt;'\n  /usr/local/rvm/rubies/ruby-1.9.3-p484/lib/ruby/site_ruby/1.9.1/rubygems/core_ext/kernel_require.rb:135:in `require'\n</code></p>\n\n<p>But the version that it is intalled on the server is 1.16.0:\n<code>\n[root@dev conf.d]# bundle -v\nBundler version 1.16.0\n</code></p>\n"}, {"tags": ["ruby", "for-loop", "local-variables"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1511353897, "post_id": 47433445, "comment_id": 81823680, "body": "Right, sorry for misguiding comment."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1511355539, "post_id": 47433445, "comment_id": 81824773, "body": "What are you trying to achieve? If you don&#39;t want a variable from outside get changed inside a loop, then don&#39;t change it. What is the point of assignment inside loop, if you don&#39;t want it to change?"}, {"owner": {"reputation": 731, "user_id": 2129178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c325d9c68c23531633e54f8a1f77b18d?s=128&d=identicon&r=PG", "display_name": "Nicola Mingotti", "link": "https://stackoverflow.com/users/2129178/nicola-mingotti"}, "edited": false, "score": 0, "creation_date": 1511356897, "post_id": 47433445, "comment_id": 81825748, "body": "I would like to use the <code>for</code> loop as i do in other programming languages, to keep a common pattern. It would be a substantial benefit to be able to definire local variables in the loop, i don&#39;t think i need to argument why it is so."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1511366971, "post_id": 47433445, "comment_id": 81833133, "body": "When I run your code, the outer <code>tmp</code> is indeed not modified. The block-local variable <code>tmp</code> masks it. How is this is not what you want?"}, {"owner": {"reputation": 731, "user_id": 2129178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c325d9c68c23531633e54f8a1f77b18d?s=128&d=identicon&r=PG", "display_name": "Nicola Mingotti", "link": "https://stackoverflow.com/users/2129178/nicola-mingotti"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1511371462, "post_id": 47433445, "comment_id": 81836146, "body": "@max, I don&#39;t understand well your question. The behaviour in the example is what i want. I was asking for a way to achieve that in a for loop."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1511375458, "post_id": 47433445, "comment_id": 81838256, "body": "@NicolaMingotti sorry, my bad."}], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 0, "last_activity_date": 1511354710, "creation_date": 1511354710, "answer_id": 47435097, "question_id": 47433445, "link": "https://stackoverflow.com/questions/47433445/ruby-local-variables-in-a-for-loop/47435097#47435097", "title": "Ruby local variables in a for loop", "body": "<p>I don't think that is possible, <code>for</code> loops do not have a scope of their own.</p>\n"}, {"comments": [{"owner": {"reputation": 731, "user_id": 2129178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c325d9c68c23531633e54f8a1f77b18d?s=128&d=identicon&r=PG", "display_name": "Nicola Mingotti", "link": "https://stackoverflow.com/users/2129178/nicola-mingotti"}, "edited": false, "score": 0, "creation_date": 1511454132, "post_id": 47441660, "comment_id": 81874082, "body": "Thank you @Max, your example with <code>proc</code> answers my question. I agree that it is not a nice structure to see. On the other side, <code>for</code> is (with <code>if</code>) the most written word in computer programming, it is a pity to leave it out of business in Ruby."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 731, "user_id": 2129178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c325d9c68c23531633e54f8a1f77b18d?s=128&d=identicon&r=PG", "display_name": "Nicola Mingotti", "link": "https://stackoverflow.com/users/2129178/nicola-mingotti"}, "edited": false, "score": 0, "creation_date": 1511463434, "post_id": 47441660, "comment_id": 81878496, "body": "@NicolaMingotti I haven&#39;t written a single <code>for</code> loop outside of experiments like this in all my years of using Ruby. I&#39;m pretty sure it&#39;s only in there so that people don&#39;t freak out when they come over from other languages."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1511375431, "creation_date": 1511375431, "answer_id": 47441660, "question_id": 47433445, "link": "https://stackoverflow.com/questions/47433445/ruby-local-variables-in-a-for-loop/47441660#47441660", "title": "Ruby local variables in a for loop", "body": "<p>You can introduce a new block for masking the outer variable</p>\n\n<pre><code>tmp = 0\nfor i in (1..5) do\n  proc do |;tmp|\n    puts i\n    tmp = i\n  end[]\nend\n</code></pre>\n\n<p>This is awful. The difference between <code>for</code> and <code>each</code> is that the iteration variable in a <code>for</code> loop <em>pollutes the outer scope</em>.</p>\n\n<pre><code>x = []\n# i has same scope as x\nfor i in (1..3)\n  # closure captures i outside the loop scope, so...\n  x &lt;&lt; lambda { i }\nend\n# WAT\nx.map(&amp;:call) # [3, 3, 3]\n\nx = []\n(1..3).each { |i| x &lt;&lt; lambda { i } }\n# sanity restored\nx.map(&amp;:call) # [1, 2, 3]\n</code></pre>\n\n<p>Using my hack above to make your <code>for</code> act more like an <code>each</code> makes already confusing behavior even more confusing. Better to avoid <code>for</code> entirely.</p>\n"}], "owner": {"reputation": 731, "user_id": 2129178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c325d9c68c23531633e54f8a1f77b18d?s=128&d=identicon&r=PG", "display_name": "Nicola Mingotti", "link": "https://stackoverflow.com/users/2129178/nicola-mingotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511375826, "creation_date": 1511349786, "last_edit_date": 1511375826, "question_id": 47433445, "link": "https://stackoverflow.com/questions/47433445/ruby-local-variables-in-a-for-loop", "title": "Ruby local variables in a for loop", "body": "<p>I would like to know if it is possible to set local variables in Ruby <code>for</code> loop. </p>\n\n<p>More precisely I would like to have the <code>for</code> loop to behave like this:</p>\n\n<pre><code>tmp = 0\n1.upto(5) { |i;tmp| puts i; tmp = i; } ; \"tmp: #{tmp}\"\n</code></pre>\n\n<p>The <code>tmp</code> variable should not be modified by what runs inside the foor loop.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-maps", "gmaps4rails"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1511348173, "post_id": 47432884, "comment_id": 81820007, "body": "you are trying to display content from <code>http</code> to <code>https</code>"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1511348200, "post_id": 47432884, "comment_id": 81820029, "body": "both should be either <code>http:&#47;&#47;</code> or <code>https:&#47;&#47;</code>"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1511348232, "post_id": 47432884, "comment_id": 81820050, "body": "one more question, why are you accessing localhost with <code>https:&#47;&#47;</code> ?"}, {"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1511348619, "post_id": 47432884, "comment_id": 81820301, "body": "Thanks for the reply @Deepak Mahakale... I changed the <code>http</code> to <code>https</code> and warnings go away, but still the map doesn&#39;t appear. I&#39;m using <code>https</code> in order to access <code>html5 geolocation</code> with safari."}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1511348919, "post_id": 47433057, "comment_id": 81820471, "body": "Thanks for the reply @Sachin Singh, I updated according to your code and still it doesn&#39;t appear"}, {"owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "reply_to_user": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1511349783, "post_id": 47433057, "comment_id": 81821037, "body": "@Theopap please try not to append current location to <code>@hash</code> and let me know."}], "tags": [], "owner": {"reputation": 6929, "user_id": 1262519, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/zvPMu.jpg?s=128&g=1", "display_name": "Sachin Singh", "link": "https://stackoverflow.com/users/1262519/sachin-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1511349520, "last_edit_date": 1511349520, "creation_date": 1511348590, "answer_id": 47433057, "question_id": 47432884, "link": "https://stackoverflow.com/questions/47432884/rails5-gem-gmaps4rails-the-google-map-is-not-showing/47433057#47433057", "title": "Rails5: gem &#39;gmaps4rails&#39; the google map is not showing", "body": "<p>try updating your show.html.erb with this code</p>\n\n<pre><code>&lt;script src=\"//maps.google.com/maps/api/js?key=I have my api key in here\"&gt;&lt;/script&gt;\n&lt;script src=\"//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js\"&gt;&lt;/script&gt;      \n&lt;script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'&gt;&lt;/script&gt;\n\n&lt;div style='width: 800px;'&gt;\n  &lt;div id=\"map\" style='width: 800px; height: 400px;'&gt;&lt;/div&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n  handler = Gmaps.build('Google');\n  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){\n    markers = handler.addMarkers(&lt;%=raw @hash.to_json %&gt;);\n    handler.bounds.extendWith(markers);\n    handler.fitMapToBounds();\n  });\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511349520, "creation_date": 1511348055, "question_id": 47432884, "link": "https://stackoverflow.com/questions/47432884/rails5-gem-gmaps4rails-the-google-map-is-not-showing", "title": "Rails5: gem &#39;gmaps4rails&#39; the google map is not showing", "body": "<p>I have installed the <code>gem 'gmaps4rails'</code> and this is the setup I have:</p>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'gmaps4rails'\ngem 'underscore-rails'\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>//= require underscore\n//= require gmaps/google\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;script src=\"//maps.google.com/maps/api/js?key=I have my api key in here\"&gt;&lt;/script&gt;\n&lt;script src=\"//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js\"&gt;&lt;/script&gt;      \n&lt;script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'&gt;&lt;/script&gt;\n\n&lt;div id=\"map\" style='width: 400px; height: 400px;'&gt;\n\n        &lt;script&gt;\n            handler = Gmaps.build('Google');\n            handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){\n                markers = handler.addMarkers(&lt;%=raw @hash.to_json %&gt;);\n                handler.bounds.extendWith(markers);\n                handler.fitMapToBounds();\n                });\n        &lt;/script&gt;\n\n      &lt;/div&gt;\n</code></pre>\n\n<p>items-controller.rb</p>\n\n<pre><code>def show\n@items = Item.find(params[:id])\n@hash = Gmaps4rails.build_markers(@items) do |item, marker|\n  marker.lat item.latitude\n  marker.lng item.longitude\n  marker.picture({\n                     :url =&gt; \"http://www.google.com/mapfiles/dd-end.png\",\n                     :width   =&gt; 32,\n                     :height  =&gt; 32\n                 })\n  marker.infowindow render_to_string(:partial =&gt; 'items/info_page')\n end\n  append_cur_location\nend\n\n\ndef append_cur_location\n  @hash &lt;&lt; {\n    :lat=&gt;action[0],\n    :lng=&gt;action[1],\n    :picture=&gt; {\n        :url=&gt; \"http://www.google.com/mapfiles/dd-start.png\",\n        :width=&gt;  32,\n        :height=&gt; 32\n      }\n  }\n end\n\n  def action\n    @lat_lng = cookies[:lat_lng].split(\"|\") unless cookies[:lat_lng] == nil\n  end\n</code></pre>\n\n<p>It should be appearing on the <code>show.html.erb</code> but its not!! Inside the browser web inspector I'm getting two warnings:</p>\n\n<pre><code>The page at https://localhost:3000/items/1 was allowed to display insecure content from http://www.google.com/mapfiles/dd-end.png.\nThe page at https://localhost:3000/items/1 was allowed to display insecure content from http://www.google.com/mapfiles/dd-start.png.\n</code></pre>\n\n<p>Any ideas what might be wrong here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "factory-bot"], "comments": [{"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 1, "creation_date": 1511347630, "post_id": 47432612, "comment_id": 81819604, "body": "<code>rspec</code> executes by default for test environment"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1511347974, "post_id": 47432612, "comment_id": 81819851, "body": "Can you see exactly which factory is already registered in the error log?"}, {"owner": {"reputation": 393, "user_id": 1950386, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZIEO0.jpg?s=128&g=1", "display_name": "htunc", "link": "https://stackoverflow.com/users/1950386/htunc"}, "edited": false, "score": 0, "creation_date": 1511348249, "post_id": 47432612, "comment_id": 81820062, "body": "It gives the same error for every factory. It&#39;s like running all factories twice. But the problem is if i run it just &#39;rspec&#39; it works without any error."}, {"owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "edited": false, "score": 0, "creation_date": 1511350933, "post_id": 47432612, "comment_id": 81821794, "body": "As Mikhail has stated ... rspec should be running in test environment by default anyway ... RAILS_ENV should be defined at the top of your rails_helper.rb file. Might be worth posting that file in your question anyway ... as well as spec_helper.rb"}], "owner": {"reputation": 393, "user_id": 1950386, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZIEO0.jpg?s=128&g=1", "display_name": "htunc", "link": "https://stackoverflow.com/users/1950386/htunc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511347325, "creation_date": 1511347325, "question_id": 47432612, "link": "https://stackoverflow.com/questions/47432612/factory-already-registered-error-on-rails-test", "title": "Factory already registered error on rails test", "body": "<p>I'm using factory-bot (factory-girl) when i'm testing my rails project. \nWhen i run 'rspec' with development environments tests are working well but if i run it like 'RAILS_ENV=test rspec' i'm gettin factory already registered for each factory.</p>\n\n<p>Is there anyone who has an idea why this is happening? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "github", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": false, "score": 0, "last_activity_date": 1511347525, "creation_date": 1511347525, "answer_id": 47432680, "question_id": 47432535, "link": "https://stackoverflow.com/questions/47432535/specific-many-gems-from-the-same-github-account/47432680#47432680", "title": "Specific many gems from the same github account", "body": "<p>So one solution I used this:</p>\n\n<pre><code>['foo', 'bar'].each do |gem_name|\n  gem gem_name, git: \"https://github.com/my_company/#{gem_name}.git\", branch: 'rm_2422-rails5-upgrade'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1511348191, "post_id": 47432795, "comment_id": 81820023, "body": "Nice tip about the block."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1511433734, "post_id": 47432795, "comment_id": 81861606, "body": "Thanks for the updated answer but I wanted to avoid having anything but <code>gem &#39;foo&#39;</code> on the actual line otherwise I might well write out the full <code>git</code>, <code>branch</code> keys."}], "tags": [], "owner": {"reputation": 761, "user_id": 2006706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7be029535e1eee83a81dcb4c9cdb436?s=128&d=identicon&r=PG", "display_name": "bronislav", "link": "https://stackoverflow.com/users/2006706/bronislav"}, "is_accepted": false, "score": 1, "last_activity_date": 1511348858, "last_edit_date": 1511348858, "creation_date": 1511347818, "answer_id": 47432795, "question_id": 47432535, "link": "https://stackoverflow.com/questions/47432535/specific-many-gems-from-the-same-github-account/47432795#47432795", "title": "Specific many gems from the same github account", "body": "<p>You may define a new <code>git_source</code> in your <code>Gemfile</code>:</p>\n\n<pre><code>git_source(:your_source_name) do |repo_name|\n  repo_name = \"company/#{repo_name}\"\n  \"https://github.com/#{repo_name}.git\"\nend\n</code></pre>\n\n<p>And then use it:</p>\n\n<pre><code>gem \"gem_name\", your_company: \"gem_repo_name\"\n</code></pre>\n\n<p>This was very simple example, but you may pass more options to the block. We use this approach to redefine original <code>github</code> source to be able to pass auth token for private repositories:</p>\n\n<pre><code>git_source(:github) do |(repo_name, auth_token)|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  auth_data = !!auth_token ? \"#{auth_token}:x-oauth-basic@\" : \"\"\n  \"https://#{auth_data}github.com/#{repo_name}.git\"\nend\n</code></pre>\n\n<p>UPDATE: I found a way to do what you need, but this is quite a dirty hack IMHO. Since Gemfile is a pure ruby file you may define your own functions there:</p>\n\n<pre><code>def my_gem(name, *args)\n  options = args.last.is_a?(Hash) ? args.pop.dup : {}\n  version = args || [\"&gt;= 0\"]\n\n  options[:branch] = \"develop\"\n\n  gem(name, version, options)\nend\n</code></pre>\n\n<p>And then use it, instead of original <code>gem</code> method:</p>\n\n<pre><code>my_gem \"gem_name\"\n</code></pre>\n"}], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1511348858, "creation_date": 1511347116, "last_edit_date": 1511347567, "question_id": 47432535, "link": "https://stackoverflow.com/questions/47432535/specific-many-gems-from-the-same-github-account", "title": "Specific many gems from the same github account", "body": "<p>like with <code>path</code> and <code>source</code> I'd like to do this:</p>\n\n<pre><code>git 'https://github.com/my_company', branch: 'rm_2422-rails5-upgrade' do\n  gem 'foo'\n  gem 'bar'\n  # many more gems...\nend\n</code></pre>\n\n<p>The idea being this would fetch the <code>foo</code> gem with the URL's <code>https://github.com/my_company/foo.git</code> using the <code>rm_2422-rails5-upgrade</code> branch.</p>\n\n<p>I can see from the <a href=\"http://bundler.io/v1.12/git.html\" rel=\"nofollow noreferrer\">bundler docs</a> that this is not how it works and I know I can do:</p>\n\n<pre><code>git 'foo', git: 'https://github.com/my_company/foo.git', branch: 'rm_2422-rails5-upgrade'\n</code></pre>\n\n<p>But I have <em>lots</em> of gems which need to be pulled from said branch.</p>\n\n<p>I also looked at <code>git_source</code> but this does not seem to work for this case either.</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1511344218, "post_id": 47430728, "comment_id": 81817296, "body": "The docs at <a href=\"http://filterrific.clearcove.ca/\" rel=\"nofollow noreferrer\">filterrific.clearcove.ca</a> tells that you need to add some code to your model. How does your model look like?"}, {"owner": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1511345456, "post_id": 47430728, "comment_id": 81818072, "body": "@spickermann sorry forgot to add the model I read the docs but there are no topics about array I am pushing values into <b>object reserves.push</b> and displaying them as reserves.new in the view above, how can I filter the array <b>reserves = filterrific.find.page(params[:page])</b>"}], "owner": {"reputation": 205, "user_id": 8818948, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5992e6d07f86d46cb4530bb96935f095?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8818948/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511347769, "creation_date": 1511342056, "last_edit_date": 1511347769, "question_id": 47430728, "link": "https://stackoverflow.com/questions/47430728/filterrific-gem-array-rails", "title": "Filterrific gem array rails", "body": "<p>How can I initialize the array for the filterrific and filter the views?</p>\n\n<pre><code>@reserves = Array.new\n</code></pre>\n\n<p>I get an error of undefined method `filterrific_default_filter_params' for [[]]:Array</p>\n\n<p>Controller </p>\n\n<pre><code>@filterrific = initialize_filterrific(@reserves.split,params[:filterrific],\nselect_options: {\n sorted_by: Reserve.options_for_sorted_by,\n}) or return\n @reserves = @filterrific.find.page(params[:page])\n respond_to do |format|\n   format.html\n   format.js\n end\n</code></pre>\n\n<p>Model </p>\n\n<pre><code>filterrific(\n    default_filter_params: { sorted_by: 'created_at_desc' },\n    available_filters: [\n      :sorted_by,\n      :search_query\n    ]\n  )\n\n  scope :search_query, lambda { |query|\n\n  return nil  if query.blank?\n\n  terms = query.downcase.split(/\\s+/)\n\n  terms = terms.map { |e|\n    (e.gsub('*', '%') + '%').gsub(/%+/, '%')\n  }\n  num_or_conds = 2\n    where(\n      terms.map { |term|\n        \"(LOWER(reserves.first_name) LIKE ? OR LOWER(reserves.last_name) LIKE ?)\"\n      }.join(' AND '),\n      *terms.map { |e| [e] * num_or_conds }.flatten\n    )\n  }\n\n\n  scope :sorted_by, lambda { |sort_option|\n  direction = (sort_option =~ /desc$/) ? 'desc' : 'asc'\n  case sort_option.to_s\n  when /^created_at_/\n    order(\"reserves.created_at #{ direction }\")\n  when /^name_/\n    order(\"LOWER(reserves.last_name) #{ direction }, LOWER(reserves.first_name) #{ direction }\")\n  else\n    raise(ArgumentError, \"Invalid sort option: #{ sort_option.inspect }\")\n  end\n}\n</code></pre>\n\n<p>View</p>\n\n<pre><code>&lt;% @reserves.each do|reserve| %&gt;\n  &lt;tr&gt;\n  &lt;% display_reserve = reserves.split %&gt;\n  &lt;td&gt;&lt;%= display_reserve[5] %&gt; &lt;%= display_reserve[1] %&gt; &lt;%= display_reserve[2] %&gt;&lt;/td&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>It works when I just use @reserves = Array.new when I try to add filterrific it gives an error </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "foreign-keys"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 8873722, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/57781335f480cf4c521dbf50421ae476?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/8873722/suresh"}, "edited": false, "score": 0, "creation_date": 1511343637, "post_id": 47430789, "comment_id": 81816920, "body": "If I don&#39;t define foreign_key : true then ActiveRecord will assume that foreign key is kept in the author_id column. If I define it then ActiveRecord will surely know that author_id is id from author table. Am I right ?"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 71, "user_id": 8873722, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/57781335f480cf4c521dbf50421ae476?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/8873722/suresh"}, "edited": false, "score": 0, "creation_date": 1511344903, "post_id": 47430789, "comment_id": 81817742, "body": "@Suresh If you don&#39;t define <code>foreign_key: true</code> than no foreign key constraint will be created and the logic is only caught on application level."}], "tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1511342225, "creation_date": 1511342225, "answer_id": 47430789, "question_id": 47430701, "link": "https://stackoverflow.com/questions/47430701/difference-between-add-references-and-add-column-in-rails/47430789#47430789", "title": "Difference between add_references and add_column in rails", "body": "<p>Both will generate the same columns when you run the migration. </p>\n\n<blockquote>\n  <p>The first command adds a belongs_to :author relationship in your Book\n  model whereas the second does not. When this relationship is\n  specified, ActiveRecord will assume that the foreign key is kept in\n  the author_id column and it will use a model named Author to\n  instantiate the specific author.</p>\n</blockquote>\n\n<p>The first command also adds an index on the new author_id column.</p>\n"}, {"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1610459690, "post_id": 47431599, "comment_id": 116135398, "body": "Note that since Ruby on Rails 5.1 <code>:bigint</code> is used instead of <code>:integer</code>. See: <a href=\"https://github.com/rails/rails/pull/26266\" rel=\"nofollow noreferrer\">github.com/rails/rails/pull/26266</a>"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 8, "last_activity_date": 1511346840, "last_edit_date": 1511346840, "creation_date": 1511344713, "answer_id": 47431599, "question_id": 47430701, "link": "https://stackoverflow.com/questions/47430701/difference-between-add-references-and-add-column-in-rails/47431599#47431599", "title": "Difference between add_references and add_column in rails", "body": "<h1>TLDR</h1>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-add_column\" rel=\"noreferrer\"><em>#add_column</em></a> is meant for adding a column like the name suggests.</p>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-add_reference\" rel=\"noreferrer\"><em>#add_reference</em></a> is meant as a shortcut for creating a column, index and foreign key at the same time.</p>\n\n<h1>Explanation</h1>\n\n<p>In your example the only difference is the <em>index</em> on the column that will be created by <em>#add_reference</em> that defaults to <code>true</code>. </p>\n\n<pre><code>add_reference :books, :author\n# equals\nadd_column :books, :author_id, :integer\nadd_index :books, :author_id\n</code></pre>\n\n<p>But if you would take the following line:</p>\n\n<pre><code>add_reference :books, :author, foreign_key: true\n</code></pre>\n\n<p>It would also create a foreign key constraint. </p>\n\n<p>Furthermore if you would like to have every author be able to publish only one book you can set the <em>unique</em> constraint through <em>#add_reference</em> by doing the following:</p>\n\n<pre><code>add_reference :books, :author, null: false, index: {unique: true}, foreign_key: true\n</code></pre>\n\n<p>This requires every book to have an author and restraints the authors to have a maximum of one book.</p>\n\n<p>The same can be done using <em>#add_column</em> by doing the following:</p>\n\n<pre><code>add_column :books, :author_id, :integer, null: false\nadd_index :books, :author_id, unique: true\nadd_foreign_key :books, :authors\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8873722, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/57781335f480cf4c521dbf50421ae476?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh", "link": "https://stackoverflow.com/users/8873722/suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2445, "favorite_count": 1, "accepted_answer_id": 47431599, "answer_count": 2, "score": 5, "last_activity_date": 1511349724, "creation_date": 1511341950, "last_edit_date": 1511349724, "question_id": 47430701, "link": "https://stackoverflow.com/questions/47430701/difference-between-add-references-and-add-column-in-rails", "title": "Difference between add_references and add_column in rails", "body": "<pre><code> add_reference :books, :author\n add_column :books, :author_id, :integer\n</code></pre>\n\n<p>Here add references will create user_id column and add column is also creating user_id column in books table. What is the difference between them. What is the advantage of using references instead of column?</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "edited": false, "score": 0, "creation_date": 1511382501, "post_id": 47429896, "comment_id": 81841768, "body": "Does this helped you?"}, {"owner": {"reputation": 33, "user_id": 8807374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIV3X.jpg?s=128&g=1", "display_name": "Sattar Jamali", "link": "https://stackoverflow.com/users/8807374/sattar-jamali"}, "edited": false, "score": 0, "creation_date": 1511439419, "post_id": 47429896, "comment_id": 81865016, "body": "Yes. Thanks for the help dude..!"}, {"owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "reply_to_user": {"reputation": 33, "user_id": 8807374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIV3X.jpg?s=128&g=1", "display_name": "Sattar Jamali", "link": "https://stackoverflow.com/users/8807374/sattar-jamali"}, "edited": false, "score": 0, "creation_date": 1511439613, "post_id": 47429896, "comment_id": 81865157, "body": "@SattarJamali you are welcome. It would be great if you mark my question as a valid answer (with a green tick to the left) for future visitors. Thanks in advance"}, {"owner": {"reputation": 33, "user_id": 8807374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIV3X.jpg?s=128&g=1", "display_name": "Sattar Jamali", "link": "https://stackoverflow.com/users/8807374/sattar-jamali"}, "edited": false, "score": 0, "creation_date": 1511457373, "post_id": 47429896, "comment_id": 81875859, "body": "Dear @AntonTkachov, I have marked when I was done, but due to reputations, my marking as a valid answer is not being showed. :("}], "tags": [], "owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "is_accepted": false, "score": 2, "last_activity_date": 1511339103, "creation_date": 1511339103, "answer_id": 47429896, "question_id": 47429492, "link": "https://stackoverflow.com/questions/47429492/rails-dropdown1-enables-drobdown2-selection-using-ruby-on-rails/47429896#47429896", "title": "Rails. Dropdown1 enables Drobdown2 selection using Ruby on Rails", "body": "<p>Ruby will be not enough for this. You need to use javascript to achieve what you want. Let's go with seats. If you expect seats to be loaded depending on flight, you should first setup a controller action which will accept fligh_id and return array of seats in JSON format. I would put this controller into namespace and place it in <code>app/controllers/ajax/seats_controller.rb</code>:</p>\n\n<pre><code>class Ajax::SeatsController &lt; ApplicationController\n  def index\n    @seats = Seat.where(fligh_id: params[:flight_id])\n    render json: @seats\n  end\nend\n</code></pre>\n\n<p>in <code>routes.rb</code>:</p>\n\n<pre><code>namespace :ajax do\n  resources :seats_controller, only: :index\nend\n</code></pre>\n\n<p>Then rewrite seats input like:</p>\n\n<pre><code>&lt;div class=\"input-group\" style=\"display: none\"&gt;\n  &lt;%= f.label :seat_no %&gt;&lt;br&gt;\n  &lt;%= f.text_field :seat_no %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>in <code>app/assets/javascripts/[your_controller].js</code>:</p>\n\n<pre><code>$('#[your_flight_dropdown_html_id]').onchange(function() {\n  $.getJSON('/ajax/seats', { flight_id: $('#[your_flight_dropdown_html_id]').val(), function(data) {\n    // destroy all existing seat options\n    // loop through data and fill in new seat options\n    // Make seats dropdown visible\n  }\n});\n</code></pre>\n\n<p>It's short description how would I go with your task. You can do the same for another pair of dropdown. Maybe there are some bugs in my code (haven't tested it), but at least you will have common understanding how to move forward.</p>\n\n<p>Write a comment in case of any help needed</p>\n"}], "owner": {"reputation": 33, "user_id": 8807374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WIV3X.jpg?s=128&g=1", "display_name": "Sattar Jamali", "link": "https://stackoverflow.com/users/8807374/sattar-jamali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511339103, "creation_date": 1511337568, "question_id": 47429492, "link": "https://stackoverflow.com/questions/47429492/rails-dropdown1-enables-drobdown2-selection-using-ruby-on-rails", "title": "Rails. Dropdown1 enables Drobdown2 selection using Ruby on Rails", "body": "<p>I have two DropDowns (say DropDown1 and DropDown2) in my <code>_form.html.erb</code>.\nHere is the <code>_form.html.erb</code>'s code (Where I need assistance);</p>\n\n<pre><code>  &lt;div class=\"input-group\"&gt;\n    &lt;%= f.label :flight_id %&gt;&lt;br&gt;\n    &lt;%= f.collection_select :flight_id, Flight.all, :id, :airline %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"input-group\"&gt;\n    &lt;%= f.label :seat_no %&gt;&lt;br&gt;\n    &lt;%= f.text_field :seat_no %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"input-group\"&gt;\n    &lt;%= f.label :hotel_id %&gt;&lt;br&gt;\n    &lt;%= f.collection_select :hotel_id, Hotel.all, :id, :hotel_name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"input-group\"&gt;\n    &lt;%= f.label :room_no %&gt;&lt;br&gt;\n    &lt;%= f.text_field :room_no %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p>Here I want to convert the <code>seat_no</code> and <code>room_no</code> as dependent <code>Drop down</code> lists, dependent on <code>Flight</code> and <code>Hotel</code> respectively.\nWhen I select <code>Flight</code> Seats against that <code>Flight</code> should become available in the <code>Seat</code> drop down list, and same logic for the <code>Room</code> drop down list.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 2, "creation_date": 1511337780, "post_id": 47429483, "comment_id": 81813496, "body": "Your <code>Message</code> instance doesn&#39;t have an <code>id</code> yet in <code>before_save</code> callback if you create it."}, {"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 2, "creation_date": 1511338300, "post_id": 47429483, "comment_id": 81813809, "body": "You use <code>before_save</code> action, in this case when you call <code>Spec.where(message_id: self.id).order(&#39;id asc&#39;)</code> these specs are not yet saved to db"}, {"owner": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "edited": false, "score": 0, "creation_date": 1511338469, "post_id": 47429483, "comment_id": 81813888, "body": "Oh I see.... any ideas how to approach this?"}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1511345500, "post_id": 47429483, "comment_id": 81818104, "body": "things you are trying to do in <code>before_save</code> can be achieved in the message controller action itself. You can easily create the specs along with the message upon receiving the form inputs. As you have defined <code>accepts_nested_attributes_for :specs</code> in <code>Message</code>, the <code>params</code> will contain specs related fields inside <code>specs_attributes</code>. Saving the message will also save the related specs. For details: <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/&hellip;</a>"}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1511345638, "post_id": 47429483, "comment_id": 81818192, "body": "You&#39;re trying to query the database for the records before you saved them ... :&#39;-)"}, {"owner": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "reply_to_user": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1511361081, "post_id": 47429483, "comment_id": 81828673, "body": "@WasifHossain That is true, but the problem I&#39;m having is not with saving specs, they do get saved, but I need to use them to save another field &#39;output&#39; and that one does not get saved."}, {"owner": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "reply_to_user": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1511361226, "post_id": 47429483, "comment_id": 81828787, "body": "@Drenmi You&#39;re right... any suggestions how to do access the attributes before they are saved so I can achieve my goal?"}, {"owner": {"reputation": 3638, "user_id": 1977104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe5f45f44332caa3a105c05382c8e7b?s=128&d=identicon&r=PG", "display_name": "Wasif Hossain", "link": "https://stackoverflow.com/users/1977104/wasif-hossain"}, "edited": false, "score": 0, "creation_date": 1511363682, "post_id": 47429483, "comment_id": 81830681, "body": "as you didn&#39;t provide enough details on how your controller action is saving the Message as well as its <code>has_many :specs</code>, why don&#39;t you do it in <code>after_save</code> callback instead of <code>before_save</code>, as the message will eventually have its id assigned by the time <code>after</code> callback is executed."}], "answers": [{"comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 0, "creation_date": 1511339634, "post_id": 47429959, "comment_id": 81814479, "body": "<code>self</code> is unnecessary here."}, {"owner": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "edited": false, "score": 0, "creation_date": 1511340321, "post_id": 47429959, "comment_id": 81814892, "body": "Unfortunately, it does not work:/ same as before, nothing happens and output is saved as &#39;hola&#39;"}, {"owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "reply_to_user": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "edited": false, "score": 0, "creation_date": 1511356079, "post_id": 47429959, "comment_id": 81825158, "body": "@NavidFalla Can you please include your controller method in your question? The one that calls save for message/specs"}], "tags": [], "owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "is_accepted": false, "score": 0, "last_activity_date": 1511355992, "last_edit_date": 1511355992, "creation_date": 1511339380, "answer_id": 47429959, "question_id": 47429483, "link": "https://stackoverflow.com/questions/47429483/query-in-active-record-rails-does-not-work/47429959#47429959", "title": "Query in Active Record Rails does not work", "body": "<p>Try to rewrite your like:</p>\n\n<pre><code>specs_array = Spec.where(message_id: self.id).order('id asc')\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>specs_array = specs.order(:id)\n</code></pre>\n\n<p>Write a comment whether that helped?</p>\n"}], "owner": {"reputation": 79, "user_id": 7089194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207836759698479/picture?type=large", "display_name": "Navid Falla", "link": "https://stackoverflow.com/users/7089194/navid-falla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511360501, "creation_date": 1511337555, "last_edit_date": 1511360501, "question_id": 47429483, "link": "https://stackoverflow.com/questions/47429483/query-in-active-record-rails-does-not-work", "title": "Query in Active Record Rails does not work", "body": "<p>I am trying to use Rails' active record to generate something before_save and save it to a field. It's using two tables (Message and Spec)</p>\n\n<p>My models/message.rb file looks like this:</p>\n\n<pre><code>class Message &lt; ApplicationRecord\n  has_many :specs\n  accepts_nested_attributes_for :specs\n  before_save :generate_output\n\n  def generate_output\n    self.output = \"hola\"\n    specs_array = Spec.where(message_id: self.id).order('id asc')\n    specs_array.each do |spec|\n        self.output = \"hello\"\n        if spec.call\n          self.output += Message.find(name: spec).output\n        else\n          self.output += spec.specification\n        end\n      end\n    self.output\n  end\nend\n</code></pre>\n\n<p>and my models/spec.rb file:</p>\n\n<pre><code>class Spec &lt; ApplicationRecord\n  belongs_to  :message\nend\n</code></pre>\n\n<p>And here is my schema:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20171121153642) do\n  enable_extension \"plpgsql\"\n\n  create_table \"messages\", force: :cascade do |t|\n    t.string \"name\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.text \"output\"\n  end\n\n  create_table \"specs\", force: :cascade do |t|\n    t.string \"specification\"\n    t.boolean \"call\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.bigint \"message_id\"\n    t.index [\"message_id\"], name: \"index_specs_on_message_id\"\n  end\n\n  add_foreign_key \"specs\", \"messages\"\nend\n</code></pre>\n\n<p>I have a message form, that upon submission, saves a 'name' to Message table and 3 Specifications (and their message_id) to Spec table. It should also generate and save an output (as you can see in the message model) based on the specs in the Message table. </p>\n\n<p>but these two lines of code in the model do not work:</p>\n\n<pre><code>    specs_array = Spec.where(message_id: self.id).order('id asc')\n    specs_array.each do |spec|\n</code></pre>\n\n<p>I know the ones before them are working, because when I create a new message, its output is saved as 'hola' and if these two lines work, it should be saved as 'hello'+ whatever the message is.</p>\n\n<p>I have tried the query in rails console, and it totally works fine, any idea why it's not working in the app?\nthanks!</p>\n\n<p>edit:\nMy controller method that calls for save (it's Rails generic method):</p>\n\n<pre><code>  def create\n    @message = Message.new(message_params)\n\n    respond_to do |format|\n      if @message.save\n        format.html { redirect_to @message, notice: 'Message was successfully created.' }\n        format.json { render :show, status: :created, location: @message }\n      else\n        format.html { render :new }\n        format.json { render json: @message.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>and the private method for messasge_params:</p>\n\n<pre><code>def message_params\n  params.require(:message).permit(:name, specs_attributes: [:id, :call, :specification])\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1511325535, "post_id": 47426616, "comment_id": 81808397, "body": "I&#39;m no SQL expert, but that sounds like a <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-left_joins\" rel=\"nofollow noreferrer\"><code>left_outer_joins</code></a> sql query, wouldn&#39;t it be?"}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 8431259, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/c9u5J.jpg?s=128&g=1", "display_name": "Karol Karol", "link": "https://stackoverflow.com/users/8431259/karol-karol"}, "edited": false, "score": 0, "creation_date": 1511356047, "post_id": 47426912, "comment_id": 81825140, "body": "I&#39;ve tried <code>@user_categories = Category.joins(:preferences).where(preferences: { user_id: id })</code> for getting the user_categories, I don&#39;t know why but using <code>where.not</code> it doesn&#39;t show the non-user categories, just an empty query result."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 4, "last_activity_date": 1511325872, "last_edit_date": 1511325872, "creation_date": 1511325533, "answer_id": 47426912, "question_id": 47426616, "link": "https://stackoverflow.com/questions/47426616/activerecord-get-all-model-records-plus-those-matching-some-criteria/47426912#47426912", "title": "ActiveRecord get all model records plus those matching some criteria", "body": "<p>You can do it in a few steps.</p>\n\n<p>First get all categories</p>\n\n<pre><code>all_categories = Category.all\n</code></pre>\n\n<p>Then get the user categories (I'm assumiming you already have code to define <code>current_user</code> for the request)</p>\n\n<pre><code>@user_categories = current_user.categories\n</code></pre>\n\n<p>Then you can find the difference between the two:</p>\n\n<pre><code>@non_user_categories = all_categories - @user_categories\n</code></pre>\n\n<p>The <code>@user_categories</code> and <code>all_categories</code> are not, strictly speaking, Arrays - they are <code>ActiveRecord::Relation</code> objects. But you can still use array subtraction to find the difference. Note that <code>@non_user_categories</code> <em>is</em> an actual Array. </p>\n\n<hr>\n\n<p>You can do it another way which avoids loading excess records, though for a small data set the performance gain will be inconsequential.</p>\n\n<pre><code>@user_categories = current_user.categories\n\n@non_user_categories = Category.joins(:preferences).where.not(\n  \"preferences.user_id = ?\",\n  current_user.id\n)\n</code></pre>\n"}], "owner": {"reputation": 336, "user_id": 8431259, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/c9u5J.jpg?s=128&g=1", "display_name": "Karol Karol", "link": "https://stackoverflow.com/users/8431259/karol-karol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 47426912, "answer_count": 1, "score": 1, "last_activity_date": 1511325872, "creation_date": 1511323609, "last_edit_date": 1511324226, "question_id": 47426616, "link": "https://stackoverflow.com/questions/47426616/activerecord-get-all-model-records-plus-those-matching-some-criteria", "title": "ActiveRecord get all model records plus those matching some criteria", "body": "<p>I'm trying to create a set of checkbox tags in order the user can see how much of them he has (has subscribed to), and to which no.</p>\n\n<p>My models are User, Category and Preferences which handles the has_many through relationship between both first models:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :preferences\n  has_many :categories, through: :preferences\nend\n\nclass Category &lt; ApplicationRecord\n  has_many :preferences\n  has_many :users, through: :preferences\nend\n\nclass Preference &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :category\nend\n</code></pre>\n\n<p>The goal is to get all the categories existent and to be able a extra way to check if the user has such categories, this way I can use an active CSS rule and show them different to those which the user doesn't have.</p>\n\n<p>I've tried just getting all the categories name, and also all the categories name for those corresponding to the user and joining them as one array with multiple 2 elements arrays inside and I get something like:</p>\n\n<pre><code>[\n  [\"coffee\",         \"coffee\"],\n  [\"coworking\",      \"food\"],\n  [\"event\",          \"pub\"],\n  [\"food\",           \"restaurant\"],\n  [\"landmark\",       \"shop\"],\n  [\"nightlife\",      \"vacation\"],\n  [\"pub\",            nil],\n  [\"restaurant\",     nil],\n  [\"shop\",           nil],\n  [\"transportation\", nil],\n  [\"vacation\",       nil]\n]\n</code></pre>\n\n<p>This way would be good if I can make them match in name, since the names won't never be repeated for each array, maybe like:</p>\n\n<pre><code>[\n  [\"coffee\",         \"coffee\"],\n  [\"coworking\",      nil],\n  [\"event\",          nil],\n  [\"food\",           \"food\"],\n  [\"landmark\",       nil],\n  [\"nightlife\",      nil],\n  [\"pub\",            \"pub\"],\n  [\"restaurant\",     \"restaurant\"],\n  [\"shop\",           \"shop\"],\n  [\"transportation\", nil],\n  [\"vacation\",       \"vacation\"],\n]\n</code></pre>\n\n<p>So I can see which of those are nil in the last (second) element in the array and don't print the CSS rule for checked elements.</p>\n\n<p>But it seems I need to do it outside an ActiveRecord query.</p>\n\n<p>Does it exist any way to get the desired result by using ActiveRecord, or do I have to handle it manually, or to change the schema?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 21499, "user_id": 19839, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/971cfac6afb23c0f0fd3623284a02a81?s=128&d=identicon&r=PG", "display_name": "csexton", "link": "https://stackoverflow.com/users/19839/csexton"}, "is_accepted": true, "score": 3, "last_activity_date": 1511322254, "creation_date": 1511322254, "answer_id": 47426418, "question_id": 47425411, "link": "https://stackoverflow.com/questions/47425411/best-way-to-parse-json-in-ruby-for-the-format-given/47426418#47426418", "title": "Best way to parse json in Ruby for the format given", "body": "<p>Oddly specific question, but kinda an interesting problem so I took a stab at it. If this is coming from a SQL database I feel like the better solution would be to have SQL format the data for you as opposed to transforming it in ruby. </p>\n\n<pre><code>@data = JSON.parse(request,symbolize_names: true)[:data]\n\nintermediate = {}\n@data.each do |row|\n  time = row.delete(:time)\n  row.each do |key, val|\n    intermediate[key] ||= {data: {}}\n    intermediate[key][:data][time] = val if val &gt; 0\n  end\nend\n\ntransformed = []\nintermediate.each do |key, val|\n  transformed &lt;&lt; {name: key.to_s, data: val}\nend\n</code></pre>\n\n<p>At the end of this <code>transformed</code> will contain the transformed data. Horrible variable names, and I hate having to do this in two passes. But got something working and figured I would share in case it is helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 1, "last_activity_date": 1511330945, "creation_date": 1511330945, "answer_id": 47427898, "question_id": 47425411, "link": "https://stackoverflow.com/questions/47425411/best-way-to-parse-json-in-ruby-for-the-format-given/47427898#47427898", "title": "Best way to parse json in Ruby for the format given", "body": "<p>I agree with csexton that it looks like a better query to source the data would be the ultimate solution here.</p>\n\n<p>Anyway, here's a solution that's similar to csexton's but uses nested default Hash procs to simplify some of the operations:</p>\n\n<pre><code>def pivot(arr, column)\n  results = Hash.new do |hash, key|\n    hash[key] = Hash.new(0)\n  end\n\n  arr.each do |hash|\n    data = hash.dup\n    pivot = data.delete(column)\n\n    data.each_pair do |name, value|\n      results[name][pivot] += value\n    end\n  end\n\n  results.map { |name, data| {\n    name: name.to_s,\n    data: data.delete_if { |_, sum| sum.zero? }\n  }}\nend\n\npivot(@data, :time) # =&gt; [{:name=&gt;\"A\", :data=&gt;{\"2017-11-16\"=&gt;2, \"2017-11-21\"=&gt;6}}, ..\n</code></pre>\n\n<p>Here's a more \"Ruby-ish\" (depending on who you ask) solution:</p>\n\n<pre><code>def pivot(arr, column)\n  arr\n    .flat_map do |hash|\n      hash\n        .to_a\n        .delete_if { |key, _| key == column }\n        .map! { |data| data &lt;&lt; hash[column] }\n    end\n    .group_by(&amp;:shift)\n    .map { |name, outer| {\n      name: name.to_s,\n      data: outer\n        .group_by(&amp;:last)\n        .transform_values! { |inner| inner.sum(&amp;:first) }\n        .delete_if { |_, sum| sum.zero? }\n    }}\nend\n\npivot(@data, :time) # =&gt; [{:name=&gt;\"A\", :data=&gt;{\"2017-11-16\"=&gt;2, \"2017-11-21\"=&gt;6}}, ..\n</code></pre>\n\n<p>Quite frankly, I find it pretty unreadable and I wouldn't want to support it. :)</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1511379378, "last_edit_date": 1511379378, "creation_date": 1511332268, "answer_id": 47428187, "question_id": 47425411, "link": "https://stackoverflow.com/questions/47425411/best-way-to-parse-json-in-ruby-for-the-format-given/47428187#47428187", "title": "Best way to parse json in Ruby for the format given", "body": "<pre><code>arr = [{\"time\":\"2017-11-14\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n       {\"time\":\"2017-11-15\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n       {\"time\":\"2017-11-16\",\"A\":2,\"B\":1,\"C\":1,\"D\":0,\"E\":1},\n       {\"time\":\"2017-11-17\",\"A\":0,\"B\":0,\"C\":1,\"D\":0,\"E\":1},\n       {\"time\":\"2017-11-20\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n       {\"time\":\"2017-11-21\",\"A\":6,\"B\":17,\"C\":0,\"D\":0,\"E\":1}]\n\n(arr.first.keys - [:time]).map do |key|\n   { name: key.to_s,\n     data: arr.select { |h| h[key] &gt; 0 }.\n               each_with_object({}) { |h,g| g.update(h[:time]=&gt;h[key]) } }\nend\n  #=&gt; [{:name=&gt;\"A\", :data=&gt;{\"2017-11-16\"=&gt;2, \"2017-11-21\"=&gt;6}},\n  #    {:name=&gt;\"B\", :data=&gt;{\"2017-11-16\"=&gt;1, \"2017-11-21\"=&gt;17}},\n  #    {:name=&gt;\"C\", :data=&gt;{\"2017-11-16\"=&gt;1, \"2017-11-17\"=&gt;1}},\n  #    {:name=&gt;\"D\", :data=&gt;{}},\n  #    {:name=&gt;\"E\", :data=&gt;{\"2017-11-16\"=&gt;1, \"2017-11-17\"=&gt;1, \"2017-11-21\"=&gt;1}}]\n</code></pre>\n\n<p>Note that</p>\n\n<pre><code>arr.first.keys - [:time]\n  #=&gt; [:A, :B, :C, :D, :E]\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 5187888, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc8537959ea53f5c42080417802fa742?s=128&d=identicon&r=PG&f=1", "display_name": "Wings2fly", "link": "https://stackoverflow.com/users/5187888/wings2fly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 47426418, "answer_count": 3, "score": 0, "last_activity_date": 1511379378, "creation_date": 1511314014, "last_edit_date": 1511317303, "question_id": 47425411, "link": "https://stackoverflow.com/questions/47425411/best-way-to-parse-json-in-ruby-for-the-format-given", "title": "Best way to parse json in Ruby for the format given", "body": "<p>For my rails app, SQL query result is received in the below format.</p>\n\n<pre><code>   @data= JSON.parse(request,symbolize_names: true)[:data] \n#  @data sample\n\n [{\"time\":\"2017-11-14\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n  {\"time\":\"2017-11-15\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n  {\"time\":\"2017-11-16\",\"A\":2,\"B\":1,\"C\":1,\"D\":0,\"E\":1},\n  {\"time\":\"2017-11-17\",\"A\":0,\"B\":0,\"C\":1,\"D\":0,\"E\":1},\n  {\"time\":\"2017-11-20\",\"A\":0,\"B\":0,\"C\":0,\"D\":0,\"E\":0},\n  {\"time\":\"2017-11-21\",\"A\":6,\"B\":17,\"C\":0,\"D\":0,\"E\":1}]\n</code></pre>\n\n<p>But I want the data in the format </p>\n\n<pre><code>  [{\"name\":\"A\",\"data\":{\"2017-11-16\":2,\"2017-11-21\":6}},\n  {\"name\":\"B\",\"data\":{\"2017-11-16\":1,\"2017-11-21\":17}},\n  {\"name\":\"C\",\"data\":{\"2017-11-16\":1,\"2017-11-17\":1}},\n  {\"name\":\"D\",\"data\":{}},\n  {\"name\":\"E\",\"data\":{\"2017-11-16\":1,\"2017-11-17\":1,\"2017-11-21\":1}}]\n</code></pre>\n\n<p>What is the best way to parse this in Ruby? \nI tried using @data.each method, but it is lengthy.</p>\n\n<p>I am totally new to Ruby. Any help would be appreciated.</p>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511311542, "post_id": 47425078, "comment_id": 81805115, "body": "That sounds like an interesting problem. What have you tried so far?"}, {"owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511311632, "post_id": 47425078, "comment_id": 81805136, "body": "i was trying this one: <a href=\"https://stackoverflow.com/questions/37998809/sorting-a-hash-based-on-array-of-order-in-ruby\" title=\"sorting a hash based on array of order in ruby\">stackoverflow.com/questions/37998809/&hellip;</a> but not much luck with it"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 2, "creation_date": 1511311930, "post_id": 47425078, "comment_id": 81805212, "body": "While the latest versions of Ruby have hashes that have a fixed order, traditionally hashes did not have a fixed order. So some will say that ordering hashes is a bad practice. Can you explain why you want them ordered? There may be a way of doing what you want without depending on an ordered hash."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511312002, "post_id": 47425078, "comment_id": 81805230, "body": "Also (far more importantly) you have duplicate hash keys. that is not a valid hash."}, {"owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "edited": false, "score": 0, "creation_date": 1511312090, "post_id": 47425078, "comment_id": 81805265, "body": "Ok i have updated the hash and removed the dups."}, {"owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "edited": false, "score": 0, "creation_date": 1511312752, "post_id": 47425078, "comment_id": 81805447, "body": "Also to answer your question in a simple way, i&#39;m reading a report file which is in CSV format through which i&#39;m preparing a hash like i mentioned in the question and i&#39;m trying to do aggregation of a particular attribute&#39;s value but the aggregations should not be disturbed by some rows which i dont want to consider(business logic). Now the problem is the order of hash is not always same so i want to sort the negative ones in the last such that they will not disturb in the aggregation process."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511337547, "post_id": 47425078, "comment_id": 81813339, "body": "What is the code you are having trouble with? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ? Please, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511337561, "post_id": 47425078, "comment_id": 81813348, "body": "Can you provide a <i>precise</i> specification of what it is that you want to happen, including any and all rules, exceptions from those rules, corner cases, special cases, boundary cases, and edge cases? Can you provide sample inputs and outputs demonstrating what you expect to happen, both in normal cases, and in all the exceptions, corner cases, special cases, boundary cases, and edge cases? Please, also provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511337596, "post_id": 47425078, "comment_id": 81813370, "body": "&quot;How can I do it?&quot; \u2013 You do it by writing a program which does that. If you have a problem with your program, carefully read the documentation of all the methods, classes, modules, and libraries you are using, write tests for your programs, trace the execution with pen and paper, single-step it in a debugger, then sleep on it, start again from the beginning, sleep on it again, and <i>then and only then</i> ask a focused, narrow question on <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "is_accepted": false, "score": 0, "last_activity_date": 1511314326, "last_edit_date": 1511314326, "creation_date": 1511313736, "answer_id": 47425381, "question_id": 47425078, "link": "https://stackoverflow.com/questions/47425078/sort-hash-based-on-conditions/47425381#47425381", "title": "Sort hash based on conditions", "body": "<p>If you know your bad roles:</p>\n\n<pre><code>negative_roles = [\"electrician\", \"teachers\", \"carpenters\"]\n</code></pre>\n\n<p>And your \"good\" roles:</p>\n\n<pre><code>positive_roles = roles.keys - negative_roles\n</code></pre>\n\n<p>You can iterate through the hash in that order:</p>\n\n<pre><code>(positive_roles + negative_roles).each do |key|\n  role = roles[key]\n\n  # ..\nend\n</code></pre>\n\n<p>As Beartech mentioned in the comments above, sorting a hash may not always do what you want it to do in Ruby, but you could convert the above to an array of tuples:</p>\n\n<pre><code>role_tuples = (positive_roles + negative_roles).map! { |key| [key, roles[key]] }\n</code></pre>\n\n<p>This looks like:</p>\n\n<pre><code>[\n  [\"painters\", [{:name=&gt;\"G\"}, {:name=&gt;\"H\"}, {:name=&gt;\"I\"}]],\n  [\"gardeners\", [{:name=&gt;\"P\"}, {:name=&gt;\"Q\"}, {:name=&gt;\"R\"}]],\n  [\"electrician\", [{:name=&gt;\"D\"}, {:name=&gt;\"E\"}, {:name=&gt;\"F\"}]],\n  [\"teachers\", [{:name=&gt;\"A\"}, {:name=&gt;\"B\"}, {:name=&gt;\"C\"}]],\n  [\"carpenters\", [{:name=&gt;\"J\"}, {:name=&gt;\"K\"}, {:name=&gt;\"L\"}]]\n]\n</code></pre>\n\n<p>You could then convert it back to a hash (with <code>.to_h</code>) if you feel comfortable relying on hashes maintaining their order in Ruby.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1511424169, "last_edit_date": 1511424169, "creation_date": 1511326940, "answer_id": 47427151, "question_id": 47425078, "link": "https://stackoverflow.com/questions/47425078/sort-hash-based-on-conditions/47427151#47427151", "title": "Sort hash based on conditions", "body": "<p>Here are three ways to reorder the keys of the hash <code>roles</code>. In #1 <code>roles</code> is mutated. In #2 and #3, it is not. In those latter two cases, if <code>roles</code> is to be modified (as the question indicates), simply insert <code>roles =</code> at the beginning. Similarly, in #1, if <code>roles</code> is not to be mutated, operate on a copy of <code>roles</code> (<code>roles_cpy = roles.dup</code>).</p>\n\n<p>As well as <code>roles</code>, we are given</p>\n\n<pre><code>negative_roles = [\"electrician\", \"teachers\", \"carpenters\"]\n</code></pre>\n\n<p>All three methods below return</p>\n\n<pre><code>  { \"painters\"=&gt;[{:name=&gt;\"G\"}, {:name=&gt;\"H\"}, {:name=&gt;\"I\"}],\n    \"gardeners\"=&gt;[{:name=&gt;\"P\"}, {:name=&gt;\"Q\"}, {:name=&gt;\"R\"}],\n    \"teachers\"=&gt;[{:name=&gt;\"A\"}, {:name=&gt;\"B\"}, {:name=&gt;\"C\"}],\n    \"electrician\"=&gt;[{:name=&gt;\"D\"}, {:name=&gt;\"E\"}, {:name=&gt;\"F\"}],\n    \"carpenters\"=&gt;[{:name=&gt;\"J\"}, {:name=&gt;\"K\"}, {:name=&gt;\"L\"}]}\n</code></pre>\n\n<p><strong>#1 Use <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-delete\" rel=\"nofollow noreferrer\">Hash#delete</a></strong></p>\n\n<pre><code>negative_roles.each { |k| roles[k] = roles.delete(k) }\nroles\n</code></pre>\n\n<p><strong>#2 Use <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-reject\" rel=\"nofollow noreferrer\">Hash#reject</a>, <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-select\" rel=\"nofollow noreferrer\">Hash#select</a> and <a href=\"http://ruby-doc.org/core-2.4.0/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a></strong></p>\n\n<pre><code>roles.reject { |k,_| negative_roles.include?(k) }.\n  merge(roles.select { |k,_| negative_roles.include?(k) })\n</code></pre>\n\n<p><strong>#3 Use <a href=\"http://ruby-doc.org/core2.4.0/Enumerable.html#method-i-partition\" rel=\"nofollow noreferrer\">Enumerable#partition</a></strong></p>\n\n<pre><code>roles.partition { |k,_| !negative_roles.include?(k) }.flatten(1).to_h\n</code></pre>\n\n<p>I try to avoid converting a hash to an array, modifying the array and then converting it back to a hash. It just seems a bit brutish.</p>\n"}], "owner": {"reputation": 1508, "user_id": 1468122, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/QKC1Z.jpg?s=128&g=1", "display_name": "Ahmad hamza", "link": "https://stackoverflow.com/users/1468122/ahmad-hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47427151, "answer_count": 2, "score": -3, "last_activity_date": 1511424169, "creation_date": 1511311397, "last_edit_date": 1511321401, "question_id": 47425078, "link": "https://stackoverflow.com/questions/47425078/sort-hash-based-on-conditions", "title": "Sort hash based on conditions", "body": "<p>I have a hash like this:</p>\n\n<pre><code>roles = {\n   \"teachers\"   =&gt; [{name: \"A\"}, {name: \"B\"}, {name: \"C\"}], \n   \"electrician\"=&gt; [{name: \"D\"}, {name: \"E\"}, {name: \"F\"}],\n   \"painters\"   =&gt; [{name: \"G\"}, {name: \"H\"}, {name: \"I\"}],\n   \"carpenters\" =&gt; [{name: \"J\"}, {name: \"K\"}, {name: \"L\"}],\n   \"gardeners\"  =&gt; [{name: \"P\"}, {name: \"Q\"}, {name: \"R\"}], \n}\n</code></pre>\n\n<p>I also have an array <code>negative_roles</code> that consists of negative roles:</p>\n\n<pre><code>negative_roles = [\"electrician\", \"teachers\", \"carpenters\"]\n</code></pre>\n\n<p><code>roles</code> should be sorted so that all negative roles come later like this:</p>\n\n<pre><code>roles = { \n   \"painters\"   =&gt; [{name: \"G\"}, {name: \"H\"}, {name: \"I\"}],\n   \"gardeners\"  =&gt; [{name: \"P\"}, {name: \"Q\"}, {name: \"R\"}], \n   \"electrician\"=&gt; [{name: \"M\"}, {name: \"N\"}, {name: \"O\"}],\n   \"teachers\"   =&gt; [{name: \"A\"}, {name: \"B\"}, {name: \"C\"}],\n   \"carpenters\" =&gt; [{name: \"J\"}, {name: \"K\"}, {name: \"L\"}], \n}\n</code></pre>\n\n<p>How can I do it?</p>\n"}, {"tags": ["c", "ruby", "parsing"], "comments": [{"owner": {"reputation": 540, "user_id": 6679233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbbbded9ce82f04a8cd114e5e7ae283c?s=128&d=identicon&r=PG&f=1", "display_name": "Maru", "link": "https://stackoverflow.com/users/6679233/maru"}, "edited": false, "score": 1, "creation_date": 1511310696, "post_id": 47424831, "comment_id": 81804860, "body": "as far as my understanding of ruby goes, you cannot do this from a Gem since gems run on top the ruby interpretter. you can add c extensions to your gem but you can&#39;t affect the interpretter thats already running.   for more info on gems with c extensions: <a href=\"http://guides.rubygems.org/gems-with-extensions/\" rel=\"nofollow noreferrer\">guides.rubygems.org/gems-with-extensions</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "edited": false, "score": 2, "creation_date": 1511419847, "post_id": 47439746, "comment_id": 81853387, "body": "rats. i was going to try to try to put ++ -- in there, just out of spite. oh well."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1511368556, "creation_date": 1511368556, "answer_id": 47439746, "question_id": 47424831, "link": "https://stackoverflow.com/questions/47424831/override-rubys-base-c-code-from-gem/47439746#47439746", "title": "Override Ruby&#39;s base C code from Gem", "body": "<p>No.</p>\n\n<p>The only base C code that gems have access to is that exposed by the <a href=\"https://github.com/ruby/ruby/tree/trunk/include/ruby\" rel=\"nofollow noreferrer\">Ruby headers</a>.\nThe parsing/lexing code is not exposed there.</p>\n\n<p>If you want to define custom syntax, I would try (in order):</p>\n\n<ol>\n<li>Loosen your requirements a bit and define a <a href=\"https://www.leighhalliday.com/creating-ruby-dsl\" rel=\"nofollow noreferrer\">DSL</a>. Ruby has insanely powerful metaprogramming features that can take anything you might do statically in a script and instead do it dynamically during runtime</li>\n<li>Write your custom parser in Ruby and emit valid Ruby which you then <code>eval</code>. Ugly, and probably a little slow, but will allow you to do anything you want.</li>\n<li>Modify the <a href=\"https://github.com/mruby/mruby\" rel=\"nofollow noreferrer\">mruby</a> parser instead. mruby is designed for embedded applications where you want to be able to highly customize the capabilities of the VM. I doubt that they had the parser in mind, but still it might be more feasible than messing around with MRI.</li>\n</ol>\n"}], "owner": {"reputation": 6100, "user_id": 3704297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjB9f.jpg?s=128&g=1", "display_name": "omikes", "link": "https://stackoverflow.com/users/3704297/omikes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 1, "accepted_answer_id": 47439746, "answer_count": 1, "score": 4, "last_activity_date": 1511368556, "creation_date": 1511309504, "last_edit_date": 1511330575, "question_id": 47424831, "link": "https://stackoverflow.com/questions/47424831/override-rubys-base-c-code-from-gem", "title": "Override Ruby&#39;s base C code from Gem", "body": "<p>For the sake of experimentation, I am looking for a way to modify some of Ruby's base code, specifically the parser. I was wondering if this was possible to do at all, let alone using a Gem.</p>\n\n<p>I have narrowed the code I need to change to <code>static int yylex()</code> within <code>parser.c</code>. I was going to try to use an alias, but that seems to require that I change <code>parser.h</code>, which cannot be done within a Gem, as I understand.</p>\n\n<p>Can this be done from a Gem?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "github", "heroku"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 4, "creation_date": 1511309207, "post_id": 47424687, "comment_id": 81804441, "body": "I&#39;m confused. I see warnings, but no error. And it ends with <code>deployed to Heroku</code>. So, what&#39;s the error?"}, {"owner": {"reputation": 89, "user_id": 5281391, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/083ee934c04a141aae19a666a9e97d06?s=128&d=identicon&r=PG&f=1", "display_name": "sampbay", "link": "https://stackoverflow.com/users/5281391/sampbay"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511321616, "post_id": 47424687, "comment_id": 81807512, "body": "When I open the app: &quot;Application error An error occurred in the application and your page could not be served. If you are the application owner, check your logs for details.&quot; The above build log is all I got."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511321716, "post_id": 47424687, "comment_id": 81807532, "body": "You should be able to do something like: <code>heroku logs</code> in your console and see what the errors are in heroku. Depending on how you have things configured, you may need to add the <code>--remote</code> directive. You can also add <code>--tail</code> to see what&#39;s happening on heroku in real time."}, {"owner": {"reputation": 89, "user_id": 5281391, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/083ee934c04a141aae19a666a9e97d06?s=128&d=identicon&r=PG&f=1", "display_name": "sampbay", "link": "https://stackoverflow.com/users/5281391/sampbay"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511321995, "post_id": 47424687, "comment_id": 81807588, "body": "<code>heroku logs</code> gives this error: <code>ENOTFOUND: getaddrinfo ENOTFOUND api.heroku.com api.heroku.com:443</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1511322424, "post_id": 47424687, "comment_id": 81807676, "body": "Okay, well, here&#39;s the deal. It&#39;s pretty clear that the problem has <i>nothing</i> to do with &quot;Restore Ruby gems after OS High Sierra upgrade&quot;. There are two paths I would suggest. First, in <code>config&#47;environments&#47;development.rb</code>, you could change <code>config.eager_load = false</code> to <code>config.eager_load = true</code> and see if you can replicate your system failure on server restart. Second, you need to learn/figure out how to connect to heroku (that error you&#39;re getting, <code>ENOTFOUND</code>, etc., suggests a whole different problem)."}, {"owner": {"reputation": 89, "user_id": 5281391, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/083ee934c04a141aae19a666a9e97d06?s=128&d=identicon&r=PG&f=1", "display_name": "sampbay", "link": "https://stackoverflow.com/users/5281391/sampbay"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511383268, "post_id": 47424687, "comment_id": 81842129, "body": "<code>ENOTFOUND: getaddrinfo ENOTFOUND api.heroku.com api.heroku.com:443</code> error is now gone and a whole set of logs shown if I run <code>heroku logs</code>. I am really new to rails and heroku and might be missing something."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511386134, "post_id": 47424687, "comment_id": 81843494, "body": "Please add to your question: (1) what you get when you do <code>ruby -v</code> in your console, and (2) your <code>Gemfile</code>."}, {"owner": {"reputation": 89, "user_id": 5281391, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/083ee934c04a141aae19a666a9e97d06?s=128&d=identicon&r=PG&f=1", "display_name": "sampbay", "link": "https://stackoverflow.com/users/5281391/sampbay"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1511391026, "post_id": 47424687, "comment_id": 81845397, "body": "@jvillian I&#39;ve looked everywhere but still can&#39;t find the cause... thanks for your help."}, {"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "edited": false, "score": 0, "creation_date": 1516113345, "post_id": 47424687, "comment_id": 83551142, "body": "@sampbay, walk me through this please. You had a RoR app live on Heroku when you upgraded to High Sierra, correct?"}], "owner": {"reputation": 89, "user_id": 5281391, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/083ee934c04a141aae19a666a9e97d06?s=128&d=identicon&r=PG&f=1", "display_name": "sampbay", "link": "https://stackoverflow.com/users/5281391/sampbay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511390908, "creation_date": 1511308428, "last_edit_date": 1511390908, "question_id": 47424687, "link": "https://stackoverflow.com/questions/47424687/restore-ruby-gems-after-os-high-sierra-upgrade", "title": "Restore Ruby gems after OS High Sierra upgrade", "body": "<p>I just upgraded my OS to High Sierra and my Rails application on Heroku stopped working with the following error:</p>\n\n<pre><code>   -----&gt; Ruby app detected\n   -----&gt; Compiling Ruby/Rails\n   -----&gt; Using Ruby version: ruby-2.4.2\n   -----&gt; Installing dependencies using bundler 1.15.2\n          Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\n          Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.0). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\n          Using rake 12.3.0\n          Using concurrent-ruby 1.0.5\n          Using minitest 5.10.3\n          Using thread_safe 0.3.6\n          Using builder 3.2.3\n          Using erubis 2.7.0\n          Using mini_portile2 2.3.0\n          Using crass 1.0.3\n          Using rack 1.6.8\n          Using mini_mime 1.0.0\n          Using arel 6.0.4\n          Using execjs 2.7.0\n          Using bcrypt 3.1.11\n          Using rb-fsevent 0.10.2\n          Using ffi 1.9.18\n          Using bundler 1.15.2\n          Using thor 0.20.0\n          Using coffee-script-source 1.12.2\n          Using colored 1.2\n          Using multi_json 1.12.2\n          Using turbolinks-source 5.0.3\n          Using json 1.8.6\n          Using nprogress-rails 0.2.0.2\n          Using pg 0.21.0\n          Using rails_serve_static_assets 0.0.5\n          Using rails_stdout_logging 0.0.5\n          Using rdoc 4.3.0\n          Using tilt 2.0.8\n          Using unicode_utils 1.4.0\n          Using i18n 0.9.1\n          Using tzinfo 1.2.4\n          Using nokogiri 1.8.1\n          Using mail 2.7.0\n          Using autoprefixer-rails 7.1.6\n          Using uglifier 3.2.0\n          Using rack-test 0.6.3\n          Using sprockets 3.7.1\n          Using rb-inotify 0.9.10\n          Using coffee-script 2.4.1\n          Using select2-rails 4.0.3\n          Using turbolinks 5.0.1\n          Using rails_12factor 0.0.3\n          Using activesupport 4.2.8\n          Using sdoc 0.4.2\n          Using loofah 2.1.1\n          Using rails-deprecated_sanitizer 1.0.3\n          Using globalid 0.4.1\n          Using activemodel 4.2.8\n          Using jbuilder 2.7.0\n          Using sass-listen 4.0.0\n          Using rails-html-sanitizer 1.0.3\n          Using rails-dom-testing 1.0.8\n          Using activerecord 4.2.8\n          Using sass 3.5.3\n          Using activejob 4.2.8\n          Using actionview 4.2.8\n          Using bootstrap-sass 3.3.7\n          Using actionpack 4.2.8\n          Using actionmailer 4.2.8\n          Using railties 4.2.8\n          Using sprockets-rails 3.2.1\n          Using chart-js-rails 0.1.4\n          Using coffee-rails 4.1.1\n          Using jquery-rails 4.3.1\n          Using jquery-turbolinks 2.1.0\n          Using rails 4.2.8\n          Using responders 2.4.0\n          Using sass-rails 5.0.7\n          Using tabulous 2.1.4\n          Bundle complete! 22 Gemfile dependencies, 69 gems now installed.\n          Gems in the groups development and test were not installed.\n          Bundled gems are installed into ./vendor/bundle.\n          Bundle completed (1.05s)\n          Cleaning up the bundler cache.\n          Warning: the running version of Bundler (1.15.2) is older than the version that created the lockfile (1.16.0). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\n   -----&gt; Installing node-v6.11.1-linux-x64\n          Detected manifest file, assuming assets were compiled locally\n   ###### WARNING:\n          Removing `vendor/bundle`.\n          Checking in `vendor/bundle` is not supported. Please remove this directory\n          and add it to your .gitignore. To vendor your gems with Bundler, use\n          `bundle pack` instead.\n   ###### WARNING:\n          No Procfile detected, using the default web server.\n          We recommend explicitly declaring how to boot your server process via a Procfile.\n          https://devcenter.heroku.com/articles/ruby-default-web-server\n   -----&gt; Discovering process types\n          Procfile declares types     -&gt; (none)\n          Default types for buildpack -&gt; console, rake, web, worker\n   -----&gt; Compressing...\n          Done: 482M\n   -----&gt; Launching...\n    !     Warning: Your slug size exceeds our soft limit (482 MB) which may affect boot time.\n          Released v46\n          https://nameless-headland-25042.herokuapp.com/ deployed to Heroku\n</code></pre>\n\n<p>I installed gems using rbenv and set global and local to the latest version 2.4.2. \nI \"bundle updated\" the gems in this app but I am not sure what went wrong during the OS upgrade...</p>\n\n<p>The app actually works fine on my localhost but just not on Heroku. I pushed my app from github using Heroku's manual deploy function, of which the result (error) is shown above.</p>\n\n<p>Edit: I ran <code>heroku logs --app nameless-headland-25042</code> and the following is the log. <code>git push heroku master</code> results in successful build and the app runs normally on may local server too. 'heroku restart' and 'heroku run rails console' run okay but the app still crashes with H10 error. </p>\n\n<pre><code>2017-11-22T19:09:53.481580+00:00 heroku[web.1]: State changed from crashed to starting\n2017-11-22T19:09:58.598103+00:00 app[api]: Starting process with command `ruby -v` by user sampbay@outlook.com\n2017-11-22T19:10:01.298088+00:00 app[api]: Starting process with command `ruby -v` by user sampbay@outlook.com\n2017-11-22T19:10:17.627615+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 26537 -e production`\n2017-11-22T19:10:20.294752+00:00 heroku[web.1]: Process exited with status 1\n2017-11-22T19:10:20.211680+00:00 app[web.1]: /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:486:in `validate_ruby!': Your Ruby version is 1.9.3, but your Gemfile specified 2.4.2 (Bundler::RubyVersionMismatch)\n2017-11-22T19:10:20.211722+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler.rb:95:in `setup'\n2017-11-22T19:10:20.211716+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:461:in `validate_runtime!'\n2017-11-22T19:10:20.211730+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n2017-11-22T19:10:20.211736+00:00 app[web.1]:    from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n2017-11-22T19:10:20.211743+00:00 app[web.1]:    from bin/rails:3:in `&lt;main&gt;'\n2017-11-22T19:10:20.211729+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n2017-11-22T19:10:20.211730+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n2017-11-22T19:10:20.211723+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/setup.rb:19:in `&lt;top (required)&gt;'\n2017-11-22T19:10:20.211742+00:00 app[web.1]:    from bin/rails:3:in `require_relative'\n2017-11-22T19:10:20.310479+00:00 heroku[web.1]: State changed from starting to crashed\n2017-11-22T19:10:21.822127+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=5ca8def8-6d30-43cc-9a37-b61e0569aff9 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:10:22.087967+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=3e1132da-cfc1-4106-b1d1-c8813d0d92c8 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:10:26.078493+00:00 heroku[run.7220]: Awaiting client\n2017-11-22T19:10:26.040233+00:00 heroku[run.7220]: State changed from starting to up\n2017-11-22T19:10:26.776223+00:00 heroku[run.8213]: Awaiting client\n2017-11-22T19:10:26.973557+00:00 heroku[run.8213]: State changed from starting to up\n2017-11-22T19:10:50.018572+00:00 app[api]: Starting process with command `bash` by user sampbay@outlook.com\n2017-11-22T19:10:56.080177+00:00 heroku[run.7220]: Error R13 (Attach error) -&gt; Failed to attach to process\n2017-11-22T19:10:56.082673+00:00 heroku[run.7220]: Process exited with status 128\n2017-11-22T19:10:56.099492+00:00 heroku[run.7220]: State changed from up to complete\n2017-11-22T19:10:56.777794+00:00 heroku[run.8213]: Error R13 (Attach error) -&gt; Failed to attach to process\n2017-11-22T19:10:56.781655+00:00 heroku[run.8213]: Process exited with status 128\n2017-11-22T19:10:56.796121+00:00 heroku[run.8213]: State changed from up to complete\n2017-11-22T19:11:15.476237+00:00 heroku[run.3078]: Awaiting client\n2017-11-22T19:11:15.669289+00:00 heroku[run.3078]: State changed from starting to up\n2017-11-22T19:11:18.149746+00:00 app[api]: Starting process with command `bash` by user sampbay@outlook.com\n2017-11-22T19:11:42.403048+00:00 heroku[run.2308]: Awaiting client\n2017-11-22T19:11:42.448759+00:00 heroku[run.2308]: Starting process with command `bash`\n2017-11-22T19:11:42.504773+00:00 heroku[run.2308]: State changed from starting to up\n2017-11-22T19:11:45.477512+00:00 heroku[run.3078]: Error R13 (Attach error) -&gt; Failed to attach to process\n2017-11-22T19:11:45.480343+00:00 heroku[run.3078]: Process exited with status 128\n2017-11-22T19:11:45.492467+00:00 heroku[run.3078]: State changed from up to complete\n2017-11-22T19:13:02.638906+00:00 heroku[run.2308]: State changed from up to complete\n2017-11-22T19:13:02.626226+00:00 heroku[run.2308]: Process exited with status 130\n2017-11-22T19:14:35.403208+00:00 app[api]: Starting process with command `bash` by user sampbay@outlook.com\n2017-11-22T19:14:58.752336+00:00 heroku[run.4399]: Starting process with command `bash`\n2017-11-22T19:14:58.728051+00:00 heroku[run.4399]: Awaiting client\n2017-11-22T19:14:58.920165+00:00 heroku[run.4399]: State changed from starting to up\n2017-11-22T19:15:38.245463+00:00 heroku[run.4399]: State changed from up to complete\n2017-11-22T19:15:38.233115+00:00 heroku[run.4399]: Process exited with status 127\n2017-11-22T19:24:05.273542+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=37071eae-5041-4eab-b125-3d5dbda9dee9 fwd=\"209.171.88.244\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:24:05.675915+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=cbffabff-23ab-43b7-bab8-3d124d354853 fwd=\"209.171.88.244\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:26:48.235036+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=HEAD path=\"/\" host=www.trialn.com request_id=93f709b3-dc4a-496e-875b-ea9f3bc4b8d8 fwd=\"138.246.253.19\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:29:29.248613+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=e1ce9f53-b509-452b-a9f4-dfe0459d32b0 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:29:29.514570+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=c1bf8800-8496-42e5-8856-e14210a09ec9 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:37:05.406000+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=fdfb412c-f52a-469d-80fd-7b286adb005b fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:37:05.746892+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=369e49b2-bfd5-42fb-a3bd-52a6cdabeebb fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:56:09.000000+00:00 app[api]: Build started by user sampbay@outlook.com\n2017-11-22T19:56:44.065170+00:00 heroku[web.1]: State changed from crashed to starting\n2017-11-22T19:56:43.831102+00:00 app[api]: Release v66 created by user sampbay@outlook.com\n2017-11-22T19:56:43.831102+00:00 app[api]: Deploy 10ec53f8 by user sampbay@outlook.com\n2017-11-22T19:56:09.000000+00:00 app[api]: Build succeeded\n2017-11-22T19:56:55.109511+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 26954 -e production`\n2017-11-22T19:56:57.043796+00:00 app[web.1]: /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:486:in `validate_ruby!': Your Ruby version is 1.9.3, but your Gemfile specified 2.4.2 (Bundler::RubyVersionMismatch)\n2017-11-22T19:56:57.043820+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler.rb:95:in `setup'\n2017-11-22T19:56:57.043819+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:461:in `validate_runtime!'\n2017-11-22T19:56:57.043821+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/setup.rb:19:in `&lt;top (required)&gt;'\n2017-11-22T19:56:57.043849+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n2017-11-22T19:56:57.043851+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n2017-11-22T19:56:57.043852+00:00 app[web.1]:    from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n2017-11-22T19:56:57.043851+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n2017-11-22T19:56:57.043853+00:00 app[web.1]:    from bin/rails:3:in `require_relative'\n2017-11-22T19:56:57.043853+00:00 app[web.1]:    from bin/rails:3:in `&lt;main&gt;'\n2017-11-22T19:56:57.119277+00:00 heroku[web.1]: Process exited with status 1\n2017-11-22T19:56:57.131451+00:00 heroku[web.1]: State changed from starting to crashed\n2017-11-22T19:56:57.133421+00:00 heroku[web.1]: State changed from crashed to starting\n2017-11-22T19:57:12.623536+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 39202 -e production`\n2017-11-22T19:57:15.543436+00:00 app[web.1]: /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:486:in `validate_ruby!': Your Ruby version is 1.9.3, but your Gemfile specified 2.4.2 (Bundler::RubyVersionMismatch)\n2017-11-22T19:57:15.543522+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n2017-11-22T19:57:15.543484+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler.rb:95:in `setup'\n2017-11-22T19:57:15.543537+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n2017-11-22T19:57:15.543587+00:00 app[web.1]:    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n2017-11-22T19:57:15.543471+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/definition.rb:461:in `validate_runtime!'\n2017-11-22T19:57:15.543611+00:00 app[web.1]:    from bin/rails:3:in `require_relative'\n2017-11-22T19:57:15.543622+00:00 app[web.1]:    from bin/rails:3:in `&lt;main&gt;'\n2017-11-22T19:57:15.543495+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.4.0/gems/bundler-1.15.2/lib/bundler/setup.rb:19:in `&lt;top (required)&gt;'\n2017-11-22T19:57:15.543599+00:00 app[web.1]:    from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n2017-11-22T19:57:15.659621+00:00 heroku[web.1]: State changed from starting to crashed\n2017-11-22T19:57:15.642838+00:00 heroku[web.1]: Process exited with status 1\n2017-11-22T19:57:43.446415+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=0244c6e7-7327-4607-af44-b97b982ca24a fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:43.744819+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=f96b2b70-3c55-4fde-ac03-e365325598c4 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:44.991232+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=08d2b9c8-bb56-4443-a505-6d8f3890e236 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:45.174088+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=98bbb508-33c4-4bd3-8dfb-ed6acd9b1eca fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:45.887297+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=df1b33a5-ec4e-41f0-89c8-12b147e2bfb6 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:46.053922+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=6e39b8f9-4a4e-4141-9067-a32bf1621e9e fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:46.651470+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=51c63d7a-b98b-4cba-9f71-2368d46b78d7 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:46.825180+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=82d1a487-6aa0-4710-b073-335664ff74b1 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:48.097023+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=73611bae-7d9d-46e1-b921-e030d9868cd3 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:48.336866+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=8fe9f620-c154-4c60-bb3d-6292d9df5f6c fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:49.745128+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=c3e5b9df-0cef-41a8-82ed-02fe945dd1c3 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T19:57:49.908798+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=02162725-4a2c-4a38-9ccc-bec24d9fcfe6 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T20:00:50.654740+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=10a16eeb-841b-4a35-a34b-ea8cd1060e9c fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T20:00:51.014613+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=dd93bced-52ba-4064-a856-a3bdbce5119f fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T20:05:38.672583+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=nameless-headland-25042.herokuapp.com request_id=03dea5ff-c62a-43b0-a6cc-37b4adc844e7 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n2017-11-22T20:05:38.981499+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=nameless-headland-25042.herokuapp.com request_id=d8e2b616-c2b4-4614-8ccd-c83d6b3a88f3 fwd=\"208.94.109.2\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n\n<p>edit 2: \n<code>ruby -v</code> gives <code>ruby 2.4.2p198 (2017-09-14 revision 59899) [x86_64-darwin17]</code></p>\n\n<p>gemfile: </p>\n\n<pre><code>source 'https://rubygems.org'\n# Declare Ruby version\nruby '2.4.2'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.8'\n# Use sqlite3 as the database for Active Record\n# gem 'sqlite3'\n# Use pg as the database for Active Record\ngem 'pg'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0.6'\n# USE bootstrap-sass\ngem 'bootstrap-sass', '~&gt; 3.3.5'\n\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.1.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\ngem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.0'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\n\n# Use ActiveModel has_secure_password\ngem 'bcrypt', '~&gt; 3.1.7'\n\n\n# Use Unicorn as the app server\n# gem 'unicorn'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# UnicodeUtils implements Unicode algorithms for case conversion, normalization, text segmentation and more in pure Ruby code.\ngem 'unicode_utils', '~&gt; 1.4.0'\n\n#Select2\ngem 'select2-rails', '~&gt; 4.0.0'\n\n#Chart.js for Rails Version 2.0.2\ngem 'chart-js-rails', '~&gt; 0.1.0'\n\n#progress bar\ngem 'nprogress-rails'\n\ngem 'responders', '~&gt; 2.4.0'\n\n#paginate\n#gem 'will_paginate', '~&gt; 3.1.1'\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug'\n\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'web-console', '~&gt; 2.0'\n\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n\n  #Heroku integration has previously relied on using the Rails plugin system, which has been removed from Rails 4. To enable features such as static asset serving and logging on Heroku please add this\n  gem 'rails_12factor', group: :production\nend\n</code></pre>\n\n<p>Gemfile.lock: </p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actionmailer (4.2.8)\n      actionpack (= 4.2.8)\n      actionview (= 4.2.8)\n      activejob (= 4.2.8)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n    actionpack (4.2.8)\n      actionview (= 4.2.8)\n      activesupport (= 4.2.8)\n      rack (~&gt; 1.6)\n      rack-test (~&gt; 0.6.2)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (4.2.8)\n      activesupport (= 4.2.8)\n      builder (~&gt; 3.1)\n      erubis (~&gt; 2.7.0)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.3)\n    activejob (4.2.8)\n      activesupport (= 4.2.8)\n      globalid (&gt;= 0.3.0)\n    activemodel (4.2.8)\n      activesupport (= 4.2.8)\n      builder (~&gt; 3.1)\n    activerecord (4.2.8)\n      activemodel (= 4.2.8)\n      activesupport (= 4.2.8)\n      arel (~&gt; 6.0)\n    activesupport (4.2.8)\n      i18n (~&gt; 0.7)\n      minitest (~&gt; 5.1)\n      thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n      tzinfo (~&gt; 1.1)\n    arel (6.0.4)\n    autoprefixer-rails (7.1.6)\n      execjs\n    bcrypt (3.1.11)\n    binding_of_caller (0.7.3)\n      debug_inspector (&gt;= 0.0.1)\n    bootstrap-sass (3.3.7)\n      autoprefixer-rails (&gt;= 5.2.1)\n      sass (&gt;= 3.3.4)\n    builder (3.2.3)\n    byebug (9.1.0)\n    chart-js-rails (0.1.4)\n      railties (&gt; 3.1)\n    coffee-rails (4.1.1)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0, &lt; 5.1.x)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.12.2)\n    concurrent-ruby (1.0.5)\n    crass (1.0.3)\n    debug_inspector (0.0.3)\n    erubis (2.7.0)\n    execjs (2.7.0)\n    ffi (1.9.18)\n    globalid (0.4.1)\n      activesupport (&gt;= 4.2.0)\n    i18n (0.9.1)\n      concurrent-ruby (~&gt; 1.0)\n    jbuilder (2.7.0)\n      activesupport (&gt;= 4.2.0)\n      multi_json (&gt;= 1.2)\n    jquery-rails (4.3.1)\n      rails-dom-testing (&gt;= 1, &lt; 3)\n      railties (&gt;= 4.2.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    json (1.8.6)\n    loofah (2.1.1)\n      crass (~&gt; 1.0.2)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.7.0)\n      mini_mime (&gt;= 0.1.1)\n    mini_mime (1.0.0)\n    mini_portile2 (2.3.0)\n    minitest (5.10.3)\n    multi_json (1.12.2)\n    nokogiri (1.8.1)\n      mini_portile2 (~&gt; 2.3.0)\n    nprogress-rails (0.2.0.2)\n    pg (0.21.0)\n    rack (1.6.8)\n    rack-test (0.6.3)\n      rack (&gt;= 1.0)\n    rails (4.2.8)\n      actionmailer (= 4.2.8)\n      actionpack (= 4.2.8)\n      actionview (= 4.2.8)\n      activejob (= 4.2.8)\n      activemodel (= 4.2.8)\n      activerecord (= 4.2.8)\n      activesupport (= 4.2.8)\n      bundler (&gt;= 1.3.0, &lt; 2.0)\n      railties (= 4.2.8)\n      sprockets-rails\n    rails-deprecated_sanitizer (1.0.3)\n      activesupport (&gt;= 4.2.0.alpha)\n    rails-dom-testing (1.0.8)\n      activesupport (&gt;= 4.2.0.beta, &lt; 5.0)\n      nokogiri (~&gt; 1.6)\n      rails-deprecated_sanitizer (&gt;= 1.0.1)\n    rails-html-sanitizer (1.0.3)\n      loofah (~&gt; 2.0)\n    rails_12factor (0.0.3)\n      rails_serve_static_assets\n      rails_stdout_logging\n    rails_serve_static_assets (0.0.5)\n    rails_stdout_logging (0.0.5)\n    railties (4.2.8)\n      actionpack (= 4.2.8)\n      activesupport (= 4.2.8)\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rake (12.3.0)\n    rb-fsevent (0.10.2)\n    rb-inotify (0.9.10)\n      ffi (&gt;= 0.5.0, &lt; 2)\n    rdoc (4.3.0)\n    responders (2.4.0)\n      actionpack (&gt;= 4.2.0, &lt; 5.3)\n      railties (&gt;= 4.2.0, &lt; 5.3)\n    sass (3.5.3)\n      sass-listen (~&gt; 4.0.0)\n    sass-listen (4.0.0)\n      rb-fsevent (~&gt; 0.9, &gt;= 0.9.4)\n      rb-inotify (~&gt; 0.9, &gt;= 0.9.7)\n    sass-rails (5.0.7)\n      railties (&gt;= 4.0.0, &lt; 6)\n      sass (~&gt; 3.1)\n      sprockets (&gt;= 2.8, &lt; 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n      tilt (&gt;= 1.1, &lt; 3)\n    sdoc (0.4.2)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      rdoc (~&gt; 4.0)\n    select2-rails (4.0.3)\n      thor (~&gt; 0.14)\n    spring (2.0.2)\n      activesupport (&gt;= 4.2)\n    sprockets (3.7.1)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.2.1)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    thor (0.20.0)\n    thread_safe (0.3.6)\n    tilt (2.0.8)\n    turbolinks (5.0.1)\n      turbolinks-source (~&gt; 5)\n    turbolinks-source (5.0.3)\n    tzinfo (1.2.4)\n      thread_safe (~&gt; 0.1)\n    uglifier (3.2.0)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    unicode_utils (1.4.0)\n    web-console (2.3.0)\n      activemodel (&gt;= 4.0)\n      binding_of_caller (&gt;= 0.7.2)\n      railties (&gt;= 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  bcrypt (~&gt; 3.1.7)\n  bootstrap-sass (~&gt; 3.3.5)\n  byebug\n  chart-js-rails (~&gt; 0.1.0)\n  coffee-rails (~&gt; 4.1.0)\n  jbuilder (~&gt; 2.0)\n  jquery-rails\n  nprogress-rails\n  pg\n  rails (= 4.2.8)\n  rails_12factor\n  responders (~&gt; 2.4.0)\n  sass-rails (~&gt; 5.0.6)\n  sdoc (~&gt; 0.4.0)\n  select2-rails (~&gt; 4.0.0)\n  spring\n  turbolinks\n  uglifier (&gt;= 1.3.0)\n  unicode_utils (~&gt; 1.4.0)\n  web-console (~&gt; 2.0)\n\nRUBY VERSION\n   ruby 2.4.2p198\n\nBUNDLED WITH\n   1.15.2\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "is_accepted": true, "score": 2, "last_activity_date": 1511308445, "creation_date": 1511308445, "answer_id": 47424689, "question_id": 47424663, "link": "https://stackoverflow.com/questions/47424663/install-rbenv-or-homebrew-first/47424689#47424689", "title": "Install rbenv or Homebrew first?", "body": "<p>The installation instructions for rbenv on MacOS assume Homebrew is already installed so this should be done first.</p>\n\n<p><a href=\"https://github.com/rbenv/rbenv#homebrew-on-macos\" rel=\"nofollow noreferrer\">https://github.com/rbenv/rbenv#homebrew-on-macos</a></p>\n"}], "owner": {"reputation": 1834, "user_id": 787648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a6d9411205d3334d86391f449fd53bad?s=128&d=identicon&r=PG", "display_name": "Paul Bruno", "link": "https://stackoverflow.com/users/787648/paul-bruno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 47424689, "answer_count": 1, "score": -2, "last_activity_date": 1511308451, "creation_date": 1511308265, "last_edit_date": 1511308451, "question_id": 47424663, "link": "https://stackoverflow.com/questions/47424663/install-rbenv-or-homebrew-first", "title": "Install rbenv or Homebrew first?", "body": "<p>tl;dr: Have never hitherto installed either <code>rbenv</code> or Homebrew on my macOS machine; which would be considered best practice, or what are the pros/cons of each?</p>\n\n<p>Unabridged: Somehow, in my 13 yr. development career and 13 yr. tenure as a Mac user, I've never installed installed a package manager. And I'm also setting myself to learn Ruby/Rails in coming weeks/months. So I'm aiming to set up both.  But there are some who would recommend using Homebrew to set up <code>rbenv</code>;  and of course, you can install rubies via <code>rbenv</code> (and <code>ruby-build</code>), and then possibly set up your Homebrew install from a non-system ruby)?</p>\n\n<p>Is there an unequivocally better choice in these two? I'm a JavaScript developer, and I've set up both <code>nvm</code> and now <code>nodenv</code> w/o package manager. For symmetry of experience I have a slight inclination to do <code>rbenv</code> first, but those wiser in this than me are free to advise to the contrary.</p>\n"}, {"tags": ["ruby", "yaml"], "comments": [{"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 3, "creation_date": 1511305522, "post_id": 47424118, "comment_id": 81803294, "body": "The best way to store binary data in YAML is to Base64-encode it and use the !!binary type. Do you have the ability to change the YAML or are you stuck with it? <a href=\"http://yaml.org/type/binary.html\" rel=\"nofollow noreferrer\">yaml.org/type/binary.html</a>"}, {"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 2, "creation_date": 1511305917, "post_id": 47424118, "comment_id": 81803410, "body": "Also, you&#39;ll see the double backslashes if you&#39;re inspecting the string, but that doesn&#39;t necessarily mean the string is being modified. Are you sure you&#39;re not just looking at the &quot;printable&quot; version?"}, {"owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 1, "creation_date": 1511307645, "post_id": 47424118, "comment_id": 81803987, "body": "@mwp is correct, it&#39;s not being modified, you&#39;re just seeing the escaped backslash in the string. I tried it with <code>YAML.load</code> and it appears to be working as you expect it to."}], "owner": {"reputation": 2417, "user_id": 343495, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/823c21aefa18ab5a917aea66cc3c0519?s=128&d=identicon&r=PG", "display_name": "Drew", "link": "https://stackoverflow.com/users/343495/drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511305656, "creation_date": 1511305003, "last_edit_date": 1511305656, "question_id": 47424118, "link": "https://stackoverflow.com/questions/47424118/yaml-value-translation", "title": "YAML Value Translation", "body": "<p>So I want to have the following value for a YAML key:</p>\n\n<pre><code>\\x1D\\r\\xAFK\\xF3\\x03\\xE5Uj\\x97\\xD3B\\xD5a'\\e6\\x93\\xDD\\x84\\xCA\\xC5\\r\\x90+\\x12\\xEA\\x1E\\xEC\\xBE\\x9C\\x95`\n</code></pre>\n\n<p>However after setting it up like:</p>\n\n<pre><code>KEY: \\x1D\\r\\xAFK\\xF3\\x03\\xE5Uj\\x97\\xD3B\\xD5a'\\e6\\x93\\xDD\\x84\\xCA\\xC5\\r\\x90+\\x12\\xEA\\x1E\\xEC\\xBE\\x9C\\x95\n</code></pre>\n\n<p>I'm getting:</p>\n\n<pre><code>\\\\x1D\\\\r\\\\xAFK\\\\xF3\\\\x03\\\\xE5Uj\\\\x97\\\\xD3B\\\\xD5a'\\\\e6\\\\x93\\\\xDD\\\\x84\\\\xCA\\\\xC5\\\\r\\\\x90+\\\\x12\\\\xEA\\\\x1E\\\\xEC\\\\xBE\\\\x9C\\\\x95\n</code></pre>\n\n<p>after the YAML has been parsed.</p>\n\n<p>Any thoughts on how I can retain the original string?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 5, "last_activity_date": 1511302812, "last_edit_date": 1511302812, "creation_date": 1511302164, "answer_id": 47423586, "question_id": 47423410, "link": "https://stackoverflow.com/questions/47423410/add-zeros-in-money-field/47423586#47423586", "title": "add zeros in money field", "body": "<p>Take a look at Rails' <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_to_currency\" rel=\"nofollow noreferrer\"><code>number_to_currency</code></a> helper, which formats the proper number of decimal places as well as the currency symbols:</p>\n\n<p>For example (from the docs):</p>\n\n<blockquote>\n<pre><code>number_to_currency(1234567890.50)                    # =&gt; $1,234,567,890.50\nnumber_to_currency(1234567890.506, locale: :fr)      # =&gt; 1 234 567 890,51 \u20ac\n</code></pre>\n</blockquote>\n\n<p>and check out the <code>:format</code> option if you don't want the currency symbols:</p>\n\n<blockquote>\n  <p>Sets the format for non-negative numbers (defaults to \u201c%u%n\u201d). Fields are %u for the currency, and %n for the number.</p>\n</blockquote>\n\n<hr>\n\n<p>Alternatively, if you don't want the currency symbol, it looks like there's a <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_with_precision\" rel=\"nofollow noreferrer\"><code>number_with_precision</code></a> helper:</p>\n\n<p>Examples (again from the docs):</p>\n\n<blockquote>\n<pre><code>number_with_precision(111.2345, precision: 2)                           # =&gt; 111.23\nnumber_with_precision(13, precision: 5)                                 # =&gt; 13.00000\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511302812, "creation_date": 1511301363, "question_id": 47423410, "link": "https://stackoverflow.com/questions/47423410/add-zeros-in-money-field", "title": "add zeros in money field", "body": "<p>I'm working with my database on sql server and I'm showing a money type record that will be the total money, the problem is that when I'm doing the data rendering, in the total field it shows me this way 347.0 when in the database is saved with two decimals in this way 347.00 how could you make it show the two decimal places instead of one? Is there a gem that automatically recognizes when the field to be displayed is of the money type so that it can show decimals?</p>\n"}, {"tags": ["ruby", "pipe"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511298908, "post_id": 47422406, "comment_id": 81800221, "body": "Over what, the console? A network connection?"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1511349347, "post_id": 47422406, "comment_id": 81820734, "body": "I think something along the line <code>while line_in=STDIN.read do ... end</code> should do the job. Probably you can provide some test &quot;code&quot; (bash script) to explain better what you want to achieve."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1511350455, "post_id": 47422406, "comment_id": 81821507, "body": "Wait a second, you want to give the server input or process its output or both? Please improve your question and provide examples."}], "answers": [{"tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 1, "last_activity_date": 1511350396, "creation_date": 1511350396, "answer_id": 47433658, "question_id": 47422406, "link": "https://stackoverflow.com/questions/47422406/ruby-process-pipe-output-actively/47433658#47433658", "title": "Ruby: Process Pipe output actively", "body": "<p>You'll find some nice explanations in <a href=\"https://stackoverflow.com/questions/273262/best-practices-with-stdin-in-ruby\">Best practices with STDIN in Ruby?</a> .</p>\n\n<p>You can do the following</p>\n\n<pre><code>#!/usr/bin/env ruby\nARGF.each_line do |line|\n  puts line.upcase\nend\n</code></pre>\n\n<p>Given a script like</p>\n\n<pre><code>#!/bin/bash\necho \"abcde\"\nsleep 2\necho \"oiiausd\"\nsleep 2\n</code></pre>\n\n<p>and feeding them like</p>\n\n<pre><code>$ ./bash_script.sh | ./ruby_script.rb\n</code></pre>\n\n<p>will output</p>\n\n<pre><code>ABCDE\nOIIAUSD\n</code></pre>\n\n<p>Note however that you'll might have to deal with IO buffering and stuff if you notice that processing of the input stream does not work as expected.</p>\n\n<p>Also note that usage of ARGF-magic has the advantage that you could also consume a given log-file like <code>./ruby_script.rb LOGFILE.log</code> (without the pipe).</p>\n"}], "owner": {"reputation": 15, "user_id": 7551650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed4bebe05674379d70986518418f95fa?s=128&d=identicon&r=PG", "display_name": "iSkaltes iSkalt", "link": "https://stackoverflow.com/users/7551650/iskaltes-iskalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1511350396, "creation_date": 1511297189, "question_id": 47422406, "link": "https://stackoverflow.com/questions/47422406/ruby-process-pipe-output-actively", "title": "Ruby: Process Pipe output actively", "body": "<p>I want to process the output of a pipe actively. If I'd, for example, host a server with an interactive console, how would I take the output live and process it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "partial-views", "partial"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511302440, "post_id": 47422269, "comment_id": 81802027, "body": "Can you show the output of the web console? Should tell you if it doesn&#39;t find a value or declaration of <code>par</code> in the partial or the parent file. Where the error is happening in the chain should tell you more about what the problem is."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 1934168, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a8e85918d3db651edd04097020cbf5f1?s=128&d=identicon&r=PG", "display_name": "Hilmi Yamc\u0131", "link": "https://stackoverflow.com/users/1934168/hilmi-yamc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1511338173, "post_id": 47424431, "comment_id": 81813733, "body": "local_assigns[:par] seems to be the key. Thanks a lot"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1593475243, "post_id": 47424431, "comment_id": 110789171, "body": "Thanks for this answer! It&#39;s 2020 and I have this problem with a Rails 6 app. I had to modify the code slightly: <code>&lt;% name      ||= local_assigns[:locals][:name]      %&gt;</code>."}], "tags": [], "owner": {"reputation": 3180, "user_id": 4659816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5TNaW.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/4659816/david"}, "is_accepted": true, "score": 5, "last_activity_date": 1511306818, "creation_date": 1511306818, "answer_id": 47424431, "question_id": 47422269, "link": "https://stackoverflow.com/questions/47422269/ruby-on-rails-render-partial-undefined-local-variable/47424431#47424431", "title": "Ruby on Rails render partial, undefined local variable", "body": "<p>I have also experienced this issue in the past and not entirely sure what causes it but in my case, it seemed to be related to deeply nested partials (but only for a few views).</p>\n\n<p>The solution is to access the local variable from the local_assigns hash. What I tend to do is assign it to a local variable at the top of the page as so:-</p>\n\n<pre><code>&lt;% par ||= local_assigns[:par] %&gt;\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 323, "user_id": 1934168, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/a8e85918d3db651edd04097020cbf5f1?s=128&d=identicon&r=PG", "display_name": "Hilmi Yamc\u0131", "link": "https://stackoverflow.com/users/1934168/hilmi-yamc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "accepted_answer_id": 47424431, "answer_count": 1, "score": 2, "last_activity_date": 1511306818, "creation_date": 1511296715, "question_id": 47422269, "link": "https://stackoverflow.com/questions/47422269/ruby-on-rails-render-partial-undefined-local-variable", "title": "Ruby on Rails render partial, undefined local variable", "body": "<p>I have a change avatar popup in my ruby on rails application. I'm trying to use it for several models like changing profile picture or picture of a product.</p>\n\n<p>I have created a view and trying to open it with parameters as follows in the user.html.erb file:</p>\n\n<pre><code>&lt;div id=\"myModal_change_avatar\" class=\"modal-dialog fade-scale\"&gt;\n &lt;div class=\"modal-content\"&gt;\n  &lt;div style=\"height: 100%;width: 100%\" id=\"id_model_content\"&gt;\n   &lt;%= render partial: 'change_avatar/index', locals: { par:'param'} %&gt;\n  &lt;/div&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In my _index.html.erb file which is located under views/change_avatar:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= par %&gt;&lt;/h1&gt;\n</code></pre>\n\n<p>But, I get \"undefined local variable or method `par' for\" when I open user.html.erb file.</p>\n\n<p>I can't see what I'm missing.</p>\n\n<p>Any suggestions ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "dynamic"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 2, "creation_date": 1511299397, "post_id": 47422006, "comment_id": 81800523, "body": "&quot;Now I have a piece of code that doesn&#39;t work&quot; seems a bit ambiguous what does &quot;doesn&#39;t  work&quot; mean in this case? Error, nothing rendered, the wold comes to a screeching halt?"}, {"owner": {"reputation": 1, "user_id": 8981858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-px1i5tmNYP4/AAAAAAAAAAI/AAAAAAAAATA/kd8Ujzvw55Q/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/8981858/sergey"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511327836, "post_id": 47422006, "comment_id": 81809035, "body": "In this case I have an error with &quot;par.name&quot;: undefined method `par2&#39; for #&lt;Device:0x007f03624d0578&gt;. Where &#39;par2&#39; is the parameter name. But in the parameters table, not in devices table."}, {"owner": {"reputation": 1, "user_id": 8981858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-px1i5tmNYP4/AAAAAAAAAAI/AAAAAAAAATA/kd8Ujzvw55Q/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/8981858/sergey"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511328245, "post_id": 47422006, "comment_id": 81809177, "body": "If I use &#39;par.name&#39; without &#39;f.send&#39;, I get all parameters names correctly. But I want to use it for generating form fields."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511359326, "post_id": 47422006, "comment_id": 81827467, "body": "Since the pars are not attributes of the <code>Device</code> model itself you will need to use a nested attributes to handle these fields. This method is called <code>#fields_for</code> and works very similar to <code>form_for</code> but will nested the parameters under the original model like <code>{device: { parset_attributes: [{parameter_id: 1, value: value}, {parameter_id: 2, value: value}]}}</code> have a look <a href=\"https://apidock.com/rails/ActionView/Helpers/FormHelper/fields_for\" rel=\"nofollow noreferrer\"><code>ActionView::Helpers#fields_for</code></a>"}, {"owner": {"reputation": 1, "user_id": 8981858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-px1i5tmNYP4/AAAAAAAAAAI/AAAAAAAAATA/kd8Ujzvw55Q/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/8981858/sergey"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511369330, "post_id": 47422006, "comment_id": 81834764, "body": "I&#39;ve tried this, but I can&#39;t understand how can I generate only fields for parameters based on chosen categories for device. Nothing rendered in this case:   &lt;%= f.fields_for :parameters || @device.parameters.new do |par| %&gt;     &lt;%= par.object.name %&gt;: &lt;%= par.text_field :value, class: &#39;form-control&#39; %&gt;&lt;br&gt;     &lt;%= par.text_field :value_type, class: &#39;form-control&#39; %&gt;&lt;br&gt;   &lt;% end %&gt;"}, {"owner": {"reputation": 1, "user_id": 8981858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-px1i5tmNYP4/AAAAAAAAAAI/AAAAAAAAATA/kd8Ujzvw55Q/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/8981858/sergey"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511457961, "post_id": 47422006, "comment_id": 81876117, "body": "&lt;%= device.fields_for :parsets do |parset| %&gt; &lt;% @allparams.uniq.each do |param| %&gt; &lt;%= parset.label param.name %&gt; &lt;%= parset.text_field :value, class: &#39;form-control&#39; %&gt; &lt;% end %&gt; &lt;% end %&gt; Now I have &lt;label for=&quot;device_parsets_attributes_0_par1&quot;&gt;Par1&lt;/label&gt; &lt;input class=&quot;form-control&quot; type=&quot;text&quot; value=&quot;12345&quot; name=&quot;device[parsets_attributes][0][value]&quot; id=&quot;device_parsets_attributes_0_value&quot;&gt; &lt;label for=&quot;device_parsets_attributes_0_par2&quot;&gt;Par2&lt;/label&gt; &lt;input class=&quot;form-control&quot; type=&quot;text&quot; value=&quot;12345&quot; name=&quot;device[parsets_attributes][0][value]&quot; id=&quot;device_parsets_attributes_0_value&quot;&gt;"}], "owner": {"reputation": 1, "user_id": 8981858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-px1i5tmNYP4/AAAAAAAAAAI/AAAAAAAAATA/kd8Ujzvw55Q/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/8981858/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511295666, "creation_date": 1511295666, "question_id": 47422006, "link": "https://stackoverflow.com/questions/47422006/dynamic-form-fields-on-rails", "title": "Dynamic form fields on Rails", "body": "<p>I'm starting to programming on Ruby on Rails and I need some help.</p>\n\n<p>I have some models:</p>\n\n<pre><code>class Device &lt; ApplicationRecord\n  has_and_belongs_to_many :categories\n  has_many :parsets\n  has_many :parameters, -&gt; { select('parameters.*, parsets.*') }, through: :parsets\n  accepts_nested_attributes_for :parameters\nend\n\nclass Category &lt; ApplicationRecord\n  has_and_belongs_to_many :devices, dependent: :destroy\n  has_and_belongs_to_many :parameters\n  validates :name, presence: true\nend\n\nclass Parameter &lt; ApplicationRecord\n  has_and_belongs_to_many :categories, dependent: :destroy\n  has_many :parsets\n  has_many :devices, -&gt; { select('devices.*, parsets.*') }, through: :parsets\nend\n\nclass Parset &lt; ApplicationRecord\n  belongs_to :device\n  belongs_to :parameter\nend\n</code></pre>\n\n<p>Categories may contain some parameters ('parameters' table have columns 'name' and 'value_type'). Each device have a parset ('parsets' table have columns 'device_id', 'parameter_id' and 'value' for parameter value). // Parset - is \"parameters set\".</p>\n\n<p>I want to dynamically create form_fields for device parameters based on chosen categories.</p>\n\n<p>Now I have a piece of code that doesn't work (it is only for test and the logic will be placed in the controller later):</p>\n\n<pre><code>&lt;%= form_for @device do |f| %&gt;\n  # ... some form fields here ...\n\n  &lt;% @allparams = [] %&gt;\n\n  &lt;% @device.categories.each do |cat| %&gt;\n    &lt;% cat.parameters.each do |par| %&gt;\n      &lt;% @allparams.push par %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n\n  &lt;% @allparams.uniq.each do |par| %&gt;\n    &lt;%= f.send(par.value_type.to_sym, par.name) %&gt;&lt;br /&gt;\n  &lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please help me to realise dynamically generated form fields.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1511291579, "post_id": 47420830, "comment_id": 81796000, "body": "The stack trace indicates the problem may be in blogs_helper.rb. What does that file contain? Please edit your answer to show that file."}, {"owner": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1511291587, "post_id": 47420830, "comment_id": 81796006, "body": "It&#39;s hard to tell without seeing more of your code, but you could try removing lines one-by-one from your partial to see which one is giving you the error."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1511292031, "post_id": 47420830, "comment_id": 81796299, "body": "Are you certain that <code>blog.body</code> is a string value and not <code>nil</code>? I would put a <code>binding.pry</code> right before the <code>markdown blog.body</code> call to ensure you are passing in valid data to the method."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1511293807, "post_id": 47420830, "comment_id": 81797362, "body": "@anothermh, I put a <code>binding.pry</code> in front of the <code>markdown blog.body</code> and posted the results."}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1511294277, "post_id": 47420830, "comment_id": 81797603, "body": "Great, now start debugging until you get to the problematic line of code \ud83d\ude04 I recommend <a href=\"https://github.com/deivid-rodriguez/pry-byebug\" rel=\"nofollow noreferrer\">pry-byebug</a> for access to commands like <code>next</code> to step through."}, {"owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "reply_to_user": {"reputation": 4243, "user_id": 4638378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pGqPN.png?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4638378/brian"}, "edited": false, "score": 0, "creation_date": 1511313545, "post_id": 47420830, "comment_id": 81805643, "body": "I would follow what @Brian suggested and uncomment the code line by line  as suggested by the stack trace in <code>blogs_helper.rb</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "edited": false, "score": 0, "creation_date": 1511313683, "post_id": 47420830, "comment_id": 81805682, "body": "I am doing this now because I tried <code>Pry</code> and it has not provided anything useful for me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "reply_to_user": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "edited": false, "score": 0, "creation_date": 1511313926, "post_id": 47420830, "comment_id": 81805759, "body": "@Daniel, when I commented out <code>CodeRay.scan(code, language).div</code>, the blog page worked fine again. Then I uncommented again and it seems to work fine again. So it seems coderay gem is the culprit here."}], "answers": [{"tags": [], "owner": {"reputation": 8754, "user_id": 6719819, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/HmF9I.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6719819/daniel"}, "is_accepted": true, "score": 0, "last_activity_date": 1511320499, "last_edit_date": 1511320499, "creation_date": 1511314664, "answer_id": 47425498, "question_id": 47420830, "link": "https://stackoverflow.com/questions/47420830/how-do-i-begin-to-troubleshoot-symbol-or-string-expected-but-nilclass-given/47425498#47425498", "title": "How do I begin to troubleshoot Symbol or String expected, but nilClass given?", "body": "<p>If you are unable to resolve this utilizing <code>pry</code>, then take a look at the stack trace which indicates the problem to be in blogs_helper.rb</p>\n\n<pre><code>2017-11-21T19:04:10.635268+00:00 app[web.1]: F, [2017-11-21T19:04:10.635198 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072] app/helpers/blogs_helper.rb:8:in `block_code'\n</code></pre>\n\n<p>Comment out the code on line 8 and also the code indicated here:</p>\n\n<pre><code>2017-11-21T19:04:10.634747+00:00 app[web.1]: F, [2017-11-21T19:04:10.634675 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072] ActionView::Template::Error (Symbol or String expected, but NilClass given.):\n2017-11-21T19:04:10.635079+00:00 app[web.1]: F, [2017-11-21T19:04:10.635014 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072]     4:\n2017-11-21T19:04:10.635081+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     5:     &lt;%= render partial: 'blogs/admin_actions', locals: {blog: blog} %&gt;\n2017-11-21T19:04:10.635082+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     6:\n2017-11-21T19:04:10.635083+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     7:     &lt;p&gt;&lt;%= markdown blog.body %&gt;&lt;/p&gt;\n2017-11-21T19:04:10.635083+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     8:\n2017-11-21T19:04:10.635084+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     9:  &lt;/div&gt;&lt;!-- /.blog-post --&gt;\n</code></pre>\n\n<p>Through a process of elimination via commenting out code, you should be able to narrow down the problem with your code.</p>\n\n<p>In other words, since <code>pry</code> did not seem to work for you, then the next step was to implement delta debugging manually to solve this. Basically, commenting out chunks of code until you can work out what part of the code is causing the failure. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8359832"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 47425498, "answer_count": 1, "score": 1, "last_activity_date": 1511320499, "creation_date": 1511291250, "last_edit_date": 1511294926, "question_id": 47420830, "link": "https://stackoverflow.com/questions/47420830/how-do-i-begin-to-troubleshoot-symbol-or-string-expected-but-nilclass-given", "title": "How do I begin to troubleshoot Symbol or String expected, but nilClass given?", "body": "<p>I have a Ruby on Rails application that is in production and the blog page only is getting a 500 error. The Heroku log files say this:</p>\n\n<pre><code>017-11-21T19:04:10.618353+00:00 app[web.1]: D, [2017-11-21T19:04:10.618254 #4] DEBUG -- : [9091d983-bc39-4f64-b86e-c388e3893072]    (0.9ms)  SELECT COUNT(*) FROM \"blogs\"\n2017-11-21T19:04:10.628750+00:00 app[web.1]: D, [2017-11-21T19:04:10.628603 #4] DEBUG -- : [9091d983-bc39-4f64-b86e-c388e3893072]   Blog Load (1.5ms)  SELECT  \"blogs\".* FROM \"blogs\" ORDER BY created_at DESC LIMIT $1 OFFSET $2  [[\"LIMIT\", 5], [\"OFFSET\", 0]]\n2017-11-21T19:04:10.631373+00:00 app[web.1]: I, [2017-11-21T19:04:10.631297 #4]  INFO -- : [9091d983-bc39-4f64-b86e-c388e3893072]   Rendered blogs/_admin_actions.html.erb (0.9ms)\n2017-11-21T19:04:10.632644+00:00 app[web.1]: I, [2017-11-21T19:04:10.632567 #4]  INFO -- : [9091d983-bc39-4f64-b86e-c388e3893072]   Rendered collection of blogs/_blog.html.erb [5 times] (3.1ms)\n2017-11-21T19:04:10.632805+00:00 app[web.1]: I, [2017-11-21T19:04:10.632739 #4]  INFO -- : [9091d983-bc39-4f64-b86e-c388e3893072]   Rendered blogs/index.html.erb within layouts/blog (16.1ms)\n2017-11-21T19:04:10.633090+00:00 app[web.1]: I, [2017-11-21T19:04:10.633020 #4]  INFO -- : [9091d983-bc39-4f64-b86e-c388e3893072] Completed 500 Internal Server Error in 24ms (ActiveRecord: 3.9ms)\n2017-11-21T19:04:10.634643+00:00 app[web.1]: F, [2017-11-21T19:04:10.634573 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072]\n2017-11-21T19:04:10.634747+00:00 app[web.1]: F, [2017-11-21T19:04:10.634675 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072] ActionView::Template::Error (Symbol or String expected, but NilClass given.):\n2017-11-21T19:04:10.635079+00:00 app[web.1]: F, [2017-11-21T19:04:10.635014 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072]     4:\n2017-11-21T19:04:10.635081+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     5:     &lt;%= render partial: 'blogs/admin_actions', locals: {blog: blog} %&gt;\n2017-11-21T19:04:10.635082+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     6:\n2017-11-21T19:04:10.635083+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     7:     &lt;p&gt;&lt;%= markdown blog.body %&gt;&lt;/p&gt;\n2017-11-21T19:04:10.635083+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     8:\n2017-11-21T19:04:10.635084+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072]     9:  &lt;/div&gt;&lt;!-- /.blog-post --&gt;\n2017-11-21T19:04:10.635166+00:00 app[web.1]: F, [2017-11-21T19:04:10.635106 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072]\n2017-11-21T19:04:10.635268+00:00 app[web.1]: F, [2017-11-21T19:04:10.635198 #4] FATAL -- : [9091d983-bc39-4f64-b86e-c388e3893072] app/helpers/blogs_helper.rb:8:in `block_code'\n2017-11-21T19:04:10.635270+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072] app/helpers/blogs_helper.rb:23:in `render'\n2017-11-21T19:04:10.635271+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072] app/helpers/blogs_helper.rb:23:in `markdown'\n2017-11-21T19:04:10.635272+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072] app/views/blogs/_blog.html.erb:7:in `_app_views_blogs__blog_html_erb___2264044015187904428_50852620'\n2017-11-21T19:04:10.635273+00:00 app[web.1]: [9091d983-bc39-4f64-b86e-c388e3893072] app/views/blogs/index.html.erb:5:in `_app_views_blogs_index_html_erb__3065153368905289675_52150720'\n2017-11-21T19:04:10.806557+00:00 heroku[router]: at=info method=GET path=\"/favicon.ico\" host=dancortes-portfolio.herokuapp.com request_id=4d778605-235a-4a14-9d31-ab7c89f35015 fwd=\"69.141.168.126\" dyno=web.1 connect=0ms service=1ms status=200 bytes=143 protocol=https\n</code></pre>\n\n<p>A colleague says that there must be a syntax error in _admin_actions.html.erb:</p>\n\n<pre><code>&lt;% if logged_in?(:site_admin) %&gt;\n    &lt;nav class=\"breadcrumb blogcrumb\"&gt;\n        &lt;%= link_to fa_icon('file-text'), toggle_status_blog_path(blog), style: blog_status_color(blog) %&gt; \n        &lt;%= link_to fa_icon('pencil-square-o'), edit_blog_path(blog) %&gt; \n        &lt;%= link_to fa_icon('trash'), blog, method: :delete, data: { confirm: 'Are you sure?' } %&gt;\n    &lt;/nav&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I do not see a syntax error here, I did not even touch the code when this happened. Initially, I thought it was an error in the markdown of one of the blogs, but I have since deleted the blog and I still get a 500 error for the blog page only and only when logged in as admin.</p>\n\n<p>I have edited this post to display the app/helpers/blogs_helper.rb:</p>\n\n<pre><code>module BlogsHelper\n    def gravatar_helper user\n        image_tag \"https://www.gravatar.com/avatar/#{Digest::MD5.hexdigest(user.email)}\", width: 60\n    end\n\n    class CodeRayify &lt; Redcarpet::Render::HTML\n        def block_code(code, language)\n            CodeRay.scan(code, language).div\n        end\n    end\n\n    def markdown(text)\n        coderayify = CodeRayify.new(filter_html: true, hard_wrap: true)\n\n        options = {\n            fenced_code_blocks: true,\n            no_intra_emphasis: true,\n            autolink: true,\n            lax_html_blocks: true,\n        }\n\n        markdown_to_html = Redcarpet::Markdown.new(coderayify, options)\n        markdown_to_html.render(text).html_safe\n    end\n\n    def blog_status_color blog\n        'color: red;' if blog.draft?\n    end\nend\n</code></pre>\n\n<p>I implemented debugging with Pry and this was the result:</p>\n\n<pre><code> 3:     &lt;p class=\"blog-post-meta\"&gt;Published &lt;%= distance_of_time_in_words(blog.created_at, Time.now) %&gt; ago&lt;/a&gt;&lt;/p&gt;\n     4:\n     5:     &lt;%= render partial: 'blogs/admin_actions', locals: {blog: blog} %&gt;\n     6:\n     7:     &lt;% binding.pry %&gt;\n =&gt;  8:\n     9:     &lt;p&gt;&lt;%= markdown blog.body %&gt;&lt;/p&gt;\n    10:\n    11:  &lt;/div&gt;&lt;!-- /.blog-post --&gt;\n\n[1] pry(#&lt;#&lt;Class:0x007fbc007b6880&gt;&gt;)&gt; blog\n=&gt; #&lt;Blog:0x007fbc0b4d86d0\n id: 10,\n title: \"My Blog Post 9\",\n body:\n  \"Gluten-free pug cloud bread raclette.\\r\\n\\t\\tSucculents intelligentsia banjo, selfies pork\\r\\n\\t\\tbelly mixtape selvage hexagon DIY try-hard\\r\\n\\t\\tdistillery 90's art party kombucha bicycle\\r\\n\\t\\trights. **Pour-over fashion** axe poutine tumblr 3\\r\\n\\t\\twolf moon franzen, fam plaid bespoke ethical\\r\\n\\t\\tramps post-ironic ugh dreamcatcher fanny pack.\\r\\n\\t\\tYuccie salvia unicorn, yr viral kogi air plant\\r\\n\\t\\tthundercats sartorial kickstarter prism blog\\r\\n\\t\\tsubway tile ugh. Kinfolk kogi VHS, paleo narwhal\\r\\n\\t\\tshabby chic man braid flannel. Selfies stumptown\\r\\n\\t\\tvenmo copper mug tousled four dollar toast.\\r\\n\\t\\tAffogato enamel pin vape whatever.\",\n created_at: Mon, 02 Oct 2017 19:38:05 UTC +00:00,\n updated_at: Wed, 04 Oct 2017 13:20:53 UTC +00:00,\n slug: \"my-blog-post-9\",\n status: \"draft\",\n topic_id: 3&gt;\n[2] pry(#&lt;#&lt;Class:0x007fbc007b6880&gt;&gt;)&gt; params\n=&gt; &lt;ActionController::Parameters {\"controller\"=&gt;\"blogs\", \"action\"=&gt;\"index\"} permitted: false&gt;\n</code></pre>\n\n<p>Then with binding.pry inside the show action of the blogs_controller.rb:</p>\n\n<pre><code>def show\n    binding.pry\n    if logged_in?(:site_admin) || @blog.published?\n      @blog = Blog.includes(:comments).friendly.find(params[:id])\n      @comment = Comment.new\n\n      @page_title = @blog.title\n      @seo_keywords = @blog.body\n    else\n      redirect_to blogs_path, notice: \"You are not authorized to access this page.\"\n    end\n  end\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code> 3:     &lt;p class=\"blog-post-meta\"&gt;Published &lt;%= distance_of_time_in_words(blog.created_at, Time.now) %&gt; ago&lt;/a&gt;&lt;/p&gt;\n    4:\n    5:     &lt;%= render partial: 'blogs/admin_actions', locals: {blog: blog} %&gt;\n    6:\n    7:     &lt;p&gt;&lt;%= markdown blog.body %&gt;&lt;/p&gt;\n =&gt; 8:\n    9:  &lt;/div&gt;&lt;!-- /.blog-post --&gt;\n\n[1] pry(#&lt;#&lt;Class:0x007fbc007b6880&gt;&gt;)&gt; @blog\n=&gt; nil\n</code></pre>\n\n<p>So does that mean the blogs are not being set?</p>\n\n<p>Next, I tried placing <code>binding.pry</code> here:</p>\n\n<pre><code>def index\n    binding.pry\n    if logged_in?(:site_admin)\n      @blogs = Blog.recent.page(params[:page]).per(5)\n    else\n      @blogs = Blog.published.recent.page(params[:page]).per(5)\n    end\n    @page_title = \"Portfolio Blog\"\n  end\n</code></pre>\n\n<p>Not sure if the problem is in the index action, but I decided to add index action to <code>before_action</code>:</p>\n\n<pre><code>class BlogsController &lt; ApplicationController\n  before_action :set_blog, only: [:index, :show, :edit, :update, :destroy, :toggle_status]\n  before_action :set_sidebar_topics, except: [:update, :create, :destroy, :toggle_status]\n  layout \"blog\"\n  access all: [:show, :index], user: {except: [:destroy, :new, :create, :update, :edit, :toggle_status]}, site_admin: :all\n</code></pre>\n\n<p>Now I get a 404 error, stating:</p>\n\n<pre><code>ActiveRecord::RecordNotFound (Couldn't find Blog without an ID):\n</code></pre>\n\n<p>So I would like to check in with you guys and see if it even looks like I am in the ballpark here.</p>\n"}, {"tags": ["ruby", "swagger"], "answers": [{"comments": [{"owner": {"reputation": 6925, "user_id": 320036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/CdvdX.jpg?s=128&g=1", "display_name": "z0r", "link": "https://stackoverflow.com/users/320036/z0r"}, "edited": false, "score": 3, "creation_date": 1561597839, "post_id": 47422863, "comment_id": 100120069, "body": "Which docs? It&#39;s not clear which version you&#39;re referring to. Please provide a link."}], "tags": [], "owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "is_accepted": false, "score": 4, "last_activity_date": 1511298941, "creation_date": 1511298941, "answer_id": 47422863, "question_id": 47420755, "link": "https://stackoverflow.com/questions/47420755/how-to-pass-multi-value-query-params-in-swagger/47422863#47422863", "title": "how to pass multi value query params in swagger", "body": "<p>From the docs:</p>\n\n<pre><code>parameters:\n- name: id\n  in: path\n  description: ID of pet to use\n  required: true\n  schema:\n    type: array\n    style: simple\n    items:\n      type: string\n</code></pre>\n\n<p>You have to define the parameter as array.  </p>\n"}, {"comments": [{"owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1511302343, "post_id": 47422957, "comment_id": 81801986, "body": "one question, when i try to pass a blank value for page_id it doesnt return data for blank value. do you know why? <code>?page_id[]=def&amp;page_id[]=%22%20%22</code>"}, {"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "reply_to_user": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1511303658, "post_id": 47422957, "comment_id": 81802605, "body": "@mike <code>%22%20%22</code> is not really a &quot;blank&quot; value, it&#39;s <code>&quot; &quot;</code> (space inside quotes) - is this a valid value that your server expects?"}, {"owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1511305318, "post_id": 47422957, "comment_id": 81803229, "body": "Yes page_id can also be empty, hence passed <code>&quot; &quot;</code>."}, {"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "reply_to_user": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "edited": false, "score": 0, "creation_date": 1511339902, "post_id": 47422957, "comment_id": 81814636, "body": "It probably depends on how the server is implemented - does it expect <code>page_id[]=&quot; &quot;</code> or maybe <code>page_id[]=</code> (no value)? If you wrote the server, look into your code. If it&#39;s a third-party API, check its documentation."}], "tags": [], "owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "is_accepted": true, "score": 13, "last_activity_date": 1511303295, "last_edit_date": 1511303295, "creation_date": 1511299359, "answer_id": 47422957, "question_id": 47420755, "link": "https://stackoverflow.com/questions/47420755/how-to-pass-multi-value-query-params-in-swagger/47422957#47422957", "title": "how to pass multi value query params in swagger", "body": "<p>You are almost there. Name the parameter <code>page_id[]</code>, make it <code>type: array</code> and use <code>collectionFormat: multi</code>:</p>\n\n\n\n<pre><code>      parameters:\n        - name: page_id[]\n          in: query\n          description: some description\n          required: false\n          type: array\n          items:\n            type: string   # or type: integer or whatever the type is \n          collectionFormat: multi\n</code></pre>\n\n<p>Note that the requests will be sent with the <code>[</code> and <code>]</code> characters percent-encoded as <code>%5B</code> and <code>%5D</code>, because they are reserved characters according to <a href=\"https://tools.ietf.org/html/rfc3986#section-2.2\" rel=\"noreferrer\">RFC 3986</a>.</p>\n\n<pre><code>http://example.com/pages?page_id%5B%5D=123&amp;page_id%5B%5D=456\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10875, "favorite_count": 0, "accepted_answer_id": 47422957, "answer_count": 2, "score": 11, "last_activity_date": 1559822016, "creation_date": 1511290945, "last_edit_date": 1559822016, "question_id": 47420755, "link": "https://stackoverflow.com/questions/47420755/how-to-pass-multi-value-query-params-in-swagger", "title": "how to pass multi value query params in swagger", "body": "<p>I have following service in swagger.yml. The service is written so that page_id can be passed multiple times. e.g <code>/pages?page_id[]=123&amp;page_id[]=542</code></p>\n\n<p>I checked this link <a href=\"https://swagger.io/specification/\" rel=\"noreferrer\">https://swagger.io/specification/</a> but couldnt understand how could i update yml so i could pass id multiple times.</p>\n\n<p>I see that i have to set <code>collectionFormat</code> but dont know how.</p>\n\n<p>I tried updating it like below but no luck <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md\" rel=\"noreferrer\">https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md</a>. </p>\n\n<p>it generates url like '<a href=\"http://localhost:0000/pages?page_id=123%2C%20542\" rel=\"noreferrer\">http://localhost:0000/pages?page_id=123%2C%20542</a>`</p>\n\n<pre><code> '/pages':\n    get:\n      tags:\n        - \n      summary: get the list of pages\n      operationId: getPages\n      produces:\n        - application/json\n      parameters:\n        - name: page_id\n          in: query\n          description: some description\n          required: false\n          type: string\n          collectionFormat: multi\n        - name: page_detail\n          in: query\n          description: some description\n          required: false\n          type: string\n      responses:\n        '200':\n          description: OK\n        '401':\n          description: Authentication Failed\n        '404':\n          description: Not Found\n        '503':\n          description: Service Not Available\n</code></pre>\n"}, {"tags": ["sql", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 3, "last_activity_date": 1511290896, "creation_date": 1511290896, "answer_id": 47420738, "question_id": 47420585, "link": "https://stackoverflow.com/questions/47420585/what-does-type-translation-in-sqlite3-gem-do/47420738#47420738", "title": "What does type translation in SQLite3 gem do?", "body": "<p>From this link: <a href=\"https://github.com/sparklemotion/sqlite3-ruby/blob/master/lib/sqlite3/database.rb\" rel=\"nofollow noreferrer\">https://github.com/sparklemotion/sqlite3-ruby/blob/master/lib/sqlite3/database.rb</a></p>\n\n<p>\"...The Database class provides type translation services as well, by which the SQLite3 data types (which are all represented as strings) may be converted into their corresponding types (as defined in the schemas for their tables). This translation only occurs when querying data from the database--insertions and updates are all still typeless...\"</p>\n\n<p>This may help too: <a href=\"https://sqlite.org/datatype3.html\" rel=\"nofollow noreferrer\">https://sqlite.org/datatype3.html</a> as it explains how data types are handled in sqlite3. </p>\n"}, {"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 3, "last_activity_date": 1511290919, "creation_date": 1511290919, "answer_id": 47420746, "question_id": 47420585, "link": "https://stackoverflow.com/questions/47420585/what-does-type-translation-in-sqlite3-gem-do/47420746#47420746", "title": "What does type translation in SQLite3 gem do?", "body": "<p>The answer can be found by <a href=\"https://github.com/sparklemotion/sqlite3-ruby/blob/master/lib/sqlite3/database.rb#L123-L131\" rel=\"nofollow noreferrer\">examining the source code</a>:</p>\n\n<pre><code># Return the type translator employed by this database instance. Each\n# database instance has its own type translator; this allows for different\n# type handlers to be installed in each instance without affecting other\n# instances. Furthermore, the translators are instantiated lazily, so that\n# if a database does not use type translation, it will not be burdened by\n# the overhead of a useless type translator. (See the Translator class.)\n</code></pre>\n\n<p>And when you look at the <a href=\"https://github.com/sparklemotion/sqlite3-ruby/blob/master/lib/sqlite3/translator.rb#L6-L9\" rel=\"nofollow noreferrer\"><code>Translator</code> class</a>:</p>\n\n<pre><code># The Translator class encapsulates the logic and callbacks necessary for\n# converting string data to a value of some specified type. Every Database\n# instance may have a Translator instance, in order to assist in type\n# translation (Database#type_translation).\n</code></pre>\n\n<p>Therefore, when <code>type_translation = true</code>, sqlite3 will use that database's type translator to assist with serializing data between data types.</p>\n"}], "owner": {"reputation": 1068, "user_id": 2712925, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AC3j5.jpg?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/2712925/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 47420746, "answer_count": 2, "score": 1, "last_activity_date": 1511348400, "creation_date": 1511290381, "last_edit_date": 1511348400, "question_id": 47420585, "link": "https://stackoverflow.com/questions/47420585/what-does-type-translation-in-sqlite3-gem-do", "title": "What does type translation in SQLite3 gem do?", "body": "<p><code>type_translation = true</code> in the initialize method isn't documented on the gem's website. What does it do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "html-safe"], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 3, "last_activity_date": 1511290395, "creation_date": 1511290395, "answer_id": 47420588, "question_id": 47420477, "link": "https://stackoverflow.com/questions/47420477/how-to-show-properly-using-rspec-the-double-quote-marks/47420588#47420588", "title": "how to show properly using Rspec the Double Quote Mark&#39;s &quot; &quot;", "body": "<p>Single quote the string:</p>\n\n<pre><code>expect(page).to have_content('You are not allowed to upload \"txt\" files, allowed types: jpg, jpeg, gif, png')\n</code></pre>\n\n<p>There are <a href=\"https://stackoverflow.com/questions/6395288/double-vs-single-quotes\">other answers</a> that better explain the details of single quotes vs double quotes.</p>\n"}, {"comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1511291749, "post_id": 47420799, "comment_id": 81796118, "body": "You don&#39;t need <code>&quot;#{str}&quot;</code>. Use this instead: <code>expect(page).to have_content(str)</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511298275, "post_id": 47420799, "comment_id": 81799867, "body": "Why would you not have just accepted the answer given rather than essentially repeating it and then giving credit"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1511305085, "post_id": 47420799, "comment_id": 81803179, "body": "Not everyone knows <a href=\"https://stackoverflow.com/help/someone-answers\">what to do when someone answers a question</a> but hopefully @rld will read it for their next question."}, {"owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "edited": false, "score": 0, "creation_date": 1511311469, "post_id": 47420799, "comment_id": 81805097, "body": "The thing was I was trying to do the code to pass, and when I get it I saw the answer of the anothermh. Nothing about the help of him but I like more the mine and I want to do quickly because of the hour and I just put here for for share, it&#39;s a one more answer for help others. Anyway thank&#39;s for show me this I will read."}, {"owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "edited": false, "score": 0, "creation_date": 1511312001, "post_id": 47420799, "comment_id": 81805229, "body": "I&#39;m sorry guys I was in the library and because of the time(the library closing) I don&#39;t vote up on the answer of the anothermh, I forget. And I was trying to pass the code and so when I get to pass I post my answer, for share. And yes, I&#39;m never readed that before. Anyway thank you for the help."}], "tags": [], "owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "is_accepted": false, "score": 1, "last_activity_date": 1511291140, "creation_date": 1511291140, "answer_id": 47420799, "question_id": 47420477, "link": "https://stackoverflow.com/questions/47420477/how-to-show-properly-using-rspec-the-double-quote-marks/47420799#47420799", "title": "how to show properly using Rspec the Double Quote Mark&#39;s &quot; &quot;", "body": "<p>I put this and work's:</p>\n\n<pre><code>str = \"You are not allowed to upload \\\"txt\\\" files, allowed types: jpg, jpeg, gif, png\"\nexpect(page).to have_content \"#{str}\"\n</code></pre>\n\n<p>thank's @anothermh</p>\n"}], "owner": {"reputation": 1439, "user_id": 2993674, "user_type": "registered", "accept_rate": 6, "profile_image": "https://i.stack.imgur.com/TRxII.jpg?s=128&g=1", "display_name": "rld", "link": "https://stackoverflow.com/users/2993674/rld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 47420588, "answer_count": 2, "score": 1, "last_activity_date": 1511291140, "creation_date": 1511290002, "last_edit_date": 1511290099, "question_id": 47420477, "link": "https://stackoverflow.com/questions/47420477/how-to-show-properly-using-rspec-the-double-quote-marks", "title": "how to show properly using Rspec the Double Quote Mark&#39;s &quot; &quot;", "body": "<p>I'm using Rspec and the gem file_validators for testing and I need to put properly the output of the Quote Marks (\"txt\") like theses:</p>\n\n<pre><code>expect(page).to have_content expect(page).to have_content \"You are not allowed to upload \\\"txt\\\" files, allowed types: jpg, jpeg, gif, png\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>double_quotes = \"&amp;quot;txt&amp;quot;\".html_safe\nexpect(page).to have_content expect(page).to have_content \"You are not allowed to upload #{double_quotes} files, allowed types: jpg, jpeg, gif, png\"\n</code></pre>\n\n<p>But I'm having a failure error for show this:</p>\n\n<pre><code>Failure/Error: expect(page).to have_content   expect(page).to have_content \"You are not allowed to upload #{double_quotes} files, allowed types: jpg, jpeg, gif, png\"\n   expected to find text \"You are not allowed to upload &amp;quot;txt&amp;quot; files, allowed types: jpg, jpeg, gif, png\" in \"News CityToggle navigationHomeAdminSigned in as rubie@fayvon.netSign out\u00d7Post has not been created.New Post* TitleSubtitleFileYou are not allowed to upload \\\"txt\\\" files, allowed types: jpg, jpeg, gif, png* Content It will serve for show images about the posts.\"\n</code></pre>\n\n<p>Someone can help me with this problem?\nThe entire output needs to be like these:</p>\n\n<pre><code>You are not allowed to upload \"rtf\" files, allowed types: jpg, jpeg, gif, png\n</code></pre>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511290017, "post_id": 47420247, "comment_id": 81795091, "body": "Maybe your <code>PATH</code> isn&#39;t set like it used to be?"}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511342837, "post_id": 47420247, "comment_id": 81816372, "body": "Hi tadman, thanks, but in this case it actually looks like the <i>irb</i> shellscript wrapper hasn&#39;t been added to <code>~&#47;.rvm&#47;rubies&#47;ruby-2.4.1&#47;bin&#47;irb</code>, and the same with the other commands there.  However it has been for <i>ri</i>, <i>rdoc</i> and <i>rake</i>, so I&#39;m not sure if a <code>$PATH</code> change would affect this?"}], "owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511289101, "creation_date": 1511289101, "question_id": 47420247, "link": "https://stackoverflow.com/questions/47420247/rvm-binstubs-not-working-for-irb", "title": "rvm binstubs not working for irb?", "body": "<p>Using latest version of RVM (1.29.3) and Ruby (2.4.1) under macOS High Sierra, <code>gem regenerate_binstubs</code> was applied, and though this works for ri, rdoc, and rake, it doesn't seem to have worked for other commands, including <code>irb</code>.</p>\n\n<p>It should do though, shouldn't it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "time"], "comments": [{"owner": {"reputation": 1606, "user_id": 3137698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1819a8d2ac84a22c29b910b38dd4686f?s=128&d=identicon&r=PG", "display_name": "zinovyev", "link": "https://stackoverflow.com/users/3137698/zinovyev"}, "edited": false, "score": 0, "creation_date": 1511289097, "post_id": 47420198, "comment_id": 81794606, "body": "I don&#39;t think your format is completely worng. This works for me:  [4] pry(main)&gt; Time.new &#39;11-21-2017 3:00PM -0500&#39; =&gt; 0011-01-01 00:00:00 +0230"}, {"owner": {"reputation": 1606, "user_id": 3137698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1819a8d2ac84a22c29b910b38dd4686f?s=128&d=identicon&r=PG", "display_name": "zinovyev", "link": "https://stackoverflow.com/users/3137698/zinovyev"}, "edited": false, "score": 0, "creation_date": 1511289150, "post_id": 47420198, "comment_id": 81794639, "body": "It can be something specifically to your version of ror maybe"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1511298065, "post_id": 47420198, "comment_id": 81799739, "body": "month-day-year is pretty unusual..."}], "answers": [{"tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": false, "score": 2, "last_activity_date": 1511329490, "last_edit_date": 1511329490, "creation_date": 1511289376, "answer_id": 47420318, "question_id": 47420198, "link": "https://stackoverflow.com/questions/47420198/time-parse-11-21-2017-300pm-0500-doesnt-work-ruby-rails/47420318#47420318", "title": "Time.parse &quot;11-21-2017 3:00PM -0500&quot; doesn&#39;t work - Ruby/Rails", "body": "<p>Time.parse failing to identify format of time you are providing, better you should go ahead with using</p>\n\n<pre><code>   Time.strptime(\"11-21-2017 3:00PM -0500\", \"%m-%d-%Y %I:%M%p %z\")\n</code></pre>\n\n<p>This accepts both time and format as arguments.  For API documentation refer the link <a href=\"https://ruby-doc.org/stdlib-2.1.1/libdoc/time/rdoc/Time.html#method-c-strptime\" rel=\"nofollow noreferrer\">https://ruby-doc.org/stdlib-2.1.1/libdoc/time/rdoc/Time.html#method-c-strptime</a></p>\n\n<p>I hope this helps you.</p>\n"}, {"comments": [{"owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "edited": false, "score": 0, "creation_date": 1511371817, "post_id": 47420411, "comment_id": 81836338, "body": "Interestingly, this only works with the format <code>3:00PM</code>.  If you use <code>3:00 PM</code> it will cause an invalid date error."}], "tags": [], "owner": {"reputation": 155, "user_id": 8733981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSUg7.png?s=128&g=1", "display_name": "rks", "link": "https://stackoverflow.com/users/8733981/rks"}, "is_accepted": true, "score": 3, "last_activity_date": 1511289707, "creation_date": 1511289707, "answer_id": 47420411, "question_id": 47420198, "link": "https://stackoverflow.com/questions/47420198/time-parse-11-21-2017-300pm-0500-doesnt-work-ruby-rails/47420411#47420411", "title": "Time.parse &quot;11-21-2017 3:00PM -0500&quot; doesn&#39;t work - Ruby/Rails", "body": "<p>I can reproduce your out of range issue.</p>\n\n<p>You need to provide format of your date string.</p>\n\n<p>Following code works:</p>\n\n<pre><code>DateTime.strptime(\"11-21-2017 3:00PM -0500\", \"%m-%d-%Y %I:%M%p %z\")\n</code></pre>\n"}], "owner": {"reputation": 8066, "user_id": 4272549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/1hvwh.jpg?s=128&g=1", "display_name": "123", "link": "https://stackoverflow.com/users/4272549/123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47420411, "answer_count": 2, "score": 0, "last_activity_date": 1511329490, "creation_date": 1511288919, "question_id": 47420198, "link": "https://stackoverflow.com/questions/47420198/time-parse-11-21-2017-300pm-0500-doesnt-work-ruby-rails", "title": "Time.parse &quot;11-21-2017 3:00PM -0500&quot; doesn&#39;t work - Ruby/Rails", "body": "<p>I'm trying to parse a string into a Time/DateTime object.  This usually is pretty robust, but the particular format I'm working with is running into problems.  I have the string <code>\"11-21-2017 3:00PM -0500\"</code> and when running <code>Time.parse</code> I get and <code>argument out of range</code> error.  If I try to use something like <code>.to_datetime</code>, I get an error <code>invalid date</code>.</p>\n\n<p>Is there something specifically wrong with my format, or is there something else going on here?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1511302119, "creation_date": 1511302119, "answer_id": 47423577, "question_id": 47419983, "link": "https://stackoverflow.com/questions/47419983/how-do-i-get-this-each-loop-to-apply-to-every-item/47423577#47423577", "title": "How do I get this each loop to apply to every item?", "body": "<p>Well your <code>ones.each do</code> goes through the <code>ones</code> but ignores them, since your block doesn't have parameters. You essentially just use <code>ones</code> to determine <strong>how often</strong> to run the block.</p>\n\n<p>Your</p>\n\n<pre><code>ri = ones[0][0]\nci = ones[0][1]\nones.each do \n</code></pre>\n\n<p>should be</p>\n\n<pre><code>ones.each do |ri, ci|\n</code></pre>\n\n<p>I'm surprised you got <code>find_ones</code> right (where you do something similar) but do something so strange in <code>transform</code> (setting <code>ri</code> and <code>ci</code> like that).</p>\n"}], "owner": {"reputation": 1, "user_id": 8981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30846935d7f90ed393c6e629775f0b73?s=128&d=identicon&r=PG&f=1", "display_name": "Iann", "link": "https://stackoverflow.com/users/8981374/iann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511302119, "creation_date": 1511288160, "question_id": 47419983, "link": "https://stackoverflow.com/questions/47419983/how-do-i-get-this-each-loop-to-apply-to-every-item", "title": "How do I get this each loop to apply to every item?", "body": "<p>I'm working on a problem called Image Blur. I need to have my code take items (either 1s or 0s) from a 2D array and, for every 1, change the adjacent 0s to 1s. My code thus far does this well to the first 1 that it comes across, but for some reason it does not loop over the others.</p>\n\n<pre><code>class Image\n  def initialize(image)\n    @values = image\n  end\n\n  def find_ones\n    ones = []\n    @values.each_with_index do |row, row_index|\n      row.each_with_index do |pixel, column_index|\n        if pixel == 1\n          coord = [row_index, column_index]\n          ones &lt;&lt; coord\n        end\n        puts \"#{pixel} #{row_index} #{column_index}\" if pixel == 1\n      end\n    end\n    ones\n  end\n\n  def transform\n    ones = find_ones\n    ri = ones[0][0]\n    ci = ones[0][1]\n    ones.each do \n      @values[ri + 1][ci] = 1 if (ri + 1) &lt;= 3\n      @values[ri - 1][ci] = 1 if (ri - 1) &gt;= 0\n      @values[ri][ci + 1] = 1 if (ci + 1) &lt;= 3\n      @values[ri][ci - 1] = 1 if (ci - 1) &gt;= 0\n    end\n  end\n\n\n def output_image\n    @values.each do |row|\n      puts row.join\n    end\n  end\nend\n\n\nimage = Image.new([\n  [0, 0, 0, 1],\n  [0, 0, 0, 0],\n  [0, 0, 0, 0],\n  [0, 1, 0, 0]\n])\n\nimage.transform\nimage.output_image\n</code></pre>\n\n<p>Thanks for the help in advance!</p>\n"}, {"tags": ["ruby", "csv", "matrix"], "answers": [{"tags": [], "owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "is_accepted": true, "score": 1, "last_activity_date": 1511287844, "creation_date": 1511287844, "answer_id": 47419892, "question_id": 47419801, "link": "https://stackoverflow.com/questions/47419801/sum-matrixes-as-numbers-not-strings-ruby/47419892#47419892", "title": "Sum matrixes as numbers not strings ruby", "body": "<p>When you're reading in the CSV, all columns will be strings, so you'll have to manually do the conversion to a number in the code.</p>\n\n<p>If all of the columns of the CSV are intended to be numbers, you can add <code>.map(&amp;:to_i)</code> to the row line. Like this:</p>\n\n<pre><code>CSV.foreach(matrix1) do |row|\n  arr1 &lt;&lt; row.map(&amp;:to_i) # &lt;-- this will turn everything in the row into a number\n  line_count += 1\n  elements_in_line_count =  row.size\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511302952, "post_id": 47420097, "comment_id": 81802298, "body": "Why not <code>map { |cells| cells.reduce(:+) }</code>? :-)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511323571, "post_id": 47420097, "comment_id": 81807937, "body": "@CarySwoveland because of zip before, there are always two elements, here reduce is an overkill."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511325799, "post_id": 47420097, "comment_id": 81808458, "body": "I couldn&#39;t help myself."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1511288580, "creation_date": 1511288580, "answer_id": 47420097, "question_id": 47419801, "link": "https://stackoverflow.com/questions/47419801/sum-matrixes-as-numbers-not-strings-ruby/47420097#47420097", "title": "Sum matrixes as numbers not strings ruby", "body": "<pre><code>[m1, m2].map do |m|\n  CSV.foreach(m).map { |row| row.map(&amp;:to_i) }\nend.reduce do |m1, m2|\n  m1.map.with_index do |row, idx|\n    row.zip(m2[idx]).map { |cell1, cell2| cell1 + cell2 }\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 3, "last_activity_date": 1511288741, "last_edit_date": 1592644375, "creation_date": 1511288741, "answer_id": 47420142, "question_id": 47419801, "link": "https://stackoverflow.com/questions/47419801/sum-matrixes-as-numbers-not-strings-ruby/47420142#47420142", "title": "Sum matrixes as numbers not strings ruby", "body": "<p>When you read in the CSV, by default it reads in all the rows/columns as strings, the Ruby <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/csv/rdoc/CSV.html#Converters\" rel=\"nofollow noreferrer\">CSV</a> class can take an optional parameter to <code>foreach</code> and <code>new</code> and similar methods called <code>:converters</code> that it will use to convert each applicable column. One of the converters it can take is</p>\n<blockquote>\n<p>:integer</p>\n<p>Converts any field Integer() accepts.</p>\n</blockquote>\n<p>So you can also change your code to look like:</p>\n<pre><code>csv_options = { converters: [:integer] }\nCSV.foreach(matrix1, csv_options) do |row|\n# ...\nCSV.foreach(matrix2, csv_options) do |row|\n</code></pre>\n<p>to achieve results similar to calling <code>map(&amp;:to_i)</code> on each row.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1511317574, "creation_date": 1511317574, "answer_id": 47425852, "question_id": 47419801, "link": "https://stackoverflow.com/questions/47419801/sum-matrixes-as-numbers-not-strings-ruby/47425852#47425852", "title": "Sum matrixes as numbers not strings ruby", "body": "<p>As you want to add matrices, consider using Ruby's built-in <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/matrix/rdoc/Matrix.html\" rel=\"nofollow noreferrer\">Matrix</a> class, and the instance method <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/matrix/rdoc/Matrix.html#method-i-2B\" rel=\"nofollow noreferrer\">Matrix#+</a> in particular.</p>\n\n<p>Let's first construct three CSV files.</p>\n\n<pre><code>fname1 = 't1.csv'\nfname2 = 't2.csv'\nfname3 = 't3.csv'\n\nFile.write(fname1, \"1,2\\n3,4\")\n  #=&gt; 7\nFile.write(fname2, \"100,200\\n300,400\")\n  #=&gt; 15\nFile.write(fname3, \"1000,2000\\n3000,4000\")\n  #=&gt; 19\n</code></pre>\n\n<p>We can sum the underlying matrices as follows.</p>\n\n<pre><code>require 'csv'\nrequire 'matrix'\n\nfnames = [fname1, fname2, fname3]\n\nfnames.drop(1).reduce(matrix_from_CSV(fnames.first)) do |t,fname|\n  t + matrix_from_CSV(fname)\nend.to_a\n  #=&gt; [[1101, 2202],\n  #    [3303, 4404]]\n\ndef matrix_from_CSV(fname)\n  Matrix[*CSV.read(fname, converters: [:integer])]\nend\n</code></pre>\n\n<p>I borrowed <code>converters: [:integer]</code> from @Simple's answer. I wasn't aware of that.</p>\n"}], "owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47419892, "answer_count": 4, "score": 1, "last_activity_date": 1511317574, "creation_date": 1511287518, "question_id": 47419801, "link": "https://stackoverflow.com/questions/47419801/sum-matrixes-as-numbers-not-strings-ruby", "title": "Sum matrixes as numbers not strings ruby", "body": "<p>I am trying to sum 2 matrixes from a CSV file\nCurrently, I put them into to arrays and then transform the array into matrixes. However, when I print them, I get concatenated strings not summed integers. </p>\n\n<pre><code>require 'csv'\nrequire 'matrix'\n\nmatrix1 = \"./matrix1.csv\"\nmatrix2 = \"./matrix2.csv\"\n\nline_count = 0\nelements_in_line_count = 0\narr1 = Array.new    #=&gt; []\narr2 = Array.new    #=&gt; []\n\nCSV.foreach(matrix1) do |row|\n  arr1 &lt;&lt; row\n  line_count += 1\n  elements_in_line_count =  row.size\nend\n\nn1 = elements_in_line_count\nm1 = line_count \n\n# find n and m of second matrix \n\nline_count = 0\nelements_in_line_count = 0\n\nCSV.foreach(matrix2) do |row|\n # print row\n   arr2 &lt;&lt; row\n  line_count += 1\n  elements_in_line_count =  row.size\nend\n\nputs Matrix.rows(arr1) + Matrix.rows(arr2)\n</code></pre>\n\n<p>For example, CSV 1 is:</p>\n\n<pre><code>  1,2\n  3,4\n</code></pre>\n\n<p>Same for CSV 2.\nThe output is </p>\n\n<pre><code>Matrix[[11, 22], [33, 44]]\n</code></pre>\n\n<p>But I want it to be [2,4],[6,8]</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "delayed-job", "resque"], "comments": [{"owner": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1511295404, "post_id": 47419543, "comment_id": 81798243, "body": "Does the api in question has an option to push the data to you? Pub/Sub would be nice solution here."}, {"owner": {"reputation": 523, "user_id": 8980988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b92727f9c9f58bb720a08be26e3d3a?s=128&d=identicon&r=PG&f=1", "display_name": "danielsmith1789", "link": "https://stackoverflow.com/users/8980988/danielsmith1789"}, "reply_to_user": {"reputation": 500, "user_id": 1595868, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2106152c457f7df0ef892b6814423cfc?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/1595868/anton"}, "edited": false, "score": 0, "creation_date": 1511296322, "post_id": 47419543, "comment_id": 81798806, "body": "The apis in question cannot push the data to me. I am using various apis to get the price of different products."}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 2549660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955f4b1957878754cfe5056d1a84d03e?s=128&d=identicon&r=PG", "display_name": "Paulius", "link": "https://stackoverflow.com/users/2549660/paulius"}, "is_accepted": false, "score": 0, "last_activity_date": 1511287721, "last_edit_date": 1511287721, "creation_date": 1511287408, "answer_id": 47419767, "question_id": 47419543, "link": "https://stackoverflow.com/questions/47419543/ruby-on-rails-constantly-updating-a-variable/47419767#47419767", "title": "Ruby on Rails constantly updating a variable", "body": "<p>I guess in this case you should use rails cache. Put something like this in your controller:</p>\n\n<pre><code>@price = Rails.cache.fetch('price') do\n  &lt;&lt;Some external query&gt;&gt;\nend\n</code></pre>\n\n<p>you can also configure cache expiration date, by setting <code>expires_in</code> argument, see <a href=\"https://apidock.com/rails/ActiveSupport/Cache/Store/fetch\" rel=\"nofollow noreferrer\">https://apidock.com/rails/ActiveSupport/Cache/Store/fetch</a> for more information.</p>\n\n<p>Regarding using background jobs to update your \"price\" value, you would need to store retrieved data anyways (use some kind of database) and fetch it in your controller.</p>\n"}, {"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 0, "last_activity_date": 1511294106, "creation_date": 1511294106, "answer_id": 47421599, "question_id": 47419543, "link": "https://stackoverflow.com/questions/47419543/ruby-on-rails-constantly-updating-a-variable/47421599#47421599", "title": "Ruby on Rails constantly updating a variable", "body": "<p>That is not how background jobs work. You're right, you have a lot of reading up to do. Think of running an asynchronous job processor like Sidekiq as running an entirely separate app. It shares the same code base as your Rails app but it runs <em>completely separately</em>. If you want these two separate apps to talk to each other then <em>you</em> have to design and write that code.</p>\n\n<p>For example, I would define a cache with reader and writer methods, then have the cache populated when necessary:</p>\n\n<ol>\n<li>someone loads product \"foo\" for the <strong>first</strong> time on your site</li>\n<li>Rails checks the cache and finds it empty</li>\n<li>Rails calls the external service</li>\n<li>Rails saves the external service response to the cache using its writer method</li>\n<li>Rails returns the cached response to the client</li>\n</ol>\n\n<p>The cache would be populated thereafter by Sidekiq:</p>\n\n<ol>\n<li>someone loads product \"foo\" for the <strong>second</strong> time on your site</li>\n<li>Rails checks the cache and finds the cached value from above</li>\n<li>Rails fires a Sidekiq job telling it to refresh the cache</li>\n<li>Rails returns the cached response to the client</li>\n</ol>\n\n<p>Continuing from step 3 above:</p>\n\n<ol>\n<li>Sidekiq checks to see when the cache was last refreshed, and if it was more than <em>x</em> seconds ago then continue, else quit</li>\n<li>Sidekiq calls the external service</li>\n<li>Sidekiq saves the external service response to the cache using its writer method</li>\n</ol>\n\n<p>When the <strong>next</strong> client loads product \"foo\", Rails will read the cache that was updated (or not updated) by Sidekiq.</p>\n\n<p>With this type of system, the cache must be an external store of some kind like a relational database (MySQL, Postgres, Sqlite) or a NoSQL database (Redis, memcache). You cannot use the internal Rails cache because the Rails cache exists only within the memory space of the Rails app, and is <strong>not</strong> readable by Sidekiq. (because Sidekiq runs as a totally separate app)</p>\n"}], "owner": {"reputation": 523, "user_id": 8980988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b92727f9c9f58bb720a08be26e3d3a?s=128&d=identicon&r=PG&f=1", "display_name": "danielsmith1789", "link": "https://stackoverflow.com/users/8980988/danielsmith1789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 47421599, "answer_count": 2, "score": 0, "last_activity_date": 1511299373, "creation_date": 1511286655, "last_edit_date": 1511299373, "question_id": 47419543, "link": "https://stackoverflow.com/questions/47419543/ruby-on-rails-constantly-updating-a-variable", "title": "Ruby on Rails constantly updating a variable", "body": "<p>Currently I am building an application that allows users to place bids on products and admins to approve them. The 'transactions' themselves take place outside of the scope of the application. Currently, users see the price of an asset on the transaction/new page and submit a bid by submitting the form. Admins click a button to approve the bid.</p>\n\n<pre><code>class TransactionsController &lt; ApplicationController\nbefore_action :get_price\n\n  def new\n    @price = get_price\n    @tansaction = Transaction.new\n  end\n\n  ###\n\n  def get_price\n    @price = &lt;&lt;Some External Query&gt;&gt;\n  end\n\n  def approve\n    t = Transaction.find(params[:id])\n    t.status = \"Approved\"\n    t.update!\n  end\n</code></pre>\n\n<p>Obviously this is not ideal. I don't want to query the API every time a user wants to submit a bid. Ideally, I could query this API every 5-10 seconds in the background and use the price in that manner. I have looked at a couple of techniques for running background jobs including delayed_job, sidekiq, and resque. For example in sidekiq I could run something like this:</p>\n\n<pre><code>  #app/workers/price_worker.rb\n  class PriceWorker\n    include Sidekiq::Worker\n\n    def perform(*args)\n      get_price\n    end\n\n    def get_price\n        @price = &lt;&lt;Some External Query&gt;&gt;\n      end\n  end\n\n  #config/initializers/sidekiq.rb\n  schedule_file = \"config/schedule.yml\"\n\n  if File.exists?(schedule_file) &amp;&amp; Sidekiq.server?\n    Sidekiq::Cron::Job.load_from_hash YAML.load_file(schedule_file)\n  end\n\n\n  #config/schedule.yml\n  my_price_job:\n    cron: \"*/10 * * * * * \"\n    class: \"PriceWorker\"\n</code></pre>\n\n<p>That code runs. The problem is I am kind of lost on how to handle the price variable and pass it back to the user from the worker. I have watched the Railscasts episodes for both sidekiq and resque. I have written background workers and jobs that queue and run properly, but I cannot figure out how to implement them into my application. This is the first time I have dealt with background jobs so I have a lot to learn. I have spent sometime researching this issue and it seems like more background jobs are used for longer running tasks like updating db indexes rather than constantly recurring jobs (like an API request every 5 seconds). </p>\n\n<p>So to sum up, What is the proper technique for running a constantly recurring task such as querying an external API in Rails? Any feedback on how to do this properly will be greatly appreciated! Thank you.     </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encoding", "devise"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511285354, "post_id": 47418907, "comment_id": 81792393, "body": "That doesn&#39;t look like an error. What does the complete message say?"}, {"owner": {"reputation": 246, "user_id": 2912833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69a5d516a5a8cf8a8ff8768ec789fcfd?s=128&d=identicon&r=PG&f=1", "display_name": "Arnaldo Jr", "link": "https://stackoverflow.com/users/2912833/arnaldo-jr"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511285393, "post_id": 47418907, "comment_id": 81792421, "body": "Encoding::InvalidByteSequenceError in Devise::Sessions#new &quot;\\xED&quot; followed by &quot;t&quot; on UTF-8"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1511285487, "post_id": 47418907, "comment_id": 81792482, "body": "Someone has tried to create a username with an emoji, and your database does not support this? At a guess."}, {"owner": {"reputation": 246, "user_id": 2912833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69a5d516a5a8cf8a8ff8768ec789fcfd?s=128&d=identicon&r=PG&f=1", "display_name": "Arnaldo Jr", "link": "https://stackoverflow.com/users/2912833/arnaldo-jr"}, "edited": false, "score": 0, "creation_date": 1511285647, "post_id": 47418907, "comment_id": 81792584, "body": "But this happens when I try to compile the assets or the login screen."}, {"owner": {"reputation": 246, "user_id": 2912833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69a5d516a5a8cf8a8ff8768ec789fcfd?s=128&d=identicon&r=PG&f=1", "display_name": "Arnaldo Jr", "link": "https://stackoverflow.com/users/2912833/arnaldo-jr"}, "edited": false, "score": 0, "creation_date": 1511285666, "post_id": 47418907, "comment_id": 81792597, "body": "rake assets:precompile rake aborted! Encoding::InvalidByteSequenceError: &quot;\\xED&quot; followed by &quot;t&quot; on UTF-8 /directory/gems/sprockets-3.7.1/lib/sprockets/utils.rb:110:i&zwnj;&#8203;n `encode&#39;"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1511285886, "post_id": 47418907, "comment_id": 81792725, "body": "Try and track down where that sequence occurs. You&#39;ve got a mangled UTF-8 character in one of your source files."}, {"owner": {"reputation": 246, "user_id": 2912833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69a5d516a5a8cf8a8ff8768ec789fcfd?s=128&d=identicon&r=PG&f=1", "display_name": "Arnaldo Jr", "link": "https://stackoverflow.com/users/2912833/arnaldo-jr"}, "edited": false, "score": 0, "creation_date": 1511369138, "post_id": 47418907, "comment_id": 81834604, "body": "There was an .js file in my application with invalid characters. I fixed them and it worked again."}], "owner": {"reputation": 246, "user_id": 2912833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/69a5d516a5a8cf8a8ff8768ec789fcfd?s=128&d=identicon&r=PG&f=1", "display_name": "Arnaldo Jr", "link": "https://stackoverflow.com/users/2912833/arnaldo-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511284498, "creation_date": 1511284498, "question_id": 47418907, "link": "https://stackoverflow.com/questions/47418907/xed-followed-by-t-on-utf-8", "title": "&quot;\\xED&quot; followed by &quot;t&quot; on UTF-8", "body": "<p>I have a rails application and the time I try to run or compile the assets gives this error:</p>\n\n<pre><code>\"\\ xED\" followed by \"t\" on UTF-8\n</code></pre>\n\n<p>In my </p>\n\n<blockquote>\n  <p>application.rb</p>\n</blockquote>\n\n<p>you have this key:</p>\n\n<pre><code>config.encoding = \"utf-8\"\n</code></pre>\n\n<p>Does anyone know what can it be?</p>\n"}, {"tags": ["ruby", "http", "post", "request"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511285324, "post_id": 47418857, "comment_id": 81792378, "body": "Can you be more specific as to your expectation? right no you are simply making a post request to the given URL without an parameters. 415 means that the payload format is unsupported but since you have no payload on the POST request this is not that surprising. You will most likely need to specify a Content-Type header e.g <code>application&#47;json</code> or <code>text&#47;xml</code> as well but I am unsure what this service is expecting"}, {"owner": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511285488, "post_id": 47418857, "comment_id": 81792483, "body": "i add parameters to url, like id and password to auth"}, {"owner": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511285608, "post_id": 47418857, "comment_id": 81792560, "body": "i try to connect to university web site, and who write api to this site, give me this: url = URI(&quot;<a href=\"https://ams.iaau.edu.kg/api/authentication/13010106044/sha-256\" rel=\"nofollow noreferrer\">ams.iaau.edu.kg/api/authentication/13010106044/sha-256</a> hash&quot;)"}, {"owner": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511285950, "post_id": 47418857, "comment_id": 81792760, "body": "URL /api/authentication/:id/:password Method POST URL Params Required: id=[Integer] password=[String] hashed in sha256  Data Params None Success Response: Code: 200 OK  Content: {&quot;authToken&quot;:&quot;eyJhbGciOiJIUzI1NiJ9...&quot;, &quot;expires&quot;: &quot;2017-10-11T12:13:47.441&quot;}  Error Response: Code: 401 Unauthorized  Content: {&quot;Status&quot;:&quot;Wrong Password&quot;} Code: 401 Unauthorized Content: {&quot;Status&quot;:&quot;User doesn&#39;t exist&quot;}"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "edited": false, "score": 0, "creation_date": 1511286527, "post_id": 47419460, "comment_id": 81793116, "body": "Now I have :Bad request,400"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "edited": false, "score": 0, "creation_date": 1511286823, "post_id": 47419460, "comment_id": 81793300, "body": "That is very strange I will try a few thinsg and get back to you because just using curl I get a 401 with or without content-type specified"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "edited": false, "score": 0, "creation_date": 1511287852, "post_id": 47419460, "comment_id": 81793910, "body": "@MaratTynarbekov Please see updated post using this I am now getting a 401 which is as far as I can get without credentials"}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": true, "score": 1, "last_activity_date": 1511288654, "last_edit_date": 1511288654, "creation_date": 1511286384, "answer_id": 47419460, "question_id": 47418857, "link": "https://stackoverflow.com/questions/47418857/ruby-http-request-post-method/47419460#47419460", "title": "ruby http request post method", "body": "<p>Okay now that you have posted some information I am going to assume this is a json API because the responses are json.</p>\n\n<p>Update Try this instead  </p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\nuri = URI.parse('https://ams.iaau.edu.kg/api/authentication/id/password')\nhttp = Net::HTTP.new(uri.host, uri.port)\nhttp.use_ssl = (uri.scheme == 'https')\nresponse = http.send_request('POST',uri.request_uri)\n</code></pre>\n\n<p>I am now getting a 401 Unauthorized as expected since I don't have an id or password</p>\n\n<p>If you would prefer your original code I have found the solution which is setting the content type of the request directly e.g.</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\nurl = URI.parse('https://ams.iaau.edu.kg/api/authentication/id/password')\nhttp = Net::HTTP.new(url.host, url.port)\nhttp.use_ssl = (url.scheme == 'https')\nrequest = Net::HTTP::Post.new(url.path)\nrequest.content_type = 'application/json' # HERE\nresponse = http.request(request)\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7975750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d245760b79c9eefd699101c96d3906ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marat Tynarbekov", "link": "https://stackoverflow.com/users/7975750/marat-tynarbekov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "accepted_answer_id": 47419460, "answer_count": 1, "score": 1, "last_activity_date": 1511288654, "creation_date": 1511284342, "last_edit_date": 1511286512, "question_id": 47418857, "link": "https://stackoverflow.com/questions/47418857/ruby-http-request-post-method", "title": "ruby http request post method", "body": "<p>I want take token,but i have a problems.</p>\n\n<p>My code:</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\nurl = URI.parse('https://ams.iaau.edu.kg/api/authentication/id/password')\nhttp = Net::HTTP.new(url.host, url.port)\nhttp.use_ssl = (url.scheme == 'https')\nrequest = Net::HTTP::Post.new(url.path)\nresponse = http.request(request)\nputs response.message\nputs response.code\n</code></pre>\n\n<p>I have output like this:</p>\n\n<pre><code>Unsupported Media Type\n415\n</code></pre>\n\n<p>API Doc</p>\n\n<pre><code>URL /api/authentication/:id/:password Method POST \nURL Params Required: id=[Integer] password=[String] hashed in sha256 \nData \n  Params None \n  Success Response: Code: 200 OK \n    Content: {\"authToken\":\"eyJhbGciOiJIUzI1NiJ9...\", \"expires\": \"2017-10-11T12:13:47.441\"} \n  Error Response: Code: 401 Unauthorized \n    Content: {\"Status\":\"Wrong Password\"} Code: 401 Unauthorized \n    Content: {\"Status\":\"User doesn't exist\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 5, "creation_date": 1511283925, "post_id": 47418645, "comment_id": 81791476, "body": "There are no backslashes in your array. There is a single string <code>&#39;def, &quot; &quot;&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511286111, "post_id": 47418820, "comment_id": 81792862, "body": "The backslash notation is pretty common across Perl, Python, C, C++, JavaScript..."}], "tags": [], "owner": {"reputation": 863, "user_id": 5557544, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q9trY.jpg?s=128&g=1", "display_name": "Roman Svitukha", "link": "https://stackoverflow.com/users/5557544/roman-svitukha"}, "is_accepted": false, "score": 2, "last_activity_date": 1511284228, "creation_date": 1511284228, "answer_id": 47418820, "question_id": 47418645, "link": "https://stackoverflow.com/questions/47418645/how-to-remove-backslash-from-the-value-of-an-array/47418820#47418820", "title": "how to remove backslash from the value of an array", "body": "<p>When you write:</p>\n\n<pre><code>input = \"{ \\\"foo\\\": \\\"bar\\\", \\\"num\\\": 3}\"\n</code></pre>\n\n<p>The actual string stored in input is:</p>\n\n<pre><code>{ \"foo\": \"bar\", \"num\": 3}\n</code></pre>\n\n<p>The escape \\\" here is interpreted by Ruby parser, so that it can distinguish between the boundary of a string (the left most and the right most \"), and a normal character \" in a string (the escaped ones).</p>\n\n<p>String#delete deletes a character set specified the first parameter, rather than a pattern. All characters that is in the first parameter will be removed. So by writing</p>\n\n<pre><code>input.delete('\\\\\"')\n</code></pre>\n\n<p>You got a string with all \\ and \" removed from input, rather than a string with all \\\" sequence removed from input. This is wrong for your case. It may cause unexpected behavior some time later.</p>\n"}], "owner": {"reputation": 265, "user_id": 492919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ba64c96f5400159f84a6de03b0a7eff3?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/492919/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511284228, "creation_date": 1511283671, "question_id": 47418645, "link": "https://stackoverflow.com/questions/47418645/how-to-remove-backslash-from-the-value-of-an-array", "title": "how to remove backslash from the value of an array", "body": "<p>I have following type of arrays</p>\n\n<ul>\n<li><code>[\"def, \\\" \\\"\"]</code></li>\n<li><code>[\"abc,\\\" \\\",def\"]</code></li>\n</ul>\n\n<p>How can i check if there's a <code>\\</code> in value and convert them correctly as follows?</p>\n\n<ul>\n<li><code>[\"def\", \" \"]</code></li>\n<li><code>[\"abc\", \" \", \"def\"]</code></li>\n</ul>\n\n<p>I have been trying to correct them using \n<code>join(',')</code> \n<code>delete('\\\"')</code> <code>split(', ')</code>\nbut no luck</p>\n"}, {"tags": ["ruby", "csv", "foreach"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1511281623, "post_id": 47417924, "comment_id": 81789780, "body": "<code>row.size</code> / <code>row.length</code> should work."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1511282845, "post_id": 47417924, "comment_id": 81790661, "body": "@Stefan a violent paranoid living inside me says it should be <code>CSV.foreach(...).max_by(&amp;:size).size</code> :)"}], "answers": [{"tags": [], "owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "is_accepted": false, "score": 0, "last_activity_date": 1512246043, "last_edit_date": 1512246043, "creation_date": 1511281715, "answer_id": 47417994, "question_id": 47417924, "link": "https://stackoverflow.com/questions/47417924/count-number-of-elements-in-a-csv-in-a-row-in-ruby/47417994#47417994", "title": "count number of elements in a CSV in a row in Ruby", "body": "<pre><code>row.size \n</code></pre>\n\n<p>worked as suggested by @Stefan</p>\n\n<p>But a more error prone approach is:</p>\n\n<pre><code>CSV.foreach('test.csv','r').max_by(&amp;:length).length\n</code></pre>\n\n<p>Another way is to get the size of the current line:</p>\n\n<pre><code>CSV.foreach('test.csv', 'r') { |row| puts r.length }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1511282909, "post_id": 47418069, "comment_id": 81790714, "body": "or <code>CSV.foreach(&#39;test.csv&#39;,&#39;r&#39;).max_by(&amp;:length).length</code> for the longest row"}], "tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": true, "score": 1, "last_activity_date": 1511281965, "creation_date": 1511281965, "answer_id": 47418069, "question_id": 47417924, "link": "https://stackoverflow.com/questions/47417924/count-number-of-elements-in-a-csv-in-a-row-in-ruby/47418069#47418069", "title": "count number of elements in a CSV in a row in Ruby", "body": "<p>If each line contains same number of elements then:</p>\n\n<pre><code>CSV.open('test.csv', 'r') { |csv| puts csv.first.length }\n</code></pre>\n\n<p>If not then count for each line:</p>\n\n<pre><code>CSV.foreach('test.csv', 'r') { |row| puts r.length }\n</code></pre>\n"}], "owner": {"reputation": 889, "user_id": 7946648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q2VPH.jpg?s=128&g=1", "display_name": "Karina Kozarova", "link": "https://stackoverflow.com/users/7946648/karina-kozarova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 47418069, "answer_count": 2, "score": 0, "last_activity_date": 1512246043, "creation_date": 1511281522, "question_id": 47417924, "link": "https://stackoverflow.com/questions/47417924/count-number-of-elements-in-a-csv-in-a-row-in-ruby", "title": "count number of elements in a CSV in a row in Ruby", "body": "<p>I have the following piece of code to process a CSV:</p>\n\n<pre><code>CSV.foreach(\"./matrix1.csv\") do |row|\n puts \"Row is: \" \n print row\n line_count += 1\nend\n</code></pre>\n\n<p>And it successfully found out the number of line in the CSV. However, how can I find the number of CSV elements in one line(row).\nFor example, I have the following CSV</p>\n\n<pre><code>1,2,3,4,5\n</code></pre>\n\n<p>How can I see that the number of elements is 5?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1511292259, "post_id": 47417628, "comment_id": 81796437, "body": "I recommend following the flow chart at <a href=\"https://stackoverflow.com/a/31572431/3784008\">this answer</a> to determine the most appropriate way to fire and forget a child process in Ruby."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1511338953, "post_id": 47417628, "comment_id": 81814129, "body": "Hey @anothermh, pretty awesome diagram. Thanks for sharing it. I&#39;m spawning the process according to it but it doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "edited": false, "score": 0, "creation_date": 1511370949, "post_id": 47436111, "comment_id": 81835830, "body": "This is really nice info, thanks for tracking it down and following up."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 17782, "user_id": 1494519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af54a0871600db7fbdbb5c558a6e29a3?s=128&d=identicon&r=PG", "display_name": "Mike Perham", "link": "https://stackoverflow.com/users/1494519/mike-perham"}, "edited": false, "score": 0, "creation_date": 1511424937, "post_id": 47436111, "comment_id": 81855808, "body": "Thank you @MikePerham. It was hard to track it down since my experience with systemd is limited and there are no that many resources of running sidekiq on the new init system. I hope this answer will help others or at least make them read the systemd docs more thoroughly."}], "tags": [], "owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "is_accepted": false, "score": 1, "last_activity_date": 1511357782, "creation_date": 1511357782, "answer_id": 47436111, "question_id": 47417628, "link": "https://stackoverflow.com/questions/47417628/processes-spawned-by-sidekiq-are-stopped-when-sidekiq-stops/47436111#47436111", "title": "Processes spawned by sidekiq are stopped when sidekiq stops", "body": "<p>After hours of debugging I ended up finding that systemd was causing this. The process started inside sidekiq got the sidekiq <code>cgroup</code> and whenever you kill a process the default <code>killmode</code> is <code>control-group</code>.</p>\n\n<pre><code>deployer@srv-14:~$ ps -efj | grep test.sh\nUID        PID  PPID  PGID   SID  C STIME TTY          TIME CMD\ndeployer 16679  8455 16678  8455  0 12:59 pts/0    00:00:00 grep --color=auto test.sh\ndeployer 24904 30861 24904 30861  0 12:52 ?        00:00:00 sh -c cd /home/deployer &amp;&amp;           ./test.sh\ndeployer 24906 24904 24904 30861  0 12:52 ?        00:00:00 /bin/bash ./test.sh\n\ndeployer  6382     1  6382  6382 38 12:53 ?        00:02:14 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer  7787     1  7787  7787 30 12:46 ?        00:04:07 sidekiq 4.2.10 my_proj [6 of 8 busy]\ndeployer 13680     1 13680 13680 29 12:49 ?        00:03:08 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 14372     1 14372 14372 38 12:49 ?        00:03:48 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 16719  8455 16718  8455  0 12:59 pts/0    00:00:00 grep --color=auto sidekiq\ndeployer 17678     1 17678 17678 38 12:50 ?        00:03:22 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 18023     1 18023 18023 32 12:50 ?        00:02:49 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 18349     1 18349 18349 34 12:43 ?        00:05:32 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 18909     1 18909 18909 34 12:51 ?        00:02:53 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 22956     1 22956 22956 39 12:01 ?        00:22:42 sidekiq 4.2.10 my_proj [8 of 8 busy]\ndeployer 30861     1 30861 30861 46 12:00 ?        00:27:23 sidekiq 4.2.10 my_proj [8 of 8 busy]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>cat /proc/24904/cgroup\n11:perf_event:/\n10:blkio:/\n9:pids:/system.slice\n8:devices:/system.slice/system-my_proj\\x2dsidekiq.slice\n7:cpuset:/\n6:freezer:/\n5:memory:/\n4:cpu,cpuacct:/\n3:net_cls,net_prio:/\n2:hugetlb:/\n1:name=systemd:/system.slice/system-my_proj\\x2dsidekiq.slice/my_proj-sidekiq@9.service\n</code></pre>\n\n<p>I fixed the problem by instructing my sidekiq service that the <code>KillMode</code> is <code>process</code></p>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://www.freedesktop.org/wiki/Software/systemd/ControlGroupInterface/\" rel=\"nofollow noreferrer\">https://www.freedesktop.org/wiki/Software/systemd/ControlGroupInterface/</a></li>\n<li><a href=\"https://www.freedesktop.org/software/systemd/man/systemd.kill.html\" rel=\"nofollow noreferrer\">https://www.freedesktop.org/software/systemd/man/systemd.kill.html</a></li>\n</ul>\n"}], "owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511357782, "creation_date": 1511280698, "question_id": 47417628, "link": "https://stackoverflow.com/questions/47417628/processes-spawned-by-sidekiq-are-stopped-when-sidekiq-stops", "title": "Processes spawned by sidekiq are stopped when sidekiq stops", "body": "<p>I'm doing some processing inside a job which ends up executing an external shell command. The command is executing a script that takes hours to finish. </p>\n\n<p>Problem is that after I start the script using <a href=\"https://ruby-doc.org/core-2.2.0/Process.html#method-c-spawn\" rel=\"nofollow noreferrer\">spawn</a> and <a href=\"https://ruby-doc.org/core-2.2.0/Process.html#method-c-detach\" rel=\"nofollow noreferrer\">detach</a> the script stops execution if I shut down the sidekiq job using a kill -15 signal. This behaviour is only occurring if the <code>spawn</code> command is fired by sidekiq - not if I do it in irb and close the console. So somehow it's still bound to sidekiq it seems - but why and how to avoid it?.</p>\n\n<p><strong>test.sh</strong></p>\n\n<pre><code>#!/bin/bash\n\nfor a in `seq 1000` ; do\n  echo \"$a \"\n  sleep 1\ndone\n</code></pre>\n\n<p><strong>spawn_test_job.rb</strong></p>\n\n<pre><code>module WorkerJobs\n  class SpawnTestJob &lt; CountrySpecificWorker\n    sidekiq_options :queue =&gt; :my_jobs, :retry =&gt; false\n\n    def perform version\n      logfile = \"/home/deployer/test_#{version}.log\"\n      pid = spawn(\n        \"cd /home/deployer &amp;&amp;\n          ./test.sh\n        \",\n        [:out, :err] =&gt; logfile\n      )\n      Process.detach(pid)\n    end\n\n  end\nend\n</code></pre>\n\n<p>I enqueue the job <code>WorkerJobs::SpawnTestJob.perform_async(1)</code> and if I tail the <code>test_1.log</code> I can see my counter going on. However when I send sidekiq the kill -15 the counter stops and the script pid disappears. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "grape-api", "grape-entity"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511290845, "post_id": 47417619, "comment_id": 81795576, "body": "Actually sounds more like an autoload issue than a thread issue. I actually created a very similar concept recently for templating endpoints in Grape unfortuantely the code is far too verbose and application specific to post here. That being said why would you need to call this in an initializer? Why not handle the generation of the needed endpoints in a lazy method or inside of V1::Base directly ?"}, {"owner": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511296424, "post_id": 47417619, "comment_id": 81798860, "body": "The generation of the endpoint is a static method in V1::Base indeed. It&#39;s the generation of the Grape::Entity that is generated when ApplicationRecord is inherited: the reason why I did so is because I wanted to have the entity defined as Model::Entity and Model::EntitiesList. Do you think this is a bad approach to have the Grape::Entity as a subclass on the model?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511297229, "post_id": 47417619, "comment_id": 81799279, "body": "Since I hate the idea of any business or presentation logic in a model (or subclass there of) I separate the 2 concerns and generate the entities in their own namespace dynamically. While our code base has many concerns involved the simplified version is just <code>Entities::Book = Class.new(Grape::Entity) { expose *Book.attribute_names}</code>. It seems this concept could easily be patched into your <code>#show</code> method directly since you are already checking constant definitions"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511298604, "post_id": 47417619, "comment_id": 81800052, "body": "I think your main issue right now is that <code>Book</code> is not loaded and thus <code>Book::Entity</code> is invalid because <code>Book</code> is not currently a valid namespace. If you were to do this in an initializer you would essentially need to load every model (which are generally lazy loaded as needed) so that you would have a declared namespace in which to generate the <code>Entity</code> class. Constant lookup requires a depth chart where <code>class Book; class Entity; end; end;</code> can resolve the <code>Book</code> namespace but <code>class Book::Entity; end;</code> cannot <a href=\"https://cirw.in/blog/constant-lookup.html\" rel=\"nofollow noreferrer\">Nice Reasonably Concise Article</a>"}, {"owner": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511299016, "post_id": 47417619, "comment_id": 81800273, "body": "I was actually able to get it working it was a matter of constant not yet created and linked to the correct class. Now though I&#39;m more concerted of what you said, I hate a lot the presentation login in the model too. I think I will refactor."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1511299125, "post_id": 47417619, "comment_id": 81800354, "body": "Glad you got everything sorted. Best of luck"}], "owner": {"reputation": 1961, "user_id": 7754093, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VoAj5.png?s=128&g=1", "display_name": "Francesco Meli", "link": "https://stackoverflow.com/users/7754093/francesco-meli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511280676, "creation_date": 1511280676, "question_id": 47417619, "link": "https://stackoverflow.com/questions/47417619/automagically-creating-api-endpoints-and-their-basic-swagger-documentation", "title": "Automagically creating API endpoints and their basic swagger documentation", "body": "<p>Rails is so magical that I need help from someone who knows a little better than I do.</p>\n\n<p>Since I have a lot of crud API basic endpoints repeated over and over I decided to automate their creations (see my final post in the following <a href=\"https://github.com/ruby-grape/grape/issues/1709\" rel=\"nofollow noreferrer\">github issue</a>).</p>\n\n<p>For the sake of having some basic valid swagger documentation I automated also the creation of the Grape::Entities by adding some custom code to my ApplicationRecord (see github SOLUTION snippet added to this question: <a href=\"https://stackoverflow.com/questions/47371243/inheriting-class-definition-from-parent-class\">Inheriting class definition from parent class</a>).</p>\n\n<p>With the above 2 customizations I can create API endpoint by simply doing:</p>\n\n<pre><code>V1::Base.show Book\n</code></pre>\n\n<p>The above method will create an endpoint and it will use the automagically created Entity like so that it gets automagically documented with default values that can be overridden later on if needed in the Book model class:</p>\n\n<pre><code>Book::Entity\n</code></pre>\n\n<p>There is 1 exception when the above code seems to break: it seems that whenever I interact in an early state during the bootstrap of my Rails application (initializers for example), when I call <code>V1::Base.show Book</code> (to create the api endpoint) which calls <code>Book::Entity</code> the following error is returned:</p>\n\n<pre><code>NameError: uninitialized constant Book::Entity\n</code></pre>\n\n<p>Could anybody give me a hint on what it could be? the early interaction with the model can be a simple Book.all, it smells like a thread issue.</p>\n"}, {"tags": ["ruby", "argv", "optparse"], "comments": [{"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1511284442, "post_id": 47417292, "comment_id": 81791833, "body": "Still, you&#39;ll love optparse in a couple of months :) Honestly, as it behaves pretty predictably (and allows for better &quot;arguments&quot; like <code>--interactive</code> and <code>-i</code> together with a help text) as soon as you implement the third_version consider using it, although its pretty bureaucratic."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 1, "creation_date": 1511280472, "post_id": 47417449, "comment_id": 81788952, "body": "This is exactly what I&#39;ve been looking for, thank you so much for such a concise and perfect response!"}, {"owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "reply_to_user": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "edited": false, "score": 0, "creation_date": 1511281030, "post_id": 47417449, "comment_id": 81789347, "body": "Happy to help! Don&#39;t forget to accept this as the answer."}], "tags": [], "owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "is_accepted": true, "score": 1, "last_activity_date": 1511280198, "creation_date": 1511280198, "answer_id": 47417449, "question_id": 47417292, "link": "https://stackoverflow.com/questions/47417292/run-specific-version-of-ruby-script-if-command-line-argument-is-entered/47417449#47417449", "title": "run specific version of ruby script if command line argument is entered", "body": "<p><code>ARGV</code> isn't readonly, so you could consume the first input like this:</p>\n\n<pre><code>if ARGV[0] == 'second_version'\n  ARGV.shift # removes the first element \n  second_version_methods\nelse\n  main_version\nend\n</code></pre>\n\n<p>If you want to keep ARGV intact (which is a better idea), you can do this:</p>\n\n<pre><code>arguments = ARGV.dup\n\nif arguments[0] == 'second_thing'\n  arguments.shift\n# ...\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8496955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130af836e960f2242a04e7fa5cbef5a8?s=128&d=identicon&r=PG&f=1", "display_name": "lumos", "link": "https://stackoverflow.com/users/8496955/lumos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47417449, "answer_count": 1, "score": 0, "last_activity_date": 1511280198, "creation_date": 1511279769, "question_id": 47417292, "link": "https://stackoverflow.com/questions/47417292/run-specific-version-of-ruby-script-if-command-line-argument-is-entered", "title": "run specific version of ruby script if command line argument is entered", "body": "<p>I've read through tons of variations of my question, but I can't seem to find one that really matches up with what I'm trying to do.</p>\n\n<p>I have a script that essentially has two versions: the \"default\" would run through a series of mandatory methods, and the second version would run through those same methods, then tack on a series of secondary methods. I would like the second version to be triggered from the command line (something like <code>$ script.rb second_version</code>), and the \"default\" option to be triggered by no argument input at all (since it's going to be used more frequently, so just <code>$ script.rb</code>).</p>\n\n<p>I tried this with ARGV:</p>\n\n<pre><code>second_version = ARGV[0]\n\nif second_version\n   second_version_methods\nelse\n  main_version\nend\n</code></pre>\n\n<p>This technically works, but the problem is that the very first method that runs in the main_version script is a method that requires user input. What ends up happening is that the string \"second_version\" is automatically passed to that method as the value, which I don't want.</p>\n\n<p>Essentially, is there a way to have a command line argument that will <em>only</em> specify a condition to run in a particular way, and then once that's done, it just drops the input? I've looked into optparse but its functionality seems a bit superfluous for this purpose.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "edited": false, "score": 0, "creation_date": 1511280473, "post_id": 47416852, "comment_id": 81788953, "body": "you have an error in your server. include it to get help."}, {"owner": {"reputation": 1655, "user_id": 1587541, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f9a8cdad3107b443ceeee42bb4456e1?s=128&d=identicon&r=PG", "display_name": "AntonTkachov", "link": "https://stackoverflow.com/users/1587541/antontkachov"}, "edited": false, "score": 0, "creation_date": 1511281220, "post_id": 47416852, "comment_id": 81789484, "body": "Similar scenario worked for me. You should have some errors/warnings/etc"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511282965, "post_id": 47416852, "comment_id": 81790760, "body": "You can just use <code>company.update!</code> instead of two lines."}], "answers": [{"tags": [], "owner": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "is_accepted": true, "score": 1, "last_activity_date": 1511349069, "last_edit_date": 1511349069, "creation_date": 1511291400, "answer_id": 47420874, "question_id": 47416852, "link": "https://stackoverflow.com/questions/47416852/unable-to-edit-address-from-company-page/47420874#47420874", "title": "Unable to edit address from company page", "body": "<p>You should post the error message for getting better help. That's being said, I can see you added validations for <code>city</code>, <code>zip</code>, <code>street</code>, <code>country</code>. However, when assigning attributes with <code>company_addresses_attributes: [id: company_address.id, street: 'New Street']</code>, you have missed <code>city</code>, <code>zip</code>, <code>country</code>.</p>\n\n<p>Again, can't be sure if this is the exact problem without seeing any actual errors. Try and let me know.</p>\n"}], "owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47420874, "answer_count": 1, "score": 0, "last_activity_date": 1511349069, "creation_date": 1511278467, "question_id": 47416852, "link": "https://stackoverflow.com/questions/47416852/unable-to-edit-address-from-company-page", "title": "Unable to edit address from company page", "body": "<p>I have standard company has many addresses case, where in my company model I have this :</p>\n\n<pre><code>has_many :company_addresses\naccepts_nested_attributes_for :company_addresses, allow_destroy: true\n</code></pre>\n\n<p>In my company address model I have this :</p>\n\n<pre><code>  belongs_to :company, counter_cache: true\n  validates :city, :zip, :street, :country, presence: true\n</code></pre>\n\n<p>Now when I try to update the actual address via company:</p>\n\n<pre><code>company_address = company.company_addresses.first\ncompany.assign_attributes(company_addresses_attributes: [id: company_address.id, street: 'New Street'])\ncompany.save!\n</code></pre>\n\n<p>The actual address object does not change, why is this? What am I doing wrong here?</p>\n"}, {"tags": ["angularjs", "json", "ruby", "sinatra"], "comments": [{"owner": {"reputation": 3768, "user_id": 1029521, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7ce6f2f15a73bb6012b490dcbc4c1ed5?s=128&d=identicon&r=PG", "display_name": "Max Woolf", "link": "https://stackoverflow.com/users/1029521/max-woolf"}, "edited": false, "score": 0, "creation_date": 1511278459, "post_id": 47416802, "comment_id": 81787440, "body": "You&#39;re trying to parse JSON but that string does not look like JSON. Can you post the full string of what you&#39;re trying to parse?"}, {"owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "reply_to_user": {"reputation": 3768, "user_id": 1029521, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7ce6f2f15a73bb6012b490dcbc4c1ed5?s=128&d=identicon&r=PG", "display_name": "Max Woolf", "link": "https://stackoverflow.com/users/1029521/max-woolf"}, "edited": false, "score": 0, "creation_date": 1511280639, "post_id": 47416802, "comment_id": 81789069, "body": "I have edited the post with angularjs script and html form, if you would like to see anything else, please just say"}, {"owner": {"reputation": 46815, "user_id": 5535245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnjcO.jpg?s=128&g=1", "display_name": "georgeawg", "link": "https://stackoverflow.com/users/5535245/georgeawg"}, "edited": false, "score": 0, "creation_date": 1511288959, "post_id": 47416802, "comment_id": 81794512, "body": "The AngularJS code is old an obsolete. For more information, see <a href=\"https://stackoverflow.com/questions/35329384/why-are-angular-http-success-error-methods-deprecated-removed-from-v1-6/35331339#35331339\">Why are angular $http success/error methods deprecated? Removed from v1.6?</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3768, "user_id": 1029521, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7ce6f2f15a73bb6012b490dcbc4c1ed5?s=128&d=identicon&r=PG", "display_name": "Max Woolf", "link": "https://stackoverflow.com/users/1029521/max-woolf"}, "is_accepted": false, "score": 1, "last_activity_date": 1511281379, "creation_date": 1511281379, "answer_id": 47417882, "question_id": 47416802, "link": "https://stackoverflow.com/questions/47416802/sinatra-error-jsonparsererror-784-unexpected-token/47417882#47417882", "title": "Sinatra error -- JSON::ParserError - 784: unexpected token", "body": "<p>You are attempting to parse URL encoded data by passing it through a JSON parser. This will not work.</p>\n\n<p>Try parsing <code>response.body</code> as a regular String rather than a JSON String.</p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "edited": false, "score": 0, "creation_date": 1511297237, "post_id": 47420390, "comment_id": 81799283, "body": "Thanks for help, I did correction but I get 404 erroe in console without any xhanges on the server. Then I added headers as well and i got t200 OK, but my response error is: SyntaxError: JSON.parse: unexpected end of data at line 1 column 1 of the JSON data, then i change to params tab and i see: {&quot;id&quot;:&quot;99&quot;,&quot;name&quot;:&quot;Bruce Lee&quot;,&quot;city&quot;:&quot;Shangai&quot;,&quot;address&quot;:&quot;MStreet&quot;}:           ! I can see this double colon, I guess it is the reason of the error right?"}, {"owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "edited": false, "score": 0, "creation_date": 1511767563, "post_id": 47420390, "comment_id": 81967256, "body": "It led me to the right answer so I accept this answer, thank you for the help"}], "tags": [], "owner": {"reputation": 46815, "user_id": 5535245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnjcO.jpg?s=128&g=1", "display_name": "georgeawg", "link": "https://stackoverflow.com/users/5535245/georgeawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1511289630, "creation_date": 1511289630, "answer_id": 47420390, "question_id": 47416802, "link": "https://stackoverflow.com/questions/47416802/sinatra-error-jsonparsererror-784-unexpected-token/47420390#47420390", "title": "Sinatra error -- JSON::ParserError - 784: unexpected token", "body": "<p>The error occurs because the AngularJS code is sending data in URL encoded form. To POST data as a <a href=\"https://en.wikipedia.org/wiki/JSON\" rel=\"nofollow noreferrer\">JSON</a> string:</p>\n\n<pre><code>var formApp = angular.module('formApp', []);\nfunction formController($scope, $http) {\n    $scope.formData = {};\n    $scope.processForm = function() {\n        $http({\n            method  : 'POST',\n            url     : 'http://localhost:4567/api/v1/companies',\n            \u0336d\u0336a\u0336t\u0336a\u0336 \u0336 \u0336 \u0336 \u0336:\u0336 \u0336$\u0336.\u0336p\u0336a\u0336r\u0336a\u0336m\u0336(\u0336$\u0336s\u0336c\u0336o\u0336p\u0336e\u0336.\u0336f\u0336o\u0336r\u0336m\u0336D\u0336a\u0336t\u0336a\u0336)\u0336,\u0336 \u0336 \u0336/\u0336/\u0336 \u0336p\u0336a\u0336s\u0336s\u0336 \u0336i\u0336n\u0336 \u0336d\u0336a\u0336t\u0336a\u0336 \u0336a\u0336s\u0336 \u0336s\u0336t\u0336r\u0336i\u0336n\u0336g\u0336s\u0336\n            data    : $scope.formData, //data automatically coded as JSON string\n            \u0336h\u0336e\u0336a\u0336d\u0336e\u0336r\u0336s\u0336 \u0336:\u0336 \u0336{\u0336 \u0336'\u0336C\u0336o\u0336n\u0336t\u0336e\u0336n\u0336t\u0336-\u0336T\u0336y\u0336p\u0336e\u0336'\u0336:\u0336 \u0336'\u0336a\u0336p\u0336p\u0336l\u0336i\u0336c\u0336a\u0336t\u0336i\u0336o\u0336n\u0336/\u0336x\u0336-\u0336w\u0336w\u0336w\u0336-\u0336f\u0336o\u0336r\u0336m\u0336-\u0336u\u0336r\u0336l\u0336e\u0336n\u0336c\u0336o\u0336d\u0336e\u0336d\u0336'\u0336 \u0336}\u0336            \n        })\n            \u0336.\u0336s\u0336u\u0336c\u0336c\u0336e\u0336s\u0336s\u0336(\u0336f\u0336u\u0336n\u0336c\u0336t\u0336i\u0336o\u0336n\u0336(\u0336d\u0336a\u0336t\u0336a\u0336)\u0336 \u0336{\u0336\n            .then(function(response) {\n                \u0332v\u0332a\u0332r\u0332 \u0332d\u0332a\u0332t\u0332a\u0332 \u0332=\u0332 \u0332r\u0332e\u0332s\u0332p\u0332o\u0332n\u0332s\u0332e\u0332.\u0332d\u0332a\u0332t\u0332a\u0332;\u0332\n                console.log(data);\n                if (!data.success) {\n                    // if not successful, bind errors to error variables\n                    $scope.errorName = data.errors.name;\n                    $scope.errorSuperhero = data.errors.superheroAlias;\n                } else {\n                    // if successful, bind success message to message\n                    $scope.message = data.message;\n                                $scope.errorName = '';\n                    $scope.errorSuperhero = '';\n                }\n            });\n    };\n}\n</code></pre>\n\n<p>The $http service automatically encodes JavaScript objects as JSON strings. The content type header is set to <code>application/json</code>.</p>\n\n<p>The <code>.success</code> method is obsolete. Use <code>.then</code> instead. For more information, see <a href=\"https://stackoverflow.com/questions/35329384/why-are-angular-http-success-error-methods-deprecated-removed-from-v1-6/35331339#35331339\">Why are angular $http success/error methods deprecated? Removed from v1.6?</a>.</p>\n"}], "owner": {"reputation": 402, "user_id": 7007177, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/g0oZj.jpg?s=128&g=1", "display_name": "quant", "link": "https://stackoverflow.com/users/7007177/quant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1772, "favorite_count": 0, "accepted_answer_id": 47420390, "answer_count": 2, "score": 0, "last_activity_date": 1511289630, "creation_date": 1511278314, "last_edit_date": 1511288753, "question_id": 47416802, "link": "https://stackoverflow.com/questions/47416802/sinatra-error-jsonparsererror-784-unexpected-token", "title": "Sinatra error -- JSON::ParserError - 784: unexpected token", "body": "<p>I have an api in Sinatra (Mongodb). I am trying to write some data with the POST method from very small application written in Angularjs. data I am trying to send is 'aplication/x-www-form-urlencoded'. For some reason I keep getting the error:</p>\n\n<pre><code>JSON::ParserError - 784: unexpected token at 'id=111&amp;name=Bruce&amp;city=LA&amp;address=City1':\n</code></pre>\n\n<p>I can see that there is some data encoded in url, but Sinatra does not read it correctly.</p>\n\n<p>Sinatra:</p>\n\n<pre><code>post '/companies' do\n  company=JSON.parse(request.body.read)\n  company = Company.new(company)\nend\n</code></pre>\n\n<p>AngularJs script:</p>\n\n<pre><code>var formApp = angular.module('formApp', []);\nfunction formController($scope, $http) {\n    $scope.formData = {};\n    $scope.processForm = function() {\n        $http({\n            method  : 'POST',\n            url     : 'http://localhost:4567/api/v1/companies',\n            data    : $.param($scope.formData),  // pass in data as strings\n            headers : { 'Content-Type': 'application/x-www-form-urlencoded' }\n        })\n            .success(function(data) {\n                console.log(data);\n                if (!data.success) {\n                    // if not successful, bind errors to error variables\n                    $scope.errorName = data.errors.name;\n                    $scope.errorSuperhero = data.errors.superheroAlias;\n                } else {\n                    // if successful, bind success message to message\n                    $scope.message = data.message;\n                                $scope.errorName = '';\n                    $scope.errorSuperhero = '';\n                }\n            });\n    };\n}\n</code></pre>\n\n<p>I am calling the function formData with the button after the form is completed in HTML:</p>\n\n<pre><code>body ng-app=\"formApp\" ng-controller=\"formController\"&gt;\n&lt;div class=\"container\"&gt;\n&lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n\n    &lt;!-- PAGE TITLE --&gt;\n    &lt;div class=\"page-header\"&gt;\n        &lt;h1&gt;&lt;span class=\"glyphicon glyphicon-tower\"&gt;&lt;/span&gt; Submitting Forms with Angular&lt;/h1&gt;\n    &lt;/div&gt;\n\n    &lt;!-- SHOW ERROR/SUCCESS MESSAGES --&gt;\n    &lt;div id=\"messages\" class=\"well\" ng-show=\"message\"&gt;{{ message }}&lt;/div&gt;\n\n    &lt;!-- FORM --&gt;\n    &lt;form ng-submit=\"processForm()\"&gt;\n\n\n        &lt;div id=\"superhero-group\" class=\"form-group\" ng-class=\"{ 'has-error' : errorSuperhero }\"&gt;\n            &lt;label&gt;ID&lt;/label&gt;\n            &lt;input type=\"text\" name=\"id\" class=\"form-control\" placeholder=\"Caped Crusader\" ng-model=\"formData.id\"&gt;\n            &lt;span class=\"help-block\" ng-show=\"errorSuperhero\"&gt;{{ errorSuperhero }}&lt;/span&gt;\n        &lt;/div&gt;  \n\n\n        &lt;div id=\"name-group\" class=\"form-group\" ng-class=\"{ 'has-error' : errorName }\"&gt;\n            &lt;label&gt;Name&lt;/label&gt;\n            &lt;input type=\"text\" name=\"name\" class=\"form-control\" placeholder=\"Bruce Wayne\" ng-model=\"formData.name\"&gt;\n                        &lt;span class=\"help-block\" ng-show=\"errorName\"&gt;{{ errorName }}&lt;/span&gt;\n        &lt;/div&gt;\n\n        &lt;!-- SUPERHERO NAME --&gt;\n        &lt;div id=\"superhero-group\" class=\"form-group\" ng-class=\"{ 'has-error' : errorSuperhero }\"&gt;\n            &lt;label&gt;City&lt;/label&gt;\n            &lt;input type=\"text\" name=\"city\" class=\"form-control\" placeholder=\"Caped Crusader\" ng-model=\"formData.city\"&gt;\n            &lt;span class=\"help-block\" ng-show=\"errorSuperhero\"&gt;{{ errorSuperhero }}&lt;/span&gt;\n        &lt;/div&gt;\n\n                &lt;div id=\"superhero-group\" class=\"form-group\" ng-class=\"{ 'has-error' : errorSuperhero }\"&gt;\n            &lt;label&gt;Address&lt;/label&gt;\n            &lt;input type=\"text\" name=\"address\" class=\"form-control\" placeholder=\"Caped Crusader\" ng-model=\"formData.address\"&gt;\n            &lt;span class=\"help-block\" ng-show=\"errorSuperhero\"&gt;{{ errorSuperhero }}&lt;/span&gt;\n        &lt;/div&gt;\n\n        &lt;!-- SUBMIT BUTTON --&gt;\n        &lt;button type=\"submit\" class=\"btn btn-success btn-lg btn-block\"&gt;\n            &lt;span class=\"glyphicon glyphicon-flash\"&gt;&lt;/span&gt; Submit!\n        &lt;/button&gt;\n    &lt;/form&gt;\n\n    &lt;!-- SHOW DATA FROM INPUTS AS THEY ARE BEING TYPED --&gt;\n    &lt;pre&gt;\n        {{ formData }}\n    &lt;/pre&gt;\n\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1511276358, "post_id": 47416035, "comment_id": 81785944, "body": "<code>get &#39;show_post_category&#39;</code> -&gt; <code>get &#39;&#47;show_post_category&#47;:category_id&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4994232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2cf95240d117fed96fefaa430e3b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "hue pham", "link": "https://stackoverflow.com/users/4994232/hue-pham"}, "edited": false, "score": 0, "creation_date": 1511316111, "post_id": 47416299, "comment_id": 81806238, "body": "Thank you Mikhail Katrin"}], "tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511276787, "creation_date": 1511276787, "answer_id": 47416299, "question_id": 47416035, "link": "https://stackoverflow.com/questions/47416035/no-route-matches-action-show-post-category-category-id-5-controller/47416299#47416299", "title": "No route matches {:action=&gt;&quot;show_post_category&quot;, :category_id=&gt;5, :controller=&gt;&quot;posts&quot;}", "body": "<pre><code>def show_post_category\n    if params[:id].present?\n        @posts = Category.find(params[:id]).posts\n    else\n        @posts= Post.all\n    end\nend\n</code></pre>\n\n<p>Or even shorter</p>\n\n<pre><code>def show_post_category\n    @posts = params[:id].present? ? Category.find(params[:id]).posts : Post.all\nend\n</code></pre>\n\n<p>Change route: <code>get 'show_post_category/:id'</code></p>\n\n<p>And replace <code>each</code> with <code>map</code></p>\n\n<pre><code>&lt;% @categories = Category.all %&gt;\n&lt;% @categories.map do |c| %&gt;                      \n    &lt;li&gt;\n        &lt;%= link_to c.name, :controller =&gt; \"posts\", :action =&gt; \"show_post_category\", :id =&gt; c.id %&gt;\n    &lt;/li&gt;     \n&lt;% end %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4994232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2cf95240d117fed96fefaa430e3b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "hue pham", "link": "https://stackoverflow.com/users/4994232/hue-pham"}, "edited": false, "score": 0, "creation_date": 1511316081, "post_id": 47416349, "comment_id": 81806227, "body": "Thank you so much Schwad, I will reference to your suggestion."}], "tags": [], "owner": {"reputation": 960, "user_id": 4109592, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Sip6.jpg?s=128&g=1", "display_name": "Nick Schwaderer", "link": "https://stackoverflow.com/users/4109592/nick-schwaderer"}, "is_accepted": false, "score": 0, "last_activity_date": 1511276950, "creation_date": 1511276950, "answer_id": 47416349, "question_id": 47416035, "link": "https://stackoverflow.com/questions/47416035/no-route-matches-action-show-post-category-category-id-5-controller/47416349#47416349", "title": "No route matches {:action=&gt;&quot;show_post_category&quot;, :category_id=&gt;5, :controller=&gt;&quot;posts&quot;}", "body": "<p>That sure sounds frustrating!</p>\n\n<p>Maybe you should try specifying that this is a collection from the <code>routes.rb</code> file like so:</p>\n\n<pre><code>  resources :categories do\n    resources :posts do\n      collection do\n        get 'show_post_category'\n      end\n    end\n  end\n</code></pre>\n\n<p>Let me know how that works for you. </p>\n\n<p>If you want to do a deeper dive here are some more helpful documentation: <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/routing.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4994232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2cf95240d117fed96fefaa430e3b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "hue pham", "link": "https://stackoverflow.com/users/4994232/hue-pham"}, "edited": false, "score": 0, "creation_date": 1511316667, "post_id": 47418779, "comment_id": 81806359, "body": "Thank you Max, I will try with your suggestion and let you know."}], "tags": [], "owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1511284094, "creation_date": 1511284094, "answer_id": 47418779, "question_id": 47416035, "link": "https://stackoverflow.com/questions/47416035/no-route-matches-action-show-post-category-category-id-5-controller/47418779#47418779", "title": "No route matches {:action=&gt;&quot;show_post_category&quot;, :category_id=&gt;5, :controller=&gt;&quot;posts&quot;}", "body": "<p>You can do a lot better.</p>\n\n<p>To create a route that shows all the posts belonging to a category you want the following route:</p>\n\n<pre><code>GET /categories/:category_id/posts\n</code></pre>\n\n<p>This is a restful way of declaring a <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">nested resource</a>. </p>\n\n<p>You would declare the route by:</p>\n\n<pre><code>resources :posts do\n  resources :categories, only: :index, module: :posts\nend\n</code></pre>\n\n<p><code>module: :posts</code> tells Rails we want to use a  seperate <code>Categories::PostsController#index</code> instead of <code>PostsController</code>.</p>\n\n<pre><code>class Categories::PostsController &lt; ApplicationController\n  before_action :set_category\n\n  # GET /categories/:category_id/posts\n  def index\n    @posts = @category.posts\n  end\n\n  private\n\n  def set_category\n    @category = Category.includes(:posts).find(params[:category_id])\n  end \nend\n</code></pre>\n\n<p>Using a module here is really optional but its IMHO a superior solution to \"param sniffing\":</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  # GET /posts\n  # and\n  # GET /categories/:category_id/posts\n  def index\n    if params[:category_id]\n       @posts = Category.includes(:posts).find(params[:category_id])\n    else\n       @posts = Post.all\n    end\n  end\nend\n</code></pre>\n\n<p>The later violates the single responsibility principle.</p>\n"}], "owner": {"reputation": 83, "user_id": 4994232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2cf95240d117fed96fefaa430e3b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "hue pham", "link": "https://stackoverflow.com/users/4994232/hue-pham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1511284094, "creation_date": 1511276018, "last_edit_date": 1511281508, "question_id": 47416035, "link": "https://stackoverflow.com/questions/47416035/no-route-matches-action-show-post-category-category-id-5-controller", "title": "No route matches {:action=&gt;&quot;show_post_category&quot;, :category_id=&gt;5, :controller=&gt;&quot;posts&quot;}", "body": "<p>While practicing Rails, I have a problem that I am unable to resolve it, it as below:\n- I want to show all posts belong to the category (via foreign key category_id) when I clicking on category name, I write a method in 'post' controller:</p>\n\n<pre><code>def show_post_category\n  if params[:category_id]\n    @categories = Category.find_by(params[:category_id])\n    @posts = @categories.posts\n  else\n    @posts= Post.all\n  end\nend\n</code></pre>\n\n<p>In the view, I write the code to show the category name hyperlink:</p>\n\n<pre><code>&lt;% @categories = Category.all %&gt;\n&lt;% @categories.each do |c| %&gt;                      \n  &lt;li&gt;\n    &lt;%= link_to c.name, :controller =&gt; \"posts\", :action =&gt; \"show_post_category\", :category_id =&gt; c.id %&gt;\n  &lt;/li&gt;     \n&lt;% end %&gt;\n</code></pre>\n\n<p>However, when I click on category name, the error is displayed</p>\n\n<pre><code>'No route matches {:action=&gt;\"show_post_category\", :category_id=&gt;5,:controller=&gt;\"posts\"}.\n</code></pre>\n\n<p>Here is the code in routes file:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :posts\n  resources :categories   \n  resources :categories do\n    posts do\n      get 'show_post_category'\n    end\n  end \nend\n</code></pre>\n\n<p>Where is the problem in my code ? please give me the solution for this.</p>\n\n<p>Thank you so much,</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1511274221, "post_id": 47414802, "comment_id": 81784347, "body": "Can you please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of the problem you&#39;re describing? What values for <code>described_class</code>, <code>command</code> and <code>command_args</code> can I use to replicate the problem as you describe it? I took a quick look at <a href=\"https://github.com/davetron5000/gli/blob/84c21131320168178077e9bfe03f51f0e28d361e/lib/gli/app_support.rb#L242\" rel=\"nofollow noreferrer\">the <code>GLI</code> source code</a>, and I can&#39;t see why your approach would fail, under normal circumstances."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511274477, "post_id": 47414802, "comment_id": 81784558, "body": "However, I also noticed that the library provides an <a href=\"https://github.com/davetron5000/gli/blob/84c21131320168178077e9bfe03f51f0e28d361e/lib/gli/app_support.rb#L5-L7\" rel=\"nofollow noreferrer\"><code>error_device=</code></a> method, which is used internally for its own tests such as <a href=\"https://github.com/davetron5000/gli/blob/84c21131320168178077e9bfe03f51f0e28d361e/test/tc_subcommand_parsing.rb#L8-L23\" rel=\"nofollow noreferrer\">here</a>. Could that approach be of use?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1511278066, "post_id": 47414802, "comment_id": 81787145, "body": "You can still access the original streams using the constants <code>STDOUT&#47;STDERR</code>"}], "answers": [{"tags": [], "owner": {"reputation": 919, "user_id": 1742070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ea518131f69363dd9f9de02aa12904?s=128&d=identicon&r=PG", "display_name": "brainbag", "link": "https://stackoverflow.com/users/1742070/brainbag"}, "is_accepted": false, "score": 0, "last_activity_date": 1511280696, "creation_date": 1511280696, "answer_id": 47417627, "question_id": 47414802, "link": "https://stackoverflow.com/questions/47414802/trace-stdout-stderr-in-ruby/47417627#47417627", "title": "Trace $stdout/$stderr in Ruby", "body": "<p>It looks like you're using RSpec based on <code>described_class</code>. If you're just trying to test <code>stdout</code>/<code>stderr</code>, then there's a matcher for that.</p>\n\n<pre><code>it \"does something\" do \n  expect { \n    described_class.run([command] + command_args) \n  }.to output(/some string match/).to_stdout\nend\n</code></pre>\n\n<p>The owner of the GLI project made some suggestions <a href=\"https://github.com/davetron5000/gli/issues/221\" rel=\"nofollow noreferrer\">here</a> about how to test GLI setup, perhaps that will help as well.</p>\n"}], "owner": {"reputation": 19398, "user_id": 435471, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/WvUmQ.jpg?s=128&g=1", "display_name": "Kyle Decot", "link": "https://stackoverflow.com/users/435471/kyle-decot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511280696, "creation_date": 1511272312, "question_id": 47414802, "link": "https://stackoverflow.com/questions/47414802/trace-stdout-stderr-in-ruby", "title": "Trace $stdout/$stderr in Ruby", "body": "<p>I'm attempting to test the output of my gem that is using <a href=\"http://naildrivin5.com/gli/\" rel=\"nofollow noreferrer\">GLI</a> however I'm running into issues. In my test setup I'm redirecting <code>$stdout</code> and <code>$stderr</code> to <code>StringIO</code> instances however when I run my code I'm still getting a message printed to my screen rather than being redirected to my custom objects. </p>\n\n<pre><code>begin\n  old_stdout, old_stderr, $stdout, $stderr = $stdout, $stderr, StringIO.new, StringIO.new\n\n  @exit_code = described_class.run([command] + command_args)\n  @stdout = $stdout.string\n  @stderr = $stderr.string\nensure\n  $stdout = old_stdout\n  $stderror = old_stderr\nend\n</code></pre>\n\n<p>I would expect that <code>described_class.run([command] + command_args)</code> which ends up calling GLI's <code>exit_now!</code> method would be redirected to <code>$stderr</code> however this does not seem to be the case.</p>\n\n<p>Is there a way to \"trace\" where/how a string was printed to the screen?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1511272856, "post_id": 47414656, "comment_id": 81783372, "body": "Take a look at the example for <a href=\"http://ruby-doc.org/core-2.4.2/Enumerator.html#method-c-new\" rel=\"nofollow noreferrer\"><code>Enumerator.new</code></a> \u2013 calling <code>take(10)</code> only returns the first 10 items, although numbers are yielded in an infinite loop. Worth reading: <a href=\"https://blog.arkency.com/2014/01/ruby-to-enum-for-enumerator/\" rel=\"nofollow noreferrer\">blog.arkency.com/2014/01/ruby-to-enum-for-enumerator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 5527374, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/OQmV2.png?s=128&g=1", "display_name": "tscheingeld", "link": "https://stackoverflow.com/users/5527374/tscheingeld"}, "edited": false, "score": 0, "creation_date": 1511281195, "post_id": 47414964, "comment_id": 81789468, "body": "Fantastic! Works just like I need. Thanks!"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1511272931, "creation_date": 1511272931, "answer_id": 47414964, "question_id": 47414656, "link": "https://stackoverflow.com/questions/47414656/how-to-create-enumerable-class-without-another-enumerable/47414964#47414964", "title": "How to create enumerable class without another enumerable?", "body": "<pre><code>class MyClass\n  include Enumerable\n\n  def enum\n    @enum ||= Enumerator.new do |y|\n      loop do  \n        value = get_next\n        raise StopIteration.new(\"nil\") if value.nil?\n        y &lt;&lt; value\n      end    \n    end  \n  end\n\n  def each\n    return enum_for(:each) unless block_given?\n    enum.each(&amp;Proc.new)\n  end\n\n  def get_next\n    return_val = rand.to_s\n    return_val.match(/33/) ? nil : return_val\n  end\nend\n\nmc = MyClass.new\nmc.each { |e| puts e }\n#\u21d2\u00a00.9354594959902887\n#  0.6425492923024724\n#  0.24551401459676037\n#  0.17117672854168786\n#  0.15611540754420283\n#  0.3914491388594509\n#  0.40243662946930725\n#  0.3792875585148314\n#  0.11978219941961588\n#  0.49891129730441874\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1511308063, "post_id": 47424475, "comment_id": 81804117, "body": "...and if you want <code>each</code> with no arguments to return an Enumerator (just like stdlib enumerables do), add  <code>return to_enum unless block_given?</code> to the top of the method."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511420574, "post_id": 47424475, "comment_id": 81853704, "body": "This implementation is not compatible with <code>next</code> contract, that expects <code>StopIteration</code> to be <i>thrown</i> when there are no items to iterate. That said, this implementation is not compatible with ruby at all and might have many hidden glitches that will turn out to be a production run-time bugs later. The proper way to go is an <code>Enumerator</code> as I showed up in my answer, this is plain wrong and even worse dangerous."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511425192, "post_id": 47424475, "comment_id": 81855961, "body": "@mudasobwa Huh? I&#39;m doing exactly what the documentation says. And <i>&quot;not compatible with ruby at all&quot;</i>? Did you overlook the part where I demonstrate that it works? <i>More</i> than <i>you</i> do, btw, since your demo doesn&#39;t even use anything from <code>Enumerable</code>. And &quot;<code>next</code> contract&quot;? It doesn&#39;t even <i>have</i> a <code>next</code> method. That&#39;s an <code>Enumerator</code> thing, not an <code>Enumerable</code> thing. And if you do want a non-block <code>Enumerator</code> result, just add what mwp said. You even do that yourself (just longer). Then you&#39;d also have a <code>next</code>, and it would do the <code>StopIteration</code>. Can you show an actual problem?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511425938, "post_id": 47424475, "comment_id": 81856396, "body": "Sure. Try to make it <code>lazy</code>."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511426377, "post_id": 47424475, "comment_id": 81856670, "body": "@mudasobwa Ok I just tried that and it worked fine. (It btw already is lazy, isn&#39;t it?)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511427903, "post_id": 47424475, "comment_id": 81857568, "body": "Indeed, it works even with <code>take</code>. Turned out ruby constructs a proper <code>Enumerator</code> in <a href=\"http://ruby-doc.org/core-2.4.0/Object.html#method-i-enum_for\" rel=\"nofollow noreferrer\"><code>Object#enum_for</code></a>. It\u2019s not lazy, though. Please make a small change in the answer so that I could retract my downvote and put what this answer deserves; an upvote."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511428539, "post_id": 47424475, "comment_id": 81857989, "body": "@mudasobwa What do you mean it&#39;s not lazy?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511428843, "post_id": 47424475, "comment_id": 81858205, "body": "\u201cIt btw already is lazy, isn&#39;t it?\u201d\u2014I mean it\u2019s not lazy in the ruby sense. <code>my.map.each { |i| i }</code> wont execute the latter <code>each</code> for each mapped value consequently."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511430459, "post_id": 47424475, "comment_id": 81859322, "body": "@mudasobwa With &quot;It btw already is lazy, isn&#39;t it?&quot; I meant my answer, i.e., my <code>each</code>, as used in <code>MyClass.new.each { |e| puts e }</code>. What&#39;s the <code>my</code> in your example?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511437061, "post_id": 47424475, "comment_id": 81863639, "body": "<code>my = MyClass.new</code>"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511444051, "post_id": 47424475, "comment_id": 81867916, "body": "@mudasobwa Ok, that works and yes, that&#39;s not lazy. Gives me an array. <b>Just like yours does.</b> So I don&#39;t know what your point is with this..."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511610770, "post_id": 47424475, "comment_id": 81926096, "body": "@mudasobwa Oh, I guess I misunderstood your request for &quot;a small change&quot;. I thought you meant a change to fix something and I was trying to find out what you still wanted me to fix. I forgot that SO locks votes. I did make an edit now, adding some further thoughts."}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1511610496, "last_edit_date": 1511610496, "creation_date": 1511307146, "answer_id": 47424475, "question_id": 47414656, "link": "https://stackoverflow.com/questions/47414656/how-to-create-enumerable-class-without-another-enumerable/47424475#47424475", "title": "How to create enumerable class without another enumerable?", "body": "<blockquote>\n  <p>fill in the blanks. What would go in each() to make this an enumerable class?</p>\n</blockquote>\n\n<p>The doc says <a href=\"https://ruby-doc.org/core-2.4.2/Enumerable.html\" rel=\"nofollow noreferrer\"><em>\"The class must provide a method <code>each</code>, which yields successive members of the collection.\"</em></a>. So you could just do that, keep yielding values as long as they're not <code>nil</code>.</p>\n\n<pre><code>def each\n  while val = get_next\n    yield val\n  end\nend\n</code></pre>\n\n<p>Demo:</p>\n\n<pre><code>irb(main):002:0&gt; MyClass.new.each { |e| puts e }\n0.9368650618038962\n0.9784286059513836\n0.9881624526762572\n</code></pre>\n\n<p>Another demo (to show a method from <code>Enumerable</code>):</p>\n\n<pre><code>irb(main):003:0&gt; MyClass.new.map(&amp;:to_f)\n=&gt; [0.6368065208805999, 0.6926393662295052, 0.9911564544581742, 0.35788099831068787]\n</code></pre>\n\n<hr>\n\n<p>So that's enough to make it \"enumerable\", in the sense of successfully mixing in <code>Enumerable</code> (and I don't think there's an official Ruby definition of \"enumerable\"). It's not clear from your question whether you actually need that, btw. If all you want is to go over values with <code>each</code>, then you don't even need to include <code>Enumerable</code>. All that does is give you additional methods like <code>map</code> and <code>select</code>. Even a <code>for</code> loop works just thanks to <code>each</code>, without including <code>Enumerable</code>:</p>\n\n<pre><code>irb(main):002:0&gt; for e in MyClass.new\nirb(main):003:1&gt;   puts e\nirb(main):004:1&gt; end\n0.7638166357043203\n0.18409214000273166\n0.39757329498164495\n0.14658393540113002\n0.948396753859117\n0.3157122887487579\n0.4804571082701993\n</code></pre>\n\n<p>(But note that <code>for</code> loops are generally discouraged: <a href=\"https://stackoverflow.com/a/31263749/1672429\">[1]</a>, <a href=\"https://github.com/bbatsov/ruby-style-guide#user-content-no-for-loops\" rel=\"nofollow noreferrer\">[2]</a>. I'm only showing this to further demonstrate the importance of <code>each</code> and the unimportance of <code>Enumerable</code> for basic iteration.)</p>\n"}], "owner": {"reputation": 557, "user_id": 5527374, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/OQmV2.png?s=128&g=1", "display_name": "tscheingeld", "link": "https://stackoverflow.com/users/5527374/tscheingeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 47414964, "answer_count": 2, "score": 0, "last_activity_date": 1511610496, "creation_date": 1511271924, "question_id": 47414656, "link": "https://stackoverflow.com/questions/47414656/how-to-create-enumerable-class-without-another-enumerable", "title": "How to create enumerable class without another enumerable?", "body": "<p>I asked this same sort of question a few days ago and somehow communication didn't happen. I've restructured my question so that hopefully we can zero in on the issue I need resolved.</p>\n\n<p>The issue is basically this: how do you create an enumerable class that doesn't just use another enumerable? As a simplified but fully working example of what I need to do, consider this class:</p>\n\n<pre><code>class MyClass\n    include Enumerable\n\n    def get_next\n        return_val = rand.to_s\n\n        if return_val.match(/33/)\n            return nil\n        else\n            return return_val\n        end\n    end\n\n    def each\n        # ??????\n    end\nend\n</code></pre>\n\n<p>In this class, get_next calculates a random value. Then, if that value has two 3's next to each other, the method returns nil. Otherwise it returns the value. So you can run get_next over and over, usually for fewer than ten times:</p>\n\n<pre><code>myob = MyClass.new\n\nwhile not myob.get_next.nil?\n    puts 'got one'\nend\n</code></pre>\n\n<p>In reality, get_next searches through thousands of data points. When it finds the next item, it returns a rather voluminous object. It is impossible for a MyClass object to slurp in all items into an array. It needs to get just one at a time.</p>\n\n<p>In point of fact, my class works just fine as structured above. However, I want to implement this in a rubyish way.</p>\n\n<p>So, given the working class above, fill in the blanks. What would go in each() to make this an enumerable class?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511270522, "post_id": 47413970, "comment_id": 81781674, "body": "What&#39;s the point to do that? You already have full country name in <code>option</code> body..."}, {"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511270703, "post_id": 47413970, "comment_id": 81781792, "body": "@nattfodd : I guess OP want full country name as value to store into DB"}], "answers": [{"comments": [{"owner": {"reputation": 2673, "user_id": 960184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8202c5cedc13b7c8449fbb230fc5982?s=128&d=identicon&r=PG", "display_name": "Richard Logwood", "link": "https://stackoverflow.com/users/960184/richard-logwood"}, "edited": false, "score": 0, "creation_date": 1615271613, "post_id": 47418509, "comment_id": 117632700, "body": "The ISO country translation is exactly what I needed - Thank You!"}], "tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": 0, "last_activity_date": 1511283189, "creation_date": 1511283189, "answer_id": 47418509, "question_id": 47413970, "link": "https://stackoverflow.com/questions/47413970/how-to-customize-options-to-get-full-country-name-as-value-of-country-select-gem/47418509#47418509", "title": "How to customize options to get full country name as value of country_select gem?", "body": "<p>If you are using it in the <code>User</code> model, as explained from <a href=\"https://github.com/stefanpenner/country_select#iso-3166-1-alpha-2-codes\" rel=\"nofollow noreferrer\">their doc</a>, you create an instance method called <code>country_name</code>, that will return the <code>country name</code> of that user. Also remember to replace <code>country_code</code> with the attribute of your <code>User</code> model, that you are using to store that country code.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  # Assuming country_select is used with User attribute `country_code`\n  # This will attempt to translate the country name and use the default\n  # (usually English) name if no translation is available\n    def country_name\n      country = ISO3166::Country[country_code]\n      country.translations[I18n.locale.to_s] || country.name\n    end\nend\n</code></pre>\n\n<p>then you use the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html\" rel=\"nofollow noreferrer\"><code>select</code> form helper</a> </p>\n\n<pre><code>select(\"user\", \"country_code\", User.all.collect {|u| [ u.country_name, u.country_code ] })\n</code></pre>\n\n<p>this should generate</p>\n\n<pre><code>&lt;select name=\"user[country_code]\" id=\"user_country_code\"&gt;\n  &lt;option value=\"AF\"&gt;Africa&lt;/option&gt;\n  &lt;option value=\"IT\"&gt;Italy&lt;/option&gt;\n  &lt;option value=\"FR\"&gt;France&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 253, "user_id": 11043967, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-weeDaulyxrM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO6VIkcftWtiYPlNLcPCVoqPPvI1w/mo/photo.jpg?sz=128", "display_name": "Simon Mo", "link": "https://stackoverflow.com/users/11043967/simon-mo"}, "is_accepted": false, "score": 0, "last_activity_date": 1593088329, "creation_date": 1593088329, "answer_id": 62575416, "question_id": 47413970, "link": "https://stackoverflow.com/questions/47413970/how-to-customize-options-to-get-full-country-name-as-value-of-country-select-gem/62575416#62575416", "title": "How to customize options to get full country name as value of country_select gem?", "body": "<p>1/ Make an initializer</p>\n<pre class=\"lang-rb prettyprint-override\"><code># config/initializers/country_select.rb\n\nCountrySelect::FORMATS[:with_full_country_name] = lambda do |country|\n  [\n    country.name,\n    country.alpha2,\n    {\n      'value' =&gt; country.name,\n    }\n  ]\nend\n</code></pre>\n<p>2/ Call it in your view with <code>format</code></p>\n<pre><code>&lt;%= country_select(&quot;user&quot;, &quot;country&quot;, format: :with_full_country_name) %&gt;\n</code></pre>\n<p>As explained in the documentation : <a href=\"https://github.com/stefanpenner/country_select#using-a-custom-formatter\" rel=\"nofollow noreferrer\">https://github.com/stefanpenner/country_select#using-a-custom-formatter</a></p>\n"}], "owner": {"reputation": 43, "user_id": 3206743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01951aa0bc842afea590c836ddf8bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3206743", "link": "https://stackoverflow.com/users/3206743/user3206743"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 560, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1593088329, "creation_date": 1511269922, "question_id": 47413970, "link": "https://stackoverflow.com/questions/47413970/how-to-customize-options-to-get-full-country-name-as-value-of-country-select-gem", "title": "How to customize options to get full country name as value of country_select gem?", "body": "<p>I have used <strong><a href=\"https://github.com/stefanpenner/country_select\" rel=\"nofollow noreferrer\">country_select</a></strong> gem, it working fine, now I want to set option value as full country name same as what it displayed in dropdown, not contry code.</p>\n\n<p>for eg: I am getting like below:</p>\n\n<pre><code>&lt;select id=\"order_ship_country\" name=\"order[ship_country]\"&gt;\n    &lt;option value=\"AU\"&gt;Australia&lt;/option&gt;\n    &lt;option value=\"CA\"&gt;Canada&lt;/option&gt;\n    &lt;option value=\"GB\"&gt;United Kingdom&lt;/option&gt;\n    &lt;option value=\"US\"&gt;United States&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>But I am expecting like this:</p>\n\n<pre><code>&lt;select id=\"order_ship_country\" name=\"order[ship_country]\"&gt;\n    &lt;option value=\"Australia\"&gt;Australia&lt;/option&gt;\n    &lt;option value=\"Canada\"&gt;Canada&lt;/option&gt;\n    &lt;option value=\"United Kingdom\"&gt;United Kingdom&lt;/option&gt;\n    &lt;option value=\"United States\"&gt;United States&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "httparty", "webmock"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1511267416, "post_id": 47412819, "comment_id": 81779559, "body": "Can you add the rspec code that&#39;s not working?"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511267611, "post_id": 47412819, "comment_id": 81779702, "body": "also a part of controller responsible for handling input params will help as well"}], "owner": {"reputation": 569, "user_id": 3797956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/36a6be2353c564135c691235a570be03?s=128&d=identicon&r=PG&f=1", "display_name": "pandomic", "link": "https://stackoverflow.com/users/3797956/pandomic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511270455, "creation_date": 1511266205, "last_edit_date": 1511270455, "question_id": 47412819, "link": "https://stackoverflow.com/questions/47412819/httparty-webmock-invalid-url-inside-specs", "title": "HTTParty + Webmock | Invalid url inside specs", "body": "<p>When running requests with <code>disable_rails_query_string_format</code> with such query params:</p>\n\n<pre><code>query: {selected_ids: [1,2,3]}\n</code></pre>\n\n<p>It works fine when running the code in the app, but when running specs, the url become truncated and only last element of the array is taken, so that url become <code>selected_ids=3</code> instead of <code>selected_ids=1&amp;selected_ids=2&amp;selected_ids=3</code>.</p>\n\n<p>Don't know if that matter, but additionally we use Webmock to stub requests inside specs.</p>\n\n<p>Maybe someone ran the same issue and know what may cause it?</p>\n\n<p><strong>Update, code abstraction</strong></p>\n\n<p>Let's say, here's a service called Client:</p>\n\n<pre><code>class Client\n  include HTTParty\n\n  SOME_ENDPOINT = 'http://someurl.com/some-endpoint'.freeze\n\n  def do_get(options = {})\n    self.class.disable_rails_query_string_format\n    self.class.get(SOME_ENDPOINT, options)\n  end\nend\n</code></pre>\n\n<p>And at some point it gets executed, let's say, by some action performed by controller, which delegates execution to resource and resource executes that service:</p>\n\n<pre><code># Somewhere in resource\nClient.new.do_get(selected_ids: [1, 2, 3])\n</code></pre>\n\n<p>When the code above gets executed in non-test environment, <code>Client</code> makes a correct call to <code>http://someurl.com/some-endpoint?selected_ids=1&amp;selected_ids=2&amp;selected_ids=3</code></p>\n\n<p>But under specs, when doing the same thing without <code>stub_request</code>, Webmock error got raised indicating the unmocked url, which is incorrect: <code>http://someurl.com/some-endpoint?selected_ids=3</code></p>\n\n<p>Generally, spec is not doing some extra steps and looks like standard RSpec specs:</p>\n\n<pre><code>describe Client\n  subject { Client.new.do_get(selected_ids: [1, 2, 3]) }\n\n  it\n    subject\n  end\nend\n\n# -&gt; Webmock error - unregistered request to \n# http://someurl.com/some-endpoint?selected_ids=3,\n# but it should be to \n# http://someurl.com/some-endpoint?selected_ids=1&amp;selected_ids=2&amp;selected_ids=3\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "json", "ruby"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511267144, "post_id": 47412733, "comment_id": 81779424, "body": "Do you want result to be a hash, or are there any other requirements?"}, {"owner": {"reputation": 982, "user_id": 7850578, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/48efe78ee937358fb944ee7a94e1f71b?s=128&d=identicon&r=PG&f=1", "display_name": "Pattatharasu Nataraj", "link": "https://stackoverflow.com/users/7850578/pattatharasu-nataraj"}, "reply_to_user": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1511267303, "post_id": 47412733, "comment_id": 81779508, "body": "Hash or array anything is fine"}, {"owner": {"reputation": 982, "user_id": 7850578, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/48efe78ee937358fb944ee7a94e1f71b?s=128&d=identicon&r=PG&f=1", "display_name": "Pattatharasu Nataraj", "link": "https://stackoverflow.com/users/7850578/pattatharasu-nataraj"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1511267673, "post_id": 47412733, "comment_id": 81779743, "body": "@SebastianPalma JSON input is from API all data are string."}, {"owner": {"reputation": 2309, "user_id": 8039858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05a1367657700f0980a87767d797273?s=128&d=identicon&r=PG&f=1", "display_name": "nullqube", "link": "https://stackoverflow.com/users/8039858/nullqube"}, "edited": false, "score": 0, "creation_date": 1511273445, "post_id": 47412733, "comment_id": 81783789, "body": "try : data[entry.date] = [ ... ]"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511269453, "post_id": 47413318, "comment_id": 81780909, "body": "Abusing <code>each</code> with a previously declared local variable is a code smell. Use e. g. <code>each_with_object</code> instead. Also, to make a default hash element to be empty array, use <code>data = Hash.new { |h, k| h[k] = [] }</code>."}, {"owner": {"reputation": 66, "user_id": 2958213, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000244607580/picture?type=large", "display_name": "evngcdr", "link": "https://stackoverflow.com/users/2958213/evngcdr"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1511281370, "post_id": 47413318, "comment_id": 81789603, "body": "Thank you for advice @mudasobwa! Didn&#39;t know that:)"}], "tags": [], "owner": {"reputation": 66, "user_id": 2958213, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000244607580/picture?type=large", "display_name": "evngcdr", "link": "https://stackoverflow.com/users/2958213/evngcdr"}, "is_accepted": false, "score": 1, "last_activity_date": 1511268802, "last_edit_date": 1511268802, "creation_date": 1511267862, "answer_id": 47413318, "question_id": 47412733, "link": "https://stackoverflow.com/questions/47412733/split-multi-dimensional-array-in-ruby/47413318#47413318", "title": "split multi-dimensional array in ruby", "body": "<p>First of all, are adding fields to your array <code>data</code>, as I can see from your desired output, you need a hash.</p>\n\n<p>You have to create the hash, not the array:</p>\n\n<pre><code>data = {}\n</code></pre>\n\n<p>and then in your loop</p>\n\n<pre><code>raw_data['entries'].each do |entry|\n</code></pre>\n\n<p>add it like that</p>\n\n<pre><code>data[entry_date] = [   \n                     {\n                       \"content\" =&gt; entry.title,\n                       \"allDay\" =&gt; true,\n                     },\n                     {                                                           \n                       \"content\" =&gt; entry.writer,\n                       \"allDay\" =&gt; true,\n                     },\n                   ]\n</code></pre>\n\n<p>(I am not where do you declare entry_date in your example so it might be entry.date)</p>\n\n<p>I can't tell from your example if entry date is unique or not(and I think it's not) make sure you add to hash, because you might overwrite it.</p>\n\n<p>You can do something like this if entry date isn't unique</p>\n\n<pre><code>data[entry.date] ||= []\ndata[entry.date] &lt;&lt; {hash_you_need}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1511269783, "last_edit_date": 1511269783, "creation_date": 1511269369, "answer_id": 47413800, "question_id": 47412733, "link": "https://stackoverflow.com/questions/47412733/split-multi-dimensional-array-in-ruby/47413800#47413800", "title": "split multi-dimensional array in ruby", "body": "<p>Ruby implementation would look like:</p>\n\n<pre><code>data = raw_data['entries'].map do |entry|\n  [entry.date,  [entry.title, entry.writer].map do |content|\n                  {content: content, allDay: true}\n                end]\nend.to_h\n</code></pre>\n"}], "owner": {"reputation": 982, "user_id": 7850578, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/48efe78ee937358fb944ee7a94e1f71b?s=128&d=identicon&r=PG&f=1", "display_name": "Pattatharasu Nataraj", "link": "https://stackoverflow.com/users/7850578/pattatharasu-nataraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 47413800, "answer_count": 2, "score": 0, "last_activity_date": 1511269783, "creation_date": 1511265926, "last_edit_date": 1511266269, "question_id": 47412733, "link": "https://stackoverflow.com/questions/47412733/split-multi-dimensional-array-in-ruby", "title": "split multi-dimensional array in ruby", "body": "<p>I am trying to parse json data in ruby my desired output is:</p>\n\n<pre><code>var events = {  '01-01-2018' : \n                [ {content: 'Psalm 2',  allDay: true},\n                  {content: 'by ToddWagner', allDay: true}\n                ],\n                '01-02-2018' :\n                [ {content: 'Psalm 2', allDay: true},\n                  {content: 'by ToddWagner', allDay: true}\n                                            ]\n                        }\n</code></pre>\n\n<p>what I get is</p>\n\n<pre><code>var events = [\n                {\"2017-11-03\":\n                        [ {\"content\":\"Romans 14:5-12\",\"allDay\":true},\n                          {\"content\":\"by Micah Leiss\",\"allDay\":true}\n                            ]\n                        },\n                {\"2017-11-06\":\n                       [{\"content\":\"Romans 14:13\",\"allDay\":true},\n                        {\"content\":\"by Sarah Thomas\",\"allDay\":true}\n                        ]\n                }\n            ]\n</code></pre>\n\n<p>I tried something like </p>\n\n<pre><code>data = [] \nraw_data['entries'].each do |entry|\n    data &lt;&lt; {entry_date =&gt; [\n                                {\n                                  \"content\" =&gt; entry.title,\n                                  \"allDay\" =&gt; true,\n                                },\n                                {                                                           \n                                  \"content\" =&gt; entry.writer,\n                                  \"allDay\" =&gt; true,\n                                },\n                            ]\n                        }\nend\ndata.to_json\n</code></pre>\n\n<p>but I didn't get desired results, I have also tried data.pop data.shift.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1511266467, "post_id": 47412569, "comment_id": 81778986, "body": "What exactly are you trying to get a list of? All jobs what are <i>defined</i> in <code>clock.rb</code>? All background tasks that are <i>currently scheduled</i> (or running)?"}, {"owner": {"reputation": 11, "user_id": 7124710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/617e9f11bb991e894cf1b278e0ea764c?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan", "link": "https://stackoverflow.com/users/7124710/narayanan"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511319020, "post_id": 47412569, "comment_id": 81806900, "body": "I am trying to get the list of jobs name to display it in the frontend. Background jobs are defined in clock.rb background tasks are scheduled. I need run the jobs manually from UI. @TomLord"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511345215, "post_id": 47431708, "comment_id": 81817937, "body": "Also, note that your &quot;list of background jobs&quot; <i>may</i> (?) only be a <i>subset</i> of the jobs defined in <code>clock.rb</code>. Therefore, consider whether this is really the correct approach you wish to take..."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1511344935, "creation_date": 1511344935, "answer_id": 47431708, "question_id": 47412569, "link": "https://stackoverflow.com/questions/47412569/get-the-list-of-background-jobs-from-clock-rb-file/47431708#47431708", "title": "Get the list of background jobs from clock.rb file", "body": "<p>I had to dig a little into <a href=\"https://github.com/Rykian/clockwork/blob/11f80a0f206d17060b07a55bffec23e935279d1c/lib/clockwork/manager.rb#L65\" rel=\"nofollow noreferrer\">the source code</a> to find a way of doing this directly:</p>\n\n<pre><code># This is the demo file from the gem's README:\n\nrequire 'clockwork'\nmodule Clockwork\n  handler do |job|\n    puts \"Running #{job}\"\n  end\n\n  every(10.seconds, 'frequent.job')\n  every(3.minutes, 'less.frequent.job')\n  every(1.hour, 'hourly.job')\n\n  every(1.day, 'midnight.job', :at =&gt; '00:00')\nend\n\n# Here is a way to then access the defined events:\n\nClockwork.manager.instance_variable_get('@events').map(&amp;:to_s)\n#=&gt; [\"frequent.job\", \"less.frequent.job\", \"hourly.job\", \"midnight.job\"]\n</code></pre>\n\n<p>Again, looking at the source code, the way this library works is that (for example) when you call <code>every(period, job_name)</code>, this <a href=\"https://github.com/Rykian/clockwork/blob/11f80a0f206d17060b07a55bffec23e935279d1c/lib/clockwork/manager.rb#L48-L58\" rel=\"nofollow noreferrer\">registers an event</a> in the <code>Clockwork.manager</code>.</p>\n\n<p>However, a word of warning: Accessing private data - namely <code>instance_variable_get('@events')</code> - is depending on the <em>internal implementation</em> of the library. It was not designed to be used this way, and therefore there is a risk that the implementation could completely change in a future version of the gem.</p>\n\n<p>That's not to say \"don't do this\", but rather, \"do this <em>with caution</em>\". And if you plan to rely on this functionality heavily, consider forking the project (or even submitting a PR?) to make it an official feature of the library.</p>\n"}], "owner": {"reputation": 11, "user_id": 7124710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/617e9f11bb991e894cf1b278e0ea764c?s=128&d=identicon&r=PG&f=1", "display_name": "Narayanan", "link": "https://stackoverflow.com/users/7124710/narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511344935, "creation_date": 1511265374, "last_edit_date": 1511266627, "question_id": 47412569, "link": "https://stackoverflow.com/questions/47412569/get-the-list-of-background-jobs-from-clock-rb-file", "title": "Get the list of background jobs from clock.rb file", "body": "<p>I need to get the list of jobs from clock.rb file through controller. I am using ruby 2.3.3,rails 4.2 and clock gem to define the job. </p>\n\n<p>In my clock.rb file my code was</p>\n\n<pre><code>module Clockwork\n  handler do |job, time|\n    Rails.logger.warn \"Running #{job}, at #{time}\"\n  end\n\n  configure do |config|\n    config[:logger] = Rails.logger\n  end\n\n  def self.job1?\n    # ...\n  end\n\n  def self.job2?\n    # ...\n  end\nend\n</code></pre>\n\n<p>In my controller how to I get the job list, any idea how to get this done?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": true, "score": 4, "last_activity_date": 1511268259, "last_edit_date": 1511268259, "creation_date": 1511265093, "answer_id": 47412467, "question_id": 47412423, "link": "https://stackoverflow.com/questions/47412423/cant-get-rails-activerecord-condifions-working-wrong-number-of-arguments-giv/47412467#47412467", "title": "Cant get rails ActiveRecord :condifions working, &#39;wrong number of arguments (given 1, expected 0)&#39;", "body": "<p>You're trying to apply 2.3 query syntax to ActiveRecord 5.x. The proper way is:</p>\n\n<pre><code>@this_section = Section.where(url_section: params[:section])\n</code></pre>\n\n<p>or probably more accurately (since you seem to need only one instance in this case):</p>\n\n<pre><code>@this_section = Section.find_by(url_section: params[:section])\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 8423250, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/EBMqt.jpg?s=128&g=1", "display_name": "Ben Edwards", "link": "https://stackoverflow.com/users/8423250/ben-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 47412467, "answer_count": 1, "score": 0, "last_activity_date": 1511268259, "creation_date": 1511264970, "last_edit_date": 1511265224, "question_id": 47412423, "link": "https://stackoverflow.com/questions/47412423/cant-get-rails-activerecord-condifions-working-wrong-number-of-arguments-giv", "title": "Cant get rails ActiveRecord :condifions working, &#39;wrong number of arguments (given 1, expected 0)&#39;", "body": "<p>I have the following code for an active record condition in a controller</p>\n\n<pre><code> @this_section = Section.all( :conditions =&gt; [ \"url_section = ?\", params[:ssection] ] )\n</code></pre>\n\n<p>And when I try to goto to the webpage associated with it I get the following error in the browser:</p>\n\n<pre><code>ArgumentError in UpcomingEventsController#index\n\nwrong number of arguments (given 1, expected 0)\n</code></pre>\n\n<p>And in the puma log I am getting:</p>\n\n<pre><code> Started GET \"/\" for 127.0.0.1 at 2017-11-21 11:06:22 +0000\n Processing by UpcomingEventsController#index as HTML\n Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms)\n\n ArgumentError (wrong number of arguments (given 1, expected 0)):\n\n app/controllers/upcoming_events_controller.rb:11:in `index'\n</code></pre>\n\n<p>11 is the line of code at the top of this post</p>\n\n<p>I was using  <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_querying.html</a> to work out how to do it.</p>\n\n<p>The route for this page is</p>\n\n<pre><code>   get 'upcoming_events/:ssection/:cost', to: 'upcoming_events#index'\n</code></pre>\n\n<p>What I am trying to do is set @this_section to the record from the sections table of the database WHERE url_section = params[:ssection].  I am using rails 5.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "gmail", "actionmailer"], "comments": [{"owner": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1511265900, "post_id": 47411833, "comment_id": 81778588, "body": "also check in your gmail outbox"}, {"owner": {"reputation": 634, "user_id": 4788165, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/62bb9b2e30fa2f0d1b17a2353e97ecb9?s=128&d=identicon&r=PG&f=1", "display_name": "JOSEMAFUEN", "link": "https://stackoverflow.com/users/4788165/josemafuen"}, "reply_to_user": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1511267481, "post_id": 47411833, "comment_id": 81779606, "body": "It&#39;s empty, I&#39;ll edit the question"}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 6040776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bf544476832e38323f66dfb9c7c0b7?s=128&d=identicon&r=PG", "display_name": "hezanathos", "link": "https://stackoverflow.com/users/6040776/hezanathos"}, "is_accepted": true, "score": 0, "last_activity_date": 1511272714, "last_edit_date": 1511272714, "creation_date": 1511269373, "answer_id": 47413802, "question_id": 47411833, "link": "https://stackoverflow.com/questions/47411833/rails-mailer-not-sending/47413802#47413802", "title": "Rails mailer not sending", "body": "<p>For a better mail debugging you can try the bang method <a href=\"http://www.rubydoc.info/github/rails/rails/ActionMailer%2FMessageDelivery%3Adeliver_now!\" rel=\"nofollow noreferrer\">deliver_now!</a> and see if it raises any exeption (for example password issue).</p>\n\n<blockquote>\n  <p>Method: ActionMailer::MessageDelivery#deliver_now!</p>\n  \n  <p>Defined in:\n      actionmailer/lib/action_mailer/message_delivery.rb </p>\n  \n  <h1>deliver_now! \u21d2 Object</h1>\n  \n  <p>Delivers an email without checking perform_deliveries and\n  raise_delivery_errors, so use with caution.</p>\n  \n  <p>Notifier.welcome(User.first).deliver_now!</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 634, "user_id": 4788165, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/62bb9b2e30fa2f0d1b17a2353e97ecb9?s=128&d=identicon&r=PG&f=1", "display_name": "JOSEMAFUEN", "link": "https://stackoverflow.com/users/4788165/josemafuen"}, "is_accepted": false, "score": 1, "last_activity_date": 1511272289, "creation_date": 1511272289, "answer_id": 47414794, "question_id": 47411833, "link": "https://stackoverflow.com/questions/47411833/rails-mailer-not-sending/47414794#47414794", "title": "Rails mailer not sending", "body": "<p>It seems That the connection was being refused. Restarting the server solved the problem.</p>\n"}], "owner": {"reputation": 634, "user_id": 4788165, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/62bb9b2e30fa2f0d1b17a2353e97ecb9?s=128&d=identicon&r=PG&f=1", "display_name": "JOSEMAFUEN", "link": "https://stackoverflow.com/users/4788165/josemafuen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 47413802, "answer_count": 2, "score": 2, "last_activity_date": 1511272714, "creation_date": 1511263203, "last_edit_date": 1511267655, "question_id": 47411833, "link": "https://stackoverflow.com/questions/47411833/rails-mailer-not-sending", "title": "Rails mailer not sending", "body": "<p>I'm trying to send a 'password-reset' mail through my Rails application. But the problem is that the email never arrives although my logs say it is sent.</p>\n\n<p>Here's the config in config/environments/development.rb</p>\n\n<pre><code>config.action_mailer.delivery_method = :smtp\n  config.action_mailer.smtp_settings = {\n      address:              'smtp.gmail.com',\n      port:                 587,\n      user_name:            'xxxxx@gmail.com',\n      password:             'yyyyy',\n      authentication:       'plain',\n      enable_starttls_auto: true  }\n</code></pre>\n\n<p>My app/mailers/user_mailer.rb:</p>\n\n<pre><code>class UserMailer &lt; ActionMailer::Base\n  default from: \"xxxxx@gmail.com\"\n\n  def password_reset(user)\n    @user = user\n    mail :to =&gt; user.email, :subject =&gt; \"Password Reset\"\n  end\nend\n</code></pre>\n\n<p>And the method that calls the mailer in app/models/user.rb</p>\n\n<pre><code>def send_password_reset\n    generate_token(:password_reset_token)\n    self.password_reset_sent_at = Time.zone.now\n    save!(:validate =&gt; false)\n    UserMailer.password_reset(self).deliver_now\n  end\n</code></pre>\n\n<p>The views and everything are ok because, as I said, the logs say that the email was sent successfully, I must be missing some configuration I guess. Here are the logs:</p>\n\n<pre><code>Sent mail to zzzzz@hotmail.com (2007.7ms)\nDate: Tue, 21 Nov 2017 12:10:46 +0100\nFrom: xxxxx@gmail.com\nTo: zzzzz@hotmail.com\nMessage-ID: &lt;5a1409b627bb8_3ca86e9450429578@DESKTOP-85KSOM4.mail&gt;\nSubject: Password Reset\nMime-Version: 1.0\nContent-Type: text/plain;\n charset=UTF-8\nContent-Transfer-Encoding: quoted-printable\n\nSigue el siguiente enlace para restablecer la contrase=C3=B1a\nhttp://localhost:3000/password_resets/w0F77qrpHbM9HvXaFElWGA/edit\nIgnora este email si no pediste el cambio.\n\nRedirected to http://localhost:3000/\n</code></pre>\n\n<p>Moreover, the outbox of the sender gmail is empty but I have allowed less secure apps to access my gmail account, so the problem must be another thing. I don't know how to debug what's going wrong.</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "cucumber", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 180, "user_id": 8014464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FMMjH.jpg?s=128&g=1", "display_name": "theRubyGuy", "link": "https://stackoverflow.com/users/8014464/therubyguy"}, "edited": false, "score": 0, "creation_date": 1511344561, "post_id": 47411429, "comment_id": 81817520, "body": "Found the answer to my question."}], "owner": {"reputation": 180, "user_id": 8014464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FMMjH.jpg?s=128&g=1", "display_name": "theRubyGuy", "link": "https://stackoverflow.com/users/8014464/therubyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1511344778, "creation_date": 1511261954, "last_edit_date": 1511344778, "question_id": 47411429, "link": "https://stackoverflow.com/questions/47411429/getting-an-error-while-trying-to-load-a-cucumber-test-undefined-method-as-json", "title": "Getting an error while trying to load a cucumber test (undefined method `as_json&#39; for nil:NilClass)", "body": "<p>I upgraded my VM environment with the following versions:</p>\n\n<ul>\n<li>cucumber 2.4.0</li>\n<li>selenium-webdriver 3.7.0</li>\n<li>ruby 2.4.1</li>\n<li>chrome 62.0.3202.94 </li>\n<li>ChromeDriver 2.33.506092</li>\n</ul>\n\n<p>my env.rb is configured with the following attributes:</p>\n\n<pre><code>    $browser = Selenium::WebDriver.for :chrome, options: options\n    $browser.manage.window.maximize\n</code></pre>\n\n<p>I'm trying to run any test and i'm getting the following error:</p>\n\n<pre><code>    undefined method `as_json' for nil:NilClass (NoMethodError)\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/selenium-webdriver-3.7.0/lib/selenium/webdriver/chrome/driver.rb:111:in `create_capabilities'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/selenium-webdriver-3.7.0/lib/selenium/webdriver/chrome/driver.rb:33:in `initialize'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/selenium-webdriver-3.7.0/lib/selenium/webdriver/common/driver.rb:44:in `new'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/selenium-webdriver-3.7.0/lib/selenium/webdriver/common/driver.rb:44:in `for'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/selenium-webdriver-3.7.0/lib/selenium/webdriver.rb:84:in `for'\n    /home/glasner/repos/portal_automation/features/support/env.rb:193:in `block in &lt;top (required)&gt;'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/retriable-3.1.1/lib/retriable.rb:61:in `block in retriable'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/retriable-3.1.1/lib/retriable.rb:57:in `times'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/retriable-3.1.1/lib/retriable.rb:57:in `retriable'\n    /home/glasner/repos/portal_automation/features/support/env.rb:189:in `&lt;top (required)&gt;'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/rb_support/rb_language.rb:96:in `load'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/rb_support/rb_language.rb:96:in `load_code_file'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:142:in `load_file'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:84:in `block in load_files!'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:83:in `each'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime/support_code.rb:83:in `load_files!'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime.rb:253:in `load_step_definitions'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/runtime.rb:61:in `run!'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/lib/cucumber/cli/main.rb:32:in `execute!'\n    /home/glasner/.rvm/gems/ruby-2.4.1/gems/cucumber-2.4.0/bin/cucumber:8:in `&lt;top (required)&gt;'\n    /home/glasner/.rvm/gems/ruby-2.4.1/bin/cucumber:23:in `load'\n    /home/glasner/.rvm/gems/ruby-2.4.1/bin/cucumber:23:in `&lt;main&gt;'\n    /home/glasner/.rvm/gems/ruby-2.4.1/bin/ruby_executable_hooks:15:in `eval'\n    /home/glasner/.rvm/gems/ruby-2.4.1/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>I tried using different version of all of the above but it seems that the problem is that new \"options\" configurations for the chrome browser.\nWhich option should I use in order to solve that problem?</p>\n\n<p>Thank you! :)</p>\n\n<p><strong>UPDATE</strong>:</p>\n\n<p>Found the answer to the problem.\nI had a method for running the tests in a headless mode that initialize the options variable, but that wasn't good enough.\noptions variable should be initialized before we configure the driver, as such:</p>\n\n<pre><code>   options = Selenium::WebDriver::Chrome::Options.new\n   $browser = Selenium::WebDriver.for :chrome, options: options\n   $browser.manage.window.maximize\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511259819, "post_id": 47410424, "comment_id": 81774575, "body": "I just skimmed through the code... Without digging into what it&#39;s actually trying to do, I quickly noticed that you&#39;re <b>never putting anything in the <code>@highest_count_words_across_lines</code> array</b>!! You initialise it with <code>nil</code>, then set it to <code>Array.new</code>, then you never populate any values. So your final result is empty."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511259988, "post_id": 47410424, "comment_id": 81774674, "body": "<code>[].map(&amp;:highest_wf_words) == []</code>, and <code>[].flatten == []</code>. So since you never actually populate the array with any data, the rest of the code executes fine, but you still end up with an empty final result."}, {"owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511260115, "post_id": 47410424, "comment_id": 81774773, "body": "I tried doing this: @highest_count_words_across_lines = analyzer.highest_wf_words, to no avail."}, {"owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511260549, "post_id": 47410424, "comment_id": 81775088, "body": "Explicitly which line of code should I add and where? Can&#39;t figure out."}, {"owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511261856, "post_id": 47410424, "comment_id": 81775970, "body": "Implement the calculate_line_with_highest_frequency() method to: identifies the &#39;LineAnalyzer&#39; objects in the &#39;analyzers&#39; array that have &#39;highest_wf_count == highest_count_across_lines&#39;  attribute value determined previously and store them in &#39;highest_count_words_across_lines&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 0, "last_activity_date": 1511261842, "creation_date": 1511261842, "answer_id": 47411391, "question_id": 47410424, "link": "https://stackoverflow.com/questions/47410424/calculates-highest-count-words-across-lines-to-be-will-it-really-failed-1/47411391#47411391", "title": "calculates highest count words across lines to be will, it, really (FAILED - 1) ruby rspec", "body": "<p>As I said above, your immediate problem is that the <code>@highest_count_words_across_lines</code> is only ever set to an empty array - so the final result will inevitably also be empty.</p>\n\n<p>You could build a list of all words containing the maximum number of repetitions as follows:</p>\n\n<pre><code>@highest_count_words_across_lines = analyzers.map do |analyzer|\n  analyzer.highest_wf_words.select do |word, count|\n    count == highest_count_across_lines\n  end\nend.flat_map(&amp;:keys)\n</code></pre>\n\n<p>You may wish to move some of that logic into the <code>LineAnalyzer</code> class, e.g. in a <code>LineAnalyzer#words_of_length(length)</code> method.</p>\n\n<p>Note that this will only return <em>two</em> values <code>[\"really\", \"it\"]</code>. This is because your code is currently considering the first <code>\"Will\"</code> to be a different word as it is capitalised. If this is not desired, then you should <code>downcase</code> all words when analysing the file.</p>\n"}, {"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511274946, "post_id": 47414324, "comment_id": 81784877, "body": "Sorry... To clarify, my demo code was to make <code>solution.highest_count_words_across_lines</code> the <b>answer</b>. You don&#39;t need to call any additional methods on it. Of course, if you wish to redesign the code to work in such a way, then go for it."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1511275010, "post_id": 47414324, "comment_id": 81784925, "body": "Also, this should not be submitted as an <i>answer</i>. Additional information like this should either be added as an <a href=\"https://stackoverflow.com/posts/47410424/edit\">edit</a> to your original post, or as a comment under mine."}], "tags": [], "owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "is_accepted": false, "score": 0, "last_activity_date": 1511820560, "last_edit_date": 1511820560, "creation_date": 1511271023, "answer_id": 47414324, "question_id": 47410424, "link": "https://stackoverflow.com/questions/47410424/calculates-highest-count-words-across-lines-to-be-will-it-really-failed-1/47414324#47414324", "title": "calculates highest count words across lines to be will, it, really (FAILED - 1) ruby rspec", "body": "<p>Thanks very much @Tom for your help. After some efforts the code below passed but not before applying the downcase at the LineAnalyser class level as you suggested:</p>\n\n<pre><code> @highest_count_across_lines = analyzers.sort_by { |analyzer| analyzer.highest_wf_count }.reverse.first.highest_wf_count\n    @highest_count_words_across_lines = analyzers.select { |analyzer| @highest_count_across_lines == analyzer.highest_wf_count  }\n</code></pre>\n\n<p><br/>\nMany thanks again.</p>\n"}], "owner": {"reputation": 5, "user_id": 3845145, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001389942709/picture?type=large", "display_name": "Akame Brice", "link": "https://stackoverflow.com/users/3845145/akame-brice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 47411391, "answer_count": 2, "score": 0, "last_activity_date": 1511820560, "creation_date": 1511259099, "question_id": 47410424, "link": "https://stackoverflow.com/questions/47410424/calculates-highest-count-words-across-lines-to-be-will-it-really-failed-1", "title": "calculates highest count words across lines to be will, it, really (FAILED - 1) ruby rspec", "body": "<p>I've asked this question before and maybe I wasn't clear enough (or didn't) put all the details of the my question.\nIt's been weeks now frustration is killing me on this assignment as I continue to switch sessions and the assignment itself seems enigmatic to everybody on Coursera since nobody has really answered the question in all the posts I've read.</p>\n\n<p><a href=\"https://drive.google.com/file/d/0BxOTj_EJTdDGdTFsczNHTjJzYzg/view%20%22%20Here%20are%20the%20assignment%20questions\" rel=\"nofollow noreferrer\">Here are the assignment questions</a>\n<br/> <br/>Meanwhile this is my code: </p>\n\n<pre><code>#Implement all parts of this assignment within (this) module2_assignment2.rb file\n\n#Implement a class called LineAnalyzer.\nclass LineAnalyzer\n  #Implement the following read-only attributes in the LineAnalyzer class. \n  #* highest_wf_count - a number with maximum number of occurrences for a single word (calculated)\n  #* highest_wf_words - an array of words with the maximum number of occurrences (calculated)\n  #* content          - the string analyzed (provided)\n  #* line_number      - the line number analyzed (provided)\n\n  #Add the following methods in the LineAnalyzer class.\n  #* initialize() - taking a line of text (content) and a line number\n  #* calculate_word_frequency() - calculates result\n\n  #Implement the initialize() method to:\n  #* take in a line of text and line number\n  #* initialize the content and line_number attributes\n  #* call the calculate_word_frequency() method.\n\n  #Implement the calculate_word_frequency() method to:\n  #* calculate the maximum number of times a single word appears within\n  #  provided content and store that in the highest_wf_count attribute.\n  #* identify the words that were used the maximum number of times and\n  #  store that in the highest_wf_words attribute.\n\n    attr_accessor :highest_wf_count, :highest_wf_words, :content, :line_number\n\n\n    def initialize(content, line)\n    @content = content\n    @line_number = line\n    @highest_wf_count=0\n    calculate_word_frequency()\n  end\n\n  def calculate_word_frequency()\n    @highest_wf_words = Hash.new\n    words = @content.split\n    words.each { |w|\n      if @highest_wf_words.has_key?(w)\n        @highest_wf_words[w] += 1\n      else\n        @highest_wf_words[w] = 1\n      end\n    }\n    @highest_wf_words.sort_by { |word, count| count }\n    @highest_wf_words.each do |key, value|\n      if value &gt; @highest_wf_count\n        @highest_wf_count = value\n      end\n    end\n  end\n\n  def highest_wf_count= (number)\n    @highest_wf_count = number\n  end\n\nend\n\n\n#  Implement a class called Solution. \nclass Solution\n\n  # Implement the following read-only attributes in the Solution class.\n  #* analyzers - an array of LineAnalyzer objects for each line in the file\n  #* highest_count_across_lines - a number with the maximum value for highest_wf_words attribute in the analyzers array.\n  #* highest_count_words_across_lines - a filtered array of LineAnalyzer objects with the highest_wf_words attribute \n  #  equal to the highest_count_across_lines determined previously.\n\n  # Implement the following methods in the Solution class.\n  #* analyze_file() - processes 'test.txt' into an array of LineAnalyzers and stores them in analyzers.\n  #* calculate_line_with_highest_frequency() - determines the highest_count_across_lines and \n  #  highest_count_words_across_lines attribute values  \n  #* print_highest_word_frequency_across_lines() - prints the values of LineAnalyzer objects in \n  #  highest_count_words_across_lines in the specified format\n\n\n  # Implement the analyze_file() method() to:\n  #* Read the 'test.txt' file in lines \n  #* Create an array of LineAnalyzers for each line in the file\n\n  # Implement the calculate_line_with_highest_frequency() method to:\n  #* calculate the maximum value for highest_wf_count contained by the LineAnalyzer objects in analyzers array\n  #  and stores this result in the highest_count_across_lines attribute.\n  #* identifies the LineAnalyzer objects in the analyzers array that have highest_wf_count equal to highest_count_across_lines \n  #  attribute value determined previously and stores them in highest_count_words_across_lines.\n\n  #Implement the print_highest_word_frequency_across_lines() method to\n  #* print the values of objects in highest_count_words_across_lines in the specified format\n  attr_reader  :analyzers, :highest_count_across_lines, :highest_count_words_across_lines\n\n  def initialize()\n    @analyzers = Array.new\n    @highest_count_across_lines = nil\n    @highest_count_words_across_lines = nil\n  end\n\n  def analyze_file()\n    File.foreach('test.txt').with_index(1) do |content, line|\n      line_analyzer = LineAnalyzer.new(content, line)\n      @analyzers &lt;&lt; line_analyzer\n    end\n  end\n\n  def calculate_line_with_highest_frequency()\n    @highest_count_across_lines = 0\n    @highest_count_words_across_lines = Array.new\n    @analyzers.each do |analyzer|\n      if analyzer.highest_wf_count &gt; @highest_count_across_lines\n        @highest_count_across_lines = analyzer.highest_wf_count\n      end\n    end\n  end\n\n  def print_highest_word_frequency_across_lines()\n    @highest_count_words_across_lines = Array.new\n    puts \"The following words have the highest word frequency per line:\" \n\n  end\nend\n</code></pre>\n\n<p>This is the rspec file for <code>class = solution</code>:\n<br/></p>\n\n<pre><code>require_relative \"../module2_assignment\"\nrequire 'rspec'\n\ndescribe Solution do\n  subject(:solution) { Solution.new }\n\n  it { is_expected.to respond_to(:analyze_file) } \n  it { is_expected.to respond_to(:calculate_line_with_highest_frequency) } \n  it { is_expected.to respond_to(:print_highest_word_frequency_across_lines) } \n\n  context \"#analyze_file\" do\n    it \"creates 3 line analyzers\" do\n      expect(solution.analyzers.length).to eq 0 \n      solution.analyze_file\n      expect(solution.analyzers.length).to eq 3\n    end  \n  end\n\n  context \"#calculate_line_with_highest_frequency\" do\n\n\n    it \"calculates highest count across lines to be 4\" do\n      solution.analyze_file\n\n      expect(solution.highest_count_across_lines).to be nil\n\n      solution.calculate_line_with_highest_frequency\n\n      expect(solution.highest_count_across_lines).to be 4\n    end  \n    it \"calculates highest count words across lines to be will, it, really\" do\n      solution.analyze_file\n\n      expect(solution.highest_count_words_across_lines).to be nil\n\n      solution.calculate_line_with_highest_frequency\n\n      words_found = solution.highest_count_words_across_lines.map(&amp;:highest_wf_words).flatten\n      expect(words_found).to match_array [\"will\", \"it\", \"really\"] \n    end  \n  end\n\nend\n</code></pre>\n\n<p><br/>\n The <code>test.txt</code> file: <br/></p>\n\n<pre><code>This is a really really really cool experiment really\nCute little experiment\nWill it work maybe it will work do you think it will it will\n</code></pre>\n\n<p><br/>\nAnd this is the rspec results I've had so far: <br/></p>\n\n<pre><code>LineAnalyzer\n  has accessor for highest_wf_count\n  has accessor for highest_wf_words\n  has accessor for content\n  has accessor for line_number\n  has method calculate_word_frequency\n  calls calculate_word_frequency when created\n  attributes and values\n    has attributes content and line_number\n    content attribute should have value \"test\"\n    line_number attribute should have value 1\n  #calculate_word_frequency\n    highest_wf_count value is 3\n    highest_wf_words will include \"really\" and \"you\"\n    content attribute will have value \"This is a really really really cool cool you you you\"\n    line_number attribute will have value 2\n\nSolution\n  should respond to #analyze_file\n  should respond to #calculate_line_with_highest_frequency\n  should respond to #print_highest_word_frequency_across_lines\n  #analyze_file\n    creates 3 line analyzers\n  #calculate_line_with_highest_frequency\n    calculates highest count across lines to be 4\n    calculates highest count words across lines to be will, it, really (FAILED - 1)\n\nFailures:\n\n  1) Solution#calculate_line_with_highest_frequency calculates highest count words across lines to be will, it, really\n     Failure/Error: expect(words_found).to match_array [\"will\", \"it\", \"really\"]\n\n       expected collection contained:  [\"it\", \"really\", \"will\"]\n       actual collection contained:    []\n       the missing elements were:      [\"it\", \"really\", \"will\"]\n     # ./spec/solution_spec.rb:39:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.13939 seconds (files took 0.39711 seconds to load)\n19 examples, 1 failure\n\nFailed examples:\n\nrspec ./spec/solution_spec.rb:31 # Solution#calculate_line_with_highest_frequency calculates highest count words across lines to be will, it, really\n</code></pre>\n\n<p><br/>\nI really can't figure out where the problem is.<br/>\nIs it a typo problem or I'm doing something wrong somewhere?<br/>\nIf someone could help then it'll be very great,please.<br/>\nThanks in advance.<br/>\nBrice</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1511260114, "post_id": 47410298, "comment_id": 81774770, "body": "But you have to have a root tag"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511260114, "post_id": 47410298, "comment_id": 81774771, "body": "<i>&quot;I don&#39;t want the &lt;hash&gt; tag as root&quot;</i> \u2013 what do you want instead?"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511260326, "post_id": 47410298, "comment_id": 81774908, "body": "@Stefan I updated the example I was using. So, I want the root to be <code>d</code>"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1511260369, "post_id": 47410298, "comment_id": 81774946, "body": "@MikhailKatrin I updated the correct example"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1511260766, "post_id": 47410298, "comment_id": 81775236, "body": "Like <code>{a: &#39;1&#39;, b: {c: &#39;2&#39;}}.to_xml(root: &#39;d&#39;)</code>?"}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511260828, "post_id": 47410298, "comment_id": 81775272, "body": "@Stefan Yes, you are right, the only missing fact is, I don&#39;t know the root element as it varies from different XMLs"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511260892, "post_id": 47410298, "comment_id": 81775316, "body": "The first hash in your example is <code>{a: &#39;1&#39;, b: {c: &#39;2&#39;}}</code>, i.e. it doesn&#39;t have such &quot;root&quot; element."}, {"owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511260971, "post_id": 47410298, "comment_id": 81775374, "body": "@Stefan Yes, I realised that I posted a wrong example, and I tagged you in comment saying <code>I updated the example I was using</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511260783, "last_edit_date": 1511260783, "creation_date": 1511260264, "answer_id": 47410853, "question_id": 47410298, "link": "https://stackoverflow.com/questions/47410298/remove-hash-tag-as-root-from-to-xml/47410853#47410853", "title": "Remove &lt;hash&gt; tag as root from &quot;to_xml&quot;", "body": "<p>It doesn't look good, but </p>\n\n<pre><code>h = {d: {a: \"1\", b: {c: \"2\"}}}\n\nh[h.keys.first].to_xml(root: h.keys.first)\n\n&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\n&lt;d&gt;\n    &lt;a&gt;1&lt;/a&gt;\n    &lt;b&gt;\n        &lt;c&gt;2&lt;/c&gt;\n    &lt;/b&gt;\n&lt;/d&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "is_accepted": true, "score": 0, "last_activity_date": 1511260734, "creation_date": 1511260734, "answer_id": 47411010, "question_id": 47410298, "link": "https://stackoverflow.com/questions/47410298/remove-hash-tag-as-root-from-to-xml/47411010#47411010", "title": "Remove &lt;hash&gt; tag as root from &quot;to_xml&quot;", "body": "<p>Ok, I got it. Since, I always have a root key, I can do it like:</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>hash = {d: {a: \"1\", b: {c: \"2\"}}}\nroot = hash.keys.first\n\nxml = hash[root].to_xml(root: root)\n</code></pre>\n\n<p>And it will output:</p>\n\n<pre><code>&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\n&lt;d&gt;\n  &lt;a&gt;1&lt;/a&gt;\n  &lt;b&gt;\n    &lt;c&gt;2&lt;/c&gt;\n  &lt;/b&gt;\n&lt;/d&gt;\n</code></pre>\n"}], "owner": {"reputation": 3618, "user_id": 2968762, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EhAX3.png?s=128&g=1", "display_name": "Abhi", "link": "https://stackoverflow.com/users/2968762/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 1, "accepted_answer_id": 47411010, "answer_count": 2, "score": 0, "last_activity_date": 1511260783, "creation_date": 1511258731, "last_edit_date": 1511260284, "question_id": 47410298, "link": "https://stackoverflow.com/questions/47410298/remove-hash-tag-as-root-from-to-xml", "title": "Remove &lt;hash&gt; tag as root from &quot;to_xml&quot;", "body": "<p>I'm trying to convert a hash to xml. So, I'm using <code>Hash.to_xml</code>. But, it adds as <code>&lt;hash&gt;</code> tag as the root</p>\n\n<p>A simple example:</p>\n\n<pre><code>&gt; {a: \"1\", b: {c: \"2\"}}.to_xml\n</code></pre>\n\n<p><strong>Gives</strong></p>\n\n<pre><code>&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\n&lt;hash&gt;\n  &lt;d&gt;\n    &lt;a&gt;1&lt;/a&gt;\n    &lt;b&gt;\n      &lt;c&gt;2&lt;/c&gt;\n    &lt;/b&gt;\n  &lt;/d&gt;\n&lt;/hash&gt;\n</code></pre>\n\n<p>But, I don't want the <code>&lt;hash&gt;</code> tag as root.</p>\n\n<p><a href=\"https://apidock.com/rails/Hash/to_xml\" rel=\"nofollow noreferrer\">DOC</a> says, it's configurable via <strong>root</strong>. So, I tried</p>\n\n<pre><code>{d: {a: \"1\", b: {c: \"2\"}}}.to_xml(root: \"\")\n</code></pre>\n\n<p>But, that gives an empty <code>&lt;&gt;</code> instead of <code>&lt;hash&gt;</code></p>\n\n<p><strong>NOTE:</strong> In my actual hash, I always have a root key. Like in the above example I have it as <strong>d</strong>. But, it's not known to me as it's dynamic</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1511268435, "post_id": 47409458, "comment_id": 81780243, "body": "This might help: <a href=\"https://gist.github.com/JagdeepSingh/166fa03829275cb6131d77abc6d4c148#custom-accounts\" rel=\"nofollow noreferrer\">gist.github.com/JagdeepSingh/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1511345800, "post_id": 47409648, "comment_id": 81818316, "body": "It&#39;s giving me another below error &quot;Invalid type: must be one of standard, express, or custom&quot;"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1511346151, "post_id": 47409648, "comment_id": 81818546, "body": "That&#39;s because you are passing the value of :type as &#39;individual&#39;"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1511346183, "post_id": 47409648, "comment_id": 81818560, "body": "Pass whichever is appropriate from <code>standard</code>, <code>express</code>, or <code>custom</code>"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "edited": false, "score": 0, "creation_date": 1511346226, "post_id": 47409648, "comment_id": 81818594, "body": "And please check the documentation you will get solution for almost everything there itself"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 1, "last_activity_date": 1511257104, "last_edit_date": 1511257104, "creation_date": 1511256765, "answer_id": 47409648, "question_id": 47409458, "link": "https://stackoverflow.com/questions/47409458/ruby-stripe-missing-required-param-type/47409648#47409648", "title": "Ruby - Stripe: Missing required param: type", "body": "<p>You are not passing the proper parameters to the API.</p>\n\n<p>Please check this document for the proper request and response returned by Stripe.</p>\n\n<p><a href=\"https://stripe.com/docs/api?lang=ruby#create_account\" rel=\"nofollow noreferrer\">https://stripe.com/docs/api?lang=ruby#create_account</a></p>\n\n<pre><code>require \"stripe\"\nStripe.api_key = \"sk_test_bcd1234\"\n\nStripe::Account.create(\n  :type =&gt; 'standard',\n  :country =&gt; 'US',\n  :email =&gt; 'bob@example.com'\n)\n</code></pre>\n\n<p>To point out you are not passing <code>:type</code> param in the outer hash. You need to move it to the first level.</p>\n\n<pre><code>account = Stripe::Account.create(\n  {\n    :country =&gt; 'US',\n    :managed =&gt; true,\n    :type =&gt; 'individual', # Move this from nested to first level \n    :transfer_schedule =&gt; {\n      :interval =&gt; 'weekly',\n      :weekly_anchor =&gt; 'friday'\n    },\n    :legal_entity =&gt; {\n      :dob =&gt; {\n        :day =&gt; birthday.day,\n        :month =&gt; birthday.month,\n        :year =&gt; birthday.year\n      },\n      :first_name =&gt; first_name,\n      :last_name =&gt; last_name\n    },\n    :tos_acceptance =&gt; {\n      :date =&gt; Time.now.to_i,\n      :ip =&gt; request.remote_ip\n    }\n  }\n)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8543149, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b405e3d9b67b417c59d302f1f8d42614?s=128&d=identicon&r=PG&f=1", "display_name": "Pinki", "link": "https://stackoverflow.com/users/8543149/pinki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511260949, "creation_date": 1511256224, "last_edit_date": 1511260949, "question_id": 47409458, "link": "https://stackoverflow.com/questions/47409458/ruby-stripe-missing-required-param-type", "title": "Ruby - Stripe: Missing required param: type", "body": "<p>I am trying to add a bank account using Ruby stripe API. but it gives the stripe error \"Missing required param: type\".</p>\n\n<p>I am using following ruby code:</p>\n\n<pre><code>account = Stripe::Account.create({\n    :country =&gt; 'US',\n    :managed =&gt; true,\n    :transfer_schedule =&gt; {\n        :interval =&gt; 'weekly',\n        :weekly_anchor =&gt; 'friday'\n    },\n    :legal_entity =&gt; {\n        :dob =&gt; {\n            :day =&gt; birthday.day,\n            :month =&gt; birthday.month,\n            :year =&gt; birthday.year\n        },\n        :first_name =&gt; first_name,\n        :last_name =&gt; last_name,\n        :type =&gt; 'individual'\n    },\n    :tos_acceptance =&gt; {\n        :date =&gt; Time.now.to_i,\n        :ip =&gt; request.remote_ip\n    }\n})\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511258027, "post_id": 47409054, "comment_id": 81773428, "body": "<code>exec</code> replaces your process with the command which is not what you want. <code>system</code> and <code>%x</code> (or backticks) wait for the command to finish. <code>spawn</code> however looks promising \u2013 it just returns the pid."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511258383, "post_id": 47409054, "comment_id": 81773686, "body": "Since you are using Sidekiq: wouldn&#39;t it make more sense to have the worker wait for the command to finish so you can handle failure (possibly restart), limit number of concurrent jobs etc?"}, {"owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511259070, "post_id": 47409054, "comment_id": 81774120, "body": "No, because the script is self-contained (handling errors by itself etc.). I just need to have it invoked by my webapp (a controller action enqueues a sidekiq job, which evokes the script ans some other stuff)."}, {"owner": {"reputation": 14684, "user_id": 446267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7012ce54f5b02c8741ae73cec596b7fc?s=128&d=identicon&r=PG", "display_name": "\u041c\u0430\u043b\u044a \u0421\u043a\u0440\u044b\u043b\u0435\u0432\u044a", "link": "https://stackoverflow.com/users/446267/%d0%9c%d0%b0%d0%bb%d1%8a-%d0%a1%d0%ba%d1%80%d1%8b%d0%bb%d0%b5%d0%b2%d1%8a"}, "edited": false, "score": 0, "creation_date": 1511269154, "post_id": 47409054, "comment_id": 81780713, "body": "it seems that the command not quite correcly run, try it to run manually, use &#39;&amp;&gt;&#39; flow forward conbination instead of just &#39;&gt;&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1511357457, "last_edit_date": 1511357457, "creation_date": 1511265304, "answer_id": 47412539, "question_id": 47409054, "link": "https://stackoverflow.com/questions/47409054/how-to-start-a-script-in-background-with-logging-to-a-specific-file-and-complete/47412539#47412539", "title": "How to start a script in background with logging to a specific file and completely detaching from ruby?", "body": "<p>Okay so I ended up going with <code>spawn</code>:</p>\n\n<pre><code>module WorkerJobs\n  class MyJob &lt; SidekiqWorker\n\n    def perform country\n      logfile =  \"/home/deployer/my_dir/shared/log/log_#{country}.log\"\n      pid = spawn(\"cd ~/my_dir/production &amp;&amp; nohub Rscript --vanilla main.r --country #{country}\", [:out, :err] =&gt; logfile)\n      Process.detach(pid)\n    end\n\n  end\nend\n</code></pre>\n\n<p>That worked as intended.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>However now this happens: <a href=\"https://stackoverflow.com/questions/47412593/how-to-debug-r-script-suddenly-stopping-at-random-point-with-no-error\">How to debug R-script suddenly stopping at random point with no error?</a> (related or unrelated I don't know?)</p>\n\n<p><strong>update 2</strong></p>\n\n<p>It actually seems to be related! When sidekiq restarts (get's a kill -15) then it also nukes the process. Strange... Investigating...</p>\n\n<p><strong>final update</strong></p>\n\n<p>It turns out, that since sidekiq was started by systemd, systemd was actually the one responsible for nuking any \"child\" processes (whether they were actually classical child processes or not). This is the default behaviour of systemd. An explanation can be found here: <a href=\"https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd#32209842\">Can&#39;t detach child process when main process is started from systemd</a></p>\n\n<p>Changing the killmode for system d to <code>process</code> fixed the problem.</p>\n"}], "owner": {"reputation": 8232, "user_id": 1002814, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/935d2564cfa8572c12763684e072063d?s=128&d=identicon&r=PG", "display_name": "Niels Kristian", "link": "https://stackoverflow.com/users/1002814/niels-kristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511357457, "creation_date": 1511254890, "last_edit_date": 1511257225, "question_id": 47409054, "link": "https://stackoverflow.com/questions/47409054/how-to-start-a-script-in-background-with-logging-to-a-specific-file-and-complete", "title": "How to start a script in background with logging to a specific file and completely detaching from ruby?", "body": "<p>I have some ruby code (a sidekiq job) which looks like this:</p>\n\n<pre><code>module WorkerJobs\n  class MyJob &lt; SidekiqWorker\n\n    def perform country\n      # Exec, ``, system, Spawn ... whatever?\n      # ????\n    end\n\n  end\nend\n</code></pre>\n\n<p>I would like to have the ruby code start a command like this (which takes several hours to complete):</p>\n\n<pre><code>\"cd ~/my_dir/production &amp;&amp; nohub Rscript --vanilla main.r --country #{country} &gt; /home/deployer/my_dir/shared/log/log_#{country}.log 2&gt;&amp;1 &amp;\"\n</code></pre>\n\n<p>The goal is to get the script started and the sidekiq job to complete without waiting for anything (since the script takes hours to run), so sidekiq can move on and do other jobs. Sidekiq/ruby does not need to know any more details of the state of the job what so ever.</p>\n\n<p>I tried using <code>system()</code> but that seems to not send the stdout/err to the specified log file for some reason? I tried reading about other ways of executing the script but I can't figure out which method is the right one to use in this case. Again, while the script runs the sidekiq process/thread that started it might stop/start/do-what-ever it should NOT influence the script</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 31, "user_id": 8978018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2804ac9ca1a7473fb31caf362f2ab34?s=128&d=identicon&r=PG&f=1", "display_name": "RubyNewby", "link": "https://stackoverflow.com/users/8978018/rubynewby"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511253383, "post_id": 47408360, "comment_id": 81770312, "body": "@sawa I made the question more explcit \ud83d\ude0a"}], "answers": [{"tags": [], "owner": {"reputation": 11435, "user_id": 6328256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PyZe2.png?s=128&g=1", "display_name": "Sash Sinha", "link": "https://stackoverflow.com/users/6328256/sash-sinha"}, "is_accepted": true, "score": 4, "last_activity_date": 1511253561, "last_edit_date": 1511253561, "creation_date": 1511252712, "answer_id": 47408394, "question_id": 47408360, "link": "https://stackoverflow.com/questions/47408360/split-string-in-ruby-when-character-is-different-to-previous-character/47408394#47408394", "title": "Split string in ruby when character is different to previous character", "body": "<p>Here is a one liner using <strong><a href=\"http://ruby-doc.org/core-2.4.2/Enumerable.html#method-i-chunk\" rel=\"nofollow noreferrer\">chunk</a></strong>, <strong><a href=\"http://ruby-doc.org/core-2.4.2/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">map</a></strong> and <strong><a href=\"https://ruby-doc.org/core-2.4.2/Array.html#method-i-join\" rel=\"nofollow noreferrer\">join</a></strong>:</p>\n\n<pre><code>\"aabbbc226%%*\".chars.chunk(&amp;:itself).map{|_,c| c.join}\n# =&gt; [\"aa\", \"bbb\", \"c\", \"22\", \"6\", \"%%\", \"*\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1511253515, "creation_date": 1511253515, "answer_id": 47408600, "question_id": 47408360, "link": "https://stackoverflow.com/questions/47408360/split-string-in-ruby-when-character-is-different-to-previous-character/47408600#47408600", "title": "Split string in ruby when character is different to previous character", "body": "<pre><code>\"aabbbc226%%*\".scan(/((.)\\2*)/).to_h.keys\n# =&gt; [\"aa\", \"bbb\", \"c\", \"22\", \"6\", \"%%\", \"*\"]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>\"aabbbc226%%*\".scan(/((.)\\2*)/).map(&amp;:first)\n# =&gt; [\"aa\", \"bbb\", \"c\", \"22\", \"6\", \"%%\", \"*\"]\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8978018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2804ac9ca1a7473fb31caf362f2ab34?s=128&d=identicon&r=PG&f=1", "display_name": "RubyNewby", "link": "https://stackoverflow.com/users/8978018/rubynewby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 2, "closed_date": 1511253846, "accepted_answer_id": 47408394, "answer_count": 2, "score": 2, "last_activity_date": 1511253561, "creation_date": 1511252590, "last_edit_date": 1511253342, "question_id": 47408360, "link": "https://stackoverflow.com/questions/47408360/split-string-in-ruby-when-character-is-different-to-previous-character", "closed_reason": "Duplicate", "title": "Split string in ruby when character is different to previous character", "body": "<p>I would like to split a string when a character changes.</p>\n\n<p>For example <code>\"aabbbc226%%*\"</code> should be split into an array like this <code>[\"aa\",  \"bbb\",  \"c\",  \"22\",  \"6\",  \"%%\",  \"*\"]</code></p>\n\n<p>Heres what I have right now</p>\n\n<pre><code>def split_when_char_change(str)\n   array = Array.new\n   chars = str.split('')\n   chars.each { |c|\n     array.push c\n   }\n   array\nend\n</code></pre>\n\n<p>split_when_char_change(\"aabbbc226%%*\")</p>\n\n<p>I am getting this output: <code>[\"a\", \"a\", \"b\", \"b\", \"b\", \"c\", \"2\", \"2\", \"6\", \"%\", \"%\", \"*\"]</code> which is wrong.</p>\n\n<p>How can I get my desired array?</p>\n"}, {"tags": ["ruby", "algorithm", "recursion", "graph", "greedy"], "comments": [{"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1511266299, "post_id": 47407601, "comment_id": 81778881, "body": "<code>in &#39;&lt;main&gt;&#39;: undefined local variable or method &#39;vertex&#39;</code> It would be easier for us to help if we can copy-paste a working code."}, {"owner": {"reputation": 477, "user_id": 2025167, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/ff7f79fba372583e604e82a0bf2d1638?s=128&d=identicon&r=PG", "display_name": "krnbatta", "link": "https://stackoverflow.com/users/2025167/krnbatta"}, "reply_to_user": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1511294821, "post_id": 47407601, "comment_id": 81797903, "body": "@BernardK When i replace <code>frequency = frequency.sort_by {|k, v| v}.to_h</code> with <code>frequency = frequency.clone</code> It works fine. The problem occurs when i try to sort the frequencies in order to evenly distribute."}, {"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1511301993, "post_id": 47407601, "comment_id": 81801815, "body": "$ <code>ruby -w t.rb</code> =&gt; <code>t.rb:7: warning: global variable &#39;$H&#39; not initialized</code>."}, {"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1511303009, "post_id": 47407601, "comment_id": 81802325, "body": "If I replace $G by $H, then <code>undefined local variable or method &#39;colors&#39; for main:Object</code> in line <code>available_colors = colors.keys-used_colors</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "edited": false, "score": 0, "creation_date": 1511628083, "post_id": 47425985, "comment_id": 81931417, "body": "@krnbatta After two changes, I have the feeling it repeats two much times the same processing. Do you have something new ?"}], "tags": [], "owner": {"reputation": 3286, "user_id": 1851041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736f0189c216f8d9ece902e96fd37f6a?s=128&d=identicon&r=PG", "display_name": "BernardK", "link": "https://stackoverflow.com/users/1851041/bernardk"}, "is_accepted": false, "score": 0, "last_activity_date": 1511627786, "last_edit_date": 1511627786, "creation_date": 1511318739, "answer_id": 47425985, "question_id": 47407601, "link": "https://stackoverflow.com/questions/47407601/evenly-color-graph-in-ruby/47425985#47425985", "title": "Evenly color graph in ruby", "body": "<p>With two changed lines (marked with <code># &lt;--------------------</code>) :</p>\n\n<pre><code>require_relative 'trips1' # contains $G={\"TRIP-10122\"=&gt;...\n\ndef dfs(vertex, original_visited_arr, frequency)\n  puts \"enters dfs with vertex=#{vertex}, vis arr=#{original_visited_arr}, frequency=#{frequency}\"\n  return nil unless $G[vertex] # &lt;--------------------\n  #original_visited_arr is passed as reference\n  visited_arr = original_visited_arr.clone\n  #sorting colors frequency for evenly distribution\n  frequency = frequency.sort_by {|k, v| v}.to_h\n  used_colors = []\n\n#  puts $G.keys.sort\n  $G[vertex].each do |adj_vertex|\n    puts \"adj_vertex 1=#{adj_vertex}\"\n    used_colors &lt;&lt; visited_arr[adj_vertex]\n  end\n  puts \"used_colors=#{used_colors}\"\n\n  #checking the colors which can be used (total colors-colors used by adjacent nodes)\n  available_colors = frequency.keys - used_colors\n  puts \"available_colors=#{available_colors}\"\n  #if there is no color available to be filled in the node, backtrack!\n  if available_colors.length==0\n    return nil\n  end\n\n  #iterate through the available colors to check which one solves the problem\n  available_colors.each do |color|\n    puts \"color=#{color}, visited_arr[vertex]=#{visited_arr[vertex].inspect}, vertex=#{vertex}\"\n    visited_arr[vertex] = color\n    frequency[color]+=1\n    res = true\n\n    #use recursion over each node that is adjacent to the current node\n    $G[vertex].each do |adj_vertex|\n      puts \"adj_vertex 2=#{adj_vertex}, visited_arr[adj_vertex]=#{visited_arr[adj_vertex].inspect}\"\n      unless visited_arr[adj_vertex] # &lt;--------------------\n        adj_vertex_visited_arr = dfs(adj_vertex, visited_arr, frequency)\n        puts \"dfs returned #{adj_vertex_visited_arr.inspect}\"\n        if ! adj_vertex_visited_arr\n          res=false\n          break\n        end\n        visited_arr = adj_vertex_visited_arr\n      end\n    end\n    puts \"res=#{res}\"\n    if res\n      puts \"about to return #{visited_arr}\"\n      return visited_arr\n    end\n    frequency[color] -= 1\n    visited_arr[vertex] = \"0\"\n  end\n  return nil\nend\n\nvertex=\"TRIP-10065\"\n\nvisited_arr = {}\nfrequency = {\"1\" =&gt; 0, \"2\" =&gt; 0, \"3\" =&gt; 0, \"4\" =&gt; 0, \"5\" =&gt; 0, \"6\" =&gt; 0}\nvisited_arr =  dfs(vertex, visited_arr, frequency)\n</code></pre>\n\n<p>and <code>trips1</code> :</p>\n\n<pre><code>$G = {\"TRIP-10065\"=&gt;[\"TRIP-10090\", \"TRIP-10137\", \"TRIP-10138\"],\n      \"TRIP-10090\"=&gt;[\"TRIP-10065\", \"TRIP-10101\", \"TRIP-10110\", \"TRIP-10107\", \"TRIP-10137\", \"TRIP-10138\"],\n      \"TRIP-10137\"=&gt;[\"TRIP-10138\", \"TRIP-10065\", \"TRIP-10145\", \"TRIP-10175\", \"TRIP-10107\", \"TRIP-10090\", \"TRIP-10101\"], \n      \"TRIP-10138\"=&gt;[\"TRIP-10137\", \"TRIP-10065\", \"TRIP-10107\", \"TRIP-10153\", \"TRIP-10090\", \"TRIP-10101\"],\n     }\n</code></pre>\n\n<p>Execution :</p>\n\n<pre><code>$ ruby -w t.rb \nenters dfs with vertex=TRIP-10065, vis arr={}, frequency={\"1\"=&gt;0, \"2\"=&gt;0, \"3\"=&gt;0, \"4\"=&gt;0, \"5\"=&gt;0, \"6\"=&gt;0}\nadj_vertex 1=TRIP-10090\nadj_vertex 1=TRIP-10137\nadj_vertex 1=TRIP-10138\nused_colors=[nil, nil, nil]\navailable_colors=[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\"]\ncolor=1, visited_arr[vertex]=nil, vertex=TRIP-10065\nadj_vertex 2=TRIP-10090, visited_arr[adj_vertex]=nil\nenters dfs with vertex=TRIP-10090, vis arr={\"TRIP-10065\"=&gt;\"1\"}, frequency={\"1\"=&gt;1, \"2\"=&gt;0, \"3\"=&gt;0, \"4\"=&gt;0, \"5\"=&gt;0, \"6\"=&gt;0}\nadj_vertex 1=TRIP-10065\nadj_vertex 1=TRIP-10101\n...\navailable_colors=[\"1\", \"3\", \"4\", \"5\", \"6\"]\ncolor=1, visited_arr[vertex]=nil, vertex=TRIP-10090\n...\ncolor=3, visited_arr[vertex]=\"0\", vertex=TRIP-10090\n...\ncolor=4, visited_arr[vertex]=\"0\", vertex=TRIP-10090\nadj_vertex 2=TRIP-10065, visited_arr[adj_vertex]=\"2\"\nadj_vertex 2=TRIP-10101, visited_arr[adj_vertex]=nil\n...\ncolor=5, visited_arr[vertex]=\"0\", vertex=TRIP-10090\nadj_vertex 2=TRIP-10065, visited_arr[adj_vertex]=\"2\"\nadj_vertex 2=TRIP-10101, visited_arr[adj_vertex]=nil\n....\ncolor=6, visited_arr[vertex]=\"0\", vertex=TRIP-10090\nadj_vertex 2=TRIP-10065, visited_arr[adj_vertex]=\"2\"\nadj_vertex 2=TRIP-10101, visited_arr[adj_vertex]=nil\nenters dfs with vertex=TRIP-10101, vis arr={\"TRIP-10065\"=&gt;\"2\", \"TRIP-10090\"=&gt;\"6\"}, frequency={\"1\"=&gt;0, \"3\"=&gt;0, \"4\"=&gt;0, \"5\"=&gt;0, \"6\"=&gt;1, \"2\"=&gt;1}\ndfs returned nil\nres=false\ndfs returned nil\nres=false\n...\n</code></pre>\n\n<p>It seems there is something wrong with iterating the colours :</p>\n\n<pre><code>available_colors.each do |color|\n</code></pre>\n\n<p>because it repeats 6 times the same processing.</p>\n"}], "owner": {"reputation": 477, "user_id": 2025167, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/ff7f79fba372583e604e82a0bf2d1638?s=128&d=identicon&r=PG", "display_name": "krnbatta", "link": "https://stackoverflow.com/users/2025167/krnbatta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511627786, "creation_date": 1511249647, "last_edit_date": 1511311383, "question_id": 47407601, "link": "https://stackoverflow.com/questions/47407601/evenly-color-graph-in-ruby", "title": "Evenly color graph in ruby", "body": "<p>Please let me know the problem in the code that I implemented.\nProblem Statement: There are n nodes and m colors to be filled in a Graph g. Assign colors to the nodes such that no two adjacent nodes have same colors and try to evenly distribute the colors among the nodes.</p>\n\n<p>Approach: I am using dfs along with greedy algorithm(to evenly distribute)</p>\n\n<p>Variables: <code>$G</code> is graph of the form: {v1: [v2, v3, v4], v2: [v4, v8], ...};\n<code>vertex</code> is the starting vertex of the graph; <code>visited_arr</code> or <code>adj_visited_arr</code> is hash of the form: {v1: \"1\", v2: \"2\", ...} where \"1\", \"2\", ..., \"6\" are colors; <code>frequency</code> is hash which keeps the count of the number of times the color has been used in the graph so far. eg.: {\"1\": 5, \"2\": 6, \"3\": 8, ...}</p>\n\n<p>Code:</p>\n\n<pre><code>def dfs(vertex, original_visited_arr, frequency)\n  #original_visited_arr is passed as reference\n  visited_arr = original_visited_arr.clone\n  #sorting colors frequency for evenly distribution\n  frequency = frequency.sort_by {|k, v| v}.to_h\n  used_colors = []\n  $G[vertex].each do |adj_vertex|\n    used_colors &lt;&lt; visited_arr[adj_vertex]\n  end\n  #checking the colors which can be used (total colors-colors used by adjacent nodes)\n  available_colors = frequency.keys-used_colors\n  #if there is no color available to be filled in the node, backtrack!\n  if available_colors.length==0\n    return nil\n  end\n  #iterate through the available colors to check which one solves the problem\n  available_colors.each do |color|\n    visited_arr[vertex] = color\n    frequency[color]+=1\n    res = true\n    #use recursion over each node that is adjacent to the current node\n    $G[vertex].each do |adj_vertex|\n      if visited_arr[adj_vertex]==\"0\"\n        adj_vertex_visited_arr = dfs(adj_vertex, visited_arr, frequency)\n        if !adj_vertex_visited_arr\n          res=false\n          break\n        end\n        visited_arr=adj_vertex_visited_arr\n      end\n    end\n    if res\n      return visited_arr\n    end\n    frequency[color]-=1\n    visited_arr[vertex] = \"0\"\n  end\n  return nil\nend\n\nvisited_arr = {}\nfrequency = {\"1\" =&gt; 0, \"2\" =&gt; 0, \"3\" =&gt; 0, \"4\" =&gt; 0, \"5\" =&gt; 0, \"6\" =&gt; 0}\nvisited_arr =  dfs(vertex, visited_arr, frequency)\n</code></pre>\n\n<p>Values:\n<code>vertex=\"TRIP-10065\"</code></p>\n\n<p><code>vertices=[\"TRIP-10065\", \"TRIP-10066\", \"TRIP-10067\", \"TRIP-10068\", \"TRIP-10069\", \"TRIP-10070\", \"TRIP-10071\", \"TRIP-10072\", \"TRIP-10073\", \"TRIP-10074\", \"TRIP-10075\", \"TRIP-10076\", \"TRIP-10077\", \"TRIP-10078\", \"TRIP-10079\", \"TRIP-10080\", \"TRIP-10081\", \"TRIP-10082\", \"TRIP-10083\", \"TRIP-10084\", \"TRIP-10085\", \"TRIP-10086\", \"TRIP-10087\", \"TRIP-10088\", \"TRIP-10089\", \"TRIP-10090\", \"TRIP-10091\", \"TRIP-10092\", \"TRIP-10093\", \"TRIP-10094\", \"TRIP-10095\", \"TRIP-10096\", \"TRIP-10097\", \"TRIP-10098\", \"TRIP-10099\", \"TRIP-10100\", \"TRIP-10101\", \"TRIP-10102\", \"TRIP-10103\", \"TRIP-10104\", \"TRIP-10105\", \"TRIP-10106\", \"TRIP-10107\", \"TRIP-10108\", \"TRIP-10109\", \"TRIP-10110\", \"TRIP-10111\", \"TRIP-10112\", \"TRIP-10113\", \"TRIP-10114\", \"TRIP-10115\", \"TRIP-10116\", \"TRIP-10117\", \"TRIP-10118\", \"TRIP-10119\", \"TRIP-10120\", \"TRIP-10121\", \"TRIP-10122\", \"TRIP-10123\", \"TRIP-10124\", \"TRIP-10125\", \"TRIP-10126\", \"TRIP-10127\", \"TRIP-10128\", \"TRIP-10129\", \"TRIP-10130\", \"TRIP-10131\", \"TRIP-10132\", \"TRIP-10133\", \"TRIP-10134\", \"TRIP-10135\", \"TRIP-10136\", \"TRIP-10137\", \"TRIP-10138\", \"TRIP-10139\", \"TRIP-10140\", \"TRIP-10141\", \"TRIP-10142\", \"TRIP-10143\", \"TRIP-10144\", \"TRIP-10145\", \"TRIP-10146\", \"TRIP-10147\", \"TRIP-10148\", \"TRIP-10149\", \"TRIP-10150\", \"TRIP-10151\", \"TRIP-10152\", \"TRIP-10153\", \"TRIP-10154\", \"TRIP-10155\", \"TRIP-10156\", \"TRIP-10157\", \"TRIP-10158\", \"TRIP-10159\", \"TRIP-10160\", \"TRIP-10161\", \"TRIP-10162\", \"TRIP-10163\", \"TRIP-10164\", \"TRIP-10165\", \"TRIP-10166\", \"TRIP-10167\", \"TRIP-10168\", \"TRIP-10169\", \"TRIP-10170\", \"TRIP-10171\", \"TRIP-10172\", \"TRIP-10173\", \"TRIP-10174\", \"TRIP-10175\", \"TRIP-10176\", \"TRIP-10177\", \"TRIP-10178\", \"TRIP-10179\", \"TRIP-10180\", \"TRIP-10181\", \"TRIP-10182\", \"TRIP-10183\", \"TRIP-10184\", \"TRIP-10185\", \"TRIP-10186\", \"TRIP-10187\"]</code> </p>\n\n<p><code>$G={\"TRIP-10122\"=&gt;[\"TRIP-10157\", \"TRIP-10158\", \"TRIP-10168\", \"TRIP-10159\", \"TRIP-10169\", \"TRIP-10178\", \"TRIP-10179\"], \"TRIP-10091\"=&gt;[\"TRIP-10111\", \"TRIP-10148\", \"TRIP-10141\", \"TRIP-10139\", \"TRIP-10147\", \"TRIP-10088\", \"TRIP-10089\"], \"TRIP-10119\"=&gt;[\"TRIP-10168\", \"TRIP-10167\", \"TRIP-10155\", \"TRIP-10178\", \"TRIP-10157\", \"TRIP-10176\", \"TRIP-10179\"], \"TRIP-10118\"=&gt;[\"TRIP-10167\", \"TRIP-10168\", \"TRIP-10155\", \"TRIP-10176\", \"TRIP-10157\", \"TRIP-10178\", \"TRIP-10177\"], \"TRIP-10125\"=&gt;[\"TRIP-10169\", \"TRIP-10170\", \"TRIP-10171\", \"TRIP-10158\", \"TRIP-10180\", \"TRIP-10181\", \"TRIP-10156\"], \"TRIP-10097\"=&gt;[\"TRIP-10112\", \"TRIP-10148\", \"TRIP-10142\", \"TRIP-10150\", \"TRIP-10089\", \"TRIP-10149\", \"TRIP-10140\"], \"TRIP-10136\"=&gt;[\"TRIP-10153\", \"TRIP-10184\", \"TRIP-10165\", \"TRIP-10183\", \"TRIP-10175\", \"TRIP-10185\", \"TRIP-10173\"], \"TRIP-10130\"=&gt;[\"TRIP-10164\", \"TRIP-10171\", \"TRIP-10183\", \"TRIP-10172\", \"TRIP-10163\", \"TRIP-10184\", \"TRIP-10186\"], \"TRIP-10068\"=&gt;[\"TRIP-10070\", \"TRIP-10067\", \"TRIP-10069\", \"TRIP-10086\", \"TRIP-10083\", \"TRIP-10074\", \"TRIP-10087\"], \"TRIP-10094\"=&gt;[\"TRIP-10112\", \"TRIP-10141\", \"TRIP-10149\", \"TRIP-10140\", \"TRIP-10114\", \"TRIP-10142\", \"TRIP-10151\"], \"TRIP-10067\"=&gt;[\"TRIP-10086\", \"TRIP-10069\", \"TRIP-10068\", \"TRIP-10070\", \"TRIP-10071\", \"TRIP-10072\", \"TRIP-10073\"], \"TRIP-10103\"=&gt;[\"TRIP-10116\", \"TRIP-10144\", \"TRIP-10151\", \"TRIP-10152\", \"TRIP-10177\", \"TRIP-10176\", \"TRIP-10114\"], \"TRIP-10088\"=&gt;[\"TRIP-10082\", \"TRIP-10139\", \"TRIP-10084\", \"TRIP-10086\", \"TRIP-10091\", \"TRIP-10111\", \"TRIP-10087\"], \"TRIP-10144\"=&gt;[\"TRIP-10103\", \"TRIP-10151\", \"TRIP-10152\", \"TRIP-10102\", \"TRIP-10104\", \"TRIP-10114\", \"TRIP-10116\"], \"TRIP-10073\"=&gt;[\"TRIP-10072\", \"TRIP-10071\", \"TRIP-10066\", \"TRIP-10074\", \"TRIP-10078\", \"TRIP-10083\", \"TRIP-10067\"], \"TRIP-10137\"=&gt;[\"TRIP-10138\", \"TRIP-10065\", \"TRIP-10145\", \"TRIP-10175\", \"TRIP-10107\", \"TRIP-10090\", \"TRIP-10101\"], \"TRIP-10072\"=&gt;[\"TRIP-10078\", \"TRIP-10073\", \"TRIP-10071\", \"TRIP-10066\", \"TRIP-10074\", \"TRIP-10083\", \"TRIP-10067\"], \"TRIP-10128\"=&gt;[\"TRIP-10160\", \"TRIP-10182\", \"TRIP-10161\", \"TRIP-10181\", \"TRIP-10170\", \"TRIP-10171\", \"TRIP-10184\", \"TRIP-10172\", \"TRIP-10109\", \"TRIP-10158\", \"TRIP-10110\", \"TRIP-10183\"], \"TRIP-10158\"=&gt;[\"TRIP-10126\", \"TRIP-10122\", \"TRIP-10180\", \"TRIP-10125\", \"TRIP-10181\", \"TRIP-10168\", \"TRIP-10124\", \"TRIP-10179\", \"TRIP-10170\", \"TRIP-10169\", \"TRIP-10128\", \"TRIP-10171\"], \"TRIP-10092\"=&gt;[\"TRIP-10141\", \"TRIP-10112\", \"TRIP-10139\", \"TRIP-10148\", \"TRIP-10089\", \"TRIP-10147\", \"TRIP-10132\", \"TRIP-10160\", \"TRIP-10140\", \"TRIP-10111\", \"TRIP-10114\", \"TRIP-10142\"], \"TRIP-10161\"=&gt;[\"TRIP-10127\", \"TRIP-10184\", \"TRIP-10181\", \"TRIP-10128\", \"TRIP-10108\", \"TRIP-10120\", \"TRIP-10110\", \"TRIP-10145\", \"TRIP-10183\", \"TRIP-10171\", \"TRIP-10182\", \"TRIP-10172\"], \"TRIP-10153\"=&gt;[\"TRIP-10185\", \"TRIP-10146\", \"TRIP-10127\", \"TRIP-10145\", \"TRIP-10136\", \"TRIP-10184\", \"TRIP-10107\", \"TRIP-10138\", \"TRIP-10110\", \"TRIP-10175\", \"TRIP-10129\", \"TRIP-10173\"], \"TRIP-10083\"=&gt;[\"TRIP-10082\", \"TRIP-10085\", \"TRIP-10068\", \"TRIP-10086\", \"TRIP-10070\", \"TRIP-10084\", \"TRIP-10076\", \"TRIP-10081\", \"TRIP-10072\", \"TRIP-10073\", \"TRIP-10078\", \"TRIP-10069\"], \"TRIP-10112\"=&gt;[\"TRIP-10094\", \"TRIP-10097\", \"TRIP-10092\", \"TRIP-10140\", \"TRIP-10149\", \"TRIP-10089\", \"TRIP-10150\", \"TRIP-10096\", \"TRIP-10148\", \"TRIP-10093\", \"TRIP-10139\", \"TRIP-10142\"], \"TRIP-10173\"=&gt;[\"TRIP-10131\", \"TRIP-10165\", \"TRIP-10133\", \"TRIP-10134\", \"TRIP-10132\", \"TRIP-10162\", \"TRIP-10127\", \"TRIP-10182\", \"TRIP-10185\", \"TRIP-10184\", \"TRIP-10136\", \"TRIP-10153\"], \"TRIP-10168\"=&gt;[\"TRIP-10121\", \"TRIP-10119\", \"TRIP-10118\", \"TRIP-10120\", \"TRIP-10157\", \"TRIP-10122\", \"TRIP-10158\", \"TRIP-10178\", \"TRIP-10176\", \"TRIP-10156\", \"TRIP-10179\", \"TRIP-10155\"], \"TRIP-10116\"=&gt;[\"TRIP-10104\", \"TRIP-10103\", \"TRIP-10109\", \"TRIP-10155\", \"TRIP-10152\", \"TRIP-10176\", \"TRIP-10177\", \"TRIP-10154\", \"TRIP-10178\", \"TRIP-10106\", \"TRIP-10144\", \"TRIP-10179\"], \"TRIP-10070\"=&gt;[\"TRIP-10068\", \"TRIP-10079\", \"TRIP-10080\", \"TRIP-10067\", \"TRIP-10069\", \"TRIP-10086\", \"TRIP-10083\", \"TRIP-10084\", \"TRIP-10074\", \"TRIP-10078\", \"TRIP-10087\", \"TRIP-10085\"], \"TRIP-10114\"=&gt;[\"TRIP-10096\", \"TRIP-10099\", \"TRIP-10151\", \"TRIP-10144\", \"TRIP-10102\", \"TRIP-10143\", \"TRIP-10103\", \"TRIP-10152\", \"TRIP-10094\", \"TRIP-10142\", \"TRIP-10092\", \"TRIP-10148\"], \"TRIP-10181\"=&gt;[\"TRIP-10161\", \"TRIP-10126\", \"TRIP-10160\", \"TRIP-10124\", \"TRIP-10125\", \"TRIP-10158\", \"TRIP-10128\", \"TRIP-10170\", \"TRIP-10171\", \"TRIP-10100\", \"TRIP-10120\", \"TRIP-10156\"], \"TRIP-10148\"=&gt;[\"TRIP-10142\", \"TRIP-10139\", \"TRIP-10097\", \"TRIP-10091\", \"TRIP-10092\", \"TRIP-10089\", \"TRIP-10093\", \"TRIP-10096\", \"TRIP-10112\", \"TRIP-10111\", \"TRIP-10113\", \"TRIP-10114\"], \"TRIP-10167\"=&gt;[\"TRIP-10118\", \"TRIP-10155\", \"TRIP-10119\", \"TRIP-10117\", \"TRIP-10154\", \"TRIP-10157\", \"TRIP-10176\", \"TRIP-10123\", \"TRIP-10160\", \"TRIP-10177\", \"TRIP-10179\", \"TRIP-10178\"], \"TRIP-10157\"=&gt;[\"TRIP-10122\", \"TRIP-10178\", \"TRIP-10106\", \"TRIP-10176\", \"TRIP-10118\", \"TRIP-10121\", \"TRIP-10179\", \"TRIP-10168\", \"TRIP-10119\", \"TRIP-10167\", \"TRIP-10169\", \"TRIP-10177\"], \"TRIP-10139\"=&gt;[\"TRIP-10148\", \"TRIP-10088\", \"TRIP-10149\", \"TRIP-10147\", \"TRIP-10092\", \"TRIP-10087\", \"TRIP-10086\", \"TRIP-10093\", \"TRIP-10091\", \"TRIP-10096\", \"TRIP-10112\", \"TRIP-10111\"], \"TRIP-10155\"=&gt;[\"TRIP-10167\", \"TRIP-10176\", \"TRIP-10179\", \"TRIP-10106\", \"TRIP-10117\", \"TRIP-10118\", \"TRIP-10119\", \"TRIP-10178\", \"TRIP-10177\", \"TRIP-10109\", \"TRIP-10116\", \"TRIP-10168\"], \"TRIP-10145\"=&gt;[\"TRIP-10127\", \"TRIP-10153\", \"TRIP-10108\", \"TRIP-10163\", \"TRIP-10161\", \"TRIP-10137\", \"TRIP-10175\", \"TRIP-10105\", \"TRIP-10146\", \"TRIP-10110\", \"TRIP-10115\", \"TRIP-10106\"], \"TRIP-10163\"=&gt;[\"TRIP-10115\", \"TRIP-10183\", \"TRIP-10108\", \"TRIP-10145\", \"TRIP-10129\", \"TRIP-10172\", \"TRIP-10130\", \"TRIP-10184\", \"TRIP-10105\", \"TRIP-10175\", \"TRIP-10106\", \"TRIP-10127\"], \"TRIP-10111\"=&gt;[\"TRIP-10091\", \"TRIP-10088\", \"TRIP-10141\", \"TRIP-10089\", \"TRIP-10147\", \"TRIP-10087\", \"TRIP-10139\", \"TRIP-10148\", \"TRIP-10093\", \"TRIP-10092\"], \"TRIP-10117\"=&gt;[\"TRIP-10106\", \"TRIP-10109\", \"TRIP-10155\", \"TRIP-10156\", \"TRIP-10179\", \"TRIP-10177\", \"TRIP-10167\", \"TRIP-10154\", \"TRIP-10178\", \"TRIP-10176\"], \"TRIP-10132\"=&gt;[\"TRIP-10106\", \"TRIP-10174\", \"TRIP-10162\", \"TRIP-10182\", \"TRIP-10160\", \"TRIP-10092\", \"TRIP-10173\", \"TRIP-10172\", \"TRIP-10100\", \"TRIP-10166\"], \"TRIP-10134\"=&gt;[\"TRIP-10165\", \"TRIP-10164\", \"TRIP-10174\", \"TRIP-10166\", \"TRIP-10185\", \"TRIP-10173\", \"TRIP-10183\", \"TRIP-10184\", \"TRIP-10186\", \"TRIP-10172\"], \"TRIP-10087\"=&gt;[\"TRIP-10086\", \"TRIP-10089\", \"TRIP-10147\", \"TRIP-10139\", \"TRIP-10088\", \"TRIP-10111\", \"TRIP-10068\", \"TRIP-10070\", \"TRIP-10082\", \"TRIP-10084\"], \"TRIP-10156\"=&gt;[\"TRIP-10180\", \"TRIP-10179\", \"TRIP-10121\", \"TRIP-10117\", \"TRIP-10125\", \"TRIP-10169\", \"TRIP-10100\", \"TRIP-10120\", \"TRIP-10181\", \"TRIP-10168\"], \"TRIP-10129\"=&gt;[\"TRIP-10105\", \"TRIP-10163\", \"TRIP-10172\", \"TRIP-10165\", \"TRIP-10175\", \"TRIP-10164\", \"TRIP-10183\", \"TRIP-10153\", \"TRIP-10185\", \"TRIP-10110\"], \"TRIP-10085\"=&gt;[\"TRIP-10081\", \"TRIP-10089\", \"TRIP-10076\", \"TRIP-10082\", \"TRIP-10083\", \"TRIP-10078\", \"TRIP-10084\", \"TRIP-10080\", \"TRIP-10070\", \"TRIP-10066\"], \"TRIP-10082\"=&gt;[\"TRIP-10088\", \"TRIP-10084\", \"TRIP-10083\", \"TRIP-10085\", \"TRIP-10086\", \"TRIP-10077\", \"TRIP-10079\", \"TRIP-10069\", \"TRIP-10087\", \"TRIP-10078\"], \"TRIP-10140\"=&gt;[\"TRIP-10149\", \"TRIP-10112\", \"TRIP-10094\", \"TRIP-10093\", \"TRIP-10113\", \"TRIP-10092\", \"TRIP-10097\", \"TRIP-10150\", \"TRIP-10096\", \"TRIP-10147\"], \"TRIP-10076\"=&gt;[\"TRIP-10075\", \"TRIP-10085\", \"TRIP-10074\", \"TRIP-10078\", \"TRIP-10071\", \"TRIP-10083\", \"TRIP-10080\", \"TRIP-10175\", \"TRIP-10084\", \"TRIP-10066\"], \"TRIP-10121\"=&gt;[\"TRIP-10168\", \"TRIP-10156\", \"TRIP-10179\", \"TRIP-10157\", \"TRIP-10169\"], \"TRIP-10098\"=&gt;[\"TRIP-10143\", \"TRIP-10113\", \"TRIP-10150\", \"TRIP-10141\", \"TRIP-10142\"], \"TRIP-10107\"=&gt;[\"TRIP-10131\", \"TRIP-10138\", \"TRIP-10153\", \"TRIP-10137\", \"TRIP-10090\"], \"TRIP-10133\"=&gt;[\"TRIP-10175\", \"TRIP-10162\", \"TRIP-10173\", \"TRIP-10182\", \"TRIP-10174\"], \"TRIP-10099\"=&gt;[\"TRIP-10143\", \"TRIP-10114\", \"TRIP-10151\", \"TRIP-10113\", \"TRIP-10141\", \"TRIP-10150\"], \"TRIP-10108\"=&gt;[\"TRIP-10115\", \"TRIP-10145\", \"TRIP-10163\", \"TRIP-10120\", \"TRIP-10161\", \"TRIP-10127\"], \"TRIP-10104\"=&gt;[\"TRIP-10116\", \"TRIP-10177\", \"TRIP-10152\", \"TRIP-10144\", \"TRIP-10154\", \"TRIP-10178\"], \"TRIP-10100\"=&gt;[\"TRIP-10120\", \"TRIP-10156\", \"TRIP-10181\", \"TRIP-10132\", \"TRIP-10166\", \"TRIP-10182\"], \"TRIP-10090\"=&gt;[\"TRIP-10065\", \"TRIP-10101\", \"TRIP-10110\", \"TRIP-10107\", \"TRIP-10137\", \"TRIP-10138\"], \"TRIP-10186\"=&gt;[\"TRIP-10135\", \"TRIP-10174\", \"TRIP-10130\", \"TRIP-10172\", \"TRIP-10134\", \"TRIP-10166\"], \"TRIP-10066\"=&gt;[\"TRIP-10071\", \"TRIP-10072\", \"TRIP-10073\", \"TRIP-10076\", \"TRIP-10078\", \"TRIP-10085\"], \"TRIP-10138\"=&gt;[\"TRIP-10137\", \"TRIP-10065\", \"TRIP-10107\", \"TRIP-10153\", \"TRIP-10090\", \"TRIP-10101\"], \"TRIP-10126\"=&gt;[\"TRIP-10158\", \"TRIP-10160\", \"TRIP-10181\", \"TRIP-10171\"], \"TRIP-10146\"=&gt;[\"TRIP-10153\", \"TRIP-10185\", \"TRIP-10145\", \"TRIP-10110\"], \"TRIP-10101\"=&gt;[\"TRIP-10090\", \"TRIP-10071\", \"TRIP-10137\", \"TRIP-10138\"], \"TRIP-10135\"=&gt;[\"TRIP-10186\", \"TRIP-10174\", \"TRIP-10166\", \"TRIP-10185\"], \"TRIP-10102\"=&gt;[\"TRIP-10143\", \"TRIP-10151\", \"TRIP-10144\", \"TRIP-10114\"], \"TRIP-10077\"=&gt;[\"TRIP-10079\", \"TRIP-10078\", \"TRIP-10082\", \"TRIP-10069\"], \"TRIP-10141\"=&gt;[\"TRIP-10092\", \"TRIP-10149\", \"TRIP-10150\", \"TRIP-10091\", \"TRIP-10093\", \"TRIP-10147\", \"TRIP-10187\", \"TRIP-10094\", \"TRIP-10098\", \"TRIP-10099\", \"TRIP-10113\", \"TRIP-10096\", \"TRIP-10111\"], \"TRIP-10096\"=&gt;[\"TRIP-10114\", \"TRIP-10142\", \"TRIP-10150\", \"TRIP-10113\", \"TRIP-10141\", \"TRIP-10143\", \"TRIP-10089\", \"TRIP-10112\", \"TRIP-10148\", \"TRIP-10139\", \"TRIP-10149\", \"TRIP-10140\", \"TRIP-10151\"], \"TRIP-10113\"=&gt;[\"TRIP-10098\", \"TRIP-10142\", \"TRIP-10150\", \"TRIP-10099\", \"TRIP-10141\", \"TRIP-10093\", \"TRIP-10140\", \"TRIP-10096\", \"TRIP-10143\", \"TRIP-10095\", \"TRIP-10149\", \"TRIP-10148\", \"TRIP-10147\"], \"TRIP-10171\"=&gt;[\"TRIP-10130\", \"TRIP-10124\", \"TRIP-10125\", \"TRIP-10123\", \"TRIP-10160\", \"TRIP-10181\", \"TRIP-10128\", \"TRIP-10161\", \"TRIP-10182\", \"TRIP-10184\", \"TRIP-10120\", \"TRIP-10126\", \"TRIP-10158\"], \"TRIP-10089\"=&gt;[\"TRIP-10187\", \"TRIP-10085\", \"TRIP-10087\", \"TRIP-10147\", \"TRIP-10092\", \"TRIP-10097\", \"TRIP-10148\", \"TRIP-10112\", \"TRIP-10149\", \"TRIP-10093\", \"TRIP-10091\", \"TRIP-10111\", \"TRIP-10096\"], \"TRIP-10177\"=&gt;[\"TRIP-10104\", \"TRIP-10106\", \"TRIP-10152\", \"TRIP-10103\", \"TRIP-10117\", \"TRIP-10155\", \"TRIP-10154\", \"TRIP-10116\", \"TRIP-10123\", \"TRIP-10160\", \"TRIP-10167\", \"TRIP-10118\", \"TRIP-10157\"], \"TRIP-10182\"=&gt;[\"TRIP-10133\", \"TRIP-10162\", \"TRIP-10132\", \"TRIP-10128\", \"TRIP-10160\", \"TRIP-10174\", \"TRIP-10173\", \"TRIP-10161\", \"TRIP-10171\", \"TRIP-10172\", \"TRIP-10109\", \"TRIP-10100\", \"TRIP-10166\"], \"TRIP-10095\"=&gt;[\"TRIP-10142\", \"TRIP-10150\", \"TRIP-10113\"], \"TRIP-10065\"=&gt;[\"TRIP-10090\", \"TRIP-10137\", \"TRIP-10138\"], \"TRIP-10187\"=&gt;[\"TRIP-10089\", \"TRIP-10141\", \"TRIP-10147\"], \"TRIP-10124\"=&gt;[\"TRIP-10170\", \"TRIP-10171\", \"TRIP-10160\", \"TRIP-10181\", \"TRIP-10158\", \"TRIP-10180\", \"TRIP-10106\", \"TRIP-10176\"], \"TRIP-10143\"=&gt;[\"TRIP-10098\", \"TRIP-10099\", \"TRIP-10150\", \"TRIP-10102\", \"TRIP-10151\", \"TRIP-10096\", \"TRIP-10113\", \"TRIP-10114\"], \"TRIP-10162\"=&gt;[\"TRIP-10133\", \"TRIP-10132\", \"TRIP-10131\", \"TRIP-10182\", \"TRIP-10174\", \"TRIP-10173\", \"TRIP-10172\", \"TRIP-10185\"], \"TRIP-10071\"=&gt;[\"TRIP-10066\", \"TRIP-10101\", \"TRIP-10072\", \"TRIP-10073\", \"TRIP-10075\", \"TRIP-10076\", \"TRIP-10175\", \"TRIP-10067\"], \"TRIP-10074\"=&gt;[\"TRIP-10078\", \"TRIP-10075\", \"TRIP-10076\", \"TRIP-10072\", \"TRIP-10073\", \"TRIP-10068\", \"TRIP-10070\", \"TRIP-10086\"], \"TRIP-10075\"=&gt;[\"TRIP-10076\", \"TRIP-10074\", \"TRIP-10078\", \"TRIP-10080\", \"TRIP-10081\", \"TRIP-10071\", \"TRIP-10084\", \"TRIP-10175\"], \"TRIP-10081\"=&gt;[\"TRIP-10085\", \"TRIP-10079\", \"TRIP-10078\", \"TRIP-10075\", \"TRIP-10080\", \"TRIP-10083\", \"TRIP-10084\", \"TRIP-10069\"], \"TRIP-10159\"=&gt;[\"TRIP-10179\", \"TRIP-10178\", \"TRIP-10123\", \"TRIP-10170\", \"TRIP-10180\", \"TRIP-10176\", \"TRIP-10169\", \"TRIP-10122\"], \"TRIP-10079\"=&gt;[\"TRIP-10077\", \"TRIP-10070\", \"TRIP-10081\", \"TRIP-10080\", \"TRIP-10078\", \"TRIP-10082\", \"TRIP-10069\", \"TRIP-10084\"], \"TRIP-10180\"=&gt;[\"TRIP-10156\", \"TRIP-10158\", \"TRIP-10125\", \"TRIP-10123\", \"TRIP-10159\", \"TRIP-10124\", \"TRIP-10170\", \"TRIP-10169\"], \"TRIP-10170\"=&gt;[\"TRIP-10125\", \"TRIP-10124\", \"TRIP-10123\", \"TRIP-10159\", \"TRIP-10181\", \"TRIP-10128\", \"TRIP-10158\", \"TRIP-10180\"], \"TRIP-10152\"=&gt;[\"TRIP-10103\", \"TRIP-10144\", \"TRIP-10106\", \"TRIP-10177\", \"TRIP-10104\", \"TRIP-10176\", \"TRIP-10116\", \"TRIP-10114\"], \"TRIP-10123\"=&gt;[\"TRIP-10159\", \"TRIP-10170\", \"TRIP-10160\", \"TRIP-10171\", \"TRIP-10180\", \"TRIP-10178\", \"TRIP-10176\", \"TRIP-10169\", \"TRIP-10167\", \"TRIP-10177\", \"TRIP-10179\"], \"TRIP-10084\"=&gt;[\"TRIP-10082\", \"TRIP-10080\", \"TRIP-10088\", \"TRIP-10070\", \"TRIP-10083\", \"TRIP-10075\", \"TRIP-10081\", \"TRIP-10085\", \"TRIP-10087\", \"TRIP-10076\", \"TRIP-10079\"], \"TRIP-10093\"=&gt;[\"TRIP-10142\", \"TRIP-10141\", \"TRIP-10147\", \"TRIP-10139\", \"TRIP-10148\", \"TRIP-10113\", \"TRIP-10140\", \"TRIP-10089\", \"TRIP-10112\", \"TRIP-10149\", \"TRIP-10111\"], \"TRIP-10174\"=&gt;[\"TRIP-10166\", \"TRIP-10135\", \"TRIP-10132\", \"TRIP-10134\", \"TRIP-10186\", \"TRIP-10133\", \"TRIP-10162\", \"TRIP-10160\", \"TRIP-10182\", \"TRIP-10185\", \"TRIP-10184\"], \"TRIP-10169\"=&gt;[\"TRIP-10125\", \"TRIP-10156\", \"TRIP-10123\", \"TRIP-10159\", \"TRIP-10122\", \"TRIP-10158\", \"TRIP-10179\", \"TRIP-10121\", \"TRIP-10180\", \"TRIP-10157\", \"TRIP-10178\"], \"TRIP-10164\"=&gt;[\"TRIP-10134\", \"TRIP-10130\", \"TRIP-10184\", \"TRIP-10110\", \"TRIP-10131\", \"TRIP-10185\", \"TRIP-10183\", \"TRIP-10172\", \"TRIP-10105\", \"TRIP-10129\", \"TRIP-10127\"], \"TRIP-10149\"=&gt;[\"TRIP-10140\", \"TRIP-10139\", \"TRIP-10141\", \"TRIP-10112\", \"TRIP-10094\", \"TRIP-10089\", \"TRIP-10097\", \"TRIP-10142\", \"TRIP-10093\", \"TRIP-10096\", \"TRIP-10113\"], \"TRIP-10150\"=&gt;[\"TRIP-10142\", \"TRIP-10143\", \"TRIP-10141\", \"TRIP-10097\", \"TRIP-10113\", \"TRIP-10098\", \"TRIP-10095\", \"TRIP-10096\", \"TRIP-10099\", \"TRIP-10112\", \"TRIP-10140\"], \"TRIP-10147\"=&gt;[\"TRIP-10139\", \"TRIP-10093\", \"TRIP-10141\", \"TRIP-10187\", \"TRIP-10087\", \"TRIP-10089\", \"TRIP-10092\", \"TRIP-10091\", \"TRIP-10111\", \"TRIP-10113\", \"TRIP-10140\"], \"TRIP-10086\"=&gt;[\"TRIP-10067\", \"TRIP-10087\", \"TRIP-10088\", \"TRIP-10139\", \"TRIP-10082\", \"TRIP-10068\", \"TRIP-10070\", \"TRIP-10083\", \"TRIP-10074\"], \"TRIP-10120\"=&gt;[\"TRIP-10100\", \"TRIP-10168\", \"TRIP-10108\", \"TRIP-10161\", \"TRIP-10110\", \"TRIP-10156\", \"TRIP-10181\", \"TRIP-10183\", \"TRIP-10171\"], \"TRIP-10115\"=&gt;[\"TRIP-10110\", \"TRIP-10108\", \"TRIP-10105\", \"TRIP-10163\", \"TRIP-10183\", \"TRIP-10165\", \"TRIP-10145\", \"TRIP-10175\", \"TRIP-10106\"], \"TRIP-10069\"=&gt;[\"TRIP-10067\", \"TRIP-10068\", \"TRIP-10070\", \"TRIP-10077\", \"TRIP-10079\", \"TRIP-10082\", \"TRIP-10083\", \"TRIP-10080\", \"TRIP-10081\"], \"TRIP-10131\"=&gt;[\"TRIP-10173\", \"TRIP-10107\", \"TRIP-10162\", \"TRIP-10164\", \"TRIP-10165\", \"TRIP-10185\", \"TRIP-10183\", \"TRIP-10172\", \"TRIP-10184\"], \"TRIP-10166\"=&gt;[\"TRIP-10174\", \"TRIP-10185\", \"TRIP-10135\", \"TRIP-10134\", \"TRIP-10186\", \"TRIP-10184\", \"TRIP-10100\", \"TRIP-10132\", \"TRIP-10182\"], \"TRIP-10105\"=&gt;[\"TRIP-10129\", \"TRIP-10165\", \"TRIP-10115\", \"TRIP-10164\", \"TRIP-10127\", \"TRIP-10145\", \"TRIP-10163\", \"TRIP-10183\", \"TRIP-10184\"], \"TRIP-10109\"=&gt;[\"TRIP-10154\", \"TRIP-10117\", \"TRIP-10116\", \"TRIP-10155\", \"TRIP-10178\", \"TRIP-10128\", \"TRIP-10160\", \"TRIP-10182\", \"TRIP-10179\"], \"TRIP-10154\"=&gt;[\"TRIP-10109\", \"TRIP-10104\", \"TRIP-10177\", \"TRIP-10117\", \"TRIP-10167\", \"TRIP-10106\", \"TRIP-10178\", \"TRIP-10116\", \"TRIP-10179\"], \"TRIP-10080\"=&gt;[\"TRIP-10084\", \"TRIP-10070\", \"TRIP-10079\", \"TRIP-10075\", \"TRIP-10081\", \"TRIP-10076\", \"TRIP-10078\", \"TRIP-10085\", \"TRIP-10069\"], \"TRIP-10151\"=&gt;[\"TRIP-10103\", \"TRIP-10144\", \"TRIP-10102\", \"TRIP-10143\", \"TRIP-10099\", \"TRIP-10114\", \"TRIP-10096\", \"TRIP-10094\", \"TRIP-10142\"], \"TRIP-10142\"=&gt;[\"TRIP-10148\", \"TRIP-10093\", \"TRIP-10150\", \"TRIP-10097\", \"TRIP-10113\", \"TRIP-10095\", \"TRIP-10096\", \"TRIP-10098\", \"TRIP-10149\", \"TRIP-10112\", \"TRIP-10094\", \"TRIP-10114\", \"TRIP-10151\", \"TRIP-10092\"], \"TRIP-10078\"=&gt;[\"TRIP-10077\", \"TRIP-10072\", \"TRIP-10074\", \"TRIP-10079\", \"TRIP-10081\", \"TRIP-10075\", \"TRIP-10076\", \"TRIP-10080\", \"TRIP-10073\", \"TRIP-10083\", \"TRIP-10070\", \"TRIP-10085\", \"TRIP-10082\", \"TRIP-10066\"], \"TRIP-10106\"=&gt;[\"TRIP-10117\", \"TRIP-10132\", \"TRIP-10152\", \"TRIP-10177\", \"TRIP-10155\", \"TRIP-10157\", \"TRIP-10176\", \"TRIP-10154\", \"TRIP-10115\", \"TRIP-10145\", \"TRIP-10163\", \"TRIP-10124\", \"TRIP-10160\", \"TRIP-10116\"], \"TRIP-10165\"=&gt;[\"TRIP-10134\", \"TRIP-10184\", \"TRIP-10105\", \"TRIP-10173\", \"TRIP-10131\", \"TRIP-10185\", \"TRIP-10136\", \"TRIP-10183\", \"TRIP-10129\", \"TRIP-10175\", \"TRIP-10110\", \"TRIP-10115\", \"TRIP-10127\", \"TRIP-10172\"], \"TRIP-10110\"=&gt;[\"TRIP-10115\", \"TRIP-10090\", \"TRIP-10164\", \"TRIP-10165\", \"TRIP-10120\", \"TRIP-10161\", \"TRIP-10127\", \"TRIP-10145\", \"TRIP-10153\", \"TRIP-10183\", \"TRIP-10129\", \"TRIP-10128\", \"TRIP-10146\", \"TRIP-10185\"], \"TRIP-10127\"=&gt;[\"TRIP-10161\", \"TRIP-10172\", \"TRIP-10145\", \"TRIP-10153\", \"TRIP-10105\", \"TRIP-10164\", \"TRIP-10165\", \"TRIP-10173\", \"TRIP-10110\", \"TRIP-10175\", \"TRIP-10185\", \"TRIP-10184\", \"TRIP-10108\", \"TRIP-10163\", \"TRIP-10183\"], \"TRIP-10175\"=&gt;[\"TRIP-10133\", \"TRIP-10129\", \"TRIP-10165\", \"TRIP-10137\", \"TRIP-10145\", \"TRIP-10136\", \"TRIP-10153\", \"TRIP-10185\", \"TRIP-10127\", \"TRIP-10115\", \"TRIP-10163\", \"TRIP-10183\", \"TRIP-10071\", \"TRIP-10075\", \"TRIP-10076\"], \"TRIP-10160\"=&gt;[\"TRIP-10126\", \"TRIP-10181\", \"TRIP-10124\", \"TRIP-10123\", \"TRIP-10171\", \"TRIP-10128\", \"TRIP-10182\", \"TRIP-10132\", \"TRIP-10092\", \"TRIP-10174\", \"TRIP-10106\", \"TRIP-10176\", \"TRIP-10167\", \"TRIP-10177\", \"TRIP-10109\"], \"TRIP-10178\"=&gt;[\"TRIP-10159\", \"TRIP-10157\", \"TRIP-10123\", \"TRIP-10119\", \"TRIP-10155\", \"TRIP-10109\", \"TRIP-10154\", \"TRIP-10168\", \"TRIP-10122\", \"TRIP-10118\", \"TRIP-10117\", \"TRIP-10104\", \"TRIP-10116\", \"TRIP-10167\", \"TRIP-10169\"], \"TRIP-10176\"=&gt;[\"TRIP-10155\", \"TRIP-10106\", \"TRIP-10157\", \"TRIP-10152\", \"TRIP-10118\", \"TRIP-10103\", \"TRIP-10123\", \"TRIP-10159\", \"TRIP-10116\", \"TRIP-10119\", \"TRIP-10168\", \"TRIP-10117\", \"TRIP-10167\", \"TRIP-10124\", \"TRIP-10160\"], \"TRIP-10183\"=&gt;[\"TRIP-10115\", \"TRIP-10163\", \"TRIP-10130\", \"TRIP-10164\", \"TRIP-10136\", \"TRIP-10165\", \"TRIP-10134\", \"TRIP-10129\", \"TRIP-10131\", \"TRIP-10105\", \"TRIP-10110\", \"TRIP-10120\", \"TRIP-10161\", \"TRIP-10175\", \"TRIP-10128\", \"TRIP-10127\"], \"TRIP-10179\"=&gt;[\"TRIP-10159\", \"TRIP-10156\", \"TRIP-10155\", \"TRIP-10121\", \"TRIP-10117\", \"TRIP-10157\", \"TRIP-10122\", \"TRIP-10158\", \"TRIP-10168\", \"TRIP-10169\", \"TRIP-10119\", \"TRIP-10167\", \"TRIP-10123\", \"TRIP-10109\", \"TRIP-10116\", \"TRIP-10154\"], \"TRIP-10172\"=&gt;[\"TRIP-10127\", \"TRIP-10130\", \"TRIP-10164\", \"TRIP-10129\", \"TRIP-10163\", \"TRIP-10186\", \"TRIP-10131\", \"TRIP-10162\", \"TRIP-10185\", \"TRIP-10134\", \"TRIP-10165\", \"TRIP-10184\", \"TRIP-10128\", \"TRIP-10161\", \"TRIP-10132\", \"TRIP-10182\"], \"TRIP-10184\"=&gt;[\"TRIP-10165\", \"TRIP-10164\", \"TRIP-10161\", \"TRIP-10136\", \"TRIP-10153\", \"TRIP-10130\", \"TRIP-10163\", \"TRIP-10134\", \"TRIP-10105\", \"TRIP-10127\", \"TRIP-10172\", \"TRIP-10173\", \"TRIP-10128\", \"TRIP-10171\", \"TRIP-10166\", \"TRIP-10174\", \"TRIP-10131\"], \"TRIP-10185\"=&gt;[\"TRIP-10166\", \"TRIP-10153\", \"TRIP-10146\", \"TRIP-10131\", \"TRIP-10165\", \"TRIP-10164\", \"TRIP-10134\", \"TRIP-10136\", \"TRIP-10175\", \"TRIP-10127\", \"TRIP-10162\", \"TRIP-10172\", \"TRIP-10173\", \"TRIP-10135\", \"TRIP-10174\", \"TRIP-10129\", \"TRIP-10110\"]}</code></p>\n"}, {"tags": ["ruby", "lambda", "functional-programming"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1511249509, "post_id": 47407389, "comment_id": 81768181, "body": "I&#39;d also be interested to know if there&#39;s any objective reason to prevent this syntax. Here&#39;s a related question (duplicate?) : <a href=\"https://stackoverflow.com/questions/6343812/calling-applying-lambda-vs-function-call-the-syntax-in-ruby-is-different-why\" title=\"calling applying lambda vs function call the syntax in ruby is different why\">stackoverflow.com/questions/6343812/&hellip;</a> The answer isn&#39;t very satisfying though IMHO."}, {"owner": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 0, "creation_date": 1511249839, "post_id": 47407389, "comment_id": 81768365, "body": "Here&#39;s <a href=\"https://stackoverflow.com/questions/1686844/why-isnt-the-ruby-1-9-lambda-call-possible-without-the-dot-in-front-of-the-pare\">another explanation</a>. Supposedly Ruby doesn&#39;t permit () to be defined on an object because the parentheses are optional in a method call. I agree though, the .() syntax drives me nuts."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1511249983, "post_id": 47407389, "comment_id": 81768448, "body": "Why fuss over just a single period?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511250442, "post_id": 47407389, "comment_id": 81768667, "body": "@sawa: Because Ruby is all about syntactic sugar?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 0, "creation_date": 1511250488, "post_id": 47407389, "comment_id": 81768681, "body": "@chickenburgers: This makes the most sense to me."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 135, "user_id": 4028239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GAbTC.jpg?s=128&g=1", "display_name": "vladpisanov", "link": "https://stackoverflow.com/users/4028239/vladpisanov"}, "edited": false, "score": 3, "creation_date": 1511268527, "post_id": 47407389, "comment_id": 81780303, "body": "@chickenburgers: it isn&#39;t really about &quot;permitting it&quot;. It is simply impossible. If you were to allow it, then it would no longer be possible to know what <code>foo()</code> means."}], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1511250615, "post_id": 47407710, "comment_id": 81768749, "body": "Even more so - consider <code>def make_yo_printer; lambda { puts &quot;yo&quot; }; end</code>. OP, under your proposal, what do you expect <code>make_yo_printer()</code> to do? Under current Ruby syntax, it is clear: <code>make_yo_printer</code> returns a lambda, <code>make_yo_printer()</code> as well, while <code>make_yo_printer.()</code> and <code>make_yo_printer().()</code> both execute it. But if <code>()</code> executes lambdas, it is not clear what do parentheses belong to in <code>make_yo_printer()</code>: to the <code>make_yo_printer</code> call, or to the returned lambda. This dilemma does not exist in Python, since <code>()</code> is always needed to execute a call."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1511250675, "post_id": 47407710, "comment_id": 81768774, "body": "Code having the same name for local variables and methods probably deserves to break."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1511250721, "post_id": 47407710, "comment_id": 81768802, "body": "@Amadan: That&#39;s the reason indeed. Methods can be called without parens."}, {"owner": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "edited": false, "score": 0, "creation_date": 1511272920, "post_id": 47407710, "comment_id": 81783417, "body": "It seems pretty obvious to me that <code>object()</code> should return a lambda; ommitting () is just syntactic sugar, after all. To call the lambda it would be <code>object()()</code>. As for the ambiguity of an object and a method sharing a name, first of all I think that&#39;s a terrible style choice, secondly in that case <code>object</code> should be the object while <code>object()</code> should be the method. Simple, isn&#39;t it? and you could still access <code>object.()</code> like with other overloaded operators (<code>object.+(other_object)</code>)."}, {"owner": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1511273225, "post_id": 47407710, "comment_id": 81783613, "body": "@Amadan same could be said about <code>method { ... }</code> though. Is <code>{ ... }</code> a block? is it a hash? The answer is simple, it&#39;s a block. Why? Because at some point somebody just defined it to be that way. Same goes for your example. Just make clear that <code>whatever()</code> calls <code>whatever</code> if it&#39;s a method, or tries the <code>()</code> operator if it isn&#39;t. That makes sense, is intuitive and wouldn&#39;t break any code. <code>make_yo_printer()</code> would then unambiguously call <code>make_yo_printer</code> and return a lambda, as any sane programmer would expect."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "edited": false, "score": 0, "creation_date": 1511321540, "post_id": 47407710, "comment_id": 81807499, "body": "@DarkWiiPlayer: Is it really that intuitive, and something any sane programmer would expect? It is key to the design of Ruby that there is no distinction between methods and properties. <code>arr.size</code> is a method; <code>arr.size()</code> is perfectly legal but weird. Now imagine if my method wasn&#39;t called <code>make_yo_printer</code> but <code>yo_printer</code>, and normal access being <code>yo_printer.call</code>? Now would you expect it to be equivalent to <code>yo_printer()</code> or <code>yo_printer()()</code>?"}, {"owner": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "edited": false, "score": 0, "creation_date": 1511421343, "post_id": 47407710, "comment_id": 81854042, "body": "If <code>yo_printer</code> returns a lambda, I&#39;d expect both <code>yo_printer</code> and <code>yo_printer()</code> to return a lambda. Again, because <code>yo_printer</code> and <code>yo_printer()</code> should be the same according to how ruby is supposed to work. There&#39;s no ambiguity or uncertainty either; unlike in other languages, in ruby <code>object.attribute</code> is ALWAYS a method, even if its syntax makes it look like a real attribute. Also, if <code>yo_printer</code> was meant to be used like that, it&#39;d be <code>print_yo</code>; if it returns a lambda, it&#39;s probably not meant to be called directly except in a few special cases."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 5, "last_activity_date": 1511251138, "last_edit_date": 1511251138, "creation_date": 1511250084, "answer_id": 47407710, "question_id": 47407389, "link": "https://stackoverflow.com/questions/47407389/why-no-operator-for-objects/47407710#47407710", "title": "Why no `()` operator for objects?", "body": "<blockquote>\n  <p>Why not add a () operator that can be overloaded?</p>\n</blockquote>\n\n<p>It would be ambiguous. If <code>object</code> is both, a method and a local variable, then <code>object</code> refers to the local variable, whereas <code>object()</code> invokes the method:</p>\n\n<pre><code>def object\n  123\nend\nobject = :abc\n\nobject   #=&gt; :abc\nobject() #=&gt; 123\n</code></pre>\n\n<p>Changing this convention would likely break existing code.</p>\n\n<p>That's (presumably) why Ruby has <code>object.()</code> \u2013 it is syntactic sugar for <code>object.call</code>:</p>\n\n<pre><code>class MyClass\n  def call\n    123\n  end\nend\n\nobject = MyClass.new\nobject.call #=&gt; 123\nobject.()   #=&gt; 123\n</code></pre>\n\n<p>Having a separate syntax to call lambdas allows to distinguish between a method call and calling a lambda which is returned by that method: (thanks Amadan for pointing that out)</p>\n\n<pre><code>def object\n  -&gt; { 123 }\nend\n\nobject    #=&gt; #&lt;Proc:0x007fe494110a78@(irb):2 (lambda)&gt;\nobject()  #=&gt; #&lt;Proc:0x007fe494110a78@(irb):2 (lambda)&gt;\n\nobject.()   #=&gt; 123\nobject().() #=&gt; 123\n</code></pre>\n"}], "owner": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511274824, "creation_date": 1511248909, "last_edit_date": 1592644375, "question_id": 47407389, "link": "https://stackoverflow.com/questions/47407389/why-no-operator-for-objects", "title": "Why no `()` operator for objects?", "body": "<p>Lambdas (and procs) in Ruby are just objects with a <code>call</code> method, as in any OO language with functional programming glued on as an afterthought. There are also:</p>\n<ul>\n<li><code>lambda.(&lt;args&gt;)</code></li>\n<li><code>lambda[&lt;args&gt;]</code></li>\n</ul>\n<p>as syntactic sugar for <code>lambda.call()</code>.</p>\n<p>Lua allows for a <code>__call</code> meta method, that lets me call an object, and in the background, the arguments (and the table) are handed to a real function that does the actual magic.</p>\n<p>Lambdas don't feel like dealing with real functions since they are called with <code>[]</code> or <code>.()</code> instead of <code>()</code>. Why not add a <code>()</code> operator that can be overloaded? Then <code>object()</code> would be translated to mean <code>object.()</code>, same as with <code>+</code>, <code>||</code> or any other operator.</p>\n<p>Wouldn't it make sense to have syntactic sugar that allows calling the lambda directly? Is this more a matter of design philosophy than technical limitations?</p>\n<h3>Addressing some &quot;problems&quot; (that aren't really problems) that people have brought up:</h3>\n<p><em>If a method returns a lambda, what does that method followed by () mean? does it call only the method, or also the returned lambda?</em></p>\n<p><code>method()</code> means call <code>method</code>. If that expression returns a lambda, <code>method()()</code> would then call said lambda. The opposite would make no sense at all.</p>\n<p><em>If there is a method called foo, and a callable object called foo, what does foo() mean?</em></p>\n<p>Answer: <em>if foo is a method and a variable, what do you expect <code>foo</code> to evaluate to?</em> The variable. Ruby already does deal with this kind of ambiguity by simply choosing the more intuitive of two options. Thus, if there is a method <code>foo</code>, <code>foo()</code> should call that method. If there's a callable method <code>foo</code> in the same scope, that'd be shadowed by the real function.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 5014, "user_id": 3640770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HJBjs.jpg?s=128&g=1", "display_name": "IngoAlbers", "link": "https://stackoverflow.com/users/3640770/ingoalbers"}, "is_accepted": false, "score": 1, "last_activity_date": 1511248651, "creation_date": 1511248651, "answer_id": 47407310, "question_id": 47407280, "link": "https://stackoverflow.com/questions/47407280/rails-get-controller-action-url/47407310#47407310", "title": "Rails get controller action url", "body": "<p>Rails provides path as well as url helpers for all the routes.</p>\n\n<p>So if you use <code>group_report_statistics_url(id)</code>, you will get the full URL.</p>\n"}, {"tags": [], "owner": {"reputation": 10770, "user_id": 381874, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/k7VRE.jpg?s=128&g=1", "display_name": "Sachin R", "link": "https://stackoverflow.com/users/381874/sachin-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1511248752, "creation_date": 1511248752, "answer_id": 47407341, "question_id": 47407280, "link": "https://stackoverflow.com/questions/47407280/rails-get-controller-action-url/47407341#47407341", "title": "Rails get controller action url", "body": "<p>try this </p>\n\n<pre><code>File.join(root_url + group_report_statistics_path(id))\n</code></pre>\n\n<p>or </p>\n\n<pre><code> group_report_statistics_url(id)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4527, "user_id": 5497690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577c8ad14fffb59cd619e43634c51dad?s=128&d=identicon&r=PG&f=1", "display_name": "puneet18", "link": "https://stackoverflow.com/users/5497690/puneet18"}, "is_accepted": false, "score": 2, "last_activity_date": 1511258997, "creation_date": 1511258997, "answer_id": 47410384, "question_id": 47407280, "link": "https://stackoverflow.com/questions/47407280/rails-get-controller-action-url/47410384#47410384", "title": "Rails get controller action url", "body": "<p>Use <code>group_report_statistics_url(id)</code></p>\n\n<p><code>_path</code> helpers provide a site-root-relative path. You should probably use this most of the time.</p>\n\n<p><code>_url</code> helpers provide an absolute path, including protocol and server name. I've found that I mainly use these in emails when creating links to the app on the server. They should mainly be used when providing links for external use.</p>\n"}], "owner": {"reputation": 3691, "user_id": 3732906, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d83d53cbd84d7427ebfd45190b9ded9d?s=128&d=identicon&r=PG&f=1", "display_name": "Coda Chang", "link": "https://stackoverflow.com/users/3732906/coda-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1693, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1511258997, "creation_date": 1511248534, "question_id": 47407280, "link": "https://stackoverflow.com/questions/47407280/rails-get-controller-action-url", "title": "Rails get controller action url", "body": "<p>I have an action, and I've defined it in the <code>routes.rb</code></p>\n\n<pre><code>resources :statistics, only: [] do\n  get 'group_report/:id', to: 'statistics#group_report', as: 'group_report'\nend\n</code></pre>\n\n<p>Then in the method in the model, I want to return the full URL. </p>\n\n<p>Thus, I wrote this method </p>\n\n<pre><code>root_url + group_report_statistics_path(id)\n</code></pre>\n\n<p>The result is <code>\"http://localhost:3000//statistics/group_report/DHo6qzUzYXw\"</code></p>\n\n<p>I thought it was a dirty way, and I need to handle the double slash as well.</p>\n\n<p>Does Rails provide some useful method which I can get the full URL of the action directly? </p>\n"}, {"tags": ["ruby", "heroku", "sinatra", "asset-pipeline", "sinatra-assetpack"], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 3897591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99fb11088a9dc9fc6c422951c3640669?s=128&d=identicon&r=PG", "display_name": "scarsam", "link": "https://stackoverflow.com/users/3897591/scarsam"}, "is_accepted": false, "score": 1, "last_activity_date": 1511246742, "creation_date": 1511246742, "answer_id": 47406812, "question_id": 47406294, "link": "https://stackoverflow.com/questions/47406294/sinatra-asset-pipeline-gem-compiles-to-an-empty-json/47406812#47406812", "title": "Sinatra asset pipeline gem, compiles to an empty .json", "body": "<p>I had to specify the asset_precompile inside my Controller to get my rake task to compile in the right format: <code>set :assets_precompile, %w(application.css *.png *.jpg *.svg *.eot *.ttf *.woff *.woff2)</code> I hope this answer can help anyone else struggling with Sinatra and asset pipeline.</p>\n\n<pre><code>class ApplicationController &lt; Sinatra::Base\n  register Sinatra::Sprockets::Helpers\n\n  set :assets_precompile, %w(application.css *.png *.jpg *.svg *.eot *.ttf *.woff *.woff2)\n\n  register Sinatra::AssetPipeline\n  set :sprockets, Sprockets::Environment.new('app')\n  set :assets_prefix, '/assets'\n  set :digest_assets, true\n\n  configure do\n    set :public_folder, 'public'\n    set :views, 'app/views'\n    sprockets.append_path File.join('assets', 'stylesheets')\n  end\n\n  get '/' do\n    erb :'index'\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 3897591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99fb11088a9dc9fc6c422951c3640669?s=128&d=identicon&r=PG", "display_name": "scarsam", "link": "https://stackoverflow.com/users/3897591/scarsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511246742, "creation_date": 1511244514, "question_id": 47406294, "link": "https://stackoverflow.com/questions/47406294/sinatra-asset-pipeline-gem-compiles-to-an-empty-json", "title": "Sinatra asset pipeline gem, compiles to an empty .json", "body": "<p>I'm trying to get <a href=\"https://github.com/kalasjocke/sinatra-asset-pipeline\" rel=\"nofollow noreferrer\">sinatra-asset-pipeline</a> to work for my Sinatra application, so I can get my assets to display on Heroku. I'm following a MVC pattern and is currently storing my assets inside <code>project-folder/assets/stylesheets/application.scss</code>. My <code>config/environment.rb</code> file contains all the gem requirements: </p>\n\n<pre><code>require 'bundler/setup'\nBundler.require\nrequire 'sprockets'\nrequire 'sinatra/activerecord/rake'\nrequire 'sinatra/asset_pipeline/task'\nrequire 'sinatra/asset_pipeline'\nrequire 'sinatra/sprockets-helpers'\nrequire 'rack-flash'\nrequire 'sass/plugin/rack'\nrequire_all 'app'\n</code></pre>\n\n<p>I configure the <strong>sinatra-asset-pipeline</strong> gem inside my <code>ApplicationController</code>.</p>\n\n<pre><code>require './config/environment'\n\nclass ApplicationController &lt; Sinatra::Base\n  register Sinatra::Sprockets::Helpers\n  register Sinatra::AssetPipeline\n  set :sprockets, Sprockets::Environment.new('app')\n  set :assets_prefix, '/assets'\n  set :digest_assets, true\n\n  configure do\n    set :public_folder, 'public'\n    set :views, 'app/views'\n    sprockets.append_path File.join('app', 'assets', 'stylesheets')\n  end\n\n  get '/' do\n    erb :'index'\n  end\n\nend\n</code></pre>\n\n<p>My <strong>Rakefile</strong> contains the code for running the rake task</p>\n\n<pre><code>Sinatra::AssetPipeline::Task.define! ApplicationController\n</code></pre>\n\n<p>When I run <code>rake assets:precompile --trace</code> I get:</p>\n\n<pre><code>** Invoke assets:precompile (first_time)\n** Execute assets:precompile\n</code></pre>\n\n<p>Which creates the folder <code>/public/assets/.sprockets-manifest-107e377ad857386671d3a9b56a890322.json</code>. This file is only containing this line of code: <code>{}</code></p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby", "ruby-on-rails-4", "asset-pipeline"], "comments": [{"owner": {"reputation": 157, "user_id": 1843919, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/993a0.png?s=128&g=1", "display_name": "Rebel Rider", "link": "https://stackoverflow.com/users/1843919/rebel-rider"}, "edited": false, "score": 0, "creation_date": 1511245190, "post_id": 47406247, "comment_id": 81766201, "body": "u can assign the same in controller and use the instance variable right"}, {"owner": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "reply_to_user": {"reputation": 157, "user_id": 1843919, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/993a0.png?s=128&g=1", "display_name": "Rebel Rider", "link": "https://stackoverflow.com/users/1843919/rebel-rider"}, "edited": false, "score": 0, "creation_date": 1511246290, "post_id": 47406247, "comment_id": 81766638, "body": "yes I do code in Controller&#39;s Show method and when page load I want to check css colour from Model"}, {"owner": {"reputation": 1310, "user_id": 1284725, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6QMbe.png?s=128&g=1", "display_name": "Charlie Weems", "link": "https://stackoverflow.com/users/1284725/charlie-weems"}, "edited": false, "score": 1, "creation_date": 1511248309, "post_id": 47406247, "comment_id": 81767579, "body": "You can&#39;t access params directly in a template. You need to get the value in your controller, declare it as an instance variable and then access the instance variable in the template."}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "edited": false, "score": 0, "creation_date": 1511252496, "post_id": 47407355, "comment_id": 81769753, "body": "ya, it&#39;s working already but if I want to use different CSS file for this so how can I?"}, {"owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "reply_to_user": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "edited": false, "score": 1, "creation_date": 1511255410, "post_id": 47407355, "comment_id": 81771544, "body": "@RonakBhatt any css that is common put in css file. And any dynamic classes put in layout as shown above"}], "tags": [], "owner": {"reputation": 2372, "user_id": 8478218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0tjM.jpg?s=128&g=1", "display_name": "krishnar", "link": "https://stackoverflow.com/users/8478218/krishnar"}, "is_accepted": false, "score": 2, "last_activity_date": 1511248791, "last_edit_date": 1592644375, "creation_date": 1511248791, "answer_id": 47407355, "question_id": 47406247, "link": "https://stackoverflow.com/questions/47406247/how-to-access-rails-instance-variabletheme-in-custom-css-erb/47407355#47407355", "title": "how to access rails instance variable(@theme) in custom.css.erb?", "body": "<p>Dynamic css styles which are using instance variables should not be put inside css.erb / css.haml as it wont work properly.\nConsider asset precompilation.\nRails will precompile assets before starting application and there after it will be static resource. So, your dynamicity can't be achieved here</p>\n<h3>Solution:</h3>\n<p>Just put those dynamic css styles inside layout</p>\n<p><strong>/layout/home.html.haml</strong></p>\n<pre><code>:css\n  .div {\n    color: &lt;%=@mycolor%&gt;;\n    ...\n  }\n</code></pre>\n<p><strong>/layout/home.html.erb</strong>  ( If you have erb template)</p>\n<pre><code>&lt;style type=&quot;text/css&quot;&gt;  \n.div {\n   color: &lt;%=@mycolor%&gt;;\n   ...\n} \n&lt;/style&gt; \n</code></pre>\n"}], "owner": {"reputation": 162, "user_id": 8397782, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-WLDKa6wvBgE/AAAAAAAAAAI/AAAAAAAAA9s/kGyIlC3iKyw/photo.jpg?sz=128", "display_name": "Ronak Bhatt", "link": "https://stackoverflow.com/users/8397782/ronak-bhatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511252868, "creation_date": 1511244267, "last_edit_date": 1511252868, "question_id": 47406247, "link": "https://stackoverflow.com/questions/47406247/how-to-access-rails-instance-variabletheme-in-custom-css-erb", "title": "how to access rails instance variable(@theme) in custom.css.erb?", "body": "<p>I have Theme Model and I have 3 Field</p>\n\n<p>1) navbar\n2) header\n3) contain</p>\n\n<p>I want to access instance Variable (@theme) from custom.css.erb so how I can I access params.</p>\n\n<p><strong>Controller.rb</strong></p>\n\n<pre><code>def show\n @params = params[:name].downcase\n @cmp = Company.find_by(name: @params)\n @theme = Theme.find_by(company_id:  @cmp.id)\nend\n</code></pre>\n\n<p><strong>custom.css.erb</strong>    </p>\n\n<pre><code>&lt;% if @theme.present? %&gt;\n.navbar.navbar-inverse {\n    background-color: &lt;%= @theme.navbar %&gt; !important;\n}\n.page-header {\n    background-color: &lt;%= @theme.header %&gt; !important;\n}\n.panel.panel-flat {\n    background-color: &lt;%= @theme.contain %&gt; !important;\n}\n.panel-heading {\n    background-color: &lt;%= @theme.contain %&gt; !important;\n}\n&lt;% else %&gt;\n.navbar.navbar-inverse {\n    background-color: #37474F !important;\n}\n.page-header {\n    background-color: #ffffff !important;\n}\n.panel.panel-flat {\n    background-color: #ffffff !important;\n}\n.panel-heading {\n    background-color: #ffffff !important;\n  }      \n</code></pre>\n\n\n\n<p>I got Error Like Below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yY41t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yY41t.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["jquery", "html", "ruby-on-rails", "ruby", "twitter-bootstrap"], "answers": [{"tags": [], "owner": {"reputation": 6370, "user_id": 2279018, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/JI5Hp.jpg?s=128&g=1", "display_name": "SSR", "link": "https://stackoverflow.com/users/2279018/ssr"}, "is_accepted": false, "score": 1, "last_activity_date": 1511244118, "creation_date": 1511244118, "answer_id": 47406214, "question_id": 47406135, "link": "https://stackoverflow.com/questions/47406135/disabling-a-bootstrap-table-row-on-click-and-have-it-save-in-ruby-on-rails/47406214#47406214", "title": "Disabling a Bootstrap table row on click and have it save in Ruby on Rails", "body": "<p>You don't need to maintain separate table for this.</p>\n\n<p><a href=\"https://github.com/rubysherpas/paranoia\" rel=\"nofollow noreferrer\">https://github.com/rubysherpas/paranoia</a></p>\n\n<p>Take a look at this Gem. The thing you want is Soft Delete. By adding deleted_at in respective table. Use ajax based deletion so you would be able to show row as archived by Grey Out the entire row.</p>\n\n<pre><code>&lt;% @clients.each do |client| %&gt;\n    &lt;tr class=\"table-row\" id=\"client_&lt;%= client.id %&gt;\"&gt;\n      &lt;td&gt;&lt;%= client.first_name %&gt; &lt;%= client.last_name %&gt;&lt;/td&gt;\n      &lt;td class=\"table-options\"&gt;\n        &lt;%= link_to edit_client_path(client) do %&gt;\n          &lt;i class=\"ion-edit\"&gt;&lt;/i&gt;\n        &lt;% end %&gt;\n        &lt;button class=\"archive\"&gt;\n          &lt;i class=\"ion-ios-box\"&gt;&lt;/i&gt;\n        &lt;/button&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>You can assign a unique id to your row. Then use the js.erb to use the AJAX functionality.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511282925, "post_id": 47417798, "comment_id": 81790724, "body": "I had a mini epiphany and thought about doing this right after posting this question lol. I&#39;m gonna give this a shot!"}, {"owner": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511418504, "post_id": 47417798, "comment_id": 81852741, "body": "when you say &quot;Now you could use your ajax link and process&quot;, how could I do this? I&#39;m not the most familiar with ajax."}, {"owner": {"reputation": 361, "user_id": 6665764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wh8CZ.jpg?s=128&g=1", "display_name": "inveterateliterate", "link": "https://stackoverflow.com/users/6665764/inveterateliterate"}, "reply_to_user": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511419284, "post_id": 47417798, "comment_id": 81853123, "body": "Ah, sorry about that, when I was reading this post I thought you mentioned using Ajax but i see that was something the other answer mentioned. To be clear, you don\u2019t need Ajax to do this, you can do it the standard way of updating your model and calling the redirect which reloads the page. Ajax is for when you want the process to be asynchronous, in an instance like this, giving the appearance that a field is archived without showing the reload."}, {"owner": {"reputation": 361, "user_id": 6665764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wh8CZ.jpg?s=128&g=1", "display_name": "inveterateliterate", "link": "https://stackoverflow.com/users/6665764/inveterateliterate"}, "reply_to_user": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511419335, "post_id": 47417798, "comment_id": 81853145, "body": "Kind of long for a comment to provide an example, but I recommend this example for an intro: <a href=\"https://richonrails.com/articles/basic-ajax-in-ruby-on-rails\" rel=\"nofollow noreferrer\">richonrails.com/articles/basic-ajax-in-ruby-on-rails</a>"}, {"owner": {"reputation": 361, "user_id": 6665764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wh8CZ.jpg?s=128&g=1", "display_name": "inveterateliterate", "link": "https://stackoverflow.com/users/6665764/inveterateliterate"}, "reply_to_user": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511419374, "post_id": 47417798, "comment_id": 81853159, "body": "I would also check out other stack overflow posts on using Ajax to \u201ctoggle\u201dcharacteristics on rails pages"}, {"owner": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511424318, "post_id": 47417798, "comment_id": 81855464, "body": "Ok! I got it to change the column from true to false, but it&#39;s having a tough time with adding the archived class. It&#39;s saying archived is an undefined variable."}, {"owner": {"reputation": 361, "user_id": 6665764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wh8CZ.jpg?s=128&g=1", "display_name": "inveterateliterate", "link": "https://stackoverflow.com/users/6665764/inveterateliterate"}, "reply_to_user": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511457171, "post_id": 47417798, "comment_id": 81875763, "body": "Updated my answer - your class name should be in quotes so it evaluates to a string. Sorry about that!"}, {"owner": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "edited": false, "score": 0, "creation_date": 1511461519, "post_id": 47417798, "comment_id": 81877762, "body": "Ah no worries! I should&#39;ve known. Thanks a bunch!"}], "tags": [], "owner": {"reputation": 361, "user_id": 6665764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wh8CZ.jpg?s=128&g=1", "display_name": "inveterateliterate", "link": "https://stackoverflow.com/users/6665764/inveterateliterate"}, "is_accepted": true, "score": 0, "last_activity_date": 1511457117, "last_edit_date": 1511457117, "creation_date": 1511281136, "answer_id": 47417798, "question_id": 47406135, "link": "https://stackoverflow.com/questions/47406135/disabling-a-bootstrap-table-row-on-click-and-have-it-save-in-ruby-on-rails/47417798#47417798", "title": "Disabling a Bootstrap table row on click and have it save in Ruby on Rails", "body": "<p>Paranoia is a nice gem, but one caveat is that it overrides ActiveRecord's <code>destroy</code> method (<a href=\"https://github.com/rubysherpas/paranoia/blob/92505787662e0415f228a3507a885ba771058ff1/lib/paranoia.rb#L72\" rel=\"nofollow noreferrer\">https://github.com/rubysherpas/paranoia/blob/92505787662e0415f228a3507a885ba771058ff1/lib/paranoia.rb#L72</a>).</p>\n\n<p>If you are comfortable with that, paranoia is a perfectly fine gem. </p>\n\n<p>Another option is to roll your own strategy. Paranoia essentially just adds another column to your model to fill in when you call destroy. Alternatively, you could add your own column, perhaps something like <code>archived</code>, and make it a boolean value (or you could use <code>archived_at</code> with a timestamp, like the gem). I like to use affirmatives in my models, so I might call the column <code>active</code>, which defaults to <code>true</code> when a new record is created, and is changed to <code>false</code> when I would like to archive a record.</p>\n\n<p>Now you could use your ajax link and process attached to your table to send a message back to the controller to update that new column when a user wants to archive a record. Finally, you would add logic in your table to display or hide (or gray out if you prefer) records based on this new column, either in the table, or by creating a scope on the class and sending only the scoped collection to the view:</p>\n\n<p><strong>app/models/client.rb</strong></p>\n\n<pre><code>class Client\n\n  scope :active, -&gt; { where(active: true) }\n  scope :archived, -&gt; { where(active: false) }\n\n  ...\nend\n</code></pre>\n\n<p><strong>app/controllers/clients_controller.rb</strong></p>\n\n<pre><code>class ClientsController\n\n  def index\n    @clients = Client.active\n  end\n  ...\nend\n</code></pre>\n\n<p>If you want to display all the records but just gray out the row you could add a conditional class to the table row:</p>\n\n<pre><code>&lt;tr class=\"table-row &lt;%= \u2018archived\u2019 unless client.active? %&gt;\"&gt;\n</code></pre>\n\n<p>Where you would style your class \"archived\" as you please. There are several ways to accomplish this part, this is just one example.</p>\n"}], "owner": {"reputation": 3, "user_id": 6679857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8CYSk.jpg?s=128&g=1", "display_name": "Kenan Philips", "link": "https://stackoverflow.com/users/6679857/kenan-philips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 47417798, "answer_count": 2, "score": 0, "last_activity_date": 1511457117, "creation_date": 1511243776, "question_id": 47406135, "link": "https://stackoverflow.com/questions/47406135/disabling-a-bootstrap-table-row-on-click-and-have-it-save-in-ruby-on-rails", "title": "Disabling a Bootstrap table row on click and have it save in Ruby on Rails", "body": "<p>I have a table that will be populated with user information based on a form they fill out. One thing I'm wanting to do is have the admin be able to \"archive\" a table row once they're done with that user.</p>\n\n<p>The two ways I've thought I could do this is either grey out the specific table row when the archive button on that row is clicked, OR have that row move down to a different table, one specifically used for archived users.</p>\n\n<p>I don't want the user's info to be deleted, just archived in case the admin needs it again</p>\n\n<p>The biggest thing here is mainly to have it save.</p>\n\n<p>Here is my current table from my index.html.erb file:</p>\n\n<pre><code>&lt;table id=\"table-current\" width=\"100%\" data-toggle=\"table\" class=\"table\"&gt;\n  &lt;h3&gt;Current Submissions&lt;/h3&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th data-sortable=\"true\"&gt;Name&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Email&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Phone Number&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Pick Up Address&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;City&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Pick Up Date&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Pick Up Time&lt;/th&gt;\n      &lt;th data-sortable=\"true\"&gt;Instructions&lt;/th&gt;\n      &lt;th data-sortable=\"false\"&gt;Options&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;% @clients.each do |client| %&gt;\n      &lt;tr class=\"table-row\"&gt;\n        &lt;td&gt;&lt;%= client.first_name %&gt; &lt;%= client.last_name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"mailto:&lt;%= client.email %&gt;\"&gt;&lt;%= client.email %&gt;&lt;/a&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"tel:&lt;%= client.phone_number %&gt;\"&gt;&lt;%= number_to_phone(client.phone_number) %&gt;&lt;/a&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"https://maps.google.com/?q=&lt;%= client.pick_up_location %&gt;&amp;t=m\" target=\"_blank\"&gt;&lt;%= client.pick_up_location %&gt;&lt;/a&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= client.city %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= client.pick_up_date %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= client.pick_up_time.strftime(\"%l:%M %p\") %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= client.instructions %&gt;&lt;/td&gt;\n        &lt;td class=\"table-options\"&gt;\n          &lt;%= link_to edit_client_path(client) do %&gt;\n            &lt;i class=\"ion-edit\"&gt;&lt;/i&gt;\n          &lt;% end %&gt;\n          &lt;button class=\"archive\"&gt;\n            &lt;i class=\"ion-ios-box\"&gt;&lt;/i&gt;\n          &lt;/button&gt;\n        &lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Any help is appreciated! Thank you!</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511253728, "post_id": 47405237, "comment_id": 81770534, "body": "BTW, the experts for &quot;code that works but could be more readable and/or faster&quot; are over at <a href=\"https://codereview.stackexchange.com\">Code Review</a>. Should you decide that your question finds a better home there, please make sure to read the help center, on-topic and off-topic pages, the FAQ and if unsure ask on their meta page or in chat, just like you would on any other site. (In other words: don&#39;t take my word for it.) They have some specific rules about what code can be posted and how. (For example, <a href=\"https://stackoverflow.com\">Stack Overflow</a> prefers that you condense your production code down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, whereas <a href=\"https://codereview.stackexchange.com\">Code Review</a> prefers the <i>real</i> code in context.)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1511253775, "post_id": 47405237, "comment_id": 81770562, "body": "Also, should you decide to do this, don&#39;t cross-post, rather delete this question, or even better, ask a moderator to migrate it."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1511239647, "creation_date": 1511239647, "answer_id": 47405407, "question_id": 47405237, "link": "https://stackoverflow.com/questions/47405237/how-can-i-refactor-this-ruby-method-to-run-faster/47405407#47405407", "title": "How can I refactor this Ruby method to run faster?", "body": "<p>If you are looking for super performance, ruby is probably not a best language of choice. If you are looking for a readability, here you go:</p>\n\n<pre><code>[1,2,3,2,4,5,1].\n  map.               # or each (less readable, probably faster) \n  with_index.\n  group_by(&amp;:shift). # or group_by(&amp;:first)\n  min_by { |v, a| a[1] &amp;&amp; a[1].last || Float::INFINITY }.\n  first\n#\u21d2 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1511242308, "creation_date": 1511242308, "answer_id": 47405864, "question_id": 47405237, "link": "https://stackoverflow.com/questions/47405237/how-can-i-refactor-this-ruby-method-to-run-faster/47405864#47405864", "title": "How can I refactor this Ruby method to run faster?", "body": "<p>You could count the entries as you go and use <code>Enumerable#find</code> to stop iterating as soon as you find something again:</p>\n\n<pre><code>h = { }\na.find do |e|\n  h[e] = h[e].to_i + 1 # The `to_i` converts `nil` to zero without a bunch of noise.\n  h[e] == 2\nend\n</code></pre>\n\n<p>You could also say:</p>\n\n<pre><code>h = Hash.new(0) # to auto-vivify with zeros\na.find do |e|\n  h[e] += 1\n  h[e] == 2\nend\n</code></pre>\n\n<p>or use <code>Hash#fetch</code> with a default value:</p>\n\n<pre><code>h = { }\na.find do |e|\n  h[e] = h.fetch(e, 0) + 1\n  h[e] == 2\nend\n</code></pre>\n\n<p><code>find</code> will stop as soon as it finds an element that makes that block <code>true</code> so this should be reasonably efficient.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1511248987, "last_edit_date": 1511248987, "creation_date": 1511245567, "answer_id": 47406534, "question_id": 47405237, "link": "https://stackoverflow.com/questions/47405237/how-can-i-refactor-this-ruby-method-to-run-faster/47406534#47406534", "title": "How can I refactor this Ruby method to run faster?", "body": "<p>Here are two ways that could be done quite simply.</p>\n\n<p><strong>Use a set</strong></p>\n\n<pre><code>require 'set'\n\ndef first_dup(arr)\n  st = Set.new\n  arr.find { |e| st.add?(e).nil? }\nend\n\nfirst_dup [1,2,3,2,4,5,4,1,4]\n  #=&gt; 2\nfirst_dup [1,2,3,4,5]\n  #=&gt; nil\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.4.0/libdoc/set/rdoc/Set.html#method-i-add-3F\" rel=\"nofollow noreferrer\">Set#add?</a>.</p>\n\n<p><strong>Use <code>Array#difference</code></strong></p>\n\n<pre><code>def first_dup(arr)\n  arr.difference(arr.uniq).first\nend\n\nfirst_dup [1,2,3,2,4,5,4,1,4]\n  #=&gt; 2\nfirst_dup [1,2,3,4,5]\n  #=&gt; nil\n</code></pre>\n\n<p>I have found <code>Array#difference</code> to be sufficiently useful that I <a href=\"https://bugs.ruby-lang.org/issues/11815\" rel=\"nofollow noreferrer\">proposed it be added to the Ruby core</a> (but it doesn't seem to be gaining traction). It is as follows:</p>\n\n<pre><code>class Array\n  def difference(other)\n    h = other.each_with_object(Hash.new(0)) { |e,h| h[e] += 1 }\n    reject { |e| h[e] &gt; 0 &amp;&amp; h[e] -= 1 }\n  end\nend\n</code></pre>\n\n<p>As explained at the link, it differs from <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-i-2D\" rel=\"nofollow noreferrer\">Array#-</a> as follows:</p>\n\n<pre><code>a = [1,2,2,3,3,2,2]\nb = [2,2,3]\n\na - b\n  #=&gt; [1]\na.difference(b)\n  #=&gt; [1,3,2,2]\n</code></pre>\n\n<p>That is, <code>difference</code> \"removes\" one <code>2</code>in <code>a</code> for each <code>2</code> in <code>b</code> (similar for <code>3</code>), preserving the order of what's left of <code>a</code>. <code>a</code> is not mutated, however.</p>\n\n<p>The steps in the example given above for the present problem are as follows.</p>\n\n<pre><code>arr = [1,2,3,2,4,5,4,1,4]\na = arr.uniq\n  #=&gt; [1,2,3,4,5]\nb = arr.difference(a)\n  #=&gt; [2, 4, 1, 4]\nb.first\n  #=&gt; 2\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8852859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090de9d9f0ff0f9298c87c83990f595b?s=128&d=identicon&r=PG&f=1", "display_name": "sds0208", "link": "https://stackoverflow.com/users/8852859/sds0208"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47405864, "answer_count": 3, "score": 1, "last_activity_date": 1511248987, "creation_date": 1511238798, "last_edit_date": 1511242332, "question_id": 47405237, "link": "https://stackoverflow.com/questions/47405237/how-can-i-refactor-this-ruby-method-to-run-faster", "title": "How can I refactor this Ruby method to run faster?", "body": "<p>The method below is supposed to take an array <code>a</code> and return the duplicated integer whose second index value is the lowest. The array will only include integers between 1 and <code>a.length</code>. With this example,</p>\n\n<pre><code>firstDuplicate([1,2,3,2,4,5,1])\n</code></pre>\n\n<p>the method returns <code>2</code>.</p>\n\n<pre><code>def firstDuplicate(a)\n    num = 1\n    big_num_array = []\n    a.length.times do\n        num_array = []\n        if a.include?(num)\n            num_array.push(a.index(num))\n            a[a.index(num)] = \"x\"\n            if a.include?(num)\n                num_array.unshift(a.index(num))\n                num_array.push(num)\n            end\n            big_num_array.push(num_array) if num_array.length == 3\n         end        \n         num += 1   \n     end\n     if big_num_array.length &gt; 0\n         big_num_array.sort![0][2]\n     else\n         -1\n     end  \nend\n</code></pre>\n\n<p>The code works, but seems longer than necessary and doesn't run fast enough. I am looking for ways to refactor this.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1511264027, "post_id": 47405121, "comment_id": 81777387, "body": "<code>(1..5).each {}</code> passes a block to the method, although there&#39;s nothing between <code>{</code> and <code>}</code>."}], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": true, "score": 3, "last_activity_date": 1511238555, "creation_date": 1511238555, "answer_id": 47405194, "question_id": 47405121, "link": "https://stackoverflow.com/questions/47405121/having-trouble-distinguishing-where-the-block-is-if-this-function-has-a-block/47405194#47405194", "title": "Having trouble distinguishing where the block is/if this function has a block", "body": "<p>You are playing with words. It is a matter of definition. Usually, the block includes the <code>do</code> and <code>end</code>. The whole:</p>\n\n<pre><code>do |i|\n  puts 2 ** i\nend\n</code></pre>\n\n<p>is the block. But since a block is not an object in Ruby (unlike proc), it does not make much difference whichever you call a block.</p>\n"}], "owner": {"reputation": 61, "user_id": 8222495, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3b646c21c59f66992bddb104ba1240b7?s=128&d=identicon&r=PG&f=1", "display_name": "Cody Speroff", "link": "https://stackoverflow.com/users/8222495/cody-speroff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 47405194, "answer_count": 1, "score": 0, "last_activity_date": 1511238602, "creation_date": 1511238041, "last_edit_date": 1511238602, "question_id": 47405121, "link": "https://stackoverflow.com/questions/47405121/having-trouble-distinguishing-where-the-block-is-if-this-function-has-a-block", "title": "Having trouble distinguishing where the block is/if this function has a block", "body": "<p>I am under the impression that when you write a function, the block is what goes in between <code>do</code> and <code>end</code>. </p>\n\n<pre><code>(1..5).each do |i|\n  puts 2 ** i\nend\n</code></pre>\n\n<p>So in the function above, would the block part consist of the following? </p>\n\n<pre><code>|i| puts 2 ** i\n</code></pre>\n"}, {"tags": ["ruby", "ubuntu", "nginx", "sinatra", "passenger"], "comments": [{"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 1, "creation_date": 1511236306, "post_id": 47404812, "comment_id": 81763437, "body": "What session store are you using? The default cookie sessions should work ok here, but if you are using <code>Rack::Session::Pool</code> then each process will have it\u2019s own set of sessions, which will result in you losing sessions like you describe."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 3808852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7915398ccf473b2c3bab1beec2649c58?s=128&d=identicon&r=PG&f=1", "display_name": "user3808852", "link": "https://stackoverflow.com/users/3808852/user3808852"}, "is_accepted": false, "score": 0, "last_activity_date": 1511595164, "creation_date": 1511595164, "answer_id": 47483633, "question_id": 47404812, "link": "https://stackoverflow.com/questions/47404812/session-gets-lost-randomly-on-ruby-app-with-passenger-nginx-setup/47483633#47483633", "title": "Session gets lost randomly on ruby app with passenger + nginx setup", "body": "<p>You'll want to make sure you specify a session secret, otherwise one will be auto generated every time the process starts, wiping out any existing sessions.</p>\n\n<p>Eg:</p>\n\n<pre><code>use Rack::Session::Cookie, :key =&gt; 'rack.session', :path =&gt; '/', :secret =&gt; 'yoursessionsecretgoeshere'\n</code></pre>\n\n<p>edit: You aren't having the problem with a pool size of 1 because you only have one process running.  If you restart that process you'll probably see the sessions drop if you don't have a secret set.</p>\n"}], "owner": {"reputation": 171, "user_id": 2460764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472d1d1509eb1fe67086184539330670?s=128&d=identicon&r=PG", "display_name": "Shyam Jos", "link": "https://stackoverflow.com/users/2460764/shyam-jos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511595164, "creation_date": 1511235759, "last_edit_date": 1511242765, "question_id": 47404812, "link": "https://stackoverflow.com/questions/47404812/session-gets-lost-randomly-on-ruby-app-with-passenger-nginx-setup", "title": "Session gets lost randomly on ruby app with passenger + nginx setup", "body": "<p>We have a sinatra app which is running on passenger + nginx setup, Currently we are facing an issue that Session gets lost randomly. We also tried disabling smart spawning in passenger but it didn't worked.Server load and memory usage is also fine.</p>\n\n<p>But we were able to fix the issue by setting <code>passenger_max_pool_size 1;</code>in nginx configuration.</p>\n\n<p>Why this issue is happening when pool size is greater than 1 ?<br>\nWill this configuration cause any performance issue with our app since passenger cant spawn new instances ?</p>\n\n<p>nginx sites-enabled conf</p>\n\n<pre><code> server {\n     listen 8082;\n     server_name 0.0.0.0;\n     root /home/deploy/manager/current/app/public;\n     passenger_ruby /usr/local/rvm/gems/ree-1.8.7-2012.02/wrappers/ruby;\n     passenger_enabled on;\n\n}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2571, "user_id": 19308, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/357484c51a4516af57969653e3535680?s=128&d=identicon&r=PG", "display_name": "Joshua Drake", "link": "https://stackoverflow.com/users/19308/joshua-drake"}, "edited": false, "score": 1, "creation_date": 1511236315, "post_id": 47404639, "comment_id": 81763440, "body": "What code have you tried so far?  What error message(s) did you get?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511247227, "post_id": 47404639, "comment_id": 81767039, "body": "When you given an example please include only valid Ruby objects. Here that would mean no &quot;...&quot;. Also give the desired return value for your example as another valid Ruby object.  It is also helpful to assign a variable to each input object, so readers can refer to those variables in answers and comments without having to define them. Here that might be <code>arr  = [{ name: &quot;John doe&quot;, ...]</code> and <code>person = &quot;mary&quot;</code>. You would then say that you want to determine the number of values of <code>:name</code> in all the elements of <code>arr</code> that equal the value of <code>person</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511247601, "post_id": 47404639, "comment_id": 81767213, "body": "<code>{ &quot;name&quot;: &quot;cat&quot; }</code>, <code>{ name: &quot;cat&quot; }</code> and <code>{ :name=&gt;&quot;cat&quot; }</code> are all equivalent, so there is no point in using the first of these. The only time you would want to do that is when the symbol is made up of two or more words, such as ` { &quot;cat lives remaining&quot;: 4 } #=&gt; {:&quot;cat lives remaining&quot;=&gt;4}`."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511254438, "post_id": 47404639, "comment_id": 81770936, "body": "What is the code you are having trouble with? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ? Please, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511254461, "post_id": 47404639, "comment_id": 81770944, "body": "Can you provide a <i>precise</i> specification of what it is that you want to happen, including any and all rules, exceptions from those rules, corner cases, special cases, boundary cases, and edge cases? Can you provide sample inputs and outputs demonstrating what you expect to happen, both in normal cases, and in all the exceptions, corner cases, special cases, boundary cases, and edge cases?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1511254521, "post_id": 47404639, "comment_id": 81770986, "body": "&quot;I am supposed to count how many people there are with the same name.&quot; \u2013 You do it by writing a program which does that. If you have a problem with your program, carefully read the documentation of all the methods, classes, modules, and libraries you are using, write tests for your programs, trace the execution with pen and paper, single-step it in a debugger, then sleep on it, start again from the beginning, sleep on it again, and <i>then and only then</i> ask a focused, narrow question on <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "is_accepted": false, "score": 0, "last_activity_date": 1511235546, "creation_date": 1511235546, "answer_id": 47404775, "question_id": 47404639, "link": "https://stackoverflow.com/questions/47404639/counting-through-an-array-of-hashes/47404775#47404775", "title": "Counting through an array of hashes", "body": "<p>You can do it like this:</p>\n\n<pre><code>  name_count = Hash.new(0) # default count of same name: 0\n  users = [\n     {\"name\": \"John doe\",\"job\": \"construction\"}, \n     {\"name\": \"mary\",\"job\": \"cook\"}\n  ]\n  users.each do |user|\n    name_count[user[:name]] += 1\n  end\n  puts name_count\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8976459, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_idsYhp3GN8/AAAAAAAAAAI/AAAAAAAAAoA/rIm0l_l06dI/photo.jpg?sz=128", "display_name": "marco alvarez", "link": "https://stackoverflow.com/users/8976459/marco-alvarez"}, "edited": false, "score": 0, "creation_date": 1511239501, "post_id": 47405095, "comment_id": 81764178, "body": "this is what did it, thank you so much!!!!!!!!!!! your help means the world to a newbie like me"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511248334, "post_id": 47405095, "comment_id": 81767592, "body": "I believe you mean <code>user[:name] =~...</code>. I wasn&#39;t aware that  <code>nil =~ regex  #=&gt; nil</code> (because <code>nil.method(:=~).owner #=&gt; Kernel</code>)."}, {"owner": {"reputation": 10647, "user_id": 64669, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Vg5iU.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/64669/aaron"}, "reply_to_user": {"reputation": 1, "user_id": 8976459, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_idsYhp3GN8/AAAAAAAAAAI/AAAAAAAAAoA/rIm0l_l06dI/photo.jpg?sz=128", "display_name": "marco alvarez", "link": "https://stackoverflow.com/users/8976459/marco-alvarez"}, "edited": false, "score": 0, "creation_date": 1511291089, "post_id": 47405095, "comment_id": 81795708, "body": "@marcoalvarez Glad it helped. Ruby is a great language not only to learn how to program but to use everyday. I&#39;d highly recommend Sandi Metz&#39;s book Practical Object-Oriented Design in Ruby to go from newbie to novice in 1.0 books."}, {"owner": {"reputation": 10647, "user_id": 64669, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Vg5iU.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/64669/aaron"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511291311, "post_id": 47405095, "comment_id": 81795842, "body": "@CarySwoveland In Marco&#39;s example it looks the keys are strings and since I can&#39;t guarantee a <code>HashWithIndifferentAccess</code> I decided to use the syntax that would be sure to succeed.  I also love it when Ruby <i>just works</i>. It&#39;s such a great language for developers because it&#39;s so simple to write if you put the effort in and yet so powerful in what you can do with it. <code>Kernel</code> and <code>Object</code> are worth checking out for anyone reading this as you&#39;ll get such a great idea of what you can expect in Ruby."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1511293908, "post_id": 47405095, "comment_id": 81797425, "body": "With <code>users</code> defined as the OP has (without <code>...</code>), <code>users  #=&gt; [{:name=&gt;&quot;John doe&quot;, :job=&gt;&quot;construction&quot;}, {:name=&gt;&quot;mary&quot;, :job=&gt;&quot;cook&quot;}]</code> shows the keys are symbols. <code>users.count { |user| user[&#39;name&#39;] =~ &#47;mary&#47;i } #=&gt; 0</code>, whereas <code>users.count { |user| user[:name] =~ &#47;mary&#47;i } #=&gt; 1</code>. Notice this is a pure-Ruby question, so Rails&#39; <code>Class Object::HashWithIndifferentAccess &lt; Hash</code> doesn&#39;t apply"}], "tags": [], "owner": {"reputation": 10647, "user_id": 64669, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Vg5iU.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/64669/aaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1511237886, "creation_date": 1511237886, "answer_id": 47405095, "question_id": 47404639, "link": "https://stackoverflow.com/questions/47404639/counting-through-an-array-of-hashes/47405095#47405095", "title": "Counting through an array of hashes", "body": "<p>Depending on how specific your match has to be the following would do a case insensitive match on the \"Mary\"s assuming <code>users</code> contains the array in your question.</p>\n\n<pre><code>users.count { |user| user['name'] =~ /mary/i }\n</code></pre>\n\n<p>See the documentation for <a href=\"https://ruby-doc.org/core-2.4.2/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\">Enumerable#count</a>. The third form will take a block that will result in the number of items for which the block returns true.</p>\n\n<p>In my example, we're accessing the <code>'name'</code> key of each hash and comparing it to a case insensitive match against the regular expression <code>/mary/</code>. <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-3D-7E\" rel=\"nofollow noreferrer\">The <code>=~</code> operator</a> returns the integer value of the first match (a truthy value) or <code>nil</code> if it does not match which is a falsey value.</p>\n\n<p>Hopefully this answers your question and the components of the answer with documentation.</p>\n"}], "owner": {"reputation": 1, "user_id": 8976459, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_idsYhp3GN8/AAAAAAAAAAI/AAAAAAAAAoA/rIm0l_l06dI/photo.jpg?sz=128", "display_name": "marco alvarez", "link": "https://stackoverflow.com/users/8976459/marco-alvarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 47405095, "answer_count": 2, "score": -2, "last_activity_date": 1511252153, "creation_date": 1511234471, "last_edit_date": 1511252153, "question_id": 47404639, "link": "https://stackoverflow.com/questions/47404639/counting-through-an-array-of-hashes", "title": "Counting through an array of hashes", "body": "<p>I have this array of hashes:</p>\n\n<pre><code>[\n  {\"name\": \"John doe\",\"job\": \"construction\"}, \n  {\"name\": \"mary\",\"job\": \"cook\"}\n  ...\n]\n</code></pre>\n\n<p>I am supposed to count how many people there are with the same name. If there are five <code>\"mary\"</code>s, I should have <code>5</code>.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1511238198, "post_id": 47404599, "comment_id": 81763859, "body": "i think i can help you, but can you say exactly what the result should be? The <code>each</code> iterator, by the way, works differently on hashes when the block is given one argument (in which case it becomes a <code>[&lt;key&gt;, &lt;val&gt;]</code> array or two arguments (in which case they are set to key and val respectively)"}, {"owner": {"reputation": 43, "user_id": 6938318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883385f71922344dc57cb04313b0af5c?s=128&d=identicon&r=PG&f=1", "display_name": "Shwtm3", "link": "https://stackoverflow.com/users/6938318/shwtm3"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1511239117, "post_id": 47404599, "comment_id": 81764066, "body": "Thanks, yes, I&#39;m looking to be able to dynamically access the elements like so: Hash[Key][data:][text:] and have the text portion returned: &quot;Moeslein Nate&quot; Hash[Key][data:][dataImg:] should return &quot;/vinD.jpg&quot;  I&#39;d like to get at the values nested under data: but using logic as so I can get them using the key to ensure my key values match accordingly!"}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 1, "creation_date": 1511247399, "post_id": 47404599, "comment_id": 81767114, "body": "based on your ruby version, or adding <code>activesupport</code> as dependency you can use <code>transform_keys!</code>. thus you can normalize all your keys to be in same type (e.g. symbol)"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1511288780, "post_id": 47404599, "comment_id": 81794422, "body": "Thank you @marmeladze, that&#39;s one I was not aware of!"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 1, "creation_date": 1511289297, "post_id": 47404599, "comment_id": 81794710, "body": "@marmeladze you just caused me to look up the docs and there is also a public method <code>deep_symbolize_keys!</code> that will do it recursively. It also has &#39;<code>deep_stringify_keys!</code> to do the opposite. Very useful!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6938318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883385f71922344dc57cb04313b0af5c?s=128&d=identicon&r=PG&f=1", "display_name": "Shwtm3", "link": "https://stackoverflow.com/users/6938318/shwtm3"}, "edited": false, "score": 0, "creation_date": 1511370260, "post_id": 47406256, "comment_id": 81835379, "body": "Thanks a ton man, this solved it for me! Appreciate the detail! I was also able to pull off a sort using the following: <code>mySortedHash = myJobsHash.sort_by { |k,v| &quot;#{v[&#39;monthTotals&#39;]}&quot;}.reverse</code>  Cheers!"}], "tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": true, "score": 1, "last_activity_date": 1511289787, "last_edit_date": 1511289787, "creation_date": 1511244318, "answer_id": 47406256, "question_id": 47404599, "link": "https://stackoverflow.com/questions/47404599/ruby-sinatra-hash-nested-in-array/47406256#47406256", "title": "Ruby Sinatra Hash nested in Array", "body": "<p>I think you are missing the fact that you have another layer of Hash in \"data\"</p>\n\n<p>So the correct way to access it is:</p>\n\n<pre><code>widgets[\"sales31\"][\"data\"][\"text\"]\n</code></pre>\n\n<p>thus,</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key, val|\n  puts val[\"text\"]\nend\n</code></pre>\n\n<p>since the value of <code>val</code> is:</p>\n\n<pre><code>\"data\": {\"text\":\"Moeslein Nate\",\"dataImg\":\"/vinD.jpg\",\"id\":\"sales31\",\"updatedAt\":1511232577}\n</code></pre>\n\n<p>which is a Hash itself.\nSo widgets is a hash of:</p>\n\n<pre><code>widgets == {\"sales31\":  \"data\": {\"text\": \"Moeslein Nate\", \"dataImg\": \"/vinD.jpg\", \"id\": \"sales31\", \"updatedAt\" :1511232577} }\n\nwidgets[\"sales31\"] == { \"data\": {\"text\": \"Moeslein Nate\", \"dataImg\": \"/vinD.jpg\", \"id\": \"sales31\", \"updatedAt\" :1511232577} }\n\nwidgets[\"sales31\"][\"data\"] == {\"text\": \"Moeslein Nate\", \"dataImg\": \"/vinD.jpg\", \"id\": \"sales31\", \"updatedAt\" :1511232577}\n\nwidgets[\"sales31\"][\"data\"][\"text\"] == \"Moeslein Nate\"\n</code></pre>\n\n<p>Basically a hash within a hash within a hash. You are not very clear on how you want your information formatted but you could do:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key, val|\n  puts \"widgets[#{key}][#{val.keys[0]}] = #{val[valkeys[0]][\"text\"]}\"   \nend\n#=&gt; \"widgets[\"sales31\"][\"data\"] = Moeslein Nate\"\n</code></pre>\n\n<p>Now that's not the prettiest way to do it but since you asked for a programmatic solution it get the job done without naming hash keys explicitly. It could be simplified to this if it works for you:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key, val|    \n  puts \"widgets[#{key}][\"data\"] = #{val[\"data\"][\"text\"]}\" \nend\n</code></pre>\n\n<p>UPDATE:\nThanks to @marmeladze comment I found the method <code>deep_symbolize_keys</code> it can be used with the <code>!</code> to modify the original if you prefer. I would do something like:</p>\n\n<pre><code>my_widgets = widgets.deep_symbolize_keys\nmy_widgets = Sinatra::Application.settings.history\nmy_widgets.each do |key, val|    \n  puts \"widgets[#{key}][:data] = #{val[:data][:text]}\" \nend\n</code></pre>\n\n<p>It just seems cleaner to me to not mix key types unless you need to. </p>\n"}], "owner": {"reputation": 43, "user_id": 6938318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883385f71922344dc57cb04313b0af5c?s=128&d=identicon&r=PG&f=1", "display_name": "Shwtm3", "link": "https://stackoverflow.com/users/6938318/shwtm3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 47406256, "answer_count": 1, "score": 0, "last_activity_date": 1511289787, "creation_date": 1511234166, "last_edit_date": 1511234632, "question_id": 47404599, "link": "https://stackoverflow.com/questions/47404599/ruby-sinatra-hash-nested-in-array", "title": "Ruby Sinatra Hash nested in Array", "body": "<p>I am a bit of ruby nooby and can't seem to grasp, what appears to be a hash nested in array?!</p>\n\n<p>if I run the following:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key, value|\n  puts key\n  puts value\nend\n</code></pre>\n\n<p>I get the following result:</p>\n\n<pre><code>sales31\ndata: {\"text\":\"Moeslein Nate\",\"dataImg\":\"/vinD.jpg\",\"id\":\"sales31\",\"updatedAt\":1511232577}\n</code></pre>\n\n<p>However; when I attempt to extract only the values using the key, I'm met with an error:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key|\n  puts key[:data]\nend\n</code></pre>\n\n<p>Met with Error\n<code>TypeError - no implicit conversion of Symbol into Integer</code></p>\n\n<p>That led me to believe it was an array with a nested hash, so I tried:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key|\n  puts key[0]\nend\n</code></pre>\n\n<p>Which just prints the keys again\n<code>sales30</code>\n<code>sales31</code></p>\n\n<p>and if I try and extract nested data:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key|\n  puts key[0][:data]\nend\n</code></pre>\n\n<p>Back to <code>Type Error</code></p>\n\n<p>and just the first letter of the key this time:</p>\n\n<pre><code>widgets = Sinatra::Application.settings.history\nwidgets.each do |key|\n  puts key[0][0]\nend\n</code></pre>\n\n<p>Could someone elaborate on the best/most feasible way for me to parse this data as so I can use the KEY to extract particular values:</p>\n\n<pre><code>widgets[sales31][text]\n</code></pre>\n\n<p>as to where it would print the actual text:</p>\n\n<pre><code>Moeslein Nate\n</code></pre>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1544716900, "post_id": 47404520, "comment_id": 94383324, "body": "Where should I add &quot;before do ...&quot; ?"}, {"owner": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "reply_to_user": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1544763878, "post_id": 47404520, "comment_id": 94398958, "body": "in your <code>spec</code> file :)"}, {"owner": {"reputation": 1443, "user_id": 4064922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-2_1oNmjkoec/AAAAAAAAAAI/AAAAAAAAAXE/OTUcRfaAZeM/photo.jpg?sz=128", "display_name": "Aboozar Rajabi", "link": "https://stackoverflow.com/users/4064922/aboozar-rajabi"}, "edited": false, "score": 0, "creation_date": 1545053722, "post_id": 47404520, "comment_id": 94480894, "body": "I got this error: <code>NameError:        uninitialized constant AuthenticateService</code>"}], "tags": [], "owner": {"reputation": 3063, "user_id": 1682038, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/90c9c92c135240a02e9bcd1c886bcae8?s=128&d=identicon&r=PG", "display_name": "rony36", "link": "https://stackoverflow.com/users/1682038/rony36"}, "is_accepted": true, "score": 1, "last_activity_date": 1511233484, "creation_date": 1511233484, "answer_id": 47404520, "question_id": 47403822, "link": "https://stackoverflow.com/questions/47403822/stuck-with-faraday-in-rspec/47404520#47404520", "title": "Stuck with Faraday in rspec", "body": "<p>It's actually trying to call a outsider request.\nIn you case there are two solutions:</p>\n\n<h2>Mock what is calling outside:</h2>\n\n<pre><code>before do\n  allow_any_instance_of(AuthenticateService).to receive(:execute).and_return(access_token: 'some token')\nend\n</code></pre>\n\n<h2>Record a real call (I like it :))</h2>\n\n<blockquote>\n  <p>You can try a gem <a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\">vcr</a>. It records your external request into a <code>cassette</code> and on spec run it plays back.</p>\n</blockquote>\n\n<p>Cheers!</p>\n"}, {"tags": [], "owner": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "is_accepted": false, "score": 0, "last_activity_date": 1511233914, "last_edit_date": 1511233914, "creation_date": 1511233507, "answer_id": 47404525, "question_id": 47403822, "link": "https://stackoverflow.com/questions/47403822/stuck-with-faraday-in-rspec/47404525#47404525", "title": "Stuck with Faraday in rspec", "body": "<p>Because in test mode, you did's set the <code>url</code>,I can replay the exact error in my pry console: </p>\n\n<pre><code>&gt; conn = Faraday.new();\n&gt; conn.post '/oauth/token';\nFaraday::ConnectionFailed: Connection refused - connect(2) for nil port 80\nfrom /home/fangxing/.rvm/rubies/ruby-2.2.2/lib/ruby/2.2.0/net/http.rb:879:in `initialize'\n</code></pre>\n\n<p>I think in your project somewhere,  configured a  variable <code>url</code> for Faraday, and you did't configure it in test mode.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6620416, "user_type": "registered", "profile_image": "https://graph.facebook.com/1349081931835579/picture?type=large", "display_name": "James Hwang", "link": "https://stackoverflow.com/users/6620416/james-hwang"}, "is_accepted": false, "score": 0, "last_activity_date": 1511283811, "creation_date": 1511283811, "answer_id": 47418692, "question_id": 47403822, "link": "https://stackoverflow.com/questions/47403822/stuck-with-faraday-in-rspec/47418692#47418692", "title": "Stuck with Faraday in rspec", "body": "<p>There is also something called Webmock, which mocks the API call and returns a response that you predefined. You should look into it! </p>\n\n<p>I like it a lot better than VCR, which could be nasty when dealing with a lot of data or multiple API calls.</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 4479867, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GHSihrH3XIY/AAAAAAAAAAI/AAAAAAAAAdM/fRqyZXDrXCs/photo.jpg?sz=128", "display_name": "Vitya Ivliiev", "link": "https://stackoverflow.com/users/4479867/vitya-ivliiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1595321393, "creation_date": 1595321393, "answer_id": 63010838, "question_id": 47403822, "link": "https://stackoverflow.com/questions/47403822/stuck-with-faraday-in-rspec/63010838#63010838", "title": "Stuck with Faraday in rspec", "body": "<p>My solution to a similar problem:</p>\n<pre><code>stub_request(method, url).with(\n  headers: { 'Authorization' =&gt; /Basic */ }\n).to_return(\n  status: status, body: 'stubbed response', headers: {}\n)\n</code></pre>\n<p>you can tighten verification by replacing:</p>\n<pre><code>/Basic */ -&gt; &quot;Basic #{your_token}&quot;\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 8179934, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-omoLmVbjqoY/AAAAAAAAAAI/AAAAAAAAAAs/8AiO17vneHg/photo.jpg?sz=128", "display_name": "Ian Tran", "link": "https://stackoverflow.com/users/8179934/ian-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 47404520, "answer_count": 4, "score": 0, "last_activity_date": 1595321393, "creation_date": 1511227944, "question_id": 47403822, "link": "https://stackoverflow.com/questions/47403822/stuck-with-faraday-in-rspec", "title": "Stuck with Faraday in rspec", "body": "<p>I'm trying to write a test calling an API using Faraday with RSpec. The calling is in the .execute method and it works normally in production, but in test, I'm stuck with this error: </p>\n\n<pre><code>Failure/Error: @response ||= conn.post '/oauth/token', @params\n\n     Faraday::ConnectionFailed:\n       Failed to open TCP connection to :80 (Connection refused - connect(2) for nil port 80)\n</code></pre>\n\n<p>And the test is like this</p>\n\n<pre><code>it 'access_token should not be nil' do\n      @auth = AuthenticateService.new(params)\n      auth_exec = @auth.execute\n      access_token = auth_exec[:access_token]\n      expect(access_token.present?).not_to be_empty\n    end\n</code></pre>\n\n<p>Do I need to configure something to make Faraday works with test?</p>\n"}, {"tags": ["ruby", "class", "rspec", "sequel"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1511233165, "post_id": 47403570, "comment_id": 81762685, "body": "When you say &quot;the data is coming from the database and its not predictable&quot;, what do you mean? How is the test environment&#39;s database getting it&#39;s data, and when, if ever, is it being wiped? Also, what have you tried? Can you show your attempt at writing an rspec test, even if it fails?"}, {"owner": {"reputation": 3, "user_id": 2593522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb8feb2fb20a1d36c16b86dbd208b3a3?s=128&d=identicon&r=PG", "display_name": "jneusteter", "link": "https://stackoverflow.com/users/2593522/jneusteter"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1511267185, "post_id": 47403570, "comment_id": 81779451, "body": "I am beginning to see my problem here. This project I am working on is a hobby/learning one. So I have no test database setup. Or my test database is the only database. Which is full of data."}], "owner": {"reputation": 3, "user_id": 2593522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb8feb2fb20a1d36c16b86dbd208b3a3?s=128&d=identicon&r=PG", "display_name": "jneusteter", "link": "https://stackoverflow.com/users/2593522/jneusteter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511266971, "creation_date": 1511225822, "last_edit_date": 1511266971, "question_id": 47403570, "link": "https://stackoverflow.com/questions/47403570/testing-class-method-using-sequel-and-rspec", "title": "Testing class method using Sequel and Rspec", "body": "<p>How do I test the .total method using rspec. The method adds the total of the plus_minus column where player_id is x.</p>\n\n<pre><code>class Plus_minus &lt; Sequel::Model\n def self.total(player_id)\n   self.where(player_id: player_id).sum(:plus_minus)\n end\nend\n</code></pre>\n\n<p>When I do:</p>\n\n<pre><code>puts Plus_Minus.total(10)\n</code></pre>\n\n<p>It does work, and puts out the correct value.</p>\n\n<p>The thing I am having trouble with is that the data is coming from the database and its not predictable. With an instance method I can create a predictable object to test against.</p>\n\n<p><strong>EDIT</strong>\nThis is my test. First I was trying to test it like an instance method. Then upon reading about why it was always failing, I found out class methods are tested different.</p>\n\n<pre><code>describe Plus_minus do\n  describe '.total' do\n    it \"returns 1 when plus_minus is 1 and player_id is 10\" do\n      #various ways of trying to setup the class. \n       expect(Plus_minus.total(10)).to eq(1)\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rake", "rake-task"], "comments": [{"owner": {"reputation": 3624, "user_id": 5615038, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wW8mP.jpg?s=128&g=1", "display_name": "fangxing", "link": "https://stackoverflow.com/users/5615038/fangxing"}, "edited": false, "score": 0, "creation_date": 1511226554, "post_id": 47403464, "comment_id": 81761061, "body": "You can set  <code>config.assets.quiet = true</code>, in your environments/development.rb"}], "answers": [{"comments": [{"owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "edited": false, "score": 0, "creation_date": 1511812575, "post_id": 47408080, "comment_id": 81993810, "body": "Thanks for the detailed response \u2764\ufe0f, but (as I said) I already tried <code>Rake::SprocketsTask.new</code> and it does not <i>replace</i> the existing task. IOW, just calling that constructor appears to have no effect on <code>rake assets:precompile</code>."}], "tags": [], "owner": {"reputation": 5535, "user_id": 7295772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZhWhR.jpg?s=128&g=1", "display_name": "Fabrizio Bertoglio", "link": "https://stackoverflow.com/users/7295772/fabrizio-bertoglio"}, "is_accepted": false, "score": 0, "last_activity_date": 1511254667, "last_edit_date": 1592644375, "creation_date": 1511251635, "answer_id": 47408080, "question_id": 47403464, "link": "https://stackoverflow.com/questions/47403464/how-to-set-log-level-for-the-assetsprecompile-task/47408080#47408080", "title": "How to set log_level for the assets:precompile task?", "body": "<p>some feedback, <code>logger</code> is an <code>attribute</code> of the class <code>SprocketsTask</code>.</p>\n<pre><code>require 'logger'\n\nmodule Rake\n    # Simple Sprockets compilation Rake task macro.\n    #\n    #   Rake::SprocketsTask.new do |t|\n    #     t.environment = Sprockets::Environment.new\n    #     t.output      = &quot;./public/assets&quot;\n    #     t.assets      = %w( application.js application.css )\n    #   end\n    #\n    class SprocketsTask &lt; Rake::TaskLib \n        # Logger to use during rake tasks. Defaults to using stderr.\n        #\n        #   t.logger = Logger.new($stdout)\n        #\n        attr_accessor :logger  \n</code></pre>\n<p>I did not find the info in the <a href=\"http://api.rubyonrails.org/\" rel=\"nofollow noreferrer\">api</a>, there is some good explanation in the <a href=\"http://guides.rubyonrails.org/debugging_rails_applications.html#the-logger\" rel=\"nofollow noreferrer\">Rails Guide</a> about the <a href=\"https://github.com/colbygk/log4r\" rel=\"nofollow noreferrer\">Log4r</a> logger used by rails.</p>\n<p>This is the explanation of the code you included</p>\n<blockquote>\n<p>Rails makes use of the ActiveSupport::Logger class to write log information. Other loggers, such as Log4r, may also be substituted.</p>\n<p>You can specify an alternative logger in config/application.rb or any other environment file, for example:</p>\n</blockquote>\n<pre><code>config.logger = Logger.new(STDOUT)\nconfig.logger = Log4r::Logger.new(&quot;Application Log&quot;)\n</code></pre>\n<p>That command creates a log file by default under Rails.root/log/</p>\n<p>The info you need are about <a href=\"http://guides.rubyonrails.org/debugging_rails_applications.html#log-levels\" rel=\"nofollow noreferrer\"><code>log levels</code></a></p>\n<blockquote>\n<p>When something is logged, it's printed into the corresponding log if the log level of the message is equal to or higher than the configured log level. If you want to know the current log level, you can call the <code>Rails.logger.level</code> method.</p>\n<p>The available log levels are: <code>:debug</code>, <code>:info</code>, <code>:warn</code>, <code>:error</code>, <code>:fatal</code>, and <code>:unknown</code>, corresponding to the log level numbers from 0 up to 5, respectively. To change the default log level, use</p>\n</blockquote>\n<pre><code>config.log_level = :warn # In any environment initializer, or\nRails.logger.level = 0 # at any time\n</code></pre>\n<p>This is the <code>Log4r::Logger.rb</code> class.\nIt has <code>attr_reader</code> for <code>:level</code>, which is set with the <code>def initizialize</code>.</p>\n<pre><code>module Log4r\n  \n  # See log4r/logger.rb\n  class Logger\n    attr_reader :name, :fullname, :path, :level, :parent\n    attr_reader :additive, :trace, :outputters\n\n    # Logger requires a name. The last 3 parameters are:\n    #\n    # level::     Do I have a level? (Otherwise, I'll inherit my parent's)\n    # additive::  Am I additive?\n    # trace::     Do I record the execution trace? (slows things a wee bit) \n\n    def initialize(_fullname, _level=nil, _additive=true, _trace=false)\n      # validation\n      raise ArgumentError, &quot;Logger must have a name&quot;, caller if _fullname.nil?\n      Log4rTools.validate_level(_level) unless _level.nil?\n      validate_name(_fullname)\n      \n      # create the logger\n      @fullname = _fullname\n      @outputters = []\n      @additive = _additive\n      deal_with_inheritance(_level)\n      LoggerFactory.define_methods(self)\n      self.trace = _trace\n      Repository[@fullname] = self\n    end\n</code></pre>\n<p>You can set the level by doing:</p>\n<pre><code>Log4r::Logger.new('Assets Log', :warn)\n</code></pre>\n<p>So I believe <code>t.logger.level = 2</code> should set the <code>level</code> to <code>:warn</code></p>\n<pre><code>Rake::SprocketsTask.new do |t|   \n  t.logger = Logger.new(&quot;log/assets.log&quot;) \n  t.logger.level = 2\nend\n</code></pre>\n<blockquote>\n<p><code>:debug</code>, <code>:info</code>, <code>:warn</code>, <code>:error</code>, <code>:fatal</code>, and <code>:unknown</code>, corresponding to the log level numbers from 0 up to 5, respectively.</p>\n</blockquote>\n<p>Also this works because, <code>Log4r::Logger</code> has a method <code>def level=(_level)</code> to re-set the <code>level</code> attribute.</p>\n<pre><code># Set the logger level dynamically. Does not affect children.\ndef level=(_level)\n  Log4rTools.validate_level(_level)\n  @level = _level\n  LoggerFactory.define_methods(self)\n  Logger.log_internal {&quot;Logger '#{@fullname}' set to #{LNAMES[@level]}&quot;}\n  @level\nend\n</code></pre>\n"}], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 673, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511254667, "creation_date": 1511224875, "question_id": 47403464, "link": "https://stackoverflow.com/questions/47403464/how-to-set-log-level-for-the-assetsprecompile-task", "title": "How to set log_level for the assets:precompile task?", "body": "<p>There is a method <code>Rake::SprocketsTask#log_level=</code> (defined by <code>sprockets-3.7.1/lib/rake/sprocketstask.rb</code>) but how to call it?</p>\n\n<p><a href=\"https://github.com/rails/sprockets-rails/issues/314#issuecomment-191344546\" rel=\"nofollow noreferrer\">Rafael Fran\u00e7a says</a>:</p>\n\n<blockquote>\n  <p>To change the logger you can define your own precompile tasks and\n  setting logger=</p>\n\n<pre><code>Rake::SprocketsTask.new do |t|   \n  t.logger = Logger.new(\"log/assets.log\") \nend\n</code></pre>\n</blockquote>\n\n<p>I tried that (with <code>log_level</code>) and it returns a <code>SprocketsTask</code> instance, but how do I replace the <code>assets:precompile</code> task?</p>\n\n<p>I want to set the <code>log_level</code> of the <code>assets:precompile</code> task to something quieter, like <code>:warn</code>.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1511221321, "post_id": 47402903, "comment_id": 81759620, "body": "Some variation of <a href=\"https://stackoverflow.com/questions/3018595/how-do-i-redirect-stderr-and-stdout-to-file-for-a-ruby-script\" title=\"how do i redirect stderr and stdout to file for a ruby script\">stackoverflow.com/questions/3018595/&hellip;</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 2840838, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c45dc364cff6e3f55935b9894edf92?s=128&d=identicon&r=PG&f=1", "display_name": "Lo HaBuyshan", "link": "https://stackoverflow.com/users/2840838/lo-habuyshan"}, "is_accepted": false, "score": 1, "last_activity_date": 1511221724, "creation_date": 1511221724, "answer_id": 47403033, "question_id": 47402903, "link": "https://stackoverflow.com/questions/47402903/in-ruby-how-do-i-redirect-stdin-to-a-file/47403033#47403033", "title": "In Ruby, how do I redirect STDIN to a file", "body": "<p>Ok, based on the variation link provided, I got it to work:</p>\n\n<pre><code>file = STDIN.reopen('filename')\ndo_stuff\nfile.close\n</code></pre>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 307, "user_id": 2840838, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7c45dc364cff6e3f55935b9894edf92?s=128&d=identicon&r=PG&f=1", "display_name": "Lo HaBuyshan", "link": "https://stackoverflow.com/users/2840838/lo-habuyshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511221724, "creation_date": 1511221032, "question_id": 47402903, "link": "https://stackoverflow.com/questions/47402903/in-ruby-how-do-i-redirect-stdin-to-a-file", "title": "In Ruby, how do I redirect STDIN to a file", "body": "<p>This Ruby code hangs:</p>\n\n<pre><code>file = File.open('filename')\nSTDIN = file\ndo_stuff\nfile.close\n</code></pre>\n\n<p>So in Ruby, how do I redirect STDIN to a file? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook", "devise", "omniauth-facebook"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511222617, "post_id": 47402707, "comment_id": 81760031, "body": "The way you have written this the user will never be updated if it already exists - so if you used the email of an exisisting user then <code>user.skip_confirmation!</code> is never called."}, {"owner": {"reputation": 316, "user_id": 7495784, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211983730091551/picture?type=large", "display_name": "Diego Patricio Aguilef S&#225;nchez", "link": "https://stackoverflow.com/users/7495784/diego-patricio-aguilef-s%c3%a1nchez"}, "edited": false, "score": 0, "creation_date": 1511223220, "post_id": 47402707, "comment_id": 81760197, "body": "Have you configured the email in your environment initializer ?"}, {"owner": {"reputation": 31, "user_id": 8954896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa9800834c3996f2cd1e8116d864ca6?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/8954896/diego"}, "edited": false, "score": 0, "creation_date": 1511361477, "post_id": 47402707, "comment_id": 81828979, "body": "I drop the database and creating again. It&#39;s working fine, but now don&#39;t permit me login with Facebook."}], "owner": {"reputation": 31, "user_id": 8954896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa9800834c3996f2cd1e8116d864ca6?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/8954896/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511253840, "creation_date": 1511219775, "last_edit_date": 1511253840, "question_id": 47402707, "link": "https://stackoverflow.com/questions/47402707/configuration-devise-and-omniauth-in-ruby-on-rails", "title": "Configuration Devise and omniauth in ruby on rails", "body": "<p>I have a problem with both gems, because when I try to connect to my webpage with Facebook (Sign Up or Login) tell me they send a email confirmation or I need to confirm the email confirmation. </p>\n\n<p>But the problem is that never send me a email, and other thing, if I don't want send a email when I Sign in my web across Facebook.</p>\n\n<p>I put the code.</p>\n\n<h1>app/controllers/omniauth_callbacks_controller.rb</h1>\n\n<pre><code>    class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    # You need to implement the method below in your model (e.g. app/models/user.rb)\n    @user = User.from_omniauth(request.env[\"omniauth.auth\"])\n\n    if @user.persisted?\n      sign_in_and_redirect @user, :event =&gt; :authentication #this will throw if @user is not activated\n      set_flash_message(:notice, :success, :kind =&gt; \"Facebook\") if is_navigational_format?\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\n\n  def failure\n    redirect_to root_path\n  end\nend\n</code></pre>\n\n<h1>app/models/user.rb</h1>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable,\n         :confirmable, :omniauthable, :omniauth_providers =&gt; [:facebook]\n\n  validates :fullname, presence: true, length: {maximum: 50}\n\n  has_many :rooms\n  has_many :reservations\n\n  has_many :guest_reviews, class_name: \"GuestReview\", foreign_key: \"guest_id\"\n  has_many :host_reviews, class_name: \"HostReview\", foreign_key: \"host_id\"\n\n  def self.from_omniauth(auth)\n    user = User.where(email: auth.info.email).first\n\n    if user\n      return user\n    else\n      where(provider: auth.provider, uid: auth.uid).first_or_create do |user|\n        user.email = auth.info.email\n        user.password = Devise.friendly_token[0,20]\n        user.fullname = auth.info.name\n        user.image = auth.info.image\n        user.uid = auth.uid\n        user.provider = auth.provider\n\n        # If you are using confirmable and the provider(s) you use validate emails,\n        # uncomment the line below to skip the confirmation emails.\n        user.skip_confirmation!\n      end\n    end\n  end\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "naming"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511231305, "post_id": 47402578, "comment_id": 81762246, "body": "A gem is a library as a whole, but as the directory spec suggests, there are additional things that are not core part of the library but are included in the gem. The name <code>lib</code> can be taken to mean the core part of library, or &quot;the library of the library&quot;. Nothing wrong with words like &quot;New York, NY&quot;, or &quot;top of the top&quot;."}, {"owner": {"reputation": 7897, "user_id": 1468130, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LO71w.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/1468130/jackson"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511233612, "post_id": 47402578, "comment_id": 81762804, "body": "@sawa Good point.  Can you provide a direct reference to this &quot;directory spec&quot; as evidence?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511234134, "post_id": 47402578, "comment_id": 81762910, "body": "spec is for tests. It is not used during ordinary use of the library."}, {"owner": {"reputation": 7897, "user_id": 1468130, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LO71w.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/1468130/jackson"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511237359, "post_id": 47402578, "comment_id": 81763665, "body": "Oh, I didn&#39;t mean &quot;the &#39;spec&#39; directory,&quot; I wanted to know what &quot;specification&quot; you meant when you said &quot;but as the directory spec suggests.&quot;"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511238385, "post_id": 47402578, "comment_id": 81763900, "body": "You took my sentence not as I intended. I used the expression &quot;directory spec&quot; appositively, which can indeed be paraphrased as &quot;the &#39;spec&#39; directory&quot;. So I do not understand what you mean by specification."}, {"owner": {"reputation": 7897, "user_id": 1468130, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LO71w.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/1468130/jackson"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1511278699, "post_id": 47402578, "comment_id": 81787623, "body": "I see now.  I thought you were alluding to the existence of a website like rubygems.com/the-one-and-true-specification-as-to-the-meanin&zwnj;&#8203;g-of-gem-directories which says &quot;thou shalt name the source code directory &#39;lib&#39;&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7897, "user_id": 1468130, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LO71w.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/1468130/jackson"}, "is_accepted": true, "score": 0, "last_activity_date": 1511279119, "creation_date": 1511279119, "answer_id": 47417061, "question_id": 47402578, "link": "https://stackoverflow.com/questions/47402578/what-is-the-conventional-purpose-of-the-lib-directory-in-ruby-projects/47417061#47417061", "title": "What is the conventional purpose of the &quot;lib&quot; directory in Ruby projects?", "body": "<p>The default \"require path,\" i.e. the directory which will by default be added to $LOAD_PATH when the gem is activated, is \"lib\".  See the <a href=\"http://guides.rubygems.org/specification-reference/#require_pathsval\" rel=\"nofollow noreferrer\">rubygems specification</a>:</p>\n\n<blockquote>\n  <p><code>REQUIRE_PATHS=(val)</code></p>\n  \n  <p>Paths in the gem to add to <code>$LOAD_PATH</code> when this gem is activated. If\n  you have an extension you do not need to add <code>\"ext\"</code> to the require\n  path, the extension build process will copy the extension files into\n  \u201clib\u201d for you.</p>\n  \n  <p>The default value is <code>\"lib\"</code></p>\n  \n  <p>Usage:</p>\n\n<pre><code># If all library files are in the root directory...\nspec.require_paths = ['.']\n</code></pre>\n</blockquote>\n\n<p>The fact the name is chosen as a default implies it is also a good default naming decision to avoid extra configuration and to help navigate newcomers to the gem.</p>\n"}], "owner": {"reputation": 7897, "user_id": 1468130, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/LO71w.jpg?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/1468130/jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 47417061, "answer_count": 1, "score": 1, "last_activity_date": 1511279119, "creation_date": 1511218985, "question_id": 47402578, "link": "https://stackoverflow.com/questions/47402578/what-is-the-conventional-purpose-of-the-lib-directory-in-ruby-projects", "title": "What is the conventional purpose of the &quot;lib&quot; directory in Ruby projects?", "body": "<p>Take this ruby gem: <a href=\"https://github.com/ai/autoprefixer-rails\" rel=\"nofollow noreferrer\">https://github.com/ai/autoprefixer-rails</a></p>\n\n<p>The gem's structure includes a \"lib\", \"spec\" and \"vendor\" directory, and some gemfiles in the root directory.</p>\n\n<p>What exactly is the purpose of directories called \"lib\" in ruby gems?</p>\n\n<p>It looks like \"lib\" contains all of the ruby code provided by the gem.  So does \"lib\" mean \"the source code files that constitute the library?\"  (It's hard to say if \"lib\" means \"the library,\" since arguably the gemfiles are \"part of the library,\" too.) Or does it mean something else?  And is the meaning of the directory names in ruby gems defined anywhere?  Or is directory naming completely arbitrary?</p>\n\n<p>I am trying to determine if the name \"lib\" has any special significance as I set out to write my own gem.  I'd like to know, because if it doesn't, I might like to pick a different name.</p>\n"}, {"tags": ["ruby", "wordpress", "selenium", "file-upload", "upload"], "answers": [{"tags": [], "owner": {"reputation": 367, "user_id": 7852372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ukz2Q.jpg?s=128&g=1", "display_name": "rhunal", "link": "https://stackoverflow.com/users/7852372/rhunal"}, "is_accepted": false, "score": 0, "last_activity_date": 1513014277, "creation_date": 1513014277, "answer_id": 47758463, "question_id": 47402499, "link": "https://stackoverflow.com/questions/47402499/unable-to-upload-a-file-with-selenium-ruby/47758463#47758463", "title": "Unable to upload a file with Selenium - Ruby", "body": "<p>Find a file field on the page and attach a file given its path.\nThe file field can be found via its name, id or label text.</p>\n\n<pre><code>page.attach_file(locator, '/path/to/file.png')\n</code></pre>\n\n<p>Here, locator will be<code>CSS</code> id or class of file  upload path.</p>\n"}], "owner": {"reputation": 1, "user_id": 8974548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ccc6b7d2d9285bb11efeb1ec3f7d90a?s=128&d=identicon&r=PG&f=1", "display_name": "smashup", "link": "https://stackoverflow.com/users/8974548/smashup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513014277, "creation_date": 1511218452, "question_id": 47402499, "link": "https://stackoverflow.com/questions/47402499/unable-to-upload-a-file-with-selenium-ruby", "title": "Unable to upload a file with Selenium - Ruby", "body": "<p>I am trying to upload a file using a bot written in Ruby. It failed but I think my synthax to be good. I suppose that the recent upgrade of Firefox unabled me to do the job. Have you got an idea please ? </p>\n\n<p>I used these resources to do my code : </p>\n\n<p><a href=\"https://saucelabs.com/resources/articles/best-practices-tips-selenium-file-upload\" rel=\"nofollow noreferrer\">https://saucelabs.com/resources/articles/best-practices-tips-selenium-file-upload</a></p>\n\n<p><a href=\"http://elementalselenium.com/tips/1-upload-a-file\" rel=\"nofollow noreferrer\">http://elementalselenium.com/tips/1-upload-a-file</a></p>\n\n<p>I got the last version of selenium here : </p>\n\n<p><a href=\"https://rubygems.org/gems/selenium-webdriver/versions/2.53.0?locale=fr\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/selenium-webdriver/versions/2.53.0?locale=fr</a></p>\n\n<p>I got the last version of geckodriver here : </p>\n\n<p><a href=\"https://rubygems.org/gems/geckodriver-helper/versions/0.0.3\" rel=\"nofollow noreferrer\">https://rubygems.org/gems/geckodriver-helper/versions/0.0.3</a></p>\n\n<p>But it didn't work : WebDriverError@chrome://marionnette/content/error.js:235:5 File not found</p>\n\n<p>I am using wordpress in local mode with local by flywheel.\nFirefox Quantum 57.0 64bits</p>\n\n<p>Here is my little code : </p>\n\n<pre><code>require 'selenium-webdriver'\nrequire 'rspec/expectations'\ninclude RSpec::Matchers\n\ndef setup\n  @driver = Selenium::WebDriver.for :firefox\nend\n\ndef teardown\n  @driver.quit\nend\n\ndef run\n  setup\n  yield\n  teardown\nend\n\nrun do\n  @driver.get \"http://mywebsite.dev/wp-admin/profile.php\"\n  inputlogin = @driver.find_element :id =&gt; \"user_login\"\n  inputpwd = @driver.find_element :id =&gt; \"user_pass\"\n\n  inputlogin.send_keys \"mylogin\"\n  inputpwd.send_keys \"mypwd\"\n  @driver.find_element(:id, \"wp-submit\").click\n\n  @driver.get \"http://mywebsite.dev\"\n  element = @driver.find_element(:id, 'uploadInput1')\n  element.send_keys \"C:\\\\path\\\\image.jpg\"\n\n  # @driver.find_element(id: 'btn-submit').click\n\n  puts \"Successful on #{@driver.title}\"\nend\n</code></pre>\n\n<p>As it didn't work, I was looking for an other way to upload my file so I tried using AutoIT but I failed... Here is an example. </p>\n\n<p><a href=\"http://www.maisasolutions.com/blog/How-to-upload-images-using-selenium-webdriver-with-ruby\" rel=\"nofollow noreferrer\">http://www.maisasolutions.com/blog/How-to-upload-images-using-selenium-webdriver-with-ruby</a></p>\n\n<p>Moreover, this solution is very heavy (downloads, installations, non reproductability etc.) and don't seems to be proper code.</p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["ruby", "multithreading", "deadlock"], "comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1511220989, "post_id": 47402408, "comment_id": 81759497, "body": "Is this what you&#39;re looking for? <a href=\"https://stackoverflow.com/questions/30400319/ruby-wait-for-all-threads-completed-using-join-and-threadswait-all-waits-what\" title=\"ruby wait for all threads completed using join and threadswait all waits what\">stackoverflow.com/questions/30400319/&hellip;</a>? It&#39;s possible that the <a href=\"https://ruby-doc.org/stdlib-1.9.3/libdoc/thwait/rdoc/ThreadsWait.html\" rel=\"nofollow noreferrer\">ThreadsWait</a> class has something you can use."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1511233235, "post_id": 47402408, "comment_id": 81762710, "body": "can you show your existing solution?"}, {"owner": {"reputation": 2192, "user_id": 215044, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bbee182f380067c8428dd32f3ead7825?s=128&d=identicon&r=PG", "display_name": "rcrogers", "link": "https://stackoverflow.com/users/215044/rcrogers"}, "edited": false, "score": 0, "creation_date": 1511243055, "post_id": 47402408, "comment_id": 81765392, "body": "<code>ThreadsWait</code> is exactly what I was looking for -- feel free to post as an answer and I&#39;ll accept!"}, {"owner": {"reputation": 2192, "user_id": 215044, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bbee182f380067c8428dd32f3ead7825?s=128&d=identicon&r=PG", "display_name": "rcrogers", "link": "https://stackoverflow.com/users/215044/rcrogers"}, "edited": false, "score": 0, "creation_date": 1511243447, "post_id": 47402408, "comment_id": 81765542, "body": "existing solution added"}], "owner": {"reputation": 2192, "user_id": 215044, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bbee182f380067c8428dd32f3ead7825?s=128&d=identicon&r=PG", "display_name": "rcrogers", "link": "https://stackoverflow.com/users/215044/rcrogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511243436, "creation_date": 1511218009, "last_edit_date": 1511243436, "question_id": 47402408, "link": "https://stackoverflow.com/questions/47402408/join-threads-in-the-order-they-finish-in-order-to-raise-exception-faster", "title": "join threads in the order they finish, in order to raise exception faster", "body": "<p>I have a couple threads running and want to wait for them to finish:</p>\n\n<pre><code>[thread_a, thread_b].each(&amp;:join)\n</code></pre>\n\n<p>Say that one of the threads suffers an immediate fatal exception as soon as it's started.  Meanwhile, the other takes 10 minutes to complete.  If we're lucky and <code>thread_a</code> is the thread that fails, we'll get its exception immediately, since it's being joined first.  However, if we're unlucky, we have to wait 10 minutes for <code>thread_a</code> to finish, and only then does <code>thread_b</code> get to raise its exception to the parent thread.</p>\n\n<p>I have an existing solution that uses an <code>ensure</code> block in each thread, to insert that thread into a queue when it exits.  The parent thread can then poll the queue and join each thread as it finishes.  However, I'm wondering if Ruby has a more idiomatic way to handle this?</p>\n\n<p>Existing solution:</p>\n\n<pre><code>dead_threads = Queue.new\n\nthreads = 2.times.map do |i|\n  Thread.new do\n    begin\n      case i\n      when 0; sleep\n      when 1; raise \"I'm the problem thread!\"\n      end\n    ensure\n      dead_threads &lt;&lt; Thread.current\n    end\n  end\nend\n\nlive_threads_count = threads.size\nuntil live_threads_count == 0\n  dead_threads.shift.join\n  live_threads_count -= 1\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-5", "rails-activerecord"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511218129, "post_id": 47402338, "comment_id": 81758594, "body": "<code>accepts_nested_attributes_for</code> is only really needed when you want to create nested records in the same request with attributes. Its not needed when you are just assigning associations with the <code>_ids</code> setters like when you are selecting items with a select. So in this case you don&#39;t need it."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511218324, "post_id": 47402338, "comment_id": 81758671, "body": "<code>User.create(email: &quot;someone@somewhere.com&quot;, dietary_tag_ids: [1])</code> should implicitly create a <code>DietaryTagging</code> record. The question is really what is triggering the validation error."}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511220061, "post_id": 47402338, "comment_id": 81759221, "body": "@max I <i>think</i> the validation is being triggered by <a href=\"https://blog.bigbinary.com/2016/02/15/rails-5-makes-belong-to-association-required-by-default.html\" rel=\"nofollow noreferrer\">Rails 5&#39;s new <code>belongs_to</code> behavior</a>. If I change DietaryTagging to use, <code>belongs_to :dietary_taggable, polymorphic: true, optional: true</code> everything works as expected."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511220469, "post_id": 47402338, "comment_id": 81759343, "body": "Thats wierd, rails should set both associations when creating the join model impllicitly. It could be due to the polymorphic association. Does the created DietaryTagging have the correct <code>dietary_taggable_id</code> and <code>dietary_taggable_type</code>?"}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511220885, "post_id": 47402338, "comment_id": 81759467, "body": "@max Yes, it does."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1511222320, "post_id": 47402338, "comment_id": 81759944, "body": "Sounds like a bug in the validation generated by the association. I would just leave  <code>optional: true</code> and use <code>validates_presence_of :dietary_taggable_id, :dietary_taggable_type</code>"}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511226023, "post_id": 47402338, "comment_id": 81760935, "body": "@max Interestingly, adding those validations results in the same error."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511229105, "post_id": 47402338, "comment_id": 81761683, "body": "Just a guess, but any chance it could be related to plural/singular? I have trouble myself sometimes remembering what gets pluralized where. Any chance it should be <code>User.create(email: &quot;someone@somewhere.com&quot;, dietary_tags_ids: [1])</code> with a plural on <code>dietary_tags_ids</code>?"}, {"owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511229357, "post_id": 47402338, "comment_id": 81761758, "body": "@Beartech Thanks for the suggestion, but that doesn&#39;t work. The resulting error is, <code>ActiveModel::UnknownAttributeError: unknown attribute &#39;dietary_tags_ids&#39; for User</code>"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1511229730, "post_id": 47402338, "comment_id": 81761868, "body": "I feel like I have run into similar before but can&#39;t remember... Something about the creation seems off but I&#39;m no expert. I know if you were passing these in params from a web form the params would be more like: `User.create(email: &quot;someone@somewhere.com&quot;, dietary_tag_attributes: {ids:  [1]} )"}], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1197, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511217627, "creation_date": 1511217627, "question_id": 47402338, "link": "https://stackoverflow.com/questions/47402338/rails-5-accepts-nested-attributes-for-has-many-through", "title": "Rails 5 accepts_nested_attributes_for/has_many :through", "body": "<p>How do I create a new model containing a reference to an association (many-to-many, using <code>has_many :through</code>) which already exists?</p>\n\n<p>Here are the relevant portions of the models which form the many-to-many relationship:</p>\n\n<pre><code>class DietaryTagging &lt; ApplicationRecord\n  belongs_to :dietary_tag\n  belongs_to :dietary_taggable, polymorphic: true\nend\n\nclass DietaryTag &lt; ApplicationRecord\n  has_many :dietary_taggings\n\n  has_many  :users,\n            source: :dietary_taggable,\n            source_type: \"User\",\n            through: :dietary_taggings\nend\n\nclass User &lt; ApplicationRecord\n  has_many :dietary_taggings, as: :dietary_taggable\n  has_many :dietary_tags, through: :dietary_taggings\n  accepts_nested_attributes_for :dietary_tags\nend\n</code></pre>\n\n<p>Given an existing <code>DietaryTag</code> whose ID is 1, when trying to create a new <code>User</code> with the following, I'm presented with an error which says, <code>{:dietary_taggings=&gt;[\"is invalid\"]}</code>.</p>\n\n<p><code>User.create(email: \"someone@somewhere.com\", dietary_tag_ids: [1])</code></p>\n\n<p>I'm able to create the join model directly using for an existing user and dietary tag: <code>DietaryTagging.create(dietary_taggable: User.last, dietary_tag_id: 1)</code>. So, I'm pretty sure the issue is either with how I'm using <code>accepts_nested_attributes_for</code> or my expectations about how/when the join instance should be created.</p>\n"}, {"tags": ["ruby", "sqlite3-ruby"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1511217090, "post_id": 47402048, "comment_id": 81758216, "body": "Have you tried passing the variables in an array, that is, <code>db.execute(&quot;INSERT INTO usn_notice (usn_number, href, title, description) VALUES (?,?,?,?)&quot;, [usn_number, href, title, description])</code>?"}, {"owner": {"reputation": 379, "user_id": 3541354, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/efb36d4a06472f564803595de5401e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Koko", "link": "https://stackoverflow.com/users/3541354/koko"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1511272775, "post_id": 47402048, "comment_id": 81783326, "body": "Ah, that works. Thank you!"}], "owner": {"reputation": 379, "user_id": 3541354, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/efb36d4a06472f564803595de5401e6c?s=128&d=identicon&r=PG&f=1", "display_name": "Koko", "link": "https://stackoverflow.com/users/3541354/koko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511216273, "creation_date": 1511216273, "question_id": 47402048, "link": "https://stackoverflow.com/questions/47402048/ruby-sqlite3-please-switch-to-passing-bind-parameters-as-an-array", "title": "Ruby/Sqlite3: Please switch to passing bind parameters as an array", "body": "<p>New to ruby here - getting an error about bind parameters in my <code>db_add_notice</code> method. Having trouble googling this error for some reason. Can someone point out what's wrong? Thanks.</p>\n\n<p>./check.rb:57:in `db_add_notice' is calling SQLite3::Database#execute with nil or multiple bind params\nwithout using an array.  Please switch to passing bind parameters as an array.\nSupport for bind parameters as *args will be removed in 2.0.0.</p>\n\n<pre><code>...\n# add a usn entry to the datase\ndef db_add_notice(db, usn_number, href, title, description)\n   db.execute(\"INSERT INTO usn_notice (usn_number, href, title, description) VALUES (?,?,?,?)\", usn_number, href, title, description)\nend\n...\ndb_add_notice(db, usn_number, href, title, description)\n...\n</code></pre>\n"}, {"tags": ["ruby", "set"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511216242, "post_id": 47401957, "comment_id": 81757855, "body": "The number of combinations is less than <i>O(N^2)</i> but it&#39;s still pretty punishing in terms of how many tests you need to do. Is it only positive integers? You can discard numbers higher than your target <i>m</i> obviously."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1511216292, "post_id": 47401957, "comment_id": 81757878, "body": "Is this &quot;two numbers&quot; as in &quot;sum of two numbers&quot;?"}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 1, "creation_date": 1511217296, "post_id": 47401957, "comment_id": 81758296, "body": "And can those two numbers actually be at the same location in the array (implying the two numbers are equal), or do they have to be at different locations?"}, {"owner": {"reputation": 53, "user_id": 7988874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8a621286d16dfa69f3a630a11b6500c?s=128&d=identicon&r=PG&f=1", "display_name": "mhkna", "link": "https://stackoverflow.com/users/7988874/mhkna"}, "edited": false, "score": 0, "creation_date": 1511227738, "post_id": 47401957, "comment_id": 81761329, "body": "Yes, &#39;two numbers&#39; did mean &#39;sum of two numbers&#39; in this case."}], "answers": [{"comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1511219812, "post_id": 47402077, "comment_id": 81759136, "body": "Note, (as implied in your  <a href=\"https://stackoverflow.com/questions/47401957/using-a-set-in-ruby-find-if-num-exists-as-a-sum-of-2-numbers-in-an-array#comment81757855_47401957\">comment up above</a> that you should only run the <code>reject { v &gt;= n }</code> if you&#39;re guaranteed to have only positive integers...otherwise a number larger than target plus a negative number could bring it back down to equality."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1511216397, "creation_date": 1511216397, "answer_id": 47402077, "question_id": 47401957, "link": "https://stackoverflow.com/questions/47401957/using-a-set-find-if-num-exists-as-a-sum-of-2-numbers-in-an-array/47402077#47402077", "title": "Using a set, find if num exists as a sum of 2 numbers in an array", "body": "<p>The naive strategy here is pretty simple:</p>\n\n<pre><code>def sum?(array, n)\n  array.reject do |v|\n    v &gt;= n\n  end.combination(2).any? do |a, b|\n    a + b == n\n  end\nend\n</code></pre>\n\n<p>Using a <code>Set</code> seems pretty heavy-handed as you'd have to compute the entire set of all possible sums. For repeated tests it would be more efficient, you only need to compute the set once, but for single tests it's less efficient. This really depends on your use case.</p>\n\n<p>For example:</p>\n\n<pre><code>def sum?(array, n)\n  Set.new(\n    array.reject do |v|\n      v &gt;= n\n    end.combination(2).map do |a, b|\n      a + b\n    end\n  ).include?(n)\nend\n</code></pre>\n\n<p>You could try benchmarking that to see what the performance is like with longer lists of numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511216629, "post_id": 47402096, "comment_id": 81758021, "body": "The question is a bit hazy but does seem to imply that a sum is required."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1511216681, "post_id": 47402096, "comment_id": 81758040, "body": "You&#39;re missing a <code>do</code> and should probably mention <code>require &#39;set&#39;</code>."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1511216854, "post_id": 47402096, "comment_id": 81758119, "body": "@tadman the sum is implicit. If the array includes both <code>x</code> and <code>num-x</code> then it contains two numbers that sum to <code>num</code>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1511216918, "post_id": 47402096, "comment_id": 81758138, "body": "Ah, true, good point. That won&#39;t scale to three numbers but it should work for two. This should perform fairly well so long as the construction cost on the set is fairly linear."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1511217025, "post_id": 47402096, "comment_id": 81758187, "body": "Regarding the last paragraph of the answer: I think your code will work fine if the array is <code>[num&#47;2]</code>.  Then <code>num - x</code> equals <code>x</code>, and <code>include?</code> returns true, so <code>any?</code> returns true."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1511217104, "post_id": 47402096, "comment_id": 81758223, "body": "@DavidGrayson The question says &quot;sum of two numbers&quot; so I think it would need to be <code>[num&#47;2,num&#47;2]</code> in order to be true."}, {"owner": {"reputation": 53, "user_id": 7988874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8a621286d16dfa69f3a630a11b6500c?s=128&d=identicon&r=PG&f=1", "display_name": "mhkna", "link": "https://stackoverflow.com/users/7988874/mhkna"}, "edited": false, "score": 0, "creation_date": 1511228144, "post_id": 47402096, "comment_id": 81761445, "body": "@Max Thanks. This worked great along with a check to make sure num - x doesn&#39;t equal x"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 4, "last_activity_date": 1520972408, "last_edit_date": 1520972408, "creation_date": 1511216526, "answer_id": 47402096, "question_id": 47401957, "link": "https://stackoverflow.com/questions/47401957/using-a-set-find-if-num-exists-as-a-sum-of-2-numbers-in-an-array/47402096#47402096", "title": "Using a set, find if num exists as a sum of 2 numbers in an array", "body": "<p>With a set, lookup of a specific number is approximately constant. For each number in the array, there is only one other number that can make the sum work. Scanning the array is linear.</p>\n\n<pre><code>require 'set'\n\ndef sum?(array, num)\n  set = array.to_set\n  array.any? { |x| set.include?(num - x) }\nend\n</code></pre>\n\n<p>The set conversion is approximately linear (N inserts), the <code>any?</code> is linear since the worst case iterates over each element once, and each element has an approximately constant lookup in the set. So overall linear.</p>\n\n<p>This method fails if <code>num</code> is even and the array contains a single copy of <code>num/2</code>. That is another linear check, which I'll leave as an exercise.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 8473146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa65b46dba0bfc383fc79409d262c9d?s=128&d=identicon&r=PG&f=1", "display_name": "mroeder", "link": "https://stackoverflow.com/users/8473146/mroeder"}, "is_accepted": false, "score": 0, "last_activity_date": 1511274740, "creation_date": 1511274740, "answer_id": 47415621, "question_id": 47401957, "link": "https://stackoverflow.com/questions/47401957/using-a-set-find-if-num-exists-as-a-sum-of-2-numbers-in-an-array/47415621#47415621", "title": "Using a set, find if num exists as a sum of 2 numbers in an array", "body": "<p>You asked for a set based solution. If you want to avoid imports, you could use rubys \"Enumerable#uniq\" function instead (also implemented in Array), which creates a new array without dublicate entries. The next step would be to determine the minimum int value of your array and subtract that from your wished sum value. The value calculated like this is the maximum allowed value you have. You can then reject the others. All the operations so far seem to be O(N) according to the C-Code in the ruby docs. In the end you can use the Enumerable#any? function, as in your pereferd solution.</p>\n\n<p>Here goes some untested code:</p>\n\n<pre><code>    def sum?(array,num)\n       rest = array.uniq\n       max_allowed = num - rest.min\n       rest.reject! {|value| value &gt; max_allowed}\n       rest.any? {|value| rest.include?(num - value)}\n    end\n</code></pre>\n\n<p>For the calculation:\narray.uniq is pretty much the same as a tranformation into a set, so lets skip this.\ncalculating max allowed is O(1) + O(N)\nrejection is O(N)\nany? should result in avg of O(N * log(N))</p>\n\n<p>which makes the result: O(1) + 2 * O(N) + O(N * log(N))\naccording to the big O notation this is O(N * log(N)) as it is the biggest part which is less then O(N^2)</p>\n"}], "owner": {"reputation": 53, "user_id": 7988874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8a621286d16dfa69f3a630a11b6500c?s=128&d=identicon&r=PG&f=1", "display_name": "mhkna", "link": "https://stackoverflow.com/users/7988874/mhkna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47402096, "answer_count": 3, "score": 0, "last_activity_date": 1520972408, "creation_date": 1511215843, "last_edit_date": 1511231975, "question_id": 47401957, "link": "https://stackoverflow.com/questions/47401957/using-a-set-find-if-num-exists-as-a-sum-of-2-numbers-in-an-array", "title": "Using a set, find if num exists as a sum of 2 numbers in an array", "body": "<p>I need to find if two numbers in an array equal a specific digit or not.</p>\n\n<pre><code>def sum?(array, num)\nend\n\nsum?([1, 2, 3], 5) #=&gt; true\nsum?([1, 2, 3], 6) #=&gt; false\n</code></pre>\n\n<p>Is there a solution using a set whose order is less than N^2? Also, is there a way to get under N^2 without using a set?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511218861, "post_id": 47401891, "comment_id": 81758839, "body": "Well you could eval the file contents and it will return the class/module object provided that the file only declares one class/module. You would also have to deal with the duplicate constant issue. But most autoloader designs are based on a set of conventions instead."}, {"owner": {"reputation": 115, "user_id": 7397261, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/27684debc553213b41cf21042c1142a7?s=128&d=identicon&r=PG&f=1", "display_name": "a user", "link": "https://stackoverflow.com/users/7397261/a-user"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1511224673, "post_id": 47401891, "comment_id": 81760579, "body": "@max updated the question a bit. Eval returns a symbol of the last method declared in the class."}], "owner": {"reputation": 115, "user_id": 7397261, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/27684debc553213b41cf21042c1142a7?s=128&d=identicon&r=PG&f=1", "display_name": "a user", "link": "https://stackoverflow.com/users/7397261/a-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511229114, "creation_date": 1511215524, "last_edit_date": 1511227712, "question_id": 47401891, "link": "https://stackoverflow.com/questions/47401891/load-in-arbitrary-code-and-find-a-class", "title": "Load in arbitrary code and find a class", "body": "<p>I'm doing an experiment that involves taking in an arbitrary bit of code and determining which class was just loaded from a <code>require &lt;file&gt;</code> or <code>eval &lt;file&gt;</code> statement.</p>\n\n<p>So, for example, if I have:</p>\n\n<pre><code>module Foo\n  class Bar &lt; ExistingGemModule::ExistingGemClass\n\n  end\nend\n</code></pre>\n\n<p>I want to come up with Foo::Bar</p>\n\n<p>Is there a way for me to do that? </p>\n\n<p>These might be hacky ways to do it:</p>\n\n<ul>\n<li>Use regex on the file, including taking in modules/namespaces. </li>\n<li>Find an index of everything loaded before the statement, then immediately after, and perform <code>after - before</code>.</li>\n</ul>\n\n<p>What I'm really checking if I can use bare-metal Ruby infrastructure/callbacks/interrupts/etc to do it.</p>\n\n<p>Yes, I know it's dangerous to require arbitrary code in production. :)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "sinatra-activerecord"], "comments": [{"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 3, "creation_date": 1511219772, "post_id": 47401809, "comment_id": 81759121, "body": "I think <code>:develpoment</code> is spelled wrong."}, {"owner": {"reputation": 789, "user_id": 8758793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZupKk.jpg?s=128&g=1", "display_name": "Matt Hough", "link": "https://stackoverflow.com/users/8758793/matt-hough"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1511221230, "post_id": 47401809, "comment_id": 81759590, "body": "Thank you. I checked over it multiple times and missed that!"}], "owner": {"reputation": 789, "user_id": 8758793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZupKk.jpg?s=128&g=1", "display_name": "Matt Hough", "link": "https://stackoverflow.com/users/8758793/matt-hough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1511215119, "creation_date": 1511215119, "question_id": 47401809, "link": "https://stackoverflow.com/questions/47401809/sinatra-activerecordconnectionnotestablished-no-connection-pool-for-activer", "title": "Sinatra - ActiveRecord::ConnectionNotEstablished: No connection pool for ActiveRecord::Base", "body": "<p>I've only been able to find rails answers to this question. Whenever I run <code>rake db:migrate</code> I am getting the aforementioned error. As far as I am aware, I have setup everything correctly so have no idea what's wrong.</p>\n\n<h3>config/environment.rb</h3>\n\n<pre><code>ENV['SINATRA_ENV'] ||= \"development\"\n\nrequire 'bundler/setup'\nBundler.require(:default, ENV['SINATRA_ENV'])\n\nconfigure :develpoment do\n    set :database, 'sqlite3:db/database.db'\nend\n\nrequire './app'\n</code></pre>\n\n<h3>Rakefile</h3>\n\n<pre><code>require \"./config/environment\"\nrequire \"sinatra/activerecord/rake\"\n</code></pre>\n"}]