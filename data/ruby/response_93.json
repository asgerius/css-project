[{"tags": ["arrays", "ruby", "string", "date"], "answers": [{"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1476919792, "post_id": 40143056, "comment_id": 67556162, "body": "is calling a ruby array <code>times</code> a great idea?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1476920973, "post_id": 40143056, "comment_id": 67556520, "body": "It&#39;s an array of times, but you can call it almost anything you want so long as it doesn&#39;t conflict with a reserved keyword. <code>times</code> isn&#39;t one of those."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1476919327, "creation_date": 1476919327, "answer_id": 40143056, "question_id": 40143026, "link": "https://stackoverflow.com/questions/40143026/how-can-i-remove-unwanted-characters-from-date-like-strings-within-an-array/40143056#40143056", "title": "How can I remove unwanted characters from date-like strings within an array?", "body": "<p>Just split on <code>:</code> and discard the rest:</p>\n\n<pre><code>times = [ \"24/Oct/2014:13:43:15 -0600\", \"25/Oct/2014:14:47:25 -0600\", \"24/Oct/2014:13:46:15 -0600\" ]\n\ntimes.map do |time|\n  time.split(':').first\nend\n\n# =&gt; [\"24/Oct/2014\", \"25/Oct/2014\", \"24/Oct/2014\"]\n</code></pre>\n\n<p>If you want to do that in-place and modify your array, use <code>map!</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1476947020, "last_edit_date": 1476947020, "creation_date": 1476925612, "answer_id": 40143888, "question_id": 40143026, "link": "https://stackoverflow.com/questions/40143026/how-can-i-remove-unwanted-characters-from-date-like-strings-within-an-array/40143888#40143888", "title": "How can I remove unwanted characters from date-like strings within an array?", "body": "<pre><code>arr = [\"24/Oct/2014:13:43:15 -0600\",\n       \"05/Oct/2014:14:47:25 -0600\",\n       \"24/Oct/2014:13:46:15 -0600\"]\n</code></pre>\n\n<p>If you are certain that the format of the date strings will be correct, and represent valid dates, you can simply write</p>\n\n<pre><code>arr.map { |s| s[0,11] }\n  #=&gt; [\"24/Oct/2014\", \"05/Oct/2014\", \"24/Oct/2014\"]\n</code></pre>\n\n<p>On the other hand, if you wish to check the validity of the date strings, you may wish to convert each date string to a date object, then convert that object to the desired string format. That way, an exception will be raised if a date string is invalid.</p>\n\n<pre><code>require 'date'\n\narr.map { |s| DateTime.strptime(s, '%d/%b/%Y:%H:%M:%S %z').strftime('%d/%b/%Y') }\n  #=&gt; [\"24/Oct/2014\", \"05/Oct/2014\", \"24/Oct/2014\"] \n</code></pre>\n\n<p>This uses the methods <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/date/rdoc/DateTime.html#method-c-strptime\" rel=\"nofollow\">DateTime::strptime</a> and <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/date/rdoc/DateTime.html#method-i-strftime\" rel=\"nofollow\">DateTime#strftime</a>. Date format strings are explained in the doc for <code>strftime</code>.</p>\n\n<p>Suppose</p>\n\n<pre><code>arr = [\"42/Oct/2014:13:43:15 -0600\"]\n</code></pre>\n\n<p>then</p>\n\n<pre><code>arr.map { |s| DateTime.strptime(s, '%d/%b/%Y:%H:%M:%S %z').strftime('%d/%b/%Y') }\n  #=&gt; ArgumentError: invalid date\n</code></pre>\n\n<p>You could instead use <a href=\"http://ruby-doc.org/stdlib-2.3.0/libdoc/date/rdoc/DateTime.html#method-c-parse\" rel=\"nofollow\">DateTime::parse</a> instead of <code>strptime</code> to convert date strings to <code>Date</code> objects, but it is quite weak at identifying invalid dates. For example:</p>\n\n<pre><code>DateTime.parse \"123456/01-02abc\"\n  #=&gt; #&lt;DateTime: 123456-01-02T00:00:00+00:00 ((46812439j,0s,0n),...\nDateTime.parse \"-7/8\"\n  #=&gt; #&lt;DateTime: 2016-07-08T00:00:00+00:00 ((2457578j,0s,0n),...\nDateTime.parse \"He demanded 1/2 of the pie\"\n  #=&gt; #&lt;DateTime: 2016-01-02T00:00:00+00:00 ((2457390j,0s,0n),...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": true, "score": 2, "last_activity_date": 1476939990, "last_edit_date": 1476939990, "creation_date": 1476939197, "answer_id": 40145736, "question_id": 40143026, "link": "https://stackoverflow.com/questions/40143026/how-can-i-remove-unwanted-characters-from-date-like-strings-within-an-array/40145736#40145736", "title": "How can I remove unwanted characters from date-like strings within an array?", "body": "<h2>Many Alternatives with Strings</h2>\n\n<p>There are a lot of ways to manipulate date strings as String objects. In your case, two such options include <a href=\"https://ruby-doc.org/core/String.html#method-i-partition\" rel=\"nofollow\">String#partition</a> and <a href=\"https://ruby-doc.org/core/String.html#method-i-match\" rel=\"nofollow\">String#match</a>. For example:</p>\n\n<pre><code>dates = [\n  \"24/Oct/2014:13:43:15 -0600\",\n  \"25/Oct/2014:14:47:25 -0600\",\n  \"24/Oct/2014:13:46:15 -0600\"\n]\n\ndates.map { |date| date.match(/\\A[^:]+/).to_s }\ndates.map { |date| date.partition(?:)[0] }\n</code></pre>\n\n<p>Both methods will return an array of strings like the following:</p>\n\n<pre><code>#=&gt; [\"24/Oct/2014\", \"25/Oct/2014\", \"24/Oct/2014\"]\n</code></pre>\n\n<h2>Considerations</h2>\n\n<p>The main problem with dealing with dates like this as String objects is that you're assuming that the string representation will always be the same. If you know your data, that's fine, but it's often better to treat dates <em>as</em> dates. For example, you can use <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html#method-c-parse\" rel=\"nofollow\">Date#parse</a>, with or without <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html#method-i-strftime\" rel=\"nofollow\">Date#strftime</a>, to automagically handle common representations as follows:</p>\n\n<pre><code>require 'date'\n\n# Remove #to_s if you want to return actual Date objects for\n# further processing, rather than an array of strings.\ndates.map { |date| Date.parse(date).to_s }\n#=&gt; [\"2016-10-24\", \"2016-10-25\", \"2016-10-24\"]\n\n# This will only return strings, but that's what you originally\n# asked for.\ndates.map { |date| Date.parse(date).strftime '%d/%b/%Y' }\n#=&gt; [\"24/Oct/2016\", \"25/Oct/2016\", \"24/Oct/2016\"]\n</code></pre>\n\n<p>The Date and DateTime libraries contain other parsers, too. Of course, if you use a non-standard input format you can use <a href=\"https://ruby-doc.org/stdlib/libdoc/date/rdoc/Date.html#method-c-strptime\" rel=\"nofollow\">Date#strptime</a> with a custom template.</p>\n\n<p>The point here is that munging String objects works, but it's generally better to deal with dates as Date or DateTime objects to avoid edge cases, validate inputs, and to raise exceptions like:</p>\n\n<pre><code>dates.map { |date| Date.rfc2822 date }\n</code></pre>\n\n<blockquote>\n  <p>ArgumentError: invalid date</p>\n</blockquote>\n\n<p>when appropriate. You should definitely leverage core capabilities like this whenever possible.</p>\n"}], "owner": {"reputation": 33, "user_id": 7025340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c6ebd5a4f018cb638cf79bd680e59b6?s=128&d=identicon&r=PG&f=1", "display_name": "tbrent", "link": "https://stackoverflow.com/users/7025340/tbrent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 40145736, "answer_count": 3, "score": 0, "last_activity_date": 1476947020, "creation_date": 1476919091, "last_edit_date": 1476939307, "question_id": 40143026, "link": "https://stackoverflow.com/questions/40143026/how-can-i-remove-unwanted-characters-from-date-like-strings-within-an-array", "title": "How can I remove unwanted characters from date-like strings within an array?", "body": "<p>I have an array with multiple dates and times:</p>\n\n<pre><code>[ \"24/Oct/2014:13:43:15 -0600\",\n  \"25/Oct/2014:14:47:25 -0600\",\n  \"24/Oct/2014:13:46:15 -0600\" ]\n</code></pre>\n\n<p>I've been trying to get.</p>\n\n<pre><code>[\"24/Oct/2014\", \"25/Oct/2014\", \"24/Oct/2014\"]\n</code></pre>\n\n<p>I have tried using <code>gsub</code> to replace what's not needed with a blank space, but it's only removed the colons. How could I remove this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "capybara"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1476924224, "post_id": 40142983, "comment_id": 67557288, "body": "Welcome to Stack Overflow. This isn&#39;t the place to rant. SO is to help you solve a problem with code, not act as a sounding block. Also, SO isn&#39;t a discussion list, it&#39;s a reference book, and your question just created a new article describing how to solve the problem you asked about. Do you think it&#39;s appropriate to write an article in a reference book that is a rant? Would you see such in an encyclopedia, text book or cookbook?"}], "answers": [{"comments": [{"owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920165, "post_id": 40143149, "comment_id": 67556275, "body": "It didn&#39;t work. :-( <code>crawler.rb:5:in </code>block in &lt;main&gt;&#39;: undefined local variable or method <code>app&#39; for main:Object (NameError)</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920256, "post_id": 40143149, "comment_id": 67556299, "body": "@MichaelP. Sorry - forgot the parameter on the register_driver block - fixed"}, {"owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920368, "post_id": 40143149, "comment_id": 67556331, "body": "Thanks for responding, Tom. Here&#39;s what I&#39;m getting when I run that code: Unable to find chromedriver. Please download the server from        <a href=\"http://chromedriver.storage.googleapis.com/index.html\" rel=\"nofollow noreferrer\">chromedriver.storage.googleapis.com/index.html</a> and place it        somewhere on your PATH. More info at <a href=\"https://github.com/SeleniumHQ/selenium/wiki/ChromeDriver\" rel=\"nofollow noreferrer\">github.com/SeleniumHQ/selenium/wiki/ChromeDriver</a>. (Selenium::WebDriver::Error::WebDriverError)"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920415, "post_id": 40143149, "comment_id": 67556346, "body": "right - as my answer said - you need to download the latest chromedriver - <a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\">sites.google.com/a/chromium.org/chromedriver/downloads</a> - and put it somewhere in your PATH"}, {"owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920614, "post_id": 40143149, "comment_id": 67556407, "body": "I don&#39;t know how to install the driver. That page and a Google search aren&#39;t showing me how."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "edited": false, "score": 0, "creation_date": 1476920694, "post_id": 40143149, "comment_id": 67556425, "body": "@MichaelP. What platform are you on?"}, {"owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1476920703, "post_id": 40143149, "comment_id": 67556431, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/126170/discussion-between-michael-p-and-tom-walpole\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 3, "last_activity_date": 1476920187, "last_edit_date": 1476920187, "creation_date": 1476919876, "answer_id": 40143149, "question_id": 40142983, "link": "https://stackoverflow.com/questions/40142983/my-attempts-at-building-the-simplest-web-crawler-w-capybara-are-failing-what-am/40143149#40143149", "title": "My attempts at building the simplest web crawler w/Capybara are failing. What am I doing wrong?", "body": "<p>selenium-webdriver recently released 3.0.0 which defaults to using geckodriver with firefox (which Capybara defaults to), but has some missing functionality in that combination.  Rather I would recommend using it with chrome and chromedriver for your use case.  You will need to download the latest version of chromedriver and put it somewhere in your PATH.  Then</p>\n\n<pre><code>require \"capybara/dsl\"\nrequire \"selenium-webdriver\"\n\nCapybara.register_driver :crawler_driver do |app|\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :chrome)\nend\nCapybara.default_driver = :crawler_driver\n\nclass Crawler\n  include Capybara::DSL\n\n  def initialize\n    visit \"http://www.google.com\"\n  end\nend\n\ncrawler = Crawler.new\n</code></pre>\n\n<p>should do what you're trying to do.  You're going to have issues as soon as you create another Crawler instance though since they will both be using the same Capybara session and conflict.  If you're not going to be creating multiple instance then you're fine, if you are then you'll want to create a new Capybara::Session in each instance of crawler and call all capybara methods on that session object rather than including Capybara::DSL into your object which would be more like this</p>\n\n<pre><code>class Crawler\n  def initialize\n    @session = Capybara::Session.new(:crawler_driver)\n    @session.visit \"http://www.google.com\"\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 6747306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d281451f8e389d9ea59bfa1085df00?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Adeel", "link": "https://stackoverflow.com/users/6747306/muhammad-adeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1571900687, "creation_date": 1571900687, "answer_id": 58535921, "question_id": 40142983, "link": "https://stackoverflow.com/questions/40142983/my-attempts-at-building-the-simplest-web-crawler-w-capybara-are-failing-what-am/58535921#58535921", "title": "My attempts at building the simplest web crawler w/Capybara are failing. What am I doing wrong?", "body": "<p>You can use <code>poltergeist</code> driver in capybara which is much simpler to use. Also one more thing in capybara, the default driver is rack-test so we need to inform that we will use some other driver. </p>\n\n<p>Like in my case I do like that</p>\n\n<pre><code>require \"capybara/poltergeist\"\ncapybara = Capybara::Session.new(:poltergeist)\n</code></pre>\n"}], "owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 1, "accepted_answer_id": 40143149, "answer_count": 2, "score": 0, "last_activity_date": 1571900687, "creation_date": 1476918823, "last_edit_date": 1476919123, "question_id": 40142983, "link": "https://stackoverflow.com/questions/40142983/my-attempts-at-building-the-simplest-web-crawler-w-capybara-are-failing-what-am", "title": "My attempts at building the simplest web crawler w/Capybara are failing. What am I doing wrong?", "body": "<p>[Warning: Ranting ahead. Please don't edit out the ranting. I want to know whether what I'm encoutnering is normal. These sorts of obstacles absolutely ruin my day as a developer. They're more difficult than trying to solve for whatever business problem I've set out to solve.]</p>\n\n<p>Capybara. Mechanize. Nokogiri. Selenium. Et cetera.</p>\n\n<p>I've tried to build the simplest little Ruby program that does the following:</p>\n\n<ol>\n<li>Opens a web browser</li>\n<li>Navigates to a website</li>\n<li>Clicks a link</li>\n</ol>\n\n<p>. . . but have had basically no success.**</p>\n\n<p>Here's what I've tried:</p>\n\n<p>crawler.rb</p>\n\n<pre><code>require \"capybara\"\nrequire \"capybara/dsl\"\n\nclass Crawler\n  include Capybara::DSL\n\n  def initialize\n    visit \"http://www.google.com\"\n  end\nend\n\ncrawler = Crawler.new\n</code></pre>\n\n<p>When I run that code, I get an error.</p>\n\n<p><code>rack-test requires a rack application, but none was given (ArgumentError)</code></p>\n\n<p>I read somewhere not in the documentation that this should fix it:</p>\n\n<pre><code>require \"capybara\"\nrequire \"capybara/dsl\"\n\nclass Crawler\n  include Capybara::DSL\n\n  def initialize\n    Capybara.default_driver = :selenium\n    visit \"http://www.google.com\"\n  end\nend\n\ncrawler = Crawler.new\n</code></pre>\n\n<p>Then, when I solve for that error, I get another related to some other dependency.</p>\n\n<p><code>Unable to find Mozilla geckodriver. Please download the server from        https://github.com/mozilla/geckodriver/releases and place it        somewhere on your PATH. More info at https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver. (Selenium::WebDriver::Error::WebDriverError)</code></p>\n\n<p>I download the driver, have no clue as to how to actually install the thing despite reading and following another set of elliptical directions, but already have the distinct sense that I'm down a path of yak-shaving that won't yield any fruit, because all I want to do is get Ruby to go to a stupid web page and click a stupid link.</p>\n\n<p>I'm not trying to run this code as part of a test. I literally just want Ruby to open a  web browser (that I can see) using Capybara (or whatever tool gets the job done, though preferably Capybara) and to do my bidding. But this for whatever reason is EXTREMELY difficult, even though it's apparently been done a billion times.</p>\n\n<p>Guys/Gals, what am I doing wrong here? It's stuff like this that chews up way too much time whenever I'm trying to so much as test a simple idea.</p>\n\n<p>** It's absolutely infuriating--especially so because you'd think it would be as straightforward as following a given gem's documentation. But, generally speaking, I found that gems are elliptically documented. About 90% of the time, I have to go to Stackoverflow or google someone's tutorial in order to learn how to do the most basic shit with popular gems like the ones above, because they seldom just work. There's just about always some crazy gymnastics that, were it not for the assistance of others, I'd have zero clue as to how to overcome.</p>\n\n<p>Sorry--that's just a general gripe about open-source software. I'm not even a junior developer, and I find sometimes that I need to spend HOURS just getting a gem to do whatever basic thing it's supposed to do.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4.2"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 1, "creation_date": 1476918614, "post_id": 40142776, "comment_id": 67555828, "body": "As somebody that has no idea what these do, what do <code>ActionController::Routing.possible_controllers</code> and <code>Rails.application.routes.routes</code> actually output? Can you add a puts/inspect statement in there or something?"}], "owner": {"reputation": 119, "user_id": 1896065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/65528b147c9323a2ecb0d12dbb916833?s=128&d=identicon&r=PG", "display_name": "JmG", "link": "https://stackoverflow.com/users/1896065/jmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1476919515, "creation_date": 1476917501, "last_edit_date": 1476919515, "question_id": 40142776, "link": "https://stackoverflow.com/questions/40142776/add-controller-path-for-routes-in-rails-4", "title": "Add controller path for routes in Rails 4", "body": "<p>I am working on a rails migration project (From rails 2 to rails 4)</p>\n\n<p>So I have a folder under my rails root directory called \"template_actions\" and this folder has subdirectories that can have a controller in it(I cant change it.. thats how they have designed the structure). </p>\n\n<p>So to allow these paths to be considered, my routes.rb was like this. </p>\n\n<pre><code>allControllers= ActionController::Routing.possible_controllers + Actions.all_template_action_controllers #Returns controller names\nActionController::Routing.use_controllers!(allControllers)\nActionController::Routing::Routes.draw do |map|\n</code></pre>\n\n<p>I want this same thing in rails 4. </p>\n\n<pre><code>allControllers = Actions.all_template_action_controllers + Rails.application.routes.routes \nRails.application.routes.draw do\n</code></pre>\n\n<p>I tried the above and it crashes saying '+' is not allowed. </p>\n\n<p>Any idea how to get this working?</p>\n\n<p><b>OUTPUT Requested in Comments:</b></p>\n\n<p>Rails.application.routes.routes - Outputs a class. </p>\n\n<p>But each on it and puts prints the below.</p>\n\n<pre><code>#&lt;ActionDispatch::Journey::Route:0x007f88de078320 @name=nil, @app=#&lt;ActionDispatch::Routing::Mapper::Constraints:0x007f88de078c08 @dispatcher=false, @app=#&lt;Sprockets::Environment:0x3fc46c977f78 root=\"abcd\", paths=[\"abcd/app/assets/images\", \"abcd/app/assets/javascripts\", \"abcd/app/assets/stylesheets\", \"abcd/vendor/assets/javascripts\", \"abcd/vendor/assets/stylesheets\", \"/Users/qwerty/.rvm/gems/ruby-2.3.0/gems/jquery-rails-4.2.1/vendor/assets/javascripts\", \"/Users/qwerty/.rvm/gems/ruby-2.3.0/gems/coffee-rails-4.1.1/lib/assets/javascripts\", \"/Users/qwerty/.rvm/gems/ruby-2.3.0/gems/turbolinks-source-5.0.0/lib/assets/javascripts\"]&gt;, @constraints=[]&gt;, @path=#&lt;ActionDispatch::Journey::Path::Pattern:0x007f88de078b40 @spec=#&lt;ActionDispatch::Journey::Nodes::Cat:0x007f88de078e38 @left=#&lt;ActionDispatch::Journey::Nodes::Slash:0x007f88de079180 @left=\"/\", @memo=nil&gt;, @memo=nil, @right=#&lt;ActionDispatch::Journey::Nodes::Literal:0x007f88de078ed8 @left=\"assets\", @memo=nil&gt;&gt;, @requirements={}, @separators=\"/.?\", @anchored=false, @names=[], @optional_names=nil, @required_names=nil, @re=nil, @offsets=nil&gt;, @constraints={:required_defaults=&gt;[]}, @defaults={}, @required_defaults=nil, @required_parts=nil, @parts=nil, @decorated_ast=nil, @precedence=0, @path_formatter=#&lt;ActionDispatch::Journey::Format:0x007f88de0781b8 @parts=[\"/\", \"assets\"], @children=[], @parameters=[]&gt;&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "edited": false, "score": 0, "creation_date": 1476918345, "post_id": 40142744, "comment_id": 67555734, "body": "Stackoverflow also has documentation and many examples, you can check it here: <a href=\"http://stackoverflow.com/documentation/ruby/288/hashes/8854/conversion-to-and-from-arrays#t=201610192303377711573\">stackoverflow.com/documentation/ruby/288/hashes/8854/&hellip;</a>"}, {"owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "edited": false, "score": 0, "creation_date": 1476918449, "post_id": 40142744, "comment_id": 67555769, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5174913/combine-two-arrays-into-hash\">Combine two Arrays into Hash</a>"}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 3745914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089c0fafd037b2bc186da6ba68ecd94?s=128&d=identicon&r=PG", "display_name": "Asche", "link": "https://stackoverflow.com/users/3745914/asche"}, "is_accepted": false, "score": 0, "last_activity_date": 1477053334, "last_edit_date": 1495535247, "creation_date": 1476918019, "answer_id": 40142853, "question_id": 40142744, "link": "https://stackoverflow.com/questions/40142744/new-hash-from-2-arrays-arr1-key-arr2-value-where-arr2-is-random/40142853#40142853", "title": "New Hash from 2 Arrays: Arr1 = Key, Arr2 = Value where Arr2 is Random", "body": "<p>I'm pretty sure similar questions were answered in S.O. before, <a href=\"https://stackoverflow.com/questions/5174913/combine-two-arrays-into-hash\" title=\"Combine two arrays into hash\">like here</a>.</p>\n\n<p>Anyway, you can just do:</p>\n\n<pre><code>&gt; hash = Hash[arr1.zip(arr2.shuffle)]\n=&gt; {\"a\"=&gt;\"1\", \"b\"=&gt;\"2\", \"c\"=&gt;\"3\", \"d\"=&gt;\"4\"}\n</code></pre>\n\n<p>Tip: don't forget to take an extensive look at basic structures' documentation.</p>\n"}, {"tags": [], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "is_accepted": false, "score": 3, "last_activity_date": 1476918192, "creation_date": 1476918192, "answer_id": 40142882, "question_id": 40142744, "link": "https://stackoverflow.com/questions/40142744/new-hash-from-2-arrays-arr1-key-arr2-value-where-arr2-is-random/40142882#40142882", "title": "New Hash from 2 Arrays: Arr1 = Key, Arr2 = Value where Arr2 is Random", "body": "<p>So there are a fair number of ways to do this, but I'll do it in my favorite way</p>\n\n<pre><code>arr1.zip(arr2.shuffle).to_h\n</code></pre>\n\n<p>This shuffles (randomizes) <code>arr2</code> so <code>arr2</code> becomes <code>['3', '1', '2', '4']</code> (for example) and then zips <code>arr1</code> and <code>arr2</code> together into a multidimensional array <code>[['a', '3'], ['b', '1'], ['c', '2'], ['d', '4']]</code>. Then <code>to_h</code> turns this into a hash with the first element as the key and the second as the value.</p>\n"}], "owner": {"reputation": 1, "user_id": 7044849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67beaf88fd020d8e2c050e7f771999e?s=128&d=identicon&r=PG&f=1", "display_name": "Collin", "link": "https://stackoverflow.com/users/7044849/collin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1477053334, "creation_date": 1476917305, "last_edit_date": 1476927448, "question_id": 40142744, "link": "https://stackoverflow.com/questions/40142744/new-hash-from-2-arrays-arr1-key-arr2-value-where-arr2-is-random", "title": "New Hash from 2 Arrays: Arr1 = Key, Arr2 = Value where Arr2 is Random", "body": "<p>Newbie here. Scratching my head.</p>\n\n<p>I have 2 Arrays:</p>\n\n<pre><code>arr1 = [\"a\", \"b\", \"c\", \"d\"]\narr2 = [\"1\", \"2\", \"3\", \"4\"]\n</code></pre>\n\n<p>I want to make a Hash using <code>arr1</code> elements as the key and <code>arr2</code> elements as the value. I want <code>arr2</code> (or <code>arr1</code>, doesn't really matter) to be random.</p>\n\n<p>Result example:</p>\n\n<pre><code>hash = {\"a\"=&gt;\"3\", \"b\"=&gt;\"1\", \"c\"=&gt;\"2\", \"d\"=&gt;\"4\"}\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "loops", "if-statement", "scripting"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1476927936, "post_id": 40142679, "comment_id": 67558091, "body": "Note: Constants should be declared in <code>ALL_CAPS</code> names. Also use <code>case</code> to break out behaviour when you&#39;re comparing the same variable vs. multiple values, as you do where with <code>@selection</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "edited": false, "score": 0, "creation_date": 1476918032, "post_id": 40142722, "comment_id": 67555638, "body": "Used .size but I guess it works in a way but the @correct_tries just restarts itself and doesn&#39;t break the loop?"}], "tags": [], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1476917159, "creation_date": 1476917159, "answer_id": 40142722, "question_id": 40142679, "link": "https://stackoverflow.com/questions/40142679/how-do-i-get-the-elsif-for-correct-tries-to-work-properly/40142722#40142722", "title": "How do I get the elsif for @correct_tries to work properly?", "body": "<p>The <code>elsif</code> condition\n<code>elsif(@correct_tries == hangman_word_array.inspect)</code> will never be true. <code>@correct_tries</code> is a numerical value and <code>hangman_word_array.inspect</code> will return the array of words for hangman in a string format (e.g. <code>hangman_word_array = ['a', 'b', 'c']</code> then <code>hangman_word_array.inspect</code> will be <code>\"[\\\"a\\\", \\\"b\\\", \\\"c\\\"]\"</code>. </p>\n"}], "owner": {"reputation": 13, "user_id": 6452234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf6j1.jpg?s=128&g=1", "display_name": "Clueless", "link": "https://stackoverflow.com/users/6452234/clueless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476928034, "creation_date": 1476916922, "last_edit_date": 1476928034, "question_id": 40142679, "link": "https://stackoverflow.com/questions/40142679/how-do-i-get-the-elsif-for-correct-tries-to-work-properly", "title": "How do I get the elsif for @correct_tries to work properly?", "body": "<p>My first hangman game from scratch is almost done with the real basic stuff. I just need a counter for when a player gets it right to work correctly. I haven't figured out a good way to do it without deleting everything and starting over.\nthe @correct_tries counts correctly then in the elsif compare the numerical value to the number of elements in the given word that were answered correctly. </p>\n\n<p>It'll keep counting when it should have stopped when @correct_tries was compared to the number when .inspect happens on the array. But it keeps counting.</p>\n\n<pre><code>class Hangman\n\nProfanity = ['cobol','snit','crap','court']\nAdjective = ['foul','repugnant','swift','fast'] \nNoun = ['king','queen','prince','princess']\n\n\n    def self.start_game\n      print \"Welcome to Hangman V1 by Clueless! Please select which category of words do you want to use:   \\n Profanity, Adjective, Noun \"\n      @selection = gets.chomp.downcase\n      case \n      when @selection == 'profanity'\n        puts 'You have selected profanity! '\n        hangman_word_selection\n     when @selection == 'adjective'\n       puts 'You have selected Adjectives! '\n        hangman_word_selection\n    when @selection == 'noun'\n      puts 'You have selected nouns! '   \n          hangman_word_selection\n     end \n     end\n\n    def self.hangman_word_selection\n\n     if @selection == 'profanity'\n       hangman_word = Profanity.sample\n       hangman_word_setup(hangman_word)\n       #puts '_ ' * hangman_word.size\n     elsif @selection == 'adjective'\n       hangman_word = Adjective.sample\n       hangman_word_setup(hangman_word)\n     elsif\n            @selection == 'noun'\n       hangman_word = Noun.sample\n       hangman_word_setup(hangman_word)\n\n    end\nend\n\n  def self.hangman_word_setup(hangman_word)\n  hangman_word_array = hangman_word.chars.to_a\n   @hangman_end = false\n   #while(@hangman_end == false)\n    #puts \"*\" * 40\n    #puts \n    #puts\n    puts 'You have five tries to get the word correct. If you can guess the whole word do so but you only have one try. Or just guess letter by letter.'\n    p hangman_word_array\n    @total_tries = 0\n    @correct_tries = 0\n    game_check = true\n\n    while game_check == true\n    first_try = gets.chomp.downcase\n\n\n\n   if(first_try == hangman_word_array[0] || first_try == hangman_word_array[1] || first_try == hangman_word_array[2] || first_try == hangman_word_array[3] || first_try == hangman_word_array[4])\n     puts 'Check'\n     @correct_tries += 1\n     p @correct_tries\n     #correct tries equal to the number of chars in the given word check it.\n    puts 'You have gotten it correct!'\n    elsif(first_try == hangman_word)\n     puts 'You have completed the word! Congratulations you win!'\n              hangman_win\n              break\n     elsif(first_try != hangman_word_array)\n     puts  'Wrong.'\n               @total_tries += 1\n               p  @total_tries\n           #puts \"*\" * 40\n      elsif(@correct_tries == hangman_word_array.inspect)\n              puts 'done.'\n              break\n\n\n    end\n    end\n     end\n\n\n\n  def self.hangman_loss\n    puts ' +---+-\n               |   |\n               |   0\n               |   |\\\\\n               |   /\\\\\n              -+----------'\n\n  puts 'You lose!'            \n  end\n\n\n  def self.hangman_win\n\n    puts 'NEED HANGMAN VICTORY POSE HERE.'\n\n  end \n\nstart_game\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "minify"], "answers": [{"comments": [{"owner": {"reputation": 1151, "user_id": 641127, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a24bf6f324701c1ffe7180b036e536f?s=128&d=identicon&r=PG", "display_name": "Gavin Ballard", "link": "https://stackoverflow.com/users/641127/gavin-ballard"}, "edited": false, "score": 1, "creation_date": 1477111739, "post_id": 40147111, "comment_id": 67643920, "body": "Hi Luke, thanks for the very detailed answer and the level of effort you went to! Unfortunately, I&#39;m after something that&#39;s still executable Ruby code when minified - sorry if that wasn&#39;t clear in the question. Similar to how minification works for Javascript or CSS files."}], "tags": [], "owner": {"reputation": 3360, "user_id": 3208553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tjyir.png?s=128&g=1", "display_name": "Luke Schoen", "link": "https://stackoverflow.com/users/3208553/luke-schoen"}, "is_accepted": false, "score": 3, "last_activity_date": 1476947538, "last_edit_date": 1476947538, "creation_date": 1476945471, "answer_id": 40147111, "question_id": 40142307, "link": "https://stackoverflow.com/questions/40142307/how-can-i-minify-a-ruby-source-file/40147111#40147111", "title": "How can I minify a Ruby source file?", "body": "<p>I created a <a href=\"https://github.com/ltfschoen/RubyTest/tree/master/minify_and_obfuscate_ruby\" rel=\"nofollow\">simple script that reads a Ruby file, generates a minified and obfuscated version, and then interprets the output to regenerate it again</a>. I created a Ruby file and used command expansion to run a Shell script that may be executed with <code>ruby main.rb</code>:</p>\n\n<h1>main.rb</h1>\n\n<pre><code>class MinifyAndObfuscateRuby\n    def initialize(shell_script=\"./main.sh\")\n    @shell_script = shell_script\n    run_shell_script\n  end\n\n  private\n\n  def run_shell_script\n    %x[sh #{@shell_script}]\n  end\nend\n</code></pre>\n\n<p>I wrote the Shell script, which takes an input Ruby source file and generates an output file based on the input. Optionally you can just run this directly with with <code>sh main.sh</code> (instead of using the <code>main.rb</code> wrapper that I added for testing with RSpec). Note that most of the main.sh code shared in the repository is shown below, but for brevity I have omitted details of the <code>recover_source</code> function, which tries to re-generate the original Ruby source file in a second output file. </p>\n\n<h1>main.sh</h1>\n\n<pre><code>#!/bin/bash\n\n# Purpose: Simple script that reads a Ruby file, generates a minified and \n# obfuscated version, and then interprets the output to regenerate it again. \n# Execute either by running `main.rb` Ruby file (uses command expansion to run this Shell script)\n# with `ruby main.rb` or with directly with `sh main.sh`. Outputs are automatically\n# generated in an ./outputs subdirectory.\n\n# declare and instantiate variables\nMINLEN=0 # optionally exclude iteration of blank lines when MINLENGTH is 1\ninput_file=\"./source.rb\"\nreverse=\"\"\noutput_file=\"./outputs/output_minified_and_obfuscated.min.rb\"\noutput_file_recovered=\"./outputs/output_unminified_and_unobfuscated.rb\"\n\n# obfuscate: by reversing each line\nfunction obfuscate {\n    for (( i=$len-1; i&gt;=0; i-- )); do\n        reverse=\"$reverse${line:$i:1}\"\n    done\n    reverse+=\"\\n\"\n}\n\n# minify: find instances of the tuple keys in the variable containing the\n# reversed input file string and replace with respective tuple values\nfunction minify {\n    find_data='eriuqer;*r* fed;*d* dne;*e* edulcni;*i* ssalc;*c* redaer_rtta;*ar*'; \n    for tuple in $find_data; do\n        key=$(echo $tuple | cut -d ';' -f 1); \n        value=$(echo $tuple | cut -d ';' -f 2); \n        reverse=${reverse/$key/$value} \n    done\n}\n\nfunction process_source {\n    # read lines from input file\n    while IFS= read -r line || [ -n \"$line\" ]; do\n        len=${#line}\n        if [ \"$len\" -ge \"$MINLEN\" ]; then\n            obfuscate\n            minify\n        fi\n    done &lt; \"$input_file\"\n\n  echo \"$output_file not found. Creating $output_file and adding minified and obfuscated contents\"\n  ! [[ -d \"outputs\" ]] &amp;&amp; mkdir outputs\n  touch $output_file\n  echo $reverse &gt;&gt; $output_file\n}\n\n# check if output Ruby file already exists and if so regenerate source, otherwise create it\nif [ -f \"$output_file\" ] &amp;&amp; ! [ -f \"$output_file_recovered\" ]; then\n  echo \"$output_file already exists.\"\n  recover_source # see source code for details of this method\n  exit 0\nelif [ -f \"$input_file\" ] &amp;&amp; ! [ -f \"$output_file_recovered\" ]; then\n    process_source\n    exit 0\nelse\n    echo \"$output_file and $output_file_recovered have both already been generated.\"\n    echo \"Deleted temporary files and restarting process...\"\n    [ -f \"$output_file\" ] &amp;&amp; rm -f \"$output_file\"\n    [ -f \"$output_file_recovered\" ] &amp;&amp; rm -f \"$output_file_recovered\"\n    [ -d \"outputs\" ] &amp;&amp; rmdir outputs\n    exit 0\nfi\n</code></pre>\n\n<p>The example source code file I used is shown below:</p>\n\n<h1>source.rb</h1>\n\n<pre><code>require 'bigdecimal'\n\nclass Obfiscate\n    include Comparable\n\n  attr_reader :name\n\n  def initialize(name)\n    @name = name\n  end\nend\n</code></pre>\n\n<p>It applies a degree of obfuscation by reversing each line in the source file and uses regular expressions replace Ruby syntax with my own custom abbreviations (i.e. replace <code>require</code> with <code>*r*</code>, <code>class</code> with <code>*c*</code>, <code>attr_accessor</code> with <code>*ar*</code>, <code>def</code> with <code>*d*</code>, and <code>end</code> with <code>*e*</code>) to reduce the overall character count and optionally remove blank lines as shown in sample output below:</p>\n\n<h1>./outputs/output_minified_and_obfuscated.min.rb</h1>\n\n<pre><code>'lamicedgib' *r*\netacsifbO *c*\nelbarapmoC \neman: *ar*\n)eman(ezilaitini *d* \neman = eman@ \n*e* \n*e*\n</code></pre>\n"}], "owner": {"reputation": 1151, "user_id": 641127, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a24bf6f324701c1ffe7180b036e536f?s=128&d=identicon&r=PG", "display_name": "Gavin Ballard", "link": "https://stackoverflow.com/users/641127/gavin-ballard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1476947538, "creation_date": 1476914775, "question_id": 40142307, "link": "https://stackoverflow.com/questions/40142307/how-can-i-minify-a-ruby-source-file", "title": "How can I minify a Ruby source file?", "body": "<p>I have a situation where I'd like to be able to <strong>minify</strong> (not compile) a Ruby script. The goals are to:</p>\n\n<ol>\n<li>Reduce the overall character count of the script;</li>\n<li>Perform a degree of obfuscation to make it difficult for others to modify the code.</li>\n</ol>\n\n<p>We can assume that:</p>\n\n<ol>\n<li>Yes, I know what I'm doing, and I really do want to minify and obfuscate the code.</li>\n<li>The source Ruby code has a simple syntax and doesn't use any advanced metaprogramming techniques or the like.</li>\n</ol>\n\n<p>Is there any existing library or tool for this? If not, what would be the best way to get started to develop a simple minifier (ideally, also written in Ruby)?</p>\n"}, {"tags": ["ruby", "rubygems", "require"], "comments": [{"owner": {"reputation": 22303, "user_id": 2456433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiN8K.jpg?s=128&g=1", "display_name": "infused", "link": "https://stackoverflow.com/users/2456433/infused"}, "edited": false, "score": 0, "creation_date": 1476914219, "post_id": 40142041, "comment_id": 67554303, "body": "If you just did a <code>gem install priority_queue</code> then you&#39;re getting this repo: <a href=\"https://github.com/ninjudd/priority_queue\" rel=\"nofollow noreferrer\">github.com/ninjudd/priority_queue</a> which doesn&#39;t have a <code>push</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "is_accepted": false, "score": 0, "last_activity_date": 1476914321, "creation_date": 1476914321, "answer_id": 40142196, "question_id": 40142041, "link": "https://stackoverflow.com/questions/40142041/ruby-undefined-method-while-using-priorityqueue/40142196#40142196", "title": "Ruby undefined method while using PriorityQueue", "body": "<p>The gem you linked do is (a fork of) the <a href=\"https://rubygems.org/gems/PriorityQueue\" rel=\"nofollow\"><code>PriorityQueue</code></a> gem, not the <a href=\"https://rubygems.org/gems/priority_queue\" rel=\"nofollow\"><code>priority_queue</code></a> gem. You need <code>gem install PriorityQueue</code>.</p>\n\n<p>I realize that the repository you linked to <em>says</em> <code>gem install priority_queue</code> in the readme, but, that does not appear to be correct. The <code>priority_queue</code> gem is from <a href=\"https://github.com/ninjudd/priority_queue\" rel=\"nofollow\">a different repository</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7044688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fab43af91d9706ef789cd8adc481a950?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/7044688/maki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476914321, "creation_date": 1476913561, "last_edit_date": 1592644375, "question_id": 40142041, "link": "https://stackoverflow.com/questions/40142041/ruby-undefined-method-while-using-priorityqueue", "title": "Ruby undefined method while using PriorityQueue", "body": "<p>I'm trying to use a priorityQueue from <a href=\"https://github.com/ldonnet/priority_queue\" rel=\"nofollow noreferrer\">https://github.com/ldonnet/priority_queue</a> on ruby, after installing it with <code>gem install priority_queue</code>, i'm having the error :</p>\n<pre><code>./example.rb:5:in `&lt;main&gt;': undefined method `push' for #&lt;PriorityQueue:0x000000015ca200 @queues={}&gt; (NoMethodError)\n</code></pre>\n<p>When trying to run an example of the README.md file :</p>\n<pre><code>#!/usr/bin/ruby\nrequire 'priority_queue'\n\nq = PriorityQueue.new\nq.push &quot;node1&quot;, 0 \nq.push &quot;node2&quot;, 1\n\nq.min #=&gt; &quot;node1&quot;\n\nq.decrease_priority(&quot;node2&quot;, -1)\n\nq.pop_min #=&gt; &quot;node2&quot;\nq.min     #=&gt; &quot;node1&quot;\n</code></pre>\n<p>ruby version : <code>ruby 1.9.3p484 (2013-11-22 revision 43786) [x86_64-linux]</code></p>\n<p>Thank you</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu", "bundle", "bundler"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 1, "creation_date": 1476915015, "post_id": 40141840, "comment_id": 67554597, "body": "<code>gem install bundler</code> :)"}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476921026, "post_id": 40141840, "comment_id": 67556535, "body": "Should it be juist &quot;gem install&quot; or &quot;sudo gem install&quot;?  I get teh error &quot;You don&#39;t have write permissions for the /usr/local/rvm/gems/ruby-2.2.1 directory.&quot; when I run that command"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476922450, "post_id": 40141840, "comment_id": 67556856, "body": "Always try it without the <code>sudo</code> if you can. Looks like you may need to fix that error before proceeding - as I recall (from the dim, dark past when I first set up my Ubuntu box) there&#39;s something you need to <code>chmod</code> to make it work. I&#39;d google for the error message."}, {"owner": {"reputation": 1680, "user_id": 194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c93bba200ad6c7c64e8ec07b44e254ac?s=128&d=identicon&r=PG", "display_name": "Raphael", "link": "https://stackoverflow.com/users/194932/raphael"}, "edited": false, "score": 0, "creation_date": 1476925185, "post_id": 40141840, "comment_id": 67557506, "body": "Your system is confusing two different ruby installs, one system wide and one user only.   Did you install ruby 2.2.2 with rvm or rbenv?"}, {"owner": {"reputation": 415, "user_id": 3328921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9386ab49bea2f95ab84eb048aee4863a?s=128&d=identicon&r=PG&f=1", "display_name": "archon92", "link": "https://stackoverflow.com/users/3328921/archon92"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476961400, "post_id": 40141840, "comment_id": 67573952, "body": "Follow @Taryn East&#39;s answer"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 866, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476912658, "creation_date": 1476912658, "question_id": 40141840, "link": "https://stackoverflow.com/questions/40141840/running-bundle-install-gives-could-not-find-bundler-0-amongst-error-on", "title": "Running &quot;bundle install&quot; gives &quot;Could not find bundler (&gt;= 0) amongst&quot; error on Ubuntu", "body": "<p>I\u2019m using Ubuntu.  I just upgraded my Ruby version, or at least I thought I did \u2026</p>\n\n<pre><code>myuser@myproject:~/myproject$ ruby -v\nruby 2.2.2p95 (2015-04-13 revision 50295) [x86_64-linux]\n</code></pre>\n\n<p>However when I try and run \u201cbundle install,\u201d I get some crazy errors, none of which I understand \u2026</p>\n\n<pre><code>myuser@myproject:~/myproject$ bundle install\n/usr/lib/ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find bundler (&gt;= 0) amongst [bundler-unload-1.0.2, executable-hooks-1.3.2, gem- wrappers-1.2.7, minitest-5.4.3, power_assert-0.2.2, rubygems-bundler-1.4.4, rvm-1.11.3.9, test-unit-3.0.8] (Gem::LoadError)\n    from /usr/lib/ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'\n    from /usr/lib/ruby/1.9.1/rubygems.rb:1231:in `gem'\n    from /usr/local/bin/bundle:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>Ditto when I try and run a simple \u201cbundle update\u201d \u2026</p>\n\n<pre><code>myuser@myproject:~/myproject$ bundle update\n/usr/lib/ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find bundler (&gt;= 0) amongst [bundler-unload-1.0.2, executable-hooks-1.3.2, gem- wrappers-1.2.7, minitest-5.4.3, power_assert-0.2.2, rubygems-bundler-1.4.4, rvm-1.11.3.9, test-unit-3.0.8] (Gem::LoadError)\n    from /usr/lib/ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'\n    from /usr/lib/ruby/1.9.1/rubygems.rb:1231:in `gem'\n    from /usr/local/bin/bundle:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>What do I need to do to get \u201cbundle install\u201d and \u201cbundle update\u201d working?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3", "aws-sdk-ruby"], "comments": [{"owner": {"reputation": 257, "user_id": 2097533, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa2235c63eaec157781528f7610821ab?s=128&d=identicon&r=PG", "display_name": "Stefan Lyew", "link": "https://stackoverflow.com/users/2097533/stefan-lyew"}, "edited": false, "score": 0, "creation_date": 1476976007, "post_id": 40141630, "comment_id": 67585084, "body": "similar question: <a href=\"http://stackoverflow.com/questions/39466716/how-do-i-get-the-aws-s3-website-endpoint-url-through-the-api\" title=\"how do i get the aws s3 website endpoint url through the api\">stackoverflow.com/questions/39466716/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": false, "score": 2, "last_activity_date": 1476930185, "creation_date": 1476930185, "answer_id": 40144419, "question_id": 40141630, "link": "https://stackoverflow.com/questions/40141630/how-can-you-programmatically-get-the-endpoint-value-of-the-root-domain-for-an-s3/40144419#40144419", "title": "How can you programmatically get the endpoint value of the root domain for an S3 Bucket (static website) that was assigned by AWS via the SDK?", "body": "<p>The value doesn't appear to be exposed by the S3 API, itself.</p>\n\n<p>It is, however, easily derived from the bucket location, which is accessible <a href=\"http://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGETlocation.html\" rel=\"nofollow\">via the S3 REST API</a>, though it isn't obvious from skimming the docs whether this is implemented in the Ruby SDK, either, in spite of its presence in the underlying API. I didn't find it.</p>\n\n<p>But the web site endpoints are always in this form:</p>\n\n<pre><code>${bucket}.s3-website-${region}.amazonaws.com\n</code></pre>\n\n<p>In us-east-1, as shown in the screen shot, the endpoint for a bucket named <code>example.com</code> fits this pattern, <code>example.com.s3-website-us-east-1.amazonaws.com</code>.</p>\n\n<p><a href=\"http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region\" rel=\"nofollow\">http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region</a></p>\n"}], "owner": {"reputation": 257, "user_id": 2097533, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aa2235c63eaec157781528f7610821ab?s=128&d=identicon&r=PG", "display_name": "Stefan Lyew", "link": "https://stackoverflow.com/users/2097533/stefan-lyew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491280742, "creation_date": 1476911612, "last_edit_date": 1491280742, "question_id": 40141630, "link": "https://stackoverflow.com/questions/40141630/how-can-you-programmatically-get-the-endpoint-value-of-the-root-domain-for-an-s3", "title": "How can you programmatically get the endpoint value of the root domain for an S3 Bucket (static website) that was assigned by AWS via the SDK?", "body": "<p>For example: example.com.s3-website-us-east-1.amazonaws.com?</p>\n\n<p><a href=\"https://i.stack.imgur.com/DE8KO.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/DE8KO.png\" alt=\"Here is the value in the GUI\"></a></p>\n\n<p>How can I get this value programmatically via the SDK?  I can't seem to find it:</p>\n\n<p>link to docs:  <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/S3.html\" rel=\"nofollow\">http://docs.aws.amazon.com/sdkforruby/api/Aws/S3.html</a></p>\n"}, {"tags": ["ruby", "eclipse", "selenium", "firefox", "geckodriver"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1476910603, "post_id": 40141242, "comment_id": 67552689, "body": "Try FF 49.0.1.  That&#39;s what&#39;s working for me."}, {"owner": {"reputation": 69, "user_id": 4686146, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/037213b2f82c7f251e694275b72e3d18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe12", "link": "https://stackoverflow.com/users/4686146/joe12"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1477066421, "post_id": 40141242, "comment_id": 67629690, "body": "@orde ,mine is 49.0.2 the latest and i am still getting the same issue.Any suggestions?"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1477067911, "post_id": 40141242, "comment_id": 67630504, "body": "Does it work when you run via command line/terminal (instead of Eclipse)?"}, {"owner": {"reputation": 69, "user_id": 4686146, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/037213b2f82c7f251e694275b72e3d18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe12", "link": "https://stackoverflow.com/users/4686146/joe12"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1477078863, "post_id": 40141242, "comment_id": 67636123, "body": "@orde ,it still opens a blank page and skype extension in another tab when run through command line."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1477613358, "post_id": 40141242, "comment_id": 67850515, "body": "Without a stacktrace or more information, it&#39;s hard to say why that&#39;s happening."}, {"owner": {"reputation": 69, "user_id": 4686146, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/037213b2f82c7f251e694275b72e3d18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe12", "link": "https://stackoverflow.com/users/4686146/joe12"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1478038854, "post_id": 40141242, "comment_id": 67992655, "body": "@orde, what type of information do you need"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1478043302, "post_id": 40141242, "comment_id": 67994046, "body": "Not sure.  I can&#39;t repro using <code>selenium-webdriver (3.0.0)</code>, <code>watir-webdriver (0.9.3)</code>, and <code>geckodriver v0.11.1</code>.  If it just hangs and there&#39;s no error message(s), there&#39;s unfortunately not much to go on."}, {"owner": {"reputation": 69, "user_id": 4686146, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/037213b2f82c7f251e694275b72e3d18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe12", "link": "https://stackoverflow.com/users/4686146/joe12"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1478114966, "post_id": 40141242, "comment_id": 68028104, "body": "@orde, This is the url of the tab that it opens up &quot;<a href=\"https://support.skype.com/en/faq/FA34612/what-is-the-skype-extension\" rel=\"nofollow noreferrer\">support.skype.com/en/faq/FA34612/what-is-the-skype-extensio&zwnj;&#8203;n</a>&quot;"}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1478130241, "post_id": 40141242, "comment_id": 68034871, "body": "Okey dokey.  Uninstall the skype extension, and see what happens."}], "owner": {"reputation": 69, "user_id": 4686146, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/037213b2f82c7f251e694275b72e3d18?s=128&d=identicon&r=PG&f=1", "display_name": "Joe12", "link": "https://stackoverflow.com/users/4686146/joe12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1477078903, "creation_date": 1476910021, "last_edit_date": 1477078903, "question_id": 40141242, "link": "https://stackoverflow.com/questions/40141242/firefox-opening-blank-page-when-launching-browser", "title": "Firefox opening blank page when launching browser", "body": "<p>Firefox opening blank page when launching browser using Selenium Eclipse with Ruby.</p>\n\n<pre><code>require \"selenium-webdriver\"\ndriver = Selenium::WebDriver.for :firefox\ndriver.navigate.to \"http://google.com\"\n</code></pre>\n\n<p>Version selenium 3.0, Firefox 49.0.2, Geckodriver latest</p>\n"}, {"tags": ["ruby", "encryption", "binary", "hex"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1476906780, "post_id": 40139949, "comment_id": 67550640, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17623668/what-does-string-packh-mean\">What does &#91;&quot;string&quot;&#93;.pack(&#39;H*&#39;) mean?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476906462, "post_id": 40140012, "comment_id": 67550447, "body": "I think it&#39;s just <code>[str].pack(&#39;H*&#39;)</code>"}], "tags": [], "owner": {"reputation": 2548, "user_id": 2400454, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iEfZ3.jpg?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/2400454/jay"}, "is_accepted": true, "score": 6, "last_activity_date": 1476908749, "last_edit_date": 1476908749, "creation_date": 1476905422, "answer_id": 40140012, "question_id": 40139949, "link": "https://stackoverflow.com/questions/40139949/how-to-convert-a-hexadecimal-string-back-to-its-securerandom-random-bytes-bin/40140012#40140012", "title": "How to convert a hexadecimal string back to it&#39;s &#39;SecureRandom.random_bytes&#39; binary?", "body": "<p>Is this what you are looking for?</p>\n\n<pre><code>[str].pack('H*').bytes.to_a\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>[str].pack('H*')\n</code></pre>\n"}], "owner": {"reputation": 1605, "user_id": 1413388, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/658c9476fcc0f26dde65dfd5edfe1f93?s=128&d=identicon&r=PG", "display_name": "Cjoerg", "link": "https://stackoverflow.com/users/1413388/cjoerg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 40140012, "answer_count": 1, "score": 1, "last_activity_date": 1476908749, "creation_date": 1476905204, "question_id": 40139949, "link": "https://stackoverflow.com/questions/40139949/how-to-convert-a-hexadecimal-string-back-to-its-securerandom-random-bytes-bin", "title": "How to convert a hexadecimal string back to it&#39;s &#39;SecureRandom.random_bytes&#39; binary?", "body": "<p>In Ruby, I can create a 16 byte binary and convert it to a hexadecimal string:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>key     = SecureRandom.random_bytes(16)                    # =&gt; \"hN\\xDB\\xAD\\xAF\\xB3R\\xC0`\\xB19\\x1D\\x19.\\xD3I\"\nhex_key = key.each_byte.map { |byte| '%02x' % byte }.join  # =&gt; \"684edbadafb352c060b1391d192ed349\"\n</code></pre>\n\n<p>In PHP and Javascript I can convert the the hexadecimal string back to it's 16 byte binary.</p>\n\n<p>PHP:</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>&lt;?php\nhex2bin(\"684edbadafb352c060b1391d192ed349\");\n?&gt;\n</code></pre>\n\n<p>Javascript <a href=\"https://code.google.com/archive/p/crypto-js/wikis/QuickStartGuide_v3beta.wiki\" rel=\"nofollow\">via CryptoJS</a>:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>CryptoJS.enc.Hex.parse(\"684edbadafb352c060b1391d192ed349\");\n</code></pre>\n\n<p>But how do I convert the hexadecimal string back to it's 16 byte binary, using Ruby?</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe", "chef-solo", "cookbook"], "comments": [{"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1476906111, "post_id": 40139809, "comment_id": 67550250, "body": "You won&#39;t really save all that much time; chown is pretty fast. Why does it matter?"}, {"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "reply_to_user": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "edited": false, "score": 0, "creation_date": 1476906930, "post_id": 40139809, "comment_id": 67550724, "body": "when the directory is empty, the command doesn&#39;t work and throws an error"}, {"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476950570, "post_id": 40139809, "comment_id": 67566644, "body": "The error is what?"}, {"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476950602, "post_id": 40139809, "comment_id": 67566658, "body": "Regarding &quot;chmod is fast&quot;, please read about <a href=\"http://stackoverflow.com/questions/30615588/difference-between-convergence-and-idempotency-in-chef\">idempotency</a>"}, {"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476950956, "post_id": 40139809, "comment_id": 67566839, "body": "Does the error occur, if the directory does not exist?"}], "answers": [{"comments": [{"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476950549, "post_id": 40141254, "comment_id": 67566629, "body": "This is a pretty bad style from the point of idempotence (the reason, why @meallhour is looking for a valid guard)."}, {"owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "reply_to_user": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476958072, "post_id": 40141254, "comment_id": 67571813, "body": "@StephenKing Thanks for the bike shedding. Please look up &quot;convergence.&quot; I won&#39;t argue it further, but you&#39;re welcome to leave your own answer for the OP."}, {"owner": {"reputation": 30536, "user_id": 400222, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75febe3a9bd5b1ad9cb63fceccb6aa31?s=128&d=identicon&r=PG", "display_name": "StephenKing", "link": "https://stackoverflow.com/users/400222/stephenking"}, "edited": false, "score": 0, "creation_date": 1476958325, "post_id": 40141254, "comment_id": 67571990, "body": "I could not reproduce the problem within the time I had. That&#39;s why I didn&#39;t leave an answer. As you seemed to be not aware of this aspect of chef, I tried to make you aware of that as friendly as possible."}], "tags": [], "owner": {"reputation": 71199, "user_id": 1301972, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/T5G7N.jpg?s=128&g=1", "display_name": "Todd A. Jacobs", "link": "https://stackoverflow.com/users/1301972/todd-a-jacobs"}, "is_accepted": false, "score": -2, "last_activity_date": 1476910078, "creation_date": 1476910078, "answer_id": 40141254, "question_id": 40139809, "link": "https://stackoverflow.com/questions/40139809/how-to-not-execute-chef-resource-if-directory-is-empty/40141254#40141254", "title": "How to not execute chef resource if directory is empty?", "body": "<p>Just close standard error. For example:</p>\n\n<pre><code>execute 'chown a directory' do\n  command 'chown -R user:group /path/to/directory 2&gt;&amp;-'\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 2601773, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000861105780/picture?type=large", "display_name": "Sradhu Anand", "link": "https://stackoverflow.com/users/2601773/sradhu-anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1477521473, "last_edit_date": 1477521473, "creation_date": 1477054482, "answer_id": 40177229, "question_id": 40139809, "link": "https://stackoverflow.com/questions/40139809/how-to-not-execute-chef-resource-if-directory-is-empty/40177229#40177229", "title": "How to not execute chef resource if directory is empty?", "body": "<p>Try this:</p>\n\n<pre><code>not_if { Dir.entries(\"/home/user/dir1/\").select {|entry| ::File.join(\"home\",\"user\",\"dir1\",entry) and !(entry =='.' || entry == '..') }.empty? }\n</code></pre>\n"}], "owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 805, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1477521473, "creation_date": 1476904702, "question_id": 40139809, "link": "https://stackoverflow.com/questions/40139809/how-to-not-execute-chef-resource-if-directory-is-empty", "title": "How to not execute chef resource if directory is empty?", "body": "<p>I have a resource that looks as below:</p>\n\n<pre><code>execute 'run_command' do\n  command \"chown -R user:user * \"\n  not_if Dir[\"/home/user/dir1/*\"].empty?\nend\n</code></pre>\n\n<p>I want to make sure that the resource is not executed if <code>/home/user/dir1</code> is empty</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "enums"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1476903632, "post_id": 40139352, "comment_id": 67548800, "body": "what&#39;s the error? did you check the validation result on the model for a clue?"}, {"owner": {"reputation": 9160, "user_id": 1300194, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/oBkyV.jpg?s=128&g=1", "display_name": "Awlad Liton", "link": "https://stackoverflow.com/users/1300194/awlad-liton"}, "edited": false, "score": 0, "creation_date": 1476904301, "post_id": 40139352, "comment_id": 67549215, "body": "looks like your parameter is not correct. role should be inside the hash of  company. your view is not right. Check  form <code>select</code>."}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476904523, "post_id": 40139352, "comment_id": 67549347, "body": "No error, it just begins, commits transaction without any value updated in database and then redirects to dashboard_path. I have removed any enum validation from model."}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476904420, "post_id": 40139632, "comment_id": 67549286, "body": "&lt;option value= .. &gt; is needed for Bootstrap, not related to the error I have. Do you have any idea, why I cannot save enum?"}, {"owner": {"reputation": 9160, "user_id": 1300194, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/oBkyV.jpg?s=128&g=1", "display_name": "Awlad Liton", "link": "https://stackoverflow.com/users/1300194/awlad-liton"}, "reply_to_user": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476904521, "post_id": 40139632, "comment_id": 67549346, "body": "@matiss  what do you mean by &quot;needed for Bootstrap&quot; ?"}, {"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476904699, "post_id": 40139632, "comment_id": 67549430, "body": "Well, I&#39;m using Inspinia admin theme and as I understand it&#39;s how I can get all the styling there. At lease by using &lt;option value= ..&gt; I get nice drop-downs :)"}, {"owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "reply_to_user": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476905260, "post_id": 40139632, "comment_id": 67549738, "body": "@matiss You need to add a class (&#39;m-b&#39;) to f.select."}], "tags": [], "owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "is_accepted": false, "score": 1, "last_activity_date": 1476905001, "last_edit_date": 1476905001, "creation_date": 1476904123, "answer_id": 40139632, "question_id": 40139352, "link": "https://stackoverflow.com/questions/40139352/rails-5-enum-from-select-not-saved-on-update/40139632#40139632", "title": "Rails 5: enum from select not saved on update", "body": "<p>This looks really weird to me.</p>\n\n<pre><code>&lt;option value=&lt;%= f.select :role, Company.roles.keys.to_a, class: 'form-control' %&gt;&lt;/option&gt;\n</code></pre>\n\n<p>You can generate drop-down by simply writing this. You have to add class to the f.select to get the style you need.</p>\n\n<pre><code>&lt;%= f.select :role, Company.roles.keys.to_a, {}, class: 'form-control m-b' %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476905165, "post_id": 40139832, "comment_id": 67549686, "body": "Yes, you are right. I removed &lt;option value= .. &gt; and it works now. I will need to figure out how to get those nice drop-downs, but that&#39;s another story. Thank you for helping! Rails community the best :)"}, {"owner": {"reputation": 9160, "user_id": 1300194, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/oBkyV.jpg?s=128&g=1", "display_name": "Awlad Liton", "link": "https://stackoverflow.com/users/1300194/awlad-liton"}, "reply_to_user": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "edited": false, "score": 0, "creation_date": 1476905235, "post_id": 40139832, "comment_id": 67549720, "body": "<a href=\"http://stackoverflow.com/questions/21197138/how-to-add-a-class-to-select-tag-in-ruby-on-rails\" title=\"how to add a class to select tag in ruby on rails\">stackoverflow.com/questions/21197138/&hellip;</a> look at the last answer. You can add class in the select and also in the option."}], "tags": [], "owner": {"reputation": 9160, "user_id": 1300194, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/oBkyV.jpg?s=128&g=1", "display_name": "Awlad Liton", "link": "https://stackoverflow.com/users/1300194/awlad-liton"}, "is_accepted": true, "score": 2, "last_activity_date": 1476906050, "last_edit_date": 1476906050, "creation_date": 1476904794, "answer_id": 40139832, "question_id": 40139352, "link": "https://stackoverflow.com/questions/40139352/rails-5-enum-from-select-not-saved-on-update/40139832#40139832", "title": "Rails 5: enum from select not saved on update", "body": "<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"5mjLbYZH6tJWOympfEApF2EwbR/Nk4cQFvqtCiXhL3hOIs+yOQGbZUaIFqO42aMyUWr3JdX+dYQU4Arkpy3jrQ==\", \n\"company\"=&gt;{\"name\"=&gt;\"Agency 8\", \"legal_name\"=&gt;\"agency No8 SIA\", \"reg_number\"=&gt;\"123456789\", \"address\"=&gt;\"street 8\", \"bank_acc\"=&gt;\"123456789\", \"description\"=&gt;\"Super agency\", \n\"website\"=&gt;\"www.google.com\"}, \"role\"=&gt;\"seller_buyer\", \"commit\"=&gt;\"Save\", \"id\"=&gt;\"13\"}\n</code></pre>\n\n<p>Look at the <code>\"role\"=&gt;\"seller_buyer\"</code> it is out side of <code>company</code> hash. It should be like this:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"5mjLbYZH6tJWOympfEApF2EwbR/Nk4cQFvqtCiXhL3hOIs+yOQGbZUaIFqO42aMyUWr3JdX+dYQU4Arkpy3jrQ==\", \n    \"company\"=&gt;{\"name\"=&gt;\"Agency 8\", \"legal_name\"=&gt;\"agency No8 SIA\", \"reg_number\"=&gt;\"123456789\", \"address\"=&gt;\"street 8\", \"bank_acc\"=&gt;\"123456789\", \"description\"=&gt;\"Super agency\", \n    \"website\"=&gt;\"www.google.com\", \"role\"=&gt;\"seller_buyer\"}, \"commit\"=&gt;\"Save\", \"id\"=&gt;\"13\"}\n</code></pre>\n\n<p>it is happening because your form input is not correctly generated. You should not be use select inside option. <code>select</code> will generate options by the given array(<code>Company.roles.keys.to_a</code>).</p>\n\n<p><strong>Edit:</strong>\nThis should fix your design issue:</p>\n\n<pre><code>&lt;%= f.select :role, options_for_select(Company.roles.keys.to_a, class: 'form-control'),{},{class:\"form-control m-b\"} %&gt;\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 6873497, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7e17e7b7f298bbf51382bd565add516a?s=128&d=identicon&r=PG&f=1", "display_name": "matiss", "link": "https://stackoverflow.com/users/6873497/matiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1285, "favorite_count": 0, "accepted_answer_id": 40139832, "answer_count": 2, "score": 0, "last_activity_date": 1477750816, "creation_date": 1476903069, "last_edit_date": 1477750816, "question_id": 40139352, "link": "https://stackoverflow.com/questions/40139352/rails-5-enum-from-select-not-saved-on-update", "title": "Rails 5: enum from select not saved on update", "body": "<p>I'm trying to update/save enum in database, however <strong>seems it is not passing as param correctly</strong>. \nOn Update paramters are passed, except \"role\" (used as enum) which seems to be outside of hash (3rd line):   </p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"5mjLbYZH6tJWOympfEApF2EwbR/Nk4cQFvqtCiXhL3hOIs+yOQGbZUaIFqO42aMyUWr3JdX+dYQU4Arkpy3jrQ==\", \n\"company\"=&gt;{\"name\"=&gt;\"Agency 8\", \"legal_name\"=&gt;\"agency No8 SIA\", \"reg_number\"=&gt;\"123456789\", \"address\"=&gt;\"street 8\", \"bank_acc\"=&gt;\"123456789\", \"description\"=&gt;\"Super agency\", \n\"website\"=&gt;\"www.google.com\"}, \"role\"=&gt;\"seller_buyer\", \"commit\"=&gt;\"Save\", \"id\"=&gt;\"13\"}\n</code></pre>\n\n<p>In <em>/common/companies_controller.rb</em> I have this:</p>\n\n<pre><code>def edit\n@company = Company.find(params[:id])\nend\n\ndef update\n@company = Company.find(params[:id])\nif @company.update_attributes(company_params)\n  flash[:success] = \"Company updated\"\n  redirect_to dashboard_path\nelse\n  #render 'edit'\n  flash[:error] = \"Nothing happened!\"\nend\nend\n\nprivate\ndef company_params\n    params.require(:company).permit(:name, :legal_name, :reg_number,\n                            :address, :bank_acc, :currency, :description, :website, :role)\n    end\n</code></pre>\n\n<p>In <em>/models/company.rb</em> I have this:</p>\n\n<pre><code>    class Company &lt; ApplicationRecord\n\n#Companies has many users\n    has_many :accounts, dependent: :destroy\n    has_many :users, through: :accounts\n    has_many :user_roles, through: :users, source: :roles\n\n    enum currency: {eur: 1}, _suffix: true\n    enum role: {seller_buyer: 1, seller: 2, buyer: 3}, _suffix: true\n    accepts_nested_attributes_for :accounts, :users\n</code></pre>\n\n<p>In view I use this line to select role from drop-down:</p>\n\n<pre><code>&lt;option value=&lt;%= f.select :role, Company.roles.keys.to_a, class: 'form-control' %&gt;&lt;/option&gt;\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>This is how view looks like:</p>\n\n<pre><code>&lt;div class=\"middle-box text-center loginscreen animated fadeInDown\"&gt;\n&lt;%= form_for([:common, @company]) do |f| %&gt;\n    &lt;form class=\"m-t\" role=\"form\" action=\"\"&gt;\n    &lt;div class=\"form-group\"&gt;\n            &lt;%= f.text_field :name, class: 'form-control', placeholder: \"Name\"%&gt;\n            &lt;%= f.text_field :legal_name, class: 'form-control', placeholder: \"Legal name\"%&gt;\n            &lt;%= f.text_field :reg_number, class: 'form-control', placeholder: \"Registration number\"%&gt;\n            &lt;%= f.text_field :address, class: 'form-control', placeholder: \"Address\"%&gt;\n            &lt;%= f.text_field :bank_acc, class: 'form-control', placeholder: \"Bank account\"%&gt;\n            &lt;%= f.text_field :description, class: 'form-control', placeholder: \"Description\"%&gt;\n            &lt;%= f.text_field :website, class: 'form-control', placeholder: \"Website\"%&gt;\n            &lt;select class=\"form-control m-b\" name=\"role\"&gt;\n            &lt;option value=&lt;%= f.select :role, Company.roles.keys.to_a, class: 'form-control' %&gt;&lt;/option&gt;\n            &lt;%= f.submit \"Save\", class: \"btn btn-primary block full-width m-b\" %&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>What should I change to make \"role\" enum update/save?</strong></p>\n\n<hr>\n\n<p><strong>Update for solution</strong></p>\n\n<p>This is solution where in Edit action, drop-down shows actual value from database:\n<code>&lt;%= f.select :role, Company.roles.to_a.map { |w| [w[0].humanize, w[0]] }, {}, {class:\"form-control m-b\"} %&gt;</code> Other solutions allowed to update, however it did not show current value in Edit action.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4334121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b26ba4f581ea8875193e7fcbec555a6?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4334121/damien"}, "edited": false, "score": 0, "creation_date": 1476906223, "post_id": 40139384, "comment_id": 67550309, "body": "Thanks that worked. Can I change the first user to be the admin?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 4334121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b26ba4f581ea8875193e7fcbec555a6?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4334121/damien"}, "edited": false, "score": 0, "creation_date": 1476906286, "post_id": 40139384, "comment_id": 67550349, "body": "This works on any user, so long as you can fetch it, so either <code>User.find(...)</code> or <code>User.find_by(...)</code> depending on how you want to get it."}, {"owner": {"reputation": 11, "user_id": 4334121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b26ba4f581ea8875193e7fcbec555a6?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4334121/damien"}, "edited": false, "score": 0, "creation_date": 1476907607, "post_id": 40139384, "comment_id": 67551093, "body": "I have changed the admin to true on the first user but it still doesn&#39;t recognise the log in details. Any suggestions?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 11, "user_id": 4334121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b26ba4f581ea8875193e7fcbec555a6?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4334121/damien"}, "edited": false, "score": 0, "creation_date": 1476908351, "post_id": 40139384, "comment_id": 67551549, "body": "That&#39;s another issue, and another question."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 0, "last_activity_date": 1476903168, "creation_date": 1476903168, "answer_id": 40139384, "question_id": 40139333, "link": "https://stackoverflow.com/questions/40139333/devise-admin-in-ruby-on-rails/40139384#40139384", "title": "Devise Admin in ruby on rails", "body": "<p>Normally you can just manually set the password via the Rails console:</p>\n\n<pre><code>u = User.first\nu.password = u.password_confirmation = 'new password'\nu.save\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4334121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b26ba4f581ea8875193e7fcbec555a6?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4334121/damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1476903168, "creation_date": 1476902963, "question_id": 40139333, "link": "https://stackoverflow.com/questions/40139333/devise-admin-in-ruby-on-rails", "title": "Devise Admin in ruby on rails", "body": "<p>Having problems with the Admin log in with devise as I can't remember the password and email. Any suggestions on how to fix this to gain access?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-s3", "amazon-elastic-beanstalk", "aws-sdk"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "edited": false, "score": 0, "creation_date": 1476901178, "post_id": 40138703, "comment_id": 67547303, "body": "That makes sense, thank you! The image will be set as a bytea datatype - do I still need to read / open in order for it to get uploaded?"}, {"owner": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "edited": false, "score": 0, "creation_date": 1476901264, "post_id": 40138703, "comment_id": 67547362, "body": "Also, I&#39;m confused about why something does get posted to S3 locally but nothing appears on the deployed app. Right now I&#39;m testing by passing in a string and the string appears in the S3 bucket when I post locally, but when I perform the exact same post on eb nothing appears. Why would it not work on the deployed version?"}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "reply_to_user": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "edited": false, "score": 0, "creation_date": 1476902666, "post_id": 40138703, "comment_id": 67548254, "body": "Does your server have the AWS creds or a policy that let&#39;s it write to S3?"}, {"owner": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "edited": false, "score": 0, "creation_date": 1476905018, "post_id": 40138703, "comment_id": 67549597, "body": "I didn&#39;t actively set those up, so probably not. I have been poking around in documentation but am unclear how to give my Elastic Beanstalk application a policy to write to S3."}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "reply_to_user": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "edited": false, "score": 1, "creation_date": 1476907347, "post_id": 40138703, "comment_id": 67550942, "body": "You&#39;ll have to log into your AWS console, go to the EC2 section, there should be an instance for your app there and options to add policies to it <a href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-policies-for-amazon-ec2.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AWSEC2/latest/UserGuide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 0, "last_activity_date": 1476900735, "creation_date": 1476900735, "answer_id": 40138703, "question_id": 40138498, "link": "https://stackoverflow.com/questions/40138498/aws-sdk-for-ruby-v2-check-success-status-after-i-put-object-in-s3-bucket/40138703#40138703", "title": "aws-sdk for Ruby v2: check success status after I PUT object in S3 bucket", "body": "<p>It doesn't seem like you're <code>put</code>ing the image file, only the uri. The docs say this about the <code>put</code> method's <code>body</code> option:</p>\n\n<pre><code>body: source_file, # file/IO object, or string data\n</code></pre>\n\n<p>You'll have to read or open the image file in order to actually upload the image:</p>\n\n<pre><code>obj.put({\n  acl: 'public-read',\n  body: File.open(params[:user][:image_uri], ?r),\n})\n</code></pre>\n\n<p>Then you can check the success status with <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Object.html#exists%3F-instance_method\" rel=\"nofollow\">exists?</a></p>\n"}], "owner": {"reputation": 149, "user_id": 5760378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2a272332b1d8dfea01eaa73b2960256?s=128&d=identicon&r=PG&f=1", "display_name": "swellactually", "link": "https://stackoverflow.com/users/5760378/swellactually"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 40138703, "answer_count": 1, "score": 0, "last_activity_date": 1491280765, "creation_date": 1476899993, "last_edit_date": 1491280765, "question_id": 40138498, "link": "https://stackoverflow.com/questions/40138498/aws-sdk-for-ruby-v2-check-success-status-after-i-put-object-in-s3-bucket", "title": "aws-sdk for Ruby v2: check success status after I PUT object in S3 bucket", "body": "<p>I'm using the aws-sdk v2 for Ruby and I find the methods available on objects really limiting. I created a bucket like so:</p>\n\n<pre><code>client = Aws::S3::Client.new(region: 'us-west-2')\ns3 = Aws::S3::Resource.new(client: client)\nS3_BUCKET = s3.bucket(ENV['AWS_BUCKET'])\n</code></pre>\n\n<p>I've found that the only methods available to write an object to my bucket is <code>put.</code> However, I don't see a 'success_action_status' available with this method. I've deployed my app to Elastic Beanstalk. Locally, I can write to this bucket, but when I try and write to my eb app, it's not working and I am working blind trying to figure out what's happening. Any info to help determine where my PUT request is going wrong would be helpful. </p>\n\n<p>Here's what my method looks like now: </p>\n\n<pre><code>  def create\n    username = params[:user][:user_alias]\n    key = \"uploads/#{username}\"\n    obj = S3_BUCKET.object(key)\n\n    obj.put({\n      acl: 'public-read',\n      body: params[:user][:image_uri],\n    })\n\n    @user = User.new(user_params)\n    if @user.save\n      render json: @user, status: :created, location: @user\n    else\n      render json: @user.errors, status: :unprocessable_entity\n    end\n  end\n</code></pre>\n\n<p>Here's the documentation I'm referring to for PUT methods: <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Object.html#put-instance_method\" rel=\"nofollow\">http://docs.aws.amazon.com/sdkforruby/api/Aws/S3/Object.html#put-instance_method</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 1, "creation_date": 1476898879, "post_id": 40137481, "comment_id": 67545915, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20502165/how-to-replace-text-in-a-ruby-string\">How to replace text in a ruby string</a>"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1476925197, "post_id": 40137481, "comment_id": 67557510, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We&#39;d like to see your effort toward solving the problem, not just a framework with &quot;# ALGORITHM HERE&quot;. We&#39;re here to help fix problems with your code, not write the code."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1476897608, "post_id": 40137617, "comment_id": 67545166, "body": "What happens when <code>string = &#39;redeem&#39;</code>?"}, {"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1476897825, "post_id": 40137617, "comment_id": 67545283, "body": "give it a try, but I would assume that you would get (red)eem"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1476900505, "post_id": 40137617, "comment_id": 67546919, "body": "@CdotStrifeVII please fix your answer so that it works as required."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1476901707, "post_id": 40137617, "comment_id": 67547664, "body": "This works but gets geometrically slower on longer arrays and longer strings."}, {"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1476903043, "post_id": 40137617, "comment_id": 67548475, "body": "Hey @sagarpandya82 so for as I can tell the requested features are an algorithm that replaces sub strings in a string that match strings in an array and my solution does that. What were you referring to?"}, {"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1476904016, "post_id": 40137617, "comment_id": 67549044, "body": "@mu is too short fixed the false positive issue"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1476904874, "post_id": 40137617, "comment_id": 67549535, "body": "ok now it works properly with your edit. I removed downvote and given upvote:)"}, {"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476904931, "post_id": 40137617, "comment_id": 67549565, "body": "Thanks for the motivation :)"}], "tags": [], "owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "is_accepted": false, "score": 4, "last_activity_date": 1476903659, "last_edit_date": 1476903659, "creation_date": 1476896955, "answer_id": 40137617, "question_id": 40137481, "link": "https://stackoverflow.com/questions/40137481/how-do-i-replace-words-in-a-string-based-on-words-in-an-array-in-ruby/40137617#40137617", "title": "How do I replace words in a string based on words in an Array in Ruby?", "body": "<pre><code>strings_to_highlight = ['red', 'blue']\nstring = \"Roses are red, violets are blue\"\n\nstrings_to_highlight.each { |i| string.gsub!(/\\b#{i}\\b/, \"(#{i})\")}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1476901767, "post_id": 40137733, "comment_id": 67547708, "body": "Great use of <code>Regexp.union</code> here, but do try and link through to the current version of the documentation, and also using the <code>[...](...)</code> notation to avoid ugly bare URLs."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1476926665, "post_id": 40137733, "comment_id": 67557825, "body": "Be really careful with <code>Regexp.union words.map { |w| &#47;\\b(#{Regexp.escape(w)})\\b&#47; } # =&gt; &#47;(?-mix:\\b(red)\\b)|(?-mix:\\b(blue)\\b)&#47;</code>. The pattern generated has potential pitfalls in it. Plus the pattern generated could be a lot more simple."}, {"owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1476933210, "post_id": 40137733, "comment_id": 67559255, "body": "@theTinMan what are the pitfalls? The resulting regexp is overly complicated because it preserves the options of all the component patterns (the ?-mix means m,i,and x are all not enabled for each sub-pattern), but I&#39;d still rather use Regexp#union over building a big pattern with regexp string interpolation and literal &quot;|&quot;."}], "tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": false, "score": 5, "last_activity_date": 1476907729, "last_edit_date": 1476907729, "creation_date": 1476897390, "answer_id": 40137733, "question_id": 40137481, "link": "https://stackoverflow.com/questions/40137481/how-do-i-replace-words-in-a-string-based-on-words-in-an-array-in-ruby/40137733#40137733", "title": "How do I replace words in a string based on words in an Array in Ruby?", "body": "<p><code>Regexp</code> has a helpful <a href=\"https://ruby-doc.org/core/Regexp.html#method-c-union\" rel=\"nofollow\"><code>union</code></a> function for combining regular expressions together. Stick with regexp until you have a performance problem:</p>\n\n<pre><code>string = \"Roses are red, violets are blue\"\nstrings_to_highlight = ['red', 'blue']\n\ndef highlight(str, words)\n  matcher = Regexp.union words.map { |w| /\\b(#{Regexp.escape(w)})\\b/ }\n  str.gsub(matcher) { |word| \"(#{word})\" }\nend\n\nputs highlight(string, strings_to_highlight)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 2, "last_activity_date": 1476915116, "last_edit_date": 1476915116, "creation_date": 1476914265, "answer_id": 40142182, "question_id": 40137481, "link": "https://stackoverflow.com/questions/40137481/how-do-i-replace-words-in-a-string-based-on-words-in-an-array-in-ruby/40142182#40142182", "title": "How do I replace words in a string based on words in an Array in Ruby?", "body": "<p>I suggest using the form of <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-gsub\" rel=\"nofollow\">String#gsub</a> that employs a hash for making substitutions.</p>\n\n<pre><code>strings_to_highlight = ['red', 'blue']\n</code></pre>\n\n<p>First construct the hash.</p>\n\n<pre><code>h = strings_to_highlight.each_with_object({}) do |s,h|\n  h[s] = \"(#{s})\"\n  ss = \"#{s[0].swapcase}#{s[1..-1]}\"\n  h[ss] = \"(#{ss})\"\nend\n  #=&gt; {\"red\"=&gt;\"(red)\", \"Red\"=&gt;\"(Red)\", \"Blue\"=&gt;\"(Blue)\", \"blue\"=&gt;\"(blue)\"} \n</code></pre>\n\n<p>Next define a default proc for it:</p>\n\n<pre><code>h.default_proc = -&gt;(h,k) { k }\n</code></pre>\n\n<p>so that if <code>h</code> does not have a key <code>k</code>, <code>h[k]</code> returns <code>k</code> (e.g., <code>h[\"cat\"] #=&gt; \"cat\"</code>).</p>\n\n<p>Ready to go!</p>\n\n<pre><code>string = \"Roses are Red, violets are blue\"\n\nstring.gsub(/[[[:alpha:]]]+/, h)\n =&gt; \"Roses are (Red), violets are (blue)\"\n</code></pre>\n\n<p>This should be relatively efficient as only one pass through the string is needed and hash lookups are very fast.</p>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1476926477, "creation_date": 1476926477, "answer_id": 40143985, "question_id": 40137481, "link": "https://stackoverflow.com/questions/40137481/how-do-i-replace-words-in-a-string-based-on-words-in-an-array-in-ruby/40143985#40143985", "title": "How do I replace words in a string based on words in an Array in Ruby?", "body": "<p>I'd use:</p>\n\n<pre><code>string = \"Roses are red, violets are blue\"\nstrings_to_highlight = ['red', 'blue']\n\nstring.gsub(/\\b(#{Regexp.union(strings_to_highlight).source})\\b/) { |s| \"(#{s})\" } # =&gt; \"Roses are (red), violets are (blue)\"\n</code></pre>\n\n<p>Here's how it breaks down:</p>\n\n<pre><code>/\\b(#{Regexp.union(strings_to_highlight).source})\\b/ # =&gt; /\\b(red|blue)\\b/\n</code></pre>\n\n<p>It's important to use <code>source</code> when embedding a pattern. Without it results in:</p>\n\n<pre><code>/\\b(#{Regexp.union(strings_to_highlight)})\\b/ # =&gt; /\\b((?-mix:red|blue))\\b/\n</code></pre>\n\n<p>and that <code>(?-mix:...)</code> part can cause problems if you don't understand what it means in regex-ese. The Regexp documentation explains the flags but failing to do this can lead to a really hard to diagnose bug if you're not aware of the problem.</p>\n\n<p><code>\\b</code> tells the engine to match words, not substrings. Without that you could end up with:</p>\n\n<pre><code>string = \"Fred, bluette\"\nstrings_to_highlight = ['red', 'blue']\nstring.gsub(/(#{Regexp.union(strings_to_highlight).source})/) { |s| \"(#{s})\" } \n# =&gt; \"F(red), (blue)tte\"\n</code></pre>\n\n<p>Using a block with <code>gsub</code> allows us to perform calculations on the matched values.</p>\n"}], "owner": {"reputation": 1976, "user_id": 318146, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6WZ0N.jpg?s=128&g=1", "display_name": "nebulus", "link": "https://stackoverflow.com/users/318146/nebulus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 40142182, "answer_count": 4, "score": 2, "last_activity_date": 1476926477, "creation_date": 1476896484, "question_id": 40137481, "link": "https://stackoverflow.com/questions/40137481/how-do-i-replace-words-in-a-string-based-on-words-in-an-array-in-ruby", "title": "How do I replace words in a string based on words in an Array in Ruby?", "body": "<p>how would I do the following? I tried doing this gsub but I can't figure out what really efficient if strings_to_highlight array is large. Cheers!</p>\n\n<pre><code>  string = \"Roses are red, violets are blue\"\n\n  strings_to_highlight = ['red', 'blue']\n\n  # ALGORITHM HERE\n\n  resulting_string = \"Roses are (red), violets are (blue)\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1476903886, "post_id": 40137316, "comment_id": 67548959, "body": "can you try adding spree to the gemfile, running <code>bundle</code>, then <code>bundle exec spree install .</code>? By the way, it&#39;s not good practice on StackOverflow to post multiple questions about the same issue"}], "answers": [{"comments": [{"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "edited": false, "score": 0, "creation_date": 1476899505, "post_id": 40137831, "comment_id": 67546335, "body": "<code>bundler (1.13.5)</code> is already installed. I tried getting started, but there I stuck with some other error: <a href=\"http://stackoverflow.com/questions/40131331/spree-install-error-rails-g-spreeinstall-user-class-spreeuser-not-doing?noredirect=1#comment67534506_40131331\" title=\"spree install error rails g spreeinstall user class spreeuser not doing\">stackoverflow.com/questions/40131331/&hellip;</a>"}], "tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": false, "score": 0, "last_activity_date": 1476897766, "creation_date": 1476897766, "answer_id": 40137831, "question_id": 40137316, "link": "https://stackoverflow.com/questions/40137316/error-in-setting-up-spree/40137831#40137831", "title": "error in setting up spree", "body": "<p>Spree requires <a href=\"https://bundler.io\" rel=\"nofollow\">bundler</a> to be installed. Please install it first with</p>\n\n<pre><code>gem install bundler\n</code></pre>\n\n<p>That said, with a new Spree project, you should follow the warning of the command line tool and setup your new Spree project the recommended way. This is described on the linked page on <a href=\"https://github.com/spree/spree#getting-started\" rel=\"nofollow\">https://github.com/spree/spree#getting-started</a></p>\n"}, {"tags": [], "owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "is_accepted": true, "score": 0, "last_activity_date": 1476944241, "creation_date": 1476944241, "answer_id": 40146793, "question_id": 40137316, "link": "https://stackoverflow.com/questions/40137316/error-in-setting-up-spree/40146793#40146793", "title": "error in setting up spree", "body": "<p>I figured out what the problem was:</p>\n\n<p>I had to create a rails app with 4.2.6 version of rails, using following command:</p>\n\n<pre><code>rails _4.2.6_ new store\n</code></pre>\n\n<p>When I was just running <code>rails new store</code>, it used to create dependency using rails 5 version, which was breaking with spree.</p>\n"}], "owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 40146793, "answer_count": 2, "score": 0, "last_activity_date": 1476944241, "creation_date": 1476895922, "last_edit_date": 1495542261, "question_id": 40137316, "link": "https://stackoverflow.com/questions/40137316/error-in-setting-up-spree", "title": "error in setting up spree", "body": "<p>I have create a new rails app using this command:</p>\n\n<pre><code>rails new store\n</code></pre>\n\n<p>rails version is: 4.2.6</p>\n\n<p>Ruby Version:</p>\n\n<pre><code>$ rvm rubies\nruby-2.1.2 [ x86_64 ]\nruby-2.2.0 [ x86_64 ]\n=* ruby-2.2.2 [ x86_64 ]`\n</code></pre>\n\n<p>When I tried :</p>\n\n<pre><code>spree install .\n</code></pre>\n\n<p>I am getting following error:</p>\n\n<pre><code>[WARNING] Spree CMD Installer is deprecated. Please follow installation instructions at https://github.com/spree/spree#getting-started\nWould you like to install the default gateways? (Recommended) (yes/no) [yes] yes\nWould you like to install the default authentication system? (yes/no) [yes] yes\nWould you like to run the migrations? (yes/no) [yes] yes\nWould you like to load the seed data? (yes/no) [yes] yes\nWould you like to load the sample data? (yes/no) [yes] yes\n     gemfile  spree\n     gemfile  spree_gateway\n     gemfile  spree_auth_devise\n         run  bundle install from \".\"\n/Users/saurabh.mimani/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- bundler (LoadError)\n    from /Users/saurabh.mimani/.rvm/rubies/ruby-2.2.2/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n    from /Users/saurabh.mimani/work/codes/spree/store/bin/spring:8:in `&lt;top (required)&gt;'\n    from bin/rails:3:in `load'\n    from bin/rails:3:in `&lt;main&gt;'\n</code></pre>\n\n<p>I also tried to install as is given in <a href=\"https://github.com/spree/spree#getting-started\" rel=\"nofollow noreferrer\">getting started</a> page, but than I get some other error, which is described <a href=\"https://stackoverflow.com/questions/40131331/spree-install-error-rails-g-spreeinstall-user-class-spreeuser-not-doing?noredirect=1#comment67534506_40131331\">here</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-dynamodb"], "answers": [{"tags": [], "owner": {"reputation": 29341, "user_id": 6337748, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/7Si7m.jpg?s=128&g=1", "display_name": "notionquest", "link": "https://stackoverflow.com/users/6337748/notionquest"}, "is_accepted": true, "score": 3, "last_activity_date": 1476951338, "creation_date": 1476951338, "answer_id": 40148992, "question_id": 40136712, "link": "https://stackoverflow.com/questions/40136712/awserrorsmissingcredentialserrorunable-to-sign-request-without-credentials/40148992#40148992", "title": "Aws::Errors::MissingCredentialsError:unable to sign request without credentials set", "body": "<p>You can use the below configuration for local dynamodb. When you give the localhost endpoint, the dynamodb uses the endpoint directly rather than deriving the endpoint from region.</p>\n\n<pre><code>Aws.config.update({\n  region: 'us-west-2',\n  credentials: Aws::Credentials.new('akid', 'secret'),\n  endpoint:'http://localhost:8000'\n})\n</code></pre>\n\n<blockquote>\n  <p>The region is used to construct an SSL endpoint. If you need to\n  connect to a non-standard endpoint, you may specify the :endpoint\n  option.</p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 6786797, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-66XS7t8uN2U/AAAAAAAAAAI/AAAAAAAAACQ/Rtb0sIMBl6U/photo.jpg?sz=128", "display_name": "Prakadeessh Arunachalam", "link": "https://stackoverflow.com/users/6786797/prakadeessh-arunachalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5959, "favorite_count": 0, "accepted_answer_id": 40148992, "answer_count": 1, "score": 3, "last_activity_date": 1476951338, "creation_date": 1476893779, "question_id": 40136712, "link": "https://stackoverflow.com/questions/40136712/awserrorsmissingcredentialserrorunable-to-sign-request-without-credentials", "title": "Aws::Errors::MissingCredentialsError:unable to sign request without credentials set", "body": "<p>I am building a rails application and I am using dynamoDB as the database (using dynamoid). \nWhile I am running the tests, I get the following error:</p>\n\n<p><code>Aws::Errors::MissingCredentialsError:unable to sign request without credentials set</code></p>\n\n<p>Since tests are run in the local dynamoDB, I am a little confused over this error message. Is it that my tests are not running in local db and they are trying to access the remote db?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "centos", "smtp", "sensu"], "comments": [{"owner": {"reputation": 752, "user_id": 3218830, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b49bccdb43e803fa91b36f215c7a27ec?s=128&d=identicon&r=PG&f=1", "display_name": "Kobbe", "link": "https://stackoverflow.com/users/3218830/kobbe"}, "edited": false, "score": 0, "creation_date": 1476903513, "post_id": 40136326, "comment_id": 67548725, "body": "What have you tried? What is your configuration? You best find the error if you try to send emails without sensu. Just use ruby to directly without sensu and it will be much quicker."}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 3062270, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1985ce4a2b8afa4ed3f9813bd4b7ef34?s=128&d=identicon&r=PG&f=1", "display_name": "sreenivas", "link": "https://stackoverflow.com/users/3062270/sreenivas"}, "is_accepted": true, "score": 0, "last_activity_date": 1476973231, "creation_date": 1476973231, "answer_id": 40157091, "question_id": 40136326, "link": "https://stackoverflow.com/questions/40136326/sensu-mailer-handler-using-mail-gem-ruby/40157091#40157091", "title": "sensu mailer handler using mail gem ruby", "body": "<p>Finally found the issue, firewall is blocking port 587.</p>\n"}], "owner": {"reputation": 384, "user_id": 3062270, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1985ce4a2b8afa4ed3f9813bd4b7ef34?s=128&d=identicon&r=PG&f=1", "display_name": "sreenivas", "link": "https://stackoverflow.com/users/3062270/sreenivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 40157091, "answer_count": 1, "score": -1, "last_activity_date": 1476973231, "creation_date": 1476892501, "last_edit_date": 1476901209, "question_id": 40136326, "link": "https://stackoverflow.com/questions/40136326/sensu-mailer-handler-using-mail-gem-ruby", "title": "sensu mailer handler using mail gem ruby", "body": "<p>i am facing some issue using sensu mailer handler, please help me out to solve this issue </p>\n\n<p>i think i am facing port issue, does anyone have any idea.</p>\n\n<blockquote>\n  <p>\"output\":[\"/opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:542:in <code>initialize': execution expired (Net::OpenTimeout)\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:542:in</code>open'\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:542:in <code>tcp_socket'\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:552:in</code>block in do_start'\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/timeout.rb:101:in <code>timeout'\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:551:in</code>do_start'\\n\\tfrom /opt/sensu/embedded/lib/ruby/2.3.0/net/smtp.rb:521:in <code>start'\\n\\tfrom /opt/sensu/embedded/lib/ruby/gems/2.3.0/gems/mail-2.6.4/lib/mail/network/delivery_methods/smtp.rb:113:in</code>deliver!'\\n\\tfrom /opt/sensu/embedded/lib/ruby/gems/2.3.0/gems/mail-2.6.4/lib/mail/message.rb:2149:in <code>do_delivery'\\n\\tfrom /opt/sensu/embedded/lib/ruby/gems/2.3.0/gems/mail-2.6.4/lib/mail/message.rb:239:in</code>deliver'\\n\\tfrom /opt/sensu/embedded/lib/ruby/gems/2.3.0/gems/mail-2.6.4/lib/mail/mail.rb:141:in <code>deliver'\\n\\tfrom /etc/sensu/handlers/handler-mailer.rb:233:in</code>rescue in handle'\\n\\tfrom /etc/sensu/handlers/handler-mailer.rb:218:in <code>handle'\\n\\tfrom /opt/sensu/embedded/lib/ruby/gems/2.3.0/gems/sensu-plugin-1.3.0/lib/sensu-handler.rb:57:in</code>block in '\\n\"]</p>\n</blockquote>\n"}, {"tags": ["ruby", "unit-testing", "mocking", "minitest"], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 0, "creation_date": 1476910235, "post_id": 40136289, "comment_id": 67552510, "body": "Since assert returns a proc, you&#39;ll need to actually <i>call</i> that proc, the final line should be <code>@mock_verifier.assert.call</code>"}, {"owner": {"reputation": 1121, "user_id": 3937773, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/4orvN.jpg?s=128&g=1", "display_name": "Eric Ihli", "link": "https://stackoverflow.com/users/3937773/eric-ihli"}, "reply_to_user": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 0, "creation_date": 1476928343, "post_id": 40136289, "comment_id": 67558173, "body": "Good catch. Thanks. Was a false green. Poor TDD practice on my part."}], "tags": [], "owner": {"reputation": 1121, "user_id": 3937773, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/4orvN.jpg?s=128&g=1", "display_name": "Eric Ihli", "link": "https://stackoverflow.com/users/3937773/eric-ihli"}, "is_accepted": true, "score": 0, "last_activity_date": 1476930071, "last_edit_date": 1476930071, "creation_date": 1476892411, "answer_id": 40136289, "question_id": 40136223, "link": "https://stackoverflow.com/questions/40136223/how-do-i-use-minitestmock-to-assert-that-a-verify-method-has-been-called-on/40136289#40136289", "title": "How do I use MiniTest::Mock to assert that a &#39;verify&#39; method has been called on a mocked object?", "body": "<p>EDIT: Original post (at bottom) was incorrect.</p>\n\n<p>A working solution is:</p>\n\n<pre><code>@mock_verifier.instance_eval {\n        def assert\n            @expected_calls.each do |name, expected|\n                actual = @actual_calls.fetch(name, nil)\n                raise MockExpectationError, \"expected #{__call name, expected[0]}\" unless actual\n                raise MockExpectationError, \"expected #{__call name, expected[actual.size]}, got [#{__call name, actual}]\" if\n                    actual.size &lt; expected.size\n            end\n            true\n        end\n}\n</code></pre>\n\n<p><strong>* Below is incorrect *</strong></p>\n\n<p>Open up the mock, save off the MiniTest::Mock#verify method under a different method name (The -> Proc is needed to capture scope), then un-define 'verify' on the mock.</p>\n\n<pre><code>def @mock_verifier.assert  \n  -&gt; { @mock_verifier.method(:verify) }\nend\n\n@mock_verifier.instance_eval 'undef :verify'\n</code></pre>\n\n<p>Now at the end you do</p>\n\n<pre><code>@mock_verifier.expect :verify, false\n\n@reader.verify(nil)\n\n@mock_verifier.assert\n</code></pre>\n"}], "owner": {"reputation": 1121, "user_id": 3937773, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/4orvN.jpg?s=128&g=1", "display_name": "Eric Ihli", "link": "https://stackoverflow.com/users/3937773/eric-ihli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "accepted_answer_id": 40136289, "answer_count": 1, "score": 0, "last_activity_date": 1476930071, "creation_date": 1476892237, "question_id": 40136223, "link": "https://stackoverflow.com/questions/40136223/how-do-i-use-minitestmock-to-assert-that-a-verify-method-has-been-called-on", "title": "How do I use MiniTest::Mock to assert that a &#39;verify&#39; method has been called on a mocked object?", "body": "<p>I have a class that defines a 'verify' method which is unfortunately the same name that MiniTest::Mock uses to verify a method has been called. I'm running into a clobbering problem.</p>\n\n<p>I have classes defined as below.</p>\n\n<pre><code>class Reader\n  def initialize(verifier)\n    @verifier = verifier\n  end\n\n  def verify(subject)\n    @verifier.verify(subject)\n  end\nend\n\nclass Verifier\n  def verify(subject)\n    subject != nil\n  end\nend\n</code></pre>\n\n<p>I have tests setup as follows.</p>\n\n<pre><code>class TestReader &lt; MiniTest::Test\n  def test_reader_when_verification_fails\n    mock_verifier = MiniTest::Mock.new\n    mock_verifier.expect :verify, false\n\n    reader = Reader.new(mock_verifier)\n    reader.verify(nil)\n\n    # The following verify method ends up being the 'verify' defined on\n    # Verifier, not on MiniTest::Mock. It blows up because Verifier#verify\n    # expects an argument.\n    mock_verifier.verify\n  end\nend\n</code></pre>\n\n<p>How do I get around this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara", "factory-bot", "rspec-rails"], "answers": [{"tags": [], "owner": {"reputation": 1779, "user_id": 3102718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9c06b4a732dc2ee775f93135d1592f?s=128&d=identicon&r=PG", "display_name": "Alex Avoiants", "link": "https://stackoverflow.com/users/3102718/alex-avoiants"}, "is_accepted": true, "score": 0, "last_activity_date": 1476902367, "creation_date": 1476902367, "answer_id": 40139191, "question_id": 40136020, "link": "https://stackoverflow.com/questions/40136020/quadruple-nested-child-elements-in-factorygirl/40139191#40139191", "title": "Quadruple nested child elements in FactoryGirl", "body": "<p>I think in factories hook should be <code>after(:create)</code> instead of <code>after(:build)</code>, e.g.:</p>\n\n<pre><code>after(:create) do |video|\n  create(:comment, video: video)\nend\n</code></pre>\n\n<p>Here is all updated factories:</p>\n\n<p><strong>spec/factories/users.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    first_name  Faker::Name.first_name\n    last_name  Faker::Name.last_name\n    sequence(:username) { |n| \"#{n}username\" }\n    sequence(:email) { |n| \"#{n}email@website.com\" }\n    phone Faker::PhoneNumber.phone_number\n    password Faker::Internet.password(6, 20)\n    country Faker::Address.country\n    state Faker::Address.state_abbr\n    city Faker::Address.city\n    zip Faker::Address.zip\n    seeking_coach true\n    accept_email true\n    accept_phone true\n\n    trait :with_10_posts do\n      after(:create) do |user|\n        create_list(:post, 10, :with_videos, user: user)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><strong>spec/factories/posts.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :post do\n    sequence(:title) { |n| \"#{n}title\" }\n    date Date.today.strftime('%m/%d/%Y')\n    body Faker::Lorem.paragraph(3)\n    tags Faker::Lorem.words(4)\n    user\n\n    trait :with_videos do\n      after(:create) do |post|\n        create(:video, :with_comments, post: post)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><strong>spec/factories/videos.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :video do\n    sequence(:title) { |n| \"#{n}title\" }\n    sequence(:url) { |n| \"https://www.youtube.com/watch?v=tYm_#{n}2oCVdSM\" }\n    post\n\n    trait :with_comments do\n      after(:create) do |video|\n        create(:comment, video: video)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><strong>spec/factories/comments.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :comment do\n    sequence(:body) { |n| \"#{n}body\" }\n    video\n  end\nend\n</code></pre>\n\n<p>And RSpec test to ensure that factories setup works:</p>\n\n<pre><code>describe 'Factories' do\n  it 'creates 20 users, each with at least 10 posts, each post with at least 1 video, each video with at least 1 comment' do\n    FactoryGirl.create_list(:user, 20, :with_10_posts)\n    expect(User.count).to eq(20)\n    user = User.take\n    expect(user.posts.count).to be &gt;= 10\n    post = user.posts.take\n    expect(post.videos.count).to be &gt;= 1\n    video = post.videos.take\n    expect(video.comments.count).to be &gt;= 1\n  end\nend\n</code></pre>\n\n<p>Here is all the code - <a href=\"https://github.com/shhavel/stackoverflow_question_40136020\" rel=\"nofollow\">https://github.com/shhavel/stackoverflow_question_40136020</a></p>\n"}], "owner": {"reputation": 153, "user_id": 5822806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c163588fe782ff5c78200a1b05506cd1?s=128&d=identicon&r=PG&f=1", "display_name": "n.milsht", "link": "https://stackoverflow.com/users/5822806/n-milsht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 40139191, "answer_count": 1, "score": 1, "last_activity_date": 1476902367, "creation_date": 1476891726, "question_id": 40136020, "link": "https://stackoverflow.com/questions/40136020/quadruple-nested-child-elements-in-factorygirl", "title": "Quadruple nested child elements in FactoryGirl", "body": "<p>I'm trying to create dummy data with FactoryGirl. </p>\n\n<p>User has many posts, post has many videos, video has many comments.\nComment belong to video and user.\nVideo belongs to post and user.\nPost belongs to user.</p>\n\n<p>I would like to create at least 20 users, each with at least 10 posts, each post with at least 1 video, each video with at least 1 comment.</p>\n\n<p>Thus far I have the following factories however I can't seem to get the videos or comments to work.</p>\n\n<h1>spec/factories/comments.rb</h1>\n\n<pre><code>FactoryGirl.define do\n  factory :comment do\n    sequence(:body) { |n| \"#{n}body\" }\n    video\n    user\n  end\nend\n</code></pre>\n\n<h1>spec/factories/posts.rb</h1>\n\n<pre><code>FactoryGirl.define do\n  factory :post do\n    sequence(:title) { |n| \"#{n}title\" }\n    date Date.today.strftime('%m/%d/%Y')\n    body Faker::Lorem.paragraph(3)\n    tags Faker::Lorem.words(4)\n    user\n\n    trait :with_videos do\n      after(:build) do |post|\n        create(:video, post: post)\n      end\n    end\n  end\nend\n</code></pre>\n\n<h1>spec/factories/users.rb</h1>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    first_name  Faker::Name.first_name\n    last_name  Faker::Name.last_name\n    sequence(:username) { |n| \"#{n}username\" }\n    sequence(:email) { |n| \"#{n}email@website.com\" }\n    phone  Faker::PhoneNumber.phone_number\n    password  Faker::Internet.password(6, 20)\n    country  Faker::Address.country\n    state  Faker::Address.state_abbr\n    city  Faker::Address.city\n    zip  Faker::Address.zip\n    seeking_coach true\n    accept_email true\n    accept_phone true\n  end\nend\n</code></pre>\n\n<h1>spec/factories/videos.rb</h1>\n\n<pre><code>FactoryGirl.define do\n  factory :video do\n    sequence(:title) { |n| \"#{n}title\" }\n    sequence(:url) { |n| \"https://www.youtube.com/watch?v=tYm_#{n}2oCVdSM\" }\n    embed_id { \"#{url}.split('=').last\" }\n    post\n    user\n\n    trait :with_comments do\n      after(:build) do |video|\n        create(:comment, video: video)\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476890314, "post_id": 40135400, "comment_id": 67540778, "body": "What you are asking is given the value you how do you return the name of that <code>key</code> from an <code>activerecord</code> record with that value"}], "answers": [{"comments": [{"owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "edited": false, "score": 1, "creation_date": 1476890373, "post_id": 40135449, "comment_id": 67540813, "body": "Wow! I never knew that. Im still learning. So <code>f.attributes</code> is the hash? Ok."}, {"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 2, "creation_date": 1476890378, "post_id": 40135449, "comment_id": 67540816, "body": "Didn&#39;t know you could do this."}, {"owner": {"reputation": 505, "user_id": 5909738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jNscA.jpg?s=128&g=1", "display_name": "Tashows", "link": "https://stackoverflow.com/users/5909738/tashows"}, "edited": false, "score": 0, "creation_date": 1612014987, "post_id": 40135449, "comment_id": 116637069, "body": "That&#39;s exactly what I needed and had no clue is possible! Awesome!"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 5, "last_activity_date": 1476890942, "last_edit_date": 1476890942, "creation_date": 1476890102, "answer_id": 40135449, "question_id": 40135400, "link": "https://stackoverflow.com/questions/40135400/get-attributes-name-by-its-value/40135449#40135449", "title": "Get attribute&#39;s name by it&#39;s value", "body": "<p><code>f</code> is an instance of <code>Foo</code> class, which inherits from <code>ActiveRecord::Base</code>, it is not a <code>Hash</code> instance.</p>\n\n<p>To get the attribute's name by it's value (using <code>key</code>), you have to get a hash of <code>f</code>'s <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods.html#method-i-attributes\" rel=\"nofollow\">ActiveRecord::AttributeMethods#<code>attributes</code></a> first:</p>\n\n<pre><code>f.attributes.key('dave') # `attributes` method returns a Hash instance\n#=&gt; \"name\"\n</code></pre>\n\n<blockquote>\n  <p>What is the difference</p>\n</blockquote>\n\n<p>To sum up: the difference in the instance methods defined in the object's class.</p>\n"}], "owner": {"reputation": 8519, "user_id": 3581788, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ghs5V.jpg?s=128&g=1", "display_name": "Sylar", "link": "https://stackoverflow.com/users/3581788/sylar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 1, "accepted_answer_id": 40135449, "answer_count": 1, "score": 3, "last_activity_date": 1476905414, "creation_date": 1476889974, "last_edit_date": 1476905414, "question_id": 40135400, "link": "https://stackoverflow.com/questions/40135400/get-attributes-name-by-its-value", "title": "Get attribute&#39;s name by it&#39;s value", "body": "<p>I need to return the key with a known <code>value</code> from my model.</p>\n\n<pre><code>f = Foo.find_by(name: \"dave\")\n#= returned object: {id: 1, name: \"dave\", age: 32}\nf.key(\"dave\") # expected :name or name\n</code></pre>\n\n<p>This <code>value</code> will be unique. How to get the attribute? Am I asking the right question?</p>\n\n<p>What is the difference with this, please?</p>\n\n<pre><code>hash = { \"a\" =&gt; 100, \"b\" =&gt; 200, \"c\" =&gt; 300, \"d\" =&gt; 300 }\nhash.key(200) #=&gt; \"b\"\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1476889804, "post_id": 40135124, "comment_id": 67540417, "body": "You have to look for another approach. Can you think of a way to make <code>next_bigger(12_000_000_000)</code> return <code>21_000_000_000</code> without having to traverse all 39,916,800 permutations?"}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476890094, "post_id": 40135124, "comment_id": 67540614, "body": "ok, I figured I was taking a wrong approach instead of optimizing."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476890863, "post_id": 40135124, "comment_id": 67541146, "body": "Here&#39;s a hint: if I closely examine 531, I can see that 5 \u2265 3 \u2265 1."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476898074, "post_id": 40135124, "comment_id": 67545449, "body": "[the <code>21_000_000_000</code> in my first comment should be <code>20_000_000_001</code>]"}], "answers": [{"comments": [{"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "edited": false, "score": 0, "creation_date": 1476892122, "post_id": 40135568, "comment_id": 67541959, "body": "Thanks for providing an answer Surya, this seems to be on the right track. I can learn from this. However not all the tests pass for this implementation. <code>Expected: 1234567908, instead got: 1234567980</code> and <code>Expected: 59884848483559, instead got: 59884848495853</code> The input is <code>1234567890</code> and <code>59884848459853</code> respectively."}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "edited": false, "score": 0, "creation_date": 1476892140, "post_id": 40135568, "comment_id": 67541972, "body": "I&#39;ll definitely build off of this though"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "reply_to_user": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "edited": false, "score": 0, "creation_date": 1476896378, "post_id": 40135568, "comment_id": 67544506, "body": "Interesting case, above changes address the problem, though code has become unreadable. I&#39;ll see if I can make it look more understandable."}], "tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 0, "last_activity_date": 1476896313, "last_edit_date": 1476896313, "creation_date": 1476890445, "answer_id": 40135568, "question_id": 40135124, "link": "https://stackoverflow.com/questions/40135124/how-could-i-make-this-code-kata-solution-run-faster/40135568#40135568", "title": "How could I make this code kata solution run faster?", "body": "<p>You seems to be wasting cycles on line:</p>\n\n<pre><code>list_of_nums = num_material.permutation(num_material.size).to_a\n</code></pre>\n\n<p>Imagine if <code>num_material</code> is as big as 987654323445678, think about the number of permutations that your code has to produce and then convert them to an array for further processing. I would probably just check the degree of numbers starting from least digit and its next digit, keep comparing them until I find a large number than its next most significant number(neighbour number on its left), and break the iteration once I have found the number.</p>\n\n<p>Later, we fix the large numbers that have come on to left side by marking the swapped number as pivot and taking the pivot index. We fix it by comparing a large possible number that is on left which is greater than pivot but less than the number which has reached to the lest most position of pivot.</p>\n\n<p>We now need to fix one more thing which is the number that have become shuffled on the right side of pivot by sorting.</p>\n\n<p>So, in worst case algorithm would be O(nlogn)[Since we are sorting]:</p>\n\n<pre><code>number = gets.chomp\n\nnumber_length = number.length - 1\nnext_bigger_number_present = false\n\nwhile !next_bigger_number_present &amp;&amp; number_length != 0\n  if (number[number_length] &gt; number[number_length-1])\n    pivot_number = number[number_length - 1]\n    pivot_number_index = number_length - 1\n\n    temp = number[number_length]\n    number[number_length] = number[number_length - 1]\n    number[number_length - 1] = temp\n    next_bigger_number_present = true\n  end\n  number_length -= 1\nend\n\nwhile next_bigger_number_present &amp;&amp; number_length &lt; number.length - 2\n  if (pivot_number &lt; number[number_length] &amp;&amp; number[pivot_number_index] &gt; number[number_length])\n    temp = number[number_length]\n    number[number_length] = number[pivot_number_index]\n    number[pivot_number_index] = temp\n  end\n  number_length += 1\nend\n\nif next_bigger_number_present\n  number[pivot_number_index+1..number.length-1] = number[pivot_number_index+1..number.length-1].split('').sort.join('')\nend\n\n\nputs next_bigger_number_present ? number : -1\n</code></pre>\n\n<p>I'll probably try to rewrite the code to make it more readable.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476897255, "post_id": 40136870, "comment_id": 67544977, "body": "You don&#39;t need an array to determine the &quot;starting digit&quot;. You just have to look for the last digit that is smaller than its successor."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476899182, "post_id": 40136870, "comment_id": 67546111, "body": "Yes, that is true."}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": false, "score": 1, "last_activity_date": 1476899239, "last_edit_date": 1476899239, "creation_date": 1476894296, "answer_id": 40136870, "question_id": 40135124, "link": "https://stackoverflow.com/questions/40135124/how-could-i-make-this-code-kata-solution-run-faster/40136870#40136870", "title": "How could I make this code kata solution run faster?", "body": "<p>You should break the problem up into sub-steps.</p>\n\n<p>First, see if there is any way to increase the ones digit without modifying the other digits.  If that were possible, it would certainly yield the answer, since increasing the ones digit always yields a smaller number than increasing a larger digit (say, the tens digit).  However, it is not possible to increase the ones digit without decreasing some other digit, because the new number has to be an anagram of the original number.</p>\n\n<p>Next, see if there is any way to increase the tens digit without modifying any digits that are more significant.  This is possible if and only if the ones digit is larger than the tens digit.  So if the ones digit is larger than the tens digit, swap those two digits and return that as the answer.</p>\n\n<p>Next, let's consider whether we can increase the hundreds digit without modifying digits that are more significant.  If the hundreds digit is smaller than the ones digit or the tens digit, then we can indeed increase it by permuting those three digits in some way to make the hundreds digit larger.  We either have to swap the hundreds digit with the tens digit or the ones digit.  To make sure we get the smallest possible number, we must swap it with the lowest of those two digits that is still larger than the hundreds digit.  Then we should order the tens and ones digits in ascending order to make sure they make sure we get the smallest number possible.</p>\n\n<p>The paragraph above is pretty abstract, so I should give some examples.  If we were given 9231, we would rearrange the lower three digits to get 9312.  If we were given 9243, we would arrange the lower three digits to get 9324.</p>\n\n<p>I think you can see a pattern emerging here.  The general algorithm would be:</p>\n\n<p>Loop over each digit of the input number starting with the least significant digit.  Make a list of the digit values for the digits that are less significant.  If the list contains a value that is larger than the current digit we are looking at, then we can get our answer by doing the following:  Pick the smallest such value that is larger than the digit we are looking at, and swap it with the digit that we are looking at. (We are modifying a the input number in place.)  Now sort the digits of the number that are less significant than the one we are looking at, in ascending order.</p>\n\n<p>The output number will look like this at the end: zero or more unmodified digits, followed by one digit that increased by swapping with a digit less significant than it, followed by an ascending sequence of one or more digits.</p>\n\n<p>You can write this in Ruby!  I would recommend that you split your number up into an array of digits (e.g. <code>134</code> becomes <code>[1, 3, 4]</code>) as soon as possible, and work with arrays like that throughout your program.</p>\n"}], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476899239, "creation_date": 1476889330, "question_id": 40135124, "link": "https://stackoverflow.com/questions/40135124/how-could-i-make-this-code-kata-solution-run-faster", "title": "How could I make this code kata solution run faster?", "body": "<p>I was recently going into some kata practice where this morning I solved the following puzzle. Here it is reproduced from <a href=\"https://www.codewars.com\" rel=\"nofollow\">Codewars</a></p>\n\n<pre><code>You have to create a function that takes a positive integer number and returns the next bigger number formed by the same digits:\n\nnext_bigger(12)==21\nnext_bigger(513)==531\nnext_bigger(2017)==2071\n\nIf no bigger number can be composed using those digits, return -1:\n\nnext_bigger(9)==-1\nnext_bigger(111)==-1\nnext_bigger(531)==-1\n\ndef next_bigger(n)\n  root_number = n\n  num_material = n.to_s.split(//)\n  list_of_nums = num_material.permutation(num_material.size).to_a\n  possible_combinations = []\n  list_of_nums.each do |n|\n    num = n.join.to_i\n    possible_combinations &lt;&lt; num if root_number &lt; num \n  end\n  possible_combinations.empty? ? -1 : possible_combinations.min\nend\n</code></pre>\n\n<p>The code solves the kata, however I noticed that when I try to run the entire test suite, I always get a <code>Request Timeout</code> error. It seems like my solution is too slow. How could I possibly make this faster? Off the bat, I thought recursion could be a faster implementation but a little bit of googling revealed that it won't necessarily be efficient with languages like python, ruby, java etc. What options would I have to make this faster? </p>\n"}, {"tags": ["ruby", "testing", "cucumber", "automated-tests", "bdd"], "comments": [{"owner": {"reputation": 4478, "user_id": 861594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5bd816221582ff949ae3ce6ab7d29b?s=128&d=identicon&r=PG", "display_name": "user861594", "link": "https://stackoverflow.com/users/861594/user861594"}, "edited": false, "score": 0, "creation_date": 1476892652, "post_id": 40135062, "comment_id": 67542324, "body": "in case of java, there is a way for it in QAF-Gherkin [ <a href=\"https://qmetry.github.io/qaf/latest/qaf-gherkin-client.html\" rel=\"nofollow noreferrer\">qmetry.github.io/qaf/latest/qaf-gherkin-client.html</a> ] by means of step listener. You can check if the same thing you can implement for ruby"}, {"owner": {"reputation": 847, "user_id": 1482694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e4742341658d0f90de0b770fc4f01f?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1482694/sam"}, "edited": false, "score": 1, "creation_date": 1476963731, "post_id": 40135062, "comment_id": 67575697, "body": "Why use AfterStep and not After (scenario) ? Try: After(&#39;@screenshot&#39;) do |scenario| ....."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 1245255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428861249a432b1f54c1867d87cd9d4e?s=128&d=identicon&r=PG", "display_name": "mondaini", "link": "https://stackoverflow.com/users/1245255/mondaini"}, "is_accepted": true, "score": 0, "last_activity_date": 1477146530, "creation_date": 1477146530, "answer_id": 40193295, "question_id": 40135062, "link": "https://stackoverflow.com/questions/40135062/how-to-implement-an-afterstep-getting-the-tag-and-passing-the-scenario-as-an-arg/40193295#40193295", "title": "How to implement an AfterStep getting the Tag and passing the scenario as an argument?", "body": "<p>As @Sam pointed out, using <code>After('@screenshot') do |scenario|</code> did the trick for me. </p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 1245255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428861249a432b1f54c1867d87cd9d4e?s=128&d=identicon&r=PG", "display_name": "mondaini", "link": "https://stackoverflow.com/users/1245255/mondaini"}, "edited": false, "score": 0, "creation_date": 1477336964, "post_id": 40225359, "comment_id": 67715300, "body": "This wasn&#39;t exactly what I was looking for. I do have a helper method to take screenshots. My doubt was how to use the After (or AfterStep) method passing the scenario as argument. But thanks."}], "tags": [], "owner": {"reputation": 31, "user_id": 6552592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fd575fbd0fc205e3bed1f40368af561?s=128&d=identicon&r=PG&f=1", "display_name": "J.Wright", "link": "https://stackoverflow.com/users/6552592/j-wright"}, "is_accepted": false, "score": 0, "last_activity_date": 1477334714, "creation_date": 1477334714, "answer_id": 40225359, "question_id": 40135062, "link": "https://stackoverflow.com/questions/40135062/how-to-implement-an-afterstep-getting-the-tag-and-passing-the-scenario-as-an-arg/40225359#40225359", "title": "How to implement an AfterStep getting the Tag and passing the scenario as an argument?", "body": "<pre><code>After('@screenshot') do |scenario|\n\n  output_folder = (ENV[\"output_folder\"] || \"features/output\") + \"/\" + ENV['TIMESTAMP'][0,10]\n  scenario_folder = output_folder + '/' + 'failure screenshots' + '/'\n\n  if scenario.respond_to? (:title)\n    script_name = scenario.name\n  else\n    script_name = scenario.scenario_outline.title\n  end\n\n  screenshot_file = scenario_folder + script_name.gsub(/[\\/\\\\| &lt;&gt;\\n\\r]+/, \"_\")[0..90] + \".png\"\n  current_path = ''\n\n\n  begin\n    screenshot_file.split(/\\//).map{|m| m.split(/\\\\/)}.flatten.each {|folder|\n    next if folder =~ /\\.png/\n    current_path += folder + \"/\"\n    next if folder.downcase =~ /:/\n    Dir.mkdir(current_path) unless File.exists?(current_path)\n    }\n\n  @browser.screenshot.save screenshot_file\n  embed screenshot_file, 'image/png'\n\n  rescue Exception =&gt; e\n    p e.message\n    p \"Could not capture screenshot\"\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1245255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428861249a432b1f54c1867d87cd9d4e?s=128&d=identicon&r=PG", "display_name": "mondaini", "link": "https://stackoverflow.com/users/1245255/mondaini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 40193295, "answer_count": 2, "score": 0, "last_activity_date": 1477334714, "creation_date": 1476889195, "question_id": 40135062, "link": "https://stackoverflow.com/questions/40135062/how-to-implement-an-afterstep-getting-the-tag-and-passing-the-scenario-as-an-arg", "title": "How to implement an AfterStep getting the Tag and passing the scenario as an argument?", "body": "<p>I'm searching a way to implement an AfterStep(@tag) passing the scenario as an argument. Unfortunately, this isn't working and I couldn't find a way to do it.</p>\n\n<p>I also looked into the <a href=\"https://github.com/cucumber/cucumber/wiki/Hooks\" rel=\"nofollow\">Cucumber Hooks documentation</a>, but that didn't help as well.</p>\n\n<p>The way I'm trying to implement:</p>\n\n<pre><code>  AfterStep('@screenshot') do |scenario|\n    # Add screenshot to baseline folder.\n    @helper = Helper.new\n    @helper.take_screenshot(scenario.name, 'screenshots/baseline')\n  end\n</code></pre>\n\n<p>When I run the tests, I get this error:</p>\n\n<pre><code>undefined method `name' for #&lt;Cucumber::Core::Test::Result::Passed:0x007f2b818e6d50&gt; (NoMethodError)\n</code></pre>\n\n<p>The objective here is to take a screenshot from the scenarios with the @screenshot tag.</p>\n"}, {"tags": ["arrays", "ruby", "string", "substring"], "comments": [{"owner": {"reputation": 2637, "user_id": 1260068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1e0f4a1006aaeb0ae65db3d6ccdaa89?s=128&d=identicon&r=PG", "display_name": "roychri", "link": "https://stackoverflow.com/users/1260068/roychri"}, "edited": false, "score": 1, "creation_date": 1476888506, "post_id": 40134729, "comment_id": 67539370, "body": "When I tried your code, the order was right. check out and run: <a href=\"https://repl.it/EA98/0\" rel=\"nofollow noreferrer\">repl.it/EA98/0</a>"}, {"owner": {"reputation": 129, "user_id": 6780364, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/N9rjw.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6780364/leo"}, "reply_to_user": {"reputation": 2637, "user_id": 1260068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a1e0f4a1006aaeb0ae65db3d6ccdaa89?s=128&d=identicon&r=PG", "display_name": "roychri", "link": "https://stackoverflow.com/users/1260068/roychri"}, "edited": false, "score": 0, "creation_date": 1476898110, "post_id": 40134729, "comment_id": 67545467, "body": "Indeed, but I was missing the sort method at the end, that is why it did not return the array in the proper order."}], "answers": [{"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476888946, "post_id": 40134789, "comment_id": 67539700, "body": "It&#39;s more a substring than a syllable."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476889037, "post_id": 40134789, "comment_id": 67539777, "body": "Yeah, I didn&#39;t know how to name it."}, {"owner": {"reputation": 129, "user_id": 6780364, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/N9rjw.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6780364/leo"}, "edited": false, "score": 0, "creation_date": 1476898066, "post_id": 40134789, "comment_id": 67545445, "body": "It works.  Thanks You. I forgot to mention that the function did not work because it needed to be returned in a lexicographic order, which is simply done by calling sort"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "edited": false, "score": 0, "creation_date": 1476898750, "post_id": 40134789, "comment_id": 67545835, "body": "My pleasure Sir ;)"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1476888524, "creation_date": 1476888524, "answer_id": 40134789, "question_id": 40134729, "link": "https://stackoverflow.com/questions/40134729/verify-if-substring-included-in-string-when-comparing-away-elements/40134789#40134789", "title": "Verify if substring included in string when comparing away elements", "body": "<p>I'd do something like this</p>\n\n<pre><code>example1.select { |syllable| example2.any? { |word| word.include? syllable } }\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 6780364, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/N9rjw.jpg?s=128&g=1", "display_name": "Leo", "link": "https://stackoverflow.com/users/6780364/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476888797, "creation_date": 1476888337, "last_edit_date": 1476888797, "question_id": 40134729, "link": "https://stackoverflow.com/questions/40134729/verify-if-substring-included-in-string-when-comparing-away-elements", "title": "Verify if substring included in string when comparing away elements", "body": "<p>I have two data sets</p>\n\n<pre><code>example1 = [\"og\", \"phan\"]\nexample2 = [\"dog\", \"cat\", \"elephant\", \"chicken\", \"snake\"]\n</code></pre>\n\n<p>What I need to be returned, exactly, is a new array containing elements from <code>example1</code> <strong>only</strong> if they are substring of any of the elements of <code>example2</code> <strong>and</strong> they should also be included <strong>in the same order</strong> as they were presented.</p>\n\n<p>I managed to get the following code working, but the new array returns the elements in a different order (e.g. <code>[\"phan\", \"og\"]</code> instead of <code>[\"og\", \"phan\"]</code>.</p>\n\n<pre><code>r = []\narray1.map { |x| r.push(x) if array2.join(\" \").include?(x) }\nr.flatten\n</code></pre>\n\n<p>Extra:  I found out that <code>include?</code> does not work if you use it when comparing array against array, in other words, it does not find substring within string in a single array element unless it is exactly the same.</p>\n"}, {"tags": ["ruby", "forms", "sanitize"], "answers": [{"comments": [{"owner": {"reputation": 8028, "user_id": 18092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c64bdb2472e682117c58e4a07b8486?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/18092/fred"}, "edited": false, "score": 0, "creation_date": 1476892209, "post_id": 40136097, "comment_id": 67542013, "body": "One more thing, you can store the HTML markup in the database and sanitize in the view before display. That way, in the future you can do something more with HTML text, if you choose. If you throw the formatting away before storing, it is gone."}, {"owner": {"reputation": 25, "user_id": 6877257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af24eab40df32e408c0fad9f57530532?s=128&d=identicon&r=PG&f=1", "display_name": "user6877257", "link": "https://stackoverflow.com/users/6877257/user6877257"}, "edited": false, "score": 0, "creation_date": 1476893140, "post_id": 40136097, "comment_id": 67542662, "body": "Thanks for the speedy reply and the link. I am using Ruby 2.2.1. I should have told you I already went through the sanitize documentation before posting. So if I opt for option 2, (get rid of the formatting before storing), how should I write it ? How can I combine the form field and sanitize together?"}, {"owner": {"reputation": 8028, "user_id": 18092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c64bdb2472e682117c58e4a07b8486?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/18092/fred"}, "reply_to_user": {"reputation": 25, "user_id": 6877257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af24eab40df32e408c0fad9f57530532?s=128&d=identicon&r=PG&f=1", "display_name": "user6877257", "link": "https://stackoverflow.com/users/6877257/user6877257"}, "edited": false, "score": 0, "creation_date": 1476911768, "post_id": 40136097, "comment_id": 67553279, "body": "The simplest way would be to sanitize the string in the model when assigning the text_field to the model attribute before saving to the database. You can&#39;t really process the form_field on the fly without some careful thought (e.g., what would you do if the unfinished text wasn&#39;t well-formed HTML). You could run some javascript when the text_field loses focus and strip out the HTML, but if you put the result back in the text_field it might be confusing to the user. You need to define exactly what you want to do before choosing an implementation method."}], "tags": [], "owner": {"reputation": 8028, "user_id": 18092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c64bdb2472e682117c58e4a07b8486?s=128&d=identicon&r=PG", "display_name": "Fred", "link": "https://stackoverflow.com/users/18092/fred"}, "is_accepted": false, "score": 0, "last_activity_date": 1476891933, "creation_date": 1476891933, "answer_id": 40136097, "question_id": 40134644, "link": "https://stackoverflow.com/questions/40134644/allow-copy-paste-in-a-text-area-field-form-but-remove-formatting/40136097#40136097", "title": "Allow copy / paste in a text_area field form but remove formatting", "body": "<p>You didn't say which version of Rails, but you could use <code>#sanitize</code> from <code>ActionView::Helpers::SanitizeHelper</code> module to strip all the HTML formatting. It scrubs HTML from text with a scrubber. The default scrubber allows optional whitelisting of attributes. You can even build your own custom scrubber to modify the string if you need more control over what is output. The module also contains <code>#strip_tags</code> and <code>#strip_links</code>, which are very simple scrubbers that remove all HTML tags and all HTML link tags (leaving the link text).</p>\n\n<p>Note that you can wind up with malformed text if the user's input wasn't valid HTML.</p>\n\n<p>Quick examples from the docs: </p>\n\n<pre><code>// remove all HTML tags except &lt;strong&gt; &lt;em&gt; &lt;a&gt; and the \n// &lt;href&gt; attributes from @text\nnomarkup_text = sanitize @text, tags: %w(strong em a), attributes: %w(href)\n\n// remove all HTML markup\nstrip_tags(\"&lt;b&gt;Bold&lt;/b&gt; no more!  &lt;a href='more.html'&gt;See more here&lt;/a&gt;...\")\n</code></pre>\n\n<p>returns the string <code>Bold no more!  See more here...</code></p>\n\n<pre><code>// remove just the link markup\nstrip_links('Please e-mail me at &lt;a href=\"mailto:me@email.com\"&gt;me@email.com&lt;/a&gt;.')\n</code></pre>\n\n<p>returns the string <code>Please e-mail me at me@email.com.</code></p>\n\n<p>More detail at the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html\" rel=\"nofollow\" title=\"here\">API page for SantizeHelper</a></p>\n"}], "owner": {"reputation": 25, "user_id": 6877257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af24eab40df32e408c0fad9f57530532?s=128&d=identicon&r=PG&f=1", "display_name": "user6877257", "link": "https://stackoverflow.com/users/6877257/user6877257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476891933, "creation_date": 1476888128, "question_id": 40134644, "link": "https://stackoverflow.com/questions/40134644/allow-copy-paste-in-a-text-area-field-form-but-remove-formatting", "title": "Allow copy / paste in a text_area field form but remove formatting", "body": "<p>I have a text_area field in a form which allows some text formatting through a very simple WYSIWYG (bold / underline / bullet points). This was aimed at having a consistent formatting in the description profile of the users.</p>\n\n<pre><code> &lt;%= l.text_area :access, value: \"#{t('.access_placeholder_html')}\" %&gt;\n</code></pre>\n\n<p>Nevertheless, some users usually filled the text_area by copy / pasting directly from their website. And their specific formatting \"hypertext links\", font size, etc. is after reflected on my website, which makes it a bit dirty. </p>\n\n<p>How can I solve this problem. Ideally I would love that when saving the form it gets rid of all the HTML code that is not allowed instead of not allowing copy / paste. Is this possible? Was wondering if should use Sanitize but if so how? (Sorry new to code, I guess you would have understood). </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tinymce", "sendgrid"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1476888912, "post_id": 40134606, "comment_id": 67539674, "body": "Post your production environment config please"}, {"owner": {"reputation": 21, "user_id": 7041557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ugmYF.jpg?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/7041557/ziv"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1476948403, "post_id": 40134606, "comment_id": 67565308, "body": "there you go: <a href=\"http://pastie.org/10946602\" rel=\"nofollow noreferrer\">pastie.org/10946602</a>"}], "owner": {"reputation": 21, "user_id": 7041557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ugmYF.jpg?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/7041557/ziv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 649, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1479400330, "creation_date": 1476888059, "last_edit_date": 1479400330, "question_id": 40134606, "link": "https://stackoverflow.com/questions/40134606/sendgrid-some-images-not-showing-up-in-html-mail", "title": "SendGrid some images not showing up in HTML mail", "body": "<p>Im using Sendgrid with Ruby on rails version 2.3.18 and tinymce editor to send campaign emails through my app.</p>\n\n<p>When i try to send a campaign HTML email with <strong>multiple</strong> linked images inside it (stored on amazon), some of the images gets broken and not displayed.\nwhen checking the email in developer tools, i see that the broken images SRC is messed up.\nThe weird thing is:\n1. It happens even if i send an email with the <strong>same image</strong> multiple times.\n2. I debugged my code to the last line of code before SendGrid takes over, and all of the images SRC are identical and works properly up to that point.</p>\n\n<p>Here is the content of the campaign email before Sendgrid takes over, notice that the 7th img tag is identical to all of the other img tags:</p>\n\n<p><a href=\"http://pastebin.com/UxTUxxLY\" rel=\"nofollow\">http://pastebin.com/UxTUxxLY</a></p>\n\n<p>and this is what renders in the email itself (dev tools on the mail),\nNotice how the 7th img tag SRC attribute is different than the rest, even though its the same image:</p>\n\n<p><a href=\"http://pastebin.com/EWB4a0tR\" rel=\"nofollow\">http://pastebin.com/EWB4a0tR</a></p>\n\n<p>Iv tried different email supplier such as hotmail to see wheter its an issue with gmail specificly, and its not.</p>\n\n<p>any idea what could be the source of the image breaking?</p>\n"}, {"tags": ["ruby", "activeadmin"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476887840, "post_id": 40134392, "comment_id": 67538845, "body": "Does a user always have both, a first name and a surname?"}], "answers": [{"comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1476888311, "post_id": 40134457, "comment_id": 67539224, "body": "I prefer the version that uses string interpolation, because version that concatenates the string with <code>+</code> fails when <code>f_name</code> is <code>nil</code>."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1476888351, "post_id": 40134457, "comment_id": 67539261, "body": "@spickermann for me string interpolation always looked better, so +1"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1476887684, "creation_date": 1476887684, "answer_id": 40134457, "question_id": 40134392, "link": "https://stackoverflow.com/questions/40134392/ror-def-to-s-for-two-names-labels/40134457#40134457", "title": "RoR: def to_s for two names/labels", "body": "<p>You can use interpolation:</p>\n\n<pre><code>def to_s\n  \"#{f_name} {l_name}\" # or f_name + ' ' + l_name\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 343, "user_id": 5419275, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d8823ae602d94a408b1e72f78b7df34b?s=128&d=identicon&r=PG&f=1", "display_name": "Co2", "link": "https://stackoverflow.com/users/5419275/co2"}, "edited": false, "score": 0, "creation_date": 1476887967, "post_id": 40134470, "comment_id": 67538936, "body": "Thanks both! Both approaches work. Thanks very much :) Can&#39;t tick for a few minutes!"}], "tags": [], "owner": {"reputation": 15486, "user_id": 719547, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/51e61f099c7b1ac0588ecda69193f75c?s=128&d=identicon&r=PG", "display_name": "Jim Stewart", "link": "https://stackoverflow.com/users/719547/jim-stewart"}, "is_accepted": false, "score": 1, "last_activity_date": 1476887714, "creation_date": 1476887714, "answer_id": 40134470, "question_id": 40134392, "link": "https://stackoverflow.com/questions/40134392/ror-def-to-s-for-two-names-labels/40134470#40134470", "title": "RoR: def to_s for two names/labels", "body": "<p>The simplest version is to just return a string concatenating both name parts:</p>\n\n<pre><code>def to_s\n  \"#{f_name} #{s_name}\"\nend\n</code></pre>\n\n<p>In Ruby, the last value in a method is the implied return value. There are more explicit ways to do this, and other ways to concatenate strings. You could do this as well:</p>\n\n<pre><code>def to_s\n  return f_name + ' ' + s_name\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "is_accepted": true, "score": 2, "last_activity_date": 1476887830, "creation_date": 1476887830, "answer_id": 40134515, "question_id": 40134392, "link": "https://stackoverflow.com/questions/40134392/ror-def-to-s-for-two-names-labels/40134515#40134515", "title": "RoR: def to_s for two names/labels", "body": "<p>If it is possible that you have only a first or last name, then consider:</p>\n\n<pre><code>def full_name\n  [first_name, last_name].compact.join(' ')\nend\n\ndef to_s\n  full_name\nend\n</code></pre>\n\n<p>Whatever technique you use, I would recommend that you create a method to express the full name, and then reference that in the to_s method.</p>\n"}], "owner": {"reputation": 343, "user_id": 5419275, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d8823ae602d94a408b1e72f78b7df34b?s=128&d=identicon&r=PG&f=1", "display_name": "Co2", "link": "https://stackoverflow.com/users/5419275/co2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 40134515, "answer_count": 3, "score": 0, "last_activity_date": 1476887830, "creation_date": 1476887526, "question_id": 40134392, "link": "https://stackoverflow.com/questions/40134392/ror-def-to-s-for-two-names-labels", "title": "RoR: def to_s for two names/labels", "body": "<p>I am using def to_s to change the numerical value of a user in to the string. </p>\n\n<p>A user has a first name and a surname though - f_name and s_name.</p>\n\n<p>In my model:</p>\n\n<pre><code>def to_s\nf_name\nend\n</code></pre>\n\n<p>Works fine. But how can I get the surname alongside?? Thx</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "is_accepted": false, "score": 2, "last_activity_date": 1476887948, "last_edit_date": 1476887948, "creation_date": 1476887614, "answer_id": 40134424, "question_id": 40134368, "link": "https://stackoverflow.com/questions/40134368/how-do-i-check-if-a-value-is-present-within-my-array-rails-4/40134424#40134424", "title": "How do I check if a value is present within my array? - Rails 4", "body": "<p>These should work as well</p>\n\n<pre><code>attendees.include?(user) #always use parentheses with methods like this\n\nattendees.select {|a| a.id == 4}.present?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1476887626, "creation_date": 1476887626, "answer_id": 40134430, "question_id": 40134368, "link": "https://stackoverflow.com/questions/40134368/how-do-i-check-if-a-value-is-present-within-my-array-rails-4/40134430#40134430", "title": "How do I check if a value is present within my array? - Rails 4", "body": "<p>if you have an id of your model and you want to perform a check with a SQL query you can do</p>\n\n<pre><code>User.exists?(4)\n</code></pre>\n\n<p>Or, in a normal array object, you need the entire User object</p>\n\n<pre><code>attendees.include?(user)\n</code></pre>\n\n<p>or, with just the id</p>\n\n<pre><code>attendees.find { |attendee| attendee.id == 4 }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476887927, "post_id": 40134477, "comment_id": 67538900, "body": "thats very javascripty"}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": false, "score": 2, "last_activity_date": 1476888070, "last_edit_date": 1476888070, "creation_date": 1476887735, "answer_id": 40134477, "question_id": 40134368, "link": "https://stackoverflow.com/questions/40134368/how-do-i-check-if-a-value-is-present-within-my-array-rails-4/40134477#40134477", "title": "How do I check if a value is present within my array? - Rails 4", "body": "<p>If you need just check, you can write like:</p>\n\n<pre><code>!!attendees.find_by(user_id: 4)\n#=&gt; true or false\n</code></pre>\n\n<p>If you want to do it in Rails-style, you can use <code>present?</code>:</p>\n\n<pre><code>attendees.find_by(user_id: 4).present?\n#=&gt; true or false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1377, "user_id": 3734125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4c82fc440ab08376bc41a5e229c86e26?s=128&d=identicon&r=PG", "display_name": "ARTLoe", "link": "https://stackoverflow.com/users/3734125/artloe"}, "edited": false, "score": 0, "creation_date": 1476888844, "post_id": 40134628, "comment_id": 67539623, "body": "Thank you @spickermann! this works perfectly in the views.  <code>&lt;% if @social.attendances.exists?(user: current_user) %&gt; #do something &lt;% end %&gt;</code>  how will i write this in the social.rb model -  would it be like this ---------&gt;<code>def attending?     self.attendances.exists?(user: user)   end</code>"}, {"owner": {"reputation": 1377, "user_id": 3734125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4c82fc440ab08376bc41a5e229c86e26?s=128&d=identicon&r=PG", "display_name": "ARTLoe", "link": "https://stackoverflow.com/users/3734125/artloe"}, "edited": false, "score": 0, "creation_date": 1476889611, "post_id": 40134628, "comment_id": 67540268, "body": "figured it out! - thanks @spickemann!  social.rb <code>def attending?(user)     self.attendances.exists?(user: user)   end</code>     views/social/show.html.erb <code>&lt;% if @social.attending?(current_user) %&gt;   #do something &lt;% end %&gt;</code>"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1476888103, "creation_date": 1476888103, "answer_id": 40134628, "question_id": 40134368, "link": "https://stackoverflow.com/questions/40134368/how-do-i-check-if-a-value-is-present-within-my-array-rails-4/40134628#40134628", "title": "How do I check if a value is present within my array? - Rails 4", "body": "<p>I would do something like this:</p>\n\n<pre><code>user = User.find(4)\nsocial = Social.find(10)\n\nsocial.attendances.exists?(user: user)\n</code></pre>\n"}], "owner": {"reputation": 1377, "user_id": 3734125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4c82fc440ab08376bc41a5e229c86e26?s=128&d=identicon&r=PG", "display_name": "ARTLoe", "link": "https://stackoverflow.com/users/3734125/artloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 40134628, "answer_count": 4, "score": 0, "last_activity_date": 1476888103, "creation_date": 1476887484, "question_id": 40134368, "link": "https://stackoverflow.com/questions/40134368/how-do-i-check-if-a-value-is-present-within-my-array-rails-4", "title": "How do I check if a value is present within my array? - Rails 4", "body": "<p>Can one kindly advise me how i do check if my array includes a value.</p>\n\n<ul>\n<li>i have an array <code>attendees = social.attendances</code> </li>\n<li>i am trying to check if the <code>user = User.find(4)</code> is present within the <code>attendees</code> array </li>\n</ul>\n\n<blockquote>\n  <p>Terminal</p>\n</blockquote>\n\n<pre><code>user = User.find(4)\n  User Load (1.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 4]]\n =&gt; #&lt;User id: 4, email: \"emma@gmail.com\"&gt; \n\n\nsocial = Social.find(10)\n  Social Load (0.3ms)  SELECT  \"socials\".* FROM \"socials\" WHERE \"socials\".\"id\" = ? LIMIT 1  [[\"id\", 10]]\n =&gt; #&lt;Social id: 10, title: \"How to successfully fundraise\"&gt; \n\n\nattendees = social.attendances\n =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;user_id: 10&gt;, #&lt;user_id: 4&gt;, #&lt;user_id: 14&gt;, #&lt;user_id: 9&gt;, #&lt;user_id: 6&gt;]&gt; \n</code></pre>\n\n<blockquote>\n  <p>i tried the below:</p>\n</blockquote>\n\n<p>i tried the below in the terminal but no luck</p>\n\n<pre><code> attendees.include?(user_id:4)\n =&gt; false \n\nattendees.include? \"user_id:4\"\n =&gt; false\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476888508, "post_id": 40134548, "comment_id": 67539371, "body": "Perfect! Its getting passed in URL now but still it is not getting saved in the item_id hidden field."}, {"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476888872, "post_id": 40134548, "comment_id": 67539644, "body": "Got it. Had to change in controller from"}, {"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476888956, "post_id": 40134548, "comment_id": 67539710, "body": "Got it. Had to change in controller from <code>def create     @recipe_ingredient = RecipeIngredient.new(:item_id =&gt; params[:item_id])</code> to <code>@recipe_ingredient = RecipeIngredient.new(recipe_ingredient_params)</code>"}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": true, "score": 1, "last_activity_date": 1476887913, "creation_date": 1476887913, "answer_id": 40134548, "question_id": 40134245, "link": "https://stackoverflow.com/questions/40134245/passing-a-parameter-received-in-link-to-to-different-actions-in-controller/40134548#40134548", "title": "Passing a parameter received in link_to to different actions in controller", "body": "<p>You're not setting the <code>@item_id</code> instance variable that you use here:</p>\n\n<pre><code>&lt;%= link_to 'New Recipe Ingredient', new_recipe_ingredient_path(:item_id =&gt; @item_id) %&gt;\n</code></pre>\n\n<p>In the controller action for that view, you should set the variable:</p>\n\n<pre><code>@item_id = params[:item_id]\n</code></pre>\n\n<p>Or just use the params directly in the view:</p>\n\n<pre><code>&lt;%= link_to 'New Recipe Ingredient', new_recipe_ingredient_path(item_id: params[:item_id]) %&gt;\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40134548, "answer_count": 1, "score": 0, "last_activity_date": 1476887913, "creation_date": 1476887201, "question_id": 40134245, "link": "https://stackoverflow.com/questions/40134245/passing-a-parameter-received-in-link-to-to-different-actions-in-controller", "title": "Passing a parameter received in link_to to different actions in controller", "body": "<p>I have an Item model as below.</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n  belongs_to :item_type, :class_name=&gt;ItemType, :foreign_key=&gt;\"item_type_id\"\nend\n</code></pre>\n\n<p>and a RecipeIngredient model as below</p>\n\n<pre><code>class RecipeIngredient &lt; ApplicationRecord\n  belongs_to :item, :class_name=&gt;Item, :foreign_key=&gt;\"item_id\"\n  belongs_to :ingredient, :class_name=&gt;Ingredient, :foreign_key=&gt;\"ingredient_id\"\n  validates_numericality_of :quantity\nend\n</code></pre>\n\n<p>From the index view of items, I am passing the item_id to the index view of recipe_ingredients as below</p>\n\n<pre><code>&lt;td&gt;&lt;%= link_to 'Add Recipe', recipe_ingredients_path(:item_id =&gt;item.id) %&gt;&lt;/td&gt;\n</code></pre>\n\n<p>and the index view of recipe_ingredients only displays those ingredients which belong to the item with item_id as received in URL. For that the controller for RecipeIngredient is like this.</p>\n\n<pre><code> def index\n    @recipe_ingredients = RecipeIngredient.where(:item_id =&gt; params[:item_id])\n  end\n</code></pre>\n\n<p>now I am trying to pass the same item_id to newrecipe ingredient form from the index page of recipe ingredient like this.</p>\n\n<pre><code>&lt;%= link_to 'New Recipe Ingredient', new_recipe_ingredient_path(:item_id =&gt; @item_id) %&gt;\n</code></pre>\n\n<p>and the whole controller file for recipe ingredients, including new is given below.</p>\n\n<pre><code>class RecipeIngredientsController &lt; ApplicationController\n  before_action :set_recipe_ingredient, only: [:show, :edit, :update, :destroy]\n\n  # GET /recipe_ingredients\n  # GET /recipe_ingredients.json\n  def index\n    @recipe_ingredients = RecipeIngredient.where(:item_id =&gt; params[:item_id])\n  end\n\n  # GET /recipe_ingredients/1\n  # GET /recipe_ingredients/1.json\n  def show\n  end\n\n  # GET /recipe_ingredients/new\n  def new\n    @recipe_ingredient = RecipeIngredient.new(:item_id =&gt; params[:item_id])\n  end\n\n  # GET /recipe_ingredients/1/edit\n  def edit\n  end\n\n  # POST /recipe_ingredients\n  # POST /recipe_ingredients.json\n  def create\n    @recipe_ingredient = RecipeIngredient.new(:item_id =&gt; params[:item_id])\n\n    respond_to do |format|\n      if @recipe_ingredient.save\n        format.html { redirect_to @recipe_ingredient, notice: 'Recipe ingredient was successfully created.' }\n        format.json { render :show, status: :created, location: @recipe_ingredient }\n      else\n        format.html { render :new }\n        format.json { render json: @recipe_ingredient.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /recipe_ingredients/1\n  # PATCH/PUT /recipe_ingredients/1.json\n  def update\n    respond_to do |format|\n      if @recipe_ingredient.update(recipe_ingredient_params)\n        format.html { redirect_to @recipe_ingredient, notice: 'Recipe ingredient was successfully updated.' }\n        format.json { render :show, status: :ok, location: @recipe_ingredient }\n      else\n        format.html { render :edit }\n        format.json { render json: @recipe_ingredient.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /recipe_ingredients/1\n  # DELETE /recipe_ingredients/1.json\n  def destroy\n    @recipe_ingredient.destroy\n    respond_to do |format|\n      format.html { redirect_to recipe_ingredients_url, notice: 'Recipe ingredient was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_recipe_ingredient\n      @recipe_ingredient = RecipeIngredient.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def recipe_ingredient_params\n      params.require(:recipe_ingredient).permit(:item_id, :ingredient_id, :quantity)\n    end\nend\n</code></pre>\n\n<p>but the URL to new recipe ingredient does not contain the parameter and hence the form as below which has a hidden field (mandatory) of item_id gives error of field being empty.</p>\n\n<pre><code>&lt;%= form_for(recipe_ingredient) do |f| %&gt;\n  &lt;% if recipe_ingredient.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(recipe_ingredient.errors.count, \"error\") %&gt; prohibited this recipe_ingredient from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% recipe_ingredient.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.hidden_field :item_id %&gt;\n  &lt;/div&gt;\n\n &lt;div class=\"field\"&gt;\n    &lt;%= f.label :ingredient_id %&gt;\n    &lt;%= f.collection_select :ingredient_id, Ingredient.all, :id, :ingredient %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :quantity %&gt;\n    &lt;%= f.text_field :quantity %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476887422, "post_id": 40134255, "comment_id": 67538502, "body": "Sorry the question was mistyped, this is how I have my query, but it still doesn&#39;t work."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476887463, "post_id": 40134255, "comment_id": 67538552, "body": "@user2320239 I&#39;ve edited it according to the edit (i did not notice, you wanted only persons, that have at least one pet)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476887538, "post_id": 40134255, "comment_id": 67538613, "body": "@user2320239 you want to use <code>joins</code> for INNER JOIN, and includes for LEFT OUTER, which means, <code>joins</code> returns only persons with pets, whereas <code>includes</code> would return all persons, with those, that do not have pets at the end of the list"}, {"owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476887947, "post_id": 40134255, "comment_id": 67538919, "body": "Thanks for the replies, though this seems to not work, Person.joins(:pets).where(pets: { mammal: true }).count returns 14, whereas Person.count returns 12, obviously the number of people with mammal pets has to be less than or equal to the number of people"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476887979, "post_id": 40134255, "comment_id": 67538947, "body": "@user2320239 add <code>.group(&#39;persons.id&#39;)</code> to the end of my query"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476889516, "post_id": 40134255, "comment_id": 67540175, "body": "@user2320239 did <code>.group(&#39;persons.id&#39;)</code> do the thing? (I mean, it did, but have you got a moment to test it :D)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1476888000, "last_edit_date": 1476888000, "creation_date": 1476887222, "answer_id": 40134255, "question_id": 40134228, "link": "https://stackoverflow.com/questions/40134228/getting-records-where-attributes-have-certain-value/40134255#40134255", "title": "Getting records where attributes have certain value", "body": "<p>In <code>where</code> clause there should be the actual name of the database table - in your case its <code>pets</code>:</p>\n\n<pre><code>Person.joins(:pets).where(pets: { mammal: true }).group('persons.id')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1476887538, "creation_date": 1476887538, "answer_id": 40134397, "question_id": 40134228, "link": "https://stackoverflow.com/questions/40134228/getting-records-where-attributes-have-certain-value/40134397#40134397", "title": "Getting records where attributes have certain value", "body": "<p>Another option:</p>\n\n<p><code>Person.where id: Pet.where(mammal: true).pluck('distinct person_id')</code></p>\n"}], "owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476888134, "creation_date": 1476887170, "last_edit_date": 1476888134, "question_id": 40134228, "link": "https://stackoverflow.com/questions/40134228/getting-records-where-attributes-have-certain-value", "title": "Getting records where attributes have certain value", "body": "<p>I have a project with a model Person, a person has many Pets, and a Pet and a Boolean attribute Mammal, Id like to be able to retrieve all people whose have at least one pet who is a mammal, but I'm not sure how to do this, I've tried: </p>\n\n<pre><code>Person.includes(:pets).where(pets: {mammal: true})\n</code></pre>\n\n<p>but it doesn't seem to work. What is the best way for me to do this?</p>\n"}, {"tags": ["ruby", "anemone"], "answers": [{"tags": [], "owner": {"reputation": 3798, "user_id": 1012952, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/572a69029f51ac0b75b5195c53495fc9?s=128&d=identicon&r=PG", "display_name": "Killerpixler", "link": "https://stackoverflow.com/users/1012952/killerpixler"}, "is_accepted": true, "score": 0, "last_activity_date": 1479394733, "creation_date": 1479394733, "answer_id": 40658132, "question_id": 40134098, "link": "https://stackoverflow.com/questions/40134098/anemone-crawler-skip-links-like-not-obeyed/40658132#40658132", "title": "Anemone Crawler skip_links_like not obeyed", "body": "<p>Turns out the <code>skip_links_like</code> method takes URIs not URLs meaning you can only match on parts after the top level domian so instead of this:</p>\n\n<pre><code>crawler.skip_links_like(/(.+com\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*)|(\\.(jpg|pdf|png|jpeg)$)/)\n</code></pre>\n\n<p>I had to use this:</p>\n\n<pre><code>crawler.skip_links_like(/(^\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*)|(\\.(jpg|pdf|png|jpeg)$)/)\n</code></pre>\n\n<p>or just the REGEX differences:</p>\n\n<p>Wrong: <code>.+com\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*</code></p>\n\n<p>Right: <code>^\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*</code></p>\n"}], "owner": {"reputation": 3798, "user_id": 1012952, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/572a69029f51ac0b75b5195c53495fc9?s=128&d=identicon&r=PG", "display_name": "Killerpixler", "link": "https://stackoverflow.com/users/1012952/killerpixler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 40658132, "answer_count": 1, "score": 0, "last_activity_date": 1479394733, "creation_date": 1476886870, "question_id": 40134098, "link": "https://stackoverflow.com/questions/40134098/anemone-crawler-skip-links-like-not-obeyed", "title": "Anemone Crawler skip_links_like not obeyed", "body": "<p>I am using <code>Anemone</code> to crawl a massive site that to make things worse has the same content on a few different language versions.</p>\n\n<p>There is <code>domain.com/</code> for the main language and <code>domain.com/de/</code>, <code>domain.com/es/</code> for the other languages so I decided to exclude these in the crawl like so:</p>\n\n<pre><code>crawler = Anemone::Core.new('http://domain.com', opts = {skip_query_strings: true})\ncrawler.skip_links_like(/(.+com\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*)|(\\.(jpg|pdf|png|jpeg)$)/)\n</code></pre>\n\n<p>However when looking at what is being crawled via a <code>puts page.url</code> in the <code>on_every_page do |page|</code> block I can see that it is still crawling all the many language variations.</p>\n\n<p>I've even tried to include this </p>\n\n<pre><code>crawler.focus_crawl{|page| page.links.reject{|i| !i.to_s.match(/(.+com\\/(fi|de|it|no|se|en-bm|dk|fr|ie|en-nz|es|int).*)|(\\.(jpg|pdf|png|jpeg)$)/).nil? }}\n</code></pre>\n\n<p>To remove the language links from what is being considered next in the list of pages to crawl.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["css", "ruby", "gruntjs", "mustache", "amp-html"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1476904184, "post_id": 40134010, "comment_id": 67549140, "body": "i think you have the right idea - if you get your compiled stylesheet to a file you can use ERB and html_safe to interpolate the css into the html. You can use <code>if Rails.env.production?</code> to distinguish between development and production logic."}, {"owner": {"reputation": 1455, "user_id": 2274900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa6c355c642a86a8a18c956dbe67a972?s=128&d=identicon&r=PG", "display_name": "chinds", "link": "https://stackoverflow.com/users/2274900/chinds"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1476950213, "post_id": 40134010, "comment_id": 67566425, "body": "HI max, thanks for the advice, Ill check those out now!"}, {"owner": {"reputation": 1455, "user_id": 2274900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa6c355c642a86a8a18c956dbe67a972?s=128&d=identicon&r=PG", "display_name": "chinds", "link": "https://stackoverflow.com/users/2274900/chinds"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1476965423, "post_id": 40134010, "comment_id": 67576909, "body": "Sorry just relaised what you mentioned was from rails. This project is not using rails. is their a similar alternative for plain old Ruby of mustahce?"}], "owner": {"reputation": 1455, "user_id": 2274900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa6c355c642a86a8a18c956dbe67a972?s=128&d=identicon&r=PG", "display_name": "chinds", "link": "https://stackoverflow.com/users/2274900/chinds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518082160, "creation_date": 1476886703, "last_edit_date": 1518082160, "question_id": 40134010, "link": "https://stackoverflow.com/questions/40134010/inline-css-at-build-time-using-mustache-ruby", "title": "Inline CSS at build time using mustache/ruby", "body": "<p>I have project built using RUBY with grunt as its asset pipeline. At build time I need to take all the styles from the <code>/dist/all.min.css</code> file and place them into a custom style tag in the head <code>&lt;style amp-custom&gt;...&lt;/style</code>.</p>\n\n<p>When developing I include the css as a linked stylesheet in the head. Which is fine. But when this is live the styles must be inlined.</p>\n\n<p>I have tried a few grunt emailer tasks which are designed to take any linked asset and inline it, however this either didn't work or would take all linked assets and try and inline them and there are a few JS links that i do not what inlined, only the stylesheet.</p>\n\n<p><strong>head during development</strong></p>\n\n<pre><code>&lt;head&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;link rel=\"canonical\" href=\"/index.html\" data-embed-ignore&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\"&gt;\n\n    &lt;!-- Linked stylesheet for developing --&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"{{{asset_base}}}/css/all.css\" data-embed&gt;\n\n    &lt;script async custom-element=\"amp-image-lightbox\" src=\"https://cdn.ampproject.org/v0/amp-image-lightbox-0.1.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://cdn.ampproject.org/v0.js\" async data-embed-ignore&gt;&lt;/script&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p><strong>desired head for production</strong></p>\n\n<pre><code>&lt;head&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;link rel=\"canonical\" href=\"/index.html\" data-embed-ignore&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\"&gt;\n\n    &lt;!-- Inlined styles --&gt;\n    &lt;style amp-custom&gt;\n      /* Custom styles here */\n    &lt;/style&gt;\n\n    &lt;script async custom-element=\"amp-image-lightbox\" src=\"https://cdn.ampproject.org/v0/amp-image-lightbox-0.1.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"https://cdn.ampproject.org/v0.js\" async data-embed-ignore&gt;&lt;/script&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>I am using mustache for the templating engine and was think i could somehow include the css file if its available. This way when i do the production grunt task it could remove the linked style tag and generate the file thats included via mustache. But i am not entirely sure how to do that or even if it will work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1476886887, "post_id": 40133961, "comment_id": 67538006, "body": "first of all that&#39;s alot of rails tags for different versions what version are you actually running. that being said you would have to use a string where for the or portion. what is not working about this other than you are probably missing some parens"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1476888197, "post_id": 40133961, "comment_id": 67539137, "body": "What Rails version are you actually using? Please clean up the tags."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1476888393, "post_id": 40133961, "comment_id": 67539288, "body": "What is &quot;not working&quot;? Error messages? Expected behavior? Actual Behavior?"}], "answers": [{"tags": [], "owner": {"reputation": 12694, "user_id": 1174001, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b27f05489e2cebe5948277c2ca561a93?s=128&d=identicon&r=PG", "display_name": "CDub", "link": "https://stackoverflow.com/users/1174001/cdub"}, "is_accepted": false, "score": 0, "last_activity_date": 1476990000, "creation_date": 1476990000, "answer_id": 40162495, "question_id": 40133961, "link": "https://stackoverflow.com/questions/40133961/or-in-where-clause-when-working-with-nested-includes-or-joins-with-association/40162495#40162495", "title": "OR in where clause when working with nested includes or joins with association", "body": "<p>As commented, without knowing the actual version of Rails you're using, I'll presume it's Rails 3... In which case, I'd suggest using Arel. Something like:</p>\n\n<pre><code>Inventory.includes(:category, :inventory_tiers, modifiers: [:modifier_measures, :modifier_tiers])\n  .where(categories: { category_tag: 'Dry' }, location_id: 12, inventory_tiers: { tier: 1 })\n  .where(Modifier.arel_table[:category_tag].eq(\"Wet\").or(ModifierTier.arel_table[:tier].eq(1)))\n</code></pre>\n\n<p>I haven't tested this, but the above should get you on the right path.</p>\n"}], "owner": {"reputation": 238, "user_id": 6223167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1721395208137173/picture?type=large", "display_name": "Manoj Datt", "link": "https://stackoverflow.com/users/6223167/manoj-datt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476990000, "creation_date": 1476886579, "last_edit_date": 1476915060, "question_id": 40133961, "link": "https://stackoverflow.com/questions/40133961/or-in-where-clause-when-working-with-nested-includes-or-joins-with-association", "title": "OR in where clause when working with nested includes or joins with association", "body": "<p>I have to use OR in where clause when working with nested includes with association.\nI have an ActiveRecord query as follows:</p>\n\n<pre><code>  Inventory.includes(:category,:inventory_tiers,:modifiers=&gt;[:modifier_measures,:modifier_tiers])\n  .where(\n    :categories =&gt; { category_tag: 'Dry'},\n    :location_id =&gt;12,\n    :inventory_tiers =&gt; {:tier =&gt; 1}),\n    modifiers: {category_tag:\"Wet\"},\n    modifier_tiers: {tier:1}\n)\n</code></pre>\n\n<p>in which where clause uses AND for all conditions.\nbut I want to use OR for last two conditions, something like:</p>\n\n<pre><code>Inventory.includes(:category,:inventory_tiers,:modifiers=&gt;[:modifier_measures,:modifier_tiers]).where(\"categories.category_tag=? AND location_id=? AND inventory_tiers.tier = ? OR modifiers.category_tag=? OR modifier_tiers.tier=?\", \"Wet\",12,1,\"Wet\",1).select(\"inventories.id,inventories.name,inventories.photo,inventory_tiers.sell_price, modifiers.id,modifiers.name,modifiers.price,modifier_measures.id as measure_id,modifier_measures.name as measure,modifier_measures.price as measure_price,modifier_measures.measure_value\")\n</code></pre>\n\n<p>but its not working.\nHow i can rewrite the syntax?</p>\n"}, {"tags": ["ruby", "jruby"], "comments": [{"owner": {"reputation": 1872, "user_id": 4091324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/razpB.jpg?s=128&g=1", "display_name": "Darth Kotik", "link": "https://stackoverflow.com/users/4091324/darth-kotik"}, "edited": false, "score": 0, "creation_date": 1476886204, "post_id": 40133708, "comment_id": 67537434, "body": "Can&#39;t you just inherit <code>IArray</code> from <code>Array</code>? No conversions needed than"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1476886270, "post_id": 40133708, "comment_id": 67537493, "body": "<i>&quot;I&#39;ve implemented <code>is_a?</code> and <code>kind_of?</code> for <code>a2</code>&quot;</i> \u2013 where is that implementation? Besides, your code works just fine for me. <code>concat</code> calls <code>to_ary</code> which is handled / forwarded by <code>method_missing</code>."}, {"owner": {"reputation": 147, "user_id": 2429102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41d4ee7d85eee6a9f8f9d29d3114ad85?s=128&d=identicon&r=PG", "display_name": "Rodrigo Botafogo", "link": "https://stackoverflow.com/users/2429102/rodrigo-botafogo"}, "edited": false, "score": 0, "creation_date": 1476890480, "post_id": 40133708, "comment_id": 67540874, "body": "Stefan I&#180;ve implemented <i>is_a?</i> <i>and kind_of?</i> in class IArray and they are never called.  It is true that concat calls to_ary, but the return value of to_ary should be an array and in my case I cannot return @array, I want the call to go through method_missing."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 2429102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41d4ee7d85eee6a9f8f9d29d3114ad85?s=128&d=identicon&r=PG", "display_name": "Rodrigo Botafogo", "link": "https://stackoverflow.com/users/2429102/rodrigo-botafogo"}, "edited": false, "score": 0, "creation_date": 1476891275, "post_id": 40133800, "comment_id": 67541413, "body": "Does&#180;t seem to work either for what I need. Maybe a bit more of background will clarify why I need what I need (or someone can come with a completely different idea):  I&#180;m using a java library into which I can &quot;inject&quot; objects.  Since I&#180;m working with JRuby, my array object is just a java object that gets injected into the library.  Once injected, unfortunately I cannot access it as a ruby object, it becomes a wrapped java object in the library.  To call a method on it I need to use the library&#180;s API.  So, I need to capture the call &amp; forward to the wrapped array by means of this API. Clearer?"}], "tags": [], "owner": {"reputation": 37836, "user_id": 24195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb4bebe360045a2dce663ee875f13723?s=128&d=identicon&r=PG", "display_name": "Rob Di Marco", "link": "https://stackoverflow.com/users/24195/rob-di-marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1476886197, "creation_date": 1476886197, "answer_id": 40133800, "question_id": 40133708, "link": "https://stackoverflow.com/questions/40133708/ruby-can-i-wrap-a-class-in-another-class-completely-transparently/40133800#40133800", "title": "Ruby: Can I wrap a class in another class completely transparently?", "body": "<p>Take a look at <a href=\"http://ruby-doc.org/stdlib-2.2.1/libdoc/delegate/rdoc/SimpleDelegator.html\" rel=\"nofollow\">SimpleDelegator</a>. I think that will meet your needs.</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 2429102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41d4ee7d85eee6a9f8f9d29d3114ad85?s=128&d=identicon&r=PG", "display_name": "Rodrigo Botafogo", "link": "https://stackoverflow.com/users/2429102/rodrigo-botafogo"}, "edited": false, "score": 0, "creation_date": 1476975977, "post_id": 40139339, "comment_id": 67585056, "body": "J&#246;rg... thanks for your thoughtful answer... much more than I had hoped for!  Can you take a look at my solution bellow and comment on where it can break and what is missing?  Thanks!!"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 2, "last_activity_date": 1476903414, "last_edit_date": 1476903414, "creation_date": 1476902997, "answer_id": 40139339, "question_id": 40133708, "link": "https://stackoverflow.com/questions/40133708/ruby-can-i-wrap-a-class-in-another-class-completely-transparently/40139339#40139339", "title": "Ruby: Can I wrap a class in another class completely transparently?", "body": "<p>No, unfortunately, it is not possible in Ruby for one object to simulate another fully. This is an unfortunate limitation, since one object simulating another is one of the cornerstones of OO, and Ruby is an OO language, so this should really be possible.</p>\n\n<p>There are three main reasons why it is impossible:</p>\n\n<ul>\n<li><strong>Reference Equality</strong>: Reference Equality (<a href=\"http://ruby-doc.org/core/BasicObject.html#method-i-equal-3F\" rel=\"nofollow\"><code>BasicObject#equal?</code></a>) breaks simulation, and thus OO. Comparing for Reference Equality allows you to distinguish the simulating object from the simulated object, which should not be possible. You can monkey patch <code>BasicObject</code> to remove or replace <code>equal?</code>, but that will probably break things left and right.</li>\n<li><strong>Boolean operators and conditionals</strong>: Boolean operators and conditionals consider only the two singleton objects <code>nil</code> and <code>false</code> to be <em>falsy</em>. There is no way to write your own <em>falsy</em> object, therefore, there is no way to simulate <code>nil</code> or <code>false</code>.</li>\n<li><strong>Classes instead of Protocols as Types</strong>: some core library and standard library methods as well as some hardcoded internals expect objects to be instances of a specific class to be able to work with them, even though according to OO principles, an object which speaks the same Protocol should have the same Type, regardless of its Class.</li>\n</ul>\n\n<p>You can get quite far, though:</p>\n\n<ul>\n<li>Very few methods (actually, no methods, I believe) in the core library and standard library check for Reference Equality.</li>\n<li>You will seldom have the requirement to simulate <code>nil</code> or <code>false</code>.</li>\n<li>Almost always when a particular subroutine requires a particular class, it will provide a level of indirection as an escape hatch and call some conversion method (e.g. the unary prefix ampersand <code>&amp;</code> operator calls <code>to_proc</code>, the unary prefix asterisk <code>*</code> \"splat\" operator calls <code>to_a</code>, <code>print</code> calls <code>to_s</code>, <code>Array#[]</code> calls <code>to_int</code>, and so on). Plus, at least for <code>Numeric</code>s, there is a defined coercion protocol.</li>\n</ul>\n\n<p>However, in your specific case, you run into one of those cases where it simply doesn't work: while <code>to_ary</code> lets you get a long way toward making something that simulates an <code>Array</code>, in your case, you need to further keep track of your <code>IArray</code>, but of course converting it to an <code>Array</code> loses both its identity and its additional behavior. Unfortunately, you're screwed. There's nothing more you can do.</p>\n\n<p>In an ideal OO world, two objects that speak the same protocol should be considered to be of the same type, ergo <code>Array#concat</code> shouldn't care about whether or not its argument is an instance of <code>Array</code> (or can be converted to one), but rather whether its argument speaks the same protocol as <code>Array</code> (or more precisely: speaks the subset of the protocol that <code>concat</code> <em>actually</em> requires).</p>\n\n<p>I can only speculate why Ruby doesn't follow the OO paradigm in this case: performance. In OO, one object can never know the representation of another object, even if the two objects are of the same type (or the same class). This is the fundamental difference between Object-Oriented Data Abstraction and Data Abstraction based on Abstract Data Types: ADT instances can inspect the representation of other instances of the <em>same type</em>, objects can <em>not</em> the representation of <em>any</em> other object, even if it is of the same type (or class).</p>\n\n<p>However, this means that it is impossible for an operation to inspect the representation of two objects at once (the operation is either a method on a third object, which means that it cannot inspect the representation of either object, or it is a method of one of the two objects, in which case it can inspect its own object's representation but not the other's), and this means that it is impossible to write operations in OO that need access to the representation of two objects at once.</p>\n\n<p>E.g. concatenating two linked lists is O(1), if you have access to the first list's last element's <code>next</code> pointer, and the second list's first element's <code>prev</code> pointer, but in OO, you can access at most one of the two (unless the two lists explicitly expose a public method that gives access to the two pointers). And concatenating an array to another array requires access to the internal representation of both arrays to be fast, therefore Ruby decides to break OO encapsulation here and requires both objects to be of a class that it knows the internal memory layout of.</p>\n\n<p>This is unfortunate, and not purely OO, but it is a tradeoff that even \"hardcore OO\" languages like Smalltalk make for some of their core data types. (E.g. numbers, strings, arrays, and booleans.)</p>\n\n<p>In implementations like YARV, JRuby, and others, where significant portions of the core library are implemented with privileged access to the implementation's internals, there is another problem, in that it is very tempting (and there are no ways to prevent this) for core methods to bypass Ruby semantics, for a more convenient implementation. A completely unrelated example: implementing the various complex \"overloads\" of <code>Enumerable#inject</code> in YARV in C, or in JRuby in Java is easy: in YARV, the C function has privileged access to the interpreter internals and can thus inspect the arguments that are passed in ways someone trying to re-implement the method in Ruby cannot, in JRuby, there is some glue magic that allows you to implement those overloaded methods as actual Java overloaded methods, for even more convenience.</p>\n\n<p>Likewise, since all core methods have privileged access to the internal representation of objects in the implementation's GC memory, they will often check the class of an object by directly inspecting its in-memory representation instead of going through <code>class</code>, <code>is_a?</code>, <code>kind_of?</code>, or <code>instance_of?</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 2429102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41d4ee7d85eee6a9f8f9d29d3114ad85?s=128&d=identicon&r=PG", "display_name": "Rodrigo Botafogo", "link": "https://stackoverflow.com/users/2429102/rodrigo-botafogo"}, "is_accepted": false, "score": 0, "last_activity_date": 1476975891, "creation_date": 1476975891, "answer_id": 40158123, "question_id": 40133708, "link": "https://stackoverflow.com/questions/40133708/ruby-can-i-wrap-a-class-in-another-class-completely-transparently/40158123#40158123", "title": "Ruby: Can I wrap a class in another class completely transparently?", "body": "<p>Here is my (probably incomplete solution to the problem).  In order for this to work, all ruby objects must be \"packed\" in RBProxyObject as follows:</p>\n\n<pre><code>class RBProxyObject\n\n  attr_reader :ruby_obj\n\n  def initialize(ruby_obj)\n    @ruby_obj = ruby_obj\n  end\n\n  def is_a?(klass)\n    @ruby_obj.is_a?(klass)\n  end\n\n  def kind_of?(klass)\n    @ruby_obj.is_a?(klass)\n  end\n\n  def method_missing(symbol, *args, &amp;blk)\n    begin\n      @ruby_obj.send(symbol, *args, &amp;blk)\n    rescue TypeError\n      args[0].native(symbol, @ruby_obj, &amp;blk)\n    end\n  end\n\n  def native(*args)\n    method = args.shift\n    other = args.shift\n    other.send(method, @ruby_obj, *args)\n  end\n\nend\n</code></pre>\n\n<p>And now here is how it should be used:</p>\n\n<pre><code>a1 = [1, 2, 3]\na2 = [4, 5]\n\np1 = RBProxyObject.new(a1)\np2 = RBProxyObject.new(a2)\n\n\n&gt; p p1[0]\n  1\n&gt; p p2[1]\n  5\n\n&gt; p p1.is_a? Array\n  true\n\n&gt; p p1.concat(p2)\n  [1, 2, 3, 4, 5]\n</code></pre>\n\n<p>What other methods should be added to this class and where can it break?  Thanks...</p>\n"}], "owner": {"reputation": 147, "user_id": 2429102, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/41d4ee7d85eee6a9f8f9d29d3114ad85?s=128&d=identicon&r=PG", "display_name": "Rodrigo Botafogo", "link": "https://stackoverflow.com/users/2429102/rodrigo-botafogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 1, "accepted_answer_id": 40139339, "answer_count": 3, "score": 1, "last_activity_date": 1476975891, "creation_date": 1476886017, "last_edit_date": 1476888283, "question_id": 40133708, "link": "https://stackoverflow.com/questions/40133708/ruby-can-i-wrap-a-class-in-another-class-completely-transparently", "title": "Ruby: Can I wrap a class in another class completely transparently?", "body": "<p>I need to create a class like the following (the real problem is more complex)</p>\n\n<pre><code>class IArray\n  attr_reader :array\n\n  # array is a Ruby Array\n  def initialize(array)\n    @array = array\n  end\n\n  def method_missing(...)\n    # forwards every call to @array\n  end\nend\n</code></pre>\n\n<p>Now in my code I want to do</p>\n\n<pre><code>a1 = [1, 2, 3]\na2 = IArray.new([4, 5])\na1.concat(a2)\n</code></pre>\n\n<p>The last statement will not work, saying \"no implicit convertion of a2 to array\".  How does <code>a1</code> know that <code>a2</code> is not an array?  I\u00b4ve implemented <code>is_a?</code> and <code>kind_of?</code> for <code>a2</code> so that it returns <code>tru</code>e if asked if it is an array.  What I want is for <code>a1</code> to think <code>a2</code> is an array and then call any method on <code>a2</code> that it needs to do the merge.</p>\n\n<p>I would like the same to happen with any other class, i.e., just wrap it inside a class but let it work as if it were not wrapped.</p>\n"}, {"tags": ["ruby", "chef-infra", "chef-recipe", "chef-solo", "cookbook"], "comments": [{"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 2, "creation_date": 1476886204, "post_id": 40133670, "comment_id": 67537436, "body": "More <code>only_if %w(6 5).include?(node[&#39;platform_version&#39;)</code>. It&#39;s just a ruby test, so if you wish to do a X == 5 or 6, the best idea is to make an array of [5,6] and test if this array include the actual platform_version value."}, {"owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "reply_to_user": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 0, "creation_date": 1476886361, "post_id": 40133670, "comment_id": 67537576, "body": "do you think it might give wrong result if the platform version is 6.5. should i instead do <code>only_if %w(6 5).include?(node[&#39;platform_version&#39;].to_i)</code>"}, {"owner": {"reputation": 15030, "user_id": 3627607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fd623c0fdd0c93a2535cf6293ec5d?s=128&d=identicon&r=PG", "display_name": "Tensibai", "link": "https://stackoverflow.com/users/3627607/tensibai"}, "edited": false, "score": 1, "creation_date": 1476886581, "post_id": 40133670, "comment_id": 67537752, "body": "6.5 when called with to_i will return 6, so yes, it will be better."}], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 3956630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DzNBP.jpg?s=128&g=1", "display_name": "Yugendran", "link": "https://stackoverflow.com/users/3956630/yugendran"}, "is_accepted": false, "score": 0, "last_activity_date": 1549035715, "creation_date": 1549035715, "answer_id": 54482702, "question_id": 40133670, "link": "https://stackoverflow.com/questions/40133670/using-multiple-conditions-in-chef-only-if-guard/54482702#54482702", "title": "Using multiple conditions in Chef only_if guard", "body": "<p>The ruby commands in the guard block should be enclosed in {}. Also note that any ruby code inside the guard block will be executed at the converging phase i.e. run-time. I had a similar scenario and based on tensibai's comment above, I just used a array with pre-included values to be checked for the ubuntu version.</p>\n\n<pre><code>execute \"apt-get-update\" do\n  command \"apt-get update\"\n  ignore_failure true\n  notifies :install, 'package[ntp]', :immediately\n  not_if {[16.04, 18.04].include?(node['platform_version'].to_f) &amp;&amp; (node['packages'].keys.include? \"ntp\")}\n  #not_if {(node['packages'].keys.include? \"ntp\")}\nend\n</code></pre>\n\n<p>So for your scenario, I believe that the guard-block would be something like </p>\n\n<pre><code>execute 'run_command' do\n    command \"chkconfig service on\"\n    only_if {[5, 6].include?(node['platform_version'].to_i)} \nend\n</code></pre>\n"}], "owner": {"reputation": 8777, "user_id": 5632400, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1581444277a110a7b803f5ab4e4d14?s=128&d=identicon&r=PG&f=1", "display_name": "meallhour", "link": "https://stackoverflow.com/users/5632400/meallhour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4004, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549035715, "creation_date": 1476885930, "question_id": 40133670, "link": "https://stackoverflow.com/questions/40133670/using-multiple-conditions-in-chef-only-if-guard", "title": "Using multiple conditions in Chef only_if guard", "body": "<p>I am using the following chef resource: </p>\n\n<pre><code>execute 'run_command' do\n  command \"chkconfig service on\"\n  only_if node['platform_version'].to_i == 6, 5\nend\n</code></pre>\n\n<p>Please let me know if only_if guard is used in correct fashion</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "csv"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4126003, "user_type": "registered", "profile_image": "https://graph.facebook.com/1450745926/picture?type=large", "display_name": "Chuck Baker", "link": "https://stackoverflow.com/users/4126003/chuck-baker"}, "edited": false, "score": 0, "creation_date": 1476886386, "post_id": 40133553, "comment_id": 67537597, "body": "Thanks Ursus it&#39;s working now.  I knew it would be something simple.  Thanks again"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1476885638, "creation_date": 1476885638, "answer_id": 40133553, "question_id": 40133491, "link": "https://stackoverflow.com/questions/40133491/rails-4-hash-accessing-values-returns-nil/40133553#40133553", "title": "Rails 4 hash accessing values returns nil", "body": "<p>Those keys are symbols. Try</p>\n\n<pre><code>id    = data[:studentid] \ntitle = data[:title] \n</code></pre>\n\n<p>Note: not <code>data[':studentid']</code>. <code>':studentid'</code> is simply a string that starts with a <code>:</code></p>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1476886388, "last_edit_date": 1495541956, "creation_date": 1476885786, "answer_id": 40133608, "question_id": 40133491, "link": "https://stackoverflow.com/questions/40133491/rails-4-hash-accessing-values-returns-nil/40133608#40133608", "title": "Rails 4 hash accessing values returns nil", "body": "<p><a href=\"https://ruby-doc.org/core/Symbol.html\" rel=\"nofollow noreferrer\">Symbols</a> and <a href=\"https://ruby-doc.org/core/String.html\" rel=\"nofollow noreferrer\">Strings</a> are two basic object types in ruby. <a href=\"https://stackoverflow.com/q/255078/1954610\">They are different</a>.</p>\n\n<p>The following hash:</p>\n\n<pre><code>{:lastname=&gt;\"XXXX\", :firstname=&gt;\"XXXXX\", ...}\n</code></pre>\n\n<p>is using <strong>symbols</strong> as keys, not strings. In order to access the values, you must also use symbol:</p>\n\n<pre><code>lastname = data[:lastname]\n</code></pre>\n\n<p>Again, to reiterate: <code>:lastname</code> and <code>':lastname'</code> are <strong>not</strong> the same thing; the former is a <em>symbol</em>, and the latter is a <em>string</em> (that starts with a <code>:</code>).</p>\n"}], "owner": {"reputation": 33, "user_id": 4126003, "user_type": "registered", "profile_image": "https://graph.facebook.com/1450745926/picture?type=large", "display_name": "Chuck Baker", "link": "https://stackoverflow.com/users/4126003/chuck-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 40133553, "answer_count": 2, "score": 2, "last_activity_date": 1476886444, "creation_date": 1476885485, "last_edit_date": 1476886444, "question_id": 40133491, "link": "https://stackoverflow.com/questions/40133491/rails-4-hash-accessing-values-returns-nil", "title": "Rails 4 hash accessing values returns nil", "body": "<p>I seem to be stuck trying to access hash values coming from a csv file and could use a different pair of eyes to point out the obvious mistake I'm making.  Here is the relevant code:</p>\n\n<pre><code>  CSV.foreach(filename, headers: true, header_converters: :symbol, converters: :all) do |row|\n  data = row.to_hash\n  id = data['studentid'] # (have also tried id = data[':studentid'] but there are no :'s in the csv file headers, and double quotes instead of single)\n  title = data['title'] # also (title = data[:title'])\n     logger.debug \"data param: #{data.inspect}\"\n     logger.debug \"data title param: #{title.inspect}\"\n     logger.debug \"data studentid param: #{id.inspect}\"\n</code></pre>\n\n<p>From the log file:  (valid data x'ed out or fake - note studentid comes in as a fixnum)</p>\n\n<pre><code>data param: {:lastname=&gt;\"XXXX\", :firstname=&gt;\"XXXXX\", :title=&gt;\"XXXXXXX\", :studentid=&gt;123456, :date=&gt;\"XXXXXXXXXX\"}\ndata title param: nil\ndata studentid param: nil\n</code></pre>\n\n<p>Rails 4.x Ruby 2.x OS Ubuntu\nIdeas?</p>\n"}, {"tags": ["ruby", "syntax", "switch-statement", "semantics"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1476885080, "last_edit_date": 1476885080, "creation_date": 1476884654, "answer_id": 40133171, "question_id": 40133098, "link": "https://stackoverflow.com/questions/40133098/what-does-a-ruby-case-expression-mean-without-an-expression-to-inspect/40133171#40133171", "title": "What does a Ruby case expression mean without an expression to inspect?", "body": "<p>It is by design that <code>case</code> statement without a value to match against behaves as an <code>if</code> statement.</p>\n\n<p>It <strong>is actually</strong> the same as writing:</p>\n\n<pre><code>if 3\n  'foo'\nelsif 4\n  'bar'\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1476897962, "post_id": 40133920, "comment_id": 67545387, "body": "Your code examples are not equivalent. In your example, <code>3</code> would not match since <code>3 === true</code> is <code>false</code>. The answer by Andrey is actually correct."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1476899075, "post_id": 40133920, "comment_id": 67546040, "body": "Thanks. I have no idea what I was thinking! Is that better?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1476899319, "post_id": 40133920, "comment_id": 67546203, "body": "BTW: I just noticed that the &quot;equivalent&quot; code samples in the docs are also wrong. Meh."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1476900629, "post_id": 40133920, "comment_id": 67547001, "body": "Thanks for the correction. This is much better now. Also thanks for quoting from the ISO standard since it&#39;s quite an expensive reference :)"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1476900806, "post_id": 40133920, "comment_id": 67547101, "body": "Don&#39;t tell anyone I&#39;m quoting from the Draft, then! ;-)"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1476899044, "last_edit_date": 1476899044, "creation_date": 1476886475, "answer_id": 40133920, "question_id": 40133098, "link": "https://stackoverflow.com/questions/40133098/what-does-a-ruby-case-expression-mean-without-an-expression-to-inspect/40133920#40133920", "title": "What does a Ruby case expression mean without an expression to inspect?", "body": "<p>In this form of the <code>case</code> expression, the <code>then</code> clause associated with the lexically first <code>when</code> clause that evaluates to a <em>truthy</em> value is evaluated.</p>\n\n<p>See clause b) 2) of \u00a711.5.2.2.4 <em>Semantics</em> of the <a href=\"http://iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=59579\" rel=\"nofollow\">ISO Ruby Language Specification</a> (<strong>bold</strong> emphasis mine):</p>\n\n<blockquote>\n  <h1>Semantics</h1>\n  \n  <p>A case-expression is evaluated as follows:</p>\n  \n  <ul>\n  <li>a) [\u2026]</li>\n  <li>b. The meaning of the phrase \u201cO is matching\u201d in Step c) is defined as follows:\n  \n  <ol>\n  <li>[\u2026]</li>\n  <li><strong>If the <em>case-expression</em> is a <em>case-expression-without-expression</em>, <em>O</em> is matching if and only if <em>O</em> is a trueish object.</strong></li>\n  </ol></li>\n  <li>c) Take the following steps:\n  \n  <ol>\n  <li>Search the <em>when-clause</em>s <strong>in the order they appear in the program text</strong> for a matching <em>when-clause</em> as follows:\n  \n  <ul>\n  <li>i) If the <em>operator-expression-list</em> of the <em>when-argument</em> is present:</li>\n  <li>I) For each of its <em>operator-expression</em>s, evaluate it and test if the resulting value is matching.</li>\n  <li>II) If a matching value is found, other <em>operator-expression</em>s, if any, are not evaluated.</li>\n  <li>ii) If no matching value is found, and the <em>splatting-argument</em> (see 11.3.2) is present:</li>\n  <li>I) Construct a list of values from it as described in 11.3.2. For each element of the resulting list, in the same order in the list, test if it is matching.</li>\n  <li>II) If a matching value is found, other values, if any, are not evaluated.</li>\n  <li>iii) A <em>when-clause</em> is considered to be matching if and only if a matching value is found in its <em>when-argument</em>. Later <em>when-clauses</em>, if any, are not tested in this case.</li>\n  </ul></li>\n  <li>If one of the <em>when-clause</em>s is matching, evaluate the <em>compound-statement</em> of the <em>then-clause</em> of this <em>when-clause</em>. The value of the <em>case-expression</em> is the resulting value.</li>\n  <li>If none of the <em>when-clause</em>s is matching, and if there is an <em>else-clause</em>, then evaluate the <em>compound-statement</em> of the <em>else-clause</em>. The value of the <em>case-expression</em> is the resulting value.</li>\n  <li>Otherwise, the value of the <em>case-expression</em> is <code>nil</code>.</li>\n  </ol></li>\n  </ul>\n</blockquote>\n\n<p>The <a href=\"http://ruby-doc.org/docs/keywords/1.9/files/keywords_rb.html#M000011\" rel=\"nofollow\">RDoc documentation</a>, while much less precise, also states that <em>truthiness</em> is the selection criteria, when the condition is omitted; and lexical ordering determines the order in which <code>when</code> clauses are checked (<strong>bold</strong> emphasis mine):</p>\n\n<blockquote>\n  <h1><code>case</code></h1>\n  \n  <p>The case statement operator. Case statements consist of an <strong>optional condition</strong>, which is in the position of an argument to <code>case</code>, and zero or more <code>when</code> clauses. <strong>The first <code>when</code> clause</strong> to match the condition (or to <strong>evaluate to Boolean truth, if the condition is null</strong>) \"wins\", and its code stanza is executed. The value of the case statement is the value of the successful <code>when</code> clause, or <code>nil</code> if there is no such clause.</p>\n</blockquote>\n"}], "owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "accepted_answer_id": 40133920, "answer_count": 2, "score": 1, "last_activity_date": 1476952493, "creation_date": 1476884503, "last_edit_date": 1476952493, "question_id": 40133098, "link": "https://stackoverflow.com/questions/40133098/what-does-a-ruby-case-expression-mean-without-an-expression-to-inspect", "title": "What does a Ruby case expression mean without an expression to inspect?", "body": "<p>Take this example Ruby expression:</p>\n\n<pre><code>case\n  when 3 then \"foo\"\n  when 4 then \"bar\"\nend\n</code></pre>\n\n<p>I was surprised to learn that this is not a syntax error. Instead, it evaluates to <code>\"foo\"</code>!</p>\n\n<p>Why? What are the syntax and evaluation rules being applied here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476884555, "post_id": 40133037, "comment_id": 67536018, "body": "That seems like a really inefficent way of doing it since I know the target string is at the beginning"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476884675, "post_id": 40133037, "comment_id": 67536123, "body": "This query will just search for statuses starting with <code>ijk</code> because we have added wildcard at the end"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "edited": false, "score": 0, "creation_date": 1476884823, "post_id": 40133037, "comment_id": 67536238, "body": "This query will not match <code>vvijk</code> but only <code>ijkvv</code> or <code>ijksdd</code> and I think that is what you want"}, {"owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "edited": false, "score": 0, "creation_date": 1476885238, "post_id": 40133037, "comment_id": 67536628, "body": "Guess that&#39;s the best way to do it"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 2, "last_activity_date": 1476884565, "last_edit_date": 1476884565, "creation_date": 1476884376, "answer_id": 40133037, "question_id": 40133014, "link": "https://stackoverflow.com/questions/40133014/getting-record-where-the-first-set-of-characters-in-attribute-matches/40133037#40133037", "title": "Getting record where the first set of characters in attribute matches", "body": "<p>You can use LIKE query with wildcards</p>\n\n<pre><code>Model.where('status LIKE ?', 'ijk%')\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476884565, "creation_date": 1476884309, "last_edit_date": 1476884496, "question_id": 40133014, "link": "https://stackoverflow.com/questions/40133014/getting-record-where-the-first-set-of-characters-in-attribute-matches", "title": "Getting record where the first set of characters in attribute matches", "body": "<p>I have a model with a string attribute, the attribute can have values 'abc', 'def', 'ghi' or 'jkl' + count I need to get all records with the value 'jkl' + count. I was hoping something like:</p>\n\n<pre><code>Model.where(status[0..2]: 'jkl')\n</code></pre>\n\n<p>Would work, but it seems like it doesn't, is there a good way for me to do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3.2"], "comments": [{"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476884396, "post_id": 40132864, "comment_id": 67535892, "body": "Maybe not a solution but can you try this <code>send_file( file, :filename =&gt; &#39;my_file.txt&#39;  )</code> ?"}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476885704, "post_id": 40132864, "comment_id": 67537026, "body": "I just copied your code and it works. Maybe there&#39;s something you&#39;re not putting in here?"}, {"owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1477293749, "post_id": 40132864, "comment_id": 67689510, "body": "@lcguida i have tried the same code in my application as well(test application) and it works. i have modified the question and please have a look."}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "is_accepted": true, "score": 0, "last_activity_date": 1477879126, "creation_date": 1477879126, "answer_id": 40335639, "question_id": 40132864, "link": "https://stackoverflow.com/questions/40132864/send-file-send-data-not-sending-file-for-downloading/40335639#40335639", "title": "send_file/send_data not sending file for downloading", "body": "<p>I dont know why this method is working. But serves my purpose.</p>\n\n<pre><code>$(\"#btn_id\").on('click', function () {\n    window.location = ypur api url;\n});\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Ajith</p>\n"}], "owner": {"reputation": 161, "user_id": 2918956, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9ca0002ba7b1ba0989598bec6431e72d?s=128&d=identicon&r=PG&f=1", "display_name": "Ajith", "link": "https://stackoverflow.com/users/2918956/ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 40335639, "answer_count": 1, "score": 3, "last_activity_date": 1477879126, "creation_date": 1476883907, "last_edit_date": 1477294763, "question_id": 40132864, "link": "https://stackoverflow.com/questions/40132864/send-file-send-data-not-sending-file-for-downloading", "title": "send_file/send_data not sending file for downloading", "body": "<p>i'm using rails 3.2.22.4 and ruby 2.2.4. i'm testing send_file feature. I get \"file sent\" in server logs but i cant see it is getting downloaded in browser. Save button click will call this action.</p>\n\n<pre><code>def save_trunk_logs\n  device_id = params['device_id']\n  trunk_name = params['trunk_name'] ||= \"test\"\n  data =\"\"\n  file = \"#{trunk_name}.txt\"\n  trunk_logs = TrunkStatusLog.select([:LogType, :LogMessage, :EpochLoggedAtTime]).where(DeviceID: device_id)\n  File.open(file, \"w+\") do |aFile|\n    aFile.write(\"Trunk Name : #{trunk_name}\\n\")\n    aFile.write(\"*\"*100)\n    aFile.write(\"\\n\")\n    aFile.write(\"Time Stamp\"+\"\\t\"+\"Log Message\\n\")\n    trunk_logs.each do |msg|\n      data =format_log_messages msg\n      aFile.write(\"#{data}\\n\")\n    end\n  end\n  send_file file, :type =&gt; 'text/plain; charset=UTF-8', :disposition =&gt; 'attachment'\nend\n</code></pre>\n\n<p>This action is called by a button_to click event.</p>\n\n<pre><code>$(\"input[value='Download']\").on('click', function () {\n    $.ajax({\n        type: \"POST\",\n        url: \"/dm/trunk_test_tools/save_trunk_logs?device_id=\"+selectedTrunkDeviceId+\"&amp;trunk_name=\"+selectedTrunkDeviceName,\n       }\n    })\n});\n</code></pre>\n\n<p>every time i hit download button 2 calls are made. server side log is pasted below</p>\n\n<pre><code>Started POST \"/X/Y/save_trunk_logs?device_id=9&amp;trunk_name=SIP_1\" for      10.198.2.208 at 2016-10-24 12:58:58 +0530\nProcessing by ABCController#save_trunk_logs as */*\nParameters: {\"device_id\"=&gt;\"9\", \"trunk_name\"=&gt;\"SIP_1\"}\nSent file SIP_1.txt (0.0ms)\nCompleted 200 OK in 98.0ms (ActiveRecord: 62.0ms)\n\nStarted POST \"/X/Y/save_trunk_logs\" for 10.198.2.208 at 2016-10-24 12:58:59 +0530\nProcessing by TrunkTestToolsController#save_trunk_logs as HTML\nParameters: {\"authenticity_token\"=&gt;\"3HSxduOUwccwo=\"}\nsent file test.txt (0.0ms)\nCompleted 200 OK in 17.0ms (ActiveRecord: 3.0ms)\n</code></pre>\n\n<p>I dont understand why second call is made and from where it is being made. in the first server call it says file is sent but does not download. In second call file is sent as well as downloaded. but it is of no use. parameters not not correct. authenticity token i am not sending as parameter.(actual data queries are skipped.)</p>\n\n<p>Any help will be appreciated.\nThanks in advance.</p>\n"}, {"tags": ["ruby", "numbers", "range"], "comments": [{"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476880312, "post_id": 40131341, "comment_id": 67532809, "body": "Actually the program does not stops. You&#39;ll only see anything print if the condition <code>sum_angstrom == number</code> is met. You can use some <code>puts</code> to debug you program."}, {"owner": {"reputation": 73, "user_id": 5010178, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9b76f8d6032d1e92e743955d9cd4bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Allen M", "link": "https://stackoverflow.com/users/5010178/allen-m"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476880714, "post_id": 40131341, "comment_id": 67533131, "body": "Hmm, it should normally print, 1 153 370 371 407, i&#39;ll keep trying."}, {"owner": {"reputation": 73, "user_id": 5010178, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9b76f8d6032d1e92e743955d9cd4bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Allen M", "link": "https://stackoverflow.com/users/5010178/allen-m"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476881061, "post_id": 40131341, "comment_id": 67533378, "body": "I think it has something to do with the way im iterating (number += number) through the numbers."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1476883662, "post_id": 40131341, "comment_id": 67535341, "body": "@AllenM if I&#39;m not mistaken, each digit has to be raised to the power of the number of total digits. That&#39;s 3 for 3-digit numbers <code>153 = 1^3 + 5^3 + 3^3</code>, 4 for 4-digit numbers <code>1634  = 1^4 + 6^4 + 3^4 + 4^4</code> and so on. See <a href=\"https://oeis.org/A005188\" rel=\"nofollow noreferrer\">oeis.org/A005188</a>"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5010178, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9b76f8d6032d1e92e743955d9cd4bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Allen M", "link": "https://stackoverflow.com/users/5010178/allen-m"}, "edited": false, "score": 0, "creation_date": 1476882376, "post_id": 40131907, "comment_id": 67534420, "body": "Thats exactly what i did before seeing your answer, i knew there was something wrong with the way i was iterating XD."}], "tags": [], "owner": {"reputation": 34664, "user_id": 390819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee2ef44de10f7791cca06df317246935?s=128&d=identicon&r=PG", "display_name": "Cristian Lupascu", "link": "https://stackoverflow.com/users/390819/cristian-lupascu"}, "is_accepted": true, "score": 0, "last_activity_date": 1476882415, "last_edit_date": 1476882415, "creation_date": 1476881484, "answer_id": 40131907, "question_id": 40131341, "link": "https://stackoverflow.com/questions/40131341/ruby-armstrong-numbers-in-a-range/40131907#40131907", "title": "Ruby armstrong numbers in a range", "body": "<p>First of all, change <code>number += number</code> to <code>number += 1</code>; otherwise you will only test the powers of 2.</p>\n\n<p>Second, move the <code>number += 1</code> line at the bottom of the while block it is in. Otherwise you will always test if <code>sum_armstrong(n) == n+1</code>.</p>\n\n<p>This <a href=\"http://ideone.com/SNXRtB\" rel=\"nofollow\">works</a>:</p>\n\n<pre><code>puts \"Enter range(starts at 1), ends at the number that you enter: \"\nrange = gets.chomp.to_i\n\n\nnumber = 1\n\nwhile number &lt;= range\n    temporary_number = number\n    sum_angstrom = 0\n\n    while(temporary_number != 0)\n        digit = temporary_number % 10\n        temporary_number /= 10\n        sum_angstrom = sum_angstrom + (digit ** 3)\n    end\n\n    if (sum_angstrom == number)\n        puts number\n    end\n\n    number += 1\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 777, "user_id": 1823441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffeeda5d93823fc29b927ca44e632c95?s=128&d=identicon&r=PG", "display_name": "Arjun", "link": "https://stackoverflow.com/users/1823441/arjun"}, "is_accepted": false, "score": 0, "last_activity_date": 1543558003, "last_edit_date": 1543558003, "creation_date": 1543557677, "answer_id": 53552075, "question_id": 40131341, "link": "https://stackoverflow.com/questions/40131341/ruby-armstrong-numbers-in-a-range/53552075#53552075", "title": "Ruby armstrong numbers in a range", "body": "<p><strong>Armstrong Number in Ruby one liner</strong></p>\n\n<pre><code>n  = 153 \ns = 0 \nn.to_s.split(\"\").map{|e| s+=(e.to_i*e.to_i*e.to_i)}\nputs (n==s ? \"Armstrong number\" : \"Not Armstrong number\")\n</code></pre>\n\n<p>You can iterate in a range to print the value based on your requirement. \nMain logic lies in below line.</p>\n\n<pre><code> n.to_s.split(\"\").map{|e| s+=(e.to_i*e.to_i*e.to_i)}\n</code></pre>\n\n<p><strong>Improving my answer a little bit</strong></p>\n\n<pre><code>n.digits.map{|e| s+=(e**3)}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5010178, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9b76f8d6032d1e92e743955d9cd4bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Allen M", "link": "https://stackoverflow.com/users/5010178/allen-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 40131907, "answer_count": 2, "score": 1, "last_activity_date": 1543558003, "creation_date": 1476879891, "last_edit_date": 1476880078, "question_id": 40131341, "link": "https://stackoverflow.com/questions/40131341/ruby-armstrong-numbers-in-a-range", "title": "Ruby armstrong numbers in a range", "body": "<pre><code>puts \"Enter range(starts at 1), ends at the number that you enter: \"\nrange = gets.chomp.to_i\n\n\nnumber = 1\n\nwhile number &lt;= range\n    temporary_number = number\n    sum_angstrom = 0\n    number += number\n\n    while(temporary_number != 0)\n        digit = temporary_number % 10\n        temporary_number /= 10\n        sum_angstrom = sum_angstrom + (digit ** 3)\n    end\n\n    if (sum_angstrom == number)\n        puts number\n    end\nend\n</code></pre>\n\n<p>This time, I tried to make a program to show the armstrong numbers in a range that's taken from the user's input. The program just stops after I enter the number and press enter and i can't figure out why.</p>\n\n<p>Keep in mind that i can't use for(each), that's why i'm using while so often.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "comments": [{"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476880080, "post_id": 40131331, "comment_id": 67532625, "body": "you mean nothing relevant shows up on terminal after you execute this ?"}, {"owner": {"reputation": 2388, "user_id": 1752114, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/778377fd64568f1a23968400a7477306?s=128&d=identicon&r=PG", "display_name": "Arvind", "link": "https://stackoverflow.com/users/1752114/arvind"}, "edited": false, "score": 0, "creation_date": 1476880614, "post_id": 40131331, "comment_id": 67533053, "body": "hope you are performing action in correct directory ?"}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 2388, "user_id": 1752114, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/778377fd64568f1a23968400a7477306?s=128&d=identicon&r=PG", "display_name": "Arvind", "link": "https://stackoverflow.com/users/1752114/arvind"}, "edited": false, "score": 0, "creation_date": 1476880852, "post_id": 40131331, "comment_id": 67533223, "body": "@Arvind Yes, I am performing in the created app directory, and nothing happens after running this command."}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476881340, "post_id": 40131331, "comment_id": 67533605, "body": "@sajan yes nothing shows on terminal after executing this."}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1476882344, "post_id": 40131331, "comment_id": 67534391, "body": "what is the spree version installed, check Gemfile.lock"}, {"owner": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1476882504, "post_id": 40131331, "comment_id": 67534506, "body": "You should have Required rails version  (~&gt; 4.2.6) for spree 3.1.1"}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "reply_to_user": {"reputation": 7359, "user_id": 599989, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d752d2574aeb36bc66471f4d0f8811aa?s=128&d=identicon&r=PG", "display_name": "Bijendra", "link": "https://stackoverflow.com/users/599989/bijendra"}, "edited": false, "score": 0, "creation_date": 1476890769, "post_id": 40131331, "comment_id": 67541069, "body": "@Bijendra I have added Gemfile.lock as well, Rails version installed is: 4.2.7.1 and spree is 3.1.1"}, {"owner": {"reputation": 869, "user_id": 463564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53c2a9bc5927db192031fecfd92fa71d?s=128&d=identicon&r=PG", "display_name": "jmsalcido", "link": "https://stackoverflow.com/users/463564/jmsalcido"}, "edited": false, "score": 0, "creation_date": 1486445823, "post_id": 40131331, "comment_id": 71335683, "body": "same problem, I know this is old, but... just remove spring gem from <code>gems&#47;spring-2.x.x</code> and then bundle install again."}, {"owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "edited": false, "score": 0, "creation_date": 1486447512, "post_id": 40131331, "comment_id": 71336280, "body": "I had to create a rails app with 4.2.6 version of rails, using following command:  <code>rails _4.2.6_ new store</code>  When I was just running rails new store, it used to create dependency using <code>rails 5</code> version, which was breaking with spree."}], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 1695482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ad92197f307e037af05d91538e2e47?s=128&d=identicon&r=PG", "display_name": "Vladimir Dimitrov", "link": "https://stackoverflow.com/users/1695482/vladimir-dimitrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1480785277, "last_edit_date": 1480785277, "creation_date": 1480782921, "answer_id": 40949995, "question_id": 40131331, "link": "https://stackoverflow.com/questions/40131331/spree-install-error-rails-g-spreeinstall-user-class-spreeuser-not-doing/40949995#40949995", "title": "spree install error: &quot;rails g spree:install --user_class=Spree::User&quot; not doing anything", "body": "<p>I had the same issue! \nFirst make sure you have <strong>Devise</strong> initilizer with <strong>secret_key</strong> in it before run above command.</p>\n\n<p><strong>config/initilizers/devise.rb</strong></p>\n\n<pre><code>Devise.secret_key = \"a20fc3f341233168dbc630d965a55792107e1f176784bfb7c6bd4d5762694a533ba273e03365b6614c150f039c42c0e0d\"\n</code></pre>\n\n<p>I don't know what the problem exactly was. I hit ctrl+c while waiting and I noticed that </p>\n\n<pre><code>gems/spring-2.0.0/lib/spring/client/run.rb:117:in `gets': Interrupt\n</code></pre>\n\n<p>was the brakepoint. I put some debug messages in this file and notice that it opens a socket with (env.socket_name) which was pointing to </p>\n\n<pre><code>/run/user/1000/spring-1000/a063a1aa4f0846e81b9eeaf57ad05be4\n</code></pre>\n\n<p>I deleted this file and this fixed the issue. So take a look in your <strong>/run</strong> folder for something about <strong>spring</strong> and remove it, or I think a system reboot will do the job too.</p>\n"}], "owner": {"reputation": 58061, "user_id": 1610034, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/x77Vf.jpg?s=128&g=1", "display_name": "Saurabh", "link": "https://stackoverflow.com/users/1610034/saurabh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480785277, "creation_date": 1476879862, "last_edit_date": 1476899554, "question_id": 40131331, "link": "https://stackoverflow.com/questions/40131331/spree-install-error-rails-g-spreeinstall-user-class-spreeuser-not-doing", "title": "spree install error: &quot;rails g spree:install --user_class=Spree::User&quot; not doing anything", "body": "<p>I have create a new rails app using this command:</p>\n\n<pre><code>rails new store\n</code></pre>\n\n<p>rails version is: 4.2.6</p>\n\n<p>Ruby Version: </p>\n\n<pre><code>$rvm rubies\n\n   ruby-2.1.2 [ x86_64 ]\n\n   ruby-2.2.0 [ x86_64 ]\n\n=* ruby-2.2.2 [ x86_64 ]`\n</code></pre>\n\n<p>Following is the Gemfile: </p>\n\n<pre><code> source 'https://rubygems.org'\n # Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\n gem 'rails', '~&gt; 4.2.6'\n # Use sqlite3 as the database for Active Record\n gem 'sqlite3'\n # Use Puma as the app server\n gem 'puma', '~&gt; 3.0'\n # Use SCSS for stylesheets\n gem 'sass-rails', '~&gt; 5.0'\n # Use Uglifier as compressor for JavaScript assets\n gem 'uglifier', '&gt;= 1.3.0'\n # Use CoffeeScript for .coffee assets and views\n gem 'coffee-rails', '~&gt; 4.2'\n # See https://github.com/rails/execjs#readme for more supported runtimes\n # gem 'therubyracer', platforms: :ruby\n\n # Use jquery as the JavaScript library\n gem 'jquery-rails'\n # Turbolinks makes navigating your web application faster. Read more:                     https://github.com/turbolinks/turbolinks\n gem 'turbolinks', '~&gt; 5'\n # Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\n gem 'jbuilder', '~&gt; 2.5'\n # Use Redis adapter to run Action Cable in production\n # gem 'redis', '~&gt; 3.0'\n # Use ActiveModel has_secure_password\n # gem 'bcrypt', '~&gt; 3.1.7'\n\n # Use Capistrano for deployment\n # gem 'capistrano-rails', group: :development\n\n group :development, :test do\n   # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n   gem 'byebug', platform: :mri\n end\n\n group :development do\n   # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n   gem 'web-console'\n   gem 'listen', '~&gt; 3.0.5'\n   # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n   gem 'spring'\n   gem 'spring-watcher-listen', '~&gt; 2.0.0'\n end\n\n gem 'spree', '~&gt; 3.1.0'\n gem 'spree_auth_devise', '~&gt; 3.1.0'\n gem 'spree_gateway', '~&gt; 3.1.0'\n\n # Windows does not include zoneinfo files, so bundle the tzinfo-data gem\n gem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>Bundle install works fine, But when I try to follow <a href=\"https://github.com/spree/spree#getting-started\" rel=\"nofollow\">getting started</a> and run this command</p>\n\n<p><code>rails g spree:install --user_class=Spree::User</code></p>\n\n<p>Nothing happens at all.</p>\n\n<p>Please let me know what can be wrong?</p>\n\n<p>Here is Gemfile.lock:</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actionmailer (4.2.7.1)\n      actionpack (= 4.2.7.1)\n      actionview (= 4.2.7.1)\n      activejob (= 4.2.7.1)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n    actionpack (4.2.7.1)\n      actionview (= 4.2.7.1)\n      activesupport (= 4.2.7.1)\n      rack (~&gt; 1.6)\n      rack-test (~&gt; 0.6.2)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (4.2.7.1)\n      activesupport (= 4.2.7.1)\n      builder (~&gt; 3.1)\n      erubis (~&gt; 2.7.0)\n      rails-dom-testing (~&gt; 1.0, &gt;= 1.0.5)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    activejob (4.2.7.1)\n      activesupport (= 4.2.7.1)\n      globalid (&gt;= 0.3.0)\n    activemerchant (1.49.0)\n      activesupport (&gt;= 3.2.14, &lt; 5.0.0)\n      builder (&gt;= 2.1.2, &lt; 4.0.0)\n      i18n (&gt;= 0.6.9)\n      nokogiri (~&gt; 1.4)\n    activemodel (4.2.7.1)\n      activesupport (= 4.2.7.1)\n      builder (~&gt; 3.1)\n    activerecord (4.2.7.1)\n      activemodel (= 4.2.7.1)\n      activesupport (= 4.2.7.1)\n      arel (~&gt; 6.0)\n    activesupport (4.2.7.1)\n      i18n (~&gt; 0.7)\n      json (~&gt; 1.7, &gt;= 1.7.7)\n      minitest (~&gt; 5.1)\n      thread_safe (~&gt; 0.3, &gt;= 0.3.4)\n      tzinfo (~&gt; 1.1)\n    acts_as_list (0.7.2)\n      activerecord (&gt;= 3.0)\n    addressable (2.4.0)\n    arel (6.0.3)\n    autoprefixer-rails (6.5.1)\n      execjs\n    awesome_nested_set (3.0.3)\n      activerecord (&gt;= 4.0.0, &lt; 5)\n    bcrypt (3.1.11)\n    bootstrap-sass (3.3.7)\n      autoprefixer-rails (&gt;= 5.2.1)\n      sass (&gt;= 3.3.4)\n    builder (3.2.2)\n    byebug (9.0.6)\n    camertron-eprun (1.1.1)\n    cancancan (1.10.1)\n    canonical-rails (0.0.11)\n      rails (&gt;= 3.1, &lt; 5.0)\n    carmen (1.0.2)\n      activesupport (&gt;= 3.0.0)\n    cldr-plurals-runtime-rb (1.0.1)\n    climate_control (0.0.3)\n      activesupport (&gt;= 3.0)\n    cocaine (0.5.8)\n      climate_control (&gt;= 0.0.3, &lt; 1.0)\n    coffee-rails (4.2.1)\n      coffee-script (&gt;= 2.2.0)\n      railties (&gt;= 4.0.0, &lt; 5.2.x)\n    coffee-script (2.4.1)\n      coffee-script-source\n      execjs\n    coffee-script-source (1.10.0)\n    colorize (0.8.1)\n    concurrent-ruby (1.0.2)\n    css_parser (1.4.5)\n      addressable\n    debug_inspector (0.0.2)\n    deface (1.0.2)\n      colorize (&gt;= 0.5.8)\n      nokogiri (~&gt; 1.6.0)\n      polyglot\n      rails (&gt;= 3.1)\n    devise (3.5.10)\n      bcrypt (~&gt; 3.0)\n      orm_adapter (~&gt; 0.1)\n      railties (&gt;= 3.2.6, &lt; 5)\n      responders\n      thread_safe (~&gt; 0.1)\n      warden (~&gt; 1.2.3)\n    devise-encryptable (0.1.2)\n      devise (&gt;= 2.1.0)\n    erubis (2.7.0)\n    execjs (2.7.0)\n    ffaker (2.2.0)\n    ffi (1.9.14)\n    font-awesome-rails (4.6.3.1)\n      railties (&gt;= 3.2, &lt; 5.1)\n    friendly_id (5.1.0)\n      activerecord (&gt;= 4.0.0)\n    globalid (0.3.7)\n      activesupport (&gt;= 4.1.0)\n    highline (1.6.21)\n    htmlentities (4.3.4)\n    i18n (0.7.0)\n    jbuilder (2.6.0)\n      activesupport (&gt;= 3.0.0, &lt; 5.1)\n      multi_json (~&gt; 1.2)\n    jquery-rails (4.2.1)\n      rails-dom-testing (&gt;= 1, &lt; 3)\n      railties (&gt;= 4.2.0)\n      thor (&gt;= 0.14, &lt; 2.0)\n    jquery-ui-rails (5.0.5)\n      railties (&gt;= 3.2.16)\n    json (1.8.3)\n    kaminari (0.17.0)\n      actionpack (&gt;= 3.0.0)\n      activesupport (&gt;= 3.0.0)\n    listen (3.0.8)\n      rb-fsevent (~&gt; 0.9, &gt;= 0.9.4)\n      rb-inotify (~&gt; 0.9, &gt;= 0.9.7)\n    loofah (2.0.3)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.6.4)\n      mime-types (&gt;= 1.16, &lt; 4)\n    mime-types (3.1)\n      mime-types-data (~&gt; 3.2015)\n    mime-types-data (3.2016.0521)\n    mimemagic (0.3.0)\n    mini_portile2 (2.1.0)\n    minitest (5.9.1)\n    monetize (1.4.0)\n      money (~&gt; 6.7)\n    money (6.7.1)\n      i18n (&gt;= 0.6.4, &lt;= 0.7.0)\n      sixarm_ruby_unaccent (&gt;= 1.1.1, &lt; 2)\n    multi_json (1.12.1)\n    nokogiri (1.6.8.1)\n      mini_portile2 (~&gt; 2.1.0)\n    orm_adapter (0.5.0)\n    paperclip (4.3.7)\n      activemodel (&gt;= 3.2.0)\n      activesupport (&gt;= 3.2.0)\n      cocaine (~&gt; 0.5.5)\n      mime-types\n      mimemagic (= 0.3.0)\n    paranoia (2.1.5)\n      activerecord (~&gt; 4.0)\n    polyamorous (1.3.1)\n      activerecord (&gt;= 3.0)\n    polyglot (0.3.5)\n    premailer (1.8.7)\n      css_parser (&gt;= 1.4.5)\n      htmlentities (&gt;= 4.0.0)\n    premailer-rails (1.9.4)\n      actionmailer (&gt;= 3, &lt; 6)\n      premailer (~&gt; 1.7, &gt;= 1.7.9)\n    puma (3.6.0)\n    rabl (0.12.0)\n      activesupport (&gt;= 2.3.14)\n    rack (1.6.4)\n    rack-test (0.6.3)\n      rack (&gt;= 1.0)\n    rails (4.2.7.1)\n      actionmailer (= 4.2.7.1)\n      actionpack (= 4.2.7.1)\n      actionview (= 4.2.7.1)\n      activejob (= 4.2.7.1)\n      activemodel (= 4.2.7.1)\n      activerecord (= 4.2.7.1)\n      activesupport (= 4.2.7.1)\n      bundler (&gt;= 1.3.0, &lt; 2.0)\n      railties (= 4.2.7.1)\n      sprockets-rails\n    rails-deprecated_sanitizer (1.0.3)\n      activesupport (&gt;= 4.2.0.alpha)\n    rails-dom-testing (1.0.7)\n      activesupport (&gt;= 4.2.0.beta, &lt; 5.0)\n      nokogiri (~&gt; 1.6.0)\n      rails-deprecated_sanitizer (&gt;= 1.0.1)\n    rails-html-sanitizer (1.0.3)\n      loofah (~&gt; 2.0)\n    railties (4.2.7.1)\n      actionpack (= 4.2.7.1)\n      activesupport (= 4.2.7.1)\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rake (11.3.0)\n    ransack (1.4.1)\n      actionpack (&gt;= 3.0)\n      activerecord (&gt;= 3.0)\n      activesupport (&gt;= 3.0)\n      i18n\n      polyamorous (~&gt; 1.1)\n    rb-fsevent (0.9.7)\n    rb-inotify (0.9.7)\n      ffi (&gt;= 0.5.0)\n    responders (2.3.0)\n      railties (&gt;= 4.2.0, &lt; 5.1)\n    sass (3.4.22)\n    sass-rails (5.0.6)\n      railties (&gt;= 4.0.0, &lt; 6)\n      sass (~&gt; 3.1)\n      sprockets (&gt;= 2.8, &lt; 4.0)\n      sprockets-rails (&gt;= 2.0, &lt; 4.0)\n      tilt (&gt;= 1.1, &lt; 3)\n    select2-rails (3.5.9.1)\n      thor (~&gt; 0.14)\n    sixarm_ruby_unaccent (1.1.1)\n    spree (3.1.1)\n      spree_api (= 3.1.1)\n      spree_backend (= 3.1.1)\n      spree_cmd (= 3.1.1)\n      spree_core (= 3.1.1)\n      spree_frontend (= 3.1.1)\n      spree_sample (= 3.1.1)\n    spree_api (3.1.1)\n      rabl (~&gt; 0.12.0)\n      spree_core (= 3.1.1)\n      versioncake (~&gt; 2.3.1)\n    spree_auth_devise (3.1.0)\n      devise (~&gt; 3.5.4)\n      devise-encryptable (= 0.1.2)\n      spree_core (~&gt; 3.1.0.beta)\n    spree_backend (3.1.1)\n      bootstrap-sass (~&gt; 3.3)\n      jquery-rails (~&gt; 4.1)\n      jquery-ui-rails (~&gt; 5.0)\n      select2-rails (= 3.5.9.1)\n      spree_api (= 3.1.1)\n      spree_core (= 3.1.1)\n    spree_cmd (3.1.1)\n      thor (~&gt; 0.14)\n    spree_core (3.1.1)\n      activemerchant (~&gt; 1.49.0)\n      acts_as_list (= 0.7.2)\n      awesome_nested_set (~&gt; 3.0.1)\n      cancancan (~&gt; 1.10.1)\n      carmen (~&gt; 1.0.0)\n      deface (~&gt; 1.0.0)\n      ffaker (~&gt; 2.2.0)\n      font-awesome-rails (~&gt; 4.0)\n      friendly_id (~&gt; 5.1.0)\n      highline (~&gt; 1.6.18)\n      kaminari (~&gt; 0.17)\n      monetize (~&gt; 1.1)\n      paperclip (~&gt; 4.3.0)\n      paranoia (~&gt; 2.1.0)\n      premailer-rails\n      rails (~&gt; 4.2.7.1)\n      ransack (~&gt; 1.4.1)\n      responders\n      sprockets-rails\n      state_machines-activerecord (~&gt; 0.2)\n      stringex\n      truncate_html (~&gt; 0.9.3)\n      twitter_cldr (~&gt; 3.0)\n    spree_frontend (3.1.1)\n      bootstrap-sass (&gt;= 3.3.5.1, &lt; 3.4)\n      canonical-rails (~&gt; 0.0.4)\n      jquery-rails (~&gt; 4.1)\n      spree_api (= 3.1.1)\n      spree_core (= 3.1.1)\n    spree_gateway (3.1.0)\n      spree_core (~&gt; 3.1.0.beta)\n    spree_sample (3.1.1)\n      spree_core (= 3.1.1)\n    spring (2.0.0)\n      activesupport (&gt;= 4.2)\n    spring-watcher-listen (2.0.1)\n      listen (&gt;= 2.7, &lt; 4.0)\n      spring (&gt;= 1.2, &lt; 3.0)\n    sprockets (3.7.0)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.2.0)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    sqlite3 (1.3.12)\n    state_machines (0.4.0)\n    state_machines-activemodel (0.4.0)\n      activemodel (&gt;= 4.1, &lt; 5.1)\n      state_machines (&gt;= 0.4.0)\n    state_machines-activerecord (0.4.0)\n      activerecord (&gt;= 4.1, &lt; 5.1)\n      state_machines-activemodel (&gt;= 0.3.0)\n    stringex (2.6.1)\n    thor (0.19.1)\n    thread_safe (0.3.5)\n    tilt (2.0.5)\n    truncate_html (0.9.3)\n    turbolinks (5.0.1)\n      turbolinks-source (~&gt; 5)\n    turbolinks-source (5.0.0)\n    twitter_cldr (3.5.0)\n      camertron-eprun\n      cldr-plurals-runtime-rb (~&gt; 1.0.0)\n      tzinfo\n    tzinfo (1.2.2)\n      thread_safe (~&gt; 0.1)\n    uglifier (3.0.2)\n      execjs (&gt;= 0.3.0, &lt; 3)\n    versioncake (2.3.1)\n      actionpack (&gt;= 3.2)\n      activesupport (&gt;= 3.2)\n      railties (&gt;= 3.2)\n      tzinfo\n    warden (1.2.6)\n      rack (&gt;= 1.0)\n    web-console (3.3.0)\n      activemodel (&gt;= 4.2)\n      debug_inspector\n      railties (&gt;= 4.2)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  byebug\n  coffee-rails (~&gt; 4.2)\n  jbuilder (~&gt; 2.5)\n  jquery-rails\n  listen (~&gt; 3.0.5)\n  puma (~&gt; 3.0)\n  rails (~&gt; 4.2.6)\n  sass-rails (~&gt; 5.0)\n  spree (~&gt; 3.1.0)\n  spree_auth_devise (~&gt; 3.1.0)\n  spree_gateway (~&gt; 3.1.0)\n  spring\n  spring-watcher-listen (~&gt; 2.0.0)\n  sqlite3\n  turbolinks (~&gt; 5)\n  tzinfo-data\n  uglifier (&gt;= 1.3.0)\n  web-console\n\nBUNDLED WITH\n   1.13.5\n</code></pre>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476879296, "post_id": 40131070, "comment_id": 67532064, "body": "Describe the model in which those values would be saved"}, {"owner": {"reputation": 31, "user_id": 7041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac82499c80ad1c59104e06c0829b7c07?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/7041993/andrey"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476880120, "post_id": 40131070, "comment_id": 67532656, "body": "I&#39;m using gem activerecord. Model is empty.   <code>class Product &lt; ActiveRecord::Base  end</code>"}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476880437, "post_id": 40131070, "comment_id": 67532904, "body": "Seems to me that you don&#39;t know much rails. I&#39;ll recommend you to read the Rails Guides. For you specific problem, take a look at this: <a href=\"http://guides.rubyonrails.org/active_record_basics.html#create\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_basics.html#create</a>"}, {"owner": {"reputation": 31, "user_id": 7041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac82499c80ad1c59104e06c0829b7c07?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/7041993/andrey"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476880485, "post_id": 40131070, "comment_id": 67532939, "body": "could you tell me the direction, I&#39;m new to ruby/Sinatra."}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 2, "creation_date": 1476880593, "post_id": 40131070, "comment_id": 67533036, "body": "I just did. Take a look at the link. If you can&#39;t really figure it out with it, You should take a step back and take a look at ruby basics, specially in the Enumerable methods: <a href=\"https://ruby-doc.org/core-2.3.1/Enumerable.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.1/Enumerable.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 260, "user_id": 3815905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8CMY.jpg?s=128&g=1", "display_name": "AnkurVyas", "link": "https://stackoverflow.com/users/3815905/ankurvyas"}, "is_accepted": false, "score": 2, "last_activity_date": 1476883096, "creation_date": 1476883096, "answer_id": 40132549, "question_id": 40131070, "link": "https://stackoverflow.com/questions/40131070/how-split-the-array-and-save-to-database/40132549#40132549", "title": "how split the array and save to database?", "body": "<p>Assuming you have Product model and attributes are code:string and name:string. And you store the parsed results in data variable.</p>\n\n<p>You need to do the following:</p>\n\n<pre><code>data = [{:code=&gt;\"1\", :name=&gt;\"Pen\"},\n {:code=&gt;\"2\", :name=&gt;\"Apple\"}]\n\ndata.each{|row| Product.create(row) }\n</code></pre>\n\n<p>This will create two entries in your Product model.</p>\n"}], "owner": {"reputation": 31, "user_id": 7041993, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac82499c80ad1c59104e06c0829b7c07?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/7041993/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476883339, "creation_date": 1476879088, "last_edit_date": 1476883339, "question_id": 40131070, "link": "https://stackoverflow.com/questions/40131070/how-split-the-array-and-save-to-database", "title": "how split the array and save to database?", "body": "<p>I parsed a file using <code>smarter_csv</code>: </p>\n\n<pre><code>file = SmarterCSV.process(smarter_csv, file_encoding: windows-1251', col_sep: ';', verbose: true, convert_values_to_numeric: true, remove_zero_values: false)\n</code></pre>\n\n<p>And got this array:</p>\n\n<pre><code>[{:code=&gt;\"1\", :Name=&gt;\"Pen\"},\n {:code=&gt;\"2\", :Name=&gt;\"Apple\"}]\n</code></pre>\n\n<p>how you can break this array to save it in the database?</p>\n\n<p>I guess you need to iterate through items using <code>each</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476878733, "post_id": 40130433, "comment_id": 67531662, "body": "What database are you using?"}, {"owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "reply_to_user": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476878945, "post_id": 40130433, "comment_id": 67531813, "body": "@CdotStrifeVII he is using postgres. check tags."}, {"owner": {"reputation": 161, "user_id": 1525501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60a84205108bed01e8f77cd5d6950421?s=128&d=identicon&r=PG", "display_name": "Oviron", "link": "https://stackoverflow.com/users/1525501/oviron"}, "reply_to_user": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476878962, "post_id": 40130433, "comment_id": 67531823, "body": "@CdotStrifeVII Postgresql. I wrote it in tags but forgot to mention in post."}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476879982, "post_id": 40130433, "comment_id": 67532550, "body": "<code>ANY</code> is to be used for array comparison (<a href=\"https://www.postgresql.org/docs/9.4/static/functions-comparisons.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/9.4/static/functions-comparisons.html</a>). What are you trying to do? Find costumer who have a phone number in that pattern?"}, {"owner": {"reputation": 161, "user_id": 1525501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60a84205108bed01e8f77cd5d6950421?s=128&d=identicon&r=PG", "display_name": "Oviron", "link": "https://stackoverflow.com/users/1525501/oviron"}, "reply_to_user": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476881439, "post_id": 40130433, "comment_id": 67533679, "body": "@lcguida exactly."}, {"owner": {"reputation": 3467, "user_id": 906511, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61286bced0ae2da15261439d1bb62297?s=128&d=identicon&r=PG", "display_name": "lcguida", "link": "https://stackoverflow.com/users/906511/lcguida"}, "edited": false, "score": 0, "creation_date": 1476882475, "post_id": 40130433, "comment_id": 67534487, "body": "And <code>phones</code> is a array? Is a String? is what?"}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 1915537, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q2U3D.jpg?s=128&g=1", "display_name": "Andrey Skuratovsky", "link": "https://stackoverflow.com/users/1915537/andrey-skuratovsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1476884835, "last_edit_date": 1476884835, "creation_date": 1476880167, "answer_id": 40131449, "question_id": 40130433, "link": "https://stackoverflow.com/questions/40130433/activerecord-query-against-array-column-using-wildcard/40131449#40131449", "title": "Activerecord query against array column using wildcard", "body": "<p>I think, first of all, its better to use second table phones with fields customer_id, phone_number. I think it's more rails way ). In this way you can use this query</p>\n\n<pre><code>Phone.where(\"phone_number LIKE ?\", '%PART%').first.customer\n</code></pre>\n\n<p>If you serialize your array in some text field, by example JSON, you should use % on both sides of your pattern:</p>\n\n<pre><code>Customer.where('phones LIKE ?', '%+7985%')\n</code></pre>\n\n<p>If you have an array in your database, you should use <strong>unnest()</strong> function to expand an array to a set of rows.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 1525501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60a84205108bed01e8f77cd5d6950421?s=128&d=identicon&r=PG", "display_name": "Oviron", "link": "https://stackoverflow.com/users/1525501/oviron"}, "edited": false, "score": 0, "creation_date": 1476882116, "post_id": 40131494, "comment_id": 67534235, "body": "<code>&#39;%+7985%&#39;</code> will be the correct way, i believe. For cases like <code>[&#39;+7921123456&#39;, &#39;+7985123456&#39;]</code>"}], "tags": [], "owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "is_accepted": true, "score": 1, "last_activity_date": 1476880314, "creation_date": 1476880314, "answer_id": 40131494, "question_id": 40130433, "link": "https://stackoverflow.com/questions/40130433/activerecord-query-against-array-column-using-wildcard/40131494#40131494", "title": "Activerecord query against array column using wildcard", "body": "<p>Can you try this</p>\n\n<pre><code>Customer.where(\"array_to_string(phones, ', ') like ?\", '+7985%')\n</code></pre>\n\n<p>I believe this will work. </p>\n"}], "owner": {"reputation": 161, "user_id": 1525501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60a84205108bed01e8f77cd5d6950421?s=128&d=identicon&r=PG", "display_name": "Oviron", "link": "https://stackoverflow.com/users/1525501/oviron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 1, "accepted_answer_id": 40131494, "answer_count": 2, "score": 5, "last_activity_date": 1476884835, "creation_date": 1476877240, "last_edit_date": 1476879000, "question_id": 40130433, "link": "https://stackoverflow.com/questions/40130433/activerecord-query-against-array-column-using-wildcard", "title": "Activerecord query against array column using wildcard", "body": "<p>So let's say i have a <code>Customer</code> model with array column <code>phones</code>.\nIt's pretty easy to find all customers with given phone</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Customer.where('? = ANY(phones)', '+79851234567')\n</code></pre>\n\n<p>But i can't figure out how to use <code>LIKE</code> with wildcard when i want to find customers with phones similar to given one, something like:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Customer.where('ANY(phones) LIKE ?', '+7985%')\n</code></pre>\n\n<p>I'm using PostgreSQL 9.5 and Rais 4.2</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "database"], "comments": [{"owner": {"reputation": 2646, "user_id": 3899080, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6iZy6.jpg?s=128&g=1", "display_name": "Mahesh Madushanka", "link": "https://stackoverflow.com/users/3899080/mahesh-madushanka"}, "edited": false, "score": 0, "creation_date": 1476875187, "post_id": 40129581, "comment_id": 67529017, "body": "Created time not available on mysql.user table"}, {"owner": {"reputation": 699, "user_id": 5306391, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh4.googleusercontent.com/-QqS8n4PQZSw/AAAAAAAAAAI/AAAAAAAABgo/YnozuUmsWWc/photo.jpg?sz=128", "display_name": "Moataz Zaitoun", "link": "https://stackoverflow.com/users/5306391/moataz-zaitoun"}, "edited": false, "score": 0, "creation_date": 1476877354, "post_id": 40129581, "comment_id": 67530677, "body": "are you sure ? from 11pm to 4pm ? this means you want all records excluding from 4pm : 11pm right? if yes see my update"}], "answers": [{"tags": [], "owner": {"reputation": 7636, "user_id": 1788516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dea886f1f4124d1222c8a96b34c23f0?s=128&d=identicon&r=PG", "display_name": "Perry", "link": "https://stackoverflow.com/users/1788516/perry"}, "is_accepted": true, "score": 4, "last_activity_date": 1476876799, "last_edit_date": 1476876799, "creation_date": 1476875752, "answer_id": 40129914, "question_id": 40129581, "link": "https://stackoverflow.com/questions/40129581/fetch-records-within-time-stamp-but-not-specific-to-date/40129914#40129914", "title": "Fetch records within time stamp but not specific to date", "body": "<p>The mysql between function works different than you expect.</p>\n\n<blockquote>\n  <p>The between function expect the first parameter to be the min value en the second parameter to be the max value. See the documentation: <a href=\"http://dev.mysql.com/doc/refman/5.7/en/comparison-operators.html#operator_between\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.7/en/comparison-operators.html#operator_between</a></p>\n</blockquote>\n\n<p>Try this:</p>\n\n<pre><code>User.where(\"(TIME(created_at) BETWEEN '23:00:00' AND '23:59:59' OR TIME(created_at) BETWEEN '00:00:00' AND '03:59:59')\")\n</code></pre>\n\n<p>Based on your update it will be like this:</p>\n\n<pre><code>User.where(\"(TIME(created_at) BETWEEN '23:02:00' AND '23:59:59' OR TIME(created_at) BETWEEN '00:00:00' AND '04:03:59')\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 699, "user_id": 5306391, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh4.googleusercontent.com/-QqS8n4PQZSw/AAAAAAAAAAI/AAAAAAAABgo/YnozuUmsWWc/photo.jpg?sz=128", "display_name": "Moataz Zaitoun", "link": "https://stackoverflow.com/users/5306391/moataz-zaitoun"}, "is_accepted": false, "score": 1, "last_activity_date": 1476877568, "last_edit_date": 1476877568, "creation_date": 1476876008, "answer_id": 40130002, "question_id": 40129581, "link": "https://stackoverflow.com/questions/40129581/fetch-records-within-time-stamp-but-not-specific-to-date/40130002#40130002", "title": "Fetch records within time stamp but not specific to date", "body": "<p>Try this :</p>\n\n<pre><code>User.where.not(\"Hour(created_at) &gt;= '16:04' AND Hour(created_at) &lt;= '11:02'\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 7006680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b58e928f54f57fc8838913eacb61882?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil Patidar", "link": "https://stackoverflow.com/users/7006680/sunil-patidar"}, "is_accepted": false, "score": 0, "last_activity_date": 1476876166, "creation_date": 1476876166, "answer_id": 40130046, "question_id": 40129581, "link": "https://stackoverflow.com/questions/40129581/fetch-records-within-time-stamp-but-not-specific-to-date/40130046#40130046", "title": "Fetch records within time stamp but not specific to date", "body": "<p>Try this query:</p>\n\n<pre><code>User.where(\"DATE_FORMAT(`created_at`,'%H:%i:%s') BETWEEN '11:00:00' AND '04:00:00'\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7040345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca7c584d38bfb51f9905af189ccdcb8?s=128&d=identicon&r=PG&f=1", "display_name": "kiran madke", "link": "https://stackoverflow.com/users/7040345/kiran-madke"}, "is_accepted": false, "score": 0, "last_activity_date": 1476876443, "creation_date": 1476876443, "answer_id": 40130141, "question_id": 40129581, "link": "https://stackoverflow.com/questions/40129581/fetch-records-within-time-stamp-but-not-specific-to-date/40130141#40130141", "title": "Fetch records within time stamp but not specific to date", "body": "<pre><code>select * from time_table \n   where HOUR(time_column) BETWEEN 6 AND 11\n</code></pre>\n"}], "owner": {"reputation": 562, "user_id": 4318953, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-YaI4dV-ir8U/AAAAAAAAAAI/AAAAAAAAA_c/pXc7-4d6csg/photo.jpg?sz=128", "display_name": "Shefalee Chaudhary", "link": "https://stackoverflow.com/users/4318953/shefalee-chaudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 40129914, "answer_count": 4, "score": 3, "last_activity_date": 1477108863, "creation_date": 1476874924, "last_edit_date": 1477108863, "question_id": 40129581, "link": "https://stackoverflow.com/questions/40129581/fetch-records-within-time-stamp-but-not-specific-to-date", "title": "Fetch records within time stamp but not specific to date", "body": "<p>I want to fetch records of users who signed in between 11:02 pm to 4:04 pm, date doesn't matter.</p>\n\n<p>I tried something like : </p>\n\n<pre><code>User.where(\"TIME(created_at) BETWEEN '11:02:00' AND '04:04:00'\")\n</code></pre>\n\n<p>But it's not working. Any help to this is greatly appreciated.</p>\n"}, {"tags": ["ruby", "character-encoding"], "comments": [{"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476875115, "post_id": 40129567, "comment_id": 67528962, "body": "Is this what are you looking for <code>Encoding.find(&#39;utf-8&#39;)</code> or <code>Encoding.list</code> ? Though find will raise error if does not exists"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1476876912, "post_id": 40129567, "comment_id": 67530382, "body": "Can you clarify your question? UTF-8 is not a character set, it is a character encoding. Also, what does it mean for a character set to &quot;exist&quot;?"}, {"owner": {"reputation": 33, "user_id": 6857860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dbb94230b9326baf90b4687a6c8651?s=128&d=identicon&r=PG&f=1", "display_name": "chocku", "link": "https://stackoverflow.com/users/6857860/chocku"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476955275, "post_id": 40129567, "comment_id": 67569749, "body": "@J&#246;rg W Mittag One part of my app converts strings from one encoding like ISO-8859-1 to another like UTF-8. But in some cases the user provides wrong encoding name like ISO-9959-1 or ISO-8000. In these cases I got an error &quot;Invalid Encoding&quot;. Instead I looked for a method which could specifically throw error like &quot;unknown encoding name&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 2, "last_activity_date": 1476878166, "last_edit_date": 1476878166, "creation_date": 1476876655, "answer_id": 40130229, "question_id": 40129567, "link": "https://stackoverflow.com/questions/40129567/detect-whether-charset-exists-in-ruby/40130229#40130229", "title": "Detect whether charset exists in ruby", "body": "<p>This can be achieved with <a href=\"https://ruby-doc.org/core/Encoding.html#method-c-find\" rel=\"nofollow\"><code>Encoding.find</code></a>. However, this raises an argument exception if the encoding does not exist:</p>\n\n<pre><code>Encoding.find('utf-8') # =&gt; #&lt;Encoding:UTF-8&gt;\nEncoding.find('utf-88') # =&gt; ArgumentError: unknown encoding name - utf-88\n</code></pre>\n\n<p>A simple workaround would be to rescue the exception:</p>\n\n<pre><code>Encoding.find('utf-8') rescue nil # =&gt; #&lt;Encoding:UTF-8&gt;\nEncoding.find('utf-88') rescue nil # =&gt; nil\n</code></pre>\n\n<p>Alternatively, if you'd rather not deal with exceptions, you could use <a href=\"https://ruby-doc.org/core/Encoding.html#method-c-name_list\" rel=\"nofollow\"><code>Encoding.name_list</code></a>:</p>\n\n<pre><code>Encoding.name_list.include?('UTF-8') =&gt; true\nEncoding.name_list.include?('UTF-88') =&gt; false\n</code></pre>\n\n<p>However, this approach also has a downside, in that the the queried encoding is now case sensitive - for example:</p>\n\n<pre><code>Encoding.name_list.include?('utf-8') =&gt; false\n</code></pre>\n\n<p>If this is problematic, you could use a case insensitive comparison such as:</p>\n\n<pre><code>Encoding.name_list.any?{ |encoding| encoding.casecmp('utf-8').zero? }\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6857860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dbb94230b9326baf90b4687a6c8651?s=128&d=identicon&r=PG&f=1", "display_name": "chocku", "link": "https://stackoverflow.com/users/6857860/chocku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40130229, "answer_count": 1, "score": 0, "last_activity_date": 1476886455, "creation_date": 1476874882, "last_edit_date": 1476886455, "question_id": 40129567, "link": "https://stackoverflow.com/questions/40129567/detect-whether-charset-exists-in-ruby", "title": "Detect whether charset exists in ruby", "body": "<p>Is it possible to check in Ruby whether a given charset exists/is installed. </p>\n\n<p>For example:</p>\n\n<p><code>check('utf-8')</code> -> True.</p>\n\n<p><code>check('utf-88')</code> -> False.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "paypal", "actionmailer", "mailer"], "comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1476874607, "post_id": 40129407, "comment_id": 67528534, "body": "are you using devise?"}, {"owner": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "reply_to_user": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 1, "creation_date": 1476874721, "post_id": 40129407, "comment_id": 67528648, "body": "@Sravan Yes, i am. Why?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875013, "post_id": 40129590, "comment_id": 67528875, "body": "if i used &#39;current_user.email&#39; - wouldn&#39;t that just send to the logged in user?"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875075, "post_id": 40129590, "comment_id": 67528926, "body": "but you said that the email should go to the store owner?"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875146, "post_id": 40129590, "comment_id": 67528983, "body": "if you want to send the mail to the logged_in user, you can simply use, <code>current_user.email</code>, but of you want it to send it to store owner, check my answer."}, {"owner": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875147, "post_id": 40129590, "comment_id": 67528985, "body": "Store owner, but a customer could be logged in buying a product from the store."}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875270, "post_id": 40129590, "comment_id": 67529088, "body": "check now, sorry first updated <code>current_user</code> by mistake"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875359, "post_id": 40129590, "comment_id": 67529151, "body": "<code>LineItem.find(@payment_notification.line_item_id).product.st&zwnj;&#8203;ore.user.email</code>"}, {"owner": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875881, "post_id": 40129590, "comment_id": 67529546, "body": "This is what i got <code>undefined method </code>email&#39; for nil:NilClass`"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "edited": false, "score": 0, "creation_date": 1476875916, "post_id": 40129590, "comment_id": 67529584, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/126111/discussion-between-sravan-and-rails-learner\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": true, "score": 1, "last_activity_date": 1476875252, "last_edit_date": 1476875252, "creation_date": 1476874937, "answer_id": 40129590, "question_id": 40129407, "link": "https://stackoverflow.com/questions/40129407/mailer-challenge-with-rails/40129590#40129590", "title": "Mailer Challenge with Rails", "body": "<p>Referring your associations, you can get the <code>user_email</code> as,</p>\n\n<pre><code>LineItem.find(@payment_notification.line_item_id).product.store.user.email\n</code></pre>\n\n<p>Mailer,</p>\n\n<pre><code>class PaymentNotifier &lt; ActionMailer::Base\n\n def notify(payment_notification)\n    @payment_notification = payment_notification\n     mail to: LineItem.find(@payment_notification.line_item_id).product.store.user.email, subject: 'New order'\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6094382, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/8e8e88e3b7ba5f9d802fe180c7649988?s=128&d=identicon&r=PG&f=1", "display_name": "Rails_learner", "link": "https://stackoverflow.com/users/6094382/rails-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "accepted_answer_id": 40129590, "answer_count": 1, "score": 0, "last_activity_date": 1476875252, "creation_date": 1476874514, "question_id": 40129407, "link": "https://stackoverflow.com/questions/40129407/mailer-challenge-with-rails", "title": "Mailer Challenge with Rails", "body": "<p>I'm trying to send a mail to the owner of a store after each transaction. Everything else is set up, but i can't seem to get the email address generated.</p>\n\n<pre><code>class PaymentNotifier &lt; ActionMailer::Base\n\n def notify(payment_notification)\n    @payment_notification = payment_notification\n   mail to: **'xxxxxxxxx'**, subject: 'New order'\n  end\nend\n</code></pre>\n\n<p>Payment Notification from Paypal comes into the system with details of the transaction:\ncart_id, line_item_id, product_title.</p>\n\n<p>Line_item has a cart_id column, as well as a product_id column.</p>\n\n<p>Product has a store_id column.</p>\n\n<p>Store has a user_id column.</p>\n\n<p>User has an <strong>email address</strong>.</p>\n\n<p>Trying to find out how i can access this email address from my mailer and fire the email after the transaction.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["ruby", "nagios"], "comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476874063, "post_id": 40128958, "comment_id": 67528089, "body": "can you add what you get in <code>j</code> ? This error told you that some data by one of this keys <code>[0] or [&quot;Command Status&quot;] or [&quot;Response Data&quot;] or [&quot;BBU_Info&quot;] or [0]</code> return nil, so next key can&#39;t be used for nil"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476874760, "post_id": 40128958, "comment_id": 67528673, "body": "output = %x{/usr/sbin/storcli /c0/bbu show j}  p JSON.parse(output)"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476875304, "post_id": 40128958, "comment_id": 67529114, "body": "And I answered you just write <code>puts JSON.parse(output)</code> it will return what you get in <code>j</code>"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476875358, "post_id": 40128958, "comment_id": 67529150, "body": "Also, what version of Ruby do you use?"}, {"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476875477, "post_id": 40128958, "comment_id": 67529238, "body": "@AlexGolubenko I&#39;m using ruby 1.8.7"}, {"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476876009, "post_id": 40128958, "comment_id": 67529664, "body": "@AlexGolubenko I&#39;m getting some kinda JSON output like this, <code>{&quot;Controllers&quot;=&gt;[{&quot;Command Status&quot;=&gt;{&quot;Controller&quot;=&gt;0, &quot;Status&quot;=&gt;&quot;Failure&quot;, &quot;Description&quot;=&gt;&quot;None&quot;, &quot;Detailed Status&quot;=&gt;[{&quot;Ctrl&quot;=&gt;0, &quot;Status&quot;=&gt;&quot;Failed&quot;, &quot;Property&quot;=&gt;&quot;-&quot;, &quot;ErrMsg&quot;=&gt;&quot;use &#47;cx&#47;cv&quot;, &quot;ErrCd&quot;=&gt;1001}]}}]} CRITICAL: error reading BBU status: undefined method </code>[]&#39; for nil:NilClass`"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476876658, "post_id": 40128958, "comment_id": 67530173, "body": "So, you can see that <code>[&quot;Controllers&quot;][0]</code> doesn&#39;t return <code>hash</code> with <code>key</code> named <code>&quot;Response Data&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 0, "creation_date": 1476874913, "post_id": 40129278, "comment_id": 67528789, "body": "can you please elaborate little bit, I still don&#39;t understand what to check for"}, {"owner": {"reputation": 1058, "user_id": 3134309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QlzB1.jpg?s=128&g=1", "display_name": "gaga5lala", "link": "https://stackoverflow.com/users/3134309/gaga5lala"}, "reply_to_user": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 1, "creation_date": 1476877296, "post_id": 40129278, "comment_id": 67530636, "body": "Hi @Rahul, I add an unmatched json example for demo why the error occur."}, {"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 0, "creation_date": 1476878076, "post_id": 40129278, "comment_id": 67531175, "body": "yep, I understood this very well."}], "tags": [], "owner": {"reputation": 1058, "user_id": 3134309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QlzB1.jpg?s=128&g=1", "display_name": "gaga5lala", "link": "https://stackoverflow.com/users/3134309/gaga5lala"}, "is_accepted": false, "score": 2, "last_activity_date": 1476877140, "last_edit_date": 1476877140, "creation_date": 1476874208, "answer_id": 40129278, "question_id": 40128958, "link": "https://stackoverflow.com/questions/40128958/ruby-undefined-method-for-nilnilclass/40129278#40129278", "title": "Ruby undefined method `[]&#39; for nil:NilClass", "body": "<p>Seems your code break at</p>\n\n<pre><code>j = JSON.parse(output)\nresult = j[\"Controllers\"][0][\"Command Status\"][\"Status\"]\nstatus = j[\"Controllers\"][0][\"Response Data\"][\"BBU_Info\"][0][\"State\"]\n</code></pre>\n\n<p>you should check which line </p>\n\n<ol>\n<li><code>j == nil</code>, and your want <code>j[\"Controllers\"]</code></li>\n<li><code>result = j[\"Controllers\"][0][\"Command Status\"][\"Status\"]</code></li>\n<li><code>status = j[\"Controllers\"][0][\"Response Data\"][\"BBU_Info\"][0][\"State\"]</code></li>\n</ol>\n\n<p>cause <code>undefined method '[]' for nil:NilClass</code> by display <code>j</code> value first, and make sure json format match your code.</p>\n\n<pre><code>j = JSON.parse(output)\np j # display value\n</code></pre>\n\n<p>update:</p>\n\n<p>your json format should match your code, otherwise it will raise error.</p>\n\n<p>for example: </p>\n\n<pre><code>{\n  \"Controllers\": [\n    {\n      \"Commandddd Status\": { # format not match\n        \"Status\": \"success\"\n      }\n    }\n  ]\n}\n\n# code and json format not match\nj[\"Controllers\"][0][\"Command Status\"] # nil\n\nj[\"Controllers\"][0][\"Command Status\"][\"Status\"]\n=&gt; nil[\"Status\"] #  boom!\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 0, "creation_date": 1476877952, "post_id": 40130465, "comment_id": 67531093, "body": "thanks, this helped me a lot. Could you please explain what is that piece of code, how it&#39;s working from <code>def try ... end</code> ?"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "reply_to_user": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 0, "creation_date": 1476878205, "post_id": 40130465, "comment_id": 67531260, "body": "@Rahul I think, you can add new Question, It is not convenient to answer in the comments"}, {"owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "edited": false, "score": 0, "creation_date": 1476878272, "post_id": 40130465, "comment_id": 67531324, "body": "can you join me on chat room <a href=\"http://chat.stackoverflow.com/rooms/126109/discussion-between-rahul-and-alex-golubenko\">chat.stackoverflow.com/rooms/126109/&hellip;</a> ?"}], "tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1476879383, "last_edit_date": 1476879383, "creation_date": 1476877321, "answer_id": 40130465, "question_id": 40128958, "link": "https://stackoverflow.com/questions/40128958/ruby-undefined-method-for-nilnilclass/40130465#40130465", "title": "Ruby undefined method `[]&#39; for nil:NilClass", "body": "<p>For example to my comment, lets imagine that we have correct JSON:</p>\n\n<pre><code>j = {\"Controllers\" =&gt; [{\"Comand Status\" =&gt; {\"status\" =&gt; 'ok'}}]}\n=&gt; {\"Controllers\"=&gt;[{\"Comand Status\"=&gt;{\"status\"=&gt;\"ok\"}}]} \n</code></pre>\n\n<p>so by typing your first line, it's should return correct result:</p>\n\n<pre><code>&gt; j[\"Controllers\"][0][\"Comand Status\"][\"status\"]\n=&gt; \"ok\" \n</code></pre>\n\n<p>But also you can get wrong JSON, for example: </p>\n\n<pre><code>j_e = {\"Controllers\" =&gt; []}\n</code></pre>\n\n<p>so now it's return error:</p>\n\n<pre><code>&gt;j_e[\"Controllers\"][0][\"Comand Status\"][\"status\"]\nNoMethodError: undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>to solve it, you can use something like: </p>\n\n<pre><code>def try data, keys # there we take arguments: data == j, and keys == array with keys\n  return data if data.nil? # there we check: if data, that we send == nil, for example j = nil, array = ['first', etc..] we should stop this method and return nil as result\n  value = data[keys.shift] # on this line we try to get some data from j ##keys.shift will delete first element from array that we send to this method and return as `key` for `data`, for example data['Controllers'] so keys now will looks like: [0, 'Comand Status', 'status']\n  unless keys.empty? #on this line we check if on the pred line we was used the last key and keys now looks like: [] we: *return value and if it's not empty we just **call this method 1 more time\n    try(value, keys) #**value = [{\"Comand Status\" =&gt; {\"status\" =&gt; 'ok'}}] and keys = [0, 'Comand Status', 'status']\n  else\n    value #*nil or value\n  end\nend\n\n\n\nj = {\"Controllers\"=&gt;[{\"Comand Status\"=&gt;{\"status\"=&gt;\"ok\"}}]}\ntry(j, ['Controllers', 0, 'Comand Status', 'status'])\n&gt;'ok'\ntry j, ['Controllers', 1, 'Comand Status', 'status']\n&gt; nil\n</code></pre>\n\n<p>in you code this should looks like:</p>\n\n<pre><code>require 'json'\n\ndef try data, keys\n  return data if data.nil?\n  value = data[keys.shift]  \n  unless keys.empty?\n    try(value, keys)\n  else\n    value\n  end\nend\n\n\noutput = %x{/usr/sbin/storcli /c0/bbu show j}\nbegin\n  j = JSON.parse(output)\n  result = try(j, [\"Controllers\", 0, \"Command Status\", \"Status\"])\n  status = try(j, [\"Controllers\", 0, \"Response Data\", \"BBU_Info\", 0, \"State\"])\nrescue Exception =&gt; e\n  puts \"CRITICAL: error reading BBU status: #{e}\"\n  exit 2\nend\n\nif result != 'Success'\n  puts \"CRITICAL: command not successful, result: #{result}\"\n  exit 2\nend\n\nif status != 'Optimal'\n  puts \"CRITICAL: BBU not optimal, status is #{status}\"\n  exit 2\nend\n\nputs \"OK: BBU is optimal\"\n</code></pre>\n\n<p>Also, for <strong>Ruby 2.3.0+</strong></p>\n\n<p>it's much easier, just:</p>\n\n<pre><code>j.dig(\"Controllers\", 0, \"Comand Status\", \"status\")\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 2598184, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xwKWQ.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/2598184/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 40130465, "answer_count": 2, "score": 0, "last_activity_date": 1476879383, "creation_date": 1476873371, "question_id": 40128958, "link": "https://stackoverflow.com/questions/40128958/ruby-undefined-method-for-nilnilclass", "title": "Ruby undefined method `[]&#39; for nil:NilClass", "body": "<p>I'm trying to make nagios check for BBU (Battery Backup Unit), I have this ruby script called <code>check_bbu</code></p>\n\n<pre><code>#!/usr/bin/ruby\nrequire 'json'\n\noutput = %x{/usr/sbin/storcli /c0/bbu show j}\n\nbegin\n        j = JSON.parse(output)\n        result = j[\"Controllers\"][0][\"Command Status\"][\"Status\"]\n        status = j[\"Controllers\"][0][\"Response Data\"][\"BBU_Info\"][0][\"State\"]\nrescue Exception =&gt; e\n        puts \"CRITICAL: error reading BBU status: #{e}\"\n        exit 2\nend\n\nif result != 'Success'\n        puts \"CRITICAL: command not successful, result: #{result}\"\n        exit 2\nend\n\nif status != 'Optimal'\n        puts \"CRITICAL: BBU not optimal, status is #{status}\"\n        exit 2\nend\n\nputs \"OK: BBU is optimal\"\n</code></pre>\n\n<p>But when I run this plugin I'm getting following error,</p>\n\n<pre><code>$ ./check_nrpe -u -t 30 -H foo.example.com -c check_bbu\nCRITICAL: error reading BBU status: undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>What am I doing wrong in this ?</p>\n"}, {"tags": ["ruby", "https", "phantomjs", "cucumber"], "comments": [{"owner": {"reputation": 23, "user_id": 5571769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fcaccab0c5fd4657a617e2c313400111?s=128&d=identicon&r=PG&f=1", "display_name": "DHarls17", "link": "https://stackoverflow.com/users/5571769/dharls17"}, "edited": false, "score": 0, "creation_date": 1476883935, "post_id": 40128521, "comment_id": 67535565, "body": "Ok, so I&#39;m pretty certain that this command line setting (for example, --ignore-ssl-errors=yes) needs to be added into the env.rb file of my cucumber project. But what I don&#39;t know is how to add this. I&#39;ve seen an example for Capybara, but I&#39;m not using Capybara (I&#39;m using Selenium and Phantom)."}, {"owner": {"reputation": 847, "user_id": 1482694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e4742341658d0f90de0b770fc4f01f?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1482694/sam"}, "edited": false, "score": 0, "creation_date": 1476964119, "post_id": 40128521, "comment_id": 67576014, "body": "Can you post the code you are using to initiate phantomjs driver with selenium ?"}, {"owner": {"reputation": 23, "user_id": 5571769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fcaccab0c5fd4657a617e2c313400111?s=128&d=identicon&r=PG&f=1", "display_name": "DHarls17", "link": "https://stackoverflow.com/users/5571769/dharls17"}, "reply_to_user": {"reputation": 847, "user_id": 1482694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e4742341658d0f90de0b770fc4f01f?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1482694/sam"}, "edited": false, "score": 0, "creation_date": 1476976752, "post_id": 40128521, "comment_id": 67585707, "body": "I just have this in my Cucumber env.rb file;  <code>@driver = Selenium::WebDriver.for ENV[&#39;BROWSER&#39;].to_sym</code>  and this in my cucumber.yml file;  <code>phantomjs: BROWSER=phantomjs</code>  then pass the browser type using the Cucumber profile (-p phantomjs).  Thanks."}], "owner": {"reputation": 23, "user_id": 5571769, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fcaccab0c5fd4657a617e2c313400111?s=128&d=identicon&r=PG&f=1", "display_name": "DHarls17", "link": "https://stackoverflow.com/users/5571769/dharls17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476899741, "creation_date": 1476872301, "last_edit_date": 1476899741, "question_id": 40128521, "link": "https://stackoverflow.com/questions/40128521/cucumber-phantomjs-not-loading-https-so-how-do-i-change-the-phantom-settings", "title": "Cucumber/Phantomjs not loading https - so how do I change the phantom settings?", "body": "<p>I'm using phantomjs as my browser to run my ruby cucumber scripts.</p>\n\n<p>When I try and run some https-based scripts, Chrome, Firefox, etc all pass but phantomjs fails.</p>\n\n<p>I've seen where I can change the phantomjs settings to <code>--ssl-protocol=any</code> for example, or <code>--ignore-ssl-errors=yes</code>.  But where do I set these when using Cucumber?</p>\n\n<p>I (naively) thought I could just add it to the end of the cucumber command (<code>cucumber ./features/ABC-1234.feature -p phantomjs --ignore-ssl-errors=yes etc, etc</code>), but this obviously didn't work.</p>\n\n<p>I've tried adding it to the cucumber hook file, but again to no avail.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "minitest"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1476877581, "post_id": 40127548, "comment_id": 67530836, "body": "Did you consider to stub the method on Tempfile that is used to write the data into that file and let it raise an error?"}, {"owner": {"reputation": 541, "user_id": 5106253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10207412646419526/picture?type=large", "display_name": "Paul D Smith", "link": "https://stackoverflow.com/users/5106253/paul-d-smith"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1476949045, "post_id": 40127548, "comment_id": 67565685, "body": "Excellent.  I&#39;d not come across stubbing although I imagined there would be something that did something similar - it&#39;s all about knowing the correct term to search for ;-)."}], "owner": {"reputation": 541, "user_id": 5106253, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10207412646419526/picture?type=large", "display_name": "Paul D Smith", "link": "https://stackoverflow.com/users/5106253/paul-d-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1476870788, "creation_date": 1476869707, "last_edit_date": 1476870788, "question_id": 40127548, "link": "https://stackoverflow.com/questions/40127548/how-to-test-rails-file-upload-failure", "title": "How to test rails file upload failure?", "body": "<p>There's lots of good stuff on how to test a Rails file upload, but how can I simulate a failure to test what happens in this case?  For example if there is some reason that the storage is temporarily unavailable, I would like the user to see a sensible error.\nCan I somehow simulate this sort of failure using minitest?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476875658, "post_id": 40127484, "comment_id": 67529377, "body": "I changed the controller as below"}, {"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476875687, "post_id": 40127484, "comment_id": 67529401, "body": "I changed the controller as below"}, {"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476875758, "post_id": 40127484, "comment_id": 67529464, "body": "I changed the controller to <b>@recipe_ingredients = RecipeIngredient.where(params[:item_id])</b> and now it shows the index page but it does not filter the results using the parameter."}, {"owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "edited": false, "score": 0, "creation_date": 1476877255, "post_id": 40127484, "comment_id": 67530611, "body": "Got it! Had to change my controller to <b>@recipe_ingredients = RecipeIngredient.where(:item_id =&gt; params[:item_id])</b>"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 1, "last_activity_date": 1476869527, "creation_date": 1476869527, "answer_id": 40127484, "question_id": 40127222, "link": "https://stackoverflow.com/questions/40127222/filtering-the-data-showed-on-index-page-using-parameter-received-in-url/40127484#40127484", "title": "Filtering the data showed on index page using parameter received in URL", "body": "<pre><code>@recipe_ingredients = RecipeIngredient.find(params[:item_id])\n</code></pre>\n\n<p>This will return you only one <code>RecipeIngredient</code> with <code>id = params[:item_id]</code> not activerecord array</p>\n\n<p>So you need to change <code>find</code> to <code>where</code> if you want to loop over <code>@recipe_ingredients</code></p>\n\n<pre><code>@recipe_ingredients = RecipeIngredient.where(params[:item_id])\n</code></pre>\n\n<p>or, you need to change the view</p>\n\n<pre><code>&lt;tbody&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= @recipe_ingredients.item.item %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= @recipe_ingredients.ingredient.ingredient %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= @recipe_ingredients.quantity %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= @recipe_ingredients.ingredient.recipe_unit %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', @recipe_ingredients %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_recipe_ingredient_path(@recipe_ingredients) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', @recipe_ingredients, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 40127484, "answer_count": 1, "score": 0, "last_activity_date": 1476869527, "creation_date": 1476868941, "last_edit_date": 1476869331, "question_id": 40127222, "link": "https://stackoverflow.com/questions/40127222/filtering-the-data-showed-on-index-page-using-parameter-received-in-url", "title": "Filtering the data showed on index page using parameter received in URL", "body": "<p>I have two models here for Item and RecipeIngredient as below where RecipeIngredient belongs to Item.</p>\n\n<hr>\n\n<h2>Model for Item</h2>\n\n<pre><code>class Item &lt; ApplicationRecord\n  belongs_to :item_type, :class_name=&gt;ItemType, :foreign_key=&gt;\"item_type_id\"\nend\n</code></pre>\n\n<hr>\n\n<h2>Model for RecipeIngredient</h2>\n\n<pre><code>class RecipeIngredient &lt; ApplicationRecord\n  belongs_to :item, :class_name=&gt;Item, :foreign_key=&gt;\"item_id\"\n  belongs_to :ingredient, :class_name=&gt;Ingredient, :foreign_key=&gt;\"ingredient_id\"\n  validates_numericality_of :quantity\nend\n</code></pre>\n\n<p>I have index page for Items where I have created a link to index page for RecipeIngredients and I am passing the id of the item in the URL as parameter.</p>\n\n<hr>\n\n<h2>Index Page for Item</h2>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;h1&gt;Items&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Item&lt;/th&gt;\n      &lt;th&gt;Item type&lt;/th&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @items.each do |item| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= item.item %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= item.item_type.item_type %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', item %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_item_path(item) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', item, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Add Recipe', recipe_ingredients_path(:item_id =&gt;item.id) %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;br&gt;\n\n&lt;%= link_to 'New Item', new_item_path %&gt;\n&lt;%= link_to \"Home\", '/' %&gt;\n</code></pre>\n\n<p>And I have the controller for RecipeIngredients as below.</p>\n\n<hr>\n\n<h2>Controller for RecipeIngredient</h2>\n\n<pre><code>  def index\n    @recipe_ingredients = RecipeIngredient.find(params[:item_id])\n  end\n</code></pre>\n\n<p>And the index page for recipe ingredients looks like as given below. I need to filter the data displayed on this index page of recipe ingredients only to match the item_id received as a parameter in URL.</p>\n\n<hr>\n\n<h2>Index for RecipeIngredients</h2>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;h1&gt;Recipe Ingredients&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Item&lt;/th&gt;\n      &lt;th&gt;Ingredient&lt;/th&gt;\n      &lt;th&gt;Quantity&lt;/th&gt;\n      &lt;th&gt;Unit&lt;/th&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @recipe_ingredients.each do |recipe_ingredient| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.item.item %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.ingredient.ingredient %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.quantity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.ingredient.recipe_unit %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', recipe_ingredient %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_recipe_ingredient_path(recipe_ingredient) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', recipe_ingredient, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;br&gt;\n\n&lt;%= link_to 'New Recipe Ingredient', new_recipe_ingredient_path %&gt;\n&lt;%= link_to 'Back', '/items' %&gt;\n</code></pre>\n\n<p>Right now I am getting this error:</p>\n\n<blockquote>\n  <p>undefined method `show' for #&lt; RecipeIngredient:0xa5653b8></p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "redirect", "polymorphic-associations"], "comments": [{"owner": {"reputation": 1568, "user_id": 966100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xN0ul.jpg?s=128&g=1", "display_name": "eeeeeean", "link": "https://stackoverflow.com/users/966100/eeeeeean"}, "edited": false, "score": 0, "creation_date": 1476904753, "post_id": 40127065, "comment_id": 67549466, "body": "&quot;is there a way to call a method in the controller model.&quot; What about: @notification.notifiable.is_a?(Request)"}, {"owner": {"reputation": 2405, "user_id": 135845, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agZcF.jpg?s=128&g=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/135845/eric"}, "edited": false, "score": 0, "creation_date": 1478201060, "post_id": 40127065, "comment_id": 68069424, "body": "I&#39;m having trouble with your terminology. Clicking on something doesn&#39;t &quot;redirect to the request&quot;, but I think you might be too tied to not doing things in the notifications_controller regardless. Can you describe more concrete steps for what you would like to see happen?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5979865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a848d144aa37e11930ed0c571fba881?s=128&d=identicon&r=PG&f=1", "display_name": "Adil Eleemrani", "link": "https://stackoverflow.com/users/5979865/adil-eleemrani"}, "edited": false, "score": 0, "creation_date": 1486066323, "post_id": 42011329, "comment_id": 71198317, "body": "in this project, adding the both notifications and history that are shown in a context( each context depend on where the user is), so he will view specific notif and histories. if anyone need details about the making of it feel free to ask."}], "tags": [], "owner": {"reputation": 21, "user_id": 5979865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a848d144aa37e11930ed0c571fba881?s=128&d=identicon&r=PG&f=1", "display_name": "Adil Eleemrani", "link": "https://stackoverflow.com/users/5979865/adil-eleemrani"}, "is_accepted": true, "score": 0, "last_activity_date": 1486065846, "creation_date": 1486065846, "answer_id": 42011329, "question_id": 40127065, "link": "https://stackoverflow.com/questions/40127065/rails-polymorphic-associations-redirection-depending-on-model-using-the-model/42011329#42011329", "title": "rails polymorphic associations, redirection depending on model, using the model&#39;s controller", "body": "<p>i ended up adding an attribute to the notification model, message_type : integer.\nOnce the notification is clicked on, the redirection will always be the same : to a methode in the NotificationController (redirect_notification), now the notification known, also the depending model is too (from the polymorphic relation).\nin the NotificationController :</p>\n\n<pre><code>def redirect_notification    \n   notification =Notification.find(params[:id]) // here i get the notification  \n   notification.notifiable.get_notification_path(notification.message_type)\nend\n</code></pre>\n\n<p>we take advantage of the poymorphic when using notification.notifiable.\nSo, i define a method called get_notification_path(message_type) in each model who have a polymorphic association with notifications, as example :</p>\n\n<pre><code>class Document &lt; ActiveRecord::Base\n  has_many :notifications, as: :notifiable\n  def get_notification_path(message_type)\n    if message_type == 0\n       \"/documents\"// this is just an example, here you can put any redirection you want, you can include url_helpers.\n    elsif message_type == 1\n       url_for user_path\n    end\n  end\nend\n</code></pre>\n\n<p>This way, i get the redirection i need, using the polymorphic associations and without adding unneeded routes.</p>\n"}], "owner": {"reputation": 21, "user_id": 5979865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a848d144aa37e11930ed0c571fba881?s=128&d=identicon&r=PG&f=1", "display_name": "Adil Eleemrani", "link": "https://stackoverflow.com/users/5979865/adil-eleemrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 42011329, "answer_count": 1, "score": 1, "last_activity_date": 1486065846, "creation_date": 1476868517, "question_id": 40127065, "link": "https://stackoverflow.com/questions/40127065/rails-polymorphic-associations-redirection-depending-on-model-using-the-model", "title": "rails polymorphic associations, redirection depending on model, using the model&#39;s controller", "body": "<p>in the application i'm working on, i need to install a notification system.</p>\n\n<pre><code>class Notification &lt; ActiveRecord::Base\n  belongs_to :notifiable, polymorphic: true\nend\n\nclass Request &lt; ActiveRecord::Base\n has_many :notifications, as: :notifiable\nend\n\nclass Document &lt; ActiveRecord::Base\n has_many :notifications, as: :notifiable\nend\n</code></pre>\n\n<p>after created, the notifications should redirect to differents view depending on the notification type, so it could be forthe same model and different redirections ( so the redirect_to notification.notifiable isn't a solution since i need many different redirections for that same model, not only the show).\nworking with polymorphic_path or url, also dont give different redirections, only defined prefix helpers.</p>\n\n<p>what i need more explicitly, for example there let's take two different types of notifications, the one where a request is submited, so clicking on it will redirect to the request itself, but when the request is done the user will be redirected to his dashboard.</p>\n\n<p>i dont want to redirect to the notifications_controller and test on the model and then test again on the notification type, i hope that the polymorphism here could help. is there a way to call a method in the controller model (the model is detected from the polymorphic association )</p>\n\n<p>and thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "orm"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 0, "last_activity_date": 1476868545, "creation_date": 1476868545, "answer_id": 40127072, "question_id": 40127052, "link": "https://stackoverflow.com/questions/40127052/finding-the-number-of-models-with-a-certain-attribute/40127072#40127072", "title": "Finding the number of models with a certain attribute", "body": "<blockquote>\n  <p>I want to find all the Users in my database with one or more Cars.</p>\n</blockquote>\n\n<pre><code>User.includes(:cars).where.not(cars: { id: nil })\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1476868790, "post_id": 40127132, "comment_id": 67524167, "body": "This is wrong in a way, that it won&#39;t return a number of <code>User</code> objects, but a number of <code>Car</code> objects, that are associated with at least single user"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 0, "last_activity_date": 1476869070, "last_edit_date": 1476869070, "creation_date": 1476868685, "answer_id": 40127132, "question_id": 40127052, "link": "https://stackoverflow.com/questions/40127052/finding-the-number-of-models-with-a-certain-attribute/40127132#40127132", "title": "Finding the number of models with a certain attribute", "body": "<p>For your example try <code>joins</code> with <code>count</code>:</p>\n\n<pre><code>User.joins(:cars).distinct.count\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 2320239, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/daef5b7116143c14162b242bf0b1a35a?s=128&d=identicon&r=PG", "display_name": "user2320239", "link": "https://stackoverflow.com/users/2320239/user2320239"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 40127072, "answer_count": 2, "score": 0, "last_activity_date": 1476869070, "creation_date": 1476868473, "question_id": 40127052, "link": "https://stackoverflow.com/questions/40127052/finding-the-number-of-models-with-a-certain-attribute", "title": "Finding the number of models with a certain attribute", "body": "<p>Hi I have a model in my database User, a user can have zero, one or many Cars. I want to find all the Users in my database with one or more Cars. At the moment I have logic that says:</p>\n\n<pre><code>@car_user_count\nfor user in Users.all do\n\n    if user.cars.count &gt; 0 \n        @car_user_count = @car_user_count + 1\n\nend\n</code></pre>\n\n<p>This seems like an overly complicated way of doing this. I assume there must be a way of doing something like:</p>\n\n<pre><code>User.where(Cars.count &gt; 0).all.count\n</code></pre>\n\n<p>but I just can't seem to get it to work, any help with this would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller", "routes"], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476869187, "post_id": 40127306, "comment_id": 67524450, "body": "Thanks for your answer, I want to create resource_image for the request. But when I put @request.resource_image.build. It prints out error that there is no such method in the Request model"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "reply_to_user": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476869387, "post_id": 40127306, "comment_id": 67524583, "body": "Again you dont have that association, you have only <code>requests_has_images</code>, <code>response_images</code>, <code>chosen_images</code>"}, {"owner": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476869569, "post_id": 40127306, "comment_id": 67524716, "body": "Oh right, that fixed one problem. I will edit my question. The problem now is this error: &#39;No route matches {:action=&gt;&quot;create_for_request&quot;, :controller=&gt;&quot;requests&quot;, :id=&gt;&quot;11&quot;}`"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "reply_to_user": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476869828, "post_id": 40127306, "comment_id": 67524923, "body": "Thats because <code>create_for_request</code> is in <code>ImagesController</code> not in <code>RequestsController</code> so change that in form accordingly"}, {"owner": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476870074, "post_id": 40127306, "comment_id": 67525124, "body": "Can you help me solve this nested routing problem? If I explicitly specifies: &#39;controller: &quot;image&quot; &#39; it said no routes match &#39;create_for_request&#39; for image controller. This is because it is a nested route."}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "reply_to_user": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "edited": false, "score": 0, "creation_date": 1476870301, "post_id": 40127306, "comment_id": 67525314, "body": "I think it should be <code>images</code> . Try this"}, {"owner": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "reply_to_user": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476870938, "post_id": 40127306, "comment_id": 67525797, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/126090/discussion-between-long-le-and-sajan\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476870124, "last_edit_date": 1476870124, "creation_date": 1476869094, "answer_id": 40127306, "question_id": 40127023, "link": "https://stackoverflow.com/questions/40127023/rails-form-for-setting-nested-routes-with-custom-action/40127306#40127306", "title": "Rails: form_for setting Nested Routes with custom action", "body": "<p>You have mentioned <code>@request.images.build</code> in form but I don't see that you have any association like Request <code>has_many :images</code> instead you have several other association which involves image. I dont what which association you exactly want to build there so I can only suggest that change that <code>build</code> to actual association you want and also you may need to adjust your <code>create_for_request</code> a little based on that.</p>\n\n<p>EDIT:\nOP changed <code>@request.images.build</code> line in posted question to fix the issue. and solution to his new problem mentioned in comment section of this answer is to change the <code>controller</code> in form declaration. since you are referring <code>a action</code> which is not present in <code>Request</code> controller.</p>\n"}], "owner": {"reputation": 350, "user_id": 4339490, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/09b68aecb58b78a66d3b3f014c0e57c0?s=128&d=identicon&r=PG&f=1", "display_name": "Long Le", "link": "https://stackoverflow.com/users/4339490/long-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476870124, "creation_date": 1476868385, "last_edit_date": 1476869686, "question_id": 40127023, "link": "https://stackoverflow.com/questions/40127023/rails-form-for-setting-nested-routes-with-custom-action", "title": "Rails: form_for setting Nested Routes with custom action", "body": "<p>I have a problem with nested routes with custom action. I want to make a form url path: <code>localhost:3000/requests/2/images/create_for_request</code>. Where the custom action: <code>create_for_request</code> is called in the <code>ImagesController</code>, with the <code>request_id</code> from <code>requests/show.html.erb</code>. \nBelow is the error:</p>\n\n<pre><code>No route matches {:action=&gt;\"create_for_request\", :controller=&gt;\"requests\", :id=&gt;\"11\"}\n</code></pre>\n\n<p>request.rb:</p>\n\n<pre><code>class Request &lt; ApplicationRecord\n  belongs_to :user\n  alias_attribute :requester, :user\n  has_many :requests_has_images\n  has_many :response_images, through: :requests_has_images, class_name: 'Image', source: 'image'\n  has_many :chosen_images, lambda {where(chosen: true)}, through: :requests_has_images, class_name: 'Image', source: 'image'\n\n  def is_requester(user)\n    if user &amp;&amp; self.user_id == user.id\n      return true\n    else\n      return false\n    end\n  end  \nend\n</code></pre>\n\n<p>config.rb</p>\n\n<pre><code>  resources :requests do\n    post 'images/create_for_request' =&gt; 'images#create_for_request'\n    put 'images/edit_for_request' =&gt; 'images#edit_for_request'\n    post 'images/delete_for_request' =&gt; 'images#delete_for_request'\n  end\n</code></pre>\n\n<p>requests/show.html.erb:</p>\n\n<pre><code>&lt;h2&gt;Make Response Image&lt;/h2&gt;\n# Send this form for image to image controller with request_id of this request\n&lt;%= form_for [@request, @request.response_images.build], url: url_for(action: 'create_for_request') do |f|  %&gt;\n&lt;p&gt;\n</code></pre>\n\n<p>images_controller.rb:</p>\n\n<pre><code>  def create_for_request    \n    @request = Request.find(params[:request_id])    \n    if @request          \n      @image = Image.new(image_params)\n      add_file_params(@image)\n      @image.request = @request\n      if @image.save       \n        redirect_to request_path(@request)\n      end     \n    else\n     #TODO show error no such request \n    end\n  end  \n</code></pre>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["ruby", "oop"], "answers": [{"comments": [{"owner": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "edited": false, "score": 0, "creation_date": 1476874301, "post_id": 40127018, "comment_id": 67528289, "body": "thanks for your answer. I knew about GC, but what surprised me is that it didn&#39;t removed the same number of objects for each run"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1476868370, "creation_date": 1476868370, "answer_id": 40127018, "question_id": 40126167, "link": "https://stackoverflow.com/questions/40126167/classobjects-deleted-randomly/40127018#40127018", "title": "Class&#39;objects deleted randomly", "body": "<p>There is a memory management mechanizm called <a href=\"https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)\" rel=\"nofollow\">garbage collection</a>.</p>\n\n<p>In Ruby it is implemented in <a href=\"https://ruby-doc.org/core-2.3.1/GC.html\" rel=\"nofollow\">GC module</a>.</p>\n\n<p>What it does, is removing objects, which are no longer used/referenced, to optimize memory usage.</p>\n\n<p>Since you are not storing your created objects of <code>Table</code> class anywhere, GC treats them as garbage, and collects.</p>\n\n<p>You can inspect the <code>ObjectSpace</code> by <a href=\"https://ruby-doc.org/core-2.3.1/GC.html#method-c-disable\" rel=\"nofollow\"><code>disable</code></a>'ing garbage collection before the loop, for example.</p>\n"}], "owner": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 40127018, "answer_count": 1, "score": 0, "last_activity_date": 1476872791, "creation_date": 1476866161, "last_edit_date": 1476872791, "question_id": 40126167, "link": "https://stackoverflow.com/questions/40126167/classobjects-deleted-randomly", "title": "Class&#39;objects deleted randomly", "body": "<p>I have a ruby class named <code>Table</code>, and I'm iterating over a csv file to create an object of this class for every row if this row's first element hasn't been seen yet.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>require 'csv'\nclass Table\n  def initialize(name)\n    @name = name\n    @columns = {}\n  end\nend\n\ncsv_tables = File.read(\"db_apm.csv\")\ncsv_tables = CSV.parse(csv_tables, :headers =&gt; true)\ncsv_tables.each_with_index do |row, index|\n  # Check if object with the name present at row[0] has already been created \n  if ObjectSpace.each_object(Table).find { |object| object.instance_variable_get(:@name) == row[0] }.nil?\n    table = Table.new(row[0])\n    p row[0]\n  end\n  p ObjectSpace.each_object(Table).to_a.count\nend\np \"Final count\"\np ObjectSpace.each_object(Table).to_a.count\n</code></pre>\n\n<p>The csv file never changes, but I'm seeing some weird results: </p>\n\n<ol>\n<li><p>First, the count before the end of the each loop restarts at 0 during the same run of the script (I can see 1, 2, 3, ... 50, 1 , 2 , 3 ). </p></li>\n<li><p>Also, the final count changes between each run of the script. I sometimes get 17, or I can get 204 etc, it seems very random.</p></li>\n</ol>\n\n<p>I don't understand why this is happening since the file isn't changing, and the code is pretty straightforward. </p>\n\n<p>Here is a small extract of the file: </p>\n\n<pre><code>LOG_RECHERCHE\nLOG_RECHERCHE\nLOG_RECHERCHE\nLOG_RECHERCHE\nLOG_RECHERCHE\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nINTERVENTION\nSUIVI_SCRIPT_SQL\nSUIVI_SCRIPT_SQL\nSUIVI_SCRIPT_SQL\nSUIVI_SCRIPT_SQL\nVUE_COMPILE_RENCONTRE\nVUE_COMPILE_RENCONTRE\nVUE_COMPILE_RENCONTRE\nVUE_COMPILE_RENCONTRE\nVUE_COMPILE_RENCONTRE\nVUE_COMPILE_RENCONTRE\n</code></pre>\n\n<p>For this, the final count should be 4. I'm not sure the issue will occur with a small part of the file (the final count should be about 200 with the whole file).</p>\n\n<p>Is ruby deleting objects for some reasons ? </p>\n"}, {"tags": ["ruby", "linux", "chef-infra", "chef-recipe", "subdirectory"], "comments": [{"owner": {"reputation": 944, "user_id": 3963970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WC8zU.jpg?s=128&g=1", "display_name": "Mrigesh Priyadarshi", "link": "https://stackoverflow.com/users/3963970/mrigesh-priyadarshi"}, "edited": false, "score": 0, "creation_date": 1476865709, "post_id": 40125901, "comment_id": 67522088, "body": "You can refer :- <a href=\"http://stackoverflow.com/questions/23921708/how-do-i-change-recursively-the-owner-and-group-on-a-directory-with-chef\" title=\"how do i change recursively the owner and group on a directory with chef\">stackoverflow.com/questions/23921708/&hellip;</a>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1476865719, "post_id": 40125901, "comment_id": 67522098, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/23921708/how-do-i-change-recursively-the-owner-and-group-on-a-directory-with-chef\">How do I change recursively the owner and group on a directory with Chef?</a>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3580316"}, "edited": false, "score": 0, "creation_date": 1476867350, "post_id": 40126042, "comment_id": 67523181, "body": "I do not want to define each subfolder. Since there are a bunch of them and a long hierarchi of folders."}], "tags": [], "owner": {"reputation": 1063, "user_id": 1930504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a4UQO.jpg?s=128&g=1", "display_name": "Jack Bracken", "link": "https://stackoverflow.com/users/1930504/jack-bracken"}, "is_accepted": false, "score": 0, "last_activity_date": 1476865829, "creation_date": 1476865829, "answer_id": 40126042, "question_id": 40125901, "link": "https://stackoverflow.com/questions/40125901/chef-user-group-permissions-on-subfolders/40126042#40126042", "title": "Chef user group permissions on subfolders", "body": "<p>From the <a href=\"https://docs.chef.io/resource_directory.html\" rel=\"nofollow\">chef docs</a>:</p>\n\n<pre><code>recursive\n    Ruby Types: TrueClass, FalseClass\n\n    Create or delete parent directories recursively. For the owner, group, and mode properties, the value of this attribute applies only to the leaf directory. Default value: false.\n</code></pre>\n\n<p>User and group permissions won't recurse, you'll have to set them on each sub-directory manually.</p>\n\n<p>You could make this slightly easier by doing something like the following:</p>\n\n<pre><code>plugins = %w(plugin1 plugin2)\nplugins.each do |plugin|\n  directory \"/opt/jenkins/plugins/#{plugin}\" do\n    owner 'jenkins'\n    group 'jenkins'\n    mode '0755'\n    action :create\n  end\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3580316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 757, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476865829, "creation_date": 1476865396, "question_id": 40125901, "link": "https://stackoverflow.com/questions/40125901/chef-user-group-permissions-on-subfolders", "title": "Chef user group permissions on subfolders", "body": "<p>I am working trying to give user group permissions on subfolders in a Linux environment. In Linux that would be:</p>\n\n<pre><code>chown -R user:group /var/lib/temp/*\n</code></pre>\n\n<p>How can I acheive the same in Chef with Ruby? I have tried this:</p>\n\n<pre><code>directory '/opt/jenkins/plugins' do\n  owner 'jenkins'\n  group 'jenkins'\n  mode '0755'\n  recursive true\n  action :create\nend\n</code></pre>\n\n<p>By specifying recursive it does not help.</p>\n"}, {"tags": ["ruby", "hash", "rgbcolor"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1476867028, "post_id": 40126420, "comment_id": 67522997, "body": "That&#39;s exactly what I did some years ago. Unfortunately, my manager&#39;s name got mapped to a color he didn&#39;t like (it was pink or light orange, I think). I had to introduce a constant there, to affect the mapping :)"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1476867607, "post_id": 40126420, "comment_id": 67523345, "body": "I&#39;m using a similar approach to color labels. But instead of random RGB values, I&#39;m using HSL with a totally random hue and only limited variations in lightness and saturation. This gives more consistent colors."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1476867794, "post_id": 40126420, "comment_id": 67523458, "body": "@Stefan that&#39;s a nice idea, I might do that, thanks."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1476867823, "post_id": 40126420, "comment_id": 67523481, "body": "What variation did you have for l &amp; s btw?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1476868144, "post_id": 40126420, "comment_id": 67523702, "body": "@MaxWilliams they are actually fixed values now, depending on the type of label. I have a saturated color range with <code>hsl(x, 45%, 50%)</code> and a pastel color range with <code>hsl(x, 65%, 90%)</code>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1476871298, "last_edit_date": 1476871298, "creation_date": 1476866887, "answer_id": 40126420, "question_id": 40125832, "link": "https://stackoverflow.com/questions/40125832/generate-an-rgb-color-from-a-users-name-in-a-repeatable-way/40126420#40126420", "title": "Generate an rgb color from a user&#39;s name (in a repeatable way)", "body": "<p>You could build an MD5-hash of the user's name via:</p>\n\n<pre><code>require 'digest'\n\nname = 'foo'\ndigest = Digest::MD5.digest(name)\n#=&gt; \"\\xAC\\xBD\\x18\\xDBL\\xC2\\xF8\\\\\\xED\\xEFeO\\xCC\\xC4\\xA4\\xD8\"\n</code></pre>\n\n<p>Extract the first three 16-bit integers:</p>\n\n<pre><code>values = digest.unpack('SSS')\n#=&gt; [48556, 56088, 49740]\n</code></pre>\n\n<p>And map these 0..65535 values to 0..200:</p>\n\n<pre><code>values.map { |i| i * 201 / 0x10000 }\n#=&gt; [148, 172, 152]\n</code></pre>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 40126420, "answer_count": 1, "score": 1, "last_activity_date": 1476871298, "creation_date": 1476865197, "last_edit_date": 1476865353, "question_id": 40125832, "link": "https://stackoverflow.com/questions/40125832/generate-an-rgb-color-from-a-users-name-in-a-repeatable-way", "title": "Generate an rgb color from a user&#39;s name (in a repeatable way)", "body": "<p>I'd like to set a consistent color for a user's default avatar background, according to the following rules:</p>\n\n<ul>\n<li>rgb value, where each number can not be higher than 200 (ie between 0 and 200)</li>\n<li>use the full name, eg \"John Smith\" and \"John Smithy\" would give different colors.</li>\n<li>A small change to the name should create a totally different color.</li>\n</ul>\n\n<p>I'm thinking of something along these lines:</p>\n\n<ul>\n<li>hash the name into something which consists of three equal parts</li>\n<li>take each of the three parts and normalise it to a float between 0 and 1</li>\n<li>multiply these by 200 to get the r, g or b value.</li>\n</ul>\n\n<p>But I can't quite figure out how to go about it.  Any suggestions?  If I could do it without getting any extra gems that would be ideal.  I already use MD5 for some hashing stuff.</p>\n\n<p>NOTE: this isn't a security issue, it's just a bit of fun, so if two different names end up generating the same color once in a while it doesn't matter too much, but generally it would be nice to have the color values as varied as possible.</p>\n"}, {"tags": ["ruby", "calabash", "calabash-ios"], "comments": [{"owner": {"reputation": 2440, "user_id": 2047304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fcea18e8fa7f6f5016b38ac97be13f7?s=128&d=identicon&r=PG", "display_name": "jmoody", "link": "https://stackoverflow.com/users/2047304/jmoody"}, "edited": false, "score": 1, "creation_date": 1478077687, "post_id": 40125822, "comment_id": 68004369, "body": "Please provide a stack trace or just a snippet of one. I think the overflow is due to the <code>embed</code> method being called too many times."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7040985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8766fb95ff3ff68a5348490fc795b58c?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7040985/razvan"}, "edited": false, "score": 0, "creation_date": 1478636432, "post_id": 40376036, "comment_id": 68235546, "body": "Update: @jmoody, you were right, by removing <code>include Calabash::Cucumber::Operations</code> from some pages, the error is no longer happening. Thanks a lot, it really helped me."}], "tags": [], "owner": {"reputation": 2440, "user_id": 2047304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fcea18e8fa7f6f5016b38ac97be13f7?s=128&d=identicon&r=PG", "display_name": "jmoody", "link": "https://stackoverflow.com/users/2047304/jmoody"}, "is_accepted": true, "score": 2, "last_activity_date": 1478077618, "creation_date": 1478077618, "answer_id": 40376036, "question_id": 40125822, "link": "https://stackoverflow.com/questions/40125822/calabash-ios-stack-level-too-deep-systemstackerror-error-is-encountered-each/40376036#40376036", "title": "Calabash-iOS : stack level too deep (SystemStackError) error is encountered each time an assertion is failing", "body": "<p>I believe you are calling <code>include Calabash::Cucumber::Operations</code> somewhere.  You should not need to <code>include</code> Operations anywhere in your code.</p>\n"}], "owner": {"reputation": 33, "user_id": 7040985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8766fb95ff3ff68a5348490fc795b58c?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan", "link": "https://stackoverflow.com/users/7040985/razvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 40376036, "answer_count": 1, "score": 3, "last_activity_date": 1478077618, "creation_date": 1476865168, "last_edit_date": 1476865850, "question_id": 40125822, "link": "https://stackoverflow.com/questions/40125822/calabash-ios-stack-level-too-deep-systemstackerror-error-is-encountered-each", "title": "Calabash-iOS : stack level too deep (SystemStackError) error is encountered each time an assertion is failing", "body": "<p>I am encountering  \"stack level too deep (SystemStackError) \" error each time an assertion is failing, no matter what is the actual :timeout_message</p>\n\n<p>The following examples of code are just two of the many ones that rises above mentioned error each time an assertion is failing:</p>\n\n<pre><code> def wait_and_touch(element)\n    when_element_exists(element, :timeout =&gt; 10, :timeout_message =&gt; \"[#{element}] element was not identified\")\n  end\n\n  def check_user_message(usr)\n    usr_array = usr.gsub(\",\", \" \").split\n    usr_array.each do |item|\n      f_name = @test_data.get_first_name(item)\n      wait_for(:timeout =&gt; 5, :timeout_message =&gt; \"[FAIL] The message from #{f_name} should be displayed as unread!\") {\n        query(panel_1_msg_cell + \" descendant view {text CONTAINS '#{f_name}'}\", :font).first.include? 'Roboto-Black' }\n    end\n  end\n</code></pre>\n\n<p>I am currently using calabash -v 0.20.0 version with ruby-2.3.1 [ x86_64 ], OS X El Capitan, -v 10.11.6</p>\n\n<p>Any idea why is this happening?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "edited": false, "score": 0, "creation_date": 1476865226, "post_id": 40125724, "comment_id": 67521770, "body": "can you please give me the full command for adding the entry for the third table.  my third table have only the entry  user_id and role_id"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "reply_to_user": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "edited": false, "score": 0, "creation_date": 1476865348, "post_id": 40125724, "comment_id": 67521851, "body": "I already showed you some examples and a reference link. just do like that and it will fill that <code>user_id</code> and <code>role_id</code> itself. I can&#39;t give you actual code without seeing what you are trying to achieve."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1476865357, "post_id": 40125724, "comment_id": 67521860, "body": "This is not going to work because HABTM is not going to save a <code>Role.new</code> object and hence it won&#39;t save it in <code>@user.roles</code>, vice-versa. Probably <code>Role.find(1)</code> would be a better example."}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476865439, "post_id": 40125724, "comment_id": 67521913, "body": "you are right, I was a little distracted. I will edit"}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "edited": false, "score": 0, "creation_date": 1476865534, "post_id": 40125724, "comment_id": 67521983, "body": "Also, OP is creating a join table which is not according to the Rails convention, it is <code>CreateJoinTableUserRole</code> instead of <code>CreateJoinTableRolesUsers</code>. Hence, to address that answer should also explain to add a <code>join_table:</code> option in the association that OP is trying to create."}], "tags": [], "owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "is_accepted": false, "score": -1, "last_activity_date": 1476865516, "last_edit_date": 1476865516, "creation_date": 1476864828, "answer_id": 40125724, "question_id": 40125634, "link": "https://stackoverflow.com/questions/40125634/inserting-a-value-has-and-belongs-to-many-associated-table-on-rails/40125724#40125724", "title": "Inserting a value has_and_belongs_to_many associated table on Rails", "body": "<p>For this Third table, you dont need any controller  or model. It stores the record of <code>user</code> and <code>role</code>.\nwhen you create a <code>role</code> for user in <code>UserController</code> or anywhere else like:</p>\n\n<pre><code>@user.roles &lt;&lt; @role\n</code></pre>\n\n<p>Given you have two objects @user and @role of class User and Role respectively .</p>\n\n<p>It will create a new row in that table containing <code>@user</code>'s id and <code>Roles</code>'s id and same for the opposite case i.e when you create a <code>user</code> for a Role.</p>\n\n<pre><code>@role.users &lt;&lt; User.find(1)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>@roles.users &lt;&lt; @user\n</code></pre>\n\n<p>Rails guide on <a href=\"http://guides.rubyonrails.org/association_basics.html#has-and-belongs-to-many-association-reference\" rel=\"nofollow\">HABTM</a> association. </p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "edited": false, "score": 0, "creation_date": 1476866045, "post_id": 40125833, "comment_id": 67522291, "body": "In the Role table I have only two fields"}, {"owner": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "edited": false, "score": 0, "creation_date": 1476866103, "post_id": 40125833, "comment_id": 67522341, "body": "id and role_name. How do i create the @role object and asssign it. Sorry. I&#39;m new to rails.."}, {"owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "reply_to_user": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "edited": false, "score": 0, "creation_date": 1476866715, "post_id": 40125833, "comment_id": 67522784, "body": "<code>Role.create(role_name: &#39;admin&#39;)</code> then <code>Role.find(1)</code> where &quot;1&quot;(assuming that there were no entries before) is the id of the row in <code>roles</code> table."}], "tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": true, "score": 1, "last_activity_date": 1476865822, "last_edit_date": 1476865822, "creation_date": 1476865199, "answer_id": 40125833, "question_id": 40125634, "link": "https://stackoverflow.com/questions/40125634/inserting-a-value-has-and-belongs-to-many-associated-table-on-rails/40125833#40125833", "title": "Inserting a value has_and_belongs_to_many associated table on Rails", "body": "<p>To generate the migration:</p>\n\n<pre><code>rails g migration create_join_table :roles, :users\n</code></pre>\n\n<p>Then, you can simply save association like so:</p>\n\n<pre><code>@user.roles &lt;&lt; @role\n</code></pre>\n\n<p>Where <code>@user</code> is <code>User</code> object and <code>@role</code> is <code>Role</code> object.</p>\n\n<p>Note: Things that you should always keep in mind here is that join table names are arranged in alphabetical order, in this case <strong><em>roles</em></strong> should come before <strong><em>users</em></strong>, Hence: <code>roles_users</code> will be the table that should be created to make HABTM work as per Rails convention.</p>\n"}], "owner": {"reputation": 37, "user_id": 7030170, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23457d01b3e3efa586d2d65d4b6f6bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Nifras Ismail", "link": "https://stackoverflow.com/users/7030170/nifras-ismail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 40125833, "answer_count": 2, "score": 0, "last_activity_date": 1476865822, "creation_date": 1476864593, "question_id": 40125634, "link": "https://stackoverflow.com/questions/40125634/inserting-a-value-has-and-belongs-to-many-associated-table-on-rails", "title": "Inserting a value has_and_belongs_to_many associated table on Rails", "body": "<p>I have generate two table and its model and controllers using the scaffold  command on Rails </p>\n\n<p>The two tables are User and Role</p>\n\n<p>scaffold command create the two tables model and controllers. </p>\n\n<h2>app/models/user.rb</h2>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_and_belongs_to_many   :roles\nend\n</code></pre>\n\n<h2>app/models/role.rb</h2>\n\n<pre><code>class Role &lt; ApplicationRecord\n    has_and_belongs_to_many :users\nend\n</code></pre>\n\n<p>Then I used the following command to generate the many-to-many relationship third table. </p>\n\n<pre><code>rails generate migration CreateJoinTableUserRole User Role\n</code></pre>\n\n<p>For this third table rails does not generate models or controllers. How do i add the values to this table? Do i need to create model for this table separately or do it another way?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "loops"], "comments": [{"owner": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "edited": false, "score": 0, "creation_date": 1476863738, "post_id": 40125304, "comment_id": 67520800, "body": "And why do you think <code>Project.statuses</code> will work? What do you really want to do?"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "reply_to_user": {"reputation": 2889, "user_id": 3079520, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LfkPU.jpg?s=128&g=1", "display_name": "dnsh", "link": "https://stackoverflow.com/users/3079520/dnsh"}, "edited": false, "score": 0, "creation_date": 1476863966, "post_id": 40125304, "comment_id": 67520923, "body": "I have 3 different statuses. I would like my user to be able to choose between this fourth"}, {"owner": {"reputation": 9878, "user_id": 3315785, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YsMo6.jpg?s=128&g=1", "display_name": "j-dexx", "link": "https://stackoverflow.com/users/3315785/j-dexx"}, "edited": false, "score": 0, "creation_date": 1476864119, "post_id": 40125304, "comment_id": 67521020, "body": "Can you post the Project model statuses class method"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1476864385, "post_id": 40125304, "comment_id": 67521192, "body": "There is no method statuses in my model. Status is just the name of the field in my table. And  for each instance I&#39;d like to get only the status and display all of those in a select form"}], "answers": [{"comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1476864002, "post_id": 40125417, "comment_id": 67520950, "body": "@Orsay, try this."}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1476864261, "post_id": 40125417, "comment_id": 67521110, "body": "Actually I want to display all the statuses already save in my Project table. So for each instance get only the status and display all of those in a select form. As the user can choose an existing status"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1476864463, "post_id": 40125417, "comment_id": 67521238, "body": "use,<code>Project.select(:status).map(&amp;:status).uniq</code>, this shld work"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1476865243, "post_id": 40125417, "comment_id": 67521782, "body": "Cool it seems to work ! Do you know how can I add my I18n variable on your solution please ? because it do not display as I want and I don&#39;t know how to customize the displaying of your solution."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1476865733, "post_id": 40125417, "comment_id": 67522104, "body": "First of all, it would be more efficient to use <code>Project.pluck(:status).uniq</code>. Secondly, I don&#39;t know what OP expects <code>statuses.keys</code> to return, but it <i>looks like</i> they actually have a hash defined somewhere with a list of all statuses - seeing as they have some <code>I18n</code> translations set up for them... I&#39;m still a bit confused what is being expected here, but having the statuses defined in a constant somewhere is more logical than re-reading them from the DB!"}, {"owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "edited": false, "score": 0, "creation_date": 1476870616, "post_id": 40125417, "comment_id": 67525576, "body": "Thank you this is exactly what I expected :)"}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": true, "score": 0, "last_activity_date": 1476868706, "last_edit_date": 1476868706, "creation_date": 1476863893, "answer_id": 40125417, "question_id": 40125304, "link": "https://stackoverflow.com/questions/40125304/undefined-method-when-i-loop-to-display-a-f-select-in-form/40125417#40125417", "title": "Undefined method when I loop to display a f.select in form", "body": "<p>You cannot use an assosciation directly on a Class so <code>Project.statuses</code> is wrong.</p>\n\n<p><strong><code>use select on Class and then map them</code></strong></p>\n\n<p><strong><code>Project.select(:status).map(&amp;:status).uniq</code></strong></p>\n\n<pre><code>&lt;%= form_for [@context, @project], validate: true do |f| %&gt;\n       &lt;%= f.label \"status\" %&gt;\n       &lt;%= f.select(:status, Project.select(:status).map{ |status| [I18n.t(\"#{status}\"), status]}.uniq %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 1, "last_activity_date": 1476867740, "last_edit_date": 1495542805, "creation_date": 1476867740, "answer_id": 40126751, "question_id": 40125304, "link": "https://stackoverflow.com/questions/40125304/undefined-method-when-i-loop-to-display-a-f-select-in-form/40126751#40126751", "title": "Undefined method when I loop to display a f.select in form", "body": "<p>Use pluck to get all statuses</p>\n\n<pre><code>&lt;%= f.select(:status, Project.pluck(:status).uniq.map{ |status| [I18n.t(\"#{status}\"), status] %&gt;\n</code></pre>\n\n<p>As per <a href=\"https://stackoverflow.com/users/1954610/tom-lord\">Tom Lord</a>'s comment you can use constant for the statuses instead of reading the values from db each time you render the view.</p>\n\n<pre><code>PROJECT_STATUSES = ['open', 'closed', 'pending']\n\n# And use it in view\n&lt;%= f.select(:status, PROJECT_STATUSES.map{ |status| [I18n.t(\"#{status}\"), status] %&gt;\n</code></pre>\n"}], "owner": {"reputation": 814, "user_id": 5479076, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ebf84ecaf15f684b53f18b9313cd1325?s=128&d=identicon&r=PG&f=1", "display_name": "Orsay", "link": "https://stackoverflow.com/users/5479076/orsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 40125417, "answer_count": 2, "score": 0, "last_activity_date": 1476868706, "creation_date": 1476863557, "last_edit_date": 1476867603, "question_id": 40125304, "link": "https://stackoverflow.com/questions/40125304/undefined-method-when-i-loop-to-display-a-f-select-in-form", "title": "Undefined method when I loop to display a f.select in form", "body": "<p>I would like to have a list in my form with all my project statuses. </p>\n\n<p>The field status exist in the database. When I run something like <code>Project.first.status</code> it works fine but it doesn't when I loop into it.</p>\n\n<p>When I run the following code I get : </p>\n\n<blockquote>\n  <p>undefined method `statuses' for Class...</p>\n</blockquote>\n\n<p><strong>new_form</strong></p>\n\n<pre><code>&lt;%= form_for [@context, @project], validate: true do |f| %&gt;\n       &lt;%= f.label \"status\" %&gt;\n       &lt;%= f.select(:status, Project.statuses.keys.map{ |status| [I18n.t(\"#{status}\"), status] %&gt;\n</code></pre>\n\n<p><strong>SCHEMA</strong></p>\n\n<pre><code>create_table \"projects\", force: :cascade do |t|\n    t.string   \"title\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.integer  \"status\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "class", "instance"], "answers": [{"tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 1, "last_activity_date": 1476863774, "creation_date": 1476863774, "answer_id": 40125374, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute/40125374#40125374", "title": "Find object by attribute", "body": "<p>Let's add a getter method for the name attribute</p>\n\n<pre><code>class Table\n  attr_reader :name\n\n  def initialize(name)\n    @name = name\n    @columns = {}\n  end\nend\n</code></pre>\n\n<p>Now, if you have an array of Table objects</p>\n\n<pre><code>arr = [Table.new(\"First\"), Table.new(\"Second\"), Table.new(\"Third\")]\n</code></pre>\n\n<p>You can find by name</p>\n\n<pre><code>arr.find { |table| table.name == \"Second\" }\n =&gt; #&lt;Table:0x007f862107eb18 @name=\"Second\", @columns={}&gt; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1476864440, "post_id": 40125375, "comment_id": 67521223, "body": "Further question, how can I distinguish garbage from non-garbage objects?"}, {"owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1476864551, "post_id": 40125375, "comment_id": 67521297, "body": "And how can I select only non-garbage objects without forcing a gc?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "edited": false, "score": 0, "creation_date": 1476864919, "post_id": 40125375, "comment_id": 67521551, "body": "@Aetherus, I do not yet have discovered the full power of <code>ObjectSpace</code> and GC, so can&#39;t answer the question about distinquishing between garbage and non-garbage objects."}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476865211, "post_id": 40125375, "comment_id": 67521759, "body": "But,  <code>.instance_variable_get(:@name)</code> - for  what here? I think, <code>ObjectSpace.each_object(Table).find { |object| object.name == &quot;Second&quot; }</code> will work the same in this example, no?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476865253, "post_id": 40125375, "comment_id": 67521791, "body": "@AlexGolubenko no, there is no <code>attr_reader</code> for <code>@name</code> instance variable :)"}, {"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1476865625, "post_id": 40125375, "comment_id": 67522037, "body": "@AndreyDeineko oh, sure, sorry for this, I just a little not quite awake :) Thanks!"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 2, "last_activity_date": 1476863778, "creation_date": 1476863778, "answer_id": 40125375, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute/40125375#40125375", "title": "Find object by attribute", "body": "<p>Without creating any additional structures of data:</p>\n\n<pre><code>ObjectSpace.each_object(Table).find { |object| object.instance_variable_get(:@name) == \"Second\" }\n=&gt; #&lt;Table:0x007f9f912b0ce0 @columns={}, @name=\"Second\"&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 1, "last_activity_date": 1476863815, "creation_date": 1476863815, "answer_id": 40125394, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute/40125394#40125394", "title": "Find object by attribute", "body": "<p>You can use enumerable <a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-find\" rel=\"nofollow\"><code>find</code></a> or any similar method from the enumerable module:</p>\n\n<pre><code>class Table\n  attr_reader :name\n  def initialize(name)\n    @name = name\n    @columns = {}\n  end\nend\n\ntable_1 = Table.new(\"First\")\ntable_2 = Table.new(\"Second\")\ntable_3 = Table.new(\"Third\")\n\nx = [table_1, table_2, table_3].find { |t| t.name == \"Second\" }\n\nputs x.name =&gt; \"Second\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14827, "user_id": 645886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2abb0123e9484284a9cb2d36aa9854b3?s=128&d=identicon&r=PG&f=1", "display_name": "Surya", "link": "https://stackoverflow.com/users/645886/surya"}, "is_accepted": false, "score": 1, "last_activity_date": 1476864567, "creation_date": 1476864567, "answer_id": 40125622, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute/40125622#40125622", "title": "Find object by attribute", "body": "<p>Let's say we have reader on <code>name</code> in <code>Table</code>:</p>\n\n<pre><code>class Table\n  attr_reader :name\n\n  def initialize(name)\n    @name = name\n    @columns = {}\n  end\nend\n</code></pre>\n\n<p>I'd encourage you to store these <code>Table</code> classes' objects in a list/array:</p>\n\n<pre><code>table_1 = Table.new(\"First\")\ntable_2 = Table.new(\"Second\")\ntable_3 = Table.new(\"Third\")\n\ntables = [table_1, table_2, table_3]\n</code></pre>\n\n<p>Which can then be used for finding it using <code>find</code>(as mentioned in one of the answers) or <a href=\"https://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-detect\" rel=\"nofollow\"><code>detect</code></a>:</p>\n\n<pre><code>tables.detect { |t| t.name == \"Second\" } #=&gt; table_2 object\n</code></pre>\n\n<p>If you'd like to go one more step ahead then we can have another class maintaining this array:</p>\n\n<pre><code>class TableList\n  attr_reader :tables\n  def initialize\n    @tables = tables\n  end\n\n  def add(table)\n    @tables &lt;&lt; table\n  end\n\n  def find_by_name(name)\n    tables.detect{ |table| table.name == name }\n  end\nend\n</code></pre>\n\n<p>Which can then be used as:</p>\n\n<pre><code>table_1 = Table.new(\"First\")\ntable_2 = Table.new(\"Second\")\ntable_3 = Table.new(\"Third\")\ntable_list = TableList.new\ntable_list.add(table_1)\ntable_list.add(table_2)\ntable_list.add(table_3)\n\ntable_list.find_by_name('Second') #=&gt; table_2 object\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "edited": false, "score": 0, "creation_date": 1476874369, "post_id": 40126284, "comment_id": 67528345, "body": "@Andrey&#39;s solution is the shortest but this one allowed me to keep objects"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "edited": false, "score": 0, "creation_date": 1476874487, "post_id": 40126284, "comment_id": 67528443, "body": "Nice solution! @GrahamSlick just a short note: you never said in your question that you wanted to keep objects ;) But good you&#39;ve found a suitable solution!"}, {"owner": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "reply_to_user": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1476874728, "post_id": 40126284, "comment_id": 67528652, "body": "@AndreyDeineko I know bc I only realized it was removing objects once I implemented yours :D Sorry about that, but thanks a lot for your help too"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "edited": false, "score": 0, "creation_date": 1476874775, "post_id": 40126284, "comment_id": 67528688, "body": "@GrahamSlick :D as I say, no probs, glad to help :)"}], "tags": [], "owner": {"reputation": 7994, "user_id": 1625339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b8ba46f911517c8b2ccc39e0be9050c0?s=128&d=identicon&r=PG", "display_name": "Aetherus", "link": "https://stackoverflow.com/users/1625339/aetherus"}, "is_accepted": true, "score": 1, "last_activity_date": 1476866483, "creation_date": 1476866483, "answer_id": 40126284, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute/40126284#40126284", "title": "Find object by attribute", "body": "<p>You can keep a reference to an array of instances in the class.</p>\n\n<pre><code>class Table\n  @instances = []\n  class &lt;&lt; self\n    attr_accessor :instances\n  end\n\n  def initialize(name)\n    @name = name\n    @columns = {}\n    self.class.instances &lt;&lt; self\n  end\nend\n</code></pre>\n\n<p>Then you can get all the instances by</p>\n\n<pre><code>Table.instances\n</code></pre>\n\n<p>This, however, will prevent all the <code>Table</code> objects being garbage collected, so it is only feasible if you have only a small amount of <code>Table</code>s and that amount never grows, otherwise you'll have a memory leak.</p>\n"}], "owner": {"reputation": 5704, "user_id": 1236336, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9b3d57108481b0576bad482a82e698e6?s=128&d=identicon&r=PG", "display_name": "Graham Slick", "link": "https://stackoverflow.com/users/1236336/graham-slick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 40126284, "answer_count": 5, "score": 1, "last_activity_date": 1476866483, "creation_date": 1476863534, "last_edit_date": 1476863942, "question_id": 40125297, "link": "https://stackoverflow.com/questions/40125297/find-object-by-attribute", "title": "Find object by attribute", "body": "<p>I have a ruby class like this: </p>\n\n<pre><code>class Table\n  def initialize(name)\n    @name = name\n    @columns = {}\n  end\nend\n</code></pre>\n\n<p>I'm creating different objects:</p>\n\n<pre><code>table_1 = Table.new(\"First\")\ntable_2 = Table.new(\"Second\")\ntable_3 = Table.new(\"Third\")\n</code></pre>\n\n<p>How can I find among the objects of the <code>Table</code> class the object having \"Second\" as <code>name</code> attribute ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "orm", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476863186, "post_id": 40124994, "comment_id": 67520457, "body": "Can you please remove the extra associations written in User and Hotel models. please remove the following, &#39;has_many :hotels, through: :reservations&#39; from User and &#39;belongs_to :users, through: :reservations&#39; from Hotel. and then run the queries in console"}, {"owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "reply_to_user": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476863369, "post_id": 40124994, "comment_id": 67520572, "body": "Just did it and still got the &quot; Reservation Load (0.4ms)  SELECT <code>reservations</code>.* FROM <code>reservations</code> WHERE <code>reservations</code>.<code>reservable_id</code> = 1 AND <code>reservations</code>.<code>reservable_type</code> = &#39;User&#39;  =&gt; #&lt;ActiveRecord::Associations::CollectionProxy []&gt;  &quot; problem."}, {"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476863546, "post_id": 40124994, "comment_id": 67520682, "body": "can you please remoe this too from reservations model, belongs_to :users       belongs_to :hotels"}, {"owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "reply_to_user": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476863716, "post_id": 40124994, "comment_id": 67520790, "body": "Still get the same result. I think the pb is I&#39;m using the relationship in &quot;wrong way&quot;, since it&#39;s looking for &#39;User&#39; type in reservations table whereas I want it to load Hotels reservations."}, {"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476863730, "post_id": 40124994, "comment_id": 67520796, "body": "Can you please add the migration files too? of the above models?"}, {"owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "edited": false, "score": 0, "creation_date": 1476864421, "post_id": 40124994, "comment_id": 67521212, "body": "please refactor your code as below. I checked the same code in my local system. And found that the extra associations brings the error."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "edited": false, "score": 0, "creation_date": 1476864725, "post_id": 40125560, "comment_id": 67521419, "body": "Ok I got the first mistake I make : User is not reservable. User has_many reservations through user_id relations, not &quot;reservable_id&quot;.  I have to figure out the user -&gt; hotels relation to make it fully work."}, {"owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "edited": false, "score": 0, "creation_date": 1476865620, "post_id": 40125560, "comment_id": 67522031, "body": "It keeps seeking &quot;2.2.3 :001 &gt; u = User.find(1)   User Load (0.5ms)  SELECT  <code>users</code>.* FROM <code>users</code> WHERE <code>users</code>.<code>id</code> = 1 LIMIT 1  =&gt; #&lt;User id: 1, first_name: &quot;Thomas&quot;, last_name: &quot;Dupont&quot;, email: &quot;thomas.dupont@yopmail.com&quot;, created_at: &quot;2016-10-18 21:12:12&quot;, updated_at: &quot;2016-10-18 21:12:12&quot;&gt;  2.2.3 :002 &gt; u.reservations   Reservation Load (0.4ms)  SELECT <code>reservations</code>.* FROM <code>reservations</code> WHERE <code>reservations</code>.<code>reservable_id</code> = 1 AND <code>reservations</code>.<code>reservable_type</code> = &#39;User&#39;  =&gt; #&lt;ActiveRecord::Associations::CollectionProxy []&gt; &quot;. This is not the behavior I&#39;m looking for."}], "tags": [], "owner": {"reputation": 671, "user_id": 5742949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3912a535b54d364d6922df433db50512?s=128&d=identicon&r=PG&f=1", "display_name": "Shabini Rajadas", "link": "https://stackoverflow.com/users/5742949/shabini-rajadas"}, "is_accepted": false, "score": 0, "last_activity_date": 1476864338, "creation_date": 1476864338, "answer_id": 40125560, "question_id": 40124994, "link": "https://stackoverflow.com/questions/40124994/rails-polymorphic-relations/40125560#40125560", "title": "Rails polymorphic relations", "body": "<p>I guess on viewing your code, you have written extra associations on top of the polymorphic association,</p>\n\n<p>To create a polymorphic association, just the following code is enough. No need to pass extra association inside the model. Please refactor your code as follows,\nUser model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n     has_many :reservations, as: :reservable\nend\n</code></pre>\n\n<p>Hotel model :</p>\n\n<pre><code>class Hotel &lt; ApplicationRecord\n      has_many :reservations, as: :reservable\nend\n</code></pre>\n\n<p>Reservation model :</p>\n\n<pre><code>class Reservation &lt; ApplicationRecord\n      belongs_to :reservable, polymorphic: true\nend\n</code></pre>\n\n<p>And in the migration file for reservations, add the reservable as below </p>\n\n<pre><code>t.references :reservable, polymorphic: true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476867567, "creation_date": 1476867567, "answer_id": 40126679, "question_id": 40124994, "link": "https://stackoverflow.com/questions/40124994/rails-polymorphic-relations/40126679#40126679", "title": "Rails polymorphic relations", "body": "<p>Ok i sorted this out :</p>\n\n<p>This is the reservation model :</p>\n\n<pre><code>class Reservation &lt; ApplicationRecord\n      belongs_to :reservable, polymorphic: true\nend\n</code></pre>\n\n<p>This is the hotel model :</p>\n\n<pre><code>class Hotel &lt; ApplicationRecord\nend\n</code></pre>\n\n<p>And the user model :</p>\n\n<pre><code>class User &lt; ApplicationRecord\n     has_many :reservations\nend\n</code></pre>\n\n<p>And how I got a results in rails console :</p>\n\n<pre><code>Running via Spring preloader in process 87452\nLoading development environment (Rails 5.0.0.1)\n2.2.3 :001 &gt; u = User.find(1)\n  User Load (0.3ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n =&gt; #&lt;User id: 1, first_name: \"Thomas\", last_name: \"Dupont\", email: \"thomas.dupont@yopmail.com\", created_at: \"2016-10-18 21:12:12\", updated_at: \"2016-10-18 21:12:12\"&gt; \n2.2.3 :002 &gt; u.reservations\n  Reservation Load (0.3ms)  SELECT `reservations`.* FROM `reservations` WHERE `reservations`.`user_id` = 1\n =&gt; #&lt;ActiveRecord::Associations::CollectionProxy [#&lt;Reservation id: 1, reservable_id: 1, reservable_type: \"Hotel\", user_id: 1, date_from: \"2017-01-12 00:00:00\", date_to: \"2017-01-15 00:00:00\", created_at: \"2016-10-19 09:18:01\", updated_at: \"2016-10-19 09:18:01\"&gt;]&gt; \n2.2.3 :003 &gt; u.reservations.first.reservable\n  Hotel Load (0.3ms)  SELECT  `hotels`.* FROM `hotels` WHERE `hotels`.`id` = 1 LIMIT 1\n =&gt; #&lt;Hotel id: 1, name: \"HYATT REGENCY HOTEL\", address: \"3 Place du G\u00e9n\u00e9ral K\u0153nig\", postal_code: \"75017\", town: \"PARIS\", created_at: \"2016-10-19 08:36:55\", updated_at: \"2016-10-19 08:36:55\"&gt; \n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 706257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4524da6eab9a270cd96dc58acd56f87c?s=128&d=identicon&r=PG", "display_name": "galettan", "link": "https://stackoverflow.com/users/706257/galettan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476867567, "creation_date": 1476862602, "last_edit_date": 1476865851, "question_id": 40124994, "link": "https://stackoverflow.com/questions/40124994/rails-polymorphic-relations", "title": "Rails polymorphic relations", "body": "<p>I'm trying to use polymorphic relationship with rails 5.</p>\n\n<p>I have difficulties to figure out how to finish my relations.</p>\n\n<p>I have users, who can take reservations for hotels, restaurants, etc.</p>\n\n<p>My purpose is to get hotels name and reservations when calling /users/{id} through API.</p>\n\n<p>Here is my User model :</p>\n\n<pre><code>class User &lt; ApplicationRecord\n     has_many :reservations, as: :reservable\n     has_many :hotels, through: :reservations\nend\n</code></pre>\n\n<p>My Hotel model :</p>\n\n<pre><code>class Hotel &lt; ApplicationRecord\n      has_many :reservations, as: :reservable\n      belongs_to :users, through: :reservations\nend\n</code></pre>\n\n<p>My Reservation model :</p>\n\n<pre><code>class Reservation &lt; ApplicationRecord\n      belongs_to :reservable, polymorphic: true\n      belongs_to :users\n      belongs_to :hotels\nend\n</code></pre>\n\n<p>Migrations :</p>\n\n<p>User :</p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :users do |t|\n      t.string :first_name\n      t.string :last_name\n      t.string :email\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Reservations :</p>\n\n<pre><code>class CreateReservations &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :reservations do |t|\n      t.belongs_to :hotel, index: true\n      t.belongs_to :user, index: true\n      t.datetime :date_from\n      t.datetime :date_to\n\n      t.timestamps\n    end\n  end\nend\nclass ReservationPolymorphism &lt; ActiveRecord::Migration[5.0]\n  def change\n      rename_column :reservations, :hotel_id, :reservable_id\n      change_column :reservations, :reservable_id, polymorphic: true\n      add_column :reservations, :reservable_type, :string\n  end\nend\n</code></pre>\n\n<p>Hotel :</p>\n\n<pre><code>class CreateHotels &lt; ActiveRecord::Migration[5.0]\n  def change\n    create_table :hotels do |t|\n      t.string :name\n      t.string :address\n      t.string :postal_code\n      t.string :town\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>I just have 1 line in my reservations table :</p>\n\n<pre><code>mysql&gt; select * from reservations;\n+----+---------------+-----------------+---------+---------------------+---------------------+---------------------+---------------------+\n| id | reservable_id | reservable_type | user_id | date_from           | date_to             | created_at          | updated_at          |\n+----+---------------+-----------------+---------+---------------------+---------------------+---------------------+---------------------+\n|  1 |             1 | Hotel           |       1 | 2017-01-12 00:00:00 | 2017-01-15 00:00:00 | 2016-10-19 09:18:01 | 2016-10-19 09:18:01 |\n+----+---------------+-----------------+---------+---------------------+---------------------+---------------------+---------------------+\n</code></pre>\n\n<p>I have no result when using the API.</p>\n\n<p>Here is what I get, using Rails console :</p>\n\n<pre><code>2.2.3 :001 &gt; thomas = User.find(1)\n  User Load (0.2ms)  SELECT  `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1\n =&gt; #&lt;User id: 1, first_name: \"Thomas\", last_name: \"Dupont\", email: \"thomas.dupont@yopmail.com\", created_at: \"2016-10-18 21:12:12\", updated_at: \"2016-10-18 21:12:12\"&gt; \n2.2.3 :003 &gt;   thomas.reservations\n  Reservation Load (0.3ms)  SELECT `reservations`.* FROM `reservations` WHERE `reservations`.`reservable_id` = 1 AND `reservations`.`reservable_type` = 'User'\n2.2.3 :005 &gt; thomas.hotels\nNameError: uninitialized constant User::Hotels\n</code></pre>\n\n<p>So I can see I make basic mistake with rails relations and polymorphism but I really can't find out where I'm wrong.</p>\n\n<p>I think I made a mistake.\nI assumed Polymorphism could be use to load other models and their tables (like \"morphTo\" with eloquent / laravel), whereas it's just to load a model which has no data representation (as described in this post : <a href=\"https://robots.thoughtbot.com/using-polymorphism-to-make-a-better-activity-feed-in-rails\" rel=\"nofollow\">https://robots.thoughtbot.com/using-polymorphism-to-make-a-better-activity-feed-in-rails</a> )</p>\n"}, {"tags": ["arrays", "ruby", "linux", "chef-infra", "chef-recipe"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3580316"}, "edited": false, "score": 0, "creation_date": 1476863988, "post_id": 40125258, "comment_id": 67520937, "body": "Thanks for your answar, that worked. How can I set user group with that command on subfolers? <code>recursive true</code> doesn&#39;t set user group on subfolders below <code>&#47;var&#47;lib&#47;temp</code> and <code>&#47;opt&#47;chef&#47;library</code>. Equiqvalent command to <code>chown -R user:group &#47;var&#47;lib&#47;temp&#47;*</code> in Linux."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1476864453, "post_id": 40125258, "comment_id": 67521229, "body": "That&#39;s a whole other question, so best to split that out as a separate thing."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1476903011, "last_edit_date": 1476903011, "creation_date": 1476863396, "answer_id": 40125258, "question_id": 40124825, "link": "https://stackoverflow.com/questions/40124825/chef-using-variables-in-a-array/40125258#40125258", "title": "Chef using variables in a array", "body": "<p>The <code>%w{ ... }</code> syntax is for declaring an array of words, and no interpolation is done. Since you want an array of pre-existing strings, you can do it this way by declaring a plain-old array:</p>\n\n<pre><code>[ variable1, variable2 ].each do |dir|\n  # ...\nend\n</code></pre>\n\n<p>Or you can switch to this:</p>\n\n<pre><code>%w[ /var/lib/temp /opt/chef/library ].each |dir|\n  # ...\nend\n</code></pre>\n\n<p>The second form makes a lot more sense since that's your intent. No need for intermediate variables.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3580316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2259, "favorite_count": 0, "accepted_answer_id": 40125258, "answer_count": 1, "score": 2, "last_activity_date": 1476903011, "creation_date": 1476861993, "question_id": 40124825, "link": "https://stackoverflow.com/questions/40124825/chef-using-variables-in-a-array", "title": "Chef using variables in a array", "body": "<p>How can you use variables in an array in Chef. I am trying to create multiple folder with an array. However my code does not work:</p>\n\n<p>Code</p>\n\n<pre><code>variable1 = \"/var/lib/temp\"\nvariable2 = \"/opt/chef/library\"\n\n%w{ #{variable1} #{variable2} }.each do |dir| \n    directory dir do\n       owner 'root'\n       group 'root'\n       mode  '755'\n       recursive true\n       action :create\n    end\nend \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1476862476, "post_id": 40124719, "comment_id": 67519978, "body": "can you post some pseudo code about how you want your data ?"}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1476868359, "post_id": 40125038, "comment_id": 67523841, "body": "hai @sravan i find a another answer"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1476868483, "post_id": 40125038, "comment_id": 67523941, "body": "mine worked? if worked, atleast upvote it, so that I can think this is not  wrong. :)"}, {"owner": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1476868544, "post_id": 40125038, "comment_id": 67523997, "body": "wait i will explain"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1476869044, "post_id": 40125038, "comment_id": 67524336, "body": "check the answer now."}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "edited": false, "score": 0, "creation_date": 1476870617, "post_id": 40125038, "comment_id": 67525577, "body": "try using render text: <code>@instance</code> and return false, and check what is in <code>@instance</code>."}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": true, "score": 0, "last_activity_date": 1476869017, "last_edit_date": 1476869017, "creation_date": 1476862727, "answer_id": 40125038, "question_id": 40124719, "link": "https://stackoverflow.com/questions/40124719/rails-multiple-table-id-find/40125038#40125038", "title": "rails multiple table id find", "body": "<p>Just take an instance <code>hash</code> and push each data as a key.</p>\n\n<pre><code>def index\n    @instance = {}\n    @instance['wall_notifications_picture'] = current_user.wall_notifications.where(attachable_type: 'Picture')\n    @instance['picture_ids'] = @instance['wall_notifications_picture'].map {|w| Picture.find_by_id(w.attachable_id)}\n    @instance['wall_notifications_uservideo'] = current_user.wall_notifications.where(attachable_type: 'UserVideo')\n    @instance['uservideo_ids'] = @instance['wall_notifications_uservideo'].map {|w| UserVideo.find_by_id(w.attachable_id)}\n    @instance['wall_notifications_career'] = current_user.wall_notifications.where(attachable_type: 'Career')\n    @instance['career_ids'] = @instance['uservideo_ids'].map {|w| Career.find_by_id(w.attachable_id)}\n\nend\n</code></pre>\n\n<p>Now send only <code>@instance</code> into the view.</p>\n\n<p>in the view,</p>\n\n<p><code>&lt;%= @instance %&gt;</code></p>\n\n<p>You can use each key in it to display in respective places.</p>\n"}, {"tags": [], "owner": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476873333, "creation_date": 1476873333, "answer_id": 40128943, "question_id": 40124719, "link": "https://stackoverflow.com/questions/40124719/rails-multiple-table-id-find/40128943#40128943", "title": "rails multiple table id find", "body": "<p>Thanks all..now i find simple step</p>\n\n<p>in my controller.rb</p>\n\n<pre><code>def index\n    @wall_notifications = current_user.wall_notifications.order(\"id DESC\")\nend\n</code></pre>\n\n<p>and my view.html.erb</p>\n\n<pre><code>&lt;% if current_user.wall_notifications.present? %&gt;\n  &lt;!-- wall notification picture--&gt;\n  &lt;% @wall_notifications.each do |wall_notification|%&gt;\n  &lt;div class=\"row margin-top\"&gt;\n    &lt;div class=\"col-md-12\"&gt;\n      &lt;div class=\"right-article\"&gt;    \n        &lt;div class=\"item-side-article\"&gt;\n          &lt;% if wall_notification.attachable_type == 'Picture'%&gt;\n            &lt;% if wall_notification.attachable.pic_upload.file.extension.downcase == 'mp4'%&gt;\n               &lt;video style=\"float:left;height:102px;margin-right:10px;width:180px;\" controls&gt;\n                  &lt;source src=\"&lt;%= wall_notification.attachable.pic_upload.url%&gt;\" type=\"video/mp4\"&gt;\n                Your browser does not support the video tag.\n                &lt;/video&gt;\n            &lt;% else %&gt;\n              &lt;img src=\"&lt;%= wall_notification.attachable.pic_upload.url%&gt;\"&gt;\n            &lt;% end %&gt;\n          &lt;% end %&gt;\n          &lt;% if wall_notification.attachable_type == 'UserVideo'%&gt;\n            &lt;% if wall_notification.attachable.user_video.present? %&gt;\n              &lt;video style=\"float:left;height:102px;margin-right:10px;width:180px;\" controls&gt;\n                &lt;source src=\"&lt;%= wall_notification.attachable.user_video.url%&gt;\" type=\"video/mp4\"&gt;\n                Your browser does not support the video tag.\n              &lt;/video&gt;\n            &lt;% end %&gt;\n          &lt;% end %&gt;\n          &lt;% if wall_notification.attachable_type == 'Career'%&gt;\n            &lt;% if wall_notification.attachable.career_file.present?%&gt;\n              &lt;img src=\"&lt;%= wall_notification.attachable.career_file.url%&gt;\"&gt;\n            &lt;% end %&gt;\n          &lt;% end %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;%end%&gt;\n  &lt;!-- wall notification picture end --&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1339, "user_id": 6295641, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tXMWi.jpg?s=128&g=1", "display_name": "Karthick Nagarajan", "link": "https://stackoverflow.com/users/6295641/karthick-nagarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 40125038, "answer_count": 2, "score": 0, "last_activity_date": 1484806940, "creation_date": 1476861630, "last_edit_date": 1484806940, "question_id": 40124719, "link": "https://stackoverflow.com/questions/40124719/rails-multiple-table-id-find", "title": "rails multiple table id find", "body": "<p>and use rails polymorphic association..</p>\n\n<p>This is wall_notification.rb</p>\n\n<pre><code>class WallNotification &lt; ActiveRecord::Base\n    belongs_to :attachable, polymorphic: true\n    belongs_to :user\nend\n</code></pre>\n\n<p>This is picture.rb</p>\n\n<pre><code>class Picture &lt; ActiveRecord::Base\n    belongs_to :user\n    has_many :wall_notifications, as: :attachable\n    mount_uploader :pic_upload\n    validates :pic_upload,presence: true\nend\n</code></pre>\n\n<p>This is user_video.rb</p>\n\n<pre><code>class UserVideo &lt; ActiveRecord::Base\n    belongs_to :user\n    has_many :wall_notifications, as: :attachable\n    mount_uploader :user_video\nend\n</code></pre>\n\n<p>This is career.rb</p>\n\n<pre><code>class Career &lt; ActiveRecord::Base\n    has_many :wall_notifications, as: :attachable\n    mount_uploader :career_file\nend\n</code></pre>\n\n<p>and,when create new picture,user_video,career, wall_notifiacatin will create new record automatically because,we use polymorphic association..</p>\n\n<p>when i check my rails console..polymorphic association perfectly working..</p>\n\n<pre><code>[1] pry(main)&gt; WallNotification.all\n  WallNotification Load (220.3ms)  SELECT `wall_notifications`.* FROM `wall_notifications`\n=&gt; [#&lt;WallNotification:0xb4b51d0\n  id: 1,\n  user_id: 1,\n  attachable_id: 1,\n  attachable_type: \"Picture\",\n  created_at: Wed, 19 Oct 2016 04:50:55 UTC +00:00,\n  updated_at: Wed, 19 Oct 2016 04:50:55 UTC +00:00&gt;,\n #&lt;WallNotification:0xb4a98e4\n  id: 2,\n  user_id: 1,\n  attachable_id: 1,\n  attachable_type: \"UserVideo\",\n  created_at: Wed, 19 Oct 2016 04:53:43 UTC +00:00,\n  updated_at: Wed, 19 Oct 2016 04:53:43 UTC +00:00&gt;,\n #&lt;WallNotification:0xb4a9740\n  id: 3,\n  user_id: 1,\n  attachable_id: 1,\n  attachable_type: \"Career\",\n  created_at: Wed, 19 Oct 2016 05:12:43 UTC +00:00,\n  updated_at: Wed, 19 Oct 2016 05:12:43 UTC +00:00&gt;]\n</code></pre>\n\n<p>but now i want to current_user's wall_notifications list..and this is my controller.rb</p>\n\n<pre><code>def index\n    @wall_notifications_picture = current_user.wall_notifications.where(attachable_type: 'Picture')\n    @picture_ids = @wall_notifications_picture.map {|w| Picture.find_by_id(w.attachable_id)}\n    @wall_notifications_uservideo = current_user.wall_notifications.where(attachable_type: 'UserVideo')\n    @uservideo_ids = @wall_notifications_uservideo.map {|w| UserVideo.find_by_id(w.attachable_id)}\n    @wall_notifications_career = current_user.wall_notifications.where(attachable_type: 'Career')\n    @career_ids = @wall_notifications_uservideo.map {|w| Career.find_by_id(w.attachable_id)}\n end\n</code></pre>\n\n<p>i want each table data in one instance variable :( :(\nAny one help me..</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "charts", "chartkick"], "answers": [{"tags": [], "owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "is_accepted": false, "score": 0, "last_activity_date": 1476878035, "last_edit_date": 1495541626, "creation_date": 1476878035, "answer_id": 40130718, "question_id": 40124555, "link": "https://stackoverflow.com/questions/40124555/percentage-and-value-combination-for-chartkick-y-axis/40130718#40130718", "title": "Percentage and value combination for Chartkick Y axis", "body": "<p>with <a href=\"https://developers.google.com/chart/\" rel=\"nofollow noreferrer\">google charts</a>, you can easily customize both the axis labels and the tooltips  </p>\n\n<p>the column values for each row can be intrinsic values such as strings or numbers  </p>\n\n<p>alternatively, you can use object notation to provide the values  </p>\n\n<p>each cell in the data table can be represented as an object with the following keys  </p>\n\n<p><code>v</code> - value<br>\n<code>f</code> - formatted value  </p>\n\n<p>which means we can provide the value we want for the y-axis,<br>\nand a formatted value which displays on the tooltip  </p>\n\n<pre><code>{\n  v: 0.62,\n  f: '62'\n}\n</code></pre>\n\n<p>although, primarily focused on tooltips, <a href=\"https://stackoverflow.com/a/36730895/5090771\">here is a simple example</a> to demonstrate  </p>\n\n<p>if for some reason that alone does not meet your needs  </p>\n\n<p>both the axis labels and tooltips can be further customized as needed  </p>\n\n<p><em>axis labels</em><br>\nfound in the <a href=\"https://developers.google.com/chart/interactive/docs/gallery/linechart#configuration-options\" rel=\"nofollow noreferrer\">configuration options</a> for a line chart,<br>\ncustom axis labels can be provided using <code>ticks</code><br>\nfor the y-axis, the specific option would be <code>vAxis.ticks</code><br>\nwhich takes an array of values --> <code>[0.10, 0.20, 0.30]</code><br>\nor objects, again with the above keys  </p>\n\n<pre><code>[\n  {v: 0.10, f: '10%'},\n  {v: 0.20, f: '20%'},\n  {v: 0.30, f: '30%'}\n]\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/39862037/5090771\">here is a working example</a> of using <code>ticks</code>  </p>\n\n<p><em>tooltips</em><br>\n<a href=\"https://developers.google.com/chart/interactive/docs/customizing_tooltip_content#customizing-html-content\" rel=\"nofollow noreferrer\">customizing tooltips</a> is fairly straight forward  </p>\n\n<p>as mentioned, the default tooltip will display the formatted value (<code>f:</code>)  </p>\n\n<p>or you can provide an html string with the content you need displayed  </p>\n\n<p>each series may have its own custom tooltip,<br>\nadd a <a href=\"https://developers.google.com/chart/interactive/docs/roles#what-roles-are-available\" rel=\"nofollow noreferrer\"><code>'tooltip'</code> column role</a> after each series column  </p>\n\n<p><a href=\"https://stackoverflow.com/a/39469316/5090771\">here is a working example</a> for providing custom html tooltips...</p>\n"}], "owner": {"reputation": 169, "user_id": 1713782, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9655d06394b3b2a146d8c362c0dc1198?s=128&d=identicon&r=PG", "display_name": "Kamil \u0141\u0119czycki", "link": "https://stackoverflow.com/users/1713782/kamil-%c5%81%c4%99czycki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476878035, "creation_date": 1476861122, "question_id": 40124555, "link": "https://stackoverflow.com/questions/40124555/percentage-and-value-combination-for-chartkick-y-axis", "title": "Percentage and value combination for Chartkick Y axis", "body": "<p>I'm using <a href=\"https://github.com/ankane/chartkick\" rel=\"nofollow\">https://github.com/ankane/chartkick</a> in my Rails application and I would like to draw a line chart (multiple series to be specyfic) which will show on Y axis the percentage value but in the tooltip the actual numeric value. Is this somehow achievable (can be in any JS chart adapter: Chart.js, Google Charts or Highcharts)?</p>\n"}, {"tags": ["ruby", "rspec", "windows-7"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476862779, "post_id": 40124463, "comment_id": 67520185, "body": "This question has nothing to do with programming. It is a basic Windows user 101 &quot;How do I install software&quot; question. On Windows, the program to use to process a file is determined by the file name (or file extension). <code>rspec</code> doesn&#39;t have a file extension, and presumably you didn&#39;t register the file name. You have to register the file name <code>rspec</code> to be processed by <code>ruby.exe</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476863442, "post_id": 40124463, "comment_id": 67520614, "body": "The dialog you are getting is <i>exactly</i> the dialog you get when you tell Windows to open a file, and Windows doesn&#39;t know what to do with the file because the file extension or file name isn&#39;t registered as a file type and/or the file type isn&#39;t associated with a program to process that file type. So, either the file name <code>rspec</code> isn&#39;t registered as a Ruby file, or Ruby files aren&#39;t associated with <code>ruby.exe</code>. Did you try associating <code>rspec</code> with <code>ruby.exe</code>? What happened?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476864147, "post_id": 40124463, "comment_id": 67521039, "body": "The documentation you are reading is obviously for Unix, not Windows. The fact that it uses <code>&#47;</code> as a path component separator instead of `` is a dead giveaway. In Unix, the program to use to process a file is indicated within the file itself, and independent of the file extension or file name, therefore, there is never a need for such association."}, {"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476944840, "post_id": 40124463, "comment_id": 67563227, "body": "@J&#246;rgWMittag apologies if this is off-topic, but the solution was simply to explicitly call the commands with ruby. <code>ruby bin&#47;rspec --format doc</code> successfully runs the test. Thanks for your help."}], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "edited": false, "score": 0, "creation_date": 1476947173, "post_id": 40146941, "comment_id": 67564527, "body": "I suppose I could browse to ruby.exe from the &quot;Choose the program you want&quot; dialogue box and select ruby.exe as the default to always open &quot;rspec&quot; but I am not certain if this would set ruby.exe to open any file without an extension, or just ones named &quot;rspec&quot;... something for a later day"}], "tags": [], "owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "is_accepted": true, "score": 0, "last_activity_date": 1476944847, "creation_date": 1476944847, "answer_id": 40146941, "question_id": 40124463, "link": "https://stackoverflow.com/questions/40124463/rspec-basics-bin-rspec-format-doc/40146941#40146941", "title": "RSpec basics: bin/rspec --format doc", "body": "<p>Ah, I figured out what I need to do... I just need to explicitly call ruby:</p>\n\n<pre><code>ruby bin/rspec --format doc\n</code></pre>\n\n<p>...and the test gets run - YaY!</p>\n\n<p>Per @J\u00f6rgWMittag, I confirmed my Environment Variable Path to make sure ruby.exe was in there (C:\\Ruby22\\bin;).  </p>\n\n<p>Then looking at my Program Defaults, I thought that maybe I could tell win7 to associate any file named \"rspec\" with ruby.exe per <a href=\"https://support.microsoft.com/en-us/help/18539/windows-7-change-default-programs\" rel=\"nofollow\">https://support.microsoft.com/en-us/help/18539/windows-7-change-default-programs</a> ...but I couldn't actually add file type \"extensions\" or \"protocols\" - I could only change the association of existing ones, but .rb and .rbw were in there... Maybe there is a way to do this manually, but I am not a windows expert.  </p>\n\n<p>Thinking on all this it occurred to me that I just needed to explicitly tell ruby to ingest the command... Heh.  </p>\n\n<p>I apologize if this is off-topic.</p>\n"}], "owner": {"reputation": 2415, "user_id": 5225057, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh4.googleusercontent.com/-BQOs6bXTlFc/AAAAAAAAAAI/AAAAAAAAAT8/-aYe7hZBGyI/photo.jpg?sz=128", "display_name": "Mr. Kennedy", "link": "https://stackoverflow.com/users/5225057/mr-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 40146941, "answer_count": 1, "score": -1, "last_activity_date": 1476944847, "creation_date": 1476860796, "last_edit_date": 1476861982, "question_id": 40124463, "link": "https://stackoverflow.com/questions/40124463/rspec-basics-bin-rspec-format-doc", "title": "RSpec basics: bin/rspec --format doc", "body": "<p>I've installed RSpec on a win7 lappy and am following along the <a href=\"http://rspec.info/\" rel=\"nofollow\">http://rspec.info/</a> homepage tutorial to make sure everything works. If I am reading their demo correctly <code>bin/rspec --format doc</code> should run the specification test file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/quwjI.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/quwjI.png\" alt=\"enter image description here\"></a></p>\n\n<p>Instead, I get a system prompt for a text editor... ? I am confused.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0uhiM.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/0uhiM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any explanation of what is going on or guidance about how to get my RSPEC configuration working in accordance to the makers homepage would be great.</p>\n\n<p>FWIW Ruby 2.2.5p319, Bundler version 1.13.1 and gem -v tells me 2.6.7 (originally I had 2.4 but that is broken on windows, so I upgraded according to <a href=\"http://guides.rubygems.org/ssl-certificate-update/\" rel=\"nofollow\">http://guides.rubygems.org/ssl-certificate-update/</a>) Also, I have basic RSpec functionality and have completed the tutorial here: <a href=\"https://www.tutorialspoint.com/rspec/rspec_writing_specs.htm\" rel=\"nofollow\">https://www.tutorialspoint.com/rspec/rspec_writing_specs.htm</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1476860861, "post_id": 40124209, "comment_id": 67519015, "body": "Can you give some more details? How do you generate the file? Where?"}, {"owner": {"reputation": 423, "user_id": 3595470, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/aa6a1b78beda706c1fbd8e5f5d68ddfe?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick", "link": "https://stackoverflow.com/users/3595470/karthick"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1476861249, "post_id": 40124209, "comment_id": 67519244, "body": "I gave a option to user upload a csv file so user uploaded a file so i got file only i won&#39;t read that file.did you understand?"}, {"owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "edited": false, "score": 0, "creation_date": 1476861514, "post_id": 40124209, "comment_id": 67519387, "body": "<code>file-path</code> is not a valid variable name in ruby"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1476864141, "post_id": 40124209, "comment_id": 67521033, "body": "No, did not understand. Show some code."}], "answers": [{"tags": [], "owner": {"reputation": 2707, "user_id": 1540290, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02f9d39d23f7ce35ec2cc4332ac1dafc?s=128&d=identicon&r=PG", "display_name": "Lukasz Muzyka", "link": "https://stackoverflow.com/users/1540290/lukasz-muzyka"}, "is_accepted": false, "score": 1, "last_activity_date": 1476861679, "creation_date": 1476861679, "answer_id": 40124740, "question_id": 40124209, "link": "https://stackoverflow.com/questions/40124209/ruby-on-rails-csv-file-not-storing-to-file-path/40124740#40124740", "title": "Ruby on Rails - CSV file not storing to file path", "body": "<p>if you want to open CSV there a couple options but the code above has a syntactic error. </p>\n\n<p>you can try this: </p>\n\n<pre><code>parsed_file = CSV.parse(File.open('/Users/yourname/Desktop/' + 'file.csv', 'wb'))\n\nparsed_file.each do |row|\n  puts row[0] # will print first column of each row\nend\n</code></pre>\n"}], "owner": {"reputation": 423, "user_id": 3595470, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/aa6a1b78beda706c1fbd8e5f5d68ddfe?s=128&d=identicon&r=PG&f=1", "display_name": "Karthick", "link": "https://stackoverflow.com/users/3595470/karthick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476861679, "creation_date": 1476860014, "question_id": 40124209, "link": "https://stackoverflow.com/questions/40124209/ruby-on-rails-csv-file-not-storing-to-file-path", "title": "Ruby on Rails - CSV file not storing to file path", "body": "<p>I have a file path but i don't know how do i store the csv file to file path and i tried code below but i didn't get file from that file-path.I want uploaded csv file store to some location</p>\n\n<pre><code>File.join(file-path, filename)\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "rake"], "answers": [{"comments": [{"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "edited": false, "score": 0, "creation_date": 1573193136, "post_id": 40131365, "comment_id": 103809251, "body": "It will be helpful if you provide little idea how ruby can be used to build desktop application"}], "tags": [], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1476879967, "creation_date": 1476879967, "answer_id": 40131365, "question_id": 40123836, "link": "https://stackoverflow.com/questions/40123836/creating-windows-executable-for-ruby-app/40131365#40131365", "title": "Creating Windows executable for ruby APP", "body": "<p>So Finally I got the answer, So Travelling ruby does't work for me because some of its limitations</p>\n\n<p>So its good to go with Ocra Gem (<a href=\"https://github.com/larsch/ocra\" rel=\"nofollow\">https://github.com/larsch/ocra</a>)</p>\n\n<p>Simple install the gem on windows (I have made app on window)\nand run the command </p>\n\n<pre><code>ocra &lt;Ruby file name &gt; --verbose --gem-full --no-dep-run --add-all-core --gemfile Gemfile\n</code></pre>\n\n<p>It will generate the exe file and you  are ready to run it on any windows</p>\n"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "accepted_answer_id": 40131365, "answer_count": 1, "score": 1, "last_activity_date": 1476879967, "creation_date": 1476858734, "question_id": 40123836, "link": "https://stackoverflow.com/questions/40123836/creating-windows-executable-for-ruby-app", "title": "Creating Windows executable for ruby APP", "body": "<p>I have written small script project on windows, I have three gems in my gem file</p>\n\n<p>I am using Travelling ruby on ubuntu to create its package but in the rake task when script try to dowload the gems these three gems gives error because I think its window specific gems and look for some dependencies</p>\n\n<p>I kept these gems with in the project and referenced  in gem file , The script created zip file well, but when I run that on windows the errors that the win32... gems not found</p>\n\n<pre><code>    rake package:win32 outputs when it try to fetch gems \n\n```shell\nFetching gem metadata from http://rubygems.org/............\nFetching version metadata from http://rubygems.org/.\nResolving dependencies...\nUsing jmespath 1.3.1\nUsing ffi 1.9.14\nUsing mini_magick 4.3.6\nInstalling win32-api 1.4.8 (was 1.6.0) with native extensions\nUsing bundler 1.13.5\nUsing aws-sdk-core 2.6.10\nUsing rautomation 0.17.0\nUsing win32-clipboard 0.6.4\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /home/vishalgarg/.rvm/rubies/ruby-2.1.5/bin/ruby -r ./siteconf20161019-3963-1e9bkxl.rb extconf.rb\nchecking for strncpy_s()... no\ncreating Makefile\n\nmake \"DESTDIR=\" clean\n\nmake \"DESTDIR=\"\ncompiling win32/api.c\nwin32/api.c:2:21: fatal error: windows.h: No such file or directory\n #include &lt;windows.h&gt;\n                     ^\ncompilation terminated.\nmake: *** [api.o] Error 1\n\nmake failed, exit code 2\n\n\n```\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1476857470, "post_id": 40123473, "comment_id": 67517089, "body": "you don&#39;t have a relation,   <code>has_many :payment_orders</code> in the company. Please add that and try"}, {"owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "reply_to_user": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "edited": false, "score": 0, "creation_date": 1476864541, "post_id": 40123473, "comment_id": 67521293, "body": "yep i have added that relation too. doesnt work"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476864611, "post_id": 40123527, "comment_id": 67521332, "body": "yes i have already tried but doesnt work even the price attribute is set as nil"}, {"owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476864666, "post_id": 40123527, "comment_id": 67521370, "body": "price attribute is of type &#39;float&#39;"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476864735, "post_id": 40123527, "comment_id": 67521432, "body": "<code>@variable = @company.payment_orders.create(subscription_id: 1, price: 1000.0), @variable.errors</code>, check if any errors are present?"}, {"owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476865010, "post_id": 40123527, "comment_id": 67521609, "body": "<code>#&lt;ActiveModel::Errors:0x00000008872208  @base=#&lt;PaymentOrder id: 2, company_id: nil, subscription_id: 1, created_at: &quot;2016-10-19 08:15:52&quot;, updated_at: &quot;2016-10-19 08:15:52&quot;, amount: 0.0&gt;,  @messages={}&gt;</code>"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476865082, "post_id": 40123527, "comment_id": 67521656, "body": "you have taken wrong field name, take <code>amount</code> instead ofprice <code>@company.payment_orders.create(subscription_id: @subscription_id, amount: @price)</code>"}, {"owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476865209, "post_id": 40123527, "comment_id": 67521756, "body": "no actual i changed the price field to amount and added default 0.0 value. the amount value is still doesnt change it remains default 0.0 event if i assign any other float value like &#39;10.0&#39; or &#39;100.0&#39;"}, {"owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "reply_to_user": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "edited": false, "score": 0, "creation_date": 1476868748, "post_id": 40123527, "comment_id": 67524138, "body": "have you changed it to amount from price? , if yes, paste the insert query once,"}], "tags": [], "owner": {"reputation": 16757, "user_id": 5654404, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/746f3e19ba3d2c092e951129a114391a?s=128&d=identicon&r=PG&f=1", "display_name": "Sravan", "link": "https://stackoverflow.com/users/5654404/sravan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476865114, "last_edit_date": 1476865114, "creation_date": 1476857571, "answer_id": 40123527, "question_id": 40123473, "link": "https://stackoverflow.com/questions/40123473/rails-activerecord-sets-object-attribute-nil-when-creating-or-initializing-objec/40123527#40123527", "title": "Rails ActiveRecord sets object attribute nil when creating or initializing object even when value is present", "body": "<p>you don't have a relation, has_many :payment_orders in the company. Please add that and try </p>\n\n<p>Models: </p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_one :subscription\n  has_many :payment_orders\nend\n\nclass PaymentOrder &lt; ActiveRecord::Base\n  belongs_to :company\n  belongs_to :subscription\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  has_many :payment_orders\nend\n</code></pre>\n\n<p>Then,</p>\n\n<pre><code>class PaymentOrderRecorder\n  .....\n\n  def record\n    @company.payment_orders.create(subscription_id: @subscription_id, amount: @price)\n  end\n  ....\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 5949678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn9j3.jpg?s=128&g=1", "display_name": "Divya Sharma", "link": "https://stackoverflow.com/users/5949678/divya-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1476859967, "creation_date": 1476859967, "answer_id": 40124191, "question_id": 40123473, "link": "https://stackoverflow.com/questions/40123473/rails-activerecord-sets-object-attribute-nil-when-creating-or-initializing-objec/40124191#40124191", "title": "Rails ActiveRecord sets object attribute nil when creating or initializing object even when value is present", "body": "<p>I think you should use has_many through association for this:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :payment_orders\n  has_many :subscription,  :through =&gt; :payment_orders\nend\n\n\nclass PaymentOrder &lt; ActiveRecord::Base\n  belongs_to :company\n  belongs_to :subscription\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  has_many :payment_orders\n  has_many :companies,  :through =&gt; :payment_orders\nend\n</code></pre>\n\n<p>then perform this query:</p>\n\n<pre><code>@company.payment_orders.create(subscription_id: 1, price: 1000.0)\n</code></pre>\n\n<p>it will work</p>\n"}], "owner": {"reputation": 1, "user_id": 3343186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fcea4b01c40691483c62bdf2c93113?s=128&d=identicon&r=PG&f=1", "display_name": "sagunshre", "link": "https://stackoverflow.com/users/3343186/sagunshre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476865114, "creation_date": 1476857316, "question_id": 40123473, "link": "https://stackoverflow.com/questions/40123473/rails-activerecord-sets-object-attribute-nil-when-creating-or-initializing-objec", "title": "Rails ActiveRecord sets object attribute nil when creating or initializing object even when value is present", "body": "<p>When creating a model object active record sets the objects attribute to nil even if the values are set</p>\n\n<pre><code>@company.payment_orders.create(subscription_id: 1, price: 1000.0)\n#&lt;PaymentOrder id: nil, company_id: 1, subscription_id: nil, price: nil,..&gt;\n</code></pre>\n\n<p>my models look some thing like this</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_one :subscription\nend\n\nclass PaymentOrder &lt; ActiveRecord::Base\n  belongs_to :company\n  belongs_to :subscription\nend\n\nclass Subscription &lt; ActiveRecord::Base\n  has_many :payment_orders\nend\n</code></pre>\n\n<p>And class for recording the payment_order</p>\n\n<pre><code>class PaymentOrderRecorder\n  def initialize(company, subscription, price)\n    @company = company\n    @subscription = subscription\n    @price = price\n  end\n\n  def record\n    @company.payment_orders.create(subscription_id: @subscription_id, price: @price)\n  end\n  ....\nend\n</code></pre>\n"}, {"tags": ["json", "ruby"], "comments": [{"owner": {"reputation": 3528, "user_id": 4650975, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/477an.png?s=128&g=1", "display_name": "ABGR", "link": "https://stackoverflow.com/users/4650975/abgr"}, "edited": false, "score": 0, "creation_date": 1476855254, "post_id": 40122902, "comment_id": 67516164, "body": "It&#39;s more of Javascript(Client side work) than Ruby"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1476855516, "post_id": 40122902, "comment_id": 67516269, "body": "Look on ruby gems in the table printing category"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1476856084, "post_id": 40122902, "comment_id": 67516515, "body": "First step: <code>JSON.load(json_string)</code>. Second step: Something like <a href=\"https://github.com/aptinio/text-table\" rel=\"nofollow noreferrer\"><code>text-table</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 260, "user_id": 3815905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E8CMY.jpg?s=128&g=1", "display_name": "AnkurVyas", "link": "https://stackoverflow.com/users/3815905/ankurvyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1476883961, "creation_date": 1476883961, "answer_id": 40132882, "question_id": 40122902, "link": "https://stackoverflow.com/questions/40122902/ruby-formatting-json-into-string/40132882#40132882", "title": "Ruby - Formatting json into string", "body": "<p>First you need to parse JSON result.</p>\n\n<pre><code>data = JSON.parse(result)\n</code></pre>\n\n<p>Then use that parsed result to generate the pattern.</p>\n\n<pre><code>data = [\n  { id: 1, name: 'Panda', description: '' },\n  { id: 2, name: 'koala', description: '' }\n]\n\nputs 'Id      | Name         |Description'\ndata.each do |entry|\n  puts \"#{entry[:id]}       | #{entry[:name]}        |#{entry[:description]}\"\nend\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 1420, "user_id": 1436610, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/Ow8Cb.jpg?s=128&g=1", "display_name": "Coding active", "link": "https://stackoverflow.com/users/1436610/coding-active"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476883961, "creation_date": 1476855086, "question_id": 40122902, "link": "https://stackoverflow.com/questions/40122902/ruby-formatting-json-into-string", "title": "Ruby - Formatting json into string", "body": "<p>I need to convert a JSON response into a well-formatted string, more like a table.</p>\n\n<p>Example,</p>\n\n<pre><code>[{id: 1, name: \"Panda\", description: \"\"}, {id: 2, name: \"koala\", description: \"\"},...]\n</code></pre>\n\n<p>To be converted as,</p>\n\n<pre><code> Id       | Name        |Description\n 1        | Panda       |\n 2        | Koala test  | \n</code></pre>\n\n<p>and for the text to be automatically wrapped inside the cell width. \nAny help would be appreciated. \nThank you. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 2067375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd805bbb6862aa2fc7166a3372119e0c?s=128&d=identicon&r=PG", "display_name": "Rada Bogdan", "link": "https://stackoverflow.com/users/2067375/rada-bogdan"}, "is_accepted": false, "score": 0, "last_activity_date": 1476861247, "creation_date": 1476861247, "answer_id": 40124595, "question_id": 40122486, "link": "https://stackoverflow.com/questions/40122486/how-and-where-can-i-import-a-common-scss-files-so-that-it-gets-available-in-eve/40124595#40124595", "title": "How and where can I import a common SCSS files, so that it gets available in every scss files?", "body": "<p>Have you tried <code>sprockets-sass</code> gem ? It works great with Sprockets 2.x and 3.x with both SCSS and SASS files. </p>\n\n<p>And it does exactly what you need :D </p>\n"}], "owner": {"reputation": 2111, "user_id": 1846982, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/9979071c5c3697ae9e8b8f50062a1782?s=128&d=identicon&r=PG&f=1", "display_name": "Bloomberg", "link": "https://stackoverflow.com/users/1846982/bloomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476861247, "creation_date": 1476853192, "question_id": 40122486, "link": "https://stackoverflow.com/questions/40122486/how-and-where-can-i-import-a-common-scss-files-so-that-it-gets-available-in-eve", "title": "How and where can I import a common SCSS files, so that it gets available in every scss files?", "body": "<p>I have scss files that use variables for colors. like - </p>\n\n<pre><code>.label-primary, .badge-primary {\n  background-color: $navy;\n  color: #FFFFFF;\n}\n\n.label-success, .badge-success {\n  background-color: $blue;\n  color: #FFFFFF;\n}\n\n.label-warning, .badge-warning {\n  background-color: $yellow;\n  color: #FFFFFF;\n}\n</code></pre>\n\n<p>These variables are defined in <code>variables.scss</code> file</p>\n\n<p>I have already @imported <code>@import \"base/variables\";</code> in application.css.scss file.</p>\n\n<pre><code>// Variables, Mixins\n@import \"base/variables\";\n@import \"base/mixins\";\n</code></pre>\n\n<p>but still it doesnt loads in other scss files and throws error <code>Sass::SyntaxError: Undefined variable: \"$navy\".</code> where trying to precompile in production.</p>\n\n<p>I have to explicitely <code>@import \"base/variables\";</code> in every scss file on the top. there are 35 files.</p>\n\n<p>How can i define this variable.scss file in just one place so that its loaded in every scss file?</p>\n\n<pre><code>NOTE: I am using rails-api gem and the application is API only. I have tweaked a bit to make some views on this application.\n</code></pre>\n"}, {"tags": ["ruby", "encoding", "cryptography"], "comments": [{"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1476854095, "post_id": 40122403, "comment_id": 67515763, "body": "The <code>==</code> at the end suggests it&#39;s Base64 encoded. There is no encryption at play here."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476855706, "post_id": 40122403, "comment_id": 67516358, "body": "Do you perchance have an Enigma machine?"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1476856117, "post_id": 40122746, "comment_id": 67516532, "body": "Ideally instead of just decoding you put in the code you used to do the decoding as that&#39;s the <i>educational</i> part."}], "tags": [], "owner": {"reputation": 58, "user_id": 2182331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a590b329890b84691e17e99ed95baf?s=128&d=identicon&r=PG", "display_name": "kovex", "link": "https://stackoverflow.com/users/2182331/kovex"}, "is_accepted": false, "score": 0, "last_activity_date": 1476854355, "creation_date": 1476854355, "answer_id": 40122746, "question_id": 40122403, "link": "https://stackoverflow.com/questions/40122403/how-can-i-decipher-a-ciphered-text/40122746#40122746", "title": "How can I decipher a ciphered text?", "body": "<p>Difficult if you don't have any information about the algorithm, but the string looks like just base64 encoded, if you use a decoder you end up with </p>\n\n<blockquote>\n  <p>0110111101110000011001010110111000100000011100110110010101110011011000010110110101100101</p>\n</blockquote>\n\n<p>don't know whether it makes sense or not </p>\n"}, {"comments": [{"owner": {"reputation": 256, "user_id": 4291349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07f5345e0ddc148df69fedcf236f08c5?s=128&d=identicon&r=PG&f=1", "display_name": "roarfromror", "link": "https://stackoverflow.com/users/4291349/roarfromror"}, "edited": false, "score": 0, "creation_date": 1476863883, "post_id": 40123639, "comment_id": 67520872, "body": "Thanks alot for detailed answer."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1476857997, "last_edit_date": 1495535549, "creation_date": 1476857997, "answer_id": 40123639, "question_id": 40122403, "link": "https://stackoverflow.com/questions/40122403/how-can-i-decipher-a-ciphered-text/40123639#40123639", "title": "How can I decipher a ciphered text?", "body": "<p>Artjom B. already noted in a <a href=\"https://stackoverflow.com/questions/40122403/how-can-i-decipher-a-ciphered-text#comment67515763_40122403\">comment</a> that trailing equal signs may indicate a Base64 encoding (a quick <a href=\"http://www.google.com/search?q=trailing+equal+signs+encoding\" rel=\"nofollow noreferrer\">Google search</a> reveals this, too). Fortunately, Ruby has a <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/base64/rdoc/Base64.html\" rel=\"nofollow noreferrer\"><code>Base64</code></a> library to decode it:</p>\n\n<pre><code>require 'base64'\n\nstring = 'MDExMDExMTEwMTExMDAwMDAxMTAwMTAxMDExMDExMTAwMDEwMDAwMDAxMTEwMDExMDExMDAxMDEwMTExMDAxMTAx MTAwMDAxMDExMDExMDEwMTEwMDEwMQ=='\ndecoded = Base64.decode64(string)\n#=&gt; \"0110111101110000011001010110111000100000011100110110010101110011011000010110110101100101\"\n</code></pre>\n\n<p>The new string consists of 0's and 1's, apparently another encoding, this time a binary one. It could be ASCII characters. Let's take a look at the first 8 \"bits\":</p>\n\n<pre><code>decoded[0, 8] #=&gt; \"01101111\"\n</code></pre>\n\n<p>Converted to a byte, i.e. an integer via <a href=\"http://ruby-doc.org/core-2.3.1/String.html#method-i-to_i\" rel=\"nofollow noreferrer\"><code>to_i</code></a>: (2 means binary)</p>\n\n<pre><code>decoded[0, 8].to_i(2) #=&gt; 111\n</code></pre>\n\n<p>And finally to a character via <a href=\"http://ruby-doc.org/core-2.3.1/Integer.html#method-i-chr\" rel=\"nofollow noreferrer\"><code>chr</code></a>:</p>\n\n<pre><code>decoded[0, 8].to_i(2).chr #=&gt; \"o\"\n</code></pre>\n\n<p>Nice, \"o\" is a valid ASCII character, what about the following characters?</p>\n\n<pre><code>decoded[8, 8].to_i(2).chr  #=&gt; \"p\"\ndecoded[16, 8].to_i(2).chr #=&gt; \"e\"\ndecoded[24, 8].to_i(2).chr #=&gt; \"n\"\n</code></pre>\n\n<p>That's \"open\", an English word. I think we have something here. You can probably work out the rest yourself. And beware of the thieves ;-)</p>\n"}], "owner": {"reputation": 256, "user_id": 4291349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07f5345e0ddc148df69fedcf236f08c5?s=128&d=identicon&r=PG&f=1", "display_name": "roarfromror", "link": "https://stackoverflow.com/users/4291349/roarfromror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 40123639, "answer_count": 2, "score": 0, "last_activity_date": 1476857997, "creation_date": 1476852804, "last_edit_date": 1476854030, "question_id": 40122403, "link": "https://stackoverflow.com/questions/40122403/how-can-i-decipher-a-ciphered-text", "title": "How can I decipher a ciphered text?", "body": "<p>I got the following ciphered string:</p>\n\n<blockquote>\n  <p>MDExMDExMTEwMTExMDAwMDAxMTAwMTAxMDExMDExMTAwMDEwMDAwMDAxMTEwMDExMDExMDAxMDEwMTExMDAxMTAx MTAwMDAxMDExMDExMDEwMTEwMDEwMQ==</p>\n</blockquote>\n\n<p>Now I would like to decipher this string into original one. How can I do this? and I don't know about which algorithm is used to cipher the original string, the ciphered string has length of 121 characters.</p>\n"}, {"tags": ["javascript", "ruby", "function", "global-variables", "storing-data"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1476860079, "post_id": 40122250, "comment_id": 67518515, "body": "Don&#39;t use recursion here, a loop is actually what you want: <code>loop do ... end</code>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1476864458, "post_id": 40122250, "comment_id": 67521233, "body": "I think it would be better to explain <i>why</i> you are recommending against Tail Recursion, because Tail Recursion is actually a perfectly natural intuitive way of looping. (As is evidenced by the fact that someone who seems to be a beginner at programming reached for it as the easiest and most obvious solution). The problem is that Ruby doesn&#39;t have Proper Tail Calls (actually Proper Tail Recursion would be enough in this case), and thus Tail Recursion will potentially blow the stack. (Probably not in this case, though, after all, there will seldom be more than 9 &quot;iterations&quot; of the &quot;loop&quot;.)"}], "answers": [{"comments": [{"owner": {"reputation": 298, "user_id": 6196389, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b16e6130113046b62d3eef5495d044a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6196389/mike"}, "edited": false, "score": 0, "creation_date": 1476998480, "post_id": 40123498, "comment_id": 67598251, "body": "I have actually.just recently been introduced to classes.  Still trying to learn them. Could you please give me an example of how I would use this in a class?  class Board/ attr_accessor :row1 /def initialize /@row1 = row1"}, {"owner": {"reputation": 298, "user_id": 6196389, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b16e6130113046b62d3eef5495d044a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6196389/mike"}, "edited": false, "score": 0, "creation_date": 1476998676, "post_id": 40123498, "comment_id": 67598347, "body": "Didn&#39;t mean to hit post on the comment above.  But something like that last line above?  But how would I incorporate it into my code above and how does that help keep data in the array?"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1477013687, "last_edit_date": 1477013687, "creation_date": 1476857457, "answer_id": 40123498, "question_id": 40122250, "link": "https://stackoverflow.com/questions/40122250/ruby-trying-to-store-array-elements-when-reiterating-through-functions/40123498#40123498", "title": "Ruby trying to store array elements when reiterating through functions", "body": "<p>Global variables are prefixed by <code>$</code> and are generally a bad idea in Ruby.</p>\n\n<p>Instance variables, prefixed by <code>@</code>, can also do what you want; on top-level, they behave pretty much the same as globals, but in classes or modules they are nicely isolated.</p>\n\n<p>So the best way would be to make a class; create your variable (say, <code>@row1</code>) in the <code>initialize</code> method, and then you will be able to just use it in <code>choosespot_x</code> method.</p>\n\n<p>EDIT: The way I'd do it...</p>\n\n<pre><code>module TicTacToe\n  class Board\n    def initialize\n      @board = Array.new(9)\n    end\n\n    def [](y, x)\n      @board[x + y * 3 - 4]\n    end\n\n    def []=(y, x, value)\n      @board[x + y * 3 - 4] = value\n    end\n  end\nend\n\nboard = TicTacToe::Board.new\nboard[1, 3] = :white\nboard[3, 2] = :black\nboard[1, 3]\n# =&gt; :white\nboard[1, 1]\n# =&gt; nil\n</code></pre>\n"}], "owner": {"reputation": 298, "user_id": 6196389, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b16e6130113046b62d3eef5495d044a2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/6196389/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40123498, "answer_count": 1, "score": 0, "last_activity_date": 1477013687, "creation_date": 1476851923, "question_id": 40122250, "link": "https://stackoverflow.com/questions/40122250/ruby-trying-to-store-array-elements-when-reiterating-through-functions", "title": "Ruby trying to store array elements when reiterating through functions", "body": "<p>I am attempting to make a tic tac toe game.  I have a good idea of where to go, and I know what the problem is, but I am not sure how to fix it.  When I create a function, I establish variables for that function.  i = 0, row1 = [], but when I am reiterating through the functions, every time the function gets called again, row1 is back to empty because of the initial row1 = [], and the counter I want to use, i = 0, goes back to 0 every time because the beginning of the function I am setting my variables.  I think the solution may be to make the variable global, and set it out of the function, but I am not sure how to do that.  But if anyone has any suggestions it would be greatly appreciated.  Here is the problem code.</p>\n\n<pre><code>def row1(player)\n    row1 = []\n    row1[player - 1] = \"X\"\n\n    puts \"#{row1}\"\n\nend\n\ndef choosespot_x\n\n    puts \"X -- Choose a spot\"\n    move = gets.chomp.to_i\n    if move &lt;= 3\n        row1(move)\n    end\n\nchoosespot_x\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "loops", "memory"], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1476865031, "last_edit_date": 1476865031, "creation_date": 1476861045, "answer_id": 40124532, "question_id": 40122137, "link": "https://stackoverflow.com/questions/40122137/ruby-memory-usage-methodical-loop-versus-built-in-loop/40124532#40124532", "title": "Ruby Memory Usage: Methodical Loop Versus Built In Loop", "body": "<p>Your first loop is <em>iterative</em> and your second loop is <em>recursive</em>.</p>\n\n<p>In other words, you are calling the same method from itself over and over again. This builds a huge stack. You can see this by raising an exception at a given point:</p>\n\n<pre><code>@n = 0\ndef lp\n  @n += 1\n  raise if @n &gt;= 10\n  lp\nend\nlp\n</code></pre>\n\n<p>Gives:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>loop.rb:4:in `lp': unhandled exception\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:5:in `lp'\n        from loop.rb:7:in `&lt;main&gt;'\n</code></pre>\n\n<p>You are using a special kind of recursion here called <a href=\"https://en.wikipedia.org/wiki/Tail_recursion\" rel=\"nofollow\">tail recursion</a> and it can be optimized.</p>\n\n<p>Although Ruby does not optimize tail calls by default, you can <a href=\"http://nithinbekal.com/posts/ruby-tco/\" rel=\"nofollow\">enable it</a> manually:</p>\n\n<pre><code># tailcall.rb\n\ntailcall = ARGV.include?('-t')\n\nRubyVM::InstructionSequence.compile_option = {\n  tailcall_optimization: tailcall,\n  trace_instruction: false\n}\n\nRubyVM::InstructionSequence.new(&lt;&lt;-RUBY).eval\n  @n = 0\n  def lp\n    @n += 1\n    if @n == 11_900\n      return\n    end\n    lp\n  end\n  lp\nRUBY\n\nputs \"Memory usage: #{`ps -o rss= -p #{$$}`.to_i} kB\"\n</code></pre>\n\n<p>From shell without optimization:</p>\n\n<pre><code>$ ruby --disable-all tailcall.rb\nMemory usage: 4952 kB\n</code></pre>\n\n<p>and with optimization:</p>\n\n<pre><code>$ ruby --disable-all tailcall.rb -t\nMemory usage: 3860 kB\n</code></pre>\n\n<p>Using tail call optimization makes the recursive algorithm as memory efficient as its iterative counterpart. It also prevents a stack overflow.</p>\n"}, {"tags": [], "owner": {"reputation": 5455, "user_id": 393021, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5761f8f81bb258e64b585889481ef25c?s=128&d=identicon&r=PG", "display_name": "iGbanam", "link": "https://stackoverflow.com/users/393021/igbanam"}, "is_accepted": false, "score": 0, "last_activity_date": 1476866520, "creation_date": 1476866520, "answer_id": 40126297, "question_id": 40122137, "link": "https://stackoverflow.com/questions/40122137/ruby-memory-usage-methodical-loop-versus-built-in-loop/40126297#40126297", "title": "Ruby Memory Usage: Methodical Loop Versus Built In Loop", "body": "<p>In your recursive approach, extra memory segments have to be allocated for the new function to be called. While in your iterative approach, all values needed to compute the logic is already available from setup, therefore less memory is used. </p>\n"}], "owner": {"reputation": 103, "user_id": 6872917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iw4nZ.jpg?s=128&g=1", "display_name": "Elijah Schutz", "link": "https://stackoverflow.com/users/6872917/elijah-schutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 40124532, "answer_count": 2, "score": 2, "last_activity_date": 1476866520, "creation_date": 1476851289, "question_id": 40122137, "link": "https://stackoverflow.com/questions/40122137/ruby-memory-usage-methodical-loop-versus-built-in-loop", "title": "Ruby Memory Usage: Methodical Loop Versus Built In Loop", "body": "<p>Take this Ruby (MRI) program:</p>\n\n<pre><code>@n = 0\nloop do\n    @n += 1\n    break if @n == 11_900\nend\n\nps = `ps auxm | grep ruby`\nputs \"Memory usage: #{ps.split[5].to_i/1024.0} Mb\"\n</code></pre>\n\n<p>Using the builtin <code>loop</code> function it infinitely loops until <code>@n</code> equals 11,900, then prints the memory used by Ruby in the process (I used a system call for lack of a good, working memory profiler).</p>\n\n<p>When executed, this outputs: <code>Memory usage: 9.16796875 Mb</code>, or anywhere between about 8.99 Mb and 9.49 Mb.</p>\n\n<p>Compare to this function:</p>\n\n<pre><code>@n = 0\ndef lp\n  @n += 1\n  if @n == 11_900\n    return\n  end\n  lp\nend\nlp\n</code></pre>\n\n<p>Using a self-calling function, <code>lp</code>, it loops until <code>@n</code> equals 11,900 (the stack limit).</p>\n\n<p>When executed, this outputs: <code>Memory usage: 10.20703125 Mb</code>, or anywhere between about 9.96 Mb and 10.41 Mb.</p>\n\n<p>Why is it that the first program occupies almost a megabyte less memory than the second? How does the builtin loop differ from an artificial loop?</p>\n\n<p>The only reason I am able to think of with my limited knowledge is that the <code>loop</code> function compiles directly to C whereas the second program has a lot of overhead with the function definition etc.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search", "solr"], "comments": [{"owner": {"reputation": 1360, "user_id": 5424117, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d43a8ddc631162ea764c878ada40b410?s=128&d=identicon&r=PG&f=1", "display_name": "jb62", "link": "https://stackoverflow.com/users/5424117/jb62"}, "edited": false, "score": 0, "creation_date": 1476886325, "post_id": 40122098, "comment_id": 67537546, "body": "Although I haven&#39;t used it, the most recent release of Solr has SQL-like functionality.  I am not aware of anything that does the translation from normal English to the SQL, but if something like that exists for Ruby - perhaps there&#39;s a way to connect the output (the SQL) to Solr.  See this for some info on the Solr SQL ability...  <a href=\"https://cwiki.apache.org/confluence/display/solr/Parallel+SQL+Interface\" rel=\"nofollow noreferrer\">cwiki.apache.org/confluence/display/solr/Parallel+SQL+Interf&zwnj;&#8203;ace</a>"}, {"owner": {"reputation": 2573, "user_id": 5787849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0885a24e8501106661f4475a59fe1a0b?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket Shivam Tiwari", "link": "https://stackoverflow.com/users/5787849/aniket-shivam-tiwari"}, "edited": false, "score": 0, "creation_date": 1494836616, "post_id": 40122098, "comment_id": 74978824, "body": "have you find any solution?"}, {"owner": {"reputation": 10324, "user_id": 409617, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/fQkEw.jpg?s=128&g=1", "display_name": "Mr. Black", "link": "https://stackoverflow.com/users/409617/mr-black"}, "edited": false, "score": 0, "creation_date": 1498208641, "post_id": 40122098, "comment_id": 76416877, "body": "Not yet. Will update if any."}], "owner": {"reputation": 10324, "user_id": 409617, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/fQkEw.jpg?s=128&g=1", "display_name": "Mr. Black", "link": "https://stackoverflow.com/users/409617/mr-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476851046, "creation_date": 1476851046, "question_id": 40122098, "link": "https://stackoverflow.com/questions/40122098/splunk-like-search-feature-in-ruby-on-rails", "title": "Splunk like search feature in ruby on rails", "body": "<p>I have an application which is have 300+ million records. I would like to implement splunk the search mechanism to filter out the records from the DB. </p>\n\n<p>i.e the user can write a query in normal English and that would be converted to the SQL query and retrieve the data for the user. </p>\n\n<p>Is there any tool/gems available for that? any other suggestion would be great.</p>\n\n<p>I have some experience with solr. </p>\n\n<p>thx.</p>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 6569140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c91af48cee9e57bc8f078fde90a46c?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Kale", "link": "https://stackoverflow.com/users/6569140/chaitanya-kale"}, "edited": false, "score": 0, "creation_date": 1476851180, "post_id": 40122078, "comment_id": 67514752, "body": "Ah this one is better than my solution as <code>sort_by</code> is expensive"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1476851230, "post_id": 40122078, "comment_id": 67514767, "body": "Max, thank you so much for the quick reply! I&#39;ll try this out.  I didn&#39;t think index could be used to compare string order.  This is very elegant--really appreciate your time."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 187, "user_id": 6569140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c91af48cee9e57bc8f078fde90a46c?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Kale", "link": "https://stackoverflow.com/users/6569140/chaitanya-kale"}, "edited": false, "score": 0, "creation_date": 1476854722, "post_id": 40122078, "comment_id": 67515985, "body": "@ChaitanyaKale, <code>sort_by</code> is cheap, not expensive. That&#39;s because the construction of a hash that maps elements to the sorting criterion is done only once, prior to  the sorting operation. By contrast, with <code>&lt;=&gt;</code> indices must be calculated twice for each pairwise comparison, which is much slower than performing two hash lookups."}, {"owner": {"reputation": 187, "user_id": 6569140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c91af48cee9e57bc8f078fde90a46c?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Kale", "link": "https://stackoverflow.com/users/6569140/chaitanya-kale"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476885047, "post_id": 40122078, "comment_id": 67536461, "body": "Ah Thanks @CarySwoveland! I read <a href=\"https://ruby-doc.org/core-2.2.0/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Enumerable.html#method-i-sort_by</a> which mentions it being expensive   &quot;The current implementation of sort_by generates an array of tuples containing the original collection element and the mapped value. This makes sort_by fairly expensive when the keysets are simple.&quot;"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 187, "user_id": 6569140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c91af48cee9e57bc8f078fde90a46c?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Kale", "link": "https://stackoverflow.com/users/6569140/chaitanya-kale"}, "edited": false, "score": 0, "creation_date": 1476886962, "post_id": 40122078, "comment_id": 67538083, "body": "@ChaitanyaKale, I&#39;m amazed that <code>sort_by</code> uses an array of two-element arrays. I just assumed it would be a hash for fast lookups. Even so, <code>sort_by</code> is much faster than <code>sort</code> in many situations."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477073485, "post_id": 40122078, "comment_id": 67633380, "body": "Max (et al), I am getting <code>comparison of Array with Array failed (ArgumentError)</code> when using <code>order.index(a[:name]) &lt;=&gt; order.index(b[:name]</code> against my real data in my app (similar to the sample data I provided).  I&#39;ve been trying to diagnose it for about 2 hours and can&#39;t seem to find a pattern.  When a remove certain hashes in the array, it doesn&#39;t happen but those hashes don&#39;t appear to be different than any of the others.  Do you by chance know what would cause this?  Does your solution deal with values in my data that don&#39;t match any in the array?  Thanks in advance for your help!"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1477074051, "post_id": 40122078, "comment_id": 67633652, "body": "I don&#39;t recall offhand how to reproduce this error, though I&#39;ve definitely encountered it as well. Personally how I&#39;d debug it is to install a debugger like <code>byebug</code>, then inside the sort block, use something like <code>byebug unless [a[:name], b[:name]].all? { |x| x.is_a? String }</code> to set a conditional breakpoint. At that point, you could inspect your values at runtime and determine how to proceed. You may have to put in nil checks and default values."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477094836, "post_id": 40122078, "comment_id": 67641546, "body": "Thanks Max!  I found the issue--I had two names for the same book (aliases) in my data.  One was missing from the array."}, {"owner": {"reputation": 2241, "user_id": 2140271, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea24c17719a975fb38c107a60f4b3802?s=128&d=identicon&r=PG", "display_name": "Vincent Fourmond", "link": "https://stackoverflow.com/users/2140271/vincent-fourmond"}, "edited": false, "score": 0, "creation_date": 1538845939, "post_id": 40122078, "comment_id": 92291212, "body": "This is way too complicated, you only need to sort when you don&#39;t know the order yet. Here, the order is known, it&#39;s only that the data structure is not adapted."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 2241, "user_id": 2140271, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea24c17719a975fb38c107a60f4b3802?s=128&d=identicon&r=PG", "display_name": "Vincent Fourmond", "link": "https://stackoverflow.com/users/2140271/vincent-fourmond"}, "edited": false, "score": 0, "creation_date": 1538855514, "post_id": 40122078, "comment_id": 92293683, "body": "@VincentFourmond i&#39;m not really clear what you mean. If you have a simpler way, maybe make another answer?"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 5, "last_activity_date": 1538845258, "last_edit_date": 1538845258, "creation_date": 1476850903, "answer_id": 40122078, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order/40122078#40122078", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>Here's an example</p>\n\n<pre><code>arr = [{a: 1}, {a: 3}, {a: 2}] \n\norder = [2,1,3]  \n\narr.sort { |a,b| order.index(a[:a]) &lt;=&gt; order.index(b[:a]) }                                           \n# =&gt; [{:a=&gt;2}, {:a=&gt;1}, {:a=&gt;3}]  \n</code></pre>\n\n<p>In your case it would be </p>\n\n<pre><code>order = ['Matthew', 'Mark', 'Acts', '1John']\nresult = list_of_hashes.sort do |a,b|\n  order.index(a[:name]) &lt;=&gt; order.index(b[:name])\nend\n</code></pre>\n\n<p>There are two important concepts here:</p>\n\n<ol>\n<li>Using <code>Array#index</code> to find where in an array an element is found</li>\n<li>the 'spaceship operator' <code>&lt;=&gt;</code> which is how <code>Array#sort</code> works - see <a href=\"https://stackoverflow.com/questions/827649/what-is-the-ruby-spaceship-operator\">What is the Ruby &lt;=&gt; (spaceship) operator?</a></li>\n</ol>\n\n<p>You can make it slightly faster by indexing the list of elements you want to order by:</p>\n\n<pre><code>order_with_index = order.each.with_object.with_index({}) do |(elem, memo), idx|\n  memo[elem] = idx\nend\n</code></pre>\n\n<p>then instead of <code>order.index(&lt;name&gt;)</code> use <code>order_with_index[&lt;name&gt;]</code></p>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477000186, "post_id": 40122110, "comment_id": 67599020, "body": "Thank you for your time Chaitanya!"}], "tags": [], "owner": {"reputation": 187, "user_id": 6569140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c91af48cee9e57bc8f078fde90a46c?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Kale", "link": "https://stackoverflow.com/users/6569140/chaitanya-kale"}, "is_accepted": false, "score": 2, "last_activity_date": 1476894184, "last_edit_date": 1476894184, "creation_date": 1476851090, "answer_id": 40122110, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order/40122110#40122110", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>As the description of <code>Array#sort_by</code> accepts a block. The block should return -1, 0, or +1 depending on the comparison between a and b. You can use <code>find_index</code> on the <code>array</code> to do such comparison.</p>\n\n<p><code>array_of_hashes.sort_by {|a| array.find_index(a[:book]) }</code> should do the trick.</p>\n"}, {"comments": [{"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477000309, "post_id": 40122437, "comment_id": 67599076, "body": "Cary, so sorry I didn&#39;t catch this yesterday.  I was so glad to have a solution that I didn&#39;t follow up.   This is really good analysis and my <code>@bible</code> array (or whatever it will be called) is quite large.  If I get this thing off the ground, I may very well be comparing performance and use your solution in my final code.  Thank you!!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1476910149, "last_edit_date": 1476910149, "creation_date": 1476853010, "answer_id": 40122437, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order/40122437#40122437", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>Since you know the desired order there's no need to sort the array. Here's one way you could do that. (I've called your array of hashes <code>bible</code>.)</p>\n\n<pre><code>bible.group_by { |h| h[:book] }.values_at(*array).flatten\n  #=&gt; [{:book=&gt;\"Matthew\", :chapter=&gt;\"4\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"Matthew\", :chapter=&gt;\"22\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"Mark\", :chapter=&gt;\"6\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"Acts\", :chapter=&gt;\"9\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"Acts\", :chapter=&gt;\"17\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"},\n  #    {:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"}] \n</code></pre>\n\n<p>Since <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html#method-i-group_by\" rel=\"nofollow\">Enumerable#group_by</a>, <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-values_at\" rel=\"nofollow\">Hash#values_at</a> and <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-flatten\" rel=\"nofollow\">Array#flatten</a> each require just one pass through the array <code>bible</code> this may be faster than sorting when <code>bible</code> is large. </p>\n\n<p>Here are the steps.</p>\n\n<pre><code>h = bible.group_by { |h| h[:book] }\n  #=&gt; {\"Matthew\"=&gt;[{:book=&gt;\"Matthew\", :chapter=&gt;\"4\", :section=&gt;\"new_testament\"},\n  #                {:book=&gt;\"Matthew\", :chapter=&gt;\"22\", :section=&gt;\"new_testament\"}],\n  #    \"Mark\"   =&gt;[{:book=&gt;\"Mark\", :chapter=&gt;\"6\", :section=&gt;\"new_testament\"}],\n  #    \"1John\"  =&gt;[{:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"},\n  #                {:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"}],\n  #    \"Acts\"   =&gt;[{:book=&gt;\"Acts\", :chapter=&gt;\"9\", :section=&gt;\"new_testament\"}, \n  #                {:book=&gt;\"Acts\", :chapter=&gt;\"17\", :section=&gt;\"new_testament\"}]\n  #   } \n\na = h.values_at(*array)\n  #=&gt; h.values_at('Matthew', 'Mark', 'Acts', '1John')\n  #=&gt; [[{:book=&gt;\"Matthew\", :chapter=&gt;\"4\", :section=&gt;\"new_testament\"},\n  #     {:book=&gt;\"Matthew\", :chapter=&gt;\"22\", :section=&gt;\"new_testament\"}],\n  #    [{:book=&gt;\"Mark\", :chapter=&gt;\"6\", :section=&gt;\"new_testament\"}],\n  #    [{:book=&gt;\"Acts\", :chapter=&gt;\"9\", :section=&gt;\"new_testament\"},\n  #     {:book=&gt;\"Acts\", :chapter=&gt;\"17\", :section=&gt;\"new_testament\"}],\n  #    [{:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"},\n  #     {:book=&gt;\"1John\", :chapter=&gt;\"1\", :section=&gt;\"new_testament\"}]] \n</code></pre>\n\n<p>Lastly, <code>a.flatten</code> returns the array shown earlier.</p>\n\n<p>Let's do a benchmark.</p>\n\n<pre><code>require 'fruity'\n\n@bible = [\n  {:book=&gt;\"Matthew\",\n   :chapter=&gt;\"4\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"Matthew\",\n   :chapter=&gt;\"22\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"Mark\",\n   :chapter=&gt;\"6\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"1John\",\n   :chapter=&gt;\"1\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"1John\",\n   :chapter=&gt;\"1\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"Acts\",\n   :chapter=&gt;\"9\",\n   :section=&gt;\"new_testament\"},\n  {:book=&gt;\"Acts\",\n   :chapter=&gt;\"17\",\n   :section=&gt;\"new_testament\"}]\n\n@order = ['Matthew', 'Mark', 'Acts', '1John']\n</code></pre>\n\n<p></p>    \n\n<pre><code>def bench_em(n)\n  arr = (@bible*((n/@bible.size.to_f).ceil))[0,n].shuffle\n  puts \"arr contains #{n} elements\"\n  compare do \n    _sort       { arr.sort { |h1,h2| @order.index(h1[:book]) &lt;=&gt;\n                  @order.index(h2[:book]) }.size }\n    _sort_by    { arr.sort_by { |h| @order.find_index(h[:book]) }.size }\n    _sort_by_with_hash {ord=@order.each.with_index.to_h;\n                        arr.sort_by {|b| ord[b[:book]]}.size}    \n    _values_at  { arr.group_by { |h| h[:book] }.values_at(*@order).flatten.size }\n  end\nend\n</code></pre>\n\n<p>@maxpleaner, @ChaitanyaKale and @Michael Kohl contributed <code>_sort</code>, <code>_sort_by</code>, and <code>sort_by_with_hash</code>, respectively.</p>\n\n<pre><code>bench_em    100\narr contains 100 elements\nRunning each test 128 times. Test will take about 1 second.\n_sort_by is similar to _sort_by_with_hash\n_sort_by_with_hash is similar to _values_at\n_values_at is faster than _sort by 2x \u00b1 1.0\n\nbench_em  1_000\narr contains 1000 elements\nRunning each test 16 times. Test will take about 1 second.\n_sort_by_with_hash is similar to _values_at\n_values_at is similar to _sort_by\n_sort_by is faster than _sort by 2x \u00b1 0.1\n\nbench_em 10_000\narr contains 10000 elements\nRunning each test once. Test will take about 1 second.\n_values_at is faster than _sort_by_with_hash by 10.000000000000009% \u00b1 10.0%\n_sort_by_with_hash is faster than _sort_by by 10.000000000000009% \u00b1 10.0%\n_sort_by is faster than _sort by 2x \u00b1 0.1\n\nbench_em 100_000\narr contains 100000 elements\nRunning each test once. Test will take about 3 seconds.\n_values_at is similar to _sort_by_with_hash\n_sort_by_with_hash is similar to _sort_by\n_sort_by is faster than _sort by 2x \u00b1 0.1\n</code></pre>\n\n<p>Here's a second run.</p>\n\n<pre><code>bench_em    100\narr contains 100 elements\nRunning each test 128 times. Test will take about 1 second.\n_sort_by_with_hash is similar to _values_at\n_values_at is similar to _sort_by\n_sort_by is faster than _sort by 2x \u00b1 0.1\n\nbench_em  1_000\narr contains 1000 elements\nRunning each test 8 times. Test will take about 1 second.\n_values_at is faster than _sort_by_with_hash by 10.000000000000009% \u00b1 10.0%\n_sort_by_with_hash is similar to _sort_by\n_sort_by is faster than _sort by 2.2x \u00b1 0.1\n\nbench_em 10_000\narr contains 10000 elements\nRunning each test once. Test will take about 1 second.\n_values_at is similar to _sort_by_with_hash\n_sort_by_with_hash is similar to _sort_by\n_sort_by is faster than _sort by 2x \u00b1 1.0\n\nbench_em 100_000\narr contains 100000 elements\nRunning each test once. Test will take about 3 seconds.\n_sort_by_with_hash is similar to _values_at\n_values_at is similar to _sort_by\n_sort_by is faster than _sort by 2x \u00b1 0.1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476910513, "post_id": 40123212, "comment_id": 67552648, "body": "I somehow missed your answer earlier. I expected the hash to speed up <code>sort_by</code> quite a lot, but my benchmarks suggest that it doesn&#39;t."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476935038, "post_id": 40123212, "comment_id": 67559759, "body": "The array is probably too small for that to make a noticeable difference. But for larger arrays I&#39;d certainly use this approach."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476935332, "post_id": 40123212, "comment_id": 67559849, "body": "Ah, I missed your update with all the BM results above. Seems like even for biggish arrays the difference between my and your solution is negligible. Maybe the implementation of <code>sort_by</code> with a two element array offsets the benefit of using a hash for generating the external order, so I&#39;d say one should use whatever code makes semantically the most sense. Thanks for the benchmarks!"}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477000085, "post_id": 40123212, "comment_id": 67598984, "body": "Apologies Michael, I am just seeing this now.  Thank you so much for taking the time to put this together.  This is definitely a more readable solution and I have upvoted it.  It is nice to understand how the backend sorting works but I will definitely go this route in the future."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477020505, "post_id": 40123212, "comment_id": 67604027, "body": "@KurtW Don&#39;t worry, it seems that you learned a lot from this answer and that&#39;s what SO is about."}, {"owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "edited": false, "score": 0, "creation_date": 1477068629, "post_id": 40123212, "comment_id": 67630877, "body": "Thanks Michael :) -- hey, does Ruby 2.0.0 not support the <code>.to_h</code> method on <code>Enumerator</code>?    Just specifying <code>order = nt_books.each.with_index.to_h</code> gives me <code>undefined method  &#39;to_h&#39; for #&lt;Enumerator:0x00000000640168&gt;&#39;</code>.   If Ruby 2.0.0 doesn&#39;t support it, what is the alternative for legacy versions of Ruby?  Thanks in advance!"}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1477106458, "post_id": 40123212, "comment_id": 67643270, "body": "You&#39;re right, <code>to_h</code> was added in 2.1.0. The Alternative in this case is <code>Hash[nt_books.each.with_index.to_h]</code>."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 4, "last_activity_date": 1476856255, "creation_date": 1476856255, "answer_id": 40123212, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order/40123212#40123212", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>As can be seen from the <a href=\"http://ruby-doc.org/core-2.3.1/Array.html#method-i-index\" rel=\"nofollow\">documentation</a>, <code>Array#index</code> indeed does work for strings (it's even the provided example), so this would work:</p>\n\n<pre><code>books.sort_by { |b| array.index(b[:book]) }\n</code></pre>\n\n<p>But instead of repeatedly searching through <code>array</code>, you can just determine the order once and then look it up:</p>\n\n<pre><code>order = array.each.with_index.to_h\n#=&gt; { \"Matthew\" =&gt; 0, \"Mark\" =&gt; 1, \"Acts\" =&gt; 2, \"1John\" =&gt; 3 }\nbooks.sort_by { |b| order[b[:book]] }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2241, "user_id": 2140271, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea24c17719a975fb38c107a60f4b3802?s=128&d=identicon&r=PG", "display_name": "Vincent Fourmond", "link": "https://stackoverflow.com/users/2140271/vincent-fourmond"}, "edited": false, "score": 0, "creation_date": 1538898131, "post_id": 52681450, "comment_id": 92300174, "body": "Hmmm. I didn&#39;t see there were more than one entry with the same name, forget this."}], "tags": [], "owner": {"reputation": 2241, "user_id": 2140271, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ea24c17719a975fb38c107a60f4b3802?s=128&d=identicon&r=PG", "display_name": "Vincent Fourmond", "link": "https://stackoverflow.com/users/2140271/vincent-fourmond"}, "is_accepted": false, "score": 0, "last_activity_date": 1538845875, "creation_date": 1538845875, "answer_id": 52681450, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order/52681450#52681450", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>Your mistake is to think that you are sorting. But, in fact, you are not, you already have the order, you just need to place the elements. I'm not proposing a compact or optimal solution, but a simple solution. First convert your large array into a hash indexed by the <code>:book</code> key (which should have been your first data structure), and then just use <code>map</code>:</p>\n\n<pre><code>array = ['Matthew', 'Mark', 'Acts', '1John']\nelements = [{:book=&gt;\"Matthew\",\n  :chapter=&gt;\"4\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Matthew\",\n  :chapter=&gt;\"22\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Mark\",\n  :chapter=&gt;\"6\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"1John\",\n  :chapter=&gt;\"1\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"1John\",\n  :chapter=&gt;\"1\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Acts\",\n  :chapter=&gt;\"9\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Acts\",\n  :chapter=&gt;\"17\",\n  :section=&gt;\"new_testament\"}]\nby_name = {}\nfor e in elements\n  by_name[e[:book]] = e\nend\nfinal = array.map { |x| by_name[x] }\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3875042, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1557167620/picture?type=large", "display_name": "Kurt W", "link": "https://stackoverflow.com/users/3875042/kurt-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 1, "accepted_answer_id": 40122078, "answer_count": 5, "score": 2, "last_activity_date": 1538845875, "creation_date": 1476849932, "last_edit_date": 1495540838, "question_id": 40121932, "link": "https://stackoverflow.com/questions/40121932/ruby-sort-array-of-hashes-values-string-based-on-array-order", "title": "Ruby - sort array of hashes values (string) based on array order", "body": "<p>I have an array of hashes in the format shown below and I am attempting to sort the <code>:book</code> key of the hash based on a separate array.  The order is not alphabetical and for my use case it cannot be alphabetical.</p>\n\n<p>I need to sort based on the following array:</p>\n\n<pre><code>array = ['Matthew', 'Mark', 'Acts', '1John']\n</code></pre>\n\n<p>Note that I've seen several solutions that leverage <code>Array#index</code> (such as <a href=\"https://stackoverflow.com/questions/28392328/sorting-an-array-of-hashes-based-on-an-array-of-sorted-values\">Sorting an Array of hashes based on an Array of sorted values</a>) to perform a custom sort but that will not work with strings.</p>\n\n<p>I've tried various combinations of sorting with <code>Array#sort</code> and <code>Array#sort_by</code> but they don't seem to accept a custom order.  What am I missing?  Thank you in advance for your help!</p>\n\n<p><strong>Array of Hashes</strong></p>\n\n<pre><code>[{:book=&gt;\"Matthew\",\n  :chapter=&gt;\"4\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Matthew\",\n  :chapter=&gt;\"22\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Mark\",\n  :chapter=&gt;\"6\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"1John\",\n  :chapter=&gt;\"1\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"1John\",\n  :chapter=&gt;\"1\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Acts\",\n  :chapter=&gt;\"9\",\n  :section=&gt;\"new_testament\"},\n {:book=&gt;\"Acts\",\n  :chapter=&gt;\"17\",\n  :section=&gt;\"new_testament\"}]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "sqlite", "rake"], "comments": [{"owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "edited": false, "score": 0, "creation_date": 1476849420, "post_id": 40121805, "comment_id": 67514263, "body": "After you perform <code>rake db:migrate</code> what was the logs says?"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "reply_to_user": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "edited": false, "score": 0, "creation_date": 1476850158, "post_id": 40121805, "comment_id": 67514434, "body": "@araratan,  <code>~&#47;mebay $ rake db:migrate --trace ** Invoke db:migrate (first_time) ** Invoke environment (first_time) ** Execute environment ** Invoke db:load_config (first_time) ** Execute db:load_config ** Execute db:migrate ** Invoke db:_dump (first_time) ** Execute db:_dump ** Invoke db:schema:dump (first_time) ** Invoke environment  ** Invoke db:load_config  ** Execute db:schema:dump</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476850881, "post_id": 40121840, "comment_id": 67514650, "body": "Yeah you&#39;re right but.. But the books says I need to replace my database with downloaded from their site (according to book - with the same structure)  but after replacing i get <a href=\"http://localhost:3000/ads/3\" rel=\"nofollow noreferrer\">localhost:3000/ads/3</a>:  <code>Migrations are pending. To resolve this issue, run: bin&#47;rake db:migrate RAILS_ENV=development        def check_pending!(connection = Base.connection)         raise ActiveRecord::PendingMigrationError if ActiveRecord::Migrator.needs_migration?(connection)       end        def load_schema_if_pending!</code>"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476850954, "post_id": 40121840, "comment_id": 67514672, "body": "and then <code>~&#47;mebay $ rake db:migrate RAILS_ENV=development == 20161018144410 CreateAds: migrating ======================================== -- create_table(:ads) rake aborted! StandardError: An error has occurred, this and all later migrations canceled:  SQLite3::SQLException: table &quot;ads&quot; already exists: CREATE TABLE &quot;ads&quot; (&quot;id&quot; INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, &quot;name&quot; varchar, &quot;description&quot; text, &quot;price&quot; decimal, &quot;seller_id&quot; integer, &quot;email&quot; varchar, &quot;img_url&quot; varchar, &quot;created_at&quot; datetime NOT NULL, &quot;updated_at&quot; datetime NOT NULL) </code>"}, {"owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "reply_to_user": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476851565, "post_id": 40121840, "comment_id": 67514877, "body": "Oh you need to drop the table first before running your migration. The error output said <code>SQLite3::SQLException: table &quot;ads&quot; already exists</code>. To drop the table, run this command <code>rails generate migration drop_ads_table</code>. Then open that new migration file and copy this string into the body of the def method <code>drop_table :ads</code>. Save the file and then run rake db:migrate"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476852299, "post_id": 40121840, "comment_id": 67515098, "body": "ahem.. :) you meaned rake db:drop? (just googled it)"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476852420, "post_id": 40121840, "comment_id": 67515141, "body": "ahem.. :) you meaned rake db:drop? (just googled it)  <code>~&#47;mebay $ rake db:migrate RAILS_ENV=development == 20161018144410 CreateAds: migrating ======================================== -- create_table(:ads)    -&gt; 0.0012s == 20161018144410 CreateAds: migrated (0.0013s) ===============================</code>  as i expected, dropping erased all of the data)  <code>ActiveRecord::RecordNotFound in AdsController#show Couldn&#39;t find Ad with &#39;id&#39;=3</code>  but how can i actually replace the tables then, if they had same structure?"}, {"owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "reply_to_user": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476852537, "post_id": 40121840, "comment_id": 67515188, "body": "I just amended my answer. And no I didn&#39;t mean that. Running <code>rake db:drop</code> will completely erase the whole database and the way I proposed will simply delete the ads table from the database. I suppose either way would work for your situation though."}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476854141, "post_id": 40121840, "comment_id": 67515781, "body": "it half-worked) or I half-understanded it. :) I did what you said with replaced table file and come back to <code>ActiveRecord::RecordNotFound in AdsController#show Couldn&#39;t find Ad with &#39;id&#39;=3</code> maybe there is another way to replace sqlite files?"}, {"owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "edited": false, "score": 0, "creation_date": 1476866411, "post_id": 40121840, "comment_id": 67522557, "body": "whoops - you was totally right, my code was ok from the very beginning, problem was in the downloaded database. Manyally edited my db with sqlitestudio and that&#39;s all. You&#39;re my hero"}], "tags": [], "owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "is_accepted": true, "score": 2, "last_activity_date": 1476852428, "last_edit_date": 1476852428, "creation_date": 1476849407, "answer_id": 40121840, "question_id": 40121805, "link": "https://stackoverflow.com/questions/40121805/rake-dbmigrate-does-not-create-table/40121840#40121840", "title": "rake db:migrate does not create table", "body": "<p>You actually didn't do anything wrong. Look in db/schema.rb and if you see this then you're database is setup properly:</p>\n\n<pre><code>ActiveRecord::Schema.define(version: 20161019035406) do\n\n  create_table \"ads\", force: :cascade do |t|\n    t.string   \"name\"\n    t.text     \"description\"\n    t.decimal  \"price\"\n    t.integer  \"seller_id\"\n    t.string   \"email\"\n    t.string   \"img_url\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n\nend\n</code></pre>\n\n<p>If you're getting an error that the table already exists, you can do the following: </p>\n\n<p>first add a <code>down</code> method to your migration file that you used to generate the ads table. The down method would look like this:</p>\n\n<pre><code>def down\n  drop_table :ads\nend\n</code></pre>\n\n<p>Then run <code>rake db:migrate:down VERSION=version_number</code> where the version_number is the timestamp in the name of the migration file. This will remove the table from the database. Then change the name of the <code>change</code> method to <code>up</code>. Save the file and run <code>rake db:migrate:up</code> to create the table again.</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 2650008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67a97403efd8cdf88ec1596399bcba3?s=128&d=identicon&r=PG&f=1", "display_name": "Yu-Shing Shen", "link": "https://stackoverflow.com/users/2650008/yu-shing-shen"}, "is_accepted": false, "score": 0, "last_activity_date": 1476850298, "creation_date": 1476850298, "answer_id": 40121976, "question_id": 40121805, "link": "https://stackoverflow.com/questions/40121805/rake-dbmigrate-does-not-create-table/40121976#40121976", "title": "rake db:migrate does not create table", "body": "<p>How about run <code>rake db:create</code> first and then run <code>rake db:migrate</code></p>\n"}], "owner": {"reputation": 119, "user_id": 7039910, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/464edee302c4920a64df3b21810ed084?s=128&d=identicon&r=PG&f=1", "display_name": "crcerror", "link": "https://stackoverflow.com/users/7039910/crcerror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4912, "favorite_count": 0, "accepted_answer_id": 40121840, "answer_count": 2, "score": 1, "last_activity_date": 1476859317, "creation_date": 1476849134, "last_edit_date": 1476859317, "question_id": 40121805, "link": "https://stackoverflow.com/questions/40121805/rake-dbmigrate-does-not-create-table", "title": "rake db:migrate does not create table", "body": "<p>I'm using Rails 4.2.6 and have strange error (learning rails with the HeadFirst book, project and directory name - \"mebay\"):</p>\n\n<p>I need to create project uses only \"read\" of CRUD - so I run:</p>\n\n<pre><code>~/mebay $ rails generate model ad name:string description:text price:decimal seller_id:integer email:string img_url:string\n\nRunning via Spring preloader in process 8400\n      invoke  active_record\n   identical    db/migrate/20161018144410_create_ads.rb\n   identical    app/models/ad.rb\n      invoke    test_unit\n   identical      test/models/ad_test.rb\n   identical      test/fixtures/ads.yml\n</code></pre>\n\n<p>and here comes my db/migrate/20161018144410_create_ads.rb:</p>\n\n<pre><code>class CreateAds &lt; ActiveRecord::Migration\n  def change\n    create_table :ads do |t|\n      t.string :name\n      t.text :description\n      t.decimal :price\n      t.integer :seller_id\n      t.string :email\n      t.string :img_url\n\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>(looks pretty ok for me, basing on earlier projects)</p>\n\n<p>Then, as I understand, I need to create database (i use sqlite):</p>\n\n<pre><code>~/mebay $ rake db:migrate\n</code></pre>\n\n<p>but after that, my development.sqlite3 remain empty</p>\n\n<p>what am i doing wrong?</p>\n"}, {"tags": ["ruby", "loops", "hash"], "answers": [{"tags": [], "owner": {"reputation": 1992, "user_id": 3924496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YPKhm.jpg?s=128&g=1", "display_name": "roelofs", "link": "https://stackoverflow.com/users/3924496/roelofs"}, "is_accepted": false, "score": 0, "last_activity_date": 1476847898, "creation_date": 1476847898, "answer_id": 40121650, "question_id": 40121575, "link": "https://stackoverflow.com/questions/40121575/iterating-over-a-hash-in-ruby-difference-between-these-two-examples/40121650#40121650", "title": "Iterating over a Hash in Ruby. Difference between these two examples?", "body": "<p>In your first example, you're iterating over each complete element of the hash (<code>x</code>), and printing it as a single <strong>key:value</strong> pair, resulting in the bracketed format.</p>\n\n<p>In your second example, you're iterating over each element in the hash again, but specifically splitting that element into the key and value (<code>x</code>, <code>y</code>) being fed into the <code>puts</code> statement, and printing them with your own formatting.</p>\n"}, {"tags": [], "owner": {"reputation": 6559, "user_id": 382520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05f73868bd13eba39cab490c897f1333?s=128&d=identicon&r=PG", "display_name": "JCorcuera", "link": "https://stackoverflow.com/users/382520/jcorcuera"}, "is_accepted": true, "score": 1, "last_activity_date": 1476853036, "creation_date": 1476853036, "answer_id": 40122443, "question_id": 40121575, "link": "https://stackoverflow.com/questions/40121575/iterating-over-a-hash-in-ruby-difference-between-these-two-examples/40122443#40122443", "title": "Iterating over a Hash in Ruby. Difference between these two examples?", "body": "<p>When you iterate a hash, it passes the <code>key</code>, <code>value</code> pair as a parameter in the format of an array of two elements: <code>[key, value]</code>. That is the reason you are seeing <code>[\"Homer\", \"dad\"]</code> in your first example, <code>x</code> is being assigned with the array.</p>\n\n<p>The second example is the same but in that case you are assigning the pair to <code>x</code> and <code>y</code>. <code>x</code> gets the first element of the array and <code>y</code> the second element, that is called <a href=\"https://nathanhoad.net/ruby-multiple-assignment\" rel=\"nofollow\">multiple assignment</a> in ruby.</p>\n\n<pre><code>2.2.2 :001 &gt; x = {a: 1}.first\n =&gt; [:a, 1] \n2.2.2 :002 &gt; x\n =&gt; [:a, 1] \n2.2.2 :003 &gt; x,y ={a: 1}.first\n =&gt; [:a, 1] \n2.2.2 :004 &gt; x\n =&gt; :a \n2.2.2 :005 &gt; y\n =&gt; 1 \n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6918173, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/21df02f6b44d7da39831f925d43e4a29?s=128&d=identicon&r=PG&f=1", "display_name": "KnowledgeMC", "link": "https://stackoverflow.com/users/6918173/knowledgemc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 40122443, "answer_count": 2, "score": 0, "last_activity_date": 1476853036, "creation_date": 1476847457, "question_id": 40121575, "link": "https://stackoverflow.com/questions/40121575/iterating-over-a-hash-in-ruby-difference-between-these-two-examples", "title": "Iterating over a Hash in Ruby. Difference between these two examples?", "body": "<p>I am trying to learn a little Ruby.  Can someone please explain to me the difference between these two examples? </p>\n\n<p>Say that I have a hash: </p>\n\n<pre><code>family = { \"Homer\" =&gt; \"dad\",\n  \"Marge\" =&gt; \"mom\",\n  \"Lisa\" =&gt; \"sister\",\n  \"Maggie\" =&gt; \"sister\",\n  \"Abe\" =&gt; \"grandpa\",\n  \"Santa's Little Helper\" =&gt; \"dog\"\n}\n</code></pre>\n\n<p>If I iterate like this:</p>\n\n<pre><code>family.each { |x| puts \"#{x}\" }\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>[\"Homer\", \"dad\"]\n[\"Marge\", \"mom\"]\n[\"Lisa\", \"sister\"]\n[\"Maggie\", \"sister\"]\n[\"Abe\", \"grandpa\"]\n[\"Santa's Little Helper\", \"dog\"]\n</code></pre>\n\n<p>When I iterate like this:</p>\n\n<pre><code>family.each { |x, y| puts \"#{x}: #{y}\" }\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>Homer: dad\nMarge: mom\nLisa: sister\nMaggie: sister\nAbe: grandpa\nSanta's Little Helper: dog\n</code></pre>\n\n<p>Can someone please explain how the two results differ (what do the square brackets, quotes, commas, colons mean?), and when one might use one vs. the other? Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos-sierra"], "comments": [{"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 0, "creation_date": 1476848539, "post_id": 40121528, "comment_id": 67514021, "body": "The cld project hasn&#39;t been touched in four years... You might have some luck rolling back your Ruby version, but if I were in your shoes, I&#39;d be looking for alternatives to cld. In the meantime, you might try making sure your homebrew and xcode tools installation are up to date."}], "answers": [{"tags": [], "owner": {"reputation": 297, "user_id": 4512783, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c989fbbc5605c7295966460c8b0584d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/4512783/guillermo"}, "is_accepted": false, "score": 0, "last_activity_date": 1476889994, "creation_date": 1476889994, "answer_id": 40135413, "question_id": 40121528, "link": "https://stackoverflow.com/questions/40121528/bundle-error-installing-cld-macos-sierra/40135413#40135413", "title": "Bundle Error Installing CLD, macOS Sierra", "body": "<p>As @MarsAtomico suggested I did update xcode and homebrew and was able to install the gem.</p>\n"}], "owner": {"reputation": 297, "user_id": 4512783, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c989fbbc5605c7295966460c8b0584d7?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/4512783/guillermo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1476889994, "creation_date": 1476847077, "question_id": 40121528, "link": "https://stackoverflow.com/questions/40121528/bundle-error-installing-cld-macos-sierra", "title": "Bundle Error Installing CLD, macOS Sierra", "body": "<p>I have been having some problems with <code>bundle install</code> since updating my OS to Sierra. The latest one is related with the gem cld:</p>\n\n<pre><code>Installing cld 0.7.0 with native extensions\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\ncurrent directory:\n/private/var/folders/zn/wqrzmg6d4nq55m38xmpfyyn80000gn/T/bundler20161018-17743-2nngwicld-0.7.0/gems/cld-0.7.0/ext/cld\n/Users/seque1990/.rbenv/versions/2.2.2/bin/ruby -r ./siteconf20161018-17743-1l1g1xa.rb\nextconf.rb\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... build_aux/install-sh -c -d\nchecking for gawk... no\nchecking for mawk... no\nchecking for nawk... no\nchecking for awk... awk\nchecking whether make sets $(MAKE)... no\nchecking build system type... i386-apple-darwin16.0.0\nchecking host system type... i386-apple-darwin16.0.0\nchecking how to print strings... printf\nchecking for style of include used by make... none\nchecking for gcc... gcc\nchecking for C compiler default output file name...\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details.\n\nMakefile not found\n\nGem files will remain installed in\n/var/folders/zn/wqrzmg6d4nq55m38xmpfyyn80000gn/T/bundler20161018-17743-2nngwicld-0.7.0/gems/cld-0.7.0\nfor inspection.\nResults logged to\n/var/folders/zn/wqrzmg6d4nq55m38xmpfyyn80000gn/T/bundler20161018-17743-2nngwicld-0.7.0/extensions/x86_64-darwin-15/2.2.0-static/cld-0.7.0/gem_make.out\n\nAn error occurred while installing cld (0.7.0), and Bundler cannot continue.\nMake sure that `gem install cld -v '0.7.0'` succeeds before bundling.\n</code></pre>\n\n<p>What is the best approach to solve this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8372, "user_id": 1408347, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/7mD3y.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1408347/brian"}, "edited": false, "score": 0, "creation_date": 1476848604, "post_id": 40121370, "comment_id": 67514032, "body": "Do you want to see all the elements inside the Enumerator?"}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1476864737, "post_id": 40121790, "comment_id": 67521434, "body": "Or, the really short answer: because <a href=\"http://ruby-doc.org/core/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\">the documentation</a> says so."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1541105524, "last_edit_date": 1541105524, "creation_date": 1476849062, "answer_id": 40121790, "question_id": 40121370, "link": "https://stackoverflow.com/questions/40121370/why-does-chunk-while-return-enumerator-object/40121790#40121790", "title": "Why does chunk_while return Enumerator object", "body": "<p>Methods in the <a href=\"http://ruby-doc.org/core-2.3.0/Enumerable.html\" rel=\"nofollow noreferrer\">Enumerable</a> module, such as <code>chunk_while</code>, require that receivers be enumerators, that is, instances of the class <a href=\"http://ruby-doc.org/core-2.3.0/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator</a>. Therefore if an <code>Enumerable</code> method such as <code>chunk_while</code> returns an enumerator, it can be the receiver to another <code>Enumerable</code> method (and that method can be the receiver of another <code>Enumerable</code> method, and so on). This is called <em>method chaining</em>. That's why you see many <code>Enumerable</code> methods return an enumerator if no block is provided. </p>\n\n<p>The chaining of methods that have enumerators as receivers may also include methods in other modules or in the class <code>Enumerator</code>, such as  <a href=\"http://ruby-doc.org/core-2.3.0/Enumerator.html#method-i-with_index\" rel=\"nofollow noreferrer\">Enumerator#with_index</a>.</p>\n\n<p>This is why we can write expressions such as the following.</p>\n\n<pre><code>array.chunk_while {|i,j| i + 1 == j }.map.with_index { |a,i| i.even? ? a.reduce(:+) : 0 }\n  #=&gt; [15, 0, 31]\n</code></pre>\n\n<p>Let's break this down.</p>\n\n<pre><code>e0 = array.chunk_while {|i,j| i + 1 == j }\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator::Generator:0x007fa01b9639e0&gt;:each&gt; \ne1 = e0.map\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: #&lt;Enumerator::Generator:0x007fa01b9639e0&gt;:each&gt;:map&gt; \ne2 = e1.with_index\n  #=&gt; #&lt;Enumerator: #&lt;Enumerator: #&lt;Enumerator:\n  #    #&lt;Enumerator::Generator:0x007fa01b9639e0&gt;:each&gt;:map&gt;:with_index&gt; \ne2.each { |a,i| i.even? ? a.reduce(:+) : 0 }\n  #=&gt; [15, 0, 31] \n</code></pre>\n\n<p>Examine the return values for the operations that produce <code>e0</code>, <code>e1</code> and <code>e2</code>. <code>e1</code> and <code>e2</code> may be thought of as <em>compound enumerators</em>.</p>\n\n<p>As a matter of practice, <code>chunk_while</code> is almost always chained to another method, so it makes sense for it to return an enumerator.</p>\n\n<p>You might well ask, \"why must all enumerable methods require a receiver that is an enumerator, considering that <code>chunk_while</code>'s receiver in the example, <code>array</code>, is not an enumerator\"? The answer lies in the fact that every class that includes the <code>Enumerable</code> module must have a method <code>each</code> that returns an enumerator. One therefore could write</p>\n\n<pre><code>array.each.chunk_while {|i,j| i + 1 == j }.to_a\n</code></pre>\n\n<p>but Ruby saves you the trouble. Ruby will invoke <a href=\"https://stackoverflow.com/questions/40066614/convert-array-of-hashes-to-array/40066893?noredirect=1#comment67536024_40066893\">Array#each</a> for you when it sees that the method being invoked on an array requires an enumerator as its receiver. The same is true of all classes that have a method <code>each</code>.</p>\n"}], "owner": {"reputation": 6373, "user_id": 2715384, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/hwUTZ.jpg?s=128&g=1", "display_name": "the_prole", "link": "https://stackoverflow.com/users/2715384/the-prole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 40121790, "answer_count": 1, "score": 2, "last_activity_date": 1541143004, "creation_date": 1476846000, "last_edit_date": 1541143004, "question_id": 40121370, "link": "https://stackoverflow.com/questions/40121370/why-does-chunk-while-return-enumerator-object", "title": "Why does chunk_while return Enumerator object", "body": "<p>Why does <code>chunk_while</code> return an instance of <code>Enumerator</code>?</p>\n\n<p>This code:</p>\n\n<pre><code>array = [0, 1, 2, 3, 4, 5, 7, 8, 9, 15, 16]\np array.chunk_while {|i,j| i + 1 == j }\n</code></pre>\n\n<p>outputs this:</p>\n\n<pre><code>#&lt;Enumerator::Generator:0x00000002bef0a8&gt;:each&gt;\n</code></pre>\n\n<p>I have ruby version <code>ruby 2.3.1p112 (2016-04-26 revision 54768) [x64-mingw32]</code>.</p>\n"}, {"tags": ["ruby", "regex"], "answers": [{"comments": [{"owner": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 2, "creation_date": 1476843269, "post_id": 40120930, "comment_id": 67512886, "body": "other way: <code>[^\\P{P}&#39;]</code>"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 83048, "user_id": 2255089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZNAsT.jpg?s=128&g=1", "display_name": "Casimir et Hippolyte", "link": "https://stackoverflow.com/users/2255089/casimir-et-hippolyte"}, "edited": false, "score": 0, "creation_date": 1476844347, "post_id": 40120930, "comment_id": 67513127, "body": "Yup, @CasimiretHippolyte&#39;s solution should work too."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 3, "last_activity_date": 1476842965, "creation_date": 1476842965, "answer_id": 40120930, "question_id": 40120904, "link": "https://stackoverflow.com/questions/40120904/i-want-to-match-all-punctuation-in-my-regexp-except-apostrophes-how-do-i-do-tha/40120930#40120930", "title": "I want to match all punctuation in my regexp except apostrophes. How do i do that in Ruby?", "body": "<pre><code>string = \"jack. o'reilly? mike??!?\"\nputs string.gsub(/[\\p{P}&amp;&amp;[^']]/, '')\n# =&gt; jack o'reilly mike\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.3.0/Regexp.html#class-Regexp-label-Character+Classes\" rel=\"nofollow\">Docs</a>:</p>\n\n<blockquote>\n  <p>A character class may contain another character class. By itself this isn\u2019t useful because <code>[a-z[0-9]]</code> describes the same set as <code>[a-z0-9]</code>. However, character classes also support the <code>&amp;&amp;</code> operator which performs set intersection on its arguments. </p>\n</blockquote>\n\n<p>So, <code>[\\p{P}&amp;&amp;[^']]</code> is \"any character that is punctuation and also not an apostrophe\".</p>\n"}], "owner": {"reputation": 167, "user_id": 6758433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154048264753472/picture?type=large", "display_name": "Jack Kelly", "link": "https://stackoverflow.com/users/6758433/jack-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 40120930, "answer_count": 1, "score": 0, "last_activity_date": 1476842965, "creation_date": 1476842786, "question_id": 40120904, "link": "https://stackoverflow.com/questions/40120904/i-want-to-match-all-punctuation-in-my-regexp-except-apostrophes-how-do-i-do-tha", "title": "I want to match all punctuation in my regexp except apostrophes. How do i do that in Ruby?", "body": "<p>This is my code so far:</p>\n\n<pre><code>def alternate_words(string)\n    string.gsub(/[\\p{P}]/, \"\")\nend\n</code></pre>\n\n<p>I am looking for a way to add exceptions to my regular expressions. Is it possible or do I have to list them all out?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "pdf"], "comments": [{"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476841843, "post_id": 40120744, "comment_id": 67512539, "body": "So its its not working in production?"}, {"owner": {"reputation": 115, "user_id": 5630303, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153104270176036/picture?type=large", "display_name": "morales257", "link": "https://stackoverflow.com/users/5630303/morales257"}, "reply_to_user": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476842174, "post_id": 40120744, "comment_id": 67512610, "body": "now <code>APP_CONFIG[Rails.env][&#39;itinerary_path&#39;] </code> doesnt work in development either."}], "owner": {"reputation": 115, "user_id": 5630303, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153104270176036/picture?type=large", "display_name": "morales257", "link": "https://stackoverflow.com/users/5630303/morales257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1476841595, "creation_date": 1476841595, "last_edit_date": 1495540843, "question_id": 40120744, "link": "https://stackoverflow.com/questions/40120744/configuring-paths-in-development-and-production", "title": "Configuring Paths in Development and Production", "body": "<p>I have an app that lets users download itineraries if they like the preview of the first page. In order to make the preview, I use PDF Reader to parse the original document and create a PDF version of the first page.</p>\n\n<p>In development, the original itinerary is stored in the public folder.</p>\n\n<pre><code>@itin_preview = itinerary\nreader = PDF::Reader.new(\"public/#{@itin_preview/document_file_name}\")\nformatted_page = reader.page(1)\nformatted_text = formatted_page.text.gsub! /\\s+/, ''\npage_text = formatted_text.gsub!(/$/, \"\\n\")\n</code></pre>\n\n<p>This return <code>public/itinerary.pdf</code>. However, in production, the itinerary is stored on Amazon AWS, so i tried to configure an initializer with different paths in a YAML file for development and production, taken from <a href=\"https://stackoverflow.com/questions/18124673/downloading-rails-assets-file-paths-in-development-vs-production\">here</a>.</p>\n\n<p><strong>config.rb</strong></p>\n\n<pre><code>APP_CONFIG = YAML.load_file(\"#{Rails.root}/config/initializers/config.yml\")\n</code></pre>\n\n<p><strong>config.yml</strong></p>\n\n<pre><code>development:\n  itinerary_path: /public/#{@itin_preview.document_file_name}\nproduction:\n  itinerary_path: &lt;%= asset_path \"#{@itin_preview.document_file_name}\" %&gt;\n</code></pre>\n\n<p>When I input the constant into my PDF Reader like so,</p>\n\n<pre><code>reader = PDF::Reader.new(APP_CONFIG[Rails.env]['itinerary_path'])\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Completed 500 Internal Server Error in 19ms (ActiveRecord: 1.3ms)\n\nArgumentError (input must be an IO-like object or a filename):\n</code></pre>\n\n<p>I have double checked that <code>APP_CONFIG[Rails.env]['itinerary_path']</code> spits out <code>public/itinerary.pdf</code> in development. So why does it work as a string but not as a Constant?</p>\n\n<p>How can i get it to work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "pipe"], "answers": [{"tags": [], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1476842116, "creation_date": 1476842116, "answer_id": 40120806, "question_id": 40120638, "link": "https://stackoverflow.com/questions/40120638/ruby-pipes-io-and-stderr-redirect/40120806#40120806", "title": "ruby pipes, IO and stderr redirect", "body": "<p>The issue seems to be that as <code>stdout_writer</code> runs infinitely, <code>stdin_reader</code> will never get a chance to read the <code>STDOUT</code> from <code>stdout_writer</code> as the pipe, in this case, is waiting for <code>stdout_writer</code> to be finished before <code>stdin_reader</code> starts reading. I tested this by changing <code>while true</code> to <code>5.times do</code>. If you do that, and wait 5 seconds, the result of <code>./stdout_writer.rb | ./stdin_reader.rb</code> is </p>\n\n<pre><code>reading...\nwriting...\ngot line writing...\n~\ngot line ~\n~\ngot line ~\n~\ngot line ~\n~\ngot line ~\n~\ngot line ~\n</code></pre>\n\n<p>This isn't an issue with your code itself, but more so an issue with the way that ruby execution in terms of <code>STDOUT | STDIN</code> handling works.</p>\n\n<p>Also, I don't think I've ever learned as much as I learned researching this question. Thank you for the fun exercise. </p>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1476844589, "creation_date": 1476844589, "answer_id": 40121148, "question_id": 40120638, "link": "https://stackoverflow.com/questions/40120638/ruby-pipes-io-and-stderr-redirect/40121148#40121148", "title": "ruby pipes, IO and stderr redirect", "body": "<p>The output from <code>stdout_writer.rb</code> is being buffered by Ruby, so the reader process doesn\u2019t see it. If you wait long enough, you should see the result appear in chunks.</p>\n\n<p>You can turn buffering off and get the result you\u2019re expecting by <a href=\"http://ruby-doc.org/core-2.3.1/IO.html#method-i-sync-3D\" rel=\"nofollow\">setting <code>sync</code> to true</a> on <code>$stdout</code> at the start of stdout_writer.rb:</p>\n\n<pre><code>$stdout.sync = true \n</code></pre>\n"}], "owner": {"reputation": 3440, "user_id": 484460, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/2a42fb3ca4383d21fa8884752f5e2675?s=128&d=identicon&r=PG", "display_name": "Victor Pudeyev", "link": "https://stackoverflow.com/users/484460/victor-pudeyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1476844589, "creation_date": 1476840760, "question_id": 40120638, "link": "https://stackoverflow.com/questions/40120638/ruby-pipes-io-and-stderr-redirect", "title": "ruby pipes, IO and stderr redirect", "body": "<p>I am looking to have a ruby program (a rake task) observe an output from another rake task. The output writer outputs to stderr. I'd like to read those lines. I'm having difficulty setting it up. If I have a writer (stdout_writer.rb) that constantly prints something:</p>\n\n<pre><code>#!/usr/bin/env ruby\nputs 'writing...'\nwhile true\n  $stdout.puts '~'\n  sleep 1\nend\n</code></pre>\n\n<p>and a file that reads it and echoes (stdin_reader.rb):</p>\n\n<pre><code>#!/usr/bin/env ruby\nputs 'reading...'\nwhile input = ARGF.gets\n  puts input\n  input.each_line do |line|\n    begin\n      $stdout.puts \"got line #{line}\"\n    rescue Errno::EPIPE\n      exit(74)\n    end\n  end\nend\n</code></pre>\n\n<p>and I'm trying to have them work together, nothing happens:</p>\n\n<pre><code>$ ./stdout_writer.rb 2&gt;&amp;1 | ./stdin_reader.rb\n$ ./stdout_writer.rb | ./stdin_reader.rb\n</code></pre>\n\n<p>nothing... although if I just echo into stdin_reader.rb, I get what I expect: </p>\n\n<pre><code>piousbox@e7440:~/projects/opera_events/sendgrid-example-operaevent$ echo \"ok true\" | ./stdin_reader.rb\nreading...\nok true\ngot line ok true\npiousbox@e7440:~/projects/opera_events/sendgrid-example-operaevent$ \n</code></pre>\n\n<p>so how would I setup a script that gets stderr piped into it, so that it can read it line-by-line? Additional info: this will be an ubuntu upstart service <code>script1.rb | script2.rb</code> where script1 sends a message, and script2 verifies that the message was sent by script1</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476840364, "post_id": 40120561, "comment_id": 67512205, "body": "What are you trying to do, can you explain a little more?"}, {"owner": {"reputation": 3479, "user_id": 1639575, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L9ukx.jpg?s=128&g=1", "display_name": "Dudo", "link": "https://stackoverflow.com/users/1639575/dudo"}, "reply_to_user": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "edited": false, "score": 0, "creation_date": 1476840902, "post_id": 40120561, "comment_id": 67512328, "body": "Updated a bit. This seems super easy, but for whatever reason I can&#39;t seem to get the result I need."}], "answers": [{"comments": [{"owner": {"reputation": 3479, "user_id": 1639575, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L9ukx.jpg?s=128&g=1", "display_name": "Dudo", "link": "https://stackoverflow.com/users/1639575/dudo"}, "edited": false, "score": 0, "creation_date": 1476840571, "post_id": 40120606, "comment_id": 67512263, "body": "I need the nils, though. I still need the the underlying loans, even if they don&#39;t have a decision. More importantly, I&#39;m not trying to sort the resulting array, but the underlying collection."}, {"owner": {"reputation": 3479, "user_id": 1639575, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L9ukx.jpg?s=128&g=1", "display_name": "Dudo", "link": "https://stackoverflow.com/users/1639575/dudo"}, "edited": false, "score": 0, "creation_date": 1476841080, "post_id": 40120606, "comment_id": 67512362, "body": "we&#39;d need a uniq as well there. this does everything in memory, as well. I&#39;m trying to lean on the power of AR to handle this in the database."}, {"owner": {"reputation": 3479, "user_id": 1639575, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L9ukx.jpg?s=128&g=1", "display_name": "Dudo", "link": "https://stackoverflow.com/users/1639575/dudo"}, "edited": false, "score": 0, "creation_date": 1476841204, "post_id": 40120606, "comment_id": 67512386, "body": "Loan has_many :decisions. Your answer will result in several duplicate loans."}], "tags": [], "owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "is_accepted": false, "score": 0, "last_activity_date": 1476841249, "last_edit_date": 1476841249, "creation_date": 1476840494, "answer_id": 40120606, "question_id": 40120561, "link": "https://stackoverflow.com/questions/40120561/activerecord-ordering-by-relation/40120606#40120606", "title": "ActiveRecord ordering by relation", "body": "<p>If you have a relationship on Decision then you could do this, the Loans should be in the correct order in the returned hash.</p>\n\n<pre><code>Decision.where(...).includes(:loan).order(:smart_rate).map(&amp;:loan).uniq\n</code></pre>\n"}], "owner": {"reputation": 3479, "user_id": 1639575, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/L9ukx.jpg?s=128&g=1", "display_name": "Dudo", "link": "https://stackoverflow.com/users/1639575/dudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476841249, "creation_date": 1476840118, "last_edit_date": 1476840728, "question_id": 40120561, "link": "https://stackoverflow.com/questions/40120561/activerecord-ordering-by-relation", "title": "ActiveRecord ordering by relation", "body": "<pre><code>Loan.includes(:decisions).map{|l| l.decisions.last.try(:smart_rate)}\n=&gt; [2, nil, 2, 1, 4, 4, 1, nil, nil, nil, nil, 1, nil, 1, nil, 1, nil, nil, nil, 3, nil, 3, 1, 1, nil, 3, 1, 1, 4, 1, 1, 1, nil, 2, 1, nil, 1, nil, 1, 1, nil, 3, nil, 1, 1, 1, 1, 1, 1, 1]\n</code></pre>\n\n<p>I'd like to sort Loans by their last decision's smart_rate. I'm not trying to sort the array, but the resulting Loan::ActiveRecord_Relation.</p>\n\n<p>Can this be done via ActiveRecord?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "search"], "comments": [{"owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 1, "creation_date": 1476839996, "post_id": 40120512, "comment_id": 67512118, "body": "If you want to use the same term for both <code>?</code>s, you need to pass <code>@searchcriteria</code> twice; otherwise it thinks you forgot one."}, {"owner": {"reputation": 219, "user_id": 4860536, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/958053014205494/picture?type=large", "display_name": "Frank", "link": "https://stackoverflow.com/users/4860536/frank"}, "reply_to_user": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 0, "creation_date": 1476840110, "post_id": 40120512, "comment_id": 67512144, "body": "@philomory I don&#39;t know how that passed over my head. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1755, "user_id": 1877683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uttsA.jpg?s=128&g=1", "display_name": "C dot StrifeVII", "link": "https://stackoverflow.com/users/1877683/c-dot-strifevii"}, "is_accepted": true, "score": 2, "last_activity_date": 1476840177, "creation_date": 1476840177, "answer_id": 40120571, "question_id": 40120512, "link": "https://stackoverflow.com/questions/40120512/search-for-item-name-from-multiple-fields-on-ruby-on-rails/40120571#40120571", "title": "Search for item name from multiple fields on Ruby on Rails", "body": "<p>The problem is you have to pass in two variables. If that is <code>@searchcriteria</code> then pass that in.</p>\n\n<pre><code>def search\n    @results=0\n        if !params[:searchinput].empty?\n            @results=1\n            @searchinput = params[:searchinput]\n            @searchcriteria=\"%#{params[:searchinput]}%\"\n            @productlist = Product.where(\"productname like ? OR description like ?\", @searchcriteria, @second_variable)\n    end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219, "user_id": 4860536, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/958053014205494/picture?type=large", "display_name": "Frank", "link": "https://stackoverflow.com/users/4860536/frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1476840190, "creation_date": 1476840190, "answer_id": 40120573, "question_id": 40120512, "link": "https://stackoverflow.com/questions/40120512/search-for-item-name-from-multiple-fields-on-ruby-on-rails/40120573#40120573", "title": "Search for item name from multiple fields on Ruby on Rails", "body": "<p>the productlist statement should look like the following:</p>\n\n<pre><code>@productlist = Product.where(\"productname like ? OR description like ?\", @searchcriteria, @searchcriteria)\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 4860536, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/958053014205494/picture?type=large", "display_name": "Frank", "link": "https://stackoverflow.com/users/4860536/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 40120571, "answer_count": 2, "score": 2, "last_activity_date": 1476840190, "creation_date": 1476839644, "question_id": 40120512, "link": "https://stackoverflow.com/questions/40120512/search-for-item-name-from-multiple-fields-on-ruby-on-rails", "title": "Search for item name from multiple fields on Ruby on Rails", "body": "<p>I'm trying to enable a search for an item, and then have that item listed if the search is completed. I can get it to work for both instances, but not at the same time. My code:</p>\n\n<pre><code>def search\n    @results=0\n        if !params[:searchinput].empty?\n            @results=1\n            @searchinput = params[:searchinput]\n            @searchcriteria=\"%#{params[:searchinput]}%\"\n            @productlist = Product.where(\"productname like ? OR description like ?\", @searchcriteria)\n    end\nend\n</code></pre>\n\n<p>I get the following error:\n<a href=\"https://i.stack.imgur.com/00RMO.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/00RMO.png\" alt=\"enter image description here\"></a>\nIs the formatting with the productlist statement wrong?</p>\n"}, {"tags": ["ruby", "regex", "tuples", "irb"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476844211, "post_id": 40121044, "comment_id": 67513095, "body": "Very nice. (I was a few minutes behind you.) I would say part of the magic is how <code>scan</code> deals with capture groups."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1476843814, "creation_date": 1476843814, "answer_id": 40121044, "question_id": 40120358, "link": "https://stackoverflow.com/questions/40120358/search-string-returning-indexes-of-all-overlapping-occurrences-for-multiple-vari/40121044#40121044", "title": "Search string returning indexes of all overlapping occurrences for multiple variable length Ruby regular expressions", "body": "<p>Matches can't overlap. Use zero-length assertions instead:</p>\n\n<pre><code>guilty_terms = [/danger/i, /hack/i, /ckdd/i]\n\n# the positive lookahead is where the magic happens\nregex_guilty_terms = /(?=(#{Regexp.union(guilty_terms)}))/\nevidence = \"hackddangerhackdanger\"\n\n# just a squeezin'\n[].tap { |arr| evidence.scan(regex_guilty_terms) { |x| arr &lt;&lt; [$1, $~.begin(1)] } }\n# =&gt; [[\"hack\", 0], [\"ckdd\", 2], [\"danger\", 5], [\"hack\", 11], [\"danger\", 15]]\n</code></pre>\n\n<p>The position 13 is not printed because it's not actually a match, so... not sure how you'd get the expected results :)</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1476846265, "post_id": 40121376, "comment_id": 67513518, "body": "The desired result suggests that <code>evidence</code> should have a &quot;d&quot; before  &quot;danger&quot; at the end of the string, so I added that. That also causes the index to be off by one (16 rather than 15) for the last match."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1476846772, "last_edit_date": 1476846772, "creation_date": 1476846026, "answer_id": 40121376, "question_id": 40120358, "link": "https://stackoverflow.com/questions/40120358/search-string-returning-indexes-of-all-overlapping-occurrences-for-multiple-vari/40121376#40121376", "title": "Search string returning indexes of all overlapping occurrences for multiple variable length Ruby regular expressions", "body": "<p>You don't have to use a regex.</p>\n\n<pre><code>terms = %w| Danger hack ckdd |\n  #=&gt; [\"Danger\", \"hack\", \"ckdd\"]\nevidence = \"Hackddangerhackddanger\"\n\ndown_terms = terms.map(&amp;:downcase)\n  #=&gt; [\"danger\", \"hack\", \"ckdd\"] \ndown_evidence = evidence.downcase\n  #=&gt; \"hackddangerhackddanger\" \n\ndown_evidence.size.times.with_object([]) do |i,a|\n  w = down_terms.find { |w| down_evidence[i..-1].start_with?(w) }\n  a &lt;&lt; [w,i] unless w.nil?\nend\n  # =&gt; [[\"hack\",0], [\"ckdd\",2], [\"danger\",5], [\"hack\",11], [\"ckdd\",13], [\"danger\",16]] \n</code></pre>\n"}], "owner": {"reputation": 3360, "user_id": 3208553, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Tjyir.png?s=128&g=1", "display_name": "Luke Schoen", "link": "https://stackoverflow.com/users/3208553/luke-schoen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40121044, "answer_count": 2, "score": 1, "last_activity_date": 1476846772, "creation_date": 1476838405, "question_id": 40120358, "link": "https://stackoverflow.com/questions/40120358/search-string-returning-indexes-of-all-overlapping-occurrences-for-multiple-vari", "title": "Search string returning indexes of all overlapping occurrences for multiple variable length Ruby regular expressions", "body": "<p>I use the following code in Interactive Ruby (IRB) <code>$ irb</code> to search a string (i.e. <code>evidence</code>) and return an array of tuples (<code>guilty_term_indexes</code>). The second element of each tuple represents the character index in the <code>evidence</code> string where the first character of a <code>guilty_term</code> (stored in the first element of a tuple) has been found.</p>\n\n<pre><code>guilty_terms = [/danger/i, /hack/i, /ckdd/i]\nregex_guilty_terms = Regexp.union(guilty_terms)\nevidence = \"hackddangerhackdanger\"\nguilty_terms_and_indexes = []\nevidence.scan(regex_guilty_terms) do |index|\n    guilty_term = Regexp.last_match.offset(0)[0]\n    guilty_terms_and_indexes &lt;&lt; [index, guilty_term]\nend\np guilty_terms_and_indexes\n</code></pre>\n\n<p>I <strong>expected</strong> <code>guilty_terms_and_indexes</code> to return:\n<code>\n[[\"hack\", 0], [\"ckdd\", 2], [\"danger\", 5], [\"hack\", 11], [\"ckdd\", 13], [\"danger\", 15]]\n</code>\nBut instead it returns:\n<code>\n[[\"hack\", 0], [\"danger\", 5], [\"hack\", 11], [\"danger\", 15]]\n</code></p>\n\n<p>How can I get the <strong>expected</strong> results? </p>\n\n<h3>System</h3>\n\n<p><code>$ ruby -v</code>\n<code>ruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-darwin15]</code></p>\n"}, {"tags": ["ruby", "encryption", "3des"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1476843123, "post_id": 40120318, "comment_id": 67512849, "body": "&quot;3DES with ECB and no padding&quot;, wow, what a bad combination! Do not use 3DES unless it must be used for compatibility with a legacy system and the legacy system can not be changed. Do not use ECB mode, it is insecure, see <a href=\"https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29\" rel=\"nofollow noreferrer\">ECB mode</a>, scroll down to the Penguin. Use CBC with a random IV, prepend the IV to the encrypted data.  If the input data is not always a multiple of the block size then padding must be added to the input data; specify padding, PKCS#5 is the preferred padding for DES/3DES."}, {"owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1476843421, "post_id": 40120318, "comment_id": 67512926, "body": "Thanks for the comment.  I agree, and would not be doing it if it were avoidable."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1476847240, "post_id": 40120318, "comment_id": 67513740, "body": "Ah yes, actual security is not all that important, there always seem to be  excuses that take precedent."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "edited": false, "score": 0, "creation_date": 1476886098, "post_id": 40132350, "comment_id": 67537342, "body": "Thank you - it looks like this is it.  The confusion came from openssl zero-padding the remainder of the key, whereas the &quot;host&quot; implementation uses the strategy of repeating the first bytes."}, {"owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "edited": false, "score": 0, "creation_date": 1476886156, "post_id": 40132350, "comment_id": 67537387, "body": "I will let the &quot;host&quot; end of this interchange know that a lot of the security around this is pretty awful and hope I can get them to change.  And in the mean time, I learned a bunch about encryption yesterday."}], "tags": [], "owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "is_accepted": true, "score": 1, "last_activity_date": 1476883740, "last_edit_date": 1476883740, "creation_date": 1476882602, "answer_id": 40132350, "question_id": 40120318, "link": "https://stackoverflow.com/questions/40120318/decrypt-hex-strings-using-3des-in-ruby-from-net/40132350#40132350", "title": "Decrypt hex strings using 3DES in Ruby from .NET", "body": "<p>A 3DES key is 24-bytes, use a full length key.</p>\n\n<p>3DES uses triple encryption with essentially a 24-byte key. <code>202FA9B21843D7022B6466DB68327E1F</code> is hex encoded 16-byte key.</p>\n\n<p>Try repeating the first 8-bytes of the key:<br>\n<code>202FA9B21843D7022B6466DB68327E1F202FA9B21843D702</code></p>\n\n<p>Some 3DES implementations will repeat 8-bytes of a 16-byte key but relying on such implementation details is not a good idea.</p>\n\n<p>Note: 3DES actually uses a 168-bit key because the LSb of each byte is not used. Further because there are actually three DES calls the security is only 112-bits. Additionally DES has some weak keys. There are two common modes, ede and ded, in an effort to facilitate moving from DES to 3DES thus adding more confusion.</p>\n\n<p>Finally: Move from 3DES to AES in CBC mode with a random IV. Please don't continue poor security practices.</p>\n"}], "owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 40132350, "answer_count": 1, "score": 2, "last_activity_date": 1476883740, "creation_date": 1476838166, "question_id": 40120318, "link": "https://stackoverflow.com/questions/40120318/decrypt-hex-strings-using-3des-in-ruby-from-net", "title": "Decrypt hex strings using 3DES in Ruby from .NET", "body": "<p>I'm working on a Ruby project that is interacting with a webservice that I'm exchanging some encrypted data with.</p>\n\n<p>I am having a very hard time decrypting something I get back from the webservice in Ruby, although in the .NET side, it's working fine, and a number of other web-based or desktop-based tools can deal with this. </p>\n\n<p>The encryption method was 3DES with ECB and no padding.</p>\n\n<p>Below is a test script I have been working on.  I've tried everything I can think of to get these strings unpacked correctly, but to no avail.</p>\n\n<pre><code>require 'openssl'\nrequire 'base64'\n\ndef cipher(key, encrypted)\n  key = key.unpack('a2'*32).map{|x| x.hex}.pack('c'*32)\n  encrypted = encrypted.unpack('a2'*32).map{|x| x.hex}.pack('c'*32)\n  OpenSSL::Cipher::ciphers.select{|c| c.include? 'des3' }.map do |cipher_name|\n    begin\n      cipher = OpenSSL::Cipher.new(cipher_name)\n      cipher.padding = 0\n      cipher.decrypt\n      cipher.key=key\n\n      plain = cipher.update(encrypted) + cipher.final\n\n      p \"Cipher #{cipher_name} success: #{plain} #{plain.class} #{plain.length} #{plain.encoding.to_s}\"\n      plain\n    rescue =&gt; e\n      p \"Cipher #{cipher_name} failed #{e}\"\n      nil\n    end\n  end\n\nend\n\nkey = '202FA9B21843D7022B6466DB68327E1F'\nencrypted = 'ff6f07e270ebd5c0878c67c999d87ebf'\n\nres1 = cipher key, encrypted\n\nkey = '49CE85147B24123718AB3F4539AB1A21'\nencrypted = '995604ed8016da8897f1875ebd725529'\n\nres2 = cipher key, encrypted\n\n\np res1 == res2 ? \"SUCCESS\" : \"FAIL\"\n\n# In both cases, the correct output should be '25588015543912470222703296730936'\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JNpby.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/JNpby.png\" alt=\"BC-Tools Decryption\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4101, "user_id": 1482055, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/f4D9p.jpg?s=128&g=1", "display_name": "Milind", "link": "https://stackoverflow.com/users/1482055/milind"}, "edited": false, "score": 0, "creation_date": 1476838126, "post_id": 40120298, "comment_id": 67511675, "body": "Kindly post a question in a way that can be easily understandable by everyone....:) by adding more details in depth..."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476838227, "post_id": 40120298, "comment_id": 67511703, "body": "Hi and welcome to Stack Overflow. Have you read the truly-excellent Rails Guide that covers all the details of using Rails&#39; Query Interface? It will answer your question and also help you level up in Rails: <a href=\"http://guides.rubyonrails.org/active_record_querying.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/active_record_querying.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 5051165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GwtWi5OOBvs/AAAAAAAAAAI/AAAAAAAAfsg/kqASETNy-G4/photo.jpg?sz=128", "display_name": "Matt Welke", "link": "https://stackoverflow.com/users/5051165/matt-welke"}, "is_accepted": false, "score": 0, "last_activity_date": 1476840007, "last_edit_date": 1476840007, "creation_date": 1476839704, "answer_id": 40120520, "question_id": 40120298, "link": "https://stackoverflow.com/questions/40120298/pull-records-from-model-in-a-custom-order/40120520#40120520", "title": "Pull records from model in a custom order", "body": "<p>You could use ActiveRecord for this. You're already using it to get all the reviews for that particular app. You can go further and use:</p>\n\n<pre><code>@app.reviews.where(user_id == current_user.id)\n</code></pre>\n\n<p>where current_user was your user. The belongs_to and has_many calls put those ids in there for you to use.</p>\n\n<p>Since you plan to do this so that the current_user's reviews are ordered first, you could do these steps:</p>\n\n<ol>\n<li>Get all reviews for the app where the user_id != current_user.id, store in an array.</li>\n<li>Find the reviews for current_user, store in another array.</li>\n<li>Concatenate the two arrays with the current_user reviews first, yielding one array with all of the reviews for the app, but with the current_user reviews ordered first.</li>\n</ol>\n"}], "owner": {"reputation": 2192, "user_id": 5942579, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/o6P12.jpg?s=128&g=1", "display_name": "Emmanuel Mtali", "link": "https://stackoverflow.com/users/5942579/emmanuel-mtali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476840007, "creation_date": 1476837978, "question_id": 40120298, "link": "https://stackoverflow.com/questions/40120298/pull-records-from-model-in-a-custom-order", "title": "Pull records from model in a custom order", "body": "<p>I have an rails application with user, app and review models. When user visit app show page i am fetching all reviews for an app as <code>@app.reviews</code></p>\n\n<p>Associations . .</p>\n\n<p>User -> has_many :reviews, has_many :apps</p>\n\n<p>Review -> belongs_to :app, belongs_to :user</p>\n\n<p>App -> has_many :reviews, belong_to :user</p>\n\n<p>I would like to fetch all the reviews with the current_user review at the top/first. How can do it?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "is_accepted": false, "score": 0, "last_activity_date": 1476839338, "creation_date": 1476839338, "answer_id": 40120476, "question_id": 40120224, "link": "https://stackoverflow.com/questions/40120224/how-can-i-get-a-line-count-for-this-grep-command-need-number-only-not-all-inst/40120476#40120476", "title": "How can I get a line count for this grep command. Need number only, not all instances", "body": "<p>I believe that you can just use count:</p>\n\n<pre><code>p File.foreach('filename').grep(/word/).count\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7039404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a516d459c619b8915500fdbf8a76bd?s=128&d=identicon&r=PG&f=1", "display_name": "JorgeM", "link": "https://stackoverflow.com/users/7039404/jorgem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476843967, "creation_date": 1476837470, "last_edit_date": 1476843967, "question_id": 40120224, "link": "https://stackoverflow.com/questions/40120224/how-can-i-get-a-line-count-for-this-grep-command-need-number-only-not-all-inst", "title": "How can I get a line count for this grep command. Need number only, not all instances", "body": "<p>I want to get a number count of the instances that contain the words. Don't need for all of the lines to display.</p>\n\n<pre><code>puts File.foreach('filename').grep /word looking for/\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 306316, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89241163d6d4b217c0f64a00a46f3537?s=128&d=identicon&r=PG", "display_name": "alkaloids", "link": "https://stackoverflow.com/users/306316/alkaloids"}, "is_accepted": false, "score": 0, "last_activity_date": 1476840308, "creation_date": 1476840308, "answer_id": 40120587, "question_id": 40120034, "link": "https://stackoverflow.com/questions/40120034/ruby-writing-into-several-files-on-a-loop-does-not-give-expected-answer/40120587#40120587", "title": "Ruby writing into several files on a loop does not give expected answer", "body": "<p>That seems bananas.  I'm guessing you have a lingering reference to the file in some of the code that is omitted - it's hard to see with the current amount of code.</p>\n\n<p>When I read, write, read in a loop, I get what you would expect:</p>\n\n<pre><code>path = 'filename'\ntext = 'something'\n\n10.times {\n  p File.open(path, 'rb') { |file| file.read }\n\n  result = File.open(path, 'w+') do |f|\n    f.write text\n  end\n\n  p result\n\n  p File.open(path, 'rb') { |file| file.read }\n}\n</code></pre>\n\n<p>If you are certain you want to overwrite the file on each pass, then you should probably <a href=\"https://ruby-doc.org/core-2.1.4/File.html#method-c-delete\" rel=\"nofollow\">delete</a> the file each time through.</p>\n\n<p>Or give them different names... </p>\n\n<p>Maybe with more info I can be more helpful.</p>\n"}], "owner": {"reputation": 9, "user_id": 5365029, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ypw7Iv5d_Pk/AAAAAAAAAAI/AAAAAAAAABE/F74sWrNmNsQ/photo.jpg?sz=128", "display_name": "Joao Pedro de Medeiros Santos", "link": "https://stackoverflow.com/users/5365029/joao-pedro-de-medeiros-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1476840308, "creation_date": 1476835940, "question_id": 40120034, "link": "https://stackoverflow.com/questions/40120034/ruby-writing-into-several-files-on-a-loop-does-not-give-expected-answer", "title": "Ruby writing into several files on a loop does not give expected answer", "body": "<p>I have some ruby code that should execute and create some files with outputs in it. </p>\n\n<p>When i run the code a single time i don't have any problems at all, but when i try to run it on a loop the first file comes out with a normal output, but from the second file foward, they all follow a bizarre pattern. </p>\n\n<p>If i run it three times the first output comes normal, the second comes with the info of the first followed by the output it should have and the third one comes with the first and the second output first and then it's normal output.</p>\n\n<p>This is the code i use to read file:</p>\n\n<pre><code>File.open(path, 'rb') { |file| file.read }\n</code></pre>\n\n<p>This is the code i use to write on file:</p>\n\n<pre><code> File.open(path + '.txt', 'w') do |f|\n  f.write text\n end\n</code></pre>\n\n<p>This is a part of the code i'm using to run it multiple times:</p>\n\n<pre><code>while i &lt; 4 do\n    sample_path = \"#{path}/samples/sample#{i}.html.erb\"\n    controller_grabber.grab_controllers(sample_path)\n    answer_string = file_manager.read_file(\"#{path}/samples/sample#{i}_expected_answer.txt\").gsub(/\\s+/, \"\")\n    tool_answer = file_manager.read_file(\"#{path}/outputs/#{file_manager.get_file_name(sample_path)}_output.txt\").gsub(/\\s+/, \"\")\n    i += 1\nend\n</code></pre>\n\n<p>On grab_controllers i call write file once. I really have no idea what the cause might be, tried to create a new instance of controller_grabber and file_manager but it didn't worked</p>\n\n<p>Here is some example of the outputs i'm getting</p>\n\n<p>First expected result:</p>\n\n<pre><code>[name: Show, type: @otml_file]\n[name: Back, type: otml_files_path]\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[name: Show, type: @otml_file]\n[name: Back, type: otml_files_path]\n</code></pre>\n\n<p>Second expected result:</p>\n\n<pre><code>[name: Inicio, type: root_path]\n[name: Producto, type: productos_index_path]\n[name: Venta, type: venta_index_path]\n[name: Proveedor, type: proveedor_index_path]\n[name: Clientes, type: cliente_index_path]\n</code></pre>\n\n<p>Second result:</p>\n\n<pre><code>[name: Show, type: @otml_file]\n[name: Back, type: otml_files_path]\n[name: Inicio, type: root_path]\n[name: Producto, type: productos_index_path]\n[name: Venta, type: venta_index_path]\n[name: Proveedor, type: proveedor_index_path]\n[name: Clientes, type: cliente_index_path]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 1, "creation_date": 1476834428, "post_id": 40119666, "comment_id": 67510791, "body": "The <code>self.method(:method_1)</code> syntax should have worked just fine, but, only if <code>self</code> really has a <code>method_1</code> method, defined when the <code>method</code> method is called. For example, you can do that inside the <code>initialize</code> method, since that is also an instance method and <code>self</code> is an instance of your Parser class, but if you tried doing it in a class method, it&#39;s not going to work, since <code>method_1</code> is not also a class method."}], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 1246279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2533d5a4299cad329268e552c47fa8d?s=128&d=identicon&r=PG", "display_name": "philomory", "link": "https://stackoverflow.com/users/1246279/philomory"}, "edited": false, "score": 1, "creation_date": 1476834524, "post_id": 40119824, "comment_id": 67510819, "body": "Send will work fine, but the <code>method(:method_1)</code> option should also have worked, so something else may be going on."}], "tags": [], "owner": {"reputation": 1419, "user_id": 3953760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d0864178d8e61e4631091e9c772b86?s=128&d=identicon&r=PG&f=1", "display_name": "AJ Gregory", "link": "https://stackoverflow.com/users/3953760/aj-gregory"}, "is_accepted": false, "score": 0, "last_activity_date": 1476834365, "creation_date": 1476834365, "answer_id": 40119824, "question_id": 40119666, "link": "https://stackoverflow.com/questions/40119666/create-hash-of-instance-methods-references/40119824#40119824", "title": "Create hash of instance methods references", "body": "<p>The method you're looking for is <code>send</code>.</p>\n\n<p>Note that the values in your hash need to be symbols to be passed to <code>send</code>.</p>\n\n<pre><code>class Parser\n    def initialize(msg_id)\n        @my_methods = {1 =&gt; :method_1, 2 =&gt; :method_2, 3 =&gt; :method_3}\n        send(@my_methods[msg_id])\n    end\n\n    def method_1\n    end\n\n    def method_2\n    end\n\n    def method_3\n    end\nend\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.3.1/Object.html#method-i-send\" rel=\"nofollow\">Documentation here</a></p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1476871933, "post_id": 40124504, "comment_id": 67526506, "body": "at the moment of writing <code>While provided answer</code> there was only one answer by <b>AJ Gregory</b> :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476937775, "post_id": 40124504, "comment_id": 67560493, "body": "What about <code>def methods_map; Hash[methods(false).each.with_index(1).map (&amp;:reverse)]</code> (and removing your instance method <code>instance_methods</code>)?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476946056, "post_id": 40124504, "comment_id": 67563928, "body": "@CarySwoveland thx, actually also though about <code>methods(false)</code> sometime after giving this answer, but did not edit. Edited now!"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476949217, "post_id": 40124504, "comment_id": 67565793, "body": "@CarySwoveland I just realized, that <code>methods</code> won&#39;t work at all, since it returns a list of singleton_methods, when <code>false</code> passed as an argument.."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476950367, "post_id": 40124504, "comment_id": 67566510, "body": "It should be <code>methods(false)</code>, which is equivalent to <code>self.class.instance_methods(false)</code>. N&#39;est-ce pas?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476950528, "post_id": 40124504, "comment_id": 67566617, "body": "@CarySwoveland <code>class Foo; def bar; end end</code> and <code>Foo.instance_methods(false) == Foo.new.methods(false)</code> =&gt; <code>false</code>. Because <code>methods(false)</code> returns a list of object&#39;s singleton methods. <code>Foo.instance_methods(false)</code> =&gt; <code>[:bar]</code> and <code>Foo.new.methods(false)</code> =&gt; <code>[]</code>. And: <code>baz = Foo.new; def baz.qux;end</code>, <code>baz.methods(false)</code> =&gt; <code>[:qux]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1476977499, "post_id": 40124504, "comment_id": 67586214, "body": "Ah, I didn&#39;t know that, but good to know. So let&#39;s make that <code>Hash[self.class.instance_methods(false).each.with_index(1).m&zwnj;&#8203;ap(&amp;:reverse)]</code>."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1476949311, "last_edit_date": 1476949311, "creation_date": 1476860969, "answer_id": 40124504, "question_id": 40119666, "link": "https://stackoverflow.com/questions/40119666/create-hash-of-instance-methods-references/40124504#40124504", "title": "Create hash of instance methods references", "body": "<p>While provided answer would work fine, there are few \"minor\" issues with it:</p>\n\n<ol>\n<li>If there'd be tons of methods, hardcoding such hash would take time, and since it is not dynamic (because you have to update the hash manually each time new method is added to the class body) it is very error prone.</li>\n<li>Even though you are within the class, and technically have access to all methods defined with any visibility scope with implicit receiver (including <code>private</code> and <code>protected</code>), it is still a good practice to <em>only rely on public interface</em>, thus, I'd recommend to use <a href=\"http://ruby-doc.org/core-2.3.1/Object.html#method-i-public_send\" rel=\"nofollow\">Object#<code>public_send</code></a>.</li>\n</ol>\n\n<hr>\n\n<p>So here is what I would suggest (despite the fact I do not see how the idea of having such map would work in real life):</p>\n\n<pre><code>class Parser\n  def initialize(msg_id)\n    # generate a dynamic hash with keys starting with 1\n    # and ending with the size of the methods count\n    methods_map = Hash[(1..instance_methods.size).zip(instance_methods)]\n\n    # Use public_send to ensure, only public methods are accessed\n    public_send(methods_map[msg_id])\n  end\n\n  # create a method, which holds a list of all instance methods defined in the class\n  def instance_methods\n    self.class.instance_methods(false)\n  end\nend\n</code></pre>\n\n<p>After a quick thought I refactored it a bit, so that we hide the implementation of the mapping to <code>private</code> methods:</p>\n\n<pre><code>class Parser\n  def initialize(msg_id)\n    public_send(methods_map[msg_id])\n  end\n\n  # methods omitted\n\n  private\n\n  def methods_map # not methods_hash, because what we do is mapping\n    Hash[(1..instance_methods.size).zip(instance_methods)]\n    # or\n    # Hash[instance_methods.each.with_index(1).map(&amp;:reverse)]\n  end\n\n  def instance_methods\n    self.class.instance_methods(false)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 1, "last_activity_date": 1476866151, "creation_date": 1476866151, "answer_id": 40126160, "question_id": 40119666, "link": "https://stackoverflow.com/questions/40119666/create-hash-of-instance-methods-references/40126160#40126160", "title": "Create hash of instance methods references", "body": "<p>The simplest possible changes to fix your code are like this:</p>\n\n<pre><code>class Parser\n  def initialize(msg_id)\n    @my_methods = { 1 =&gt; method(:method_1), 2 =&gt; method(:method_2), 3 =&gt; method(:method_3) }\n    @my_methods[msg_id].()\n  end\n\n  def method_1; end\n  def method_2; end\n  def method_3; end\nend\n</code></pre>\n\n<p>I.e. use the <a href=\"http://ruby-doc.org/core/Object.html#method-i-method\" rel=\"nofollow\"><code>Object#method</code></a> method to get a <a href=\"http://ruby-doc.org/core/Method.html\" rel=\"nofollow\"><code>Method</code></a> object, and use the <a href=\"http://ruby-doc.org/core/Method.html#method-i-call\" rel=\"nofollow\"><code>Method#call</code></a> method to execute it.</p>\n\n<p>However, there are a few improvements we could make. For one, your <a href=\"http://ruby-doc.org/core/Hash.html\" rel=\"nofollow\"><code>Hash</code></a> associates <a href=\"http://ruby-doc.org/core/Integer.html\" rel=\"nofollow\"><code>Integer</code></a>s with values. But there is a better data structure which already does that: an <a href=\"http://ruby-doc.org/core/Array.html\" rel=\"nofollow\"><code>Array</code></a>. (Note: if your message IDs are not assigned sequentially, then a <code>Hash</code> is probably the right choice, but from the looks of your example, they are just <code>Integer</code>s counting up from <code>1</code>.)</p>\n\n<p>And secondly, hardcoding the methods inside the <code>Parser#initialize</code> method is probably not a good idea. There should be a declarative description of the protocol, i.e. the message IDs and their corresponding method names somewhere.</p>\n\n<pre><code>class Parser\n  # this will make your message IDs start at 0, though\n  PROTOCOL_MAPPING = [:method_1, :method_2, :method_3].freeze\n\n  def initialize(msg_id)\n    @my_methods = PROTOCOL_MAPPING.map(&amp;method(:method))\n    @my_methods[msg_id].()\n  end\n\n  def method_1; end\n  def method_2; end\n  def method_3; end\nend\n</code></pre>\n\n<p>Another possibility would be something like this:</p>\n\n<pre><code>class Parser\n  PROTOCOL_MAPPING = []\n\n  private_class_method def self.parser(name)\n    PROTOCOL_MAPPING &lt;&lt; name\n  end\n\n  def initialize(msg_id)\n    @my_methods = PROTOCOL_MAPPING.map(&amp;method(:method))\n    @my_methods[msg_id].()\n  end\n\n  parser def method_1; end\n  parser def method_2; end\n  parser def method_3; end\nend\n</code></pre>\n\n<p>Or maybe this:</p>\n\n<pre><code>class Parser\n  PROTOCOL_MAPPING = {}\n\n  private_class_method def self.parser(msg_id, name)\n    PROTOCOL_MAPPING[msg_id] = name\n  end\n\n  def initialize(msg_id)\n    @my_methods = PROTOCOL_MAPPING.map {|msg_id, name| [msg_id, method(name)] }.to_h.freeze\n    @my_methods[msg_id].()\n  end\n\n  parser 1, def method_1; end\n  parser 2, def method_2; end\n  parser 3, def method_3; end\nend\n</code></pre>\n"}], "owner": {"reputation": 7933, "user_id": 222421, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Zrns4.png?s=128&g=1", "display_name": "jramirez", "link": "https://stackoverflow.com/users/222421/jramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1476949311, "creation_date": 1476833241, "last_edit_date": 1476861767, "question_id": 40119666, "link": "https://stackoverflow.com/questions/40119666/create-hash-of-instance-methods-references", "title": "Create hash of instance methods references", "body": "<p>I have a class that can parse different types of messages and what I want to do is to create a hash that will use the msg type id as the keys and different instance methods as the values.</p>\n\n<p>Something like this:</p>\n\n<pre><code>class Parser\n    def initialize(msg_id)\n        @my_methods = {1 =&gt; method_1, 2 =&gt; method_2, 3 =&gt; method_3}\n        @my_methods[msg_id]()\n\n    end\n\n    def method_1\n    end\n\n    def method_2\n    end\n\n    def method_3\n    end end\n</code></pre>\n\n<p>I know it's possible, but I am not sure how to do it. I tried using the <code>self.method(:method_1)</code> as a value but I got an error saying that <code>method_1</code> is not defined. </p>\n\n<p>Thank you</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "rubygems", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 847, "user_id": 1482694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e4742341658d0f90de0b770fc4f01f?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1482694/sam"}, "edited": false, "score": 0, "creation_date": 1476970329, "post_id": 40119485, "comment_id": 67580333, "body": "In my experience rbuf_fill (read buffer filled up) can occur occasionally due to a block in network traffic / ports by ruby processes. A simple machine restart has fixed this for me mostly, so worth a try."}, {"owner": {"reputation": 65, "user_id": 5198459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3958baf0ee9af3c450fbb3ee2a2cbe54?s=128&d=identicon&r=PG&f=1", "display_name": "NinyaEvu", "link": "https://stackoverflow.com/users/5198459/ninyaevu"}, "reply_to_user": {"reputation": 847, "user_id": 1482694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e4742341658d0f90de0b770fc4f01f?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1482694/sam"}, "edited": false, "score": 0, "creation_date": 1477002320, "post_id": 40119485, "comment_id": 67599814, "body": "Thanks for the suggestion, it didn&#39;t budge though.  I actually re-wrote the whole thing in python now as I got frustrated."}], "answers": [{"tags": [], "owner": {"reputation": 1404, "user_id": 660274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a54677db31ef668a7148eb50b18eaaf?s=128&d=identicon&r=PG", "display_name": "Chawarong Songserm PMP", "link": "https://stackoverflow.com/users/660274/chawarong-songserm-pmp"}, "is_accepted": true, "score": 4, "last_activity_date": 1479962301, "creation_date": 1479962301, "answer_id": 40778145, "question_id": 40119485, "link": "https://stackoverflow.com/questions/40119485/protocol-rb153in-read-nonblock-end-of-file-reached-eoferror/40778145#40778145", "title": "protocol.rb:153:in `read_nonblock&#39;: end of file reached (EOFError)", "body": "<p>I have found the same error and I've upgraded chromedriver to version 2.25 (chromedriver_mac64.zip  2016-10-22 06:23:51 4.35MB).</p>\n\n<p>Now, it runs perfectly fine. </p>\n\n<p><a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></p>\n"}], "owner": {"reputation": 65, "user_id": 5198459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3958baf0ee9af3c450fbb3ee2a2cbe54?s=128&d=identicon&r=PG&f=1", "display_name": "NinyaEvu", "link": "https://stackoverflow.com/users/5198459/ninyaevu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "accepted_answer_id": 40778145, "answer_count": 1, "score": 4, "last_activity_date": 1479962301, "creation_date": 1476832131, "last_edit_date": 1476856097, "question_id": 40119485, "link": "https://stackoverflow.com/questions/40119485/protocol-rb153in-read-nonblock-end-of-file-reached-eoferror", "title": "protocol.rb:153:in `read_nonblock&#39;: end of file reached (EOFError)", "body": "<p>I'm having a problem with my ruby selenium-driver script that has been working fine up until recently. I can't think of any changes I've done to my environment that may have stopped it working.</p>\n\n<p><strong>Here's the code:</strong></p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'capybara'\nrequire 'selenium-webdriver'\nrequire 'pry'\nrequire 'capybara/dsl'\n\nCapybara.register_driver :chromedriver do |app|\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :chrome)\nend\n\nCapybara.current_driver = :chromedriver\n\nclass BulkDoAction\n  include Capybara::DSL\n\n  def initialize(file)\n    @value_ids = File.readlines file\n  end\n\n  def delete(value_id)\n\n    puts \"#{Time.now} -&gt; saving value=#{value_id}\"\n    visit \"https://www.url.com/#{value_id}/confirmSave\"\n\n    click_button \"Save\"\n    sleep 5.0\n  end\n\n  def run\n    visit 'https://www.url.com/login'\n\n    fill_in 'Email or Username', with: 'XXX'\n    fill_in 'password', with: 'XXX'\n    click_button \"Login\"\n    sleep 5.0\n\n    @value_ids.each_with_index do |val_id, idx|\n      puts \"Doing #{idx + 1} out of #{@value_ids.size}\"\n      delete val_id.to_i\n      sleep 3.0\n    end\n  end\nend\n\nBulkDoAction.new('test.txt').run\n</code></pre>\n\n<p>I've changed a few of the values, as there is sensitive information.</p>\n\n<p><strong>However, whenever I run this as:</strong></p>\n\n<p>./bulk.rb</p>\n\n<p><strong>I get the following exception:</strong></p>\n\n<pre><code>/usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/protocol.rb:153:in `read_nonblock': end of file reached (EOFError)\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/protocol.rb:153:in `rbuf_fill'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/protocol.rb:134:in `readuntil'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/protocol.rb:144:in `readline'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http/response.rb:39:in `read_status_line'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http/response.rb:28:in `read_new'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1414:in `block in transport_request'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1411:in `catch'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1411:in `transport_request'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1384:in `request'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1377:in `block in request'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:853:in `start'\n    from /usr/local/Cellar/ruby/2.2.3/lib/ruby/2.2.0/net/http.rb:1375:in `request'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/http/default.rb:103:in `response_for'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/http/default.rb:57:in `request'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/http/common.rb:59:in `call'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/bridge.rb:653:in `raw_execute'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/bridge.rb:124:in `create_session'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/remote/bridge.rb:88:in `initialize'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/chrome/bridge.rb:40:in `initialize'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/common/driver.rb:62:in `new'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver/common/driver.rb:62:in `for'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/selenium-webdriver-3.0.0/lib/selenium/webdriver.rb:82:in `for'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/capybara-2.10.1/lib/capybara/selenium/driver.rb:20:in `browser'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/capybara-2.10.1/lib/capybara/selenium/driver.rb:53:in `visit'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/capybara-2.10.1/lib/capybara/session.rb:240:in `visit'\n    from /usr/local/lib/ruby/gems/2.2.0/gems/capybara-2.10.1/lib/capybara/dsl.rb:52:in `block (2 levels) in &lt;module:DSL&gt;'\n    from ./bulk.rb:48:in `run'\n    from ./bulk.rb:63:in `&lt;main&gt;'\n</code></pre>\n\n<p>I get this when I run both the brew installed ruby, and force running the system ruby which is 2.0.0.</p>\n\n<p>I feel as there's something wrong with my gems and being read the script but I can't figure it out. </p>\n\n<p><strong>Here is my gem list:</strong></p>\n\n<pre><code>addressable (2.4.0)\narchive-zip (0.7.0)\nbigdecimal (1.2.6)\ncapybara (2.10.1)\nchildprocess (0.5.9)\nchromedriver-helper (1.0.0)\ncoderay (1.1.1)\nffi (1.9.14)\nio-console (0.4.3)\nio-like (0.3.0)\njson (1.8.1)\nmethod_source (0.8.2)\nmime-types (3.1)\nmime-types-data (3.2016.0521)\nmini_portile2 (2.1.0)\nminitest (5.4.3)\nmulti_json (1.12.1)\nnokogiri (1.6.8.1)\npower_assert (0.2.2)\npry (0.10.4)\npsych (2.0.8)\nrack (2.0.1)\nrack-test (0.6.3)\nrake (10.4.2)\nrdoc (4.2.0)\nrubyzip (1.2.0)\nselenium-webdriver (3.0.0)\nslop (3.6.0)\ntest-unit (3.0.8)\nwebdriver-firefox (0.0.15)\nwebsocket (1.2.3)\nxpath (2.0.0)\n</code></pre>\n\n<p>So just to clarify, I'm not even getting to the URL when chrome opens up, it is stuck on 'data;' and then it throws the exception in terminal.</p>\n\n<p>Nothing has changed with the script, so I think it's something to do with my environment.</p>\n\n<p>If anyone has any ideas I would be most grateful while I continue trying to figure it out!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "httparty"], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 12498105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdda8fd4e6bd1ca3abfbc60e9c77ea04?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/12498105/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1608819365, "creation_date": 1608819365, "answer_id": 65439489, "question_id": 40119207, "link": "https://stackoverflow.com/questions/40119207/accessing-the-filename-in-an-httparty-response/65439489#65439489", "title": "Accessing the filename in an HTTParty response?", "body": "<p>You don't want the filename. You can use CSV.parse instead.</p>\n<pre><code>csv_response = HTTParty.get('service.com/csv')\nCSV.parse(csv_response.body, headers: true) do |row|\n  # do something\nend\n</code></pre>\n<p>Remove the <code>headers: true</code> if your CSV doesn't have a header row.</p>\n"}], "owner": {"reputation": 163, "user_id": 4484661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNTdI.jpg?s=128&g=1", "display_name": "Quinn Stearns", "link": "https://stackoverflow.com/users/4484661/quinn-stearns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1608819365, "creation_date": 1476830133, "question_id": 40119207, "link": "https://stackoverflow.com/questions/40119207/accessing-the-filename-in-an-httparty-response", "title": "Accessing the filename in an HTTParty response?", "body": "<p>I am trying to parse the response from an api that has content type text/csv in a Ruby application. I am making the request using the HTTParty library. I know the filename is typically stored in the response headers under Content-Disposition, but HTTParty does not seem to be correctly parsing this particular header.</p>\n\n<p>My best attempt at a fix looks like:</p>\n\n<pre><code>csv_response = HTTParty.get('service.com/csv')\ncontent_disposition = CGI::parse(catalog_response.headers['Content-Disposition'])\n</code></pre>\n\n<p>This is where I'm stuck because CGI parse is returning a hash with the filename object containing a leading space and escaped quotes surrounding the filename like:</p>\n\n<pre><code>{' filename' =&gt; '\\\"file.csv\\\"'}\n</code></pre>\n\n<p>Am I parsing the response correctly? Is there a more reasonable way to access the filename using HTTParty?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "capybara"], "comments": [{"owner": {"reputation": 331, "user_id": 4940021, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/35K5c.jpg?s=128&g=1", "display_name": "Adebayo", "link": "https://stackoverflow.com/users/4940021/adebayo"}, "edited": false, "score": 0, "creation_date": 1476830660, "post_id": 40119155, "comment_id": 67509876, "body": "Have you tried using the xpath? Eg. <code>locate(&quot;&#47;&#47;[@id=&#39;overlay&#39;&quot;).find(&quot;&#47;&#47;h1&quot;).click</code>"}, {"owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "reply_to_user": {"reputation": 331, "user_id": 4940021, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/35K5c.jpg?s=128&g=1", "display_name": "Adebayo", "link": "https://stackoverflow.com/users/4940021/adebayo"}, "edited": false, "score": 0, "creation_date": 1476830743, "post_id": 40119155, "comment_id": 67509898, "body": "No. I just want to figure out why this isn&#39;t working. This is all but a &quot;hello world&quot; example, and it keeps failing."}], "answers": [{"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1476831219, "creation_date": 1476831219, "answer_id": 40119376, "question_id": 40119155, "link": "https://stackoverflow.com/questions/40119155/capybaraelementnotfound-error-super-simple-capybara-example-is-failing-and-i/40119376#40119376", "title": "Capybara::ElementNotFound error - Super simple Capybara example is failing and I have no clue as to why", "body": "<p>It's failing because you're not calling click_link on the session where you visited a URL.  By including Capybara::DSL you've made all of Capybaras methods available on the object, and when you call <code>click_link</code> you are actually calling <code>Capybara.current_session.click_link</code>.  However you've created your own session which isn't Capybara.current_session, so you either need to let Capybara manage the session (which in your use case probably won't work well since it seems like you want a session per class instance)</p>\n\n<pre><code>visit 'www.cnn.com'\nclick_link 'Entertainment'\n</code></pre>\n\n<p>or don't include Capybara::DSL and instead manage you're own session per class instance like you are doing and call the methods on the session</p>\n\n<pre><code>session = Capybara::Session.new(:selenium)\nsession.visit \"https://www.cnn.com\"\nsession.click_link 'Entertainment'\n</code></pre>\n\n<p>see <a href=\"https://github.com/jnicklas/capybara#using-sessions\" rel=\"nofollow\">https://github.com/jnicklas/capybara#using-sessions</a></p>\n"}], "owner": {"reputation": 1033, "user_id": 1775716, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7d7cfafc64f5bda01194708412fc5f97?s=128&d=identicon&r=PG&f=1", "display_name": "Michael P.", "link": "https://stackoverflow.com/users/1775716/michael-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476831219, "creation_date": 1476829869, "question_id": 40119155, "link": "https://stackoverflow.com/questions/40119155/capybaraelementnotfound-error-super-simple-capybara-example-is-failing-and-i", "title": "Capybara::ElementNotFound error - Super simple Capybara example is failing and I have no clue as to why", "body": "<p>Here's my code. I've been messing around with this for 1.5 hours and have yet to get Capybara to click a link without the ElementNotFound error. Visiting the site works as expected, but clicking links, filling in forms--really, interacting with the DOM in any fashion--fails. Any help would be greatly appreciated.</p>\n\n<pre><code>require 'capybara'\nrequire 'capybara/dsl'\n\nclass Prowler\n  include Capybara::DSL\n\n  def initialize\n    Capybara.run_server = false\n        Capybara.default_driver = :selenium\n  end\n\n  def visitSite\n    session = Capybara::Session.new(:selenium)\n    session.visit \"https://www.cnn.com\"\n    click_link 'Entertainment'\n  end\nend\n\nprowler = Prowler.new\nprowler.visitSite\n</code></pre>\n"}, {"tags": ["ruby", "shell", "command-line"], "comments": [{"owner": {"reputation": 343, "user_id": 6817726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97420bbf5c3f2d922f097835c0c1c35?s=128&d=identicon&r=PG&f=1", "display_name": "galra", "link": "https://stackoverflow.com/users/6817726/galra"}, "edited": false, "score": 0, "creation_date": 1476897363, "post_id": 40119141, "comment_id": 67545040, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8175007/executing-shell-command-from-ruby-using-the-same-shell-process\">Executing shell command from ruby using the same shell process</a>"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 6817726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97420bbf5c3f2d922f097835c0c1c35?s=128&d=identicon&r=PG&f=1", "display_name": "galra", "link": "https://stackoverflow.com/users/6817726/galra"}, "reply_to_user": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "edited": false, "score": 0, "creation_date": 1476885228, "post_id": 40119272, "comment_id": 67536612, "body": "I have no computer available at the moment, but you can find an example here: <a href=\"https://coderwall.com/p/etxnsg/handling-sub-processes-in-ruby\" rel=\"nofollow noreferrer\">coderwall.com/p/etxnsg/handling-sub-processes-in-ruby</a>"}, {"owner": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "edited": false, "score": 0, "creation_date": 1476890255, "post_id": 40119272, "comment_id": 67540730, "body": "It seems like running a thread, I need a way to keep the state of running a terminal (backticks run in a different PID for every call) ."}, {"owner": {"reputation": 343, "user_id": 6817726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97420bbf5c3f2d922f097835c0c1c35?s=128&d=identicon&r=PG&f=1", "display_name": "galra", "link": "https://stackoverflow.com/users/6817726/galra"}, "reply_to_user": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "edited": false, "score": 0, "creation_date": 1476893970, "post_id": 40119272, "comment_id": 67543173, "body": "Check the link I&#39;ve attached. They aren&#39;t using backticks, they open a subprocess AND HOLD IT."}, {"owner": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "edited": false, "score": 0, "creation_date": 1476999673, "post_id": 40119272, "comment_id": 67598796, "body": "I can&#39;t seem to get it working with the command prompt in Windows, how should I do that?"}], "tags": [], "owner": {"reputation": 343, "user_id": 6817726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97420bbf5c3f2d922f097835c0c1c35?s=128&d=identicon&r=PG&f=1", "display_name": "galra", "link": "https://stackoverflow.com/users/6817726/galra"}, "is_accepted": false, "score": 1, "last_activity_date": 1476830440, "creation_date": 1476830440, "answer_id": 40119272, "question_id": 40119141, "link": "https://stackoverflow.com/questions/40119141/run-multiple-commands-in-same-process-in-ruby/40119272#40119272", "title": "Run multiple commands in same process in Ruby", "body": "<p>Open a shell subprocess with popen, and save the handle. Run all your commands in this shell.\nYou can have it as a singleton, if it should be accessible from anywhere within the program.</p>\n"}], "owner": {"reputation": 351, "user_id": 3878329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EHSxC.png?s=128&g=1", "display_name": "Peter Zhu", "link": "https://stackoverflow.com/users/3878329/peter-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1476830440, "creation_date": 1476829797, "question_id": 40119141, "link": "https://stackoverflow.com/questions/40119141/run-multiple-commands-in-same-process-in-ruby", "title": "Run multiple commands in same process in Ruby", "body": "<p>How can I run multiple commands in the same process in Ruby? For example, I should be able to run the command <code>set TEMP=T</code> on Windows and when ran the command <code>echo %TEMP%</code> later get a result of <code>T</code>. The solution should be system independent.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actionmailer", "database-cleaner"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476830206, "post_id": 40119113, "comment_id": 67509758, "body": "1) How do you know for sure that it&#39;s a problem with <code>database_cleaner</code>?  2) Have you tried clearing all deliveries at the beginning of just this spec, to be sure there&#39;s not something weird going on?"}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 5822806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c163588fe782ff5c78200a1b05506cd1?s=128&d=identicon&r=PG&f=1", "display_name": "n.milsht", "link": "https://stackoverflow.com/users/5822806/n-milsht"}, "is_accepted": false, "score": 0, "last_activity_date": 1476831291, "creation_date": 1476831291, "answer_id": 40119386, "question_id": 40119113, "link": "https://stackoverflow.com/questions/40119113/rails-capybara-test-failing-due-to-database-cleaner-malfunction/40119386#40119386", "title": "Rails capybara test failing due to database_cleaner malfunction", "body": "<p>I believe I solved this by changing the test.</p>\n\n<pre><code>scenario \"is coach, signs up, email not in const, requests admin status\" do\n  user_sign_in(user1)\n  visit my_profile_users_path\n  click_button \"Request Admin Status\"\n\n  expect(ActionMailer::Base.deliveries.last.subject).to have_content(\"#{user1.username} requested admin\")\nend\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 5822806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c163588fe782ff5c78200a1b05506cd1?s=128&d=identicon&r=PG&f=1", "display_name": "n.milsht", "link": "https://stackoverflow.com/users/5822806/n-milsht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476831291, "creation_date": 1476829658, "question_id": 40119113, "link": "https://stackoverflow.com/questions/40119113/rails-capybara-test-failing-due-to-database-cleaner-malfunction", "title": "Rails capybara test failing due to database_cleaner malfunction", "body": "<p>I have <code>database_cleaner</code> installed and functioning for all my tests except when it encounters this...</p>\n\n<pre><code>scenario \"is coach, signs up, email not in const, requests admin status\" do\n  user_sign_in(user1)\n  visit my_profile_users_path\n  click_button \"Request Admin Status\"\n\n  expect(ActionMailer::Base.deliveries.count).to eq(1)\nend\n</code></pre>\n\n<p>Rails returns \n    Failure/Error: expect(ActionMailer::Base.deliveries.count).to eq(1)\n       expected: 1\n            got: 137\n       (compared using ==)</p>\n\n<p>Not sure why database cleaner fails on this one instance or how to fix it. Any help would be appreciated. </p>\n\n<h1>Gemfile.rb</h1>\n\n<pre><code>group :test do\n  gem 'coveralls', require: false\n  gem 'database_cleaner'\n  gem 'launchy', require: false\nend\n</code></pre>\n\n<h1>spec/support/database_cleaner.rb</h1>\n\n<pre><code># frozen_string_literal: true\n\nRSpec.configure do |config|\n\n  config.before(:each) do\n    DatabaseCleaner.clean_with(:truncation)\n  end\n\n  config.before(:each) do\n    DatabaseCleaner.strategy = :truncation\n  end\n\n  config.before(:each, js: true) do\n    DatabaseCleaner.strategy = :truncation\n  end\n\n  config.before(:each) do\n    DatabaseCleaner.start\n  end\n\n  config.after(:each) do\n    DatabaseCleaner.clean\n  end\n\n  config.after(:each) do\n  end\nend\n</code></pre>\n\n<h1>rails_helper.rb</h1>\n\n<pre><code>require 'spec_helper'\nrequire 'rspec/rails'\nrequire_relative \"../spec/support/database_cleaner\"\n</code></pre>\n\n<h1>spec_helper.rb</h1>\n\n<pre><code>require 'database_cleaner'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord", "rails-activerecord"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476832310, "post_id": 40119051, "comment_id": 67510280, "body": "Have a look at the sql generated by this query using eg <code>Product.published.to_sql</code> (edit your question and add the result there so we can all see it) :) You can often figure out why the SQL is wrong, then backport the fix you need to the ruby scope."}, {"owner": {"reputation": 119, "user_id": 604805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264ec9f46e09397ecfa443bc784d6620?s=128&d=identicon&r=PG", "display_name": "Kenn", "link": "https://stackoverflow.com/users/604805/kenn"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 1, "creation_date": 1476905485, "post_id": 40119051, "comment_id": 67549878, "body": "Good idea @TarynEast, thanks. I&#39;ve added the generated SQL which I did check previously, but I haven&#39;t really wrapped my head around joins so it didn&#39;t help me see the problem."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 604805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264ec9f46e09397ecfa443bc784d6620?s=128&d=identicon&r=PG", "display_name": "Kenn", "link": "https://stackoverflow.com/users/604805/kenn"}, "edited": false, "score": 0, "creation_date": 1476905846, "post_id": 40119815, "comment_id": 67550095, "body": "This did it, thanks! I clearly need to learn more actual SQL."}], "tags": [], "owner": {"reputation": 86, "user_id": 7039240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3feb8ac9b9e2661ce4376e4a8d97e7?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Coniglio", "link": "https://stackoverflow.com/users/7039240/mauricio-coniglio"}, "is_accepted": true, "score": 4, "last_activity_date": 1476834292, "creation_date": 1476834292, "answer_id": 40119815, "question_id": 40119051, "link": "https://stackoverflow.com/questions/40119051/creating-activerecord-scope-with-multiple-conditionals/40119815#40119815", "title": "Creating ActiveRecord scope with multiple conditionals", "body": "<p>The problem is that you are using <code>joins(:issue)</code>. That method does an <code>INNER JOIN</code> between <code>products</code> and <code>issues</code> tables and discards all the products that doesn't have an issue_id. Maybe you could use <code>LEFT JOIN</code> so you can keep all the products regardless they have an issue.</p>\n\n<pre><code>scope :published, -&gt; {\n    joins('LEFT JOIN issues ON issues.id = products.issue_id')\n    .select('products.*')\n    .reorder('products.created_at ASC, products.number ASC')\n    .where('products.status = ?', Product.statuses[:available])\n    .where('issues.status = ? OR products.issue_id IS NULL', Issue.statuses[:published])\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 604805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264ec9f46e09397ecfa443bc784d6620?s=128&d=identicon&r=PG", "display_name": "Kenn", "link": "https://stackoverflow.com/users/604805/kenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 40119815, "answer_count": 1, "score": 3, "last_activity_date": 1476905349, "creation_date": 1476829341, "last_edit_date": 1476905349, "question_id": 40119051, "link": "https://stackoverflow.com/questions/40119051/creating-activerecord-scope-with-multiple-conditionals", "title": "Creating ActiveRecord scope with multiple conditionals", "body": "<p>I have a Rails application with a number of Products, some of which are associated with an Issue model. Some of these products have an issue_id (so an Issue <code>has_many</code> products) and some do not. The products <em>without</em> an issue ID are a new addition I'm working on.</p>\n\n<p>I previously had a named scope so that I can list products using <code>Product.published</code>, which looks like this:</p>\n\n<pre><code>scope :published, -&gt; {\n    joins(:issue).reorder('products.created_at ASC, products.number ASC')\n    .where('products.status = ?', Product.statuses[:available])\n    .where('issues.status = ?', Issue.statuses[:published])\n}\n</code></pre>\n\n<p>The result of this is that I can find only products that are associated with a published issue (think magazine issue).</p>\n\n<p>I'm now adding products that will not be associated with a particular issue but will still have a draft/available state. The above scope does not find these products, as it looks for an issue_id that does not exist. </p>\n\n<p>I thought I could modify the scope like this, adding the <code>OR issue_id IS NULL</code> part in the last line:</p>\n\n<pre><code>scope :published, -&gt; {\n    joins(:issue).reorder('products.created_at ASC, products.number ASC')\n    .where('products.status = ?', Product.statuses[:available])\n    .where('issues.status = ? OR issue_id IS NULL', Issue.statuses[:published])\n}\n</code></pre>\n\n<p>But this doesn't work. I still only get 'available' products associated with a 'published' issue. The products without an issue_id are not included in the returned collection.</p>\n\n<p>(There is a window in which a product will be set to <em>available</em> before its associated issue is published, so for these situations I do need to check the status of both records.)</p>\n\n<p>Here's the SQL generated by the above (wrapped for readability):</p>\n\n<pre><code>pry(main)&gt; Product.published.to_sql\n=&gt; \"SELECT `products`.* FROM `products` INNER JOIN `issues` ON `issues`.`id` = \n`products`.`issue_id` WHERE (products.status = 1) AND (issues.status = 1 OR \nissue_id IS NULL)  ORDER BY products.created_at ASC, products.number ASC\"\n</code></pre>\n\n<p>I've already created a Product class method that takes an argument as an alternate approach but doesn't work in all cases because I'm often looking up a product based on the ID without knowing in advance whether there's an Issue association or not (eg, for the product's <em>show</em> view).</p>\n\n<p>Also, <code>Product.published</code> is nice and concise and the alternative is to load all published products (eg, <code>Product.where(:status =&gt; :published)</code>) and then iterate through to remove those associated with a not-yet-published issue in a second operation.</p>\n\n<p>I feel like there's something I'm not quite grasping about doing more complex queries within a scope. My ideal outcome is a modified scope that can return available products, both with and without an issue, and without supplying an argument.</p>\n\n<p>Is this possible, or should I resign myself to finding an alternate approach now that I'm adding these unassociated products?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": false, "score": 1, "last_activity_date": 1476829545, "creation_date": 1476829545, "answer_id": 40119087, "question_id": 40118959, "link": "https://stackoverflow.com/questions/40118959/display-results-of-a-query-in-a-table-in-rails-application/40119087#40119087", "title": "Display results of a query in a table in rails application", "body": "<p>Ok, it's displaying as it is because you are displaying the whole class, not an actual detail of the instance.</p>\n\n<p>In this case below, you are selecting a whole set of Ingredients (the set contains only one ingredient, but it will always return a set):</p>\n\n<pre><code>Ingredient.select('recipe_unit').where(:id =&gt; @ingredient_id)\n</code></pre>\n\n<p>What you probably want is something like this:</p>\n\n<pre><code>Ingredient.find(@ingredient_id).recipe_unit\n</code></pre>\n\n<p>The differences:</p>\n\n<ol>\n<li>where always returns a set of items (even if there's just one item in the set) What is returned is not an ingredient, but an Active Relation. To just return one ingredient, you need to use <code>find</code> or <code>first</code> (or a similar such method).</li>\n<li><code>select</code> just tells Rails what to pull out of the db... it doesn't tell the template what to display in the template. It says \"only fetch the <code>recipe_unit</code> column from the db\" it doesn't say <code>and then output the</code>recipe_unit<code>column</code> - for that you need to actually call the <code>recipe_unit</code> method on the ingredient (as in the example I gave). </li>\n</ol>\n\n<p>Note that you have the same problem with <code>recipe_ingredient.item</code>\nWhat column from an item do you want to display? does it have a <code>name</code> or a <code>description</code> if so - you need to actually call that eg:</p>\n\n<pre><code>&lt;%= recipe_ingredient.item.name %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2893, "user_id": 511374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b92928f3f39951cc97dc02a59fbb117?s=128&d=identicon&r=PG", "display_name": "Sergey Moiseev", "link": "https://stackoverflow.com/users/511374/sergey-moiseev"}, "is_accepted": false, "score": 1, "last_activity_date": 1476829846, "creation_date": 1476829846, "answer_id": 40119153, "question_id": 40118959, "link": "https://stackoverflow.com/questions/40118959/display-results-of-a-query-in-a-table-in-rails-application/40119153#40119153", "title": "Display results of a query in a table in rails application", "body": "<p>First of all, you may omit <code>:class_name</code> and <code>:foreign_key</code> from your models because of <a href=\"http://guides.rubyonrails.org/active_record_basics.html#convention-over-configuration-in-active-record\" rel=\"nofollow\">convention over configuration</a> - your models are named exactly like classes and foreign keys you list. </p>\n\n<p>As for your question, you need to use <a href=\"http://blog.hasmanythrough.com/2012/1/4/yak-shaving\" rel=\"nofollow\">yak shaving</a> for that:</p>\n\n<pre><code>recipe_ingredient.ingredient.recipe_unit\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3288, "user_id": 5781737, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/86ad144d764093a50390bb9c6fe95b86?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5781737/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1476836354, "creation_date": 1476836354, "answer_id": 40120084, "question_id": 40118959, "link": "https://stackoverflow.com/questions/40118959/display-results-of-a-query-in-a-table-in-rails-application/40120084#40120084", "title": "Display results of a query in a table in rails application", "body": "<p>You can simply type the following:</p>\n\n<pre><code>recipe_ingredient.ingredient.recipe_unit\n</code></pre>\n\n<h3>Why is this possible?</h3>\n\n<p>Since a <code>RecipeIngredient</code> belongs_to an <code>Ingredient</code>, you can access the <code>Ingredient</code> of a <code>RecipeIngredient</code> as if it was any other field like this:</p>\n\n<pre><code>recipe_ingredient.ingredient\n</code></pre>\n\n<p>Once you have the ingredient, you can pull the recipe_unit directly by typing:</p>\n\n<pre><code>recipe_ingredient.ingredient.recipe_unit\n</code></pre>\n\n<h3>Side note:</h3>\n\n<p>You can omit the <code>:class_name</code> and <code>:foreign_key</code> hashes from your associativity rules in your model classes. For example, take this class:</p>\n\n<pre><code>class Student &lt; ActiveRecord::Base\n  belongs_to Course\nend\n</code></pre>\n\n<p>By convention, rails will associate the Student class with the Course class. Rails will look for a column in the \"students\" database table labeled \"course_id\", and if \"course_id\" exists as a column in the table, Rails will automatically use that field as the foreign key for Student. You can use the <code>:foreign_key =&gt; 'some_key'</code> notation when you want to override the default conventions in rails (which isn't recommended unless its strictly necessary). </p>\n\n<p>For more reading on the subject of active record migrations and foreign key associations, you can check out the <a href=\"http://guides.rubyonrails.org/association_basics.html\" rel=\"nofollow\">rails docs</a>.</p>\n"}], "owner": {"reputation": 177, "user_id": 6900160, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OMZbu.jpg?s=128&g=1", "display_name": "Parry", "link": "https://stackoverflow.com/users/6900160/parry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 40120084, "answer_count": 3, "score": 1, "last_activity_date": 1476836354, "creation_date": 1476828742, "last_edit_date": 1476829271, "question_id": 40118959, "link": "https://stackoverflow.com/questions/40118959/display-results-of-a-query-in-a-table-in-rails-application", "title": "Display results of a query in a table in rails application", "body": "<p>I have 3 models as below.</p>\n\n<p>Model for Item</p>\n\n<pre><code>class Item &lt; ApplicationRecord\n    belongs_to :item_type, :class_name=&gt;ItemType, :foreign_key=&gt;\"item_type_id\"\nend\n</code></pre>\n\n<p>and Model for Ingredients</p>\n\n<pre><code>class Ingredient &lt; ApplicationRecord\n    validates_presence_of :ingredient, :message=&gt;\"name cannot be blank!\"\nend\n</code></pre>\n\n<p>and model for recipe_ingredients</p>\n\n<pre><code>class RecipeIngredient &lt; ApplicationRecord\n  belongs_to :item, :class_name=&gt;Item, :foreign_key=&gt;\"item_id\"\n  belongs_to :ingredient, :class_name=&gt;Ingredient, :foreign_key=&gt;\"ingredient_id\"\n  validates_numericality_of :quantity\nend\n</code></pre>\n\n<hr>\n\n<p>The table for ingredients has following columns</p>\n\n<pre><code>\"id\" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,\n\"ingredient\" varchar, \n\"inventory_unit\" varchar, \n\"recipe_unit\" varchar, \n\"created_at\" datetime NOT NULL, \n\"updated_at\" datetime NOT NULL\n</code></pre>\n\n<hr>\n\n<p>The view for index of recipe ingredients is as below. The ingredients are appearing in the view. I want to pull recipe unit from ingredients table for the selected ingredient and display it in the table. I have tried it doing a query. The code is as below.</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;h1&gt;Recipe Ingredients&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;Item&lt;/th&gt;\n      &lt;th&gt;Ingredient&lt;/th&gt;\n      &lt;th&gt;Quantity&lt;/th&gt;\n      &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n\n  &lt;tbody&gt;\n    &lt;% @recipe_ingredients.each do |recipe_ingredient| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.item %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.ingredient.ingredient %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= recipe_ingredient.quantity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= Ingredient.select('recipe_unit').where(:id =&gt; @ingredient_id) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Show', recipe_ingredient %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Edit', edit_recipe_ingredient_path(recipe_ingredient) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= link_to 'Destroy', recipe_ingredient, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;br&gt;\n\n&lt;%= link_to 'New Recipe Ingredient', new_recipe_ingredient_path %&gt;\n</code></pre>\n\n<hr>\n\n<p>But the output I am getting is as shown in image given below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9mvpj.jpg\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/9mvpj.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "github", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1476828074, "post_id": 40118288, "comment_id": 67509081, "body": "This is, unfortunately, the best approach unless you can get that dependency resolved by the original author."}], "tags": [], "owner": {"reputation": 87, "user_id": 6771806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a313da5c7a8a9d167ce259cabf9a6a4a?s=128&d=identicon&r=PG", "display_name": "rudkovskyi", "link": "https://stackoverflow.com/users/6771806/rudkovskyi"}, "is_accepted": true, "score": 4, "last_activity_date": 1476825690, "creation_date": 1476825690, "answer_id": 40118288, "question_id": 40118206, "link": "https://stackoverflow.com/questions/40118206/whats-the-easiest-way-to-edit-a-dependency-in-a-gem-stored-on-github/40118288#40118288", "title": "What&#39;s the easiest way to edit a dependency in a gem stored on GitHub", "body": "<p>You can fork it, modify the <code>gemspec</code> by changing the version of dependency and after that to install this gem in your app by defining </p>\n\n<p><code>gem 'your_gem', :git =&gt; 'git://github.com/your_name/your_gem.git</code></p>\n"}], "owner": {"reputation": 729, "user_id": 5655756, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005069719213/picture?type=large", "display_name": "Catalin", "link": "https://stackoverflow.com/users/5655756/catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 40118288, "answer_count": 1, "score": 0, "last_activity_date": 1476825690, "creation_date": 1476825384, "question_id": 40118206, "link": "https://stackoverflow.com/questions/40118206/whats-the-easiest-way-to-edit-a-dependency-in-a-gem-stored-on-github", "title": "What&#39;s the easiest way to edit a dependency in a gem stored on GitHub", "body": "<p>I'm trying to install a <code>gem</code> from GitHub, but in the gemspec a dependency version makes installing the gem impossible. All I need is to edit that version.</p>\n\n<p>What's the easiest way of doing this so I can make the gem usable in my app ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails", "stubbing"], "comments": [{"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476824964, "post_id": 40118038, "comment_id": 67507814, "body": "Can you show us the relevant route? (both in your routes file and via rake routes)"}, {"owner": {"reputation": 1013, "user_id": 1291865, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96a04043b6f48df133821e828623e04d?s=128&d=identicon&r=PG", "display_name": "Betjamin Richards", "link": "https://stackoverflow.com/users/1291865/betjamin-richards"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476866124, "post_id": 40118038, "comment_id": 67522350, "body": "@TarynEast As I stated above, you can call <code>link_to</code> without passing in a path. It then tries to deduce your current path itself. It works fine in practice, but when testing via rspec (and therefore without a current controller) it throws this error."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476907808, "post_id": 40118038, "comment_id": 67551214, "body": "As I stated above... (BTW that&#39;s an awful phrase probably you shouldn&#39;t use it) - can you please show us the route of the original page... because that will help us determine what params it expect and what is causing it to break :) and yes, without a current controller - it likely will simply not work - why is there no current controller in your spec?."}, {"owner": {"reputation": 1013, "user_id": 1291865, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96a04043b6f48df133821e828623e04d?s=128&d=identicon&r=PG", "display_name": "Betjamin Richards", "link": "https://stackoverflow.com/users/1291865/betjamin-richards"}, "reply_to_user": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 1, "creation_date": 1476950629, "post_id": 40118038, "comment_id": 67566672, "body": "@TarynEast - haha..thank you. It wasn&#39;t meant to come out like that, but now you&#39;ve pointed it out I can see what you mean. It&#39;s in a helper so it&#39;s used in many pages (controller actions) across the site. You ask <code>why is there no current controller in your spec?</code> how do you define a current controller in a helper spec?"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1476996080, "post_id": 40118038, "comment_id": 67597120, "body": "oh in a helper spec - yeah I think I missed that part - I was thinking of this being tested in a controller spec for some reason :) Sorry - my brain-fart, pls ignore. There might be a way of designating a controller for the sake of the spec, but yeah I don&#39;t know it."}], "answers": [{"tags": [], "owner": {"reputation": 2500, "user_id": 1431800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef52069ce1a561e10feef902e0346ae2?s=128&d=identicon&r=PG&f=1", "display_name": "newdark-it", "link": "https://stackoverflow.com/users/1431800/newdark-it"}, "is_accepted": false, "score": 2, "last_activity_date": 1486669149, "last_edit_date": 1495539923, "creation_date": 1486669149, "answer_id": 42145406, "question_id": 40118038, "link": "https://stackoverflow.com/questions/40118038/testing-link-to-without-path-in-helper-using-rspec/42145406#42145406", "title": "Testing link_to without path in helper using Rspec", "body": "<p>This is a dirty trick if you are using params like above.</p>\n\n<pre><code>allow(helper).to receive(:params).and_return(_recall: { controller: 'homes' })\n</code></pre>\n\n<p>Also here is another way to do it that is a quick way to get the job done.</p>\n\n<p><a href=\"https://stackoverflow.com/a/22265920/1431800\">https://stackoverflow.com/a/22265920/1431800</a></p>\n"}], "owner": {"reputation": 1013, "user_id": 1291865, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96a04043b6f48df133821e828623e04d?s=128&d=identicon&r=PG", "display_name": "Betjamin Richards", "link": "https://stackoverflow.com/users/1291865/betjamin-richards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486669149, "creation_date": 1476824655, "question_id": 40118038, "link": "https://stackoverflow.com/questions/40118038/testing-link-to-without-path-in-helper-using-rspec", "title": "Testing link_to without path in helper using Rspec", "body": "<p>Using the tip <a href=\"http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to#32-Link-to-same-URL-with-different-format\" rel=\"nofollow\">here</a> I have built a method in a helper module like so:</p>\n\n<pre><code>describe ExampleHelper do\n  def build_link\n    link_to \"RSS feed\", params.merge(:format =&gt; :rss), :class =&gt; \"feed_link\"\n  end\nend\n</code></pre>\n\n<p>However, when I test this method I get the following error:</p>\n\n<pre><code> Failure/Error: subject { helper.build_link }\n ActionController::UrlGenerationError:\n   No route matches {:action=&gt;\"index\", :foo=&gt;\"bah\", :foobah=&gt;[\"1\", \"2\", \"3\"], :results_per_page=&gt;\"25\"}\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionpack-4.2.6/lib/action_dispatch/journey/formatter.rb:46:in `generate'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionpack-4.2.6/lib/action_dispatch/routing/route_set.rb:721:in `generate'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionpack-4.2.6/lib/action_dispatch/routing/route_set.rb:752:in `generate'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionpack-4.2.6/lib/action_dispatch/routing/route_set.rb:799:in `url_for'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionpack-4.2.6/lib/action_dispatch/routing/url_for.rb:156:in `url_for'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionview-4.2.6/lib/action_view/routing_url_for.rb:94:in `url_for'\n # /Users/tombrammar/.rvm/gems/ruby-2.1.10@example/gems/actionview-4.2.6/lib/action_view/helpers/url_helper.rb:181:in `link_to'\n</code></pre>\n\n<p>It seems that because I'm testing within the helper it can't determine what controller to use and therefore how to build the url.</p>\n\n<p>Can anyone help me understand how to fix this? I.e. perhaps I can stub the controller the helper rspec?</p>\n"}]