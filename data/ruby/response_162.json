[{"tags": ["ruby", "encryption", "amazon-s3", "gnupg", "gpgme"], "comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1518966140, "post_id": 48797735, "comment_id": 84709496, "body": "I guess the same goes for decryption as for <a href=\"https://stackoverflow.com/q/34926578/589259\">encryption</a>; could you indicate if this is the case?"}, {"owner": {"reputation": 3238, "user_id": 2801707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gb0aB.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2801707/ben"}, "edited": false, "score": 0, "creation_date": 1522499658, "post_id": 48797735, "comment_id": 86183211, "body": "If the entire file is encrypted as one thing then you&#39;ll need the entire ciphertext, but if each chunk is encrypted separately then it should be do able. We&#39;d really need more detail on the data structure (we don&#39;t need to know what the decrypted content is, though)."}], "owner": {"reputation": 12925, "user_id": 361833, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/CqdAB.jpg?s=128&g=1", "display_name": "doremi", "link": "https://stackoverflow.com/users/361833/doremi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1518649728, "creation_date": 1518649728, "question_id": 48797735, "link": "https://stackoverflow.com/questions/48797735/gpg-decrypt-chunk-from-stream", "title": "GPG Decrypt Chunk From Stream", "body": "<p>I'm attempting to stream several large symmetrically encrypted .csv.gpg (40GB+ each) files from S3 to gnupg to an output stream. </p>\n\n<p>I'd like to process the files in chunks using streams so that we never need to download the entire encrypted/decrypted file to disk or memory.</p>\n\n<p>Here's an example using the <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Client.html#get_object-instance_method\" rel=\"nofollow noreferrer\">AWS Ruby S3 SDK</a> to download chunks of the object and pass them to gnupg for decryption, using Ruby 2.5.0 with the <a href=\"https://github.com/ueno/ruby-gpgme\" rel=\"nofollow noreferrer\">ruby-gpgme gem</a>. </p>\n\n<pre><code>crypto = GPGME::Crypto.new\n\ns3_client.get_object(bucket: BUCKET, key: KEY) do |chunk|\n  crypto.decrypt(chunk, password: PASSWORD, output: $stdout)\nend\n</code></pre>\n\n<p>When running this, I see valid decrypted CSV data in STDOUT (good!) up until it fails at the end of the first chunk:</p>\n\n<blockquote>\n  <p>~/.rvm/gems/ruby-2.5.0/gems/gpgme-2.0.14/lib/gpgme/ctx.rb:435:in `decrypt_verify': Decryption failed (GPGME::Error::DecryptFailed)</p>\n</blockquote>\n\n<p>This is where I'm stuck.</p>\n\n<ul>\n<li>Can gnupg decrypt chunks at a time or must it read the entire file before writing the output?</li>\n<li>Do the chunks need to be of certain size and/or delimited in some way?</li>\n</ul>\n\n<p>Any feedback would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "devise", "routing"], "answers": [{"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": false, "score": 0, "last_activity_date": 1518648642, "creation_date": 1518648642, "answer_id": 48797538, "question_id": 48796922, "link": "https://stackoverflow.com/questions/48796922/devise-signed-in-user-giving-401-unauthorized/48797538#48797538", "title": "Devise signed_in user giving 401 unauthorized", "body": "<p>Have you considered just using devise's <code>sign_in</code> in the after-confirmation redirection? eg:</p>\n\n<pre><code>class ConfirmationsController &lt; Devise::ConfirmationsController\n  private\n  def after_confirmation_path_for(resource_name, resource)\n    sign_in(resource)\n    your_new_after_confirmation_path\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1518648642, "creation_date": 1518645438, "question_id": 48796922, "link": "https://stackoverflow.com/questions/48796922/devise-signed-in-user-giving-401-unauthorized", "title": "Devise signed_in user giving 401 unauthorized", "body": "<p>I have a rails application and I'm adding a feature to auto-login users using confirmation tokens sent to them as a part of the URL in email links. </p>\n\n<p>I added the following to my <code>application_controller.rb</code>:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\n  before_action :bypass_login\n\n  private\n  def bypass_login\n    if params[:some_params]\n      some_params = params[:some_params]\n      if some_params[:token] &amp;&amp; some_params[:client_email]\n        user = User.by_bypass_token(some_params[:token])\n        sign_in(user, :bypass =&gt; true) if user\n\n        puts \"We should have a current user over here #{current_user}\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the above, the puts does show me a <code>current_user</code>in the terminal but it still seems to throw an error and not really login the user. The terminal response is:</p>\n\n<pre><code>Processing by ErrorsController#routing as */*\n  Parameters: {\"some_params\"=&gt;\n  {\"client_email\"=&gt;\"some@example.com\", \"token\"=&gt;\"iasSDagLadgdagB\"}, \"a\"=&gt;\"api/v1/player/game_play\"}\n  User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"login_bypass_token\" = $1 LIMIT 1  [[\"login_bypass_token\", \"2464l6nbjb416vi4v64iv64iva25a44326363yhvyivg234624646\"]]\n  User Load (0.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1  ORDER BY \"users\".\"id\" ASC LIMIT 1  [[\"id\", 5]]\n  We should have a current user over here #&lt;User:0x007fc215c58b48&gt;\n  Completed 401 Unauthorized in 322ms (Views: 0.2ms | ActiveRecord: 1.6ms)\n</code></pre>\n\n<p>So it's showing an errorController#routing and 401 Unauthorized even though the user should be signed in before reaching any other controller. Do I need to add something more over here?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1518645629, "post_id": 48796258, "comment_id": 84596344, "body": "Please edit to state whether the number of hashes <code>h</code> for which <code>h.key(&quot;name&quot;) #=&gt; true</code> and <code>h[&quot;name&quot;] === &quot;Gi8&quot; #=&gt; true</code> can be zero or more than one."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1518647940, "post_id": 48796258, "comment_id": 84597335, "body": "Note <code>&quot;G18&quot;</code> is not an array and you presumably mean that you want to return the <i>value</i> of <code>:data</code>. If you assign a variable to your array (<code>arr = [{...</code>) you could say that you &quot;wish to return <code>h[:data]</code> for the element of  <code>h</code> of <code>arr</code> for which <code>h[:name] == &quot;G18&quot;</code>is <code>true</code>. That assumes there is exactly one such hash <code>h</code> having that property. If zero or more than one could have that property, the statement would have to be adjusted according."}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 3, "last_activity_date": 1518642868, "creation_date": 1518642868, "answer_id": 48796327, "question_id": 48796258, "link": "https://stackoverflow.com/questions/48796258/select-named-array-from-a-hash-of-array-of-arrays/48796327#48796327", "title": "Select named array from a hash of array of arrays", "body": "<p>Given:</p>\n\n<pre><code>ary = [\n  {\"name\":\"G18\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]},\n  {\"name\":\"G19\",\"data\": [[\"M16\",141],[\"M203\",57],[\"M29S\",142]]},\n  {\"name\":\"G20\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]}\n]\n</code></pre>\n\n<p>Try:</p>\n\n<pre><code>ary.select{|hsh| hsh[:name] == 'G18'}.first[:data]\n =&gt; [[\"X301\", 141], [\"x7901\", 57], [\"x2100\", 142], [\"x90\", 58]] \n</code></pre>\n\n<p>In fact, marmeladze's answer is the correct one: </p>\n\n<pre><code>ary.find{|hsh| hsh[:name] == 'G18'}[:data]\n</code></pre>\n\n<p>Using <code>select</code> was a misfire.</p>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "edited": false, "score": 1, "creation_date": 1518644034, "post_id": 48796335, "comment_id": 84595649, "body": "Thank you, that solved my problem, greatly appreciated."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1518723838, "post_id": 48796335, "comment_id": 84633928, "body": "<code>a.find {|e| e[:name] == &quot;G17&quot; }[:data]</code> raises an exception because  <code>a.find {|e| e[:name] == &quot;G17&quot; } #=&gt; nil</code> and there is no method <code>NilClass#[]</code>. You could use Ruby&#39;s <a href=\"http://mitrev.net/ruby/2015/11/13/the-operator-in-ruby/\" rel=\"nofollow noreferrer\">Safe Navigation operator</a> to deal with this case: <code>a.find {|e| e[:name] == &quot;G17&quot; }&amp;.[](:data) #=&gt; nil</code>. Note that you cannot write <code>a.find {|e| e[:name] == &quot;G17&quot; }&amp;.[:data]</code>."}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1518725458, "post_id": 48796335, "comment_id": 84634749, "body": "@CarySwoveland , blame me not -)) just tell those mad <a href=\"https://stackoverflow.com/questions/48815210/transform-float-to-int-so-that-every-information-is-preserved-or-how-to-get-the\">pythonistas</a> that they need basic arithmetics, not decimal handling libraries, string representations, logarithms etc -))"}], "tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": true, "score": 3, "last_activity_date": 1518657290, "last_edit_date": 1518657290, "creation_date": 1518642892, "answer_id": 48796335, "question_id": 48796258, "link": "https://stackoverflow.com/questions/48796258/select-named-array-from-a-hash-of-array-of-arrays/48796335#48796335", "title": "Select named array from a hash of array of arrays", "body": "<p>This will work for you if you have only one item with name \"G18\":</p>\n\n<pre><code>a.find {|e| e[:name] == \"G18\" }[:data]\n</code></pre>\n\n<p>See: <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\"><em>Enumerable#find</em></a> in the official docs.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1518645255, "post_id": 48796498, "comment_id": 84596190, "body": "How does this differ from @marmeladze&#39;s earlier answer?"}, {"owner": {"reputation": 750, "user_id": 1796041, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/233b6d0e4a63ef12775bee73cf1c228b?s=128&d=identicon&r=PG", "display_name": "Dylan Richards", "link": "https://stackoverflow.com/users/1796041/dylan-richards"}, "edited": false, "score": 0, "creation_date": 1518646403, "post_id": 48796498, "comment_id": 84596667, "body": "It&#39;s always a good idea in Ruby to extract logic such as this into methods.  In this case, doing so allows this code to work with any collection of hashes that have <code>name</code> and <code>data</code> keys. Also lets us defer until runtime the decision as to what item we&#39;re looking for."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1518648104, "post_id": 48796498, "comment_id": 84597413, "body": "I think what you said is obvious and could be applied equally to any SO answer that has not been wrapped in the obvious method."}, {"owner": {"reputation": 750, "user_id": 1796041, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/233b6d0e4a63ef12775bee73cf1c228b?s=128&d=identicon&r=PG", "display_name": "Dylan Richards", "link": "https://stackoverflow.com/users/1796041/dylan-richards"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1518666850, "post_id": 48796498, "comment_id": 84602210, "body": "@CarySwoveland -- As someone who teachers beginners how to code, this is certainly not obvious."}], "tags": [], "owner": {"reputation": 750, "user_id": 1796041, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/233b6d0e4a63ef12775bee73cf1c228b?s=128&d=identicon&r=PG", "display_name": "Dylan Richards", "link": "https://stackoverflow.com/users/1796041/dylan-richards"}, "is_accepted": false, "score": 2, "last_activity_date": 1518643567, "creation_date": 1518643567, "answer_id": 48796498, "question_id": 48796258, "link": "https://stackoverflow.com/questions/48796258/select-named-array-from-a-hash-of-array-of-arrays/48796498#48796498", "title": "Select named array from a hash of array of arrays", "body": "<pre><code>collection = [\n  {\"name\":\"G18\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]},\n  {\"name\":\"G19\",\"data\": [[\"M16\",141],[\"M203\",57],[\"M29S\",142]]},\n  {\"name\":\"G20\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]}\n]\n\ndef data_for_name(name, collection)\n  collection.find { |item| item[:name] == name }[:data]\nend\n\np data_for_name(\"G18\", collection)\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48796335, "answer_count": 3, "score": 1, "last_activity_date": 1518663347, "creation_date": 1518642558, "last_edit_date": 1518663347, "question_id": 48796258, "link": "https://stackoverflow.com/questions/48796258/select-named-array-from-a-hash-of-array-of-arrays", "title": "Select named array from a hash of array of arrays", "body": "<p>I have a hash of an array of arrays. The array is indexed by the hash (that is the way I am reading this):</p>\n\n<pre><code>[\n {\"name\":\"G18\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]},\n {\"name\":\"G19\",\"data\": [[\"M16\",141],[\"M203\",57],[\"M29S\",142]]},\n {\"name\":\"G20\",\"data\": [[\"X301\",141],[\"x7901\",57],[\"x2100\",142],[\"x90\",58]]}\n]\n</code></pre>\n\n<p>I want to select the hashes that contain the array <code>G18</code>, and return only the data.</p>\n\n<p>I tried searching for answer, but I haven't found anything like this yet.</p>\n"}, {"tags": ["ruby", "irb"], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 2, "last_activity_date": 1518645634, "creation_date": 1518645634, "answer_id": 48796968, "question_id": 48796160, "link": "https://stackoverflow.com/questions/48796160/how-to-prevent-irb-from-asking-to-display-all-possibilities/48796968#48796968", "title": "How to prevent IRB from asking to Display all possibilities?", "body": "<p>Since IRB uses GNU Readline, it can be also affected by contents of <code>~/.inputrc</code> file. You can get the behaviour that you described by setting these options in <code>~/.inputrc</code> :</p>\n\n<pre><code>set completion-query-items 0\nset page-completions off\n</code></pre>\n\n<p>as described in <a href=\"https://superuser.com/a/601997/43811\">this answer</a> on Super User.</p>\n\n<p>However, this also affects Bash and possibly other programs using Readline, which may be either completely undesired annoyance, or a pleasant surprise :)</p>\n"}], "owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 48796968, "answer_count": 1, "score": 0, "last_activity_date": 1518645634, "creation_date": 1518642187, "question_id": 48796160, "link": "https://stackoverflow.com/questions/48796160/how-to-prevent-irb-from-asking-to-display-all-possibilities", "title": "How to prevent IRB from asking to Display all possibilities?", "body": "<p>I've enabled tab-completion in IRB by adding the <code>require \"irb/completion\"</code> to my <code>~/.irbrc</code> file.</p>\n\n<p>Now, IRB keeps asking me to type <code>y</code> before displaying the properties:</p>\n\n<pre><code>irb(main):001:0&gt; 42.\nDisplay all 112 possibilities? (y or n)\n</code></pre>\n\n<p>Is there some setting I can add to my <code>.irbrc</code> file to make the default behavior be to simply display all the possibilities?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "fedena"], "comments": [{"owner": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1518763445, "post_id": 48795557, "comment_id": 84646116, "body": "You are using latest version of ruby. Use 1.8.7. Follow the steps mentioned here: <a href=\"http://projectfedena.org/install\" rel=\"nofollow noreferrer\">projectfedena.org/install</a>"}, {"owner": {"reputation": 11, "user_id": 9361740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b4d329dda50ba6c0b3d42f4d12e126?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9361740/adam"}, "reply_to_user": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1518881095, "post_id": 48795557, "comment_id": 84689753, "body": "Hi Navin, Thank you for the advice. I suspected it was that but thought that some function would have been built into newer versions of RoR to allow for apps that run on older RoR versions. I have one more issue that no amount of research is able to solve....ruby 1.8.7 (2013-06-27 patchlevel 374) [i386-mingw32] ruby.exe: illegal switch in RUBYOPT: -E (RuntimeError)"}, {"owner": {"reputation": 533, "user_id": 2504691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b92de7de2771f0e07a48626a5626c?s=128&d=identicon&r=PG", "display_name": "Navin", "link": "https://stackoverflow.com/users/2504691/navin"}, "edited": false, "score": 0, "creation_date": 1519123217, "post_id": 48795557, "comment_id": 84770775, "body": "In newer rails version some old syntaxes are deprecated. You can not run an rails 2.3.5 , ruby 1.8.7 app in newer versions."}], "owner": {"reputation": 11, "user_id": 9361740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b4d329dda50ba6c0b3d42f4d12e126?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/9361740/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518652325, "creation_date": 1518639686, "last_edit_date": 1518652325, "question_id": 48795557, "link": "https://stackoverflow.com/questions/48795557/fedena-windows-installation-issue", "title": "fedena windows installation issue", "body": "<p>Fedena installation issue. Unable to create db via <code>rake db:create</code>. All gems seem to be of correct versions for the fedena app. <code>Config/database.yml</code> apparently correct. One possible reason for inability to create db in MySQL are the differences in RoR versions specified for fedena. i.e. <code>ver 1.8.7</code> vs  <code>ruby 2.5.0p0</code> (2017-12-25 revision 61468) [x64-mingw32] (latter installed on system) </p>\n\n<p>Please see below: </p>\n\n<pre><code>d:\\fedena&gt;rake db:create\nTraceback (most recent call last):\n        13: from C:/Ruby25-x64/bin/rake:23:in `&lt;main&gt;'\n        12: from C:/Ruby25-x64/bin/rake:23:in `load'\n        11: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/bin/rake:26:in `&lt;top (required)&gt;'\n        10: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         9: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         8: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/lib/rake.rb:41:in `&lt;top (required)&gt;'\n         7: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         6: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         5: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/lib/rake/win32.rb:2:in `&lt;top (required)&gt;'\n         4: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/lib/rake/win32.rb:3:in `&lt;module:Rake&gt;'\n         3: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         2: from C:/Ruby25-x64/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require'\n         1: from C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/lib/rake/alt_system.rb:31:in `&lt;top (required)&gt;'\nC:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/rake-0.8.7/lib/rake/alt_system.rb:32:in `&lt;module:AltSystem&gt;': uninitialized constant Rake::AltSystem::Config (NameError)\nDid you mean?  RbConfig\n</code></pre>\n\n<p>Any advice and guidance would be awesome. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1519622520, "post_id": 48794906, "comment_id": 84968825, "body": "Did one of these answers meet your needs?"}, {"owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1519656008, "post_id": 48794906, "comment_id": 84986595, "body": "@jvillian, this is works for me: shops = Shop.joins(:shop_clients).where(shop_clients: {client_id: params[:client_id]}).merge(Shop.joins(:shop_products).where(&zwnj;&#8203;shop_products: {product_id: params[:product_id]}))"}], "answers": [{"tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1518647462, "last_edit_date": 1518647462, "creation_date": 1518637837, "answer_id": 48795113, "question_id": 48794906, "link": "https://stackoverflow.com/questions/48794906/rails-5-select-from-two-different-tables-and-get-one-result/48795113#48795113", "title": "Rails 5 select from two different tables and get one result", "body": "<p>I feel like the best way to solve this issue is to use sub-queries. I'll first collect all valid shop ids from <em>ShopClient</em>, followed by all valid shop ids from <em>ShopProduct</em>. Than feed them into the where query on <em>Shop</em>. This will result in one SQL query.</p>\n\n<pre><code>shop_client_ids = ShopClient.where(client_id: params[:client_id]).select(:shop_id)\nshop_product_ids = ShopProduct.where(product_id: params[:product_id]).select(:shop_id)\n@shops = Shop.where(id: shop_client_ids).where(id: shop_product_ids)\n\n#=&gt; #&lt;ActiveRecord::Relation [#&lt;Shop id: 1, created_at: \"2018-02-14 20:22:18\", updated_at: \"2018-02-14 20:22:18\"&gt;]&gt;\n</code></pre>\n\n<p>The above query results in the SQL query below. I didn't specify a limit, but this might be added by the fact that my dummy project uses SQLite.</p>\n\n<pre><code>SELECT  \"shops\".* \nFROM \"shops\" \nWHERE \n  \"shops\".\"id\" IN (\n    SELECT \"shop_clients\".\"shop_id\" \n    FROM \"shop_clients\" \n    WHERE \"shop_clients\".\"client_id\" = ?) AND \n  \"shops\".\"id\" IN (\n    SELECT \"shop_products\".\"shop_id\" \n    FROM \"shop_products\" \n    WHERE \"shop_products\".\"product_id\" = ?) \nLIMIT ?  \n[[\"client_id\", 1], [\"product_id\", 1], [\"LIMIT\", 11]]\n</code></pre>\n\n<p><strong>Combining the two sub-queries in one <em>where</em> doesn't result in a correct response:</strong></p>\n\n<pre><code>@shops = Shop.where(id: [shop_client_ids, shop_product_ids])\n#=&gt; #&lt;ActiveRecord::Relation []&gt;\n</code></pre>\n\n<p>Produces the query:</p>\n\n<pre><code>SELECT  \"shops\".* FROM \"shops\" WHERE \"shops\".\"id\" IN (NULL, NULL) LIMIT ?  [[\"LIMIT\", 11]]\n</code></pre>\n\n<h3>note</h3>\n\n<p>Keep in mind that when you run the statements one by one in the console this will normally result in 3 queries. This is due to the fact that the return value uses the <em>#inspect</em> method to let you see the result. This method is overridden by Rails to execute the query and display the result.</p>\n\n<p>You can simulate the behavior of the normal application by suffixing the statements with <code>;nil</code>. This makes sure <code>nil</code> is returned and the <em>#inspect</em> method is not called on the where chain, thus not executing the query and keeping the chain in memory.</p>\n\n<h3>edit</h3>\n\n<p>If you want to clean up the controller you might want to move these sub-queries into model methods (inspired by <a href=\"https://stackoverflow.com/a/48795866/3982562\">jvillians answer</a>).</p>\n\n<pre><code>class Shop\n  # ...\n  def self.with_clients(*client_ids)\n    client_ids.flatten! # allows passing of multiple arguments or an array of arguments\n    where(id: ShopClient.where(client_id: client_ids).select(:shop_id))\n  end\n  # ...\nend\n</code></pre>\n\n<h3>Rails sub-query vs join</h3>\n\n<p>The advantage of a sub-query over a join is that using joins might end up returning the same record multiple times if you query on a attribute that is not unique. For example, say a product has an attribute <em>product_type</em> that is either <code>'physical'</code> or <code>'digital'</code>. If you want to select all shops selling a digital product you must not forget to call <em>distinct</em> on the chain when you're using a join, otherwise the same shop may return multiple times. </p>\n\n<p>However if you'll have to query on multiple attributes in product, and you'll use multiple helpers in the model (where each helper <code>joins(:products)</code>). Multiple sub-queries are likely slower. (Assuming you set <code>has_many :products, through: :shop_products</code>.) Since Rails reduces all joins to the same association to a single one. Example: <code>Shop.joins(:products).joins(:products)</code> (from multiple class methods) will still end up joining the <em>products</em> table a single time, whereas sub-queries will not be reduced.</p>\n"}, {"comments": [{"owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1518641559, "post_id": 48795214, "comment_id": 84594429, "body": "ERROR:  column shops.client_id does not exist. And it is true becaus the table shops does not have a client_id, cause it is saved in the shop_clients table. HOw can I make it works?"}, {"owner": {"reputation": 276, "user_id": 4188532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abfe90024d7e2b7d5f565ad3c9b1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Prince Bansal", "link": "https://stackoverflow.com/users/4188532/prince-bansal"}, "reply_to_user": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1518666845, "post_id": 48795214, "comment_id": 84602209, "body": "You need to declare has_many association with shop_clients model and then declare has_many clients through shop_clients as stated in my answer."}], "tags": [], "owner": {"reputation": 276, "user_id": 4188532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abfe90024d7e2b7d5f565ad3c9b1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Prince Bansal", "link": "https://stackoverflow.com/users/4188532/prince-bansal"}, "is_accepted": false, "score": 4, "last_activity_date": 1518639263, "last_edit_date": 1518639263, "creation_date": 1518638203, "answer_id": 48795214, "question_id": 48794906, "link": "https://stackoverflow.com/questions/48794906/rails-5-select-from-two-different-tables-and-get-one-result/48795214#48795214", "title": "Rails 5 select from two different tables and get one result", "body": "<p>Below query will work for you.</p>\n\n<pre><code>class Shop\n  has_many :shop_clients\n  has_many :clients, through: :shop_clients\n  has_many :shop_products\n  has_many :products, through: :shop_products\nend\n\nclass Client\nend\n\nclass Product\nend\n\n\nclass ShopClient\n  belongs_to :shop\n  belongs_to :client\nend\n\nclass ShopProduct\n  belongs_to :shop\n  belongs_to :product\nend\n\n@shops = Shop.joins(:clients).where(clients: {id: params[:client_id]}).merge(Shop.joins(:products).where(products: {id: params[:product_id]}))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1518640766, "creation_date": 1518640766, "answer_id": 48795798, "question_id": 48794906, "link": "https://stackoverflow.com/questions/48794906/rails-5-select-from-two-different-tables-and-get-one-result/48795798#48795798", "title": "Rails 5 select from two different tables and get one result", "body": "<p>Below sql query possibly gonna work for you. </p>\n\n<pre><code>-- \n-- assuming \n-- tables: shops, products, clients, shop_products, shop_clients\n--  \n\nSELECT DISTINCT * FROM shops\n  JOIN shop_products \n    ON shop_products.shop_id = shops.id\n  JOIN shop_clients \n    ON shop_clients.shop_id = shops.id\nWHERE  shop_clients.client_id = ? AND shop_products.product_id = ?\n</code></pre>\n\n<p>If you'll face difficulties while creating an adequate AR expression for this sql query, let me know.  </p>\n\n<p><a href=\"http://sqlfiddle.com/#!17/b40fb/3\" rel=\"nofollow noreferrer\">Btw, here is a mock</a></p>\n"}, {"comments": [{"owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1518641573, "post_id": 48795866, "comment_id": 84594439, "body": "ERROR: column shops.client_id does not exist. And it is true becaus the table shops does not have a client_id, cause it is saved in the shop_clients table. HOw can it make it works?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1518642152, "post_id": 48795866, "comment_id": 84594708, "body": "Oh, sorry. I didn&#39;t actually check Prince Bansal&#39;s query. I think something like the updated answer <i>should</i> work. But, I didn&#39;t test. So, you may have to fiddle with it a bit."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1518645150, "post_id": 48795866, "comment_id": 84596153, "body": "The helpers should be: <code>joins(:shop_clients).where(shop_clients: {client_id: clients})</code> or <code>joins(:clients).where(clients: {id: clients})</code>. The same for the other helper. The current solution will use a join and a sub-query."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1518645556, "post_id": 48795866, "comment_id": 84596318, "body": "Thank you, @JohanWentholt. That&#39;s quite a bit better."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "edited": false, "score": 0, "creation_date": 1518645993, "post_id": 48795866, "comment_id": 84596511, "body": "@matQ - If you still get the error you might need to set <code>has_many :clients, through: :shop_clients</code> on <i>Shop</i> or use <code>joins(:shop_clients).where(shop_clients: {client_id: clients})</code> instead. The same goes for <i>Product</i>."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1518645538, "last_edit_date": 1518645538, "creation_date": 1518641031, "answer_id": 48795866, "question_id": 48794906, "link": "https://stackoverflow.com/questions/48794906/rails-5-select-from-two-different-tables-and-get-one-result/48795866#48795866", "title": "Rails 5 select from two different tables and get one result", "body": "<p>Just to riff on the answer provided by Prince Bansal. How about creating some class methods for those joins? Something like:</p>\n\n<pre><code>class Shop\n  has_many :shop_clients\n  has_many :clients, through: :shop_clients\n  has_many :shop_products\n  has_many :products, through: :shop_products\n\n  class &lt;&lt; self \n\n    def with_clients(clients)\n      joins(:clients).where(clients: {id: clients})\n    end\n\n    def with_products(products)\n      joins(:products).where(products: {id: products})\n    end\n\n  end \n\nend\n</code></pre>\n\n<p>Then you could do something like:</p>\n\n<pre><code>@shops = Shop.with_clients(params[:client_id]).with_products(params[:product_id])\n</code></pre>\n\n<p>By the way, I'm sure someone is going to say you should make those class methods into scopes. And you certainly can do that. I did it as class methods because that's what <a href=\"http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments\" rel=\"nofollow noreferrer\">the Guide</a> recommends:</p>\n\n<blockquote>\n  <p>Using a class method is the preferred way to accept arguments for scopes.</p>\n</blockquote>\n\n<p>But, I realize some people strongly prefer the aesthetics of using scopes instead. So, whichever pleases you most.</p>\n"}], "owner": {"reputation": 537, "user_id": 6665356, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4c86625b9dd9d7d9505758a743d871ea?s=128&d=identicon&r=PG&f=1", "display_name": "matQ", "link": "https://stackoverflow.com/users/6665356/matq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4521, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1518647462, "creation_date": 1518636986, "last_edit_date": 1518644365, "question_id": 48794906, "link": "https://stackoverflow.com/questions/48794906/rails-5-select-from-two-different-tables-and-get-one-result", "title": "Rails 5 select from two different tables and get one result", "body": "<p>I have 3 models, <code>Shop</code>, <code>Client</code>, <code>Product</code>.</p>\n\n<p>A shop has many clients, and a shop has many products.</p>\n\n<p>Then I have 2 extra models, one is <code>ShopClient</code>, that groups the <code>shop_id</code> and <code>client_id</code>. The second is <code>ShopProduct</code>, that groups the <code>shop_id</code> and <code>product_id</code>.</p>\n\n<p>Now I have a controller that receives two params, the <code>client_id</code> and <code>product_id</code>. So I want to select all the shops (in one instance variable <code>@shops</code>) filtered by <code>client_id</code> and <code>product_id</code> without shop repetition. How can I do this??</p>\n\n<p>I hope I was clear, thanks.</p>\n\n<p>ps: I'm using Postgresql as database.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "has-and-belongs-to-many"], "comments": [{"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 2, "creation_date": 1518634615, "post_id": 48794238, "comment_id": 84590841, "body": "do you have a model for the join table or are you using the default Rails&#39; <code>has_and_belongs_to_many</code> functionality?"}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 4188532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abfe90024d7e2b7d5f565ad3c9b1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Prince Bansal", "link": "https://stackoverflow.com/users/4188532/prince-bansal"}, "is_accepted": false, "score": 0, "last_activity_date": 1518637565, "creation_date": 1518637565, "answer_id": 48795057, "question_id": 48794238, "link": "https://stackoverflow.com/questions/48794238/how-to-deduplicate-a-habtm-join-table-in-rails/48795057#48795057", "title": "How to Deduplicate a HABTM join table in Rails", "body": "<p>You can use below query to delete duplicate records from HABTM table.</p>\n\n<p>ActiveRecord::Base.connection.execute(\"DELETE FROM TableName WHERE (model_id_one, model_id_two) IN (SELECT model_id_one model_id_two FROM TableName GROUP BY model_id_one, model_id_two HAVING COUNT(*) > 1)\")</p>\n"}, {"comments": [{"owner": {"reputation": 3691, "user_id": 514860, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c901002fd1c9ba4c58b0223c2f42e952?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/514860/will"}, "edited": false, "score": 0, "creation_date": 1518717547, "post_id": 48813089, "comment_id": 84630588, "body": "no this isn&#39;t right, they are measures to only show unique items, not dedupe the db and the second one prevents the duplicates, which is the next task, that I can&#39;t do until it&#39;s de-duped."}], "tags": [], "owner": {"reputation": 1, "user_id": 8131673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fZNkOHAj0BY/AAAAAAAAAAI/AAAAAAAAIm4/EDq3u_n3yPU/photo.jpg?sz=128", "display_name": "Alexey Melnikov", "link": "https://stackoverflow.com/users/8131673/alexey-melnikov"}, "is_accepted": false, "score": 0, "last_activity_date": 1518715873, "creation_date": 1518715873, "answer_id": 48813089, "question_id": 48794238, "link": "https://stackoverflow.com/questions/48794238/how-to-deduplicate-a-habtm-join-table-in-rails/48813089#48813089", "title": "How to Deduplicate a HABTM join table in Rails", "body": "<p>I think it will help: <a href=\"https://stackoverflow.com/questions/1129781/has-and-belongs-to-many-avoiding-dupes-in-the-join-table\">has_and_belongs_to_many, avoiding dupes in the join table</a></p>\n\n<p>For showing related entries without duplicates: </p>\n\n<pre><code>has_and_belongs_to_many :students, -&gt; { distinct }\n</code></pre>\n\n<p>But also I recommend to add unique index on your join table.</p>\n"}], "owner": {"reputation": 3691, "user_id": 514860, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c901002fd1c9ba4c58b0223c2f42e952?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/514860/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556897805, "creation_date": 1518634239, "question_id": 48794238, "link": "https://stackoverflow.com/questions/48794238/how-to-deduplicate-a-habtm-join-table-in-rails", "title": "How to Deduplicate a HABTM join table in Rails", "body": "<p>I have a join table that joins students HABTM students</p>\n\n<p>Unfortunately, it's gotten some duplicate records in it.  </p>\n\n<p>How can I deduplicate the join table. Ideally, using Ruby. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-elastic-beanstalk"], "answers": [{"tags": [], "owner": {"reputation": 460, "user_id": 2810489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ltkms.jpg?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/2810489/matthieu"}, "is_accepted": false, "score": 4, "last_activity_date": 1599720017, "last_edit_date": 1599720017, "creation_date": 1518634825, "answer_id": 48794399, "question_id": 48793496, "link": "https://stackoverflow.com/questions/48793496/elastic-beanstalk-aws-rails-bundle-install-failure/48794399#48794399", "title": "Elastic Beanstalk AWS Rails Bundle Install Failure", "body": "<p>You need to install git.\nYou can create a file .ebextensions/git.config in your rails app:</p>\n<pre><code>packages:\n  yum:\n    git: []\n</code></pre>\n<p>Then try to deploy again</p>\n"}, {"tags": [], "owner": {"reputation": 4938, "user_id": 431432, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d071dc4623d932c3dfa6d2dd41159439?s=128&d=identicon&r=PG", "display_name": "Chris Chen", "link": "https://stackoverflow.com/users/431432/chris-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1560041488, "creation_date": 1560041488, "answer_id": 56511185, "question_id": 48793496, "link": "https://stackoverflow.com/questions/48793496/elastic-beanstalk-aws-rails-bundle-install-failure/56511185#56511185", "title": "Elastic Beanstalk AWS Rails Bundle Install Failure", "body": "<p>By default, the Load Balancer target group uses \"/\" for the health check. Make sure your rails app responses to that endpoint with 200 status or you can update the health check path to a relevant one.</p>\n"}], "owner": {"reputation": 1, "user_id": 9361458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2860d51aed88c39c3e5070749cb3b6da?s=128&d=identicon&r=PG&f=1", "display_name": "Meg.o", "link": "https://stackoverflow.com/users/9361458/meg-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1599720017, "creation_date": 1518631201, "question_id": 48793496, "link": "https://stackoverflow.com/questions/48793496/elastic-beanstalk-aws-rails-bundle-install-failure", "title": "Elastic Beanstalk AWS Rails Bundle Install Failure", "body": "<p>I'm trying to deploy my rails app using AWS and Elastic Beanstalk. My deployment worked but the health is at a 'red' status - error 11 (bundle install failed).</p>\n\n<p>I tried: \n$ gem update bundler\n$ bundle package --all</p>\n\n<p>Still the same error. </p>\n\n<pre><code># Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n# ruby \"2.4.1\"\n+ '[' -d /var/app/ondeck/vendor/cache ']'\n+ bundle install\nDon't run Bundler as root. Bundler can ask for sudo if it is needed, and\ninstalling your bundle as root will break this application for all non-root\nusers on this machine.\nWarning: the running version of Bundler (1.16.0) is older than the version that created the lockfile (1.16.1). We suggest you upgrade to the latest version of Bundler by running `gem install bundler`.\nFetching gem metadata from https://rubygems.org/.........\nFetching https://github.com/mshibuya/remotipart.git\nsh: git: command not found\n\nRetrying `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` due to error (2/4): Bundler::Source::Git::GitCommandError Git error: command `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` in directory /var/app/ondeck has failed.sh: git: command not found\n\nRetrying `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` due to error (3/4): Bundler::Source::Git::GitCommandError Git error: command `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` in directory /var/app/ondeck has failed.sh: git: command not found\n\nRetrying `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` due to error (4/4): Bundler::Source::Git::GitCommandError Git error: command `git clone 'https://github.com/mshibuya/remotipart.git' \"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\" --bare --no-hardlinks --quiet` in directory /var/app/ondeck has failed.sh: git: command not found\n\nGit error: command `git clone 'https://github.com/mshibuya/remotipart.git'\n\"/opt/rubies/ruby-2.4.3/lib/ruby/gems/2.4.0/cache/bundler/git/remotipart-f9606ede17c5ca255592b042ebded6ea195ac779\"\n--bare --no-hardlinks --quiet` in directory /var/app/ondeck has failed.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongoid"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1520598152, "post_id": 48792656, "comment_id": 85391954, "body": "Did you figure out how to do this?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1520598199, "post_id": 48792656, "comment_id": 85391974, "body": "If not you can raise an issue on the gem. Someone can raise a PR if it looks a genuine requirement."}, {"owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1522443483, "post_id": 48792656, "comment_id": 86170649, "body": "Sorry, just saw your comment. I don&#39;t think it&#39;s a problem with the gem. It&#39;s just something, that it doesn&#39;t do. Would have to write some methods in order to make this work. Thank you."}], "owner": {"reputation": 95, "user_id": 7685722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/791cbf6af02ecfe051dd1a9b0c39fa7c?s=128&d=identicon&r=PG&f=1", "display_name": "C. Yee", "link": "https://stackoverflow.com/users/7685722/c-yee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518628046, "creation_date": 1518628046, "question_id": 48792656, "link": "https://stackoverflow.com/questions/48792656/tracking-changes-in-an-array-using-mongoid-history", "title": "Tracking changes in an array using Mongoid History", "body": "<p>How do you track changes in an array using the Mongoid History gem? I have an array of questions. It will look something like this</p>\n\n<pre><code>Questions = [ {\"intro\" =&gt; \"Intro: 1\", \"name\" =&gt; \"Name: 1\"}, {\"intro\" =&gt; \"Intro: 2\", \"name\" =&gt; \"Name: 2\"} ]\n</code></pre>\n\n<p>This is my code</p>\n\n<pre><code>class Script\n  include Mongoid::History::Trackable\n\n  field :name, type: String\n  field :type, type: String\n  field :questions, type: Array, default: []\n\n  track_history on: [ :type, :name, :questions ], track_create: true, track_update: true, track_destory: true\nend\n\nclass Question\n  include Mongoid::History::Trackable\n\n  field :intro, type: String\n  field :name, type: String\n\n  track_history(\n    on: :fields,\n    scope: :script,\n    track_create: true,\n    track_update: true,\n    track_destroy: true\n  )\nend\n</code></pre>\n\n<p>When I make a change, it gives me the array with all the information, instead of just the name or intro that changed. I do not want to have the questions embedded into the script for various reasons. The best way in my case is to create a field for it. </p>\n"}, {"tags": ["ruby", "class", "oop"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1518628454, "post_id": 48792632, "comment_id": 84587700, "body": "If you use single <code>@</code> it should work correctly. See the first annswer at <a href=\"https://stackoverflow.com/questions/1251352/ruby-inherit-code-that-works-\" title=\"ruby inherit code that works \">stackoverflow.com/questions/1251352/&hellip;</a> with-class-variables"}, {"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518631812, "post_id": 48792632, "comment_id": 84589379, "body": "Using single @ does get rid of the warning, but I think that still doesn&#39;t answer my question: if self is Foo in the class_eval block, why does the class variable I set end up a class variable of Object?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518633954, "post_id": 48792632, "comment_id": 84590478, "body": "all classes inherit from object, and double @ variables are shared with the whole inheritance chain. Like the answer I linked says, they&#39;re more like globals. Don&#39;t blame you for being confused."}, {"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518634498, "post_id": 48792632, "comment_id": 84590770, "body": "Mhm. Double @ variables are shared down the inheritance chain. Object is above Foo in the chain, so I don&#39;t see why @@class_var belongs to Object."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518637336, "post_id": 48792632, "comment_id": 84592267, "body": "i guess that&#39;s a good point, I don&#39;t know."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1518635026, "post_id": 48794337, "comment_id": 84591062, "body": "This is illuminating, but I&#39;m not sure it fully answers my question. It shows that when class_eval is called within a &quot;class Bar&quot; block, Bar gets the class variable. In my example, there&#39;s similar (but still confusing) behavior: class_eval is called within the context of &quot;Object&quot; (top-level class) and Object is assigned the class variable."}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1518635300, "post_id": 48794337, "comment_id": 84591218, "body": "yeah there must be something special about context, if you think there  that&#39;s the entry-point of your app, so I assume that&#39;s some magic going on. if you rename Bar to Object it would still work just like monkey patch does"}, {"owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "reply_to_user": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "edited": false, "score": 0, "creation_date": 1518635605, "post_id": 48794337, "comment_id": 84591371, "body": "also if you run <code>p self</code> form the top level context you don&#39;t see <code>Object</code> but you see <code>main</code>"}], "tags": [], "owner": {"reputation": 6709, "user_id": 3640161, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/065307b80129366f064b9b99811658aa?s=128&d=identicon&r=PG", "display_name": "Tiago Lopo", "link": "https://stackoverflow.com/users/3640161/tiago-lopo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518634615, "creation_date": 1518634615, "answer_id": 48794337, "question_id": 48792632, "link": "https://stackoverflow.com/questions/48792632/why-does-using-class-eval-cause-toplevel-class-variable-to-be-set/48794337#48794337", "title": "Why does using class_eval cause toplevel class variable to be set?", "body": "<p>As pointed out in comments  a single <code>@</code> would do what you want, now if you were running the code from inside another class <code>@@</code> would work but it would set a class variable for  both Foo, and whatever class you running from: </p>\n\n<pre><code>class Foo\n  puts self\n  # =&gt; Foo\n  @@class_var = \"hello\"\nend\n\nclass Bar\n  def self.main\n    puts Object.class_variables\n    # =&gt; []\n\n    Foo.class_eval do\n      puts self\n      # =&gt; Foo\n      @@class_var = \"hi\"\n    end\n  end\nend\n\nBar.main\np [Bar.class_variables]\n#[[:@@class_var]]\np [Foo.class_variables]\n#[[:@@class_var]]\n</code></pre>\n\n<p>That has to do with <code>proc</code> or <code>block</code> scope, I was expecting it to set only <code>@@class_var</code> only on <code>Bar</code> class but it actually sets on both, weird. </p>\n"}], "owner": {"reputation": 383, "user_id": 6889933, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1b819d95e4d369dfa5b4aeac622c703b?s=128&d=identicon&r=PG&f=1", "display_name": "nickackerman42", "link": "https://stackoverflow.com/users/6889933/nickackerman42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1518634615, "creation_date": 1518627982, "question_id": 48792632, "link": "https://stackoverflow.com/questions/48792632/why-does-using-class-eval-cause-toplevel-class-variable-to-be-set", "title": "Why does using class_eval cause toplevel class variable to be set?", "body": "<p>I wrote some code to learn about the class_eval method. My understanding is that Foo.class_eval will set self to \"Foo\" and evaluate the block below in that context, just as saying \"class Foo\" will do. However, the code below shows that setting a class variable using class_eval will assign the class variable at the toplevel: to \"Object\". Why does this happen?</p>\n\n<pre><code>class Foo\nend\n\nclass Foo\n  puts self\n  # =&gt; Foo\n  @@class_var = \"hello\"\nend\n\nputs Object.class_variables\n# =&gt; []\n\nFoo.class_eval do\n    puts self\n    # =&gt; Foo\n    @@class_var = \"hi\"\n    # =&gt; warning: class variable access from toplevel\nend\n\nputs Object.class_variables\n# =&gt; @@class_var\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-admin"], "comments": [{"owner": {"reputation": 1265, "user_id": 6092216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F6a3O.jpg?s=128&g=1", "display_name": "Nabin Paudyal", "link": "https://stackoverflow.com/users/6092216/nabin-paudyal"}, "edited": false, "score": 0, "creation_date": 1518628046, "post_id": 48792310, "comment_id": 84587469, "body": "What does your view look like?"}, {"owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "reply_to_user": {"reputation": 1265, "user_id": 6092216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F6a3O.jpg?s=128&g=1", "display_name": "Nabin Paudyal", "link": "https://stackoverflow.com/users/6092216/nabin-paudyal"}, "edited": false, "score": 0, "creation_date": 1518628289, "post_id": 48792310, "comment_id": 84587626, "body": "I don&#39;t understand the question. This is rails admin, I don&#39;t use a view @nabi"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1518632230, "post_id": 48792310, "comment_id": 84589606, "body": "You need to add your view code."}], "answers": [{"comments": [{"owner": {"reputation": 635, "user_id": 1027220, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c3376bb6869ac5e702763b4e550d9447?s=128&d=identicon&r=PG", "display_name": "Natan Rubinstein", "link": "https://stackoverflow.com/users/1027220/natan-rubinstein"}, "edited": false, "score": 0, "creation_date": 1544655214, "post_id": 48794375, "comment_id": 94358064, "body": "I had that problem when I did enum field. You solution worked but needed to change the list line to this      bindings[:view].tag(:a, {href: path}, true) &lt;&lt; user.admin_user"}], "tags": [], "owner": {"reputation": 696, "user_id": 6999833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0e26a82fa2dccaae910c7fa87dd8e8?s=128&d=identicon&r=PG", "display_name": "Stan Mazhara", "link": "https://stackoverflow.com/users/6999833/stan-mazhara"}, "is_accepted": true, "score": 6, "last_activity_date": 1518634757, "creation_date": 1518634757, "answer_id": 48794375, "question_id": 48792310, "link": "https://stackoverflow.com/questions/48792310/rails-admin-object-rendering-as-user-in-the-index-list-view/48794375#48794375", "title": "Rails admin object rendering as `#&lt;User:` in the index list view", "body": "<p>The reason it shows <code>#&lt;User:0x0....&gt;</code> is because your <code>admin_user</code> returns an instance of ActiveRecord. When RailsAdmin outputs it calls its <code>#to_s</code> method, which, by default returns that output above. You can either override that method to look something like this:</p>\n\n<pre><code># User class\n\ndef to_s\n  name\nend\n</code></pre>\n\n<p>or you could modify your <code>admin_user</code> to return a properly formatted string instead of ActiveRecord if you prefer.</p>\n\n<p>In order to 'make it link to the User admin view' a bit more configuration is required in your <code>config.model</code>. You need to define a <code>pretty_value</code> for it and override default rendering.</p>\n\n<pre><code>config.model 'Team' do\n   pretty_value do\n     # user's active record\n     user = bindings[:object]\n     # path to its RailsAdmin 'show' page\n     path = bindings[:view].show_path(model_name: 'User', id: bindings[:object].id)\n     # &lt;a href...&gt; tag to it\n     bindings[:view].tag(:a, href: path) &lt;&lt; user.admin_user\n  end\nend\n</code></pre>\n\n<p>remember that <code>user.admin_user</code> in the last line assumes it returns a string that you want in your link or <code>User</code> that has a properly defined <code>#to_s</code>.</p>\n\n<p>Here is a link to the official documentation <a href=\"https://github.com/sferik/rails_admin/wiki/Custom-list-fields-as-HTML-tags\" rel=\"noreferrer\">https://github.com/sferik/rails_admin/wiki/Custom-list-fields-as-HTML-tags</a></p>\n"}, {"tags": [], "owner": {"reputation": 3312, "user_id": 412528, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7a781dab51284428bf9a44f3e0c85b6a?s=128&d=identicon&r=PG", "display_name": "Guillermo Siliceo Trueba", "link": "https://stackoverflow.com/users/412528/guillermo-siliceo-trueba"}, "is_accepted": false, "score": 0, "last_activity_date": 1518716623, "creation_date": 1518716623, "answer_id": 48813310, "question_id": 48792310, "link": "https://stackoverflow.com/questions/48792310/rails-admin-object-rendering-as-user-in-the-index-list-view/48813310#48813310", "title": "Rails admin object rendering as `#&lt;User:` in the index list view", "body": "<p>There\u00b4s another way\nYou can create another model </p>\n\n<p>class AdminUser &lt; User\n    def self.default_scope\n      where('roles @> ARRAY[?]::varchar[]', ['admin'])\n    end</p>\n\n<pre><code>after_initialize do\n   self.roles &lt;&lt; ['admin']\nend\n</code></pre>\n\n<p>end</p>\n\n<p>And then on the team model\nclass Team\n    belongs_to :admin_user, foreign_key: :user_id</p>\n\n<pre><code>rails_admin do\n  list do\n    field :admin_user\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>And this will not only show the right content on the Team index, but it will allow you to filter and search the teams through attributes of the admin, like name or email, also it will also allow you to create Admins with its own index and edit view. \nIt might be a bit overkill but it will definitely solve your problem too.</p>\n"}], "owner": {"reputation": 6671, "user_id": 5129131, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/j5HkF.jpg?s=128&g=1", "display_name": "Sergio Tapia", "link": "https://stackoverflow.com/users/5129131/sergio-tapia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 0, "accepted_answer_id": 48794375, "answer_count": 2, "score": 0, "last_activity_date": 1518716623, "creation_date": 1518626995, "question_id": 48792310, "link": "https://stackoverflow.com/questions/48792310/rails-admin-object-rendering-as-user-in-the-index-list-view", "title": "Rails admin object rendering as `#&lt;User:` in the index list view", "body": "<p>My model function:</p>\n\n<pre><code>def admin_user\n  users.where('roles @&gt; ARRAY[?]::varchar[]', ['admin']).first\nend\n</code></pre>\n\n<p>My admin configuration:</p>\n\n<pre><code>config.model 'Team' do\n  list do\n    field :admin_user\n  end\nend\n</code></pre>\n\n<p>It shows up like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IJ1NG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IJ1NG.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I make it link to the User admin view?</p>\n"}, {"tags": ["ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "edited": false, "score": 0, "creation_date": 1518632842, "post_id": 48792277, "comment_id": 84589923, "body": "Thanks but this would completely change the order in which things are done. It would limit an operation to only work with one kind of element. If I wanted to do a series of tasks product by product I couldn&#39;t use this approach, because in this approach things are done element name by element name."}, {"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "reply_to_user": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "edited": false, "score": 0, "creation_date": 1518664505, "post_id": 48792277, "comment_id": 84601729, "body": "@JohnSmith1976 Look at the updated version. My original example was on the terse side, of course you don&#39;t have to use the combined selector right away."}], "tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": true, "score": 2, "last_activity_date": 1518663870, "last_edit_date": 1518663870, "creation_date": 1518626917, "answer_id": 48792277, "question_id": 48792086, "link": "https://stackoverflow.com/questions/48792086/how-to-retrieve-only-elements-that-are-not-nested/48792277#48792277", "title": "How to retrieve only elements that are not nested?", "body": "<p>You can use <code>&gt;</code> to select only <code>NAME</code> elements that are direct children of <code>PRODUCT</code>:</p>\n\n<pre><code>doc.css(\"PRODUCT\").each do |product|\n  puts product.css(\"&gt; NAME\")\nend\n</code></pre>\n\n<p>This will output the following:</p>\n\n<pre><code>&lt;NAME&gt;&lt;![CDATA[Some name]]&gt;&lt;/NAME&gt;\n&lt;NAME&gt;&lt;![CDATA[Some other name]]&gt;&lt;/NAME&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1518627144, "post_id": 48792308, "comment_id": 84586908, "body": "This is dependent on the order of the XML though. If <code>CATEGORIES</code> and <code>NAME</code> ever get switched, it would return the first category&#39;s name."}, {"owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "reply_to_user": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 1, "creation_date": 1518627187, "post_id": 48792308, "comment_id": 84586949, "body": "Absolutely, your answer is way better !"}, {"owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "edited": false, "score": 0, "creation_date": 1518632895, "post_id": 48792308, "comment_id": 84589947, "body": "Thanks but this is exactly what I mentioned that I wasn&#39;t looking for."}], "tags": [], "owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1518626993, "creation_date": 1518626993, "answer_id": 48792308, "question_id": 48792086, "link": "https://stackoverflow.com/questions/48792086/how-to-retrieve-only-elements-that-are-not-nested/48792308#48792308", "title": "How to retrieve only elements that are not nested?", "body": "<p>You can use the following </p>\n\n<pre><code>doc.css(\"PRODUCT\").each do |product|\n   puts product.css(\"NAME\").first\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": false, "score": 0, "last_activity_date": 1518642813, "last_edit_date": 1518642813, "creation_date": 1518640875, "answer_id": 48795818, "question_id": 48792086, "link": "https://stackoverflow.com/questions/48792086/how-to-retrieve-only-elements-that-are-not-nested/48795818#48795818", "title": "How to retrieve only elements that are not nested?", "body": "<p>Using <a href=\"https://en.wikipedia.org/wiki/XPath\" rel=\"nofollow noreferrer\">XPath</a>:</p>\n\n<pre><code>doc.xpath(\"PRODUCTS/PRODUCT\").each do |product| \n  puts product.xpath(\"NAME\").first\nend\n</code></pre>\n\n<p><code>.xpath(\"NAME\")</code> in this case returns only immediate descendants. Same effect can be achieved with css child selector.</p>\n\n<pre><code>doc.css(\"PRODUCT\").each do |product| \n  puts product.css(\"&gt; NAME\").first\nend\n</code></pre>\n"}], "owner": {"reputation": 34, "user_id": 2226653, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/78cf12ddf9d6ac72738374643c135e14?s=128&d=identicon&r=PG", "display_name": "JohnSmith1976", "link": "https://stackoverflow.com/users/2226653/johnsmith1976"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48792277, "answer_count": 3, "score": 2, "last_activity_date": 1518663870, "creation_date": 1518626322, "question_id": 48792086, "link": "https://stackoverflow.com/questions/48792086/how-to-retrieve-only-elements-that-are-not-nested", "title": "How to retrieve only elements that are not nested?", "body": "<p>I am trying to parse some XML content, in this case with some products:</p>\n\n<pre><code>&lt;PRODUCTS&gt;\n  &lt;PRODUCT&gt;\n    &lt;NAME&gt;&lt;![CDATA[Some name]]&gt;&lt;/NAME&gt;\n    &lt;CATEGORIES&gt;\n      &lt;CATEGORY&gt;\n        &lt;NAME&gt;&lt;![CDATA[Category 1]]&gt;&lt;/NAME&gt;\n      &lt;/CATEGORY&gt;\n      &lt;CATEGORY&gt;\n        &lt;NAME&gt;&lt;![CDATA[Category 2]]&gt;&lt;/NAME&gt;\n      &lt;/CATEGORY&gt;\n    &lt;/CATEGORIES&gt;\n  &lt;/PRODUCT&gt;\n  &lt;PRODUCT&gt;\n    &lt;NAME&gt;&lt;![CDATA[Some other name]]&gt;&lt;/NAME&gt;\n    &lt;CATEGORIES&gt;\n      &lt;CATEGORY&gt;\n        &lt;NAME&gt;&lt;![CDATA[Category 1]]&gt;&lt;/NAME&gt;\n      &lt;/CATEGORY&gt;\n      &lt;CATEGORY&gt;\n        &lt;NAME&gt;&lt;![CDATA[Category 2]]&gt;&lt;/NAME&gt;\n      &lt;/CATEGORY&gt;\n    &lt;/CATEGORIES&gt;\n  &lt;/PRODUCT&gt;\n&lt;/PRODUCTS&gt;\n</code></pre>\n\n<p>If I put the above into a <code>doc</code> variable and call for the <code>NAME</code> in each product:</p>\n\n<pre><code>doc.css(\"PRODUCT\").each do |product|\n  puts product.css(\"NAME\").size # =&gt; 3\nend\n</code></pre>\n\n<p>I also get the nested <code>NAME</code> elements of each product.</p>\n\n<p>How do I get only the <code>NAME</code> that is not nested? I know that <code>product.at_css(\"NAME\")</code> returns only the first element, but my question is not how to get the first element, but rather how to get elements that are not nested.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "edited": false, "score": 1, "creation_date": 1518626135, "post_id": 48791932, "comment_id": 84586193, "body": "It says the problem is in <code>EventsController#new</code> and the error means <code>@user</code> is <code>nil</code>, so <code>User.find_by_email(params[:email])</code> doesn&#39;t return a user."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 9164069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a76cf933419cf5da005cdc3cc771d5?s=128&d=identicon&r=PG&f=1", "display_name": "neznidalibor", "link": "https://stackoverflow.com/users/9164069/neznidalibor"}, "is_accepted": false, "score": 0, "last_activity_date": 1518628250, "creation_date": 1518628250, "answer_id": 48792719, "question_id": 48791932, "link": "https://stackoverflow.com/questions/48791932/undefined-method-created-events-for-nilnilclass/48792719#48792719", "title": "undefined method &#39;created_events&#39; for nil:NilClass", "body": "<p><code>User.find_by_email(params[:email])</code> does not find a user with the email parameter you pass to it so there's your problem.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9361034, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pedro Santana", "link": "https://stackoverflow.com/users/9361034/pedro-santana"}, "edited": false, "score": 1, "creation_date": 1518649402, "post_id": 48793386, "comment_id": 84597898, "body": "Thanks, it worked. I changed it to find the user by the current_user.id instead of email."}], "tags": [], "owner": {"reputation": 26, "user_id": 9361376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ujrWU.jpg?s=128&g=1", "display_name": "Shrikant Banke", "link": "https://stackoverflow.com/users/9361376/shrikant-banke"}, "is_accepted": true, "score": 0, "last_activity_date": 1518630720, "creation_date": 1518630720, "answer_id": 48793386, "question_id": 48791932, "link": "https://stackoverflow.com/questions/48791932/undefined-method-created-events-for-nilnilclass/48793386#48793386", "title": "undefined method &#39;created_events&#39; for nil:NilClass", "body": "<p>There is no such user exists in your database with the email which is returned by <code>params[:email]</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 9361034, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pedro Santana", "link": "https://stackoverflow.com/users/9361034/pedro-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 48793386, "answer_count": 2, "score": 0, "last_activity_date": 1518630720, "creation_date": 1518625785, "question_id": 48791932, "link": "https://stackoverflow.com/questions/48791932/undefined-method-created-events-for-nilnilclass", "title": "undefined method &#39;created_events&#39; for nil:NilClass", "body": "<p>I'm coding a project from \"The Odin Project\" about Rails Associations. I thought I had get the topic pretty well, but I hit a block.</p>\n\n<p>I'm getting a <strong>NoMethodError in EventsController#new</strong> // <strong>Undefined method 'created_events' for nil:NilClass</strong></p>\n\n<p>Here's my User Model:</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_secure_password\n\n  has_many :created_events, :foreign_key =&gt; :creator_id, :class_name =&gt; 'Event', :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>Event Model:</p>\n\n<pre><code>class Event &lt; ApplicationRecord\n  belongs_to :creator, :class_name =&gt; 'User'\nend\n</code></pre>\n\n<p>EventsController:</p>\n\n<pre><code>class EventsController &lt; ApplicationController\n  def index\n    @events = Event.all\n  end\n\n  def show\n    @event = Event.find(params[:id])\n  end\n\n  def new\n    @user = User.find_by_email(params[:email])\n    @created_event = @user.created_events.build\n  end\n\n  def create\n    @user = User.find_by_email(params[:email])\n    @created_event = @user.created_events.build(event_params)\n\n    if @created_event.save\n      flash[:notice] = \"Event was successfully created!\"\n      redirect_to @created_event\n    else\n      render 'new'\n    end\n  end\n\n  private\n    def event_params\n      params.require(:event).permit(:name, :location, :date, :description)\n    end\nend\n</code></pre>\n\n<p>And my 'new' view, which I'm not sure it's 100% correct given I've messed with it a bit.</p>\n\n<pre><code>&lt;h1&gt;New Event&lt;/h1&gt;\n&lt;%= form_for @created_event do |f| %&gt;\n  &lt;p&gt;\n    &lt;%= f.label :name %&gt;&lt;br&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.label :location %&gt;&lt;br&gt;\n    &lt;%= f.text_field :location %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.label :date %&gt;&lt;br&gt;\n    &lt;%= f.text_field :date %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.label :description %&gt;&lt;br&gt;\n    &lt;%= f.text_area :description %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>For simplicity, I've included the form on the page, although in my project I've it stashed in a partial.</p>\n\n<p><strong>I've tested 'created_events' in the rails console, and it worked but on the site, it gives me the error.</strong></p>\n\n<p>If someone can tell me how to fix this, and what I'm doing wrong it would be much appreciated.</p>\n"}, {"tags": ["ruby", "rspec", "jruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518625975, "post_id": 48791502, "comment_id": 84586097, "body": "How do you terminate the heartbeat thread in your code, i.e. outside RSpec?"}, {"owner": {"reputation": 83, "user_id": 2183512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ab7b5abb814b040b136d6f15fc76f?s=128&d=identicon&r=PG", "display_name": "Ultimation", "link": "https://stackoverflow.com/users/2183512/ultimation"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518626124, "post_id": 48791502, "comment_id": 84586184, "body": "I don&#39;t, I expect it to continue unless something kills the ruby process or it gets an exception"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2183512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ab7b5abb814b040b136d6f15fc76f?s=128&d=identicon&r=PG", "display_name": "Ultimation", "link": "https://stackoverflow.com/users/2183512/ultimation"}, "edited": false, "score": 0, "creation_date": 1518684743, "post_id": 48792980, "comment_id": 84608975, "body": "Doh, I had that in my code but managed to write the wrong one on this post. You&#39;re right though that it does what I desire - just not sure if that&#39;s how it <i>should</i> be done"}, {"owner": {"reputation": 165, "user_id": 9164069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a76cf933419cf5da005cdc3cc771d5?s=128&d=identicon&r=PG&f=1", "display_name": "neznidalibor", "link": "https://stackoverflow.com/users/9164069/neznidalibor"}, "reply_to_user": {"reputation": 83, "user_id": 2183512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ab7b5abb814b040b136d6f15fc76f?s=128&d=identicon&r=PG", "display_name": "Ultimation", "link": "https://stackoverflow.com/users/2183512/ultimation"}, "edited": false, "score": 1, "creation_date": 1518730037, "post_id": 48792980, "comment_id": 84637019, "body": "You could always stub the behavior of your class for everything you&#39;re not testing. In this case you could do away with the <code>after</code> block and then do something like <code>allow_any_instance_of(Thread).to receive(:new).and_call_original</code> and <code>allow_any_instance_of(Thread).to receive(:kill).and_call_original</code> if I&#39;m getting your problem correctly."}], "tags": [], "owner": {"reputation": 165, "user_id": 9164069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a76cf933419cf5da005cdc3cc771d5?s=128&d=identicon&r=PG&f=1", "display_name": "neznidalibor", "link": "https://stackoverflow.com/users/9164069/neznidalibor"}, "is_accepted": true, "score": 1, "last_activity_date": 1518629145, "creation_date": 1518629145, "answer_id": 48792980, "question_id": 48791502, "link": "https://stackoverflow.com/questions/48791502/how-can-i-make-sure-threads-inside-my-class-end-after-each-rspec-test/48792980#48792980", "title": "How can I make sure threads inside my class end after each rspec test?", "body": "<p>You should replace <code>after(:all)</code> with <code>after(:each)</code>.</p>\n\n<p>Should be the correct syntax for what you want to do because <code>after(:all)</code> evaluates after all test cases have been run.</p>\n"}], "owner": {"reputation": 83, "user_id": 2183512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4ab7b5abb814b040b136d6f15fc76f?s=128&d=identicon&r=PG", "display_name": "Ultimation", "link": "https://stackoverflow.com/users/2183512/ultimation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 48792980, "answer_count": 1, "score": 1, "last_activity_date": 1518629145, "creation_date": 1518624446, "last_edit_date": 1518628253, "question_id": 48791502, "link": "https://stackoverflow.com/questions/48791502/how-can-i-make-sure-threads-inside-my-class-end-after-each-rspec-test", "title": "How can I make sure threads inside my class end after each rspec test?", "body": "<p>I have a jruby class which contains a heartbeat that does something every certain number of seconds: (simplified code below)</p>\n\n<pre><code>class Client\n  def initialise\n    @interval = 30\n    @heartbeat = Thread.new do\n      begin\n        loop do\n          puts \"heartbeat\"\n          sleep @interval\n        end\n      rescue Exception =&gt; e\n        Thread.main.raise e\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And I have a range of rspec tests that instantiate this class. </p>\n\n<p>At the end of each test, I would expect the object to be destroyed, but the threads seem to remain. </p>\n\n<p>At the moment I've fixed this with:\nclient.rb:</p>\n\n<pre><code>def kill\n    @heartbeat.kill\nend\n</code></pre>\n\n<p>rspec:</p>\n\n<pre><code>after(:all) do\n   client.kill\nend\n</code></pre>\n\n<p>Which seems to do the job - but this doesn't feel like the best way to do it. </p>\n\n<p>What is the best way to approach this?</p>\n\n<p>Using version jruby-9.1.10.0 &amp; rspec 3.7.0</p>\n\n<p>Edit:\nAs per <a href=\"http://ruby-doc.org/core-2.4.0/Thread.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/core-2.4.0/Thread.html</a> I would expect the thread to normally terminate when the main thread does\nIn my tests I instantiate the client with</p>\n\n<pre><code>describe Client do\n  context 'bla' do\n    let(:client) do\n      described_class.new\n    end\n    it 'blas' do\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "amazon-ec2"], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 4559663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NB6G_b8nD3s/AAAAAAAAAAI/AAAAAAAAAVI/JP0eQUa6kXY/photo.jpg?sz=128", "display_name": "Raushan", "link": "https://stackoverflow.com/users/4559663/raushan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518698917, "last_edit_date": 1518698917, "creation_date": 1518698512, "answer_id": 48807585, "question_id": 48791403, "link": "https://stackoverflow.com/questions/48791403/how-to-convert-a-ruby-struct-of-awsec2typestag-to-a-normal-ruby-hashes/48807585#48807585", "title": "How to convert a ruby struct of Aws::EC2::Types::Tag to a normal ruby hashes", "body": "<pre><code>The data was something like this.\n\n&lt;struct Aws::EC2::Types::Tag key=\"Env\", value=\"Dev\"&gt;\n&lt;struct Aws::EC2::Types::Tag key=\"role\", value=\"test-app\"&gt;\n&lt;struct Aws::EC2::Types::Tag key=\"stack\", value=\"next\"&gt;\n\nThis is the array of ruby structure of Aws::EC2::Types::Tag type. \n</code></pre>\n\n<p>I had these data in a variable i.e. tags. I am fetching tags details of an existing AWS instance. I am using ruby AWS SDK version 3. So what i did to get the key and value from the respective data. </p>\n\n<pre><code>@@instance = Aws::EC2::Instance.new(instance_id)\n@@tags = instance.tags\ntags.each do |tg|\n      temp_tg=tg.to_h\n      if temp_tg[:key] == \"stack\"\n           stack = temp_tg[:value]\n           #puts stack\n      end\n      if temp_tg[:key] == \"role\"\n           role = temp_tg[:value]\n           #puts role\n      end\n      if temp_tg[:key] == \"Env\"\n           Env = temp_tg[:value]\n           #puts Env\n      end\nend\n</code></pre>\n\n<p>It worked for me. There may be some other great ways to achieve this.\nI'll appreciate if anyone gives a better version or approach of this. Thanks in advance.</p>\n"}], "owner": {"reputation": 127, "user_id": 4559663, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NB6G_b8nD3s/AAAAAAAAAAI/AAAAAAAAAVI/JP0eQUa6kXY/photo.jpg?sz=128", "display_name": "Raushan", "link": "https://stackoverflow.com/users/4559663/raushan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518698917, "creation_date": 1518624162, "last_edit_date": 1518638150, "question_id": 48791403, "link": "https://stackoverflow.com/questions/48791403/how-to-convert-a-ruby-struct-of-awsec2typestag-to-a-normal-ruby-hashes", "title": "How to convert a ruby struct of Aws::EC2::Types::Tag to a normal ruby hashes", "body": "<p>Anyone could you please help me on how to get value for the key 'stack' from below ruby struct. This struct has returned when i fetched details of an instance and did</p>\n\n<p>instance.tags \n<a href=\"https://i.stack.imgur.com/e6tDa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e6tDa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "selenium-webdriver", "cucumber"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7733695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ed6267f407450ce9b63a481cf5d67f?s=128&d=identicon&r=PG&f=1", "display_name": "J. Schulte", "link": "https://stackoverflow.com/users/7733695/j-schulte"}, "is_accepted": false, "score": 0, "last_activity_date": 1520351463, "creation_date": 1520351463, "answer_id": 49134923, "question_id": 48791185, "link": "https://stackoverflow.com/questions/48791185/cucumber-ruby-reports-error-cant-modify-frozen-string-runtimeerror/49134923#49134923", "title": "cucumber ruby reports error &quot;can&#39;t modify frozen String (RunTimeError)&quot;", "body": "<p>This is a cucumber problem. If you want to track it, it's logged here: </p>\n\n<p><a href=\"https://github.com/cucumber/cucumber-ruby/issues/1240\" rel=\"nofollow noreferrer\">https://github.com/cucumber/cucumber-ruby/issues/1240</a></p>\n"}], "owner": {"reputation": 1126, "user_id": 4927393, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-7rRm-826oe4/AAAAAAAAAAI/AAAAAAAAIQ8/jBtS640nEeU/photo.jpg?sz=128", "display_name": "Dragan Nikolic", "link": "https://stackoverflow.com/users/4927393/dragan-nikolic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 759, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520351463, "creation_date": 1518623500, "question_id": 48791185, "link": "https://stackoverflow.com/questions/48791185/cucumber-ruby-reports-error-cant-modify-frozen-string-runtimeerror", "title": "cucumber ruby reports error &quot;can&#39;t modify frozen String (RunTimeError)&quot;", "body": "<p>I created automated tests for a web application using Ruby Cucumber (v3.1.0) and Selenium WebDriver.</p>\n\n<p>Some failed tests cause also Cucumber to crash with the following error: \"can't modify frozen String (RunTimeError)\". At that point test execution is stopped and no report is generated. </p>\n\n<p>Could anybody explain what is the root cause for this? I wonder if this is Cucumber or WebDriver issue, or simply I do not use them properly. Anybody seen this? Thanks in advance.</p>\n\n<p>Here is the Cucumber output:</p>\n\n<pre><code>  Scenario: Verify Pool link verification                 # features/home/pool.feature:19\n    When I click on the Pool link on Backoffice Home Page # step_definitions/pool_steps.rb:9\n      timed out after 30 seconds, waiting for #&lt;Watir::Anchor: located: false; {:href=&gt;\"/backoffice/pool/info\", :index=&gt;, :tag_name=&gt;\"a\"}&gt; to be located (Watir::Exception::UnknownObjectException)\n      (eval):1:in `process_watir_call'\n      ./step_definitions/pool_steps.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n      ./step_definitions/pool_steps.rb:10:in `\"I click on the Pool link on Backoffice Home Page\"'\n      features/home/pool.feature:20:in `When I click on the Pool link on Backoffice Home Page'\n\ncan't modify frozen String (RuntimeError)\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/html.rb:571:in `snippet'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/html.rb:293:in `extra_failure_content'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/html.rb:435:in `build_exception_detail'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/html.rb:288:in `exception'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/ignore_missing_messages.rb:11:in `method_mising'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/ast.rb:181:in `print_exception'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/ast.rb:116:in `accept'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:580:in `step_invocatin'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:543:in `step_invocatin'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:387:in `print_step'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:251:in `after_test_stp'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:107:in `after_test_stp'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/formatter/legacy_api/adapter.rb:31:in `block in initilize'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/event_bus.rb:34:in `block in broadcast'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/event_bus.rb:34:in `each'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/event_bus.rb:34:in `broadcast'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/event_bus.rb:40:in `method_missing'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/runner.rb:35:in `around_hook'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/around_hook.rb:12:in `describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:120:in `block (2 levels) in copose_around_hooks'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:121:in `compose_around_hooks'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:26:in `block in describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/runner.rb:19:in `test_case'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:25:in `describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/prepare_world.rb:12:in `test_case'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:25:in `describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:57:in `test_case'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/retry.rb:18:in `test_case'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:25:in `describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/quit.rb:12:in `test_case'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/case.rb:25:in `describe_to'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/broadcast_test_run_started_event.rb:20:in `blck in done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/broadcast_test_run_started_event.rb:19:in `ma'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/filters/broadcast_test_run_started_event.rb:19:in `doe'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/filters/locations_filter.rb:20:in `don'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/filter.rb:62:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/test/filters/tag_filter.rb:18:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/compiler.rb:24:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core/gherkin/parser.rb:37:in `done'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core.rb:32:in `parse'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-core-3.1.0/lib/cucumber/core.rb:21:in `compile'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/runtime.rb:74:in `run!'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/lib/cucumber/cli/main.rb:33:in `execute!'\nC:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/cucumber-3.1.0/bin/cucumber:9:in `&lt;top (required)&gt;'\nC:/Ruby24-x64/bin/cucumber:23:in `load'\nC:/Ruby24-x64/bin/cucumber:23:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "macos", "visual-studio"], "comments": [{"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 2, "creation_date": 1518618374, "post_id": 48789079, "comment_id": 84580746, "body": "No, that is not normal. But from the information you&#39;ve given I can not determine what would be the issue. Your ruby code, at least what you provided, can not cause this issue on its own. You need to provide some more information on how you execute this piece of code."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1518619141, "post_id": 48789079, "comment_id": 84581336, "body": "Are you running the Ruby code from within Visual Studio? It might be doing something weird when it runs your script. Do you get the same issue when running it from the terminal with just <code>ruby bookTwo.rb</code>?"}, {"owner": {"reputation": 41, "user_id": 9286166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafa4e7c857d5d5ed156249bb713f824?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rhamdani", "link": "https://stackoverflow.com/users/9286166/f-rhamdani"}, "reply_to_user": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 0, "creation_date": 1518620155, "post_id": 48789079, "comment_id": 84582053, "body": "@SanderSaelmans yes, i just use the exact same code as i put here to take the screenshoot and the running files, memory thing.  Sorry i forgot to mention, i run this program in the Visual Studio terminal, i though it will be the same as a Mac build-in terminal"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518620572, "post_id": 48789079, "comment_id": 84582367, "body": "Why is that code running for 39+ seconds? It should print 3 and exit."}, {"owner": {"reputation": 41, "user_id": 9286166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafa4e7c857d5d5ed156249bb713f824?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rhamdani", "link": "https://stackoverflow.com/users/9286166/f-rhamdani"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1518620744, "post_id": 48789079, "comment_id": 84582481, "body": "@Max yes, i run the code in Visual Code. I run the code several times in Mac&#39;s terminal but it seem the process does not appear as high as I run in the Visual Code&#39;s terminal, it even just sitting in around 0%.  maybe there is something wrong with the Visual Code terminal?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518621141, "post_id": 48789079, "comment_id": 84582745, "body": "@StefanPochmann that 99% is relative to one core (so it can be above 100%), whereas 86% refers to all cores (cannot be above 100%). It&#39;s probably an 8-core machine (or 4 with hyperthreading)."}, {"owner": {"reputation": 41, "user_id": 9286166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafa4e7c857d5d5ed156249bb713f824?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rhamdani", "link": "https://stackoverflow.com/users/9286166/f-rhamdani"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518621256, "post_id": 48789079, "comment_id": 84582814, "body": "@Stefan thank you for the answer.  For your question, may I know where do you know the code is running for 39+ seconds? And you are right, the code should just print 3 and then exit  EDIT: nevermind, i just realized its in my screenshoot."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518621423, "post_id": 48789079, "comment_id": 84582935, "body": "@F.Rhamdani &quot;CPU Time&quot; says 39.28 \u2013 maybe you are looking at the wrong process?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1518621546, "post_id": 48789079, "comment_id": 84583027, "body": "If I understand correctly, you&#39;re confirming that the slowness only happens in the Visual Code terminal, not a general terminal. So my guess is that it has nothing to do with Ruby, but something about how Visual Code manages the processes launched by its terminal."}, {"owner": {"reputation": 41, "user_id": 9286166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafa4e7c857d5d5ed156249bb713f824?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rhamdani", "link": "https://stackoverflow.com/users/9286166/f-rhamdani"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518621923, "post_id": 48789079, "comment_id": 84583282, "body": "@Stefan I don&#39;t think so, because the process is calling my ruby file according to the process activity log i provide above."}, {"owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "edited": false, "score": 0, "creation_date": 1518623017, "post_id": 48789079, "comment_id": 84583967, "body": "Have you restarted your computer, and ran the same code from the terminal monitoring the CPU usage? Not visual studio, I would eliminate that program in the meantime until you solve this problem. I have just recently began programming in c# on my Mac using visual studio and it constantly has bugs in the IDE"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1518634092, "post_id": 48789079, "comment_id": 84590552, "body": "If you just google &quot;visual studio high cpu on Mac&quot; you may note you are not the only one with this problem and it is not limited to ruby code"}, {"owner": {"reputation": 2204, "user_id": 4003349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyMqf.jpg?s=128&g=1", "display_name": "Legendary", "link": "https://stackoverflow.com/users/4003349/legendary"}, "edited": false, "score": 0, "creation_date": 1584558121, "post_id": 48789079, "comment_id": 107476285, "body": "Hey, mate, got same problem, while using RubyMine - Ive used yarn to install material-design-icons and then BOOM, 99.7% CPU usage from &#39;ruby&#39;. I guess RubyMine is trying to index all this icons (around 89k files)"}], "owner": {"reputation": 41, "user_id": 9286166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aafa4e7c857d5d5ed156249bb713f824?s=128&d=identicon&r=PG&f=1", "display_name": "F. Rhamdani", "link": "https://stackoverflow.com/users/9286166/f-rhamdani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1518637196, "creation_date": 1518616970, "last_edit_date": 1518637196, "question_id": 48789079, "link": "https://stackoverflow.com/questions/48789079/ruby-99-cpu-usage-on-mac", "title": "Ruby 99% ++ CPU Usage on Mac", "body": "<p>I have a problem in running Ruby in my Mac machine. I've been google for a while but not found satisfying answer, so i decided to ask myself.</p>\n\n<p>I run some simple ruby code using Visual Studio Code and i see something odd. The ruby process is taking 99%++ CPU usage.</p>\n\n<p><img src=\"https://i.stack.imgur.com/js3Lz.png\" alt=\"\"></p>\n\n<p>As you can see, it taking 99% CPU usage just for a single simple code. It will still running until i force quit the service and sometimes there is not just one process.</p>\n\n<p>this is the code that i run:</p>\n\n<pre><code>range1 = 1..5\nsomething = 3\nsomething.to_s\nprint something\n</code></pre>\n\n<p>this is the... running files, memory location things (i don't know what it called) in the Ruby service:</p>\n\n<pre><code>cwd\n/\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/bin/ruby\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/libruby.2.5.0.dylib\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/enc/encdb.bundle\ntxt\n/usr/local/Cellar/gmp/6.1.2_1/lib/libgmp.10.dylib\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/enc/trans/transdb.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/stringio.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/etc.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/pathname.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/openssl.bundle\ntxt\n/usr/local/Cellar/openssl@1.1/1.1.0g_1/lib/libssl.1.1.dylib\ntxt\n/usr/local/Cellar/openssl@1.1/1.1.0g_1/lib/libcrypto.1.1.dylib\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/digest.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/io/nonblock.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/zlib.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/digest/sha1.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/socket.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/io/wait.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/enc/windows_31j.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/json/ext/parser.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/json/ext/generator.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/readline.bundle\ntxt\n/usr/local/Cellar/readline/7.0.3_1/lib/libreadline.7.0.dylib\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/strscan.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/date_core.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/cgi/escape.bundle\ntxt\n/Users/konzaho/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/x86_64-darwin17/digest/md5.bundle\ntxt\n/usr/lib/dyld\ntxt\n/private/var/db/dyld/dyld_shared_cache_x86_64h\n0\n-&gt;0x369452a54d0e4c31\n1\n-&gt;0x369452a54d0e4911\n2\n-&gt;0x369452a54d0e38a9\n3\n-&gt;0x369452a54b81a3e9\n4\n-&gt;0x369452a54b81b769\n5\n-&gt;0x369452a54b81a569\n6\n-&gt;0x369452a54d0e38a9\n7\n-&gt;0x369452a54b81bb29\n8\n[ctl com.apple.netsrc id 9 unit 27]\n9\n-&gt;0x369452a54d0e5271\n10\nlocalhost:59277\n11\nlocalhost:59277\n12\n-&gt;0x369452a54b81a0e9\n13\n-&gt;0x369452a54b81a4a9\n14\nlocalhost:59277-&gt;localhost:59285\n15\nlocalhost:59277-&gt;localhost:59286\n16\nlocalhost:59277-&gt;localhost:59287\n24\n-&gt;0x369452a5536d6789\n25\n/Applications/Visual Studio Code.app/Contents/Resources/electron.asar\n27\n/Users/konzaho/Devs/ruby/bookTwo.rb\n</code></pre>\n\n<p>Is it normal for Ruby to taking this much of CPU power just to run a simple code?\nYes, of course i can just instantly force quit the process, but it kind of annoying to do it every time you close the editor and it heated up my machine too.</p>\n\n<p>EDIT:\nI run this code in the Visual Code's terminal and the </p>\n\n<blockquote>\n  <p>bookTwo.rb</p>\n</blockquote>\n\n<p>i exactly the same code as I mention above. Now I run the code in the Mac's terminal but it does not have the problem as I run in the VS Code terminal.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "integration-testing", "actiondispatch"], "comments": [{"owner": {"reputation": 1277, "user_id": 1737811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ab510b7d0d145c538fcc7638395ee703?s=128&d=identicon&r=PG", "display_name": "mutantkeyboard", "link": "https://stackoverflow.com/users/1737811/mutantkeyboard"}, "edited": false, "score": 0, "creation_date": 1518621822, "post_id": 48788810, "comment_id": 84583209, "body": "Might be only that you mised a colon on your params, so instead of <code>post sign_up_path, params { username: &#39;arnold&#39;, password: &#39;123&#39; }</code>,  try <code>post sign_up_path, params: { username: &#39;arnold&#39;, password: &#39;123&#39; }</code>, additionally check sign_in_path."}, {"owner": {"reputation": 303, "user_id": 889345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c556e2b4b9fb8400198e69463c2c5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/889345/simon"}, "reply_to_user": {"reputation": 1277, "user_id": 1737811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ab510b7d0d145c538fcc7638395ee703?s=128&d=identicon&r=PG", "display_name": "mutantkeyboard", "link": "https://stackoverflow.com/users/1737811/mutantkeyboard"}, "edited": false, "score": 0, "creation_date": 1518688998, "post_id": 48788810, "comment_id": 84611588, "body": "Nope, just a typo when writing the question, but good catch :)"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 889345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c556e2b4b9fb8400198e69463c2c5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/889345/simon"}, "edited": false, "score": 0, "creation_date": 1518689566, "post_id": 48790740, "comment_id": 84611976, "body": "I&#39;m getting <code>Uncaught exception: uninitialized constant Dispatcher </code>. That article is very old indeed. Couldn&#39;t find anything useful in the rails guide either. There&#39;s a middleware called <code>ActionDispatch::ShowExceptions</code> but it&#39;s already included in my project. I also have the following configuration for the test environment:  <code>config.action_dispatch.show_exceptions = true</code>"}, {"owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "reply_to_user": {"reputation": 303, "user_id": 889345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c556e2b4b9fb8400198e69463c2c5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/889345/simon"}, "edited": false, "score": 0, "creation_date": 1518689820, "post_id": 48790740, "comment_id": 84612156, "body": "Have you tried just the first block about the controller?"}, {"owner": {"reputation": 303, "user_id": 889345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c556e2b4b9fb8400198e69463c2c5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/889345/simon"}, "edited": false, "score": 0, "creation_date": 1518694168, "post_id": 48790740, "comment_id": 84614982, "body": "I did now, no difference :("}, {"owner": {"reputation": 151, "user_id": 2737320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84f777ecb4e2eee0e452ab2bcca1217?s=128&d=identicon&r=PG", "display_name": "BLewis", "link": "https://stackoverflow.com/users/2737320/blewis"}, "edited": false, "score": 0, "creation_date": 1521218140, "post_id": 48790740, "comment_id": 85652643, "body": "@rwold My biggest problem with this issue is that it won&#39;t work if the scenario in which you are testing is one where you expect an error HTTP status (e.g. testing uploading a file with an invalid format) but not the error HTTP status produced (e.g. authentication failed). If you take a look at my answer, it will allow you to test error statuses and still log the error stacktrace when the status is not the one you expected."}], "tags": [], "owner": {"reputation": 1266, "user_id": 6022100, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/dc0adea29934c8ee1c31f96bf85a7fbc?s=128&d=identicon&r=PG", "display_name": "rwold", "link": "https://stackoverflow.com/users/6022100/rwold"}, "is_accepted": false, "score": 0, "last_activity_date": 1518622669, "last_edit_date": 1518622669, "creation_date": 1518622162, "answer_id": 48790740, "question_id": 48788810, "link": "https://stackoverflow.com/questions/48788810/actiondispatchintegrationtest-suppresses-exceptions/48790740#48790740", "title": "ActionDispatch::IntegrationTest suppresses exceptions", "body": "<p>This will happen because Rails controllers by default handle exceptions and raise the 500 status, making the exceptions invisible to the test suite (which is very helpful if errors are raised in unit tests of a model). Options for disabling this in your test suite, or alternative workarounds, are discussed <a href=\"https://www.dan-manges.com/blog/debugging-rails-integration-tests\" rel=\"nofollow noreferrer\" title=\"debugging rails integration tests\">here</a>.</p>\n\n<p>The key lines of code from that link, which should be added to <code>test/integration/integration_test_helper.rb</code>:</p>\n\n<pre><code>ActionController::Base.class_eval do\n  def perform_action\n    perform_action_without_rescue\n  end\nend\n\nDispatcher.class_eval do\n  def self.failsafe_response(output, status, exception = nil)\n    raise exception\n  end\nend\n</code></pre>\n\n<p>EDIT: I've noticed that that link is quite old now. I'm really familiar with Rack, so whilst the first block looks ok to me, I'm not sure if the second will still be current. You might need to have a look at <a href=\"http://guides.rubyonrails.org/rails_on_rack.html#action-dispatcher-middleware-stack%20Rails%20on%20Rack\" rel=\"nofollow noreferrer\">the relevant current Rails guide</a> if it needs bringing up to date.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 2737320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84f777ecb4e2eee0e452ab2bcca1217?s=128&d=identicon&r=PG", "display_name": "BLewis", "link": "https://stackoverflow.com/users/2737320/blewis"}, "is_accepted": true, "score": 1, "last_activity_date": 1521218408, "last_edit_date": 1521218408, "creation_date": 1521218001, "answer_id": 49325576, "question_id": 48788810, "link": "https://stackoverflow.com/questions/48788810/actiondispatchintegrationtest-suppresses-exceptions/49325576#49325576", "title": "ActionDispatch::IntegrationTest suppresses exceptions", "body": "<p>My recommended approach to this issue would be to actually parse the response provided by Rails (at least by default in <code>test</code> and <code>development</code> environments) which includes the stacktrace for the error and handle that in the case that your test fails. This has the advantage that it won't output the stacktrace when errors are raised that don't result in failing tests (e.g. scenarios where you are intentionally testing how failures are handled).</p>\n\n<p>This little module that I've crafted will allow you to call <code>assert_response_with_errors</code> to assert the response to a call but output the exception message and stack trace in a readable format when the response is not what you expected.</p>\n\n<pre><code>module ActionDispatch\n  module Assertions\n    module CustomResponseAssertions\n      # Use this method when you want to assert a response body but also print the exception\n      # and full stack trace to the test console.\n      # Useful when you are getting errors in integration tests but don't know what they are.\n      #\n      # Example:\n      # user_session.post create_gene_path, params: {...}\n      # user_session.assert_response_with_errors :created\n      def assert_response_with_errors(type, message = nil)\n        assert_response(type, message)\n      rescue Minitest::Assertion =&gt; e\n        message = e.message\n        message += \"\\nException message: #{@response.parsed_body[:exception]}\"\n        stack_trace = @response.parsed_body[:traces][:'Application Trace'].map { |line| line[:trace] }.join \"\\n\"\n        message += \"\\nException stack trace start\"\n        message += \"\\n#{stack_trace}\"\n        message += \"\\nException stack trace end\"\n        raise Minitest::Assertion, message\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>To use this, you need to include it into ActionDispatch::Assertions before Rails has loaded its stack in your <code>test_helper.rb</code>. So just prepend the include into your <code>test_helper.rb</code>, like this:</p>\n\n<pre><code>ActionDispatch::Assertions.include ActionDispatch::Assertions::CustomResponseAssertions\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\n...\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 889345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c556e2b4b9fb8400198e69463c2c5f9?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/889345/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "accepted_answer_id": 49325576, "answer_count": 2, "score": 1, "last_activity_date": 1521218408, "creation_date": 1518616228, "last_edit_date": 1518688956, "question_id": 48788810, "link": "https://stackoverflow.com/questions/48788810/actiondispatchintegrationtest-suppresses-exceptions", "title": "ActionDispatch::IntegrationTest suppresses exceptions", "body": "<p>When debugging failing integration tests, I keep running into the same problem where the exceptions raised in my code are suppressed and not shown in the testing output. </p>\n\n<p>For example, for the following controller and test:</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>class RegistrationController::ApplicationController\n  def create\n    # some code that raises an exception\n  end\nend\n</code></pre>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>class RegistrationFlowTest &lt; ActionDispatch::IntegrationTest\n\n  test 'user registers successfully' do\n    post sign_up_path, params: { username: 'arnold', password: '123' }\n    assert_response :success  \n  end\n\nend\n</code></pre>\n\n<p>The output is something like</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Minitest::Assertion: Expected response to be a &lt;2XX: success&gt;, but was a &lt;500: Internal Server Error&gt;\n</code></pre>\n\n<p>Is there a way to see the exact raised exception? Instead of just the difference of HTTP response code?</p>\n\n<p>Thanks!</p>\n\n<p>Simon</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-migrations", "sequel"], "comments": [{"owner": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1518613177, "post_id": 48787422, "comment_id": 84577236, "body": "try removing  require &#39;rails/all&#39; from application.rb."}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518613581, "post_id": 48787422, "comment_id": 84577484, "body": "do you have migration file already ? and you try to create new migration ?"}, {"owner": {"reputation": 178, "user_id": 4125803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f61e4efa02370eb4143b60390b973a34?s=128&d=identicon&r=PG", "display_name": "R.P.", "link": "https://stackoverflow.com/users/4125803/r-p"}, "reply_to_user": {"reputation": 2537, "user_id": 5371321, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ZFyVo.jpg?s=128&g=1", "display_name": "Narasimha Reddy - Geeker", "link": "https://stackoverflow.com/users/5371321/narasimha-reddy-geeker"}, "edited": false, "score": 0, "creation_date": 1518613718, "post_id": 48787422, "comment_id": 84577567, "body": "@NarasimhaReddy, removing <code>rails&#47;all</code> throws: &quot;Don&#39;t know how to build task &#39;db:migrate&#39; (see --tasks)&quot;"}, {"owner": {"reputation": 178, "user_id": 4125803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f61e4efa02370eb4143b60390b973a34?s=128&d=identicon&r=PG", "display_name": "R.P.", "link": "https://stackoverflow.com/users/4125803/r-p"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518613783, "post_id": 48787422, "comment_id": 84577610, "body": "@Vishal, yes. the migration filed is mentioned in the question: &quot;And my migration <code>20180214121521_create_users.rb</code> content is:      Sequel.migration do       change do       create_table :users do         primary_key :id       end     end   end&quot;"}, {"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518614075, "post_id": 48787422, "comment_id": 84577801, "body": "@RalucaP. did you configure your <code>config&#47;environments&#47;development.rb</code> <code>config&#47;initializers&#47;new_framework_defaults.rb</code>"}, {"owner": {"reputation": 178, "user_id": 4125803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f61e4efa02370eb4143b60390b973a34?s=128&d=identicon&r=PG", "display_name": "R.P.", "link": "https://stackoverflow.com/users/4125803/r-p"}, "reply_to_user": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518614205, "post_id": 48787422, "comment_id": 84577879, "body": "@Vishal, I generated the app with <code>--skip-active-record</code>."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 4125803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f61e4efa02370eb4143b60390b973a34?s=128&d=identicon&r=PG", "display_name": "R.P.", "link": "https://stackoverflow.com/users/4125803/r-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1521107119, "creation_date": 1521107119, "answer_id": 49296039, "question_id": 48787422, "link": "https://stackoverflow.com/questions/48787422/rake-dbmigrate-with-rails-5-1-4-sqlite3-and-sequel-rails-gives-nameerror/49296039#49296039", "title": "rake db:migrate with rails &#39;~&gt; 5.1.4&#39;, sqlite3 and sequel-rails gives NameError: uninitialized constant", "body": "<p>The solution was to remove: <code>require 'rails/all'</code> and the <code>config.sequel.load_database_tasks = :sequel</code>. I works fine now.</p>\n"}], "owner": {"reputation": 178, "user_id": 4125803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f61e4efa02370eb4143b60390b973a34?s=128&d=identicon&r=PG", "display_name": "R.P.", "link": "https://stackoverflow.com/users/4125803/r-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 49296039, "answer_count": 1, "score": 0, "last_activity_date": 1521107119, "creation_date": 1518611843, "last_edit_date": 1518637081, "question_id": 48787422, "link": "https://stackoverflow.com/questions/48787422/rake-dbmigrate-with-rails-5-1-4-sqlite3-and-sequel-rails-gives-nameerror", "title": "rake db:migrate with rails &#39;~&gt; 5.1.4&#39;, sqlite3 and sequel-rails gives NameError: uninitialized constant", "body": "<p>I'm working on a simple application with the following gems: </p>\n\n<pre><code>gem 'rails', '~&gt; 5.1.4'\ngem 'sqlite3'\ngem 'sequel-rails'\n</code></pre>\n\n<p>When I try to create any migration, following the <a href=\"https://github.com/TalentBox/sequel-rails\" rel=\"nofollow noreferrer\">instructions</a>, I get the \"rake aborted!\nNameError: uninitialized constant\" error. For example, if I'm running this:\n<code>rails generate migration create_users</code>, the output error would be: </p>\n\n<pre><code>rake aborted!\nNameError: uninitialized constant CreateUsers\n</code></pre>\n\n<p>Same happens with any model generation.\nMy <code>application.rb</code> file reads:</p>\n\n<pre><code>  require_relative 'boot'\n\n  require \"rails\"\n  require \"action_controller/railtie\"\n  require \"action_mailer/railtie\"\n  require \"sprockets/railtie\"\n  require \"rails/test_unit/railtie\"\n  # Pick the frameworks you want:\n  require \"active_model/railtie\"\n  require \"active_job/railtie\"\n  # require \"active_record/railtie\"\n  require \"action_controller/railtie\"\n  require \"action_mailer/railtie\"\n  require \"action_view/railtie\"\n  require \"action_cable/engine\"\n  require \"sprockets/railtie\"\n  require \"rails/test_unit/railtie\"\n  require 'rails/all'\n\n  # Require the gems listed in Gemfile, including any gems\n  # you've limited to :test, :development, or :production.\n  Bundler.require(*Rails.groups)\n\n  module MyApp\n    class Application &lt; Rails::Application\n      # Initialize configuration defaults for originally generated Rails version.\n      config.load_defaults 5.1\n      # Allowed options: :sql, :ruby.\n      config.sequel.schema_format = :sql\n      # Whether to dump the schema after successful migrations.\n      # Defaults to false in production and test, true otherwise.\n      config.sequel.schema_dump = true\n      config.sequel.load_database_tasks = true\n      config.sequel.load_database_tasks = :sequel\n      config.sequel.logger = Logger.new($stdout)\n      # config.sequel.after_connect = proc do\n      #   Sequel::Model.plugin :timestamps, update_on_create: true\n      # end\n      # Settings in config/environments/* take precedence over those specified here.\n      # Application configuration should go into files in config/initializers\n      # -- all .rb files in that directory are automatically loaded.\n    end\n  end\n</code></pre>\n\n<p>The <code>database.yml</code> has:</p>\n\n<pre><code>development:\n  adapter: sqlite3 # Also accept sqlite3\n  database: db/mydatabase.sqlite # Path to db relative to Rails root\n</code></pre>\n\n<p>And my migration <code>20180214121521_create_users.rb</code>content is:</p>\n\n<pre><code>Sequel.migration do\n  change do\n    create_table :users do\n      primary_key :id\n    end\n  end\nend\n</code></pre>\n\n<p>Any help to sort this out would be really appreciated. :)</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "edited": false, "score": 0, "creation_date": 1518609822, "post_id": 48786717, "comment_id": 84574907, "body": "You want to check if there&#39;s a key in ANY of the objects in the array or in ALL of tem?"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 2, "creation_date": 1518609866, "post_id": 48786717, "comment_id": 84574941, "body": "Please give an example of what you are trying to check and when the condition is met or not met."}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518609914, "post_id": 48786717, "comment_id": 84574976, "body": "my key is unique, I just want to check if a particular key exists in my array of hashes or not"}, {"owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1518610057, "post_id": 48786717, "comment_id": 84575078, "body": "As @TamerShlash said please give some example of expected output."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518610085, "post_id": 48786717, "comment_id": 84575095, "body": "<i>&quot;if a particular key exists&quot;</i> \u2013 and what is that particular key?"}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "reply_to_user": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 0, "creation_date": 1518610090, "post_id": 48786717, "comment_id": 84575098, "body": "i have updated the post u can check @Goku"}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518610128, "post_id": 48786717, "comment_id": 84575127, "body": "@Stefan key is questionnaire id  &quot;question&quot;=&gt;&quot;0a2a3452&quot;"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1518610227, "post_id": 48786717, "comment_id": 84575194, "body": "@suman &quot;question&quot; is a key and &quot;0a2a3452&quot; is a value. What you have is a key-value pair."}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518610325, "post_id": 48786717, "comment_id": 84575256, "body": "yes key value pair, isnt that makes a json object(a key value pair) ?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518610594, "post_id": 48786717, "comment_id": 84575433, "body": "@suman your question says <i>&quot;how to check if a particular key exists&quot;</i> whereas you want to check whether your array contains a hash with a given key-value pair. That&#39;s a bit different, isn&#39;t it?"}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518635104, "post_id": 48786717, "comment_id": 84591104, "body": "@Stefan  yes you are right, my bad I was confused, may be I wasn&#39;t very clear in expressing my doubt"}], "answers": [{"tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 0, "last_activity_date": 1518610216, "creation_date": 1518610216, "answer_id": 48786910, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru/48786910#48786910", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p>You can filter the array using <code>Enumerable#select</code> to get only the hashes that contains the desired key.</p>\n\n<pre><code>filtered = my_hash.select { |item| item['desired_key'] }\n</code></pre>\n\n<p>That's possible because <code>nil</code> is falsey. If you input is a raw JSON you'll need to parse it to a Ruby hash using <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/json/rdoc/JSON.html\" rel=\"nofollow noreferrer\"><code>JSON#parse</code></a> or any other equivalent method.</p>\n\n<p><code>filtered</code> will give you all the hashes that contain the <code>desired_key</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518613250, "post_id": 48786931, "comment_id": 84577284, "body": "and how will it return true or false, as it has two condition, .any ? and .key?"}, {"owner": {"reputation": 1473, "user_id": 3173665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4f32eea9b60872a87bf1a04847ce267?s=128&d=identicon&r=PG&f=1", "display_name": "bhanu", "link": "https://stackoverflow.com/users/3173665/bhanu"}, "reply_to_user": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518616088, "post_id": 48786931, "comment_id": 84579124, "body": "As we are passing a block to to <code>any?</code>. it will be evaluated against every element in the array  @suman"}], "tags": [], "owner": {"reputation": 1473, "user_id": 3173665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e4f32eea9b60872a87bf1a04847ce267?s=128&d=identicon&r=PG&f=1", "display_name": "bhanu", "link": "https://stackoverflow.com/users/3173665/bhanu"}, "is_accepted": false, "score": 1, "last_activity_date": 1518611334, "last_edit_date": 1518611334, "creation_date": 1518610273, "answer_id": 48786931, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru/48786931#48786931", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p>Considering your are checking for a particular key exists or not</p>\n\n<pre><code>@json.any? {|obj| obj.key?(your_particular_key)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1518610496, "post_id": 48786964, "comment_id": 84575370, "body": "I don&#39;t see it necessary to check for the existence of the key separately."}, {"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "reply_to_user": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1518610620, "post_id": 48786964, "comment_id": 84575458, "body": "@TamerShlash: Yes, your right. A missing key results to nil, I forgot."}, {"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518615680, "post_id": 48786964, "comment_id": 84578839, "body": "Thanks a lot guitarman, this worked,i upvoted your answer but i dont have much reputation it wont reflect"}], "tags": [], "owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "is_accepted": false, "score": 3, "last_activity_date": 1518610895, "last_edit_date": 1518610895, "creation_date": 1518610378, "answer_id": 48786964, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru/48786964#48786964", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p><a href=\"http://ruby-doc.org/core-2.5.0/Array.html#method-i-any-3F\" rel=\"nofollow noreferrer\">Array#any?</a> iterates through the array. In each iteration I check wether the current hash has the searched question key or not. If a hash is found <a href=\"http://ruby-doc.org/core-2.5.0/Array.html#method-i-any-3F\" rel=\"nofollow noreferrer\">Array#any?</a> returns true otherwise false.</p>\n\n<pre><code>array = [{\"question\"=&gt;\"0a2a3452\", \"answer\"=&gt;\"bull\"}, {\"question\"=&gt;\"58deacf9\", \"answer\"=&gt;\"bullafolo\"}, {\"question\"=&gt;\"32c53e5f\", \"answer\"=&gt;\"curosit\"}, {\"question\"=&gt;\"b5546bcf\", \"answer\"=&gt;\"\"}, {\"question\"=&gt;\"0f0b314\", \"answer\"=&gt;\"\"}]\n\nsearch_for_key = '0a2a3452'\n\narray.any?{|hash| hash['question'] == search_for_key}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": false, "score": 3, "last_activity_date": 1547606482, "last_edit_date": 1547606482, "creation_date": 1518610423, "answer_id": 48786978, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru/48786978#48786978", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p>I'll assume that you want to check the existence of a hash which has the key/value pair <code>\"quesetion\" =&gt; \"some-value\"</code>.</p>\n\n<p>Here's how you can do it:</p>\n\n<pre><code>array.any? { |item| item['question'] == 'some-question-id' }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "edited": false, "score": 0, "creation_date": 1518610726, "post_id": 48786983, "comment_id": 84575521, "body": "i dont want this result = questions.find { |question| question[&#39;question&#39;] == &quot;Bonour&quot; } i want to find that question id and replace it with new answer from params, basically a update action"}], "tags": [], "owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1518610437, "creation_date": 1518610437, "answer_id": 48786983, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru/48786983#48786983", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p>Is that what you want ? \nBtw guitarman's answer is way better !</p>\n\n<pre><code>questions = [{\"question\"=&gt;\"0a2a3452\", \"answer\"=&gt;\"bull\"}, {\"question\"=&gt;\"58deacf9\", \"answer\"=&gt;\"bullafolo\"}, {\"question\"=&gt;\"32c53e5f\", \"answer\"=&gt;\"curosit\"}, {\"question\"=&gt;\"b5546bcf\", \"answer\"=&gt;\"\"}, {\"question\"=&gt;\"0f0b314\", \"answer\"=&gt;\"\"}]\n\nresult = questions.find { |question| question['question'] == \"Bonour\" }\n\nif result.nil?\n    puts \"Not found\"\nelse\n    puts \"#{result['question']} #{result['answer']}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6706071, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d743b1f13259470e262a17307f494781?s=128&d=identicon&r=PG&f=1", "display_name": "suman", "link": "https://stackoverflow.com/users/6706071/suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3955, "favorite_count": 1, "answer_count": 5, "score": -1, "last_activity_date": 1547606482, "creation_date": 1518609571, "last_edit_date": 1518685365, "question_id": 48786717, "link": "https://stackoverflow.com/questions/48786717/how-to-check-if-a-certain-key-value-pair-exists-in-array-of-hashes-as-json-in-ru", "title": "how to check if a certain key-value pair exists in array of hashes as json in ruby on rails", "body": "<p>I have an array of hashes as <code>json</code>, so how to check my array of hashes contains a hash with a given key-value pair.</p>\n\n<p>This is my <code>json</code></p>\n\n<pre><code>[{\"question\"=&gt;\"0a2a3452\", \"answer\"=&gt;\"bull\"}, {\"question\"=&gt;\"58deacf9\", \"answer\"=&gt;\"bullafolo\"}, {\"question\"=&gt;\"32c53e5f\", \"answer\"=&gt;\"curosit\"}, {\"question\"=&gt;\"b5546bcf\", \"answer\"=&gt;\"\"}, {\"question\"=&gt;\"0f0b314\", \"answer\"=&gt;\"\"}]\n</code></pre>\n\n<p>I tried looping through the <code>json</code> array, but this is tedious, as I need to check that if that <code>json</code> has that hash with a given key-value pair</p>\n\n<p>It's a questionnaire form, in which I have to perform an update on answers</p>\n\n<pre><code> if !@client_find.nil?    \n     @client_find.questionnaire\n     params[:commit].each do |key, value|\n       @json=[]\n       @json = @client_find.questionnaire\n      if !value.empty? &amp;&amp; @json.include?(key)\n        puts \"blunderc \"+ value.inspect\n        @new_append = Hash.new\n        @new_append[:question] = key\n        @new_append[:answer]= value\n        @json &lt;&lt; @new_append\n      end\n\n       if !key.empty? &amp;&amp; !value.empty?\n         #logic\n         @json.each  do |u|\n           if (u.key? key)\n             puts \"bothu \"+ u[key].inspect\n             u[key] = value\n           end\n         end\n       end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "amazon-ec2", "rubygems"], "comments": [{"owner": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "edited": false, "score": 0, "creation_date": 1518609121, "post_id": 48786515, "comment_id": 84574411, "body": "&#191;habla usted Ingl&#233;s? Because this is an english site."}, {"owner": {"reputation": 1, "user_id": 3110946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mkfq.jpg?s=128&g=1", "display_name": "Jo&#227;o Henrique", "link": "https://stackoverflow.com/users/3110946/jo%c3%a3o-henrique"}, "reply_to_user": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "edited": false, "score": 0, "creation_date": 1518610518, "post_id": 48786515, "comment_id": 84575381, "body": "Edited question to english. @abybaddi009"}, {"owner": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "edited": false, "score": 0, "creation_date": 1518610772, "post_id": 48786515, "comment_id": 84575552, "body": "The direct translation from google doesn&#39;t help that much. Can you elaborate?"}, {"owner": {"reputation": 1, "user_id": 3110946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mkfq.jpg?s=128&g=1", "display_name": "Jo&#227;o Henrique", "link": "https://stackoverflow.com/users/3110946/jo%c3%a3o-henrique"}, "reply_to_user": {"reputation": 810, "user_id": 4055021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LAQh8.jpg?s=128&g=1", "display_name": "abybaddi009", "link": "https://stackoverflow.com/users/4055021/abybaddi009"}, "edited": false, "score": 0, "creation_date": 1518612804, "post_id": 48786515, "comment_id": 84576988, "body": "Sorry for my english, I&#39;m having trouble with deploy in aws as follows in the image. @abybaddi009"}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 2464536, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/87e89a45fb2a98bcf44a43ff0f475019?s=128&d=identicon&r=PG", "display_name": "ajk4550", "link": "https://stackoverflow.com/users/2464536/ajk4550"}, "is_accepted": false, "score": 0, "last_activity_date": 1518720737, "creation_date": 1518720737, "answer_id": 48814345, "question_id": 48786515, "link": "https://stackoverflow.com/questions/48786515/error-deploy-aws-ruby-on-rails-gem-ffi-updated/48814345#48814345", "title": "Error Deploy AWS - Ruby on Rails gem ffi updated", "body": "<p>I ran into a similar situation today with sass-rails when trying to deploy my first AWS project. Keep in mind I am still new to AWS. I don't know that I'd recommend staying on an older version of a gem, but this might help you get running. Here's what I did:</p>\n\n<p>1) Downgrade FFI to 1.9.18. This version seems to install ok on AWS, so I added it to my Gemfile.</p>\n\n<pre><code># Use SCSS for stylesheets\ngem 'ffi', '1.9.18'\ngem 'sass-rails', '~&gt; 5.0'\n</code></pre>\n\n<p>2) Bundle install to update your Gemlock file</p>\n\n<pre><code>$ bundle install\n</code></pre>\n\n<p>3) Commit your changes</p>\n\n<pre><code>git commit -am \"Updating FFI gem\"\n</code></pre>\n\n<p>4) Now hopefully it will install ok. I think you just do but I am coming from a clean app.</p>\n\n<pre><code>eb deploy\n</code></pre>\n\n<p>This is what made me think to downgrade the Gem.</p>\n\n<p><a href=\"https://github.com/ffi/ffi/issues/613\" rel=\"nofollow noreferrer\">https://github.com/ffi/ffi/issues/613</a></p>\n\n<p><a href=\"https://github.com/ffi/ffi/pull/612\" rel=\"nofollow noreferrer\">https://github.com/ffi/ffi/pull/612</a></p>\n"}], "owner": {"reputation": 1, "user_id": 3110946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mkfq.jpg?s=128&g=1", "display_name": "Jo&#227;o Henrique", "link": "https://stackoverflow.com/users/3110946/jo%c3%a3o-henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518720737, "creation_date": 1518608951, "last_edit_date": 1518610111, "question_id": 48786515, "link": "https://stackoverflow.com/questions/48786515/error-deploy-aws-ruby-on-rails-gem-ffi-updated", "title": "Error Deploy AWS - Ruby on Rails gem ffi updated", "body": "<p>Good morning people,</p>\n\n<p>I'm having trouble deploying on AWS after a ffi gem has been updated, but this gem ffi is used as a dependency on a 5 level gem of the sass-rails.</p>\n\n<p>So I can not set the version I need in this gem that is dependent on the gem sass-rails.<a href=\"https://i.stack.imgur.com/FHsft.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>If someone has already experienced this and can help me? Or know how to arrow a version in a dependency gem.</p>\n\n<p>Thank you very much in advance!</p>\n\n<p>Att, Jo\u00e3o Henrique Soares</p>\n"}, {"tags": ["ruby", "rubocop"], "answers": [{"comments": [{"owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "edited": false, "score": 1, "creation_date": 1518608403, "post_id": 48786190, "comment_id": 84573924, "body": "Maybe so but we want it like it has been displayed in the OP, and I know it should be possible to set it like I want as according to this: <a href=\"https://github.com/bbatsov/rubocop/issues/653#issuecomment-29840347\" rel=\"nofollow noreferrer\">github.com/bbatsov/rubocop/issues/653#issuecomment-29840347</a>, I just want to know how to do it with current version of rubocop."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1518687400, "post_id": 48786190, "comment_id": 84610495, "body": "Then why didn&#39;t you ask for that in the question? :&#39;-)"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1518690364, "post_id": 48786190, "comment_id": 84612526, "body": "Since that issue is from 2013, and the <code>IndentWhenRelativeTo</code> has been renamed to <code>EnforcedStyle</code> most probably that options are no longer valid. I couldn&#39;t make it work as @jonas054 pointed out."}], "tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 2, "last_activity_date": 1518607947, "creation_date": 1518607947, "answer_id": 48786190, "question_id": 48786060, "link": "https://stackoverflow.com/questions/48786060/how-to-set-rubocop-case-indentation-correctly/48786190#48786190", "title": "How to set rubocop case indentation correctly", "body": "<p>It says</p>\n\n<blockquote>\n  <ul>\n  <li>Indent when as deep as case</li>\n  <li>When assigning the result of a conditional expression to a variable,\n  preserve the usual alignment of its branches</li>\n  </ul>\n</blockquote>\n\n<p>So it could be valid for Rubocop this way:</p>\n\n<pre><code>variable = case some_other_variable\n           when 'some value' then 'some result'\n           when 'some other value' then 'some other result'\n           when 'one more value' then 'one more result'\n           end\n</code></pre>\n\n<p>Or this way</p>\n\n<pre><code>variable =\n  case some_other_variable\n  when 'some value' then 'some result'\n  when 'some other value' then 'some other result'\n  when 'one more value' then 'one more result'\n  end\n</code></pre>\n"}], "owner": {"reputation": 2184, "user_id": 3536548, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qEPjr.png?s=128&g=1", "display_name": "Thermatix", "link": "https://stackoverflow.com/users/3536548/thermatix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 48786190, "answer_count": 1, "score": 2, "last_activity_date": 1518607947, "creation_date": 1518607588, "question_id": 48786060, "link": "https://stackoverflow.com/questions/48786060/how-to-set-rubocop-case-indentation-correctly", "title": "How to set rubocop case indentation correctly", "body": "<p>How do I get rubo-cop to accept the following as correct for case select:</p>\n\n<pre><code>variable = case some_other_variable\n  when 'some value' then 'some result'\n  when 'some other value' then 'some other result'\n  when 'one more value'  then 'one more result'\nend\n</code></pre>\n\n<p>I have this currently in my <code>.rubocop.yml</code>:</p>\n\n<pre><code>CaseIndentation:\n  EnforcedStyle: end\n  IndentOneStep: true\n</code></pre>\n\n<p>but it keeps erroring like this:</p>\n\n<pre><code>C: Layout/CaseIndentation: Indent when one step more than end.\n    when 'some value' then 'some result'\n</code></pre>\n\n<p>What am I doing wrong and how can I fix it ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oracle"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1518606290, "post_id": 48785573, "comment_id": 84572557, "body": "<code>USER_ID = &#39;sign_up&#39;</code>? what&#39;s in the params?, maybe you&#39;re not sending a &quot;real&quot; id value."}], "answers": [{"tags": [], "owner": {"reputation": 75434, "user_id": 9097906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RmIqt.jpg?s=128&g=1", "display_name": "Littlefoot", "link": "https://stackoverflow.com/users/9097906/littlefoot"}, "is_accepted": false, "score": 0, "last_activity_date": 1518606431, "creation_date": 1518606431, "answer_id": 48785685, "question_id": 48785573, "link": "https://stackoverflow.com/questions/48785573/activerecordstatementinvalid-in-userscontrollershow/48785685#48785685", "title": "ActiveRecord::StatementInvalid in UsersController#show", "body": "<pre><code>... WHERE (USER_ID = 'sign_up') \n</code></pre>\n\n<p>\"ID\" usually (once again: <em>usually</em>) means a NUMBER. If you have a look at the V_L_USERS table, what does it say - what is USER_ID data type? If it really is a NUMBER, then using a string (which 'sign_up' is) against it will raise the INVALID NUMBER error.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 1970562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjMHn.png?s=128&g=1", "display_name": "Ben Watkins", "link": "https://stackoverflow.com/users/1970562/ben-watkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1518606748, "creation_date": 1518606748, "answer_id": 48785797, "question_id": 48785573, "link": "https://stackoverflow.com/questions/48785573/activerecordstatementinvalid-in-userscontrollershow/48785797#48785797", "title": "ActiveRecord::StatementInvalid in UsersController#show", "body": "<p>It seems it's an issue with your ID parameter.</p>\n\n<p>Side note: a cleaner way to find the user would be with Users.find(params[:id])</p>\n"}], "owner": {"reputation": 136, "user_id": 9282049, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/9Ad4U.jpg?s=128&g=1", "display_name": "Nonsense", "link": "https://stackoverflow.com/users/9282049/nonsense"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518606771, "creation_date": 1518606101, "last_edit_date": 1518606771, "question_id": 48785573, "link": "https://stackoverflow.com/questions/48785573/activerecordstatementinvalid-in-userscontrollershow", "title": "ActiveRecord::StatementInvalid in UsersController#show", "body": "<p>It's impossible to go to this address: 127.0.0.1/users/sign_up.\nWhen I go to the page, I get the following error: </p>\n\n<pre><code>OCIError: ORA-01722: invalid number: SELECT * FROM (SELECT \"BLACKROW\".\"V_B_USERS\".* FROM \"BLACKROW\".\"V_B_USERS\" WHERE (USER_ID = 'sign_up') ORDER BY \"BLACKROW\".\"V_L_USERS\".\"USER_ID\" ASC ) WHERE ROWNUM &lt;= 1\n</code></pre>\n\n<p>On this action there is an error:</p>\n\n<pre><code># Use callbacks to share common setup or constraints between actions.\n\n    def set_user\n      @user = User.where('USER_ID = ?', params[:id]).first\n    end\n</code></pre>\n\n<p>What's wrong? And how can this be remedied?</p>\n"}, {"tags": ["ruby", "geojson", "rgeo"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1518607224, "post_id": 48785494, "comment_id": 84573153, "body": "Maybe the two points are just out of order and need to be swapped. Where does this &quot;distortion&quot; come from?"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518617722, "post_id": 48785494, "comment_id": 84580286, "body": "@Stefan thank you for your response! Points swap is less desirable solution, as it might change polygon area drastically in other cases. This data come from production DB, it&#39;s not accurate but I would like to preserve it and just fix it to make it somehow valid."}], "answers": [{"comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1519376711, "post_id": 48909492, "comment_id": 84895329, "body": "Thank you for the answer! <code>prepair</code> tool seems what I need. The idea of splitting bowties looks good. I can&#39;t use postgis ST_MakeValid, because the data is in MongoDB :("}], "tags": [], "owner": {"reputation": 1389, "user_id": 4133078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P24yz.jpg?s=128&g=1", "display_name": "Cody Gustafson", "link": "https://stackoverflow.com/users/4133078/cody-gustafson"}, "is_accepted": false, "score": 4, "last_activity_date": 1519227876, "last_edit_date": 1519227876, "creation_date": 1519226553, "answer_id": 48909492, "question_id": 48785494, "link": "https://stackoverflow.com/questions/48785494/rgeo-fix-self-intersections/48909492#48909492", "title": "RGeo - fix self-intersections", "body": "<p>The solution I would use is <a href=\"https://postgis.net/docs/ST_MakeValid.html\" rel=\"nofollow noreferrer\">postgis's ST_MakeValid option for postgres</a> if that is an option for you you could do something along the lines of <code>ST_AsText(ST_MakeValid(geom_column))</code> or if you would rather pass in the text here is an example using the bowtie example shown in <a href=\"https://github.com/tudelft3d/prepair\" rel=\"nofollow noreferrer\">prepair</a>:</p>\n\n<pre><code>select ST_AsText(ST_MakeValid(ST_GeomFromText('POLYGON((0 0, 0 10, 10 0, 10 10, 0 0))')));\nst_astext                         \n-----------------------------------------------------------\nMULTIPOLYGON(((0 0,0 10,5 5,0 0)),((5 5,10 10,10 0,5 5)))\n(1 row)\n</code></pre>\n\n<p>If that doesn't interest you, you could export those geometries and use a tool like <a href=\"https://github.com/tudelft3d/prepair\" rel=\"nofollow noreferrer\">prepair</a> to convert them. To sum up how this works behind the scenes, it will split these \"bowties\" into multiple polygons which will then be made into a multipolygon. The same type of fix will applied to multipolygons.</p>\n"}], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1758, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1519227876, "creation_date": 1518605894, "question_id": 48785494, "link": "https://stackoverflow.com/questions/48785494/rgeo-fix-self-intersections", "title": "RGeo - fix self-intersections", "body": "<p>I have a bunch of polygons that have self-intersection which causes some errors in further postprocessing them (in particular - I can't calculate intersection area of those polygons with other polygons). Here is an example of broken polygon:</p>\n\n<pre><code>{\n  \"type\": \"MultiPolygon\",\n  \"coordinates\": [\n    [\n      [\n        [\n          6.881057785381658,\n          46.82373306675715\n        ],\n        [\n          6.857171686909481,\n          46.81861230543794\n        ],\n        [\n          6.857354659059071,\n          46.81856788926046\n        ],\n        [\n          6.856993473052509,\n          46.82693029065604\n        ],\n        [\n          6.8612894138116785,\n          46.83422796373707\n        ],\n        [\n          6.86720955648855,\n          46.835636765630476\n        ],\n        [\n          6.871281147359957,\n          46.83078486366309\n        ],\n        [\n          6.871573291317274,\n          46.8306215963777\n        ],\n        [\n          6.877608228639841,\n          46.82771553607934\n        ],\n        [\n          6.877758462659651,\n          46.82772313420989\n        ],\n        [\n          6.877852632482749,\n          46.827735617670285\n        ],\n        [\n          6.880928107931434,\n          46.82630213148064\n        ],\n        [\n          6.8810399979122305,\n          46.82622029042867\n        ],\n        [\n          6.881117606743071,\n          46.826115612819855\n        ],\n        [\n          6.881057785381658,\n          46.82373306675715\n        ]\n      ]\n    ]\n  ]\n}\n</code></pre>\n\n<p>This is what it looks like on the map - as you can see, there is intersection of two polygon edges. RGeo throws an error, pointing intersection coordinate (I guess): <code>=&gt; \"Geos::GEOSException: TopologyException: Input geom 0 is invalid: Self-intersection at or near point 6.8573510795579145 46.818650764080992 at 6.8573510795579145 46.818650764080992\"</code>. So, I have it at least.</p>\n\n<p>My question is: is there a way to fix that intersection automatically? I read, that a possible solution is to insert 2 similar points with coordinates of self-intersection. But the problem is - the polygon has a specific order, and I don't know WHERE to insert those points. </p>\n\n<p>Also, maybe there are some existing tools helping fix that...</p>\n\n<p><a href=\"https://i.stack.imgur.com/dix88.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/dix88.png\" alt=\"self-intersection example\"></a></p>\n"}, {"tags": ["ruby", "loops", "parsing", "erb"], "comments": [{"owner": {"reputation": 7052, "user_id": 3761297, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e25290d62d20ea1429651a0cac339803?s=128&d=identicon&r=PG&f=1", "display_name": "committedandroider", "link": "https://stackoverflow.com/users/3761297/committedandroider"}, "edited": false, "score": 1, "creation_date": 1570464119, "post_id": 48784384, "comment_id": 102913154, "body": "The thing that error message is also pretty unclear. To me, it should have told you unexpected &#39;-&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 919844, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b2cb36101acc3835cdf0ecf74f2e013d?s=128&d=identicon&r=PG", "display_name": "nemenems", "link": "https://stackoverflow.com/users/919844/nemenems"}, "edited": false, "score": 1, "creation_date": 1518603390, "post_id": 48784533, "comment_id": 84570597, "body": "indeed it works! but I don&#39;t understand, the &quot;-&quot;is here to not add a newline char (from my understanding).  I saw a lot of examples with this syntax.  Why am i not supposed to use the &quot;-&quot; here ?"}, {"owner": {"reputation": 954, "user_id": 8838821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uzgur.png?s=128&g=1", "display_name": "Oli Crt", "link": "https://stackoverflow.com/users/8838821/oli-crt"}, "reply_to_user": {"reputation": 964, "user_id": 919844, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b2cb36101acc3835cdf0ecf74f2e013d?s=128&d=identicon&r=PG", "display_name": "nemenems", "link": "https://stackoverflow.com/users/919844/nemenems"}, "edited": false, "score": 0, "creation_date": 1518603776, "post_id": 48784533, "comment_id": 84570844, "body": "@nemenems Seems like you need to enable it doing <code>ERB.new(template, nil, &#39;-&#39;)</code>, see this post for more info <a href=\"https://stackoverflow.com/questions/4632879/erb-template-removing-the-trailing-line\" title=\"erb template removing the trailing line\">stackoverflow.com/questions/4632879/&hellip;</a>"}, {"owner": {"reputation": 964, "user_id": 919844, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b2cb36101acc3835cdf0ecf74f2e013d?s=128&d=identicon&r=PG", "display_name": "nemenems", "link": "https://stackoverflow.com/users/919844/nemenems"}, "edited": false, "score": 0, "creation_date": 1518606150, "post_id": 48784533, "comment_id": 84572486, "body": "perfect! you rocks!"}], "tags": [], "owner": {"reputation": 954, "user_id": 8838821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uzgur.png?s=128&g=1", "display_name": "Oli Crt", "link": "https://stackoverflow.com/users/8838821/oli-crt"}, "is_accepted": true, "score": 3, "last_activity_date": 1518603083, "creation_date": 1518603083, "answer_id": 48784533, "question_id": 48784384, "link": "https://stackoverflow.com/questions/48784384/erb-how-to-loop-on-array/48784533#48784533", "title": "erb how to loop on array", "body": "<p>You're not supposed to have those \"-\" at the end beofre the \"%\".</p>\n\n<pre><code>&lt;% ['foo', 'bar'].each do |val| %&gt;\n    &lt;%= val %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This should work.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1518604474, "last_edit_date": 1518604474, "creation_date": 1518603194, "answer_id": 48784568, "question_id": 48784384, "link": "https://stackoverflow.com/questions/48784384/erb-how-to-loop-on-array/48784568#48784568", "title": "erb how to loop on array", "body": "<p>You have to set <em>trim mode</em> to <code>-</code>:</p>\n\n<pre><code>$ erb -T - test.erb\nfoo\nbar\n</code></pre>\n\n<p>From the man page:</p>\n\n<blockquote>\n<pre>\n<b>-T</b> <i>mode</i>   Specifies trim mode (default 0). <i>mode</i> can be one of\n          <b>0</b>   EOL remains after the embedded ruby script is evaluated.\n          <b>1</b>   EOL is removed if the line ends with <b>%></b>.\n          <b>2</b>   EOL is removed if the line starts with <b>&lt;%</b> and ends with <b>%&gt;</b>.\n          <b>-</b>   EOL is removed if the line ends with <b>-%&gt;</b>. And leading whitespaces\n              are removed if the erb directive starts with <b>&lt;%-</b>.\n</pre>\n</blockquote>\n"}], "owner": {"reputation": 964, "user_id": 919844, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b2cb36101acc3835cdf0ecf74f2e013d?s=128&d=identicon&r=PG", "display_name": "nemenems", "link": "https://stackoverflow.com/users/919844/nemenems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3831, "favorite_count": 0, "accepted_answer_id": 48784533, "answer_count": 2, "score": 2, "last_activity_date": 1518604474, "creation_date": 1518602687, "question_id": 48784384, "link": "https://stackoverflow.com/questions/48784384/erb-how-to-loop-on-array", "title": "erb how to loop on array", "body": "<p>I can't simply loop on an array with ruby erb template system... </p>\n\n<p>here is my template:</p>\n\n<pre><code>&lt;% ['foo', 'bar'].each do |val| -%&gt;\n&lt;%= val %&gt;\n&lt;% end -%&gt;\n</code></pre>\n\n<p>Here is the command line and the result</p>\n\n<pre><code>erb test.erb\n/usr/share/rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/erb.rb:896:in `eval': test.erb:1: syntax error, unexpected ';' (SyntaxError)\n'foo', 'bar'].each do |val| -; _erbout.concat \"\\n\"\n                              ^\ntest.erb:3: syntax error, unexpected ';'\n;  end -; _erbout.concat \"\\n\"\n         ^\n        from /usr/share/rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/erb.rb:896:in `result'\n        from /usr/share/rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/erb.rb:878:in `run'\n        from /usr/share/rvm/rubies/ruby-2.4.1/bin/erb:149:in `run'\n        from /usr/share/rvm/rubies/ruby-2.4.1/bin/erb:170:in `&lt;main&gt;'\n</code></pre>\n\n<p>What is wrong with this really simple example? </p>\n\n<p>Disclaimer: I am a ruby and erb noob ^^</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "rbenv"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8215233, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e11efb71582f94a5b7e20368e8a7627d?s=128&d=identicon&r=PG&f=1", "display_name": "fred", "link": "https://stackoverflow.com/users/8215233/fred"}, "edited": false, "score": 0, "creation_date": 1518627873, "post_id": 48790286, "comment_id": 84587371, "body": "Please tanvir002700 this is the path I already have in my bashrc file.   export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot; eval &quot;$(rbenv init -)&quot; export PATH=&quot;$HOME/.rbenv/plugins/ruby-build/bin:$PATH&quot; export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot; eval &quot;(rbenv init .)&quot; eval &quot;(rbenv init -)&quot; eval &quot;(rbenv init .)&quot; eval &quot;$(rbenv init -)&quot;"}, {"owner": {"reputation": 417, "user_id": 4356590, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100001070226047/picture?type=large", "display_name": "Tanvir Hasan Anick", "link": "https://stackoverflow.com/users/4356590/tanvir-hasan-anick"}, "reply_to_user": {"reputation": 113, "user_id": 8215233, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e11efb71582f94a5b7e20368e8a7627d?s=128&d=identicon&r=PG&f=1", "display_name": "fred", "link": "https://stackoverflow.com/users/8215233/fred"}, "edited": false, "score": 0, "creation_date": 1518636491, "post_id": 48790286, "comment_id": 84591828, "body": "Did your .profile file set these configuration ?  ``` if [ -n &quot;$BASH_VERSION&quot; ]; then     # include .bashrc if it exists     if [ -f &quot;$HOME/.bashrc&quot; ]; then \t. &quot;$HOME/.bashrc&quot;     fi fi ```"}], "tags": [], "owner": {"reputation": 417, "user_id": 4356590, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/100001070226047/picture?type=large", "display_name": "Tanvir Hasan Anick", "link": "https://stackoverflow.com/users/4356590/tanvir-hasan-anick"}, "is_accepted": false, "score": 0, "last_activity_date": 1537833301, "last_edit_date": 1537833301, "creation_date": 1518620716, "answer_id": 48790286, "question_id": 48783461, "link": "https://stackoverflow.com/questions/48783461/rbenv-and-ruby-build-on-ubuntu/48790286#48790286", "title": "Rbenv and ruby build on Ubuntu", "body": "<p>Add these configuration to your .bashrc file. Those will be load rbenv during terminal start.</p>\n\n<pre><code>if [ -d $HOME/.rbenv ]; then\n    export RBENV_ROOT=\"$HOME/.rbenv\"\n    export PATH=\"$RBENV_ROOT/bin:$PATH\"\n    eval \"$(rbenv init -)\"\nfi\n</code></pre>\n\n<p>Note: your rbenv installation path can be different. Check before set those to you .bashrc file.</p>\n"}], "owner": {"reputation": 113, "user_id": 8215233, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e11efb71582f94a5b7e20368e8a7627d?s=128&d=identicon&r=PG&f=1", "display_name": "fred", "link": "https://stackoverflow.com/users/8215233/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 215, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537833301, "creation_date": 1518599895, "last_edit_date": 1537833273, "question_id": 48783461, "link": "https://stackoverflow.com/questions/48783461/rbenv-and-ruby-build-on-ubuntu", "title": "Rbenv and ruby build on Ubuntu", "body": "<p>I have install rbenv and ruby-build on Ubuntu DISTRIB_RELEASE 16.04 but anytime I start my terminal I get the message below on the terminal. Any help would be greatly appreciated. </p>\n\n<pre><code># Load rbenv automatically by appending\n# the following to your profile:\n\neval \"$(rbenv init -)\"\nexport PATH=\"/home/godfred/.rbenv/shims:${PATH}\"\nexport RBENV_SHELL=bash\nsource '/home/godfred/.rbenv/libexec/../completions/rbenv.bash'\ncommand rbenv rehash 2&gt;/dev/null\nrbenv() {\nlocal command\ncommand=\"${1:-}\"\nif [ \"$#\" -gt 0 ]; then\nshift\nfi\ncase \"$command\" in\nrehash|shell)\neval \"$(rbenv \"sh-$command\" \"$@\")\";;*)\ncommand rbenv \"$command\" \"$@\";;\nesac\n}\n# Load rbenv automatically by appending\n# the following to your profile:\n\neval \"$(rbenv init -)\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "searchkick"], "owner": {"reputation": 401, "user_id": 7156757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8768142e36048bf7d98b346110611ebc?s=128&d=identicon&r=PG&f=1", "display_name": "O.Vykhor", "link": "https://stackoverflow.com/users/7156757/o-vykhor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 831, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1518598973, "creation_date": 1518598973, "question_id": 48783201, "link": "https://stackoverflow.com/questions/48783201/searchkick-async-updating", "title": "Searchkick async updating", "body": "<p>I started to use searchkick for connecting with elasticsearch, and I encountered a problem with index updating in background job. I did all by example in documentation, but searchkick tasks in sidekiq only accumulated and executed only after restarting sidekiq, and after execution, tasks collect again without execution. Below code.</p>\n\n<p>Here my <code>searchkick.rb</code> initializer</p>\n\n<pre><code>Searchkick.client =\n  Elasticsearch::Client.new(\n    url: 'remote_ip:9200',\n    retry_on_failure: true,\n    transport_options: { request: { timeout: 250 } }\n)\n\nSearchkick.redis = ConnectionPool.new { Redis.new }\n</code></pre>\n\n<p>part of my model</p>\n\n<pre><code>after_commit  :searchkick_indexing\n\nsearchkick callbacks: :queue, index_name: :my_index_name\n\ndef search_data\n  {\n    title: title,\n    description: description\n  }\nend\n\nprivate\n\ndef searchkick_indexing\n  Searchkick::ProcessQueueJob.perform_later(class_name: \"model_name\")\nend\n</code></pre>\n\n<p>And, also, I added <code>searchkick</code> queue to <code>sidekiq.yml</code>.\nHow to performing searchkick job always without restarting sidekiq?\nThank in advance?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "hash", "distinct", "group-concat"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518597505, "post_id": 48782616, "comment_id": 84566800, "body": "Try this query <code>Phonebook.select(&quot;DISTINCT ON (number,sms_group_name) number,sms_group_name&quot;).where(user_id: session[:user_id]).order(:sms_group_name).group_by{ |p| p.sms_group_name }</code> let me know if it is working or not"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1518634367, "post_id": 48782616, "comment_id": 84590715, "body": "might be worth mentioning what database you are using"}, {"owner": {"reputation": 1, "user_id": 9077861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2487404f7c6ad84a786eab90cf8df1e3?s=128&d=identicon&r=PG&f=1", "display_name": "gemini", "link": "https://stackoverflow.com/users/9077861/gemini"}, "edited": false, "score": 0, "creation_date": 1518688485, "post_id": 48782616, "comment_id": 84611200, "body": "that query gave &quot;Mysql2::Error&quot; . also I use mysql server."}, {"owner": {"reputation": 1, "user_id": 9077861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2487404f7c6ad84a786eab90cf8df1e3?s=128&d=identicon&r=PG&f=1", "display_name": "gemini", "link": "https://stackoverflow.com/users/9077861/gemini"}, "edited": false, "score": 0, "creation_date": 1518691742, "post_id": 48782616, "comment_id": 84613450, "body": "I want to explain detailed : I want to take result as a &lt;ActiveRecord::Relation [#&lt;Phonebook user_id: 5, number: &quot;xxxxx,xxxxxx,xxxxxx&quot;, sms_group_name: &quot;tem1&quot;&gt;, #&lt;Phonebook user_id: 5, number: &quot;xxxxx,xxxxxx,xxxxxx&quot;, sms_group_name: &quot;tem2&quot;&gt;"}], "owner": {"reputation": 1, "user_id": 9077861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2487404f7c6ad84a786eab90cf8df1e3?s=128&d=identicon&r=PG&f=1", "display_name": "gemini", "link": "https://stackoverflow.com/users/9077861/gemini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518597170, "creation_date": 1518596686, "last_edit_date": 1518597170, "question_id": 48782616, "link": "https://stackoverflow.com/questions/48782616/how-to-select-distinct-fields-grouped-by-one-field-and-concat-one-field-with-del", "title": "how to select distinct fields grouped by one field and concat one field with delimiter in ruby", "body": "<p>I have an table that includes these field :</p>\n\n<p>table phonebook </p>\n\n<pre><code> id   \n user_id\n number\n name\n added\n card_id\n speeddial\n updated_at\n sms_group_name\n</code></pre>\n\n<p>some records have same sms_group_name and number,but there is some duplicate number for same sms_group_name. First I want to take distinct number for each sms_group_name and group_concat with , delimiter. </p>\n\n<p>query result must be like this : </p>\n\n<p>user_id, number,number,number,number,sms_group_name </p>\n\n<p>select where condition is user_id </p>\n\n<p>I tried all of them : </p>\n\n<pre><code># @a = Phonebook.select([\"DISTINCT number\",\"sms_group_name\"]).where(user_id: session[:user_id]).order(:sms_group_name).distinct\n# @a = Phonebook.where(user_id: session[:user_id])\n# Product.where.not(restaurant_id: nil).select(\"DISTINCT ON(name) name, restaurant_id, price, updated_at\").order(\"name, updated_at\")\n# @a = Phonebook.where(user_id: session[:user_id]).select(\"DISTINCT ON(number) number, added, user_id, speeddial, updated_at,sms_group_name\").order(\"sms_group_name\")\n# Phonebook.select(\"DISTINCT(number), *\").where(\"user_id = ?\", session[:user_id]).order(\"sms_group_name ASC\").group_by(&amp;:sms_group_name)\n# Location.where(\"calendar_account_id = ?\", current_user.calendar_accounts.first).group(:alias).order(\"alias ASC\").group_by(&amp;:category)\n# @a = Phonebook.where(\"user_id = ?\", session[:user_id]).order(\"sms_group_name ASC\").group(:sms_group_name)\n# @a = Phonebook.select(\"DISTINCT(number), sms_group_name\").where(\"user_id = ?\", session[:user_id]).order(\"sms_group_name ASC\").group_by(&amp;:sms_group_name)\n# @a = Phonebook.select(:number)distinct.where(\"user_id = ?\", session[:user_id]).order(\"sms_group_name ASC\").group_by(&amp;:sms_group_name)\n# @a = Phonebook.select(\"DISTINCT(number), sms_group_name\").group(\"sms_group_name\")\n</code></pre>\n\n<p>most of them give error or does not work. </p>\n\n<p>how can achive this ? </p>\n\n<p>I tried select all values into object array ,after that I tried to eliminate them, but there is no suitable solution for now. </p>\n\n<p>what can be solutions for both: \n1- solution by using query and may be added one block \n2- solution by using hash or array</p>\n\n<p>best regards,</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm"], "comments": [{"owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "edited": false, "score": 0, "creation_date": 1518596765, "post_id": 48782584, "comment_id": 84566450, "body": "Can you add which items you have in which format and what you want exactly ? currently your question is not understandable"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1518598096, "post_id": 48782584, "comment_id": 84567117, "body": "This has nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/ruby-on-rails\">ruby-on-rails</a>."}, {"owner": {"reputation": 669, "user_id": 2014043, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SVKKp.png?s=128&g=1", "display_name": "clueless", "link": "https://stackoverflow.com/users/2014043/clueless"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1518598688, "post_id": 48782584, "comment_id": 84567481, "body": "@Amadan - I&#39;m building this on rails, so any solution that can use rails specific features are welcome."}], "answers": [{"tags": [], "owner": {"reputation": 6948, "user_id": 157441, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7fd359ed56b0d634d5c16dacbcf5f042?s=128&d=identicon&r=PG", "display_name": "Austin Richardson", "link": "https://stackoverflow.com/users/157441/austin-richardson"}, "is_accepted": false, "score": 0, "last_activity_date": 1518596997, "creation_date": 1518596997, "answer_id": 48782687, "question_id": 48782584, "link": "https://stackoverflow.com/questions/48782584/distribute-items-into-containers-in-twos-rails/48782687#48782687", "title": "Distribute items into containers in twos - Rails", "body": "<p>You can use <code>Enumerable#each_slice</code> to iterate over a range from <code>0</code> to <code>10</code> in 3s and then append to an array of arrays:</p>\n\n<pre><code>containers = [\n  [],\n  [],\n  []\n]\n\n(1...10).each_slice(3) do |slice|\n  containers[0] &lt;&lt; slice[0]\n  containers[1] &lt;&lt; slice[1]\n  containers[2] &lt;&lt; slice[2]\nend\n\np containers\n# [[1, 4, 7], [2, 5, 8], [3, 6, 9]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518599035, "post_id": 48782937, "comment_id": 84567703, "body": "You could also <code>group_by.with_index</code> which avoids the indices, so you can just <code>each(&amp;:flatten!)</code> the values."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518599354, "post_id": 48782937, "comment_id": 84567941, "body": "Thanks @Stefan that&#39;s indeed simpler; I edited it in. #2 also looks more complex than it needs to be but can&#39;t figure it out :P"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518599887, "post_id": 48782937, "comment_id": 84568324, "body": "<code>array[pos ... pos += length]</code>?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518600118, "post_id": 48782937, "comment_id": 84568481, "body": "@StefanPochmann nice :) but <code>tap</code>&#39;s not what&#39;s bugging me; I hate having to initialise <code>pos</code> outside the <code>map</code>, and i don&#39;t like having to calculate length :P Oh well..."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518600160, "post_id": 48782937, "comment_id": 84568516, "body": "Ok then you won&#39;t like <code>e = array.to_enum</code> with <code>Array.new(length) { e.next }</code>, either :-)"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518600459, "post_id": 48782937, "comment_id": 84568717, "body": "@StefanPochmann Actually yes, I like that a lot :D I was actually trying with <code>iter = array.each</code> and <code>iter.take(n)</code> first, but that&#39;s not doing what I wanted (unlike what you wrote :D ). I guess I&#39;m too much of a noob on Enumerators :) Also, I guess direct slicing should be faster than collecting from an enum one by one..."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 2, "last_activity_date": 1518600576, "last_edit_date": 1518600576, "creation_date": 1518597985, "answer_id": 48782937, "question_id": 48782584, "link": "https://stackoverflow.com/questions/48782584/distribute-items-into-containers-in-twos-rails/48782937#48782937", "title": "Distribute items into containers in twos - Rails", "body": "<p>Round-robin pair distribution into three bins:</p>\n\n<pre><code>bins = 3\narray = 10.times.map { |i| i + 1 }\n# =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\narray.\n  each_slice(2).                  # divide into pairs\n  group_by.                       # group into bins\n  with_index { |p, i| i % bins }. # round-robin style\n  values.                         # get rid of bin indices\n  each(&amp;:flatten!)                # join pairs in each bin\n</code></pre>\n\n<p>Completely different approach, stuffing bins in order:</p>\n\n<pre><code>base_size, bins_with_extra = (array.size / 2).divmod(bins)\npos = 0\nbins.times.map { |i|\n  length = 2 * (base_size + (i &lt; bins_with_extra ? 1 : 0)) # how much in this bin?\n  array[pos, length].tap { pos += length }                 # extract and advance\n}\n# =&gt; [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10]]\n</code></pre>\n\n<p>If you absolutely need to have this in a hash,</p>\n\n<pre><code>Hash[%i(one two three).zip(binned_array)]\n# =&gt; {:one=&gt;[1, 2, 7, 8], :two=&gt;[3, 4, 9, 10], :three=&gt;[5, 6]}\n</code></pre>\n\n<p>The lovely (but likely not as performant) solution hinted at by Stefan Pochmann:</p>\n\n<pre><code>bins.times.with_object(array.to_enum).map { |i, e|\n  Array.new(2 * (base_size + (i &lt; bins_with_extra ? 1 : 0))) { e.next }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1518600750, "post_id": 48783715, "comment_id": 84568928, "body": "Plenty of approaches! \\o/"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 3, "creation_date": 1518601505, "post_id": 48783715, "comment_id": 84569389, "body": "Another variation: <code>items.each_slice(2).zip(containers.each_value.cycle) { |s, c| c.push(*s) }</code>"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518600672, "creation_date": 1518600672, "answer_id": 48783715, "question_id": 48782584, "link": "https://stackoverflow.com/questions/48782584/distribute-items-into-containers-in-twos-rails/48783715#48783715", "title": "Distribute items into containers in twos - Rails", "body": "<p>This is just to show a different approach (and I would probably not use this one myself).</p>\n\n<p>Given an array of items and the containers hash:</p>\n\n<pre><code>items = (1..10).to_a\ncontainers = { one: [], two: [], three: [] }\n</code></pre>\n\n<p>You could <a href=\"http://ruby-doc.org/core-2.5.0/Object.html#method-i-dup\" rel=\"nofollow noreferrer\"><code>dup</code></a> the array (in order not to modify the original one) and build an enumerator that <a href=\"http://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-cycle\" rel=\"nofollow noreferrer\"><code>cycle</code></a>s <a href=\"http://ruby-doc.org/core-2.5.0/Hash.html#method-i-each_value\" rel=\"nofollow noreferrer\"><code>each_value</code></a> in the hash:</p>\n\n<pre><code>array = items.dup\nenum = containers.each_value.cycle\n</code></pre>\n\n<p>Using the above, you can <a href=\"http://ruby-doc.org/core-2.5.0/Array.html#method-i-shift\" rel=\"nofollow noreferrer\"><code>shift</code></a> 2 items off the array and <a href=\"http://ruby-doc.org/core-2.5.0/Array.html#method-i-push\" rel=\"nofollow noreferrer\"><code>push</code></a> them to the <a href=\"http://ruby-doc.org/core-2.5.0/Enumerator.html#method-i-next\" rel=\"nofollow noreferrer\"><code>next</code></a> container <a href=\"http://ruby-doc.org/core-2.5.0/doc/syntax/control_expressions_rdoc.html#label-until+Loop\" rel=\"nofollow noreferrer\"><code>until</code></a> the array is <a href=\"http://ruby-doc.org/core-2.5.0/Array.html#method-i-empty-3F\" rel=\"nofollow noreferrer\"><code>emtpy?</code></a>:</p>\n\n<pre><code>enum.next.push(*array.shift(2)) until array.empty?\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>containers\n#=&gt; {:one=&gt;[1, 2, 7, 8], :two=&gt;[3, 4, 9, 10], :three=&gt;[5, 6]}\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 2014043, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/SVKKp.png?s=128&g=1", "display_name": "clueless", "link": "https://stackoverflow.com/users/2014043/clueless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 48782937, "answer_count": 3, "score": 1, "last_activity_date": 1518602146, "creation_date": 1518596520, "last_edit_date": 1518602146, "question_id": 48782584, "link": "https://stackoverflow.com/questions/48782584/distribute-items-into-containers-in-twos-rails", "title": "Distribute items into containers in twos - Rails", "body": "<p>I have a list of 10 items -- it is an array of hashes.</p>\n\n<pre><code>[{ id: 1, name: 'one'}, { id: 2, name: 'two' } .. { id: 10, name: 'ten' }]\n</code></pre>\n\n<p>I also have a random number of containers -- let's say 3, in this case. These containers are hashes with array values.</p>\n\n<pre><code>{ one: [], two: [], three: [] }\n</code></pre>\n\n<p>What I want to do, is iterate over the containers and drop 2 items at a time resulting in:</p>\n\n<pre><code>{ \n   one: [{id:1}, {id:2}, {id:7}, {id:8}], \n   two: [{id:3}, {id:4}, {id:9}, {id:10}], \n   three: [{id:5}, {id:6}] \n}\n</code></pre>\n\n<p>Also, if the item list is an odd number (11), the last item is still dropped into the next container.</p>\n\n<pre><code>{ \n   one: [{id:1}, {id:2}, {id:7}, {id:8}], \n   two: [{id:3}, {id:4}, {id:9}, {id:10}], \n   three: [{id:5}, {id:6}, {id:11}] \n}\n</code></pre>\n\n<p><em>note: the hashes are snipped here so it's easier to read.</em></p>\n\n<p>My solution is something like this: (simplified)</p>\n\n<pre><code>x = 10\ncontainers = { one: [], two: [], three: [] }\n\nuntil x &lt; 1 do\n    containers.each do |c|\n        c &lt;&lt; 'x'\n        c &lt;&lt; 'x'\n    end\n    x -= 2\nend\n\nputs containers\n</code></pre>\n\n<p>I'm trying to wrap my head around how I can achieve this but I can't seem to get it to work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "delayed-job"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1518594919, "post_id": 48781530, "comment_id": 84565593, "body": "Seems unlikely that switching from passenger to puma has an effect on delayed_job. It is more likely that updating and changing capistrano recipes caused the issue. Can you please show the rake task you created and explain how you run it? Furthermore, did you check the servers if there are actually delayed_job workers running? Are there any relevant entries in your log files (deploy log, production/delayed-job log, server error log?"}, {"owner": {"reputation": 6370, "user_id": 2279018, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/JI5Hp.jpg?s=128&g=1", "display_name": "SSR", "link": "https://stackoverflow.com/users/2279018/ssr"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1518600577, "post_id": 48781530, "comment_id": 84568809, "body": "@spickermann Thanks for reply! I just updated question please take a look."}, {"owner": {"reputation": 6370, "user_id": 2279018, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/JI5Hp.jpg?s=128&g=1", "display_name": "SSR", "link": "https://stackoverflow.com/users/2279018/ssr"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1518600592, "post_id": 48781530, "comment_id": 84568821, "body": "@spickermann For logs : Yes I can see updated logs for production &amp; deploy. I am also running Monit to handle delayed_jobs to start &amp; stop. Even Monit it self fails to execute."}, {"owner": {"reputation": 6370, "user_id": 2279018, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/JI5Hp.jpg?s=128&g=1", "display_name": "SSR", "link": "https://stackoverflow.com/users/2279018/ssr"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1518670355, "post_id": 48781530, "comment_id": 84602994, "body": "@spickermann Did you see updates in question? I am using Apache + Puma."}], "owner": {"reputation": 6370, "user_id": 2279018, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/JI5Hp.jpg?s=128&g=1", "display_name": "SSR", "link": "https://stackoverflow.com/users/2279018/ssr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1518600526, "creation_date": 1518592197, "last_edit_date": 1518600526, "question_id": 48781530, "link": "https://stackoverflow.com/questions/48781530/delayed-job-stopped-working-after-changing-server-from-passenger-to-puma", "title": "Delayed job stopped working after changing server from passenger to puma", "body": "<p>Recently I just changed server for my production environment from passenger to puma. Before puma delayed job was working fine without any error but after puma it stopped working.</p>\n\n<p>I am running 3 Delayed job to handle incoming requests on two different servers by dividing them as server 1 : 1 Job and server 2 : 2 Jobs.</p>\n\n<pre><code>RAILS_ENV=production bin/delayed_job -i first --queues=job_1,job_2 start\n</code></pre>\n\n<p>This command I am using to start delayed job after deployment. I am using Capistrano 3 for deployment. Also I have upgrade version of Capistrano version 2 to 3.</p>\n\n<p>In Capistrano 2 we had</p>\n\n<pre><code>require 'delayed/recepies'\n</code></pre>\n\n<p>but as per delayed job official documentation I have created a rake task and executing in order to start job again.</p>\n\n<p>It creates a new entry in delayed_jobs table as Delayed::Backend::ActiveRecord::Job.</p>\n\n<p>What's wrong I am doing here? Is there any worker not listening to my incoming calls? Should I need to start additional things?</p>\n\n<p>----UPDATED----</p>\n\n<p>This is the rake task I have created to restart the jobs.</p>\n\n<pre><code>task :restart do\n  on roles(delayed_job_roles) do\n    within release_path do\n      with rails_env: fetch(:rails_env) do\n        execute('cd #{current_path};RAILS_ENV=production bin/delayed_job -i first --queues=job_1,job_2 stop')\n        execute('cd #{current_path};RAILS_ENV=production bin/delayed_job -i second --queues=job_1,job_2 start')\n      end\n    end\n  end\nend\n\nafter 'deploy:publishing', 'delayed_job:restart'\n</code></pre>\n\n<p>As I have mentioned that I am running two seperate servers to manage delayed_jobs. On server 2 delayed_job.log file is not updated with latest logs. When I try to run delayed_job it executes on server 1 instead of server 2. Queues are running over server 2 to handle those jobs and when it runs on server 1 it couldn't find the exact source, which I am looking for to get executed.</p>\n"}, {"tags": ["ruby", "unit-testing", "rspec", "mocking", "serversocket"], "answers": [{"tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": true, "score": 2, "last_activity_date": 1518645056, "last_edit_date": 1518645056, "creation_date": 1518608632, "answer_id": 48786410, "question_id": 48780973, "link": "https://stackoverflow.com/questions/48780973/ruby-unit-test-for-a-simple-socket-server/48786410#48786410", "title": "Ruby unit test for a simple socket server", "body": "<blockquote>\n  <p>I am not even sure where to put my test file and how to test my code.</p>\n</blockquote>\n\n<p>You can put your test file anywhere you want; you just need include the path to your server (and client) at the top of your rpsec file.  For the following example, I put all the files in the same directory.</p>\n\n<pre><code>$ tree sockets\nsockets\n\u251c\u2500\u2500 my_client.rb\n\u251c\u2500\u2500 my_server.rb\n\u251c\u2500\u2500 my_specs.rb\n\u2514\u2500\u2500 prog.rb  #&lt;==creates a client and server to see if they work\n</code></pre>\n\n<p>my_client.rb:</p>\n\n<pre><code>require 'socket'\n\nclass MyClient\n  attr_reader :socket\n\n  def initialize\n    @socket = Socket.new(Socket::AF_INET, Socket::SOCK_STREAM, 0)\n    @socket.setsockopt(Socket::SOL_SOCKET,Socket::SO_REUSEADDR, true)\n    @socket.connect Socket.pack_sockaddr_in(13_500, '127.0.0.1')\n  end\n\n  def send_data(data)\n    @socket.puts data\n  end\n\n  def recv_data\n    @socket.gets\n  end\n\nend\n</code></pre>\n\n<p>my_server.rb:</p>\n\n<pre><code>require 'socket'\n\nclass MyServer\n  attr_reader :server_socket, :client\n\n  def initialize\n    @server_socket = Socket.new(Socket::AF_INET, Socket::SOCK_STREAM, 0)\n    @server_socket.setsockopt(Socket::SOL_SOCKET,Socket::SO_REUSEADDR, true)\n\n    sockaddr = Socket.pack_sockaddr_in(13_500, '127.0.0.1')\n    @server_socket.bind(sockaddr)\n    @server_socket.listen(5)\n  end\n\n  def start\n    #Blocks and waits for client connections:\n    @client, client_sockaddr = @server_socket.accept\n    @client.puts \"Connected to the server! Press q to exit\"\n\n    loop do # loop() automatically catches a StopIteration exception and terminates\n      data = @client.recvfrom(1024)[0].chomp\n      handle_data(data)\n    end\n  end\n\n  def handle_data data\n    case data\n    when 'q', ''\n      raise StopIteration  #terminates loop()\n    else \n      if @client  #For some reason @client can be nil here\n                  #which causes a nil.puts error two lines down.\n        response = data.reverse\n        @client.puts \"Your string in reverse is: #{response}\"\n      end\n    end\n\n      response\n  end\n\n\nend\n</code></pre>\n\n<p>prog.rb:</p>\n\n<pre><code>require_relative 'my_server.rb'\nrequire_relative 'my_client.rb'\n\nserver = MyServer.new\n\nThread.new do\n  server.start\nend\n\nsleep 1  #Otherwise, get connection refused error because client sends\n         #data to server before server creates the client socket\n\nclient = MyClient.new\ngreeting = client.recv_data\nputs greeting\n\nclient.send_data(\"hello\")\nresponse = client.recv_data\nputs response\n\nclient.socket.close\nserver.server_socket.close\nserver.client.close\n</code></pre>\n\n<p>my_specs.rb:</p>\n\n<pre><code>require_relative 'my_server'  #relative path to server\nrequire_relative 'my_client'  #relative path to client\n\ndescribe MyServer do \n\n  before(:example) do\n    @server = MyServer.new\n\n    Thread.new do\n      @server.start\n    end\n\n    sleep 1  #Allow server to start, so client doesn't send data \n             #to the server before the server creates the socket.\n\n    @client = MyClient.new\n    @data = 'hello'\n    @client.send_data @data  #Make sure server has started before doing this.\n  end\n\n  after(:example) do\n    @server.server_socket.close #Will send nil to client, causing gets() to unblock,\n                 #allowing recv_data() to finish executing.\n    @server.client.close\n    @client.socket.close  \n  end\n\n  describe '#handle_data' do\n    context 'given a string' do\n      it \"returns reversed string\" do\n        expect(@server.handle_data(@data)).to eql(@data.reverse)\n      end\n    end\n  end\n\n  describe '- client receives correct response' do\n    context 'given a string' do\n      it \"returns reversed string\" do\n        greeting = @client.recv_data\n        expect(@client.recv_data).to eql(\"Your string in reverse is: #{@data.reverse}\\n\")\n      end\n    end\n  end\n\nend\n</code></pre>\n\n<p>Run the specs:</p>\n\n<pre><code>~/ruby_programs/sockets$ rspec my_specs.rb\n..\n\nFinished in 2.01 seconds (files took 0.11932 seconds to load)\n2 examples, 0 failures\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9358491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ac28000a473136405d355e6c71a2f94?s=128&d=identicon&r=PG&f=1", "display_name": "PJtheOnlyDJ", "link": "https://stackoverflow.com/users/9358491/pjtheonlydj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 48786410, "answer_count": 1, "score": 2, "last_activity_date": 1518645056, "creation_date": 1518589776, "last_edit_date": 1518593546, "question_id": 48780973, "link": "https://stackoverflow.com/questions/48780973/ruby-unit-test-for-a-simple-socket-server", "title": "Ruby unit test for a simple socket server", "body": "<p>I have a simple Socket server that listens on port 9000 and returns the reverse string to the clients.</p>\n\n<pre><code>require 'socket'\n\n# Create the server using the Socket class\nserver_socket = Socket.new(Socket::AF_INET, Socket::SOCK_STREAM, 0)\n# Set the socket addres\nsockaddr = Socket.pack_sockaddr_in(9000, 'localhost')\n\n# Bind the socket address to the server socket\nserver_socket.bind(sockaddr)\n\n# set the state to listen\nserver_socket.listen(5)\nloop do\n  client, client_sockaddr = server_socket.accept\n  client.puts 'Connected to the server! Press q to exit'\n\n  loop do\n    # Receive data using recvfrom method on the new client socket\n    data = client.recvfrom(1024)[0].chomp\n\n    if data == 'q'\n      client.close\n      break\n    else\n      # Reverse the string\n      respond = data.reverse\n\n      # Send the respond\n      client.puts \"Your string in reverse is: #{respond}\"\n    end\n  end\nend\n</code></pre>\n\n<p>Now I want to write unit tests for this server to demonstrate the correctness of the response. I have no idea how to start. Looked at Rspec test and  built-in Test::Unit module but could not figure it out. I know I can use <code>RSpec Mocks</code> or things like that but I am not even sure how where to put my test file and how to test my code.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri"], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "edited": false, "score": 0, "creation_date": 1518590377, "post_id": 48781073, "comment_id": 84563551, "body": "DAYUM SON! That was fast! AND that worked perfectly! Thank you!"}], "tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": true, "score": 2, "last_activity_date": 1518590189, "creation_date": 1518590189, "answer_id": 48781073, "question_id": 48780944, "link": "https://stackoverflow.com/questions/48780944/how-to-edit-all-image-src-attributes-from-a-file-using-nokogiri/48781073#48781073", "title": "How to edit all image src attributes from a file using nokogiri?", "body": "<p>Something like this should do the trick</p>\n\n<pre><code>page.css('img').each do |node|\n node.each do |attr_name,attr_val|\n  node.attributes[\"src\"].value = attr_val.to_s.gsub(\"./\", \"/data/content/\")\n end\nend\n</code></pre>\n\n<p>You can then retrieve the updated HTML in the usual way.</p>\n"}], "owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 48781073, "answer_count": 1, "score": 0, "last_activity_date": 1518590189, "creation_date": 1518589672, "last_edit_date": 1518589989, "question_id": 48780944, "link": "https://stackoverflow.com/questions/48780944/how-to-edit-all-image-src-attributes-from-a-file-using-nokogiri", "title": "How to edit all image src attributes from a file using nokogiri?", "body": "<p>This is what I have right now. Im trying to replace all of the \"./\" in all my src attributes with \"/data/content/..\" . Now im able do individually get the attributes and change it. but how can I edit the entire object itself and save it? as im using it as a string object in the view.</p>\n\n<pre><code>@page = Nokogiri::HTML(@html_content_from_uploaded_rar_index_html)\n@page.css('img').each do |node|\n node.each do |attr_name,attr_val|\n  attr_val.to_s.gsub(\"./\", \"/data/content/\")\n  // need to save page object with updated src attribute values now\n end\nend\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "ruby", "multidimensional-array"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518595826, "post_id": 48780739, "comment_id": 84566003, "body": "Could you turn that text into Ruby code, please?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518634286, "post_id": 48780739, "comment_id": 84590668, "body": "@Stefan wants you to write the example&#39;s input and output as Ruby objects. I agree. That makes it clearer and allows readers to cut and paste to test their code. You could write, for example, <code>arr = [[1, ,1, 4], [1, 6, 9], [2, 6, 5]]</code> and show the desired return value is <code>[[0, 0, 0, 0, 0], [0, 1, 1, 4, 0],...]</code>. Assigning a variable (here <code>arr</code>) to the input object is not essential, but it allows readers to reference the variable in answers and comments without having to define it. Please edit to make the necessary changes. You might even get the hold on your question removed."}], "answers": [{"comments": [{"owner": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1518590797, "post_id": 48781033, "comment_id": 84563710, "body": "<code>Array.new(array[0].size + 2, 0)]</code> would be better"}, {"owner": {"reputation": 1265, "user_id": 6092216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F6a3O.jpg?s=128&g=1", "display_name": "Nabin Paudyal", "link": "https://stackoverflow.com/users/6092216/nabin-paudyal"}, "reply_to_user": {"reputation": 24729, "user_id": 2564200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a92dfcc9fcac72dabd4b1eefa0b5106e?s=128&d=identicon&r=PG&f=1", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/2564200/santhosh"}, "edited": false, "score": 0, "creation_date": 1518594382, "post_id": 48781033, "comment_id": 84565330, "body": "@Santhosh Thanks, I will change it accordingly."}], "tags": [], "owner": {"reputation": 1265, "user_id": 6092216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F6a3O.jpg?s=128&g=1", "display_name": "Nabin Paudyal", "link": "https://stackoverflow.com/users/6092216/nabin-paudyal"}, "is_accepted": false, "score": 1, "last_activity_date": 1518680972, "last_edit_date": 1518680972, "creation_date": 1518589996, "answer_id": 48781033, "question_id": 48780739, "link": "https://stackoverflow.com/questions/48780739/how-to-expand-a-two-dimentioanl-array/48781033#48781033", "title": "How to expand a two dimentioanl array", "body": "<p>The following Ruby onliner should do the trick.</p>\n\n<pre><code>array = [[1, 1, 4], \n         [1, 6, 9], \n         [2, 6, 5]] \n\nresult = [Array.new(array.size + 2, 0)] + array.map{|subarr| [0] + subarr + [0]} + [Array.new(array.size + 2, 0)]\n</code></pre>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1518648297, "last_edit_date": 1518648297, "creation_date": 1518596198, "answer_id": 48782502, "question_id": 48780739, "link": "https://stackoverflow.com/questions/48780739/how-to-expand-a-two-dimentioanl-array/48782502#48782502", "title": "How to expand a two dimentioanl array", "body": "<pre><code>arr = [[1, 1, 4], \n       [1, 6, 9], \n       [2, 6, 5]] \n</code></pre>\n\n<p>The following avoids the need to check for boundary cases.</p>\n\n<pre><code>Array.new(arr.size+2) { |i| Array.new(arr.first.size+2, 0) }.tap { |a|\n  arr.size.times { |i| arr.first.size.times { |j| a[i+1][j+1] = arr[i][j] } } }\n\n  #=&gt; [[0, 0, 0, 0, 0],\n  #    [0, 1, 1, 4, 0],\n  #    [0, 1, 6, 9, 0],\n  #    [0, 2, 6, 5, 0],\n  #    [0, 0, 0, 0, 0]]\n</code></pre>\n\n<p>See the docs for the class method <a href=\"http://ruby-doc.org/core-2.4.0/Array.html#method-c-new\" rel=\"nofollow noreferrer\">Array::new</a> and the instance method <a href=\"http://ruby-doc.org/core-2.4.0/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a>.</p>\n"}], "owner": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1518616395, "accepted_answer_id": 48782502, "answer_count": 2, "score": -3, "last_activity_date": 1518680972, "creation_date": 1518588768, "question_id": 48780739, "link": "https://stackoverflow.com/questions/48780739/how-to-expand-a-two-dimentioanl-array", "closed_reason": "Needs details or clarity", "title": "How to expand a two dimentioanl array", "body": "<p>is there easy way that we can pad zero's around two dimensional ruby array ?</p>\n\n<pre><code>1 1 4\n1 6 9\n2 6 5\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>0 0 0 0 0\n0 1 1 4 0\n0 1 6 9 0\n0 2 6 5 0\n0 0 0 0 0 \n</code></pre>\n"}, {"tags": ["ruby", "elasticsearch", "aggregate-functions"], "answers": [{"tags": [], "owner": {"reputation": 3749, "user_id": 1890983, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/mtNrR.png?s=128&g=1", "display_name": "Mohammad Akbari", "link": "https://stackoverflow.com/users/1890983/mohammad-akbari"}, "is_accepted": true, "score": 0, "last_activity_date": 1518607894, "creation_date": 1518607894, "answer_id": 48786174, "question_id": 48780221, "link": "https://stackoverflow.com/questions/48780221/elasticsearch-group-by-and-aggregate/48786174#48786174", "title": "ElasticSearch group by and aggregate", "body": "<p>ElasticSearch supports sub aggregations. You must use from that and then in your application side convert result of query to what you want. </p>\n\n<p>Query: </p>\n\n<pre><code>{\n    \"size\": 0,\n    \"aggs\": {\n        \"src_agg\": {\n            \"terms\": {\n                \"field\": \"src\"\n            },\n            \"aggs\": {\n                \"dst_agg\": {\n                    \"terms\": {\n                        \"field\": \"dst\"\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Sample of result:</p>\n\n<pre><code>{\n    \"key\": \"X1\",\n    \"doc_count\": 5,\n    \"agg2\": {\n        \"doc_count_error_upper_bound\": 0,\n        \"sum_other_doc_count\": 0,\n        \"buckets\": [{\n            \"key\": \"Y1\",\n            \"doc_count\": 2 // ***\n        },\n        {\n            \"key\": \"Y2\",\n            \"doc_count\": 3  // ***\n        }]\n    }\n}\n</code></pre>\n\n<p>You can extract desired data from *** in result:</p>\n\n<pre><code>(X1, Y1) = 2, (X1, Y2) = 3\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 761179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3fabb3fa74913b2e7fdb837ab0b29ba?s=128&d=identicon&r=PG", "display_name": "user72003", "link": "https://stackoverflow.com/users/761179/user72003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48786174, "answer_count": 1, "score": 0, "last_activity_date": 1518607894, "creation_date": 1518585989, "question_id": 48780221, "link": "https://stackoverflow.com/questions/48780221/elasticsearch-group-by-and-aggregate", "title": "ElasticSearch group by and aggregate", "body": "<p>I have a bunch of network traffic logs in ES and want to get some high level stats for each source:dest pair.</p>\n\n<p>In SQL, I\u2019d do something like:</p>\n\n<pre><code>SELECT src, dst, SUM(bytes)\nFROM net_traffic\nWHERE start&gt;1518585000000\nAND end&lt;1518585300000\nGROUP BY src, dst\n</code></pre>\n\n<p>(<em>start</em> and <em>end</em> are just epoch times during which the traffic was seen)</p>\n\n<p>How can I extract the same information from the data stored in ES?</p>\n\n<p>I\u2019m coding the solution in Ruby but ideally just want an ES query to pull out the data - so solution is hopefully agnostic of implementation language.</p>\n"}, {"tags": ["ruby", "vim"], "answers": [{"comments": [{"owner": {"reputation": 1689, "user_id": 240427, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/14a4ec3cdc51bfd7e6f4d8a61e007592?s=128&d=identicon&r=PG", "display_name": "Fishtoaster", "link": "https://stackoverflow.com/users/240427/fishtoaster"}, "edited": false, "score": 0, "creation_date": 1518596761, "post_id": 48780563, "comment_id": 84566448, "body": "Yes, I suggested that as the best workaround I had in the original question.  I was kinda looking for anything else.  Were this a normal ruby script, I could just do <code>exit</code>, but of course that doesn&#39;t work either because vim seems to catch the SystemExit exception and display it as an error.  So back to the original question: is there any way to exit early from the ruby script without introducing an additional level of nesting?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1518601016, "post_id": 48780563, "comment_id": 84569083, "body": "Possibly less verbose than <code>def my_method; ... return; ... end; my_method</code> might be <code>1.times do ... break ... end</code>. It&#39;s still a hack, but a shorter one."}, {"owner": {"reputation": 19956, "user_id": 451941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/445f31cee6cbc99490297198c54f2589?s=128&d=identicon&r=PG", "display_name": "Jeen Broekstra", "link": "https://stackoverflow.com/users/451941/jeen-broekstra"}, "reply_to_user": {"reputation": 1689, "user_id": 240427, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/14a4ec3cdc51bfd7e6f4d8a61e007592?s=128&d=identicon&r=PG", "display_name": "Fishtoaster", "link": "https://stackoverflow.com/users/240427/fishtoaster"}, "edited": false, "score": 0, "creation_date": 1518606680, "post_id": 48780563, "comment_id": 84572781, "body": "@Fishtoaster I completely missed that bit of your question, sorry. Will try and look at it again tomorrow."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 1689, "user_id": 240427, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/14a4ec3cdc51bfd7e6f4d8a61e007592?s=128&d=identicon&r=PG", "display_name": "Fishtoaster", "link": "https://stackoverflow.com/users/240427/fishtoaster"}, "edited": false, "score": 0, "creation_date": 1518634854, "post_id": 48780563, "comment_id": 84590975, "body": "@Fishtoaster have you tried rescuing the <code>SystemExit</code> ? seems dirty to me but it should work in this case"}, {"owner": {"reputation": 1689, "user_id": 240427, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/14a4ec3cdc51bfd7e6f4d8a61e007592?s=128&d=identicon&r=PG", "display_name": "Fishtoaster", "link": "https://stackoverflow.com/users/240427/fishtoaster"}, "edited": false, "score": 0, "creation_date": 1518648733, "post_id": 48780563, "comment_id": 84597641, "body": "Not a terrible idea- I suppose it&#39;d work.  Could really throw any exception and catch it to get the same behavior.   Although I don&#39;t know if that buys me anything that wrapping the whole content in a function doesn&#39;t."}], "tags": [], "owner": {"reputation": 19956, "user_id": 451941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/445f31cee6cbc99490297198c54f2589?s=128&d=identicon&r=PG", "display_name": "Jeen Broekstra", "link": "https://stackoverflow.com/users/451941/jeen-broekstra"}, "is_accepted": false, "score": 0, "last_activity_date": 1518762849, "last_edit_date": 1518762849, "creation_date": 1518587897, "answer_id": 48780563, "question_id": 48779895, "link": "https://stackoverflow.com/questions/48779895/how-to-cleanly-exit-ruby-in-vimscript/48780563#48780563", "title": "How to cleanly exit ruby in vimscript", "body": "<p>You get this error because there is nothing to return <em>from</em>. <code>return</code> is intended to break out of the enclosing method, but in your example there is no method.</p>\n\n<p>A possible fix is to create an enclosing method:</p>\n\n<pre><code>function! RubyTest()\nruby &lt;&lt; EOF\n def my_method\n  some_condition = true\n  puts \"aaa\"\n  return if some_condition\n  puts \"bbb\"\n end\n my_method\nEOF\nendfunction\n</code></pre>\n\n<p><em>Edit</em> Completely missed that you already suggested this solution yourself and was looking for alternatives. I can't offer any, or at least none that are any shorter or cleaner than the above. I'll delete this answer if you want. </p>\n"}], "owner": {"reputation": 1689, "user_id": 240427, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/14a4ec3cdc51bfd7e6f4d8a61e007592?s=128&d=identicon&r=PG", "display_name": "Fishtoaster", "link": "https://stackoverflow.com/users/240427/fishtoaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518762849, "creation_date": 1518583973, "question_id": 48779895, "link": "https://stackoverflow.com/questions/48779895/how-to-cleanly-exit-ruby-in-vimscript", "title": "How to cleanly exit ruby in vimscript", "body": "<h3>TLDR</h3>\n\n<p>Given a vim command like:</p>\n\n<pre><code>nnoremap &lt;leader&gt;x :ruby puts 'foo'; exit 0; puts 'bar'&lt;CR&gt;\n</code></pre>\n\n<p>What could I replace <code>exit 0</code> with to make this command exit cleanly without printing <code>'bar'</code>?</p>\n\n<h3>Longer version</h3>\n\n<p>Say I have a ruby script in my vimconfig.  For clarity I'll wrap it in a function, but that's not really necessary:</p>\n\n<pre><code>function! RubyTest()\nruby &lt;&lt; EOF\n  some_condition = true\n  puts \"aaa\"\n  return if some_condition\n  puts \"bbb\"\nEOF\nendfunction\n</code></pre>\n\n<p>I want to, depending on some condition, exit this ruby code early so <code>puts \"bbb\"</code> doesn't get executed.</p>\n\n<p>Now, I <em>could</em> just wrap the whole thing in a conditional:</p>\n\n<pre><code>  some_condition = true\n  puts \"aaa\"\n  unless some_condition\n    puts \"bbb\"\n  end\n</code></pre>\n\n<p>But this sucks if <code>puts \"bbb\"</code> is actually dozens of lines.  It's even worse if, instead of this toy example, I have a number of conditionals that would end up extremely nested and unreadable.</p>\n\n<p>So, what I'd really like to do is:</p>\n\n<pre><code>some_condition = true\nputs \"aaa\"\nreturn if some_condition\nputs \"bbb\"\n</code></pre>\n\n<p>However, <code>return</code> outputs an error:</p>\n\n<pre><code>Error detected while processing function RubyTest:\nline    6:\nLocalJumpError: unexpected return  \n</code></pre>\n\n<p>So does <code>exit</code>(<code>SystemExit: exit</code>), <code>next</code> (<code>SyntaxError: eval:3: Can't escape from eval with next</code>), and <code>break</code> (<code>SyntaxError: eval:3: Can't escape from eval with break</code>).</p>\n\n<p>My best workaround is to wrap the entire content of the ruby script in a function, immediately execute that function, and then just <code>return</code> from within it as necessary.  That seems silly, though \u2014 surely there's some way to just cleanly exit from whatever weird context Vim is executing this ruby in, right?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9328889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0a0e70b8778c940727dc43e9254be3?s=128&d=identicon&r=PG&f=1", "display_name": "kethianu", "link": "https://stackoverflow.com/users/9328889/kethianu"}, "edited": false, "score": 0, "creation_date": 1518583292, "post_id": 48779626, "comment_id": 84561185, "body": "thank you very much, this is the first test code that i wrote. how may i write better unit test scenario. can you give me a example test scenarios of using devise(user)"}, {"owner": {"reputation": 654, "user_id": 2329794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1595faba70351b69bab5fc337c486d8?s=128&d=identicon&r=PG", "display_name": "Josh McMillan", "link": "https://stackoverflow.com/users/2329794/josh-mcmillan"}, "reply_to_user": {"reputation": 27, "user_id": 9328889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0a0e70b8778c940727dc43e9254be3?s=128&d=identicon&r=PG&f=1", "display_name": "kethianu", "link": "https://stackoverflow.com/users/9328889/kethianu"}, "edited": false, "score": 0, "creation_date": 1518583471, "post_id": 48779626, "comment_id": 84561228, "body": "For RSpec-specific things, have a look at <a href=\"http://www.betterspecs.org/\" rel=\"nofollow noreferrer\">Better Specs</a>. For guidance around unit tests in general, start by learning about <a href=\"http://wiki.c2.com/?ArrangeActAssert\" rel=\"nofollow noreferrer\">Arrange Act Assert</a> \u2013 it&#39;s the foundation of writing good tests."}], "tags": [], "owner": {"reputation": 654, "user_id": 2329794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1595faba70351b69bab5fc337c486d8?s=128&d=identicon&r=PG", "display_name": "Josh McMillan", "link": "https://stackoverflow.com/users/2329794/josh-mcmillan"}, "is_accepted": false, "score": 1, "last_activity_date": 1518582087, "creation_date": 1518582087, "answer_id": 48779626, "question_id": 48779531, "link": "https://stackoverflow.com/questions/48779531/how-to-test-my-devise-code-using-rspec/48779626#48779626", "title": "How to test my devise code using rspec?", "body": "<p>Okay \u2013 as I understand it you're asking for what the best practices are for testing a Rails model. The fact that it's auto-generated by Devise is largely irrelevant.</p>\n\n<p>The first thing I would consider here is <em>what</em> it is that you're actually testing \u2013 most of your code here is testing the underlying implementation of Devise. That shouldn't be the responsibility of your application's test suite \u2013 the library has a bunch of tests that should test that for you.</p>\n\n<p>The only real useful tests here, IMO, are the association tests (which look like they come from <code>shoulda-matchers</code>). The rest of the assertions here are testing Devise-specific code, which is tightly coupling your test suite to a 3rd-party library \u2013 that's only going to put you in a world of pain further down the line.</p>\n"}], "owner": {"reputation": 27, "user_id": 9328889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0a0e70b8778c940727dc43e9254be3?s=128&d=identicon&r=PG&f=1", "display_name": "kethianu", "link": "https://stackoverflow.com/users/9328889/kethianu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518587490, "creation_date": 1518581407, "last_edit_date": 1518587490, "question_id": 48779531, "link": "https://stackoverflow.com/questions/48779531/how-to-test-my-devise-code-using-rspec", "title": "How to test my devise code using rspec?", "body": "<p>Here is my unit testing code for devise. Are there any ways to write better test code?</p>\n\n<p>user_spec.rb:</p>\n\n<pre><code>require 'rails_helper'\n\n    RSpec.describe User, type: :model do\n\n      it { should have_many(:companies) }\n      it { should have_many(:jobs) }\n      it do\n               should validate_length_of(:encrypted_password).\n                   is_at_least(6).\n                   on(:create)\n               end\n\n      it { is_expected.to validate_presence_of(:email) }\n      it { is_expected.to validate_presence_of(:encrypted_password) }\n      it { should have_db_column(:id) }\n      it { should have_db_column(:email) }\n      it { should have_db_column(:encrypted_password) }\n      it { should have_db_column(:confirmation_token) }\n      it { should have_db_column(:confirmed_at) }\n      it { should have_db_column(:confirmation_sent_at) }\n\n      it 'is databse authenticable' do\n        user = User.create(\n           email: 'test@example.com', \n          password: 'password123',\n          password_confirmation: 'password123'\n        )\n        expect(user.valid_password?('password123')).to be_truthy\n      end\nend\n</code></pre>\n"}, {"tags": ["ruby", "office365", "exchangewebservices", "impersonation", "viewpoint"], "answers": [{"tags": [], "owner": {"reputation": 2063, "user_id": 1004592, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c9811e7d0160cde543042a8d025436cb?s=128&d=identicon&r=PG", "display_name": "Yasitha", "link": "https://stackoverflow.com/users/1004592/yasitha"}, "is_accepted": true, "score": 0, "last_activity_date": 1519814065, "creation_date": 1519814065, "answer_id": 49027419, "question_id": 48779473, "link": "https://stackoverflow.com/questions/48779473/could-not-access-delegated-impersonated-shared-mailbox-via-ews/49027419#49027419", "title": "Could not access delegated/impersonated shared mailbox via EWS", "body": "<p>Finally found the root cause of this error. Usually shared mailboxes don't require any licenses. <code>Could not retrieve folders. ErrorNonExistentMailbox: No mailbox with such guid</code>error happens when we going to access unlicensed mailboxes.</p>\n\n<p>I was able to access the mailbox when I try <code>UserPrincipalName</code> instead of <code>PrimarySmtpAddress</code>.</p>\n"}], "owner": {"reputation": 2063, "user_id": 1004592, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c9811e7d0160cde543042a8d025436cb?s=128&d=identicon&r=PG", "display_name": "Yasitha", "link": "https://stackoverflow.com/users/1004592/yasitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 49027419, "answer_count": 1, "score": 0, "last_activity_date": 1519814065, "creation_date": 1518581024, "question_id": 48779473, "link": "https://stackoverflow.com/questions/48779473/could-not-access-delegated-impersonated-shared-mailbox-via-ews", "title": "Could not access delegated/impersonated shared mailbox via EWS", "body": "<p>I am trying get mailbox folders using global admin account credentials via EWS. I am using the following ruby script with viewpoint gem to do it.</p>\n\n<pre><code>require 'viewpoint'\n\ninclude Viewpoint::EWS\n\nendpoint = 'https://outlook.office365.com/ews/exchange.asmx'\nadmin_email = 'admin@hostname.com'\npassword = 'password'\n\nuser_email = \"user@hostname.com\"\n\ncli = Viewpoint::EWSClient.new endpoint, admin_email, password\ncli.set_impersonation 'PrimarySmtpAddress', user_email  #impersonation\nact_as_hash = { act_as: user_email }\nresults = cli.folders(act_as_hash)\n\nputs results.count\n</code></pre>\n\n<p>I have created required permissions and impersonations for all the mailboxes. I am having a issue when accessing shared mailboxes. I can access user mailbox folders using the same script.</p>\n\n<p>When I tried the above script to get shared mailbox folders I am getting following error.</p>\n\n<pre><code>/Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/connection.rb:121:in `check_response': SOAP Error: Message: The primary SMTP address must be specified when referencing a mailbox.  Code: a:ErrorNonPrimarySmtpAddress (Viewpoint::EWS::Errors::SoapResponseError)\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/connection.rb:103:in `post'\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/connection.rb:81:in `dispatch'\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/soap/exchange_web_service.rb:212:in `do_soap_request'\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/soap/exchange_data_services.rb:503:in `find_folder'\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/folder_accessors.rb:45:in `folders'\n    from o365_test_connection.rb:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>I tried to comment the impersonation line and use delegation to access the mailbox folders but I get the following error.</p>\n\n<pre><code>/Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/folder_accessors.rb:167:in `find_folders_parser': Could not retrieve folders. ErrorNonExistentMailbox: No mailbox with such guid. (Viewpoint::EWS::EwsFolderNotFound)\n    from /Users/yasitha/.rvm/gems/ruby-2.3.0/gems/viewpoint-1.1.0/lib/ews/folder_accessors.rb:46:in `folders'\n    from o365_test_connection.rb:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>Can anyone help me on this?</p>\n"}, {"tags": ["ruby", "cucumber", "appium", "swipe"], "comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1518586594, "post_id": 48779353, "comment_id": 84562157, "body": "Hi, @dexter, I think we need way more context to help you."}, {"owner": {"reputation": 778, "user_id": 2581843, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000141231384/picture?type=large", "display_name": "Sander Saelmans", "link": "https://stackoverflow.com/users/2581843/sander-saelmans"}, "edited": false, "score": 0, "creation_date": 1518597760, "post_id": 48779353, "comment_id": 84566942, "body": "Maybe you should use swipe? <a href=\"http://www.rubydoc.info/github/appium/ruby_lib/Appium/TouchAction:swipe\" rel=\"nofollow noreferrer\">rubydoc.info/github/appium/ruby_lib/Appium/TouchAction:swipe</a>"}, {"owner": {"reputation": 91, "user_id": 1344597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5fd2d7263bd762fb981b651e0ed02827?s=128&d=identicon&r=PG", "display_name": "rusty", "link": "https://stackoverflow.com/users/1344597/rusty"}, "edited": false, "score": 0, "creation_date": 1518600176, "post_id": 48779353, "comment_id": 84568528, "body": "Thanks keith and Sander instead of flick I used  Appium::TouchAction.new.swipe(start_x: 0.90 , start_y: 0.5, offset_x: 0.5, offset_y: 0.5, duration:500).perform  with the above line i could swipe left   here&#39;s the link to the site   <a href=\"https://discuss.appium.io/t/left-to-right-swipe-doesnt-work-for-me-android-appium-using-ruby-cucumber/19950/2\" rel=\"nofollow noreferrer\">discuss.appium.io/t/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 1344597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5fd2d7263bd762fb981b651e0ed02827?s=128&d=identicon&r=PG", "display_name": "rusty", "link": "https://stackoverflow.com/users/1344597/rusty"}, "is_accepted": false, "score": 0, "last_activity_date": 1518600619, "creation_date": 1518600619, "answer_id": 48783703, "question_id": 48779353, "link": "https://stackoverflow.com/questions/48779353/how-to-swipe-left-using-ruby-cucumber/48783703#48783703", "title": "How to swipe left using ruby cucumber", "body": "<p>Thanks keith and Sander\ninstead of flick I used</p>\n\n<p>Appium::TouchAction.new.swipe(start_x: 0.90 , start_y: 0.5, offset_x: 0.5, offset_y: 0.5, duration:500).perform</p>\n\n<p>with the above line i could swipe left</p>\n\n<p>here's the link to the site </p>\n\n<p><a href=\"https://discuss.appium.io/t/left-to-right-swipe-doesnt-work-for-me-android-appium-using-ruby-cucumber/19950/2\" rel=\"nofollow noreferrer\">https://discuss.appium.io/t/left-to-right-swipe-doesnt-work-for-me-android-appium-using-ruby-cucumber/19950/2</a></p>\n"}], "owner": {"reputation": 91, "user_id": 1344597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5fd2d7263bd762fb981b651e0ed02827?s=128&d=identicon&r=PG", "display_name": "rusty", "link": "https://stackoverflow.com/users/1344597/rusty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518600619, "creation_date": 1518580190, "question_id": 48779353, "link": "https://stackoverflow.com/questions/48779353/how-to-swipe-left-using-ruby-cucumber", "title": "How to swipe left using ruby cucumber", "body": "<p>I have to swipe x number of times to view the main page.\nIf I use<br>\ndelta = {:x => 0.0, :y => 0.0} \nflick(\"com.test.app:id/textView_slideshow\", delta)</p>\n\n<p>I get an error\nCannot swipe in {:x=>0.0, :y=>0.0} (RuntimeError)</p>\n\n<p>The swipe and pan functions do not work in ruby</p>\n"}, {"tags": ["ruby", "postgresql", "sequel"], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 0, "creation_date": 1518630835, "post_id": 48778991, "comment_id": 84588877, "body": "Could you clarify - do you mean I should recreate the table? Or are you talking about some function that exists?"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 0, "creation_date": 1518632118, "post_id": 48778991, "comment_id": 84589545, "body": "No. No matter if you recreate the table, records will not be retrieved in order, unless you specify the order in the query (such as <code>order(:time)</code>). So the important thing is to index the database by the field used to get records in order. If you want your records sorted by time, you must have an index based on the time field. Is your table indexed by time?"}, {"owner": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 0, "creation_date": 1518634527, "post_id": 48778991, "comment_id": 84590792, "body": "I&#39;m googling to try and understand what you mean - I&#39;m not very experienced with databases, so I don&#39;t know what you mean by creating an index."}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 0, "creation_date": 1518636289, "post_id": 48778991, "comment_id": 84591724, "body": "<code>CREATE INDEX index_name ON table_name (column_name)</code>; In your case: <code>CREATE INDEX mydb_time_index ON mydb (time)</code> (assuming the table is called mydb and the column is called time, as your OP states)."}, {"owner": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 0, "creation_date": 1518636401, "post_id": 48778991, "comment_id": 84591793, "body": "Amazing. Okay thank you! Will try that now. Do I specify the index name instead of the time column from that point on or do I continue as normal?"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "edited": false, "score": 1, "creation_date": 1518636510, "post_id": 48778991, "comment_id": 84591842, "body": "You continue specifying the column name. The database knows there is an index for this column."}, {"owner": {"reputation": 322, "user_id": 6062644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c3MLX.jpg?s=128&g=1", "display_name": "JLB", "link": "https://stackoverflow.com/users/6062644/jlb"}, "edited": false, "score": 0, "creation_date": 1518715257, "post_id": 48778991, "comment_id": 84629293, "body": "Here&#39;s a short explanation on ORDER BY with an index.  <a href=\"https://www.postgresql.org/docs/10/static/indexes-ordering.html\" rel=\"nofollow noreferrer\">postgresql.org/docs/10/static/indexes-ordering.html</a>"}], "tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1518577321, "creation_date": 1518577321, "answer_id": 48778991, "question_id": 48778817, "link": "https://stackoverflow.com/questions/48778817/sequel-gem-reorder-postgres-database/48778991#48778991", "title": "Sequel gem reorder postgres database?", "body": "<p>If you want to get record in a specific order you must use an order clause. Most databases do not guarantee the order if no sort clause is provided. </p>\n\n<p>You should index your table by the fields you will use to sort. </p>\n"}], "owner": {"reputation": 517, "user_id": 4200859, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/72fe764d26ac6cb9d3a5bbeaa45fc1be?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4200859/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 48778991, "answer_count": 1, "score": 0, "last_activity_date": 1518577321, "creation_date": 1518575818, "question_id": 48778817, "link": "https://stackoverflow.com/questions/48778817/sequel-gem-reorder-postgres-database", "title": "Sequel gem reorder postgres database?", "body": "<p>I'm using the Sequel gem with a postgres database which has a 300k+ entries. I'm trying to get the earliest and latest entry by time, however I migrated the db and some entries got out of order time-wise.</p>\n\n<p>If I use <code>mydb[:items].first</code> and <code>mydb[:items].last</code> it takes a fraction of a second for the query. However, like I said, they aren't fully in order of time, so that can get messed up. If I run <code>mydb[:items].order(:time).first</code> and <code>mydb[:items].order(:time).last</code>, it works but it takes FAR longer (roughly six seconds) to complete each query.</p>\n\n<p>Is there a way to reorder the database so it's naturally in order of time, so I don't have to run the order command? Or am I just doing something wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 7972, "user_id": 1297435, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a9a1330f0e323fabed39f561f1b0d94c?s=128&d=identicon&r=PG", "display_name": "rails_id", "link": "https://stackoverflow.com/users/1297435/rails-id"}, "edited": false, "score": 0, "creation_date": 1518574082, "post_id": 48778577, "comment_id": 84558855, "body": "have you try with <code>data[:labels] += dictionary.keys</code> or <code>data[:labels] = dictionary.keys</code> ?"}, {"owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "reply_to_user": {"reputation": 7972, "user_id": 1297435, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a9a1330f0e323fabed39f561f1b0d94c?s=128&d=identicon&r=PG", "display_name": "rails_id", "link": "https://stackoverflow.com/users/1297435/rails-id"}, "edited": false, "score": 0, "creation_date": 1518575016, "post_id": 48778577, "comment_id": 84559084, "body": "You mean instead of shoveling it?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1518575270, "post_id": 48778577, "comment_id": 84559136, "body": "you should either use <code>+=</code> or <code>concat</code>. <code>&lt;&lt;</code> is used to push a single value only (in this case the &#39;single value&#39; is an array). Preferably <code>+=</code>, since it doesn&#39;t mutate the array like <code>push</code>, <code>concat</code>, or <code>&lt;&lt;</code> do."}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518575743, "post_id": 48778577, "comment_id": 84559234, "body": "Can you show the structure and data in results?"}, {"owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "edited": false, "score": 0, "creation_date": 1518576539, "post_id": 48778577, "comment_id": 84559424, "body": "I don&#39;t have the structure at the moment, the data is basically like this      [[&#39;cubs&#39;, 1][&#39;cubs&#39;, 1][&#39;cubs&#39;, 1][&#39;cubs&#39;, 1][&#39;cubs&#39;, 1][&#39;astros&#39;, 1][&#39;astros&#39;, 1][&#39;astros&#39;, 1]]"}, {"owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518576598, "post_id": 48778577, "comment_id": 84559432, "body": "@maxpleaner - i will look into that in the morning."}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1518631461, "post_id": 48778577, "comment_id": 84589203, "body": "Would be helpful to have a concrete example of an input value and its expected output."}, {"owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518638369, "post_id": 48778577, "comment_id": 84592841, "body": "@maxpleaner -- Thank you problem solved"}], "answers": [{"tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1518580774, "creation_date": 1518580774, "answer_id": 48779439, "question_id": 48778577, "link": "https://stackoverflow.com/questions/48778577/ruby-array-of-arrays-returning-query-to-be-used-for-chartjs/48779439#48779439", "title": "Ruby Array of Arrays returning query to be used for chartjs,", "body": "<p>The simplest solution is to flatten the arrays prior to returning the data:</p>\n\n<pre><code>data = { :labels =&gt; [], datasets: [data: []] }\ndictionary = {}\nresults.each do |teams|\n    team = teams[0]\n    teamMembers = teams[1]\n\n    if dictionary[team].nil?\n        dictionary[team] = teamMembers\n    else \n        dictionary[team] += teamMembers\n\n    end\nend\ndata[:labels] &lt;&lt; dictionary.keys\ndata[:datasets][0][:data] &lt;&lt; dictionary.values\ndata[:labels].flatten!\ndata[:datasets][0][:data].flatten!\ndata\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "is_accepted": false, "score": 0, "last_activity_date": 1518638451, "creation_date": 1518638451, "answer_id": 48795280, "question_id": 48778577, "link": "https://stackoverflow.com/questions/48778577/ruby-array-of-arrays-returning-query-to-be-used-for-chartjs/48795280#48795280", "title": "Ruby Array of Arrays returning query to be used for chartjs,", "body": "<p>@maxpleaner and @rails_id were correct</p>\n\n<pre><code>def self.return_this_data_for_map_method\ndata = { :labels =&gt; [], datasets: [data: []] }\ndictionary = {}\nresults.each do |teams|\n    team = teams[0]\n    teamMembers = teams[1]\n\n    if dictionary[team].nil?\n        dictionary[team] = teamMembers\n    else \n        dictionary[team] += teamMembers\n\n    end\nend\ndata[:labels] += dictionary.keys\ndata[:datasets][0][:data] += dictionary.values\ndata\n</code></pre>\n\n<p>end</p>\n"}], "owner": {"reputation": 171, "user_id": 437107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/34319949/picture?type=large", "display_name": "jeremiah", "link": "https://stackoverflow.com/users/437107/jeremiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 48779439, "answer_count": 2, "score": 0, "last_activity_date": 1518638451, "creation_date": 1518573797, "question_id": 48778577, "link": "https://stackoverflow.com/questions/48778577/ruby-array-of-arrays-returning-query-to-be-used-for-chartjs", "title": "Ruby Array of Arrays returning query to be used for chartjs,", "body": "<pre><code>def self.return_this_data_for_map_method\n    data = { :labels =&gt; [], datasets: [data: []] }\n    dictionary = {}\n    results.each do |teams|\n        team = teams[0]\n        teamMembers = teams[1]\n\n        if dictionary[team].nil?\n            dictionary[team] = teamMembers\n        else \n            dictionary[team] += teamMembers\n\n        end\n    end\n    data[:labels] &lt;&lt; dictionary.keys\n    data[:datasets][0][:data] &lt;&lt; dictionary.values\n    data\nend\n</code></pre>\n\n<p>This is the data I am getting out</p>\n\n<pre><code> =&gt; {:labels=&gt;[[\"CUBS\", \"CARDS\", \"ROCKIES\", \"ASTROS\"]]:datasets=&gt;[{:data=&gt;[[72, 93, 74, 28]]}]}\n</code></pre>\n\n<p>This is how I am trying to get my data</p>\n\n<pre><code>=&gt; {:labels=&gt;[\"CUBS\", \"CARDS\", \"ROCKIES\", \"ASTROS\"], :datasets=&gt;[{:data=&gt;[72, 93, 74, 28]}]}\n</code></pre>\n\n<p>It's wrapping it like it's still in an Array of Arrays, I am not quite seeing how to break how of it.  Any suggestions on how I can fix my code would be appreciated.</p>\n\n<p>using ruby 2.3.1</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 3, "last_activity_date": 1518571235, "creation_date": 1518571235, "answer_id": 48778287, "question_id": 48778216, "link": "https://stackoverflow.com/questions/48778216/rails-how-to-access-different-db-table-in-a-view/48778287#48778287", "title": "Rails How to access different DB table in a view", "body": "<p>Since you've already defined that a Customer may have many contracts then you need now to define that that Contract belongs to a customer, so, modifying your models they should look like:</p>\n\n<pre><code>class Contract &lt; ApplicationRecord\n  belongs_to :customer\n  ...\nend\n\nclass Customer &lt; ApplicationRecord\n  has_many :contracts\n  ...\nend\n</code></pre>\n\n<p>Now you're able to access the customer name attribute from a certain contract, like:</p>\n\n<pre><code>&lt;% @contracts.each do |contract| %&gt;\n  &lt;%= contract.customer.name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This should work on getting the customer name, but for improving that query, you might add an includes on the index action:</p>\n\n<pre><code>def index\n  @contracts = Contract.includes(:customer).all\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9357673, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156117468314264/picture?type=large", "display_name": "Jesse Bell", "link": "https://stackoverflow.com/users/9357673/jesse-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 48778287, "answer_count": 1, "score": 1, "last_activity_date": 1518571292, "creation_date": 1518570697, "last_edit_date": 1518571292, "question_id": 48778216, "link": "https://stackoverflow.com/questions/48778216/rails-how-to-access-different-db-table-in-a-view", "title": "Rails How to access different DB table in a view", "body": "<p>I am new to Ruby and RubyOnRails. I have been following a basic Rails tutorial thus far and have created several views and controllers to be able to perform basic CRUD on my MySQL DB, each one is specific to tables in the DB.</p>\n\n<p>I started a new view, and I want to be able to display info from two separate tables. I want to be able to grab the Customers Name for their contract. I feel like this is an easy and common fix, What the heck am I overlooking?</p>\n\n<p>Contract View</p>\n\n<pre><code> &lt;table&gt;\n    &lt;tr&gt;\n    &lt;th&gt;Contract ID&lt;/th&gt;\n    &lt;th&gt;Customer ID&lt;/th&gt;\n    &lt;th&gt;Discount&lt;/th&gt;\n    &lt;th&gt;Start Date&lt;/th&gt;\n    &lt;th&gt;End Date&lt;/th&gt;\n    &lt;th&gt;Payment Terms&lt;/th&gt;\n    &lt;th&gt;Delivery Day Of Week&lt;/th&gt;\n    &lt;th&gt;Employee ID&lt;/th&gt;\n    &lt;th&gt;Note&lt;/th&gt;\n    &lt;th&gt;Commission&lt;/th&gt;\n    &lt;th&gt;Active&lt;/th&gt;\n\n    &lt;/tr&gt;\n\n    &lt;% @contracts.each do |contract| %&gt;\n    &lt;tr&gt;\n    &lt;td&gt;&lt;%= contract.ContractID %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.CustomerID %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.fields_for :customer do |w| %&gt;\n    &lt;%= w.text_field :CustomerName %&gt;\n    &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.Discount %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.StartDate %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.EndDate %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.PaymentTerms %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.DeliveryDayOfWeek %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.EmployeeID %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.Note %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.Commission %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= contract.Active %&gt;&lt;/td&gt;\n\n\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n    &lt;/table&gt;\n</code></pre>\n\n<p>Contract Model</p>\n\n<pre><code>&gt; class Contract &lt; ApplicationRecord belongs_to :customer\n&gt; \n&gt; accepts_nested_attributes_for :customer\n&gt; #Validation\n&gt;   \n&gt; \n&gt; #Mapping this object to the Database tables self.table_name = \"contract\" self.primary_key = \"ContractID\" end\n</code></pre>\n\n<p>Customer Model</p>\n\n<pre><code>&gt; class Customer &lt; ApplicationRecord\n&gt; \n&gt; has_many :contracts\n&gt; \n&gt; #Validation validates :CustomerID, :CustomerTypeID, presence: true\n&gt; \n&gt; validates :CustomerID, uniqueness: true\n&gt; \n&gt; #Mapping this object to the Database tables self.table_name = \"customer\" self.primary_key = \"CustomerID\"\n&gt; \n&gt; end\n</code></pre>\n\n<p>Contracts Controller</p>\n\n<pre><code>class ContractsController &lt; ApplicationController\n  def index\n    @contracts = Contract.all\n    @customers = Customer.all\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "blackjack"], "answers": [{"tags": [], "owner": {"reputation": 1081, "user_id": 1473423, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/IgJTk.png?s=128&g=1", "display_name": "bntzio", "link": "https://stackoverflow.com/users/1473423/bntzio"}, "is_accepted": false, "score": 0, "last_activity_date": 1518571185, "creation_date": 1518571185, "answer_id": 48778277, "question_id": 48777843, "link": "https://stackoverflow.com/questions/48777843/assign-value-to-similar-objects-in-array-blackjack/48778277#48778277", "title": "Assign value to similar objects in array - BlackJack", "body": "<p>Use a hash for the Aces.</p>\n\n<pre><code>cards = [{A: 1}, {A: 11}, 9]\n</code></pre>\n\n<p>Simple, key/value pairs to store additional values.</p>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518571991, "last_edit_date": 1518571991, "creation_date": 1518571600, "answer_id": 48778323, "question_id": 48777843, "link": "https://stackoverflow.com/questions/48777843/assign-value-to-similar-objects-in-array-blackjack/48778323#48778323", "title": "Assign value to similar objects in array - BlackJack", "body": "<p>Don't say that an Ace is a 1 or 11, as it is not really needed: do say that the value of <code>[A, A, 9]</code> is 11, 21 or 31. One easy way to do it, assuming <code>card.ace?</code> returns a boolean, and <code>card.value</code> an integer for any non-Ace:</p>\n\n<pre><code>def score(cards)\n  aces, non_aces = cards.partition { |card| card.ace? }\n  base_value = non_aces.sum { |card| card.value } + aces.size\n  return (aces.size + 1).times.map { |high_aces| base_value + 10 * high_aces }\nend\n</code></pre>\n\n<p>Then you can easily pick the highest score that is not over 21:</p>\n\n<pre><code>def hand_score(cards)\n  score(cards).select { |x| x &lt;= 21 }.max\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1518593675, "creation_date": 1518593675, "answer_id": 48781881, "question_id": 48777843, "link": "https://stackoverflow.com/questions/48777843/assign-value-to-similar-objects-in-array-blackjack/48781881#48781881", "title": "Assign value to similar objects in array - BlackJack", "body": "<p>Let <code>cards</code> be a 3-element array, each element being <code>:A</code> (for an ace) or a digit between <code>2</code> and <code>10</code>. The player is initially dealt cards corresponding to the first two elements of <code>cards</code>. If one of those cards is an ace and the other is a 10, <code>:BLACKJACK</code> is returned and the player wins against the dealer (unless the dealer also has blackjack. Note that <code>[:A, 10]</code> trumps <code>[:A, 4, 6]</code> and <code>[:A, :A, 9]</code>).</p>\n\n<p>If the first two cards do not produce <code>:BLACKJACK</code> the player has a choice of standing pat with the two cards (<code>:HOLD</code>) or can request a third card from the dealer (<code>:HIT</code>). I am therefore adding an argument <code>hold_or_hit</code> to the method that computes the total score, if the first two cards do not produce blackjack.. (Tt would perhaps be more useful for the argument to be the rules the player employs to decide between hold and hit.) If the player chooses \"hit\" and the sum of the three cards is less than <code>21</code>, the player can ask for another \"hit\", and so on. Because of the wording of the question I am assuming that here at most one hit can be requested.</p>\n\n<p>Simply computing the sum of three cards is not especially useful, so I will modify the return value to more closely reflect the actual game.</p>\n\n<pre><code>def outcome(cards, hold_or_hit)\n  return 13 if hold_or_hit == :HIT &amp;&amp; cards.count(:A) == 3 \n  first2 = cards[0,2]\n  return :BLACK_JACK if first2 == [:A,10] || first2 == [10,:A]\n  total(hold_or_hit == :HOLD ? first2 : cards)\nend\n\ndef total(arr)\n  sum_non_aces = arr.sum { |c| c == :A ? 0 : c }\n  sum_non_aces +\n  case arr.count(:A)\n    when 0\n      0\n    when 1\n      sum_non_aces &gt; 10 ? 1 : 11\n    else\n      12\n    end\n  end\nend\n</code></pre>\n\n<p>Note that, in <code>total</code>, if <code>arr.count(:A) == 2</code>, <code>12</code> reflects one ace <code>11</code>, the other <code>1</code>.</p>\n\n<pre><code>outcome [10, :A,  4], :HOLD  #=&gt; :BLACK_JACK\noutcome [ 9, :A,  4], :HOLD  #=&gt; 20\noutcome [ 9, :A,  4], :HIT   #=&gt; 14\noutcome [:A, :A,  4], :HIT   #=&gt; 16\noutcome [:A, :A,  9], :HIT   #=&gt; 21\noutcome [:A, :A,  9], :HOLD  #=&gt; 12\noutcome [ 7,  9,  6], :HOLD  #=&gt; 16\noutcome [ 7,  9,  6], :HIT   #=&gt; 22\noutcome [:A, :A, :A], :HIT   #=&gt; 13\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 8320938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33de15d3dc1ff4e996aae5c62ecaa561?s=128&d=identicon&r=PG&f=1", "display_name": "\u041e\u043b\u0435\u0433 \u042f\u043a\u0443\u043d\u0438\u043d", "link": "https://stackoverflow.com/users/8320938/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%af%d0%ba%d1%83%d0%bd%d0%b8%d0%bd"}, "edited": false, "score": 0, "creation_date": 1518988211, "post_id": 48794019, "comment_id": 84716731, "body": "Thanks. that was helpful, i&#39;ve refactored my method into 2 lines now."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 0, "last_activity_date": 1518633248, "creation_date": 1518633248, "answer_id": 48794019, "question_id": 48777843, "link": "https://stackoverflow.com/questions/48777843/assign-value-to-similar-objects-in-array-blackjack/48794019#48794019", "title": "Assign value to similar objects in array - BlackJack", "body": "<p>It is misleading to say that there is any player choice involved in the value of aces. The value of a blackjack hand is in fact fixed strictly by rule, which is quite simple:</p>\n\n<ol>\n<li>Count aces as one. Period.</li>\n<li>If the total of the hand is less than 12, and the hand contains at least one ace, add 10 and mark it \"soft\".</li>\n</ol>\n\n<p>That's it. No need to mess with individual card values, counting aces, or any other nonsense. Just write a simple function to return the value of the hand using the above rules.</p>\n"}], "owner": {"reputation": 118, "user_id": 8320938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33de15d3dc1ff4e996aae5c62ecaa561?s=128&d=identicon&r=PG&f=1", "display_name": "\u041e\u043b\u0435\u0433 \u042f\u043a\u0443\u043d\u0438\u043d", "link": "https://stackoverflow.com/users/8320938/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%af%d0%ba%d1%83%d0%bd%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 48794019, "answer_count": 4, "score": 0, "last_activity_date": 1518988298, "creation_date": 1518567847, "last_edit_date": 1518988298, "question_id": 48777843, "link": "https://stackoverflow.com/questions/48777843/assign-value-to-similar-objects-in-array-blackjack", "title": "Assign value to similar objects in array - BlackJack", "body": "<p>So I was doing BlackJack project recently and I'm kinda stuck on Ace value procedure right now.</p>\n\n<p>According to the rules player can assume that Ace can be 1 or 11, peace of cake if you have 2 cards, problem with 3 cards.</p>\n\n<p>I have an array of 3 cards with 2 aces, it can be - [A, A, 9], [A, 9, A], [9, A, A]</p>\n\n<p>How do I say to ruby that one of the Aces should have value  11 and another one 1? Elements of array are objects of class Card with value attribute.</p>\n\n<p>UPDATE</p>\n\n<p>I took one of the answers and edited it a little bit, so if I got no aces and score more than 21 I get not nil value</p>\n\n<p><code>def score_array\n  aces, non_aces = current_cards.partition(&amp;:ace?)\n  base_value = non_aces.sum(&amp;:value) + aces.size\n  return base_value unless aces?\n  score_array = Array.new(aces.size + 1) { |high_aces| base_value + 10 * high_aces }\n  ace_value = score_array.select { |score| score &lt;= 21 }.max\n end</code> </p>\n\n<p>UPDATE 2</p>\n\n<p>I've refactored method into 2 lines using one of the comments idea:</p>\n\n<p><code>def count_score\n  @score = current_cards.sum(&amp;:value)\n  @score += 10 if score &lt; 12 &amp;&amp; aces?\n end</code></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518571180, "post_id": 48778150, "comment_id": 84558160, "body": "same thing happens"}, {"owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518571849, "post_id": 48778150, "comment_id": 84558311, "body": "James - updated the answer - it should be fine with .json"}, {"owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518572272, "post_id": 48778150, "comment_id": 84558413, "body": "James - when you submit the form, is the page itself posting and displaying the JSON?"}, {"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518572623, "post_id": 48778150, "comment_id": 84558502, "body": "yes, like literaly it&#39;s a page of the json response"}, {"owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518573234, "post_id": 48778150, "comment_id": 84558662, "body": "I&#39;m able to replicate your issue by removing   //= require jquery_ujs  from the javascript manifest.  Do you have the necessary dependencies in your asset pipeline to make asynchronous form requests?"}, {"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518574273, "post_id": 48778150, "comment_id": 84558902, "body": "yes, like i do this elsewhere, that&#39;s why it&#39;s so weird, i just copied pasted my otoher working code into here"}, {"owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "reply_to_user": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518579147, "post_id": 48778150, "comment_id": 84560045, "body": "James - if you can update your question with a public github repository containing a rails app demonstrating the issue - I&#39;m sure we&#39;ll be able to figure out what is going on."}, {"owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "edited": false, "score": 0, "creation_date": 1518585513, "post_id": 48778150, "comment_id": 84561809, "body": "thanks, this is for a small thing so not worth the crazy time investment already, since rails is keen on rendering the <code>order_lookup</code> template no matter what, i will give it a template in html to work with. thanks for your patience"}], "tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1518572777, "last_edit_date": 1518572777, "creation_date": 1518570267, "answer_id": 48778150, "question_id": 48777731, "link": "https://stackoverflow.com/questions/48777731/rails-remote-renders-a-page-of-json-and-the-js-ajax-handler-doesnt-catch/48778150#48778150", "title": "Rails remote renders a page of json and the JS ajax handler doesn&#39;t catch", "body": "<p>Try changing your form_tag to the following:</p>\n\n<pre><code>form_tag '/admin/order_lookup.json', remote: true, authenticity_token: true, id: \"order-lookup-submit\"\n</code></pre>\n\n<p>Notice the appended json on the location.</p>\n\n<p>I've created a demo app to illustrate this working.</p>\n\n<p>testing.js</p>\n\n<pre><code>$(document).ready(function(){\n  $(\"#order-lookup-submit\").on(\"ajax:success\",function(event){\n    alert(\"success\");\n  }).on(\"ajax:error\",function(event,x,y){\n    alert(\"error\");\n  });\n});\n</code></pre>\n\n<p>order_lookup.html.haml</p>\n\n<pre><code>= form_tag '/admin/order_lookup.json', remote: true, authenticity_token: true, id: \"order-lookup-submit\" do \n  = hidden_field_tag \"testing\", \"testing\"\n  = submit_tag \"submit\"\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>class TestingController &lt; ApplicationController\n   def order_lookup\n     return render json: {hi: \"hi\"}\n   end\nend\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code>Rails.application.routes.draw do\n   root \"testing#index\"\n   post \"admin/order_lookup\" =&gt; \"testing#order_lookup\"\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 2562127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWIAC.png?s=128&g=1", "display_name": "Rodrigo Moya", "link": "https://stackoverflow.com/users/2562127/rodrigo-moya"}, "is_accepted": false, "score": 1, "last_activity_date": 1518570608, "creation_date": 1518570608, "answer_id": 48778201, "question_id": 48777731, "link": "https://stackoverflow.com/questions/48777731/rails-remote-renders-a-page-of-json-and-the-js-ajax-handler-doesnt-catch/48778201#48778201", "title": "Rails remote renders a page of json and the JS ajax handler doesn&#39;t catch", "body": "<p>Did you try to set the respond_to with .json?</p>\n\n<pre><code>format.json {render json: @result.to_json}\n</code></pre>\n"}], "owner": {"reputation": 3351, "user_id": 2731253, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bf88a5179da66f2e54012dd30b6f31cb?s=128&d=identicon&r=PG&f=1", "display_name": "james", "link": "https://stackoverflow.com/users/2731253/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518572777, "creation_date": 1518567074, "question_id": 48777731, "link": "https://stackoverflow.com/questions/48777731/rails-remote-renders-a-page-of-json-and-the-js-ajax-handler-doesnt-catch", "title": "Rails remote renders a page of json and the JS ajax handler doesn&#39;t catch", "body": "<p>I would like a form to post remotely, and then get some JSON back that my JS knows what to do with. Code:</p>\n\n<pre><code>&lt;%= form_tag '/admin/order_lookup', remote: true, authenticity_token: true, id: \"order-lookup-submit\" do -%&gt;\n  &lt;%= text_field_tag 'contact_string' %&gt;\n  &lt;%= submit_tag 'Submit' %&gt;\n&lt;% end -%&gt;\n\n$(\"#order-lookup-submit\").on(\"ajax:success\", function(e, data, status, xhr) { \n  alert(\"in success\")\n})\n\ndef order_lookup\n  # some code\n  render json: @result\nend\n</code></pre>\n\n<p>When I do the <code>POST</code>, what happens is I correctly get the JSON, but in a page of just JSON (URL: <code>http://localhost:3000/admin/order_lookup</code>).</p>\n\n<p>Obviously I don't want that, I want the ajax event handler to catch the JSON. What am I doing wrong?</p>\n\n<p>I've tried </p>\n\n<pre><code>respond_to do |format|\n  format.js {render json: @result}\nend\n</code></pre>\n\n<p>in like every possible way, and I keep getting ActionController:UnknownFormat. Haven't successfully debugged that according to conventional logic either.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1518567099, "post_id": 48777661, "comment_id": 84557047, "body": "no regex <code>&quot;#New    York&quot;[1..-1].split.join(&#39; &#39;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1518567117, "last_edit_date": 1518567117, "creation_date": 1518566750, "answer_id": 48777674, "question_id": 48777661, "link": "https://stackoverflow.com/questions/48777661/remove-non-alphabetic-characters-and-more-than-one-space-from-a-string/48777674#48777674", "title": "Remove non-alphabetic characters and more than one space from a string", "body": "<p>You can replace <code>strip</code> with <code>squeeze</code>:</p>\n\n<pre><code>\"#New    York\".gsub(/[^a-zA-Z\\s]/,\"\").squeeze(\" \")\n# =&gt; New York\n</code></pre>\n\n<p>Another way is to use a regex like</p>\n\n<pre><code>\"  #New \\t   York  \".gsub(/\\s{2,}|[^\\sa-zA-Z]/, ' ').strip\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>\"  #New \\t   York  \".gsub(/(\\s){2,}|[^\\sa-zA-Z]/, '\\1').strip\n</code></pre>\n\n<p>Here, <code>/\\s{2,}|[^\\sa-zA-Z]/</code> matches 2 or more consecutive whitespaces (<code>\\s{2,}</code>) or (<code>|</code>) any char other than an ASCII letter or whitespace (<code>[^\\sa-zA-Z]</code>). In case of <code>(\\s){2,}</code>, the last whitespace captured will be inserted into the resulting string with the help of the <code>\\1</code> placeholder.</p>\n\n<p>See a <a href=\"http://rubular.com/r/R9g6thxXLb\" rel=\"nofollow noreferrer\">Rubular demo</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1518567555, "last_edit_date": 1518567555, "creation_date": 1518567193, "answer_id": 48777748, "question_id": 48777661, "link": "https://stackoverflow.com/questions/48777661/remove-non-alphabetic-characters-and-more-than-one-space-from-a-string/48777748#48777748", "title": "Remove non-alphabetic characters and more than one space from a string", "body": "<p><strong>Regex</strong>: <a href=\"https://regex101.com/r/cINiqW/1\" rel=\"nofollow noreferrer\"><code>(?:\\s+(?=\\s)|[^A-Za-z\\s]+)</code></a></p>\n\n<p><strong>Ruby code</strong>:</p>\n\n<pre><code>\"#New    York\".gsub(/(?:\\s+(?=\\s)|[^A-Za-z\\s]+)/, '')\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>New York\n</code></pre>\n\n<p><a href=\"https://ideone.com/BJsVsk\" rel=\"nofollow noreferrer\">Code demo</a></p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 48777674, "answer_count": 2, "score": 1, "last_activity_date": 1518567555, "creation_date": 1518566655, "question_id": 48777661, "link": "https://stackoverflow.com/questions/48777661/remove-non-alphabetic-characters-and-more-than-one-space-from-a-string", "title": "Remove non-alphabetic characters and more than one space from a string", "body": "<p>I am not sure what I am doing wrong here:</p>\n\n<pre><code>\"#New    York\".gsub(/[^a-zA-Z\\s]/,\"\").strip\n</code></pre>\n\n<p>This regex should remove all non-alphabetic characters and all spaces greater than 1 space.</p>\n\n<p>It should give me the following result:</p>\n\n<pre><code>\"New York\"\n</code></pre>\n\n<p>What is wrong with the regex?</p>\n"}, {"tags": ["ruby", "bash", "shell"], "comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1518602497, "post_id": 48776950, "comment_id": 84570028, "body": "<code>print</code> output goes to stdout. There is no special Ruby magic involved. Of course it doesn&#39;t mean that you immediately see the output (due to buffering), but at least if the Ruby program terminates, you should see the output. There are two things to check: Do you use the correct <code>print</code>? Maybe the method has been redefined. Use <code>$stdout.print</code> instead. Second, pipe the Ruby output to <code>xxd</code>. Maybe there are some control characters which erase the line being printed so quickly, that you can&#39;t see it. Note also that <code>print</code> does not output a <code>\\n</code> automatically."}], "answers": [{"tags": [], "owner": {"reputation": 30418, "user_id": 823617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmWH1.png?s=128&g=1", "display_name": "Casper", "link": "https://stackoverflow.com/users/823617/casper"}, "is_accepted": true, "score": 5, "last_activity_date": 1518563263, "last_edit_date": 1518563263, "creation_date": 1518562913, "answer_id": 48777096, "question_id": 48776950, "link": "https://stackoverflow.com/questions/48776950/how-to-i-get-ruby-print-to-echo-to-calling-bash-script/48777096#48777096", "title": "How to I get ruby `print` to echo to calling bash script?", "body": "<p>My guess is this has to do with STDOUT buffering. <code>p</code> flushes the buffer immediately, while <code>print</code> does not. Use <code>puts</code> instead, which also flushes, or you can set STDOUT to always flush globally with:</p>\n\n<pre><code>$stdout.sync = true\n</code></pre>\n\n<p>To flush on a case-by-case basis, you can always call <code>flush</code> yourself:</p>\n\n<pre><code>print ...\nprint ...\nprint ...\n$stdout.flush\n</code></pre>\n"}], "owner": {"reputation": 10736, "user_id": 45813, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9d4814af02064c80e0a15d48854b592?s=128&d=identicon&r=PG", "display_name": "Clay Bridges", "link": "https://stackoverflow.com/users/45813/clay-bridges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 48777096, "answer_count": 1, "score": 0, "last_activity_date": 1518801736, "creation_date": 1518561981, "last_edit_date": 1518801736, "question_id": 48776950, "link": "https://stackoverflow.com/questions/48776950/how-to-i-get-ruby-print-to-echo-to-calling-bash-script", "title": "How to I get ruby `print` to echo to calling bash script?", "body": "<p>I'm calling ruby from a bash shell script, like</p>\n\n<pre><code>#!/bin/bash\n\n# lots of stuff\n\nruby script.rb\n\n# more stuff\n</code></pre>\n\n<p>I'd like the things I <code>print</code> in the ruby script to show up in stdout for the shell script, but they don't. Strangely, whatever I use <code>p</code> on <em>does</em> show up. How can I get this to work for <code>print</code>?</p>\n\n<hr>\n\n<p><strong>Quick answer:</strong> use <code>puts</code>. </p>\n"}, {"tags": ["json", "ruby", "jekyll"], "answers": [{"tags": [], "owner": {"reputation": 2844, "user_id": 2831598, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9241f712f491b60d728824909e205cda?s=128&d=identicon&r=PG", "display_name": "tlnagy", "link": "https://stackoverflow.com/users/2831598/tlnagy"}, "is_accepted": true, "score": 0, "last_activity_date": 1518562177, "creation_date": 1518562177, "answer_id": 48776982, "question_id": 48776875, "link": "https://stackoverflow.com/questions/48776875/prevent-jekyll-from-cleaning-up-generated-json-file/48776982#48776982", "title": "Prevent jekyll from cleaning up generated JSON file?", "body": "<p>I found the following issue, which suggested adding the file to <code>keep_files</code>: <a href=\"https://github.com/jekyll/jekyll/issues/5162\" rel=\"nofollow noreferrer\">https://github.com/jekyll/jekyll/issues/5162</a> which worked:</p>\n\n<p>The new code seems to avoid <code>search.json</code> from getting deleted:</p>\n\n<pre><code>module Jekyll\n\n  require 'pathname'\n  require 'json'\n\n  class SearchFileGenerator &lt; Generator\n     safe true\n\n     def generate(site)\n       output = [{\"title\" =&gt; \"Test\"}]\n\n       path = Pathname.new(site.dest) + \"search.json\"\n\n       FileUtils.mkdir_p(File.dirname(path))\n       File.open(path, 'w') do |f|\n         f.write(\"---\\nlayout: null\\n---\\n\")\n         f.write(output.to_json)\n       end\n       site.keep_files &lt;&lt; \"search.json\"\n     end\n   end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": false, "score": 0, "last_activity_date": 1518623415, "creation_date": 1518623415, "answer_id": 48791156, "question_id": 48776875, "link": "https://stackoverflow.com/questions/48776875/prevent-jekyll-from-cleaning-up-generated-json-file/48791156#48791156", "title": "Prevent jekyll from cleaning up generated JSON file?", "body": "<p>Add your new page to <code>site.pages</code> :</p>\n\n<pre><code>module Jekyll\n  class SearchFileGenerator &lt; Generator\n    def generate(site)\n      @site  = site\n      search = PageWithoutAFile.new(@site, site.source, \"/\", \"search.json\")\n      search.data[\"layout\"] = nil\n      search.content = [{\"title\" =&gt; \"Test 32\"}].to_json\n      @site.pages &lt;&lt; search\n    end\n  end\nend\n</code></pre>\n\n<p>Inspired by <a href=\"https://github.com/jekyll/jekyll-feed/blob/master/lib/jekyll-feed/generator.rb\" rel=\"nofollow noreferrer\">jekyll-feed code</a>.</p>\n"}], "owner": {"reputation": 2844, "user_id": 2831598, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9241f712f491b60d728824909e205cda?s=128&d=identicon&r=PG", "display_name": "tlnagy", "link": "https://stackoverflow.com/users/2831598/tlnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 48776982, "answer_count": 2, "score": 0, "last_activity_date": 1518623415, "creation_date": 1518561642, "question_id": 48776875, "link": "https://stackoverflow.com/questions/48776875/prevent-jekyll-from-cleaning-up-generated-json-file", "title": "Prevent jekyll from cleaning up generated JSON file?", "body": "<p>I've written a simple plugin that generates a small JSON file</p>\n\n<pre><code>module Jekyll\n\n  require 'pathname'\n  require 'json'\n\n  class SearchFileGenerator &lt; Generator\n     safe true\n\n     def generate(site)\n       output = [{\"title\" =&gt; \"Test\"}]\n\n       path = Pathname.new(site.dest) + \"search.json\"\n\n       FileUtils.mkdir_p(File.dirname(path))\n       File.open(path, 'w') do |f|\n         f.write(\"---\\nlayout: null\\n---\\n\")\n         f.write(output.to_json)\n       end\n       # 1/0\n     end\n   end\nend\n</code></pre>\n\n<p>But the generated JSON file gets deleted every time Jekyll runs to completion. If I uncomment the division by zero line and cause it to error out, I can see that the <code>search.json</code> file is being generated, but it's getting subsequently deleted. How do I prevent this?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 598, "user_id": 5866447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMv8H.jpg?s=128&g=1", "display_name": "sxm1972", "link": "https://stackoverflow.com/users/5866447/sxm1972"}, "edited": false, "score": 0, "creation_date": 1518595843, "post_id": 48776597, "comment_id": 84566010, "body": "You have not written any code that looks on other lines. the if block which matches to ALTER TABLE only looks on the same line which matches. So it is natural for it to not find anything on other lines."}], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 5866447, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMv8H.jpg?s=128&g=1", "display_name": "sxm1972", "link": "https://stackoverflow.com/users/5866447/sxm1972"}, "is_accepted": true, "score": 0, "last_activity_date": 1518596864, "creation_date": 1518596864, "answer_id": 48782657, "question_id": 48776597, "link": "https://stackoverflow.com/questions/48776597/read-a-file-and-find-if-a-string-exists-and-return-the-tablename/48782657#48782657", "title": "read a file and find if a string exists and return the tablename", "body": "<p>This is not the best way of solving the problem. But this code will get it working.</p>\n\n<pre><code>filename='modify_table.sql'\nbol1 = false\nlookformodify = false\ntableName = ''\nFile.foreach(filename).with_index do |line, line_num|\n  # convert all characters to upper case\n  line = line.upcase if line =~ /[a-z]/\n  if !lookformodify &amp;&amp; line =~ /ALTER TABLE/\n    lookformodify = true\n\n    location = line.index('ALTER TABLE') + 11\n    subline = line[location..-1]\n    sublineParts = subline.split(' ')\n    tableName = sublineParts[0]\n\n    bol1 = line.include?('MODIFY')\n    if bol1\n      puts \" found modify column on #{tableName}\"\n      lookformodify = false # found on same line. No need to look on other lines\n    end\n  elsif lookformodify &amp;&amp; line =~ /MODIFY/\n    puts \" found modify column on #{tableName}\"\n    lookformodify = false # found on different line. No need to look on other lines\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 48782657, "answer_count": 1, "score": 0, "last_activity_date": 1518624586, "creation_date": 1518560255, "last_edit_date": 1518624586, "question_id": 48776597, "link": "https://stackoverflow.com/questions/48776597/read-a-file-and-find-if-a-string-exists-and-return-the-tablename", "title": "read a file and find if a string exists and return the tablename", "body": "<p>I am trying to read a file, if the file has 'alter table' then it has to search for 'modify' if modify exists then it has to return the table name. For that i wrote the below code and it worked. </p>\n\n<pre><code>filename='modify_table.sql'\nbol1=\"false\"\nFile.foreach(filename).with_index do |line, line_num|\n\n#convert all characters to upper case\n if ( line =~ /[a-z]/ )\n line = line.upcase\n end\n  if (line =~ /ALTER TABLE/) \n\n    location = line.index(\"ALTER TABLE\") + 11\n    subline = line[location..-1]\n    sublineParts = subline.split(\" \")\n    tableName = sublineParts[0]\n\n    bol1 = line.include?(\"MODIFY\")\n    if (bol1)\n    puts \" found modify column on #{tableName}\"\n  else\n    puts \" no modify found\"\n  end\nend\nend\n</code></pre>\n\n<p>My file contains:</p>\n\n<pre><code>begin\nBEGIN EXECUTE IMMEDIATE 'alter table schemaname.tablename \nmodify (\nabc              VARCHAR2(200 BYTE),\nxyz               VARCHAR2(200 BYTE)\n)'; EXCEPTION when others then if (SQLCODE != -01430 and SQLCODE != -942) then RAISE; end if; END;\nend;\n/\n</code></pre>\n\n<p>if alter and modify are on the same line my code works.\nIn the above file, both are in diff line. so the code i wrote returns no modify found even if there is a modify in the file.\nCan someone help me how I could read the next line and find modify</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "inheritance", "ruby-on-rails-5", "sti"], "answers": [{"tags": [], "owner": {"reputation": 484, "user_id": 4515647, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/637035650/picture?type=large", "display_name": "Daniel Olivares", "link": "https://stackoverflow.com/users/4515647/daniel-olivares"}, "is_accepted": false, "score": 0, "last_activity_date": 1518563294, "creation_date": 1518563294, "answer_id": 48777164, "question_id": 48776545, "link": "https://stackoverflow.com/questions/48776545/rails-sti-sibling-callbacks-propagating/48777164#48777164", "title": "Rails STI sibling callbacks propagating", "body": "<p>My bad, I was inheriting from a wrong class...</p>\n"}], "owner": {"reputation": 484, "user_id": 4515647, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/637035650/picture?type=large", "display_name": "Daniel Olivares", "link": "https://stackoverflow.com/users/4515647/daniel-olivares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518563294, "creation_date": 1518560064, "last_edit_date": 1518560859, "question_id": 48776545, "link": "https://stackoverflow.com/questions/48776545/rails-sti-sibling-callbacks-propagating", "title": "Rails STI sibling callbacks propagating", "body": "<p>I'm facing an issue with STI (single table inheritance), where a callback that should only run on one of a child model's instances, actually runs on its sibling's instances as well, even though it shouldn't.</p>\n\n<pre><code>class Parent &lt; ApplicationRecord; end\n\nclass FirstChild &lt; Parent\n  after_initialize :set_default_attr\n\n  private\n  def set_default_attr\n    self.attr = \"something\"\n  end\nend\n\nclass SecondChild &lt; Parent; end\n\nsecond = SecondChild.new\nassert_nil second.attr # Fails because it is set to \"something\"\n</code></pre>\n\n<p>I expect the <code>#set_default_attr</code> callback to run only on <code>FirstChild</code> instances, not on <code>SecondChild</code> ones. I think the current behaviour is counter-intuitive. Am I missing something?</p>\n\n<p>Ruby version: 2.5.0, Rails version: 5.1.4</p>\n\n<hr>\n\n<p><strong>Update 1:</strong> It seems like also validations propagate</p>\n\n<p><strong>Update 2:</strong> A possible workaround would be to add something like this:</p>\n\n<pre><code>class FirstChild &lt; Parent\n  after_initialize :set_default_attr, if: :type_is_first?\n  validate :attr, presence: true, if: :type_is_first?\n\n  private\n  def set_default_attr\n    self.attr = \"something\"\n  end\n\n  def type_is_first?\n    type == \"FirstChild\"\n  end\nend\n</code></pre>\n\n<p>however this feels super dirty to me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "haml"], "answers": [{"tags": [], "owner": {"reputation": 2062, "user_id": 4896126, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/aUY9T.png?s=128&g=1", "display_name": "Marcos R. Guevara", "link": "https://stackoverflow.com/users/4896126/marcos-r-guevara"}, "is_accepted": false, "score": 0, "last_activity_date": 1518557756, "creation_date": 1518557756, "answer_id": 48776037, "question_id": 48775846, "link": "https://stackoverflow.com/questions/48775846/wrap-fractional-part-of-decimal-in-a-span/48776037#48776037", "title": "Wrap fractional part of decimal in a span", "body": "<p>You can first convert to string with to_str method if it's a number, then, use the .split method, something like this:</p>\n\n<pre><code>number = \"1234.41\"\n</code></pre>\n\n<p>then do something like this</p>\n\n<p><code>number.split(\".\")</code></p>\n\n<p>I ignore if you are doing this on backend or frontend, anyway you can find this split method on javascript. Once you have the array, you can iterate with the result.</p>\n"}, {"comments": [{"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "edited": false, "score": 0, "creation_date": 1518560979, "post_id": 48776110, "comment_id": 84555181, "body": "It&#39;s works, yes! But i need showing <code>span</code> tag like a html/haml tag, not a text inside my element. Now my price showing on page <code>1234&lt;span&gt;.41&lt;&#47;span&gt;</code>"}, {"owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "edited": false, "score": 0, "creation_date": 1518561561, "post_id": 48776110, "comment_id": 84555408, "body": "Oh god, I forgot about <code>.html_safe</code>. Thank you!"}, {"owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "reply_to_user": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "edited": false, "score": 0, "creation_date": 1518561598, "post_id": 48776110, "comment_id": 84555419, "body": "Glad I could help!"}], "tags": [], "owner": {"reputation": 3930, "user_id": 4613236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wQZcm.jpg?s=128&g=1", "display_name": "Zoran", "link": "https://stackoverflow.com/users/4613236/zoran"}, "is_accepted": true, "score": 1, "last_activity_date": 1518559459, "last_edit_date": 1518559459, "creation_date": 1518558092, "answer_id": 48776110, "question_id": 48775846, "link": "https://stackoverflow.com/questions/48775846/wrap-fractional-part-of-decimal-in-a-span/48776110#48776110", "title": "Wrap fractional part of decimal in a span", "body": "<p>Since you know the format of your original string (decimal, two digit precision, etc.), you can wrap the decimal point portion of that string in a <code>&lt;span&gt;</code> by doing something like the following:</p>\n\n<pre><code>price  = '1234.41'\nresult = price.sub('.', '&lt;span&gt;.').concat('&lt;/span&gt;')\n# =&gt; \"1234&lt;span&gt;.41&lt;/span&gt;\"\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 312, "user_id": 7657817, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2d821950016dcd8156cc8022cfb04205?s=128&d=identicon&r=PG", "display_name": "Merkelst", "link": "https://stackoverflow.com/users/7657817/merkelst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 48776110, "answer_count": 2, "score": 1, "last_activity_date": 1518568334, "creation_date": 1518556925, "last_edit_date": 1518568334, "question_id": 48775846, "link": "https://stackoverflow.com/questions/48775846/wrap-fractional-part-of-decimal-in-a-span", "title": "Wrap fractional part of decimal in a span", "body": "<p>I am printing a variable (called <code>something.price</code>) to a Haml template and its value is a string representation of a decimal with 2-digit precision. I want to wrap the fractional part of the decimal (including the <code>.</code>) in a <code>span</code>.</p>\n\n<p><em>Example:</em> If we have <code>\"1234.41\"</code>, we want to wrap the <code>span</code> around the <code>.41</code> part. How can this be achieved?</p>\n"}, {"tags": ["ruby", "evernote", "evernote-app-notebook"], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 1691455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478c1e02777864acbcfe0955348de695?s=128&d=identicon&r=PG", "display_name": "Igor Afanasyev", "link": "https://stackoverflow.com/users/1691455/igor-afanasyev"}, "is_accepted": true, "score": 2, "last_activity_date": 1518567173, "creation_date": 1518567173, "answer_id": 48777742, "question_id": 48775651, "link": "https://stackoverflow.com/questions/48775651/how-can-i-specify-all-guids-for-getnotewithresultspec/48777742#48777742", "title": "How can I specify ALL guids for getNoteWithResultSpec()?", "body": "<p><code>NoteStore.getNoteWithResultSpec</code> is meant to retrieve one specific note. If you need to find all notes belonging to a certain notebook, use <a href=\"https://dev.evernote.com/doc/reference/NoteStore.html#Fn_NoteStore_findNotesMetadata\" rel=\"nofollow noreferrer\">NoteStore.findNotesMetadata</a> to find notes. In passed <a href=\"https://dev.evernote.com/doc/reference/NoteStore.html#Struct_NoteFilter\" rel=\"nofollow noreferrer\">NoteFilter</a> structure you need to provide the guid of your notebook.</p>\n\n<p>Note that this means you will need to do as many <code>NoteStore.getNoteWithResultSpec</code> calls as the number of notes you have. A more elegant solution would be to synchronize your notebook: use <a href=\"https://dev.evernote.com/doc/reference/NoteStore.html#Fn_NoteStore_getFilteredSyncChunk\" rel=\"nofollow noreferrer\">NoteStore.getFilteredSyncChunk</a> repeatedly to get note data in chunks. In <a href=\"https://dev.evernote.com/doc/reference/NoteStore.html#Struct_SyncChunkFilter\" rel=\"nofollow noreferrer\">SyncChunkFilter</a> structure specify the list of notebook guids you're interested in (which can be just one).</p>\n\n<p>Also, if your goal is to keep up with the changes in that notebook, instead of periodically polling for new data with <code>NoteStore.getFilteredSyncChunk</code>, you can request a setup of a <a href=\"https://dev.evernote.com/doc/articles/polling_notification.php#webhooks\" rel=\"nofollow noreferrer\">webhook</a> to get notified of changes.</p>\n"}], "owner": {"reputation": 78, "user_id": 8084182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209ff3b71a8551e52c267b0bddef8f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Deckard", "link": "https://stackoverflow.com/users/8084182/ryan-deckard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 48777742, "answer_count": 1, "score": 0, "last_activity_date": 1518567173, "creation_date": 1518556042, "question_id": 48775651, "link": "https://stackoverflow.com/questions/48775651/how-can-i-specify-all-guids-for-getnotewithresultspec", "title": "How can I specify ALL guids for getNoteWithResultSpec()?", "body": "<p>New to evernote api using Ruby. Using the example to try to get a list of notes from notebooks. That example seems pretty messed up though so I don't think I'm properly configured. I'm stuck on what to put to include content from this page, <a href=\"http://dev.evernote.com/doc/reference/NoteStore.html#Fn_NoteStore_getNoteWithResultSpec\" rel=\"nofollow noreferrer\">http://dev.evernote.com/doc/reference/NoteStore.html#Fn_NoteStore_getNoteWithResultSpec</a></p>\n\n<p>def note_store\n   @note_store ||= client.note_store\n end</p>\n\n<p>note_store.getNoteWtihResultSpec(auth_token, true)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "jhipster", "swagger-codegen"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1518555767, "post_id": 48775408, "comment_id": 84552848, "body": "it&#39;s failing in the <code>Project</code> model, show us that code."}, {"owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1518560234, "post_id": 48775408, "comment_id": 84554904, "body": "<a href=\"https://github.com/jpavanaryan/dockerapps/blob/master/railsapp/app/models/project.rb\" rel=\"nofollow noreferrer\">github.com/jpavanaryan/dockerapps/blob/master/railsapp/app/&hellip;</a>   <a href=\"https://github.com/jpavanaryan/dockerapps/blob/master/railsapp/swagger_api/lib/swagger_client/models/projects.rb\" rel=\"nofollow noreferrer\">github.com/jpavanaryan/dockerapps/blob/master/railsapp/&hellip;</a>  This second object generated by Swagger code."}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518576763, "post_id": 48775408, "comment_id": 84559468, "body": "Are you using an old rails version? Change to update_attributes, just in case."}, {"owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "edited": false, "score": 0, "creation_date": 1518584530, "post_id": 48775408, "comment_id": 84561529, "body": "When I used @project.update_attributes(name: &quot;project1&quot;, location: &quot;VA&quot;) I got &quot;Failed. Response code = 405. Response message = Method Not Allowed&quot; error"}, {"owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "edited": false, "score": 0, "creation_date": 1518654715, "post_id": 48775408, "comment_id": 84599454, "body": "<a href=\"https://github.com/pavankjadda/RubyOnRails-JHipster-Docker\" rel=\"nofollow noreferrer\">github.com/pavankjadda/RubyOnRails-JHipster-Docker</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "edited": false, "score": 0, "creation_date": 1518583137, "post_id": 48779460, "comment_id": 84561148, "body": "When I used    @project.update_attributes(name: &quot;project1&quot;, location: &quot;VA&quot;)  I got &quot;Failed. Response code = 405. Response message = Method Not Allowed&quot; error"}, {"owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "edited": false, "score": 0, "creation_date": 1518584177, "post_id": 48779460, "comment_id": 84561420, "body": "JHipster Micro Services support GET, POST, PUT, DELETE methods"}], "tags": [], "owner": {"reputation": 1196, "user_id": 8426717, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QwYD3zUWkhA/AAAAAAAAAAI/AAAAAAAABJs/2y8hDOo4fYY/photo.jpg?sz=128", "display_name": "Tai", "link": "https://stackoverflow.com/users/8426717/tai"}, "is_accepted": true, "score": 2, "last_activity_date": 1518580896, "last_edit_date": 1592644375, "creation_date": 1518580896, "answer_id": 48779460, "question_id": 48775408, "link": "https://stackoverflow.com/questions/48775408/protected-method-update-called-for-project/48779460#48779460", "title": "protected method &#39;update&#39; called for #&lt;Project", "body": "<p><code>Project</code> is an <code>ActiveResource</code> not <code>ActiveRecord</code> so that it doesn't have <code>update</code> method. Using <code>update_attributes</code> instead. Ref: <a href=\"http://www.rubydoc.info/gems/activeresource/ActiveResource/Base#update_attributes-instance_method\" rel=\"nofollow noreferrer\">http://www.rubydoc.info/gems/activeresource/ActiveResource/Base#update_attributes-instance_method</a></p>\n<blockquote>\n<h1>update_attributes(attributes) \u21d2 Object</h1>\n<p>Updates this resource with all the attributes from the passed-in Hash and requests that the record be\nsaved.</p>\n</blockquote>\n"}], "owner": {"reputation": 1604, "user_id": 9244861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9ajgQ.jpg?s=128&g=1", "display_name": "Pavan Jadda", "link": "https://stackoverflow.com/users/9244861/pavan-jadda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 48779460, "answer_count": 1, "score": 0, "last_activity_date": 1518654768, "creation_date": 1518555044, "last_edit_date": 1518654768, "question_id": 48775408, "link": "https://stackoverflow.com/questions/48775408/protected-method-update-called-for-project", "title": "protected method &#39;update&#39; called for #&lt;Project", "body": "<p>I set up simple Rails application with JHipster microservices. The application has <code>Project</code> model class and CRUD operations on it. JHipster microservices with REST API support developed and integrated with Rails application. Create, Destroy, Show operations are working fine. But update operation throws following error. All the code uploaded to <a href=\"https://github.com/pavankjadda/RubyOnRails-JHipster-Docker\" rel=\"nofollow noreferrer\">GitHub repository</a>. I looked at <a href=\"https://stackoverflow.com/questions/27199089/private-method-update-called-for-customer\">similar issues</a> but could not find a proper solution.</p>\n\n<pre><code>protected method 'update' called for #Project:0x00007fdc9479d3a8\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4kltL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4kltL.png\" alt=\"Error Message \"></a></p>\n\n<p>projects_controller.rb</p>\n\n<pre><code>class ProjectsController &lt; ApplicationController\n  before_action :set_project, only: [:show, :edit, :update, :destroy]\n\n  # GET /projects\n  # GET /projects.json\n  def index\n    @projects = Project.all\n  end\n\n  # GET /projects/1\n  # GET /projects/1.json\n  def show\n  end\n\n  # GET /projects/new\n  def new\n    @project = Project.new\n  end\n\n  # GET /projects/1/edit\n  def edit\n  end\n\n  # POST /projects\n  # POST /projects.json\n  def create\n    @project = Project.new(project_params)\n\n    respond_to do |format|\n      if @project.save\n        format.html { redirect_to @project, notice: 'Project was successfully created.' }\n        format.json { render :show, status: :created, location: @project }\n      else\n        format.html { render :new }\n        format.json { render json: @project.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /projects/1\n  # PATCH/PUT /projects/1.json\n  def update\n    respond_to do |format|\n      if @project.update(project_params)\n        format.html { redirect_to @project, notice: 'Project was successfully updated.' }\n        format.json { render :show, status: :ok, location: @project }\n      else\n        format.html { render :edit }\n        format.json { render json: @project.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n\n\n  # PATCH/PUT /projects/1\n  # PATCH/PUT /projects/1.json\n  def update_attributes(project_params)\n    load(project_params, false) &amp;&amp; save\n  end\n\n\n  # DELETE /projects/1\n  # DELETE /projects/1.json\n  def destroy\n    @project.destroy\n    respond_to do |format|\n      format.html { redirect_to projects_url, notice: 'Project was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_project\n      @project = Project.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def project_params\n      params.require(:project).permit(:name, :location)\n    end\nend\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1518556660, "post_id": 48775398, "comment_id": 84553248, "body": "<code>str.scan(&#47;(?&lt;=ManagerID=&#39;).*?(?=&#39;)&#47;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7055, "user_id": 2693543, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/c2tUD.jpg?s=128&g=1", "display_name": "Shobi", "link": "https://stackoverflow.com/users/2693543/shobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1518555478, "creation_date": 1518555478, "answer_id": 48775519, "question_id": 48775398, "link": "https://stackoverflow.com/questions/48775398/join-string-to-array-with-regex/48775519#48775519", "title": "Join string to array with Regex", "body": "<p>ruby noob here, any way</p>\n\n<pre><code> \"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902' OR\n ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\".gsub(\" OR \",'')\n</code></pre>\n\n<p>would produce =><code>\"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902' ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\"</code></p>\n\n<p>then split it by <code>ManagerID=</code></p>\n\n<pre><code>    \"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902'\n ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\".split(\"ManagerID=\")\n</code></pre>\n\n<p>would produce => <code>['26a20e0e-23ba-4133-8bf4-e56f13115902', '26a20e0e-23ba-4133-8bf4-e56f13115902']</code></p>\n\n<p>then simply join them by coma</p>\n\n<p><code>['26a20e0e-23ba-4133-8bf4-e56f13115902', '26a20e0e-23ba-4133-8bf4-e56f13115902'].join(',')</code></p>\n\n<p>this should give you the expected result, basically you can chain these operations into one statement, if my knowledge is correct, below code would give you the result.</p>\n\n<pre><code> \"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902' OR ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\".gsub(\" OR \",'').split(\"ManagerID=\").join(',')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 1, "last_activity_date": 1518555612, "creation_date": 1518555612, "answer_id": 48775551, "question_id": 48775398, "link": "https://stackoverflow.com/questions/48775398/join-string-to-array-with-regex/48775551#48775551", "title": "Join string to array with Regex", "body": "<pre><code>string = \"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902' OR ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\"\n\nstring.split(\" OR \").map{ |x| x.gsub(/(^ManagerID='|'$)/, \"\") }\n</code></pre>\n"}], "owner": {"reputation": 6503, "user_id": 5650878, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xh7BI.png?s=128&g=1", "display_name": "Bitwise", "link": "https://stackoverflow.com/users/5650878/bitwise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 48775551, "answer_count": 2, "score": 0, "last_activity_date": 1518555612, "creation_date": 1518554993, "question_id": 48775398, "link": "https://stackoverflow.com/questions/48775398/join-string-to-array-with-regex", "title": "Join string to array with Regex", "body": "<p>Given this string:</p>\n\n<pre><code>\"ManagerID='26a20e0e-23ba-4133-8bf4-e56f13115902' OR ManagerID='c86eede4-fdb4-45a8-88cf-4041c9d7a327'\"\n</code></pre>\n\n<p>How can I transform it to this array:</p>\n\n<pre><code>[\"26a20e0e-23ba-4133-8bf4-e56f13115902\", \"c86eede4-fdb4-45a8-88cf-4041c9d7a327\"]\n</code></pre>\n\n<p>Basically pulling out the <code>OR</code> and joining it. I can't seem to figure this one out.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518553826, "post_id": 48775028, "comment_id": 84551894, "body": "I don&#39;t get the problem. Don&#39;t you have a PracticeQuiz Model? which has_many PracticeQuestions?. It&#39;s just using <code>@practicequiz.practice_questions.</code> This gives only the questions for this Quiz"}, {"owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "reply_to_user": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518554109, "post_id": 48775028, "comment_id": 84552035, "body": "This is true, but in the view it simply is doing +1 to the question id, eventually when it gets to a question that isn&#39;t associated with the quiz, it throws an error. The user will see one practice question per show.html.erb (of practice_question), and I want them to be able to go back or forwards ONLY for the questions associated with that parent practice quiz. I do have a practice quiz model!"}], "answers": [{"comments": [{"owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "edited": false, "score": 0, "creation_date": 1518555421, "post_id": 48775312, "comment_id": 84552685, "body": "Is this using a gem? I was wondering if there was a &quot;rails&quot; way to do it from scratch"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "edited": false, "score": 0, "creation_date": 1518555609, "post_id": 48775312, "comment_id": 84552770, "body": "It&#39;s will_paginate gem. You can also do pagination without a gem. Anyway, I posted a second approach without a gem (using the show method in Question)"}, {"owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "edited": false, "score": 0, "creation_date": 1518563419, "post_id": 48775312, "comment_id": 84556010, "body": "I tried the second method and I got this: <code>NoMethodError at &#47;practice_quizzes&#47;mountains&#47;practice_questions&#47;18 undefined method </code>practice_question_path&#39; for #&lt;#&lt;Class:0x007f8e6b3710d0&gt;:0x007f8e6c8238e8&gt; Did you mean?  practice_quizzes_path                practice_quiz_path`"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "edited": false, "score": 0, "creation_date": 1518565315, "post_id": 48775312, "comment_id": 84556572, "body": "I see you have nested resources. You need to make the link to next similar to the one you posted (including the quiz and the question). I updated my answer. The show controller also needs to set the \u2018@practice_quiz\u2019 variable."}], "tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1518565176, "last_edit_date": 1518565176, "creation_date": 1518554655, "answer_id": 48775312, "question_id": 48775028, "link": "https://stackoverflow.com/questions/48775028/rails-5-showing-previous-or-next-nested-resource-of-only-the-parent-resource/48775312#48775312", "title": "Rails 5 Showing previous or next nested resource of only the parent resource", "body": "<p><strong>I imagine two options:</strong></p>\n\n<p>You can use the index in the Quiz controller to get all Questions for this Quiz, and show them in the index view with pagination. If you set pagination to 1 item per page, you get exactly what you want.</p>\n\n<p>PracticeQuizzesController</p>\n\n<pre><code>def show\n  @quiz = PracticeQuizz.find_by(id: params[:id])\n  @questions = @quiz.practice_questions.paginate(:page =&gt; params[:page], :per_page =&gt; 1)\nend\n</code></pre>\n\n<p>views/practice_quizzes/show.html.erb</p>\n\n<pre><code>&lt;%= @quiz.name %&gt;\n&lt;%= @quiz.description %&gt;\n&lt;%= will_paginate @questions %&gt;\n&lt;%= render @questions %&gt;\n</code></pre>\n\n<p>views/practice_questions/_practice_question.html.erb</p>\n\n<pre><code>&lt;%= practice_question.text %&gt;\netc...\n</code></pre>\n\n<p><strong>Second option</strong></p>\n\n<p>In the show method for the Question, get the next and previous questions, to show on the show view</p>\n\n<p>PracticeQuestionsController</p>\n\n<pre><code>def show\n  @question = PracticeQuestion.find_by(id: params[:id])\n  @next = @question.practice_quizz.practice_questions.where(\"id &gt; ?\", @question.id).order(\"id\").first\n  @prev = @question.practice_quizz.practice_questions.where(\"id &lt; ?\", @question.id).order(\"id desc\").first\nend\n</code></pre>\n\n<p>views/practice_questions/show.html.erb</p>\n\n<pre><code>&lt;% if @next %&gt;\n  &lt;%= link_to 'next', practice_quiz_practice_question_path(@practice_quiz, @next) %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48775312, "answer_count": 1, "score": 0, "last_activity_date": 1518565176, "creation_date": 1518553395, "question_id": 48775028, "link": "https://stackoverflow.com/questions/48775028/rails-5-showing-previous-or-next-nested-resource-of-only-the-parent-resource", "title": "Rails 5 Showing previous or next nested resource of only the parent resource", "body": "<p>I have a resource <code>PracticeQuiz</code> which has a nested child called <code>PracticeQuestion</code>. I can successfully create both of them, and can go to the next question, but what I would like is that when a user is taking a quiz, the \"previous\" and \"next\" buttons should only show questions that are in the parent id. </p>\n\n<p><strong>For example:</strong></p>\n\n<p>foo.com/practice_quizzes/mountains/practice_questions/1-11,24,25</p>\n\n<p>The user should be able to go from question 1-11, then at 11 it should go to 24,and if the user wants back to 11 once they get to question 24. At question 25 it should either not show the button or say that there are no more questions.</p>\n\n<p>foo.com/practice_quizzes/fruits/practice_questions/12-23,26,27,31</p>\n\n<p>foo.com/practice_quizzes/animals/practice_questions/28-29,30,32</p>\n\n<p>(Please note that this is about the amount of questions in a quiz, because questions will be deleted or updated or changed in the future. I don't want to make sorting ID based, unless this is a bad idea and i don't know why)</p>\n\n<p>What I need is for the user to be able to navigate the show.html.erb page by clicking previous or next, and ONLY be shown the questions that are associated with a quiz, no matter what their ID is, and for the app to not crash when it detects that there is no question at the very first or last, or if a new question is being added. </p>\n\n<p>Here's what I've tried so far:</p>\n\n<p><strong>views/practice_question.show.html.erb</strong></p>\n\n<pre><code>&lt;%= link_to 'next', practice_quiz_practice_question_path(@practice_quiz, @practice_question.next) %&gt;\n</code></pre>\n\n<p><strong>models/practice_question.rb</strong></p>\n\n<pre><code>class PracticeQuestion &lt; ApplicationRecord\n  belongs_to :user, optional: true\n  belongs_to :practice_quiz\n\n  def previous\n    PracticeQuestion.where(\"practice_quiz_id = ? AND id &lt; ?\", self.practice_quiz.id, self.id).first\n  end\n\n  def next\n    PracticeQuestion.where(\"practice_quiz_id = ? AND id &gt; ?\", self.practice_quiz.id, self.id).first\n  end\n\nend\n</code></pre>\n\n<p><strong>models/practice_quiz.rb</strong></p>\n\n<pre><code>class PracticeAnswer &lt; ApplicationRecord\n  belongs_to :practice_question\nend\n</code></pre>\n\n<p>controllers/practice_questions_controller.rb</p>\n\n<pre><code>class PracticeQuestionsController &lt; ApplicationController\n  before_action :authenticate_user!\n  before_action :set_practice_quiz, only: [:show, :edit, :update, :destroy]\n  before_action :set_practice_question, only: [:show, :edit, :update, :destroy]\n\n  def index\n    if params[:practice_quiz_id]\n      @practice_questions = PracticeQuiz.friendly.find(params[:practice_quiz_id]).practice_questions\n    else\n      @practice_questions = PracticeQuestion.all\n    end\n\n    @all_practice_questions = PracticeQuestion.all\n  end\n\n  def show\n    @current_practice_question = PracticeQuestion.find(params[:id])\n  end\n\n  def new\n    @practice_quiz = PracticeQuiz.friendly.find(params[:practice_quiz_id])\n    @practice_question = PracticeQuestion.new\n  end\n\n  def edit\n  end\n\n  def create\n    @practice_quiz = PracticeQuiz.friendly.find(params[:practice_quiz_id])\n    @practice_question = @practice_quiz.practice_questions.build(practice_question_params)\n    @practice_question.user = current_user\n\n    respond_to do |format|\n      if @practice_question.save\n        format.html { redirect_to [@practice_quiz, @practice_question], notice: 'Practice question was successfully created.' }\n        format.json { render :show, status: :created, location: @practice_question }\n      else\n        format.html { render :new }\n        format.json { render json: @practice_question.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  private\n    def set_practice_question\n      @practice_question = PracticeQuestion.find(params[:id])\n    end\n\n    def set_practice_quiz\n        @practice_quiz = PracticeQuiz.friendly.find(params[:practice_quiz_id])\n    end\n\n    def practice_question_params\n        params.require(:practice_question).permit(:question, :explanation, :flagged, practice_questions_attributes: [:answer])\n     end\nend\n</code></pre>\n\n<p>How can I do previous/next for practice_questions to ONLY show questions that are associated with the id of its parent? And to avoid any errors/pitfalls such as reaching the first or last question of the quiz?</p>\n\n<p>Thanks very much in advance :)</p>\n\n<p>P.S - Some have said this is not a nested resource as far as controllers/models/views go, but In my routes.rb i did this, so doesn't that make it a nested resource? </p>\n\n<pre><code>  resources :practice_quizzes do \n    resources :practice_questions\n  end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 1, "creation_date": 1518553698, "post_id": 48775012, "comment_id": 84551815, "body": "What exactly have you tried? Please show this code and describe what was send/received."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1518554866, "post_id": 48775012, "comment_id": 84552405, "body": "Step one: Read the docs. Step two: Write some code. Step three: If you&#39;re having trouble with that code, include the code in your question on Stack Overflow."}, {"owner": {"reputation": 41, "user_id": 9168205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1864a04e08a375d77580a724232f5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Free TNT", "link": "https://stackoverflow.com/users/9168205/free-tnt"}, "edited": false, "score": 0, "creation_date": 1518559544, "post_id": 48775012, "comment_id": 84554663, "body": "I did try and read docs, i just edited the post with an example i used."}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1518560097, "post_id": 48775012, "comment_id": 84554852, "body": "What error do you get?  That&#39;s how you specify headers in a request."}, {"owner": {"reputation": 41, "user_id": 9168205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1864a04e08a375d77580a724232f5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Free TNT", "link": "https://stackoverflow.com/users/9168205/free-tnt"}, "edited": false, "score": 0, "creation_date": 1520015998, "post_id": 48775012, "comment_id": 85156638, "body": "Sorry for late reply, but i solved it already. Basically it was trying to use a host port thing, so i used uri for that and a way different way to request found in a tutorial."}], "owner": {"reputation": 41, "user_id": 9168205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1864a04e08a375d77580a724232f5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Free TNT", "link": "https://stackoverflow.com/users/9168205/free-tnt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518559497, "creation_date": 1518553329, "last_edit_date": 1518559497, "question_id": 48775012, "link": "https://stackoverflow.com/questions/48775012/ruby-https-requests-with-headers", "title": "Ruby https requests with headers", "body": "<p>How do you do an https request with ruby that also has headers, with the builtin module, I've read docs did some tries and did some googling no luck, if someone can help that would be appreciated.</p>\n\n<p>Code I've tried</p>\n\n<pre><code>require 'net/http'\ndata = Net::HTTP.get(\"https://urlhere.com\")\ndata['Authorization'] = @token\nres = http.request(data)\nreturn res.body\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "edited": false, "score": 1, "creation_date": 1518553876, "post_id": 48774777, "comment_id": 84551922, "body": "How about <code>LIST_ALL.map(&amp;:upcase)</code> and after that apply join if you want string. like this <code>LIST_ALL.map(&amp;:upcase).join(&quot;, &quot;)</code>"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "reply_to_user": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "edited": false, "score": 1, "creation_date": 1518554679, "post_id": 48774777, "comment_id": 84552310, "body": "@AjayBarot Sorry. upcase wont always work. This is just an example. Will update the question for better understandability that upcase won&#39;t always work. Thanks for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518555181, "post_id": 48775280, "comment_id": 84552554, "body": "vnbrs@ Map seems overkill for my purpose. I am building up LIST_ALL just to use it to validate that it is a valid input. And the valid inputs are ABC, DEF, XYZ"}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "reply_to_user": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518555336, "post_id": 48775280, "comment_id": 84552641, "body": "You don&#39;t need <code>map</code> if you build the hash using the old syntax. <code>{ &#39;ABC&#39; =&gt; &#39;abc&#39;, &#39;DEF&#39; =&gt; &#39;def&#39; }</code>"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518555687, "post_id": 48775280, "comment_id": 84552815, "body": "LIST_ALL should be the list of constants i.e ABC, DEF and XYZ. Not in string. Later, I want to concatenate like <code>&quot;constant names are: &quot; + LIST_ALL.something()</code> which should then give output as <code>constant names are: ABC, DEF, XYZ</code>"}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "reply_to_user": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518556304, "post_id": 48775280, "comment_id": 84553105, "body": "I made a change @AayushKumarSingha"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518613195, "post_id": 48775280, "comment_id": 84577252, "body": "Thanks for your help. In my implementation part, I have less inclination to use a map. Since, every other place its done this way. Making it consistent. I am looking more ways if possible."}, {"owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "reply_to_user": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518613275, "post_id": 48775280, "comment_id": 84577299, "body": "I removed the map @AayushKumarSingha"}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": false, "score": 4, "last_activity_date": 1518613270, "last_edit_date": 1518613270, "creation_date": 1518554488, "answer_id": 48775280, "question_id": 48774777, "link": "https://stackoverflow.com/questions/48774777/how-to-convert-array-of-constants-into-string-with-the-constant-names-and-not-it/48775280#48775280", "title": "How to convert Array of Constants into String with the constant names and not its assigned values", "body": "<p>Ruby has no explicit hook for instance naming, as I can see. However, classes does.</p>\n\n<pre><code>CONSTANT = 'my constant value'\ninstance = Class.new\nCONSTANT = instance\ninstance.name.to_s\n=&gt; \"CONSTANT\"\n</code></pre>\n\n<p>Unfortunately, this will mess with your constant value, and that's not what you want.</p>\n\n<p>In any case, a solution I see is to stop using constants directly and use a hash. Just like:</p>\n\n<pre><code>MY_HASH  = { 'ABC' =&gt; 'abc', 'DEF' =&gt; 'def' }\nputs \"constant names are #{MY_HASH.keys.join(', ')}\"\n=&gt; \"constant names are ABC, DEF\"\n\nputs \"constant values are #{MY_HASH.values.join(', ')}\"\n=&gt; \"constant values are abc, def\"\n</code></pre>\n\n<p>If you still wanna mess with metaprogramming, <a href=\"https://stackoverflow.com/a/13300489/6241184\"><strong>check this answer</strong></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518644407, "post_id": 48788561, "comment_id": 84595818, "body": "Can you also include how to use #constantize to get constants value when required?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518686675, "post_id": 48788561, "comment_id": 84610079, "body": "Just use &quot;#constantize&quot; by itself.   <code>ABC =  &quot;text&quot;; my_constant = &quot;ABC&quot;</code> then <code>my_constant.constantize</code> will return &quot;text&quot;"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518800308, "post_id": 48788561, "comment_id": 84667144, "body": "<code>undefined method &#39;constantize&#39; for &quot;ABC&quot;:String (repl):6:in &#39;block in &lt;main&gt;&#39; (repl):6:in &#39;reject&#39; (repl):6:in &#39;&lt;main&gt;&#39;</code> getting this error"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518801593, "post_id": 48788561, "comment_id": 84667819, "body": "I realized constantize is rails specific. On running using RoR, I am getting this error: <code>(NameError)  uninitialized constant ABC;</code> I have updated the question using your approach."}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518809179, "post_id": 48788561, "comment_id": 84671535, "body": "I have edited the answer. With more detailed implementation details. Thanks a ton for your answer. Also, my very first step to meta-programming."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518809587, "post_id": 48788561, "comment_id": 84671700, "body": "Uninitialized constant?  You&#39;ve defined the constant ABC before you attempted the <code>constantize</code>?"}, {"owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "edited": false, "score": 0, "creation_date": 1518821020, "post_id": 48788561, "comment_id": 84676576, "body": "I have added my implementation details as another answer. It is working for me now. The constants needed to be as &lt;class_name&gt;::&lt;constant_name&gt; otherwise, was getting uninitialized constants."}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1518615441, "creation_date": 1518615441, "answer_id": 48788561, "question_id": 48774777, "link": "https://stackoverflow.com/questions/48774777/how-to-convert-array-of-constants-into-string-with-the-constant-names-and-not-it/48788561#48788561", "title": "How to convert Array of Constants into String with the constant names and not its assigned values", "body": "<p>Store the constant names as strings, when you want to check the constant value use `#constantize'...</p>\n\n<pre><code>ABC = 'abc'\nDEF = 'def'\nGHI = ''\nXYZ = 'anything'\nLIST_ALL = %w(ABC DEF GHI XYZ)\n</code></pre>\n\n<p>Then you can do...</p>\n\n<pre><code>LIST_ALL.reject{|c| c.constantize.blank?}.join(', ') # =&gt; \"ABC, DEF, XYZ\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "is_accepted": false, "score": 0, "last_activity_date": 1518820659, "creation_date": 1518820659, "answer_id": 48835840, "question_id": 48774777, "link": "https://stackoverflow.com/questions/48774777/how-to-convert-array-of-constants-into-string-with-the-constant-names-and-not-it/48835840#48835840", "title": "How to convert Array of Constants into String with the constant names and not its assigned values", "body": "<p>Implementation details inside a class.<br>\nAdd <code>&lt;classname&gt;::&lt;constant_name&gt;</code> otherwise throws (NameError) uninitialized Constant ABC:</p>\n\n<pre><code>class X\n  ABC = \"123\"\n  DEF = \"456\"\n  LIST_ALL = %w(X::ABC X::DEF)\n\n  def something()\n    puts LIST_ALL.reject{|c| c.constantize.blank?}.join(', ') # output: X::ABC, X::DEF\n    puts LIST_ALL[0].constantize # output: 123\n  end\nend\n</code></pre>\n\n<p>Note: to use constantize, Ruby on Rails is pre-requisite.</p>\n"}], "owner": {"reputation": 616, "user_id": 5100213, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/nN43X.png?s=128&g=1", "display_name": "timekeeper", "link": "https://stackoverflow.com/users/5100213/timekeeper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "accepted_answer_id": 48788561, "answer_count": 3, "score": 3, "last_activity_date": 1518820659, "creation_date": 1518552402, "last_edit_date": 1518801789, "question_id": 48774777, "link": "https://stackoverflow.com/questions/48774777/how-to-convert-array-of-constants-into-string-with-the-constant-names-and-not-it", "title": "How to convert Array of Constants into String with the constant names and not its assigned values", "body": "<p>For example:</p>\n\n<pre><code>ABC = 'abc'\nDEF = 'def'\nXYZ = 'anything'\nLIST_ALL = [ABC, DEF, XYZ]\n</code></pre>\n\n<p>If I do </p>\n\n<pre><code>LIST_ALL.reject(&amp;:blank?).join(', ') # =&gt; \"abc, def, anything\"\n</code></pre>\n\n<p>What I am looking for is to get the constant names, not their values\nExpected output:</p>\n\n<pre><code>LIST_ALL.something() #=&gt; \"ABC, DEF, XYZ\"\n</code></pre>\n\n<p>Approach #1:</p>\n\n<pre><code>class X\n  ABC = \"abc\"\n  DEF = \"def\"\n  GHI = \"\"\n  XYZ = \"anything\"\n  LIST_ALL = %w(ABC DEF GHI XYZ)\n\n  def self.something()\n     puts LIST_ALL.reject{|c| c.constantize.blank?}.join(', ')\n     # puts LIST_ALL[0].constantize\n  end\nend\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>(NameError)  uninitialized constant ABC;\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1518550502, "creation_date": 1518550502, "answer_id": 48774352, "question_id": 48774252, "link": "https://stackoverflow.com/questions/48774252/reference-method-parameter-in-classnew-block/48774352#48774352", "title": "Reference Method Parameter in Class::new block", "body": "<p>The <code>def</code> construction closes its scope. Local variables cannot seek beyond that. To do what you want, use <code>define_method</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1518558965, "post_id": 48774472, "comment_id": 84554430, "body": "Ahhh that&#39;s not a class instance variable, that&#39;s a <i>class variable</i>! Totally different thing!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1518627829, "post_id": 48774472, "comment_id": 84587341, "body": "@max I meant that as in &quot;instance of Class variable&quot; but perhaps that could be phrased better. Edited."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1518627801, "last_edit_date": 1518627801, "creation_date": 1518551131, "answer_id": 48774472, "question_id": 48774252, "link": "https://stackoverflow.com/questions/48774252/reference-method-parameter-in-classnew-block/48774472#48774472", "title": "Reference Method Parameter in Class::new block", "body": "<p>As <code>method_return</code> is a variable you can't propagate this down to the <code>example</code> method unless you use it in another context. You could capture this in a class-level variable:</p>\n\n<pre><code>klass = Class.new(A) do\n  @@method_return = method_return\n\n  def example\n    @@method_return\n  end\nend\n</code></pre>\n\n<p>You could also dynamically define the method so that the <code>method_return</code> variable is captured by the block as a closure:</p>\n\n<pre><code>klass = Class.new(A) do\n  define_method(:example) do\n    method_return\n  end\nend\n</code></pre>\n\n<p>When using <code>def example</code> then the block scope shifts and becomes something completely different.</p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1518559605, "creation_date": 1518559605, "answer_id": 48776458, "question_id": 48774252, "link": "https://stackoverflow.com/questions/48774252/reference-method-parameter-in-classnew-block/48776458#48776458", "title": "Reference Method Parameter in Class::new block", "body": "<p>This isn't odd at all, it's the regular behavior of method definitions:</p>\n\n<pre><code>class A\n  x = 3\n  def foo\n    x\n  end\nend\n\nA.new.foo # NameError: undefined local variable or method `x'\n</code></pre>\n\n<p>Method definitions don't capture local variables from their outer scope. This is generally good: normally you don't want the result of a method to depend on some random state that existed at the time of its definition, you want it to depend on the object you called it on!</p>\n\n<p>The exception of course is when you are metaprogramming. In that case it's useful to capture local variables so you <em>explicitly</em> capture them using the same mechanism you use elsewhere: a block.</p>\n\n<pre><code>define_method :example do\n  method_return\nend\n</code></pre>\n"}], "owner": {"reputation": 6596, "user_id": 5021321, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/29f10a1b457e63d44e3a221e89e32c17?s=128&d=identicon&r=PG", "display_name": "Eli Sadoff", "link": "https://stackoverflow.com/users/5021321/eli-sadoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48776458, "answer_count": 3, "score": 0, "last_activity_date": 1518627801, "creation_date": 1518550077, "question_id": 48774252, "link": "https://stackoverflow.com/questions/48774252/reference-method-parameter-in-classnew-block", "title": "Reference Method Parameter in Class::new block", "body": "<p>I'm trying to create classes using meta-programming in Ruby as per this question: <a href=\"https://stackoverflow.com/questions/6583389/dynamically-define-named-classes-in-ruby\">Dynamically define named classes in Ruby</a>. Everything is going well, except it seems like in the block from <code>Class.new</code> can't reference method parameters which is odd.</p>\n\n<p>I have this</p>\n\n<pre><code>class A; end\n\nmodule B\n  def self.class_with_method(class_name, method_return)\n    klass = Class.new(A) do\n      def example\n        method_return\n      end\n    end\n    B.const_set class_name, klass\n  end\nend\n</code></pre>\n\n<p>But when I have the above and then test it with</p>\n\n<pre><code>B.class_with_method 'ExampleClass', 23\nB::ExampleClass.new.example\n</code></pre>\n\n<p>Gives me </p>\n\n<blockquote>\n  <p>undefined local variable or method `method_return' for #&lt;B::ExampleClass:0x00007ff1d7130d00&gt; (NameError)</p>\n</blockquote>\n\n<p>This is odd because if I were to do</p>\n\n<pre><code>def add_number(number)\n  [1, 2, 3, 4].map {|i| i + number}\nend\n\nadd_number(2)\n# =&gt; [3, 4, 5, 6]\n</code></pre>\n\n<p>So clearly blocks can take method arguments.</p>\n\n<p>Is there a way to pass <code>method_return</code> to <code>def example</code> within the block?</p>\n"}, {"tags": ["ruby", "escaping", "influxdb"], "comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1518550421, "post_id": 48774097, "comment_id": 84550129, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1542214/weird-backslash-substitution-in-ruby\">Weird backslash substitution in Ruby</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518551867, "post_id": 48774290, "comment_id": 84550822, "body": "I am using <a href=\"https://github.com/influxdata/influxdb-ruby\" rel=\"nofollow noreferrer\">github.com/influxdata/influxdb-ruby</a> which I assumed sanitized everything, I guess not. I have commetned on their Github and awaiting response."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518552380, "post_id": 48774290, "comment_id": 84551104, "body": "They can only sanitize <i>if</i> you use the parameterized query feature. There&#39;s no other way for them to know what you&#39;re putting in your string. The way you avoid injection bugs is by not injecting in the first place."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518553103, "post_id": 48774290, "comment_id": 84551480, "body": "I guess my question was a little misleading. Actually what I&#39;m doing is calling <code>INFLUXDB_CLIENT.write_point(&quot;things&quot;, time: Time.now.to_i, values: { foo: &quot;\\\\&quot; })</code>. So I&#39;m not really interpolating myself, it&#39;s done by the gem."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518553205, "post_id": 48774290, "comment_id": 84551541, "body": "Yeah, that is a little misleading since that&#39;s completely different from the code in your question."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1518553621, "post_id": 48774290, "comment_id": 84551770, "body": "the insert snippet was a little tangential, i was meaning to focus more on the <code>gsub</code> code which is addressed by the answer marked as duplicate. However I accepted yours because it ended up being more apt for my situation. I guess it&#39;s a bit of an X/Y problem."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1518554165, "post_id": 48774290, "comment_id": 84552062, "body": "It turns out I didn&#39;t find the bug, but it was a bug. See <a href=\"https://github.com/influxdata/influxdb-ruby/issues/200\" rel=\"nofollow noreferrer\">github.com/influxdata/influxdb-ruby/issues/200</a> I was using version 0.4.1 and the bug was fixed in 0.4.2"}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1518550220, "creation_date": 1518550220, "answer_id": 48774290, "question_id": 48774097, "link": "https://stackoverflow.com/questions/48774097/backslash-at-end-of-string-causes-error-when-inserting-into-influxdb/48774290#48774290", "title": "backslash at end of string causes error when inserting into InfluxDB", "body": "<p>You just use parameterized query strings:</p>\n\n<pre><code>INSERT INTO my_db.default.my_measurement,my_tag=1 my_val=%{1}\n</code></pre>\n\n<p>Where when you call it you do this:</p>\n\n<pre><code>influxdb.query(\"...query...\", params: [ string ])\n</code></pre>\n\n<p>What you did was create a classic <a href=\"http://bobby-tables.com/\" rel=\"nofollow noreferrer\">injection bug</a> by sending unescaped data into a query. The same principle applies in any database with a plain-text string representation, or even other data formats like HTML and JavaScript.</p>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 48774290, "answer_count": 1, "score": 1, "last_activity_date": 1518554400, "creation_date": 1518549549, "last_edit_date": 1518554400, "question_id": 48774097, "link": "https://stackoverflow.com/questions/48774097/backslash-at-end-of-string-causes-error-when-inserting-into-influxdb", "title": "backslash at end of string causes error when inserting into InfluxDB", "body": "<p>I have a string:</p>\n\n<pre><code>string = \"\\\\\"\nputs string\n# =&gt; \\\n</code></pre>\n\n<p>I am interpolating this into a new string and sending to a database. However the database (InfluxDB) uses backslashes as escape characters so pushing this string can cause an error.</p>\n\n<p>For example, if I pass the following to Influx it will cause an \"unterminated string\" error:</p>\n\n<pre><code>insert_cmd = &lt;&lt;-TXT\n  INSERT INTO my_db.default.my_measurement,my_tag=1 my_val=\"#{string}\"\nTXT\n</code></pre>\n\n<p>My question is how can I replace <code>\\</code> in a string with <code>\\\\</code> (two actual backslashes).</p>\n\n<p>I have it working with <code>gsub(\"\\\\\", \"\\\\\\\\\\\\\")</code> but I don't understand why this works and the following doesn't:</p>\n\n<pre><code>string.gsub(\"\\\\\", \"\\\\\\\\\")\n# SyntaxError: (irb):10: syntax error, unexpected $undefined, expecting end-of-input\n</code></pre>\n\n<p>Why doesn't this work? Why does <code>gsub(\"\\\\\", \"\\\\\\\\\\\\\")</code> work? Is there a better way?</p>\n\n<hr>\n\n<p><strong>solved</strong></p>\n\n<p>As I mentioned in a comment, actually I am not manually interpolating into a INSERT INTO string. I am using influxdb-ruby:</p>\n\n<pre><code>INFLUXDB_CLIENT.write_point(\"things\", time: Time.now.to_i, values: { foo: \"\\\\\" })\n</code></pre>\n\n<p>It turns out this is a bug with that gem: <a href=\"https://github.com/influxdata/influxdb-ruby/issues/200\" rel=\"nofollow noreferrer\">https://github.com/influxdata/influxdb-ruby/issues/200</a></p>\n\n<p>It is fixed in v 0.4.2 and i was using 0.4.1</p>\n"}, {"tags": ["ruby", "ruby-hash"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1518552516, "post_id": 48773649, "comment_id": 84551182, "body": "<code>Test.key.class</code> is central to the question. Please edit to give <code>Test.key</code>&#39;s class."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "edited": false, "score": 0, "creation_date": 1518549162, "post_id": 48773682, "comment_id": 84549423, "body": "yep accepted it. it was asking me to wait for 5 mins :)"}], "tags": [], "owner": {"reputation": 4688, "user_id": 6241184, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1022848011119215/picture?type=large", "display_name": "Vinicius Brasil", "link": "https://stackoverflow.com/users/6241184/vinicius-brasil"}, "is_accepted": true, "score": 1, "last_activity_date": 1518548668, "last_edit_date": 1518548668, "creation_date": 1518547955, "answer_id": 48773682, "question_id": 48773649, "link": "https://stackoverflow.com/questions/48773649/how-to-access-value-from-hash-based-on-key-value/48773682#48773682", "title": "how to access value from hash based on key value", "body": "<p>Ruby uses <code>Object#eql?</code> method to compare hash keys. If <code>Test.key</code> is a <code>String</code> and the hash key is a <code>Symbol</code>, you need to convert it to a <code>Symbol</code>.</p>\n\n<p>Instead of using <code>hash[Test.key]</code>, use <code>hash[Test.key.to_sym]</code>.</p>\n\n<p>See also <a href=\"https://docs.ruby-lang.org/en/2.0.0/Object.html#method-i-eql-3F\" rel=\"nofollow noreferrer\"><code>Object#eql?</code></a> and <a href=\"https://docs.ruby-lang.org/en/2.0.0/Hash.html\" rel=\"nofollow noreferrer\"><code>Hash</code></a>.</p>\n"}], "owner": {"reputation": 203, "user_id": 9226492, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1101789162a8e10b23e10edb2f56fadd?s=128&d=identicon&r=PG&f=1", "display_name": "jose1221", "link": "https://stackoverflow.com/users/9226492/jose1221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 48773682, "answer_count": 1, "score": 1, "last_activity_date": 1518592324, "creation_date": 1518547821, "last_edit_date": 1518592324, "question_id": 48773649, "link": "https://stackoverflow.com/questions/48773649/how-to-access-value-from-hash-based-on-key-value", "title": "how to access value from hash based on key value", "body": "<p>I have following hash</p>\n\n<pre><code>hash = {\n   \"some value\": \"abc\",\n   \"other value\": \"dcd\"\n}\n</code></pre>\n\n<p>The key value is coming from an object <code>Test</code> and I can access it as <code>Test.key</code></p>\n\n<p>I am trying to access hash value from the key which is coming from Test.key. I tried to access the key value from hash <code>hash[:Test.key]</code> but that returns <code>NoMethodError Exception: undefined method 'key' for :activity:Symbol</code></p>\n\n<p>How could i access the hash value?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "saml-2.0", "ruby-saml"], "answers": [{"comments": [{"owner": {"reputation": 749, "user_id": 443972, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d65f255e85d67ed4927c476a1753e8cf?s=128&d=identicon&r=PG", "display_name": "Th3sandm4n", "link": "https://stackoverflow.com/users/443972/th3sandm4n"}, "edited": false, "score": 0, "creation_date": 1518546201, "post_id": 48772971, "comment_id": 84547959, "body": "I found the answer after digging around, the problem came from the saml_settings I think: settings = idp_metadata_parser.parse(ENV[&#39;OKTA_METADATA&#39;]) i had that as a remote URL, so I changed it to settings = idp_metadata_parser.parse_remote(ENV[&#39;OKTA_METADATA&#39;]) and that seemed to work!"}], "tags": [], "owner": {"reputation": 498, "user_id": 1422425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce46bae4aba4c091bffb10b7993e8769?s=128&d=identicon&r=PG&f=1", "display_name": "Paniko0", "link": "https://stackoverflow.com/users/1422425/paniko0"}, "is_accepted": false, "score": 0, "last_activity_date": 1518545188, "creation_date": 1518545188, "answer_id": 48772971, "question_id": 48772743, "link": "https://stackoverflow.com/questions/48772743/undefined-method-for-nilnilclass-in-sample-saml-application/48772971#48772971", "title": "undefined method `+&#39; for nil:NilClass in sample saml application", "body": "<p>Firstly I think you're using a pretty old ruby-saml gem version. That might be the problem.</p>\n\n<p>I haven't tested your code, but it seems to me that you forgot to set <code>idp_sso_target_url</code> in your settings, and apparently that's the only place it can throw the exception you got. <a href=\"https://github.com/onelogin/ruby-saml/blob/v1.1.2/lib/onelogin/ruby-saml/authrequest.rb#L39\" rel=\"nofollow noreferrer\">https://github.com/onelogin/ruby-saml/blob/v1.1.2/lib/onelogin/ruby-saml/authrequest.rb#L39</a></p>\n"}, {"tags": [], "owner": {"reputation": 749, "user_id": 443972, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d65f255e85d67ed4927c476a1753e8cf?s=128&d=identicon&r=PG", "display_name": "Th3sandm4n", "link": "https://stackoverflow.com/users/443972/th3sandm4n"}, "is_accepted": false, "score": 0, "last_activity_date": 1518570098, "creation_date": 1518570098, "answer_id": 48778132, "question_id": 48772743, "link": "https://stackoverflow.com/questions/48772743/undefined-method-for-nilnilclass-in-sample-saml-application/48778132#48778132", "title": "undefined method `+&#39; for nil:NilClass in sample saml application", "body": "<p>Posting the answer here, turns out that i was using a metadata url for the OKTA_METADATA environment variable.</p>\n\n<p>Had to modify\nsettings = idp_metadata_parser.parse(ENV['OKTA_METADATA'])\nto\nsettings = idp_metadata_parser.parse_remote(ENV['OKTA_METADATA'])\nwhere\nOKTA_METADATA=<a href=\"http://blahblahblah.com/metadata\" rel=\"nofollow noreferrer\">http://blahblahblah.com/metadata</a></p>\n"}], "owner": {"reputation": 749, "user_id": 443972, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d65f255e85d67ed4927c476a1753e8cf?s=128&d=identicon&r=PG", "display_name": "Th3sandm4n", "link": "https://stackoverflow.com/users/443972/th3sandm4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518570098, "creation_date": 1518544255, "last_edit_date": 1518550052, "question_id": 48772743, "link": "https://stackoverflow.com/questions/48772743/undefined-method-for-nilnilclass-in-sample-saml-application", "title": "undefined method `+&#39; for nil:NilClass in sample saml application", "body": "<p>Trying to follow the setup <a href=\"https://medium.com/@abhisheksp/integrating-your-rails-application-with-okta-2e77ebe02528\" rel=\"nofollow noreferrer\">here</a> to create a simple SAML application  (full project I got <a href=\"https://github.com/abhisheksp/OktaDemo\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>I went through and did the setup</p>\n\n<pre><code>bundle install\nrails s\n</code></pre>\n\n<p>This went fine, but when I navigate to \n<a href=\"http://localhost:3000/\" rel=\"nofollow noreferrer\">http://localhost:3000/</a>\nI get hit with</p>\n\n<pre><code>NoMethodError in SamlController#init\nundefined method `+' for nil:NilClass\nExtracted source (around line #9):\n  def init\n    request = OneLogin::RubySaml::Authrequest.new\n    direct_to(request.create(saml_settings))\n  end\n\n  def consume\n</code></pre>\n\n<p>I added some logging to check nil status of request and saml_settings but that seems to return false for both of them</p>\n\n<pre><code>puts request.nil?\nputs saml_settings.nil?\n</code></pre>\n\n<p>Error trace:</p>\n\n<pre><code>Processing by SamlController#init as HTML\nfalse\nfalse\nCreated AuthnRequest: &lt;samlp:AuthnRequest AssertionConsumerServiceURL='http://localhost:3000/saml/consume' ID='_394fa0a0-f313-0135-85a4-6a0001e18280' IssueInstant='2018-02-13T17:42:45Z' Version='2.0' xmlns:saml='urn:oasis:names:tc:SAML:2.0:assertion' xmlns:samlp='urn:oasis:names:tc:SAML:2.0:protocol'&gt;&lt;saml:Issuer&gt;http://localhost:3000/saml/consume&lt;/saml:Issuer&gt;&lt;/samlp:AuthnRequest&gt;\nCompleted 500 Internal Server Error in 15ms (ActiveRecord: 0.0ms)\n\nNoMethodError (undefined method `+' for nil:NilClass):\n  app/controllers/saml_controller.rb:9:in `init'\n</code></pre>\n\n<p>(Note: <a href=\"https://github.com/abhisheksp/OktaDemo/blob/master/app/controllers/saml_controller.rb\" rel=\"nofollow noreferrer\">the error is line 5</a>, it says line 9 for me because of debug logging I added)\nI'm not too sure what else it could be, not sure what method it can't find and what is nil?</p>\n\n<p>I have never messed with ruby stuff, but from my initial looks I'm not sure where the nil is coming from, the logs show the request being created so not sure. Any help would be appreciated, thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "associations"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518543441, "post_id": 48772424, "comment_id": 84546476, "body": "Why do you define the method as a class method?"}, {"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518543534, "post_id": 48772424, "comment_id": 84546532, "body": "@sawa I tried defining it without the <code>self</code> but in that case it looks for a <code>user</code> attribute called <code>method_name</code> rather than looking for the method itself"}, {"owner": {"reputation": 506, "user_id": 2428762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/adff7188450a9655d0b1d00f330b9edd?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2428762/josh"}, "edited": false, "score": 0, "creation_date": 1518543538, "post_id": 48772424, "comment_id": 84546534, "body": "def method_name   self.(...) end ?"}, {"owner": {"reputation": 506, "user_id": 2428762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/adff7188450a9655d0b1d00f330b9edd?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2428762/josh"}, "edited": false, "score": 0, "creation_date": 1518543864, "post_id": 48772424, "comment_id": 84546709, "body": "Ok, so, to be clear, you have a <code>User</code> model, a <code>Game_play</code> model (?), and a <code>Player</code> model, with <code>Game_play</code> having a <code>has_many</code> for <code>Player</code> and a <code>has_many_through</code> for <code>User</code>?"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1518544422, "post_id": 48772424, "comment_id": 84547017, "body": "Yes the error is because <code>Devise.token_generator.generate(User, :login_bypass_token)</code> is trying to make sure this is unique for the given column and set this in the database but you don&#39;t have a column to look it up in or set it in. See <a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise/token_generator.rb#L16\" rel=\"nofollow noreferrer\"><code>Devise::TokenGenerator#generate</code></a>"}, {"owner": {"reputation": 506, "user_id": 2428762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/adff7188450a9655d0b1d00f330b9edd?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2428762/josh"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1518544821, "post_id": 48772424, "comment_id": 84547251, "body": "Ohhh... Try adding <code>attr_reader :raw_invitation_token</code> to your user model.... Or what @engineersmnky said."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7927990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425331290823651/picture?type=large", "display_name": "Riley Thompson", "link": "https://stackoverflow.com/users/7927990/riley-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1518543738, "creation_date": 1518543738, "answer_id": 48772619, "question_id": 48772424, "link": "https://stackoverflow.com/questions/48772424/undefined-method-when-calling-model-method-in-controller/48772619#48772619", "title": "Undefined method when calling model method in controller", "body": "<p>Should be using an instance method instead of a class method. I'm not sure how you would get an error where it's looking for an attribute on the model since those can only be defined in the schema. If you're adding a regular instance method within the model it should work correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1518546626, "last_edit_date": 1518546626, "creation_date": 1518544591, "answer_id": 48772826, "question_id": 48772424, "link": "https://stackoverflow.com/questions/48772424/undefined-method-when-calling-model-method-in-controller/48772826#48772826", "title": "Undefined method when calling model method in controller", "body": "<p><strong>EDIT:</strong></p>\n\n<p>My first answer was before you mentioned Devise and assuming you didn't know if you needed a class or instance method. It's clear that your method must be an instance one.</p>\n\n<p>I think you are trying to apply something you found here: <a href=\"https://stackoverflow.com/a/30857087/3372172\">https://stackoverflow.com/a/30857087/3372172</a></p>\n\n<p>This requires that you add a new field to the users database, to manage the :login_bypass_token. Because you will use this column later to perform a find_by. Devise does not add this column to the database.</p>\n\n<p><strong>PREVIOUS ANSWER</strong></p>\n\n<p>If the method needs to access instance variables (which means it acts differently depending the specific object in the User class), it should be an instance method, defined without the <strong>self</strong> keyword.</p>\n\n<p>If it is a class method, it cannot depend on any attribute from a specific object, and you cannot call it from an instance of the class.</p>\n\n<p>You must decide if it's really a class method or an instance method.\n`\nIf you need a class method to be called from an instance, you can do this (<strong>but I don't know why you could need it</strong>). </p>\n\n<pre><code>class User\n  def self.method_name\n    # blablabla\n  end\n\n  def method_name\n    User.method_name\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 48772826, "answer_count": 2, "score": 1, "last_activity_date": 1518546626, "creation_date": 1518542905, "last_edit_date": 1518544088, "question_id": 48772424, "link": "https://stackoverflow.com/questions/48772424/undefined-method-when-calling-model-method-in-controller", "title": "Undefined method when calling model method in controller", "body": "<p>I have a class method in my <code>User</code> model:</p>\n\n<pre><code>def self.method_name\n  ...\nend\n</code></pre>\n\n<p>In a controller, I need to call this method on a <code>User</code> instance obtained through association:</p>\n\n<pre><code>@user = game_play.player.user\n</code></pre>\n\n<p>As expected, it threw a no method error because it's a class method.</p>\n\n<p>What is the way to call the method in this case?</p>\n\n<p>EDIT: Adding code for question clarification</p>\n\n<pre><code>@user = @game_play.client.user.\n@token = @user.set_login_bypass_token\n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>def set_login_bypass_token\n  #We generate a raw token and an encrypted version of the same token\n  raw, enc = Devise.token_generator.generate(User, :login_bypass_token)\n  self.login_bypass_token = enc\n  self.login_bypass_token_set_at = Time.now\n  self.save(validate: false)\n  #Raw token is sent to the user via email to provide auto-login\n  raw\nend\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>PG::UndefinedColumn: ERROR:  column users.login_bypass_token does not exist\n</code></pre>\n\n<p>Notice the error has it as <code>users.login_bypass_token</code> instead of <code>set_login_bypass_token</code></p>\n"}, {"tags": ["ruby", "minitest"], "comments": [{"owner": {"reputation": 99, "user_id": 2299138, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/da244c8219d92fdddb0ffe8f196ed9ca?s=128&d=identicon&r=PG", "display_name": "Rohit Doraya", "link": "https://stackoverflow.com/users/2299138/rohit-doraya"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1518590176, "post_id": 48772063, "comment_id": 84563462, "body": "I googled and tried many things but not get success. My objective is that i want to call driver method before all test suite files for once."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1518620957, "post_id": 48772063, "comment_id": 84582630, "body": "That article describes your exact use case in the <i>&quot;Setting Up Before Running the Suite&quot;</i> section at the bottom"}], "owner": {"reputation": 99, "user_id": 2299138, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/da244c8219d92fdddb0ffe8f196ed9ca?s=128&d=identicon&r=PG", "display_name": "Rohit Doraya", "link": "https://stackoverflow.com/users/2299138/rohit-doraya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1518541789, "creation_date": 1518541669, "last_edit_date": 1518541789, "question_id": 48772063, "link": "https://stackoverflow.com/questions/48772063/run-some-functionality-before-all-test-suites-in-minitest", "title": "Run some functionality before all test suites in minitest", "body": "<p>This is my code:</p>\n\n<pre><code>class LoginTest &lt; MiniTest::Test\n  def before_all\n    Selenium::WebDriver::Chrome.driver_path = DRIVER_PATH\n    options = Selenium::WebDriver::Chrome::Options.new\n    options.add_argument('--headless')\n    @driver = Selenium::WebDriver.for :chrome, options: options\n  end\n\n  def test_one\n  end\n\n  def test_two\n  end\nend\n</code></pre>\n\n<p>I want to call the driver method before all test suites.</p>\n\n<p>Is there a way to run some code once before all suites?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518541532, "post_id": 48771911, "comment_id": 84545245, "body": "What is wrong? You tell us, not the other way around."}, {"owner": {"reputation": 373, "user_id": 1482916, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/029830d20670653e572da07f32226659?s=128&d=identicon&r=PG", "display_name": "Florent L.", "link": "https://stackoverflow.com/users/1482916/florent-l"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518541588, "post_id": 48771911, "comment_id": 84545280, "body": "I should get keys of hash in param, not blank array..."}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "edited": false, "score": 1, "creation_date": 1518541708, "post_id": 48771911, "comment_id": 84545364, "body": "I think I&#39;d better post full example, without dots. And show data you are testing with"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518541735, "post_id": 48771911, "comment_id": 84545385, "body": "Is <code>display_keys</code> relevant in any way to your question? If not, please remove it. Show the minimal example that demonstrates your issue."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1518541979, "post_id": 48771911, "comment_id": 84545549, "body": "<code>&quot;foo &quot; + get_new_keys(hash)</code> is invalid. It produces <i>&quot;TypeError: no implicit conversion of Array into String&quot;</i>"}, {"owner": {"reputation": 373, "user_id": 1482916, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/029830d20670653e572da07f32226659?s=128&d=identicon&r=PG", "display_name": "Florent L.", "link": "https://stackoverflow.com/users/1482916/florent-l"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1518542551, "post_id": 48771911, "comment_id": 84545905, "body": "Ok, eddited according your comments. I hope it&#39;s more clean. @axiac, I was wrong during simplification, sorry :)"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518542715, "post_id": 48771911, "comment_id": 84546022, "body": "<code>get_hash_keys</code> takes one argument, but you are passing no arguments to it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 2, "creation_date": 1518542747, "post_id": 48771911, "comment_id": 84546042, "body": "@sawa: yeah, and there is at least one other error too. Not to mention they mutate <code>new_hash</code> while iterating it."}, {"owner": {"reputation": 1104, "user_id": 3938081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ccf280616912c6edc9aa83f278686c?s=128&d=identicon&r=PG&f=1", "display_name": "dave_slash_null", "link": "https://stackoverflow.com/users/3938081/dave-slash-null"}, "edited": false, "score": 0, "creation_date": 1518547400, "post_id": 48771911, "comment_id": 84548555, "body": "Can you edit your post to show what you are starting from (seems like maybe you start with a <code>Hash</code> with some information) and where you would like to get to based on where you started from?  Then also show what you have tried.  Currently, your post shows only what you have tried but you have not indicated your actual question/problem."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518605649, "post_id": 48771911, "comment_id": 84572145, "body": "You mutate the original hash and <i>then</i> you clone it? wat?"}, {"owner": {"reputation": 373, "user_id": 1482916, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/029830d20670653e572da07f32226659?s=128&d=identicon&r=PG", "display_name": "Florent L.", "link": "https://stackoverflow.com/users/1482916/florent-l"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518682455, "post_id": 48771911, "comment_id": 84607743, "body": "Edited. @SergioTulentsev Try to give advice rather than criticize and take people for fools"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518682933, "post_id": 48771911, "comment_id": 84608008, "body": "@FlorentL.: good point. And you should be posting <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> instead of incomplete snippets which you claim as &quot;working incorrectly&quot;, but you don&#39;t show neither full snippets nor data that they operate on. And on top of it, these snippets can&#39;t possibly work at all, because they contain several errors that cause the program to crash."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518542518, "post_id": 48772127, "comment_id": 84545884, "body": "No worries. For the future, strive to post copy-pastable code. Immensely convenient."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 0, "last_activity_date": 1518542453, "last_edit_date": 1518542453, "creation_date": 1518541914, "answer_id": 48772127, "question_id": 48771911, "link": "https://stackoverflow.com/questions/48771911/hashkeys-in-helper/48772127#48772127", "title": "&#39;Hash#keys&#39; in helper", "body": "<p>Nothing is wrong with <code>hash.keys</code>:</p>\n\n<pre><code>def get_new_keys(hash)\n  hash.delete_if{|k,v| k == :bar}\n  return hash.keys\nend\nget_new_keys({qux: :bar, bar: :baz}) # =&gt; [:qux] \n</code></pre>\n\n<p>This, on the other hand, is busted. </p>\n\n<pre><code>def display_keys(hash)\n  return \"foo \" + get_new_keys(hash)\nend     \n</code></pre>\n\n<p>Are you expecting an <code>array</code> to be returned? If so, that's not the way to go about it at all. You <em>could</em> do something like:</p>\n\n<pre><code>def display_keys(hash)\n  return [:foo].concat(get_new_keys(hash))\nend\n</code></pre>\n\n<p>In which case, it'd do something like:</p>\n\n<pre><code>def display_keys(hash)\n  return [:foo].concat(get_new_keys(hash))\nend\ndisplay_keys({qux: :bar, bar: :baz}) # =&gt; [:foo, :qux] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5592281, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153111449025880/picture?type=large", "display_name": "Mckay Smalley", "link": "https://stackoverflow.com/users/5592281/mckay-smalley"}, "is_accepted": false, "score": 0, "last_activity_date": 1518542921, "last_edit_date": 1518542921, "creation_date": 1518542401, "answer_id": 48772286, "question_id": 48771911, "link": "https://stackoverflow.com/questions/48771911/hashkeys-in-helper/48772286#48772286", "title": "&#39;Hash#keys&#39; in helper", "body": "<p>The <code>.keys</code> method returns and Array of keys in the Hash. </p>\n\n<p>Your question is impossible to answer for two reasons:</p>\n\n<ol>\n<li>You have not included the condition in your <code>delete_if</code> block. My\nguess is that you are deleting all keys in the hash, so <code>.keys</code> is\nreturning <code>[]</code>.</li>\n<li>You have not described the output you are expecting.</li>\n</ol>\n\n<p>On a side note, your method <code>display_keys</code> does not work in ruby <code>2.3</code>. You cannot concatenate an Array and a String like that. It will throw a <code>TypeError: no implicit conversion of Array into String</code></p>\n\n<p>But taking my best guess at it the following code works just fine:</p>\n\n<pre><code>def get_new_keys(hash)\n    hash.delete_if{ |k,v| v % 2 == 0 }\n    return hash.keys\nend\n\ndef display_keys(hash)\n    return [\"foo\"] + get_new_keys(hash)\nend\n\nhash = {\n    one: 1,\n    two: 2,\n    three: 3,\n    four: 4,\n    five: 5,\n    six: 6,\n    seven: 7,\n    eight: 8,\n    nine: 9,\n    ten: 10\n}\n</code></pre>\n\n<p>Outputs:\n    </p>\n\n<pre><code>pry(main)&gt; display_keys( hash )\n=&gt; [\"foo\", :one, :three, :five, :seven, :nine]\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 1482916, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/029830d20670653e572da07f32226659?s=128&d=identicon&r=PG", "display_name": "Florent L.", "link": "https://stackoverflow.com/users/1482916/florent-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1518682316, "creation_date": 1518541141, "last_edit_date": 1518682316, "question_id": 48771911, "link": "https://stackoverflow.com/questions/48771911/hashkeys-in-helper", "title": "&#39;Hash#keys&#39; in helper", "body": "<p>I have this method in helper:</p>\n\n<pre><code>def get_hash_keys(hash)\n  hash.delete_if{|k, v| v.class != Hash}\n  return hash.keys\nend\n</code></pre>\n\n<p>When I call <code>get_hash_keys</code> from another method in the same helper, it returns a blank array :</p>\n\n<pre><code>def datas_size\n  sum = 0\n  new_hash = {title: \"This is a test\", datas: {firstname: \"foo\", lastname: \"bar\"}}\n  new_hash.each do |k, v|\n    sum += v.size if get_hash_keys(new_hash).includes? k\n  end\n\n  return sum\nend\n</code></pre>\n\n<p>I tested to change <code>return hash.keys</code> with fixed array, and I get it. Only <code>keys</code> function seems not to work. I also double checked my array in params.</p>\n\n<p>Is there some specifications I ignore working inside helpers ?</p>\n\n<p>Edit for @DRSE :</p>\n\n<p>I start with hash that contains others hashes. I need to know size of each children hash. The point is when I call this function (get_hash_keys) from the views, it fails (return blank array), but from console it works (return keys). </p>\n\n<p>More investigation this morning drive me to conclude may be this is a wrong usage of delete_if. My ununderstood solution is to replace : </p>\n\n<pre><code>def get_hash_keys(hash)\n  hash.delete_if{|k, v| v.class != Hash}\n  return hash.keys\nend\n</code></pre>\n\n<p>with</p>\n\n<pre><code>def get_hash_keys(hash)\n  tmp_hash = hash.clone\n  tmp_hash.delete_if{|k, v| v.class != Hash}\n  return tmp_hash.keys\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1518540235, "post_id": 48771578, "comment_id": 84544345, "body": "What do you see in <code>heroku logs --app One-Month-Rails</code> (or whatever your app name is)? (Add the heroku log to your question, don&#39;t paste in comments.) Your build log is not helpful."}, {"owner": {"reputation": 689, "user_id": 2875377, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4a9d994f85c436f7bf13c592e6b8989e?s=128&d=identicon&r=PG&f=1", "display_name": "praga2050", "link": "https://stackoverflow.com/users/2875377/praga2050"}, "edited": false, "score": 0, "creation_date": 1518540402, "post_id": 48771578, "comment_id": 84544471, "body": "for more info about heroku logs <a href=\"https://devcenter.heroku.com/articles/logging\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/logging</a>"}, {"owner": {"reputation": 3, "user_id": 9355983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0aTuh.jpg?s=128&g=1", "display_name": "Augusto Cesar", "link": "https://stackoverflow.com/users/9355983/augusto-cesar"}, "edited": false, "score": 0, "creation_date": 1518540550, "post_id": 48771578, "comment_id": 84544572, "body": "I&#39;ve updated the heroku log on questions. Didn&#39;t know about this command."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1518540579, "post_id": 48771578, "comment_id": 84544589, "body": "Specified &#39;postgresql&#39; for database adapter, but the gem is not loaded. Add <code>gem &#39;pg&#39;</code> to your Gemfile (and ensure its version is at the minimum required by ActiveRecord)."}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1518540764, "post_id": 48771578, "comment_id": 84544704, "body": "You could add the relevant parts of your <code>Gemfile</code> to your question, but the heroku error pretty much says it all."}, {"owner": {"reputation": 3, "user_id": 9355983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0aTuh.jpg?s=128&g=1", "display_name": "Augusto Cesar", "link": "https://stackoverflow.com/users/9355983/augusto-cesar"}, "edited": false, "score": 0, "creation_date": 1518541673, "post_id": 48771578, "comment_id": 84545340, "body": "The gem &#39;pg&#39; is already on Gemfile, I&#39;ve updated on questoin how it is declared"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518542288, "post_id": 48771578, "comment_id": 84545738, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48668466/error-pushing-ruby-on-rails-to-heroku\">Error pushing Ruby on Rails to heroku</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1518542212, "creation_date": 1518542212, "answer_id": 48772230, "question_id": 48771578, "link": "https://stackoverflow.com/questions/48771578/rails-application-showing-application-error-even-when-deployed/48772230#48772230", "title": "Rails application showing Application error even when deployed", "body": "<p>This has been asked often in the last months. Check my answer here: <a href=\"https://stackoverflow.com/a/48676606/3372172\">https://stackoverflow.com/a/48676606/3372172</a></p>\n\n<p>You must specify a specific pg version in your gemfile. If not, you will be using the latest available version (1.0.0). But this version is still not supported by Rails. Check here: <a href=\"https://github.com/rails/rails/issues/31673\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/31673</a></p>\n\n<p>Yous should use version 0.21</p>\n\n<pre><code>gem 'pg', '0.21'\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9355983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0aTuh.jpg?s=128&g=1", "display_name": "Augusto Cesar", "link": "https://stackoverflow.com/users/9355983/augusto-cesar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 48772230, "answer_count": 1, "score": -1, "last_activity_date": 1518542212, "creation_date": 1518540052, "last_edit_date": 1518541637, "question_id": 48771578, "link": "https://stackoverflow.com/questions/48771578/rails-application-showing-application-error-even-when-deployed", "title": "Rails application showing Application error even when deployed", "body": "<p>My Rails application code is on <a href=\"https://github.com/gutoslv/One-Month-Rails\" rel=\"nofollow noreferrer\">https://github.com/gutoslv/One-Month-Rails</a> . I deployed it to heroku without giving any error on log, but when I try to access it with the link <a href=\"https://omrails-gutoslv.herokuapp.com/\" rel=\"nofollow noreferrer\">https://omrails-gutoslv.herokuapp.com/</a>, I get the Application Error.</p>\n\n<p>Bundler is already updated, but I can't see where the error is.</p>\n\n<p>Logs are below:</p>\n\n<pre><code>    2018-02-13T16:21:34.536807+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=7b435235-1542-4356-b36c-e4c710f81548 fwd=\"179.228.208.76\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:21:54.921758+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=omrails-gutoslv.herokuapp.com request_id=e6ea5e62-eb18-4493-9069-bb603324082d fwd=\"179.228.208.76\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:29:18.453089+00:00 heroku[web.1]: State changed from crashed to starting\n2018-02-13T16:29:23.704854+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 47008 -e production`\n2018-02-13T16:29:29.534852+00:00 heroku[web.1]: State changed from starting to crashed\n2018-02-13T16:29:29.520513+00:00 heroku[web.1]: Process exited with status 1\n2018-02-13T16:29:29.401113+00:00 app[web.1]: /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/connection_adapters/connection_specification.rb:188:in `rescue in spec': Specified 'postgresql' for database adapter, but the gem is not loaded. Add `gem 'pg'` to your Gemfile (and ensure its version is at the minimum required by ActiveRecord). (Gem::LoadError)\n2018-02-13T16:29:29.401161+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/connection_adapters/connection_specification.rb:185:in `spec'\n2018-02-13T16:29:29.401203+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/connection_adapters/abstract/connection_pool.rb:880:in `establish_connection'\n2018-02-13T16:29:29.401236+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/connection_handling.rb:58:in `establish_connection'\n2018-02-13T16:29:29.401273+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:69:in `instance_eval'\n2018-02-13T16:29:29.401255+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/railtie.rb:124:in `block (2 levels) in &lt;class:Railtie&gt;'\n2018-02-13T16:29:29.401292+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:69:in `block in execute_hook'\n2018-02-13T16:29:29.401310+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:60:in `with_execution_control'\n2018-02-13T16:29:29.401329+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:65:in `execute_hook'\n2018-02-13T16:29:29.401347+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:50:in `block in run_load_hooks'\n2018-02-13T16:29:29.401375+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:49:in `each'\n2018-02-13T16:29:29.401401+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/lazy_load_hooks.rb:49:in `run_load_hooks'\n2018-02-13T16:29:29.401419+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/base.rb:326:in `&lt;module:ActiveRecord&gt;'\n2018-02-13T16:29:29.401441+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activerecord-5.1.4/lib/active_record/base.rb:25:in `&lt;top (required)&gt;'\n2018-02-13T16:29:29.401461+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `require'\n2018-02-13T16:29:29.401479+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `block in require'\n2018-02-13T16:29:29.401497+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:258:in `load_dependency'\n2018-02-13T16:29:29.401514+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `require'\n2018-02-13T16:29:29.401701+00:00 app[web.1]:    from /app/app/models/application_record.rb:1:in `&lt;top (required)&gt;'\n2018-02-13T16:29:29.401738+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `block in require'\n2018-02-13T16:29:29.401719+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `require'\n2018-02-13T16:29:29.401756+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:258:in `load_dependency'\n2018-02-13T16:29:29.401773+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:292:in `require'\n2018-02-13T16:29:29.401802+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:379:in `block in require_or_load'\n2018-02-13T16:29:29.401831+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:36:in `block in load_interlock'\n2018-02-13T16:29:29.401850+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies/interlock.rb:12:in `block in loading'\n2018-02-13T16:29:29.401868+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/concurrency/share_lock.rb:149:in `exclusive'\n2018-02-13T16:29:29.401886+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies/interlock.rb:11:in `loading'\n2018-02-13T16:29:29.401905+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:36:in `load_interlock'\n2018-02-13T16:29:29.401922+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:357:in `require_or_load'\n2018-02-13T16:29:29.401940+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:335:in `depend_on'\n2018-02-13T16:29:29.401958+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/activesupport-5.1.4/lib/active_support/dependencies.rb:251:in `require_dependency'\n2018-02-13T16:29:29.401999+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:476:in `block (2 levels) in eager_load!'\n2018-02-13T16:29:29.402017+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:475:in `each'\n2018-02-13T16:29:29.402170+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:475:in `block in eager_load!'\n2018-02-13T16:29:29.402188+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:473:in `each'\n2018-02-13T16:29:29.402206+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:473:in `eager_load!'\n2018-02-13T16:29:29.402223+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/engine.rb:354:in `eager_load!'\n2018-02-13T16:29:29.402240+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/application/finisher.rb:67:in `each'\n2018-02-13T16:29:29.402258+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/application/finisher.rb:67:in `block in &lt;module:Finisher&gt;'\n2018-02-13T16:29:29.402276+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:30:in `instance_exec'\n2018-02-13T16:29:29.402293+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:30:in `run'\n2018-02-13T16:29:29.402334+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:59:in `block in run_initializers'\n2018-02-13T16:29:29.402352+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each'\n2018-02-13T16:29:29.402369+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n2018-02-13T16:29:29.402387+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from'\n2018-02-13T16:29:29.402404+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component'\n2018-02-13T16:29:29.402421+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:347:in `each'\n2018-02-13T16:29:29.402439+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:347:in `call'\n2018-02-13T16:29:29.402457+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component'\n2018-02-13T16:29:29.402497+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each'\n2018-02-13T16:29:29.402515+00:00 app[web.1]:    from /app/vendor/ruby-2.3.6/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each'\n2018-02-13T16:29:29.402533+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/initializable.rb:58:in `run_initializers'\n2018-02-13T16:29:29.402550+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/application.rb:353:in `initialize!'\n2018-02-13T16:29:29.402569+00:00 app[web.1]:    from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2018-02-13T16:29:29.402590+00:00 app[web.1]:    from config.ru:3:in `require_relative'\n2018-02-13T16:29:29.402608+00:00 app[web.1]:    from config.ru:3:in `block in &lt;main&gt;'\n2018-02-13T16:29:29.402625+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/builder.rb:55:in `instance_eval'\n2018-02-13T16:29:29.402666+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/builder.rb:55:in `initialize'\n2018-02-13T16:29:29.402684+00:00 app[web.1]:    from config.ru:in `new'\n2018-02-13T16:29:29.402702+00:00 app[web.1]:    from config.ru:in `&lt;main&gt;'\n2018-02-13T16:29:29.402720+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/builder.rb:49:in `eval'\n2018-02-13T16:29:29.402737+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/builder.rb:49:in `new_from_string'\n2018-02-13T16:29:29.402754+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/builder.rb:40:in `parse_file'\n2018-02-13T16:29:29.402772+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/server.rb:319:in `build_app_and_options_from_config'\n2018-02-13T16:29:29.402789+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/server.rb:219:in `app'\n2018-02-13T16:29:29.402830+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands/server/server_command.rb:24:in `app'\n2018-02-13T16:29:29.402848+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/server.rb:354:in `wrapped_app'\n2018-02-13T16:29:29.402866+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/rack-2.0.4/lib/rack/server.rb:283:in `start'\n2018-02-13T16:29:29.402883+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands/server/server_command.rb:44:in `start'\n2018-02-13T16:29:29.402906+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands/server/server_command.rb:135:in `block in perform'\n2018-02-13T16:29:29.402924+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands/server/server_command.rb:130:in `tap'\n2018-02-13T16:29:29.402941+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands/server/server_command.rb:130:in `perform'\n2018-02-13T16:29:29.402959+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n2018-02-13T16:29:29.402996+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n2018-02-13T16:29:29.403014+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n2018-02-13T16:29:29.403167+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/command/base.rb:63:in `perform'\n2018-02-13T16:29:29.403185+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/command.rb:44:in `invoke'\n2018-02-13T16:29:29.403202+00:00 app[web.1]:    from /app/vendor/bundle/ruby/2.3.0/gems/railties-5.1.4/lib/rails/commands.rb:16:in `&lt;top (required)&gt;'\n2018-02-13T16:29:29.403221+00:00 app[web.1]:    from bin/rails:9:in `require'\n2018-02-13T16:29:29.403239+00:00 app[web.1]:    from bin/rails:9:in `&lt;main&gt;'\n2018-02-13T16:29:29.425694+00:00 app[web.1]: =&gt; Booting Puma\n2018-02-13T16:29:29.425698+00:00 app[web.1]: =&gt; Rails 5.1.4 application starting in production \n2018-02-13T16:29:29.425700+00:00 app[web.1]: =&gt; Run `rails server -h` for more startup options\n2018-02-13T16:29:29.425701+00:00 app[web.1]: Exiting\n2018-02-13T16:33:06.012895+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=f4e7f529-ef4a-40fc-ad87-44e5a0486091 fwd=\"187.32.207.129\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:33:06.743810+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=omrails-gutoslv.herokuapp.com request_id=5df1e475-e507-4095-84ff-9ec80b553faf fwd=\"187.32.207.129\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:34:58.358587+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=be7e3e6b-5228-4b86-97e0-8342e5bc5170 fwd=\"187.32.207.129\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:34:59.040317+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=omrails-gutoslv.herokuapp.com request_id=08308b3b-e2d5-46e7-9c49-3ae1578e1fd8 fwd=\"187.32.207.129\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:42:43.015852+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=dae71a5a-382f-4796-a3c3-fae77ce24e98 fwd=\"106.201.169.177\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:42:44.400235+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=omrails-gutoslv.herokuapp.com request_id=64f7b47c-3570-4a65-8000-cd9babd08e49 fwd=\"106.201.169.177\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:42:51.832070+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=d380ed94-419e-46c8-b5a9-87e070353205 fwd=\"76.14.9.11\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:42:51.969280+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/favicon.ico\" host=omrails-gutoslv.herokuapp.com request_id=daaafecf-af6d-451e-a2de-3ca2ea5780cf fwd=\"76.14.9.11\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:42:53.660496+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=GET path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=11ccd17e-3cad-4ce6-a6c1-c0162aa14d9a fwd=\"34.193.245.68\" dyno= connect= service= status=503 bytes= protocol=https\n2018-02-13T16:46:05.152712+00:00 heroku[router]: at=error code=H10 desc=\"App crashed\" method=HEAD path=\"/\" host=omrails-gutoslv.herokuapp.com request_id=7f751cc8-6190-4e10-8da1-c841c4967d37 fwd=\"34.235.121.206\" dyno= connect= service= status=503 bytes= protocol=https\n</code></pre>\n\n<p>The pg gem is declared under the group production on Gemfile like this</p>\n\n<pre><code>group :production do\n  gem 'pg'\nend\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 4, "creation_date": 1518540049, "post_id": 48771464, "comment_id": 84544210, "body": "Why don&#39;t you move <code>-</code> to the front (or back) of your character class or use <code>\\-</code> to avoid the warning in the first place?"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1518540517, "post_id": 48771464, "comment_id": 84544553, "body": "When you post a question, try to give  a minimum example that reproduces the issue. I simplified the regex."}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 0, "creation_date": 1518540711, "post_id": 48771464, "comment_id": 84544663, "body": "Try this: <code>[^\\w.-]</code>. Not sure if backslash before dot is to escape dot or include backslash into the class, but if you want to have backslash in the set as well use <code>[^\\w.\\\\-]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1518540993, "post_id": 48771464, "comment_id": 84544878, "body": "Amazing a language, ruby in this case, recognizes this particular dash <code>-</code> is not a range operator. It goes through all the trouble of telling you this in an exception, when it&#39;s obviously <i>non-ambiguous</i> and should be treated as a literal. They must think regex programmers are children."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 1, "creation_date": 1518542012, "post_id": 48771464, "comment_id": 84545572, "body": "@sln It&#39;s almost like it&#39;s really easy to accidentally type <code>az-0-9</code> instead of <code>a-z0-9</code> and rapid warning of potential issues is useful. Maybe that&#39;s just for us &quot;children&quot;, though -- an &quot;adult&quot; like yourself is doubtlessly perfect in every way and never makes little typos."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1518543376, "post_id": 48771464, "comment_id": 84546436, "body": "@NicHartley  - <code>z-0</code> is not a <i><b>range operator</b></i> error, it&#39;s a <i>range</i> error, which probably is a typo. But, in no-man&#39;s land, the place between entities, all is literal. By your logic, putting a <code>^</code> or a <code>[</code> in the middle of a class should be an error that the children should not do. Some engines became enlightened and let the range operator be a literal in no-mans land a long time ago. Perl and pcre for example."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1518547875, "post_id": 48771464, "comment_id": 84548763, "body": "@sln ...You realize Ruby does, too? That&#39;s why it&#39;s a <i>warning</i>, not an error. It&#39;s <i>warning</i> you that, hey, you might not have mean to do that, because that could really easily be a typo. And, since you don&#39;t seem to want to realize that a quick example doesn&#39;t need to be perfect to get the point across, fine. <code>09-a-z</code> is equally likely, wouldn&#39;t be caught by your check, and is still likely to be wrong. It&#39;s <i>possible</i> that it&#39;s right, but then the programmer would know that, and either ignore the warning or take it as a sign that they should make their code clearer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1518549984, "post_id": 48771464, "comment_id": 84549886, "body": "@NicHartley - You know, it&#39;s been nice talking to you. I don&#39;t think you can pick and choose what looks  <i>likely wrong</i> but passes <i>my</i> tests. The likelihood of this <code>[ [-\\xFF]</code> being wrong is higher, but it throws no warnings. I know how regex&#39;s are parse, and I can tell you if this <code>-</code> is between entities it has <i>no business</i> emitting any warning or error at all. The list is endless of what <i>may look suspicious</i> but lets get past <i>warning</i> the children, ok ?"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1518540324, "post_id": 48771634, "comment_id": 84544406, "body": "Not quite. Warning means that there is no syntactic problem (hence no ambiguity), but that the user might have intended something different from what it actually does."}], "tags": [], "owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1518540544, "last_edit_date": 1518540544, "creation_date": 1518540204, "answer_id": 48771634, "question_id": 48771464, "link": "https://stackoverflow.com/questions/48771464/silence-ruby-regular-expression-warning/48771634#48771634", "title": "Silence Ruby regular expression warning", "body": "<p>At this place <code>[^a-zA-Z0-9-_\\\\.]</code> there is a possibility of an error. Usage of '-' either means the new range(with mistyping) or just a symbol. Either move single characters in front of ranges or prefix with '\\'</p>\n"}, {"tags": [], "owner": {"reputation": 1104, "user_id": 3938081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ccf280616912c6edc9aa83f278686c?s=128&d=identicon&r=PG&f=1", "display_name": "dave_slash_null", "link": "https://stackoverflow.com/users/3938081/dave-slash-null"}, "is_accepted": false, "score": 0, "last_activity_date": 1518541065, "last_edit_date": 1518541065, "creation_date": 1518540536, "answer_id": 48771725, "question_id": 48771464, "link": "https://stackoverflow.com/questions/48771464/silence-ruby-regular-expression-warning/48771725#48771725", "title": "Silence Ruby regular expression warning", "body": "<p>Add a backslash (<code>\\</code>) to escape the lonely dash.  It appears the offending dash is immediately after <code>[^a-zA-Z0-9</code>. Add <code>\\-</code> instead of just the dash character <code>-</code>.  The full regex including the minor change is</p>\n\n<p><code>/[^a-zA-Z0-9\\-_\\\\.]/</code></p>\n\n<p>This will remove the warning. Escaping it with the backslash clearly instructs the regex engine that you mean to search for that character and not that you forgot to complete a range like <code>[a-z]</code></p>\n"}, {"comments": [{"owner": {"reputation": 1104, "user_id": 3938081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41ccf280616912c6edc9aa83f278686c?s=128&d=identicon&r=PG&f=1", "display_name": "dave_slash_null", "link": "https://stackoverflow.com/users/3938081/dave-slash-null"}, "edited": false, "score": 1, "creation_date": 1518540900, "post_id": 48771796, "comment_id": 84544799, "body": "Hmmm, not how I interpreted the question, but definitely directly addresses it.  Nice!"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1518540718, "creation_date": 1518540718, "answer_id": 48771796, "question_id": 48771464, "link": "https://stackoverflow.com/questions/48771464/silence-ruby-regular-expression-warning/48771796#48771796", "title": "Silence Ruby regular expression warning", "body": "<pre><code>verbosity = $VERBOSE\n$VERBOSE = nil\n/[^a-zA-Z0-9-_\\\\.]/ #=&gt; /[^a-zA-Z0-9-_\\\\.]/\n$VERBOSE = verbosity\n</code></pre>\n"}], "owner": {"reputation": 7073, "user_id": 1279844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d04dbd9bc38b19a88ae7cc28ed70a0d6?s=128&d=identicon&r=PG", "display_name": "bevanb", "link": "https://stackoverflow.com/users/1279844/bevanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1518541065, "creation_date": 1518539749, "last_edit_date": 1518540459, "question_id": 48771464, "link": "https://stackoverflow.com/questions/48771464/silence-ruby-regular-expression-warning", "title": "Silence Ruby regular expression warning", "body": "<p>I have a <code>-</code> in my regular expression. When I run it, I get <code>warning: character class has '-' without escape: /[^a-zA-Z0-9-_\\\\.]/</code></p>\n\n<p>How can I silence this warning?</p>\n"}, {"tags": ["ruby", "unit-testing", "command-line", "rspec", "keychain"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518543564, "post_id": 48770949, "comment_id": 84546548, "body": "<code>Fastlane::Actions.expects(:sh).with(&quot;security list-keychains&quot;, log: false).returns(&quot;~&#47;Library&#47;Keychains&#47;test.keychain user&#47;username&#47;Library&#47;Keychains&#47;test.keychain&quot;)</code> does this work?"}], "answers": [{"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 1, "last_activity_date": 1518545234, "creation_date": 1518545234, "answer_id": 48772981, "question_id": 48770949, "link": "https://stackoverflow.com/questions/48770949/stub-commandline-result-in-rspec/48772981#48772981", "title": "stub commandline result in rspec", "body": "<p>You can do:</p>\n\n<pre><code>keychains = double(\"keychains\")\nallow(keychains).to receive(:split).and_return([\"~/Library/Keychains/test.keychain\", \"user/username/Library/Keychains/test.keychain\"]\nallow(Fastlane::Actions).to receive(:sh).with(\"security list-keychains\", log: false)).and_return(keychains)\n</code></pre>\n"}], "owner": {"reputation": 4747, "user_id": 977466, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/h7yNy.jpg?s=128&g=1", "display_name": "u.gen", "link": "https://stackoverflow.com/users/977466/u-gen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 48772981, "answer_count": 1, "score": 1, "last_activity_date": 1518545234, "creation_date": 1518538044, "question_id": 48770949, "link": "https://stackoverflow.com/questions/48770949/stub-commandline-result-in-rspec", "title": "stub commandline result in rspec", "body": "<p>I have never used ruby and rspec before. </p>\n\n<p>I wrote a couple lines of code where the user can delete keychain from their macs. </p>\n\n<pre><code>    elsif params[:name]\n  # get default keychains list\n  default_path = Fastlane::Actions.sh(\"security list-keychains\", log: false).split\n\n  # iterate to find any of the items in the list matches with parameter name\n  does_keychain_exists = true\n  default_path.each do |path_to_keychain|\n    # sometimes keychain saved as name.keychain-db, check that case too\n    if path_to_keychain.include?(params[:name]) == true || path_to_keychain.include?(\"#{params[:name]}-db\") == true\n      keychain_path = FastlaneCore::Helper.keychain_path(params[:name])\n      if File.exist?(keychain_path)\n        complete_delete(original, keychain_path)\n      else\n        does_keychain_exists = false\n      end\n    else\n      does_keychain_exists = false\n    end\n  end\n</code></pre>\n\n<p>The code works fine, but I need to add unittest with rspec.</p>\n\n<p>How do I stub  <code>default_path = Fastlane::Actions.sh(\"security list-keychains\", log: false).split</code> so default_path variable gets something like</p>\n\n<p><code>~/Library/Keychains/test.keychain</code> or <code>user/username/Library/Keychains/test.keychain</code></p>\n\n<p>the unit test I am trying to edit is:</p>\n\n<pre><code>  describe Fastlane do\n  describe Fastlane::FastFile do\n    describe \"Delete keychain Integration\" do\n      before :each do\n        allow(File).to receive(:file?).and_return(false)\n      end\n\n      it \"works with keychain name found locally\" do\n        allow(FastlaneCore::FastlaneFolder).to receive(:path).and_return(nil)\n        keychain = File.expand_path('test.keychain')\n        allow(File).to receive(:file?).and_return(false)\n        allow(File).to receive(:file?).with(keychain).and_return(true)\n\n        result = Fastlane::FastFile.new.parse(\"lane :test do\n          delete_keychain ({\n            name: 'test.keychain',\n            throw_error:false\n          })\n        end\").runner.execute(:test)\n\n        expect(result).to eq(\"security delete-keychain #{keychain}\")\n      end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 1, "creation_date": 1518538570, "post_id": 48770681, "comment_id": 84543300, "body": "Is this the correct path in the form? <code>practice_quiz_practice_questions_path</code>"}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "edited": false, "score": 1, "creation_date": 1518538616, "post_id": 48770681, "comment_id": 84543330, "body": "can you post request params from server log? are you sure you have <code>practice_question</code> as a root parameter name in request?"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 1, "creation_date": 1518538744, "post_id": 48770681, "comment_id": 84543407, "body": "And post your new view - are you passing <code>@practice_question</code> into the form partial?"}, {"owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1518538863, "post_id": 48770681, "comment_id": 84543477, "body": "@gwalshington I read a guide that said to use the form_with url setting: <code>&lt;%= form_with(url: practice_quiz_practice_questions_path, local: true) do |form| %&gt;</code> -- This is what is in the form partial."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 1, "creation_date": 1518538942, "post_id": 48770681, "comment_id": 84543531, "body": "@mazing okay! It&#39;s a little unusual, but the error doesn&#39;t indicate that is the issue. Just wanted to make sure!  The error is saying that the variable <code>practice_questions</code> in the form is not defined."}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1518539388, "post_id": 48771309, "comment_id": 84543789, "body": "Doesn&#39;t the error indicate the issue is coming from the PraticeQuiz Load line?  It&#39;s followed by <code>Completed 400 Bad Request in 102ms (ActiveRecord: 1.7ms)</code>"}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1518539528, "post_id": 48771309, "comment_id": 84543883, "body": "the error indicates that <code>param is missing or the value is empty: practice_question</code>. Meaning there must be <code>practice_question</code> param sent to that action, but there isn&#39;t"}, {"owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "reply_to_user": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 2, "creation_date": 1518539756, "post_id": 48771309, "comment_id": 84544032, "body": "Ah, right @gwalshington. That only means that the last executed line of code that wrote something to log(in this case the last SQL request) was loading <code>PraticeQuiz</code>. But that doesn&#39;t mean the error has occurred right there."}], "tags": [], "owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "is_accepted": true, "score": 3, "last_activity_date": 1518539229, "creation_date": 1518539229, "answer_id": 48771309, "question_id": 48770681, "link": "https://stackoverflow.com/questions/48770681/rails-5-independent-view-nested-resource-param-is-missing-or-the-value-is-empt/48771309#48771309", "title": "Rails 5 Independent View Nested Resource - param is missing or the value is empty", "body": "<p>Here </p>\n\n<pre><code>def practice_question_params\n    params.require(:practice_question).permit(:question, :explanation, :flagged)\nend\n</code></pre>\n\n<p>you are using rails strong parameters. See this answer <a href=\"https://stackoverflow.com/a/30826895/2627121\">https://stackoverflow.com/a/30826895/2627121</a></p>\n\n<p>Basically, <code>params.require(:practice_question)</code> means that you must have <code>practice_question</code> parameter. \nHere\n<code>Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"\", \"question\"=&gt;\"235235\", \"explanation\"=&gt;\"25235232\", \"commit\"=&gt;\"Save \", \"practice_quiz_id\"=&gt;\"23535\"}</code>\nyou have <code>question</code> and <code>explanation</code> as root parameters, when according to your strong parameters declaration you must have\n<code>\"practice_question\" =&gt; { \"question\"=&gt;\"235235\", \"explanation\"=&gt;\"25235232\" }</code></p>\n\n<p>You should edit form fields to have name as <code>practice_question[question]</code></p>\n"}], "owner": {"reputation": 439, "user_id": 1380881, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c4346f78639e8ea7ac77046f0f2459cc?s=128&d=identicon&r=PG", "display_name": "mazing", "link": "https://stackoverflow.com/users/1380881/mazing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 48771309, "answer_count": 1, "score": 0, "last_activity_date": 1518539229, "creation_date": 1518537226, "last_edit_date": 1518538787, "question_id": 48770681, "link": "https://stackoverflow.com/questions/48770681/rails-5-independent-view-nested-resource-param-is-missing-or-the-value-is-empt", "title": "Rails 5 Independent View Nested Resource - param is missing or the value is empty", "body": "<p>I have a nested resource called PracticeQuestion, which is a child of PracticeQuiz. I want users to be able to go through one question at a time when they are at a PracticeQuiz. For example: <code>foo.com/practice_quizzes/1/practice_questions/1..n</code></p>\n\n<p>I got the practice quizzes working, but when I try to add a new practice question, I get a rails error that says that the param is missing or empty, but I don't see what i'm doing wrong. Please help</p>\n\n<p><strong>practice_quiz.rb</strong></p>\n\n<pre><code>class PracticeQuiz &lt; ApplicationRecord\n  belongs_to :user, optional: true\n  validates :user, presence: true\n  has_many :practice_questions, dependent: :destroy\nend\n</code></pre>\n\n<p><strong>practice_question.rb</strong></p>\n\n<pre><code>class PracticeQuestion &lt; ApplicationRecord\n  belongs_to :user, optional: true\n  belongs_to :practice_quiz\nend\n</code></pre>\n\n<p><strong>practice_questions_controller.rb</strong></p>\n\n<pre><code>class PracticeQuestionsController &lt; ApplicationController\n  before_action :set_practice_question, only: [:show, :edit, :update, :destroy]\n  def index\n    @practice_questions = PracticeQuestion.all\n  end\n\n  def show\n  end\n\n  # GET /practice_questions/new\n  def new\n    @practice_quiz = PracticeQuiz.friendly.find(params[:practice_quiz_id])\n    @practice_question = PracticeQuestion.new\n  end\n\n  # GET /practice_questions/1/edit\n  def edit\n  end\n\n\n  def create\n    @practice_quiz = PracticeQuiz.friendly.find(params[:practice_quiz_id])\n    @practice_question = PracticeQuestion.new(practice_question_params)\n\n    respond_to do |format|\n      if @practice_question.save\n        format.html { redirect_to @practice_question, notice: 'Practice question was successfully created.' }\n        format.json { render :show, status: :created, location: @practice_question }\n      else\n        format.html { render :new }\n        format.json { render json: @practice_question.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  private\n    def set_practice_question\n      @practice_question = PracticeQuestion.find(params[:id])\n    end\n\n    def practice_question_params\n        params.require(:practice_question).permit(:question, :explanation, :flagged)\n     end\n\n\nend\n</code></pre>\n\n<p><strong>views/practice_questions/_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_with(url: practice_quiz_practice_questions_path, local: true) do |form| %&gt;\n  &lt;% if practice_question.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(practice_question.errors.count, \"error\") %&gt; prohibited this practice_question from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% practice_question.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :question %&gt;\n    &lt;%= form.text_field :question %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= form.label :explanation %&gt;\n    &lt;%= form.text_field :explanation %&gt;\n  &lt;/div&gt;\n\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :practice_quizzes do \n    resources :practice_questions\n  end\n</code></pre>\n\n<p>I set the practice_questions controller's new method to find the id of the parent resource, but I get this error. I'm pretty sure I'm following rails naming conventions fine too.</p>\n\n<p><strong>ActionController::ParameterMissing at /practice_quizzes/23535/practice_questions\nparam is missing or the value is empty: practice_question</strong></p>\n\n<p>Update: here's the results from the rails server window</p>\n\n<pre><code>Processing by PracticeQuestionsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"7dpxBB7jjZWzicCYWGA8yeTPSc9UeaqNDOavKQai2vMISryPBiMZ9Zo4LLS3DgZQI8IJc7rLh2TXd9Fj8PAjiA==\", \"question\"=&gt;\"235235\", \"explanation\"=&gt;\"25235232\", \"commit\"=&gt;\"Save \", \"practice_quiz_id\"=&gt;\"23535\"}\n  User Load (0.8ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\n  PracticeQuiz Load (0.9ms)  SELECT  \"practice_quizzes\".* FROM \"practice_quizzes\" WHERE \"practice_quizzes\".\"slug\" = $1 ORDER BY \"practice_quizzes\".\"id\" ASC LIMIT $2  [[\"slug\", \"23535\"], [\"LIMIT\", 1]]\nCompleted 400 Bad Request in 102ms (ActiveRecord: 1.7ms)\n\nActionController::ParameterMissing - param is missing or the value is empty: practice_question:\n  app/controllers/practice_questions_controller.rb:76:in `practice_question_params'\n  app/controllers/practice_questions_controller.rb:30:in `create'\n</code></pre>\n\n<p>Update 2:</p>\n\n<p><strong>views/practice_questions/new.html.erb</strong></p>\n\n<pre><code>&lt;h1&gt;New Practice Question&lt;/h1&gt;\n&lt;%= render 'form', practice_question: @practice_question %&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518533446, "post_id": 48769246, "comment_id": 84539822, "body": "Problem is all my files are of that format only. That&#39;s where I&#39;m stuck and I&#39;m not sure how to get rid of the duplicate strings."}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518535948, "post_id": 48769246, "comment_id": 84541579, "body": "Simple and Elegant, thanks a lot !! Could yo kindly explain the <code>array.push(line.gsub(&#39;,&#39;, &#39;&#39;)) unless array.include? line.gsub(&#39;,&#39;, &#39;&#39;) or !line.include? &quot;org&quot;</code> as that would be helpful for a beginner like me. Thanks again"}, {"owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "reply_to_user": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 1, "creation_date": 1518536327, "post_id": 48769246, "comment_id": 84541822, "body": "Well, after I split the file, I got multiple lines like &quot;org\\lop09k,&quot; for exemple. So this part means that I want to push this line into the array only if it contains &quot;org&quot; and if it is not already inside this array. I do this removing the comma of course with the gsub function."}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518536523, "post_id": 48769246, "comment_id": 84541951, "body": "+1 for the clear explanation. just wondering why <code>!</code> before <code>!line.include? &quot;org&quot;</code> Does it have a specific purpose and why not <code>line.include? &quot;org&quot;</code>"}, {"owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "reply_to_user": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 1, "creation_date": 1518539891, "post_id": 48769246, "comment_id": 84544110, "body": "Yeah because I use <code>unless</code> not <code>if</code> , so I have to use the opposite expression <code>!line.include? &quot;org&quot;</code>.  Literally it means: push into array unless the line is already in the array or doesn&#39;t <code>(!)</code> contains substring &quot;org&quot;"}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518704497, "post_id": 48769246, "comment_id": 84622114, "body": "Great thanks a lot for your explanation  Out of context question, do you take any online training for RUby  or hold any blog of yours so that I can subscribe and pay if needed.   Im very new to Ruby and Programming and really interested to learn Ruby"}, {"owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "reply_to_user": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518710627, "post_id": 48769246, "comment_id": 84626333, "body": "I followed a little bit the Ruby formations of Grafikart <a href=\"https://www.grafikart.fr/formations/ruby\" rel=\"nofollow noreferrer\">link</a>. He is a French developer just like me who explains the basics of Ruby and Rails. For me the best way to learn is to find a project and jump in ! (learn on the job). You&#39;ll face a shit tons of problems and you&#39;ll find the solutions step by step and this is how you learn a language for me. For example, I started a project with Rails without totally mastering Ruby so I had to deal with a lot of problems and that has only strengthened my knowledge, actually I&#39;m surfing with Rails :D"}, {"owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518773358, "post_id": 48769246, "comment_id": 84650687, "body": "Really appreciate your help here, the link shared in in French . Does it have an English version? Many thanks again.."}, {"owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "reply_to_user": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "edited": false, "score": 0, "creation_date": 1518777573, "post_id": 48769246, "comment_id": 84653365, "body": "I don&#39;t think there is an english version of his formation :/ No problem have fun with Ruby !"}], "tags": [], "owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "is_accepted": true, "score": 1, "last_activity_date": 1518601838, "last_edit_date": 1518601838, "creation_date": 1518532602, "answer_id": 48769246, "question_id": 48768416, "link": "https://stackoverflow.com/questions/48768416/how-do-i-remove-duplicate-values-or-words-from-multiple-files-in-ruby/48769246#48769246", "title": "How do I remove duplicate values or words from multiple files in Ruby", "body": "<p>Well I've tried the last one <code>File.readlines(\"file.txt\").uniq</code> and it's working great with this kind of file:</p>\n\n<p>file.txt</p>\n\n<pre><code>org\\xcfte\norg\\hrxen\norg\\hrxen\norg\\kiopm7\norg\\0987hy\norg\\0987hy\norg\\lop09k\n</code></pre>\n\n<p>The work here is to parse your file correctly because doing <code>File.readlines(\"file.txt\").uniq</code> on this kind of file...</p>\n\n<pre><code>[active]\nrow = org\\xcfte, org\\0okilh\nspeed = org\\hrxen, org\\0okilh\ncol =  org\\0987hy\n</code></pre>\n\n<p>...will never print your expected output</p>\n\n<p><strong>Edit</strong> Here is a solution working for me</p>\n\n<pre><code>array = []\n\nfile = File.read('file')\nfile.split(' ').each do |line|\n    # I push the line if it is not already inside the array and if it contains the substring \"org\"\n    formated = line.gsub(',', '')\n    array.push(formated) unless array.include? formated or !line.include? \"org\"\nend\nputs array\n</code></pre>\n\n<p>Output for sample 1: </p>\n\n<pre><code>org\\xcfte\norg\\hrxen\norg\\kiopm7\norg\\0987hy\norg\\lop09k\n</code></pre>\n"}], "owner": {"reputation": 456, "user_id": 4902679, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4c798e668824f0209721b21bcb86ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Goku", "link": "https://stackoverflow.com/users/4902679/goku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 48769246, "answer_count": 1, "score": 1, "last_activity_date": 1518601838, "creation_date": 1518529940, "question_id": 48768416, "link": "https://stackoverflow.com/questions/48768416/how-do-i-remove-duplicate-values-or-words-from-multiple-files-in-ruby", "title": "How do I remove duplicate values or words from multiple files in Ruby", "body": "<p>I have multiple files in a directory and they have duplicate records. There can be more than one duplicate for the same value.</p>\n\n<p>sample.txt</p>\n\n<pre><code>#My first file created on Tuesday\n[active]\nrow = org\\xcfte, org\\hrxen\nspeed = org\\hrxen, org\\kiopm7, org\\0987hy\ncol = org\\lop09k, org\\0987hy\n</code></pre>\n\n<p>sample_2.txt</p>\n\n<pre><code>#My second file created on Wednesday\n[active]\nrow = org\\xcfte, org\\0okilh\nspeed = org\\hrxen, org\\0okilh\ncol =  org\\0987hy\n</code></pre>\n\n<p>and so on for multiple files</p>\n\n<p>Expected output </p>\n\n<pre><code>sample:\norg\\xcfte\norg\\hrxen\norg\\kiopm7\norg\\0987hy\norg\\lop09k\n\nsample_2:\norg\\xcfte\norg\\0okilh\norg\\hrxen\norg\\0987hy\n</code></pre>\n\n<p>from first file - org\\hrxen and org\\0987hy should appear only once and from the 2nd file 'org\\0okilh' should appear once.</p>\n\n<p>I tried </p>\n\n<pre><code>lines = File.read('/path/to/file')\nlines.split(\"\\n\").uniq.join(\"\\n\")\n</code></pre>\n\n<p>as well as</p>\n\n<pre><code>File.readlines(\"*.txt\").uniq\n</code></pre>\n\n<p>but duplicate entries are not removed</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest"], "comments": [{"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518529050, "post_id": 48767699, "comment_id": 84536640, "body": "Can you show the errors you get in both versions?"}, {"owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "reply_to_user": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518531297, "post_id": 48767699, "comment_id": 84538264, "body": "@Pablo Sure (pad)"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518531903, "post_id": 48768125, "comment_id": 84538699, "body": "<code>*args = nil</code> is not a valid synthax"}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "reply_to_user": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518553122, "post_id": 48768125, "comment_id": 84551494, "body": "Thanks @Mongoid, The splat doesn&#39;t allow defaults, re-edited"}, {"owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518557427, "post_id": 48768125, "comment_id": 84553631, "body": "[] (empty) array is still an argument"}], "tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1518552926, "last_edit_date": 1518552926, "creation_date": 1518529112, "answer_id": 48768125, "question_id": 48767699, "link": "https://stackoverflow.com/questions/48767699/creating-a-rest-service-client/48768125#48768125", "title": "Creating a REST service client", "body": "<p>you can send params to <code>send</code> with `send(method_name, *args) </p>\n\n<p><strong>or</strong></p>\n\n<p>Defining the Service like this:</p>\n\n<pre><code>class MyService\n  attr_reader :method_name, :args\n\n  def initialize(options = {})\n    # extract attributes\n    method_name = options[:method_name] || default_value\n    args = options[:args] || []\n  end\n\n  def call\n    send(method_name, *args)\n  end\nend\n</code></pre>\n\n<p>and call the service\n    <code>MyService.new(method_name: 'useful_method', args: [staff]).call</code></p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518531764, "post_id": 48768136, "comment_id": 84538605, "body": "hi @Muntasim that&#39;s not it. I get that same error, thanks"}, {"owner": {"reputation": 6361, "user_id": 540887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0c05d5d965d23a7a37de023f48ba51aa?s=128&d=identicon&r=PG", "display_name": "Muntasim", "link": "https://stackoverflow.com/users/540887/muntasim"}, "reply_to_user": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518535135, "post_id": 48768136, "comment_id": 84541049, "body": "I&#39;ve edited the answer with <code>*args</code> as the  argument to the <code>useful_method </code> method."}, {"owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "edited": false, "score": 0, "creation_date": 1518540668, "post_id": 48768136, "comment_id": 84544639, "body": "adding args to the method that does not need it, is a really redundant move"}], "tags": [], "owner": {"reputation": 6361, "user_id": 540887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0c05d5d965d23a7a37de023f48ba51aa?s=128&d=identicon&r=PG", "display_name": "Muntasim", "link": "https://stackoverflow.com/users/540887/muntasim"}, "is_accepted": false, "score": 0, "last_activity_date": 1518535063, "last_edit_date": 1518535063, "creation_date": 1518529140, "answer_id": 48768136, "question_id": 48767699, "link": "https://stackoverflow.com/questions/48767699/creating-a-rest-service-client/48768136#48768136", "title": "Creating a REST service client", "body": "<p>You are trying to call some instance methods from class (static) method. \nYou need call <code>send</code> to the instance of the class. This should work:</p>\n\n<pre><code>class MyService\n  def self.call(method_name, *args)\n    new.send(method_name, args)\n  end\n\n  def useful_method(*args)\n    'id, name'\n  end\n\n  # some methods below\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 554, "user_id": 2627121, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19db1b0378deb105b44f7319fa60d1b7?s=128&d=identicon&r=PG", "display_name": "Leaf", "link": "https://stackoverflow.com/users/2627121/leaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1518537990, "creation_date": 1518537990, "answer_id": 48770928, "question_id": 48767699, "link": "https://stackoverflow.com/questions/48767699/creating-a-rest-service-client/48770928#48770928", "title": "Creating a REST service client", "body": "<p>How about </p>\n\n<pre><code>class MyService\n  def self.call(*args)\n    send(*args)\n  end\n\n  class &lt;&lt; self\n    private \n    def useful_method\n      'id, name'\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 8070825, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/69004026ff28a9a881b636c81ae38d82?s=128&d=identicon&r=PG&f=1", "display_name": "Mongoid", "link": "https://stackoverflow.com/users/8070825/mongoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 48770928, "answer_count": 3, "score": 0, "last_activity_date": 1518552926, "creation_date": 1518527699, "last_edit_date": 1592644375, "question_id": 48767699, "link": "https://stackoverflow.com/questions/48767699/creating-a-rest-service-client", "title": "Creating a REST service client", "body": "<p>I m trying to create a rest service client as a service. Here is my service:</p>\n<h1>version 1</h1>\n<pre><code>class MyService\n  def self.call(method_name, *args)\n    send(method_name, args)\n  end\n  \n  def useful_method\n    'id, name'\n  end\n\n  # some methods below\nend\n</code></pre>\n<p>This does not work when I try to invoke methods without any arguments. For example, this:</p>\n<pre><code>MyService.call(:useful_method)\n</code></pre>\n<p>fails because <code>useful_method</code> does not expect arguments. Most of my methods have arguments, so this will work in most cases.</p>\n<p>I tried this version as well:</p>\n<h1>version 2</h1>\n<pre><code>class MyService\n  def self.call(*args)\n    send(args)\n  end\n  \n  def useful_method\n    'id, name'\n  end\n\n  # some methods below\nend\n</code></pre>\n<p>But this does not seem to work for any method with or without arguments.</p>\n<p>How can I create something like this that passes <code>method_name</code> followed by arguments or no arguments depending on whether the method has arguments?</p>\n<p>I think I've seen this <a href=\"http://www.rubydoc.info/docs/rails/4.0.0/AbstractController/Callbacks#process_action-instance_method\" rel=\"nofollow noreferrer\">here</a>, but I can't find the source for this.</p>\n<h1>Question update</h1>\n<p>Here is the version 1 error I got :</p>\n<pre><code>irb(main):001:0&gt; MyService.call(:useful_method)\nArgumentError: wrong number of arguments (given 1, expected 0)\n</code></pre>\n<p>Here is the version 2 error I got :</p>\n<pre><code>irb(main):001:0&gt; MyService.call(:useful_method)\nTypeError: [:useful_method] is not a symbol nor a string\n</code></pre>\n"}, {"tags": ["php", "ruby", "ssh"], "comments": [{"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 2, "creation_date": 1518528547, "post_id": 48767295, "comment_id": 84536250, "body": "1) Have you tried from within Ruby doing <code>`ssh host password command`</code>? This might help narrow down the problem.  2) I recommend removing the <code>ssh.close</code> command; the ssh session will be closed automatically when the block terminates. (File.open with a block works this way too.)  3) You may need to use <code>Shellwords.escape</code> on any strings you pass to a shell.  4) You should not need the <code>require &#39;rubygems&#39;</code>.  5) Are you absolutely sure that both cases (the success and the failure) are running on the same host?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1518529391, "post_id": 48767295, "comment_id": 84536910, "body": "With regards to (1) above, the problem may be to do with the environment in which SSH is running the command. Where is the PHP executable on the host machine? Is that folder in the <code>$PATH</code> when you ssh to the machine?"}, {"owner": {"reputation": 1, "user_id": 9354886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5a0a24df0d696d68398281e32e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ne", "link": "https://stackoverflow.com/users/9354886/d-ne"}, "reply_to_user": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "edited": false, "score": 0, "creation_date": 1518533430, "post_id": 48767295, "comment_id": 84539805, "body": "@KeithBennett 1) I am not sure what you&#39;re meaning. I am just learning Ruby, but I have some experience with Javascript and PHP. 2) Okay, ssh.close is removed. 3) I tried Shellwords.escape but it returns zsh:1: no such file or directory: ... 4) Thanks, removed too 5) Yes, absolutely. I copy and pasted the command and it runs."}, {"owner": {"reputation": 1, "user_id": 9354886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5a0a24df0d696d68398281e32e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ne", "link": "https://stackoverflow.com/users/9354886/d-ne"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518533436, "post_id": 48767295, "comment_id": 84539816, "body": "@TomLord Can you specify what you&#39;re meaning exactly? Like I stated above, the snippet is running. The shortened version in the code example is pointing actually to ~/.php/abc.phar in the real file."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518534238, "post_id": 48767295, "comment_id": 84540409, "body": "@D.Ne When you execute <code>php</code> on the command line, what executable is that actually running? Try: <code>which php</code>, too see. Now, run: <code>echo $PATH</code>, you should also see that folder in which the <code>php</code> executable lives. Now, try doing to above via the ruby script. What&#39;s the difference?"}, {"owner": {"reputation": 1, "user_id": 9354886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5a0a24df0d696d68398281e32e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ne", "link": "https://stackoverflow.com/users/9354886/d-ne"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518535010, "post_id": 48767295, "comment_id": 84540976, "body": "@TomLord SSH: &quot;which php&quot; returns &quot;php: aliased to /usr/local/bin/php5-56LATEST-CLI&quot; and echo $PATH returns &quot;/usr/local/bin:/usr/bin:/bin:/opt/bin:/usr/i686-pc-linux-gn&zwnj;&#8203;u/gcc-bin/5.4.0:/usr&zwnj;&#8203;/local/bin:/director&zwnj;&#8203;y/8239293/bin&quot;.  Via Ruby &quot;wich php&quot; is returning &quot;php not found&quot; and echo $PATH is returning &quot;/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Users/user/.r&zwnj;&#8203;vm/bin&quot;  But why can I connect via ruby and can execute commands like &quot;ls&quot;? Simple commands like that is working. PHP not."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518536285, "post_id": 48767295, "comment_id": 84541792, "body": "There you go, you&#39;ve found the cause: &quot;php: <b>aliased</b> to...&quot; --- When you log into the server, you&#39;re somewhere setting an <b>alias</b> for PHP. Possibly in the <code>~&#47;.bashrc</code>? However it&#39;s been implemented, this alias isn&#39;t getting triggered when you connect via SSH in ruby."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518536443, "post_id": 48767295, "comment_id": 84541893, "body": "To prove the point, if you run <code>php5-56LATEST-CLI abc.phar do_this</code> in the ruby script it will work. But a better solution would either be to (somehow?) trigger loading that same alias, or even replace the alias with something more concrete, e.g. a symbolic link. I don&#39;t know how you&#39;ve installed PHP, so can&#39;t really advise on best practice there...."}, {"owner": {"reputation": 1, "user_id": 9354886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5a0a24df0d696d68398281e32e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ne", "link": "https://stackoverflow.com/users/9354886/d-ne"}, "edited": false, "score": 0, "creation_date": 1518538185, "post_id": 48767295, "comment_id": 84543054, "body": "Thank you for your help. It&#39;s working. But: I never installed php on this shared hosting server. &#39;cd ruby &amp;&amp; /usr/local/bin/php5-56LATEST-CLI ~/.php/abc.phar do_this&#39; is indeed working. I am curious while the path is missing it is working inside SSH but with Ruby it needs to be specified."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518596171, "post_id": 48767295, "comment_id": 84566176, "body": "It&#39;s not really a ruby issue; it&#39;s because you&#39;re connecting without a login shell (i.e. Loading in a different environment, like I originally said)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518602325, "post_id": 48767295, "comment_id": 84569908, "body": "For example, <a href=\"https://github.com/mitchellh/net-ssh-shell\" rel=\"nofollow noreferrer\">here</a> is a ruby gem that connects <i>via a login shell</i>. But it would be better if you could somehow change the host machine to eliminate the need for this in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": false, "score": 1, "last_activity_date": 1518541057, "creation_date": 1518541057, "answer_id": 48771887, "question_id": 48767295, "link": "https://stackoverflow.com/questions/48767295/ruby-execute-php-commands-via-ssh/48771887#48771887", "title": "Ruby: Execute php commands via SSH", "body": "<p>I think the problem is not with Ruby per se, but probably with any language's SSH implementation. When using the language's ssh support to create an ssh session, it does not create a <em>login shell</em> (which would read initialization files such as <code>.bashrc</code>), but rather, a lower level interface to the machine.</p>\n\n<p>Therefore, some functionality you would expect from normal shell use will be missing when connecting with Ruby's <code>Net::SSH</code>.</p>\n\n<p>I was thinking there may be a way to get around this by calling <code>bash -l -c \"[the commands]\"</code>, to force a login shell with <code>bash</code>'s <code>-l</code> flag, and <code>-c</code> command specifier, but could not get it to work.</p>\n\n<p>I did find this other SO issue whose answer discusses an awkward workaround that probably is not worth trying: <a href=\"https://stackoverflow.com/questions/5051782/ruby-net-ssh-login-shell\">ruby net-ssh login shell</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9354886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5a0a24df0d696d68398281e32e7d3?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ne", "link": "https://stackoverflow.com/users/9354886/d-ne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518541057, "creation_date": 1518526327, "last_edit_date": 1518529996, "question_id": 48767295, "link": "https://stackoverflow.com/questions/48767295/ruby-execute-php-commands-via-ssh", "title": "Ruby: Execute php commands via SSH", "body": "<p>I am trying to run a PHP script inside the ruby shell. While it is working perfectly if I am using the snippet directly in the ssh terminal, it is returning an error if executed with ruby:</p>\n\n<pre><code>zsh:1: command not found: php\n</code></pre>\n\n<p>Using this script below with commands like <code>ls</code> is working fine.</p>\n\n<pre><code>require 'rubygems'\nrequire 'net/ssh'\n\nhost = \"abc.de\"\nuser = \"user_xy\"\npass = \"user_pass\"\n\nbegin\n    Net::SSH.start(host, user, :password =&gt; pass) do |ssh|\n        $a = ssh.exec! \"cd xy_dir &amp;&amp; php abc.phar do_this\"\n        ssh.close\n        puts $a     \nend\nrescue \n    puts \"Unable to connect to #{host}.\"\nend\n</code></pre>\n\n<p>How can I run PHP using <code>Net::SSH</code>?</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["ruby", "yaml", "selenium-chromedriver", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1518529902, "post_id": 48767088, "comment_id": 84537282, "body": "Can you describe what you are trying to achieve? Are you trying to save a browser instance that can be restarted later? I don&#39;t think that Watir/Selenium have that capability."}, {"owner": {"reputation": 11, "user_id": 9354898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/addf7911e3b9c8c4851669e091b8f690?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/9354898/jack"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1518531907, "post_id": 48767088, "comment_id": 84538703, "body": "Lets imagine I run script and this script brind me source save object and source and exit. Tomorrow. I want to rerite script and add some code to this script, I try to load session object and continue my work."}, {"owner": {"reputation": 11, "user_id": 9354898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/addf7911e3b9c8c4851669e091b8f690?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/9354898/jack"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1518531970, "post_id": 48767088, "comment_id": 84538755, "body": "Or imagine that watir in compiled file, it run once, save content save object, next time you will run this binary it will load session and object."}], "owner": {"reputation": 11, "user_id": 9354898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/addf7911e3b9c8c4851669e091b8f690?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/9354898/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1518530308, "creation_date": 1518525701, "last_edit_date": 1518530308, "question_id": 48767088, "link": "https://stackoverflow.com/questions/48767088/watir-save-and-load-object", "title": "WATIR save and load object", "body": "<pre><code>browser = Watir::Browser.new :chrome\nbrowser = Watir::Browser.start @url = query\n\nyml = YAML.dump(browser)\nFile.open(\"watir.obj\", 'w') { |file| file.write(yml) }\n\n#object saved ok!\n\n#BUT PROBLEM HERE \npp browser = YAML::load_file(\"watir.obj\")\nputs browser.html\n\n\npp will return #&lt;Watir::Browser:0x32ef165a7e2a48ce closed=true&gt; &lt;&lt;&lt; CLOSED\n</code></pre>\n\n<p>if I try to second part of script - I will get error:</p>\n\n<pre><code>/Users/lir/.rvm/rubies/ruby-2.4.1/lib/ruby/2.4.0/net/http.rb:906:in `rescue in block in connect': Failed to open TCP connection to 127.0.0.1:9515 (Connection refused - connect(2) for \"127.0.0.1\" port 9515) (Errno::ECONNREFUSED)\n</code></pre>\n\n<p>It looks like watir cant connect to chromedriver. Yes?</p>\n"}, {"tags": ["ruby", "activerecord", "sinatra", "haml"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "edited": false, "score": 0, "creation_date": 1518527887, "post_id": 48767618, "comment_id": 84535833, "body": "I do believe so. I added the full block in the views file. Could it be the local variable is @contacts and not @contact?"}], "tags": [], "owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518527404, "creation_date": 1518527404, "answer_id": 48767618, "question_id": 48767063, "link": "https://stackoverflow.com/questions/48767063/delete-record-in-sinatra/48767618#48767618", "title": "Delete Record in Sinatra", "body": "<p>Your error indicates that your local variable <code>@contact</code> is nil when you're attempting to render the form.</p>\n\n<pre><code>:action =&gt; \"/contacts/#{@contact.id}\"\n</code></pre>\n\n<p>are you actually passing the contact object to the contex when you are rendering this view?</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 8086571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hF7EH.png?s=128&g=1", "display_name": "Makushimaru", "link": "https://stackoverflow.com/users/8086571/makushimaru"}, "is_accepted": true, "score": 0, "last_activity_date": 1518529955, "last_edit_date": 1518529955, "creation_date": 1518529397, "answer_id": 48768229, "question_id": 48767063, "link": "https://stackoverflow.com/questions/48767063/delete-record-in-sinatra/48768229#48768229", "title": "Delete Record in Sinatra", "body": "<p>The problem is that you give \n<code>@contact.id</code> in <code>:action =&gt; \"/contacts/#{@contact.id}\"</code> which doesn't exist. </p>\n\n<p>In fact you have <code>@contacts</code> which contains all your contacts and <code>contact</code> which is a single contact. It's normal that <code>@contact</code> is nil</p>\n\n<p>Just replace it by <code>:action =&gt; \"/contacts/#{contact.id}\"</code> </p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "edited": false, "score": 1, "creation_date": 1518608859, "post_id": 48771082, "comment_id": 84574238, "body": "This is a concise breakdown of the core issue. Thank you for this, it helps me understand passing the instance variable better. swapping @contact.id to contant.id did the trick."}], "tags": [], "owner": {"reputation": 135, "user_id": 6876334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8341424e7a8cd10fcc639ecce2468359?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Galloway", "link": "https://stackoverflow.com/users/6876334/matthew-galloway"}, "is_accepted": false, "score": 0, "last_activity_date": 1518538447, "creation_date": 1518538447, "answer_id": 48771082, "question_id": 48767063, "link": "https://stackoverflow.com/questions/48767063/delete-record-in-sinatra/48771082#48771082", "title": "Delete Record in Sinatra", "body": "<p>If you check the error message, the error is not with how you wrote your <code>delete</code> action. Your <code>delete</code> action looks to be okay as it is. The error is in the view file corresponding to your <code>index</code> action.</p>\n\n<p>In the <code>index</code> action you likely did something along the lines of: <code>@contacts = Contact.all</code> which sets the instance variable <code>@contacts</code> to a collection of contacts. </p>\n\n<p>When you get to <code>- @contacts.each do |contact|</code> in your view, you are iterating over each element in the collection of contacts and defining a local variable called <code>contact</code> each time the block is run. This is what you should be referencing here <code>:action =&gt; \"/contacts/#{@contact.id}\"</code> instead of <code>@contact</code>. </p>\n\n<p>What is happening is you are attempting to build a form that points to a delete action for each element in <code>@contacts</code>, but you are not actually referencing the contacts themselves, as <code>@contact</code> is an instance variable that has never been set. <code>@contact</code> is only set once you actually make a request that gets routed to the <code>delete</code> action.</p>\n"}], "owner": {"reputation": 111, "user_id": 8511715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3vGII.jpg?s=128&g=1", "display_name": "nbkkb7x", "link": "https://stackoverflow.com/users/8511715/nbkkb7x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 48768229, "answer_count": 3, "score": 1, "last_activity_date": 1518538447, "creation_date": 1518525632, "last_edit_date": 1518527825, "question_id": 48767063, "link": "https://stackoverflow.com/questions/48767063/delete-record-in-sinatra", "title": "Delete Record in Sinatra", "body": "<p>I am having some trouble implementing a Delete route into Sinatra with Active Record. Here are the code details</p>\n\n<p>Route</p>\n\n<pre><code>delete '/contacts/:id' do\n  @contact = Contact.find_by_id(params[:id])\n  if @contact\n   @contact.destroy\n else\n   halt 404, \"Contact not found\"\n end\n</code></pre>\n\n<p>View</p>\n\n<pre><code>%table.u-full-width\n        %thead\n          %tr\n            %th Name\n            %th Phone Number\n            %th\n        %tbody\n          - @contacts.each do |contact|\n            %tr\n              %td= contact.name\n              %td= contact.phone_number\n              %td{}\n                %form{:style =&gt; \"margin: .75rem auto auto .25rem\", :action =&gt; \"/contacts/#{@contact.id}\", :method =&gt; \"post\"}\n                  %input{:name =&gt; \"_method\", :type =&gt; \"hidden\", :value =&gt; \"DELETE\"}/\n                  %input.button#button-delete{:type =&gt; \"submit\", :value =&gt; \"Delete\"}/\n</code></pre>\n\n<p>Stack Error</p>\n\n<blockquote>\n  <p>NoMethodError at /contacts undefined method `id' for nil:NilClass\n  file: contacts.haml \n  location: block (2 levels) in singleton class \n  line: 55</p>\n</blockquote>\n\n<p>Is the :id not passing in my views? Do I need to list contact.id in my table for it to pick up? Any help or documentation would be great. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "google-bigquery"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3651526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54de5950d6c7131fd4f228d0c515eaa?s=128&d=identicon&r=PG&f=1", "display_name": "SaiBharath", "link": "https://stackoverflow.com/users/3651526/saibharath"}, "edited": false, "score": 0, "creation_date": 1518585561, "post_id": 48768685, "comment_id": 84561820, "body": "Thank you for responding Mikhail Berlyant.  I have tried that API through API explorer and I got the following Response. {   &quot;error&quot;: {     &quot;code&quot;: 400,     &quot;message&quot;: &quot;Cannot list a table of type VIEW.&quot;,     &quot;errors&quot;: [       {         &quot;message&quot;: &quot;Cannot list a table of type VIEW.&quot;,         &quot;domain&quot;: &quot;global&quot;,         &quot;reason&quot;: &quot;invalid&quot;       }     ],     &quot;status&quot;: &quot;INVALID_ARGUMENT&quot;   } }  can you please share me if you have any code sample to do this and also what will be the default PageToken Parameter value"}, {"owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "reply_to_user": {"reputation": 23, "user_id": 3651526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54de5950d6c7131fd4f228d0c515eaa?s=128&d=identicon&r=PG&f=1", "display_name": "SaiBharath", "link": "https://stackoverflow.com/users/3651526/saibharath"}, "edited": false, "score": 0, "creation_date": 1518605918, "post_id": 48768685, "comment_id": 84572336, "body": "You can list data from table only, not from view :o("}, {"owner": {"reputation": 23, "user_id": 3651526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54de5950d6c7131fd4f228d0c515eaa?s=128&d=identicon&r=PG&f=1", "display_name": "SaiBharath", "link": "https://stackoverflow.com/users/3651526/saibharath"}, "edited": false, "score": 0, "creation_date": 1518673984, "post_id": 48768685, "comment_id": 84604072, "body": "yeah, I will do in that way Mikhail Berlyant. Thank you."}], "tags": [], "owner": {"reputation": 115571, "user_id": 5221944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iqXab.png?s=128&g=1", "display_name": "Mikhail Berlyant", "link": "https://stackoverflow.com/users/5221944/mikhail-berlyant"}, "is_accepted": false, "score": 3, "last_activity_date": 1518530739, "creation_date": 1518530739, "answer_id": 48768685, "question_id": 48766451, "link": "https://stackoverflow.com/questions/48766451/how-to-get-data-from-a-view-tablewhich-has-resource-full-from-google-bigquery/48768685#48768685", "title": "how to get data from a view table(which has resource_full) from Google bigquery(google-cloud-ruby gem)", "body": "<p>Instead of querying whole table - you should use <a href=\"https://cloud.google.com/bigquery/docs/reference/rest/v2/tabledata/list\" rel=\"nofollow noreferrer\"><code>Tabledata: list</code></a> API (or respective method in client of your choice)</p>\n\n<p>Using List is free and also comes with paging so you can get whole table data page by page </p>\n"}], "owner": {"reputation": 23, "user_id": 3651526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54de5950d6c7131fd4f228d0c515eaa?s=128&d=identicon&r=PG&f=1", "display_name": "SaiBharath", "link": "https://stackoverflow.com/users/3651526/saibharath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1518530739, "creation_date": 1518523529, "last_edit_date": 1518529959, "question_id": 48766451, "link": "https://stackoverflow.com/questions/48766451/how-to-get-data-from-a-view-tablewhich-has-resource-full-from-google-bigquery", "title": "how to get data from a view table(which has resource_full) from Google bigquery(google-cloud-ruby gem)", "body": "<p>I am working on Sinatra,ruby Application.</p>\n\n<p>I need to get data from one view table which is in Google-BigQuery and I am using google-cloud-bigquery gem in my Application.</p>\n\n<p>here is how am Querying the google-bigquery(ruby code)</p>\n\n<pre><code>bigquery = Google::Cloud::Bigquery.new(&lt;necessary credentials for the application&gt;)\nquery = \"select * from `dataset.table_name`  limit 10\"\nbigquery.query query  =&gt; #(this query will give me the exact output)\n</code></pre>\n\n<p>but, when I am querying without limit, like following</p>\n\n<pre><code>query = \"select * from `dataset.table_name`\"\nbigquery.query query\n</code></pre>\n\n<p>I will get this kind of response.</p>\n\n<pre><code>Google::Cloud::InvalidArgumentError (resourcesExceeded: Resources exceeded during query execution: The query could not be executed)\n</code></pre>\n\n<p>so, here in this case how can I handle it. as, I need to get all the data from that table I shouldn't give any limit.</p>\n"}, {"tags": ["ruby", "regex", "string"], "comments": [{"owner": {"reputation": 66, "user_id": 7416987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hg1mL.jpg?s=128&g=1", "display_name": "valtlai", "link": "https://stackoverflow.com/users/7416987/valtlai"}, "edited": false, "score": 2, "creation_date": 1518522250, "post_id": 48765945, "comment_id": 84532238, "body": "Would <code>&#47;:|(?&lt;=\\d)\\s&#47;</code> work?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1518522266, "post_id": 48765945, "comment_id": 84532250, "body": "<code>string.split(&#47;:|\\s(?=.+:)&#47;) #=&gt; [&quot;roll&quot;, &quot;34&quot;, &quot;name&quot;, &quot;joshi ikera&quot;]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1518526522, "creation_date": 1518526522, "answer_id": 48767366, "question_id": 48765945, "link": "https://stackoverflow.com/questions/48765945/split-a-string-by-or-a-space-after-a-numerical-digit/48767366#48767366", "title": "Split a string by &#39;&quot;:&quot;&#39; or a space after a numerical digit", "body": "<p>The <code>\\d\\s</code> matches and consumes the digit before a whitespace, and the consumed text is deleted by the <code>Regexp#split()</code> method. You need to use a lookaround, a lookbehind in this case, to make it a non-consuming pattern part, <code>/:|(?&lt;=\\d)\\s/</code> (see <a href=\"https://stackoverflow.com/questions/48765945/what-regexp-rule-can-be-used-to-split-a-string-using-delimiters-and-space-af#comment84532238_48765945\">valtlai's comment</a>). However, a more common approach in this scenario is to match 1 or more whitespace chars that are followed with 1+ word chars (if keys can only contain digits, letters and underscores) followed with <code>:</code> (see <a href=\"https://stackoverflow.com/questions/48765945/what-regexp-rule-can-be-used-to-split-a-string-using-delimiters-and-space-af#comment84532250_48765945\">Sagar's comment</a>).</p>\n\n<p>I suggest </p>\n\n<pre><code>s.split(/\\s+(?=\\w+:)|:/)\n# =&gt; roll\n34\nname\njoshi ikera\n</code></pre>\n\n<p>Here, </p>\n\n<ul>\n<li><code>\\s+</code> - consumes 1+ whitespace chars</li>\n<li><code>(?=\\w+:)</code> - that are followed with 1+ word chars and <code>:</code></li>\n<li><code>|</code> - or</li>\n<li><code>:</code> - match and consume <code>:</code>.</li>\n</ul>\n\n<p>Or, if the keys are unique</p>\n\n<pre><code>s.scan(/(\\w+):(.*?)(?=\\w+:|\\z)/).to_h\n# =&gt; {\"roll\"=&gt;\"34 \", \"name\"=&gt;\"joshi ikera\"}\n</code></pre>\n\n<p>Here,</p>\n\n<ul>\n<li><code>(\\w+)</code> - 1 or more word chars are captured into Group 1</li>\n<li><code>:</code> - a colon is matched</li>\n<li><code>(.*?)</code> - any 0+ chars other than line break chars are captured into Group 2 if immediately followed with</li>\n<li><code>(?=\\w+:|\\z)</code> - either 1+ word chars and then <code>:</code> (<code>\\w+:</code>) or (<code>|</code>) end of string (<code>\\z</code>).</li>\n</ul>\n"}], "owner": {"reputation": 351, "user_id": 493609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/eNFie.jpg?s=128&g=1", "display_name": "Anand Joshi", "link": "https://stackoverflow.com/users/493609/anand-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 48767366, "answer_count": 1, "score": 0, "last_activity_date": 1518526660, "creation_date": 1518521896, "last_edit_date": 1518526660, "question_id": 48765945, "link": "https://stackoverflow.com/questions/48765945/split-a-string-by-or-a-space-after-a-numerical-digit", "title": "Split a string by &#39;&quot;:&quot;&#39; or a space after a numerical digit", "body": "<p>I have a string like:</p>\n\n<pre><code>string = \"roll:34 name:joshi ikera\"\n</code></pre>\n\n<p>I want to split this string by the delimiting <code>:</code> and the space between the roll value and the name key. The output should look like this:</p>\n\n<pre><code>[roll, 34, name, joshi ikera]\n</code></pre>\n\n<p>I tried using:</p>\n\n<pre><code>string.split(/:|\\d\\s/)\n</code></pre>\n\n<p>but the output that I get is:</p>\n\n<pre><code>[roll, 3, name, joshi ikera]\n</code></pre>\n\n<p>How do I include the missing digit and just split by the space after the digit?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "datetime"], "comments": [{"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1518521880, "post_id": 48765856, "comment_id": 84532046, "body": "You should do like this <code>Model.group(&quot;DATE_TRUNC(&#39;day&#39;, created_at)&quot;).count</code>"}, {"owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "reply_to_user": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 1, "creation_date": 1518522446, "post_id": 48765856, "comment_id": 84532341, "body": "Not sure what you mean by this :("}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "edited": false, "score": 0, "creation_date": 1518523299, "post_id": 48765856, "comment_id": 84532868, "body": "you can use <a href=\"https://apidock.com/ruby/DateTime/strftime\" rel=\"nofollow noreferrer\">strftime</a> with<code>datetime_field.strftime(&#39;%F %R %z&#39;)</code> . It will return something like <code>2018-02-13 14:02 +0200</code>"}, {"owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 0, "creation_date": 1518530252, "post_id": 48765856, "comment_id": 84537542, "body": "It still doesn&#39;t get the timezone info from PosgreSQL, it returns the time in UTF: <code>&quot;2012-10-26 17:26 +0000&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 0, "creation_date": 1518540658, "post_id": 48770160, "comment_id": 84544635, "body": "Not sure that really asks my question, what I&#39;d want is to get the <code>+0200</code> bit from a date like this: <code>2018-02-13 14:02 +0200</code>, when I query it from Rails, and that for an individual element. As I could have elements with <code>+0200</code> and others with <code>+0100</code>, regardless of the timezone of the session or the user."}, {"owner": {"reputation": 407, "user_id": 6221200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a170bb32c5dfb8a3ebb3858d686e5dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Mogila", "link": "https://stackoverflow.com/users/6221200/ivan-mogila"}, "reply_to_user": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 0, "creation_date": 1518542820, "post_id": 48770160, "comment_id": 84546091, "body": "@JoaoTorres I think there is some misunderstanding. What do you mean saying: &quot;I&#39;d want to get, from Rails, the timezone info stored on PostgreSQL&quot;?"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "reply_to_user": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 0, "creation_date": 1518596669, "post_id": 48770160, "comment_id": 84566415, "body": "@JoaoTorres I think you&#39;re misunderstanding this slightly, the timezone of the server is always the same, regardless of the timezone of the currently signed in user of your web app. The value you see in postgres is just a representation of the stored UTC value."}, {"owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 0, "creation_date": 1518611033, "post_id": 48770160, "comment_id": 84575739, "body": "@IvanMogila I need to show the time of a specific element on the timezone it was entered, so when I have different elements in different timezones, &quot;I&#39;d want to get, from Rails, the timezone info stored on PostgreSQL&quot;.  So for example, say I have two different elements stored with the following dates: <code>2018-02-13 14:02 +0200</code> and <code>2018-02-13 13:02 +0100</code>, both are interpreted by Rails as the same value as it takes into account the set timezone, and not the timezone value stored in PostgreSQL, which on the first one was <code>+0200</code> and the second <code>+0100</code>."}, {"owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "reply_to_user": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1518611218, "post_id": 48770160, "comment_id": 84575869, "body": "@Iceman I get that the timezone of the server is always the same (and a single value), the issue is that PostgreSQL stores on each <code>timestamp with timezone</code> a timezone value. Ideally, I&#39;d like to get, in Rails, both values and not a single value on the server timezone, as if I have elements with different timezones, that information is lost on the Rails query. Is that clearer? I get it&#39;s a specific use case, but that&#39;s what I need right now."}, {"owner": {"reputation": 407, "user_id": 6221200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a170bb32c5dfb8a3ebb3858d686e5dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Mogila", "link": "https://stackoverflow.com/users/6221200/ivan-mogila"}, "reply_to_user": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "edited": false, "score": 1, "creation_date": 1518616263, "post_id": 48770160, "comment_id": 84579273, "body": "@JoaoTorres Postgres do not store original time zone for <code>timestamp with timezone</code> values. It converts any input values to UTC. There is no way you can get these values back in its original time zone unless you explicitly specify time zone using <code>AT TIME ZONE</code> construct or <code>SET TIME ZONE</code>."}], "tags": [], "owner": {"reputation": 407, "user_id": 6221200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a170bb32c5dfb8a3ebb3858d686e5dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Mogila", "link": "https://stackoverflow.com/users/6221200/ivan-mogila"}, "is_accepted": false, "score": 1, "last_activity_date": 1518535566, "last_edit_date": 1592644375, "creation_date": 1518535566, "answer_id": 48770160, "question_id": 48765856, "link": "https://stackoverflow.com/questions/48765856/rails-postgresql-how-to-query-timezone-info-along-with-time/48770160#48770160", "title": "Rails + PostgreSQL: How to query timezone info along with time", "body": "<p>From Postgres manual:</p>\n<blockquote>\n<p>For timestamp with time zone, the internally stored value is always in\nUTC (Universal Coordinated Time, traditionally known as Greenwich Mean\nTime, GMT). An input value that has an explicit time zone specified is\nconverted to UTC using the appropriate offset for that time zone. If\nno time zone is stated in the input string, then it is assumed to be\nin the time zone indicated by the system's TimeZone parameter, and is\nconverted to UTC using the offset for the timezone zone.</p>\n<p>When a timestamp with time zone value is output, it is always\nconverted from UTC to the current timezone zone, and displayed as\nlocal time in that zone. To see the time in another time zone, either\nchange timezone or use the AT TIME ZONE construct</p>\n</blockquote>\n<p>You can override current time zone on a session level using:</p>\n<pre><code>SET TIME ZONE timezone;\n</code></pre>\n<p>where <em>timezone</em> your desired time zone.</p>\n"}], "owner": {"reputation": 39, "user_id": 2358507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2ed33eb5b295e42d125d1cacadec3f?s=128&d=identicon&r=PG", "display_name": "Joao Torres", "link": "https://stackoverflow.com/users/2358507/joao-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1525326472, "creation_date": 1518521633, "last_edit_date": 1525326472, "question_id": 48765856, "link": "https://stackoverflow.com/questions/48765856/rails-postgresql-how-to-query-timezone-info-along-with-time", "title": "Rails + PostgreSQL: How to query timezone info along with time", "body": "<p>I'm using Rails4 and PostgreSQL v9.6.2, my problem is that I want to process <code>datetime</code>s in Rails in the timezone that it was entered, it gets stored properly in PostreSQL but when I retrieve it with Rails the timezone info gets lost.</p>\n\n<p>I'm using a <code>timestamp with time zone</code> in PostgreSQL and <code>datetime</code> in Rails. For example, while on PostgreSQL I see <code>2012-10-26 19:26:00+02</code>, on Rails I'm getting <code>Fri, 26 Oct 2012 17:26:00 UTC +00:00</code>, which is technically the same date, but on UTC, or without the original timezone. I'd want to get, from Rails, the timezone info stored on PostgreSQL. </p>\n"}, {"tags": ["ruby", "google-chrome-devtools"], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 0, "last_activity_date": 1518543853, "creation_date": 1518543853, "answer_id": 48772645, "question_id": 48765638, "link": "https://stackoverflow.com/questions/48765638/accessing-the-network-panel-data-on-google-chrome-developer-tools-using-ruby/48772645#48772645", "title": "Accessing the Network Panel Data on Google Chrome Developer Tools using Ruby", "body": "<p>The selenium API is pretty similar among its implementations, so, although I haven't tested it, offhand I think the following would work:</p>\n\n<pre><code>driver.get(\"http://www.google.com\")\nputs(driver.title)\nscript = \"var performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance || {}; var network = performance.getEntries() || {}; return network;\"\ndata = driver.execute_script(script)\nputs data\n</code></pre>\n\n<p>You would also have to install the Selenium gem. You can see their <a href=\"https://github.com/SeleniumHQ/selenium/wiki/Ruby-Bindings\" rel=\"nofollow noreferrer\">official instructions</a> about this.</p>\n"}], "owner": {"reputation": 483, "user_id": 7546921, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0a78fbca7cb186577145bfcdbef7499?s=128&d=identicon&r=PG&f=1", "display_name": "Richard C", "link": "https://stackoverflow.com/users/7546921/richard-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 48772645, "answer_count": 1, "score": 1, "last_activity_date": 1518543853, "creation_date": 1518520842, "question_id": 48765638, "link": "https://stackoverflow.com/questions/48765638/accessing-the-network-panel-data-on-google-chrome-developer-tools-using-ruby", "title": "Accessing the Network Panel Data on Google Chrome Developer Tools using Ruby", "body": "<p>I have been provided the following code to allow me to access the Network Panel Data on Google Chrome Developer Tools in order to be able to get this information while running my Selenium scripts. </p>\n\n<pre><code>driver.get(\"http://www.google.com\");\nSystem.out.println(driver.getTitle());\nString scriptToExecute = \"var performance = window.performance || window.mozPerformance || window.msPerformance || window.webkitPerformance || {}; var network = performance.getEntries() || {}; return network;\";\nString netData = ((JavascriptExecutor)driver).executeScript(scriptToExecute).toString();\nSystem.out.println(netData);\n</code></pre>\n\n<p>However my Automation Framework is written in Ruby, how would I convert the above to work in my Ruby Environment? Are there any additional Gems I need to install? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms"], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1518522149, "creation_date": 1518522149, "answer_id": 48766032, "question_id": 48765473, "link": "https://stackoverflow.com/questions/48765473/prevent-user-going-back-and-viewing-previously-submitted-payment-form-with-rails/48766032#48766032", "title": "Prevent user going back and viewing previously submitted payment form with Rails", "body": "<p>I see the following ways to make sure that the payment is not saved again.</p>\n\n<ol>\n<li>Use some job properties and during job creation check them and redirect to show.</li>\n<li><p>Attach a new hidden input when clicking the save button and verify if the param exist. If it exists then redirect</p>\n\n<pre><code># JavaScript\n$('#the_form button').on('submit', function() {\n   this.preventDefault();\n   this.parent.append('&lt;input type=\"hidden\" name=\"human_hit\" value=\"yes\" /&gt;');\n   this.parent.submit();\n})\n\n# Controller\ndef create\n  if params[:human_hit]\n    redirect_to :show, alert: \"Payment already done!\"\n  else\n   # Do save logic\n  end\nend\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 4188532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85abfe90024d7e2b7d5f565ad3c9b1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Prince Bansal", "link": "https://stackoverflow.com/users/4188532/prince-bansal"}, "is_accepted": false, "score": 0, "last_activity_date": 1518543406, "creation_date": 1518543406, "answer_id": 48772549, "question_id": 48765473, "link": "https://stackoverflow.com/questions/48765473/prevent-user-going-back-and-viewing-previously-submitted-payment-form-with-rails/48772549#48772549", "title": "Prevent user going back and viewing previously submitted payment form with Rails", "body": "<p>Here you can use referer header. Simply check that from which page hit is coming.</p>\n\n<p>For example:</p>\n\n<p>User is at payment form and previous page was say user details then referer from it coming will be user details. If user coming other than user details simply redirect some other page as where you want.</p>\n"}], "owner": {"reputation": 2495, "user_id": 2970507, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yw6OU.png?s=128&g=1", "display_name": "olivier", "link": "https://stackoverflow.com/users/2970507/olivier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518543406, "creation_date": 1518520348, "question_id": 48765473, "link": "https://stackoverflow.com/questions/48765473/prevent-user-going-back-and-viewing-previously-submitted-payment-form-with-rails", "title": "Prevent user going back and viewing previously submitted payment form with Rails", "body": "<p>Before marking this as duplicate. This answer didn't work for me: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/30402183/prevent-user-going-back-and-viewing-previously-submitted-form-rails\">Prevent user going back and viewing previously submitted form Rails</a></p>\n\n<p>I want to prevent, that the user is able to go back to the payment form he submitted before. </p>\n\n<p>What I am missing? This should be a easy task or not? What's my mistake?</p>\n\n<p>This is some of the form: </p>\n\n<pre><code> &lt;%= form_for :job, method: :post, url: {action: \"create\"} do |f| %&gt;\n   &lt;div class=\"infogroup\"&gt;\n     &lt;h5&gt;Informationen zum Job&lt;/h5&gt;\n     &lt;p&gt;Was f\u00fcr ein Job bieten Sie?&lt;/p&gt;\n   &lt;/div&gt;\n   &lt;div class=\"form-group\"&gt;\n      &lt;%= label_tag(:jobtitle, \"Jobtitel*\") %&gt;\n      &lt;%= text_field_tag(:jobtitle) %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"form-group\"&gt;\n     &lt;%= label_tag(:jobtype, \"Anstellungsgrad*\") %&gt;\n     &lt;%= text_field_tag(:jobtype) %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"form-group\"&gt;\n      &lt;%= label_tag(:place, \"Ort*\") %&gt;\n      &lt;%= text_field_tag(:place) %&gt;\n   &lt;/div&gt;\n[...]\n</code></pre>\n\n<p>This is the Controller code: </p>\n\n<pre><code>class JobsController &lt; ApplicationController\n\n  require 'date' \n\n  def new\n      @job = Job.new\n  end\n\n  def create\n    @job = Job.new(article_params)\n    @job.save\n    redirect_to @job\n  end\n\n  private def article_params\n\n  d = Date.new();\n  d.strftime('%a %d %b %Y')\n    params.permit(:jobtitle, :jobdescription, :jobtype, :place, :company, :paid, :userid, d)\n  end\n\n\n  def show\n    @job = Job.where(id: params[:id])\n  end\n\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope"], "comments": [{"owner": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1518517662, "post_id": 48764470, "comment_id": 84529519, "body": "Which version of rails do you use?"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "reply_to_user": {"reputation": 3020, "user_id": 4453584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25188d50654874d1125dd754d783851b?s=128&d=identicon&r=PG&f=1", "display_name": "guitarman", "link": "https://stackoverflow.com/users/4453584/guitarman"}, "edited": false, "score": 0, "creation_date": 1518517741, "post_id": 48764470, "comment_id": 84529572, "body": "@guitarman currently Rails 4.2.5.1"}, {"owner": {"reputation": 2156, "user_id": 976880, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/bcade31197a5623384d853c3c5fac28a?s=128&d=identicon&r=PG", "display_name": "aBadAssCowboy", "link": "https://stackoverflow.com/users/976880/abadasscowboy"}, "edited": false, "score": 1, "creation_date": 1518518042, "post_id": 48764470, "comment_id": 84529765, "body": "@MikeHolford Is <code>confirmed?</code> a column on <code>hunts</code> database table?"}, {"owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "reply_to_user": {"reputation": 2156, "user_id": 976880, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/bcade31197a5623384d853c3c5fac28a?s=128&d=identicon&r=PG", "display_name": "aBadAssCowboy", "link": "https://stackoverflow.com/users/976880/abadasscowboy"}, "edited": false, "score": 0, "creation_date": 1518518181, "post_id": 48764470, "comment_id": 84529850, "body": "@aBadAssCowboy in this case yes but I&#39;d love to know a solution if it wasn&#39;t too as it&#39;s a common problem for me"}], "answers": [{"comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1518518957, "post_id": 48764675, "comment_id": 84530364, "body": "I&#39;d <i>strongly</i> prefer option 1 above. Option 2 is less performant, and does not scale. (Think about what would happen in a large application, with millions of <code>Hunt</code> records!!)"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518519580, "post_id": 48764675, "comment_id": 84530755, "body": "@TomLord Very good point. I&#39;ll update my answer :) Sometimes I use Option 2 if the scope is complex, and that I&#39;d rather want the logic of the scopes be modular by putting them as scopes in their corresponding models, acknowledging though that this affects performance. Although I didnt know that it &quot;greatly&quot; affects performance/memory usage as you have just said. Thanks for this info! I&#39;ll run some tests to check the potential impact of this :) And oh, I think I can further optimise Solution 2. I&#39;m updating my answer."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518520051, "post_id": 48764675, "comment_id": 84530995, "body": "The performance issue only really comes into play on a large system. (My day job is dealing with an application with millions of active users, and billions of database records!!) For a personal/small-scale project, you&#39;ll likely not notice a difference, but it&#39;s something to be aware of nonetheless."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1518520169, "post_id": 48764675, "comment_id": 84531047, "body": "@TomLord Ahh I see! I&#39;ll take this into great consideration for big-data apps then; thank you! :)"}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 6, "last_activity_date": 1518600655, "last_edit_date": 1518600655, "creation_date": 1518518107, "answer_id": 48764675, "question_id": 48764470, "link": "https://stackoverflow.com/questions/48764470/combining-a-where-clause-with-a-method/48764675#48764675", "title": "Combining a &#39;where&#39; clause with a method", "body": "<h2>Updated:</h2>\n\n<p>Thanks to @TomLord's insight, you'd rather do Solution 1 below instead of Solution 2. Also, added sample SQL to show comparison.</p>\n\n<h2>Solution 1</h2>\n\n<pre><code>class Team &lt; ApplicationRecord\n  belongs_to :hunt\n  scope :ready, -&gt; { joins(:hunt).where(hunts: { confirmed: true }) }\nend\n</code></pre>\n\n<p><em>Usage:</em></p>\n\n<pre><code>Team.ready # or: Team.all.ready\n# SELECT  \"teams\".* FROM \"teams\" INNER JOIN \"hunts\" ON \"hunts\".\"id\" = \"teams\".\"hunt_id\" WHERE \"hunts\".\"confirmed\" = ? LIMIT ?  [[\"confirmed\", \"t\"], [\"LIMIT\", 11]]\n</code></pre>\n\n<h2>Or, Solution 2</h2>\n\n<pre><code>class Team &lt; ApplicationRecord\n  belongs_to :hunt\nend\n\nclass Hunt &lt; ApplicationRecord\n  scope :confirmed, -&gt; { where(confirmed: true) }\nend\n</code></pre>\n\n<p><em>Usage:</em></p>\n\n<pre><code># you can also move the logic below as a method/scope inside `Team` model (i.e. as `ready` method/scope)\n\n# Example 1 (using JOINS):\nTeam.joins(:hunt).where(hunts: { id: Hunt.confirmed })\n# SELECT  \"teams\".* FROM \"teams\" INNER JOIN \"hunts\" ON \"hunts\".\"id\" = \"teams\".\"hunt_id\" WHERE \"hunts\".\"id\" IN (SELECT \"hunts\".\"id\" FROM \"hunts\" WHERE \"hunts\".\"confirmed\" = ?) LIMIT ?  [[\"confirmed\", \"t\"], [\"LIMIT\", 11]]\n\n# Example 2 (same as Example 1 above but faster and more efficient):\nTeam.where(hunt_id: Hunt.confirmed)\n# SELECT  \"teams\".* FROM \"teams\" WHERE \"teams\".\"hunt_id\" IN (SELECT \"hunts\".\"id\" FROM \"hunts\" WHERE \"hunts\".\"confirmed\" = ?) LIMIT ?  [[\"confirmed\", \"t\"], [\"LIMIT\", 11]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2156, "user_id": 976880, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/bcade31197a5623384d853c3c5fac28a?s=128&d=identicon&r=PG", "display_name": "aBadAssCowboy", "link": "https://stackoverflow.com/users/976880/abadasscowboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1518518422, "creation_date": 1518518422, "answer_id": 48764810, "question_id": 48764470, "link": "https://stackoverflow.com/questions/48764470/combining-a-where-clause-with-a-method/48764810#48764810", "title": "Combining a &#39;where&#39; clause with a method", "body": "<p><strong>Solution: if <code>Hunts#confirmed</code> is a database column:</strong></p>\n\n<pre><code>class Team &lt; ApplicationRecord\n  belongs_to :hunt\n  scope :ready, -&gt; { joins(:hunt).where(hunts: { confirmed: true }) }\nend\n</code></pre>\n\n<p>In this case, <code>Team.ready</code> will return <code>ActiveRecord::Relation</code>.</p>\n\n<p><strong>Solution: If <code>Hunts#confirmed?</code> is a NOT a database column:</strong></p>\n\n<pre><code>class Team &lt; ApplicationRecord\n  belongs_to :hunt\n  scope :ready, -&gt; { includes(:hunts).select(&amp;:ready?) }\nend\n</code></pre>\n\n<p>In this case, <code>Team.ready</code> will return an <code>Array</code></p>\n\n<p>You need to be aware that the second solution is looping over the Team records calling <code>ready?</code> on each of them while the first is performing a database query. First is more efficient.</p>\n"}], "owner": {"reputation": 1603, "user_id": 1919319, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/u1f49.jpg?s=128&g=1", "display_name": "MikeHolford", "link": "https://stackoverflow.com/users/1919319/mikeholford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 48764675, "answer_count": 2, "score": 1, "last_activity_date": 1518600655, "creation_date": 1518517505, "last_edit_date": 1518517814, "question_id": 48764470, "link": "https://stackoverflow.com/questions/48764470/combining-a-where-clause-with-a-method", "title": "Combining a &#39;where&#39; clause with a method", "body": "<p>In my app, a <code>Team</code> <code>belongs_to :hunt</code>. Once a <code>Hunt</code> is confirmed, then all associated teams are ready.</p>\n\n<p>This a sample from my <code>team.rb</code> file, where I use the method <code>ready?</code> to check if <code>team.hunt</code> is confirmed.</p>\n\n<pre><code>#team.rb\n\ndef ready?\n  hunt.confirmed? ? true : false\nend\n</code></pre>\n\n<p>I would love to have a scope in <code>team.rb</code> file so I can call <code>Teams.all.ready.count</code> to show the number of teams that are ready.</p>\n\n<p>How can I write a method or a scope to achieve the behaviour above without adding anything to my DB or iterating through an array etc?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "file"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1518513378, "post_id": 48763008, "comment_id": 84526761, "body": "Use a HTML parser like <a href=\"http://www.nokogiri.org/\" rel=\"nofollow noreferrer\">Nokogiri</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1518513657, "post_id": 48763008, "comment_id": 84526963, "body": "...And I know you didn&#39;t suggest this (which is a rare relief!), but <a href=\"https://stackoverflow.com/a/1732454/1954610\"><b>don&#39;t</b> use regex to parse HTML</a>."}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "edited": false, "score": 1, "creation_date": 1518514609, "post_id": 48763201, "comment_id": 84527576, "body": "With a small edit it worked. Thanks!   index_html = file.read   page = Nokogiri::HTML(index_html)   css_styles = page.css(&#39;style&#39;)[0]"}], "tags": [], "owner": {"reputation": 3737, "user_id": 7417402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0362a30046be9244cf62d2a9fc6f8568?s=128&d=identicon&r=PG", "display_name": "Devstr", "link": "https://stackoverflow.com/users/7417402/devstr"}, "is_accepted": true, "score": 1, "last_activity_date": 1518513398, "creation_date": 1518513398, "answer_id": 48763201, "question_id": 48763008, "link": "https://stackoverflow.com/questions/48763008/how-to-extract-style-content-from-html-file-in-ruby/48763201#48763201", "title": "How to extract &lt;style&gt; content from HTML file in Ruby?", "body": "<p>You can use <a href=\"http://www.nokogiri.org/tutorials/installing_nokogiri.html\" rel=\"nofollow noreferrer\"><code>Nokogiri</code></a> gem</p>\n\n<pre><code>require 'nokogiri'\n\nfile = File.open(\"filepath/index.html\", \"rb\")\npage = Nokogiri::HTML(file.read)\nfirst_style_tag = page.css('style')[0]\nputs first_style_tag.text\n</code></pre>\n\n<p>see this tutorial <a href=\"http://ruby.bastardsbook.com/chapters/html-parsing/\" rel=\"nofollow noreferrer\">http://ruby.bastardsbook.com/chapters/html-parsing/</a></p>\n\n<p>Not tested, please try it out</p>\n"}], "owner": {"reputation": 114, "user_id": 5245132, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/6f004e91e164ad823070480a9354a516?s=128&d=identicon&r=PG&f=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5245132/chet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 48763201, "answer_count": 1, "score": 0, "last_activity_date": 1518513546, "creation_date": 1518512828, "last_edit_date": 1518513546, "question_id": 48763008, "link": "https://stackoverflow.com/questions/48763008/how-to-extract-style-content-from-html-file-in-ruby", "title": "How to extract &lt;style&gt; content from HTML file in Ruby?", "body": "<p>I've copied contents from a index.html file. Now I just want to copy everything that's inside the style tags. How can I do this?</p>\n\n<pre><code> file = File.open(\"filepath/index.html\", \"rb\")\n @html_file_contents = file.read  //@html_file_contents has raw html from which I need to extract style tag contents.\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518513186, "post_id": 48762935, "comment_id": 84526611, "body": "@Stefan message is printed and code execution continues."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1518513331, "post_id": 48762935, "comment_id": 84526720, "body": "What do you mean by &quot;stop code execution&quot;? Raising an exception?"}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518513433, "post_id": 48762935, "comment_id": 84526798, "body": "@Stefan yes, and print some message."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518513652, "post_id": 48762935, "comment_id": 84526958, "body": "Use <a href=\"http://ruby-doc.org/core-2.5.0/Kernel.html#method-i-raise\" rel=\"nofollow noreferrer\"><code>raise</code></a>   (or its alias <code>fail</code>) instead of <code>puts</code>."}, {"owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518514298, "post_id": 48762935, "comment_id": 84527386, "body": "@Stefan Can you show me complete code example please?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518514994, "post_id": 48762935, "comment_id": 84527834, "body": "BTW, if <code>env</code> returns a symbol, you should use <code>env.to_s.upcase</code> instead of <code>&quot;#{env.upcase}&quot;</code>. Or simply <code>env.upcase</code> if <code>env</code> already returns a string."}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 1, "last_activity_date": 1518515220, "last_edit_date": 1518515220, "creation_date": 1518514768, "answer_id": 48763609, "question_id": 48762935, "link": "https://stackoverflow.com/questions/48762935/stop-code-execution-if-file-is-missing/48763609#48763609", "title": "Stop code execution if file is missing", "body": "<p>You can <a href=\"http://ruby-doc.org/core-2.5.0/Kernel.html#method-i-raise\" rel=\"nofollow noreferrer\"><code>raise</code></a> an exception:</p>\n\n<pre><code>def load_environment_config(gateway, trx_type)\n  @config = YAML.load_file(\"config/#{env}_config.yml\")[env.to_s.upcase]\n  raise \"Missing ...\" unless @config[gateway]\nend\n</code></pre>\n\n<p>Which will stop execution if it is not rescued, usually printing the error message and its backtrace.</p>\n\n<p>You can also use your own <a href=\"http://ruby-doc.org/core-2.5.0/Exception.html\" rel=\"nofollow noreferrer\"><code>Exception</code></a> class:</p>\n\n<pre><code>class ConfigurationError &lt; StandardError; end\n\ndef load_environment_config(gateway, trx_type)\n  @config = YAML.load_file(\"config/#{env}_config.yml\")[env.to_s.upcase]\n  raise ConfigurationError, \"Missing ...\" unless @config[gateway]\nend\n</code></pre>\n"}], "owner": {"reputation": 7004, "user_id": 1103606, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=128&d=identicon&r=PG", "display_name": "Peter Penzov", "link": "https://stackoverflow.com/users/1103606/peter-penzov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1518540969, "accepted_answer_id": 48763609, "answer_count": 1, "score": 0, "last_activity_date": 1518515220, "creation_date": 1518512547, "last_edit_date": 1518514720, "question_id": 48762935, "link": "https://stackoverflow.com/questions/48762935/stop-code-execution-if-file-is-missing", "closed_reason": "Needs details or clarity", "title": "Stop code execution if file is missing", "body": "<p>I use this code in order to load configuration file.</p>\n\n<pre><code>def load_environment_config(gateway, trx_type)\n  @config = YAML.load_file(\"config/#{env}_config.yml\")[\"#{env.upcase}\"]\n  puts \"\\nMissing gateway configuration for #{gateway} in file config/#{env}_config.yml!\\n\\n\" unless @config[gateway]\nend\n</code></pre>\n\n<p>How I can stop code execution if line in file configuration is missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "actioncable"], "answers": [{"comments": [{"owner": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "edited": false, "score": 0, "creation_date": 1518541006, "post_id": 48771272, "comment_id": 84544891, "body": "I dont understand. I just use ActionCable.server.broadcast to broadcast some data to subscribers. But what first argument should I pass to ActionCable.server.broadcast if I didnt set stream_from? In tutorials, ActionCable.server.broadcast first argument and stream_from argument are equal. But what is the default one?"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "edited": false, "score": 0, "creation_date": 1518558085, "post_id": 48771272, "comment_id": 84553950, "body": "If you&#39;re going to do <code>ActionCable.server.broadcast</code>, you need to use <code>stream_for</code> or <code>stream_from</code>. The main reason is for scalability. You&#39;ll need to have a central place for all subscribers to listen to, which is the &quot;broadcasting name&quot; (the same value you pass to <code>stream_for(broadcasting_name)</code>). This &quot;broadcasting name&quot; resides in a central distribution place, which is normally your <code>redis</code> configure for <code>ActionCable</code>."}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "edited": false, "score": 0, "creation_date": 1518558553, "post_id": 48771272, "comment_id": 84554231, "body": "... the problem with not using a &quot;broadcasting name&quot; is that your application may have lots of computers/servers each running their own Rails server of your app (to be able to handle loooooads of concurrent requests), and that you didn&#39;t use a central place &quot;broadcasting name&quot; / redis), then <code>ActionCable.server.broadcast</code> can only broadcast to all the Websocket connections that are currently connected to it but only in one server,and not all of your servers because each server has its own &quot;memory&quot; space,and they cannot automatically access each other&#39;s &quot;memory&quot; in which the connections resides"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "edited": false, "score": 1, "creation_date": 1518558904, "post_id": 48771272, "comment_id": 84554402, "body": "If you insist however on not wanting to use <code>stream_from</code> but at the same time you wanted to be able to &quot;broadcast&quot; (like <code>ActionCable.server.broadcast</code>), then you can do something like: <code>ObjectSpace.each_object(SomethingChannel) { |something_channel_instance| something_channel_instance.connection.transmit(YOURDATA) }</code> However that will only work in the same server (multi-processes nor multi-servers wont work), and it&#39;s really not a recommended way on doing it, and you&#39;ll probably be having maintenance problems in the long-run. Also, I haven&#39;t fully tested if this even works."}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 1, "last_activity_date": 1518540032, "last_edit_date": 1518540032, "creation_date": 1518539087, "answer_id": 48771272, "question_id": 48762868, "link": "https://stackoverflow.com/questions/48762868/what-is-default-behavior-for-actioncable-in-rails/48771272#48771272", "title": "What is default behavior for actioncable in rails?", "body": "<p>Asssuming that your channel is named <code>SomethingChannel</code></p>\n\n<pre><code>class SomethingChannel &lt; ApplicationCable::Channel\n  def subscribed\n    # because you do not need stream_from, then remove the stream_from below\n    # stream_from \"something_channel\"\n\n    # and just immediately transmit the data. This should be a hash, and thus I use `as_json`; Change this accordingly as you see fit\n    transmit(Comment.all.as_json)\n  end\n\n  def unsubscribed\n    # Any cleanup needed when channel is unsubscribed\n  end\nend\n</code></pre>\n\n<p>Then on the client-side, you just simply invoke the following whenever you already need this.</p>\n\n<pre><code># ...coffee\nApp.cable.subscriptions.create 'SomethingChannel',\n  connected: -&gt;\n    console.log('connected')\n\n  # Called when the WebSocket connection is closed.\n  disconnected: -&gt;\n    console.log('disconnected')\n\n  # `transmit(Comment.all.as_json)` above will invoke this\n  received: (data) -&gt;\n    console.log('received')\n    console.log(data)\n</code></pre>\n\n<p>You should see the something like the following in your Google Chrome / Firefox console:</p>\n\n<pre><code>connected\nreceived\n\u25bc [{\u2026}]\n  \u25b6 0: {id: 1, title: \"Hello \", content: \"World from Earth! :)\", created_at: \"2018-02-13T16:15:05.734Z\", updated_at: \"2018-02-13T16:15:05.734Z\"}\n  \u25b6 1: {id: 2, title: \"Lorem \", content: \"Ipsum Dolor\", created_at: \"2018-02-13T16:15:05.734Z\", updated_at: \"2018-02-13T16:15:05.734Z\"}\n  length: 2\n  \u25b6 __proto__: Array(0)\n</code></pre>\n\n<p><em>P.S. if you are not gonna make use of <code>stream_from</code> or <code>stream_for</code> then perhaps you might not need <code>ActionCable</code> after all, and perhaps you'd be better off retrieving all the comments from an API instead (i.e. <code>GET /comments</code>)</em></p>\n"}], "owner": {"reputation": 1121, "user_id": 272846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/8b12d17e2b54660de108a0995e1b5c3f?s=128&d=identicon&r=PG", "display_name": "Molfar", "link": "https://stackoverflow.com/users/272846/molfar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 48771272, "answer_count": 1, "score": 0, "last_activity_date": 1518540032, "creation_date": 1518512252, "last_edit_date": 1518517878, "question_id": 48762868, "link": "https://stackoverflow.com/questions/48762868/what-is-default-behavior-for-actioncable-in-rails", "title": "What is default behavior for actioncable in rails?", "body": "<p>When generating a new channel, there is commented out stream_from method call. I understand, that it suits for recognizing streams, like stream_from \"comments_#{message.id}\". </p>\n\n<p>But if this channel has no such goal and should stream all comments? What is default behavior (of value maybe) of this channel without specifying stream_from?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "gemfile.lock"], "answers": [{"tags": [], "owner": {"reputation": 1623, "user_id": 1337408, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cffaadb4bb28605ba060af07de3ab779?s=128&d=identicon&r=PG&f=1", "display_name": "computer_smile", "link": "https://stackoverflow.com/users/1337408/computer-smile"}, "is_accepted": true, "score": 5, "last_activity_date": 1518542662, "creation_date": 1518542662, "answer_id": 48772358, "question_id": 48761493, "link": "https://stackoverflow.com/questions/48761493/platforms-added-to-gemfile-lock/48772358#48772358", "title": "Platforms added to Gemfile.lock", "body": "<p>After digging into this with fresh eyes in the morning here's what happened. </p>\n\n<p>I checked my bash history and saw that I ran <code>bundle lock --add-platform x86-mingw32 x86-mswin32 x64-mingw32 java</code> before the commit I posted in the question. This obviously adds more platforms in your <code>Gemfile.lock</code> and subsequently platform specific dependencies.</p>\n\n<p>I believe I ran this in the terminal to get rid of what I thought was an error around <code>tzinfo-data</code>. More info on that \"error\" here <a href=\"https://github.com/tzinfo/tzinfo-data/issues/12\" rel=\"noreferrer\">https://github.com/tzinfo/tzinfo-data/issues/12</a>. </p>\n\n<p>Rather than editing the <code>Gemfile.lock</code> directly, I ran <code>bundle lock --remove-platform x86-mingw32 x86-mswin32 x64-mingw32 java</code> and this made the appropriate edits to my lock file. More info here <a href=\"http://bundler.io/v1.16/bundle_lock.html\" rel=\"noreferrer\">http://bundler.io/v1.16/bundle_lock.html</a>.</p>\n\n<p>Heroku no longer throwing an error when deploying as expected. Hope this helps someone in the future. </p>\n"}], "owner": {"reputation": 1623, "user_id": 1337408, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cffaadb4bb28605ba060af07de3ab779?s=128&d=identicon&r=PG&f=1", "display_name": "computer_smile", "link": "https://stackoverflow.com/users/1337408/computer-smile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "accepted_answer_id": 48772358, "answer_count": 1, "score": 0, "last_activity_date": 1518542662, "creation_date": 1518506763, "last_edit_date": 1518536092, "question_id": 48761493, "link": "https://stackoverflow.com/questions/48761493/platforms-added-to-gemfile-lock", "title": "Platforms added to Gemfile.lock", "body": "<p>I'm trying to track down how a couple platforms were added to my <code>Gemfile.lock</code> without explicitly doing so. I must have overlooked these changes when adding new gems but I'm not able to reproduce the same <code>Gemfile.lock</code> platform additions when adding those same <code>Gemfile</code> changes.</p>\n\n<p>Here is the commit where the new platforms were added. </p>\n\n<pre><code>#....\n+gem 'sqreen'\n+gem 'sanitize'\n+\n\n # Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\n gem 'jbuilder', '~&gt; 2.5'\n@@ -55,6 +57,8 @@ gem 'postmark-rails'\n group :development, :test do\n   # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n   gem 'byebug', platform: :mri\n+  gem 'capybara'\n+  gem 'selenium-webdriver'\n end\n</code></pre>\n\n<p>And the changes to <code>Gemfile.lock</code> in the same commit:</p>\n\n<pre><code> PLATFORMS\n+  java\n   ruby\n+  x64-mingw32\n+  x86-mingw32\n+  x86-mswin32\n</code></pre>\n\n<p>I tried to reproduce the same modification in a test app but those platforms were not added to the <code>Gemfile.lock</code></p>\n\n<p>I noticed this when recently pushing to heroku:</p>\n\n<pre><code>Removing `Gemfile.lock` because it was generated on Windows.\nremote:        Bundler will do a full resolve so native gems are handled properly.\nremote:        This may result in unexpected gem versions being used in your app.\nremote:        In rare occasions Bundler may not be able to resolve your dependencies at all.\nremote:        https://devcenter.heroku.com/articles/bundler-windows-gemfile\n</code></pre>\n\n<p>I'm not developing on a windows machine and now platform specific gems are being added to <code>Gemfile.lock</code> for example:</p>\n\n<pre><code>ffi (1.9.18)\nffi (1.9.18-java)\nffi (1.9.18-x64-mingw32)\nffi (1.9.18-x86-mingw32)\n</code></pre>\n\n<p>I'm not entirely sure how the platforms were added. It's not advisable to modify the lock file directly but to appease the heroku warning should I explore removing all platform specific references and remove the non-ruby platforms in my lock file? Any advice here is welcome. </p>\n\n<p><code>rails 5.1.3</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "capybara", "factory-bot"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518506685, "post_id": 48761419, "comment_id": 84523221, "body": "can you include the controller methods?"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518507886, "post_id": 48761419, "comment_id": 84523798, "body": "Do you mean Topics controller method?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1518535500, "post_id": 48761419, "comment_id": 84541282, "body": "Please show your Capybara settings (current_driver, javascript_driver, default_driver, etc). Also, what version of Rails are you using?"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518541386, "post_id": 48761419, "comment_id": 84545147, "body": "I dont have any specific settings for my capybara setup in rails_helper or spec_helper files. I am using rails 5.1.4. Do I have to add these settings explicitly?"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1518541573, "post_id": 48761419, "comment_id": 84545271, "body": "@ThomasWalpole I just went through docs here <a href=\"https://github.com/teamcapybara/capybara#using-capybara-with-rspec\" rel=\"nofollow noreferrer\">github.com/teamcapybara/capybara#using-capybara-with-rspec</a>  As I have not mentioned explicitly, it must be using default Rack driver ."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1518541965, "post_id": 48761419, "comment_id": 84545536, "body": "@Solid Have you set <code>Capybara.server</code> to anything? and do you have any <code>puma</code> output in your tests output?  If so please add it to the question."}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518542554, "post_id": 48761419, "comment_id": 84545912, "body": "@ThomasWalpoleThanks  again for helping with this. I have updated the full version of my rails_spec file. I have not set capybara.server to anything specific.  There is no puma specific output, only error I see is the one I posted in question."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518516806, "post_id": 48762720, "comment_id": 84528956, "body": "You were right, I made the change i.e      random_topics = create(:topic)     visit topics_path      expect(page).to have_text random_topic.name  but still same problem, I can see the value in DB, but @topics is stil nill and hence no record on page too!"}], "tags": [], "owner": {"reputation": 3272, "user_id": 2389628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4nuI.jpg?s=128&g=1", "display_name": "smallbutton", "link": "https://stackoverflow.com/users/2389628/smallbutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1518511749, "creation_date": 1518511749, "answer_id": 48762720, "question_id": 48761419, "link": "https://stackoverflow.com/questions/48761419/capybara-and-factorybot-created-data-does-not-appear/48762720#48762720", "title": "Capybara and Factorybot - created data does not appear", "body": "<p>You should create the record before you visit the page. Currently you do it the other way around so your record cannot appear.</p>\n"}, {"comments": [{"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518516508, "post_id": 48762756, "comment_id": 84528784, "body": "Thanks @philippe-b, But I made the change you suggested, but still same problem, no change."}, {"owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518518995, "post_id": 48762756, "comment_id": 84530392, "body": "You could try to run helper methods of capybara, to check what you browser really sees with : <i>screenshot_and_open_image</i> or <i>save_and_open_page</i> ?"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518525208, "post_id": 48762756, "comment_id": 84534063, "body": "I am not able to run those helper methods, its getting error &quot;undefined methods&quot; . Any specific way to use these methods?"}, {"owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518529252, "post_id": 48762756, "comment_id": 84536805, "body": "It comes with Capybara : <a href=\"http://www.rubydoc.info/github/jnicklas/capybara/Capybara%2FSession%3Asave_and_open_page\" rel=\"nofollow noreferrer\">rubydoc.info/github/jnicklas/capybara/&hellip;</a> :)"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518529730, "post_id": 48762756, "comment_id": 84537154, "body": "Ohh, Sorry about that. I can see the sample html, I dont see the random_topic in the list. When I debug with byebug,  Topic.all.first -&gt; Returns me Correct random topic object newly created. random_topic.nam -&gt; Return me correct random topic name (matches with ActiveRecord data) @topics -&gt; return nil / empty. HTML page also dont show record in list.   It is possible that Factorybot is creating the record in a model, database_cleaner is clearing the data before Capybara can make a request?"}, {"owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518685519, "post_id": 48762756, "comment_id": 84609408, "body": "Well I see that Thomas helped you. Indeed if you use Apartment gem, you have to switch into the tenant if your user!"}, {"owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518685842, "post_id": 48762756, "comment_id": 84609592, "body": "I would suggest to extract that login logic into a helper, that you could re-use for all you tests!"}], "tags": [], "owner": {"reputation": 364, "user_id": 4136529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wvzv6m37XJg/AAAAAAAAAAI/AAAAAAAABGI/SHiJgtNb-Fs/photo.jpg?sz=128", "display_name": "Philippe B.", "link": "https://stackoverflow.com/users/4136529/philippe-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1518511857, "creation_date": 1518511857, "answer_id": 48762756, "question_id": 48761419, "link": "https://stackoverflow.com/questions/48761419/capybara-and-factorybot-created-data-does-not-appear/48762756#48762756", "title": "Capybara and Factorybot - created data does not appear", "body": "<p>Your record isn't persisted when you visit the page, so it's normal that it return <em>false</em>.</p>\n\n<p>Try the following :</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe \"topics\" do\n  let(:user) {create(:user)}\n  let!(:random_topic) {create(:topic)}\n\n  before do \n    sign_user_in(user)  #support fuction to sign user in\n    visit topics_path   # /topics/ \n  end \n\n  it \"allows topics to be edited\" do\n    expect(page).to have_text random_topic.name   # Error1 \n\n    click_edit_topic_button random_topic.name  # Another support fuction \n    random_topic_name_2 = Faker::Commerce.department(2, true)\n    fill_in \"Name\", with: random_topic_name_2\n    check \"Archived\"\n    click_button \"Update Topic\"\n\n    expect(page).to have_text \"Topic updated!\"\n    expect(page).to have_text random_topic_name_2\n  end\nend\n</code></pre>\n\n<p>Note that <em>random_topic</em> is extracted in a <em>let!</em> (more info about the difference between <em>let</em> and <em>let!</em> : <a href=\"https://relishapp.com/rspec/rspec-core/v/2-5/docs/helper-methods/let-and-let\" rel=\"nofollow noreferrer\">https://relishapp.com/rspec/rspec-core/v/2-5/docs/helper-methods/let-and-let</a> !</p>\n"}, {"comments": [{"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518546182, "post_id": 48772670, "comment_id": 84547946, "body": "I started with 2nd Option you mentioned.   Fixed the configuration with the example provided at the link. Then also removed a port from set_host. Also stopped my development server just to make sure that it won&#39;t be used. (I highly doubt that as it was the case though, as my development database must have got screwed otherwise.)  Added configuration setting &quot;Capybara.always_include_port&quot;  (I do need it as my app is multi-tenant app with apartment gem )  Still the same issue.   (BTW, I don&#39;t know if its relevant but I am using live guard for continuously running my test suit )"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518546566, "post_id": 48772670, "comment_id": 84548137, "body": "Then I started with 3rd Option you mentioned. Removed port, stopped dev server to be extra careful. Removed DatabaseCleaner settings, enable use_transactional_fixtures to true. Also setup the Capybara.server = :puma.  still the same issue. No change."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518547126, "post_id": 48772670, "comment_id": 84548419, "body": "@Solid Having the port set on app_host wouldn&#39;t have screwed your dev database since the creation/deletion of records for setup of the tests wouldn&#39;t have accessed the dev DB, only the browser would have connected to you dev app/db.  Anyway, if you&#39;ve done everything I suggested correctly it should work.  Is this a publicly accessible repo? or can you provide me access to take a look?"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518550163, "post_id": 48772670, "comment_id": 84549984, "body": "I tried all the options you mentioned, and still the error persisted. This is not a publicly accessible repo, its private repo on gitlab, let me know how can I share access with you? Thanks again for all the help!"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518550373, "post_id": 48772670, "comment_id": 84550102, "body": "Thomas - do you have gitlab account? I have repo on gitlab.com!"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518550917, "post_id": 48772670, "comment_id": 84550387, "body": "Added, let me know if you have any question about setting it up!"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518551480, "post_id": 48772670, "comment_id": 84550646, "body": "oh, sorry, Can you check now?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518553120, "post_id": 48772670, "comment_id": 84551491, "body": "@Solid - You&#39;re using the <code>apartment</code> gem which adds a layer of complexity. You&#39;re creating the <code>random_topic</code> in the &quot;public&quot; tenant, but the topics controller displays the topics from the users tenant.  You need to create your records in the correct tenant."}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518553697, "post_id": 48772670, "comment_id": 84551814, "body": "But if you look at Accounts.rb factory, i.e account_with_schema kind of takes care of switching to right tenant. Let me check if there is explicit switching correct tenant I can do."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518554060, "post_id": 48772670, "comment_id": 84552011, "body": "@Solid - the <code>account_with_schema</code> factory switches back to the public tenant after creating the account -- so there is no tenant set when you create the <code>random_topic</code>"}, {"owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "edited": false, "score": 0, "creation_date": 1518554372, "post_id": 48772670, "comment_id": 84552149, "body": "Yes, you are right. That was the issue. I moved random_topic = create(:topic) into scenario section and then explicit did the tenant switch in before at the top. I was assuming sign_user_in(user) would have done tenant switch as but I guess I was wrong in there. Thanks @thomas! This was great help!"}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1518543948, "creation_date": 1518543948, "answer_id": 48772670, "question_id": 48761419, "link": "https://stackoverflow.com/questions/48761419/capybara-and-factorybot-created-data-does-not-appear/48772670#48772670", "title": "Capybara and Factorybot - created data does not appear", "body": "<p>When this happens it's generally caused by one of a few things</p>\n\n<ol>\n<li><p>The record isn't actually being created</p>\n\n<p>From your code it doesn't appear to be that</p></li>\n<li><p>The record is being created in one transaction while the app is running in a different transaction.</p>\n\n<p>You appear to have database_cleaner configured correctly, and this shouldn't be an issue in your case, however you should be using - <a href=\"https://github.com/DatabaseCleaner/database_cleaner#rspec-with-capybara-example\" rel=\"nofollow noreferrer\">https://github.com/DatabaseCleaner/database_cleaner#rspec-with-capybara-example</a> - rather than the configuration you have (which depends on the :js metadata rather than checking which driver is actually being used)</p></li>\n<li><p>The user has configured Capybara to hit a different server than the one the test is actually running on.  </p>\n\n<p>Here we appear to have an issue, since you're configuring <code>Capybara.app_host</code> to be 'lvh.me:3000'.  Port 3000 is what your dev app is generally run on, while Capybara (by default) starts your app on a random port for tests.  This probably means your tests are actually running against your dev app/db instance which has nothing to do with the test app/db instance, and therefore the tests won't see anything you create in your tests.  Remove the setting of <code>Capybara.app_host</code> unless you have an actual need for its setting (in which case remove the port from your app_host setting and enable <code>Capybara.always_include_server_port</code>)</p></li>\n</ol>\n\n<p>This all being said, since you're using Rails 5.1+ database_cleaner should not be needed anymore.  You should be able to remove all of database_cleaner, reenable <code>use_transactional_fixtures</code>, and set <code>Capybara.server = :puma</code> and have things work fine (still would need to fix the app_host setting)</p>\n"}], "owner": {"reputation": 199, "user_id": 932334, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54304822ca2deb0bf0d348cd58c8fce4?s=128&d=identicon&r=PG", "display_name": "Solid", "link": "https://stackoverflow.com/users/932334/solid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "accepted_answer_id": 48772670, "answer_count": 3, "score": 1, "last_activity_date": 1518554634, "creation_date": 1518506407, "last_edit_date": 1518554634, "question_id": 48761419, "link": "https://stackoverflow.com/questions/48761419/capybara-and-factorybot-created-data-does-not-appear", "title": "Capybara and Factorybot - created data does not appear", "body": "<p>I am facing a wired issue, factoryBot is creating a record in Db, but when capybara try to access it, there is no record in HTML.</p>\n\n<p>I tried debugging with \"byebug\", on prompt, when I say \n@topics => It gives me Nil data. (@topic is instance variable in topics_controller.rb -> index method )</p>\n\n<p>If I do \"Topic.all.first\" it will show me correct record of Topic with an expected random name that is -> \"Toys &amp; Garden\" \nIf I do \"random_topic.name\" -> \"Toys &amp; Garden\"  </p>\n\n<p>I have somewhat similar setup in other feature i.e \"account creation feature\", it is working fine in there. Any pointer or help would be highly appreciated.</p>\n\n<p>My factory file is </p>\n\n<pre><code>FactoryBot.define do\n  factory :topic do\n    name { Faker::Commerce.department(2, true) }\n    archived false\n  end\nend\n</code></pre>\n\n<p>My Feature spec file looks like below</p>\n\n<pre><code>require 'rails_helper'\n\ndescribe \"topics\" do\n  let(:user) {create(:user)} \n\n  before do \n    sign_user_in(user)  #support fuction to sign user in\n\n  end \n\n  it \"allows topics to be edited\" do\n    random_topic = create(:topic)\n    visit topics_path   # /topics/ \n    expect(page).to have_text random_topic.name   # Error1 \n\n    click_edit_topic_button random_topic.name  # Another support fuction \n    random_topic_name_2 = Faker::Commerce.department(2, true)\n    fill_in \"Name\", with: random_topic_name_2\n    check \"Archived\"\n    click_button \"Update Topic\"\n\n    expect(page).to have_text \"Topic updated!\"\n    expect(page).to have_text random_topic_name_2\n  end\nend\n</code></pre>\n\n<p>I get the error on line marked as \"Error 1\" , please note that \"Toys &amp; Garden\" is sample name generated by Faker Gem. </p>\n\n<pre><code>Failure/Error: expect(page).to have_text random_topic.name\n       expected #has_text?(\"Toys &amp; Garden\") to return true, got false\n</code></pre>\n\n<p>my Rails helper(rails_helper.rb) file setup is as below.</p>\n\n<pre><code># This file is copied to spec/ when you run 'rails generate rspec:install'\n\nrequire 'spec_helper'\nENV['RAILS_ENV'] ||= 'test'\nrequire File.expand_path('../../config/environment', __FILE__)\nabort(\"The Rails environment is running in production mode!\") if Rails.env.production?\nrequire 'rspec/rails'\nrequire 'database_cleaner'\nrequire 'capybara/rspec'\nrequire 'shoulda/matchers'\nrequire 'email_spec'\nrequire \"email_spec/rspec\"\n\n\nDir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }\n\nActiveRecord::Migration.maintain_test_schema!\n\nShoulda::Matchers.configure do |config|\n  config.integrate do |with|\n    with.test_framework :rspec\n    with.library :rails\n  end\nend\n\n# This is for setting up Capybara right host.\n# https://stackoverflow.com/questions/6536503/capybara-with-subdomains-default-host \ndef set_host (host)\n  default_url_options[:host] = host\n  Capybara.app_host = \"http://\" + host\nend\n\nRSpec.configure do |config|\n\n  config.include Capybara::DSL\n\n  config.include Rails.application.routes.url_helpers\n\n  config.include FactoryBot::Syntax::Methods\n  config.include EmailSpec::Helpers\n  config.include EmailSpec::Matchers\n\n  config.order = \"random\"\n\n  config.use_transactional_fixtures = false\n\n  config.before(:each) do\n    set_host \"lvh.me:3000\"\n  end\n\n  config.before(:suite) do\n    DatabaseCleaner.clean_with(:truncation)\n  end\n\n  config.before(:each) do\n    DatabaseCleaner.strategy = :transaction\n  end\n\n  config.before(:each, :js =&gt; true) do\n    DatabaseCleaner.strategy = :truncation\n  end\n\n  config.before(:each) do\n    DatabaseCleaner.start\n  end\n\n  config.after(:each) do\n    DatabaseCleaner.clean\n  end\n\nend\n</code></pre>\n\n<p>My Topics Controller file is something like below</p>\n\n<pre><code>class TopicsController &lt; ApplicationController\n\n  layout 'dashboard'\n  before_action :authenticate_user!\n\n\n  def index\n    @topics = Topic.all\n  end\n\nend\n</code></pre>\n\n<p><strong>Updated with @smallbutton.com comments, but issue continues.</strong> </p>\n\n<p><strong>SOLVED</strong> </p>\n\n<p>I am using apartment gem and hence topic was getting created in public schema while test was looking into a respective tenant. </p>\n\n<p>As per @thomas suggestion, I modified the code: </p>\n\n<pre><code>  before do \n    set_subdomain(account.subdomain)\n    sign_user_in(user)  #support fuction to sign user in\n    Apartment::Tenant.switch!(account.subdomain)\n  end \n</code></pre>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518508725, "post_id": 48760004, "comment_id": 84524181, "body": "&quot;equipment[] = level[10]&quot; - no, this is not php. Here it&#39;s done differently: <code>equipment.push(level[10])</code>. And these should be outside the <code>select</code>, I think."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518508795, "post_id": 48760004, "comment_id": 84524220, "body": "Also, <code>level[10]</code> and <code>level[13]</code>? What did you mean by that? You only have 4 columns."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518509182, "post_id": 48760004, "comment_id": 84524421, "body": "Ah, sorry I changed the values."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518509502, "post_id": 48760004, "comment_id": 84524578, "body": "The issue is that I would like to check if the event type is &#39;high&#39; and severity is &#39;1&#39; before printing out &#39;DT24/SIG  Repair doors&#39; and &#39;90430/RSO&#39; &#39;Repair lift&#39;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1518509627, "post_id": 48760004, "comment_id": 84524634, "body": "yep, select first, print later."}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1518520680, "post_id": 48760004, "comment_id": 84531335, "body": "If you would write <code>equipment &lt;&lt; level[0]</code> you would already correctly collect the equipments. But @keithbennett &#39;s answer is better: first &quot;select&quot; the rows and then decide how you want to show it :)"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518596999, "post_id": 48760004, "comment_id": 84566563, "body": "I would get &quot;undefined local variable or method &#39;equipment&#39;, I would like to the logic of my code and will try Keith&#39;s code."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518596900, "post_id": 48762249, "comment_id": 84566520, "body": "Hi for the code &#39;def filter_by_event_type_and_severity(alarms, event_type, severity)&#39; I get an error &quot;wrong number of arguments (given 2, expected 3&quot;) would you know how to fix this? Thanks!"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518606008, "post_id": 48762249, "comment_id": 84572393, "body": "Sounds like you&#39;re only passing 2 arguments. I added the first argument, the array of records, to what you had. So maybe that&#39;s the one that&#39;s missing? You can post code to show us; one site for that is gist.github.com."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518611109, "post_id": 48762249, "comment_id": 84575796, "body": "<a href=\"https://gist.github.com/kaeltharlas/cdeddca2d0d71dbeea40ffa160fbb27b\" rel=\"nofollow noreferrer\">gist.github.com/kaeltharlas/cdeddca2d0d71dbeea40ffa160fbb27b</a> Here&#39;s the code. It&#39;s the same as yours, could you try to run it? Thanks!"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518620939, "post_id": 48762249, "comment_id": 84582613, "body": "Sorry, I corrected the code in my answer, and didn&#39;t think you would have copied it so fast so I didn&#39;t mention it. Try copying the last 3 lines of the code currently in the answer and replacing the corresponding 3 last lines of your code."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518656959, "post_id": 48762249, "comment_id": 84600047, "body": "It works now, thank you very much!! I&#39;ve tried to edit your code to have the equipment and description on the same array. (\\n will be the next row of equipment and description) But I&#39;ve gotten other results. Could you enlighten me on this?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 1, "creation_date": 1518673048, "post_id": 48762249, "comment_id": 84603779, "body": "One way to create the display line would be to use printf-style formatting to put the entries in aligned columns, like this: <code>eq_and_desc_lines = target_alarms.map { |alarm| &quot;%-15.15s%s&quot; % [alarm[0], alarm[3]] }</code>. You might need to adjust the width setting for proper alignment."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518674824, "post_id": 48762249, "comment_id": 84604375, "body": "If I would like to send it as an sms, all I need is to have it stored in an array am I right?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518676774, "post_id": 48762249, "comment_id": 84605132, "body": "I have no idea. What does the SMS interface require? It&#39;s probably a single string, and it may not accommodate the size that you need. If it were possible to send an attachment, perhaps you could send it as a text file, but I don&#39;t think that&#39;s possible with SMS -- maybe MMS?"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518679177, "post_id": 48762249, "comment_id": 84606099, "body": "Hmm I\u2019ll work on it on the weekends and will post something up next week. Thank you very much for your help though! I really appreciate it"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518925170, "post_id": 48762249, "comment_id": 84700283, "body": "Hi Keith, I was wondering how would you combine equipments and descriptions to one single array?"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518928677, "post_id": 48762249, "comment_id": 84700807, "body": "What would you want each element of the array to look like?"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518929299, "post_id": 48762249, "comment_id": 84700912, "body": "I&#39;m not sure if array is the correct term.. After filtering the event type and severity, I would need the output to be [&quot;Equipment&quot;, &quot;Description&quot;] ."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 1, "creation_date": 1518929420, "post_id": 48762249, "comment_id": 84700931, "body": "<code>target_alarms.map { |alarm| [alarm[0], alarm[3]] }</code>"}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518929632, "post_id": 48762249, "comment_id": 84700962, "body": "Would there be another command to split up my iteration?  That is to say, I would like the rows to be seperated and printf seperately"}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518929705, "post_id": 48762249, "comment_id": 84700971, "body": "If you mean one on each line, <code>puts</code> will do that for arrays."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518931582, "post_id": 48762249, "comment_id": 84701249, "body": "Ah I see. As I picture my program to be reading data real-time. Currently, this code would send a bunch a code at one go. I was wondering it\u2019s possible to send a row at a time."}, {"owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "reply_to_user": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1518969855, "post_id": 48762249, "comment_id": 84710719, "body": "I&#39;m not sure I understand, if you mean have a stream of records constantly being analyzed, then one way to do it is to write to a log file as the events are occurring, and calling <code>tail -f</code> on the file to display the most recent lines in a terminal window."}, {"owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "edited": false, "score": 0, "creation_date": 1519005868, "post_id": 48762249, "comment_id": 84720719, "body": "Hi Keith, I have posted another question to state the issue in a more concise format. Thank you for your inputs on this question, I hope you could check out the other question <a href=\"https://stackoverflow.com/questions/48858646/twilio-sms-using-ruby\" title=\"twilio sms using ruby\">stackoverflow.com/questions/48858646/twilio-sms-using-ruby</a>"}], "tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": true, "score": 2, "last_activity_date": 1518516901, "last_edit_date": 1518516901, "creation_date": 1518509886, "answer_id": 48762249, "question_id": 48760004, "link": "https://stackoverflow.com/questions/48760004/how-print-column-data-given-conditions-csv-ruby/48762249#48762249", "title": "How print column data given conditions? CSV Ruby", "body": "<p>I suggest breaking down the tasks into methods for their respective responsibilities. You have here loading, filtering, and transforming. The methods could reflect that. (I haven't tested this code, but this should show the general idea.)</p>\n\n<p>I think you'd be better off with something like this:</p>\n\n<pre><code>require \"csv\"\n\ndef load_alarms\n  CSV.read 'alarms.csv', {col_sep: ';'}\nend\n\ndef filter_by_event_type_and_severity(alarms, event_type, severity)\n  alarms.select do |alarm|\n    alarm[1] == event_type &amp;&amp; alarm[2].to_i == severity.to_i\n  end\nend\n\ntarget_alarms = filter_by_event_type_and_severity(\n    load_alarms, 'high', 1)\nequipments   = target_alarms.map { |alarm| alarm[0] }\ndescriptions = target_alarms.map { |alarm| alarm[3] }\n\np target_alarms\np equipments\np descriptions\n</code></pre>\n\n<p>Even if the implementations of the methods are trivially simple, this will give you the practice of separating code into logical parts, each of which is highly cohesive or specialized, with minimal coupling (dependency) on other parts of the code.</p>\n\n<p>One of the biggest mistakes of beginners is trying to do too much in the same chunk of code -- high and low level code, and with totally unrelated subjects. Learning how to break problems down into smaller problems, and logically organizing them, is one of the important skills you can learn.</p>\n\n<p>By the way, I don't recommend the <code>to_i</code> call on <code>severity</code>. Since the parameter is logically a number, you shouldn't really permit a string, IMO.</p>\n"}], "owner": {"reputation": 59, "user_id": 9320758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/1956448207702706/picture?type=large", "display_name": "Joshua Ng", "link": "https://stackoverflow.com/users/9320758/joshua-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 48762249, "answer_count": 1, "score": 0, "last_activity_date": 1518516901, "creation_date": 1518499647, "last_edit_date": 1518509134, "question_id": 48760004, "link": "https://stackoverflow.com/questions/48760004/how-print-column-data-given-conditions-csv-ruby", "title": "How print column data given conditions? CSV Ruby", "body": "<p>I'm new to programming. Is there a way for Ruby to select the conditions for column 1 and 2, while I print columns 0 and 3 (In the context of the same row)</p>\n\n<p>Take for example I would like to print out the \"description\" and \"equipment\" when there is an event type of \"high\" and severity \"1\". </p>\n\n<p><a href=\"https://i.stack.imgur.com/7mCbA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7mCbA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I could not print out my equipment and description</p>\n\n<pre><code>require \"csv\"\nequipment = []\ndescription = []\ndef find_severity(event_type, severity)\n    alarms = CSV.read 'alarms.csv', {col_sep: ';'}\n    result = alarms.select do |level|\n          level[1] == event_type &amp;&amp; level[2].to_i == severity.to_i\n          equipment[] = level[0]\n          description[] = level[3]\n    end\nend\n\np find_severity('high', 1)\np equipment\np description\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 9282049, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/9Ad4U.jpg?s=128&g=1", "display_name": "Nonsense", "link": "https://stackoverflow.com/users/9282049/nonsense"}, "edited": false, "score": 0, "creation_date": 1518503435, "post_id": 48760594, "comment_id": 84521851, "body": "Your advice did not help me"}, {"owner": {"reputation": 6003, "user_id": 4799035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuyZM.jpg?s=128&g=1", "display_name": "Christopher Jones", "link": "https://stackoverflow.com/users/4799035/christopher-jones"}, "edited": false, "score": 1, "creation_date": 1518579327, "post_id": 48760594, "comment_id": 84560098, "body": "It&#39;s often more convenient to use ldconfig as described by @anthony-l This avoids having to set LD_LIBRARY_PATH in each shell that invokes ruby."}], "tags": [], "owner": {"reputation": 1594, "user_id": 2681997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qgKiM.jpg?s=128&g=1", "display_name": "Ajay Barot", "link": "https://stackoverflow.com/users/2681997/ajay-barot"}, "is_accepted": true, "score": 3, "last_activity_date": 1518504003, "last_edit_date": 1518504003, "creation_date": 1518502776, "answer_id": 48760594, "question_id": 48759928, "link": "https://stackoverflow.com/questions/48759928/trouble-installing-ruby-oci8-gem/48760594#48760594", "title": "Trouble installing ruby-oci8 gem", "body": "<p>You have to set <code>LD_LIBRARY_PATH</code> to install <code>ruby-oci8</code> gem. Here I am assuming you are using linux os. Try this on your terminal.</p>\n\n<pre><code>$ LD_LIBRARY_PATH=$ORACLE_HOME/lib\n$ export LD_LIBRARY_PATH\n$ gem install ruby-oci8\n</code></pre>\n\n<p>Edit: </p>\n\n<p>If you uses <code>mswin32</code> ruby, use the following command instead.</p>\n\n<pre><code>gem install --platform x86-mingw32 ruby-oci8\n  or\ngem install --platform x64-mingw32 ruby-oci8\n</code></pre>\n\n<p>Let me know If you have any query or question.</p>\n\n<p>Happy Coding</p>\n"}, {"tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": false, "score": 4, "last_activity_date": 1518504569, "creation_date": 1518504569, "answer_id": 48761001, "question_id": 48759928, "link": "https://stackoverflow.com/questions/48759928/trouble-installing-ruby-oci8-gem/48761001#48761001", "title": "Trouble installing ruby-oci8 gem", "body": "<p>These steps take you through the instant client installation process as well, just to provide some context. Download the instant and SDK zip files here:</p>\n\n<p><a href=\"http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html\" rel=\"nofollow noreferrer\">http://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html</a></p>\n\n<p>Unzip both files in the following directory as root.</p>\n\n<p>/opt/oracle</p>\n\n<p>Enter the instantclient_12_2 directory following the unzip and create a symlink for the libclntsh.so file:</p>\n\n<pre><code>ln -s libclntsh.so.12.1 libclntsh.so\n</code></pre>\n\n<p>Now, depending on your OS, you'll need to update your LD_LIBRARY_PATH location.  In Ubuntu, do the following:</p>\n\n<pre><code>sudo nano /etc/ld.so.conf.d/moreLibs.conf\n</code></pre>\n\n<p>And enter the following in the file and save</p>\n\n<pre><code>/opt/oracle/instantclient_12_2\n</code></pre>\n\n<p>Now run the following command:</p>\n\n<pre><code>sudo ldconfig\n</code></pre>\n\n<p>And rerun your gem install</p>\n\n<pre><code>gem install ruby-oci8\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663, "user_id": 7536631, "user_type": "registered", "profile_image": "https://graph.facebook.com/1255313637849608/picture?type=large", "display_name": "Aman Kumar", "link": "https://stackoverflow.com/users/7536631/aman-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1569362255, "creation_date": 1569362255, "answer_id": 58088648, "question_id": 48759928, "link": "https://stackoverflow.com/questions/48759928/trouble-installing-ruby-oci8-gem/58088648#58088648", "title": "Trouble installing ruby-oci8 gem", "body": "<p>This solution worked for me</p>\n\n<p>Before executing bundle install, Run below code on the console or add it to bash and source.</p>\n\n<p><code>Export OCI_DIR=/opt/oracle/instantclient_12_2</code></p>\n\n<p>Here <code>/opt/oracle/instantclient_12_2</code> is path to instantclient on my <code>mac</code> machine.</p>\n\n<p>You need to download <code>instantclient</code> from\n<a href=\"https://www.oracle.com/database/technologies/instant-client/downloads.html\" rel=\"nofollow noreferrer\">https://www.oracle.com/database/technologies/instant-client/downloads.html</a>\nUnzip the download into <code>/opt/oracle</code> directory and export <code>OCI_DIR</code> environment variable.</p>\n"}, {"tags": [], "owner": {"reputation": 443, "user_id": 5399719, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K5w2LVidDhM/AAAAAAAAAAI/AAAAAAAAABY/Uem4aXd-mvE/photo.jpg?sz=128", "display_name": "Junjie", "link": "https://stackoverflow.com/users/5399719/junjie"}, "is_accepted": false, "score": 0, "last_activity_date": 1607776916, "creation_date": 1607776916, "answer_id": 65265046, "question_id": 48759928, "link": "https://stackoverflow.com/questions/48759928/trouble-installing-ruby-oci8-gem/65265046#65265046", "title": "Trouble installing ruby-oci8 gem", "body": "<p>I have a similar problem installing the <code>ruby-oci8</code> gem. In my case, there is already an app that uses it. When I deployed another app using the same gem, during bundle install, this error occurred. It asked for the <code>LD_LIBRARY_PATH</code> environment variable. Apparently, the installer of the old app did not set the variable to persist.</p>\n<p>I thought that there should be an oracle library somewhere in the server so I searched for it. It was not in <code>/opt</code> but in <code>/usr/lib</code>. I set the variable to <code>/usr/lib/oracle/11.1/client64/lib</code> then the gem was installed smoothly.</p>\n"}], "owner": {"reputation": 136, "user_id": 9282049, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/9Ad4U.jpg?s=128&g=1", "display_name": "Nonsense", "link": "https://stackoverflow.com/users/9282049/nonsense"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6223, "favorite_count": 0, "accepted_answer_id": 48760594, "answer_count": 4, "score": 3, "last_activity_date": 1607776916, "creation_date": 1518499135, "last_edit_date": 1518499569, "question_id": 48759928, "link": "https://stackoverflow.com/questions/48759928/trouble-installing-ruby-oci8-gem", "title": "Trouble installing ruby-oci8 gem", "body": "<p>I'm trying to install a gem <code>ruby-oci8</code> on the rails. </p>\n\n<p>I get the following error,</p>\n\n<p><strong>$ gem install ruby-oci8</strong></p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing ruby-oci8:\n        ERROR: Failed to build gem native extension.\n\n    current directory: /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8\n/home/solovievga/.rvm/rubies/ruby-2.4.2/bin/ruby -r ./siteconf20180213-21757-1hli0rl.rb extconf.rb\nchecking for load library path...\n  LD_LIBRARY_PATH is not set.\n  checking ld.so.conf... no\nchecking for cc... ok\nchecking for gcc... yes\nchecking for LP64... yes\nchecking for sys/types.h... yes\nchecking for ruby header... ok\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/home/solovievga/.rvm/rubies/ruby-2.4.2/bin/$(RUBY_BASE_NAME)\n        --with-instant-client\n        --without-instant-client\n/home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:909:in `get_home': RuntimeError (RuntimeError)\n        from /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:728:in `initialize'\n        from /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:269:in `new'\n        from /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:269:in `get'\n        from extconf.rb:22:in `&lt;main&gt;'\n---------------------------------------------------\nError Message:\n  Set the environment variable ORACLE_HOME if Oracle Full Client.\n  Append the path of Oracle client libraries to LD_LIBRARY_PATH if Oracle Instant Client.\n\nBacktrace:\n  /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:909:in `get_home'\n  /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:728:in `initialize'\n  /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:269:in `new'\n  /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1/ext/oci8/oraconf.rb:269:in `get'\n  extconf.rb:22:in `&lt;main&gt;'\n---------------------------------------------------\nSee:\n * http://www.rubydoc.info/github/kubo/ruby-oci8/file/docs/install-full-client.md for Oracle full client\n * http://www.rubydoc.info/github/kubo/ruby-oci8/file/docs/install-instant-client.md for Oracle instant client\n * http://www.rubydoc.info/github/kubo/ruby-oci8/file/docs/install-on-osx.md for OS X\n * http://www.rubydoc.info/github/kubo/ruby-oci8/file/docs/report-installation-issue.md to report an issue.\n\n\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\n\n  /home/solovievga/.rvm/gems/ruby-2.4.2/extensions/x86_64-linux/2.4.0/ruby-oci8-2.2.5.1/mkmf.log\n\nextconf failed, exit code 1\n\nGem files will remain installed in /home/solovievga/.rvm/gems/ruby-2.4.2/gems/ruby-oci8-2.2.5.1 for inspection.\nResults logged to /home/solovievga/.rvm/gems/ruby-2.4.2/extensions/x86_64-linux/2.4.0/ruby-oci8-2.2.5.1/gem_make.out\n</code></pre>\n\n<p>I wonder how I can install the ruby-oci8 package?</p>\n"}, {"tags": ["ruby", "mongodb", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 1678507, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0cd304d6ac3283b12ab4aad363ce1f8f?s=128&d=identicon&r=PG", "display_name": "Dishcandanty", "link": "https://stackoverflow.com/users/1678507/dishcandanty"}, "is_accepted": false, "score": 0, "last_activity_date": 1587967285, "creation_date": 1587967285, "answer_id": 61452604, "question_id": 48759795, "link": "https://stackoverflow.com/questions/48759795/how-do-i-query-mongoid-in-ruby-with-any-of-and-any-in/61452604#61452604", "title": "How do I query MongoID in ruby with any_of and any_in?", "body": "<p>Probably not the answer you were looking for. But closes question I could find. And the only solution I could come up with (and so anyone gets some help). Here's what I ended up with:</p>\n\n<pre><code>Modal.all_of({visibility: true}, {\"$or\" =&gt; query})\n</code></pre>\n\n<p>This seems to correctly return anything that is 'visibility: true' AND anything that is in my or selectors:</p>\n\n<pre><code>query = [{:songs.gte =&gt; 1},{:books.gte =&gt; 1}]\n</code></pre>\n"}], "owner": {"reputation": 9222, "user_id": 307428, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a598c573fb032f717dd0754250366cc9?s=128&d=identicon&r=PG", "display_name": "jdog", "link": "https://stackoverflow.com/users/307428/jdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1587967285, "creation_date": 1518498327, "question_id": 48759795, "link": "https://stackoverflow.com/questions/48759795/how-do-i-query-mongoid-in-ruby-with-any-of-and-any-in", "title": "How do I query MongoID in ruby with any_of and any_in?", "body": "<p>I have some Requests that looks like this.</p>\n\n<pre><code>Request: 1\nassigned_id: xyz\nassigned_2_id: nil\ncheck_number: 1234\ncheck_number_helper: nil\n\nRequest: 2\nassigned_id: abc\nassigned_2_id: xyz\ncheck_number: 3344\ncheck_number_helper: 1234\n\nRequest: 3\nassigned_id: xyz\nassigned_2_id: ffg\ncheck_number: 1234\ncheck_number_helper: 6678\n\nRequest: 4\nassigned_id: xyz\nassigned_2_id: ffg\ncheck_number: 7777\ncheck_number_helper: 6678\n</code></pre>\n\n<p>I need to find every Request where the assigned_id or assigned_2_id is xyz <strong>AND</strong> the check_number or check_number_helper is 1234</p>\n\n<p>I tried the following but it returns all matches assigned_id, assigned_2_id, check_number, and check_number_helper (so in the data above it returns all Requests) as it matches at least one field.</p>\n\n<pre><code>Request.any_of({:assigned_2_id =&gt; assigned_id.to_s}, {:assigned_id =&gt; assigned_id.to_s}).any_of({:check_number =&gt; check_num}, {:check_number_helper =&gt; check_num}).asc(:timestamp_requested)\n</code></pre>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "rss"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 1, "creation_date": 1518476279, "post_id": 48756922, "comment_id": 84514943, "body": "change the <code>&lt;%= @rss %&gt;</code> to <code>&lt;% @rss %&gt;</code> so ERB doesn&#39;t render the <code>@rss</code>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 9027694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoihP.jpg?s=128&g=1", "display_name": "JoeyMousepad", "link": "https://stackoverflow.com/users/9027694/joeymousepad"}, "edited": false, "score": 1, "creation_date": 1518480597, "post_id": 48757560, "comment_id": 84516163, "body": "That did it!! Thank you so much!!"}], "tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": true, "score": 0, "last_activity_date": 1518480288, "creation_date": 1518480288, "answer_id": 48757560, "question_id": 48756922, "link": "https://stackoverflow.com/questions/48756922/rails-4-how-to-display-an-rss-feed-on-html-view/48757560#48757560", "title": "Rails 4; How to Display an RSS Feed on HTML View?", "body": "<p>The issue is that <code>&lt;%=</code> differs from <code>&lt;%</code></p>\n\n<p>The equals sign tells rails \"spit out the result of the current ruby statement onto the screen into your html\"... in this case, you are spitting out the result of the ruby-code: <code>@rss.items.each</code>... which happens to return the value of <code>@rss.items</code> (which is all of your rss feed).</p>\n\n<p>For ruby-statements that don't need to output to the screen (like this), just change to using the non-equals-sign version: <code>&lt;%</code> and you should be good to go.</p>\n"}], "owner": {"reputation": 67, "user_id": 9027694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoihP.jpg?s=128&g=1", "display_name": "JoeyMousepad", "link": "https://stackoverflow.com/users/9027694/joeymousepad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 48757560, "answer_count": 1, "score": 0, "last_activity_date": 1518480288, "creation_date": 1518476221, "question_id": 48756922, "link": "https://stackoverflow.com/questions/48756922/rails-4-how-to-display-an-rss-feed-on-html-view", "title": "Rails 4; How to Display an RSS Feed on HTML View?", "body": "<p>I'm building a personal website using Ruby with Rails 4. </p>\n\n<p>I'm attempting to scrape Medium.com and have my Medium articles show up on my page. It's almost working, they <em>are</em> displaying on my page how I would want them, but it also displays the entire RSS code underneath my blog posts. I can't figure out how to get this data dump off my view. </p>\n\n<p>What can I do to change this? </p>\n\n<p>Here is my code on the controller: </p>\n\n<pre><code>def blog\n    require 'rubygems'\n    require 'rss'\n    require 'open-uri'\n\n    @rss = RSS::Parser.parse('https://medium.com/feed/@AlextheYounger/')\nend\n</code></pre>\n\n<p>Here is the code on my HTML view: </p>\n\n<pre><code>    &lt;%= @rss.items.each do |item|%&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div id=\"article-div\" class=\"col-xs-8\"&gt;\n        &lt;div class= \"well well-lg\"&gt;\n          &lt;div class= \"article-title\"&gt;\n            &lt;p&gt;&lt;%=\"#{item.title}\"%&gt;&lt;/p&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n   &lt;% end %&gt;\n</code></pre>\n\n<p>Again, it actually does display my blog posts, it just does so with a massive data dump included. How do I get rid of this massive data dump?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1518476431, "post_id": 48756912, "comment_id": 84514996, "body": "Ruby style dictates names like <code>compare_from</code> in preference to <code>compareFrom</code> as capital letters have significant syntactical meaning. The <code>for</code> statement is also almost never used as <code>emp_data.each |r|</code> is the more typical form."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1518507829, "post_id": 48756912, "comment_id": 84523780, "body": "What is <code>empData</code> and where does <code>employeeName</code> come from? Is that part of the example code actually needed to reproduce the problem?"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1518476559, "creation_date": 1518476559, "answer_id": 48756985, "question_id": 48756912, "link": "https://stackoverflow.com/questions/48756912/how-to-compare-two-arrays-in-ruby/48756985#48756985", "title": "How to compare two arrays in Ruby", "body": "<p>This code boils down to:</p>\n\n<pre><code>compare_from = emp_data.map(&amp;:employee_name)\n</code></pre>\n\n<p>Where that's calling the <code>employee_name</code> method on each of the items in the <code>emp_data</code> array and returning a new array with the result. You can easily test overlap on two arrays using <code>&amp;</code> to find the intersection:</p>\n\n<pre><code>compare_to = [\"John Doe\", \"Eric Schulz\", \"Tom Jerry\"]\ncommon = compare_from &amp; compare_to\n</code></pre>\n\n<p>If that array <code>common</code> has any entries then you have matches.</p>\n"}, {"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1518519495, "post_id": 48757955, "comment_id": 84530701, "body": "Hmm, why not math notation, <code>Set[compare_to] &lt;= Set[compare_from]</code> or <code>Set[compare_from] &gt;= Set[compare_to]</code>?"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1518483398, "creation_date": 1518483398, "answer_id": 48757955, "question_id": 48756912, "link": "https://stackoverflow.com/questions/48756912/how-to-compare-two-arrays-in-ruby/48757955#48757955", "title": "How to compare two arrays in Ruby", "body": "<p><code>Array#include?</code> only tests membership of one element in an array. Your <code>compare_from.include?(compare_to)</code> tests whether <code>compare_to</code> is an element of <code>compare_from</code>, and would e.g. return <code>true</code> in case <code>compare_from</code> is <code>[1, 2, 3, [\"John Doe\", \"Eric Schulz\", \"Tom Jerry\"], 5]</code>.</p>\n\n<p>If you want to see if all elements of <code>compare_to</code> are in <code>compare_from</code>, <code>compare_to.all? { |element| compare_from.include?(element) }</code> is idiomatic and legible but slow; tadman's <code>(compare_from &amp; compare_to).size == compare_to.size</code> is much more performant. A third option, when speaking of subsets, and the one I'd likely prefer, is to use sets:</p>\n\n<pre><code>require 'set'\nSet[compare_to].subset?(Set[compare_from])\n</code></pre>\n"}], "owner": {"reputation": 18133, "user_id": 275390, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/27f1b1529989513cd8a171a48dac1e5e?s=128&d=identicon&r=PG", "display_name": "Nick Kahn", "link": "https://stackoverflow.com/users/275390/nick-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1518516848, "creation_date": 1518476181, "last_edit_date": 1518516848, "question_id": 48756912, "link": "https://stackoverflow.com/questions/48756912/how-to-compare-two-arrays-in-ruby", "title": "How to compare two arrays in Ruby", "body": "<p>I'm trying to compare two arrays:</p>\n\n<pre><code>compareFrom = []\ncompareTo = [\"John Doe\", \"Eric Schulz\", \"Tom Jerry\"]\n</code></pre>\n\n<p>I tried the following:</p>\n\n<pre><code>arrayField1 = []\nfor r in empData\n  compareFrom &lt;&lt; r.employeeName\nend\n\nif compareFrom.include?(compareTo)\n  #yes got it\nend\n</code></pre>\n\n<p>I cannot figure out why I get <code>false</code> even though <code>compareFrom</code> has the same values as <code>compareTo</code>.</p>\n\n<p>Is there anything that I need to change in the code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "devise"], "comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 1, "creation_date": 1518476589, "post_id": 48756818, "comment_id": 84515038, "body": "Why don&#39;t you start by sharing some code, will help to see whats happening"}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1518480394, "post_id": 48756818, "comment_id": 84516103, "body": "Definitely give us some code to look at. From what you describe, I&#39;d be suspecting session-variables, and that heroku has more than one dyno (and doesn&#39;t share sessions)? Are you using database-sessions?"}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "edited": false, "score": 0, "creation_date": 1518480963, "post_id": 48756818, "comment_id": 84516262, "body": "Not using database sessions, one dyno only as well. There isnt much code except boilerplate devise, I would love to post more stacktrace from the server but even that is just inconclusive unauthorized 401"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1518490768, "post_id": 48756818, "comment_id": 84518445, "body": "Why did it fail? You should show the error message to see what happen. It&#39;s the way of tracking error, we need to see details"}, {"owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "edited": false, "score": 0, "creation_date": 1518539268, "post_id": 48756818, "comment_id": 84543726, "body": "Is there any reference in devise to &#39;failed to login&#39; string?"}], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 766115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f477aea4fdfcbfed703203a2e1e88e?s=128&d=identicon&r=PG", "display_name": "Jesse Smith", "link": "https://stackoverflow.com/users/766115/jesse-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1555708614, "creation_date": 1555708614, "answer_id": 55767964, "question_id": 48756818, "link": "https://stackoverflow.com/questions/48756818/using-rails-devise-but-getting-failed-to-login-and-signed-in-successfully-in-d/55767964#55767964", "title": "Using rails + devise but getting Failed to Login and Signed in successfully in different browsers", "body": "<p>I was getting this error, and here's my findings and solution incase it helps others in the future.</p>\n\n<p>The <code>Failed to Login</code> message actually comes from Warden, which is packed under Devise. <a href=\"https://github.com/wardencommunity/warden/blob/5b3cbd5bef67cbe399bb7007537bc4841bbee772/lib/warden/strategies/base.rb#L136\" rel=\"nofollow noreferrer\">https://github.com/wardencommunity/warden/blob/5b3cbd5bef67cbe399bb7007537bc4841bbee772/lib/warden/strategies/base.rb#L136</a></p>\n\n<p>So, as devise is going through it's list of strategies to test for authentication, if any of them call <code>strategy.fail!</code> the process will halt, and the failure message will be passed up the chain to device to display in the flash message. In this case, that's the message you see. </p>\n\n<p>For me, this was happening because my JWT token was failing to decode, and my custom devise strategy for handling the JWT tokens was rescuing and calling <code>fail!</code> without a custom error message in that case. This approach looks a little safer as it will pass a more helpful message: <a href=\"https://medium.com/@lukerollans/implementing-jwt-authentication-as-a-custom-devise-strategy-54948bddb134\" rel=\"nofollow noreferrer\">https://medium.com/@lukerollans/implementing-jwt-authentication-as-a-custom-devise-strategy-54948bddb134</a></p>\n\n<p>So I guess one of your devise strategies is calling <code>fail</code> or <code>fail!</code> somewhere along the way. Good luck!</p>\n"}], "owner": {"reputation": 456, "user_id": 1213306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41f44109c87f57c2fb8932b97e686150?s=128&d=identicon&r=PG", "display_name": "alexanderkustov", "link": "https://stackoverflow.com/users/1213306/alexanderkustov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555708614, "creation_date": 1518475722, "question_id": 48756818, "link": "https://stackoverflow.com/questions/48756818/using-rails-devise-but-getting-failed-to-login-and-signed-in-successfully-in-d", "title": "Using rails + devise but getting Failed to Login and Signed in successfully in different browsers", "body": "<p>Having setup a simple devise rails app with:\n<code>:database_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable, :confirmable</code> I am seeing different results in two browsers or within the same browser and incognito mode.</p>\n\n<p>I register fine and it logs me in instantly, if i logout and try logging again i will find the message <code>Failed to Login</code>, where does it come from? Can I debug or inspect more of it?</p>\n\n<p>Going to incognito mode in Chrome, or using a different browser logs me in almost instantly, without seeing that Failed to Login message.</p>\n\n<p>I can almost never replicate this in development mode, but on Heroku it's happening constantly.</p>\n\n<p>Any clues to even start debugging? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "nokogiri", "open-uri"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1518476207, "post_id": 48756402, "comment_id": 84514919, "body": "I think you want <code>@url = watched_link_params[:url]</code>. Then you can avoid the mess you are making with converting the hash to a string and then slicing out the part that you want."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5499383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de6a14b5b7ca748d731bdddbd65e2b85?s=128&d=identicon&r=PG&f=1", "display_name": "Padu", "link": "https://stackoverflow.com/users/5499383/padu"}, "edited": false, "score": 0, "creation_date": 1518481159, "post_id": 48757009, "comment_id": 84516314, "body": "Thank you, that fixed it and I have also removed that mess with the slicing."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 1, "last_activity_date": 1518477451, "last_edit_date": 1518477451, "creation_date": 1518476710, "answer_id": 48757009, "question_id": 48756402, "link": "https://stackoverflow.com/questions/48756402/rails-wont-read-a-link-with-nokogiri-and-open-uri/48757009#48757009", "title": "Rails won&#39;t read a link with nokogiri and open-uri", "body": "<p>Try this:</p>\n\n<pre><code>def scrape\n  @url = watched_link_params[:url]\n\n  page = Nokogiri::HTML(open(@url))\n  puts page\nend\n</code></pre>\n\n<p>You will need to pass in the entire url, including the protocol designator; that is to say, you need to use <code>http://www.google.com</code> instead of <code>www.google.com</code>:</p>\n\n<pre><code>&gt;&gt; params = ActionController::Parameters.new(default: {url: 'http://www.google.com'})\n&gt;&gt; watched_link_params = params.require(:default).permit(:url)\n&gt;&gt; @url = watched_link_params[:url]\n\"http://www.google.com\"\n&gt;&gt; page = Nokogiri::HTML(open(@url))\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5499383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de6a14b5b7ca748d731bdddbd65e2b85?s=128&d=identicon&r=PG&f=1", "display_name": "Padu", "link": "https://stackoverflow.com/users/5499383/padu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 48757009, "answer_count": 1, "score": 0, "last_activity_date": 1518477451, "creation_date": 1518473616, "question_id": 48756402, "link": "https://stackoverflow.com/questions/48756402/rails-wont-read-a-link-with-nokogiri-and-open-uri", "title": "Rails won&#39;t read a link with nokogiri and open-uri", "body": "<p>I have a controller which gets a url passed as a parameter and I am trying to scrape the entire page at that url. But when I try to read the url I get the following error: <code>No such file or directory @ rb_sysopen - www.google.com</code> </p>\n\n<p>Controller:</p>\n\n<pre><code>lass PageScraperController &lt; ApplicationController\n    require 'nokogiri'\n    require 'open-uri'\n    require 'diffy'\n    require 'htmlentities'\n\n    def scrape\n    require 'open-uri'\n        @url = watched_link_params.to_s\n        @url = @url.slice(9..@url.length-3)\n        puts \"LOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOG#{@url}\"\n\n        page = Nokogiri::HTML(open(@url))\n        # coder = HTMLEntities.new\n        # encodedHTML = coder.encode(page)\n        puts page\n\n     end\n\n    def watched_link_params\n\n        params.require(:default).permit(:url)\n\n    end\n\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518472972, "post_id": 48756184, "comment_id": 84513538, "body": "You should post the code that causes the error, but it seems you are applying the <code>.messages</code> to many conversations (or other association) and not a unique conversation."}, {"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "reply_to_user": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "edited": false, "score": 0, "creation_date": 1518473295, "post_id": 48756184, "comment_id": 84513702, "body": "@Pablo I added the code block as you suggested"}], "answers": [{"comments": [{"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473312, "post_id": 48756258, "comment_id": 84513714, "body": "It&#39;s still the same, maybe the information I added would help?"}], "tags": [], "owner": {"reputation": 2765, "user_id": 5864985, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/UlhbW.jpg?s=128&g=1", "display_name": "Ronan Lopes", "link": "https://stackoverflow.com/users/5864985/ronan-lopes"}, "is_accepted": false, "score": 0, "last_activity_date": 1518472967, "creation_date": 1518472967, "answer_id": 48756258, "question_id": 48756184, "link": "https://stackoverflow.com/questions/48756184/inconsistent-rails-method-exists-and-any/48756258#48756258", "title": "Inconsistent rails method `exists` and `any?`", "body": "<p>Did you tried with <code>present?</code> method? Guess it would work better... like this:</p>\n\n<pre><code>@conversation.messages.present?\n</code></pre>\n\n<p>It will return false if messages is nil or empty, so I guess it fits better. Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473399, "post_id": 48756331, "comment_id": 84513762, "body": "That&#39;s what I thought, but considering the fact that I&#39;m looking for the appropriate conversation using the <code>where</code> clause and since only one conversation can exist like this so it shouldn&#39;t be the case right?"}, {"owner": {"reputation": 386, "user_id": 9306590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/859e0e0a063bd3262f303dd978854a96?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/9306590/mitch"}, "reply_to_user": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473577, "post_id": 48756331, "comment_id": 84513858, "body": "<code>where</code> always returns a relation, not a single instance. which is nice, because you don&#39;t have to worry about what it&#39;s returning. but in this case, you need <code>find_by</code> or <code>where(...).first</code>"}, {"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473618, "post_id": 48756331, "comment_id": 84513877, "body": "Hmm okay, that makes sense. Thanks for the detailed explanation, I&#39;m sure it&#39;ll help me a lot in the future also"}], "tags": [], "owner": {"reputation": 386, "user_id": 9306590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/859e0e0a063bd3262f303dd978854a96?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/9306590/mitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1518473479, "last_edit_date": 1518473479, "creation_date": 1518473296, "answer_id": 48756331, "question_id": 48756184, "link": "https://stackoverflow.com/questions/48756184/inconsistent-rails-method-exists-and-any/48756331#48756331", "title": "Inconsistent rails method `exists` and `any?`", "body": "<p>That error is due to you calling <code>messages</code> on a <em>collection</em> of conversations rather than a <em>single</em> conversation.</p>\n\n<p>I'd be willing to bet the offending code is something like:</p>\n\n<p><code>client.conversations.messages #=&gt; NoMethodError</code></p>\n\n<p>Instead, it should be:</p>\n\n<p><code>client.conversations.first.messages</code></p>\n\n<p>EDIT - this is the line causing the error:</p>\n\n<p><code>@conversation = @client.conversations.where({ player_client: @game.player_client.id })</code></p>\n\n<p><code>where</code> will return a relation representing many conversations. If you only want a single conversation, you can use <code>find_by</code>:</p>\n\n<p><code>@conversation = @client.conversations.find_by({ player_client: @game.player_client.id })</code></p>\n"}, {"comments": [{"owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473436, "post_id": 48756350, "comment_id": 84513781, "body": "So what would be the best way to do it?"}, {"owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "reply_to_user": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "edited": false, "score": 0, "creation_date": 1518473518, "post_id": 48756350, "comment_id": 84513824, "body": "Already in the answer. Use find_by to select only one conversation"}], "tags": [], "owner": {"reputation": 2885, "user_id": 3372172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q3RaO.png?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/3372172/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1518473449, "last_edit_date": 1518473449, "creation_date": 1518473379, "answer_id": 48756350, "question_id": 48756184, "link": "https://stackoverflow.com/questions/48756184/inconsistent-rails-method-exists-and-any/48756350#48756350", "title": "Inconsistent rails method `exists` and `any?`", "body": "<p>In your code:</p>\n\n<pre><code>@conversation = @client.conversations.where({ player_client: @game.player_client.id })\n</code></pre>\n\n<p>is not a conversation. Is more than one. You cannot use messages there.</p>\n\n<p>If you need only one conversation, you must change where by find_by.</p>\n\n<p>If not, you need to iterate through all conversations.</p>\n"}, {"tags": [], "owner": {"reputation": 1483, "user_id": 3793234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pOraI.jpg?s=128&g=1", "display_name": "Hamdi Bayhan", "link": "https://stackoverflow.com/users/3793234/hamdi-bayhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1518473887, "creation_date": 1518473887, "answer_id": 48756453, "question_id": 48756184, "link": "https://stackoverflow.com/questions/48756184/inconsistent-rails-method-exists-and-any/48756453#48756453", "title": "Inconsistent rails method `exists` and `any?`", "body": "<p>The another way with <code>find_or_create_by</code> method:</p>\n\n<pre><code>@client.conversations.find_or_create_by(player_client: @game.player_client.id)\n</code></pre>\n\n<p>To find more info:</p>\n\n<p><a href=\"https://apidock.com/rails/v4.0.2/ActiveRecord/Relation/find_or_create_by\" rel=\"nofollow noreferrer\">https://apidock.com/rails/v4.0.2/ActiveRecord/Relation/find_or_create_by</a></p>\n"}], "owner": {"reputation": 2401, "user_id": 2873548, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b90a1fd45fc72bd55f8948b385d4626f?s=128&d=identicon&r=PG&f=1", "display_name": "anonn023432", "link": "https://stackoverflow.com/users/2873548/anonn023432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 48756331, "answer_count": 4, "score": 0, "last_activity_date": 1518473887, "creation_date": 1518472665, "last_edit_date": 1518473475, "question_id": 48756184, "link": "https://stackoverflow.com/questions/48756184/inconsistent-rails-method-exists-and-any", "title": "Inconsistent rails method `exists` and `any?`", "body": "<p>I'm working on a Ruby on Rails based chat. So I initially create a conversation between 2 clients when they add each other as friends and my model for <code>Conversation</code> is as follows:</p>\n\n<pre><code>class Conversation &lt; ActiveRecord::Base\n  has_many :messages\n  belongs_to :player_client\n  belongs_to :client\nend\n</code></pre>\n\n<p>Now when the <code>player_client</code> clicks a specific button I want to create an automated message for them. This should only happen if they've never sent a message to each other i.e. the conversation has no associated messages.</p>\n\n<p>Trying the following methods from the console:</p>\n\n<pre><code>@conversation = Conversation.find(7)\n@conversation.messages.any?\n&gt; False\n@conversation.messages.empty?\n&gt; True\n@conversation.messages.exists?\n&gt; False\n</code></pre>\n\n<p>Which are all expected values. But adding any of these methods in my Rails code throws an error:</p>\n\n<pre><code>NoMethodError (undefined method `messages' for #&lt;Conversation::ActiveRecord_AssociationRelation:0x007fa187ca1ec8&gt;)`\n</code></pre>\n\n<p>Which I guess is showing up because messages don't exist for that conversation so it can't find any association for that conversation. I'm not sure why this method would be inconsistent though.</p>\n\n<p>EDIT: Adding the error causing code.</p>\n\n<p>conversation_with_player_client = @client.conversations.select{|c| c.player_client_id == @game.player_client.id}</p>\n\n<pre><code>if conversation_with_player_client.count == 0\n  @conversation = @client.conversations.build({player_client_id: @game.player_client.id})\n  @conversation.save!\nelse\n  @conversation = @client.conversations.where({ player_client_id: @game.player_client.id })\nend\n\nputs \"the conversation we found was #{@conversation.inspect}\"\n# This gives the response\n# #&lt;Conversation id: 7, player_client_id: 1, client_id: 11, created_at: \"2018-02-12 20:55:55\", updated_at: \"2018-02-12 20:55:55\"&gt;\n# in the console so it can get the conversation \n\nif @conversation.messages.any?\n\n# this line is causing the error\n</code></pre>\n"}, {"tags": ["ruby", "encryption"], "comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 2, "creation_date": 1518473278, "post_id": 48755970, "comment_id": 84513698, "body": "<a href=\"https://stackoverflow.com/q/48492676/1672429\">stackoverflow.com/q/48492676/1672429</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1518477258, "post_id": 48756610, "comment_id": 84515260, "body": "This is very clear, but what do you mean by structureless books data? The first character is a period and then a Y... Which are not binary right?"}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1518478041, "post_id": 48756610, "comment_id": 84515514, "body": "So the original message is already encoded in ASCII format? But it really is just structureless binary data?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1518511806, "post_id": 48756610, "comment_id": 84525805, "body": "@Jwan622 Ruby only escapes non-printable characters when printing binary strings, so printable characters within the ASCII range are not distinguishable from ordinary text."}, {"owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1518533354, "post_id": 48756610, "comment_id": 84539758, "body": "@Stefan and I guess a correlary to what you&#39;re saying is that Ruby auto converts binary to ascii characters?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "edited": false, "score": 0, "creation_date": 1518534440, "post_id": 48756610, "comment_id": 84540578, "body": "@Jwan622 for displaying purposes, yes. Although <code>&quot;\\x68\\x65\\x6C\\x6C\\x6F&quot;</code> might be more consistent, it&#39;s much harder to read than <code>&quot;hello&quot;</code> ;-)"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1518474634, "creation_date": 1518474634, "answer_id": 48756610, "question_id": 48755970, "link": "https://stackoverflow.com/questions/48755970/ruby-pack-and-unpack-how-is-this-hexadecimal-conversion-being-done-could-use-s/48756610#48756610", "title": "Ruby pack and unpack. How is this hexadecimal conversion being done? Could use some assistance", "body": "<p><code>encrypted_message</code> is a string starting with the characters <code>.YI</code>. Let's convert those characters to Hex and then binary using the <a href=\"https://en.wikipedia.org/wiki/ASCII#Character_set\" rel=\"nofollow noreferrer\">ASCII</a> table:</p>\n\n<pre><code>ASCII  .        |Y        |I\nHex    2    e   |5    9   |4    9\nBinary 0010 1110|0101 1001|0100 1001\n</code></pre>\n\n<p>Notice that the hex is what you see at the beginning of the <code>unpack(H*)</code> result. If you were to call <code>encrypted_message.unpack(\"B*\")</code> (bit string), you would similarly see it start with </p>\n\n<pre><code>001011100101100101001001\n</code></pre>\n\n<p>The point is</p>\n\n<ol>\n<li>There is <em>no</em> \"encrypted message format\". <code>encrypted_message</code> is meaningless, structureless binary data.</li>\n<li>When you call <code>unpack</code>, you're saying \"Take this meaningless binary data, and show it to me with a different representation.\" In this case, hexadecimal digits. You can similarly see it as binary, like I did above. Or you can look at it as ASCII characters (the default), with <code>\\x</code> indicating a byte that doesn't have an ASCII representation. It's all the same binary data just being presented in different human-readable ways.</li>\n</ol>\n"}], "owner": {"reputation": 8818, "user_id": 2714301, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/23c7ba1f14e71e14f65b7b95516b0f19?s=128&d=identicon&r=PG", "display_name": "Jwan622", "link": "https://stackoverflow.com/users/2714301/jwan622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 48756610, "answer_count": 1, "score": 0, "last_activity_date": 1518525064, "creation_date": 1518471708, "last_edit_date": 1518471878, "question_id": 48755970, "link": "https://stackoverflow.com/questions/48755970/ruby-pack-and-unpack-how-is-this-hexadecimal-conversion-being-done-could-use-s", "title": "Ruby pack and unpack. How is this hexadecimal conversion being done? Could use some assistance", "body": "<p>I'm having a bit of trouble understanding some code:</p>\n\n<p>Things I understand:\n1. The use of the <code>Cipher</code> class and object and the encryption method.\n2. The address_string and how it is using <code>|</code> as a delimiter.\n3. The update.</p>\n\n<p>My questions:\n1. What is <code>cipher.final</code> doing?\n2. What is the unpack doing?</p>\n\n<pre><code>  cipher = OpenSSL::Cipher::Cipher.new('AES-256-CFB').encrypt\n  iv = cipher.random_iv\n  cipher.key = Digest::SHA256.digest(KEY)\n  address_string = addresses.map{ |addr| addr.strip }.push(identifier).join('|')\n  encrypted_message = cipher.update(address_string) + cipher.final\n  binding.pry\n  encrypted_message.unpack('H*')[0]\n</code></pre>\n\n<p>I see this in my terminal:</p>\n\n<pre><code> encrypted_message\n=&gt; \".YI\\xCA\\xAC\\x17\\xF2\\xBF\\x1C^b\\x8C[|\\xB8YU\\x1F\\xCBn/\\xE5\\xA0\\x15\\x8Aa\\ef\\xAF&gt;\\x7F\\x8A\"\n[2] pry(Mixer)&gt; encrypted_message.unpack('H*')\n=&gt; [\"2e5949caac17f2bf1c5e628c5b7cb859551fcb6e2fe5a0158a611b66af3e7f8a\"]\n</code></pre>\n\n<p>I understand the basics of binary and hexadecimal... but I'm still having trouble understanding what I see.</p>\n\n<ol>\n<li><p>What is the encrypted message format? What are the slashes and the <code>\\x</code>s. Is it hexadecimal? How do you know? What is the <code>.YI</code> leading part?</p></li>\n<li><p>How are they converting this to hexa? Can you show an example?</p></li>\n</ol>\n"}, {"tags": ["ruby", "windows", "encoding", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "edited": false, "score": 0, "creation_date": 1518525744, "post_id": 48767071, "comment_id": 84534416, "body": "Thanks, but in my case I am in control of every file that gets read and they are all UTF-8 - so i&#39;m safe?"}], "tags": [], "owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "is_accepted": false, "score": 0, "last_activity_date": 1518525658, "creation_date": 1518525658, "answer_id": 48767071, "question_id": 48755776, "link": "https://stackoverflow.com/questions/48755776/is-there-any-harm-in-setting-both-internal-and-external-encoding-to-utf-8-on-win/48767071#48767071", "title": "Is there any harm in setting both internal and external encoding to utf-8 on windows?", "body": "<blockquote>\n  <p>might doing this come back to bite me later on</p>\n</blockquote>\n\n<p>Yes.  Anytime you try to read a file that is not encoded in UTF-8 you will get bitten.  Your system has some locale settings that ruby reads to set your external default encoding.</p>\n"}], "owner": {"reputation": 27866, "user_id": 66725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/3b56c8754ce3d1b04690ccab04a8522b?s=128&d=identicon&r=PG&f=1", "display_name": "horseyguy", "link": "https://stackoverflow.com/users/66725/horseyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1518525658, "creation_date": 1518470815, "question_id": 48755776, "link": "https://stackoverflow.com/questions/48755776/is-there-any-harm-in-setting-both-internal-and-external-encoding-to-utf-8-on-win", "title": "Is there any harm in setting both internal and external encoding to utf-8 on windows?", "body": "<p>I am writing a Ruby app on windows, and encountering some annoying encoding related issues. However, when i set both the internal and external default encodings to <code>utf-8</code> these problems disappear.</p>\n\n<p>What do i have to worry about in doing this? might doing this come back to bite me later on?</p>\n"}, {"tags": ["arrays", "ruby", "parsing", "split"], "comments": [{"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 1, "creation_date": 1518471409, "post_id": 48755767, "comment_id": 84512811, "body": "try <code>value = value.split(&#39; &#39;)</code>. <code>split</code> does not change the value of the variable it&#39;s called on."}, {"owner": {"reputation": 653, "user_id": 7148414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KMhlJ.jpg?s=128&g=1", "display_name": "baseballlover723", "link": "https://stackoverflow.com/users/7148414/baseballlover723"}, "edited": false, "score": 0, "creation_date": 1518472998, "post_id": 48755767, "comment_id": 84513553, "body": "as a side note, the reason why it looked like it was splitting it by characters is that in ruby, you can access a string like an array of characters. <code>&quot;string&quot;[1] #=&gt; &quot;t&quot;</code>, you can also use ranges and regex with String#[]"}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1518476986, "post_id": 48755767, "comment_id": 84515169, "body": "Another side note: if you open a file with <code>File.open</code> without a block, get into the habit of closing it. <code>inputfile.close</code> will do it. There is a maximum on the amount of open files which can be handled."}], "answers": [{"tags": [], "owner": {"reputation": 4272, "user_id": 501266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iDtAx.jpg?s=128&g=1", "display_name": "Keith Bennett", "link": "https://stackoverflow.com/users/501266/keith-bennett"}, "is_accepted": true, "score": 0, "last_activity_date": 1518496969, "creation_date": 1518496969, "answer_id": 48759604, "question_id": 48755767, "link": "https://stackoverflow.com/questions/48755767/trouble-with-results-of-split-in-ruby/48759604#48759604", "title": "trouble with results of .split(&quot; &quot;) in Ruby", "body": "<p>As was said in the comments, plus some other points, with an idiomatic code sample:</p>\n\n<pre><code>lines = File.readlines('myfile.in')\n\nheader_line, data_lines = lines[0], lines[1..-1]\n\nnum_cases = header_line.to_i\n\narrays_of_number_strings = data_lines.map(&amp;:split)\narrays_of_numbers = arrays_of_number_strings.map do |array_of_number_strings|\n    array_of_number_strings.map(&amp;:to_i)\nend\n\nputs \"#{num_cases} cases in file.\"\narrays_of_numbers.each { |a| p a }\n</code></pre>\n\n<ul>\n<li>File.readlines is super handy!</li>\n<li>I don't think you were calling to_i on the header information, that\nwill be important.</li>\n<li>The data_lines.map(&amp;:split) will return an array of the numbers as strings, but then you'll need to convert those strings to numbers too.</li>\n<li>The <code>p a</code> in the final line will use the <code>Array#inspect</code> method, which is handy for viewing arrays as arrays, e.g. <code>[12, 34]</code>.</li>\n</ul>\n"}], "owner": {"reputation": 85, "user_id": 7275070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60dcb1d3a6f0b25c6b71dcb9ff09881?s=128&d=identicon&r=PG&f=1", "display_name": "mell", "link": "https://stackoverflow.com/users/7275070/mell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48759604, "answer_count": 1, "score": 0, "last_activity_date": 1518496969, "creation_date": 1518470766, "question_id": 48755767, "link": "https://stackoverflow.com/questions/48755767/trouble-with-results-of-split-in-ruby", "title": "trouble with results of .split(&quot; &quot;) in Ruby", "body": "<p>I am just starting to learn ruby and I am having troubles splitting my strings by spaces. \nFirst I read in my file and break them up by the newline character :</p>\n\n<pre><code>inputfile = File.open(\"myfile.in\")\nfilelines = inputfile.read.split(\"\\n\")\n</code></pre>\n\n<p>Then I try to read each of the two numbers individually:</p>\n\n<pre><code>filelines.each_with_index {|val, index| do_something(val, index)}\n</code></pre>\n\n<p>Where <em>do_something</em> is defined as:</p>\n\n<pre><code>def do_something(value, index)\n   if index == 0\n    numcases = value\n    puts numcases\n  else\n    value.split(\" \")\n    puts value\n    puts value[0] #trying to access the first number \n    puts value[1] #trying to access the second number \n  end\nend\n</code></pre>\n\n<p>but with a smaller input file like this one, </p>\n\n<pre><code>42\n4 2\n11 19\n0 10\n10 0\n-10 0\n0 -10\n-76 -100\n5 863\n987 850\n</code></pre>\n\n<p>My outputs ends up looking like this:</p>\n\n<pre><code>42\n4 2\n4\n\n11 19\n1\n1\n0 10\n0\n\n10 0\n1\n0\n-10 0\n-\n1\n0 -10\n0\n\n-76 -100\n-\n7\n5 863\n5\n\n987 850\n9\n8  \n</code></pre>\n\n<p>so what I am understanding is that it is breaking it up character by character, rather than by spaces. I know it can read in the whole line, as I can print the contents of the array in its entirety, but I dont know what I am doing wrong. \nI have also tried replacing value.split(\" \") with: </p>\n\n<pre><code>value.gsub(/\\s+/m, ' ').strip.split(\" \")\nvalue.split\nvalue.split(\"\\s\")\n</code></pre>\n\n<p>Using RubyMine 2017.3.2</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "openssl", "homebrew", "readline"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1518474997, "post_id": 48755604, "comment_id": 84514504, "body": "Based on <i><code>ruby-build: use readline from homebrew</code></i> followed by <i><code>BUILD FAILED</code></i>, have you installed ReadLine? If I recall correctly, OpenSSL does not use ReadLine but the Homebrew tools may."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1518511145, "post_id": 48755604, "comment_id": 84525420, "body": "Also see <a href=\"https://www.google.com/search?q=homebrew+openssl+force+link+site%3Astackoverflow.com\" rel=\"nofollow noreferrer\">homebrew openssl force link site:stackoverflow.com</a>. Lots of similar questions, like <a href=\"http://stackoverflow.com/q/38670295\">Homebrew refusing to link OpenSSL</a>, <a href=\"http://stackoverflow.com/q/15185661\">Update OpenSSL on OS X with Homebrew</a>, <a href=\"http://stackoverflow.com/q/35129977\">How to install latest version of openssl Mac OS X El Capitan</a>, <a href=\"http://apple.stackexchange.com/q/126830\">How to upgrade OpenSSL in OS X?</a>, <a href=\"http://superuser.com/q/486389\">Openssl installation using Homebrew fails</a>, etc."}, {"owner": {"reputation": 486, "user_id": 7069011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AfPIn.jpg?s=128&g=1", "display_name": "ThorTL67", "link": "https://stackoverflow.com/users/7069011/thortl67"}, "edited": false, "score": 0, "creation_date": 1518515850, "post_id": 48755604, "comment_id": 84528370, "body": "As a suggestion; I would ensure that homebrew has been updated &amp; that you also have the latest version of the Xcode command line tools. I had a few errors doing this but with RVM"}], "answers": [{"tags": [], "owner": {"reputation": 2780, "user_id": 2259237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a85077190b4ee090e7e1495ee556384?s=128&d=identicon&r=PG", "display_name": "rderoldan1", "link": "https://stackoverflow.com/users/2259237/rderoldan1"}, "is_accepted": true, "score": 0, "last_activity_date": 1548044495, "creation_date": 1548044495, "answer_id": 54283473, "question_id": 48755604, "link": "https://stackoverflow.com/questions/48755604/failing-to-build-ruby-2-5-0-with-rbenv-and-ruby-build/54283473#54283473", "title": "Failing to build Ruby 2.5.0 with rbenv and ruby-build", "body": "<p>This error happened to me after I upgrade homebrew.</p>\n\n<p>I just spent 2 days trying to fix this error, basically reinstalled everything. This is how I found the solution (TL; TR I'm so dumb)</p>\n\n<ol>\n<li>Ran <code>brew doctor</code></li>\n<li>It said \"Your Xcode version is too old, you are using 9.0 and latest is 10.0\"</li>\n<li>I went to app store, open updates tab and nothing there</li>\n<li>Searched for Xcode and noticed that version 10 was available</li>\n<li>Opened Xcode after installation</li>\n<li>Ran <code>rbenv install 2.5.0</code> and worked. </li>\n<li>Hate my all existence.</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 9351955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvDc4.jpg?s=128&g=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/9351955/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1368, "favorite_count": 0, "accepted_answer_id": 54283473, "answer_count": 1, "score": 1, "last_activity_date": 1548044495, "creation_date": 1518470023, "last_edit_date": 1518475170, "question_id": 48755604, "link": "https://stackoverflow.com/questions/48755604/failing-to-build-ruby-2-5-0-with-rbenv-and-ruby-build", "title": "Failing to build Ruby 2.5.0 with rbenv and ruby-build", "body": "<p>So I am trying to install ruby 2.5.0 with rbenv and this is my issue:</p>\n\n<pre><code>$ rbenv install 2.5.0\nruby-build: use openssl from homebrew\nDownloading ruby-2.5.0.tar.bz2...\n-&gt; https://cache.ruby-lang.org/pub/ruby/2.5/ruby-2.5.0.tar.bz2\nInstalling ruby-2.5.0...\nruby-build: use readline from homebrew\n\nBUILD FAILED (OS X 10.13.3 using ruby-build 20171226-3-g01e7b7b)\n\nInspect or clean up the working tree at /var/folders/6d/p9mv033d1xv9hc4xbdr7fxf40000gp/T/ruby-build.20180212121818.63339\nResults logged to /var/folders/6d/p9mv033d1xv9hc4xbdr7fxf40000gp/T/ruby-build.20180212121818.63339.log\n\nLast 10 log lines:\ninstalling capi-docs:\n/Users/lukeholloway/.rbenv/versions/2.5.0/share/doc/ruby\nThe Ruby OpenSSL extension was not compiled.\nERROR: Ruby install aborted due to missing extensions\nConfigure options used:\n  --prefix=/Users/lukeholloway/.rbenv/versions/2.5.0\n  --with-openssl-dir=/usr/local/opt/openssl\n  --with-readline-dir=/usr/local/opt/readline\n  CC=clang\n  LDFLAGS=-L/Users/lukeholloway/.rbenv/versions/2.5.0/lib \n  CPPFLAGS=-I/Users/lukeholloway/.rbenv/versions/2.5.0/include \n</code></pre>\n\n<p>The issue seems to be with paths between the mac version of OpenSSL and the Homebrew version. I use Homebrew on my mac for everything FYI.</p>\n\n<p>So here is my openssl folder:</p>\n\n<pre><code>$ which openssl\n/usr/local/opt/openssl/bin/openssl\n$ openssl version\nOpenSSL 1.0.2n  7 Dec 2017\n</code></pre>\n\n<p>I have this line in my <code>.bash_profile</code> to make it use the newer version installed with Homebrew:</p>\n\n<pre><code>export PATH=\"/usr/local/opt/openssl/bin:$PATH\"\n</code></pre>\n\n<p>It seems to be loading the correct OpenSSL version now but it still wont compile correctly. It does this with any version of ruby.</p>\n\n<p>Does anyone know what is going on specifically? Any help would be great!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "embedded-resource"], "comments": [{"owner": {"reputation": 33, "user_id": 9195765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b08b10599d3bfa6ed7c4ec17e240d2?s=128&d=identicon&r=PG&f=1", "display_name": "kamin", "link": "https://stackoverflow.com/users/9195765/kamin"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1518478492, "post_id": 48755494, "comment_id": 84515640, "body": "@Clifford thank you for the edit"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 9195765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b08b10599d3bfa6ed7c4ec17e240d2?s=128&d=identicon&r=PG&f=1", "display_name": "kamin", "link": "https://stackoverflow.com/users/9195765/kamin"}, "is_accepted": true, "score": 0, "last_activity_date": 1520536611, "last_edit_date": 1520536611, "creation_date": 1520534611, "answer_id": 49180289, "question_id": 48755494, "link": "https://stackoverflow.com/questions/48755494/referencing-embedded-resources-mongo-mongoid-ruby-rails/49180289#49180289", "title": "referencing embedded resources mongo mongoid ruby rails", "body": "<p>This getter in the <code>EmailRoute</code> model does the trick</p>\n\n<pre><code>def labels\n    account.labels.where(:_id.in =&gt; self[:labels])\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9195765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84b08b10599d3bfa6ed7c4ec17e240d2?s=128&d=identicon&r=PG&f=1", "display_name": "kamin", "link": "https://stackoverflow.com/users/9195765/kamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 49180289, "answer_count": 1, "score": 2, "last_activity_date": 1520536611, "creation_date": 1518469519, "last_edit_date": 1518497749, "question_id": 48755494, "link": "https://stackoverflow.com/questions/48755494/referencing-embedded-resources-mongo-mongoid-ruby-rails", "title": "referencing embedded resources mongo mongoid ruby rails", "body": "<p><code>ruby 2.50</code> \n<code>rails 5.1.4</code>\n<code>gem 'mongoid'</code>\n<code>gem 'mongoid_paranoia'</code>\n<code>gem 'mongoid-tree'</code>\n<code>gem 'mongoid-autoinc'</code>\n<code>gem 'mongoid-userstamps'</code></p>\n\n<p>I am having trouble using an embedded resource.</p>\n\n<p>I have an <code>Account</code> model.</p>\n\n<pre><code>class Account\n  store_in collection: 'accounts'\n\n  has_many :email_routes, dependent: :destroy\n  embeds_many :labels, as: :labelable\n\n  etc..\nend\n</code></pre>\n\n<p>As you can see, each account has many labels.</p>\n\n<pre><code>class Label\n  embedded_in :labelable, polymorphic: true\n  belongs_to :email_routes\n\n  field :text, type: String\n  field :color, type: String\nend\n</code></pre>\n\n<p>The available labels are specified at the account level...</p>\n\n<p>and I have an EmailRoute, which I want to apply some labels to..</p>\n\n<pre><code>class EmailRoute\n  belongs_to :account\n\n  field :email_address, type: String\n  has_many :labels, as: :labelable, dependent: :nullify\n\n  # field :labels, type: Array, default: []\nend\n</code></pre>\n\n<p>In the <code>email_routes_controller</code>, I have a simple update action..</p>\n\n<pre><code>def update\n  selected_labels = params[:labels]\n\n  @email_route.update_attributes!(labels: selected_labels)\n\n  render json: @email_route\nend\n</code></pre>\n\n<p><code>params[:labels]</code> contains an array of <code>Label</code> objects. When I patch to the controller, I get the following error/message.</p>\n\n<blockquote>\n  <p>Referencing a(n) Label document from the EmailRoute document via a relational association is not allowed since the Label is embedded.</p>\n  \n  <p>summary:<br>\n  In order to properly access a(n) Label from EmailRoute the reference would need to go through the root document of Label. In a simple case this would require Mongoid to store an extra foreign key for the root, in more complex cases where Label is multiple levels deep a key would need to be stored for each parent up the hierarchy.</p>\n  \n  <p>resolution:<br>\n  Consider not embedding Label, or do the key storage and access in a custom manner in the application code.):\"</p>\n</blockquote>\n\n<p>Is there any way I can work around this? I know there are many articles regarding embedded but none seemed to quite fit this particular case. Any help is greatly appreciated, as I don't want to lose label data and need them to be specified at the account level.</p>\n\n<p>Thanks!</p>\n\n<p><strong>edit</strong> Is something like this going to be the only solution?\n<a href=\"https://www.cookieshq.co.uk/posts/switching-relationships-with-mongoid\" rel=\"nofollow noreferrer\">https://www.cookieshq.co.uk/posts/switching-relationships-with-mongoid</a></p>\n\n<p><strong>edit 2</strong> ... I have managed to get to this point when calling <code>@account.email_routes[0].labels</code> from within the rails console. The strings in the nested array within selector are the labels I meant to add. However, when I render :json @account.email_route, the labels array is returned empty.  How do I use the information within the selector?</p>\n\n<blockquote>\n<pre><code>#&lt;Mongoid::Criteria\n</code></pre>\n  \n  <p>selector: {\"_id\"=>{\"$in\"=>[\"Critical Test updates\", \"Chill\", \"New\", >\"Make\", \"Cool\", \"1\", \"2\", \"3\"]}}\n   options:  {}\n       class:    Label\n       embedded: true></p>\n</blockquote>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1518469579, "post_id": 48755345, "comment_id": 84511985, "body": "Do you have an example CSV you can share? It&#39;s hard to say what exactly can be done without seeing the file itself. Also, <a href=\"https://github.com/JuanitoFatas/fast-ruby\" rel=\"nofollow noreferrer\">github.com/JuanitoFatas/fast-ruby</a> has some benchmarks of methods and comparable methods that could help you trim off some time."}, {"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1518469610, "post_id": 48755345, "comment_id": 84511995, "body": "is this line right? <code>tmpRow = row.to_s.chomp + &quot;,&quot; + file</code>.  <code>file</code> in this case would be the entire read file not the name.  Your while loop is O(n^2) but tough to help without knowing the data of the files."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 3, "creation_date": 1518469860, "post_id": 48755345, "comment_id": 84512107, "body": "Have you considered loading your CSVs into an SQLite database (or other database that you might have available)? CSV is a decent enough format for data interchange but it isn&#39;t a database and writing your own in-memory database and indexing system (which is what your arrays are) seems unnecessary when so many tools already exist."}, {"owner": {"reputation": 13, "user_id": 7409286, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50bbe60ceef04aa9ade05b18a332dcfb?s=128&d=identicon&r=PG&f=1", "display_name": "Donatas Jarmalovicius", "link": "https://stackoverflow.com/users/7409286/donatas-jarmalovicius"}, "edited": false, "score": 0, "creation_date": 1518469973, "post_id": 48755345, "comment_id": 84512148, "body": "Link to example csv file: <a href=\"https://drive.google.com/open?id=1t6u6zeBUM49kmb3k9MYkTO4qZdxRJuSu\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1t6u6zeBUM49kmb3k9MYkTO4qZdxRJuSu</a> Only first two columns matter there. First column is ID, second is price. Also file variable in tmpRow = row.to_s.chomp + &quot;,&quot; + file is actually a string &quot;./FIAT_2.csv&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 4422, "user_id": 1202525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc5db30edf02524aa2a0fb17d154bf8?s=128&d=identicon&r=PG", "display_name": "TomDunning", "link": "https://stackoverflow.com/users/1202525/tomdunning"}, "is_accepted": false, "score": 1, "last_activity_date": 1518485163, "creation_date": 1518485163, "answer_id": 48758153, "question_id": 48755345, "link": "https://stackoverflow.com/questions/48755345/how-to-speed-up-iteration-through-array-in-ruby/48758153#48758153", "title": "How to speed up iteration through array in ruby", "body": "<p>I would split this into several parts:\n1) I suggest you have a table which represents files (the file name, location, line number etc) and connected to that a product table (the row data from that file)\n2) script / function to ingest files and store rows as DB records\n3) script / function to analyse rows and find products by name, using the DB and pulling price info out using Min/max.</p>\n\n<p>This could later be improved to deal with naming inconsistencies products vs product occurrences etc.</p>\n"}], "owner": {"reputation": 13, "user_id": 7409286, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/50bbe60ceef04aa9ade05b18a332dcfb?s=128&d=identicon&r=PG&f=1", "display_name": "Donatas Jarmalovicius", "link": "https://stackoverflow.com/users/7409286/donatas-jarmalovicius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1518515492, "creation_date": 1518468858, "last_edit_date": 1518515492, "question_id": 48755345, "link": "https://stackoverflow.com/questions/48755345/how-to-speed-up-iteration-through-array-in-ruby", "title": "How to speed up iteration through array in ruby", "body": "<p>I have multiple csv files that have the name and the price of products. There may be or may not be products that are in both files. I have to find the highest and the lowest price across these files for each product.</p>\n\n<p>I joined products from both files into one array: </p>\n\n<pre><code>Dir[\"./*.csv\"].each do |file|\n  CSV.foreach(file, headers:true) do |row|\n    tmpRow = row.to_s.chomp + \",\" + file #saving name of the input file\n    list.push(tmpRow.chomp.split(\",\"))\n  end\nend\n</code></pre>\n\n<p>The array <code>list</code> looks like this:</p>\n\n<pre><code>[[\"5893105\",\"2.38\", \"weightOrSomethingIrrelevant\", \"./FIAT_2.csv\"]]\n</code></pre>\n\n<p>This is the main algorithm: </p>\n\n<pre><code>while list[0] do\n  if list[0] != nil\n    tmpPart = list[0][0]\n    tmpParts = list.select{ |part, price| part == tmpPart}\n    tmpParts.each do |tp|\n      tmpPrices.push(tp[1])\n    end\n    list[0][2].to_f != 0.0 ? tmpWeight = list[0][2].to_s : tmpWeight = \"Undefined\"\n    tmpMaxPrice = tmpParts.select{|part, price| part == tmpPart &amp;&amp; price == tmpPrices.max}\n    tmpMinPrice = tmpParts.select{|part, price| part == tmpPart &amp;&amp; price == tmpPrices.min}\n    result.push([tmpPart, tmpWeight, tmpPrices.max, tmpMaxPrice[0].last, tmpPrices.min, tmpMinPrice[0].last)\n    tmpPart = \"\"\n    list = list - tmpParts\n    tmpParts = []\n    tmpPrices = []\n    tmpMaxPrice = []\n    tmpMinPrice = []\n    tmpWeight = \"\"\n  end\nend\n</code></pre>\n\n<p>The input files are huge (over 200 000 rows), so I am having problems with efficiency of my algorithm (as it processes one row in half a second).</p>\n\n<p>I am wondering if there is any better way to write this app.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 8456726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d92d276990ac8a54a5d0149d8fd88a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny C", "link": "https://stackoverflow.com/users/8456726/johnny-c"}, "edited": false, "score": 0, "creation_date": 1518468959, "post_id": 48755087, "comment_id": 84511680, "body": "How do you accomplish this with a scope in Rails?"}], "tags": [], "owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "is_accepted": false, "score": 2, "last_activity_date": 1518469655, "last_edit_date": 1518469655, "creation_date": 1518467700, "answer_id": 48755087, "question_id": 48754945, "link": "https://stackoverflow.com/questions/48754945/how-to-count-columns-of-data-that-have-values-between-the-range-of-two-numbers-w/48755087#48755087", "title": "How to count columns of data that have values between the range of two numbers w/Rails Scope?", "body": "<pre><code>SELECT \n SUM(CASE WHEN SALARY BETWEEN 20000 AND 30000 THEN 1 ELSE 0 END) AS COUNT\nFROM JOBS\n</code></pre>\n\n<p>Besides this also works</p>\n\n<pre><code>SELECT COUNT(*) FROM JOBS WHERE SALARY BETWEEN 20000 AND 30000;\n</code></pre>\n\n<p>you can check working example from  <a href=\"http://sqlfiddle.com/#!18/1826f/2\" rel=\"nofollow noreferrer\">SQL Fiddle</a></p>\n\n<p>EDIT: <strong>Rails Scope</strong></p>\n\n<pre><code>jobs.where(salary: 10000..20000).count\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 8456726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d92d276990ac8a54a5d0149d8fd88a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny C", "link": "https://stackoverflow.com/users/8456726/johnny-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518469655, "creation_date": 1518467073, "question_id": 48754945, "link": "https://stackoverflow.com/questions/48754945/how-to-count-columns-of-data-that-have-values-between-the-range-of-two-numbers-w", "title": "How to count columns of data that have values between the range of two numbers w/Rails Scope?", "body": "<p>My problem is relatively simple. I am trying to aggregate and count all records of the job model that have values BETWEEN 20000 AND 30000. The problem is my scope is not producing the correct results. I'm receiving the error below</p>\n\n<p>Error</p>\n\n<pre><code>  Job Load (1.0ms)  SELECT  \"jobs\".* FROM \"jobs\" GROUP BY count(hourly_wage_salary) BETWEEN 20000 AND 30000 LIMIT $1  [[\"LIMIT\", 11]]\nActiveRecord::StatementInvalid: PG::GroupingError: ERROR:  aggregate functions are not allowed in GROUP BY\nLINE 1: SELECT  \"jobs\".* FROM \"jobs\" GROUP BY count(hourly_wage_sala...\n                                              ^\n: SELECT  \"jobs\".* FROM \"jobs\" GROUP BY count(hourly_wage_salary) BETWEEN 20000 AND 30000 LIMIT $1\n</code></pre>\n\n<p>The code for my scope is:</p>\n\n<pre><code>scope :count_jobs_with_salaries_between_20k_30k, -&gt; {group(\"count(hourly_wage_salary) BETWEEN 20000 AND 30000\")}\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518466380, "post_id": 48754639, "comment_id": 84510298, "body": "The instance variables are defined in a different scope. See <a href=\"https://stackoverflow.com/questions/15773552/ruby-class-instance-variable-vs-class-variable\" title=\"ruby class instance variable vs class variable\">stackoverflow.com/questions/15773552/&hellip;</a>"}, {"owner": {"reputation": 669, "user_id": 1050230, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7feab6ddd899b163893c2c81c62d144c?s=128&d=identicon&r=PG", "display_name": "rozza", "link": "https://stackoverflow.com/users/1050230/rozza"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518466999, "post_id": 48754639, "comment_id": 84510637, "body": "So how would get them into the same scope (other than setting them to a new variable)?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518469558, "post_id": 48754639, "comment_id": 84511979, "body": "You edited the question since I made that comment. Since you added them to <code>initialize</code> it looks like they&#39;re in the correct scope, so I&#39;m not sure."}, {"owner": {"reputation": 669, "user_id": 1050230, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7feab6ddd899b163893c2c81c62d144c?s=128&d=identicon&r=PG", "display_name": "rozza", "link": "https://stackoverflow.com/users/1050230/rozza"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518470155, "post_id": 48754639, "comment_id": 84512229, "body": "Aha, so if they&#39;re not in the initialize, why does that stop a method accessing them?  (it may say in the link, but there was a lot there and a lot of it was about inheritance, which doesn&#39;t apply here - I don&#39;t think!!)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518472689, "post_id": 48754639, "comment_id": 84513399, "body": "when you are inside <code>initialize</code> you are in &quot;instance scope&quot;. When you are outside it you are in &quot;class scope&quot;. &quot;Instance variables&quot; (with @ as prefix) can be used in either, but not <i>between</i> one or the other."}, {"owner": {"reputation": 669, "user_id": 1050230, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7feab6ddd899b163893c2c81c62d144c?s=128&d=identicon&r=PG", "display_name": "rozza", "link": "https://stackoverflow.com/users/1050230/rozza"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518474388, "post_id": 48754639, "comment_id": 84514221, "body": "but isn&#39;t the method make_my_person in instance scope as well...?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1518479422, "post_id": 48754639, "comment_id": 84515857, "body": "yes it is, but before you edited the questionn to use <code>def initialize</code> you were defining the instance variable into class scope. Even now  the first line of your <code>def initialize</code> won&#39;t work because <code>@my_name_generator_object</code> is not defined at that point."}], "owner": {"reputation": 669, "user_id": 1050230, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7feab6ddd899b163893c2c81c62d144c?s=128&d=identicon&r=PG", "display_name": "rozza", "link": "https://stackoverflow.com/users/1050230/rozza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1518468555, "creation_date": 1518465820, "last_edit_date": 1518468555, "question_id": 48754639, "link": "https://stackoverflow.com/questions/48754639/how-to-pass-an-instance-variable-to-a-constructor", "title": "How to pass an instance variable to a constructor", "body": "<p>So I have a class</p>\n\n<pre><code>class MyPerson\n   attr_accessor :id, :first_name, :surname\n\n   def initialize(&amp;block)\n      instance_eval &amp;block if block_given?\n   end\nend\n</code></pre>\n\n<p>And I want to create this from another class which looks like this</p>\n\n<pre><code>class MyCallingClass\n  def initialize\n     @my_name_generator_object.my_surname = 'Smith'\n     @my_first_name = 'Bob'\n  end\n\n  def make_my_person\n     surname_temp = @my_name_generator_object.my_surname  \n     first_name_temp = @my_first_name  \n     my_person = MyPerson.new do\n         self.surname = surname_temp\n         self.first_name = first_name_temp\n     end\n  end\nend\n</code></pre>\n\n<p>What's happening is that </p>\n\n<ul>\n<li><p>if I try to pass @my_name_generator to MyPerson in the constructor, it is not nil at the point of instantiating MyPerson, but a value of nil is passed to the initialize method of MyPerson</p></li>\n<li><p>if I try to pass @my_first_name into the constructor (as above) even though @my_first_name has a value, it is not passed into the initialize method of MyPerson.  </p></li>\n<li><p>if I set @my_name_generator_object.surname and @my_first_name to a temp variable (as in the code above) then it works as expected.</p></li>\n</ul>\n\n<p>Why is this and is there anything I can do to pass the instance variables directly into the constructor?  It just looks messy having to have temp variables to make the code work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1489, "user_id": 3628383, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZZsDD.png?s=128&g=1", "display_name": "Jaeger", "link": "https://stackoverflow.com/users/3628383/jaeger"}, "edited": false, "score": 0, "creation_date": 1518465443, "post_id": 48754424, "comment_id": 84509745, "body": "Maybe this question can help you: <a href=\"https://stackoverflow.com/questions/5528281/ruby-parsing-a-text-file\" title=\"ruby parsing a text file\">stackoverflow.com/questions/5528281/ruby-parsing-a-text-file</a>"}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 1, "creation_date": 1518466542, "post_id": 48754424, "comment_id": 84510391, "body": "Please ask one question at a time, specifying where you&#39;re stuck, what code you&#39;ve tried. Please review <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "edited": false, "score": 0, "creation_date": 1518478420, "post_id": 48754424, "comment_id": 84515619, "body": "You have a lot of unused variables in the second if block.  Is that intentional?"}, {"owner": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "edited": false, "score": 0, "creation_date": 1518483030, "post_id": 48754424, "comment_id": 84516802, "body": "@0012 , That&#39;s not intentional. I just tried it this way"}, {"owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "edited": false, "score": 0, "creation_date": 1518652287, "post_id": 48754424, "comment_id": 84598783, "body": "@shriBin you should leave an example of the problem you are trying to solve.   Any reason why you removed it?"}, {"owner": {"reputation": 4728, "user_id": 1288408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r09bq.jpg?s=128&g=1", "display_name": "Modus Tollens", "link": "https://stackoverflow.com/users/1288408/modus-tollens"}, "edited": false, "score": 1, "creation_date": 1518652612, "post_id": 48754424, "comment_id": 84598863, "body": "Rolled back. Removing that much content from your question makes it off-topic and invalidates the answer."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "edited": false, "score": 0, "creation_date": 1518483333, "post_id": 48757239, "comment_id": 84516875, "body": "This works.. Thanks for your help and explanation @0112"}, {"owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "reply_to_user": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "edited": false, "score": 0, "creation_date": 1518483375, "post_id": 48757239, "comment_id": 84516890, "body": "You&#39;re welcome.  Best of luck learning ruby."}, {"owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "reply_to_user": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "edited": false, "score": 0, "creation_date": 1518654396, "post_id": 48757239, "comment_id": 84599365, "body": "@shriBin since you have two nested if blocks, you should also probably just use an and statement like <code>if (bol1 &amp;&amp; line =~ &#47;ALTER TABLE&#47;)</code>.  I don&#39;t know if you have a specific reason for doing it the way you&#39;re doing though.  Just a suggestion."}], "tags": [], "owner": {"reputation": 3136, "user_id": 1596460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fwyxG.jpg?s=128&g=1", "display_name": "0112", "link": "https://stackoverflow.com/users/1596460/0112"}, "is_accepted": true, "score": 1, "last_activity_date": 1518477975, "creation_date": 1518477975, "answer_id": 48757239, "question_id": 48754424, "link": "https://stackoverflow.com/questions/48754424/find-a-string-in-a-file-and-return-the-value-before-the-string-using-ruby/48757239#48757239", "title": "Find a string in a file and return the value before the string using ruby", "body": "<p>A few errors/style concerns:</p>\n\n<ul>\n<li>You're using an assignment equals in your conditional.  <code>bol1 = \"true\"</code> should be <code>bol1 == \"true\"</code> But:</li>\n<li>You're checking to see if the <code>.include?</code> function returned the string <code>\"true\"</code> You should check if the value <em>is</em> true. (<code>bol1 == true</code> or just <code>if (bol1)</code>) This is why you're not getting back the value you expect.</li>\n<li><a href=\"https://stackoverflow.com/questions/5659360/why-should-you-avoid-the-then-keyword-in-ruby\"><code>then</code> is rarely used</a> but not never.</li>\n<li>If you're going to use <code>then</code> it closes the if statement, the if statement doesn't need an end unless it's completely by itself.  <code>else</code> will also close the <code>if</code> block.</li>\n<li>You're missing a closing <code>end</code> at the bottom</li>\n<li>You've tried to puts <code>\"{#bol1}\"</code> instead of <code>\"#{bol1}\"</code> which is <a href=\"http://batsov.com/articles/2014/08/13/the-elements-of-style-in-ruby-number-14-variable-interpolation/\" rel=\"nofollow noreferrer\">how variable interpolation works</a>.  (You can just <code>puts bol1</code> though, it would be easier. No need to use <code>#{}</code>)</li>\n</ul>\n\n<p>The working version of your program I've got is this:</p>\n\n<pre><code>line = \"ALTER TABLE schemaname.tablename MODIFY col1 number(19,0)\"\nbol1 = line.include?(\"MODIFY\")\nputs bol1\n\nif (bol1)\n  if (line =~ /ALTER TABLE/)\n    drop_found = true\n    location = line.index(\"ALTER TABLE\") + 11\n    subline = line[location..-1]\n    sublineParts = subline.split(\" \")\n    tableName = sublineParts[0]\n    puts \" found modify column on {#tableName}\"\n  else\n    puts \" no modify found\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9351683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3bed41c7117d22526623d92c4999bf?s=128&d=identicon&r=PG&f=1", "display_name": "shri Bin", "link": "https://stackoverflow.com/users/9351683/shri-bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1518650210, "accepted_answer_id": 48757239, "answer_count": 1, "score": 0, "last_activity_date": 1518652532, "creation_date": 1518465031, "last_edit_date": 1518652532, "question_id": 48754424, "link": "https://stackoverflow.com/questions/48754424/find-a-string-in-a-file-and-return-the-value-before-the-string-using-ruby", "closed_reason": "Needs details or clarity", "title": "Find a string in a file and return the value before the string using ruby", "body": "<p>I am in the process of learning ruby. I am trying to read a file, find a string, and return the value before the string.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>line = \"ALTER TABLE schemaname.tablename MODIFY col1 number(19,0)\"\nbol1 = line.include?(\"MODIFY\")\nputs \"{#bol1}\" \n\nif bol1 = \"true\"\n  if line =~ /ALTER TABLE/ then\n    drop_found = \"true\"\n    location = line.index(\"ALTER TABLE\") + 11\n    subline = line[location..-1]\n    sublineParts = subline.split(\" \")\n    tableName = sublineParts[0]\n    puts \" found modify column on {#tableName}\"\n   end\n   else\n     puts \" no modify found\"\n   end\n</code></pre>\n\n<p>I don't get any output here. <code>bol1 = line.include?(\"MODIFY\")</code> returns nothing. Please help.</p>\n"}, {"tags": ["c++", "ruby", "makefile", "rubygems", "swig"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1518464711, "post_id": 48754247, "comment_id": 84509371, "body": "&quot;-Wno-format-security&quot; - why would you do that?"}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1518468539, "post_id": 48754247, "comment_id": 84511434, "body": "Are you getting warnings, or errors, @edmz? <code>-Wno-format-security</code> shoudn&#39;t cause compilation to fail, since it just enables warnings."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1518472417, "post_id": 48754247, "comment_id": 84513271, "body": "@Joe, some distributions compile everything with <code>-Werror=format-security</code>."}, {"owner": {"reputation": 3180, "user_id": 90756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3aa663e8a021b03a52274b898efe462?s=128&d=identicon&r=PG", "display_name": "edmz", "link": "https://stackoverflow.com/users/90756/edmz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1518472528, "post_id": 48754247, "comment_id": 84513314, "body": "@JesperJuhl I know I should not. But this is a gem that I&#39;ve been using for years. I still haven&#39;t decided if I am going to keep using it but now I just want to understand what is going on."}, {"owner": {"reputation": 3180, "user_id": 90756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3aa663e8a021b03a52274b898efe462?s=128&d=identicon&r=PG", "display_name": "edmz", "link": "https://stackoverflow.com/users/90756/edmz"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1518472589, "post_id": 48754247, "comment_id": 84513349, "body": "@Joe I think I am getting errors:        <code>tx_swig_wrap.cxx:4369:41: error: format not a string literal and no format arguments [-Werror=format-security]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3180, "user_id": 90756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3aa663e8a021b03a52274b898efe462?s=128&d=identicon&r=PG", "display_name": "edmz", "link": "https://stackoverflow.com/users/90756/edmz"}, "is_accepted": false, "score": 0, "last_activity_date": 1518481813, "creation_date": 1518481813, "answer_id": 48757756, "question_id": 48754247, "link": "https://stackoverflow.com/questions/48754247/how-to-compile-a-gem-without-compiler-hardening-in-ubuntu/48757756#48757756", "title": "how to compile a gem without compiler hardening in Ubuntu?", "body": "<p>I found the solution to my problem although the solution is not a direct answer to this question. </p>\n\n<p>I wanted to disable the compiler errors caused by the compiler hardening settings in ubuntu. As @Jesper pointed out in the comments that might not be a wise idea. </p>\n\n<p>But I wanted to know why it wasn't working. It compiled fine on MacOS. Then I noticed that most of the errors were in a file called <code>tx_swig_wrap.cxx</code>.</p>\n\n<p>I know very little about swig, but I kind of new that it allows some c/c++ code to be called from ruby, python, etc.</p>\n\n<p>It was then that I realized that maybe that wrapper file was generated by swig and that the errors I was getting might have been fixed by a newer swig version.</p>\n\n<p>The wrapper file has a comment section at the top that tells you the swig version that created it. It was 1.X and the latest swig is v3.X. </p>\n\n<p>I installed swig and I learned that I could regenerate the wrapper by executing <code>swig -c++ -ruby tx_swig.i</code>. </p>\n\n<p>I did just that and with the new generated file the gem compiled without issues.</p>\n"}], "owner": {"reputation": 3180, "user_id": 90756, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3aa663e8a021b03a52274b898efe462?s=128&d=identicon&r=PG", "display_name": "edmz", "link": "https://stackoverflow.com/users/90756/edmz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1518481813, "creation_date": 1518464332, "question_id": 48754247, "link": "https://stackoverflow.com/questions/48754247/how-to-compile-a-gem-without-compiler-hardening-in-ubuntu", "title": "how to compile a gem without compiler hardening in Ubuntu?", "body": "<p>I am using <a href=\"https://github.com/vydao/ztx\" rel=\"nofollow noreferrer\">a gem</a> that won't compile on Ubuntu because of what appears are compiler hardening settings.</p>\n\n<p>If I clone the gem's repo and modify the Makefile to add a CPPFLAG of <code>-Wno-format-security</code> then it compiles just fine.</p>\n\n<p>My problem is that when I try to install that gem with <code>gem install ztx-0.0.1.gem</code> it tries to compile the gem again but somehow ignoring the CPP flags specified of the Makefile. (I assume this is happening because I get the same errors that I was getting before adding the <code>-Wno-format-security</code> flag).</p>\n\n<p>I tried exporting CPPFLAGS before calling <code>gem install...</code> but with the same results.</p>\n\n<p>So, my question is, how can I force those CPP flags so that I can compile that gem?</p>\n"}]