[{"tags": ["ruby", "rubygems", "rhel7"], "comments": [{"owner": {"reputation": 11, "user_id": 2102823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CYSO.png?s=128&g=1", "display_name": "wwwdavid34", "link": "https://stackoverflow.com/users/2102823/wwwdavid34"}, "edited": false, "score": 0, "creation_date": 1519877264, "post_id": 49040508, "comment_id": 85090035, "body": "Came across <a href=\"https://github.com/rubygems/rubygems/issues/1448\" rel=\"nofollow noreferrer\">this thread</a>, looks like an ongoing bug in rubygems for older ruby. Any ideas how to uninstall/downgrade rubygems?"}, {"owner": {"reputation": 958, "user_id": 5666052, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002574636751/picture?type=large", "display_name": "Pedro Gabriel Lima", "link": "https://stackoverflow.com/users/5666052/pedro-gabriel-lima"}, "edited": false, "score": 0, "creation_date": 1519909464, "post_id": 49040508, "comment_id": 85104889, "body": "Hey, I don&#39;t know about your problem question but I know a gem manager that is good! You can manager gem version by folder, is very helpful with you are working with ruby and ruby on rails. Check out: <a href=\"http://railsapps.github.io/installrubyonrails-ubuntu.html\" rel=\"nofollow noreferrer\">railsapps.github.io/installrubyonrails-ubuntu.html</a>   - Here is the doc.: <a href=\"https://rvm.io/rubies\" rel=\"nofollow noreferrer\">rvm.io/rubies</a>"}], "owner": {"reputation": 11, "user_id": 2102823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CYSO.png?s=128&g=1", "display_name": "wwwdavid34", "link": "https://stackoverflow.com/users/2102823/wwwdavid34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519861691, "creation_date": 1519861691, "question_id": 49040508, "link": "https://stackoverflow.com/questions/49040508/rubygems-install-or-downgrade-remove-rubygems", "title": "Rubygems install or downgrade/remove rubygems", "body": "<p>I had installed ruby 1.8.7 in a RHEL7 machine, with rubygems 2.7.6. I know 1.8.7 is old, but I need it to run our specific software package. When I tried to install any gem, it runs into a Gem::Package::PathError.</p>\n\n<pre><code>$ gem install rb-readline\nYAML safe loading is not available. Please upgrade psych to a version that supports safe loading (&gt;= 2.0).\nERROR:  While executing gem ... (Gem::Package::PathError)\ninstalling into parent path CHANGES of /eog/reference/lib/ruby/gems/1.8/gems/rb-readline-0.5.5 is not allowed\n</code></pre>\n\n<p>Here is my gem env output</p>\n\n<pre><code>    YAML safe loading is not available. Please upgrade psych to a version that supports safe loading (&gt;= 2.0).\nRubyGems Environment:\n  - RUBYGEMS VERSION: 2.7.6\n  - RUBY VERSION: 1.8.7 (2013-06-27 patchlevel 374) [x86_64-linux]\n  - INSTALLATION DIRECTORY: /eog/reference/lib/ruby/gems/1.8\n  - USER INSTALLATION DIRECTORY: /home/nrt/.gem/ruby/1.8\n  - RUBY EXECUTABLE: /eog/reference/bin/ruby\n  - EXECUTABLE DIRECTORY: /eog/reference/bin\n  - SPEC CACHE DIRECTORY: /home/nrt/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /eog/reference/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-linux\n  - GEM PATHS:\n     - /eog/reference/lib/ruby/gems/1.8\n     - /home/nrt/.gem/ruby/1.8\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/lib/qt-3.3/bin\n     - /eog/reference/bin\n     - /eog/reference/scripts\n     - /eog/reference/matlab\n     - /eog/reference/java\n     -\n     - /usr/local/bin\n     - /usr/bin\n     - /usr/local/sbin\n     - /usr/sbin\n     - /opt/ngdc/groovy/bin\n     - /opt/ngdc/p7zip/bin\n     - /home/nrt/.local/bin\n     - /home/nrt/bin\n</code></pre>\n\n<p>I suspected installing psych might solve the problem, but it requires ruby >= 2.2.2.</p>\n\n<pre><code>YAML safe loading is not available. Please upgrade psych to a version that supports safe loading (&gt;= 2.0).\nERROR:  Error installing psych:\n        There are no versions of psych (&gt;= 0) compatible with your Ruby &amp; RubyGems\n        psych requires Ruby version &gt;= 2.2.2. The current ruby version is 1.8.\n</code></pre>\n\n<p>Since I cannot upgrade ruby beyond 1.8.7 which will cause the software to break. I tried the to downgrade rubygems by following command without success.</p>\n\n<pre><code>gem update --system 1.3.7\n</code></pre>\n\n<p>Any ideas that I can fix the gem install problem, or if not, downgrade my rubygems to an older version?</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "floating-point"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519860149, "post_id": 49040190, "comment_id": 85085916, "body": "Use BigDecimal which has fixed-place arithmetic or be prepared for the wild, weird world of <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">floating point math</a>."}, {"owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "edited": false, "score": 0, "creation_date": 1519867395, "post_id": 49040190, "comment_id": 85087747, "body": "Your database probably has a <code>coerce</code> function that will convert results to whatever you like..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519881015, "post_id": 49040190, "comment_id": 85091015, "body": "@tadman <code>BigDecimal</code> could solve the opposite issue, but here it\u2019s MySQL who corrupts data due to floating point operation and I am not sure how <code>BigDecimal</code> would help."}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1519917213, "post_id": 49040190, "comment_id": 85109966, "body": "Why not declare the columns as decimal or double instead of fp?"}, {"owner": {"reputation": 107, "user_id": 4057027, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-QgOq8PJfOrA/AAAAAAAAAAI/AAAAAAAAAEA/7Xngl3KiDBs/photo.jpg?sz=128", "display_name": "Fletcher Stump Smith", "link": "https://stackoverflow.com/users/4057027/fletcher-stump-smith"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1519945160, "post_id": 49040190, "comment_id": 85125169, "body": "@max That isn&#39;t something I have control over."}], "owner": {"reputation": 107, "user_id": 4057027, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-QgOq8PJfOrA/AAAAAAAAAAI/AAAAAAAAAEA/7Xngl3KiDBs/photo.jpg?sz=128", "display_name": "Fletcher Stump Smith", "link": "https://stackoverflow.com/users/4057027/fletcher-stump-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519866954, "creation_date": 1519859364, "last_edit_date": 1519866954, "question_id": 49040190, "link": "https://stackoverflow.com/questions/49040190/reconciling-inconsistent-floating-precision-from-query-in-ruby-on-rails", "title": "Reconciling inconsistent floating precision from query in ruby on rails", "body": "<p>When I run a query like:</p>\n\n<pre><code>ActiveRecord::Base.connection.select_rows(\n  \"select score, coalesce(null, score), score * 1.0\"\\\n  \" from table limit 1\"\n)\nenter code here\n</code></pre>\n\n<p>I get back a result like:</p>\n\n<pre><code>[[805.92, 805.9199829101562, 805.9199829101562]]\n</code></pre>\n\n<p>From <a href=\"https://bugs.mysql.com/bug.php?id=42666\" rel=\"nofollow noreferrer\">this discussion</a> it looks like the discrepancy is due to mysql converting float fields to doubles before performing any arithmetic. </p>\n\n<p>Is there any way to reliably make these two values the same once they are in ruby? Is there a method to covert the last two values back to single per precision, or the first value to double precision? </p>\n\n<p>edit: </p>\n\n<p>I found running</p>\n\n<pre><code>[805.92].pack('f').unpack('f')\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>[805.9199829101562]\n</code></pre>\n\n<p>Though I haven't confirmed that this will always work.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 168, "user_id": 4261120, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LvCkRV1Kv7I/AAAAAAAAAAI/AAAAAAAAAJI/uwI2sDc_xJY/photo.jpg?sz=128", "display_name": "Arthur Del Esposte", "link": "https://stackoverflow.com/users/4261120/arthur-del-esposte"}, "is_accepted": false, "score": 0, "last_activity_date": 1519865332, "creation_date": 1519865332, "answer_id": 49040995, "question_id": 49039232, "link": "https://stackoverflow.com/questions/49039232/rails-testing-render-action-in-controller/49040995#49040995", "title": "Rails testing render action in controller", "body": "<p>You can write tests for your controller using the <a href=\"https://apidock.com/rails/ActionController/TemplateAssertions/assert_template\" rel=\"nofollow noreferrer\">assert_template</a> method:</p>\n\n<pre><code>test \"should render the correct template\" do\n  ['path1', 'path2'].each do |path|\n    get '/', params: { path: path }\n    assert_template \"#{path}\"\n  end\nend\n</code></pre>\n\n<p><a href=\"http://guides.rubyonrails.org/testing.html#functional-tests-for-your-controllers\" rel=\"nofollow noreferrer\">This guide</a> provides more details on how to test your controllers. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1400312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519865332, "creation_date": 1519854829, "question_id": 49039232, "link": "https://stackoverflow.com/questions/49039232/rails-testing-render-action-in-controller", "title": "Rails testing render action in controller", "body": "<p>I have a dynamically driven Rails application where views and determined by the path requested.</p>\n\n<p>routes.rb:</p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n\n  get ':tenant', to: 'tenants#home'\n  get  '/:path', to: 'tenants#page', :constraints =&gt; { :path =&gt; /.*/ }\nend\n</code></pre>\n\n<p>TenantsController:</p>\n\n<pre><code>class TenantsController &lt; ApplicationController\n    def home\n        render :template =&gt; params[:tenant] + \"/home\"\n    end\n\n    def page\n        render :template =&gt; params[:path]\n    end\nend\n</code></pre>\n\n<p>As you can see what simply happens is we get the path constraint from the endpoint and render a view template from it.</p>\n\n<p>I would like to write a test that ensures rails requests a view template that matches the URL requested. (Basically test the page method within TenantsController).</p>\n\n<p>Given that I do not want to tie my test into tenants that may be in the system, how can I write a test for this generically without the test knowing about some Tennant? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-migrations"], "answers": [{"comments": [{"owner": {"reputation": 834, "user_id": 3588645, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PqWVv.jpg?s=128&g=1", "display_name": "Paul Danelli", "link": "https://stackoverflow.com/users/3588645/paul-danelli"}, "edited": false, "score": 0, "creation_date": 1519901960, "post_id": 49047887, "comment_id": 85100660, "body": "You&#39;re right. My initializer for MoneyRails was overriding all amount column settings, not merging them, which was really dumb of me. Thank you for your help, it&#39;s very much appreciated."}, {"owner": {"reputation": 1011, "user_id": 98413, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/9ce6ae98ca0da4a5aa9d66c96666dada?s=128&d=identicon&r=PG", "display_name": "Mooktakim Ahmed", "link": "https://stackoverflow.com/users/98413/mooktakim-ahmed"}, "edited": false, "score": 0, "creation_date": 1574435843, "post_id": 49047887, "comment_id": 104244521, "body": "This is definitely the answer, it used to be that when you set &quot;default_currency&quot; to &quot;gbp&quot; it would set &quot;postfix&quot; to &quot;_pennies&quot;. now it sticks to &quot;_cents&quot;. Which means all our own columns still have &quot;_pennies&quot;, so have to set postfix manually."}], "tags": [], "owner": {"reputation": 335, "user_id": 210980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/350956e867b4af1c5810517437b7d367?s=128&d=identicon&r=PG", "display_name": "Jasper Tandy", "link": "https://stackoverflow.com/users/210980/jasper-tandy"}, "is_accepted": true, "score": 2, "last_activity_date": 1519900941, "creation_date": 1519900941, "answer_id": 49047887, "question_id": 49038824, "link": "https://stackoverflow.com/questions/49038824/rails-money-migration-fails/49047887#49047887", "title": "Rails Money migration fails", "body": "<p>Are you doing anything in an initializer that might affect the <code>MoneyRails::Configuration#amount_column</code>? Looks like the <code>OptionsExtractor</code> is missing a few things.</p>\n"}], "owner": {"reputation": 834, "user_id": 3588645, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PqWVv.jpg?s=128&g=1", "display_name": "Paul Danelli", "link": "https://stackoverflow.com/users/3588645/paul-danelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 49047887, "answer_count": 1, "score": 0, "last_activity_date": 1519900941, "creation_date": 1519853113, "question_id": 49038824, "link": "https://stackoverflow.com/questions/49038824/rails-money-migration-fails", "title": "Rails Money migration fails", "body": "<p>I am trying to import all migrations. However, the use of <code>t.monetize :total, currency: { present: false }</code> within a create_table block seems to crash with the following error message:</p>\n\n<pre><code>class AddAddressAndOrder &lt; ActiveRecord::Migration[5.1]\n  def change\n    create_table :line_items do |t|\n      t.belongs_to :order\n      t.integer :quantity, default: 0\n      t.monetize :price, currency: { present: false }\n      t.monetize :total, currency: { present: false }\n      t.timestamps\n    end\n  end\nend\n\n\n*** ArgumentError Exception: wrong number of arguments (given 1, expected 2..3)\n</code></pre>\n\n<p>Each time I get to a t.monetize (or t.money) column reference I receive the same error... added below (including --trace): </p>\n\n<pre><code>** Invoke db:migrate (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Invoke db:load_config (first_time)\n** Execute db:load_config\n** Execute db:migrate\n\n== 20160901101357 AddAddressAndOrder: migrating ===============================\n-- create_table(:orders)\nrake aborted!\nStandardError: An error has occurred, all later migrations canceled:\n\nwrong number of arguments (given 1, expected 2..3)\nschema_definitions.rb:311:in `column'\ntable_pg_rails4.rb:9:in `block in monetize'\ntable_pg_rails4.rb:6:in `each'\ntable_pg_rails4.rb:6:in `monetize'\n/Users/Paul/folder/Sites/project/db/migrate/20160901101357_add_address_and_order.rb:20:in `block in change'\nschema_statements.rb:282:in `create_table'\nabstract_mysql_adapter.rb:363:in `create_table'\nmethod_missing'\nsay_with_time'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/benchmark.rb:293:in `measure'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:818:in `say_with_time'\n`method_missing'\n/Users/Paul/folder/Sites/project/db/migrate/20160901101357_add_address_and_order.rb:18:in `change'\n`exec_migration'\nmigrate'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/benchmark.rb:293:in `measure'\nmigrate'\nconnection_pool.rb:408:in `with_connection'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:774:in `migrate'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:953:in `migrate'\nexecute_migration_in_transaction'\n`ddl_transaction'\n`execute_migration_in_transaction'\nmigrate_without_lock'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1200:in `each'\n`migrate_without_lock'\nmigrate'\n`with_advisory_lock'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1148:in `migrate'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1007:in `up'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:985:in `migrate'\n`migrate'\nlevels) in &lt;top (required)&gt;'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `block in execute'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `each'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `execute'\ninvoke_with_call_chain'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n`invoke_with_call_chain'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:181:in `invoke'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:160:in `invoke_task'\ntop_level'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:116:in `each'\ntop_level'\n`run_with_threads'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:110:in `top_level'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:83:in `block in run'\n`standard_exception_handling'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:80:in `run'\n/Users/Paul/.rvm/gems/ruby-2.5.0@global/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/bin/rake:23:in `load'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/bin/rake:23:in `&lt;main&gt;'\n\nCaused by:\nArgumentError: wrong number of arguments (given 1, expected 2..3)\nschema_definitions.rb:311:in `column'\ntable_pg_rails4.rb:9:in `block in monetize'\ntable_pg_rails4.rb:6:in `each'\ntable_pg_rails4.rb:6:in `monetize'\n/Users/Paul/folder/Sites/project/db/migrate/20160901101357_add_address_and_order.rb:20:in `block in change'\nschema_statements.rb:282:in `create_table'\nabstract_mysql_adapter.rb:363:in `create_table'\nmethod_missing'\nsay_with_time'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/benchmark.rb:293:in `measure'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:818:in `say_with_time'\n`method_missing'\n/Users/Paul/folder/Sites/project/db/migrate/20160901101357_add_address_and_order.rb:18:in `change'\n`exec_migration'\nmigrate'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/benchmark.rb:293:in `measure'\nmigrate'\nconnection_pool.rb:408:in `with_connection'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:774:in `migrate'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:953:in `migrate'\nexecute_migration_in_transaction'\n`ddl_transaction'\n`execute_migration_in_transaction'\nmigrate_without_lock'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1200:in `each'\n`migrate_without_lock'\nmigrate'\n`with_advisory_lock'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1148:in `migrate'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:1007:in `up'\n/Users/Paul/.rvm/gems/ruby-2.5.0@project/gems/activerecord-5.1.4/lib/active_record/migration.rb:985:in `migrate'\n`migrate'\nlevels) in &lt;top (required)&gt;'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `block in execute'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `each'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:251:in `execute'\ninvoke_with_call_chain'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/2.5.0/monitor.rb:226:in `mon_synchronize'\n`invoke_with_call_chain'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/task.rb:181:in `invoke'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:160:in `invoke_task'\ntop_level'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:116:in `each'\ntop_level'\n`run_with_threads'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:110:in `top_level'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:83:in `block in run'\n`standard_exception_handling'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/lib/ruby/gems/2.5.0/gems/rake-12.3.0/lib/rake/application.rb:80:in `run'\n/Users/Paul/.rvm/gems/ruby-2.5.0@global/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/bin/rake:23:in `load'\n/Users/Paul/.rvm/rubies/ruby-2.5.0/bin/rake:23:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate\n</code></pre>\n\n<p>My Gemfile.lock looks like this regarding Money-Rails: </p>\n\n<pre><code>money (~&gt; 6.10.1)\nmoney-rails (1.10.0)\n  activesupport (&gt;= 3.0)\n  monetize (~&gt; 1.7.0)\n  money (~&gt; 6.10.0)\n  railties (&gt;= 3.0)\n</code></pre>\n\n<p>The docs (<a href=\"https://github.com/RubyMoney/money-rails#migration-helpers\" rel=\"nofollow noreferrer\">https://github.com/RubyMoney/money-rails#migration-helpers</a>) state that this should be fine. So I've no idea what to do. </p>\n\n<p>The issue seems to be within the <code>MoneyRails::ActiveRecord::Migration::Table.monetize</code> method: </p>\n\n<pre><code>module MoneyRails\n  module ActiveRecord\n    module MigrationExtensions\n      module Table\n        def monetize(accessor, options={})\n          [:amount, :currency].each do |attribute|\n            column_present, _, *opts = OptionsExtractor.extract attribute, :no_table, accessor, options\n            column(*opts) if column_present\n          end\n        end\n\n        # Removed for brevity\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>No matter what is passed to monetize, it always seems to throw the same error. I really am lost as to what I am doing wrong, so any help would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "sinatra"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519852303, "post_id": 49038611, "comment_id": 85082477, "body": "This depends on the context and complexity. Can you include code as an example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1913545"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519852783, "post_id": 49038611, "comment_id": 85082747, "body": "I&#39;ve added example."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519852851, "post_id": 49038611, "comment_id": 85082787, "body": "Try and declare fixed hashes like that as constants so you don&#39;t need to create new objects (and garbage!) each time that method is executed. That&#39;s just a look-up table. If your Sinatra app is just one file you can put that anywhere you like. If it has multiple files it&#39;s up to you as to where it goes, Sinatra has no specific conventions like Rails does."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1519874490, "post_id": 49038611, "comment_id": 85089374, "body": "How are you going to know the place?"}, {"owner": {"reputation": 1135, "user_id": 1638009, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/cce87e94a76af5a587b5c9fe48461910?s=128&d=identicon&r=PG", "display_name": "Shimu", "link": "https://stackoverflow.com/users/1638009/shimu"}, "edited": false, "score": 0, "creation_date": 1519888207, "post_id": 49038611, "comment_id": 85093416, "body": "Do you need this hash only in one controller/one class for your business logic? If so, just put the hash as a constant inside that file"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1913545"}, "edited": false, "score": 0, "creation_date": 1519929273, "post_id": 49038611, "comment_id": 85117453, "body": "I need this method for 2 class. I&#39;ve two mapping method like that. And there is about 100 departments from France so it&#39;s 2 big methods with ~ 200 lines. I just want to keep my code clean."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1520021150, "post_id": 49038611, "comment_id": 85158912, "body": "I&#39;d put the mapping in a configuration file, probably JSON or YAML."}], "answers": [{"comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1520021068, "post_id": 49076519, "comment_id": 85158875, "body": "It also amuses me that the branching could be tighter :-D"}], "tags": [], "owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "is_accepted": true, "score": 0, "last_activity_date": 1520021353, "last_edit_date": 1520021353, "creation_date": 1520020997, "answer_id": 49076519, "question_id": 49038611, "link": "https://stackoverflow.com/questions/49038611/where-can-i-store-a-mapping-method/49076519#49076519", "title": "Where can I store a mapping method?", "body": "<pre class=\"lang-rb prettyprint-override\"><code>begin\n  case \"my hash's use\" do\n    when \"it's for display\" then\n      if \"it's a small method\"\n        \"put it in a helper for use a controller\"\n      else\n        \"put it in a module and include it using via `helper`\"\n      end\n    when \"it's not for display\" then \"put it in a helper for use in a route block\"\n  else\n    \"it should go in the class that requires it.\"\n  end\n\nrescue NoMethodError =&gt; e\n  e.message = &lt;&lt;~MESSAGE\n    If it doesn't work because the logic isn't defined\n    in your views or route blocks then it should go in \n    the class that requires it.\"\n  MESSAGE\nensure\n  \"I get out more so I stop answering this question in Ruby ;-)\"\nend\n</code></pre>\n\n<p>In other words, put it in a helper and then you can assess later whether it should go somewhere else.</p>\n\n<p>Regardless, @tadman is right about declaring that example hash as a constant, you should treat access to that as you would to any other constant - if you need it in more than one place then have it the level above in the namespace hierarchy. If it's a lot of data then @Stefan is right to say to load it from somewhere else.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1913545"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49076519, "answer_count": 1, "score": -1, "last_activity_date": 1520021353, "creation_date": 1519852223, "last_edit_date": 1519874440, "question_id": 49038611, "link": "https://stackoverflow.com/questions/49038611/where-can-i-store-a-mapping-method", "title": "Where can I store a mapping method?", "body": "<p>I work on an app with Sinatra framework. I would know where the best place is to store a mapping method: in a controller or a decorator. In fact, I import data from a French website that has a French territory, and I want to convert the number territory from number to name.</p>\n\n<p>Here is my method:</p>\n\n<pre><code>def territory_mapping(code)\n  {\n    '01' =&gt; 'Auvergne-Rh\u00f4ne-Alpes',\n    '02' =&gt; 'Hauts-de-France',\n    '03' =&gt; 'Auvergne-Rh\u00f4ne-Alpes'\n  }[code]\nend\n</code></pre>\n\n<p>I want to know where I can store this method.</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 0, "creation_date": 1519903153, "post_id": 49039729, "comment_id": 85101276, "body": "Thanks for your answer! I actually thought about your suggested approach in the first place and I think it&#39;s definitely the best way to validate a booking on a server side. However, in order to make this work on the client side I would need to do one of the following options: A) Do an API call everytime a user changes the dates. B) Render all future bookings upon page load and use Vue to evaluate whether a date is available or not. Which approach would you suggest for the front end?"}, {"owner": {"reputation": 1136, "user_id": 5215927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w06Fv.jpg?s=128&g=1", "display_name": "mr_sudaca", "link": "https://stackoverflow.com/users/5215927/mr-sudaca"}, "reply_to_user": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 0, "creation_date": 1519906359, "post_id": 49039729, "comment_id": 85103072, "body": "I&#39;d go for option A, and maybe look for a way to cache certain data (using redis, for example)"}], "tags": [], "owner": {"reputation": 1136, "user_id": 5215927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w06Fv.jpg?s=128&g=1", "display_name": "mr_sudaca", "link": "https://stackoverflow.com/users/5215927/mr-sudaca"}, "is_accepted": false, "score": 1, "last_activity_date": 1519857131, "creation_date": 1519857131, "answer_id": 49039729, "question_id": 49038275, "link": "https://stackoverflow.com/questions/49038275/how-to-group-count-and-map-date-ranges/49039729#49039729", "title": "How to group, count and map date ranges?", "body": "<p>i'd create a <code>RentalItemAvailability</code> class, passing <code>rental_item</code> and the date, in order to check availability for a given date, instead of trying to make something really weird figuring out how to achieve the same by a range of dates... something like:</p>\n\n<pre><code>class RentalItemAvailability\n  delegate :maximum_capacity_per_day, :bookins, to: :@rental_item\n\n  def initialize(rental_item, date)\n    @rental_item = rental_item\n    @date = date\n  end\n\n  def available?\n    bookings_on_date &lt; maximum_capacity_per_day\n  end\n\n  def bookins_on_date\n    bookins\n     .where('rental_start between :date and :date and rental_end between :date and :date', @date).count\n  end\nend      \n</code></pre>\n\n<p>That way you can validate each day and mark <code>rental_item</code> as available/not available</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "edited": false, "score": 0, "creation_date": 1519903548, "post_id": 49043983, "comment_id": 85101462, "body": "Thanks for your help! Building a hash which contains dates and counts instead of unavailable dates is also a good idea. I&#39;m gonna play around with this and see where it takes me. I don&#39;t really like the idea to store separate dates though, even the query might be more straightforward."}], "tags": [], "owner": {"reputation": 1389, "user_id": 4133078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P24yz.jpg?s=128&g=1", "display_name": "Cody Gustafson", "link": "https://stackoverflow.com/users/4133078/cody-gustafson"}, "is_accepted": false, "score": 0, "last_activity_date": 1519886538, "creation_date": 1519886538, "answer_id": 49043983, "question_id": 49038275, "link": "https://stackoverflow.com/questions/49038275/how-to-group-count-and-map-date-ranges/49043983#49043983", "title": "How to group, count and map date ranges?", "body": "<p>I believe you asking to modify <code>item_unavailable</code> to return a count for each item/date. To do that, you would <em>probably</em> want to build a hash within ruby based on the item_id, which contains the dates and counts. Something like this:</p>\n\n<pre><code>{\n  1: {\n    \"Feb 28 18\": 1,\n    \"Mar 01 18\": 2\n  }\n}\n</code></pre>\n\n<p>An alternative approach would be to store a separate booking for each date (instead of having a begin and end date). That would end up being a greater number of records, but I believe it would be a more intuitive approach.\nAn example of querying for results similar to the hash above:</p>\n\n<pre><code>future_bookings.group(:rentalitem_id, :date).count\n# {[1, \"date_from_db\"]=&gt;2, [2, \"date2_from_db\"]=&gt;1}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8567436, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/O7Cd0.png?s=128&g=1", "display_name": "luke.hawk", "link": "https://stackoverflow.com/users/8567436/luke-hawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "closed_date": 1519902545, "answer_count": 2, "score": 0, "last_activity_date": 1519886538, "creation_date": 1519850887, "question_id": 49038275, "link": "https://stackoverflow.com/questions/49038275/how-to-group-count-and-map-date-ranges", "closed_reason": "Needs details or clarity", "title": "How to group, count and map date ranges?", "body": "<p>I'm working on a booking model where items can be rented for an arbitrary period of time and each item has a maximum capacity of bookings per day (which is basically the quantity  of an item). Obviously, I want to check whether an item is available for booking or if the maximum capacity has already been reached prior a booking. I thought about creating a method in the <code>Booking</code> model which returns an array of objects with all <strong>un</strong>available dates and items, so that the desired output is:</p>\n\n<pre><code>[ {rentalitem_id: 1, unavailable: '01-03-2018'},\n  {rentalitem_id: 2, unavailable: '02-03-2018'},\n  {rentalitem_id: 1, unavailable: '01-03-2018'} ]\n</code></pre>\n\n<p>I could then render the method with JSON in order to access it in my frontend (Vue.js) where I could simply disable all dates for the according items. Of course I would also validate whether the date is available or not in the backend while processing the booking. </p>\n\n<p><strong>First question</strong>: What do you think of the idea? Maybe there are more elegant solutions how to achieve this? </p>\n\n<p>So far the method in my bookings model that I wrote looks like the following: </p>\n\n<pre><code>class Booking &lt; ApplicationRecord\n\n ...\n\n   scope :future_bookings, -&gt; (time) { where(\"rental_start &gt;= ?\", time) }\n\n ...\n\n   def self.item_unavailable\n      sorted_booking = future_bookings(Time.now).map do |booking|\n         { rentalitem_id: booking.rentalitem_id,\n           dates: ((booking.rental_start.to_date..booking.rental_end.to_date).map{ |date| date.strftime(\"%b %d %y\") }).to_a }\n      end\n      merged_bookings = sorted_booking.group_by{ |key| key[:rentalitem_id]}.each do |_, value|\n          value.map!{ |arr| arr[:dates] }\n      end\n   end\nend\n</code></pre>\n\n<p>So, basically I map over all future bookings creating a variable consiting of the <code>rentalitem_id</code> and all dates between <code>rental_start</code> and <code>rental_end</code>. After that, I group those results by the <code>rentalitem_id</code>, so that <code>merged_bookings</code> now returns all dates on which an item is booked:</p>\n\n<pre><code># { 1=&gt;[[\"Feb 28 18\", \"Mar 01 18\", \"Mar 02 18\", \"Mar 03 18\"], [\"Mar 01 18\", \"Mar 02 18\", \"Mar 03 18\", \"Mar 04 18\", \"Mar 05 18\"]], 2=&gt;[[\"Mar 01 18\", \"Mar 02 18\"], [\"Mar 02 18\", \"Mar 03 18\"], [\"Mar 02 18\", \"Mar 03 18\", \"Mar 04 18\"]] }\n</code></pre>\n\n<p>The idea was to count all intersecting dates across the arrays and return the date when it reaches the maximum capacity for the according rentalitem, whereas the maximum capacity should be queried from the rentalitem model. However, I'm stuck here and tried everything I could imagine to perfom this action. I thought about using <code>inject</code> to return the values which are unavailable, but before that I would need to count the intersecting dates?</p>\n\n<p>Let's suppose the first <code>rentalitem</code> has a maximum capacity of two bookings per day, than it should be unavailable for March 1st. Further, suppose the second <code>rentalitem</code> has a maximum capacity of three bookings per day. Hence it should be unavailable for March 2nd following the example. </p>\n\n<p>I would highly appreciate some help here :-) </p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver", "rspec", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1519854646, "post_id": 49038530, "comment_id": 85083697, "body": "Added some content to the question that might better address the issue."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1519855139, "post_id": 49038530, "comment_id": 85083912, "body": "@Zack You still haven&#39;t stated what version of FF you&#39;re using - if 59 then you&#39;ll need to use the master branch of Capybara for this to work without you doing anything else.  Did you try calling the code in my answer at the end of your tests that pop up the question?"}, {"owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1519856160, "post_id": 49038530, "comment_id": 85084371, "body": "I&#39;m on 58.0.2 64-bit. That code does work but it requires me to insert that at the end of every test that ends that way. It feels like a hacky way to handle the problem. I do appreciate the solution though."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "edited": false, "score": 0, "creation_date": 1519856860, "post_id": 49038530, "comment_id": 85084640, "body": "@Zack This shouldn&#39;t be an issue with FF 58 if you&#39;re using the latest geckodriver and capybara (it&#39;s specifically tested for in the Capybara test suite).  As for the work around code, as I stated in my answer you wouldn&#39;t actually need to insert it at the end of every test if you put it in an after block triggered by metadata, I&#39;ve expanded my answer to spell that out step by step."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 1, "last_activity_date": 1519857194, "last_edit_date": 1519857194, "creation_date": 1519851866, "answer_id": 49038530, "question_id": 49038258, "link": "https://stackoverflow.com/questions/49038258/capybara-session-not-closing-at-end-of-test/49038530#49038530", "title": "Capybara session not closing at end of test", "body": "<p>You don't indicate what browser and version of the browser you're using (for instance FF 59 has recently made a change that makes handling unload modals more difficultg to deal with) nor any other versions of the test gems you're using, so it's tough to say whether or not your current issue would be fixed by upgrading (it may).  However you can work around this issue in the tests where you know an unload modal will appear by adding</p>\n\n<pre><code>accept_confirm do\n  visit(\"about:blank\") # or any page in your app that doesn't have an unload modal ( / for instance )\nend\n</code></pre>\n\n<p>to the end of those specific tests.  That could be implemented in after block triggered by metadata on the feature if you want to keep your actual test code clean. To implement it via metadata you'd change your RSpec configure block to something like</p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:each) do\n    config.include Capybara::DSL\n  end\n\n  config.after(:each, clear_unload_modal: true) do\n    accept_confirm do # may need to be Capybara.current_session.accept_confirm depending on your includes\n      visit(\"/\") # may need to be Capybara.current_session.visit\n    end\n  end\n\n  config.after(:each) do\n    Capybara.reset_sessions!\n  end\nend\n</code></pre>\n\n<p>and then tag each test that needs it with :clear_unload_modal</p>\n\n<pre><code>scenario \"blah blah\", :clear_unload_modal do\n  ....\nend\n</code></pre>\n"}], "owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519857194, "creation_date": 1519850835, "last_edit_date": 1519852908, "question_id": 49038258, "link": "https://stackoverflow.com/questions/49038258/capybara-session-not-closing-at-end-of-test", "title": "Capybara session not closing at end of test", "body": "<p>I have a series of automated tests using selenium/capybara/rspec. For one of my tests, I am dirtying a form and verifying that certain errors are triggered. That is the end of the test... The problem is that when the test finishes running, the and the code tries to close the browser, a JavaScript message pops up with <code>This page is asking you to confirm that you want to leave - data you have entered may not be saved.</code></p>\n\n<p>In my spec helper I have:</p>\n\n<pre><code>Capybara.register_driver :firefox do |app|\n  Capybara::Selenium::Driver.new(app, browser: :firefox)\nend\n\nCapybara.default_driver = :firefox\nCapybara.app_host = ********* #redacted\nCapybara.default_max_wait_time = 5\n\nRSpec.configure do |config|\n  config.before(:each) do\n    config.include Capybara::DSL\n  end\n\n  config.after(:each) do\n    Capybara.reset_sessions!\n  end\nend\n</code></pre>\n\n<p>and am getting a test failure with <code>Capybara::ExpectationNotMet: Timed out waiting for Selenium session reset</code></p>\n\n<p>How do I make the test close the browser at the end?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 168, "user_id": 985623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae1f237b49d8a9b8f06948513195fb44?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/985623/victor"}, "edited": false, "score": 1, "creation_date": 1519849635, "post_id": 49037572, "comment_id": 85081086, "body": "It happens because <code>sort_by</code> passes an array into the block, like this [341, [&quot;CANDY&quot;, 3.99]]. You should use <code>hash.sort_by {|product| product[1][1]}</code>"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519852469, "post_id": 49037572, "comment_id": 85082575, "body": "You&#39;d better show us the value of <code>hash</code> (not that text blob without showing us the code that turns it into <code>hash</code>) and exactly what result you want. Right now the structure and types are unclear."}, {"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1519853855, "post_id": 49037572, "comment_id": 85083312, "body": "added all the code so everyone can better understand whats going on with what I&#39;m asking."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519854513, "post_id": 49037572, "comment_id": 85083641, "body": "I don&#39;t believe you that that puts out 1.89 for the max. <code>e</code> is larger than <code>P</code>."}, {"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1519854927, "post_id": 49037572, "comment_id": 85083818, "body": "<code>puts &quot;The cheapest product is #{sorted.first}&quot;  puts &quot;The most expensive product is #{sorted.max.last}</code> is the code that was making 1.89 the max"}, {"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "reply_to_user": {"reputation": 168, "user_id": 985623, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ae1f237b49d8a9b8f06948513195fb44?s=128&d=identicon&r=PG", "display_name": "Victor", "link": "https://stackoverflow.com/users/985623/victor"}, "edited": false, "score": 0, "creation_date": 1519855521, "post_id": 49037572, "comment_id": 85084085, "body": "@Victor thank you that actually fixed my issue&#39;s with some help from other answers as well, and its displaying right now with low and high"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1519848802, "post_id": 49037664, "comment_id": 85080639, "body": "Sorry i don&#39;t know why i put them in order there actually not in order. so if i try this way it brings back they key value for the cheap and then brings back the expensive = energy drink at 4.00 which its not that its the pizza at 12.99"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "reply_to_user": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 1, "creation_date": 1519849506, "post_id": 49037664, "comment_id": 85081014, "body": "I&#39;m willing to bet your prices are stored as strings, so &quot;4.00&quot;&gt;&quot;12.99&quot;. The quick, hacky way to fix that is to sort by <code>product[1].to_f</code>"}, {"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1519854143, "post_id": 49037664, "comment_id": 85083458, "body": "updated the post with entire code. so its better to understand now"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 1, "last_activity_date": 1519848229, "creation_date": 1519848229, "answer_id": 49037664, "question_id": 49037572, "link": "https://stackoverflow.com/questions/49037572/hashes-using-min-and-max/49037664#49037664", "title": "Hashes using min and max", "body": "<p><code>min</code> and <code>max</code> search for the minimum and maximum element in an array and return it. They are searching for the min and max using some other criteria that give the wrong result (lexicographic ordering).</p>\n\n<p>But your hash's entries are already sorted correctly in the <code>sorted</code> array, so just get the first and last elements:</p>\n\n<pre><code>puts \"The cheapest product is #{sorted[0].first}\"\nputs \"The most expensive product is #{sorted[-1].last }\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1519852499, "post_id": 49037723, "comment_id": 85082593, "body": "Don&#39;t forget <a href=\"https://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-minmax_by\" rel=\"nofollow noreferrer\"><code>minmax_by</code></a> which means you only need one call here, not two. You also don&#39;t need to sort if you&#39;re calling <code>min</code> or <code>max</code>, it doesn&#39;t help."}, {"owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "edited": false, "score": 0, "creation_date": 1519854077, "post_id": 49037723, "comment_id": 85083424, "body": "updated the post with entire code. so its better to understand now"}, {"owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519857019, "post_id": 49037723, "comment_id": 85084722, "body": "@tadman Nice call I forgot about #minmax_by. That is even better."}], "tags": [], "owner": {"reputation": 1523, "user_id": 6896906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JiWcO.jpg?s=128&g=1", "display_name": "Zach Tuttle", "link": "https://stackoverflow.com/users/6896906/zach-tuttle"}, "is_accepted": false, "score": 1, "last_activity_date": 1519856970, "last_edit_date": 1519856970, "creation_date": 1519848519, "answer_id": 49037723, "question_id": 49037572, "link": "https://stackoverflow.com/questions/49037572/hashes-using-min-and-max/49037723#49037723", "title": "Hashes using min and max", "body": "<p>No really sure whats going on, but your code doesn't work for me. Are you trying to do something like this:</p>\n\n<pre><code>options = {\n    POP: 1.89,\n    CANDY: 3.99,\n    PIZZA: 12.99,\n    energy_drink: 4.00\n}\n\noptions.each do |key, value|\n    puts \"#{key} - #{value}, #{value}\"\nend\n\nsorted = options.sort\nputs\nputs \"The cheapest product is #{ sorted.min_by {| key, value| value } }\"\nputs \"The most expensive product is #{ sorted.max_by {|key, value| value } }\"\n</code></pre>\n\n<p>After reading your code that you posted I got it to work like this:</p>\n\n<pre><code>hash = {}\nfiles = File.open(\"products.txt\", \"r\")\n\nfiles.each_line do |line|\n  id, name, price = line.chomp.split(',')\n  hash[id] = [name, price.to_f]\nend\n\nfiles.close\n\nwhile true\n  print \"\\n5. View highest-priced product and lowest-priced product\n    Choose an option:  \"\n\n  options = gets.chomp.to_i\n\n  if options == 5\n    hash.each {|key, value|\n      puts \"#{key} - #{value[0]}, #{value[1]}\"\n    }\n    sorted = hash.sort_by {|product| product[1][1]}.minmax_by { |key , value| value[1]}\n    puts\n    puts \"The cheapest product is #{ sorted.first }\"\n    puts \"The most expensive product is #{sorted.last}\"\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7467564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/259896cf5a66cf93389a39403d1ed3e5?s=128&d=identicon&r=PG&f=1", "display_name": "CJ15", "link": "https://stackoverflow.com/users/7467564/cj15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1519856970, "creation_date": 1519847819, "last_edit_date": 1519853780, "question_id": 49037572, "link": "https://stackoverflow.com/questions/49037572/hashes-using-min-and-max", "title": "Hashes using min and max", "body": "<p>Trying to putout the cheapest and the most expensive product. but its not working like i hoped its putting out 3.99 for min and max its putting out 1.89. I'm stumped I've tried min and max I've tried to google but I'm not coming up with anything.\n</p>\n\n<pre><code>This part is the products.txt\n\n    767,POP,1.89\n    341,CANDY,3.99\n    587,PIZZA,12.99\n    453,energy drink,4.00\n</code></pre>\n\n\n\n<pre><code>    hash = {}\nfiles = File.open(\"products.txt\", \"r\")\n\nfiles.each_line do |line|\n  id, name, price = line.chomp.split(',')\n  hash[id] = [name, price]\nend\n\nfiles.close\n\nwhile true\n  print \"\\n5. View highest-priced product and lowest-priced product\n    Choose an option:  \"\n\n  options = gets.chomp.to_i\n\n  if options == 5\n    hash.each {|key, value|\n      puts \"#{key} - #{value[0]}, #{value[1]}\"\n    }\n    sorted = hash.sort_by {|product| product[1]}\n    puts\n    puts \"The cheapest product is #{sorted.first}\"\n    puts \"The most expensive product is #{sorted.last}\"\n  end\nend\n</code></pre>\n"}, {"tags": ["html", "ruby", "html-table"], "comments": [{"owner": {"reputation": 12065, "user_id": 1161948, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/718b2745cc695cefd5418995742dca6a?s=128&d=identicon&r=PG", "display_name": "ThisClark", "link": "https://stackoverflow.com/users/1161948/thisclark"}, "edited": false, "score": 0, "creation_date": 1519847444, "post_id": 49037419, "comment_id": 85079929, "body": "Add the ruby code to this question, please."}, {"owner": {"reputation": 727, "user_id": 5670609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1042677742461591/picture?type=large", "display_name": "Champer Wu", "link": "https://stackoverflow.com/users/5670609/champer-wu"}, "reply_to_user": {"reputation": 12065, "user_id": 1161948, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/718b2745cc695cefd5418995742dca6a?s=128&d=identicon&r=PG", "display_name": "ThisClark", "link": "https://stackoverflow.com/users/1161948/thisclark"}, "edited": false, "score": 0, "creation_date": 1519848394, "post_id": 49037419, "comment_id": 85080424, "body": "@ThisClark I add some code in this editing thanks"}], "owner": {"reputation": 727, "user_id": 5670609, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1042677742461591/picture?type=large", "display_name": "Champer Wu", "link": "https://stackoverflow.com/users/5670609/champer-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519920795, "creation_date": 1519847183, "last_edit_date": 1519920795, "question_id": 49037419, "link": "https://stackoverflow.com/questions/49037419/how-can-i-create-the-dynamic-table-beautifully", "title": "How can I create the dynamic table beautifully?", "body": "<p>How can I set the table tag like this?</p>\n\n<blockquote>\n<pre><code>          col1  col2  col3 col4\n         _____ _____ _____ _____\n row1   |     |_____|_____|     |\n row2   |     |_____|_____|     |\n row3   |     |_____|_____|     |\n row4   |_____|_____|_____|_____|\n</code></pre>\n</blockquote>\n\n<p>I know use the attribute <code>rowspan</code>to let the layout like this</p>\n\n<p>as following my code:</p>\n\n<pre><code>  &lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;number&lt;/th&gt;\n    &lt;th&gt;type&lt;/th&gt;\n    &lt;th&gt;quantity&lt;/th&gt;\n    &lt;th&gt;amount&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td rowspan=\"5\"&gt;a&lt;/td&gt;\n    &lt;td&gt;b&lt;/td&gt;\n    &lt;td&gt;c&lt;/td&gt;\n    &lt;td rowspan=\"5\"&gt;d&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;b&lt;/td&gt;\n    &lt;td&gt;c&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;b&lt;/td&gt;\n    &lt;td&gt;c&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;b&lt;/td&gt;\n    &lt;td&gt;c&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>But in my case, the code is in the iterator of ruby <code>each do</code> method.\nthe items of col1 are all same, but items of col2 and col3 are all dynamic and col4 is the result of col3 calculating(sum).</p>\n\n<p>I used to stupid way to layout the col1 by repeating the same value from row1 to row4 like this:</p>\n\n<pre><code>&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;number&lt;/th&gt;\n    &lt;th&gt;type&lt;/th&gt;\n    &lt;th&gt;quantity&lt;/th&gt;\n    &lt;th&gt;amount&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;%@deals.each do |staff, deals|%&gt;\n    &lt;%if staff%&gt;\n    &lt;% @total_deal_type = deals.group_by(&amp;:type).count%&gt;\n      &lt;%deals.group_by(&amp;:type).each do |type, deals|%&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%=staff.number%&gt;&lt;/td&gt;\n        &lt;%case type%&gt;\n          &lt;%when \"service1\"%&gt;\n          &lt;%@d=staff.service1*deals.count%&gt;\n\n            &lt;td&gt;&lt;%=type%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= deals.count%&gt;&lt;/td&gt;\n\n\n          &lt;%when \"service2\"%&gt;\n          &lt;%@d2=staff.service2*deals.count%&gt;\n\n            &lt;td&gt;&lt;%=type%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= deals.count%&gt;&lt;/td&gt;\n\n\n          &lt;%when \"service3\"%&gt;\n          &lt;%@nc=staff.service3*deals.count%&gt;\n\n            &lt;td&gt;&lt;%=type%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= deals.count%&gt;&lt;/td&gt;\n\n\n          &lt;%when \"service4\"%&gt;\n          &lt;%@add=staff.service4*deals.count%&gt;\n\n            &lt;td&gt;&lt;%=type%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= deals.count%&gt;&lt;/td&gt;\n\n\n          &lt;%when \"service5\"%&gt;\n          &lt;%@bh=staff.service5*deals.count%&gt;\n\n            &lt;td&gt;&lt;%=type%&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= deals.count%&gt;&lt;/td&gt;\n\n        &lt;%end%&gt;\n      &lt;/tr&gt;\n\n      &lt;%end%&gt;\n      &lt;!--&lt;p&gt;amount:&lt;%=@d.to_i+@d2.to_i+@nc.to_i+@add.to_i+@bh.to_i%&gt;&lt;/p&gt;--&gt;\n\n    &lt;%end%&gt;\n\n  &lt;%end%&gt;\n\n&lt;/table&gt;\n</code></pre>\n\n<p>So I want to merge the same value.</p>\n\n<p>It's some way to do this?  </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 475, "user_id": 1845581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf81e573d778c38a688b1f197351d448?s=128&d=identicon&r=PG", "display_name": "Guilherme Holtz", "link": "https://stackoverflow.com/users/1845581/guilherme-holtz"}, "edited": false, "score": 0, "creation_date": 1519845691, "post_id": 49037013, "comment_id": 85079054, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 1, "creation_date": 1519846209, "post_id": 49037013, "comment_id": 85079322, "body": "Despite everything, you need to separate the elements in your array with comma."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1519846449, "post_id": 49037013, "comment_id": 85079454, "body": "check out <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-26\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/Array.html#method-i-26</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1519846487, "post_id": 49037013, "comment_id": 85079480, "body": "What do you mean by <i>&quot;doesn&#39;t work&quot;</i>? Any errors or unexpected results?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1519847096, "post_id": 49037013, "comment_id": 85079763, "body": "You could use Ruby <code>&#39;vowels&#39;.count(&#39;aeiou&#39;) #=&gt; 2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1519846754, "post_id": 49037305, "comment_id": 85079606, "body": "Also, you could just advance gdx outside/after the if-block, assuming you want to advance in any/every case."}, {"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1519846823, "post_id": 49037305, "comment_id": 85079642, "body": "It seems inefficient to repeat <code>gdx = gdx + 1</code> in both branches..."}, {"owner": {"reputation": 11, "user_id": 9425356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934099a8df4285d8ccae176a8672e339?s=128&d=identicon&r=PG&f=1", "display_name": "peter", "link": "https://stackoverflow.com/users/9425356/peter"}, "edited": false, "score": 0, "creation_date": 1519846941, "post_id": 49037305, "comment_id": 85079702, "body": "still it shows the number of vowel as 0"}, {"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1519847048, "post_id": 49037305, "comment_id": 85079745, "body": "Did you fix your vowel array? If you are not white spacing the vowels, you need to use a delimiter."}, {"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1519847116, "post_id": 49037305, "comment_id": 85079771, "body": "And yes, advancing &quot;gdx&quot; in both if cases is a bit noobeish, if you are going to do it no matter what happens and not planning to add any magic inside the blocks. Hence I suggested you can do it outside the block as well."}], "tags": [], "owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "is_accepted": true, "score": 0, "last_activity_date": 1519847278, "last_edit_date": 1519847278, "creation_date": 1519846623, "answer_id": 49037305, "question_id": 49037013, "link": "https://stackoverflow.com/questions/49037013/my-code-to-find-the-number-of-vowels-doesnt-work/49037305#49037305", "title": "my code to find the number of vowels doesnt work", "body": "<pre><code>while gdx &lt; my_vowels.length\n      if string[idx] == my_vowels[gdx]\n        count_vowels = count_vowels + 1\n      else\n        gdx = gdx + 1\n      end\nend\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>while gdx &lt; my_vowels.length\n          if string[idx] == my_vowels[gdx]\n            count_vowels = count_vowels + 1\n            gdx = gdx + 1\n          else\n            gdx = gdx + 1\n          end\nend\n</code></pre>\n\n<p>As you are not advancing your gdx-counter after finding a vowel. So it ends\nup in a loop after finding the first vowel.</p>\n\n<p>Also fixing the array declaration, the working code could be something like this:</p>\n\n<pre><code>def count_vowels(string)\n  count_vowels = 0\n  my_vowels = [\"a\", \"e\", \"i\",\"o\",\"u\",\"y\"]\n  idx = 0\n  while idx &lt; string.length\n    gdx = 0\n    while gdx &lt; my_vowels.length\n      if string[idx] == my_vowels[gdx]\n        count_vowels = count_vowels + 1\n        gdx=gdx+1\n      else\n        gdx = gdx + 1\n      end\n    end\n    idx = idx + 1\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "is_accepted": false, "score": 0, "last_activity_date": 1519888896, "last_edit_date": 1519888896, "creation_date": 1519846847, "answer_id": 49037345, "question_id": 49037013, "link": "https://stackoverflow.com/questions/49037013/my-code-to-find-the-number-of-vowels-doesnt-work/49037345#49037345", "title": "my code to find the number of vowels doesnt work", "body": "<p>Try this approach</p>\n\n<pre><code>def count_vowels(string)\n  ['a', 'e', 'i', 'o', 'u'].inject(0) { |sum, el| sum += string.downcase.count(el) }\nend\n</code></pre>\n\n<p>Please note I did <code>downcase</code> for input string to reduce iterations amount. If you have another logic - just remove it.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1519863348, "post_id": 49039124, "comment_id": 85086815, "body": "@Simple, yes, of course. Also I should have used <code>count</code> rather than <code>reduce</code>. Fixed both."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1519867473, "post_id": 49039124, "comment_id": 85087761, "body": "If you&#39;re using <code>count</code> then maybe... <code>str.count(&#39;aeiouAEIOU&#39;)</code> or <code>str.downcase.count(&#39;aeiou&#39;)</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1519871957, "post_id": 49039124, "comment_id": 85088820, "body": "@Sagar, another &quot;of course&quot;. I made the change. I am but a scribe!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1519871924, "last_edit_date": 1519871924, "creation_date": 1519854353, "answer_id": 49039124, "question_id": 49037013, "link": "https://stackoverflow.com/questions/49037013/my-code-to-find-the-number-of-vowels-doesnt-work/49039124#49039124", "title": "my code to find the number of vowels doesnt work", "body": "<pre><code>def count_vowels(str)\n  str.downcase.count(\"aeiou\")\nend\n\ncount_vowels(\"All the king's horses and all the king's men...\")\n  #=&gt; 10\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9425356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934099a8df4285d8ccae176a8672e339?s=128&d=identicon&r=PG&f=1", "display_name": "peter", "link": "https://stackoverflow.com/users/9425356/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1519856217, "accepted_answer_id": 49037305, "answer_count": 3, "score": -3, "last_activity_date": 1519888896, "creation_date": 1519845525, "last_edit_date": 1519845652, "question_id": 49037013, "link": "https://stackoverflow.com/questions/49037013/my-code-to-find-the-number-of-vowels-doesnt-work", "closed_reason": "Needs details or clarity", "title": "my code to find the number of vowels doesnt work", "body": "<pre><code>def count_vowels(string)\n  count_vowels = 0\n  my_vowels = [\"a\" \"e\" \"i\" \"o\" \"u\"]\n  idx = 0\n  while idx &lt; string.length\n    gdx = 0\n    while gdx &lt; my_vowels.length\n      if string[idx] == my_vowels[gdx]\n        count_vowels = count_vowels + 1\n      else\n        gdx = gdx + 1\n      end\n    end\n    idx = idx + 1\n  end\n\n  return count_vowels\nend\n</code></pre>\n"}, {"tags": ["ruby", "jekyll", "liquid"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "edited": false, "score": 0, "creation_date": 1519847915, "post_id": 49036476, "comment_id": 85080177, "body": "Thanks for the suggestion. Didn&#39;t work. What happened was it actually displayed the collection page on my index page. It looped through the collection and displayed each page in the collection one after the other"}, {"owner": {"reputation": 289, "user_id": 6623341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwM0S.jpg?s=128&g=1", "display_name": "Rakib", "link": "https://stackoverflow.com/users/6623341/rakib"}, "reply_to_user": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "edited": false, "score": 0, "creation_date": 1519848336, "post_id": 49036476, "comment_id": 85080387, "body": "Can you change the tags to <code>tags:  javascript jquery requires-springshare-auth-server client-side</code> (tag names in a single line separated by space)and then try."}, {"owner": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "edited": false, "score": 0, "creation_date": 1519849460, "post_id": 49036476, "comment_id": 85080983, "body": "I tried that and it&#39;s still doing the same thing. Idk if it matter but I&#39;m using no plugins in my Jekyll since it&#39;s a site on GitHub pages"}, {"owner": {"reputation": 289, "user_id": 6623341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwM0S.jpg?s=128&g=1", "display_name": "Rakib", "link": "https://stackoverflow.com/users/6623341/rakib"}, "reply_to_user": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "edited": false, "score": 0, "creation_date": 1519850596, "post_id": 49036476, "comment_id": 85081569, "body": "One last thing to try. Keep the tags in a single line as previous comment and run <code>{% for post in site.posts %} {{ post | tags }} {% endfor %}</code>. I think there is no need for plugins."}, {"owner": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "edited": false, "score": 0, "creation_date": 1519864736, "post_id": 49036476, "comment_id": 85087128, "body": "Turns out that one way to do it is with a join filter. Thanks for your time!"}], "tags": [], "owner": {"reputation": 289, "user_id": 6623341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dwM0S.jpg?s=128&g=1", "display_name": "Rakib", "link": "https://stackoverflow.com/users/6623341/rakib"}, "is_accepted": false, "score": 0, "last_activity_date": 1519843473, "creation_date": 1519843473, "answer_id": 49036476, "question_id": 49036252, "link": "https://stackoverflow.com/questions/49036252/looping-over-jekyll-collection-pages-tags-displaying-without-spaces/49036476#49036476", "title": "Looping over Jekyll collection page&#39;s tags - displaying without spaces", "body": "<p>Try replacing <code>{{libguide.tags}}</code> with <code>{{libguide | tags}}</code>. It will display tags separated by comma.</p>\n"}, {"tags": [], "owner": {"reputation": 33619, "user_id": 6884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c486c90e9e7a87a23ea89c09f27e33da?s=128&d=identicon&r=PG", "display_name": "Christian Specht", "link": "https://stackoverflow.com/users/6884/christian-specht"}, "is_accepted": true, "score": 2, "last_activity_date": 1519853363, "creation_date": 1519853363, "answer_id": 49038897, "question_id": 49036252, "link": "https://stackoverflow.com/questions/49036252/looping-over-jekyll-collection-pages-tags-displaying-without-spaces/49038897#49038897", "title": "Looping over Jekyll collection page&#39;s tags - displaying without spaces", "body": "<p>Use <a href=\"https://help.shopify.com/themes/liquid/filters/array-filters#join\" rel=\"nofollow noreferrer\">Liquid's <code>join</code> filter</a>.</p>\n\n<p>Simple example with just a single page:</p>\n\n<pre><code>---\ntitle: blah\nlayout: default\ntags:\n- javascript\n- jquery\n- requires-springshare-auth-server\n- client-side\n---\n\n&lt;li class=\"{{ page.tags | join: ' ' }}\"&gt;  \n</code></pre>\n\n<p>The rendered HTML:</p>\n\n<pre><code> &lt;li class=\"javascript jquery requires-springshare-auth-server client-side\"&gt;  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": false, "score": 2, "last_activity_date": 1519854121, "creation_date": 1519854121, "answer_id": 49039067, "question_id": 49036252, "link": "https://stackoverflow.com/questions/49036252/looping-over-jekyll-collection-pages-tags-displaying-without-spaces/49039067#49039067", "title": "Looping over Jekyll collection page&#39;s tags - displaying without spaces", "body": "<p><code>{{ libguide.tags }}</code> returns a raw output for the array, but you can separate  elements with a space using the <code>join</code> filter : </p>\n\n<p><code>{{ libguide.tags | join: \" \" }}</code>.</p>\n"}], "owner": {"reputation": 161, "user_id": 2148812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/22a15546c8bd04dcfc5e8f5012d5814c?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/2148812/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 49038897, "answer_count": 3, "score": 1, "last_activity_date": 1519859959, "creation_date": 1519842565, "question_id": 49036252, "link": "https://stackoverflow.com/questions/49036252/looping-over-jekyll-collection-pages-tags-displaying-without-spaces", "title": "Looping over Jekyll collection page&#39;s tags - displaying without spaces", "body": "<p>I'm trying to loop over a collection, display it's pages as links and on those links have each of that page's tags be distinct class names. I have everything working except for the fact that the tags jumble together without any spaces.</p>\n\n<p>Here's how I have the tags in the front matter of a page:</p>\n\n<pre><code>tags:\n- javascript\n- jquery\n- requires-springshare-auth-server\n- client-side\n</code></pre>\n\n<p>Here's the liquid in my html:</p>\n\n<pre><code>&lt;ul class=\"custom-dots\"&gt;\n   {% for libguide in site.libguides %}\n     &lt;li class=\"{{libguide.tags}}\"&gt;   \n        &lt;a href=\"{{site.baseurl}}{{ libguide.url}}\"&gt;{{libguide.title}}&lt;/a&gt;\n     &lt;/li&gt;\n    {% endfor %}\n&lt;/ul&gt;\n</code></pre>\n\n<p>And here's the rendered HTML as viewed through dev tools:</p>\n\n<pre><code>&lt;li class=\"javascriptjqueryrequires-springshare-auth-serverclient-side\"&gt;  \n</code></pre>\n"}, {"tags": ["ruby", "openssl", "unicorn", "systemd", "init.d"], "comments": [{"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 0, "creation_date": 1519840972, "post_id": 49035866, "comment_id": 85076612, "body": "I realise it&#39;s not a classic question for SO, but we&#39;re stuck and really need any help we could get."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1519843324, "post_id": 49035866, "comment_id": 85077772, "body": "I\u2019d say the question is very well stated and it\u2019s perfectly fine for SO. Upvoted."}, {"owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "edited": false, "score": 0, "creation_date": 1519843529, "post_id": 49035866, "comment_id": 85077861, "body": "Can you post your complete systemd unit file? Sometimes, systemd does strange stuff like system-call filtering, setting a chroot or resource constraints, ... which might affect the started processes in strange and sometimes indeterministic ways."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 0, "creation_date": 1519843700, "post_id": 49035866, "comment_id": 85077931, "body": "we don&#39;t use a systemd .service file. We use an init.d file. We actually tried to create a .service file, but had the same problem with it."}, {"owner": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "edited": false, "score": 0, "creation_date": 1519919543, "post_id": 49035866, "comment_id": 85111704, "body": "In your systemd service file, you should set your path the the same way you do in your init.d file for parity: <code>Environment=&quot;PATH=&#47;bin:&#47;usr&#47;sbin:&#47;usr&#47;bin:&#47;usr&#47;local&#47;bin:&#47;us&zwnj;&#8203;r&#47;local&#47;sbin:&#47;sbin&quot;</code>"}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "reply_to_user": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "edited": false, "score": 0, "creation_date": 1519925389, "post_id": 49035866, "comment_id": 85115417, "body": "@MarkStosberg I added it, but the behaviour is the same. Updated the gist to reflect the changes I&#39;ve made to the service file. To clarify, we originally kept just the init.d file, which was loaded automatically by systemd... I was just trying with a &quot;real&quot; .service file to test if it makes a difference, but it doesn&#39;t appear to..."}], "answers": [{"comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1519857753, "post_id": 49039002, "comment_id": 85085042, "body": "<i>&quot;I would also check for all your copies of SSL on the system...&quot;</i> - <i>\uff0b1</i>. I would be interested to know more about the different OpenSSL&#39;s installed on the system. And I would like to know which one Ruby was compiled and linked against; and which one it runtime links against. I&#39;ve got a feeling its an intermittent memory error due to mixing/matching OpenSSL versions."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1519887548, "post_id": 49039002, "comment_id": 85093148, "body": "Thanks Mark and @jww. I tried to answer your questions and provide more info. See UPDATE 1 on the question. Happy to run more things, answer more questions, try stuff... we&#39;re getting frustrated trying to figure this one out."}, {"owner": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "edited": false, "score": 0, "creation_date": 1519919721, "post_id": 49039002, "comment_id": 85111824, "body": "Related posts about <a href=\"https://stackoverflow.com/questions/25282939/openssl-ssl-ctx-newsslv3-method-returns-null\">SSLError (SSL_CTX_new: (null)</a> point to the issue being related to multiple versions of SSL being involved, which your debug output appears to confirm is happening on the system. You can try running the app with <code>strace</code> to confirm while files are being accessed before the crash."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 0, "creation_date": 1519925330, "post_id": 49039002, "comment_id": 85115393, "body": "I tried <code>strace</code>, but couldn&#39;t quite figure out what&#39;s going on to be honest... Any tips/pointers what to look for? (also any tips about potentially removing different versions, or pointing to the right version would be appreciated)."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 1, "creation_date": 1520019541, "post_id": 49039002, "comment_id": 85158213, "body": "@MarkStosberg thanks for your help. Upvoted. The problem suddenly vanished. It&#39;s really confusing and frustrating, but we just can&#39;t reproduce it all of a sudden. And it&#39;s not just on one place. On several instances, even when restored from snapshot. See my answer above, although it doesn&#39;t really shed much light onto this. I really appreciate your help though."}, {"owner": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "edited": false, "score": 0, "creation_date": 1520020064, "post_id": 49039002, "comment_id": 85158435, "body": "Another theory I had, which seems like likely is that the SSL problem was actually with sites you were connecting to and not with your code. I don&#39;t think this matches up with your &quot;SSLError (SSL_CTX_new: (null))&quot; error, could it could explain how the issue &quot;just vanished&quot; when  a site on the other end resolved the problem."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 1, "creation_date": 1520156711, "post_id": 49039002, "comment_id": 85193186, "body": "Thanks @MarkStosberg. Interesting theory! ... but I don&#39;t think it applies. We could trigger it with a local rails app that only connects to a local sphinx server using the mysql2 gem that didn&#39;t use SSL at all. I&#39;m not too familiar with the mysql2 gem internals, nor with sphinx to tell you with absolute certainty. The problem also disappeared suddenly on this local setup. In addition, this problem didn&#39;t happen with Digital Ocean for example with the same external resources... And it also manifested itself with non-SSL local ops like SHA1 digests etc..."}, {"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 0, "creation_date": 1520157022, "post_id": 49039002, "comment_id": 85193249, "body": "... aaaand if it were external, then how come it worked fine when we started the process using <code>&#47;etc&#47;init.d&#47;unicorn start</code> but failed with <code>systemctl start unicorn</code>?"}], "tags": [], "owner": {"reputation": 11251, "user_id": 254318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fqtBB.jpg?s=128&g=1", "display_name": "Mark Stosberg", "link": "https://stackoverflow.com/users/254318/mark-stosberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1519853822, "creation_date": 1519853822, "answer_id": 49039002, "question_id": 49035866, "link": "https://stackoverflow.com/questions/49035866/very-strange-behaviour-with-ruby-openssl-unicorn-systemd-gcloud/49039002#49039002", "title": "very strange behaviour with ruby, openssl, unicorn, systemd (Gcloud)", "body": "<p>One option is that this isn't an issue of <code>sysVinit</code> vs <code>systemd</code> at all, but you just haven't triggered the issue with your <code>sysVinit</code> script yet.</p>\n\n<p>When you run your <code>svsVinit</code> script through the <code>systemctl</code> command it's going through a compatibility layer, and there may be a problem there. Your problem would be simplified both yourself and for us if you reproduced the issue directly with a <code>systemd</code> service file and shared that file.</p>\n\n<p>You mentioned debugging ENV, but didn't mention exactly what you checked in the ENV. This is definitely one place where <code>systemd</code> could make a difference. As seen in <code>man systemd.exec</code>, <code>systemd</code> sets $PATH in the environment to a fixed value:</p>\n\n<pre><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n</code></pre>\n\n<p>If this is not exactly the same as when run directly as an <code>sysVinit</code> script, that could be an issue.</p>\n\n<p>I would also check for all your copies of SSL on the system. Do you have more than one? Where? Do you have more than copy of the <code>ruby</code> <code>openssl</code> module loaded?</p>\n\n<pre><code>\u00a0locate -r lib/.*libssl.*so\n</code></pre>\n\n<p>Also see the answer to the FAQ: <a href=\"https://unix.stackexchange.com/a/339645/20239\">Why do things behave differently under systemd?</a></p>\n"}, {"tags": [], "owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "is_accepted": false, "score": 0, "last_activity_date": 1520019382, "creation_date": 1520019382, "answer_id": 49076172, "question_id": 49035866, "link": "https://stackoverflow.com/questions/49035866/very-strange-behaviour-with-ruby-openssl-unicorn-systemd-gcloud/49076172#49076172", "title": "very strange behaviour with ruby, openssl, unicorn, systemd (Gcloud)", "body": "<p>(also posted on <a href=\"https://github.com/brianmario/mysql2/issues/944#issuecomment-370026803\" rel=\"nofollow noreferrer\">this github issue</a>)</p>\n\n<p>It looks like the problem just vanished. We were testing and reproducing it <em>consistently</em>, across <em>several</em> Compute Engine instances on Google Cloud. Under certain conditions (unicorn / puma started by systemd, etc), it was completely reproducible both with our own rails app, and with a plain vanilla rails app we've set for testing purposes. It was reproducible across several ruby versions as well (we tested 2.3.4, 2.3.6 and 2.5.0).</p>\n\n<p>Suddenly, <em>all instances</em> that were consistently failing started working without exhibiting these problems. Like it never existed. We didn't even reboot some of those instances, and we saw no evidence of any unattended upgrades taking place... We also had one snapshot of a system that had this problem, and that we can reliably reproduce on. Creating an instance from this snapshot stopped exhibiting it as well from that specific point in time a few hours ago.</p>\n\n<p>We're totally confused as to what might have cause it, and what might have made it disappear... However, without being able to reproduce it now, I guess there's no point leaving this issue open, so will close it. Chalk it up to <em>Deus ex machina</em> I suppose. (perhaps the google support gods, but they haven't reported anything back to us yet)</p>\n"}, {"comments": [{"owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "edited": false, "score": 2, "creation_date": 1540910602, "post_id": 53026354, "comment_id": 93032059, "body": "Yes, I think there&#39;s something fishy on GCP, but I couldn&#39;t figure out what it was. Even with Gold support, they won&#39;t tell me what changes were made to their platform that could have caused / resolved those issues unfortunately."}], "tags": [], "owner": {"reputation": 21, "user_id": 5830281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a791315d248529d0657efceeaea294?s=128&d=identicon&r=PG", "display_name": "malucelli", "link": "https://stackoverflow.com/users/5830281/malucelli"}, "is_accepted": false, "score": 2, "last_activity_date": 1540674927, "creation_date": 1540674927, "answer_id": 53026354, "question_id": 49035866, "link": "https://stackoverflow.com/questions/49035866/very-strange-behaviour-with-ruby-openssl-unicorn-systemd-gcloud/53026354#53026354", "title": "very strange behaviour with ruby, openssl, unicorn, systemd (Gcloud)", "body": "<p>@gingerlime I had a similar situation with our Jenkins on GCP, we're using ChefDK 3.1.0 (ruby embeed 2.5.1p57) -- tried other also, over a Jenkins that was running over <code>systemd</code> (Ubuntu 16.04) and <code>upstart</code> (Ubuntu 14.04) -- we tried on both versions, right now running over 16.04 in <code>4.15.0-1023-gcp</code> kernel version, running a few jobs with <code>kitchen-docker</code> and this problem always emerge in a few situations.</p>\n\n<p>I digged into and found that this only happens when the <code>Etc.getlogin</code> class gets called (<a href=\"https://github.com/test-kitchen/kitchen-docker/blob/v2.7.0/lib/kitchen/driver/docker.rb#L80\" rel=\"nofollow noreferrer\">for me here</a>), this doesn't return any error, it return the correct info, the correct type of the class (<code>String</code>), but once it gets a call, the <code>Unsupported digest algorithm</code> gets raised.</p>\n\n<p>If I start the process manually by <code>root</code> or <code>jenkins</code> user, this problem doesn't happen. I tried to implement the <code>Etc.getlogin</code> in several different ways, like using <code>ENV['USER']</code>, a fixed String, or other classes from <code>Etc</code>, like <code>getpwuid</code>, simulating the return class and values from <code>Etc.getlogin</code>, and the error doesn't get raised.</p>\n\n<p>I'm not sure if this is some bug related to the ruby version and the custom kernel that GCP instances uses, but it happens in a similar situation like yours, and for me, the <code>Etc.getlogin</code> was the problem. Right now, I fixed by using a custom configuration that doesn't gets the call from this function, and it's working normally.</p>\n"}], "owner": {"reputation": 4896, "user_id": 305019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/00afd84dac05c525b368b3f9beafc8fb?s=128&d=identicon&r=PG", "display_name": "gingerlime", "link": "https://stackoverflow.com/users/305019/gingerlime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1540674927, "creation_date": 1519840894, "last_edit_date": 1592644375, "question_id": 49035866, "link": "https://stackoverflow.com/questions/49035866/very-strange-behaviour-with-ruby-openssl-unicorn-systemd-gcloud", "title": "very strange behaviour with ruby, openssl, unicorn, systemd (Gcloud)", "body": "<p>We started seeing some strange errors in our logs that normally appear when ruby isn't compiled properly with OpenSSL. But it's <em>inconcistent</em>...</p>\n<p>We're getting errors like:</p>\n<ul>\n<li><code>RuntimeError: Unsupported digest algorithm (SHA256).</code> (also with other digests, like <code>sha1</code>). <a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-error_1-log\" rel=\"nofollow noreferrer\">example error trace</a></li>\n<li><code>Faraday::SSLError (SSL_CTX_new: (null))</code> <a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-error_2-log\" rel=\"nofollow noreferrer\">example error trace</a></li>\n</ul>\n<p>We managed to reproduce it when starting unicorn using <code>service unicorn start</code> or <code>systemctl start unicorn</code>. But only with <em>some</em> requests... Not all of them. Some requests that use OpenSSL under the hood do work. Others don't.</p>\n<p>However, <strong>when we start unicorn with <code>/etc/init.d/unicorn start</code>, everything works without a hitch.</strong> (to clarify, systemd starts the same <code>/etc/init.d</code> script)</p>\n<p>We tried debugging <code>ENV</code> vars, user permissions, file/dir ownership, recompile ruby, bootstrap a new server from scratch... Nothing seems to help.</p>\n<p>In case this helps:</p>\n<ul>\n<li><a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-init-d_unicorn\" rel=\"nofollow noreferrer\">unicorn init.d script</a></li>\n<li><a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-unicorn-rb\" rel=\"nofollow noreferrer\">unicorn.rb</a></li>\n</ul>\n<p>What are we missing? What can we try that we haven't thought of?</p>\n<h3>UPDATE 1</h3>\n<ul>\n<li><a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-debugging-txt\" rel=\"nofollow noreferrer\">output of some debug commands</a>, e.g. OpenSSL, ruby etc</li>\n<li>PATH is being set <a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-init-d_unicorn-L13\" rel=\"nofollow noreferrer\">inside the init.d script</a></li>\n<li>unicorn is being <a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-init-d_unicorn-L58\" rel=\"nofollow noreferrer\">executed via su into www-data user</a></li>\n<li>The same problem happens when we use <a href=\"https://gist.github.com/gingerlime/a06233c1ea4eda1188dcbdba86165a86#file-unicorn_service\" rel=\"nofollow noreferrer\">this unicorn.service</a> file in <code>/etc/systemd/system</code></li>\n<li>We're running Ubuntu 16.04 on Gcloud</li>\n<li>Ruby was <em>not</em> installed via <code>apt</code> (explicitly removed, in case platform came pre-installed) and compiled from scratch. We're currently running 2.3.4 and tried also 2.3.6. Compiled either manually or using <a href=\"https://github.com/rbenv/ruby-build\" rel=\"nofollow noreferrer\">ruby-build</a>. No <code>rbenv</code>, nor <code>RVM</code>.</li>\n<li>We install libssl-dev via <code>apt</code> (we're running <code>apt-get install -y autoconf bison build-essential libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm3 libgdbm-dev</code> before building ruby)</li>\n</ul>\n<h3>UPDATE 2</h3>\n<p>We're using a scripted/repeatable build process for the VM (using fabric), and this problem is consistent on multiple VMs we bootstrapped on <strong>GCloud</strong>. We then tried a VM on <strong>DigitalOcean</strong> with the same bootstrap scripts, and the problem doesn't seem to appear there.</p>\n<p>In both cases we picked Ubuntu 16.04 64bit base image, but obviously there are some differences with kernel versions, base installed packages etc...</p>\n<h3>UPDATE 3</h3>\n<p>The problem simply vanished. See my answer below.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1519839548, "post_id": 49035499, "comment_id": 85075907, "body": "Because <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-sprintf\" rel=\"nofollow noreferrer\"><code>Kernel#sprintf</code></a> is designed to format string, not to print it out."}, {"owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "edited": false, "score": 0, "creation_date": 1519839724, "post_id": 49035499, "comment_id": 85075987, "body": "It&#39;s a POSIX thing, <code>printf</code> family has functions with different output targets--stdout v. given file descriptor v. string. <code>Kernel#sprintf</code> is meant to mirror the string output branch of the <code>printf</code> family. <a href=\"https://www.systutorials.com/docs/linux/man/3-sprintf/\" rel=\"nofollow noreferrer\">systutorials.com/docs/linux/man/3-sprintf</a>"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519844050, "post_id": 49035499, "comment_id": 85078132, "body": "Important to note here that the first produces no output, <code>=&gt;</code> is the way <code>irb</code> describes <i>return values</i>, and the second produces output and a return value."}], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1519845410, "post_id": 49035541, "comment_id": 85078887, "body": "Just a footnote, this is copied almost exactly from C. <code>printf</code> prints a formatted string, <code>sprintf</code> creates the string without printing it."}], "tags": [], "owner": {"reputation": 9254, "user_id": 625365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ab819ffb4ef53da36f840e46dd72e967?s=128&d=identicon&r=PG", "display_name": "spike", "link": "https://stackoverflow.com/users/625365/spike"}, "is_accepted": true, "score": 7, "last_activity_date": 1519839624, "last_edit_date": 1519839624, "creation_date": 1519839571, "answer_id": 49035541, "question_id": 49035499, "link": "https://stackoverflow.com/questions/49035499/sprintf-versus-puts-in-ruby/49035541#49035541", "title": "Sprintf versus Puts in Ruby", "body": "<p><code>sprintf</code> returns the formatted string, rather than printing it anywhere. Check out <a href=\"http://ruby-doc.org/core/Kernel.html#method-i-sprintf\" rel=\"noreferrer\">http://ruby-doc.org/core/Kernel.html#method-i-sprintf</a> for the documentation.</p>\n\n<p>You might be looking for <code>printf</code> instead.</p>\n"}], "owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2339, "favorite_count": 0, "accepted_answer_id": 49035541, "answer_count": 1, "score": -1, "last_activity_date": 1519839624, "creation_date": 1519839405, "question_id": 49035499, "link": "https://stackoverflow.com/questions/49035499/sprintf-versus-puts-in-ruby", "title": "Sprintf versus Puts in Ruby", "body": "<p>Why does <code>sprintf</code> not output in a function, but <code>puts</code> will?</p>\n\n<pre><code>irb(main):001:0&gt; 3.times {|i| sprintf(\"%s\", i.to_s)}\n=&gt; 3\nirb(main):002:0&gt; 3.times {|i| puts i}\n0\n1\n2\n=&gt; 3\n</code></pre>\n\n<p>The <a href=\"http://ruby-doc.org/core-2.5.0/Kernel.html#method-i-puts\" rel=\"nofollow noreferrer\">documentation for <code>puts</code></a> says it goes to stdout. Why would <code>sprintf</code> not also go to stdout?</p>\n\n<p>Using Ruby 2.5.0.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1519839253, "last_edit_date": 1519839253, "creation_date": 1519838894, "answer_id": 49035352, "question_id": 49035306, "link": "https://stackoverflow.com/questions/49035306/how-to-access-instance-variable-defined-within-class-self/49035352#49035352", "title": "How to access instance variable defined within class &lt;&lt; self", "body": "<blockquote>\n  <p>how come <code>Dog.speak</code> does not return <code>\"here is the @var variable\"</code></p>\n</blockquote>\n\n<p>For the very same reason why this behaves similarly:</p>\n\n<pre><code>class Dog\n  @var = \"here is the @var variable\"\n\n  def speak\n    @var\n  end\nend\n\nDog.new.speak # =&gt; nil\n</code></pre>\n\n<p>You set variable on class level and expect it to be available on instance level.</p>\n"}, {"comments": [{"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1519839289, "post_id": 49035354, "comment_id": 85075758, "body": "could you possibly explain how <code>#&lt;Class:Dog&gt;</code> and <code>Dog</code> are different things? I think I am getting confused because I thought they both referred to the same object.  That is: that they both refer to the Singleton class object of: <code>Dog</code>."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 2, "creation_date": 1519839381, "post_id": 49035354, "comment_id": 85075816, "body": "<code>Dog</code> refers to the <i>instance</i> of <code>Dog</code>\u2019s singleton class (namely, to <code>Dog</code> class itself.) <code>#&lt;Class:Dog&gt;</code> refers to the <code>Dog</code>\u2019s singleton class."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 2, "creation_date": 1519839399, "post_id": 49035354, "comment_id": 85075824, "body": "@Neil: &quot;that they both refer to the Singleton class object of: Dog&quot; - how can a thing also be a singleton class object of itself? It doesn&#39;t make sense."}, {"owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "edited": false, "score": 0, "creation_date": 1519839473, "post_id": 49035354, "comment_id": 85075861, "body": "ah-ha, that was what I was missing.  Thanks you guys!"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519845594, "post_id": 49035354, "comment_id": 85079002, "body": "&quot;the former is printed while the code is parsed&quot; I don&#39;t think this is correct. AFAIK class bodies are executed just like any other Ruby expression, there&#39;s isn&#39;t a special &quot;eval classes&quot; phase before other code is run."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519880498, "post_id": 49035354, "comment_id": 85090882, "body": "@Max well, \u201cwhile the code is being loaded for the first time and executed on class level.\u201d I meant, <code>require &quot;this_file&quot;</code> would make this <code>puts</code> to get executed. No call is needed, unlike with <code>Dog.speak</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1519838901, "creation_date": 1519838901, "answer_id": 49035354, "question_id": 49035306, "link": "https://stackoverflow.com/questions/49035306/how-to-access-instance-variable-defined-within-class-self/49035354#49035354", "title": "How to access instance variable defined within class &lt;&lt; self", "body": "<p>You declare the variable on singleton class level and try to access it on class level. Debug output is your friend:</p>\n\n<pre><code>class Dog\n  class &lt;&lt; self\n    puts \"I am #{self}\"\n    @var = \"here is the @var variable\"\n\n    def speak\n      puts \"I am #{self}\"\n      @var\n    end\n  end\nend\n</code></pre>\n\n<p>Prints out:</p>\n\n<pre><code>#\u21d2\u00a0I am #&lt;Class:Dog&gt;\n\u25b6 Dog.speak\n#\u21d2\u00a0I am Dog\n</code></pre>\n\n<p>Note, that the former is printed <em>while the code is parsed</em> and the latter is printed only when the call to <code>Dog.speak</code> is explicitly performed.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 49035354, "answer_count": 2, "score": 2, "last_activity_date": 1519839253, "creation_date": 1519838736, "question_id": 49035306, "link": "https://stackoverflow.com/questions/49035306/how-to-access-instance-variable-defined-within-class-self", "title": "How to access instance variable defined within class &lt;&lt; self", "body": "<p>Given the following code, how come <code>Dog.speak</code> does not return <code>\"here is the @var variable\"</code>:</p>\n\n<pre><code>class Dog\n  class &lt;&lt; self\n    @var = \"here is the @var variable\"\n\n    def speak\n      @var\n    end\n  end\nend\n\np Dog.speak\n</code></pre>\n\n<p>Instead it returns <code>nil</code></p>\n\n<p>My understanding: <code>class &lt;&lt; self</code> opens up the singleton class object of <code>Dog</code>.  On that singleton object, we are setting the instance variable of <code>@var</code>.  Thus, I would think that the instance variable of <code>@var</code> is accessible from <code>Dog.speak</code>.</p>\n\n<p>What concepts am I missing here?  Why is <code>@var</code> not accessible to the <code>speak</code> method?</p>\n\n<p>Confusingly, this however works as expected:</p>\n\n<pre><code>class Dog\n  class &lt;&lt; self\n    def set_it\n      @var = \"The instance variable of @var is now accessible\"\n    end\n\n    def speak\n      @var\n    end\n  end\nend\n\nDog.set_it\np Dog.speak # =&gt; \"The instance variable of @var is now accessible\"\n</code></pre>\n"}, {"tags": ["ruby", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519838212, "post_id": 49035143, "comment_id": 85075082, "body": "This code looks like it should work. Doesn&#39;t it?"}, {"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519838491, "post_id": 49035143, "comment_id": 85075247, "body": "That code works (it&#39;s a representation of the Model as defined by the Gem), I was asking for the best practice way to add another <code>validates</code> call to the <code>Library::Model</code>. I&#39;ll update the question to be more specific."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1519839125, "post_id": 49035315, "comment_id": 85075661, "body": "Wow, you learn something new everyday. Where am I supposed to add this?. It&#39;s given me an <code>LoadError (Unable to autoload constant Model, expected &#47;var&#47;www&#47;my_app&#47;app&#47;models&#47;model.rb to define it)</code> error. I declared this in a random model file."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1519839173, "post_id": 49035315, "comment_id": 85075690, "body": "@Passerby Try putting it in an initializer: <code>config&#47;initializers&#47;library_patches.rb</code>"}, {"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1519839649, "post_id": 49035315, "comment_id": 85075959, "body": "You are a godsend!"}, {"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1519985679, "post_id": 49035315, "comment_id": 85139043, "body": "Thanks for the edit @Sergio, shouldn&#39;t this be a <code>class_eval</code> rather than <code>instance_eval</code>? And I take it the eval code is best placed in an initializer as well?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 1, "creation_date": 1519986285, "post_id": 49035315, "comment_id": 85139364, "body": "@Passerby: I understand the confusion. At a first glance, instance_eval/class_eval are counter-intuitive, until you understand the hidden logic. <code>instance_eval</code> runs code in the context of this very object. Which happens to be <code>Library::Model</code>, an instance of class <code>Class</code>. See <a href=\"https://eval.in/965783\" rel=\"nofollow noreferrer\">this example</a> and <a href=\"https://www.jimmycuadra.com/posts/metaprogramming-ruby-class-eval-and-instance-eval/\" rel=\"nofollow noreferrer\">this article</a>."}, {"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1520004791, "post_id": 49035315, "comment_id": 85150217, "body": "Thanks so much for all the insight. I really appreciate all the help."}, {"owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "edited": false, "score": 0, "creation_date": 1520244292, "post_id": 49035315, "comment_id": 85220391, "body": "For future googlers, this is a <a href=\"https://web.stanford.edu/~ouster/cgi-bin/cs142-winter15/classEval.php\" rel=\"nofollow noreferrer\">really good article</a> explaining the differences in an easy to digest way."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1519840014, "last_edit_date": 1519840014, "creation_date": 1519838767, "answer_id": 49035315, "question_id": 49035143, "link": "https://stackoverflow.com/questions/49035143/best-way-to-validate-an-external-gems-activerecord-model/49035315#49035315", "title": "Best way to validate an external gem&#39;s ActiveRecord model", "body": "<p>Ruby has so-called \"open classes\". You can open any class (at any time) and add more methods to it. This should work:</p>\n\n<pre><code>module Library\n  class Model\n    validates :me_too, presence: true\n  end\nend\n</code></pre>\n\n<p>It opens already defined <code>Library::Model</code> and just adds one more line of code to what's already there (not replacing/removing that existing code).</p>\n\n<p>Note that this depends on <code>Library::Model</code> being already <em>loaded</em> (this is not guaranteed). This should be a safer alternative:</p>\n\n<pre><code>Library::Model.instance_eval do\n  validates :me_too, presence: true\nend\n</code></pre>\n\n<p>It will trigger loading of <code>Library::Model</code> if it's not already loaded.</p>\n"}], "owner": {"reputation": 502, "user_id": 4857127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f386d47bf4dc5f6f93e9b39073baff1?s=128&d=identicon&r=PG", "display_name": "Passer by", "link": "https://stackoverflow.com/users/4857127/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49035315, "answer_count": 1, "score": 0, "last_activity_date": 1519840014, "creation_date": 1519838161, "last_edit_date": 1519838610, "question_id": 49035143, "link": "https://stackoverflow.com/questions/49035143/best-way-to-validate-an-external-gems-activerecord-model", "title": "Best way to validate an external gem&#39;s ActiveRecord model", "body": "<p>What is the best way to add validations to an external Gem's activerecord model?</p>\n\n<pre><code>module Library\n    class Model &lt; ActiveRecord::Base\n       validates :field_active, inclusion: { in: [true, false] }\n    end\nend\n</code></pre>\n\n<p>I would like to add another <code>validates</code> to it e.g.</p>\n\n<pre><code>validates :me_too, presence: true\n</code></pre>\n\n<p>But since it's an external gem, it's not really possible to just add it below <code>validates :field_active</code>.</p>\n\n<p>I would like to know what the best practice way of doing this is.\nIs <code>class_eval</code> the best way or is that frowned upon?</p>\n"}, {"tags": ["javascript", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1519837665, "post_id": 49034634, "comment_id": 85074753, "body": "Yes, you should use Javascript. By the way, <code>if :location == &#39;Deployed&#39;</code> is incorrect, it should be <code>if hardware.location == &quot;Deployed&quot;</code>. Also you could remove duplication with the existing code using <code>required: (hardware.location == &quot;Deployed&quot;)</code>, no need for the conditional block."}], "owner": {"reputation": 58, "user_id": 9360847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4685ed17f707b171e4da9da809ee1b7b?s=128&d=identicon&r=PG&f=1", "display_name": "MEHodges", "link": "https://stackoverflow.com/users/9360847/mehodges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1519836480, "creation_date": 1519836480, "question_id": 49034634, "link": "https://stackoverflow.com/questions/49034634/make-form-field-required-if-other-form-field-is-set", "title": "Make form field required if other form field is set", "body": "<p>I am trying to have the POC field be a required field  if the location is set to Deployed, but not if it is set to Local. I tried this below: </p>\n\n<pre><code>&lt;%= form_with(model: hardware, local: true, multipart: true) do |form| %&gt;\n&lt;% if hardware.errors.any? %&gt;\n   &lt;div id=\"error_explanation\"&gt;\n    &lt;h2&gt;&lt;%= pluralize(hardware.errors.count, \"error\") %&gt; prohibited this hardware from being saved:&lt;/h2&gt;\n    &lt;ul&gt;\n    &lt;% hardware.errors.full_messages.each do |message| %&gt;\n      &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= form.label \"Location\" %&gt;\n  &lt;%= form.select :location, ['Local', 'Deployed'] %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= form.label \"POC\" %&gt;\n  &lt;% if (:location == 'Deployed')%&gt;\n    &lt;%= form.collection_select(:poc_id, Poc.all, :id, :name, { :prompt =&gt; 'Select a POC', :selected =&gt; @hardware.poc_id,  include_blank: true }, { class: 'form-control', required: true }) %&gt;\n  &lt;% else %&gt;\n    &lt;%= form.collection_select(:poc_id, Poc.all, :id, :name, { :prompt =&gt; 'Select a POC', :selected =&gt; @hardware.poc_id,  include_blank: true }, { class: 'form-control' }) %&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>When I run it like this, it does not give any errors, but does not require the field. The only difference between the two collection selects is at the end where I set the required: true flag for the if statement and have it off on the else statement. </p>\n\n<p>Is there a way to do this with the method I am trying? Are there any Ruby Form Helpers that will allow the feature? Do I need to use Javascript to implement this feature?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2138, "user_id": 504930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VBvAi.jpg?s=128&g=1", "display_name": "devius", "link": "https://stackoverflow.com/users/504930/devius"}, "edited": false, "score": 0, "creation_date": 1519835037, "post_id": 49034048, "comment_id": 85072986, "body": "No need for <code>return</code> in either case it is implicit in Ruby. Also, what &quot;doesn&#39;t work&quot;? What happens? Also this might help understand what&#39;s going on: <a href=\"https://stackoverflow.com/questions/20671307/shortcut-to-make-case-switch-return-a-value\" title=\"shortcut to make case switch return a value\">stackoverflow.com/questions/20671307/&hellip;</a>"}, {"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "reply_to_user": {"reputation": 2138, "user_id": 504930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VBvAi.jpg?s=128&g=1", "display_name": "devius", "link": "https://stackoverflow.com/users/504930/devius"}, "edited": false, "score": 0, "creation_date": 1519835776, "post_id": 49034048, "comment_id": 85073475, "body": "It is not a duplicate"}, {"owner": {"reputation": 2138, "user_id": 504930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VBvAi.jpg?s=128&g=1", "display_name": "devius", "link": "https://stackoverflow.com/users/504930/devius"}, "edited": false, "score": 2, "creation_date": 1519836030, "post_id": 49034048, "comment_id": 85073646, "body": "Of course it is. If you read the highest voted answer in that question you would understand why your code wasn&#39;t working as expected. You&#39;re using the <code>case expression</code> form and expecting it to behave as the simpler <code>case</code> form. It also answers your other question of how to fix it, so it is definitely a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "edited": false, "score": 0, "creation_date": 1519835723, "post_id": 49034173, "comment_id": 85073442, "body": "Great thanks a lot. Just what I was searching for."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 8, "last_activity_date": 1519835083, "creation_date": 1519835083, "answer_id": 49034173, "question_id": 49034048, "link": "https://stackoverflow.com/questions/49034048/how-does-a-ruby-case-statement-with-multiple-conditions-work/49034173#49034173", "title": "How does a ruby case statement with multiple conditions work", "body": "<p>If you want the exact substitute of <code>if</code>-<code>elsif</code> functionality, you should use <em>empty</em> <code>case</code> condition:</p>\n\n<pre><code>case\nwhen @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] &gt; 0\n  p \"true\"\n  true\nwhen @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] == 0\n  @mails_hash[mail] =+ 1\n  p \"false double\"\n  false\nelse\n  p \"false else\"\n  false\nend\n</code></pre>\n\n<p>When you put an argument in call to <code>case</code>, it\u2019s used to compare against <code>when</code> clauses using threeequals aka case-equal:</p>\n\n<pre><code>case mail\nwhen MailClass then ...\nend\n</code></pre>\n\n<p>The code above actually calls <code>MailClass.===(mail)</code>.</p>\n"}], "owner": {"reputation": 166, "user_id": 8678413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10155814455004390/picture?type=large", "display_name": "Sebastian Peter", "link": "https://stackoverflow.com/users/8678413/sebastian-peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3922, "favorite_count": 0, "closed_date": 1519836677, "accepted_answer_id": 49034173, "answer_count": 1, "score": 1, "last_activity_date": 1519835083, "creation_date": 1519834676, "question_id": 49034048, "link": "https://stackoverflow.com/questions/49034048/how-does-a-ruby-case-statement-with-multiple-conditions-work", "closed_reason": "Duplicate", "title": "How does a ruby case statement with multiple conditions work", "body": "<p>My Code:</p>\n\n<pre><code>def double_mails?(mail)\n\n  if @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] &gt; 0\n      p \"true\"\n      return true\n  elsif @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] == 0\n      @mails_hash[mail] =+ 1\n      p \"false double\"\n      return false\n  else\n      p \"false else\"\n      return false\n  end\nend\n</code></pre>\n\n<p>My Question:</p>\n\n<p>When I try to make a case statement like this out of the above code  the programm  logic doesn't work anymore:</p>\n\n<pre><code>def double_mails?(mail)\n  case mail\n    when @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] &gt; 0\n      p \"true\"\n      return true\n    when @mails_hash.include?(mail) &amp;&amp; @mails_hash[mail] == 0\n      @mails_hash[mail] =+ 1\n      p \"false double\"\n      return false\n    else\n      p \"false else\"\n      return false\n  end\nend\n</code></pre>\n\n<p>It alway jumps into the else block no matter which value I pass in. The if..else works fine.\nWhy doesn't it work and how do I fix the syntax to make it work as a case statement?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "jquery-ui", "ruby-on-rails-4", "rails-sprockets"], "comments": [{"owner": {"reputation": 2138, "user_id": 504930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VBvAi.jpg?s=128&g=1", "display_name": "devius", "link": "https://stackoverflow.com/users/504930/devius"}, "edited": false, "score": 0, "creation_date": 1519834614, "post_id": 49033869, "comment_id": 85072692, "body": "That&#39;s a pretty old version of <code>jquery-rails</code>. Maybe it doesn&#39;t like to be used in a more recent version of Rails?"}], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 2137458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cfca832ee746f3e3d9971148f52dc64?s=128&d=identicon&r=PG", "display_name": "NM Pennypacker", "link": "https://stackoverflow.com/users/2137458/nm-pennypacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1519848694, "creation_date": 1519848694, "answer_id": 49037764, "question_id": 49033869, "link": "https://stackoverflow.com/questions/49033869/ruby-on-rails-upgrade-asset-precompilation-failure/49037764#49037764", "title": "ruby on rails upgrade asset precompilation failure", "body": "<p>Hard to say what's going on without knowing more about your configuration, but it might be a loading issue. <code>jquery-rails</code> puts the actual <code>.js</code> files in <code>vendor/assets/javascripts</code>, which might not be in your load path for whatever reason. You might try two things:</p>\n\n<p>First try running the generator that comes with the gem to see if it fixes the paths in the manifest file:</p>\n\n<pre><code>rails generate jquery:install #--ui to enable jQuery UI\n</code></pre>\n\n<p>If that doesn't work, and don't want to upgrade <code>jquery-rails</code>, you might have to do something like this</p>\n\n<pre><code>//= require vendor/assets/javascripts/jquery.js\n//= require vendor/assets/javascripts/jquery_ujs.js\n//= require vendor/assets/javascripts/jquery-ui.js\n</code></pre>\n\n<p>If I were you I would upgrade</p>\n"}], "owner": {"reputation": 963, "user_id": 3311489, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a07a3d565ce06b5428c193379d869be3?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Ellis", "link": "https://stackoverflow.com/users/3311489/nick-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519848694, "creation_date": 1519834132, "question_id": 49033869, "link": "https://stackoverflow.com/questions/49033869/ruby-on-rails-upgrade-asset-precompilation-failure", "title": "ruby on rails upgrade asset precompilation failure", "body": "<p>I have a rails 4.2 application I am in the process of upgrading from 3.2.  Something is going wrong with asset precomiplation but I'm not sure what I am missing.</p>\n\n<pre><code>#Gemfile\ngem 'rails', '~&gt; 4.2.7.1'\nruby \"2.3.3\"\n\ngem 'jquery-rails', '2.1.4'\ngem 'jquery-ui-rails', '4.2.1'\ngem 'activeadmin'\ngem 'sprockets-rails', '2.3.3\n</code></pre>\n\n<p>Here is the active_admin.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-ui\n//= require select2\n//= require active_admin/base\n//= require best_in_place\n//= require best_in_place.jquery-ui\n//= require activeadmin-sortable\n</code></pre>\n\n<p>The asset precompilation fails here</p>\n\n<pre><code>$ bundle exec rake assets:precompile\nI, [2018-02-28T10:58:20.467128 #6312]  INFO -- : Writing /home/nellis/src/circle2/public/assets/style-6150d2089bcada194fcfda8d38d0046cadfe7a754b6b477226d1b701cda7e197.css.gz\nrake aborted!\nSprockets::FileNotFound: couldn't find file 'jquery_ujs' with type 'application/javascript'\nChecked in these paths: \n  /home/nellis/src/circle2/app/assets/fonts\n  /home/nellis/src/circle2/app/assets/images\n  /home/nellis/src/circle2/app/assets/javascripts\n  /home/nellis/src/circle2/app/assets/stylesheets\n  /home/nellis/src/circle2/vendor/assets/javascripts\n  /home/nellis/src/circle2/vendor/assets/stylesheets\n  /home/nellis/src/circle2/public/vendor\n/home/nellis/src/circle2/app/assets/javascripts/active_admin.js:2\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/resolve.rb:65:in `resolve!'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:399:in `resolve'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:207:in `process_require_directive'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:180:in `block in process_directives'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:178:in `each'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:178:in `process_directives'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:83:in `_call'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/directive_processor.rb:68:in `call'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:75:in `call_processor'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `reverse_each'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `call_processors'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:134:in `load_from_unloaded'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:60:in `block in load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:44:in `load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:20:in `block in initialize'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:47:in `load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/bundle.rb:23:in `block in call'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/utils.rb:200:in `dfs'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/bundle.rb:24:in `call'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:75:in `call_processor'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:57:in `block in call_processors'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `reverse_each'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/processor_utils.rb:56:in `call_processors'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:134:in `load_from_unloaded'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:60:in `block in load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:317:in `fetch_asset_from_dependency_cache'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/loader.rb:44:in `load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:20:in `block in initialize'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/cached_environment.rb:47:in `load'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/base.rb:66:in `find_asset'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/base.rb:73:in `find_all_linked_assets'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:134:in `block in find'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `each'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:133:in `find'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/sprockets/manifest.rb:185:in `compile'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-rails-2.3.3/lib/sprockets/rails/task.rb:70:in `block (3 levels) in define'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-3.7.1/lib/rake/sprocketstask.rb:147:in `with_logger'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/sprockets-rails-2.3.3/lib/sprockets/rails/task.rb:69:in `block (2 levels) in define'\n/home/nellis/.rvm/gems/ruby-2.3.3/gems/rake-12.3.0/exe/rake:27:in `&lt;top (required)&gt;'\n/home/nellis/.rvm/gems/ruby-2.3.3/bin/ruby_executable_hooks:15:in `eval'\n/home/nellis/.rvm/gems/ruby-2.3.3/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\nzlib(finalizer): Zlib::GzipWriter object must be closed explicitly.\nzlib(finalizer): the stream was freed prematurely.\n</code></pre>\n\n<p>All the questions I read just say run bundle install and make sure the gems are in your Gemfile which they are.</p>\n"}, {"tags": ["ruby", "class", "methods", "console"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519834559, "post_id": 49033738, "comment_id": 85072672, "body": "See <a href=\"http://rubylearning.com/satishtalim/ruby_ri_tool.html\" rel=\"nofollow noreferrer\">this</a> discussion of the stand-alone programs <code>ri</code> and <code>rdoc</code>."}, {"owner": {"reputation": 19, "user_id": 7694052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9N6WMpAqEzw/AAAAAAAAAAI/AAAAAAAAOJ0/3TlfIw4n7as/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7694052/krishna"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519885424, "post_id": 49033738, "comment_id": 85092369, "body": "Great Thanks.. @CarySwoveland.. Would you know if php and Javascript have similar commands? This is really handy instead of always looking for the documentation online."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519891451, "post_id": 49033738, "comment_id": 85094782, "body": "Sorry, I\u2019m not familiar with either of those languages. Perhaps someone else could answer."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519897022, "post_id": 49033738, "comment_id": 85097752, "body": "@Krishna JS does not have this built-in. You have to refer the docs. Not sure about PHP."}], "answers": [{"comments": [{"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519846346, "post_id": 49033803, "comment_id": 85079401, "body": "How is a beginner expected to understand some source code for a Ruby method?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519846647, "post_id": 49033803, "comment_id": 85079549, "body": "@arjun: that&#39;s what he asked. This is the ultimate source of truth about &quot;what a method does&quot;. More &quot;beginner-friendy&quot; explanation/documentation was already available just one google search away."}, {"owner": {"reputation": 19, "user_id": 7694052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9N6WMpAqEzw/AAAAAAAAAAI/AAAAAAAAOJ0/3TlfIw4n7as/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7694052/krishna"}, "edited": false, "score": 0, "creation_date": 1519885952, "post_id": 49033803, "comment_id": 85092579, "body": "@SergioTulentsev .. i did not know about Pry. thank you very much for mentioning it. I have just started with Ruby and really liking it. One of the other questions i had was if you knew if php and javascript had similar commands. Please let me know if it would be best to start a new thread."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519896565, "post_id": 49033803, "comment_id": 85097475, "body": "@SergioTulentsev Hey if people started reading documentation, StackOverflow would be empty. The OP is a beginner. What you answered could have been additional knowledge for him. It could have been as a passing mention. What SimpleLine wrote above is the answer which OP was looking for."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519896629, "post_id": 49033803, "comment_id": 85097504, "body": "@arjun: how do you know what he was looking for?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519896785, "post_id": 49033803, "comment_id": 85097601, "body": "@arjun: anyhow, the OP is but one of the readers. Even if he can&#39;t fully benefit from this, others might."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519896828, "post_id": 49033803, "comment_id": 85097631, "body": "@SergioTulentsev Not in a school debate. Please read his question and all comments."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519897054, "post_id": 49033803, "comment_id": 85097776, "body": "@arjun: the question explicitly asks for ways to see method definition in console. You need to learn to make less assumptions."}, {"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1519897458, "post_id": 49033803, "comment_id": 85098052, "body": "@SergioTulentsev Even you answer is bad. One would have to search further what <code>Qnil</code> is. Anyone reading would be left further spending time getting definitions of those variable. If you knew so much and cared about other readers, you could have added comments in that code. Your answers and comments goes against <a href=\"https://en.wikipedia.org/wiki/Ruby_(programming_language)#Philosophy\" rel=\"nofollow noreferrer\">Ruby Philosophy</a>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1519833946, "creation_date": 1519833946, "answer_id": 49033803, "question_id": 49033738, "link": "https://stackoverflow.com/questions/49033738/in-ruby-is-there-a-way-to-know-in-the-console-what-a-method-does/49033803#49033803", "title": "In ruby, is there a way to know in the console what a method does?", "body": "<p>If you use <code>Pry</code>, it has a handy shortcut, <code>show-source</code>:</p>\n\n<pre><code>[1] pry(main)&gt; show-source String.display\n\nFrom: io.c (C Method):\nOwner: Kernel\nVisibility: public\nNumber of lines: 15\n\nstatic VALUE\nrb_obj_display(int argc, VALUE *argv, VALUE self)\n{\n    VALUE out;\n\n    if (argc == 0) {\n        out = rb_stdout;\n    }\n    else {\n        rb_scan_args(argc, argv, \"01\", &amp;out);\n    }\n    rb_io_write(out, self);\n\n    return Qnil;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 7694052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9N6WMpAqEzw/AAAAAAAAAAI/AAAAAAAAOJ0/3TlfIw4n7as/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7694052/krishna"}, "edited": false, "score": 0, "creation_date": 1519885638, "post_id": 49034104, "comment_id": 85092445, "body": "Thanks a bunch @Simple ... any chance you would know if php and javascript have similar commands?"}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 5, "last_activity_date": 1519834835, "creation_date": 1519834835, "answer_id": 49034104, "question_id": 49033738, "link": "https://stackoverflow.com/questions/49033738/in-ruby-is-there-a-way-to-know-in-the-console-what-a-method-does/49034104#49034104", "title": "In ruby, is there a way to know in the console what a method does?", "body": "<p>You can use</p>\n\n<pre><code>help 'String#display'\n</code></pre>\n\n<p>and it'll show the rdoc for the method (the same output that would show from running <code>ri 'String#display'</code> outside of irb. You can also just type <code>help</code> into irb and it'll go into a mode where you can just keep typing method names and it'll show the rdoc (enter a blank line to exit).</p>\n"}], "owner": {"reputation": 19, "user_id": 7694052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9N6WMpAqEzw/AAAAAAAAAAI/AAAAAAAAOJ0/3TlfIw4n7as/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7694052/krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519834835, "creation_date": 1519833726, "question_id": 49033738, "link": "https://stackoverflow.com/questions/49033738/in-ruby-is-there-a-way-to-know-in-the-console-what-a-method-does", "title": "In ruby, is there a way to know in the console what a method does?", "body": "<p>In Ruby, if i am looking for the methods of a class.\nie:<code>String.methods.sort</code>\nand i have the following:</p>\n\n<pre><code>[:!, :!=, :!~, :&lt;, :&lt;=, :&lt;=&gt;, :==, :===, :=~, :&gt;, :&gt;=, :__id__,\n:__send__, :allocate, :ancestors, :autoload, :autoload?, :class,\n:class_eval, :class_exec, :class_variable_defined?,\n:class_variable_get, :class_variable_set, :class_variables, :clone,\n:const_defined?, :const_get, :const_missing, :const_set, :constants,\n:define_singleton_method, :deprecate_constant, :display, :dup,\n:enum_for, :eql?, :equal?, :extend, :freeze, :frozen?, :hash, \n:include, :include?, :included_modules, :inspect, :instance_eval,...]\n</code></pre>\n\n<p>Is there a way for me to type a command in the console to explore a method? If i am unfamiliar with <code>:display</code> and i want to know what it does, what it returns, is it possible?</p>\n\n<p>If yes, does PHP and javascript have something similar to see method definition in console? It does not look like I have encountered it.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1519833464, "post_id": 49033467, "comment_id": 85071961, "body": "The latter. They are assigning a value to <code>value</code> and then checking if it&#39;s truthy."}], "answers": [{"tags": [], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "is_accepted": true, "score": 3, "last_activity_date": 1519833022, "creation_date": 1519833022, "answer_id": 49033506, "question_id": 49033467, "link": "https://stackoverflow.com/questions/49033467/ruby-if-assign-statement/49033506#49033506", "title": "Ruby if/assign statement?", "body": "<p>This is equivalent to:</p>\n\n<pre><code>value = key rescue nil\n\nif value\n  ..  \nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>value = begin\n  key\nrescue\n  nil\nend\n\nif value\n  ..  \nend\n</code></pre>\n\n<p>Remember <code>nil</code> and <code>false</code> are the only two objects that are <code>falsey</code> in ruby and since <code>value</code> here could be <code>nil</code>, that if statement could return <code>false</code>.</p>\n"}], "owner": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 49033506, "answer_count": 1, "score": 0, "last_activity_date": 1519833022, "creation_date": 1519832919, "question_id": 49033467, "link": "https://stackoverflow.com/questions/49033467/ruby-if-assign-statement", "title": "Ruby if/assign statement?", "body": "<p>I have run to the following code and I have no idea what it does. Why do they use <code>=</code> to compare values or are they assigning values and checking if the value is true after being assigned?</p>\n\n<pre><code>     if value = (key rescue nil)\n       ..\n     end\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519832776, "post_id": 49033323, "comment_id": 85071486, "body": "What is your question? <code>Dog.name</code> would perfectly work, since you declare an accessor on the class level. <code>Dog.new.name</code> obviously does not work because instances of <code>Dog</code> were not granted with accessors."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1519833494, "post_id": 49033323, "comment_id": 85071982, "body": "&quot;put me in the context of the singleton object of Dog&quot; - here&#39;s where you&#39;re wrong. It puts you in the context of the singleton <i>class</i> of Dog. Of which class there&#39;s only one instance, <code>Dog</code>. And attr_accessor grants getter/setter to this instance."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1519838934, "creation_date": 1519838934, "answer_id": 49035364, "question_id": 49033323, "link": "https://stackoverflow.com/questions/49033323/attr-accessor-on-singleton-objects-not-working-as-expected/49035364#49035364", "title": "attr_accessor on singleton objects not working as expected", "body": "<p>The typical usage for <code>class &lt;&lt; self</code> is to make a block where instance methods get defined as class methods. This lets you skip typing the <code>self.</code> in the method definition and also makes other facilities available like private/protected.</p>\n\n<p>How this works is by opening up Dog's singleton class and adding instance methods to it. Instance methods of Dog's singleton class become class methods on Dog. This is just part of the definition of singleton classes.</p>\n\n<p>In the case of attr_accessor, that's a method you call in the class scope of Dog, and which defines instance methods on Dog.</p>\n\n<p>When you call attr_accessor on Dog's singleton class, it creates instance methods on Dog's singleton class. Instance methods of Dog's singleton class become class methods on Dog. That's why you can use <code>Dog.name =</code> and not <code>Dog.new.name =</code> with your code.</p>\n"}], "owner": {"reputation": 6076, "user_id": 4044009, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/42e57031eb7d02c47c9afaecfc878638?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/4044009/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 49035364, "answer_count": 1, "score": 2, "last_activity_date": 1519838934, "creation_date": 1519832457, "last_edit_date": 1519833744, "question_id": 49033323, "link": "https://stackoverflow.com/questions/49033323/attr-accessor-on-singleton-objects-not-working-as-expected", "title": "attr_accessor on singleton objects not working as expected", "body": "<p>Why does <code>Cat.new.name</code> work but <code>Dog.new.name</code> does not work,  given these two different implementations:</p>\n\n<pre><code>class Cat\nend \n\nCat.instance_eval do\n  attr_accessor :name\nend\n</code></pre>\n\n<p>But this does not work:</p>\n\n<pre><code>class Dog\n  class &lt;&lt; self\n    attr_accessor :name\n  end\nend\n</code></pre>\n\n<p><strong>Note:</strong> I am aware that <code>Dog.name</code> <em>would</em> work, but I would think that both of these implementations would both result in creating <code>name</code> and <code>name=</code> methods for all the instantiations of <code>Dog</code> and <code>Cat</code>.</p>\n\n<hr>\n\n<p><strong>Background of question:</strong></p>\n\n<p>To start off: take the following code for example:</p>\n\n<pre><code>class Cat\nend\n\nCat.instance_eval do\n  attr_accessor :name\nend\n\nc = Cat.new\nc.name = 'some cat name'\np c.name # =&gt; \"some cat name\"\n</code></pre>\n\n<p>In regards to the <a href=\"https://apidock.com/ruby/Object/instance_eval\" rel=\"nofollow noreferrer\">ruby documentation of instance_eval</a>, I would talk through that <code>instance_eval</code> block with the following: </p>\n\n<ul>\n<li>We are in the context of <code>Cat</code> (<code>Cat</code> is <code>self</code>), so in essence, we are calling <code>Cat.attr_accessor :name</code>, which is a macro that is saying \"Hey, for all instances created from <code>Cat</code>, give them the methods <code>name</code> and <code>name=</code>.</li>\n</ul>\n\n<p>I am trying to extend this understanding to the following, but it is erroring out:</p>\n\n<pre><code>class Dog\n  class &lt;&lt; self\n    attr_accessor :name\n  end\nend\n\nd = Dog.new\nd.name = \"dog name\" # =&gt; undefined method `name=' for #&lt;Dog:0x007ff6c3062c20&gt; (NoMethodError)\n</code></pre>\n\n<p>Talking through this, I would say <code>class &lt;&lt; self</code> is saying:</p>\n\n<ul>\n<li>put me in the context of the singleton object of <code>Dog</code>, so <code>self</code>is now that singleton object of <code>Dog</code> </li>\n<li>call the <code>attr_accessor</code> macro on that singleton object of <code>Dog</code> (so we are really calling <code>&lt;singleton_of_Dog&gt;.attr_accessor :name</code>). Now every time we instantiate a <code>Dog</code> object, each of those dog objects now has <code>name</code> and <code>name=</code>.</li>\n</ul>\n\n<p>The error is clearly stating that my thinking is incorrect here, but I am not sure what part I am missing.  </p>\n\n<p>I have searched previous stack overflow questions, read books and watched videos explaining the ruby object model.  Nevertheless, there are clearly some foundational concepts that I have not entirely grasped.</p>\n"}, {"tags": ["javascript", "ruby", "amazon-web-services", "highcharts", "sinatra"], "comments": [{"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 1, "creation_date": 1519832144, "post_id": 49033198, "comment_id": 85071058, "body": "Have you checked for errors reported in the browser console?"}, {"owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "reply_to_user": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1519837378, "post_id": 49033198, "comment_id": 85074573, "body": "@Pointy I just checked and Im getting a 404 error"}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1519837561, "post_id": 49033198, "comment_id": 85074691, "body": "Well that seems pretty clear: the URL for that JSON file is clearly incorrect (or the file is in the wrong place)."}, {"owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "reply_to_user": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1519838924, "post_id": 49033198, "comment_id": 85075529, "body": "@Pointy I fixed that and I don&#39;t have any errors in console, but my charts still aren&#39;t showing"}, {"owner": {"reputation": 5446, "user_id": 8091913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BpjI.jpg?s=128&g=1", "display_name": "Kamil Kulig", "link": "https://stackoverflow.com/users/8091913/kamil-kulig"}, "edited": false, "score": 0, "creation_date": 1519911524, "post_id": 49033198, "comment_id": 85106156, "body": "Is the data properly fetched? Could you post the content of <code>dataset.data</code> from <code>synchronize-chart.js</code> and <code>data</code> from <code>Water-level-chart.js</code>?"}, {"owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "reply_to_user": {"reputation": 5446, "user_id": 8091913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BpjI.jpg?s=128&g=1", "display_name": "Kamil Kulig", "link": "https://stackoverflow.com/users/8091913/kamil-kulig"}, "edited": false, "score": 0, "creation_date": 1519967709, "post_id": 49033198, "comment_id": 85131496, "body": "@KamilKulig it should be pulling that data from my database I&#39;m using DynamoDB from AWS and I&#39;m using a map type. Idk what I&#39;m doing wrong"}, {"owner": {"reputation": 5446, "user_id": 8091913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BpjI.jpg?s=128&g=1", "display_name": "Kamil Kulig", "link": "https://stackoverflow.com/users/8091913/kamil-kulig"}, "edited": false, "score": 0, "creation_date": 1519980342, "post_id": 49033198, "comment_id": 85136051, "body": "Could you check if that data is actually properly fetched? Do <code>console.log()</code> of the variables that I mentioned in my previous comment."}, {"owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "edited": false, "score": 0, "creation_date": 1520001648, "post_id": 49033198, "comment_id": 85148000, "body": "I did console.log and nothing is coming up."}, {"owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "reply_to_user": {"reputation": 5446, "user_id": 8091913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BpjI.jpg?s=128&g=1", "display_name": "Kamil Kulig", "link": "https://stackoverflow.com/users/8091913/kamil-kulig"}, "edited": false, "score": 0, "creation_date": 1520014894, "post_id": 49033198, "comment_id": 85156143, "body": "@KamilKulig should I make blank json files so they have something to parse into?"}, {"owner": {"reputation": 5446, "user_id": 8091913, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BpjI.jpg?s=128&g=1", "display_name": "Kamil Kulig", "link": "https://stackoverflow.com/users/8091913/kamil-kulig"}, "edited": false, "score": 0, "creation_date": 1520237551, "post_id": 49033198, "comment_id": 85216826, "body": "Did you do <code>console.log(dataset.data)</code> right before this line?: <code>$(&#39;&lt;div class=&quot;chart&quot;&gt;&#39;)</code>"}], "owner": {"reputation": 11, "user_id": 5432473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80db0ed12c1fd717ebe3ee6c49c56521?s=128&d=identicon&r=PG&f=1", "display_name": "taylor dudley", "link": "https://stackoverflow.com/users/5432473/taylor-dudley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519837683, "creation_date": 1519832075, "last_edit_date": 1519837683, "question_id": 49033198, "link": "https://stackoverflow.com/questions/49033198/highcharts-not-showing-up-in-ruby-web-app", "title": "Highcharts not showing up in ruby web app", "body": "<p>Will someone tell me why my high charts aren't coming up on my ruby sinatra web application. I'm trying to pull data from my dynamodb table and put that into charts. I downloaded my dynamodb items into a csv then converted that to a json file hoping that would help. I can go on high charts website and do a demo and it loads in my website just not mine.</p>\n\n<p>This is my synchronize-chart.js</p>\n\n<pre><code>$(function() {\n$('#synchronized').bind('mousemove touchmove', function(e) {\nvar chart,\n  point,\n  i;\n\nfor (i = 0; i &lt; Highcharts.charts.length; i = i + 1) {\n  chart = Highcharts.charts[i];\n  if(chart.renderTo.className != 'chart'){\n    continue;\n  }\n  e = chart.pointer.normalize(e); // Find coordinates within the chart\n  point = chart.series[0].searchPoint(e, true); // Get the hovered point\n\n  if (point) {\n    point.onMouseOver(); // Show the hover marker\n    chart.tooltip.refresh(point); // Show the tooltip\n    chart.xAxis[0].drawCrosshair(e, point); // Show the crosshair\n  }\n}\n  });\n/**\n\n   * Override the reset function, we do not need to hide the tooltips and crosshairs.\n   */\n  Highcharts.Pointer.prototype.reset = function() {\n    return undefined;\n  };\n\n  /**\n   * Synchronize zooming through the setExtremes event handler.\n   */\n  function syncExtremes(e) {\n    var thisChart = this.chart;\n\n    if (e.trigger !== 'syncExtremes') { // Prevent feedback loop\n      Highcharts.each(Highcharts.charts, function(chart) {\n        if (chart !== thisChart) {\n          if (chart.xAxis[0].setExtremes) { // It is null while updating\n            chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, {\n              trigger: 'syncExtremes'\n            });\n          }\n        }\n      });\n    }\n  }\n\n  // Get the data. The contents of the data file can be viewed at\n  // https://github.com/highcharts/highcharts/blob/master/samples/data/activity.json\n  $.getJSON('/covertcsv.json', function(activity) {\n    $.each(activity.datasets, function(i, dataset) {\n\n      // Add X values\n      dataset.data = Highcharts.map(dataset.data, function(val, j) {\n        return [activity.xData[j], val];\n      });\n\n      $('&lt;div class=\"chart\"&gt;')\n        .appendTo('#synchronized')\n        .highcharts({\n          chart: {\n            marginLeft: 40, // Keep all charts left aligned\n            spacingTop: 20,\n            spacingBottom: 20,\n            zoomType: 'x'\n          },\n          title: {\n            text: dataset.name,\n            align: 'left',\n            margin: 0,\n            x: 30\n          },\n          credits: {\n            enabled: false\n          },\n          legend: {\n            enabled: false\n          },\n          xAxis: {\n            crosshair: true,\n            events: {\n              setExtremes: syncExtremes\n            },\n            type: 'datetime'\n          },\n          yAxis: {\n            title: {\n              text: null\n            }\n          },\n          tooltip: {\n            positioner: function() {\n              return {\n                x: this.chart.chartWidth - this.label.width, // right aligned\n                y: -1 // align to title\n              };\n            },\n            borderWidth: 0,\n            backgroundColor: 'none',\n            //pointFormat: '{point.y}',\n            pointFormat: '&lt;span style=\"font-size: 10px\"&gt;{point.x:%e. %b \\'%y %H:%M:%S}&lt;/span&gt; {point.y}',\n            headerFormat: '',\n            shadow: false,\n            style: {\n              fontSize: '18px'\n            },\n            valueDecimals: dataset.valueDecimals\n          },\n          series: [{\n            data: dataset.data,\n            name: dataset.name,\n            type: dataset.type,\n            color: Highcharts.getOptions().colors[i],\n            fillOpacity: 0.3,\n            tooltip: {\n              valueSuffix: ' ' + dataset.unit\n            }\n          }]\n        });\n    });\n  });\n});\n</code></pre>\n\n<p>Water-level-chart.js</p>\n\n<pre><code>$(function() {\n\nvar gaugeOptions = {\n\nchart: {\n  type: 'solidgauge'\n},\n\ntitle: null,\n\n    pane: {\n      center: ['50%', '85%'],\n      size: '140%',\n      startAngle: -90,\n      endAngle: 90,\n      background: {\n        backgroundColor: (Highcharts.theme &amp;&amp; Highcharts.theme.background2) || '#EEE',\n        innerRadius: '60%',\n        outerRadius: '100%',\n        shape: 'arc'\n      }\n    },\n\n    tooltip: {\n      enabled: false\n    },\n\n    // the value axis\n    yAxis: {\n      stops: [\n        [0.1, '#DF5353'], // red\n        [0.5, '#DDDF0D'], // yellow\n        [0.6, '#55BF3B'] // green\n      ],\n      lineWidth: 0,\n      minorTickInterval: null,\n      tickPixelInterval: 400,\n      tickWidth: 0,\n      title: {\n        y: -70\n      },\n      labels: {\n        y: 16\n      }\n    },\n\n    plotOptions: {\n      solidgauge: {\n        dataLabels: {\n          y: 5,\n          borderWidth: 0,\n          useHTML: true\n        }\n      }\n    }\n  };\n\n     $.getJSON('/convertcsv.json', function(data) {\n    // The speed gauge\n    $('#container-speed').highcharts(Highcharts.merge(gaugeOptions, {\n      yAxis: {\n        min: 0,\n        max: 500,\n        title: {\n          text: 'Water Level'\n        }\n      },\n\n      credits: {\n        enabled: false\n      },\n\n      series: [{\n        name: 'Water Level',\n        data: [data.waterLevel],\n        dataLabels: {\n          format: '&lt;div style=\"text-align:center\"&gt;&lt;span style=\"font-size:25px;color:' +\n            ((Highcharts.theme &amp;&amp; Highcharts.theme.contrastTextColor) || 'black') + '\"&gt;{y}&lt;/span&gt;&lt;br/&gt;' +\n            '&lt;span style=\"font-size:12px;color:silver\"&gt;water left&lt;/span&gt;&lt;/div&gt;'\n        },\n        tooltip: {\n          valueSuffix: ''\n        }\n      }]\n    })); // container-speed end\n  }); // getJson end\n\n});\n</code></pre>\n\n<p>item.rb</p>\n\n<pre><code>class Item\n    require 'dynamoid'\n  include Dynamoid::Document\n\n\n  table name: :sensor, key: :key, :read_capacity =&gt; 5, :write_capacity =&gt; 5\n\n  field :timestamp, :integer\n  field :payload, :serialized\n\n  def self.chart_values\n    x_data = []\n    temperatures = []\n    humidities = []\n    soil_moistures = []\n\n    # not an efective way to do\n    Item.all.each do |item|\n      x_data &lt;&lt; item.timestamp\n      temperatures &lt;&lt; (item.payload['temp'].to_f || 0)\n      humidities &lt;&lt; (item.payload['hum'].to_f || 0)\n      soil_moistures &lt;&lt; (item.payload['sol'].to_f || 0)\n    end\n    highcharts_value(x_data, temperatures, humidities, soil_moistures)\n  end\n\n  def self.highcharts_value(x_axis, temp, hum, soil)\n    {\n      xData: x_axis,\n      datasets: [\n        {\n          name: 'Temperature',\n          data: temp,\n          unit: '\u00b0C',\n          type: 'area',\n          valueDecimals: 1\n        },\n        {\n          name: 'Humidity',\n          data: hum,\n          unit: '%',\n          type: 'area',\n          valueDecimals: 1\n        },\n        {\n          name: 'Soil Moisture',\n          data: soil,\n          unit: '',\n          type: 'area',\n          valueDecimals: 0\n        }\n      ]\n    }\n  end\nend\n</code></pre>\n\n<p>index.haml</p>\n\n<pre><code>%head\n  %script{type: \"text/javascript\", src: url('/javascripts/jquery.min.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/highcharts.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/highcharts-more.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/solid-gauge.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/synchronized-charts.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/water-level-chart.js')}\n  %script{type: \"text/javascript\", src: url('/javascripts/water-pump.js')}\n  %link{rel: :stylesheet, type: :\"text/css\", href: url('/stylesheets/default.css')}\n#container\n  #synchronized\n  .gauge\n    #container-speed\n    .pump-control\n      %form{method: :post, action: '/take-action', id: 'action-form' }\n        %input{type: 'hidden', name: 'action', value: 'start', id: 'action_input'}\n        %span{id: 'pumper', onclick: 'takeAction()'}\n          start\n</code></pre>\n\n<p>After checking the browser console it says </p>\n\n<pre><code>jquery.min.js:2 GET http://localhost:4567/convertcsv.json 404 (Not Found)\nsend    @   jquery.min.js:2\najax    @   jquery.min.js:2\np.(anonymous function)  @   jquery.min.js:2\ngetJSON @   jquery.min.js:2\n(anonymous) @   synchronized-charts.js:60\nk   @   jquery.min.js:2\nfireWith    @   jquery.min.js:2\nready   @   jquery.min.js:2\nD   @   jquery.min.js:2\n</code></pre>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1519827957, "post_id": 49031786, "comment_id": 85068193, "body": "it partially works...but since at the time that ruby loaded, Billomat.config is defined, but it is not filled with configuration information and I get this error: <code>Failed to open TCP connection to .billomat.net:443</code>. Account is using an empty version of Billomat.config"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1519828079, "post_id": 49031786, "comment_id": 85068279, "body": "I doubt I follow. This is a completely different issue."}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1519828239, "post_id": 49031786, "comment_id": 85068401, "body": "sorry, can you be more clear? what do you doubt? and it is not a different issue cause if I require <code>account</code> <i>after</i> call <code>Billomat.config</code> it works."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1519829192, "post_id": 49031786, "comment_id": 85069072, "body": "I do not see any call to <code>Billomat.config</code> in your code and I have no idea about how it should be called to get values loaded. If one needs to call it before <code>require</code>, call it before <code>require</code> explicitly. Right after the module definition."}, {"owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 0, "creation_date": 1519829352, "post_id": 49031786, "comment_id": 85069183, "body": "the <code>config</code> should be called by someone who is using the gem, defining the service&#39;s subdomain and API key. After that they can call <code>Billomat::Account.new.....</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "edited": false, "score": 1, "creation_date": 1519829550, "post_id": 49031786, "comment_id": 85069330, "body": "OK, so the issue is <code>base_uri</code> DSL is called on class level, not <code>require</code> order at all. You have to find a workaround to call it on initialization, e.g. inside <code>initialize</code>: <code>def initialize; self.class_eval { base_uri ... }</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1519827792, "creation_date": 1519827792, "answer_id": 49031786, "question_id": 49031741, "link": "https://stackoverflow.com/questions/49031741/how-to-require-files-in-a-ruby-gem-if-they-depend-on-each-other/49031786#49031786", "title": "how to require files in a ruby gem if they depend on each other", "body": "<p>Ruby is a scripting language, it reads and processes lines one by one. Just change the order:</p>\n\n<p><strong>lib/billomat.rb</strong></p>\n\n<pre><code>require 'dry-configurable'\nrequire 'httparty'\n\nmodule Billomat\n  extend Dry::Configurable\n\n  setting :subdomain\n  setting :api_key\nend\n\nrequire 'billomat/version'\nrequire 'billomat/account'\n</code></pre>\n"}], "owner": {"reputation": 5707, "user_id": 587406, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1p6qq.jpg?s=128&g=1", "display_name": "Luiz E.", "link": "https://stackoverflow.com/users/587406/luiz-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 49031786, "answer_count": 1, "score": 0, "last_activity_date": 1519827792, "creation_date": 1519827648, "question_id": 49031741, "link": "https://stackoverflow.com/questions/49031741/how-to-require-files-in-a-ruby-gem-if-they-depend-on-each-other", "title": "how to require files in a ruby gem if they depend on each other", "body": "<p>I have the following structure:</p>\n\n<p><strong>lib/billomat.rb</strong></p>\n\n<pre><code>require 'dry-configurable'\nrequire 'httparty'\n\nrequire 'billomat/version'\nrequire 'billomat/account'\n\nmodule Billomat\n  extend Dry::Configurable\n\n  setting :subdomain\n  setting :api_key\nend\n</code></pre>\n\n<p><strong>lib/billomat/base.rb</strong></p>\n\n<pre><code>class Billomat::Base\n  include HTTParty\n  base_uri \"https://#{Billomat.config.subdomain}.billomat.net/api\"\n\n  def initialize\n    @options = { format: 'json', headers: {\n      'X-BillomatApiKey' =&gt; Billomat.config.api_key\n    } }\n  end\nend\n</code></pre>\n\n<p><strong>lib/billomat/account.rb</strong></p>\n\n<pre><code>require_relative 'base'\n\nclass Billomat::Account &lt; Billomat::Base\n  def info\n    puts Billomat.config.subdomain\n    self.class.get('/clients/myself', @options)\n  end\nend\n</code></pre>\n\n<p>If I try and access the console with <code>bin/console</code> I get an error: </p>\n\n<pre><code>lib/billomat/base.rb:3:in `&lt;class:Base&gt;': undefined method `config' for Billomat:Module (NoMethodError)\n</code></pre>\n\n<p>The gem tries to load account.rb that depends on base.rb that uses <code>Billomat.config</code> which at this it is not ready. I tried remove <code>require 'billomat/account'</code> from the <code>billomat.rb</code> and open the console again. Now, I can actually instantiate <code>Billomat.config</code>, but I try to call <code>Billomat::Account.new.info</code> I get another error:</p>\n\n<pre><code>irb(main):005:0&gt; Billomat::Account\nNameError: uninitialized constant Billomat::Account\n</code></pre>\n\n<p>because of course <code>billomat/account</code> is not required at this point, so I have to require manually.</p>\n\n<p>Question is: how can I organize the code so I can just call <code>Billomat.configuire {}</code> and then call <code>Billomat::Account.new.info</code> without having to manually require it when I want to use?</p>\n"}, {"tags": ["python", "ruby", "image-processing", "vips"], "comments": [{"owner": {"reputation": 390, "user_id": 6509168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0qZa.jpg?s=128&g=1", "display_name": "Jello", "link": "https://stackoverflow.com/users/6509168/jello"}, "edited": false, "score": 2, "creation_date": 1519829800, "post_id": 49031706, "comment_id": 85069494, "body": "By black and white do you mean grayscale or binary black and white?"}, {"owner": {"reputation": 743, "user_id": 9356981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4423952a7e37b084a1f1ebf5cc16fe45?s=128&d=identicon&r=PG", "display_name": "Adam Moller", "link": "https://stackoverflow.com/users/9356981/adam-moller"}, "edited": false, "score": 1, "creation_date": 1519830238, "post_id": 49031706, "comment_id": 85069802, "body": "Would this work for you? <a href=\"https://stackoverflow.com/a/16721373/9356981\">stackoverflow.com/a/16721373/9356981</a>"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "reply_to_user": {"reputation": 390, "user_id": 6509168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0qZa.jpg?s=128&g=1", "display_name": "Jello", "link": "https://stackoverflow.com/users/6509168/jello"}, "edited": false, "score": 0, "creation_date": 1519832615, "post_id": 49031706, "comment_id": 85071382, "body": "@Jello greyscale"}, {"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "reply_to_user": {"reputation": 743, "user_id": 9356981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4423952a7e37b084a1f1ebf5cc16fe45?s=128&d=identicon&r=PG", "display_name": "Adam Moller", "link": "https://stackoverflow.com/users/9356981/adam-moller"}, "edited": false, "score": 0, "creation_date": 1519832713, "post_id": 49031706, "comment_id": 85071442, "body": "@AdamMoller thanks, that might help, I&#39;ll try to rewrite it using ruby"}, {"owner": {"reputation": 144829, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1519858427, "post_id": 49031706, "comment_id": 85085318, "body": "Can you provide a sample image please?"}], "answers": [{"tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": false, "score": 3, "last_activity_date": 1519832807, "creation_date": 1519832807, "answer_id": 49033432, "question_id": 49031706, "link": "https://stackoverflow.com/questions/49031706/subtract-2-identical-images-bw-and-colorful-to-get-color-difference/49033432#49033432", "title": "Subtract 2 identical images (B&amp;W and colorful) to get color difference", "body": "<p>The right approach here is to convert to HSV or a similar color space that separates out saturation or chroma. Then find pixels with a high value for saturation/chroma.</p>\n\n<p>The hue component of the HSV (or similar) color space then gives you the color for those pixels (yellow or green, as an angle on the chromaticity plane).</p>\n\n<p>I cannot post code because you have tagged the question with two different languages, and I have no idea which of them is the code snippet you posted. I hope you can take it from here.</p>\n"}, {"tags": [], "owner": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "is_accepted": true, "score": 2, "last_activity_date": 1519855429, "creation_date": 1519855429, "answer_id": 49039361, "question_id": 49031706, "link": "https://stackoverflow.com/questions/49031706/subtract-2-identical-images-bw-and-colorful-to-get-color-difference/49039361#49039361", "title": "Subtract 2 identical images (B&amp;W and colorful) to get color difference", "body": "<p>In ruby-vips you could do:</p>\n\n<pre><code>require 'vips'\n\na = Vips::Image.new_from_file ARGV[0]\n\n# convert to LCh colourspace\na = a.colourspace \"lch\"\n\n# Chroma (band 1) &gt; 0 means we have some colour ... take &gt; 10, since things \n# like jpg compression will add some colour noise we are not \n# interested in\nmask = a[1] &gt; 10\n\n# the mask image will have 255 for TRUE pixels and 0 for FALSE\nmask.write_to_file \"mask.png\"\n</code></pre>\n\n<p>The mask image might not be very helpful, but I'm not clear exactly what output you need. </p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Lab_color_space#Cylindrical_representation:_CIELCh_or_CIEHLC\" rel=\"nofollow noreferrer\">LCh colourspace</a> is useful here: band 1 (ie. C) is the distance of the pixel from the neutral axis, exactly what you want, I think.</p>\n"}], "owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 49039361, "answer_count": 2, "score": 0, "last_activity_date": 1519855429, "creation_date": 1519827566, "question_id": 49031706, "link": "https://stackoverflow.com/questions/49031706/subtract-2-identical-images-bw-and-colorful-to-get-color-difference", "title": "Subtract 2 identical images (B&amp;W and colorful) to get color difference", "body": "<p>I have mostly black and white image, with some parts in color (let's say it's yellow and green). <strong>I would like to find out those colors.</strong></p>\n\n<p>For that, I suppose I might convert image to black &amp; white, and then compare b &amp; w image with original one to find the difference. But I'm not quite sure which algorithm I should use to do that.</p>\n\n<p>Something like that in pseudocode:</p>\n\n<pre><code>image = image_from_file('image.jpg')\nbw_image = image.convert_to_bw\ndiff_image = (bw_image - image)\n# Build histogram w/o black and white parts, only color ones\ndiff_image.histogram\n</code></pre>\n\n<p>I'm primary focused on libvips to do that, but I just need an advice of how to do that in general, then I'll be able to code that.</p>\n\n<p>I would also appreciate if you know any other way to do what I described above.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord", "exists"], "answers": [{"comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1519833569, "post_id": 49033270, "comment_id": 85072043, "body": "Could you please comment on the difference between <code>includes</code> and <code>joins</code> and why the proposed change should work?"}, {"owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "edited": false, "score": 0, "creation_date": 1519854121, "post_id": 49033270, "comment_id": 85083445, "body": "Basically the <code>includes</code> uses eager loading whereas <code>joins</code> uses lazy loading. You can check more <a href=\"http://tomdallimore.com/blog/includes-vs-joins-in-rails-when-and-where/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 3, "user_id": 3081786, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006412417454/picture?type=large", "display_name": "stekatk", "link": "https://stackoverflow.com/users/3081786/stekatk"}, "edited": false, "score": 1, "creation_date": 1519892303, "post_id": 49033270, "comment_id": 85095230, "body": "@Aqabawe The problem with your query is the same as with joins. For example, we have only one company with two users - David and Goliath. Your query will return that company (should return nil), because it really searches for <b>companies, that have at least one user with name different from David</b>. So the problem remains unsolved."}], "tags": [], "owner": {"reputation": 339, "user_id": 702384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/104529d3b6fc25f9a294ce8794df6569?s=128&d=identicon&r=PG", "display_name": "Aqabawe", "link": "https://stackoverflow.com/users/702384/aqabawe"}, "is_accepted": false, "score": 1, "last_activity_date": 1519832284, "creation_date": 1519832284, "answer_id": 49033270, "question_id": 49031401, "link": "https://stackoverflow.com/questions/49031401/rails-way-to-write-sql-exists-for-active-record/49033270#49033270", "title": "Rails way to write SQL EXISTS for Active Record?", "body": "<p>Just replace joins with includes</p>\n\n<pre><code>Company.includes(:users).where.not(users: { name: 'David' })\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 3081786, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006412417454/picture?type=large", "display_name": "stekatk", "link": "https://stackoverflow.com/users/3081786/stekatk"}, "is_accepted": true, "score": 0, "last_activity_date": 1523877303, "creation_date": 1523877303, "answer_id": 49855932, "question_id": 49031401, "link": "https://stackoverflow.com/questions/49031401/rails-way-to-write-sql-exists-for-active-record/49855932#49855932", "title": "Rails way to write SQL EXISTS for Active Record?", "body": "<p>Well, in the end ActiveRecord doesn't have full power of SQL, so I ended up with raw SQL.</p>\n\n<p>Still there is a gem that adds EXISTS to ActiveRecord:\n<a href=\"https://github.com/EugZol/where_exists\" rel=\"nofollow noreferrer\">https://github.com/EugZol/where_exists</a></p>\n\n<p>If you want to avoid raw SQL at any costs, you can use this.</p>\n"}], "owner": {"reputation": 3, "user_id": 3081786, "user_type": "registered", "profile_image": "https://graph.facebook.com/100006412417454/picture?type=large", "display_name": "stekatk", "link": "https://stackoverflow.com/users/3081786/stekatk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 49855932, "answer_count": 2, "score": 0, "last_activity_date": 1523877303, "creation_date": 1519826687, "question_id": 49031401, "link": "https://stackoverflow.com/questions/49031401/rails-way-to-write-sql-exists-for-active-record", "title": "Rails way to write SQL EXISTS for Active Record?", "body": "<p>I have the following setup: </p>\n\n<pre><code>class Company\n  has_many :users\nend\n\nclass User\n  belongs_to :company\nend\n</code></pre>\n\n<p>I need to get all companies that doesn't have a user with specific name, let it be 'David'.</p>\n\n<p>It's easy to do the opposite, find all companies that have a user named David:</p>\n\n<pre><code>Company.joins(:users).where(users: { name: 'David' }).distinct\n</code></pre>\n\n<p>But I don't know how to do the original task in one SQL request.\nI tried this:</p>\n\n<pre><code>Company.joins(:users).where.not(users: { name: 'David' }).distinct\n</code></pre>\n\n<p>but it doesn't work as I thought.</p>\n\n<p>So I made a raw SQL solution, where the query is:</p>\n\n<pre><code>\"SELECT companies \n  FROM companies \n  WHERE NOT EXISTS \n    (SELECT users \n      FROM users \n      WHERE users.company_id = companies.id \n      AND users.name = 'David')\"\n</code></pre>\n\n<p>So I am wondering if there is a way to do this task in rails way, using joins and where methods, or may be there is also a method for EXISTS.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519825280, "post_id": 49030876, "comment_id": 85066295, "body": "What is your question?"}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519825800, "post_id": 49030876, "comment_id": 85066693, "body": "If this is a very dangerous thing to do. Being able to do it doesn&#39;t mean it should be done, and I feared this could be the case here."}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519825981, "post_id": 49030876, "comment_id": 85066817, "body": "For example, <code>something.send(:private_method)</code> is valid, but I think everyone would say that it should NOT be done."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519826861, "post_id": 49030876, "comment_id": 85067368, "body": "Personally, I&#39;d never do this. Not even because this is dangerous, but because it is a huuuge WTF-moment. Reading ruby code, one can kinda expect that equality operators work &quot;normally&quot;."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519827466, "post_id": 49030876, "comment_id": 85067810, "body": "@SergioTulentsev as a matter of fact, triple-equal aka case-equal is <i>intended</i> to be overwritten. For normal <code>==</code> I\u2019d avoid overwriting, yes."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519827590, "post_id": 49030876, "comment_id": 85067916, "body": "@mudasobwa: it&#39;s commonly known as &quot;threequals&quot;, btw :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519827638, "post_id": 49030876, "comment_id": 85067949, "body": "@SergioTulentsev I guess I am a persona non grata in that community since I have never heard this term."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519827749, "post_id": 49030876, "comment_id": 85068026, "body": "@mudasobwa: for this example to work, we&#39;d need to amend <code>Symbol#===</code>. It doesn&#39;t <i>feel</i> right."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519827957, "post_id": 49030876, "comment_id": 85068194, "body": "@SergioTulentsev it does feel perfectly right since we have <code>super</code> in  <code>prepend</code>ed modules. C\u2019mon, man, it\u2019s ruby."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519828151, "post_id": 49030876, "comment_id": 85068329, "body": "@mudasobwa: must be I&#39;m reaching the age when I start fearing change and uncertainty. I guess I should start looking at java :)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1519828185, "post_id": 49030876, "comment_id": 85068360, "body": "@SergioTulentsev sure thing. COBOL is also good in our ages."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519828258, "post_id": 49030876, "comment_id": 85068414, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165975/discussion-between-sergio-tulentsev-and-mudasobwa\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "edited": false, "score": 0, "creation_date": 1519829229, "post_id": 49030876, "comment_id": 85069103, "body": "Fun to understand that I don&#39;t have enough &quot;reputation&quot; to even take part in the chat.  So, I take it overriding <code>#===</code> would work, but would be a bad practice."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519831175, "post_id": 49030876, "comment_id": 85070431, "body": "@Zyrthofar: as you can see, it&#39;s very much opinion-based. My opinion is to not do this without real need. mudasobwa disagrees."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519831422, "post_id": 49030876, "comment_id": 85070582, "body": "@Zyrthofar: ah but yes, it would work."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1519832454, "post_id": 49030876, "comment_id": 85071258, "body": "What does <code>user.country</code> return?"}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1519832880, "post_id": 49030876, "comment_id": 85071561, "body": "@Stefan A normal <code>Country</code> record."}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "edited": false, "score": 0, "creation_date": 1519832889, "post_id": 49030876, "comment_id": 85071566, "body": "Thank you everyone for your input!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1519835902, "post_id": 49030876, "comment_id": 85073565, "body": "Would&#39;t it be easier to check for <code>:CAN == user.country.code</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519859009, "post_id": 49030876, "comment_id": 85085542, "body": "You&#39;ll really want to steer away from putting in core extensions on Symbol to handle quirky behaviour like this. In Ruby the <code>==</code> comparison is directional, this is expected by anyone familiar with the language, and <code>a == b</code> is not obligated to be the same as <code>b == a</code> except under constraints imposed by things like <a href=\"http://ruby-doc.org/core-2.5.0/Comparable.html\" rel=\"nofollow noreferrer\">Comparable</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519859068, "post_id": 49030876, "comment_id": 85085566, "body": "Why can&#39;t you do this with strings or, better still, some kind of Country object so you can do <code>user.country == Country.canada</code>?"}, {"owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "edited": false, "score": 0, "creation_date": 1519909071, "post_id": 49030876, "comment_id": 85104662, "body": "All this has helped me decide <i>not</i> to implement these backward comparisons, and in fact to completely remove the current behavior described in the question description. Thank you!"}], "owner": {"reputation": 1, "user_id": 3685830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b49f122ad19e93964678804d828b8?s=128&d=identicon&r=PG", "display_name": "Zyrthofar", "link": "https://stackoverflow.com/users/3685830/zyrthofar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519832163, "creation_date": 1519824975, "last_edit_date": 1519832163, "question_id": 49030876, "link": "https://stackoverflow.com/questions/49030876/is-overriding-operators-with-prepend-dangerous", "title": "Is overriding operators with #prepend dangerous?", "body": "<p>I am building a gem that makes an <code>ActiveRecord</code> immutable. The details do not matter, but basically, one thing this allows is for <code>user.country == :CAN</code> to return <code>true</code> if the country's code attribute match.</p>\n\n<p>Of course, this means that <code>:CAN == user.country</code> will never work unless I override the <code>==</code> operator on <code>Symbol</code>, which I am wondering if this is a dangerous thing to do, maybe because of the added overhead, since this operator is used extensively everywhere. </p>\n\n<p>Is there a better/smarter way to do exactly that? <code>#coerce</code> is not an option because <code>Symbol</code> already knows how to <code>==</code>.</p>\n\n<pre><code>Symbol.prepend(Module.new do\n  def ==(other)\n    if other.respond_to?(:immutable?) &amp;&amp; other.immutable?\n      other.==(self)\n    else\n      super\n    end\n  end\nend)\n</code></pre>\n\n<p>If it changes anything, my main issue also has to do with the <code>===</code> operator, since I wanted to enable the following:</p>\n\n<pre><code>case user.country\n  when :CAN then ...\n  when :USA then ...\n  else ...\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "scope"], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1519827913, "post_id": 49031172, "comment_id": 85068154, "body": "Thanks for the idea. I think there will be a problem when state open is not included because then the select will start win AND clause."}, {"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "reply_to_user": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1519875041, "post_id": 49031172, "comment_id": 85089499, "body": "yeah, i thought of that you need to add some conditions to handle this. i just show the way to do this."}], "tags": [], "owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "is_accepted": true, "score": 1, "last_activity_date": 1519825947, "creation_date": 1519825947, "answer_id": 49031172, "question_id": 49030775, "link": "https://stackoverflow.com/questions/49030775/scope-with-multiple-where-conditions-based-on-multiple-conditions/49031172#49031172", "title": "Scope with multiple where conditions based on multiple conditions", "body": "<p>hope this solve your problem.</p>\n\n<pre><code>scope :state, -&gt;(state) {where(self.query_conditions(state), q: Time.now.utc.beginning_of_day))}\n\ndef self.query_conditions(state)\n  q = \"\"\n  q+= \"start_time &lt;= :q and end_time &gt;= :q\" if state.include?(\"open\")\n  q+= \" and end_time &lt; :q\" if state.include?(\"closed\")\n  q+= \" and start_time &gt; :q\" if state.include?(\"upcoming\")\n  q\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "edited": false, "score": 0, "creation_date": 1520254320, "post_id": 49067703, "comment_id": 85226850, "body": "This doesn&#39;t work for me. Also, I need to combine the conditions with OR. I Edited the answer by @Pardeep Saini, but he doesn&#39;t accept the changes yet."}], "tags": [], "owner": {"reputation": 2578, "user_id": 1478058, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fdc2fbe6012548e09c652be112f9a1b?s=128&d=identicon&r=PG", "display_name": "trushkevich", "link": "https://stackoverflow.com/users/1478058/trushkevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1519988128, "creation_date": 1519988128, "answer_id": 49067703, "question_id": 49030775, "link": "https://stackoverflow.com/questions/49030775/scope-with-multiple-where-conditions-based-on-multiple-conditions/49067703#49067703", "title": "Scope with multiple where conditions based on multiple conditions", "body": "<p>You should be able to use</p>\n\n<pre><code>  scope :state, -&gt;(state) {\n    rel = all\n    rel = rel.where(\"start_time &lt;= ? and end_time &gt;= ?\", Time.now.utc.beginning_of_day, Time.now.utc.beginning_of_day) if state.include?(\"open\")\n    rel = rel.where(\"end_time &lt; ?\", Time.now.utc.beginning_of_day) if state.include?(\"closed\")\n    rel = rel.where(\"start_time &gt; ?\", Time.now.utc.beginning_of_day) if state.include?(\"upcoming\")\n    rel\n  }\n</code></pre>\n\n<p>Notice that you should do</p>\n\n<pre><code>state([\"deleted\", \"upcoming\"])\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>state([\"deleted\"], [\"upcoming\"])\n</code></pre>\n\n<p>Also you can use <a href=\"https://apidock.com/rails/Array/wrap/class\" rel=\"nofollow noreferrer\">Array.wrap</a> to simplify using the scope:</p>\n\n<pre><code>  scope :state, -&gt;(state) {\n    state = Array.wrap(state)\n    rel = all\n    rel = rel.where(\"start_time &lt;= ? and end_time &gt;= ?\", Time.now.utc.beginning_of_day, Time.now.utc.beginning_of_day) if state.include?(\"open\")\n    rel = rel.where(\"end_time &lt; ?\", Time.now.utc.beginning_of_day) if state.include?(\"closed\")\n    rel = rel.where(\"start_time &gt; ?\", Time.now.utc.beginning_of_day) if state.include?(\"upcoming\")\n    rel\n  }\n</code></pre>\n\n<p>With state being wrapped you can use the scope in both following ways:</p>\n\n<pre><code>Model.state(['open', 'upcoming'])\nModel.state('open', 'upcoming')\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 5950598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ihgv3.jpg?s=128&g=1", "display_name": "Jan Krupa", "link": "https://stackoverflow.com/users/5950598/jan-krupa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 49031172, "answer_count": 2, "score": 0, "last_activity_date": 1519988128, "creation_date": 1519824664, "question_id": 49030775, "link": "https://stackoverflow.com/questions/49030775/scope-with-multiple-where-conditions-based-on-multiple-conditions", "title": "Scope with multiple where conditions based on multiple conditions", "body": "<p>Is there possible to use something like</p>\n\n<pre><code>  scope :state, -&gt;(state) {\n    merge(where(\"start_time &lt;= ? and end_time &gt;= ?\", Time.now.utc.beginning_of_day, Time.now.utc.beginning_of_day)) if state.include?(\"open\")\n    merge(where(\"end_time &lt; ?\", Time.now.utc.beginning_of_day)) if state.include?(\"closed\")\n    merge(where(\"start_time &gt; ?\", Time.now.utc.beginning_of_day)) if state.include?(\"upcoming\")\n  }\n</code></pre>\n\n<p>If I use this scope, only the last one is functional.</p>\n\n<p>for example:</p>\n\n<ul>\n<li>state([\"upcoming\"]) -> work</li>\n<li>state([\"open\"]) -> where is not used</li>\n<li>state([\"deleted\"], [\"upcoming\"]) -> only where with upcoming conditions is used</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1519825006, "post_id": 49030715, "comment_id": 85066089, "body": "Why is your <code>path</code> variable a nested array?"}], "answers": [{"comments": [{"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519826770, "post_id": 49030785, "comment_id": 85067320, "body": "Their <code>path</code> is <code>[[:test],[:foo]]</code>, not <code>[:test, :foo]</code>."}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519827775, "post_id": 49030785, "comment_id": 85068048, "body": "It&#39;s a variable which can be changed."}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519827823, "post_id": 49030785, "comment_id": 85068088, "body": "Any way we just need to add <code>flatten</code> if the input value is <code>[[:test],[:foo]]</code>"}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": false, "score": 3, "last_activity_date": 1519825015, "last_edit_date": 1519825015, "creation_date": 1519824696, "answer_id": 49030785, "question_id": 49030715, "link": "https://stackoverflow.com/questions/49030715/ruby-access-hash-value-by-a-variable/49030785#49030785", "title": "Ruby access hash value by a variable", "body": "<p>You can make use of <code>dig</code>. You can check the doc of dig here <a href=\"http://ruby-doc.org/core-2.3.0_preview1/Hash.html#method-i-dig\" rel=\"nofollow noreferrer\"><strong><code>Hash#dig</code></strong></a></p>\n\n<pre><code>c = { :test =&gt; { :foo =&gt; true } }\nc[:test][:foo]\n#=&gt; true\n\nc.dig(:test, :foo)\n#=&gt; true\n\npath = [:test, :foo]\nc.dig(*path)\n#=&gt; true\n</code></pre>\n\n<p>You just need to pass the hierarchy</p>\n\n<blockquote>\n  <p>Note: The <code>*</code> before <code>path</code> in <code>c.dig(*path)</code> is reffered as <strong>splat operator</strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1519825835, "post_id": 49030905, "comment_id": 85066722, "body": "You can avoid <code>flatten</code> via <code>path.reduce(hash) { |h, (p)| h[p] }</code>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1519826975, "last_edit_date": 1519826975, "creation_date": 1519825080, "answer_id": 49030905, "question_id": 49030715, "link": "https://stackoverflow.com/questions/49030715/ruby-access-hash-value-by-a-variable/49030905#49030905", "title": "Ruby access hash value by a variable", "body": "<p>Old good recursive Ruby 1.9+ solution:</p>\n\n<pre><code>hash = {:test =&gt; {:foo =&gt; true}}\npath = [[:test],[:foo]]\n\npath.flatten.reduce(hash) { |h, p| h[p] }\n#\u21d2\u00a0true\n</code></pre>\n\n<p>Or, as @Stefan suggested in comments:</p>\n\n<pre><code>path.reduce(hash) { |h, (p)| h[p] }\n# or even\npath.reduce(hash) { |h, p| h[p.first] }\n</code></pre>\n\n<p>More defensive:</p>\n\n<pre><code>path.flatten.reduce(hash) { |h, p| h.nil? ? nil : h[p] }\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 49030905, "answer_count": 2, "score": 1, "last_activity_date": 1519826975, "creation_date": 1519824452, "question_id": 49030715, "link": "https://stackoverflow.com/questions/49030715/ruby-access-hash-value-by-a-variable", "title": "Ruby access hash value by a variable", "body": "<p>Let's consider this as our hash <code>c = {:test =&gt; {:foo =&gt; true}}</code></p>\n\n<p>Normally, if we would like to print value of foo, we would access the hash like this <code>c[:test][:foo]</code> but I would like to access it dynamically based on my variable. </p>\n\n<p>Therefore, let's consider the following variable <code>path = [[:test],[:foo]]</code>.</p>\n\n<p>How do I access the value true now? I have tried <code>c[path]</code> but it just says <code>nil</code>. What am I missing?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 204581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3843532a5178e5486efa68ca64f66d8?s=128&d=identicon&r=PG", "display_name": "Leonhardt Wille", "link": "https://stackoverflow.com/users/204581/leonhardt-wille"}, "is_accepted": true, "score": 1, "last_activity_date": 1519830689, "last_edit_date": 1519830689, "creation_date": 1519828636, "answer_id": 49032052, "question_id": 49030170, "link": "https://stackoverflow.com/questions/49030170/how-to-read-an-io-object-into-another/49032052#49032052", "title": "How to read an IO object into another", "body": "<p>You can use <a href=\"http://ruby-doc.org/core-2.0.0/IO.html#method-c-copy_stream\" rel=\"nofollow noreferrer\">IO.copy_stream</a>:</p>\n\n<pre><code>files = [File.open('1.sql'), File.open('2.sql')]\nmysql = IO.popen('mysql','w') # Spawn a `mysql` process for writing to its `STDIN`, returns an `IO`\nfiles.each do |file|\n  IO.copy_stream(file, mysql) # Takes two `IO` objects, reads from first and writes to second\n  file.close()\nend\nmysql.close()\n</code></pre>\n\n<p>Feel free to omit the <code>close()</code> calls if your method/program is over now, as file handles will be automatically closed.\nNote it might be dangerous to open an unlimited number of files at once (there's a limit of open files per process), so consider opening and closing them one by one.</p>\n"}], "owner": {"reputation": 1838, "user_id": 3692286, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/deAJz.jpg?s=128&g=1", "display_name": "jleeothon", "link": "https://stackoverflow.com/users/3692286/jleeothon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49032052, "answer_count": 1, "score": 0, "last_activity_date": 1519830689, "creation_date": 1519822690, "last_edit_date": 1519823325, "question_id": 49030170, "link": "https://stackoverflow.com/questions/49030170/how-to-read-an-io-object-into-another", "title": "How to read an IO object into another", "body": "<p>If I have one IO object that will be written to, and one IO object that is read from, how can I easily pipe one into another?</p>\n\n<p>My use case is roughly:</p>\n\n<pre><code>require \"open3\"\n# File &lt; IO\nfiles = [File.open('1.sql'), File.open('2.sql')]\ninput, waiters = Open3.pipeline_w(\"mysql\") # input is an IO\nfiles.each do |file|\n    file.each_line do |line|\n        input.write line\n    end\nend\ninput.close\nProcess.wait waiters[0].pid\n</code></pre>\n\n<p>One alternative is to use <code>Open3.pipeline('cat myfile.sql', 'mysql')</code>, but then I wouldn't be able to start <code>mysql</code> only once for all the files.</p>\n"}, {"tags": ["ruby", "proxy", "rubygems", "rest-client"], "comments": [{"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1519823464, "post_id": 49030117, "comment_id": 85065033, "body": "I am a Windows user."}], "answers": [{"comments": [{"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1519823059, "post_id": 49030254, "comment_id": 85064784, "body": "Thanks but this is not my question. This way I still have to manually enter the proxy if i am using one."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6506253"}, "is_accepted": false, "score": -1, "last_activity_date": 1519823545, "last_edit_date": 1519823545, "creation_date": 1519822937, "answer_id": 49030254, "question_id": 49030117, "link": "https://stackoverflow.com/questions/49030117/using-system-proxy-in-restclient/49030254#49030254", "title": "Using system Proxy in RestClient", "body": "<p><a href=\"https://stackoverflow.com/questions/22059670/how-can-i-set-a-proxy-server-for-gem/28153935#28153935\">This</a> answer tells how to add proxy via cmd. Maybe this could be of some use. You can run these commands using <code>system()</code>. You may not need to specifically specify proxy in RestClient. <strong>!UNTESTED!</strong> This also has an option for port. The windows proxy and terminal proxies are different.</p>\n\n<p>So your 2nd and 3rd questions are answered hopefully.</p>\n"}, {"comments": [{"owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "edited": false, "score": 0, "creation_date": 1519823359, "post_id": 49030283, "comment_id": 85064975, "body": "Okay I get the <i>actual way</i> by which i can use the port in the address but I can definitely set windows proxy by <code>system(&quot;REG ADD \\&quot;HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Intern&zwnj;&#8203;et Settings\\&quot; &#47;v ProxyEnable &#47;t REG_DWORD &#47;d 1 &#47;f&quot;)</code> So is it not possible to read this registry as well some how?"}], "tags": [], "owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "is_accepted": false, "score": 1, "last_activity_date": 1519823054, "creation_date": 1519823054, "answer_id": 49030283, "question_id": 49030117, "link": "https://stackoverflow.com/questions/49030117/using-system-proxy-in-restclient/49030283#49030283", "title": "Using system Proxy in RestClient", "body": "<p>There's nothing magical about it.  </p>\n\n<p><code>http_proxy</code> is assumed set by a user or administrator, and can be of the form <code>http_proxy=http://username:password@proxy.example.org:8080</code> with both the credentials and port optional.  </p>\n\n<p>None of these magically import from the system; *nix systems generally don't have a \"system proxy setting\" and I don't think you can get at Windows' proxy settings determined in the network settings.</p>\n"}, {"tags": [], "owner": {"reputation": 1358, "user_id": 2458706, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/azbcI.png?s=128&g=1", "display_name": "inon", "link": "https://stackoverflow.com/users/2458706/inon"}, "is_accepted": false, "score": 0, "last_activity_date": 1595951609, "creation_date": 1595951609, "answer_id": 63138123, "question_id": 49030117, "link": "https://stackoverflow.com/questions/49030117/using-system-proxy-in-restclient/63138123#63138123", "title": "Using system Proxy in RestClient", "body": "<p>restClient.Proxy = new System.Net.WebProxy(yourProxyServer, yourProxyPort);</p>\n"}], "owner": {"reputation": 3076, "user_id": 4427870, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-gZZq2ak7cZU/AAAAAAAAAAI/AAAAAAAAAI4/u9zvfaYPRgw/photo.jpg?sz=128", "display_name": "Rishav", "link": "https://stackoverflow.com/users/4427870/rishav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3140, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1595951609, "creation_date": 1519822521, "question_id": 49030117, "link": "https://stackoverflow.com/questions/49030117/using-system-proxy-in-restclient", "title": "Using system Proxy in RestClient", "body": "<p>I use RestClient to get pages over internet. Also this script I made is proxy enabled by using <code>RestClient.proxy = \"http://proxy.example.com/\"</code>. \nBut I dont always use proxy. So instead of manually setting proxy on and off inside the script I wanted the script to read system settings automatically.</p>\n\n<p>The GitHub documentation states:</p>\n\n<blockquote>\n  <p>Often the proxy URL is set in an environment variable, so you can do this to use whatever proxy the system is configured to use:</p>\n  \n  <p><code>RestClient.proxy = ENV['http_proxy']</code></p>\n</blockquote>\n\n<p>I dont see how can this detect if system proxy in on or not here. It although can detect what proxy address I am using <em>i suppose</em>.</p>\n\n<ul>\n<li>Also how specifically can I use this?</li>\n<li>Also how do I specify the proxy port?</li>\n<li>AND how can I get the system's proxy settings and then\nfollow up with <code>RestClient.proxy = \"http://proxy.example.com/\"</code>\n<strong>IF</strong> proxy is enabled.</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 452, "user_id": 2105198, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d8d71b35e59634845c7b1b522824a832?s=128&d=identicon&r=PG", "display_name": "andrefurquin", "link": "https://stackoverflow.com/users/2105198/andrefurquin"}, "edited": false, "score": 0, "creation_date": 1519850176, "post_id": 49029550, "comment_id": 85081368, "body": "I would rather like to have a live approach. like google docs, informing that someone is already there."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1519822163, "last_edit_date": 1519822163, "creation_date": 1519820700, "answer_id": 49029550, "question_id": 49029372, "link": "https://stackoverflow.com/questions/49029372/show-user-that-are-on-a-given-route-in-rails/49029550#49029550", "title": "Show User That Are On A Given Route in Rails", "body": "<p>You can update the document giving a user exclusive lease to update it. When another user tries to update it, he gets an error message informing him that the document cannot be leased. When lease expires or the first user saves, the document can be edited again.</p>\n\n<p>Example/pseudocode (not tested, be aware - not thread safe):</p>\n\n<pre><code>class Document\n  def lease!(user: time: 15.minutes)\n    fail DocumentLeased if leased? &amp;&amp; !leased_to?(user)\n    update(leased_to: user, leased_until: Time.now + time)\n  end\n\n  def leased_to?(user)\n    leased_to == user\n  end\n\n  def leased?\n    leased_until &gt; Time.now\n  end\n\n  def clear_lease\n    update(leased_to: nil, leased_until: nil)\n  end\nend\n\nclass DocumentController\n def edit\n   # ...\n   @document.lease_to(current_user)\n end\n\n def update\n   #...\n   @document.clear_lease\n end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 761, "user_id": 4299353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f90473299f58264f0744371b4fe444?s=128&d=identicon&r=PG&f=1", "display_name": "mmsilviu", "link": "https://stackoverflow.com/users/4299353/mmsilviu"}, "is_accepted": false, "score": 0, "last_activity_date": 1519855295, "last_edit_date": 1592644375, "creation_date": 1519855295, "answer_id": 49039331, "question_id": 49029372, "link": "https://stackoverflow.com/questions/49029372/show-user-that-are-on-a-given-route-in-rails/49039331#49039331", "title": "Show User That Are On A Given Route in Rails", "body": "<p>You are right, the answer is Action Cable, if you want to inform the user who is editing and when he will release the document.</p>\n<p>There are a lot of resources available, but you an start by checking these:</p>\n<ul>\n<li><a href=\"http://guides.rubyonrails.org/action_cable_overview.html\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/action_cable_overview.html</a></li>\n<li><a href=\"https://medium.com/rubyinside/action-cable-hello-world-with-rails-5-1-efc475b0208b\" rel=\"nofollow noreferrer\">https://medium.com/rubyinside/action-cable-hello-world-with-rails-5-1-efc475b0208b</a></li>\n<li><a href=\"https://www.learnenough.com/action-cable-tutorial\" rel=\"nofollow noreferrer\">https://www.learnenough.com/action-cable-tutorial</a></li>\n</ul>\n<p><strong>But,</strong> if you just want to inform the user that this document is edited by other user , you can use a lock/unlock mechanism. The basics is described by @mrzasa in his answer or <a href=\"https://gist.github.com/Stex/6222440\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>You just need to inform the user, on <code>edit</code> action, that document is locked. The document will be unlocked on <code>update</code> only if the current_user is the user who locked the document.</p>\n"}], "owner": {"reputation": 452, "user_id": 2105198, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d8d71b35e59634845c7b1b522824a832?s=128&d=identicon&r=PG", "display_name": "andrefurquin", "link": "https://stackoverflow.com/users/2105198/andrefurquin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519855295, "creation_date": 1519820173, "last_edit_date": 1519838802, "question_id": 49029372, "link": "https://stackoverflow.com/questions/49029372/show-user-that-are-on-a-given-route-in-rails", "title": "Show User That Are On A Given Route in Rails", "body": "<p>I'm building a system, and I have a routes like <code>/document/123</code>. </p>\n\n<p>In my application I have many users that will eventually edit those documents, and I don't want one user to edit the same document of another. It would be good to give feedback like \"Hey, user x is editing this document already\". </p>\n\n<p>How can I achieve this in Rails? </p>\n\n<p>I think <code>ActionCable</code> would be the answer but I'm still lost. It would be good to have some material or similar code so I can move on with this task.</p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "edited": false, "score": 0, "creation_date": 1520421720, "post_id": 49028373, "comment_id": 85305525, "body": "in case you know this one @mudasowba <a href=\"https://stackoverflow.com/questions/49150665/ruby-avoid-errors-when-nil-in-sort-by\" title=\"ruby avoid errors when nil in sort by\">stackoverflow.com/questions/49150665/&hellip;</a>"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 5, "last_activity_date": 1519816891, "creation_date": 1519816891, "answer_id": 49028373, "question_id": 49028273, "link": "https://stackoverflow.com/questions/49028273/ruby-sort-an-array-of-hashes-from-a-defined-index/49028373#49028373", "title": "ruby / sort an array of hashes from a defined index", "body": "<p>Nai\u0308ve approach:</p>\n\n<pre><code>sorter = [300, 450, 345, 23]\ninput = [\n   {id: 450, title: 'rand1'},  \n   {id: 23, title: 'rand3'},  \n   {id: 300, title: 'rand0'},  \n   {id: 345, title: 'rand2'},  \n]  \ninput.sort do |h1, h2|\n  sorter.index(h1[:id]) &lt;=&gt; sorter.index(h2[:id])\nend\n#\u21d2 [\n#     {:id=&gt;300, :title=&gt;\"rand0\"},\n#     {:id=&gt;450, :title=&gt;\"rand1\"},\n#     {:id=&gt;345, :title=&gt;\"rand2\"},\n#     {:id=&gt;23, :title=&gt;\"rand3\"}]\n</code></pre>\n\n<p>or even simper:</p>\n\n<pre><code>input.sort_by { |h| sorter.index(h[:id]) }\n</code></pre>\n"}], "owner": {"reputation": 4429, "user_id": 102133, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/561a3a55352fe6a5343e541a6894b541?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/102133/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 49028373, "answer_count": 1, "score": 0, "last_activity_date": 1519821793, "creation_date": 1519816550, "question_id": 49028273, "link": "https://stackoverflow.com/questions/49028273/ruby-sort-an-array-of-hashes-from-a-defined-index", "title": "ruby / sort an array of hashes from a defined index", "body": "<p>Having the following array, it defines the sorting : </p>\n\n<pre><code>[300, 450, 345, 23]\n</code></pre>\n\n<p>And the following array, unsorted : </p>\n\n<pre><code>[\n  {id: 450, title: 'rand1'},\n  {id: 23, title: 'rand3'},\n  {id: 300, title: 'rand0'},\n  {id: 345, title: 'rand2'},\n]\n</code></pre>\n\n<p>I'd like the first array to be a \"rule\" to sort my second array (probably by matching the id key).</p>\n\n<p>How can i get achieve this cleanly ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "orm"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1519818916, "post_id": 49027034, "comment_id": 85062117, "body": "its working perfectly fine as whenever you create an object with associated object it automatically fetch the associated object id."}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1519819570, "post_id": 49027034, "comment_id": 85062499, "body": "But the item_id is not getting in the ItemsModifierGroupItem table"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1519819684, "post_id": 49027034, "comment_id": 85062573, "body": "it will automatically save item_id with nested attributes as you have association belongs_to and has_many"}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1519819869, "post_id": 49027034, "comment_id": 85062686, "body": "Yes normally this was happening but here INSERT INTO &quot;items_modifier_group_items&quot; (&quot;created_at&quot;, &quot;item_id&quot;, &quot;items_modifier_group_id&quot;, &quot;pre_select&quot;, &quot;sequence_no&quot;, &quot;updated_at&quot;) VALUES ($1, $2, $3, $4, $5, $6) RETURNING &quot;id&quot;  [[&quot;created_at&quot;, Wed, 28 Feb 2018 15:44:27 GST +04:00], [&quot;item_id&quot;, nil], [&quot;items_modifier_group_id&quot;, 35], [&quot;pre_select&quot;, true], [&quot;sequence_no&quot;, 0], [&quot;updated_at&quot;, Wed, 28 Feb 2018 15:44:27 GST +04:00]] item_id is nil"}, {"owner": {"reputation": 537, "user_id": 4289112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spCU9.jpg?s=128&g=1", "display_name": "Mirv - Matt", "link": "https://stackoverflow.com/users/4289112/mirv-matt"}, "edited": false, "score": 0, "creation_date": 1519845981, "post_id": 49027034, "comment_id": 85079217, "body": "Show us your controller, you might have setup the branching relationship calls wrong."}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "edited": false, "score": 0, "creation_date": 1519846947, "post_id": 49027034, "comment_id": 85079704, "body": "All that i have mentioned in the model here"}, {"owner": {"reputation": 537, "user_id": 4289112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/spCU9.jpg?s=128&g=1", "display_name": "Mirv - Matt", "link": "https://stackoverflow.com/users/4289112/mirv-matt"}, "edited": false, "score": 0, "creation_date": 1519851925, "post_id": 49027034, "comment_id": 85082269, "body": "Then that&#39;s the answer, if all you have is what you posted there, you&#39;re missing a rails controller to direct the app."}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "edited": false, "score": 0, "creation_date": 1519881889, "post_id": 49027034, "comment_id": 85091278, "body": "But it should work when we do it through console right?"}], "owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519882864, "creation_date": 1519812992, "last_edit_date": 1519882864, "question_id": 49027034, "link": "https://stackoverflow.com/questions/49027034/create-data-with-multiple-nested-attributes-in-rails", "title": "Create data with multiple nested attributes in rails", "body": "<p>I am trying to create an <code>item</code> with nested attributes, these are my tables:</p>\n\n<p><strong>Item</strong></p>\n\n<pre><code>has_many :items_modifier_groups, dependent: :destroy\nhas_many :items_modifier_group_items, dependent: :destroy\n\nattr_accessible :items_modifier_groups_attributes, :items_modifier_group_items_attributes\naccepts_nested_attributes_for :items_modifier_groups, :items_modifier_group_items\n</code></pre>\n\n<p><strong>ModifierGroup</strong></p>\n\n<pre><code>attr_accessible: tag_id\n</code></pre>\n\n<p><strong>ItemsModifierGroup</strong></p>\n\n<pre><code>belongs_to :modifier_group\nbelongs_to :item\nhas_many :items_modifier_group_items, dependent: :destroy\n\nattr_accessible :item_id, :modifier_group_id, :modifier_group_attributes, :items_modifier_group_items_attributes\naccepts_nested_attributes_for :modifier_group, :items_modifier_group_items\n</code></pre>\n\n<p><strong>ItemsModifierGroupItem - Table4</strong></p>\n\n<pre><code>belongs_to :items_modifier_group\nbelongs_to :item\n\nattr_accessible :items_modifier_group_id, :item_id, :pre_select\n</code></pre>\n\n<p>Params to create from console:</p>\n\n<pre><code>c = Item.new(\n  \"name\" =&gt; \"test1\", \"items_modifier_groups_attributes\"=&gt; { \n    \"0\"=&gt; { \n      \"items_modifier_group_items_attributes\"=&gt; {\n        \"0\"=&gt; {\n          \"pre_select\"=&gt;\"true\"\n        }\n      }, \n      \"min_item\"=&gt;\"1\", \n      \"modifier_group_attributes\"=&gt; { \n        \"tag_id\"=&gt; \"5\" \n      }\n    }\n  }\n)\n\nc.save\n\nINSERT INTO \"items_modifier_group_items\" (\"created_at\", \"item_id\", \"items_modifier_group_id\", \"pre_select\", \"sequence_no\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"created_at\", Wed, 28 Feb 2018 15:44:27 GST +04:00], [\"item_id\", nil], [\"items_modifier_group_id\", 35], [\"pre_select\", true], [\"sequence_no\", 0], [\"updated_at\", Wed, 28 Feb 2018 15:44:27 GST +04:00]\n</code></pre>\n\n<p>When it creates an item from <strong>CONSOLE</strong>, the <code>item_id</code> is <code>nil</code> in <code>ItemsModifierGroupItem</code> table; however, <code>item_id</code> is created in <code>ItemsModifierGroup</code> table. </p>\n\n<p>Am I missing anything in the params?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "installation"], "comments": [{"owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1519811307, "post_id": 49026377, "comment_id": 85057455, "body": "Port 53 is DNS. Do normal DNS lookups work for you? Are you running some kind of (personal) firewall that might be blocking DNS lookups from unknown applications?"}, {"owner": {"reputation": 71, "user_id": 9365927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KVebDvqKpK8/AAAAAAAAAAI/AAAAAAAAAKU/4Siu8WFM-UU/photo.jpg?sz=128", "display_name": "Gerald Matthew Concepcion", "link": "https://stackoverflow.com/users/9365927/gerald-matthew-concepcion"}, "reply_to_user": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1519832070, "post_id": 49026377, "comment_id": 85071003, "body": "I tried uninstalling my anti-virus. didn&#39;t work tho :/"}, {"owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1519890505, "post_id": 49026377, "comment_id": 85094374, "body": "Have you checked whether DNS lookups work? Have you tried more verbose settings, e.g. <code>gem install -V --debug bundler</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9365927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KVebDvqKpK8/AAAAAAAAAAI/AAAAAAAAAKU/4Siu8WFM-UU/photo.jpg?sz=128", "display_name": "Gerald Matthew Concepcion", "link": "https://stackoverflow.com/users/9365927/gerald-matthew-concepcion"}, "edited": false, "score": 0, "creation_date": 1520137886, "post_id": 49087756, "comment_id": 85189222, "body": "I&#39;m on windows 10, so is their an equivalent to solution for that?"}, {"owner": {"reputation": 1009, "user_id": 851170, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91849b553c2c0c05e4decc50a70ecffc?s=128&d=identicon&r=PG", "display_name": "Dave Collins", "link": "https://stackoverflow.com/users/851170/dave-collins"}, "reply_to_user": {"reputation": 71, "user_id": 9365927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KVebDvqKpK8/AAAAAAAAAAI/AAAAAAAAAKU/4Siu8WFM-UU/photo.jpg?sz=128", "display_name": "Gerald Matthew Concepcion", "link": "https://stackoverflow.com/users/9365927/gerald-matthew-concepcion"}, "edited": false, "score": 0, "creation_date": 1520254064, "post_id": 49087756, "comment_id": 85226712, "body": "The underlying problem is likely the same - your PC is not answering DNS requests.  Things to try: A) Double check all of your network settins - especially gateway.  B) Ensure that your local firewall/antivirus is NOT blocking port 53.  From Googling it appears netstat does work on windows.  C) search on &quot;Windows 10 not responding to DNS requests&quot; and try some of those solutions.  Hope that helps"}], "tags": [], "owner": {"reputation": 1009, "user_id": 851170, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91849b553c2c0c05e4decc50a70ecffc?s=128&d=identicon&r=PG", "display_name": "Dave Collins", "link": "https://stackoverflow.com/users/851170/dave-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1520102101, "creation_date": 1520102101, "answer_id": 49087756, "question_id": 49026377, "link": "https://stackoverflow.com/questions/49026377/ruby-on-rails-installation-error-port-53/49087756#49087756", "title": "Ruby on Rails Installation Error port 53", "body": "<p>@frank-schmitt has the correct answer here.  I was running into this exact problem.  the --debug made it clear that nothing was listening on DNS port 53.  Confirmed with:</p>\n\n<p><code>\nnetstat -an | grep \"LISTEN \"\n</code></p>\n\n<p>Installing <strong>bind</strong> (DNS Server) on Ubuntu 16.04 resolved this issue.</p>\n"}], "owner": {"reputation": 71, "user_id": 9365927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KVebDvqKpK8/AAAAAAAAAAI/AAAAAAAAAKU/4Siu8WFM-UU/photo.jpg?sz=128", "display_name": "Gerald Matthew Concepcion", "link": "https://stackoverflow.com/users/9365927/gerald-matthew-concepcion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520102101, "creation_date": 1519811035, "question_id": 49026377, "link": "https://stackoverflow.com/questions/49026377/ruby-on-rails-installation-error-port-53", "title": "Ruby on Rails Installation Error port 53", "body": "<p>Need some help trying to install bundler for ruby on rails. When I enter gem install bundler this is the error that occurs. Thanks in advance!</p>\n\n<pre><code>C:\\Sites&gt;gem install bundler ERROR:  While executing gem ... (Errno::EACCES)\nPermission denied - sendto(2) for \"255.255.255.255\" port 53\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1519807160, "post_id": 49025087, "comment_id": 85054969, "body": "Maybe a duplicate: <a href=\"https://stackoverflow.com/questions/27589399/add-nullable-foreign-key-in-rails\" title=\"add nullable foreign key in rails\">stackoverflow.com/questions/27589399/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1519812445, "post_id": 49025209, "comment_id": 85058233, "body": "See: <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to-label-Options\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveRecord/Associations/&hellip;</a>"}], "tags": [], "owner": {"reputation": 83, "user_id": 4096100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eccfc12ef297429782b81bee1f1624ac?s=128&d=identicon&r=PG&f=1", "display_name": "rubynuby", "link": "https://stackoverflow.com/users/4096100/rubynuby"}, "is_accepted": true, "score": 5, "last_activity_date": 1519807148, "creation_date": 1519807148, "answer_id": 49025209, "question_id": 49025087, "link": "https://stackoverflow.com/questions/49025087/ruby-on-rails-5-setting-has-one-child-to-nil-fails-in-console/49025209#49025209", "title": "Ruby on Rails 5 setting has_one child to nil fails in console", "body": "<p>Since rails 5, the behaviour of belongs_to association has changed.\nIt checks if the associated record persists, if not - throws an error.</p>\n\n<p>If you want to keep page object without association you should add\nbelongs_to :subject, <strong>optional: true</strong></p>\n"}], "owner": {"reputation": 63, "user_id": 8216916, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YeDqUQMqn14/AAAAAAAAAAI/AAAAAAAABiQ/sWX_UbK2J7s/photo.jpg?sz=128", "display_name": "Stephen Pon", "link": "https://stackoverflow.com/users/8216916/stephen-pon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1248, "favorite_count": 0, "accepted_answer_id": 49025209, "answer_count": 1, "score": 2, "last_activity_date": 1519807148, "creation_date": 1519806669, "question_id": 49025087, "link": "https://stackoverflow.com/questions/49025087/ruby-on-rails-5-setting-has-one-child-to-nil-fails-in-console", "title": "Ruby on Rails 5 setting has_one child to nil fails in console", "body": "<p>I'm currently working through the Ruby on Rails Essentials 5 training course on Lynda, and in the section on one-to-one associations, I create a \"Subject\" that has_one \"Page.\" Each model looks like the following:</p>\n\n<pre><code>class Subject &lt; ApplicationRecord\n\n    has_one :page\n\n    scope :visible, lambda {where(:visible =&gt; true)}\n    scope :invisible, lambda {where(:visible =&gt; false)}\n    scope :sorted, lambda {order(\"position ASC\")}\n    scope :newest_first, lambda {order(\"created_at DESC\")}\n    scope :search, lambda {|query| where([\"name LIKE ?\", \"%#{query}%\"])}\n\nend\n</code></pre>\n\n<p>/////</p>\n\n<pre><code>class Page &lt; ApplicationRecord\n\n    belongs_to :subject\n\nend\n</code></pre>\n\n<p>In the db, I have an existing Subject that I find by id and save to a variable. Then I create a new Page object (but not save it), and finally, I persist it by doing subject.page = page. The issue is, when I try to remove the association using subject.page = nil, I end up with the following error:</p>\n\n<pre><code>irb(main):004:0&gt; subject.page = nil\n   (0.3ms)  BEGIN\n   (0.2ms)  ROLLBACK\nActiveRecord::RecordNotSaved: Failed to remove the existing associated \npage. The record failed to save after its foreign key was set to nil.\n    from (irb):4\n</code></pre>\n\n<p>I believe the expected behavior is for the page record to have its foreign key reassigned to NULL. This behavior is reflected in the tutorial I'm using, and in other posts about the subject. What am I missing here?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "callback", "nested-attributes", "cocoon-gem"], "comments": [{"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1519896609, "post_id": 49024017, "comment_id": 85097495, "body": "Your code is a little confusing: you are manipulating what seems like the attributes hash in a model??? So either you manipulate the attributes hash, and do it in the controller, either you add a callback on the model and fix the model. Not sure why you want to change the <code>_destroy</code> flag? That should just work. What I see: You are trying to fix the received date-format, and this should best be done in the controller (or even better: the view --make sure the date are sent to the controller in the correct/expected format?)"}, {"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "reply_to_user": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1519896793, "post_id": 49024017, "comment_id": 85097606, "body": "@nathanvda, I did the changes in a helper. So, the issue is resolved. Thanks, anyway"}], "answers": [{"comments": [{"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1519804118, "post_id": 49024251, "comment_id": 85053406, "body": "I&#39;ve tried with <code>before_save</code> in SiteVisit object. It is not working. I don&#39;t want to do that in controller."}], "tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1519803888, "last_edit_date": 1519803888, "creation_date": 1519803498, "answer_id": 49024251, "question_id": 49024017, "link": "https://stackoverflow.com/questions/49024017/nested-attributes-change-value-before-save-with-cocoon/49024251#49024251", "title": "nested attributes change value before save with cocoon", "body": "<p><code>site_visits_attributes</code> is not a method on the Project object.  If you remove <code>rescue StandardError</code> you'll catch this issue.</p>\n\n<p>It is probably a better idea to modify the data in a <code>before_filter</code> in your controller.  Or alternatively, you could modify the data on <code>before_save</code> on the SiteVisit objects.</p>\n"}], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 49024251, "answer_count": 1, "score": 0, "last_activity_date": 1519803888, "creation_date": 1519802514, "question_id": 49024017, "link": "https://stackoverflow.com/questions/49024017/nested-attributes-change-value-before-save-with-cocoon", "title": "nested attributes change value before save with cocoon", "body": "<p>I have a <strong>project</strong> model:</p>\n\n<pre><code>class Project &lt; ApplicationRecord\n   has_many  :site_visits, inverse_of: :project, dependent: :destroy\n\n   accepts_nested_attributes_for :site_visits, allow_destroy: true, reject_if: :all_blank\n\n   before_save: :convert_site_visit_dates\n\n   def convert_site_visit_dates\n     begin\n       if self.site_visits_attributes.present?\n         self.site_visits_attributes.each do |site_visit|\n            site_visit[1]['visit_date'] = convert_date(site_visit[1]['visit_date']) if site_visit[1]['visit_date'].present?\n            site_visit[1]['_destroy'] = true if site_visit[1]['_destroy'] == \"1\"\n         end\n       end\n     rescue StandardError\n       nil\n     end\n   end \n\nend\n</code></pre>\n\n<p>I have <strong>site_visit</strong> model: (columns - <code>visit_date</code>)</p>\n\n<pre><code>class SiteVisit &lt; ApplicationRecord\n\n  belongs_to  :project\n\nend\n</code></pre>\n\n<p>Before saving the <strong>site_visits</strong> in any particular project through <a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow noreferrer\">cocoon gem</a> I need to change the value of the <code>site_visits_attributes</code> using a callback. In my project model you can see I've defined a callback to change the <code>visit_date</code> column of <code>site_visit</code> table. But the value is not changing. Thus, in the database null values are being saved. </p>\n\n<p>Any idea what's wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "post"], "comments": [{"owner": {"reputation": 1521, "user_id": 7177640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21ab719e4dfae3533a20da4f52e5c9e7?s=128&d=identicon&r=PG", "display_name": "nattfodd", "link": "https://stackoverflow.com/users/7177640/nattfodd"}, "edited": false, "score": 0, "creation_date": 1519804876, "post_id": 49024004, "comment_id": 85053773, "body": "<code>&#47;edit</code> is a GET action - it displays editing form. You probably messed it up with <code>&#47;update</code> which is PUT."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1519812958, "post_id": 49024004, "comment_id": 85058563, "body": "Replace <code>:todo</code> in the edit view with <code>@todo</code>. Rails doesn&#39;t understand what you are trying to do when you provide a symbol. If you don&#39;t provide an url, than it&#39;s going to post to the current url you&#39;re on. However by providing an object it can check if it&#39;s a <i>new_record?</i> or not and it can check what the object type is to figure out the url."}], "answers": [{"tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": true, "score": 1, "last_activity_date": 1558273237, "last_edit_date": 1558273237, "creation_date": 1519804853, "answer_id": 49024603, "question_id": 49024004, "link": "https://stackoverflow.com/questions/49024004/no-route-matches-post-projects-16-todos-35-edit/49024603#49024603", "title": "No route matches [POST] &quot;/projects/16/todos/35/edit&quot;", "body": "<p>As you can see from here, the request fired is <strong>POST</strong> request, instead it should be a <strong>GET</strong> request</p>\n\n<blockquote>\n  <p>Receiving this error No route matches [POST]\n  \"/projects/16/todos/35/edit\"</p>\n</blockquote>\n\n<p>Make sure to fire <strong>GET request</strong> when you click on <strong>Edit TODO</strong>. </p>\n\n<p>Defined routes with </p>\n\n<pre><code>resources :projects do\n    resources :todos\nend\n</code></pre>\n\n<p>are </p>\n\n<pre><code> project_todos GET    /projects/:project_id/todos(.:format)          todos#index\n                  POST   /projects/:project_id/todos(.:format)          todos#create\n new_project_todo GET    /projects/:project_id/todos/new(.:format)      todos#new\nedit_project_todo GET    /projects/:project_id/todos/:id/edit(.:format) todos#edit\n     project_todo GET    /projects/:project_id/todos/:id(.:format)      todos#show\n                  PUT    /projects/:project_id/todos/:id(.:format)      todos#update\n                  DELETE /projects/:project_id/todos/:id(.:format)      todos#destroy\n</code></pre>\n\n<p>So you can make use of rails view helper <strong>edit_project_todo(project, todo)</strong> in <strong>link_to</strong> for <strong>Edit TODO</strong> to fire GET request.</p>\n"}, {"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1519821195, "last_edit_date": 1519821195, "creation_date": 1519820742, "answer_id": 49029570, "question_id": 49024004, "link": "https://stackoverflow.com/questions/49024004/no-route-matches-post-projects-16-todos-35-edit/49029570#49029570", "title": "No route matches [POST] &quot;/projects/16/todos/35/edit&quot;", "body": "<p>in your edit.html.erb</p>\n\n<pre><code>&lt;h1&gt;Edit Task&lt;/h1&gt;\n\n&lt;%= form_for @todo, :url =&gt; project_todo_path(@project,@todo), :html =&gt; { class: \"your_class\", :method =&gt; \"put\" } do |form| %&gt;\n  &lt;p&gt;\n    &lt;%= form.label :body %&gt;&lt;br&gt;\n    &lt;%= form.text_field :body %&gt;\n  &lt;/p&gt;\n\n  &lt;div&gt;\n    &lt;%= form.submit%&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note: - <code>form_for</code> is used for any object and and here your object is <code>@todo</code> not <code>todo</code> and by default <code>form_for</code> hits <code>create</code> action if <code>@todo</code> is of new and if <code>@todo</code> is existing record then it will hit update action, here explicitly you can provide <code>url</code> to which action is will hit after submitting form . so here i have manually provided action of update and also provided <code>method: :put</code> because by default <code>form</code> is of <code>POST</code> type request.\nhopefully it will clear you doubts.</p>\n"}], "owner": {"reputation": 21, "user_id": 5912962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ef76b0dc403059e38cb36d651ff8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Shelalegen", "link": "https://stackoverflow.com/users/5912962/shelalegen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 49024603, "answer_count": 2, "score": 0, "last_activity_date": 1558273237, "creation_date": 1519802476, "last_edit_date": 1519806531, "question_id": 49024004, "link": "https://stackoverflow.com/questions/49024004/no-route-matches-post-projects-16-todos-35-edit", "title": "No route matches [POST] &quot;/projects/16/todos/35/edit&quot;", "body": "<p>I am Receiving this error  </p>\n\n<blockquote>\n  <p>No route matches [POST] \"/projects/16/todos/35/edit\"</p>\n</blockquote>\n\n<p>I understand that I don't have to put a method for that, but how can I add it</p>\n\n<p>This is <strong>routes.rd</strong></p>\n\n<pre><code>Rails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  get 'projects/index'\n  post 'projects/new'\n\n  resources :projects do\n    resources :todos\nend\n  root 'projects#index'\nend\n</code></pre>\n\n<p>This is <strong>edit.html.erb</strong> (for a task)</p>\n\n<pre><code>&lt;h1&gt;Edit Task&lt;/h1&gt;\n\n&lt;%= form_for :todo, local: true do |form| %&gt;\n  &lt;p&gt;\n\n    &lt;%= form.label :body %&gt;&lt;br&gt;\n    &lt;%= form.text_field :body %&gt;\n  &lt;/p&gt;\n\n  &lt;div&gt;\n&lt;%= form.submit%&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is <strong>todos_controller.rb</strong></p>\n\n<pre><code>class TodosController &lt; ApplicationController\n\n  def new\n    @project = Project.find(params[:project_id])\n  end\n\n  def create\n    @project = Project.find(params[:project_id])\n    @todo = @project.todos.create(todos_params)\n    redirect_to projects_path\n  end\n\n  def edit\n    @project = Project.find(params[:project_id])\n    @todo = @project.todos.find(params[:id])\n  end\n\n  def update\n    @project = Project.find(params[:project_id])\n    @todo = @project.todos.find(params[:id])\n    @todo.save\n  end\n\ndef destroy\n  @project = Project.find(params[:project_id])\n  @todo = @project.todos.find(params[:id])\n  @todo.destroy\n  redirect_to projects_path\nend\n\n  private\n    def todos_params\n      params.require(:todo).permit(:body)\n    end\nend\n</code></pre>\n\n<p>Please help to fix this problem</p>\n"}, {"tags": ["jquery", "ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "edited": false, "score": 0, "creation_date": 1519802741, "post_id": 49024018, "comment_id": 85052766, "body": "thank you but now I get this error UnknownFormat (UsersController#show is missing a template for this request format and variant.  @fool-dev"}, {"owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "edited": false, "score": 0, "creation_date": 1519802808, "post_id": 49024018, "comment_id": 85052802, "body": "The full error message is == UsersController#show is missing a template for this request format and variant. request.formats: [&quot;text/html&quot;] request.variant: [] NOTE! For XHR/Ajax or API requests, this action would normally respond with 204 No Content: an empty white screen. Since you&#39;re loading it in a web browser, we assume that you expected to actually render a template, not nothing, so we&#39;re showing an error to be extra-clear. If you expect 204 No Content, carry on. That&#39;s what you&#39;ll get from an XHR or API request. Give it a shot."}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519802871, "post_id": 49024018, "comment_id": 85052845, "body": "rename your HTML file` your_list.html.erb`  to <code>show.html.erb</code>"}, {"owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "edited": false, "score": 0, "creation_date": 1519802961, "post_id": 49024018, "comment_id": 85052886, "body": "It seems to miss <code>show</code> template, create or rename the file to <code>show.html.erb</code> inside the users folder"}], "tags": [], "owner": {"reputation": 6942, "user_id": 4172515, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/BYWxd.jpg?s=128&g=1", "display_name": "fool-dev", "link": "https://stackoverflow.com/users/4172515/fool-dev"}, "is_accepted": true, "score": 0, "last_activity_date": 1519804730, "last_edit_date": 1519804730, "creation_date": 1519802515, "answer_id": 49024018, "question_id": 49023985, "link": "https://stackoverflow.com/questions/49023985/actionnotfound-the-action-show-could-not-be-found-for-userscontroller-ruby/49024018#49024018", "title": "ActionNotFound (The action &#39;show&#39; could not be found for UsersController): ruby on rails", "body": "<p>Right the typo it should <code>show</code> instead of <code>shown</code></p>\n\n<pre><code>def show\n  @user = User.find(params[:id])\n  @items = @user.items\nend\n</code></pre>\n\n<p>Create <code>show</code> template to your <code>users</code> folder like <code>show.html.erb</code></p>\n"}, {"tags": [], "owner": {"reputation": 3048, "user_id": 2374626, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Z78U0.jpg?s=128&g=1", "display_name": "Satishakumar Awati", "link": "https://stackoverflow.com/users/2374626/satishakumar-awati"}, "is_accepted": false, "score": 0, "last_activity_date": 1519803906, "creation_date": 1519803906, "answer_id": 49024362, "question_id": 49023985, "link": "https://stackoverflow.com/questions/49023985/actionnotfound-the-action-show-could-not-be-found-for-userscontroller-ruby/49024362#49024362", "title": "ActionNotFound (The action &#39;show&#39; could not be found for UsersController): ruby on rails", "body": "<p>Make sure to recheck <strong>routes.rb</strong> for routes entry like </p>\n\n<pre><code>resources :users\n</code></pre>\n\n<p>and controller rename action name <strong>shown</strong> to <strong>show</strong> and render the respective <strong>your_list.html.erb</strong> file</p>\n\n<pre><code>def show\n  @user = User.find(params[:id])\n  @items = @user.items\n  render :template =&gt; 'products/your_list'\nend\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 49024018, "answer_count": 2, "score": 0, "last_activity_date": 1519804730, "creation_date": 1519802415, "last_edit_date": 1519802658, "question_id": 49023985, "link": "https://stackoverflow.com/questions/49023985/actionnotfound-the-action-show-could-not-be-found-for-userscontroller-ruby", "title": "ActionNotFound (The action &#39;show&#39; could not be found for UsersController): ruby on rails", "body": "<p>Everytime I click on the user name I get this error (The action 'show' could not be found for UsersController in this your_list.html.erb)</p>\n\n<p>This is your_list.html.erb</p>\n\n<pre><code>&lt;span class=\"pull-right text-center\"&gt;\n  &lt;%= image_tag avatar_url(list.item.user), class: \"img-circle \n             avatar-medium\" %&gt;&lt;/br&gt;\n   &lt;%= link_to user_path(list.item.user) do %&gt;\n                &lt;%= list.item.user.fullname %&gt;\n   &lt;% end %&gt;\n&lt;/span&gt;\n</code></pre>\n\n<p>This is my user Controller</p>\n\n<pre><code> class UsersController &lt; ApplicationController\n    def shown\n    @user = User.find(params[:id])\n    @items = @user.items\n   end\n end\n</code></pre>\n\n<p>This Image of my command line when I click on the button</p>\n\n<p><a href=\"https://i.stack.imgur.com/9qDcw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9qDcw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby", "datetime", "time", "gnuplot"], "comments": [{"owner": {"reputation": 44000, "user_id": 2604213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7ThK.png?s=128&g=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/2604213/christoph"}, "edited": false, "score": 0, "creation_date": 1519843224, "post_id": 49023963, "comment_id": 85077732, "body": "Couldn&#39;t try the code, but you have a typo in <code>xange</code> ( must be <code>xrange</code>), and the xrange must be given in the same format that you use as <code>timefmt</code>"}, {"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "reply_to_user": {"reputation": 44000, "user_id": 2604213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7ThK.png?s=128&g=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/2604213/christoph"}, "edited": false, "score": 0, "creation_date": 1519862594, "post_id": 49023963, "comment_id": 85086628, "body": "Thx a lot. The typo was a copy paste error :/"}, {"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "reply_to_user": {"reputation": 44000, "user_id": 2604213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7ThK.png?s=128&g=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/2604213/christoph"}, "edited": false, "score": 0, "creation_date": 1519866215, "post_id": 49023963, "comment_id": 85087499, "body": "I have edited my example above to keep it even simpler."}, {"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "reply_to_user": {"reputation": 44000, "user_id": 2604213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7ThK.png?s=128&g=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/2604213/christoph"}, "edited": false, "score": 0, "creation_date": 1519867513, "post_id": 49023963, "comment_id": 85087770, "body": "<a href=\"http://i.imgur.com/GKmmXAo.png\" rel=\"nofollow noreferrer\">i.imgur.com/GKmmXAo.png</a>   ?   Even simpler but still failing ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "edited": false, "score": 0, "creation_date": 1519952528, "post_id": 49049420, "comment_id": 85127434, "body": "Thanks a lot @ewcz :)  Just need now to understand why only the first element of y is plotted against all the elements of x ...  (<a href=\"https://i.imgur.com/gKGvPvg.png\" rel=\"nofollow noreferrer\">i.imgur.com/gKGvPvg.png</a>)"}, {"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "edited": false, "score": 0, "creation_date": 1519953767, "post_id": 49049420, "comment_id": 85127793, "body": "Actually, it is not plotting the first element of y but the literal value 2 from the comand  using: &#39;1:2&#39;"}, {"owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "edited": false, "score": 0, "creation_date": 1519954297, "post_id": 49049420, "comment_id": 85127940, "body": "Got it :/ I had to reformat my time data timefmt: &quot;%Y-%m-%dT%H:%M:%S&quot;,  otherwise, gnuplot assume there is only one column."}], "tags": [], "owner": {"reputation": 11364, "user_id": 5351549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f5c11fbd301040b24865853a1d73c914?s=128&d=identicon&r=PG&f=1", "display_name": "ewcz", "link": "https://stackoverflow.com/users/5351549/ewcz"}, "is_accepted": false, "score": 1, "last_activity_date": 1519906017, "creation_date": 1519906017, "answer_id": 49049420, "question_id": 49023963, "link": "https://stackoverflow.com/questions/49023963/time-axis-formatting-in-ruby-gnuplot-gnuplotrb/49049420#49049420", "title": "Time Axis Formatting in Ruby/Gnuplot/ GnuplotRB", "body": "<p>From the <a href=\"https://github.com/dilcom/gnuplotrb#getting-started\" rel=\"nofollow noreferrer\">documentation</a>, it seems that one needs to pass the plot-specific settings to the <code>Plot.new</code> call:</p>\n\n<blockquote>\n  <p>Plot's options are explained in gnuplot doc (pp. 105-181). Plot\n  options are translated into gnuplot format the same way as Dataset's\n  (except adding 'set' before each option).</p>\n</blockquote>\n\n<p>thus:</p>\n\n<pre><code>element = Dataset.new(\n  [x, y],\n  with: 'lines lw 3 lt rgb \"black\"',\n  using: '1:2'\n)\n\nmyBRTraces = Plot.new(\n  element,\n  timefmt: \"%Y-%m-%d %H:%M:%S\",\n  xdata: 'time',\n  format_x:  \"%Y-%m-%d %H:%M:%S\",\n  xrange: '[ \"2013-05-22 02:49:00\" : \"2013-05-22 02:50:00\" ]',\n  yrange: '[0:10]'\n)\n</code></pre>\n\n<p>Otherwise, <code>gnuplotrb</code> tries to assemble all options passed to <code>Dataset.new</code> in a single <code>plot</code> command (as can be seen in the error message you posted) which then fails:</p>\n\n<pre><code>plot $DATA1 with lines lw 3 lt rgb \"black\" timefmt \"%Y-%m-%d %H:%M:%S\" xdata time format x \"%Y-%m-%d %H:%M:%S\" xrange [ \"2013-05-22 02:49:00\" : \"2013-05-22 02:50:00\" ];\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6733188, "user_type": "registered", "profile_image": "https://graph.facebook.com/913023982158207/picture?type=large", "display_name": "Peter Longfield", "link": "https://stackoverflow.com/users/6733188/peter-longfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519906017, "creation_date": 1519802328, "last_edit_date": 1519866677, "question_id": 49023963, "link": "https://stackoverflow.com/questions/49023963/time-axis-formatting-in-ruby-gnuplot-gnuplotrb", "title": "Time Axis Formatting in Ruby/Gnuplot/ GnuplotRB", "body": "<p>Pulling my hair for the last few hours. Using GnuplotRB. Trying to plot some time series, and whatever formatting and xrange options I try to use, the X-axis always display 1990 to 2035 (where does this come from??)</p>\n\n<p>Example below with similar data  </p>\n\n<pre><code>require 'gnuplotrb'\ninclude GnuplotRB\n\nx = [\"2013-05-22 02:49:49\",    \"2013-05-22 02:56:49\", \"2013-05-22 02:56:59\"]\ny = [ 2,5,9]\n\np x.first\np x.last\n\nelement = Dataset.new(\n  [x, y], \n  with:'lines lw 3 lt rgb \"black\"', \n  timefmt: \"%Y-%m-%d %H:%M:%S\",\n  xdata: 'time',\n  format_x:  \"%Y-%m-%d %H:%M:%S\",\n#  xrange: '[ \"#{x.first}\":\"#{x.last}\" ]'\n  xrange: '[ \"2013-05-22 02:49:00\" : \"2013-05-22 02:50:00\" ]'\n  )\n\nmyBRTraces = Plot.new(\n  element\n   )\n\np myBRTraces.inspect\nmyBRTraces.to_png(\"/media/sf_D_DRIVE/Test/a.svg\", size: [1200, 1800], truecolor:true)\n</code></pre>\n\n<p>[Edit] - simplified code further.</p>\n\n<p>I have also done <a href=\"https://github.com/SciRuby/gnuplotrb/issues/14\" rel=\"nofollow noreferrer\">this tweak</a> to actually get some error logging from gnuplot. And I helps indeed pinpointing that xrange is a b*** but I still don't get how to make it work :</p>\n\n<pre><code>$  ruby test.rb \n\"2013-05-22 02:49:49\"\n\"2013-05-22 02:56:59\"\n \"#&lt;GnuplotRB::Plot:0x00000001ba21f0 @options=Hamster::Hash[], @datasets=Hamster::Vector[#&lt;GnuplotRB::Dataset:0x00000001ba2100 @type=:datablock, @data=#&lt;GnuplotRB::Datablock:0x00000001ba1f70 @stored_in_file=false, @data=\\\"2013-05-22 02:49:49 2\\\\n2013-05-22 02:56:49 5\\\\n2013-05-22 02:56:59 9\\\"&gt;, @options=Hamster::Hash[:with =&gt; \\\"lines lw 3 lt rgb \\\\\\\"black\\\\\\\"\\\", :timefmt =&gt; \\\"%Y-%m-%d %H:%M:%S\\\", :xdata =&gt; \\\"time\\\", :format_x =&gt; \\\"%Y-%m-%d %H:%M:%S\\\", :xrange =&gt; \\\"[ \\\\\\\"2013-05-22 02:49:00\\\\\\\" : \\\\\\\"2013-05-22 02:50:00\\\\\\\" ]\\\"]&gt;], @cmd=\\\"plot \\\"&gt;\"    \n/var/lib/gems/2.3.0/gems/gnuplotrb-0.4.0/lib/gnuplotrb/mixins/error_handling.rb:28:in `check_errors': Error in previous command (\"Warning: empty x range [2013:2013], adjusting to [1992.87:2033.13]\"): \"Warning: empty y range [2:2], adjusting to [1.98:2.02]; gnuplot&gt; plot $DATA1 with lines lw 3 lt rgb \"black\" timefmt \"%Y-%m-%d %H:%M:%S\" xdata time format x \"%Y-%m-%d %H:%M:%S\" xrange [ \"2013-05-22 02:49:00\" : \"2013-05-22 02:50:00\" ]; line 4: unexpected or unrecognized token\" (GnuplotRB::GnuplotError)\nfrom /var/lib/gems/2.3.0/gems/gnuplotrb-0.4.0/lib/gnuplotrb/staff/terminal.rb:183:in `close'\nfrom /var/lib/gems/2.3.0/gems/gnuplotrb-0.4.0/lib/gnuplotrb/plot.rb:85:in `plot'\nfrom /var/lib/gems/2.3.0/gems/gnuplotrb-0.4.0/lib/gnuplotrb/mixins/plottable.rb:111:in `to_specific_term'\nfrom /var/lib/gems/2.3.0/gems/gnuplotrb-0.4.0/lib/gnuplotrb/mixins/plottable.rb:53:in `method_missing'\n</code></pre>\n\n<p>I don't get the \"Warning: empty x range [2013:2013]\"</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1519802220, "post_id": 49023903, "comment_id": 85052482, "body": "but methods with question mark may be passed as argument, arent they?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1519802311, "post_id": 49023903, "comment_id": 85052524, "body": "@marmeladze: &quot;methods&quot;? I don&#39;t think so. They&#39;re reduced to their value and that&#39;s what is passed. Of course, you can get a hold of a Method object, but at this point it doesn&#39;t have question marks either."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1519802389, "post_id": 49023903, "comment_id": 85052578, "body": "@marmeladze: example?"}, {"owner": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1519802875, "post_id": 49023903, "comment_id": 85052848, "body": "sorrry, i was mistaken. i first tought about sth like <code>&#39;foo&#39;.respond_to? :include?</code> but then realized this is not a method definition - just call -))"}, {"owner": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "reply_to_user": {"reputation": 5483, "user_id": 4481312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/teLso.jpg?s=128&g=1", "display_name": "marmeladze", "link": "https://stackoverflow.com/users/4481312/marmeladze"}, "edited": false, "score": 0, "creation_date": 1519803071, "post_id": 49023903, "comment_id": 85052932, "body": "As @marmeladze comments, we can use question marks as keyword arguments (not raise runtime errors), and can give a hash as keywords arguments like <code>hash = { arg?: true }</code> <code>foo(hash)</code> . I can understand there is a big difference as you say, but I&#39;m confused."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "edited": false, "score": 0, "creation_date": 1519803158, "post_id": 49023903, "comment_id": 85052974, "body": "@yushirota: your code clearly demonstrates that you <i>can&#39;t</i> use question marks in keyword arguments. So I&#39;m not sure what you mean. (To reiterate once again: kwargs != options hash)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519803345, "post_id": 49023903, "comment_id": 85053047, "body": "@SergioTulentsev one still can pass <code>hash = {arg?: true}</code> as double-splatted keyword argument: <code>def blah(**kw); puts kw; end; blah(**hash)</code>."}, {"owner": {"reputation": 6968, "user_id": 5490505, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-6-yKyG1ZZUI/AAAAAAAAAAI/AAAAAAAAABA/5a7UfitqO5Y/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/5490505/john"}, "reply_to_user": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "edited": false, "score": 1, "creation_date": 1519803355, "post_id": 49023903, "comment_id": 85053058, "body": "@yushirota in <code>&#39;foo&#39;.respond_to? :include?</code>, <code>:include?</code> is being passed as the value for the <code>respond_to?</code> method&#39;s argument. Symbol&#39;s can have question marks, and <code>:include?</code> is a symbol"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519803398, "post_id": 49023903, "comment_id": 85053080, "body": "@mudasobwa: aight, one can <i>pass</i>, but what good is it, if you can&#39;t <b>define</b> a method with a parameter named <code>arg?</code>. Your example with <code>**kwargs</code> is indistinguishable from options hash. Doesn&#39;t get any kwargs benefits. In fact, the only thing it adds is more complex syntax."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "edited": false, "score": 0, "creation_date": 1519803457, "post_id": 49023903, "comment_id": 85053103, "body": "@yushirota when you use a keyword param it gets converted to a variable. <code>arg?</code> can&#39;t be a variable because variables can&#39;t have question marks. It can be a string, symbol, or method name, but nothing else."}, {"owner": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "edited": false, "score": 0, "creation_date": 1519805594, "post_id": 49023903, "comment_id": 85054167, "body": "oh, I was mistaken. Just define a method has kwargs using <code>arg?</code> (with question marks), raised an method definition error. I assumed we can define kawrgs with question marks."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 5, "last_activity_date": 1519803339, "last_edit_date": 1519803339, "creation_date": 1519802117, "answer_id": 49023903, "question_id": 49023810, "link": "https://stackoverflow.com/questions/49023810/how-to-use-an-argument-with-question-mark-in-methods-have-keyword-arguments/49023903#49023903", "title": "How to use an argument with question mark in methods have keyword arguments", "body": "<p>You can't do that. Parameter names can't have question or exclamation marks. Only method names can have them.</p>\n\n<p>As John mentions, you should be able to use the good old options hash. Although, in this case <code>foo(arg?: true)</code>, <code>arg?: true</code> is a key-value pair in a hash, not a keyword argument. Big difference (with options hash, you don't get effortless required parameters and typo protection, for example).</p>\n"}, {"tags": [], "owner": {"reputation": 6968, "user_id": 5490505, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-6-yKyG1ZZUI/AAAAAAAAAAI/AAAAAAAAABA/5a7UfitqO5Y/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/5490505/john"}, "is_accepted": true, "score": 4, "last_activity_date": 1519803041, "last_edit_date": 1519803041, "creation_date": 1519802186, "answer_id": 49023925, "question_id": 49023810, "link": "https://stackoverflow.com/questions/49023810/how-to-use-an-argument-with-question-mark-in-methods-have-keyword-arguments/49023925#49023925", "title": "How to use an argument with question mark in methods have keyword arguments", "body": "<h2>Update</h2>\n\n<p>Just confirmed it, you can do <code>foo(arg?: true)</code></p>\n\n<p><strong>Original:</strong></p>\n\n<p>I'm not sure that you can have a \"?\" in a kwarg. You could try making the method have one input arg which is a hash, and then I think you could do</p>\n\n<pre><code>def foo(arg)\n  p arg[:\"arg?\"]\nend\n\nfoo(:\"arg?\" =&gt; true)\n</code></pre>\n\n<p>The quotes <em>may</em> not be necessary, I'd have to open up the console to check. In which case:</p>\n\n<pre><code>foo(arg?: true)\n</code></pre>\n\n<h2>Update 2</h2>\n\n<p>Sergio has rightly called out the fact that I'm <em>not</em> using a key word argument (kwarg) in this solution, instead I'm passing a single, regular argument which <em>I know</em> needs to be a hash with a <code>:arg?</code> key. This is commonly referred to as an options hash. This is what people did before the ruby language added support for kwargs (or so I'm told :).</p>\n"}], "owner": {"reputation": 127, "user_id": 9087235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb6088c0eecf26e491cda14de138e26?s=128&d=identicon&r=PG&f=1", "display_name": "yu shirota", "link": "https://stackoverflow.com/users/9087235/yu-shirota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 49023925, "answer_count": 2, "score": 3, "last_activity_date": 1519803339, "creation_date": 1519801703, "question_id": 49023810, "link": "https://stackoverflow.com/questions/49023810/how-to-use-an-argument-with-question-mark-in-methods-have-keyword-arguments", "title": "How to use an argument with question mark in methods have keyword arguments", "body": "<p>How to use an argument with question mark in methods have keyword arguments?</p>\n\n<pre><code>def foo(arg?:)\n  p arg? # ERROR\nend\n\nfoo(arg?: true)\n</code></pre>\n"}, {"tags": ["ruby", "coding-style", "dry", "code-cleanup"], "answers": [{"tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1519803886, "creation_date": 1519803886, "answer_id": 49024357, "question_id": 49023613, "link": "https://stackoverflow.com/questions/49023613/rewrite-stateful-code-to-be-more-dry/49024357#49024357", "title": "Rewrite stateful code to be more DRY", "body": "<p>Your <code>else</code> branches are redundant.</p>\n\n<pre><code>def process\n  response = ServiceResponse.new(false, [])\n  project_path = import_project\n  if project_path.blank?\n    return\n  end\n\n  response.data &lt;&lt; Step.new('import', true, \"Project imported\")\n  send_realtime_data(response)    \n  hr_config, hr_config_error = fetch_hr_config(project_path)\n  weighted_scores_config, ws_error = fetch_weighted_scores(project_path)\n  if hr_config.blank?\n    response.data &lt;&lt; Step.new('.hr_config.yml', false, hr_config_error || \"Empty configuration file\")\n    return response\n  end\n\n  response.data &lt;&lt; Step.new('.hr_config.yml', true, 'Configuration file found')\n  send_realtime_data(response)\n  if weighted_scores_config.blank? &amp;&amp; ws_error.present?\n    response.data &lt;&lt; Step.new('.hr_weighted_scores.yml', false, ws_error)\n    return response\n  end\n\n  response.data &lt;&lt; Step.new('.hr_weighted_scores.yml', true, \"Weighted scoring config found\")\n  send_realtime_data(response)\n  configuration = ::X::FullStack::Configuration.new(\n    hr_config, {weighted_scores: weighted_scores_config}\n  )\n  unless configuration.valid?\n    response.data &lt;&lt; Step.new('validate_configuration', false, \"Configuration validation failed\", configuration.validations.as_json)\n    return response\n  end\n\n  response.data &lt;&lt; Step.new('validate_configuration', false, \"Configuration validated successfully\", configuration.validations.as_json)\n  send_realtime_data(response)\n\n  #....\nend\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 3339744, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f3575d3945f08493cead822d0c2b143?s=128&d=identicon&r=PG&f=1", "display_name": "shikhar.ja", "link": "https://stackoverflow.com/users/3339744/shikhar-ja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519803886, "creation_date": 1519800963, "question_id": 49023613, "link": "https://stackoverflow.com/questions/49023613/rewrite-stateful-code-to-be-more-dry", "title": "Rewrite stateful code to be more DRY", "body": "<p>I have this block of code wherein every next set of lines depends on the previous response and the set of steps must follow a fixed path making it slightly stateful.</p>\n\n<p>This is causing my method to grow in size and a lot of code repetition (even though the variables and data are different). How can I DRY-up this code?</p>\n\n<pre><code>def process\n  response = ServiceResponse.new(false, [])\n\n  # Step 1\n  project_path = import_project()\n\n  if project_path.present?\n    response.data &lt;&lt; Step.new('import', true, \"Project imported\")\n    send_realtime_data(response)\n\n    hr_config, hr_config_error = fetch_hr_config(project_path)\n    weighted_scores_config, ws_error = fetch_weighted_scores(project_path)\n\n    if hr_config.blank?\n      response.data &lt;&lt; Step.new('.hr_config.yml', false, hr_config_error || \"Empty configuration file\")\n      return response\n    else\n      response.data &lt;&lt; Step.new('.hr_config.yml', true, 'Configuration file found')\n      send_realtime_data(response)\n    end\n\n    if weighted_scores_config.blank? &amp;&amp; ws_error.present?\n      response.data &lt;&lt; Step.new('.hr_weighted_scores.yml', false, ws_error)\n      return response\n    else\n      response.data &lt;&lt; Step.new('.hr_weighted_scores.yml', true, \"Weighted scoring config found\")\n      send_realtime_data(response)\n    end\n\n    configuration = ::X::FullStack::Configuration.new(\n      hr_config, {weighted_scores: weighted_scores_config}\n    )\n\n    if !configuration.valid?\n      response.data &lt;&lt; Step.new('validate_configuration', false, \"Configuration validation failed\", configuration.validations.as_json)\n      return response\n    else\n      response.data &lt;&lt; Step.new('validate_configuration', false, \"Configuration validated successfully\", configuration.validations.as_json)\n      send_realtime_data(response)\n    end\n\n    #....\n\n  end\nend\n</code></pre>\n\n<p>The response to this method is shared via a websocket (code is from a rails delayed task), <code>send_realtime_data</code> method sends data to the frontend. When the method concludes (via <code>return</code>), the task completes and the return value is sent to the frontend followed by closing of the websocket.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 318, "user_id": 8900937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2pau7.png?s=128&g=1", "display_name": "acruma", "link": "https://stackoverflow.com/users/8900937/acruma"}, "edited": false, "score": 2, "creation_date": 1519790699, "post_id": 49021779, "comment_id": 85048692, "body": "Give us your Attempts"}, {"owner": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "edited": false, "score": 1, "creation_date": 1519791071, "post_id": 49021779, "comment_id": 85048782, "body": "Adithya, What you&#39;re looking for is probably <a href=\"http://ruby-doc.org/core-2.1.0/Array.html#method-i-to_h\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.1.0/Array.html#method-i-to_h</a> so you can convert arrays to hashes once you group your arrays [[&#39;dog&#39;, &#39;time_stamp&#39;],[&#39;cat&#39;,&#39;time_stamp]]"}, {"owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "reply_to_user": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "edited": false, "score": 0, "creation_date": 1519791268, "post_id": 49021779, "comment_id": 85048842, "body": "@iceveda06 But it should be a group of hashed inside an array."}, {"owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "reply_to_user": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "edited": false, "score": 0, "creation_date": 1519791444, "post_id": 49021779, "comment_id": 85048880, "body": "@iceveda06. I tried that way. I get the following. <code>[&#39;dog:time_stamp&#39;, &#39;cat:time_stamp&#39;, &#39;snake:time_stamp&#39;]</code>"}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 2, "creation_date": 1519791881, "post_id": 49021779, "comment_id": 85048985, "body": "Why have you chosen that data structure? I only ask because it appears (on the face of it) to be far better suited to a hash with the animals as keys. And, where does the timestamp come from?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519798630, "post_id": 49021779, "comment_id": 85051003, "body": "<code>{ &#39;dog&#39;: &lt;timestamp&gt; }</code> is the same as <code>{ :dog=&gt;&lt;timestamp&gt; }</code>. Is that what you want, or do you want <code>{ &#39;dog&#39;=&gt;&lt;timestamp&gt; }</code>? When you use the colon form, the key is always a symbol. The quotes around the key are only needed when the name of the key contains a whitespace character (e.g., <code>{ &#39;how are you&#39;: &#39;ok&#39; }</code> is the same as <code>{ :&#39;how are you&#39;=&gt;&#39;ok&#39; }</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519831678, "post_id": 49021779, "comment_id": 85070773, "body": "You have selected an answer that returns an array of hashes whose keys are strings even though you specified those keys to be symbols! Not good."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1520145311, "post_id": 49021779, "comment_id": 85190630, "body": "&quot;the output is incorrect&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ? What is the &quot;correct&quot; output?"}], "answers": [{"tags": [], "owner": {"reputation": 545, "user_id": 7146589, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0f3b4cadf837952a1fbc16191d22c2bf?s=128&d=identicon&r=PG&f=1", "display_name": "iceveda06", "link": "https://stackoverflow.com/users/7146589/iceveda06"}, "is_accepted": false, "score": 1, "last_activity_date": 1519791816, "last_edit_date": 1519791816, "creation_date": 1519791486, "answer_id": 49021903, "question_id": 49021779, "link": "https://stackoverflow.com/questions/49021779/modifying-an-array/49021903#49021903", "title": "Modifying an Array", "body": "<p>Aditha,</p>\n\n<p>How about this?</p>\n\n<pre><code>array = [\"cat\", \"hat\", \"bat\", \"mat\"]\nhash = []\nhash.push(Hash[array.collect { |item| [item, Time.now] } ])\n</code></pre>\n\n<p>OUTPUT:  => [{\"cat\"=>\"2018-02-28 04:23:08 UTC\", \"hat\"=>\"2018-02-28 04:23:08 UTC\", \"bat\"=>\"2018-02-28 04:23:08 UTC\", \"mat\"=>\"2018-02-28 04:23:08 UTC\"}] </p>\n\n<p>Instead of item.upcase you would insert your timestamp info.  It gives me hashes inside of array.</p>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 2, "creation_date": 1519798414, "post_id": 49021915, "comment_id": 85050920, "body": "We are not in the world of C language! We are in the world of Ruby!"}], "tags": [], "owner": {"reputation": 425, "user_id": 9422034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0FlA.jpg?s=128&g=1", "display_name": "Egor Egorov", "link": "https://stackoverflow.com/users/9422034/egor-egorov"}, "is_accepted": true, "score": 0, "last_activity_date": 1519791547, "creation_date": 1519791547, "answer_id": 49021915, "question_id": 49021779, "link": "https://stackoverflow.com/questions/49021779/modifying-an-array/49021915#49021915", "title": "Modifying an Array", "body": "<p>only weird thing is that you have to use => instead of :  </p>\n\n<pre><code>arr = ['dog', 'cat', 'snake']\narr2 = []\n\nfor index in 0 ... arr.size\n  arr2.push({arr[index] =&gt; Time.now})\nend\n\nputs arr2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 1, "creation_date": 1519795011, "post_id": 49022015, "comment_id": 85049837, "body": "What&#39;s the need of requiring <code>time</code>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519797351, "post_id": 49022015, "comment_id": 85050539, "body": "<code>example_array.product([Time.now]).to_h</code>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519797425, "post_id": 49022015, "comment_id": 85050570, "body": "Anyway, upvoted for <code>product</code> which is way better than all <code>map</code>s in other responses."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519797916, "post_id": 49022015, "comment_id": 85050753, "body": "@RAJ, because there&#39;s no Rails&#39; tag. Pure Ruby requires it."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519798029, "post_id": 49022015, "comment_id": 85050789, "body": "@CarySwoveland No there is no need! It works fine without requiring the <code>time</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519798079, "post_id": 49022015, "comment_id": 85050804, "body": "@mudasobwa, I had that originally but then noticed the keys were to be converted to symbols."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519798170, "post_id": 49022015, "comment_id": 85050838, "body": "Ah, indeed, I was fooled by implicit key conversion."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519798302, "post_id": 49022015, "comment_id": 85050882, "body": "@mudasobwa And also hash has to be inside the array but your solution simply returns a hash with many values, but expected result must be array of hashes!"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519798356, "post_id": 49022015, "comment_id": 85050896, "body": "@mudasobwa I have written an answer and then deleted because it returns the result of yours, <code>example_array.each_with_object({}){|value,h| h[value.to_sym]=Time.now}</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519799681, "post_id": 49022015, "comment_id": 85051382, "body": "@RAJ, yes, you are correct about <code>require &#39;time&#39;</code> not being needed. I&#39;m in the habit of requiring it to be able to use more than the basic <code>Time</code> methods (<code>Time#strptime</code> being an example) and also <code>Date</code> and <code>DateTime</code> methods without <code>require &#39;date&#39;</code>, but I should not have required it here."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519800197, "post_id": 49022015, "comment_id": 85051583, "body": "@CarySwoveland Okay, it&#39;s correct that we need to require date but we don&#39;t have to for Time.now."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1519830543, "last_edit_date": 1519830543, "creation_date": 1519792290, "answer_id": 49022015, "question_id": 49021779, "link": "https://stackoverflow.com/questions/49021779/modifying-an-array/49022015#49022015", "title": "Modifying an Array", "body": "<pre><code>example_array.product([Time.now]).map { |k,v| { k.to_sym=&gt;v }}\n  #=&gt; [{:dog=&gt;2018-02-27 20:42:56 -0800},\n  #    {:cat=&gt;2018-02-27 20:42:56 -0800},\n  #    {:snake=&gt;2018-02-27 20:42:56 -0800}\n</code></pre>\n\n<p>]Note this ensures that all values (timestamps) are equal.</p>\n"}, {"comments": [{"owner": {"reputation": 2630, "user_id": 1983197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwjpR.png?s=128&g=1", "display_name": "LordWilmore", "link": "https://stackoverflow.com/users/1983197/lordwilmore"}, "edited": false, "score": 0, "creation_date": 1519824808, "post_id": 49022019, "comment_id": 85065950, "body": "Please add some description around your answer, rather than just dumping code.  Somebody with your reputation should know this!"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1519792325, "creation_date": 1519792325, "answer_id": 49022019, "question_id": 49021779, "link": "https://stackoverflow.com/questions/49021779/modifying-an-array/49022019#49022019", "title": "Modifying an Array", "body": "<pre><code>['dog', 'cat', 'snake'].map{|e| [{e.to_sym =&gt; \"time_stamp\"}]}\n# =&gt; [[{:dog=&gt;\"time_stamp\"}], [{:cat=&gt;\"time_stamp\"}], [{:snake=&gt;\"time_stamp\"}]]\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8212516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0a46fcf100e4fc354aef50b62e4c8d2f?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8212516/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 49021915, "answer_count": 4, "score": 0, "last_activity_date": 1519830543, "creation_date": 1519790615, "last_edit_date": 1519791798, "question_id": 49021779, "link": "https://stackoverflow.com/questions/49021779/modifying-an-array", "title": "Modifying an Array", "body": "<p>I have an Array like this</p>\n\n<pre><code>example_array = ['dog', 'cat', 'snake']\n</code></pre>\n\n<p>And I am trying to append the timestamp to each element of the array and the output should look like</p>\n\n<pre><code>example_array = [{'dog': 'time_stamp'},{'cat':'time_stamp'},{'snake':'time_stamp'}]\n</code></pre>\n\n<p>I've tried this but the output is incorrect:</p>\n\n<pre><code>a = {}\nexample_array.each_with_index do |element, i|\n  a.merge!(\"#{element}\": \"#{Time.now}\")\n  example_array.delete_at(i)\nend\n</code></pre>\n\n<p>Can anyone suggest me a solution in ruby? \nI have tried a lot of ways but couldn't obtain the output like above.</p>\n"}, {"tags": ["ruby", "rspec", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 0, "creation_date": 1519788131, "post_id": 49021403, "comment_id": 85048114, "body": "So, one is not better over another?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "edited": false, "score": 1, "creation_date": 1519842513, "post_id": 49021403, "comment_id": 85077385, "body": "@AJ nope - they both do the same thing, pick the one you prefer.  The only technical difference would be the error messages produced in case of failure."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 3, "last_activity_date": 1519787763, "creation_date": 1519787763, "answer_id": 49021403, "question_id": 49021280, "link": "https://stackoverflow.com/questions/49021280/difference-between-page-should-not-have-content-and-page-should-have-no-conte/49021403#49021403", "title": "Difference between &quot;page.should_not have_content&quot; and &quot;page.should have_no_content&quot;", "body": "<p>Assuming Capybara::RSpecMatchers has been included correctly there is no real difference in the two methods you're asking about, they both boil down to running <code>current_scope_element.assert_no_text(...)</code></p>\n"}], "owner": {"reputation": 952, "user_id": 9357839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d83525a39d3b801dcf7a16a4770557?s=128&d=identicon&r=PG&f=1", "display_name": "A J", "link": "https://stackoverflow.com/users/9357839/a-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "accepted_answer_id": 49021403, "answer_count": 1, "score": 2, "last_activity_date": 1557625652, "creation_date": 1519786771, "last_edit_date": 1519950989, "question_id": 49021280, "link": "https://stackoverflow.com/questions/49021280/difference-between-page-should-not-have-content-and-page-should-have-no-conte", "title": "Difference between &quot;page.should_not have_content&quot; and &quot;page.should have_no_content&quot;", "body": "<p>Can anybody explain me the difference between \"page.should_not have_content\" and \"page.should have_no_content\" in capybara and which one is the better option to ensure page does not have a specific content?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-4", "rubymine"], "comments": [{"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519785341, "post_id": 49021042, "comment_id": 85047470, "body": "Try to specify username and password in the development section"}, {"owner": {"reputation": 15, "user_id": 8762923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adca96d5be5712aac6dc0039bd2e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Socramvm", "link": "https://stackoverflow.com/users/8762923/socramvm"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519785863, "post_id": 49021042, "comment_id": 85047590, "body": "Thank you Vasilisa! That got rid of that error. Now It is saying &quot;ActiveRecord::NoDatabaseError (FATAL:  database &quot;aaa_development&quot; does not exist) wasnt that created when the aaa project was created?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519786771, "post_id": 49021042, "comment_id": 85047803, "body": "You need to run <code>rake db:create</code>"}, {"owner": {"reputation": 15, "user_id": 8762923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adca96d5be5712aac6dc0039bd2e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Socramvm", "link": "https://stackoverflow.com/users/8762923/socramvm"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519787150, "post_id": 49021042, "comment_id": 85047883, "body": "Ok so I ran rake db:migrate and it keep telling me that error. I went ahead and commented out this part &quot;  database: aaa_development&quot; and it now seems to be working. Why didnt I need that line?"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519787757, "post_id": 49021042, "comment_id": 85048021, "body": "Try to run <code>rake db:drop &amp;&amp; rake db:create &amp;&amp; rake db:migrate</code>"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519787809, "post_id": 49021042, "comment_id": 85048032, "body": "<code>database: aaa_development</code> - this is a name of your db in the dev env for this project. You really need this line :)"}, {"owner": {"reputation": 15, "user_id": 8762923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adca96d5be5712aac6dc0039bd2e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Socramvm", "link": "https://stackoverflow.com/users/8762923/socramvm"}, "reply_to_user": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519789200, "post_id": 49021042, "comment_id": 85048332, "body": "Thank you so much Vasilisa! That worked! But why did it start working after commenting out that line? it even lets me run rake db:migrate"}, {"owner": {"reputation": 4216, "user_id": 9269043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a2763bcfa8917a365c88f8639494de7?s=128&d=identicon&r=PG", "display_name": "Vasilisa", "link": "https://stackoverflow.com/users/9269043/vasilisa"}, "edited": false, "score": 0, "creation_date": 1519789840, "post_id": 49021042, "comment_id": 85048494, "body": "Because it worked with you default Postgres db <code>postgres</code> :)"}], "owner": {"reputation": 15, "user_id": 8762923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adca96d5be5712aac6dc0039bd2e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Socramvm", "link": "https://stackoverflow.com/users/8762923/socramvm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519784815, "creation_date": 1519784815, "question_id": 49021042, "link": "https://stackoverflow.com/questions/49021042/fatal-error-when-running-starting-rails-server-on-rubymine", "title": "Fatal error when running starting rails server on rubymine", "body": "<p>so I started creating a new rails application using rubymine. I have created the new rails app and have also created a model using the scaffold feature. However, whenever I try to start the rails server or run rake db:migrate, I get the following error \"PG::ConnectionBad: FATAL:  role \"Marcos\" does not exist\". I have tested the connection to my postgres db. The username and password are set to \"postgres\". Here is my database.yml file:</p>\n\n<pre><code>    # PostgreSQL. Versions 9.1 and up are supported.\n#\n# Install the pg driver:\n#   gem install pg\n# On OS X with Homebrew:\n#   gem install pg -- --with-pg-config=/usr/local/bin/pg_config\n# On OS X with MacPorts:\n#   gem install pg -- --with-pg-config=/opt/local/lib/postgresql84/bin/pg_config\n# On Windows:\n#   gem install pg\n#       Choose the win32 build.\n#       Install PostgreSQL and put its /bin directory on your path.\n#\n# Configure Using Gemfile\n# gem 'pg'\n#\ndefault: &amp;default\n  adapter: postgresql\n  encoding: unicode\n  # For details on connection pooling, see Rails configuration guide\n  # http://guides.rubyonrails.org/configuring.html#database-pooling\n  pool: &lt;%= ENV.fetch(\"RAILS_MAX_THREADS\") { 5 } %&gt;\n\ndevelopment:\n  &lt;&lt;: *default\n  database: aaa_development\n\n  # The specified database role being used to connect to postgres.\n  # To create additional roles in postgres see `$ createuser --help`.\n  # When left blank, postgres will use the default role. This is\n  # the same name as the operating system user that initialized the database.\n  #username: aaa\n\n  # The password associated with the postgres role (username).\n  #password:\n\n  # Connect on a TCP socket. Omitted by default since the client uses a\n  # domain socket that doesn't need configuration. Windows does not have\n  # domain sockets, so uncomment these lines.\n  #host: localhost\n\n  # The TCP port the server listens on. Defaults to 5432.\n  # If your server runs on a different port number, change accordingly.\n  #port: 5432\n\n  # Schema search path. The server defaults to $user,public\n  #schema_search_path: myapp,sharedapp,public\n\n  # Minimum log levels, in increasing order:\n  #   debug5, debug4, debug3, debug2, debug1,\n  #   log, notice, warning, error, fatal, and panic\n  # Defaults to warning.\n  #min_messages: notice\n\n# Warning: The database defined as \"test\" will be erased and\n# re-generated from your development database when you run \"rake\".\n# Do not set this db to the same as development or production.\ntest:\n  &lt;&lt;: *default\n  database: aaa_test\n\n# As with config/secrets.yml, you never want to store sensitive information,\n# like your database password, in your source code. If your source code is\n# ever seen by anyone, they now have access to your database.\n#\n# Instead, provide the password as a unix environment variable when you boot\n# the app. Read http://guides.rubyonrails.org/configuring.html#configuring-a-database\n# for a full rundown on how to provide these environment variables in a\n# production deployment.\n#\n# On Heroku and other platform providers, you may have a full connection URL\n# available as an environment variable. For example:\n#\n#   DATABASE_URL=\"postgres://myuser:mypass@localhost/somedatabase\"\n#\n# You can use this database configuration with:\n#\n#   production:\n#     url: &lt;%= ENV['DATABASE_URL'] %&gt;\n#\nproduction:\n  &lt;&lt;: *default\n  database: aaa_production\n  username: aaa\n  password: &lt;%= ENV['AAA_DATABASE_PASSWORD'] %&gt;\n</code></pre>\n\n<p>I have the gem installed but I cant figure out what to do anymore. I know the message basically says that the role cannot be found. How do add the role? how do I check the current roles? Any help would be much appreciated thank you!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1519792680, "post_id": 49020629, "comment_id": 85049185, "body": "Of course Ruby is correct, unless you have hit a bug. And there is no Ruby bug related to what you have shown here."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1519792747, "post_id": 49020629, "comment_id": 85049201, "body": "What do you mean by &quot;(doesn&#39;t) work&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1519784518, "post_id": 49020748, "comment_id": 85047296, "body": "Right. <code>[[&#39;-&#39;] * 3] * 3</code> creates an array, then creates two references to that same array object. But <code>Array.new(3) { ... }</code> calls its block 3 times, and each time it creates and yields a new object."}], "tags": [], "owner": {"reputation": 956, "user_id": 236353, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aad37b5f7116c8d1f547d23b37566032?s=128&d=identicon&r=PG", "display_name": "gdonald", "link": "https://stackoverflow.com/users/236353/gdonald"}, "is_accepted": true, "score": 0, "last_activity_date": 1519782427, "creation_date": 1519782427, "answer_id": 49020748, "question_id": 49020629, "link": "https://stackoverflow.com/questions/49020629/ruby-array-assignment-produces-unexpected-result/49020748#49020748", "title": "Ruby array assignment produces unexpected result", "body": "<p>I found it has to be done this way:</p>\n\n<pre><code>irb(main):001:0&gt; b = Array.new(3) { Array.new(3) { '-' } }\n=&gt; [[\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"]]\nirb(main):002:0&gt; b[0][0] = 'X'\n=&gt; \"X\"\nirb(main):003:0&gt; b\n=&gt; [[\"X\", \"-\", \"-\"], [\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519789223, "post_id": 49020794, "comment_id": 85048337, "body": "When mysteries like this emerge, check <code>a.map(&amp;:object_id)</code> to see what objects are in the array. If the numbers are all the same, they&#39;re all the same object."}], "tags": [], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "is_accepted": false, "score": 2, "last_activity_date": 1519782767, "creation_date": 1519782767, "answer_id": 49020794, "question_id": 49020629, "link": "https://stackoverflow.com/questions/49020629/ruby-array-assignment-produces-unexpected-result/49020794#49020794", "title": "Ruby array assignment produces unexpected result", "body": "<p>This:</p>\n\n<pre><code>[object]*3\n</code></pre>\n\n<p>will create an array with 3 references to the same object so changing one of them changes all of them like this:</p>\n\n<pre><code>a = [[1]]*3 #=&gt; [[1], [1], [1]]\na[0][0] = 2 #=&gt; [[2], [2], [2]]\n</code></pre>\n\n<p>If you wish to create an array of length 3 with 3 different objects, do this:</p>\n\n<pre><code>a = 3.times.map {[1]} #=&gt; [[1], [1], [1]]\na[0][0] = 2           #=&gt; [[2], [1], [1]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 2820764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acfe5fccf788fcf7934467611cd2aa00?s=128&d=identicon&r=PG", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2820764/kandy"}, "is_accepted": false, "score": 1, "last_activity_date": 1519789785, "creation_date": 1519789785, "answer_id": 49021670, "question_id": 49020629, "link": "https://stackoverflow.com/questions/49020629/ruby-array-assignment-produces-unexpected-result/49021670#49021670", "title": "Ruby array assignment produces unexpected result", "body": "<p>The first initialization you created 3 arrays nested in 1.</p>\n\n<pre><code>a = [['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']]\n#   [['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']] \n#         ARRAY a          ARRAY b          ARRAY c\n</code></pre>\n\n<p>The second initialization you created 1 array, and then pointed the same array 3 times.</p>\n\n<pre><code>b = [['-'] * 3] * 3\n#   [['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']] \n#         ARRAY x          ARRAY x          ARRAY x\n</code></pre>\n\n<p>Thinking in this way if you change b[0][0] is going to alter only one array, however you can have the impression that is changing more arrays because it's being referenced many times.</p>\n\n<p>You can check it by yourself printing the addresses of them.</p>\n\n<pre><code>puts a[0].object_id # 47369457807480\nputs a[1].object_id # 47369457807320\nputs a[2].object_id # 47369457807200\n\nputs b[0].object_id # 47369457807070\nputs b[1].object_id # 47369457807070\nputs b[2].object_id # 47369457807070\n</code></pre>\n"}], "owner": {"reputation": 956, "user_id": 236353, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aad37b5f7116c8d1f547d23b37566032?s=128&d=identicon&r=PG", "display_name": "gdonald", "link": "https://stackoverflow.com/users/236353/gdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 49020748, "answer_count": 3, "score": -1, "last_activity_date": 1519792940, "creation_date": 1519781522, "last_edit_date": 1519792940, "question_id": 49020629, "link": "https://stackoverflow.com/questions/49020629/ruby-array-assignment-produces-unexpected-result", "title": "Ruby array assignment produces unexpected result", "body": "<p>I have:</p>\n\n<pre><code>a = [['-', '-', '-'], ['-', '-', '-'], ['-', '-', '-']]\nb = [['-'] * 3] * 3 # =&gt; [[\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"]]\na == b #=&gt; true\n</code></pre>\n\n<p>Seems correct.</p>\n\n<pre><code>a[0][0] = 'X'\na # =&gt; [[\"X\", \"-\", \"-\"], [\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"]]\n\nb[0][0] = 'X'\nb # =&gt; [[\"X\", \"-\", \"-\"], [\"X\", \"-\", \"-\"], [\"X\", \"-\", \"-\"]]\n\na == b # =&gt; false\n</code></pre>\n\n<p>What? Why does <code>b[0][0] = 'X'</code> change values in three places?</p>\n\n<p>I also found it doesn't work this way:</p>\n\n<pre><code>b = [%w[- - -]] * 3 # =&gt; [[\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"], [\"-\", \"-\", \"-\"]]\nb[0][0] = 'X'\nb # =&gt; [[\"X\", \"-\", \"-\"], [\"X\", \"-\", \"-\"], [\"X\", \"-\", \"-\"]]\n</code></pre>\n"}, {"tags": ["ruby", "time"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1519793174, "post_id": 49020598, "comment_id": 85049335, "body": "What is the format used in <code>3&#47;17&#47;98</code>?"}, {"owner": {"reputation": 28, "user_id": 8663434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3aa1e51db1448ec87b41274eeda9f5?s=128&d=identicon&r=PG", "display_name": "Leo G.", "link": "https://stackoverflow.com/users/8663434/leo-g"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1520373403, "post_id": 49020598, "comment_id": 85286611, "body": "Apologies for the delay.  Illness.  The date format is m/d/yy"}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "is_accepted": true, "score": 0, "last_activity_date": 1519782394, "creation_date": 1519782394, "answer_id": 49020742, "question_id": 49020598, "link": "https://stackoverflow.com/questions/49020598/convert-from-format-date-string-to-unix-epoch-time-value/49020742#49020742", "title": "Convert from format date string to unix (epoch) time value", "body": "<p>To convert the string into an array of integers, look into <code>split('/')</code>, to turn that into a unix time stamp look <a href=\"https://stackoverflow.com/questions/1805950/ruby-rails-converting-a-date-to-a-unix-timestamp\">here</a> (you probably want <code>to_i</code> but be warned that it incorporates your local time zone).</p>\n"}], "owner": {"reputation": 28, "user_id": 8663434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3aa1e51db1448ec87b41274eeda9f5?s=128&d=identicon&r=PG", "display_name": "Leo G.", "link": "https://stackoverflow.com/users/8663434/leo-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 49020742, "answer_count": 1, "score": -1, "last_activity_date": 1519793131, "creation_date": 1519781224, "last_edit_date": 1519793131, "question_id": 49020598, "link": "https://stackoverflow.com/questions/49020598/convert-from-format-date-string-to-unix-epoch-time-value", "title": "Convert from format date string to unix (epoch) time value", "body": "<p>How can I convert from a formatted time string (e.g. 3/17/98) to a Unix time stamp (i.e. num. seconds from Jan 1, 1970 00:00:00)?</p>\n\n<p>I can find many methods of converting into a date string in the Ruby \"date\" library, but none to go back the other way. While this won't be a problem in later builds, my proof of concept application is using a SQLite database which does not support the \"DATE\" type format.</p>\n"}, {"tags": ["ruby", "logstash"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1519781537, "post_id": 49019536, "comment_id": 85046491, "body": "did you see this? <a href=\"https://github.com/logstash-plugins/logstash-filter-translate/blob/master/lib/logstash/filters/translate.rb#L108-L109\" rel=\"nofollow noreferrer\">github.com/logstash-plugins/logstash-filter-translate/blob/&hellip;</a>"}, {"owner": {"reputation": 10070, "user_id": 155293, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/013dbf7988a8bfd5415680c1bd504eb9?s=128&d=identicon&r=PG", "display_name": "panchicore", "link": "https://stackoverflow.com/users/155293/panchicore"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1519805428, "post_id": 49019536, "comment_id": 85054076, "body": "thank you, yes, it says &quot;A large dictionary could be expensive to match in this case.&quot; and what would be great to know is how many keys is considered a large one."}], "owner": {"reputation": 10070, "user_id": 155293, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/013dbf7988a8bfd5415680c1bd504eb9?s=128&d=identicon&r=PG", "display_name": "panchicore", "link": "https://stackoverflow.com/users/155293/panchicore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519774474, "creation_date": 1519773464, "last_edit_date": 1519774474, "question_id": 49019536, "link": "https://stackoverflow.com/questions/49019536/logstash-filter-translate-performance-how-many-keys-would-be-too-much-keys-in-a", "title": "logstash-filter-translate performance: how many keys would be too much keys in a ruby Hash?", "body": "<p><code>logstash-filter-translate</code> its a great filter to perform key/value lookups, but I am concerned about performance at scale and having many keys, let's say 50k keys stored on SSD, for what I understand reading the <a href=\"https://github.com/logstash-plugins/logstash-filter-translate/blob/master/lib/logstash/filters/translate.rb#L197\" rel=\"nofollow noreferrer\">source code</a>, a ruby <code>Hash</code> is pre-populated with the file content (in case of dictionary_path) and the lookup is made first ensuring key exists using a regex <code>match</code> and followed by the <code>get</code> it in case exists. I suppose this is mostly a Ruby question now but I wanted to ask for experiences.</p>\n"}, {"tags": ["ruby", "multithreading", "yield"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519775573, "post_id": 49019336, "comment_id": 85044846, "body": "It sounds like you need an event loop. Look at using <a href=\"http://ruby-doc.org/core-2.5.0/Queue.html\" rel=\"nofollow noreferrer\">Queue</a> to handle signalling threads."}, {"owner": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519776483, "post_id": 49019336, "comment_id": 85045098, "body": "I took a quick look at Queue, but it doesn&#39;t look like the block will execute in thread1. In this case, I basically need thread1 to execute the block I pass it, anything else executing the block and it doesn&#39;t work correctly (all tied into how thread1 is being used in other parts of the code)"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 0, "creation_date": 1519835444, "post_id": 49021583, "comment_id": 85073263, "body": "thanks for taking the time to look into this.   I was playing around with the code, and it still doesn&#39;t quite do what I need.  Here is what I have: <a href=\"https://repl.it/repls/TroubledPunyAdmins\" rel=\"nofollow noreferrer\">repl.it/repls/TroubledPunyAdmins</a>  The problem is Task1 doesn&#39;t stop and let Task2 execute, Task1 is still sleeping.  For a little more context, Task1 is executing based on a user action (ex: a button press) and it is waiting for another button press. However something outside of the UI can trigger actions/changes, and it won&#39;t show the user what is happening if the original thread isn&#39;t running the code."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 0, "creation_date": 1519843062, "post_id": 49021583, "comment_id": 85077663, "body": "Two things to consider. First, steer towards the <a href=\"https://en.wikipedia.org/wiki/Event_loop\" rel=\"nofollow noreferrer\">event loop</a> design pattern and have your worker loop perform short, quick actions that don&#39;t block or stall for extended periods of time. Introducing a <code>sleep</code> in there causes it to stop processing other events, and this is bad. Fire off background threads or use timers if that&#39;s necessary."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "edited": false, "score": 0, "creation_date": 1519843132, "post_id": 49021583, "comment_id": 85077692, "body": "Secondly, always, <b>always</b> avoid slinging around arbitrary chunks of code as strings that get passed to <code>eval</code>. In Ruby it&#39;s very easy to pass in a Proc instead: <code>queue.push(-&gt; { do ... stuff. })</code> where the internals are actual Ruby code, not a string. This also helps with binding problems as you can have a proper closure, something not possible with a string."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1519789108, "creation_date": 1519789108, "answer_id": 49021583, "question_id": 49019336, "link": "https://stackoverflow.com/questions/49019336/how-to-pass-a-block-to-a-yielding-thread-in-ruby/49021583#49021583", "title": "How to pass a block to a yielding thread in Ruby", "body": "<p>Here's a simple worker thread:</p>\n\n<pre><code>queue = Queue.new\n\nworker = Thread.new do\n  # Fetch an item from the work queue, or wait until one is available\n  while (work = queue.pop)\n    # ... Do something with work\n  end\nend\n\nqueue.push(thing: 'to do')\n</code></pre>\n\n<p>The <a href=\"http://ruby-doc.org/core-2.5.0/Queue.html#method-i-pop\" rel=\"nofollow noreferrer\"><code>pop</code></a> method will block until something is pushed into the queue.</p>\n\n<p>When you're done you can push in a deliberately empty job:</p>\n\n<pre><code>queue.push(nil)\n</code></pre>\n\n<p>That will make the worker thread exit.</p>\n\n<p>You can always expand on that functionality to do more things, or to handle more conditions.</p>\n"}], "owner": {"reputation": 379, "user_id": 1847014, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fb1cb251fda46c2b04fc0f467d7ee28?s=128&d=identicon&r=PG", "display_name": "Tennesseej", "link": "https://stackoverflow.com/users/1847014/tennesseej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519789108, "creation_date": 1519772456, "last_edit_date": 1519776517, "question_id": 49019336, "link": "https://stackoverflow.com/questions/49019336/how-to-pass-a-block-to-a-yielding-thread-in-ruby", "title": "How to pass a block to a yielding thread in Ruby", "body": "<p>I am trying to wrap my head around Threads and Yielding in Ruby, and I have a question about how to pass a block to a yielding thread.</p>\n\n<p>Specifically, I have a thread that is sleeping, and waiting to be told to do something, and I would like that Thread to execute a different block if told to (ie, it is sleeping, and if a user presses a button, do something besides sleep).</p>\n\n<p>Say I have code like this:</p>\n\n<pre><code>window = Thread.new do \n\n  @thread1 = Thread.new do\n    # Do some cool stuff\n\n    # Decide it is time to sleep\n    until @told_to_wakeup\n       if block_given?\n         yield\n       end\n       sleep(1)\n    end\n\n  # At some point after @thread1 starts sleeping, \n  # a user might do something, so I want to execute\n  # some code in @@thread1 (unfortunately spawning a new thread\n  # won't work correctly in my case)\n\nend\n</code></pre>\n\n<p>Is it possible to do that?</p>\n\n<p>I tried using @@thread1.send(), but send was looking for a method name.</p>\n\n<p>Thanks for taking the time to look at this!</p>\n"}, {"tags": ["css", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1519772130, "post_id": 49019215, "comment_id": 85043801, "body": "Apply <code>id</code> or <code>class</code> to each <code>img</code> and using CSS styling from there."}], "answers": [{"tags": [], "owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "is_accepted": true, "score": 0, "last_activity_date": 1519772595, "last_edit_date": 1519772595, "creation_date": 1519772274, "answer_id": 49019309, "question_id": 49019215, "link": "https://stackoverflow.com/questions/49019215/image-tag-in-ruby-on-rails/49019309#49019309", "title": "image_tag in ruby on rails", "body": "<p>The <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag\" rel=\"nofollow noreferrer\"><code>AssetTagHelper#image_tag</code></a> is defined as:</p>\n\n<pre><code>def image_tag(source, options = {})\n  options = options.symbolize_keys\n  check_for_image_tag_errors(options)\n  skip_pipeline = options.delete(:skip_pipeline)\n\n  options[:src] = resolve_image_source(source, skip_pipeline)\n\n  if options[:srcset] &amp;&amp; !options[:srcset].is_a?(String)\n    options[:srcset] = options[:srcset].map do |src_path, size|\n      src_path = path_to_image(src_path, skip_pipeline: skip_pipeline)\n      \"#{src_path} #{size}\"\n    end.join(\", \")\n  end\n\n  options[:width], options[:height] = extract_dimensions(options.delete(:size)) if options[:size]\n  tag(\"img\", options)\nend\n</code></pre>\n\n<p>See there the options argument, if you pass a src, a srcset, width and/or options they'll be handled by the method itself, and afterwards whatever your trying to build will be passed to the helper method <a href=\"https://github.com/rails/rails/blob/7bfc79ec9bb054b97b2f961a75f8c789999b68dc/actionview/lib/action_view/helpers/tag_helper.rb#L235\" rel=\"nofollow noreferrer\"><code>tag</code></a>:</p>\n\n<pre><code>def tag(name = nil, options = nil, open = false, escape = true)\n  if name.nil?\n    tag_builder\n  else\n    \"&lt;#{name}#{tag_builder.tag_options(options, escape) if options}#{open ? \"&gt;\" : \" /&gt;\"}\".html_safe\n  end\nend\n</code></pre>\n\n<p>So, if you need to specify CSS rules, being inline or through a class then you can add them as the options in your image tag, as the tag method will add each of them within the rendered \"img\" HTML tag.</p>\n\n<pre><code>&lt;%= image_tag 'image', class: 'class', id: 'identifier', style: 'width: 360px; height: 280px' %&gt;\n</code></pre>\n\n<p>Becomes</p>\n\n<pre><code>&lt;img class=\"class\" id=\"identifier\" style=\"width: 360px; height: 280px\" src=\"image\"&gt;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9405271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96f7349e8304e5f33366ae41e2729e46?s=128&d=identicon&r=PG&f=1", "display_name": "Shilpa", "link": "https://stackoverflow.com/users/9405271/shilpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1564, "favorite_count": 0, "accepted_answer_id": 49019309, "answer_count": 1, "score": 1, "last_activity_date": 1519772595, "creation_date": 1519771689, "question_id": 49019215, "link": "https://stackoverflow.com/questions/49019215/image-tag-in-ruby-on-rails", "title": "image_tag in ruby on rails", "body": "<p>I have used image_tag in ruby on rails application for two different images, and now I want to specify different CSS properties for each image. I only have one img { } tag available. So, how can I do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "download", "streaming", "net-sftp"], "comments": [{"owner": {"reputation": 1442, "user_id": 4020610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LdgzYsM5kJw/AAAAAAAAAAI/AAAAAAAAH4E/Qase_JE27jE/photo.jpg?sz=128", "display_name": "Lohmar ASHAR", "link": "https://stackoverflow.com/users/4020610/lohmar-ashar"}, "edited": false, "score": 0, "creation_date": 1519771186, "post_id": 49019051, "comment_id": 85043479, "body": "I know pretty much nothing of ruby, so if it&#39;s to silly ...bear with me ... does something like <code>self.response_body = file</code> can work ?"}, {"owner": {"reputation": 1442, "user_id": 4020610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LdgzYsM5kJw/AAAAAAAAAAI/AAAAAAAAH4E/Qase_JE27jE/photo.jpg?sz=128", "display_name": "Lohmar ASHAR", "link": "https://stackoverflow.com/users/4020610/lohmar-ashar"}, "edited": false, "score": 0, "creation_date": 1519771522, "post_id": 49019051, "comment_id": 85043598, "body": "In the mean time I&#39;ve found this page <a href=\"https://coderwall.com/p/kad56a/streaming-large-data-responses-with-rails\" rel=\"nofollow noreferrer\">Streaming Large Data Responses with Rails</a>, most importantly it hints on using &quot;Transfer-Encoding: chunked&quot; header (beside others)."}], "owner": {"reputation": 956, "user_id": 236353, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/aad37b5f7116c8d1f547d23b37566032?s=128&d=identicon&r=PG", "display_name": "gdonald", "link": "https://stackoverflow.com/users/236353/gdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519770758, "creation_date": 1519770758, "question_id": 49019051, "link": "https://stackoverflow.com/questions/49019051/how-to-make-ruby-netsftp-not-block-so-i-can-begin-streaming-a-remote-download", "title": "How to make Ruby Net::SFTP not block, so I can begin streaming a remote download immediately?", "body": "<p>How can I acquire a remote file using Net::SFTP and stream it without waiting for the entire file to download?</p>\n\n<p>My test.zip file is 1GB in size.  When I run this code my browser does nothing for several minutes and then the download finally begins.  I'd like it to begin streaming the file sooner than that.  I have to use Net::SFTP or something like it since the file is only available via SSH or SFTP.</p>\n\n<p>I've also tried Net::SFTP's download and download! methods and got the same result.</p>\n\n<pre><code>headers['Content-Type'] = 'application/zip'\nheaders['Content-disposition'] = \"attachment; filename=test.zip\"\nself.response_body = Enumerator.new do |lines|\n  Net::SFTP.start('example.com', 'foo', keys: ['~/.ssh/id_rsa.pub']) do |sftp|\n    file = sftp.file.open('/path/to/test.zip')\n    lines &lt;&lt; file.read(4096) until file.eof?\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "graphql", "graphql-ruby"], "answers": [{"tags": [], "owner": {"reputation": 56993, "user_id": 6024220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6s3nUiQ9-fI/AAAAAAAAAAI/AAAAAAAAA0E/3zpg3zXHu4I/photo.jpg?sz=128", "display_name": "Daniel Rearden", "link": "https://stackoverflow.com/users/6024220/daniel-rearden"}, "is_accepted": false, "score": 2, "last_activity_date": 1519787200, "creation_date": 1519787200, "answer_id": 49021336, "question_id": 49018965, "link": "https://stackoverflow.com/questions/49018965/add-descriptions-comments-to-graphql-arguments/49021336#49021336", "title": "Add descriptions / comments to graphql arguments?", "body": "<p><a href=\"http://www.rubydoc.info/gems/graphql/1.7.12/GraphQL/Argument\" rel=\"nofollow noreferrer\">Looking at the docs</a>, you should be able to do something like:</p>\n\n<pre><code>argument :favoriteFood, types.String, \"A string in yyyy/mm/dd format\", default_value: nil\n</code></pre>\n"}], "owner": {"reputation": 298, "user_id": 2771419, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3359ecf8fb3a7695dd897d7a93ae3646?s=128&d=identicon&r=PG&f=1", "display_name": "Timmy", "link": "https://stackoverflow.com/users/2771419/timmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544754309, "creation_date": 1519770326, "last_edit_date": 1544754309, "question_id": 49018965, "link": "https://stackoverflow.com/questions/49018965/add-descriptions-comments-to-graphql-arguments", "title": "Add descriptions / comments to graphql arguments?", "body": "<p>Is it possible to add a description or a comment to the arguments that are accepted in a query with graphql?</p>\n\n<p>I have a Query as follows:</p>\n\n<pre><code>    field :users, types[Types::UserType] do\n  description 'List of Users. Date parameters accepted in yyyy/mm/dd format.'\n\n  # Required for date range search, accepts string (yyyy/mm/dd)\n  argument :from_date, types.String, default_value: nil\n</code></pre>\n\n<p>as you can see, currently I'm adding the description of the parameters to the description of the field.  In the graphiql schema where it describes the types I see:</p>\n\n<pre><code>users(from_date: Stringto_date: Stringemail: Stringname: Stringoffset: Intlimit: Int): [UserType]\n</code></pre>\n\n<p>when I click on the from_date it describes a string.  Is there anyway to have it describe the format of the string? eg. \"A string in yyyy/mm/dd format.\"</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1519770039, "post_id": 49018888, "comment_id": 85042994, "body": "Ruby regex does not support variable width lookbehind patterns."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519780482, "post_id": 49018888, "comment_id": 85046241, "body": "See the section &quot;Important Notes About Lookbehind&quot; <a href=\"https://www.regular-expressions.info/lookaround.html\" rel=\"nofollow noreferrer\">here</a>."}], "owner": {"reputation": 4670, "user_id": 2658159, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ca457ff473ed766a9c140f9956c910a?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Thomas", "link": "https://stackoverflow.com/users/2658159/aaron-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1519770077, "answer_count": 0, "score": 0, "last_activity_date": 1519770043, "creation_date": 1519769968, "last_edit_date": 1519770043, "question_id": 49018888, "link": "https://stackoverflow.com/questions/49018888/repetition-metacharacters-not-allowed-in-positive-lookbehind", "closed_reason": "Duplicate", "title": "Repetition metacharacters not allowed in positive lookbehind", "body": "<p>Given the statement</p>\n\n<pre><code>/(?&lt;=.*)./.match(\"abc\")\n</code></pre>\n\n<p>I get an error that there is an invalid pattern in the look behind.</p>\n\n<p>Replacing <code>(?&lt;=.*)</code> with <code>(?&lt;=.)</code> yields an answer.</p>\n\n<p>Similar issues occur when using <code>+</code> in place of <code>*</code>.</p>\n\n<p>Why does the <code>*</code> <a href=\"http://ruby-doc.org/core-2.5.0/Regexp.html#class-Regexp-label-Repetition\" rel=\"nofollow noreferrer\">repetition metacharacter</a> cause an error to be thrown?</p>\n\n<p>Using Ruby 2.5.0.</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1519769098, "post_id": 49018433, "comment_id": 85042602, "body": "Do you mind pointing out specifically what you mean by hash key? I&#39;m not entirely understanding your question"}, {"owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1519769334, "post_id": 49018433, "comment_id": 85042703, "body": "I&#39;ve been pausing my debugger at the line prior to <code>destination_hash[job_signature(destination)] &lt;&lt; destination</code>, and <code>destination</code> shows the correct information (the right <code>user_id</code>). But after the append to <code>destination_hash</code>, the <code>destination</code> object isn&#39;t what I thought I assigned"}], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "is_accepted": true, "score": 2, "last_activity_date": 1519769497, "creation_date": 1519769497, "answer_id": 49018798, "question_id": 49018433, "link": "https://stackoverflow.com/questions/49018433/defining-default-values-as-an-array-in-ruby-results-in-values-being-overwritten/49018798#49018798", "title": "Defining default values as an array in Ruby results in values being overwritten", "body": "<p>The problem seems to be that when you push <code>destination</code> into one of the values of <code>destination_hash</code> here:</p>\n\n<pre><code>destination_hash[job_signature(destination)] &lt;&lt; destination\n</code></pre>\n\n<p>you push the actual object and not a copy (ie by reference and not by value).</p>\n\n<p>This means that when you change the <code>destination</code> object in the next iteration here:</p>\n\n<pre><code>destination[:address] = user.user_id\n</code></pre>\n\n<p>you change the object everywhere it exists including where you pushed it last time.</p>\n\n<p>Try replacing</p>\n\n<pre><code>destination_hash[job_signature(destination)] &lt;&lt; destination\n</code></pre>\n\n<p>with</p>\n\n<pre><code>destination_hash[job_signature(destination)] &lt;&lt; destination.clone # or equivalent\n</code></pre>\n"}], "owner": {"reputation": 4717, "user_id": 1913389, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QKwb2.png?s=128&g=1", "display_name": "theGreenCabbage", "link": "https://stackoverflow.com/users/1913389/thegreencabbage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 49018798, "answer_count": 1, "score": 1, "last_activity_date": 1519769497, "creation_date": 1519767858, "question_id": 49018433, "link": "https://stackoverflow.com/questions/49018433/defining-default-values-as-an-array-in-ruby-results-in-values-being-overwritten", "title": "Defining default values as an array in Ruby results in values being overwritten", "body": "<p>I am working on some code that takes in a <code>sending_destination</code> object (which are instructions on how to send some data to a group of people). </p>\n\n<pre><code>  sending_destination = MyApp::Model::SendingDestination.where(:id =&gt; some_id)\n  destination_hash = Hash.new{ |h,k| h[k] = [] }\n\n  sending_destination.each do |destination|\n    if destination.send_to_group?\n      group_users = destination.address # this retrieves n-number of `User` objects\n      group_users.each do |user|\n        destination[:address] = user.user_id\n        destination_hash[job_signature(destination)] &lt;&lt; destination\n      end\n    end\n  end\n</code></pre>\n\n<p>The above code takes in a <code>destination</code> object, retrieves the <code>user_id</code> of this user, and assigns it to <code>destination</code>'s <code>address</code> field. So let's say I have 3 users of IDs <code>1</code>, <code>2</code>, and <code>3</code> respectfully, then <code>destination[:address]</code> for each user would become 1, 2, and 3.</p>\n\n<p>And this is the definition of <code>job_signature</code>:</p>\n\n<pre><code>private_class_method def self.job_signature(destination)\n  format = destination[:format]\n  \"#{format}|#{!!destination[:apply_formatting]}|#{!!destination[:apply_vis]}|#{destination.id}\"\nend\n</code></pre>\n\n<p>This just generates a string based on the properties within <code>destination</code> and is then the key used per destination for the following <code>destination_hash</code>.</p>\n\n<pre><code>destination_hash[job_signature(destination)] &lt;&lt; destination\n</code></pre>\n\n<p>The above line of code results in the following hash - the <code>:address</code> value would be incremented in each loop where the key is <code>job_signature(destination)</code> and the value is <code>destination</code>.</p>\n\n<pre><code>{\"csv|false|false|1\" =&gt; [\nMyApp::Model::SendDestination {\n  : id =&gt; 1,\n  : scheduled_plan_id =&gt; 1,\n  : type =&gt; \"email_group\",\n  : format =&gt; \"csv\",\n  : address =&gt; \"1\",\n  : apply_formatting =&gt; false,\n  : apply_vis =&gt; false,\n}]}\n</code></pre>\n\n<p>Everything seems to work fine.. except all my values (the <code>MyApp::Model::SendDestination</code> part) within <code>destination_hash</code> gets replaced by the last assigned <code>destination</code> object. For example, one would expect the respective <code>:address</code> of 3 <code>destination</code>s assigned are 1, 2, and 3. But when I print out the <code>destination_hash</code> outside of the <code>.each</code>, all <code>destination</code> objects show the <code>:address</code> of 3.</p>\n\n<p>The following is the resulting <code>destination_hash</code> object. As you can see, the <code>:address</code> value is all <code>3</code>. Instead, it should be 1, 2, and 3.</p>\n\n<pre><code>{\n  \"csv|false|false|1\" =&gt; [\n  MyApp::Model::SendDestination @values = {\n    ... # I removed the unnecessary key-values for demo purposes\n    :address =&gt; \"3\", # this should be \"1\"\n    ...\n  }],\n  \"csv|false|false|2\" =&gt; [\n  MyApp::Model::SendDestination @values = {\n    ...\n    :address =&gt; \"3\", # this should be \"2\"\n    ...\n  }],\n  \"csv|false|false|3\" =&gt; [\n  MyApp::Model::SendDestination @values = {\n    ...\n    :address =&gt; \"3\", # this is correct\n    ...\n  }]\n}\n</code></pre>\n\n<p>So my question is - why are all my destination objects being replaced by the last object assigned? </p>\n"}, {"tags": ["python", "ruby", "gdb"], "answers": [{"comments": [{"owner": {"reputation": 488, "user_id": 2100829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a31c58cd23011c0c4d72cb59d31d5fe8?s=128&d=identicon&r=PG", "display_name": "RedArrow", "link": "https://stackoverflow.com/users/2100829/redarrow"}, "edited": false, "score": 0, "creation_date": 1519933753, "post_id": 49055405, "comment_id": 85119804, "body": "thanks Tom for your answer. i have seen those libraries but i am not sure to continue with them. it seems the best way is  to communicate with python and ruby as you noticed. Since python gdb have large capacity and great capabilities. i could&#39;not find alternative for ruby in that scope."}], "tags": [], "owner": {"reputation": 18871, "user_id": 1442050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e975c669f2ce0f2be4613f1e123864b3?s=128&d=identicon&r=PG", "display_name": "Tom Tromey", "link": "https://stackoverflow.com/users/1442050/tom-tromey"}, "is_accepted": false, "score": 0, "last_activity_date": 1519925099, "creation_date": 1519925099, "answer_id": 49055405, "question_id": 49017606, "link": "https://stackoverflow.com/questions/49017606/invoke-and-control-gdb-from-ruby/49055405#49055405", "title": "invoke and control gdb from ruby", "body": "<p>The best way to interact programmatically with gdb is to simply use gdb's Python layer to do things.  Then you can communicate with it any way that is convenient -- say, by sending JSON messages to it, and having your Python code in gdb respond.</p>\n\n<p>However, the more classic way is to use gdb's MI (\"Machine Interface\"), which is a mode gdb provides where its output is structured in a way that is more readily parsed.</p>\n\n<p>Googling for \"ruby gdb MI\" shows some plausible libraries, like <a href=\"https://github.com/mcarpenter/rubug\" rel=\"nofollow noreferrer\">this one</a>, or <a href=\"https://github.com/eqv/gdb-mi-parser\" rel=\"nofollow noreferrer\">this one</a>.</p>\n"}], "owner": {"reputation": 488, "user_id": 2100829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a31c58cd23011c0c4d72cb59d31d5fe8?s=128&d=identicon&r=PG", "display_name": "RedArrow", "link": "https://stackoverflow.com/users/2100829/redarrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519925099, "creation_date": 1519764177, "question_id": 49017606, "link": "https://stackoverflow.com/questions/49017606/invoke-and-control-gdb-from-ruby", "title": "invoke and control gdb from ruby", "body": "<p>is there any support for ruby to invoke and control gdb. I need gdb control from ruby to send gdb commands for c/c++ debugging sessions.  i need the tool mentioned in the question  given the link below for ruby</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3482869/invoke-and-control-gdb-from-python\">Invoke and control GDB from Python</a> </p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 9164069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a76cf933419cf5da005cdc3cc771d5?s=128&d=identicon&r=PG&f=1", "display_name": "neznidalibor", "link": "https://stackoverflow.com/users/9164069/neznidalibor"}, "is_accepted": true, "score": 2, "last_activity_date": 1519763170, "creation_date": 1519763170, "answer_id": 49017351, "question_id": 49016848, "link": "https://stackoverflow.com/questions/49016848/turning-urls-into-embeds-ruby/49017351#49017351", "title": "Turning URLs into embeds - ruby", "body": "<p>If I understand your question correctly, you want to replace <code>https://www.youtube.com/watch?v=video_id</code> with an iframe that holds your video.</p>\n\n<p>You can do something like this:</p>\n\n<pre><code>url = 'https://www.youtube.com/watch?v=psil6MKUXeE'\n\nvalue = url.match(/v=(.*)$/)[1]\n\ntarget = \"&lt;iframe width='854' height='480' src='https://www.youtube.com/embed/#{value}' frameborder='0' allow='autoplay; encrypted-media' allowfullscreen&gt;&lt;/iframe&gt;\"\n</code></pre>\n\n<p>This will generate the links in the embeded video format that you want, implementing a script is a bit hard with the information you've provided, but putting this inside a loop that contains files and the lines to be replaced should no be hard. If you're working on Linux, you could even do this with <code>sed</code> on the whole repository.</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 1659538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21ebbb44f75e7006dea9750471513b9?s=128&d=identicon&r=PG", "display_name": "shooma", "link": "https://stackoverflow.com/users/1659538/shooma"}, "is_accepted": false, "score": 0, "last_activity_date": 1519764042, "last_edit_date": 1519764042, "creation_date": 1519763590, "answer_id": 49017465, "question_id": 49016848, "link": "https://stackoverflow.com/questions/49016848/turning-urls-into-embeds-ruby/49017465#49017465", "title": "Turning URLs into embeds - ruby", "body": "<pre><code>TEXT = 'your text with links to youtube videos'\n\nurl_regex = /https:\\/\\/www.youtube.com\\/watch\\?v=(\\w+)/\n\niframe_tag = '&lt;iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/\\1?rel=0\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen&gt;&lt;/iframe&gt;'\n\nTEXT.gsub(url_regex, iframe_tag)\n</code></pre>\n\n<p>regex could be simplified to something like <code>/https.+?v=(\\w+)/</code> if all links in text goes to youtube.</p>\n\n<p>you should change <code>iframe_tag</code> params to fit your requirments on autoplay, sizes etc.</p>\n"}], "owner": {"reputation": 2125, "user_id": 796803, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Jq55f.jpg?s=128&g=1", "display_name": "Andre Zimpel", "link": "https://stackoverflow.com/users/796803/andre-zimpel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49017351, "answer_count": 2, "score": 0, "last_activity_date": 1519767369, "creation_date": 1519761052, "last_edit_date": 1519767369, "question_id": 49016848, "link": "https://stackoverflow.com/questions/49016848/turning-urls-into-embeds-ruby", "title": "Turning URLs into embeds - ruby", "body": "<p>I'm currently migrating a Wordpress blog to Contentful. During that migration I want to transform urls, e.g. <code>https://www.youtube.com/watch?v=psil6MKUXeE</code>, into embeds. </p>\n\n<p>Let's say I got this text:</p>\n\n<pre><code>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.\n\nhttps://www.youtube.com/watch?v=psil6MKUXeE\n\nDuis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio.\n\nhttps://www.youtube.com/watch?v=psil6MKUXeE\n\nDignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. \n</code></pre>\n\n<p>How can I extract multiple urls (in this case youtube) and replace them with the youtube embed code?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "testing", "rspec", "tdd"], "comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 1, "creation_date": 1519761326, "post_id": 49016713, "comment_id": 85038800, "body": "If you are using shoulda matchers you need to use  <code>validate_confirmation_of(:password).with_message(&quot;Has\u0142a nie pasuj\u0105 do siebie.&quot;)</code>. It only works with english by default since the expectations are based on the text of the error message."}, {"owner": {"reputation": 3, "user_id": 8614173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f274afab5adb7ac91402b4c5a32fd0f?s=128&d=identicon&r=PG&f=1", "display_name": "Smugller", "link": "https://stackoverflow.com/users/8614173/smugller"}, "reply_to_user": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1519772305, "post_id": 49016713, "comment_id": 85043859, "body": "Thank you very much man!"}], "answers": [{"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": false, "score": 0, "last_activity_date": 1519932481, "creation_date": 1519932481, "answer_id": 49057291, "question_id": 49016713, "link": "https://stackoverflow.com/questions/49016713/ruby-on-rails-testing-user-model-with-rspec-password-and-password-confirmation/49057291#49057291", "title": "Ruby On Rails testing User Model with RSpec - password and password_confirmation doesn&#39;t work properly", "body": "<p>If you read the whole message carefully you'll see</p>\n\n<blockquote>\n  <p>The record was indeed invalid, but it\n       produced these validation errors instead:</p>\n</blockquote>\n\n<p>Which means that the validation failed, but the matcher expects the validation errors to be exactly as specified. And there were more.</p>\n\n<p>You have two options: </p>\n\n<ul>\n<li>add all failed validation expectations in your spec</li>\n<li>prepare the user object in such way that <code>:name</code> and <code>:email</code> are valid.</li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 8614173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f274afab5adb7ac91402b4c5a32fd0f?s=128&d=identicon&r=PG&f=1", "display_name": "Smugller", "link": "https://stackoverflow.com/users/8614173/smugller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519932481, "creation_date": 1519760569, "question_id": 49016713, "link": "https://stackoverflow.com/questions/49016713/ruby-on-rails-testing-user-model-with-rspec-password-and-password-confirmation", "title": "Ruby On Rails testing User Model with RSpec - password and password_confirmation doesn&#39;t work properly", "body": "<p>it's my first post. I start to learn Ruby and Ruby On Rails framework.</p>\n\n<p>I want to test User Model with RSpec and i have problem with pass validation of <strong>password</strong> and <strong>password_confirmation</strong>.</p>\n\n<p>Code: <a href=\"https://github.com/paw3lgora/gCMS/blob/master/spec/models/user_spec.rb\" rel=\"nofollow noreferrer\">https://github.com/paw3lgora/gCMS/blob/master/spec/models/user_spec.rb</a></p>\n\n<p>I have problem with line: <strong>it { should validate_confirmation_of(:password) }</strong></p>\n\n<p>I don't wanna use devise gem or has_secure_password method from BCrypt because i learn Ruby and I want to implement my authentcation systems from scratch and add Argon2 in the future. </p>\n\n<p>This give me error like:</p>\n\n<blockquote>\n  <p>1) User validation password should validate that\n  :password_confirmation matches :password\n       Failure/Error: it { should validate_confirmation_of(:password) }</p>\n\n<pre><code>   User did not properly validate that :password_confirmation matches\n   :password.\n     After setting :password_confirmation to \u2039\"some value\"\u203a, then setting\n     :password to \u2039\"different value\"\u203a, the matcher expected the User to be\n     invalid and to produce the validation error \"doesn't match Password\"\n     on :password_confirmation. The record was indeed invalid, but it\n     produced these validation errors instead:\n\n     * name: [\"Nazwa u\u017cytkownika nie mo\u017ce by\u0107 pusta.\", \"Nazwa u\u017cytkownika\n       jest za kr\u00f3tka. Minimum 2 znaki.\"]\n     * email: [\"Nie poda\u0142e\u015b emaila.\", \"Email jest za kr\u00f3tki. Minimum 5\n       znak\u00f3w.\", \"Poda\u0142e\u015b z\u0142\u0105 nazw\u0119 u\u017cytkownika.\"]\n     * password_confirmation: [\"Has\u0142a nie pasuj\u0105 do siebie.\"]\n # ./spec/models/user_spec.rb:27:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n</blockquote>\n\n<p>Help me guys! :)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "base64", "paperclip", "xlsx"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519757500, "post_id": 49015708, "comment_id": 85036652, "body": "Well, how do you know you have a valid xlsx there?"}, {"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519759417, "post_id": 49015708, "comment_id": 85037712, "body": "I had an xlsx file I convert it to base64 online and tried to decode with ruby and save it"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519760062, "post_id": 49015708, "comment_id": 85038086, "body": "Now do it locally, and compare the strings. Should be equal. Why the online part, again? Ruby is perfectly capable of doing base64 encoding."}, {"owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519760138, "post_id": 49015708, "comment_id": 85038129, "body": "I know. The strings are the same . The problem is the content type ."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519760339, "post_id": 49015708, "comment_id": 85038227, "body": "Well, this <i>is</i> a valid mime type for xlsx. The error is elsewhere."}], "answers": [{"tags": [], "owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "is_accepted": true, "score": 1, "last_activity_date": 1519818403, "creation_date": 1519818403, "answer_id": 49028833, "question_id": 49015708, "link": "https://stackoverflow.com/questions/49015708/ruby-on-rails-save-base64-to-xlsx-or-pdf-or-word-and-save-it-with-paperclip/49028833#49028833", "title": "Ruby on rails save base64 to xlsx (or pdf or word) and save it with paperclip", "body": "<p>I've fixed the issue. The problem was for the content type.When I tried to store the files through <code>rails_admin</code> the file_content_type was :</p>\n\n<pre><code>for xlsx file content_type = \"application/zip\"\nfor csv file content_type = \"text/plain\"\nfor pdf file content_type = \"application/pdf\"\nfor word file content_type = \"application/zip\"\nfor image file content_type = \"image\"\n</code></pre>\n\n<p>But when I was trying to store the base64 file the <code>content_type</code> was quite different as you see below:</p>\n\n<pre><code>for xlsx file content_type = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\nfor csv file content_type = \"text/plain\"\nfor pdf file content_type = \"application/pdf\"\nfor word file content_type = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\nfor image file content_type = \"image/jpg\"\n</code></pre>\n\n<p>So I replaced that correct type and the problem soveld.</p>\n\n<pre><code>decoded_data = Base64.decode64(modified_base64)\ndata = StringIO.new(decoded_data)\ndata.class_eval do\n    attr_accessor :content_type, :original_filename\nend\nif params[:contentType] == \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" \n    @content_type = \"application/zip\"\nelsif params[:contentType] == \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n    @content_type = \"application/zip\"\nelsif params[:contentType] == \"text/plain\" \n    @content_type = \"text/plain\" \nelsif params[:contentType] == \"application/pdf\"\n    @content_type = \"application/pdf\"\nelsif params[:contentType].include?('image')\n    @content_type = \"imgae\"\nend\ndata.content_type = @content_type\ndata.original_filename = params[:file_name]\n</code></pre>\n\n<p>And don't forget to set the file name, for example if the file is <code>xlsx</code> you can name it as <code>sample.xlsx</code> that's a big deal.</p>\n"}], "owner": {"reputation": 2123, "user_id": 5374999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4YXdN.jpg?s=128&g=1", "display_name": "Afsanefda", "link": "https://stackoverflow.com/users/5374999/afsanefda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 968, "favorite_count": 0, "accepted_answer_id": 49028833, "answer_count": 1, "score": 0, "last_activity_date": 1519818403, "creation_date": 1519756675, "question_id": 49015708, "link": "https://stackoverflow.com/questions/49015708/ruby-on-rails-save-base64-to-xlsx-or-pdf-or-word-and-save-it-with-paperclip", "title": "Ruby on rails save base64 to xlsx (or pdf or word) and save it with paperclip", "body": "<p>I have a <code>base64</code> like this which I have generated on-line.It's for an <code>xlsx</code> file. I want to decode it and save it in db with <code>paperclip</code> so I did this :</p>\n\n<pre><code>decoded_data = Base64.decode64(Base64)\ndata = StringIO.new(decoded_data)\ndata.class_eval do\n    attr_accessor :content_type, :original_filename\nend\ndata.content_type = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\nModel.create(file: data)\n</code></pre>\n\n<p>it creates a file and saves it on database but the file is damaged. I've tried it for <code>image</code> with <code>image content type</code> and it's fine but for <code>pdf</code>,<code>word</code> and <code>xlsx</code> it's not fine . Do you have any clue ?\nThanks in advance.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1519757510, "post_id": 49015690, "comment_id": 85036658, "body": "...or  <code>5.times { puts &#39;sorry&#39; } unless [&#39;Beck&#39;, &#39;Led Zeppelin&#39;].include?(artist)</code>."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1519757575, "post_id": 49015690, "comment_id": 85036694, "body": "@CarySwoveland: personally, I&#39;d rather not. :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1519756624, "creation_date": 1519756624, "answer_id": 49015690, "question_id": 49015520, "link": "https://stackoverflow.com/questions/49015520/ruby-is-there-a-shorthand-check-for-two-logical-conditionals-against-one-varia/49015690#49015690", "title": "Ruby - is there a shorthand check for two logical conditionals against one variable", "body": "<pre><code>unless ['Beck', 'Led Zeppelin'].include?(artist)\n  5.times { puts 'sorry' }\nend\n</code></pre>\n\n<p>Isn't any \"shorter\", but no obscure syntax trickery too. Just using regular array api. As a consequence, you can provide that array in any way you want. Load it from a file, for example. With any number of elements.</p>\n"}, {"tags": [], "owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "is_accepted": false, "score": 1, "last_activity_date": 1519757608, "creation_date": 1519757608, "answer_id": 49015979, "question_id": 49015520, "link": "https://stackoverflow.com/questions/49015520/ruby-is-there-a-shorthand-check-for-two-logical-conditionals-against-one-varia/49015979#49015979", "title": "Ruby - is there a shorthand check for two logical conditionals against one variable", "body": "<p>Your specific case is pretty minimal, but if you have lots of unrelated conditions to test for lots of values you can set the tests up as lambdas in an array and use <code>all?</code>.  For instance, the following example filters all the integers between 1 and 100 for those which are > 20, &lt; 50, even, and divisible by 3:</p>\n\n<pre><code>tests = [\n  -&gt;(x) { x &gt; 20 },\n  -&gt;(x) { x &lt; 50 },\n  -&gt;(x) { x.even? },\n  -&gt;(x) { x % 3 == 0 }\n]\n\n(1..100).each do |i|\n  puts i if tests.all? { |test| test[i] }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1519797916, "post_id": 49022157, "comment_id": 85050752, "body": "While this is producing the same side-effects, it is a misuse of case/when, don&#39;t you think? :)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1519793298, "creation_date": 1519793298, "answer_id": 49022157, "question_id": 49015520, "link": "https://stackoverflow.com/questions/49015520/ruby-is-there-a-shorthand-check-for-two-logical-conditionals-against-one-varia/49022157#49022157", "title": "Ruby - is there a shorthand check for two logical conditionals against one variable", "body": "<pre><code>case artist\nwhen 'Beck', 'Led Zeppelin'\nelse\n  5.times { puts 'sorry' }\nend\n</code></pre>\n"}], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 49015690, "answer_count": 3, "score": 0, "last_activity_date": 1519793298, "creation_date": 1519755987, "last_edit_date": 1519765426, "question_id": 49015520, "link": "https://stackoverflow.com/questions/49015520/ruby-is-there-a-shorthand-check-for-two-logical-conditionals-against-one-varia", "title": "Ruby - is there a shorthand check for two logical conditionals against one variable", "body": "<p>How can I shorten this expression?</p>\n\n<pre><code>if artist != 'Beck' &amp;&amp; artist != 'Led Zeppelin'\n  5.times { puts 'sorry' }\nend\n</code></pre>\n\n<p>Is there a shorthand check for two logical conditionals against one variable?</p>\n\n<hr>\n\n<p>As an aside, this turned into</p>\n\n<pre><code>class String\n  def is_not?(*arr)\n    !arr.include?(self)\n  end\nend\n</code></pre>\n\n<p>In our project.</p>\n\n<p>Now we can do <code>'foo'.is_not?('bar', 'batz')</code></p>\n"}, {"tags": ["ruby", "logstash", "elastic-stack"], "answers": [{"tags": [], "owner": {"reputation": 1962, "user_id": 370532, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nc6yi.jpg?s=128&g=1", "display_name": "DeezCashews", "link": "https://stackoverflow.com/users/370532/deezcashews"}, "is_accepted": true, "score": 1, "last_activity_date": 1519770938, "creation_date": 1519770938, "answer_id": 49019080, "question_id": 49015500, "link": "https://stackoverflow.com/questions/49015500/simple-ruby-filter-in-logstash/49019080#49019080", "title": "Simple ruby filter in Logstash", "body": "<p>Well I should have gone further and simplified even more.  I still received the error even after removing then entire <code>ruby { }</code> section which meant my issue was elsewhere.  Sorry to waste viewing time.  I found my issue with another filters <code>add_field</code> not working correctly.  Lesson learned: Make one change at a time and test...</p>\n"}], "owner": {"reputation": 1962, "user_id": 370532, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nc6yi.jpg?s=128&g=1", "display_name": "DeezCashews", "link": "https://stackoverflow.com/users/370532/deezcashews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "accepted_answer_id": 49019080, "answer_count": 1, "score": 3, "last_activity_date": 1519770938, "creation_date": 1519755918, "question_id": 49015500, "link": "https://stackoverflow.com/questions/49015500/simple-ruby-filter-in-logstash", "title": "Simple ruby filter in Logstash", "body": "<p>I kept running into a wall trying to get a ruby file to work for a filter and I finally simplified my config file to simply this:</p>\n\n<pre><code>filter {\n    ruby {\n        code =&gt; \"event.cancel\"\n    }\n}\n</code></pre>\n\n<p>But even with this simple example, running logstash.bat -t gives me the following:</p>\n\n<blockquote>\n  <p>The given configuration is invalid. Reason: uninitialized constant LogStashCompilerLSCLGrammar::LogStash::Compiler::LSCL::AST::Hash::ConfigurationError</p>\n</blockquote>\n\n<p>Can anyone point me in the right direction to get a ruby filter to work at all?  Same thing happening with fresh install of 6.2.2.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "edited": false, "score": 0, "creation_date": 1519761914, "post_id": 49015515, "comment_id": 85039100, "body": "Good answer but that factory method should be something like <code>def self.create_for_country(attributes)</code> and should take whitelisted attributes from the controller as models cannot access <code>request</code> and whitelisting is a controller concern."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1519764606, "last_edit_date": 1519764606, "creation_date": 1519755962, "answer_id": 49015515, "question_id": 49015403, "link": "https://stackoverflow.com/questions/49015403/how-to-use-request-variable-in-model/49015515#49015515", "title": "how to use request variable in model?", "body": "<p>The thing to keep in mind is that declarations like <code>devise</code> happen when the model is loaded, something that's normally done once and once only in production mode, so you can't add any behaviour that's conditional based on what might happen in the future when <code>country</code> is actually defined.</p>\n\n<p>What you can do is subclass your model using \"Single Table Inheritance\" (STI) to have two different kinds of users:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\nend\n\nclass GenericUser &lt; User\n  devise :invitable, ...\nend\n\nclass UkUser &lt; User\n  devise :invitable, ..., omniauth_providers: [ ... ]\nend\n</code></pre>\n\n<p>This involves adding a string <code>type</code> column to your schema, but is otherwise minimally impacting. In your controller you'll have to create the appropriate user type as well:</p>\n\n<pre><code>@user =\n  case (country)\n  when 'uk'\n    UkUser.create(params[:user])\n  else\n    GenericUser.create(params[:user])\n  end\n</code></pre>\n\n<p>Or some variation of that pattern. You can also create a factory method:</p>\n\n<pre><code>class User\n  def self.create_for_country(params)\n    model_type =\n      case (params[:user][:country])\n      when 'uk'\n        UkUser\n      else\n        GenericUser\n      end\n\n    model_type.create(params[:user])\n end\n</code></pre>\n"}], "owner": {"reputation": 16, "user_id": 4173419, "user_type": "registered", "profile_image": "https://graph.facebook.com/1134045718/picture?type=large", "display_name": "Ugolino", "link": "https://stackoverflow.com/users/4173419/ugolino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519764606, "creation_date": 1519755552, "question_id": 49015403, "link": "https://stackoverflow.com/questions/49015403/how-to-use-request-variable-in-model", "title": "how to use request variable in model?", "body": "<p>I have an app with different countries based on the domain of the request.</p>\n\n<p>I have a country model and based on the request it loads the locale.</p>\n\n<p>Now I have an issue with the user model. The countries have different user login, i.e. one country has the CAS for the SSO and another one has the normal registration.</p>\n\n<p>I am using Devise and I would like to check the country first and then add an IF in the user model to check the country and load the devise configuration for that country. </p>\n\n<p>Something like</p>\n\n<pre><code>if country == \"uk\"\ndevise :invitable, :database_authenticatable, :registerable,\n     :recoverable, :trackable, :validatable, :timeoutable,\n     :omniauthable, :omniauth_providers =&gt; [:facebook, :google_oauth2]\nelse\ndevise :invitable, :cas_authenticatable, :registerable,\n      :recoverable, :trackable, :validatable, :timeoutable\nend\n</code></pre>\n\n<p>How can I check the country and then apply an if statement in the model?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["ruby", "selenium", "selenium-chromedriver", "google-chrome-headless"], "answers": [{"tags": [], "owner": {"reputation": 784, "user_id": 998793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fcd504e11dcc87790272b673596ec073?s=128&d=identicon&r=PG", "display_name": "rogersillito", "link": "https://stackoverflow.com/users/998793/rogersillito"}, "is_accepted": false, "score": 0, "last_activity_date": 1545336319, "last_edit_date": 1545336319, "creation_date": 1521542149, "answer_id": 49381932, "question_id": 49015203, "link": "https://stackoverflow.com/questions/49015203/chromedriver-remote-debugging-port-with-selenium/49381932#49381932", "title": "Chromedriver remote-debugging-port with Selenium", "body": "<hr>\n\n<p><strong>Update: if using versions since Chrome 67/chromedriver 2.39, <a href=\"https://stackoverflow.com/a/50876153/998793\">my alternative answer above provides a simpler solution</a></strong></p>\n\n<hr>\n\n<p>The core issue here is Chromedriver also uses the remote debugging port connection to communicate with Chrome.   This uses the websocket protocol, which only supports a single-client connected at a time.   Normally, when chromedriver starts the chromedriver process, it will choose a random free TCP port number and use this to access the remote debug port.  If you specify <code>--remote-debuggging-port=9222</code> however, Chrome will be opened with the debug port you have requested, but chromedriver will silently continue to try and open a connection using this <em>random</em> port number.</p>\n\n<p>The solution I ended up with was heavily inspired by <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=878#c20\" rel=\"nofollow noreferrer\"><em>comment 20</em> in this chromedriver issue</a>.  It required quite a bit of code to get it working, but works solidly.  It  makes uses of a nodejs library, <a href=\"https://github.com/sidorares/crmux\" rel=\"nofollow noreferrer\">crmux</a> - which allows multiple clients to connect to the remote debug port of chrome at the same time.</p>\n\n<ol>\n<li>Get nodejs installed first:  <a href=\"https://nodejs.org/download/release/v9.7.0/\" rel=\"nofollow noreferrer\">Nodejs v9.7.0</a> works fine</li>\n<li>Install crmux by running <code>npm install crmux -g</code></li>\n<li><strong>Before</strong> you start chromedriver (<code>Capybara::Selenium::Driver.new</code>),  you need to <code>spawn</code> a separate thread that will do a few things: look for the remote debug port chromedriver is trying to use to connect to chrome, and then use this to fire up <code>crmux</code>.  Once this has happened Capybara etc will work as normal.</li>\n<li>My separate thread runs a ruby script that first executes a netstat command repeatedly until it finds the relevant entry for chromedriver (TCP status is SYN_SENT). <em>This separate thread must continue to run in the background while chrome is up and running</em>.</li>\n</ol>\n\n<p>The code for this is:</p>\n\n<pre><code>$chrdrv_wait_timeout = 60\n$chrdrv_exe = \"chromedriver.exe\"\n\ndef get_netstat_output\n  stdout = `netstat -a -b -n`\n  stat_lines = stdout.split(\"\\n\")\n  stat_lines\nend\n\ndef try_get_requested_port\n  socket_state = \"SYN_SENT\" # i.e. sent with no reply\n  statout = get_netstat_output\n  n = statout.length\n  i = 0\n  loop do\n    i += 1\n    # find lines relating to chromedriver\n    exe_match = /^ +\\[#{$chrdrv_exe}\\]$/.match statout[i]\n    if exe_match != nil\n      # check preceeding lines which should contain port info\n      port_match = /TCP.*:([0-9]+)\\W+#{socket_state}/.match statout[i-1]\n      if port_match != nil\n        return port_match[1].to_i\n      end\n    end\n    break unless i &lt; n\n  end\n  return nil\nend\n\ndef get_tcp_port_requested_by_chromedriver\n  i = 1\n  loop do\n    puts \"Waiting for #{$chrdrv_exe}: #{i}\"\n    port = try_get_requested_port\n    if port != nil\n      return port\n    end\n    break unless i &lt; $chrdrv_wait_timeout\n    sleep 1\n    i += 1\n  end\n  raise Exception, \"Failed to get TCP port requested by #{$chrdrv_exe} (gave up after #{$chrdrv_wait_timeout} seconds)\"\nend\n</code></pre>\n\n<p>(I'm working in Windows: for Mac/Linux the netstat syntax/output is probably different so the code will need adjustment; the key thing is you need it to <em>output the executable owner</em> of each connection entry - and parse the bit relating to chromedriver to get the port in question).</p>\n\n<ol start=\"5\">\n<li><p>Once this has found the random port (I'll use <em>12225</em> as an example), the background ruby script can then execute a crmux process, which will reunite chromedriver with chrome itself via the port <em>you</em> specified in Capybara (4444):</p>\n\n<p><code>crmux --port=4444 --listen=12225</code></p></li>\n<li><p>Finally, this separate script saves the discovered listen port to a text file.  This allows the main script/thread that is running capybara to know the port number it can use to get access to chrome (via crmux's multiplexed connection) by reading in the port from that file. So you can then use <a href=\"https://github.com/cavalle/chrome_remote\" rel=\"nofollow noreferrer\">chrome_remote</a> to access chrome using port <em>12225</em>, for example, while capybara is doing its thing.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 8357, "user_id": 47185, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/47f28e60db02c75ca0fae638bb3e8304?s=128&d=identicon&r=PG", "display_name": "Tyler Rick", "link": "https://stackoverflow.com/users/47185/tyler-rick"}, "edited": false, "score": 0, "creation_date": 1545344011, "post_id": 50876153, "comment_id": 94600851, "body": "It doesn&#39;t seem to work when <code>--port</code> and <code>--listen</code> are set to the same port. Is that a typo? (<code>chrome</code> gives ` bind() returned an error, errno=98: Address already in use` if <code>crmux</code> is already listening to the port.) How did you get this to work? I&#39;m not clear yet which things to point to which ports. Could you edit your answer with example source code?"}, {"owner": {"reputation": 8357, "user_id": 47185, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/47f28e60db02c75ca0fae638bb3e8304?s=128&d=identicon&r=PG", "display_name": "Tyler Rick", "link": "https://stackoverflow.com/users/47185/tyler-rick"}, "edited": false, "score": 1, "creation_date": 1545345173, "post_id": 50876153, "comment_id": 94601211, "body": "Oops, part of my problem that I was using chromedriver 2.37, not 2.39+. Upgrading to 2.45 fixed the first of my problems (that <code>Selenium::WebDriver::Chrome</code> hung when trying to handshake). Now to figure out the ports..."}, {"owner": {"reputation": 8357, "user_id": 47185, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/47f28e60db02c75ca0fae638bb3e8304?s=128&d=identicon&r=PG", "display_name": "Tyler Rick", "link": "https://stackoverflow.com/users/47185/tyler-rick"}, "edited": false, "score": 2, "creation_date": 1545353194, "post_id": 50876153, "comment_id": 94603057, "body": "I finally figured it out: You can set the Chrome <code>--remote-debugging-port</code> to whatever you want using <code>browser_options.args &lt;&lt; &quot;--remote-debugging-port=9222&quot;</code> (default is 0, which makes it choose random port). (Setting the port like this works regardless of whether using crmux.) Then you set up <code>crmux</code> to listen on a <i>different</i> port, like 9223 (the default), but you have to pass <code>--port 9222</code> with the <i>same</i> port as Chrome&#39;s &quot;--remote-debugging-port&quot; because that it is the port it proxies traffic <i>to</i>. Now you can connect to crmux&#39;s <i>listen</i> port from <code>chrome_remote</code>, another browser, etc."}, {"owner": {"reputation": 8357, "user_id": 47185, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/47f28e60db02c75ca0fae638bb3e8304?s=128&d=identicon&r=PG", "display_name": "Tyler Rick", "link": "https://stackoverflow.com/users/47185/tyler-rick"}, "edited": false, "score": 2, "creation_date": 1545372601, "post_id": 50876153, "comment_id": 94606767, "body": "In case you&#39;re interested, I wrote a gem to help integrate crmux and chrome_remote with Capybara similar to how you did it: <a href=\"https://github.com/TylerRick/capybara-chrome_dev_tools\" rel=\"nofollow noreferrer\">github.com/TylerRick/capybara-chrome_dev_tools</a>. Please let me know or contribute if you have any suggestions or improvements. I also added <a href=\"https://github.com/TylerRick/capybara-chrome_response_headers\" rel=\"nofollow noreferrer\">github.com/TylerRick/capybara-chrome_response_headers</a> which uses <code>chrome_remote</code> to give you <code>response_headers</code> and <code>status_code</code> in your tests."}, {"owner": {"reputation": 784, "user_id": 998793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fcd504e11dcc87790272b673596ec073?s=128&d=identicon&r=PG", "display_name": "rogersillito", "link": "https://stackoverflow.com/users/998793/rogersillito"}, "reply_to_user": {"reputation": 8357, "user_id": 47185, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/47f28e60db02c75ca0fae638bb3e8304?s=128&d=identicon&r=PG", "display_name": "Tyler Rick", "link": "https://stackoverflow.com/users/47185/tyler-rick"}, "edited": false, "score": 0, "creation_date": 1546598327, "post_id": 50876153, "comment_id": 94909774, "body": "@TylerRick - <code>--port</code> and <code>--listen</code> were intentionally set to the same port.  <i>I agree completely that this shouldn&#39;t work</i> - however it does in my case.  I&#39;m also setting <code>--remote-debugging-port</code> as you describe when starting chrome itself.   I&#39;m working in a Windows environment...   Great work on the gem BTW."}], "tags": [], "owner": {"reputation": 784, "user_id": 998793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fcd504e11dcc87790272b673596ec073?s=128&d=identicon&r=PG", "display_name": "rogersillito", "link": "https://stackoverflow.com/users/998793/rogersillito"}, "is_accepted": false, "score": 6, "last_activity_date": 1530094202, "last_edit_date": 1530094202, "creation_date": 1529067551, "answer_id": 50876153, "question_id": 49015203, "link": "https://stackoverflow.com/questions/49015203/chromedriver-remote-debugging-port-with-selenium/50876153#50876153", "title": "Chromedriver remote-debugging-port with Selenium", "body": "<p>Since <a href=\"https://bugs.chromium.org/p/chromedriver/issues/detail?id=2161\" rel=\"nofollow noreferrer\">chrome 67 and chromedriver 2.39</a>, chromedriver now correctly uses the port you specify with <code>--remote-debugging-port</code>.   This removes quite a bit of complexity <a href=\"https://stackoverflow.com/a/49381932/998793\">from my answer above</a>.  The steps I now take, which work for my use case of needing to configure download settings using <a href=\"https://github.com/cavalle/chrome_remote\" rel=\"nofollow noreferrer\">chrome_remote</a>, are as follows: </p>\n\n<p>It  makes uses of a nodejs library, <a href=\"https://github.com/sidorares/crmux\" rel=\"nofollow noreferrer\">crmux</a> - which allows multiple clients to connect to the remote debug port of chrome at the same time.</p>\n\n<ol>\n<li>Get nodejs installed first:  <a href=\"https://nodejs.org/download/release/v9.7.0/\" rel=\"nofollow noreferrer\">Nodejs v9.7.0</a> works fine</li>\n<li>Install crmux by running <code>npm install crmux -g</code></li>\n<li><p><strong>Before</strong> you start chromedriver (<code>Capybara::Selenium::Driver.new</code>),  you need to <code>spawn</code> a separate thread that will fire up <code>crmux</code>, which will let both you and chromedriver communicate with chrome itself via the port <em>you</em> specified in Capybara (4444):</p>\n\n<p><code>crmux --port=4444 --listen=4444</code></p></li>\n<li><p>You may want to add a <code>sleep 3</code> after the <code>spawn</code> command in the main script/thread to give time for crmux to start before you continue with your test startup.</p></li>\n</ol>\n\n<p>You can then use <a href=\"https://github.com/cavalle/chrome_remote\" rel=\"nofollow noreferrer\">chrome_remote</a> (for example) to access chrome using port <em>4444</em>, while capybara is doing its thing.</p>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 6880272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwKfm.jpg?s=128&g=1", "display_name": "Calaway", "link": "https://stackoverflow.com/users/6880272/calaway"}, "is_accepted": false, "score": 3, "last_activity_date": 1529084399, "creation_date": 1529084399, "answer_id": 50880390, "question_id": 49015203, "link": "https://stackoverflow.com/questions/49015203/chromedriver-remote-debugging-port-with-selenium/50880390#50880390", "title": "Chromedriver remote-debugging-port with Selenium", "body": "<p>Updating my ChromeDriver fixed it for me. I didn't have to do anything else. Before it would hang when attempting to start the test.</p>\n\n<p>Specifically I was on ChromeDriver 2.36 and I upgraded to ChromeDriver 2.40. I don't think the Chrome version was a problem, since I was on Chrome 67 both before and after.</p>\n\n<p>Here's how I'm registering the driver:</p>\n\n<pre><code>Capybara.register_driver :headless_chrome do |app|\n  capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(\n    chromeOptions: { args: %w[headless window-size=1280,960 remote-debugging-port=9222] }\n  )\n  Capybara::Selenium::Driver.new(app, browser: :chrome, desired_capabilities: capabilities)\nend\n</code></pre>\n\n<p>After that I ran my test with a debugger (<code>binding.pry</code>) placed where I wanted to inspect. Then when I hit the debugger I navigated to <a href=\"http://localhost:9222/\" rel=\"nofollow noreferrer\">http://localhost:9222/</a> in a normal instance of Chrome and was able to follow a link to view what was happening in the headless Chrome instance, including the browser console output I needed.</p>\n"}], "owner": {"reputation": 1847, "user_id": 2611078, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/a4d6410b45d0deeeee4a144e75067afc?s=128&d=identicon&r=PG", "display_name": "Julie", "link": "https://stackoverflow.com/users/2611078/julie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10329, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1545336319, "creation_date": 1519754794, "last_edit_date": 1521823204, "question_id": 49015203, "link": "https://stackoverflow.com/questions/49015203/chromedriver-remote-debugging-port-with-selenium", "title": "Chromedriver remote-debugging-port with Selenium", "body": "<p>I am using Capybara Selenium to run headless Chrome, which works great, except I cannot figure out how to use remote debugging.  When I add <code>--remote-debugging-port=4444</code> or <code>--remote-debugging-port=9222</code> or <code>--remote-debugging-port=9521</code>, Selenium no longer connects to the browser to run the test.</p>\n\n<p>How do I get remote debugging to work?  Here is my code for reference:</p>\n\n<pre><code>Capybara.register_driver :selenium do |app|\n  # from https://github.com/SeleniumHQ/selenium/issues/3738\n  capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(loggingPrefs: {browser: 'ALL'})\n  options = Selenium::WebDriver::Chrome::Options.new\n  options.add_argument '--disable-infobars' # hide info bar about chrome automating test\n  # if we don't use this flag, every selenium test will die with the error:\n  # \"unknown error: Chrome failed to start: exited abnormally\"\n  options.add_argument '--no-sandbox'\n  # BREAKS THINGS if uncommented\n  # options.add_argument '--remote-debugging-port=4444'\n  options.add_argument '--headless'\n  options.add_argument '--window-size=1600,2400'\n  options.add_preference('profile.default_content_settings.popups', 0)\n  options.add_preference('download.default_directory', DownloadHelpers::PATH.to_s)\n  Capybara::Selenium::Driver.new(\n    app,\n    clear_local_storage: true,\n    clear_session_storage: true,\n    browser: :chrome,\n    options: options,\n    desired_capabilities: capabilities,\n  )\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1519753535, "creation_date": 1519753535, "answer_id": 49014866, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes/49014866#49014866", "title": "Compare two arrays of hashes and calculate position changes", "body": "<p>Assuming there are no duplicated <code>id</code>s:</p>\n\n<pre><code>in1 = [\n   {:position=&gt;1, :id=&gt;\"GBMMV1800001\"},   \n   {:position=&gt;2, :id=&gt;\"GBMMV1800002\"},   \n   {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}  \n]  \nin2 = [\n   {:position=&gt;1, :id=&gt;\"GBMMV1800001\"},   \n   {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},  \n   {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}  \n]  \n[in1, in2].map do |a|\n  a.group_by { |h| h[:id] }\nend.reduce do |h1, h2|\n  h1.merge(h2) do |k, v1, v2|\n    v2.first.merge(change: v1.first[:position] - v2.first[:position])\n  end\nend.values.sort_by { |h| h[:position] }\n#\u21d2 [{:position=&gt;1, :id=&gt;\"GBMMV1800001\", :change=&gt;0},\n#   {:position=&gt;2, :id=&gt;\"GBMMV1800003\", :change=&gt;1},\n#   {:position=&gt;3, :id=&gt;\"GBMMV1800002\", :change=&gt;-1}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519754153, "post_id": 49014942, "comment_id": 85034870, "body": "You are abusing <code>each</code>, use <code>each_with_object({})</code> instead: <code>vals = h1.each_with_object({}) { |val|vals[val[:id]] = [val[:position]] }</code>."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519754874, "post_id": 49014942, "comment_id": 85035257, "body": "@mudasobwa How is it abuse?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519754962, "post_id": 49014942, "comment_id": 85035308, "body": "each is for iterating, not for reducing."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519754994, "post_id": 49014942, "comment_id": 85035323, "body": "@mudasobwa Looks like iteration to me. Yours doesn&#39;t work, btw."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519755122, "post_id": 49014942, "comment_id": 85035404, "body": "Ah, indeed I forgot an accumulator in block params. Iteration should not have side effects."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519755230, "post_id": 49014942, "comment_id": 85035458, "body": "@mudasobwa &quot;Iteration should not have side effects&quot;? Says who? And what are the &quot;side effects&quot; there?"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519755475, "post_id": 49014942, "comment_id": 85035582, "body": "@mudasobwa To answer my own &quot;says who&quot; question: Apparently <a href=\"https://www.google.com/search?q=&quot;Iteration+should+not+have+side+effects&quot;\" rel=\"nofollow noreferrer\"><i>nobody</i></a> other than you (that google search says <i>&quot;No results found for &quot;Iteration should not have side effects&quot;.&quot;</i>)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519756230, "post_id": 49014942, "comment_id": 85035975, "body": "@StefanPochmann I agree with @mudasobwa that each_with_object is better, it&#39;s not like a <i>the lord doth decree</i> type prescription but I do consider it &#39;cleaner&#39; to avoid side effects whenever possible. I used <code>each</code> just since it makes the code a little more digestable and my goal was to make OP understand the concept and not just give the most concise efficient code possible. Also keep in mind that my code doesn&#39;t give the same output structure as OP asked either."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519756475, "post_id": 49014942, "comment_id": 85036111, "body": "@StefanPochmann the idea of avoiding side effects comes from functional programming. there are a lot of people who like to use those concepts and even languages which have almost no side effects."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519756499, "post_id": 49014942, "comment_id": 85036125, "body": "@maxpleaner I still don&#39;t see what you guys mean with &quot;side effect&quot;. Pure iteration is pointless. Doing something with the iterated elements is not a side effect but an effect."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519756869, "post_id": 49014942, "comment_id": 85036324, "body": "@StefanPochmann you can think of the difference between <code>map</code>/<code>reduce</code> and <code>each</code>. With map or reduce you use the return value, with each you don&#39;t. <code>each_with_object</code> is more like <code>reduce</code> since you use the return value, Rather than modiying the <code>vals</code> hash, you would create a new hash with modified values. I would advise googling on the topic of &quot;what is side effects free code&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519796648, "post_id": 49014942, "comment_id": 85050322, "body": "@StefanPochmann Max Pleaner has basically already explained the difference, I\u2019d add my &#162;2. There are three types of \u201cenumerating\u201d: iteration, mapping, reducing. The former just walks over (e.g. to print values.) In FP iteration even <i>cannot</i> change/collect anything. Mapping does 1-to-1 isomorphism. Reducing produces \u201canything\u201d out of values. Of course, one might iterate with <code>loop.with_index { |_, i| break if i &gt;= array.length }</code> or map with <code>array.reduce([]) { |acc, e| acc &lt;&lt; e }</code>, but this is what I called abusing. The intent should be clear wherever possible. Here it\u2019s reducing, not iter."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519822299, "post_id": 49014942, "comment_id": 85064256, "body": "@mudasobwa Mmh, I think the intent <i>is</i> clear there. Did you actually look at that little piece of code and it wasn&#39;t clear to you what it&#39;s doing? I think it&#39;s <i>more</i> clear than your alternative, as it&#39;s significantly less code. And I&#39;d say it&#39;s a little simpler, <i>as you proved by screwing yours up</i> :-P. Also, is printing not also a &quot;side effect&quot;?  And the style guide does something similar as well (see <a href=\"https://github.com/bbatsov/ruby-style-guide#safe-because-unsafe\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/bbatsov/ruby-style-guide#concat-strings\" rel=\"nofollow noreferrer\">this</a>) and says nothing against it, I think."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519823070, "post_id": 49014942, "comment_id": 85064794, "body": "... @mudasobwa One more question: &quot;Mapping does 1-to-1 isomorphism&quot;? In what way? For example <code>map(&amp;:odd?)</code> is clearly no isomorphism."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519823662, "post_id": 49014942, "comment_id": 85065171, "body": "@StefanPochmann yes, indeed, it\u2019s not an isomorphism, it\u2019s just mapping. Still, I am positive you would agree that <code>a = []; [1,2,3].each { |e| a &lt;&lt; e * e }</code> should be better written as mapping <code>a = [1,2,3].map { |e| e * e }</code>, and I am unsure why you defend reducing should be written as plain iteration. Also, declaring a local variable upfront and modifying it inside a loop breaks SRP and introduces a responsibility leak. Reducer is easily convertible to every language, while <code>each</code> cannot be ported to any functional language. When I see <code>each</code> I expect the iteration, not a cumbersome reducer."}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519825328, "post_id": 49014942, "comment_id": 85066338, "body": "@mudasobwa Yes, I find <code>map</code> much better there. I had actually done <code>h1.map { |h| [h[:id], h[:position]] }.to_h</code> here. And you&#39;re putting words in my mouth. I&#39;m <i>not</i> saying it &quot;should be written as plain iteration&quot;. I&#39;m just saying I find that <i>ok</i>. You&#39;re the one saying it should be done one way and not another, not me. I&#39;m btw not sure why you apparently think everybody needs to care about functional languages and that it&#39;s not easy to convert that <code>each</code> solution (I mean, except for your mistake you probably had no trouble transforming it to your beloved <code>each_with_object</code>, did you?)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "edited": false, "score": 0, "creation_date": 1519825606, "post_id": 49014942, "comment_id": 85066545, "body": "@StefanPochmann well, ok :) My point is it\u2019s always better to use reducers to reduce, mappers to map and iterators to iterate. That way people reading the code would expect the respective action based on the method chosen. Within this example it\u2019s evident, but the block might have 10LOCs and many people won\u2019t expect <code>each</code> to mutate something defined upfront. Maybe I have this feeling because I do not ruby anymore."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1519753843, "creation_date": 1519753843, "answer_id": 49014942, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes/49014942#49014942", "title": "Compare two arrays of hashes and calculate position changes", "body": "<p>Given</p>\n\n<pre><code>h1 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800002\"}, \n  {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}\n]\n\nh2 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}\n]\n</code></pre>\n\n<p>I want to get a map of <code>{ id =&gt; [position1, position2] }</code>.</p>\n\n<p>To start out I iterate through h1 to get its positions</p>\n\n<pre><code>vals = {}\nh1.each do |val|\n  vals[val[:id]] = [val[:position]]\nend\n</code></pre>\n\n<p>Now vals equals </p>\n\n<pre><code>{\n  \"GBMMV1800001\" =&gt; [1],\n  \"GBMMV1800002\" =&gt; [2],\n  \"GBMMV1800003\" =&gt; [3]\n}\n</code></pre>\n\n<p>Then I iterate through the second array, adding its positions.</p>\n\n<pre><code>h2.each do |val|\n  # This will ignore ids that aren't present in h1\n  next unless vals[val[:id]]\n  vals[val[:id]].push val[:position]\nend\n</code></pre>\n\n<p>Now I have all the data I need to calculate the diffs:</p>\n\n<pre><code>{\n  \"GBMMV1800001\" =&gt; [1, 1],\n  \"GBMMV1800002\" =&gt; [2, 3],\n  \"GBMMV1800003\" =&gt; [3, 2]\n}\n</code></pre>\n\n<p>To get the diffs I would use <code>transform_values</code> is available with ruby 2.4 or with active support. You could alternatively use <code>reduce</code> or <code>each_with_object</code> by the way.</p>\n\n<pre><code>diffs = vals.transform_values { |(pos1, pos2)| pos2 - pos1 }\n</code></pre>\n\n<p>This makes use of <a href=\"http://tony.pitluga.com/2011/08/08/destructuring-with-ruby.html\" rel=\"nofollow noreferrer\">destructuring</a> in the block arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "is_accepted": false, "score": 0, "last_activity_date": 1519770916, "creation_date": 1519770916, "answer_id": 49019075, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes/49019075#49019075", "title": "Compare two arrays of hashes and calculate position changes", "body": "<p>This seems to do the trick</p>\n\n<pre><code>def get_position_changes array0, array1\n  array1.map.with_index do |hash1, index|\n    new_hash = hash1.dup\n    new_hash[:change] = array0.index {|hash0| hash0[:id] == hash1[:id]} - index\n    new_hash\n  end\nend\n\nfirst_array = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800002\"}, \n  {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}\n]\n\nsecond_array = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}\n]\n\np get_position_changes(first_array, second_array)\n\n#=&gt; [\n#=&gt;   {:position=&gt;1, :id=&gt;\"GBMMV1800001\", :change=&gt;0}\n#=&gt;   {:position=&gt;2, :id=&gt;\"GBMMV1800003\", :change=&gt;1}\n#=&gt;   {:position=&gt;3, :id=&gt;\"GBMMV1800002\", :change=&gt;-1}\n#=&gt; ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1519784488, "creation_date": 1519784488, "answer_id": 49021010, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes/49021010#49021010", "title": "Compare two arrays of hashes and calculate position changes", "body": "<pre><code>chart1 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800002\"}, \n  {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}\n]\n\nchart2 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}\n]\n\nh = chart1.each_with_index.with_object({}) { |(g,i),h| h[g[:id]] = i }\n  #=&gt; {\"GBMMV1800001\"=&gt;0, \"GBMMV1800002\"=&gt;1, \"GBMMV1800003\"=&gt;2}\nchart2.each_with_index.map { |g,i| g.merge(change: h[g[:id]] - i) }\n  #=&gt; [{:position=&gt;1, :id=&gt;\"GBMMV1800001\", :change=&gt;0},\n  #    {:position=&gt;2, :id=&gt;\"GBMMV1800003\", :change=&gt;1},\n  #    {:position=&gt;3, :id=&gt;\"GBMMV1800002\", :change=&gt;-1}]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1519796875, "post_id": 49022286, "comment_id": 85050391, "body": "<code>change: b2[k] - b2[k]</code> should be read somehow else :) Also, you might consider returning what OP asked (changes against <code>h1</code>, yours is vice versa.)"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 0, "last_activity_date": 1519798867, "last_edit_date": 1519798867, "creation_date": 1519794204, "answer_id": 49022286, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes/49022286#49022286", "title": "Compare two arrays of hashes and calculate position changes", "body": "<p>The structure you started with:</p>\n\n<pre><code>h1 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800002\"}, \n  {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}\n]\nh2 = [\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}\n]\n</code></pre>\n\n<p>is not appropriate. You should have instead started with structures like:</p>\n\n<pre><code>a1 = h1.map{|h| h[:id]} # =&gt; [\"GBMMV1800001\", \"GBMMV1800002\", \"GBMMV1800003\"]\na2 = h2.map{|h| h[:id]} # =&gt; [\"GBMMV1800001\", \"GBMMV1800003\", \"GBMMV1800002\"]\n</code></pre>\n\n<p>Given above,</p>\n\n<pre><code>b1 = a1.map.with_index(1).to_h\n# =&gt; {\"GBMMV1800001\"=&gt;1, \"GBMMV1800002\"=&gt;2, \"GBMMV1800003\"=&gt;3}\nb2 = a2.map.with_index(1).to_h\n# =&gt; {\"GBMMV1800001\"=&gt;1, \"GBMMV1800003\"=&gt;2, \"GBMMV1800002\"=&gt;3}\nb1.keys.map{|k| {id: k, position: b1[k], change: b2[k] - b1[k]}}\n# =&gt; [\n#      {:id=&gt;\"GBMMV1800001\", :position=&gt;1, :change=&gt;0},\n#      {:id=&gt;\"GBMMV1800002\", :position=&gt;2, :change=&gt;1},\n#      {:id=&gt;\"GBMMV1800003\", :position=&gt;3, :change=&gt;-1}\n#    ]\n</code></pre>\n"}], "owner": {"reputation": 1679, "user_id": 1180092, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2b9eecfea2466228e3e3f51d86d1d2a3?s=128&d=identicon&r=PG", "display_name": "Raoot", "link": "https://stackoverflow.com/users/1180092/raoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49014866, "answer_count": 5, "score": 0, "last_activity_date": 1519798867, "creation_date": 1519752943, "last_edit_date": 1519793459, "question_id": 49014709, "link": "https://stackoverflow.com/questions/49014709/compare-two-arrays-of-hashes-and-calculate-position-changes", "title": "Compare two arrays of hashes and calculate position changes", "body": "<p>I am trying to take two arrays of hashes that contain the position for IDs, and return the position change. The data are from charts scraped on different dates. </p>\n\n<p>If chart 1 from 2018-01-01 contains:</p>\n\n<pre><code>[\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800002\"}, \n  {:position=&gt;3, :id=&gt;\"GBMMV1800003\"}\n]\n</code></pre>\n\n<p>and chart 2 from 2018-01-07 contains:</p>\n\n<pre><code>[\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\"}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\"},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\"}\n]\n</code></pre>\n\n<p>how do I produce a result that will show the position change?</p>\n\n<pre><code>[\n  {:position=&gt;1, :id=&gt;\"GBMMV1800001\", :change=&gt;0}, \n  {:position=&gt;2, :id=&gt;\"GBMMV1800003\", :change=&gt;1},\n  {:position=&gt;3, :id=&gt;\"GBMMV1800002\", :change=&gt;-1} \n]\n</code></pre>\n"}, {"tags": ["ruby", "rvm"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519751885, "post_id": 49014133, "comment_id": 85033496, "body": "What is the output of <code>which bundle</code>? Perhaps you&#39;re not running it through <code>rvm</code>? Maybe you need to <code>gem install bundler</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519764990, "post_id": 49014133, "comment_id": 85040683, "body": "As always, check <code>which bundler</code> and <code>which ruby</code> and so on to see which in your <code>PATH</code> are being engaged."}], "owner": {"reputation": 91, "user_id": 9258464, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf46414e31126dbccb090a4f34a597a?s=128&d=identicon&r=PG&f=1", "display_name": "emma_lynn_rose", "link": "https://stackoverflow.com/users/9258464/emma-lynn-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519751021, "creation_date": 1519751021, "question_id": 49014133, "link": "https://stackoverflow.com/questions/49014133/ruby-rvm-gives-me-version-2-0-but-bundler-says-im-incorrectly-running-version-2", "title": "Ruby RVM gives me version 2.0 but Bundler says I&#39;m incorrectly running version 2.3", "body": "<p>I am just starting to work on an old Ruby Rails project. The Gemfile specifies:</p>\n\n<pre><code>ruby '2.0.0'\n</code></pre>\n\n<p>I am running a new version of Ubuntu, which I think came with Ruby 2.3 as the default. So I install RVM and then I:</p>\n\n<pre><code>rvm --default use 2.0.0\nruby -v\n</code></pre>\n\n<p>which gives me: </p>\n\n<pre><code>ruby 2.0.0p648 (2015-12-16 revision 53162) [x86_64-linux]\n</code></pre>\n\n<p>then I run:</p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>and I get this error:</p>\n\n<pre><code>Your Ruby version is 2.3.1, but your Gemfile specified 2.0.0\n</code></pre>\n\n<p>How do I get RVM to enforce the correct version of Ruby? </p>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "model-view-controller"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5249988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49343b3704d93f25778abbe82646e30d?s=128&d=identicon&r=PG&f=1", "display_name": "alhamz", "link": "https://stackoverflow.com/users/5249988/alhamz"}, "edited": false, "score": 0, "creation_date": 1519847599, "post_id": 49014611, "comment_id": 85080002, "body": "Thanks a lot for the feedback. This helped me understand the workings of the MVC better. Basically, it was exactly as you said. Because all comments were being rendered after the new comment initialization through the form and <code>@article.comments.build</code> which was causing a nil, unsaved comment with empty Commenter: and Comment: fields to populate.   Just as an aside, again as per the Getting Started Guide, the comments resource is nested with in my article resource in routes. Is there any advantage/disadvantage of doing this vs creating a seperate resource for comments?"}, {"owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "reply_to_user": {"reputation": 1, "user_id": 5249988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49343b3704d93f25778abbe82646e30d?s=128&d=identicon&r=PG&f=1", "display_name": "alhamz", "link": "https://stackoverflow.com/users/5249988/alhamz"}, "edited": false, "score": 0, "creation_date": 1519854385, "post_id": 49014611, "comment_id": 85083585, "body": "To be precise - your comment was not <code>nil</code>, it was an actual <code>Comment</code> object. When you&#39;re not sure of what kind of object is in play, it&#39;s helpful to check it with <code>&lt;%= comment %&gt;</code> or <code>&lt;%= comment.inspect %&gt;</code>. As for nested resources - I don&#39;t use them often, AFAIK the only benefit is visible in larger apps with many resources, they make routes and url helpers look more organized. Read <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html#nested-resources</a> if you want to use them. Glad to help - I hope my answer is acceptable. Good luck :)"}, {"owner": {"reputation": 1, "user_id": 5249988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49343b3704d93f25778abbe82646e30d?s=128&d=identicon&r=PG&f=1", "display_name": "alhamz", "link": "https://stackoverflow.com/users/5249988/alhamz"}, "edited": false, "score": 0, "creation_date": 1519917697, "post_id": 49014611, "comment_id": 85110322, "body": "Your answers were very helpful because they are not just solutions to my specific questions but rather guidelines of how to look at the problem and make sense of it. Thanks again!"}], "tags": [], "owner": {"reputation": 1197, "user_id": 400743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0d5c51291898c92154ba4ac1c56cd6?s=128&d=identicon&r=PG", "display_name": "Bartosz Pietraszko", "link": "https://stackoverflow.com/users/400743/bartosz-pietraszko"}, "is_accepted": true, "score": 1, "last_activity_date": 1519759414, "last_edit_date": 1519759414, "creation_date": 1519752549, "answer_id": 49014611, "question_id": 49013918, "link": "https://stackoverflow.com/questions/49013918/ruby-on-rails-view-iterates-through-object-even-when-object-is-nil/49014611#49014611", "title": "Ruby on Rails view iterates through object even when object is nil", "body": "<p>If you don't have any comments saved in database - it would probably be a blank new comment initialized for the form, that is most likely rendered before the comment list. Try loading existing comments to separate instance variable in controller action:</p>\n\n<pre><code>@comments = @post.comments\n</code></pre>\n\n<p>Remember to do it BEFORE initializing a new comment for form. I guess it's initialized in the view with <code>@article.comments.build</code>, so simply loading them in controller action should be enough (BTW, it's the right place to do it). Iterate on <code>@comments</code> to render list:</p>\n\n<pre><code>&lt;% @comments.each do |comment| %&gt;\n</code></pre>\n\n<p>Official \"Getting Started with Rails\" guide puts the form below comment list, possibly to spare beginners such issues. I doesn't mean you're doing it wrong - having form on the top is OK, you just have to make adjustments for that.</p>\n\n<p>Remember that you can always dinstinguish saved and unsaved ActiveRecord objects with <a href=\"https://apidock.com/rails/ActiveRecord/Persistence/new_record%3F\" rel=\"nofollow noreferrer\"><code>new_record?</code></a> and <a href=\"https://apidock.com/rails/ActiveRecord/Persistence/persisted%3F\" rel=\"nofollow noreferrer\"><code>persisted?</code></a> methods.</p>\n"}], "owner": {"reputation": 1, "user_id": 5249988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49343b3704d93f25778abbe82646e30d?s=128&d=identicon&r=PG&f=1", "display_name": "alhamz", "link": "https://stackoverflow.com/users/5249988/alhamz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 49014611, "answer_count": 1, "score": 0, "last_activity_date": 1551927253, "creation_date": 1519750376, "last_edit_date": 1551927253, "question_id": 49013918, "link": "https://stackoverflow.com/questions/49013918/ruby-on-rails-view-iterates-through-object-even-when-object-is-nil", "title": "Ruby on Rails view iterates through object even when object is nil", "body": "<p>I am a beginner when it comes to ROR and programming in general. I was working through the basic getting started guide in the documentation and am working on creating a comments view for a blog. I have the following code in my view to render all comments on an article - </p>\n\n<pre><code>&lt;% @article.comments.each do |comment| %&gt;\n  &lt;p&gt;\n    &lt;strong&gt;Commenter: &lt;/strong&gt;\n    &lt;%= comment.commenter %&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;strong&gt;Comment: &lt;/strong&gt;\n    &lt;%= comment.body %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am having trouble understanding why this code renders the 'Commenter:' and 'Comment:' titles even when there is no comment associated with the specific article?!</p>\n\n<p>I also tried wrapping the above code in - </p>\n\n<pre><code>&lt;% if @article.comments.all.empty? == false %&gt;\n  &lt;!--Code Above--&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>just to experiment with it. This will prevent the titles from being rendered if there is no comments however when I add one comment, the title get rendered again in addition to the comment just added. I just need an explanation of this to better understand what is going on.</p>\n"}, {"tags": ["ruby", "ubuntu"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1519750442, "creation_date": 1519750442, "answer_id": 49013936, "question_id": 49013852, "link": "https://stackoverflow.com/questions/49013852/translating-strings-in-file-to-hexadecimal-ruby-part-ii/49013936#49013936", "title": "Translating strings in file to hexadecimal (Ruby) Part II", "body": "<pre><code>input = 'ctgcagccgc cgactgaaat'\noutput =\n  input.split.map do |s|\n    s.chars.each_slice(2).map { |g| sequence_dna[g.join] }\n  end.map(&amp;:join).join(' ')\n#\u21d2 \"79259 61E03\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519797047, "post_id": 49014791, "comment_id": 85050449, "body": "This should be definitely marked as the best answer. <code>\\S</code> is nifty :)"}, {"owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519821201, "post_id": 49014791, "comment_id": 85063556, "body": "Actually I just realized I could&#39;ve used <code>\\w</code>. My thought process went like <code>[acgt]</code>\u2192<code>[^ ]</code>\u2192<code>\\S</code>. Rather silly :-). I&#39;ll replace."}], "tags": [], "owner": {"reputation": 24179, "user_id": 1672429, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0815eb7d4e9dd58022d51ba2011b9c0a?s=128&d=identicon&r=PG", "display_name": "Stefan Pochmann", "link": "https://stackoverflow.com/users/1672429/stefan-pochmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1519821297, "last_edit_date": 1519821297, "creation_date": 1519753249, "answer_id": 49014791, "question_id": 49013852, "link": "https://stackoverflow.com/questions/49013852/translating-strings-in-file-to-hexadecimal-ruby-part-ii/49014791#49014791", "title": "Translating strings in file to hexadecimal (Ruby) Part II", "body": "<pre><code>'ctgcagccgc cgactgaaat'.gsub(/\\w./, sequence_dna)\n=&gt; \"79259 61E03\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519759451, "post_id": 49015419, "comment_id": 85037726, "body": "Good practice would be to read/write stdin/stdout. You can connect those streams to files when you run the script."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": false, "score": 0, "last_activity_date": 1519756071, "last_edit_date": 1519756071, "creation_date": 1519755609, "answer_id": 49015419, "question_id": 49013852, "link": "https://stackoverflow.com/questions/49013852/translating-strings-in-file-to-hexadecimal-ruby-part-ii/49015419#49015419", "title": "Translating strings in file to hexadecimal (Ruby) Part II", "body": "<p>Because in any real-world DNA analysis you are going to be encountering large files, I would suggest a procedure that reads from one file and writes back out to another. This way you will have  no problems running short of memory.</p>\n\n<p>The <code>sequence</code> method below handles file reads and writes. The <code>dna_to_hex</code> method does the comparison and substitution work on a line-by-line basis.</p>\n\n<pre><code>SEQUENCE_DNA = {\n    'aa' =&gt; '0', 'ac' =&gt; '1', 'ag' =&gt; '2', 'at' =&gt; '3', 'ca' =&gt; '4', 'cc' =&gt; '5',\n    'cg' =&gt; '6', 'ct' =&gt; '7', 'ga' =&gt; '8', 'gc' =&gt; '9', 'gg' =&gt; 'A',\n    'gt' =&gt; 'B', 'ta' =&gt; 'C', 'tc' =&gt; 'D', 'tg' =&gt; 'E', 'tt' =&gt; 'F'\n}\n\ndef sequence(input_file_name, output_file_name)\n  File.open(output_file_name, 'w') do |output_file|\n    File.open(input_file_name).each_line { |line| output_file.write(dna_to_hex(line)) }\n  end\nend\n\ndef dna_to_hex(line)\n  line.gsub(/\\S./, SEQUENCE_DNA)\nend\n</code></pre>\n\n<p>You'll use it by passing the name of an input file and the name of an output file:</p>\n\n<pre><code>&gt;&gt; sequence('dna_sequences.txt', 'dna_output.txt')\n</code></pre>\n\n<p>Edit: I've borrowed the string substitution method from @StefanPochmann, as it seems to be the clear best choice for that piece of the problem.</p>\n"}], "owner": {"reputation": 11, "user_id": 9398122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nomadic_Ada", "link": "https://stackoverflow.com/users/9398122/nomadic-ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1519821297, "creation_date": 1519750149, "question_id": 49013852, "link": "https://stackoverflow.com/questions/49013852/translating-strings-in-file-to-hexadecimal-ruby-part-ii", "title": "Translating strings in file to hexadecimal (Ruby) Part II", "body": "<p>I'm new to Ruby and trying to convert a text file containing DNA sequences into a hexadecimal output. I am currently using a hash to match strings with hex-values.</p>\n\n<p>A sample input file might contain ctgcagccgc cgactgaaat. In that case, the output should be 79259 61E03.</p>\n\n<p>What can I do to properly to hash the file to output the hash table key value from string to hexadecimal or another string value?</p>\n\n<p>Below is what I have so far:</p>\n\n<pre><code>#dna_sequencing.rb\n\nsequence_dna = {\n  \"aa\" =&gt; 0, \"ac\" =&gt; 1, \"ag\" =&gt; 2, \"at\" =&gt; 3, \"ca\" =&gt; 4, \"cc\" =&gt; 5, \n  \"cg\" =&gt; 6, \"ct\" =&gt; 7, \"ga\" =&gt; 8, \"gc\" =&gt; 9, \"gg\" =&gt; 'A', \n  \"gt\" =&gt; 'B', \"ta\" =&gt; 'C', \"tc\" =&gt; 'D', \"tg\" =&gt; 'E', \"tt\" =&gt; 'F'\n}\nFile.open(\"dna_sequences.txt\") do |line|\n    #puts line\n    line.each do |fp|\n        key, value = fp.chomp.split(\" \")\n        sequence_dna[key] = value\n        #puts sequence_dna[key]\n        puts sequence_dna\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1519750988, "post_id": 49013761, "comment_id": 85032908, "body": "That&#39;s my first time looking at <code>rb_str_format</code>... yikes."}, {"owner": {"reputation": 18643, "user_id": 1737909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058573b71875bc70b5a4e30140c94040?s=128&d=identicon&r=PG", "display_name": "Ven", "link": "https://stackoverflow.com/users/1737909/ven"}, "edited": false, "score": 0, "creation_date": 1519751090, "post_id": 49013761, "comment_id": 85032979, "body": "Ugh. I had an answer written for <code>&quot;#{abc}&quot;</code>, and just now I notice... That&#39;s not what you want at all."}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "reply_to_user": {"reputation": 18643, "user_id": 1737909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058573b71875bc70b5a4e30140c94040?s=128&d=identicon&r=PG", "display_name": "Ven", "link": "https://stackoverflow.com/users/1737909/ven"}, "edited": false, "score": 0, "creation_date": 1519751722, "post_id": 49013761, "comment_id": 85033392, "body": "@Ven what would that be anyways?"}, {"owner": {"reputation": 18643, "user_id": 1737909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058573b71875bc70b5a4e30140c94040?s=128&d=identicon&r=PG", "display_name": "Ven", "link": "https://stackoverflow.com/users/1737909/ven"}, "edited": false, "score": 1, "creation_date": 1519752376, "post_id": 49013761, "comment_id": 85033805, "body": "@jgomo3 Answered both for good mesure..."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1519760017, "post_id": 49013761, "comment_id": 85038052, "body": "I&#39;m very curious what the use-case is for this..."}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "edited": false, "score": 0, "creation_date": 1519764413, "post_id": 49013761, "comment_id": 85040392, "body": "Interpolating a Template with a Hash, which could produce another template which could be interpolated with the same hash. I have to guard against Circular References.  The actual Use case is a Hash of FilePaths you can &quot;name&quot;, and also reference.  paths = {base: &#39;/tmp&#39;, p1: &#39;%{base}/p1&#39;, p1_1: &#39;%{p1}/_1&#39;, p2: &#39;%{base}/p2&#39;}; explode(paths, :p1_1) # --&gt; produces &#39;/tmp/p1/_1&#39;  I don&#39;t allow Circular references.  Currently I&#39;m using regexps. I would prefer to use the same algorithm as <code>%</code>."}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519765286, "post_id": 49013761, "comment_id": 85040855, "body": "@Max Here is the snippet of my code that is doing that <a href=\"https://gist.github.com/jgomo3/ac5d4d3a828c20b4b4daee84b206670e\" rel=\"nofollow noreferrer\">gist.github.com/jgomo3/ac5d4d3a828c20b4b4daee84b206670e</a>"}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519766193, "post_id": 49013761, "comment_id": 85041257, "body": "@Max so the Use cases for my question are actually 1) The way I&#39;m protecting the code against circular references (recording the slots being expanded while processing the string to check if already expanded), and 2) to check if there is still slots to be processed as the stop condition."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519768536, "post_id": 49013761, "comment_id": 85042347, "body": "@jgomo3 see, I would solve that much simpler: the longest reference chain would be the number of keys in the hash so do that many replacements+1. If the last replacement changes the string you must have a circular reference"}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519769807, "post_id": 49013761, "comment_id": 85042894, "body": "@Max not necessarily. You could repeat one reference many times. Even in different nested levels. In fact, my implementation is erroneous also. I.E: {o: &quot;%{a} .. %{a} .. %{b}&quot;, a: &#39;#&#39;, b: &quot;%{a} .. %{a}&quot;} Has no circular references.  The fixed version for checking that, would still use a record of the slots."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1519770089, "post_id": 49013761, "comment_id": 85043024, "body": "@jgomo3 The number of references in each string is irrelevant since string substitution replaces all of them at once. Your example has three keys and after three replacements it is fully expanded. The fourth replacement has no effect i.e. no circular references."}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "reply_to_user": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1519770280, "post_id": 49013761, "comment_id": 85043103, "body": "@Max You are right!. I&#39;ll fix that immediately. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "edited": false, "score": 0, "creation_date": 1519825755, "post_id": 49022509, "comment_id": 85066666, "body": "Encapsulated, it is perfect!"}, {"owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "edited": false, "score": 0, "creation_date": 1519828080, "post_id": 49022509, "comment_id": 85068282, "body": "Although I get this error:  undefined method `key&#39; for #&lt;KeyError: key not found: :s1&gt;. I don&#39;t find a Ruby version where the KeyError object has the method key."}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "reply_to_user": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "edited": false, "score": 1, "creation_date": 1519873684, "post_id": 49022509, "comment_id": 85089215, "body": "I assume the newest version of Ruby unless specified otherwise. <a href=\"https://ruby-doc.org/core-2.5.0/KeyError.html#method-i-key\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.0/KeyError.html#method-i-key</a>"}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 1, "last_activity_date": 1519795523, "creation_date": 1519795523, "answer_id": 49022509, "question_id": 49013761, "link": "https://stackoverflow.com/questions/49013761/can-we-get-the-slots-in-a-string-related-to-formatting/49022509#49022509", "title": "Can we get the slots in a string related to formatting?", "body": "<p>At least, you can do this:</p>\n\n<pre><code>t = '... %{s1} ... %{s2} ... %{s3} ...'\n\nh = {}\nbegin\n  t % h\nrescue KeyError =&gt; e\n  h[e.key] = true\n  retry\nend\nh.keys # =&gt; [:s1, :s2, :s3]\n</code></pre>\n"}], "owner": {"reputation": 1041, "user_id": 344501, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/974f1971efcd5eed5a25265d019cef27?s=128&d=identicon&r=PG", "display_name": "jgomo3", "link": "https://stackoverflow.com/users/344501/jgomo3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1519795903, "creation_date": 1519749894, "last_edit_date": 1519795903, "question_id": 49013761, "link": "https://stackoverflow.com/questions/49013761/can-we-get-the-slots-in-a-string-related-to-formatting", "title": "Can we get the slots in a string related to formatting?", "body": "<p>I'm interested in getting the list of slots in a string related to formatting by the operator <code>%</code>. Supposing I have a <code>slots</code> method for that, it would do the following:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>t = '... %{s1} ... %{s2} ... %{s3} ...'\nt.slots # =&gt; ['s1', 's2', 's3']\n</code></pre>\n\n<ol>\n<li>Is there such a method as the hypothetical <code>slots</code>?</li>\n<li>Is there a way to get these slots <strong>WITHOUT using regular expression</strong>, but using the same parsing routine as the one used by the Ruby engine?</li>\n<li>Is there a library that implements something like the formatting interpolation that exposes a method analogous to the mentioned <code>slots</code>?</li>\n<li>If there is not any other option, how could I produce a descent parser (not regular expression) for this case?</li>\n</ol>\n\n<p>I read <a href=\"https://github.com/ruby/ruby/blob/96db72ce38b27799dd8e80ca00696e41234db6ba/sprintf.c#L631\" rel=\"nofollow noreferrer\">what I think is the source code of <code>%</code></a>, and I'm afraid string formatting has no evident separation for slots detection.</p>\n"}, {"tags": ["arrays", "json", "ruby", "data-structures", "ruby-hash"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1519748619, "post_id": 49013176, "comment_id": 85031397, "body": "Depends; is it a known format like this, or can they be in arbitrary order? If arbitrary order, how do you determine what they should be nested under? I mean, given your specific input and output it seems pretty easy."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1519748924, "post_id": 49013176, "comment_id": 85031609, "body": "@DaveNewton Order is important."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519749013, "post_id": 49013176, "comment_id": 85031668, "body": "@mudasobwa haha thanks!"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1519749086, "post_id": 49013176, "comment_id": 85031724, "body": "@user3229073 Notice how <code>depth: 1</code> is present in the expected solutionn twice? Hashes in ruby can&#39;t have duplicate keys so that&#39;s not feasible."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1519749119, "post_id": 49013176, "comment_id": 85031753, "body": "@user3229073 What have you tried so far? Beware <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/noattempt</a> and <a href=\"http://idownvotedbecau.se/nocode/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nocode</a>."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1519749253, "post_id": 49013176, "comment_id": 85031845, "body": "@maxpleaner depth in the resulting hash can be ignored. i will edit the question."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1519749337, "post_id": 49013176, "comment_id": 85031893, "body": "@DaveNewton i will post my attempt"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1519749613, "post_id": 49013176, "comment_id": 85032065, "body": "The requested output is not valid ruby: hash on sublevel 1 cannot have two or more elements sharing the same key (<code>:text</code> in this case.) That said, this problem has no solution as it is stated."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519750612, "post_id": 49013176, "comment_id": 85032693, "body": "@mudasobwa forgive me, i will rethink the structure which is acceptable for my use case"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1519753133, "post_id": 49013176, "comment_id": 85034264, "body": "Now your example output doesn&#39;t match the input, at all."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519753814, "post_id": 49013176, "comment_id": 85034672, "body": "@SergioTulentsev it&#39;s pseudo for the possibility of something along those lines?  wondering if it&#39;s possible to generate a nested structure given the nested level as an integer."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519755662, "post_id": 49013176, "comment_id": 85035678, "body": "@user3229073: everything is possible. Except maybe your example here. I don&#39;t see how this output can be derived from that input."}, {"owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519756806, "post_id": 49013176, "comment_id": 85036295, "body": "@SergioTulentsev i see, thanks for looking regardless"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1520145485, "post_id": 49013176, "comment_id": 85190659, "body": "What is the code you are having trouble with? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ? Please, provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1520145519, "post_id": 49013176, "comment_id": 85190662, "body": "Can you provide a <i>precise</i> specification of what it is that you want to happen, including any and all rules, exceptions from those rules, corner cases, special cases, boundary cases, and edge cases? Can you provide sample inputs and outputs demonstrating what you expect to happen, both in normal cases, and in all the exceptions, corner cases, special cases, boundary cases, and edge cases? Please, also make sure to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1520145594, "post_id": 49013176, "comment_id": 85190679, "body": "&quot;Is it possible to iterate through the array above and create [\u2026]&quot; \u2013 You do it by writing a program which does that. If you have a problem with your program, carefully read the documentation of all the methods, classes, modules, and libraries you are using, write tests for your programs, trace the execution with pen and paper, single-step it in a debugger, then sleep on it, start again from the beginning, sleep on it again, and <i>then and only then</i> narrow your problem down to a concise, focused, simple, short, reproducible <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask a specific, focused, narrow question on <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1520145816, "post_id": 49013176, "comment_id": 85190719, "body": "Also, please read <a href=\"https://meta.stackoverflow.com/q/270933/2988\">this</a> to understand why &quot;is it possible&quot; is a poor question, and most likely off-topic for <a href=\"https://stackoverflow.com\">Stack Overflow</a>, and edit your question accordingly to include the precise problem you are having, the steps you have taken to solve it, and your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "is_accepted": true, "score": 0, "last_activity_date": 1519930062, "creation_date": 1519930062, "answer_id": 49056676, "question_id": 49013176, "link": "https://stackoverflow.com/questions/49013176/convert-array-with-integers-which-indicate-hash-depth-to-hash/49056676#49056676", "title": "Convert array with integers which indicate hash depth to hash", "body": "<p>I figured it out.</p>\n\n<pre><code>new_structure = []\ndepth = 0\narray.each do |element|\n  if element[:depth] == 0\n    new_structure &lt;&lt; element\n  else\n    if element[:depth] &lt; depth || element[:depth] == depth\n      parent = recursive_method(new_structure[-1], element[:depth] - 1)[:sublevel]\n      parent = [] if parent.nil?\n      parent &lt;&lt; element\n    else\n      recursive_method(new_structure[-1], element[:depth]).merge!({ sublevel: [element] })\n    end\n  end\n  depth = element[:depth]\nend\n\ndef recursive_method(structure, depth)\n  return structure if structure[:sublevel].nil? || depth == 0\n  recursive_method(structure[:sublevel][-1], depth -= 1)\nend\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[\n  {\n    :text =&gt; \"a\",\n    :depth =&gt; 0,\n    :sublevel =&gt; [\n        {\n            :text =&gt; \"b\",\n            :depth =&gt; 1,\n            :sublevel =&gt; [\n                {\n                    :text =&gt; \"c\",\n                    :depth =&gt; 2\n                }\n            ]\n        }, \n        {\n            :text =&gt; \"d\",\n            :depth =&gt; 1\n        }\n    ]\n  }\n]\n</code></pre>\n\n<p>Open to make it better. </p>\n"}], "owner": {"reputation": 13, "user_id": 3229073, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbd3466f3683e1c4f3bce6b085e6d065?s=128&d=identicon&r=PG&f=1", "display_name": "user3229073", "link": "https://stackoverflow.com/users/3229073/user3229073"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1520145466, "accepted_answer_id": 49056676, "answer_count": 1, "score": -2, "last_activity_date": 1520281248, "creation_date": 1519748004, "last_edit_date": 1520281248, "question_id": 49013176, "link": "https://stackoverflow.com/questions/49013176/convert-array-with-integers-which-indicate-hash-depth-to-hash", "closed_reason": "Needs details or clarity", "title": "Convert array with integers which indicate hash depth to hash", "body": "<p>I have the following array:</p>\n\n<pre><code>[{text: \"a\", depth: 0},\n {text: \"b\", depth: 1},\n {text: \"c\", depth: 2},\n {text: \"d\", depth: 1}]\n</code></pre>\n\n<p>The problem I'm trying to solve is to take a flattened array (above) and create a nested structure based on each element's depth. The reason I need it nested is to build a list (ordered or unordered) recursively which I can't do with the array I have.</p>\n\n<p>The following is in some way, shape, or form the desired output. The general idea for the nested structure I'm trying to create should be clearer.</p>\n\n<pre><code>  { \n    text: \"a\", \n    depth: 0,\n    sublevel: [\n      {\n        text: \"a\",\n        depth: 1,\n        sublevel: [\n          {\n            text: \"b\",\n            depth: 2,\n            sublevel: []\n          }\n        ]\n      },\n      {\n        text: \"d\",\n        depth: 1,\n        sublevel: []\n      }\n    ]\n  }\n</code></pre>\n"}, {"tags": ["ruby", "amazon-web-services", "chef-infra", "cookbook"], "answers": [{"tags": [], "owner": {"reputation": 1365, "user_id": 4894399, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tY1Cz7EDNxc/AAAAAAAAAAI/AAAAAAAABb4/3Qa15VP4_ZY/photo.jpg?sz=128", "display_name": "Szymon Szypulski", "link": "https://stackoverflow.com/users/4894399/szymon-szypulski"}, "is_accepted": false, "score": 0, "last_activity_date": 1519800694, "creation_date": 1519800694, "answer_id": 49023569, "question_id": 49013118, "link": "https://stackoverflow.com/questions/49013118/unable-to-retrieve-databag-items-for-a-encrypted-data-bag-using-chef-attributes/49023569#49023569", "title": "Unable to retrieve databag items for a encrypted data bag using chef attributes", "body": "<p>You are experiencing <a href=\"https://coderanger.net/two-pass/\" rel=\"nofollow noreferrer\">Chef's two pass</a> execution model, template variables are evaluated before ruby_block resources calls. You can wrap <code>api_keys</code> with lazy block.</p>\n\n<p>However, there is no need to manually call curl on AWS metadata endpoint. Chef's ohai ec2 plugin is extracting them anyway - <code>node[\"ec2\"][\"account_id\"]</code> and <code>node[\"ec2\"][\"availability_zone\"]</code> (just drop az id here wit <code>tr</code> or <code>gsub</code>). You can pass this right to the template or even use <code>node</code> directly in your template.</p>\n"}], "owner": {"reputation": 1, "user_id": 9419588, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "prats09", "link": "https://stackoverflow.com/users/9419588/prats09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519800694, "creation_date": 1519747828, "question_id": 49013118, "link": "https://stackoverflow.com/questions/49013118/unable-to-retrieve-databag-items-for-a-encrypted-data-bag-using-chef-attributes", "title": "Unable to retrieve databag items for a encrypted data bag using chef attributes", "body": "<p>I am working on this recipe which assigns api key from an encrypted data bag item. To retrieve the data bag item I am using chef attributes in the query. This is what I am doing to assign the attributes</p>\n\n<pre><code>ruby_block \"get_my_region\" do\n  block do\n    node.set['aws']['account_number'] = `curl -s http://169.254.169.254/latest/dynamic/instance-identity/document|grep region|awk -F\\\\\" '{print $4}'`.chop\n    node.save\n  end\n  action :create\nend\n\nruby_block \"get_account\" do\n    block do\n      node.set['aws']['region'] = `curl -s http://169.254.169.254/latest/dynamic/instance-identity/document | grep -oP '(?&lt;=\"accountId\" : \")[^\"]*(?=\")'`.chop\n      node.save\n    end\n    action :create\nend\n</code></pre>\n\n<p>Once the attributes get assigned I am calling a template to using the assigned attribute to the config file</p>\n\n<pre><code>template '/etc/default/polymur-proxy' do\n  source 'polymur-proxy.erb'\n  notifies :restart, 'service[polymur-proxy]', :delayed\n  variables(\n  api_key: (api_keys[\"#{node['aws']['region']}\"][\"#{node['aws']['account_number']}\"][\"key\"]).to_s,\n  )\nend\n</code></pre>\n\n<p>The problem is the while debugging I can see the attribute got assigned the correct values however while using them in the query they return empty. If any one has any suggestion for this will be helpful</p>\n"}, {"tags": ["ruby", "rubocop"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1519747519, "post_id": 49012978, "comment_id": 85030695, "body": "If it <b>can&#39;t</b> fall outside of that range, then make the last <code>when</code> an <code>else</code>?"}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "edited": false, "score": 1, "creation_date": 1519747521, "post_id": 49012978, "comment_id": 85030697, "body": "how can you be sure it won&#39;t fall outside the range?"}, {"owner": {"reputation": 7389, "user_id": 2235594, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/4MssP.jpg?s=128&g=1", "display_name": "davegson", "link": "https://stackoverflow.com/users/2235594/davegson"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1519747560, "post_id": 49012978, "comment_id": 85030722, "body": "I&#39;d suggest what @SergioTulentsev said as well. If it is possible for the <i>value</i> to fall outside the range <code>raise</code> an error in the <code>else</code> statement"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "edited": false, "score": 0, "creation_date": 1519747762, "post_id": 49012978, "comment_id": 85030855, "body": "That would be a solution, but it would be less evdident that the maximum value is 22 when looking at just the case-statement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "edited": false, "score": 0, "creation_date": 1519749042, "post_id": 49012978, "comment_id": 85031692, "body": "I will settle with an else-statement for the final case as this satisfies Rubocop while also being a good-enough code solution in my opinion."}, {"owner": {"reputation": 9845, "user_id": 119822, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wnqih.jpg?s=128&g=1", "display_name": "Andy Waite", "link": "https://stackoverflow.com/users/119822/andy-waite"}, "edited": false, "score": 1, "creation_date": 1519751449, "post_id": 49012978, "comment_id": 85033196, "body": "If it should never be outside of the range, raise a runtime error in the else. It may catch a future bug, and it helps to self-document the intended behaviour."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1519856444, "post_id": 49012978, "comment_id": 85084480, "body": "This cop is disabled by default, so your disable won&#39;t change anything unless there&#39;s another configuration file. In order to assess the question, you&#39;ll need to post the output from <code>rubocop</code> and your version."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "edited": false, "score": 0, "creation_date": 1519748265, "post_id": 49013085, "comment_id": 85031179, "body": "I get an &quot;unnecessary disabling of Style/MissingElse&quot; warning, which means that my global configuration should do the trick. However, when I remove the global configuration, having suppressed it in place, I get the same warning."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519748577, "post_id": 49013085, "comment_id": 85031365, "body": "I am not sure I follow. You might need to check <code>.rubocop_todo.yml</code> as well, but in general either this cop is disabled and you don\u2019t need to do anything, or it\u2019s enabled and the solution above should do the trick."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "edited": false, "score": 0, "creation_date": 1519748808, "post_id": 49013085, "comment_id": 85031529, "body": "Sorry, I was unclear in my statement. What I meant to say was that your solution for in place suppression seems to behave exactly like my global suppression, which means that both are ineffective."}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1519749278, "post_id": 49013085, "comment_id": 85031860, "body": "This is how you do it. If it&#39;s not working that would be... interesting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "edited": false, "score": 0, "creation_date": 1519749425, "post_id": 49013085, "comment_id": 85031960, "body": "It is interesting indeed. My other suppressions work just fine."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1519747705, "creation_date": 1519747705, "answer_id": 49013085, "question_id": 49012978, "link": "https://stackoverflow.com/questions/49012978/rubocop-how-to-disable-warnings-for-missing-else-clause/49013085#49013085", "title": "Rubocop - how to disable warnings for missing else-clause?", "body": "<p>Don\u2019t disable it globally, suppress it inplace:</p>\n\n<pre><code># rubocop:disable Style/MissingElse\ncase value\nwhen 4..9 then x\nwhen 10..15 then y\nwhen 16..22 then z\nend\n# rubocop:enable Style/MissingElse\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6596162"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1519747705, "creation_date": 1519747387, "question_id": 49012978, "link": "https://stackoverflow.com/questions/49012978/rubocop-how-to-disable-warnings-for-missing-else-clause", "title": "Rubocop - how to disable warnings for missing else-clause?", "body": "<p>How do I silence Rubocop warnings for a case-statement that does not include an else-clause? I tried the following value in my .rubocop.yml file without any success:</p>\n\n<pre><code>Style/MissingElse:\n  Enabled: false\n</code></pre>\n\n<p>My case-statement looks like this:</p>\n\n<pre><code>case value\nwhen 4..9 then x\nwhen 10..15 then y\nwhen 16..22 then z\nend\n</code></pre>\n\n<p>Since the value tested cannot fall outside the range 4 - 22, I see little point in adding an else-clause.</p>\n"}, {"tags": ["ruby", "javafx", "jruby", "fxml", "jrubyfx"], "owner": {"reputation": 63, "user_id": 1765835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeda9ad2431bdadc8d9f97d7e71e700?s=128&d=identicon&r=PG", "display_name": "benbyday", "link": "https://stackoverflow.com/users/1765835/benbyday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1519746530, "creation_date": 1519746530, "question_id": 49012689, "link": "https://stackoverflow.com/questions/49012689/how-do-i-get-the-window-object-from-the-controller-but-in-jrubyfx", "title": "How do I get the window object from the controller, but in JRubyFX", "body": "<p>I'm trying to eventually have a desktop app that has one main window and controller that can open a temporary second window where the first window is temporarily disabled. I found <a href=\"https://stackoverflow.com/questions/15625987/block-owner-window-java-fx\">this link</a> for how to do that in javafx, but now I'm trying to get it to work in jrubyfx.</p>\n\n<p>Here is essentially as far as I've gotten:</p>\n\n<pre><code>require 'other_controller'\n\nclass MainMenuController\n  include JRubyFX::Controller\n  fxml \"MainMenu.fxml\"\n\n  def button_press\n    new_stage = JRubyFX::DSL::Stage.new\n    with(new_stage, title: \"title\") do\n      new_stage.init_modality = :window_modal\n      new_stage.init_owner = stage.get_window\n      fxml OtherController\n      show\n    end\n    # other code\n  end\nend\n</code></pre>\n\n<p>The error I get is that the get_window method isn't found. I know my issue is that I don't fully understand how to translate javafx into jrubyfx so if anybody has any insight on how to get the window, or any more insight to what I'm missing about jrubyfx syntax would be much appreciated.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "image", "imagemagick", "paperclip"], "comments": [{"owner": {"reputation": 147, "user_id": 9284149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9eeeb8c9681c99046d95e418cd9110?s=128&d=identicon&r=PG&f=1", "display_name": "Zakhar Antoshchenko", "link": "https://stackoverflow.com/users/9284149/zakhar-antoshchenko"}, "edited": false, "score": 0, "creation_date": 1519746662, "post_id": 49011330, "comment_id": 85030054, "body": "are you sure that your image was saved to your asset&#39;s path? Check this image in directory manually, if it&#39;s present, then attach code from your migration."}, {"owner": {"reputation": 16530, "user_id": 624551, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0a09bc0cd01b0bfd4d2fea1863138267?s=128&d=identicon&r=PG", "display_name": "Intrepidd", "link": "https://stackoverflow.com/users/624551/intrepidd"}, "edited": false, "score": 0, "creation_date": 1519748878, "post_id": 49011330, "comment_id": 85031582, "body": "Check the HTML output, most likely the image is not found and you see the &quot;alt&quot;"}, {"owner": {"reputation": 71, "user_id": 2356266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4278c447322037e9885061654ef257?s=128&d=identicon&r=PG", "display_name": "Stasy Meclazcke", "link": "https://stackoverflow.com/users/2356266/stasy-meclazcke"}, "edited": false, "score": 0, "creation_date": 1519769471, "post_id": 49011330, "comment_id": 85042762, "body": "The image is definitely there I can see it in the folder manually and when I upload images with different file names, it displays the different file names"}], "owner": {"reputation": 71, "user_id": 2356266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4278c447322037e9885061654ef257?s=128&d=identicon&r=PG", "display_name": "Stasy Meclazcke", "link": "https://stackoverflow.com/users/2356266/stasy-meclazcke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519742635, "creation_date": 1519742635, "question_id": 49011330, "link": "https://stackoverflow.com/questions/49011330/image-tag-displaying-image-url-instead-of-image-on-page", "title": "Image_tag displaying image url instead of image on page", "body": "<p>So I am using imagemagick and paperclip to upload images and use the following code in the controller to set the path and url of the image:</p>\n\n<pre><code>has_attached_file :image, :path =&gt; 'app/assets/images/storeimages/:class/:attachment/:id_partition/:style/:filename', :url =&gt; 'app/assets/images/storeimages/:class/:attachment/:id_partition/:style/:filename', :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nvalidates_attachment :image, content_type: { content_type: /\\Aimage\\/.*\\Z/ }\n</code></pre>\n\n<p>Then in the view I am displaying the image with the following code</p>\n\n<pre><code>&lt;%= image_tag @storeitem.image.url(:medium) %&gt;\n</code></pre>\n\n<p>I'm not sure why it is displaying the name of the image instead of displaying an image because when I don't set the path and url, it saves where imagemagick originally sets it and displays it.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 3, "creation_date": 1519742061, "post_id": 49011037, "comment_id": 85026787, "body": "You&#39;re calling an instance method, <code>overall_avg</code> on an <code>ActiveRecord_Relation</code>. Your error trace, which you sadly don&#39;t provide, should indicate the location of the error."}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1519743610, "post_id": 49011037, "comment_id": 85027861, "body": "We don&#39;t even know if <code>overall_avg</code> is an instance method because the provided <i>recipe.rb</i> doesn&#39;t have it."}], "owner": {"reputation": 15, "user_id": 9327165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96132cb459b229d196f3591ea6b5d5e8?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u043b\u044c\u044f \u041a\u043e\u0433\u0430\u043d", "link": "https://stackoverflow.com/users/9327165/%d0%98%d0%bb%d1%8c%d1%8f-%d0%9a%d0%be%d0%b3%d0%b0%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519749552, "creation_date": 1519741731, "last_edit_date": 1519749552, "question_id": 49011037, "link": "https://stackoverflow.com/questions/49011037/undefined-method-overall-avg-for-recipeactiverecord-relation0x007f5154d4e", "title": "undefined method `overall_avg&#39; for #&lt;Recipe::ActiveRecord_Relation:0x007f5154d4ea20&gt;", "body": "<p>After installing ratyrate and i've done like in Instruction at GItHub\nI got this error\nI need to add something at controller? or what?\nI hope you will help me to solve this<a href=\"https://i.stack.imgur.com/GRQTF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GRQTF.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/pPlxq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPlxq.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to add something at controller? or what?\nI hope you will help me to solve th</p>\n\n<p>my  model user.rb(using devise)</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable and :omniauthable\n  ratyrate_rater\n\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n   has_many :recipe\n\n\nend\n</code></pre>\n\n<p>my  model recipe.rb</p>\n\n<pre><code>class Recipe &lt; ApplicationRecord\n  belongs_to :user\n\n  has_many :ingredients\n  has_many :directions\n  has_many :comments, as: :commentable\n\n  ratyrate_rateable \"recipe_rating\"\n\n\n\n  accepts_nested_attributes_for :ingredients,\n                                 reject_if: proc { |attributes| attributes['name'].blank? },\n                                 allow_destroy: true\n  accepts_nested_attributes_for :directions,\n                                 reject_if: proc { |attributes| attributes['step'].blank? },\n                                 allow_destroy: true\n\n  validates :title, :description, :image, presence: true\n\n  has_attached_file :image, styles: { medium: \"400x400#\"}\n  validates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\z/\nend\n</code></pre>\n\n<p>my index.html.haml</p>\n\n<pre><code>- @recipe.each_slice(3) do |recipes|\n  .row\n    -recipes.each do |recipe|\n      .col-md-4\n        .recipe\n          .image_wrapper\n            = link_to recipe do\n              =image_tag recipe.image.url(:medium)\n          %h2= link_to recipe.title,recipe\n\n  .row\n    .small-2.large-2.columns\n      = imdb_style_rating_for @recipe, current_user\n    %br/\n    .small-2.large-4.columns\n      - if current_user\n        Recipe Ratings: #{rating_for @recipe, \"recipe_rating\"}\n</code></pre>\n\n<p>my ricipes_controller</p>\n\n<pre><code>class RecipesController &lt; ApplicationController\n  before_action :find_recipe, only: [:show,:edit, :update, :destroy]\n  before_action :authenticate_user!, exept: [:index, :show]\n\n  def index\n    @recipe = Recipe.all.order(\"created_at DESC\")\n\n  end\n\n  def show\n\n  end\n\n  def new\n    @recipe = current_user.recipe.build\n  end\n\n  def create\n    @recipe = current_user.recipe.build(recipe_params)\n\n    if @recipe.save\n      redirect_to @recipe, notice: \"Successfully created new recipe\"\n\n    else\n      render 'new'\n    end\n  end\n\n  def edit\n  end\n\n\n\n  def update\n    if @recipe.update(recipe_params)\n      redirect_to @recipe\n    else\n      render 'edit'\n    end\n  end\n\n  def destroy\n    @recipe.destroy\n    redirect_to root_path, notice: \"Successfully deleted recipe\"\n  end\n\n  private\n\n  def recipe_params\n    params.require(:recipe).permit(:title, :description, :image, ingredients_attributes: [:id, :name, :_destroy], directions_attributes: [:id, :step, :_destroy])\n  end\n\n  def find_recipe\n    @recipe = Recipe.find(params[:id])\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1519741777, "post_id": 49010999, "comment_id": 85026588, "body": "1) One way to do it is by using <a href=\"http://ruby-doc.org/core-2.5.0/String.html#method-i-sub\" rel=\"nofollow noreferrer\"><code>String#sub</code></a> with a <a href=\"http://ruby-doc.org/core-2.5.0/Regexp.html\" rel=\"nofollow noreferrer\"><code>Regexp</code></a> as <code>pattern</code>. 2) What prevents you do that?"}, {"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "reply_to_user": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1519743334, "post_id": 49010999, "comment_id": 85027661, "body": "I got it, I used string[N..-1] , was wondering if can change the strings to true or false in the map transformation."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1519745778, "post_id": 49010999, "comment_id": 85029427, "body": "There&#39;s a thread <a href=\"https://stackoverflow.com/questions/3614389/what-is-the-easiest-way-to-remove-the-first-character-from-a-string/46958806#46958806\">here</a> that goes into detail on removing the start of a string. Might find it good reading."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1519743584, "post_id": 49011434, "comment_id": 85027845, "body": "I like this answer too, I will go try it."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "edited": false, "score": 0, "creation_date": 1519743690, "post_id": 49011434, "comment_id": 85027910, "body": "@Fatna This one has the clear answer for you because you can completely eliminate one step."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "edited": false, "score": 0, "creation_date": 1519745469, "post_id": 49011434, "comment_id": 85029205, "body": "Didn&#39;t know you could do that with <code>String#[]</code>. Informative as ever, +1. (I also like 2.5.0&#39;s <a href=\"https://ruby-doc.org/core-2.5.0/String.html#method-i-delete_prefix\" rel=\"nofollow noreferrer\">delete_prefix</a> for readability.)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1519742887, "creation_date": 1519742887, "answer_id": 49011434, "question_id": 49010999, "link": "https://stackoverflow.com/questions/49010999/ruby-how-to-remove-the-first-part-of-string/49011434#49011434", "title": "ruby, how to remove the first part of string?", "body": "<p>Basically 2) eliminates the necessity of 1), so here you go:</p>\n\n<pre><code>consent_values = consents.map do |consent|\n  case consent.attribute('class')\n  when \"fa fa-check-circle\" then true\n  when \"fa fa-circle-thin\" then false\n  else nil\n  end\nend\n</code></pre>\n\n<p>To remove <code>\"fa \"</code> prefix from the string one might use <code>String#[]</code>:</p>\n\n<pre><code>\"fa fa-check-circle\"[/(?&lt;=\\Afa ).*/]\n#\u21d2 \"fa-check-circle\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 1, "creation_date": 1519744199, "post_id": 49011652, "comment_id": 85028303, "body": "Hi, Have a look at @mudasobwa &#39;s answer, he has written an answer which actually reduces one step for you!"}], "tags": [], "owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "is_accepted": false, "score": 0, "last_activity_date": 1519743475, "creation_date": 1519743475, "answer_id": 49011652, "question_id": 49010999, "link": "https://stackoverflow.com/questions/49010999/ruby-how-to-remove-the-first-part-of-string/49011652#49011652", "title": "ruby, how to remove the first part of string?", "body": "<pre><code>string[N..-1]\n</code></pre>\n\n<p>This worked for me. thanks anyway, I hope I will interact with this forum lot.</p>\n"}], "owner": {"reputation": 83, "user_id": 9419102, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b0a94b437e39bbb234559d4300691ef?s=128&d=identicon&r=PG&f=1", "display_name": "Fatna", "link": "https://stackoverflow.com/users/9419102/fatna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 49011434, "answer_count": 2, "score": 1, "last_activity_date": 1519743475, "creation_date": 1519741600, "question_id": 49010999, "link": "https://stackoverflow.com/questions/49010999/ruby-how-to-remove-the-first-part-of-string", "title": "ruby, how to remove the first part of string?", "body": "<p>This is my first time posting in this forum, I am doing some selenium webdriver testing, I collected some data from an html UI, put it in an array:</p>\n\n<pre><code>consents = $driver.find_elements(:xpath,\"//*[@id='main-display']/div[2]/div[2]/div/table/tbody/tr/td[7]//i\")\n</code></pre>\n\n<p>, then I processed the array with map :</p>\n\n<pre><code>consent_values = consents.map { |consent| consent.attribute('class')}\n</code></pre>\n\n<p>printing the array I got :</p>\n\n<pre><code>[\"fa fa-check-circle\", \"fa fa-circle-thin\", \"fa fa-check-circle\", \"fa fa-circle-thin\", \"fa fa-circle-thin\", \"fa fa-check-circle\", \"fa fa-circle-thin\", \"fa fa-circle-thin\", \"fa fa-check-circle,....]\n</code></pre>\n\n<p>1) Is there a way to do in the map to remove \"fa\" from all strings in the array ?</p>\n\n<p>2) How about changing the strings \"fa fa-check-circle\" to be true and \"fa fa-circle-thin\" to be false so I will get :\n[true,false,true,....]</p>\n\n<p>Thanks, </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "separation-of-concerns"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1519741010, "post_id": 49010728, "comment_id": 85026027, "body": "This DRYness will have a cost: now it&#39;s not immediately obvious what instance variables will be available for views in these actions. And, depending on how you choose to implement this, it might not be obvious that some variables are set elsewhere at all. Do you think you can pay the price?"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1519742270, "post_id": 49010728, "comment_id": 85026910, "body": "btw, your new note can be initialized from <code>@notes.new</code> (because <code>@notes</code> is an <code>ActiveRecord::Relation</code> object). It this will automatically set the <code>user_id</code> to the <code>current_user</code>&#39;s id for you."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1519742532, "post_id": 49010728, "comment_id": 85027126, "body": "@MrYoshiji: good advice <b>if</b> they need that."}], "answers": [{"tags": [], "owner": {"reputation": 110512, "user_id": 350087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/808bec1c640143bd7091888d9edfb2f2?s=128&d=identicon&r=PG", "display_name": "apneadiving", "link": "https://stackoverflow.com/users/350087/apneadiving"}, "is_accepted": false, "score": 3, "last_activity_date": 1519742311, "last_edit_date": 1519742311, "creation_date": 1519741034, "answer_id": 49010821, "question_id": 49010728, "link": "https://stackoverflow.com/questions/49010728/using-rails-5-how-do-i-dryly-define-instance-variables-in-multiple-controllers/49010821#49010821", "title": "Using Rails 5, how do I DRY&#39;ly define instance variables in multiple controllers/actions?", "body": "<p>You could add the method in your <code>ApplicationController</code>.</p>\n\n<p>Then add in <code>NotesController</code>: </p>\n\n<pre><code>before_action :create_note_instances_vars, only: [:create, :update]\n</code></pre>\n\n<p>Same logic in <code>UsersController</code></p>\n"}, {"tags": [], "owner": {"reputation": 2343, "user_id": 6270554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PqRWJ.jpg?s=128&g=1", "display_name": "Hardik Upadhyay", "link": "https://stackoverflow.com/users/6270554/hardik-upadhyay"}, "is_accepted": false, "score": 0, "last_activity_date": 1519741049, "creation_date": 1519741049, "answer_id": 49010825, "question_id": 49010728, "link": "https://stackoverflow.com/questions/49010728/using-rails-5-how-do-i-dryly-define-instance-variables-in-multiple-controllers/49010825#49010825", "title": "Using Rails 5, how do I DRY&#39;ly define instance variables in multiple controllers/actions?", "body": "<p>I think concern is not good idea for just initialise instance variable.</p>\n\n<p>You can write this def in <code>ApplicationController</code> and call via callbacks when you need it in any controller.</p>\n"}], "owner": {"reputation": 2902, "user_id": 523051, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/497825ebbcb0e06c2451d3ff91d644b2?s=128&d=identicon&r=PG", "display_name": "chrickso", "link": "https://stackoverflow.com/users/523051/chrickso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519742311, "creation_date": 1519740779, "question_id": 49010728, "link": "https://stackoverflow.com/questions/49010728/using-rails-5-how-do-i-dryly-define-instance-variables-in-multiple-controllers", "title": "Using Rails 5, how do I DRY&#39;ly define instance variables in multiple controllers/actions?", "body": "<p>I need to define the same instance variables:</p>\n\n<pre><code>@note = Note.new\n@notes = current_user.notes.all\n</code></pre>\n\n<p>In multiple controllers:</p>\n\n<pre><code>UsersController#home\nNotesController#create\nNotesController#update\n</code></pre>\n\n<p>Where would be an appropriate place to house a class/function that</p>\n\n<pre><code>def createNoteInstancesVars\n  @note = Note.new\n  @notes = current_user.notes.all\nend\n</code></pre>\n\n<p>?</p>\n\n<p>Is this the intended use of a controller concern or is there a different/better way I am not thinking of? If I do put it in a concern, doesn't that mean these queries are getting run for every single controller#action? I would like to avoid that.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "scope", "rails-activerecord"], "answers": [{"comments": [{"owner": {"reputation": 1666, "user_id": 2563946, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rh0QI.jpg?s=128&g=1", "display_name": "Jaycreation", "link": "https://stackoverflow.com/users/2563946/jaycreation"}, "edited": false, "score": 0, "creation_date": 1519741534, "post_id": 49010730, "comment_id": 85026402, "body": "Great. Thank a lot for your quick answer. Wrapping into class_methods do end  do the job."}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1519742507, "post_id": 49010730, "comment_id": 85027103, "body": "Out of curiosity, why not use <code>delegate :entity_field_name, to: :class</code>?"}, {"owner": {"reputation": 110512, "user_id": 350087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/808bec1c640143bd7091888d9edfb2f2?s=128&d=identicon&r=PG", "display_name": "apneadiving", "link": "https://stackoverflow.com/users/350087/apneadiving"}, "edited": false, "score": 0, "creation_date": 1519742560, "post_id": 49010730, "comment_id": 85027139, "body": "you definitely could :) matter of taste ;)"}, {"owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "edited": false, "score": 0, "creation_date": 1519742612, "post_id": 49010730, "comment_id": 85027176, "body": "Okay I thought there was a tricky part or hidden feature there, thank you :)"}], "tags": [], "owner": {"reputation": 110512, "user_id": 350087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/808bec1c640143bd7091888d9edfb2f2?s=128&d=identicon&r=PG", "display_name": "apneadiving", "link": "https://stackoverflow.com/users/350087/apneadiving"}, "is_accepted": true, "score": 1, "last_activity_date": 1519740789, "creation_date": 1519740789, "answer_id": 49010730, "question_id": 49010703, "link": "https://stackoverflow.com/questions/49010703/ror-access-module-function-in-a-scope-into-a-module/49010730#49010730", "title": "ROR Access module function in a scope into a module", "body": "<p>You have to wrap <code>entity_field_name</code> so it is a class method:</p>\n\n<pre><code>class_methods do\n  def entity_field_name\n    self.connection.schema_search_path.split(\",\").first == 'public' ? 'entity_id' : 'entity_id__c'\n  end\nend\n</code></pre>\n\n<p>If you also need at the instance level, add:</p>\n\n<pre><code>def entity_field_name\n  self.class.entity_field_name\nend\n</code></pre>\n"}], "owner": {"reputation": 1666, "user_id": 2563946, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rh0QI.jpg?s=128&g=1", "display_name": "Jaycreation", "link": "https://stackoverflow.com/users/2563946/jaycreation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49010730, "answer_count": 1, "score": 1, "last_activity_date": 1519741092, "creation_date": 1519740702, "last_edit_date": 1519741092, "question_id": 49010703, "link": "https://stackoverflow.com/questions/49010703/ror-access-module-function-in-a-scope-into-a-module", "title": "ROR Access module function in a scope into a module", "body": "<p>I try to create a module to manage access depending of an entity field on several models.\nThe name of my entity field depends on the schema of the current model which call it.</p>\n\n<p>My Module is : </p>\n\n<pre><code> module Modules::EntityManagement\n        extend ActiveSupport::Concern\n\n        def entity_field_name\n            self.class.connection.schema_search_path.split(\",\").first == 'public' ? 'entity_id' : 'entity_id__c'\n        end\n\n\n        included do\n            scope :myscope, lambda {\n                where('WHERE ? = ?', self.entity_field_name, 1) \n            }\n        end\n    end\n</code></pre>\n\n<p>When I call this on any model\n<code>Mymodel.myscope</code></p>\n\n<p>It returns an error</p>\n\n<pre><code>undefined method `entity_field_name' for #&lt;Class:0x007ff62da60150&gt;\n</code></pre>\n\n<p>I tried a lot of different syntax, but nothing works. </p>\n\n<p>How can I use a dynamic field name based on database schema in a module's scope ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "caching", "redis"], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 5952238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t9jlU85b-6g/AAAAAAAAAAI/AAAAAAAACO4/vF6RLACv5dA/photo.jpg?sz=128", "display_name": "Joo Alberto Martins de Oliveir", "link": "https://stackoverflow.com/users/5952238/joo-alberto-martins-de-oliveir"}, "is_accepted": true, "score": 0, "last_activity_date": 1519853558, "creation_date": 1519853558, "answer_id": 49038942, "question_id": 49010253, "link": "https://stackoverflow.com/questions/49010253/rails-adding-extra-line-in-my-redis-cache/49038942#49038942", "title": "Rails adding extra line in my redis cache", "body": "<p>After open a issue in the project repo I discovered that is the default behavior of rails wrapping the cache with that data.</p>\n\n<p>In my case I need to avoid it, then is needed set <code>row</code> as <code>true</code> in configs.</p>\n\n<pre><code>config.cache_store = :redis_store, {\n  host: ENV['REDIS_SERVER'] || 'localhost',\n  port: 6379,\n  db: 0,\n  namespace: ENV['CUSTOMER'],\n  raw: true\n}\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 5952238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t9jlU85b-6g/AAAAAAAAAAI/AAAAAAAACO4/vF6RLACv5dA/photo.jpg?sz=128", "display_name": "Joo Alberto Martins de Oliveir", "link": "https://stackoverflow.com/users/5952238/joo-alberto-martins-de-oliveir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 49038942, "answer_count": 1, "score": 1, "last_activity_date": 1519853558, "creation_date": 1519739305, "question_id": 49010253, "link": "https://stackoverflow.com/questions/49010253/rails-adding-extra-line-in-my-redis-cache", "title": "Rails adding extra line in my redis cache", "body": "<p>Im using <a href=\"https://github.com/redis-store/redis-rails\" rel=\"nofollow noreferrer\">redis-rails</a> in my project to store a cache of users, and I don't know why a extra line is added at begining of cache.</p>\n\n<p>This is my config:</p>\n\n<pre><code>config.cache_store = :redis_store, {\n  host: ENV['REDIS_SERVER'] || 'localhost',\n  port: 6379,\n  db: 0,\n  namespace: ENV['CUSTOMER']\n}\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>namespace :update_employees_cache do\n  desc \"Update employees cache\"\n  task update: :environment do\n    employees = []\n\n    Employee.where(active: true).each do |item|\n      employees.push({ id: item.id, name: item.name })\n    end\n\n    Rails.cache.write \"employees\", employees.to_json\n  end\nend\n</code></pre>\n\n<p>This is the result\n<a href=\"https://i.stack.imgur.com/z1qMY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z1qMY.png\" alt=\"Result\"></a></p>\n\n<p>At line 1, <code>o: ActiveSupport::Cache::Entry:\u000b@valueI\"\ufffd\u000e</code></p>\n\n<p>What is this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1519958796, "post_id": 49009163, "comment_id": 85129135, "body": "I get no result using the above."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1519735864, "creation_date": 1519735864, "answer_id": 49009163, "question_id": 49008935, "link": "https://stackoverflow.com/questions/49008935/how-to-query-from-serialize-hash-column-in-rails/49009163#49009163", "title": "How to query from serialize Hash column in Rails", "body": "<p>By default Rails serializes hashes as YAML, so you can do:</p>\n\n<pre><code>.where('preferences LIKE \"%published: true%\"')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1519958966, "post_id": 49009242, "comment_id": 85129187, "body": "It works, but it returns Array, I still need to have Activerecord, since I&#39;m doing a scope to this function, and join it with another scope. How can I do it?"}, {"owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "reply_to_user": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "edited": false, "score": 0, "creation_date": 1522251428, "post_id": 49009242, "comment_id": 86084414, "body": "You do what @mudasobwa said, so you have the ActiveRecord relationship. But it&#39;s not meant to be used that way. You should not query on a serialized field."}], "tags": [], "owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "is_accepted": true, "score": 1, "last_activity_date": 1519736124, "creation_date": 1519736124, "answer_id": 49009242, "question_id": 49008935, "link": "https://stackoverflow.com/questions/49008935/how-to-query-from-serialize-hash-column-in-rails/49009242#49009242", "title": "How to query from serialize Hash column in Rails", "body": "<p>You can't use native DB routines to query a serialized field.\nThe only way to do this query is to do</p>\n\n<p><code>User.all.select { |u| u.preferences['published'] == true }\n</code></p>\n\n<p>You only want to serialize fields when you don't want to query on it, and just expose the data 'as it'\nIf you need to global query on it, you should have a table UserPreference for example, with a user_id and the different preferences.</p>\n\n<p>You can 'hack' it doing what @mudasobwa said <code>.where('preferences LIKE \"%published: true%\"')</code>, but it can be risky.</p>\n"}], "owner": {"reputation": 2659, "user_id": 2534479, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2472926967c5dbb6e31895a660a472ce?s=128&d=identicon&r=PG", "display_name": "aldrien.h", "link": "https://stackoverflow.com/users/2534479/aldrien-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 0, "accepted_answer_id": 49009242, "answer_count": 2, "score": 1, "last_activity_date": 1519736124, "creation_date": 1519735158, "question_id": 49008935, "link": "https://stackoverflow.com/questions/49008935/how-to-query-from-serialize-hash-column-in-rails", "title": "How to query from serialize Hash column in Rails", "body": "<p>For example:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n serialize :preferences, Hash\nend\n</code></pre>\n\n<p><strong>preferences</strong> contains hash record...\nex:</p>\n\n<pre><code>{'category' =&gt; 'a', 'type' =&gt; 'b', 'published' =&gt; true}\n</code></pre>\n\n<p><strong>How can I do some query, where I have to return records that matched/equal to specific key-value in serialized column.</strong></p>\n\n<p>I want to have something like:</p>\n\n<pre><code>.where('preferences.published' =&gt; true)\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "xml", "xpath", "nokogiri"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519736090, "post_id": 49008844, "comment_id": 85022697, "body": "Please share the expected output."}], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 2283644, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/751dbb7bb8c1ec9f973ed8d32403821a?s=128&d=identicon&r=PG", "display_name": "Alexander Rumanovsk", "link": "https://stackoverflow.com/users/2283644/alexander-rumanovsk"}, "edited": false, "score": 0, "creation_date": 1519736646, "post_id": 49009357, "comment_id": 85023053, "body": "Thank you, that&#39;s exactly what I needed."}], "tags": [], "owner": {"reputation": 88945, "user_id": 290085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306077a2fb7af6587f470214a1b337ff?s=128&d=identicon&r=PG", "display_name": "kjhughes", "link": "https://stackoverflow.com/users/290085/kjhughes"}, "is_accepted": true, "score": 1, "last_activity_date": 1519736471, "creation_date": 1519736471, "answer_id": 49009357, "question_id": 49008844, "link": "https://stackoverflow.com/questions/49008844/get-xml-attribute-value-of-property-using-xpath/49009357#49009357", "title": "Get XML attribute value of property using XPath", "body": "<p>This XPath,</p>\n\n<pre><code>//property[@name='timestamp']/@value\n</code></pre>\n\n<p>will select all <code>value</code> attributes of <code>property</code> elements with a <code>name</code> attribute value equal to <code>'timestamp'</code>. </p>\n"}], "owner": {"reputation": 1141, "user_id": 2283644, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/751dbb7bb8c1ec9f973ed8d32403821a?s=128&d=identicon&r=PG", "display_name": "Alexander Rumanovsk", "link": "https://stackoverflow.com/users/2283644/alexander-rumanovsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 49009357, "answer_count": 1, "score": 2, "last_activity_date": 1519736690, "creation_date": 1519734905, "last_edit_date": 1519736690, "question_id": 49008844, "link": "https://stackoverflow.com/questions/49008844/get-xml-attribute-value-of-property-using-xpath", "title": "Get XML attribute value of property using XPath", "body": "<p>I have a XML like the example below:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;testsuite errors=\"0\" failures=\"0\" name=\"test\" tests=\"1\" time=\"2.747\"&gt;\n  &lt;properties&gt;\n    &lt;property name=\"categories\" value=\"ExampleCategory\" /&gt;\n    &lt;property name=\"timestamp\" value=\"1519664414463\" /&gt;\n  &lt;/properties&gt;\n  &lt;testcase classname=\"com.example.junit.Test\" name=\"test\" time=\"2.747\" /&gt;\n&lt;/testsuite&gt;\n</code></pre>\n\n<p>Is there a way to retrieve the property tag value according to the name of the property?</p>\n\n<p>Right now, I'm using something like that:</p>\n\n<pre><code>@doc.xpath('//testsuite//properties//property/@value').text\n</code></pre>\n\n<p>This will give me \"ExampleCategory1519664414463\". \nI know if I use <code>.first</code> or <code>[0]</code>, <code>[1]</code>, etc, I can get the values separately, but I couldn't find a way to get the values separately according to the \"name\" attribute. </p>\n\n<p>Anyone know how can I retrieve that?</p>\n"}, {"tags": ["ruby", "methods", "jruby"], "comments": [{"owner": {"reputation": 166, "user_id": 3177310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0e457fb3ebf0ea43ed2bb443fc28b2?s=128&d=identicon&r=PG&f=1", "display_name": "Poilon", "link": "https://stackoverflow.com/users/3177310/poilon"}, "edited": false, "score": 1, "creation_date": 1519735516, "post_id": 49008818, "comment_id": 85022340, "body": "I think the methods are JRuby specific, that may add some methods on the class BasicObject. I have that : BasicObject.methods(false)  =&gt; []"}], "answers": [{"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1519761243, "creation_date": 1519761243, "answer_id": 49016881, "question_id": 49008818, "link": "https://stackoverflow.com/questions/49008818/ruby-basicobject-methods/49016881#49016881", "title": "Ruby BasicObject methods", "body": "<p>Those methods are indeed defined on BasicObject, though they are mostly just empty definitions (<code>method_missing</code> actually does some work). Check the <a href=\"https://github.com/jruby/jruby/blob/47a8a24b055cf77f83ee455c95b856abab6cac7a/core/src/main/java/org/jruby/RubyBasicObject.java#L1672\" rel=\"nofollow noreferrer\">source</a>.</p>\n\n<p>I can't say exactly why, but there could be a hint in the comments:</p>\n\n<blockquote>\n  <p>Some care has been taken to make the implementation be as monomorphic\n  as possible, so that the Java Hotspot engine can improve performance\n  of it. That is the reason for several patterns that might seem odd in\n  this class.</p>\n</blockquote>\n\n<p>Those methods are all common hooks that are redefined for metaprogramming purposes. By defining them on BasicObject, it could be that this allows for much faster method resolution by simplifying the inheritance chain.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1520146176, "creation_date": 1520146176, "answer_id": 49092773, "question_id": 49008818, "link": "https://stackoverflow.com/questions/49008818/ruby-basicobject-methods/49092773#49092773", "title": "Ruby BasicObject methods", "body": "<p>You are not asking what instance methods are defined on <code>BasicObject</code>, that would be <code>BasicObject.instance_methods</code>. You are asking, what methods you can call on <code>BasicObject</code>. Well, <code>BasicObject</code> is an object just like any other object, so you can call any method on it that is defined in its class (which in this case is <code>Class</code>) or in the superclasses of its class (which in this case are <code>Module</code>, <code>Object</code>, <code>Kernel</code>, and <code>BasicObject</code>).</p>\n"}], "owner": {"reputation": 781, "user_id": 3819362, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/sL0P3.jpg?s=128&g=1", "display_name": "Aashish", "link": "https://stackoverflow.com/users/3819362/aashish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1520357370, "creation_date": 1519734783, "question_id": 49008818, "link": "https://stackoverflow.com/questions/49008818/ruby-basicobject-methods", "title": "Ruby BasicObject methods", "body": "<p>while going through Ruby, i encountered that BasicObject is the top most superclass of Class. When I tried\n <code>BasicObject.methods</code>, i get list of these methods</p>\n\n<pre><code>[:method_missing, :singleton_method_added, :singleton_method_undefined, :singleton_method_removed, :new, :become_java!, :allocate, :superclass, :java_class, :class_variables, :&lt;=, :public_instance_methods, :prepend, :class_variable_get, :public_constant, :singleton_class?, :instance_methods, :freeze, :instance_method, :const_defined?, :to_s, :constants, :ancestors, :private_instance_methods, :===, :included_modules, :==, :using, :class_eval, :const_get, :refine, :protected_instance_methods, :public_instance_method, :class_variable_defined?, :inspect, :name, :private_constant, :&lt;, :hash, :&gt;, :&gt;=, :module_exec, :protected_method_defined?, :module_eval, :const_missing, :class_exec, :const_set, :private_method_defined?, :public_class_method, :autoload, :&lt;=&gt;, :include, :public_method_defined?, :autoload?, :class_variable_set, :include?, :remove_class_variable, :deprecate_constant, :private_class_method, :method_defined?, :include_class, :handle_different_imports, :java_kind_of?, :public_send, :frozen?, :protected_methods, :java_implements, :public_method, :java, :singleton_methods, :untaint, :javafx, :enum_for, :private_methods, :method, :instance_variables, :object_id, :extend, :itself, :instance_variable_set, :respond_to?, :java_name, :methods, :to_java, :java_package, :singleton_class, :public_methods, :to_enum, :display, :tainted?, :instance_variable_defined?, :untrusted?, :define_singleton_method, :!~, :nil?, :com, :instance_of?, :java_require, :javax, :java_signature, :tap, :java_annotation, :send, :trust, :instance_variable_get, :is_a?, :eql?, :java_field, :remove_instance_variable, :untrust, :class, :=~, :org, :taint, :kind_of?, :clone, :dup, :!, :equal?, :instance_exec, :__id__, :instance_eval, :__send__, :!=]\n</code></pre>\n\n<p>(I have Jruby present as well so some extra methods)</p>\n\n<p>But when I call <code>BasicObject.methods(false)</code> (false parameter for displaying methods of the same class itself), I get</p>\n\n<pre><code>=&gt; [:method_missing, :singleton_method_added, :singleton_method_undefined, :singleton_method_removed]\n</code></pre>\n\n<p>I have a query, ideally class.methods with false param should return only its methods and BasicObject.superclass returns nil. Is there any other hierarchy? from where does these methods coming from.</p>\n\n<p>I'm learning Ruby Apologozies if i'm missing something.\nThanks </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "docker", "rubygems"], "comments": [{"owner": {"reputation": 7605, "user_id": 584552, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dc70f4a04726fada8b9db8a18ff40412?s=128&d=identicon&r=PG", "display_name": "mdesantis", "link": "https://stackoverflow.com/users/584552/mdesantis"}, "edited": false, "score": 0, "creation_date": 1519747399, "post_id": 49008314, "comment_id": 85030606, "body": "Can I ask you why <code>gem &#39;rails&#39;, &#39;~&gt; 5.1&#39;, &#39;&gt;= 5.1.5&#39;</code> instead of <code>gem &#39;rails&#39;, &#39;~&gt; 5.1.5&#39;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 8652851, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-DOGsx0ZO_8g/AAAAAAAAAAI/AAAAAAAAADs/c9tv63h0upc/photo.jpg?sz=128", "display_name": "gbaz", "link": "https://stackoverflow.com/users/8652851/gbaz"}, "edited": false, "score": 0, "creation_date": 1519736564, "post_id": 49008456, "comment_id": 85023000, "body": "Thanks for that @Atish. Now I am getting the error with the next gem in the file! Could not find gem &#39;sass-rails (~&gt; 5.0.7)&#39; in any of the gem sources listed in your Gemfile. ERROR: Service &#39;dockerzon&#39; failed to build: The command &#39;/bin/sh -c bundle binstubs bundler --force&#39; returned a non-zero code: 7"}, {"owner": {"reputation": 11, "user_id": 8401998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10e4165c5aedb237236150959e4fa6f?s=128&d=identicon&r=PG&f=1", "display_name": "Atish", "link": "https://stackoverflow.com/users/8401998/atish"}, "reply_to_user": {"reputation": 329, "user_id": 8652851, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-DOGsx0ZO_8g/AAAAAAAAAAI/AAAAAAAAADs/c9tv63h0upc/photo.jpg?sz=128", "display_name": "gbaz", "link": "https://stackoverflow.com/users/8652851/gbaz"}, "edited": false, "score": 0, "creation_date": 1519737989, "post_id": 49008456, "comment_id": 85023934, "body": "Remove &#39;~&gt; 5.0.7&#39; from saas-rails  and &#39;~&gt; 4.2.2&#39; from coffee-rails in <b>Gemfile</b>. Let gem file take the installed version of these gems. There must be rails 5.1 version installed, which is the latest one, thats why saas-rails 5.0 version is giving not found error."}, {"owner": {"reputation": 329, "user_id": 8652851, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-DOGsx0ZO_8g/AAAAAAAAAAI/AAAAAAAAADs/c9tv63h0upc/photo.jpg?sz=128", "display_name": "gbaz", "link": "https://stackoverflow.com/users/8652851/gbaz"}, "edited": false, "score": 0, "creation_date": 1519778843, "post_id": 49008456, "comment_id": 85045744, "body": "that didn&#39;t work Step 9/13 : RUN bundle binstubs bundler --force  ---&gt; Running in bd13ecd38b04 Could not find gem &#39;sass-rails&#39; in any of the gem sources listed in your Gemfile. ERROR: Service &#39;dockerzon&#39; failed to build: The command &#39;/bin/sh -c bundle binstubs bundler --force&#39; returned a non-zero code: 7. The gems install from the Gemfile if I run &quot;bundle install&quot; but not if I run bundle binstubs bundler --force which I am trying to use"}], "tags": [], "owner": {"reputation": 11, "user_id": 8401998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e10e4165c5aedb237236150959e4fa6f?s=128&d=identicon&r=PG&f=1", "display_name": "Atish", "link": "https://stackoverflow.com/users/8401998/atish"}, "is_accepted": false, "score": 1, "last_activity_date": 1519733582, "creation_date": 1519733582, "answer_id": 49008456, "question_id": 49008314, "link": "https://stackoverflow.com/questions/49008314/could-not-find-gem-rails/49008456#49008456", "title": "Could not find gem rails", "body": "<p>Add below lines in your Dockerfile</p>\n\n<blockquote>\n  <p>RUN gem install rails</p>\n</blockquote>\n\n<p><strong>ruby:2.5-slim</strong> this docker image doesn't contain rails. It only contains ruby. You can't install rails using Gemfile. You have to install rails before bundling your gemfile. </p>\n"}, {"comments": [{"owner": {"reputation": 329, "user_id": 8652851, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-DOGsx0ZO_8g/AAAAAAAAAAI/AAAAAAAAADs/c9tv63h0upc/photo.jpg?sz=128", "display_name": "gbaz", "link": "https://stackoverflow.com/users/8652851/gbaz"}, "edited": false, "score": 1, "creation_date": 1519779790, "post_id": 49012810, "comment_id": 85046051, "body": "Thanks @Kandy. This works fine if I run &quot;bundle install&quot; like you suggested but not if I run &quot;bundle binstubs bundler --force&quot; which I am trying to use"}, {"owner": {"reputation": 231, "user_id": 237528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3607916a2a8268d14afd2a29aa70b579?s=128&d=identicon&r=PG", "display_name": "Gtx", "link": "https://stackoverflow.com/users/237528/gtx"}, "edited": false, "score": 0, "creation_date": 1612523562, "post_id": 49012810, "comment_id": 116799556, "body": "Still helpful in 2021. Thanks :)"}], "tags": [], "owner": {"reputation": 136, "user_id": 2820764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acfe5fccf788fcf7934467611cd2aa00?s=128&d=identicon&r=PG", "display_name": "Kandy", "link": "https://stackoverflow.com/users/2820764/kandy"}, "is_accepted": false, "score": 3, "last_activity_date": 1519746870, "creation_date": 1519746870, "answer_id": 49012810, "question_id": 49008314, "link": "https://stackoverflow.com/questions/49008314/could-not-find-gem-rails/49012810#49012810", "title": "Could not find gem rails", "body": "<p>Try to update the version of your RubyGems:</p>\n\n<pre><code>gem update --system\n</code></pre>\n\n<p>Then change the line in Gemfile to:</p>\n\n<pre><code>gem 'rails', '~&gt; 5.1.5'\n</code></pre>\n\n<p>Now run bundler to install the gems:</p>\n\n<pre><code>bundle install\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 8652851, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-DOGsx0ZO_8g/AAAAAAAAAAI/AAAAAAAAADs/c9tv63h0upc/photo.jpg?sz=128", "display_name": "gbaz", "link": "https://stackoverflow.com/users/8652851/gbaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10758, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1519746870, "creation_date": 1519733166, "last_edit_date": 1519733290, "question_id": 49008314, "link": "https://stackoverflow.com/questions/49008314/could-not-find-gem-rails", "title": "Could not find gem rails", "body": "<p>I am trying to build a docker container but getting the following error message:</p>\n\n<pre><code>Step 8/12 : RUN bundle binstubs bundler --force\n ---&gt; Running in ed94b127974b\nCould not find gem 'rails (&gt;= 5.1.5, ~&gt; 5.1)' in any of the gem sources listed\nin your Gemfile.\nERROR: Service 'dockerzon' failed to build: The command '/bin/sh -c bundle binstubs bundler --force' returned a non-zero code: 7\n</code></pre>\n\n<p>I have tried with different versions of rails in my Gemfile with no success! This is what I have in my Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\n# gem 'rails', '4.2.6'\n# gem 'rails', '&gt;= 5.1.5'\ngem 'rails', '~&gt; 5.1', '&gt;= 5.1.5'\n# Use sqlite3 as the database for Active Record\n# gem 'sqlite3'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0.7'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 4.1.6'\n# Use CoffeeScript for .coffee assets and views\ngem 'coffee-rails', '~&gt; 4.2.2'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use jquery as the JavaScript library\ngem 'jquery-rails'\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\ngem 'turbolinks'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.7'\n# bundle exec rake doc:rails generates the API under doc/api.\ngem 'sdoc', '~&gt; 1.0.0', group: :doc\n\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Unicorn as the app server\n# gem 'unicorn'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug'\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\n  gem 'web-console', '~&gt; 3.5.1'\n\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\nend\n\ngem 'pg', '~&gt; 1.0.0'\ngem 'redis-rails', '~&gt; 5.0.2'\ngem 'sidekiq', '~&gt; 5.1.1'\ngem 'puma', '~&gt; 3.11.2'\ngem 'rack-timeout', '~&gt; 0.4.2'\n</code></pre>\n\n<p>and this is my Dockerfile:</p>\n\n<pre><code># Use the barebones version of Ruby 2.5\nFROM ruby:2.5-slim\n\n# Optionally set a maintainer name to let people know who made this image.\n\n# Install dependencies:\n# - build-essential: To ensure certain gems can be compiled\n# - nodejs: Compile assets\n# - libpq-dev: Communicate with postgres through the postgres gem\nRUN apt-get update &amp;&amp; apt-get install -qq -y --no-install-recommends \\\n      build-essential nodejs libpq-dev\n\n# Set an environment variable to store where the app is installed to inside\n# of the Docker image. The name matches the project name out of convention only.\nENV INSTALL_PATH /dockerzon\nRUN mkdir -p $INSTALL_PATH\n\n# This sets the context of where commands will be ran in and is documented\n# on Docker's website extensively.\nWORKDIR $INSTALL_PATH\n\n# Ensure gems are cached and only get updated when they change. This will\n# drastically increase build times when your gems do not change.\nCOPY Gemfile Gemfile\n\n# We want binstubs to be available so we can directly call sidekiq and\n# potentially other binaries as command overrides without depending on\n# bundle exec.\n# RUN bundle install --binstubs\nRUN bundle binstubs bundler --force\n\n# Copy in the application code from your work station at the current directory\n# over to the working directory.\nCOPY . .\n\n# Provide a dummy DATABASE_URL to Rails so it can pre-compile assets.\nRUN bundle exec rake RAILS_ENV=production DATABASE_URL=postgresql://user:pass@127.0.0.1/dbname SECRET_TOKEN=dummytoken assets:precompile\n\n# Ensure the static assets are exposed through a volume so that nginx can read\n# in these values later.\nVOLUME [\"$INSTALL_PATH/public\"]\n\n# The default command that gets ran will be to start the Puma server.\nCMD bundle exec puma -C config/puma.rb\n</code></pre>\n"}, {"tags": ["ruby", "mongodb"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519732180, "post_id": 49007946, "comment_id": 85020424, "body": "What mongo driver do you use? The official one uses <a href=\"https://docs.mongodb.com/ruby-driver/master/quick-start/#make-a-connection\" rel=\"nofollow noreferrer\"><code>Mongo::Client</code></a> not <code>Mongo::Connection</code> to establish the connection."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519735546, "post_id": 49007946, "comment_id": 85022359, "body": "Mongo <b>java</b> driver?!"}, {"owner": {"reputation": 1, "user_id": 9418417, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i4bYjuCt5VY/AAAAAAAAAAI/AAAAAAAAAcw/0WpKCvCYv1w/photo.jpg?sz=128", "display_name": "Fatima Ezzahra", "link": "https://stackoverflow.com/users/9418417/fatima-ezzahra"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519738356, "post_id": 49007946, "comment_id": 85024174, "body": "C:\\Sites\\test_app&gt;ruby connect.rb D, [2018-02-27T13:30:06.320649 #3184] DEBUG -- : MONGODB | Topology type &#39;unknown&#39; initializing. D, [2018-02-27T13:30:06.320649 #3184] DEBUG -- : MONGODB | Server 127.0.0.1:27017 initializing. D, [2018-02-27T13:30:06.337667 #3184] DEBUG -- : MONGODB |"}, {"owner": {"reputation": 1, "user_id": 9418417, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i4bYjuCt5VY/AAAAAAAAAAI/AAAAAAAAAcw/0WpKCvCYv1w/photo.jpg?sz=128", "display_name": "Fatima Ezzahra", "link": "https://stackoverflow.com/users/9418417/fatima-ezzahra"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519738371, "post_id": 49007946, "comment_id": 85024184, "body": "Topology type &#39;unknown&#39; changed to type &#39;single&#39;. D, [2018-02-27T13:30:06.338681 #3184] DEBUG -- : MONGODB | Server description for 127.0.0.1:27017 changed from &#39;unknown&#39; to &#39;standalone&#39;. D, [2018-02-27T13:30:06.339713 #3184] DEBUG -- : MONGODB | There was a change in the members of the &#39;single&#39; topology. connect.rb:6:in <code>&lt;main&gt;&#39;: undefined method </code>[]&#39; for #&lt;Mongo::Collection:0x5474628&gt; (NoMethodError)"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1519739243, "creation_date": 1519739243, "answer_id": 49010228, "question_id": 49007946, "link": "https://stackoverflow.com/questions/49007946/main-undefined-local-variable-or-method-database-for-mainobject-nameerr/49010228#49010228", "title": "`&lt;main&gt;&#39;: undefined local variable or method `database&#39; for main:Object (NameError)", "body": "<p>As clearly specified in <a href=\"https://docs.mongodb.com/ruby-driver/master/quick-start/#access-a-database-and-a-collection\" rel=\"nofollow noreferrer\">the documentation</a>, the connection should be established that way:</p>\n\n<pre><code>@con = Mongo::Client.new('mongodb://127.0.0.1:27017/tutorial')\n@users = @con[:users]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9418417, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i4bYjuCt5VY/AAAAAAAAAAI/AAAAAAAAAcw/0WpKCvCYv1w/photo.jpg?sz=128", "display_name": "Fatima Ezzahra", "link": "https://stackoverflow.com/users/9418417/fatima-ezzahra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1519739243, "creation_date": 1519732015, "last_edit_date": 1519735321, "question_id": 49007946, "link": "https://stackoverflow.com/questions/49007946/main-undefined-local-variable-or-method-database-for-mainobject-nameerr", "title": "`&lt;main&gt;&#39;: undefined local variable or method `database&#39; for main:Object (NameError)", "body": "<p>I want to connect MongoDB with Ruby.</p>\n\n<p>I've used the following Ruby file:</p>\n\n<pre><code>require 'rubygems'\nrequire 'mongo'\n\n@con = Mongo::Connection.new\n@db = @con['tutorial']\n@users = @db['users']\n</code></pre>\n\n<p>When I use the command <code>ruby connect.rb</code> I get this error:</p>\n\n<blockquote>\n  <p>undefined local variable or method 'database' for main:Object (NameError)</p>\n</blockquote>\n"}, {"tags": ["ruby", "api", "ruby-on-rails-3", "twitter"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519731718, "post_id": 49007754, "comment_id": 85020133, "body": "What error do you get?"}, {"owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519733595, "post_id": 49007754, "comment_id": 85021256, "body": "ArgumentError: invalid byte sequence in UTF-8"}, {"owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519733650, "post_id": 49007754, "comment_id": 85021286, "body": "Want to upload large media to Twitter without using any gem"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519735514, "post_id": 49007754, "comment_id": 85022337, "body": "Why would you encode the video with <code>.encode(&#39;utf-8&#39;, &#39;binary&#39;</code>? What does it suppose to do? Just read it as binary and upload."}, {"owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519735601, "post_id": 49007754, "comment_id": 85022396, "body": "How to upload binary in a chunk ?"}, {"owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519736683, "post_id": 49007754, "comment_id": 85023074, "body": "Figured it out, Thanks for your help @mudasobwa"}, {"owner": {"reputation": 41223, "user_id": 175836, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d3b5a5015d8459c645abe6e906b9e77b?s=128&d=identicon&r=PG", "display_name": "randombits", "link": "https://stackoverflow.com/users/175836/randombits"}, "edited": false, "score": 0, "creation_date": 1543440115, "post_id": 49007754, "comment_id": 93925343, "body": "@MihirKumarThakur mind following up with what the solution was?"}], "owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519731393, "creation_date": 1519731393, "question_id": 49007754, "link": "https://stackoverflow.com/questions/49007754/chunk-upload-media-to-twitter-uisng-ruby-1-9-3", "title": "Chunk upload media to twitter uisng ruby 1.9.3", "body": "<p>I am uploading large video to Twitter and getting erros </p>\n\n<pre><code>media = File.open('/home/geobeats/Downloads/test.mp4', 'rb')\nsegment_id = 0\nbytes_sent = 0\naccess_token = Oauth::Twitter.new.access_token\nresp_1 = access_token.post(\"https://upload.twitter.com/1.1/media/upload.json\", \n  {command: 'INIT', media_type: 'video/mp4', total_bytes: media.size, media_category: 'tweet_video'})\n\nwhile bytes_sent &lt; media.size\n  chunk = media.read(4*1024*1024).encode('utf-8', 'binary', invalid: :replace, undef: :replace, replace: '')\n  req = access_token.post(\"https://upload.twitter.com/1.1/media/upload.json\", \n    {command: 'APPEND', media_id: JSON.parse(resp_1.body)['media_id'], segment_index: segment_id, media: chunk})\n\n  p req.body\n\n  segment_id = segment_id + 1\n  bytes_sent = media.tell\nend\n</code></pre>\n\n<p>Every time it gives error at APPEND call</p>\n"}, {"tags": ["ruby", "postgresql", "full-text-search", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 2001, "user_id": 1082174, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1ff427530e3fe61b67729327f83c5d1?s=128&d=identicon&r=PG", "display_name": "N&#237;colas Iensen", "link": "https://stackoverflow.com/users/1082174/n%c3%adcolas-iensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1519727802, "creation_date": 1519727802, "answer_id": 49006604, "question_id": 49006603, "link": "https://stackoverflow.com/questions/49006603/how-to-combine-full-text-search-with-unaccent-using-sequel-gem/49006604#49006604", "title": "How to combine full_text_search with unaccent using Sequel gem?", "body": "<p>We can achieve the expected result by using the class <code>Sequel::SQL::Function</code>:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># Given a user with first_name: N\u00edcolas\ncol = Sequel.qualify(:users, :first_name)\ncol_without_accent = Sequel::SQL::Function.new(:UNACCENT, col)\nPerson.full_text_search(col_without_accent, \"nicolas\").count\n# =&gt; 1\n</code></pre>\n\n<p>We can also apply the same <code>unaccent</code> function to the term used to match results:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>Person.full_text_search(col_without_accent, Sequel::SQL::Function.new(:UNACCENT, \"n\u00edcolas\")).count\n</code></pre>\n"}], "owner": {"reputation": 2001, "user_id": 1082174, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e1ff427530e3fe61b67729327f83c5d1?s=128&d=identicon&r=PG", "display_name": "N&#237;colas Iensen", "link": "https://stackoverflow.com/users/1082174/n%c3%adcolas-iensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519727802, "creation_date": 1519727802, "question_id": 49006603, "link": "https://stackoverflow.com/questions/49006603/how-to-combine-full-text-search-with-unaccent-using-sequel-gem", "title": "How to combine full_text_search with unaccent using Sequel gem?", "body": "<p>How can I use the method <a href=\"http://sequel.jeremyevans.net/rdoc-adapters/classes/Sequel/Postgres/DatasetMethods.html#method-i-full_text_search\" rel=\"nofollow noreferrer\"><code>Sequel.full_text_search</code></a> combined with the function available in PostgreSQL <code>unaccent</code> in order to return records that match the search term regardless characters with accents?</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># Given a user with first_name: N\u00edcolas\nUser.full_text_search(:first_name, \"nicolas\").count\n# Expected result to be 1, but it is 0\n</code></pre>\n"}, {"tags": ["ruby", "twilio", "twilio-api"], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 3462483, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/636235656/picture?type=large", "display_name": "doz87", "link": "https://stackoverflow.com/users/3462483/doz87"}, "edited": false, "score": 0, "creation_date": 1519776024, "post_id": 49009458, "comment_id": 85044970, "body": "Are you saying that to get a paginated result set I need to use the <code>page</code> method?  If I call the <code>list</code> method I will just receive a full result set (like the 4.5k results I am currently getting)?  I just thought that the documentation stated that list resources would contain <code>Paging Information</code> which would contain properties like <code>first_page_uri</code> and <code>next_page_uri</code> which I&#39;m currently not getting.   I am however getting that result when I use <code>curl</code> on the same endpoint??"}, {"owner": {"reputation": 581, "user_id": 3462483, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/636235656/picture?type=large", "display_name": "doz87", "link": "https://stackoverflow.com/users/3462483/doz87"}, "edited": false, "score": 0, "creation_date": 1519776132, "post_id": 49009458, "comment_id": 85044999, "body": "The documentation also states  \u2013  &quot;When fetching multiple pages of API results, use the provided nextpageuri parameter to retrieve the next page of results. All of  the Twilio Helper Libraries use the nextpageuri to page through  resources.&quot;  <a href=\"https://www.twilio.com/docs/api/rest/response#response-formats-list-filters\" rel=\"nofollow noreferrer\">Paging Through API Resources</a>"}, {"owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "reply_to_user": {"reputation": 581, "user_id": 3462483, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/636235656/picture?type=large", "display_name": "doz87", "link": "https://stackoverflow.com/users/3462483/doz87"}, "edited": false, "score": 0, "creation_date": 1519799821, "post_id": 49009458, "comment_id": 85051443, "body": "Yes, using <code>page</code> gets you a page and uses the <code>nextpageurl</code> parameter when you then call <code>next_page</code>. The <code>list</code> method uses <code>page</code> internally and paginates through for you. You can set a <code>:limit</code> option on <code>list</code> to retrieve less results, but if you want to page manually, then <code>page</code> is the method for you. I apologise for the discrepancy between the method names and the documentation that causes this confusion though."}], "tags": [], "owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "is_accepted": false, "score": 1, "last_activity_date": 1519736774, "creation_date": 1519736774, "answer_id": 49009458, "question_id": 49006487, "link": "https://stackoverflow.com/questions/49006487/querying-twilio-calls-list-resource-doesnt-paginate-the-results-using-ruby-or-p/49009458#49009458", "title": "Querying Twilio calls list resource doesn&#39;t paginate the results using Ruby or PHP", "body": "<p>Twilio developer evangelist here.</p>\n\n<p><code>list</code> will paginate through, loading all the resources it can.</p>\n\n<p>There are other calls that will stream the API in a lazier fashion, if that is more useful for your use case. For example, you can use <code>each</code> and it will load the calls lazily until they have run out.</p>\n\n<pre><code>@calls = @client.calls.each(\n  start_time_after: @time\n  start_time_before: @another_time\n) do |call|\n  puts call.direction\nend\n</code></pre>\n\n<p>If you do want to manually paginate yourself, you can the <code>page</code> method to get a <code>CallPage</code> object and iterate from there.</p>\n\n<pre><code>page = @client.calls.page(\n  start_time_after: @time\n  start_time_before: @another_time\n)\nwhile !page.nil? do\n  page.each { |call| puts call.direction }\n  page = page.next_page\nend\n</code></pre>\n\n<p>Let me know if that helps at all.</p>\n"}], "owner": {"reputation": 581, "user_id": 3462483, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/636235656/picture?type=large", "display_name": "doz87", "link": "https://stackoverflow.com/users/3462483/doz87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519736774, "creation_date": 1519727466, "question_id": 49006487, "link": "https://stackoverflow.com/questions/49006487/querying-twilio-calls-list-resource-doesnt-paginate-the-results-using-ruby-or-p", "title": "Querying Twilio calls list resource doesn&#39;t paginate the results using Ruby or PHP", "body": "<p>According to Twilio's documentation <a href=\"https://www.twilio.com/docs/api/voice/call#paging\" rel=\"nofollow noreferrer\">here</a> regarding \"paging\":</p>\n\n<blockquote>\n  <p>The list returned to you includes paging information. If you plan on requesting more records than will fit on a single page, you may want to use the provided nextpageuri rather than incrementing through the pages by page number.</p>\n</blockquote>\n\n<p>It then gives an example:</p>\n\n<pre><code># Initialize Twilio Client\n@client = Twilio::REST::Client.new(account_sid, auth_token)\n\n@client.calls.list\n       .each do |call|\n         puts call.direction\n       end\n</code></pre>\n\n<p>However, doing this just returns an array of all calls, there isn't any paging information or limiting of results or any \"pages\".</p>\n\n<p>For my purposes I'm actually filtering the query like this:</p>\n\n<pre><code>@calls = @client.calls.list(\n          start_time_after: @time\n          start_time_before: @another_time\n)\n</code></pre>\n\n<p>Because my date filter range is a 1 month period and there are currently about 4.5k calls to retrieve, its taking quite a while to process (and sometimes it just never processes)</p>\n\n<p>I'm using the twilio helper library ruby gem \"twilio-ruby\" and running ruby 2.5\nI've also tried using PHP with the respective twilio helper library and have found the same result.</p>\n\n<p>Using curl however does work and gives paging information, its also incredibly fast compared to using the helper libraries</p>\n"}, {"tags": ["ruby", "regex", "string-matching", "regex-negation", "regex-lookarounds"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1519726496, "post_id": 49006057, "comment_id": 85016750, "body": "Try <code>&#47;^(?!.*\\bdelayed\\b)(?=.*\\bconsumer\\b)(?=.*\\bservices\\b)&#47;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1519726518, "post_id": 49006138, "comment_id": 85016766, "body": "Note: <i>I would like to regex match to happen if the string has &quot;consumer&quot; <b>and</b> &quot;services&quot;</i>. BTW, the trailing <code>.*</code> is redundant."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1519727627, "last_edit_date": 1519727627, "creation_date": 1519726387, "answer_id": 49006138, "question_id": 49006057, "link": "https://stackoverflow.com/questions/49006057/regex-exclude-or-include-a-match-based-on-word-match-not-match/49006138#49006138", "title": "Regex: Exclude or include a match based on word match/not match", "body": "<p>You might use the negative lookahead:</p>\n\n<pre><code>\u25b6 input = [\"Consumer are offered services based on the plans selected\",\n\u25b7   \"In case ,the consumer services are delayed then penalty shall be beared.\"]  \n\n\u25b6 input.map { |line| line =~ /(?!.*delayed)(consumer|services)/ }\n#\u21d2 [21, nil]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1519726642, "creation_date": 1519726642, "answer_id": 49006217, "question_id": 49006057, "link": "https://stackoverflow.com/questions/49006057/regex-exclude-or-include-a-match-based-on-word-match-not-match/49006217#49006217", "title": "Regex: Exclude or include a match based on word match/not match", "body": "<p>Do you really need a regular expression for this? I think the code will be much easier to understand without one:</p>\n\n<pre><code>input = 'Consumer are offered services based on the plans selected'\n\ninput_lower = input.downcase\n\ninput_lower.include?('consumer') &amp;&amp;\n  input_lower.include?('services') &amp;&amp;\n  !input_lower.include?('delayed')\n</code></pre>\n\n<p>This isn't <em>exactly</em> checking what you asked since it's not looking for <em>word boundaries</em> (e.g. <code>'Consumers'</code> will also match), but that's probably desirable anyway.</p>\n"}], "owner": {"reputation": 415, "user_id": 1163466, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/cef17ea14120975403802aff1650cb31?s=128&d=identicon&r=PG", "display_name": "DonRaHulk", "link": "https://stackoverflow.com/users/1163466/donrahulk"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1519726621, "answer_count": 2, "score": -1, "last_activity_date": 1583136670, "creation_date": 1519726110, "question_id": 49006057, "link": "https://stackoverflow.com/questions/49006057/regex-exclude-or-include-a-match-based-on-word-match-not-match", "closed_reason": "Duplicate", "title": "Regex: Exclude or include a match based on word match/not match", "body": "<p>I would like to match a sentence if few words are present and discard the match if certain other words are present.</p>\n\n<p>For example:</p>\n\n<p>I would like to regex match to happen if the string has \"consumer\" and \"services\" and the match not to happen if the string has word \"delayed\".</p>\n\n<p>Match to happen:</p>\n\n<pre><code>\"Consumer are offered services based on the plans selected\"\n</code></pre>\n\n<p>Match not to happen:</p>\n\n<pre><code>\"In case ,the consumer services are delayed then penalty shall be beared.\"\n</code></pre>\n\n<p>Regex written for match:</p>\n\n<pre><code>(\\b(?:consumer)\\b.*?services)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "searchkick"], "comments": [{"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1519721624, "post_id": 49004528, "comment_id": 85013694, "body": "Did you try to search with a string value? <code>Book.search(&quot;120&quot;, fields: [:pages])</code>"}, {"owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "reply_to_user": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1519721881, "post_id": 49004528, "comment_id": 85013871, "body": "yes still no effect."}, {"owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "reply_to_user": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1519721924, "post_id": 49004528, "comment_id": 85013897, "body": "my guess is the query will always be string but i need to tell searchkick that pages property is integer and should be treated like that for search. but dont know how to tell searchkick that."}, {"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1519727561, "post_id": 49004528, "comment_id": 85017482, "body": "What&#39;s the response you get when you call the method in the console?"}], "answers": [{"tags": [], "owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "is_accepted": true, "score": 1, "last_activity_date": 1519800152, "creation_date": 1519800152, "answer_id": 49023434, "question_id": 49004528, "link": "https://stackoverflow.com/questions/49004528/how-to-search-integer-fields-using-searchkick/49023434#49023434", "title": "How to search integer fields using searchkick?", "body": "<p>I fixed it with this</p>\n\n<p>In Book model</p>\n\n<pre><code>  def search_data\n    {\n\n      name: name,\n      author: author,\n      pages: pages.to_s \n\n\n    }\n  end\n</code></pre>\n"}], "owner": {"reputation": 2821, "user_id": 734861, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/898cac257f853f8bf0a1a84a67d88c40?s=128&d=identicon&r=PG", "display_name": "kofhearts", "link": "https://stackoverflow.com/users/734861/kofhearts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 49023434, "answer_count": 1, "score": 1, "last_activity_date": 1519800152, "creation_date": 1519721243, "question_id": 49004528, "link": "https://stackoverflow.com/questions/49004528/how-to-search-integer-fields-using-searchkick", "title": "How to search integer fields using searchkick?", "body": "<p>How to make searchkick search integer fields?</p>\n\n<p>Let's say i have a Book model with three properties namely name:string, author:string and pages:integer. </p>\n\n<p>I want to search according to pages field. Right now if i use a query like below it works for string fields i.e name and author but it doesnt work for pages field which is of integer type. </p>\n\n<pre><code>Book.search(q, \n            misspellings: { below: 5 }, \n            fields: [:name, :author, :pages], \n            order: { name: 'asc' }, \n            page: params[:page], \n            per_page: 20)\n</code></pre>\n\n<p>I go to console and just searched Book.search(120, fields: [:pages]) and it returns empty result even though there are records with pages 120. Why is searchkick not searching for integer fields? I appreciate any help to this dilemma i am facing. Thanks!</p>\n"}, {"tags": ["ruby", "date", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519720691, "post_id": 49004335, "comment_id": 85013108, "body": "<a href=\"https://github.com/bokmann/business_time\" rel=\"nofollow noreferrer\">github.com/bokmann/business_time</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519724013, "post_id": 49004335, "comment_id": 85015139, "body": "Side note: Check out the <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow noreferrer\">ruby style guide</a>. Ruby projects are <i>very</i> consistent in how basic code is structured - i.e. 2 space tabs, and no need for explicit <code>return</code> statements like that."}, {"owner": {"reputation": 44, "user_id": 6656970, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-DxGif210ro8/AAAAAAAAAAI/AAAAAAAAAcw/jXhVPMglwG4/photo.jpg?sz=128", "display_name": "ph\u1ea1m tu\u1ea5n", "link": "https://stackoverflow.com/users/6656970/ph%e1%ba%a1m-tu%e1%ba%a5n"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519736467, "post_id": 49004335, "comment_id": 85022949, "body": "@TomLord Thank i remember note :)"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1519721171, "creation_date": 1519721171, "answer_id": 49004505, "question_id": 49004335, "link": "https://stackoverflow.com/questions/49004335/ruby-find-date-with-your-day-except-weekend/49004505#49004505", "title": "Ruby find date with your day except weekend", "body": "<pre><code>def add_working_days date, num\n  num.times.inject(date) do |date|\n    case date.wday\n    when 5 then date + 3\n    when 6 then date + 2\n    else date + 1\n    end\n  end\nend\n\nmain \u25b6 add_working_days Date.today, 3\n#\u21d2 #&lt;Date: 2018-03-02 ((2458180j,0s,0n),+0s,2299161j)&gt;\nmain \u25b6 add_working_days Date.today, 5\n#\u21d2 #&lt;Date: 2018-03-06 ((2458184j,0s,0n),+0s,2299161j)&gt;\nmain \u25b6 add_working_days Date.today, 7\n#\u21d2 #&lt;Date: 2018-03-08 ((2458186j,0s,0n),+0s,2299161j)&gt;\nmain \u25b6 add_working_days Date.today, 10\n#\u21d2 #&lt;Date: 2018-03-13 ((2458191j,0s,0n),+0s,2299161j)&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1519724637, "creation_date": 1519724637, "answer_id": 49005555, "question_id": 49004335, "link": "https://stackoverflow.com/questions/49004335/ruby-find-date-with-your-day-except-weekend/49005555#49005555", "title": "Ruby find date with your day except weekend", "body": "<p>Using the <a href=\"https://github.com/bokmann/business_time\" rel=\"nofollow noreferrer\"><code>business_time</code></a> gem (which allows extra features, such as defining <code>BusinessTime::Config.holidays</code>), this could be written as:</p>\n\n<pre><code>1.business_day.after(date)\n</code></pre>\n\n<p>Or as a more generic helper method:</p>\n\n<pre><code>def add_working_days(date, num)\n  num.business_days.after(date)\nend\n</code></pre>\n\n<p>I would advise using this library if this is a common/complex problem to solve within your application.</p>\n"}, {"tags": [], "owner": {"reputation": 1905, "user_id": 232838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8342950f34a66d9ec7cfe10b33d5494c?s=128&d=identicon&r=PG", "display_name": "koffeinfrei", "link": "https://stackoverflow.com/users/232838/koffeinfrei"}, "is_accepted": false, "score": 1, "last_activity_date": 1519725926, "creation_date": 1519725926, "answer_id": 49005989, "question_id": 49004335, "link": "https://stackoverflow.com/questions/49004335/ruby-find-date-with-your-day-except-weekend/49005989#49005989", "title": "Ruby find date with your day except weekend", "body": "<p>You can make use of a <a href=\"http://ruby-doc.org/core-2.0.0/Enumerator/Lazy.html\" rel=\"nofollow noreferrer\">lazy enumerator</a> in ruby to skip all future Saturdays and Sundays and get the date of the next workday in a functional style without any conditionals.</p>\n\n<pre><code>def next_workday(number_of_days)\n  (DateTime.now..DateTime::Infinity.new)\n    .lazy\n    .reject { |x| x.saturday? || x.sunday? }\n    .drop(number_of_days)\n    .first\nend\n</code></pre>\n"}], "owner": {"reputation": 44, "user_id": 6656970, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-DxGif210ro8/AAAAAAAAAAI/AAAAAAAAAcw/jXhVPMglwG4/photo.jpg?sz=128", "display_name": "ph\u1ea1m tu\u1ea5n", "link": "https://stackoverflow.com/users/6656970/ph%e1%ba%a1m-tu%e1%ba%a5n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 2, "accepted_answer_id": 49004505, "answer_count": 3, "score": 1, "last_activity_date": 1519736630, "creation_date": 1519720557, "last_edit_date": 1519736630, "question_id": 49004335, "link": "https://stackoverflow.com/questions/49004335/ruby-find-date-with-your-day-except-weekend", "title": "Ruby find date with your day except weekend", "body": "<p>I want make a def get day when you input the day. We have 5 day working in week except weekend.<br>\nEx: to day : 27/02/2018<br>\nyou input: 3 -> out put: 02/03/2018<br>\nyou input: 5 -> out put: 06/03/2018<br>\nyou input: 7 -> out put: 08/03/2018<br>\nyou input: 10 -> out put: 13/03/2018<br></p>\n\n<p>my code:</p>\n\n<pre><code>require 'date'\n\ndef next_week d, c\n   return d + 7 * c\nend\n\ndef my_add_day day\n    d = Date.today\n    d = next_week d, day/5\n    day = day % 5\n    if (6 - d.wday) &gt; day\n        d = d + day\n    else\n        d = d + day + 2\n    end\n    return d\nend\n</code></pre>\n\n<p><br>\nyou can use gem <a href=\"https://github.com/bokmann/business_time\" rel=\"nofollow noreferrer\">https://github.com/bokmann/business_time</a></p>\n"}, {"tags": ["ruby", "class", "methods"], "answers": [{"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": false, "score": 3, "last_activity_date": 1519718632, "creation_date": 1519718632, "answer_id": 49003856, "question_id": 49003706, "link": "https://stackoverflow.com/questions/49003706/why-methods-to-i-and-to-f-are-not-appearing-in-string-methods/49003856#49003856", "title": "Why methods to_i and to_f are not appearing in String.methods?", "body": "<p>Because <code>Object#methods</code> lists the methods of the given object.</p>\n\n<p>To list the instance methods of a given class, use <code>Module#instance_methods</code>:</p>\n\n<pre><code>String.instance_methods.grep /to_i|to_f/ # =&gt; [:to_i, :to_f]\n</code></pre>\n\n<hr>\n\n<p>Alternatively, if you have an instance, you can search through its methods:</p>\n\n<pre><code>'42'.methods.grep /to_i|to_f/ # =&gt; [:to_i, :to_f]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519720596, "post_id": 49004019, "comment_id": 85013059, "body": "<code>String</code> is a constant, not \u201ca class,\u201d btw."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519743981, "post_id": 49004019, "comment_id": 85028124, "body": "@mudasobwa I don&#39;t get you, how come? &#39;Raj&#39;.class return String. Said that, it must be class,right?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519744983, "post_id": 49004019, "comment_id": 85028859, "body": "@RAJ <code>String</code> literal itself is a ruby constant, assigned to store a class."}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519745205, "post_id": 49004019, "comment_id": 85029015, "body": "@mudasobwa How do you know String literal is a ruby constant?  How do I verify this? How do I know it&#39;s a constant not a class?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "edited": false, "score": 0, "creation_date": 1519745586, "post_id": 49004019, "comment_id": 85029283, "body": "@RAJ <code>Kernel.const_get(&#39;String&#39;)</code>"}, {"owner": {"reputation": 798, "user_id": 4091011, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f05f3852947f6076f3ad900ec0dac603?s=128&d=identicon&r=PG&f=1", "display_name": "RAJ", "link": "https://stackoverflow.com/users/4091011/raj"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1519748950, "post_id": 49004019, "comment_id": 85031632, "body": "@mudasobwa ah that&#39;s a great way!"}], "tags": [], "owner": {"reputation": 3865, "user_id": 4540175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a789c8057fed1368f96c15cfbdba6421?s=128&d=identicon&r=PG&f=1", "display_name": "gates", "link": "https://stackoverflow.com/users/4540175/gates"}, "is_accepted": false, "score": 0, "last_activity_date": 1519719264, "creation_date": 1519719264, "answer_id": 49004019, "question_id": 49003706, "link": "https://stackoverflow.com/questions/49003706/why-methods-to-i-and-to-f-are-not-appearing-in-string-methods/49004019#49004019", "title": "Why methods to_i and to_f are not appearing in String.methods?", "body": "<p>What ndn said is true, however I would like to add my 2 cents</p>\n\n<pre><code>\"3\".class\n=&gt; String\n</code></pre>\n\n<p>Here the 3 is an instance of String class.</p>\n\n<p>So you got to check instance methods of String</p>\n\n<pre><code>String.instance_methods.grep /to_i|to_f/\n=&gt; [:to_i, :to_f]\n</code></pre>\n\n<p>When you do <code>String.methods.sort</code> you are asking for class methods of String, because String is a class in this context</p>\n"}], "owner": {"reputation": 19, "user_id": 7694052, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9N6WMpAqEzw/AAAAAAAAAAI/AAAAAAAAOJ0/3TlfIw4n7as/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7694052/krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1519719618, "creation_date": 1519718039, "last_edit_date": 1519719618, "question_id": 49003706, "link": "https://stackoverflow.com/questions/49003706/why-methods-to-i-and-to-f-are-not-appearing-in-string-methods", "title": "Why methods to_i and to_f are not appearing in String.methods?", "body": "<p>I thought the <code>#methods</code> method would list all methods in a class.\nWhy aren't <code>to_i</code> and <code>to_f</code> appearing when I type <code>String.methods.sort</code>?</p>\n\n<p><code>to_i</code> is supposed to convert a String into an integer and <code>to_f</code> -\n convert a string into a float.</p>\n\n<pre><code>String.methods.sort\n[:!, :!=, :!~, :&lt;, :&lt;=, :&lt;=&gt;, :==, :===, :=~, :&gt;, :&gt;=, :__id__,\n:__send__, :allocate, :ancestors, :autoload, :autoload?, :class,\n:class_eval, :class_exec, :class_variable_defined?,\n:class_variable_get, :class_variable_set, :class_variables, :clone,\n:const_defined?, :const_get, :const_missing, :const_set, :constants,\n:define_singleton_method, :deprecate_constant, :display, :dup,\n:enum_for, :eql?, :equal?, :extend, :freeze, :frozen?, :hash, \n:include, :include?, :included_modules, :inspect, :instance_eval,\n:instance_exec, :instance_method, :instance_methods, :instance_of?,\n:instance_variable_defined?, :instance_variable_get,\n:instance_variable_set, :instance_variables, :is_a?, :itself,\n:kind_of?, :method, :method_defined?, :methods, :module_eval, \n:module_exec, :name, :new, :nil?, :object_id, :prepend,\n:private_class_method, :private_constant, :private_instance_methods,\n:private_method_defined?, :private_methods, \n:protected_instance_methods, :protected_method_defined?, \n:protected_methods, :public_class_method, :public_constant,\n:public_instance_method, :public_instance_methods, :public_method,\n:public_method_defined?, :public_methods, :public_send,\n:remove_class_variable, :remove_instance_variable, :respond_to?,\n:send, :singleton_class, :singleton_class?, :singleton_method, \n:singleton_methods, :superclass, :taint, :tainted?, :tap, :to_enum,\n:to_s, :trust, :try_convert, :untaint, :untrust, :untrusted?]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "http", "http-headers", "httpresponse"], "comments": [{"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519716344, "post_id": 49003003, "comment_id": 85010873, "body": "its Depends, its depends on your Application, Logic, Flow....and so on"}, {"owner": {"reputation": 11, "user_id": 5087987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a74ae9577fac78b540e87845a801c4?s=128&d=identicon&r=PG&f=1", "display_name": "ronak", "link": "https://stackoverflow.com/users/5087987/ronak"}, "reply_to_user": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519717964, "post_id": 49003003, "comment_id": 85011704, "body": "During networking does the response headers change due to any middlewares? Do headers gets affected due to proxies?"}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519718287, "post_id": 49003003, "comment_id": 85011853, "body": "Be specific, If you are looking for <code>During networking does the response headers change due to any middlewares? Do headers gets affected due to proxies? </code>  then you need to specify all aspect that you are looking."}, {"owner": {"reputation": 11, "user_id": 5087987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a74ae9577fac78b540e87845a801c4?s=128&d=identicon&r=PG&f=1", "display_name": "ronak", "link": "https://stackoverflow.com/users/5087987/ronak"}, "reply_to_user": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519726534, "post_id": 49003003, "comment_id": 85016777, "body": "I am setting &#39;Iso-Code&#39; in response headers, which seems very generic key. It may happen that some middlewares using the same key during processing particular request, and may alter the value. should I use a specific scope? like setting key as &#39;My-Custom-key&#39; and value as { iso-code: &#39;USD&#39;}."}, {"owner": {"reputation": 3004, "user_id": 5830036, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/B2b06.png?s=128&g=1", "display_name": "Mayur Shah", "link": "https://stackoverflow.com/users/5830036/mayur-shah"}, "edited": false, "score": 0, "creation_date": 1519730137, "post_id": 49003003, "comment_id": 85019145, "body": "Use Secure Headers, look at the blog you will get some more idea of header <code>https:&#47;&#47;blog.appcanary.com&#47;2017&#47;http-security-headers.html</code>"}], "owner": {"reputation": 11, "user_id": 5087987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a74ae9577fac78b540e87845a801c4?s=128&d=identicon&r=PG&f=1", "display_name": "ronak", "link": "https://stackoverflow.com/users/5087987/ronak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519715881, "creation_date": 1519715231, "last_edit_date": 1519715881, "question_id": 49003003, "link": "https://stackoverflow.com/questions/49003003/setting-custom-headers-in-the-response-of-rails-application-is-good-practice-or", "title": "Setting Custom headers in the Response of Rails Application is good practice or not", "body": "<p>I want to send the country-specific data in some API request from the client side. This data will remain same throughout the user session. Is it good practice to set the custom headers in response as follows:</p>\n\n<pre><code>response.header['Custom-Header-Name'] = 'Custom-Header-Value'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "upload", "paperclip"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6171809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/404512d185b7113e01f2121207129466?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/6171809/rakesh"}, "edited": false, "score": 1, "creation_date": 1519715670, "post_id": 49003023, "comment_id": 85010529, "body": "Thanks Yogesh,   Problem statement here is slight different. below mentioned MimeType itself didn&#39;t work when you download .docx file from google drive &amp; it works if .docx file you create from MS word.   &quot;application/vnd.openxmlformats-officedocument.wordprocessin&zwnj;&#8203;gml.document&quot;"}, {"owner": {"reputation": 2292, "user_id": 5448888, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/898095120243525/picture?type=large", "display_name": "Chakreshwar Sharma", "link": "https://stackoverflow.com/users/5448888/chakreshwar-sharma"}, "reply_to_user": {"reputation": 11, "user_id": 6171809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/404512d185b7113e01f2121207129466?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/6171809/rakesh"}, "edited": false, "score": 0, "creation_date": 1537160971, "post_id": 49003023, "comment_id": 91666382, "body": "@Rakesh: have u got the solution for this? I am also facing the same problem"}], "tags": [], "owner": {"reputation": 164, "user_id": 3547800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5681ac4c589f11207407950f5fcc8075?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Waghmare", "link": "https://stackoverflow.com/users/3547800/yogesh-waghmare"}, "is_accepted": false, "score": 0, "last_activity_date": 1519715302, "creation_date": 1519715302, "answer_id": 49003023, "question_id": 49001751, "link": "https://stackoverflow.com/questions/49001751/unable-to-upload-docx-format-file-downloaded-via-google-drive/49003023#49003023", "title": "Unable to upload .docx format file downloaded via google drive", "body": "<p>If you want to attach an image AND a document you need to create another paperclip attribute for the document. On your model:</p>\n\n<pre><code>has_attached_file :document\nvalidates_attachment :document, :content_type =&gt; { :content_type =&gt; %w(application/pdf application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document) }\n</code></pre>\n\n<p>If you want to attach an image OR a document you can do the following:</p>\n\n<pre><code>validates_attachment :document, :content_type =&gt; {:content_type =&gt; %w(image/jpeg image/jpg image/png application/pdf application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document)}\n</code></pre>\n\n<p>If you choose the first option you will need two file inputs on your view, with the second only one. It's not right or wrong on this. It depends what you want to do.</p>\n\n<p>if you want to upload doc format with google drive please follow this link:\n<a href=\"https://github.com/evinsou/paperclip-googledrive\" rel=\"nofollow noreferrer\">https://github.com/evinsou/paperclip-googledrive</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6171809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/404512d185b7113e01f2121207129466?s=128&d=identicon&r=PG&f=1", "display_name": "Rakesh", "link": "https://stackoverflow.com/users/6171809/rakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519715302, "creation_date": 1519709574, "question_id": 49001751, "link": "https://stackoverflow.com/questions/49001751/unable-to-upload-docx-format-file-downloaded-via-google-drive", "title": "Unable to upload .docx format file downloaded via google drive", "body": "<p>Unable to upload .docx format file (downloaded via google drive) but it's working when .docx file generated via \"Microsoft Word\".</p>\n\n<p>using MimeType for .docx is \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"</p>\n\n<p>*note : Using paperclip gem(version: 5.1.0).</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "actioncable"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 8456726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d92d276990ac8a54a5d0149d8fd88a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny C", "link": "https://stackoverflow.com/users/8456726/johnny-c"}, "edited": false, "score": 0, "creation_date": 1520093207, "post_id": 49038414, "comment_id": 85177720, "body": "Thank you for pointing me in the right direction. I will post the solution, just for future references."}], "tags": [], "owner": {"reputation": 3411, "user_id": 294022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsrDd.jpg?s=128&g=1", "display_name": "GorillaApe", "link": "https://stackoverflow.com/users/294022/gorillaape"}, "is_accepted": false, "score": 1, "last_activity_date": 1519851461, "creation_date": 1519851461, "answer_id": 49038414, "question_id": 49001669, "link": "https://stackoverflow.com/questions/49001669/receiving-an-unauthorized-connection-attempt-was-rejected-w-actioncable-checking/49038414#49038414", "title": "Receiving An unauthorized connection attempt was rejected w/ActionCable checking for Null Users", "body": "<p>I am not sure that I understood your question. However connection is initiated here:</p>\n\n<pre><code>(function() {\n  this.App || (this.App = {});\n\n  App.cable = ActionCable.createConsumer();\n\n}).call(this);\n</code></pre>\n\n<p>So if you don't want to connect you could add the check here.</p>\n"}, {"comments": [{"owner": {"reputation": 351, "user_id": 2009652, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ab04284dee660708ce5c727fdf1f6958?s=128&d=identicon&r=PG", "display_name": "calyxofheld", "link": "https://stackoverflow.com/users/2009652/calyxofheld"}, "edited": false, "score": 0, "creation_date": 1545782621, "post_id": 49086242, "comment_id": 94694315, "body": "just wondering: i see that part of this solution is in your chatroom.js file. did you remove the relevant code from that file and put it inside cable.js? and what is inside the <code>...</code>?"}], "tags": [], "owner": {"reputation": 121, "user_id": 8456726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d92d276990ac8a54a5d0149d8fd88a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny C", "link": "https://stackoverflow.com/users/8456726/johnny-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1522172026, "last_edit_date": 1522172026, "creation_date": 1520093348, "answer_id": 49086242, "question_id": 49001669, "link": "https://stackoverflow.com/questions/49001669/receiving-an-unauthorized-connection-attempt-was-rejected-w-actioncable-checking/49086242#49086242", "title": "Receiving An unauthorized connection attempt was rejected w/ActionCable checking for Null Users", "body": "<p>To solve the problem of constant pinging by ActionCable, you must add a meta data checker inside of cable.js like below</p>\n\n<pre><code>    $(document).on(\"turbolinks:load\", function () {\n    if ($(\"meta[name='current-user']\").length &gt; 0) {\n        App.chatrooms = App.cable.subscriptions.create(\"ChatroomsChannel\", {\n            ...\n        });\n    } else if(App.chatrooms) {\n       App.chatrooms.unsubscribe();\n       delete App.chatrooms; \n    }\n});  \n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 8456726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d92d276990ac8a54a5d0149d8fd88a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny C", "link": "https://stackoverflow.com/users/8456726/johnny-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1522172026, "creation_date": 1519709074, "last_edit_date": 1519709445, "question_id": 49001669, "link": "https://stackoverflow.com/questions/49001669/receiving-an-unauthorized-connection-attempt-was-rejected-w-actioncable-checking", "title": "Receiving An unauthorized connection attempt was rejected w/ActionCable checking for Null Users", "body": "<p>I'm trying to stop ActionCable from continuously checking for users that are not logged into the server. I deleted all users in my test environment to check if this issue would persist, but it shows no sign of ending, even after I added a conditional statement to the JS file to check for the current_user's id. How can I finally bring an end to ActionCable attempting to connect users that don't exist or aren't logged in? Btw, I'm using JQuery3 and Rails 5.</p>\n\n<p>Console Log</p>\n\n<pre><code>Started GET \"/cable\" for 127.0.0.1 at 2018-02-27 00:11:41 -0500\n   (1.0ms)  SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\nStarted GET \"/cable/\" [WebSocket] for 127.0.0.1 at 2018-02-27 00:11:42 -0500\nSuccessfully upgraded to WebSocket (REQUEST_METHOD: GET, HTTP_CONNECTION: Upgrade, HTTP_UPGRADE: websocket)\n  User Load (2.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" IS NULL LIMIT $1  [[\"LIMIT\", 1]]\nAn unauthorized connection attempt was rejected\nFailed to upgrade to WebSocket (REQUEST_METHOD: GET, HTTP_CONNECTION: Upgrade, HTTP_UPGRADE: websocket)\nFinished \"/cable/\" [WebSocket] for 127.0.0.1 at 2018-02-27 00:11:42 -0500\nFinished \"/cable/\" [WebSocket] for 127.0.0.1 at 2018-02-27 00:11:42 -0500\nStarted GET \"/cable\" for 127.0.0.1 at 2018-02-27 00:12:09 -0500\n</code></pre>\n\n<p>connection.rb</p>\n\n<pre><code>module ApplicationCable\n  class Connection &lt; ActionCable::Connection::Base\n    identified_by :current_user\n\n    def connect\n      self.current_user = find_verified_user\n      logger.add_tags 'ActionCable', current_user.username\n    end\n\n    protected\n    def find_verified_user\n      verified_user = User.find_by(id: cookies.signed['user.id'])\n      if verified_user &amp;&amp; cookies.signed['user.expires_at'] &gt; Time.now\n        verified_user\n      else\n        reject_unauthorized_connection\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>cable.js</p>\n\n<pre><code>// Action Cable provides the framework to deal with WebSockets in Rails.\n// You can generate new channels where WebSocket features live using the `rails generate channel` command.\n//\n//= require action_cable\n//= require_self\n//= require_tree ./channels\n\n(function() {\n  this.App || (this.App = {});\n\n  App.cable = ActionCable.createConsumer();\n\n}).call(this);\n</code></pre>\n\n<p>chatroom.js</p>\n\n<pre><code>$(document).on('turbolinks:load', function () {\n    if ($(\"meta[name='current-user']\").length &gt; 0) {\n        (function () {\n            App.chatrooms = App.cable.subscriptions.create(\"ChatroomsChannel\", {\n                connected: function () {\n                },\n                disconnected: function () {\n                },\n                received: function (data) {\n                    var active_chatroom;\n                    active_chatroom = $(\"[data-behavior='messages'][data-chatroom-id='\" + data.chatroom_id + \"']\");\n                    if (active_chatroom.length &gt; 0) {\n                        if (document.hidden) {\n                            if ($(\".strike\").length === 0) {\n                                active_chatroom.append(\"&lt;div class='strike'&gt;&lt;span&gt;Unread Messages&lt;/span&gt;&lt;/div&gt;\");\n                            }\n                            if (Notification.permission === \"granted\") {\n                                new Notification(data.username, {\n                                    body: data.body\n                                });\n                            }\n                        } else {\n                            App.last_read.update(data.chatroom_id);\n                        }\n                        return active_chatroom.append(\"&lt;div class='media message'&gt; &lt;div class='media-body'&gt; &lt;h5 class='mt-0 message-username-pos'&gt;\" + data.username + \"&lt;/h5&gt; &lt;p&gt;\" + data.body + \"&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;\");\n                    } else {\n                        return $(\"[data-behavior='chatroom-link'][data-chatroom-id='\" + data.chatroom_id + \"']\").css(\"font-weight\", \"bold\");\n                    }\n                },\n                send_message: function (chatroom_id, message) {\n                    return this.perform(\"send_message\", {\n                        chatroom_id: chatroom_id,\n                        body: message\n                    });\n                }\n            });\n\n        }).call(this);\n    }\n});\n</code></pre>\n\n<p>last_read.js</p>\n\n<pre><code>$(document).on('turbolinks:load', function () {\n    if ($(\"meta[name='current-user']\").length &gt; 0) {\n        (function () {\n            App.last_read = App.cable.subscriptions.create(\"LastReadChannel\", {\n                connected: function () {\n                },\n                disconnected: function () {\n                },\n                received: function (data) {\n                },\n                update: function (chatroom_id) {\n                    return this.perform(\"update\", {\n                        chatroom_id: chatroom_id\n                    });\n                }\n            });\n\n        }).call(this);\n    }\n});\n</code></pre>\n\n<p>application.html.erb</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n\n  &lt;title&gt;Test App&lt;/title&gt;\n  &lt;%= csrf_meta_tags %&gt;\n\n  &lt;%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt;\n  &lt;%= javascript_include_tag 'https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js' %&gt;\n  &lt;%= javascript_include_tag 'https://js.stripe.com/v3/' %&gt;\n  &lt;%= favicon_link_tag 'favicon.ico' %&gt;\n  &lt;% if user_signed_in? %&gt;\n      &lt;%= tag :meta, name: 'current-user', data: {id: current_user.id} %&gt;\n  &lt;% end %&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>warden_hooks.rb</p>\n\n<pre><code>Warden::Manager.after_set_user do |user,auth,opts|\n  scope = opts[:scope]\n  auth.cookies.signed[\"#{scope}.id\"] = user.id\n  auth.cookies.signed[\"#{scope}.expires_at\"] = 30.minutes.from_now\nend\n\nWarden::Manager.before_logout do |user, auth, opts|\n  scope = opts[:scope]\n  auth.cookies.signed[\"#{scope}.id\"] = nil\n  auth.cookies.signed[\"#{scope}.expires_at\"] = nil\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "debugging"], "comments": [{"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "edited": false, "score": 0, "creation_date": 1519706317, "post_id": 49001195, "comment_id": 85007416, "body": "i think you are facing issue with git conflicts, check this link <a href=\"https://help.github.com/articles/resolving-a-merge-conflict-using-the-command-line/\" rel=\"nofollow noreferrer\">help.github.com/articles/&hellip;</a>"}, {"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "reply_to_user": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "edited": false, "score": 0, "creation_date": 1519708134, "post_id": 49001195, "comment_id": 85007908, "body": "When I run git status, it returns my branch is up-to-date with origin/master.... nothing to commit, working directory is clean. All other branches have been deleted after i merged."}, {"owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "edited": false, "score": 0, "creation_date": 1519708577, "post_id": 49001195, "comment_id": 85008035, "body": "Just move back to previous commit . To get the list of all commit run <code>git logs</code> and to move back to particular commit just run <code>git checkout &lt;commit id&gt;</code>. check this link <a href=\"https://stackoverflow.com/questions/4114095/how-to-revert-git-repository-to-a-previous-commit\" title=\"how to revert git repository to a previous commit\">stackoverflow.com/questions/4114095/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1519710879, "post_id": 49001427, "comment_id": 85008728, "body": "I believe I have handled all merge issues, and deleted all instances and ran git commit... App still wont work..."}, {"owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1519712165, "post_id": 49001427, "comment_id": 85009186, "body": "Same errors as listed above. When I resolve all the merge issues, add, commit and push, it still doesn&#39;t change. I must have missed something and now I can&#39;t find it."}, {"owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "reply_to_user": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "edited": false, "score": 0, "creation_date": 1519712348, "post_id": 49001427, "comment_id": 85009255, "body": "You do have a missing end bracket on your <code>body{</code> declaration in the navigation.scss file."}], "tags": [], "owner": {"reputation": 1930, "user_id": 6015889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2359a5839ab1afea717f15dc0536449e?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony L ", "link": "https://stackoverflow.com/users/6015889/anthony-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1519707531, "creation_date": 1519707531, "answer_id": 49001427, "question_id": 49001195, "link": "https://stackoverflow.com/questions/49001195/ruby-on-rails-broke-application-and-idk/49001427#49001427", "title": "Ruby On Rails. Broke Application and IDK?", "body": "<p>You're definitely seeing git conflicts.  Whenever you see something like this:</p>\n\n<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n//some code\n=======\n//new code\n&gt;&gt;&gt;&gt;&gt;&gt;&gt; new-branch-name\n</code></pre>\n\n<p>Git is telling there is a conflict between the HEAD and your working branch.  This happens when git is unable to automatically merge the two branches and needs you to decide which version is preferred.</p>\n\n<p>After all is completed, every instance of <code>&gt;&gt;&gt;&gt;&gt;&gt;</code>, <code>======</code>, and <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> should be removed, and you can run</p>\n\n<pre><code>git commit\n</code></pre>\n\n<p>to complete the merge.  </p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "is_accepted": false, "score": 0, "last_activity_date": 1519712756, "creation_date": 1519712756, "answer_id": 49002416, "question_id": 49001195, "link": "https://stackoverflow.com/questions/49001195/ruby-on-rails-broke-application-and-idk/49002416#49002416", "title": "Ruby On Rails. Broke Application and IDK?", "body": "<p>Ended up checking out an older commit, took two steps back on this. Thanks for the help guys.</p>\n"}, {"tags": [], "owner": {"reputation": 1814, "user_id": 2119317, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/65e386ab94962682b0abd72463670e23?s=128&d=identicon&r=PG", "display_name": "Pardeep Saini", "link": "https://stackoverflow.com/users/2119317/pardeep-saini"}, "is_accepted": true, "score": 0, "last_activity_date": 1519739120, "creation_date": 1519739120, "answer_id": 49010186, "question_id": 49001195, "link": "https://stackoverflow.com/questions/49001195/ruby-on-rails-broke-application-and-idk/49010186#49010186", "title": "Ruby On Rails. Broke Application and IDK?", "body": "<p>Just move back to previous commit . To get the list of all commit run <code>git logs</code> and to move back to particular commit just run <code>git checkout &lt;commit-id&gt;</code>. To checkout previous link <a href=\"https://stackoverflow.com/questions/4114095/how-to-revert-git-repository-to-a-previous-commit\">check this link</a></p>\n"}], "owner": {"reputation": 167, "user_id": 8469240, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10155793383973694/picture?type=large", "display_name": "Mason SB", "link": "https://stackoverflow.com/users/8469240/mason-sb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49010186, "answer_count": 3, "score": 0, "last_activity_date": 1519739120, "creation_date": 1519705938, "last_edit_date": 1519711321, "question_id": 49001195, "link": "https://stackoverflow.com/questions/49001195/ruby-on-rails-broke-application-and-idk", "title": "Ruby On Rails. Broke Application and IDK?", "body": "<p>I am working on a ROR \"intermediate\" project I found on medium/freecodecamp.</p>\n\n<p>I have gone through each page and line number in the logs and I'm still getting an error. One thing that I've never seen was modifying the app/helpers/* files. When I did this it added >>>>>>head &amp; \">>>>>Helper\" in a lot of files. <br/>\nI'm not sure what is going on so I'm trying to be as detailed as possible about what could possibly be be the culprit<br>\nHere is the GitHub link in case that helps...<a href=\"https://github.com/Mbartlett413/myblog\" rel=\"nofollow noreferrer\">https://github.com/Mbartlett413/myblog</a></p>\n\n<p>Right now when I look on my local host I see,\n \"We're sorry, but something went wrong.\nIf you are the application owner check the logs for more information.\"</p>\n\n<p>When I look in my terminal I see this, <code>Cannot render console from XX.XX.XX ...&lt;br/&gt;\nRendered pages/index.html.erb within layouts/application (6.3ms)\nCompleted 401 Unauthorized in 1597ms (ActiveRecord: 0.0ms)...&lt;br/&gt;</code></p>\n\n<pre><code>ActionView::Template::Error (Invalid CSS after \"  }\": expected \"}\", was \"\"): &lt;br/&gt;\n4:     &lt;title&gt;Blog&lt;/title&gt; &lt;br/&gt;\n5:     &lt;%= csrf_meta_tags %&gt; &lt;br/&gt;\n6:  &lt;br/&gt;\n7:     &lt;%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %&gt; &lt;br/&gt;\n8:     &lt;%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %&gt; &lt;br/&gt;\n9:   &lt;/head&gt; &lt;br/&gt;\n10: \n\napp/assets/stylesheets/partials/layout/navigation.scss:75 &lt;br/&gt;\napp/assets/stylesheets/partials/layout:1 &lt;br/&gt;\napp/assets/stylesheets/application.scss:23 &lt;br/&gt;\napp/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb___1682161864386442755_69890208520440'\n</code></pre>\n"}, {"tags": ["ruby", "xpath", "nokogiri"], "comments": [{"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1519706289, "post_id": 49000911, "comment_id": 85007408, "body": "The xml you are showing is technically not valid, but I&#39;m assuming you have some tags wrapping the whole thing, like <code>&lt;xml&gt;...your content...&lt;&#47;xml&gt;</code>."}, {"owner": {"reputation": 3, "user_id": 9416589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e3c2cbec27359ff44dc86862621f4b9?s=128&d=identicon&r=PG&f=1", "display_name": "A Ray", "link": "https://stackoverflow.com/users/9416589/a-ray"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1519757937, "post_id": 49000911, "comment_id": 85036914, "body": "it&#39;s surrounded by &lt;html&gt;&lt;body&gt;...&lt;/html&gt;&lt;/body&gt; and prefixed by: &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot; &quot;<a href=\"http://www.w3.org/TR/REC-html40/loose.dtd\" rel=\"nofollow noreferrer\">w3.org/TR/REC-html40/loose.dtd</a>&quot;&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9416589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e3c2cbec27359ff44dc86862621f4b9?s=128&d=identicon&r=PG&f=1", "display_name": "A Ray", "link": "https://stackoverflow.com/users/9416589/a-ray"}, "edited": false, "score": 0, "creation_date": 1519758180, "post_id": 49000943, "comment_id": 85037051, "body": "Interesting. Your example worked. However, it doesn&#39;t work for me, when I pull the contents through Nokogiri::HTML(open(&quot;some_url&quot;)), and surrounded by html tags. i get the keys, but the values are blank."}, {"owner": {"reputation": 3, "user_id": 9416589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e3c2cbec27359ff44dc86862621f4b9?s=128&d=identicon&r=PG&f=1", "display_name": "A Ray", "link": "https://stackoverflow.com/users/9416589/a-ray"}, "edited": false, "score": 0, "creation_date": 1519762649, "post_id": 49000943, "comment_id": 85039452, "body": "Hi, I got it working. Changed to Nokogiri::XML, which did the trick. Thanks for the help!"}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "reply_to_user": {"reputation": 3, "user_id": 9416589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e3c2cbec27359ff44dc86862621f4b9?s=128&d=identicon&r=PG&f=1", "display_name": "A Ray", "link": "https://stackoverflow.com/users/9416589/a-ray"}, "edited": false, "score": 0, "creation_date": 1519765584, "post_id": 49000943, "comment_id": 85041001, "body": "@ARay That&#39;s great. If this was helpful to you, please accept the answer as correct by clicking the grey checkmark next to my answer."}], "tags": [], "owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "is_accepted": true, "score": 0, "last_activity_date": 1519706359, "last_edit_date": 1519706359, "creation_date": 1519704374, "answer_id": 49000943, "question_id": 49000911, "link": "https://stackoverflow.com/questions/49000911/unable-to-get-nokogiri-xmlelement-text-value/49000943#49000943", "title": "Unable to get nokogiri xmlelement text value", "body": "<p>You need to get rid of <code>xpath('text()')</code>. And you can get rid of the conditional and build a workable data structure as you go, like this:</p>\n\n<pre><code>def meta_contents(doc)\n  doc.xpath(\"//info\").map do |info_entry|\n    info_entry.xpath(\"meta\").map do |meta_entry|\n      [meta_entry[\"name\"], meta_entry.text]\n    end.to_h\n  end\nend\n\n&gt;&gt; meta_contents(doc)\n#&gt; [{\"alias\"=&gt;\"alias1\", \"score\"=&gt;\".60\"}, {\"alias\"=&gt;\"alias2\", \"score\"=&gt;\".50\"}]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9416589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e3c2cbec27359ff44dc86862621f4b9?s=128&d=identicon&r=PG&f=1", "display_name": "A Ray", "link": "https://stackoverflow.com/users/9416589/a-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 49000943, "answer_count": 1, "score": 0, "last_activity_date": 1519706359, "creation_date": 1519704141, "question_id": 49000911, "link": "https://stackoverflow.com/questions/49000911/unable-to-get-nokogiri-xmlelement-text-value", "title": "Unable to get nokogiri xmlelement text value", "body": "<p>I have the following XML content.</p>\n\n<pre><code>&lt;info&gt;\n    &lt;meta name=\"alias\"&gt;alias1&lt;/meta&gt;\n    &lt;meta name=\"score\"&gt;.60&lt;/meta&gt;\n&lt;/info&gt;\n&lt;info&gt;\n    &lt;meta name=\"alias\"&gt;alias2&lt;/meta&gt;\n    &lt;meta name=\"score\"&gt;.50&lt;/meta&gt;\n&lt;/info&gt;\n</code></pre>\n\n<p>I need to get back for each value, but having difficulty doing so.</p>\n\n<pre><code>doc.xpath(\"//info\").each do |info_entry|\n  info_entry.xpath(\"meta\").each do |meta_entry|\n      if meta_entry['name'] == 'alias'\n          the_alias = meta_entry.xpath('text()').text\n      elsif meta_entry['name'] == 'score'\n          score = meta_entry.xpath('text()').text\n      end\n      // add struct containing alias and score to list\n  end\nend\n</code></pre>\n\n<p>However, I'm not geting anything from text. I've tried many different things: inner_text, inner_html, content, value, nothing works. I've tried meta_entry.at, meta_entry.search, and so on.</p>\n\n<p>Is there something I'm missing? Any advice would be appreciated.</p>\n"}, {"tags": ["ruby", "linux", "pdf", "pdfkit", "wicked-pdf"], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 1659538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a21ebbb44f75e7006dea9750471513b9?s=128&d=identicon&r=PG", "display_name": "shooma", "link": "https://stackoverflow.com/users/1659538/shooma"}, "is_accepted": false, "score": 0, "last_activity_date": 1519765934, "creation_date": 1519765934, "answer_id": 49018017, "question_id": 49000258, "link": "https://stackoverflow.com/questions/49000258/generating-a-pdf-in-ruby-app-on-a-linux-server-qt-qpa-screen-qxcbconnection/49018017#49018017", "title": "Generating a pdf in Ruby app on *a Linux server*: qt.qpa.screen: QXcbConnection: Could not connect to display", "body": "<p>You should install X screen drivers on remote server.</p>\n\n<p>I had similar problems with X display when tried to render pdf using <code>wkhtml2pdf</code> lib on Ubuntu server (in docker container, actually).</p>\n\n<p>In my case problem was solved by installation of several libs:</p>\n\n<pre><code>apt-get update -qq &amp;&amp; apt-get install -y \\\nxfonts-base \\\nxfonts-75dpi \\\nxserver-common    \n</code></pre>\n\n<p>General is <code>xserver-common</code>. Maybe it will help.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 497, "user_id": 9383887, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/bd4404f5ac586a9c03e32eb62e55891a?s=128&d=identicon&r=PG&f=1", "display_name": "jerry", "link": "https://stackoverflow.com/users/9383887/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519765934, "creation_date": 1519699066, "question_id": 49000258, "link": "https://stackoverflow.com/questions/49000258/generating-a-pdf-in-ruby-app-on-a-linux-server-qt-qpa-screen-qxcbconnection", "title": "Generating a pdf in Ruby app on *a Linux server*: qt.qpa.screen: QXcbConnection: Could not connect to display", "body": "<p>When trying to generate a pdf * on a server* in Ruby/Rack app using gem \"pdfkit\", \"~> 0.8.2\" gem:</p>\n\n<pre><code>kit = PDFKit.new(\"some string here\", \n                  page_size: paper_size, \n                  # ..............\n                  zoom: 1)\n\nfl = kit.to_file(\"/tmp/test123.pdf\")\n</code></pre>\n\n<p>I have this error:</p>\n\n<pre><code>  qt.qpa.screen: QXcbConnection: Could not connect to display                                                                                                   \n  Could not connect to any X display.\n</code></pre>\n\n<p>How to fix it? I've tried </p>\n\n<pre><code>xhost +\nxhost:  unable to open display \"\"\n</code></pre>\n\n<p>Of course, there's no physical display on a server.</p>\n"}, {"tags": ["ruby", "multithreading"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1519700711, "post_id": 48999238, "comment_id": 85006065, "body": "You generally call semaphore.synchronize inside the thread, but this context is a little more complicated because in many rails apps, the server handles each controller action in a new thread. Database connection pools are used to ensure that concurrent db requests work. So I would back up a bit and ask what it is you want this controller action to accomplish. Do you want it to create all customers before redirecting, or redirect before they&#39;re created?"}], "owner": {"reputation": 1007, "user_id": 7952244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed5c4abef2ae0d72b24714dc00a1d70?s=128&d=identicon&r=PG&f=1", "display_name": "O.MeeKoh", "link": "https://stackoverflow.com/users/7952244/o-meekoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1540127223, "creation_date": 1519690984, "last_edit_date": 1519696776, "question_id": 48999238, "link": "https://stackoverflow.com/questions/48999238/is-ruby-code-without-thread-join-considered-not-thread-safe", "title": "Is Ruby code without thread.join considered NOT thread safe", "body": "<p>Working with multi threading in ruby and I wanted to make sure my code is \"thread safe\". I want to spawn a new thread to allow for CSV file upload. </p>\n\n<p>My current controller code is:</p>\n\n<pre><code>def upload\n   semaphore = Mutex.new \n   semaphore.synchronize{\n   threadCSV = Thread.new do\n   CSV.foreach(params[:leads].path, headers: true) do |lead|\n    Customer.create(email: lead[0], first_name: lead[1], last_name: lead[2])\n    end\n  end\n  }\n  redirect_to customers_path\n  end\nend\n</code></pre>\n\n<p>Is it necessary for me to use <code>.join</code> to wait for the thread to finish to consider this to be thread safe, or does Mutex take care of that? </p>\n\n<p>It looks like adding <code>thread.join</code> at the end will allow me to interact with elements in the browser but not navigate it (which makes sense since <code>thread.join</code> will wait for the thread to finish processing to avoid terminating any work that is being performed).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cucumber", "capybara"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1519686321, "post_id": 48998337, "comment_id": 85002498, "body": "What type of element is it actually? a <code>&lt;button&gt;</code> , <code>&lt;input&gt;</code> , <code>&lt;a&gt;</code>, other?"}, {"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1519686419, "post_id": 48998337, "comment_id": 85002537, "body": "It\u2019s an input element"}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "edited": false, "score": 0, "creation_date": 1519739592, "post_id": 48998590, "comment_id": 85025032, "body": "Very helpful. Thank you! Silly mistake on my part :)."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 2, "last_activity_date": 1519687968, "last_edit_date": 1519687968, "creation_date": 1519686650, "answer_id": 48998590, "question_id": 48998337, "link": "https://stackoverflow.com/questions/48998337/ruby-cucumber-capybara-selecting-using-regex/48998590#48998590", "title": "Ruby, Cucumber, &amp; Capybara: selecting using regex", "body": "<p>The problem you're having is that you have specified a <code>css</code> selector type but not actually specified a CSS selector.  Since it's an <code>&lt;input&gt;</code> element you could do</p>\n\n<pre><code>find(:css, 'input', text: /^#{button}/).click\n</code></pre>\n\n<p>However, since it's an input being used as a button I'm assuming it's of type submit, reset, image, or button. This means you can use the :button selector type (rather than :css) to make your clearer as to what you're actually doing. When finding a button Capybaras default behavior is to match on substrings so you should just be able to do</p>\n\n<pre><code>click_button(button)\n</code></pre>\n\n<p>which is the same as either of</p>\n\n<pre><code>find(:button, button).click\nfind_button(button).click\n</code></pre>\n\n<p>If that doesn't work for you please add the relevant HTML to your question.</p>\n\n<p>As an aside, you should stay away from <code>first</code> whenever possible - it has a number of downsides.</p>\n"}], "owner": {"reputation": 1166, "user_id": 2217750, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cKXxI.jpg?s=128&g=1", "display_name": "Darkisa", "link": "https://stackoverflow.com/users/2217750/darkisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 48998590, "answer_count": 1, "score": 0, "last_activity_date": 1519687968, "creation_date": 1519685168, "question_id": 48998337, "link": "https://stackoverflow.com/questions/48998337/ruby-cucumber-capybara-selecting-using-regex", "title": "Ruby, Cucumber, &amp; Capybara: selecting using regex", "body": "<p>I am trying to select an input node using Capybara:</p>\n\n<pre><code>When /^the shopper clicks the \"(.+)\" button$/ do |button|\n    first(:css, text: /^#{button}/).click\nend\n</code></pre>\n\n<p>The scenario that triggers the above step is: </p>\n\n<pre><code>And the shopper clicks the \"PAY\" button\n</code></pre>\n\n<p>The button in the view will always start with the text 'PAY' but it is followed by a space and then the total price of the products e.g. '<code>PAY $150</code>'</p>\n\n<p>The dollar amount will change but the PAY part won't. If I try the above code I get the following error:</p>\n\n<pre><code>And the shopper clicks the \"PAY\" button                   # features/step_definitions/shared_steps.rb:33\n      unexpected '$' after '' (Nokogiri::CSS::SyntaxError)\n</code></pre>\n\n<p>How can I properly grab the PAY button using Capybara and Regex?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7686710, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pKUPv.jpg?s=128&g=1", "display_name": "Lashe", "link": "https://stackoverflow.com/users/7686710/lashe"}, "edited": false, "score": 0, "creation_date": 1525198713, "post_id": 48998368, "comment_id": 87261078, "body": "Hey it worked after after adding the impressions count to the model."}], "tags": [], "owner": {"reputation": 580, "user_id": 5041876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942018cf0f020de80bef0fbdf4a882f8?s=128&d=identicon&r=PG&f=1", "display_name": "NiftyAsp", "link": "https://stackoverflow.com/users/5041876/niftyasp"}, "is_accepted": true, "score": 1, "last_activity_date": 1519685375, "creation_date": 1519685375, "answer_id": 48998368, "question_id": 48998118, "link": "https://stackoverflow.com/questions/48998118/how-do-i-order-posts-by-view-counts-using-impressionist-gem/48998368#48998368", "title": "How do i order posts by view counts using impressionist gem?", "body": "<p><a href=\"https://github.com/charlotte-ruby/impressionist#adding-column-to-model\" rel=\"nofollow noreferrer\">https://github.com/charlotte-ruby/impressionist#adding-column-to-model</a></p>\n\n<p>Add a column to your posts table to hold the impressions count, and then you can use <code>order</code> to sort the posts by view count. <code>Post.order(impressions_count: :desc)</code></p>\n"}], "owner": {"reputation": 31, "user_id": 7686710, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pKUPv.jpg?s=128&g=1", "display_name": "Lashe", "link": "https://stackoverflow.com/users/7686710/lashe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 48998368, "answer_count": 1, "score": 0, "last_activity_date": 1519685375, "creation_date": 1519684036, "last_edit_date": 1519684498, "question_id": 48998118, "link": "https://stackoverflow.com/questions/48998118/how-do-i-order-posts-by-view-counts-using-impressionist-gem", "title": "How do i order posts by view counts using impressionist gem?", "body": "<p>Can someone please help me out with this... What i want is a sort of popular post widget which is going to be ordered by highest views. I'm using impressionist gem and i was able to add pageviews to show page. BTW, i don't understand it from the docs.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "concurrent-ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519683790, "post_id": 48998008, "comment_id": 85001610, "body": "It&#39;s not thread safe unless you use a Mutex or atomic operations."}, {"owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519684333, "post_id": 48998008, "comment_id": 85001798, "body": "@tadman, thanks, Im trying to understand in what scenario it will cause a race condition, this is how its called MyClass.new.method, can you explain a bit more? because there is one object created, and the counter is inside the method, so how can more than one thread be processing the same method when the switcher happens. appreciated"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519685540, "post_id": 48998008, "comment_id": 85002231, "body": "It&#39;s not clear if <code>caller</code> is a variable or a property on that object, so you&#39;ll need to clarify. Keep in mind <a href=\"https://ruby-doc.org/core-2.5.0/Object.html#method-i-method\" rel=\"nofollow noreferrer\"><code>method</code></a> is already reserved as a method name, it gives you information on the method in question, so be careful."}], "answers": [{"tags": [], "owner": {"reputation": 10274, "user_id": 930207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oy7Q3.png?s=128&g=1", "display_name": "mcfinnigan", "link": "https://stackoverflow.com/users/930207/mcfinnigan"}, "is_accepted": true, "score": 2, "last_activity_date": 1519684835, "creation_date": 1519684835, "answer_id": 48998269, "question_id": 48998008, "link": "https://stackoverflow.com/questions/48998008/thread-safe-counter-inside-a-method/48998269#48998269", "title": "Thread safe counter inside a method", "body": "<p>Assuming the variable <code>counter</code> is scoped to that method only, and that there is no funny shenanigans going on with Singleton or any other weird stuff, then yes, that method should be thread safe in its current form.</p>\n\n<p>If, however, counter is an instance variable and you are using an accessor to set it, then that method is not thread safe. You may never encounter the race condition if you're using every MyClass once only, but all it takes is one well-meaning refactoring to reuse MyClass and suddenly you've got a race condition there.</p>\n\n<p>Basically - if your method is self-contained, uses variables scoped to it only, and references no external shared data then it is thread safe by default.  </p>\n\n<p>As soon as you use something that could be accessed at the same time by another thread, you have a potential race condition in the making and you should start thinking about synchronising access to the shared resources.</p>\n"}], "owner": {"reputation": 3133, "user_id": 1883793, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/33ed6dd2dcb89dab186d5b9dfe8ae9b2?s=128&d=identicon&r=PG", "display_name": "user1883793", "link": "https://stackoverflow.com/users/1883793/user1883793"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 48998269, "answer_count": 1, "score": 0, "last_activity_date": 1519685617, "creation_date": 1519683430, "last_edit_date": 1519685617, "question_id": 48998008, "link": "https://stackoverflow.com/questions/48998008/thread-safe-counter-inside-a-method", "title": "Thread safe counter inside a method", "body": "<p>I saw some retry code written like this, it tries to call a service 3 times if some exception is raised, Im trying to understand in a non-MRI multi-threaded server, is this counter thread safe? is it necessary to lock the process using Mutex?</p>\n\n<p>This is how its been called </p>\n\n<pre><code>MyClass.new.my_method\n\nclass MyClass\n  def my_method\n    counter = 3\n    begin\n      call_some_service_raise_some_exception\n    rescue SomeException =&gt; e\n      retry if counter.positive?\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "multithreading", "exit", "kill", "terminate"], "answers": [{"tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": false, "score": 2, "last_activity_date": 1519686641, "last_edit_date": 1519686641, "creation_date": 1519686115, "answer_id": 48998500, "question_id": 48997680, "link": "https://stackoverflow.com/questions/48997680/ruby-thread-kill-vs-terminate-vs-exit/48998500#48998500", "title": "ruby Thread, kill vs terminate vs exit", "body": "<p>When methods are grouped like that in the docs (a short list of method names, followed by one description), then they are aliases of each other. They share the same source code.</p>\n"}], "owner": {"reputation": 21, "user_id": 9415649, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "willem dejong", "link": "https://stackoverflow.com/users/9415649/willem-dejong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1519686641, "creation_date": 1519681774, "question_id": 48997680, "link": "https://stackoverflow.com/questions/48997680/ruby-thread-kill-vs-terminate-vs-exit", "title": "ruby Thread, kill vs terminate vs exit", "body": "<p>Ruby newby here and I am currently working with Ruby 2.3.0 and was working with a threaded gem and using Threads myself. I was looking at the ruby documentation and was curious if there was any nuances between the thread instance methods #kill, #exit and #terminate (the documentation groups them to the same description) or if they are just 3 names for the exact same code for convenience? I tried searching for a bit for answers but couldn't find any satisfying answers.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519682439, "post_id": 48996876, "comment_id": 85001077, "body": "<code>Config</code> has been deprecated in favour of <code>RbConfig</code> since ruby 1.9.3, and was removed in 2.2.0. You <i>could</i> update that <code>setup.rb</code> script, but... Why are you even running that in the first place? This looks like a legacy script to support installation on ancient ruby versions! You should just be able to run <code>gem install ruby-xslt</code> like the README says??"}, {"owner": {"reputation": 173, "user_id": 7452627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TXOZW.jpg?s=128&g=1", "display_name": "KARAN SHAH", "link": "https://stackoverflow.com/users/7452627/karan-shah"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519683414, "post_id": 48996876, "comment_id": 85001456, "body": "I want to convert transform xml to xslt so trying to install Ruby XSLT package"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519719029, "post_id": 48996876, "comment_id": 85012252, "body": "Ok. So why can&#39;t you just run the regular <code>gem install</code> command? There is nothing in the README about needing to run the command you&#39;re trying."}, {"owner": {"reputation": 173, "user_id": 7452627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TXOZW.jpg?s=128&g=1", "display_name": "KARAN SHAH", "link": "https://stackoverflow.com/users/7452627/karan-shah"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519740682, "post_id": 48996876, "comment_id": 85025790, "body": "I am behind  the proxy so it will not allow me to. And I am unable to access my proxy information to do something with it"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519741245, "post_id": 48996876, "comment_id": 85026196, "body": "Then can you download the gem, transfer it to this machine, and install it directly? <a href=\"https://rubygems.org/downloads/ruby-xslt-0.9.10.gem\" rel=\"nofollow noreferrer\">rubygems.org/downloads/ruby-xslt-0.9.10.gem</a>"}, {"owner": {"reputation": 173, "user_id": 7452627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TXOZW.jpg?s=128&g=1", "display_name": "KARAN SHAH", "link": "https://stackoverflow.com/users/7452627/karan-shah"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1519742340, "post_id": 48996876, "comment_id": 85026977, "body": "I will surely try that. Thanks. You can answer the question that Config has depreciated. I will mark it correct"}], "answers": [{"tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": true, "score": 1, "last_activity_date": 1519742924, "creation_date": 1519742924, "answer_id": 49011449, "question_id": 48996876, "link": "https://stackoverflow.com/questions/48996876/ruby-unable-to-install-ruby-xslt-plugin/49011449#49011449", "title": "Ruby unable to install Ruby xslt- plugin", "body": "<p><code>Config</code> has been deprecated in favour of <code>RbConfig</code> since ruby version <code>1.9.3</code>, and was removed completely in version <code>2.2.0</code>.</p>\n\n<p>You <em>could</em> update that <code>setup.rb</code> script for compatibility with modern ruby, but I don't think there's any need to even run this in the first place? The installation instructions, outlined in the project README, makes no mention of it. My guess is that this is a legacy script, which was used to install the project many years ago.</p>\n\n<p>You <em>should</em> be able to just run: <code>gem install ruby-xsl</code>. Or if you're somehow not able to run this directly, you can download the gem: <a href=\"https://rubygems.org/downloads/ruby-xslt-0.9.10.gem\" rel=\"nofollow noreferrer\">https://rubygems.org/downloads/ruby-xslt-0.9.10.gem</a>, then run <code>gem install</code> with this file.</p>\n\n<p>In the (unlikely) event that you do need to re-build the gem from source, I'd advise trying <a href=\"https://github.com/glejeune/ruby-xslt#installation\" rel=\"nofollow noreferrer\">the instructions laid out in the project README</a>:</p>\n\n<pre><code>ruby extconf.rb # see CONFIGURATION for more options\nmake\nmake test\nmake doc\nsudo make install\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7452627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TXOZW.jpg?s=128&g=1", "display_name": "KARAN SHAH", "link": "https://stackoverflow.com/users/7452627/karan-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 49011449, "answer_count": 1, "score": 0, "last_activity_date": 1519742924, "creation_date": 1519678282, "last_edit_date": 1519679681, "question_id": 48996876, "link": "https://stackoverflow.com/questions/48996876/ruby-unable-to-install-ruby-xslt-plugin", "title": "Ruby unable to install Ruby xslt- plugin", "body": "<p>I am trying to install ruby xslt plugin <a href=\"https://github.com/glejeune/ruby-xslt\" rel=\"nofollow noreferrer\">ruby-xslt</a> \nhowever when I run the setup I get the following error</p>\n\n<pre><code>C:\\Users\\186\\Downloads\\ruby-xslt-master&gt;ruby setup.rb\nsetup.rb:283: warning: key \"bin-dir\" is duplicated and overwritten on line 284\nTraceback (most recent call last):\n        2: from setup.rb:1578:in `&lt;main&gt;'\n        1: from setup.rb:768:in `invoke'\nsetup.rb:788:in `load_rbconfig': uninitialized constant Config (NameError)\nDid you mean?  RbConfig\n</code></pre>\n"}]