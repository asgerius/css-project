[{"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1530144222, "post_id": 51072890, "comment_id": 89135521, "body": "this requires some javascript."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1530145909, "post_id": 51072890, "comment_id": 89135846, "body": "@JoshBrody please help me with that."}, {"owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "edited": false, "score": 0, "creation_date": 1530156928, "post_id": 51072890, "comment_id": 89137997, "body": "what have you tried so far?"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530169909, "post_id": 51072890, "comment_id": 89142351, "body": "<i>&quot;a further text box opens to explain the reason of decline&quot;</i> - what is the name of other text_box field here? You can keep that field always present in the HTML and show/hide based on the value of <code>status</code> field using some custom javascript."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530170501, "post_id": 51072890, "comment_id": 89142695, "body": "@NAVROOPSINGHSIDHU i removed tags <code>ruby-on-rails-4</code> and <code>ruby-on-rails-5</code> from the question. I don&#39;t think your application depends on both."}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530177660, "post_id": 51072890, "comment_id": 89146886, "body": "have you tried the solution I advised below? the idea is that there is already a text_area field in the html, but it is just hidden initially. then there is a trigger on change of the status that will show/hide the text_area. if it does not work, kindly inform me so we can try other solutions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530195017, "post_id": 51072890, "comment_id": 89158455, "body": "@JagdeepSingh I have added a hidden field decline_reason <b>&lt;%= form.text_area :decline_reason, class: &quot;form-control hidden&quot;, id: &quot;decline-reason-textarea&quot; %&gt;</b>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530195043, "post_id": 51072890, "comment_id": 89158472, "body": "@JeffreyMCastro I just tried it. But it is not working"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530202737, "post_id": 51072890, "comment_id": 89163419, "body": "@JeffreyMCastro Please check the update above. It is not working."}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530234412, "post_id": 51072890, "comment_id": 89174108, "body": "you can try to reach me here <a href=\"https://chat.stackoverflow.com/rooms/173996/open-a-text-box-when-other-is-selected-in-dropdown-list-in-rails\">chat.stackoverflow.com/rooms/173996/&hellip;</a>"}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530235347, "post_id": 51072890, "comment_id": 89174283, "body": "@NAVROOPSINGHSIDHU I am able to make it work now, some typo in the javascript. I will give you the code by updating my answer below."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530282601, "post_id": 51072890, "comment_id": 89195230, "body": "@JeffreyMCastro it still didn&#39;t work for me. I have added the javascript code in application.js and html code in _form.html.erb"}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530494242, "post_id": 51072890, "comment_id": 89241167, "body": "@NAVROOPSINGHSIDHU sorry was out on the weekend, i think it wont work inside application.js because it has the &lt;script&gt; html tag, you should put it in the _form.html.erb file at the bottom for now. and try again. I have made it work by doing that, as shown in my answer (the javascript is coded inside the form file)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530559908, "post_id": 51072890, "comment_id": 89269385, "body": "@JeffreyMCastro Please check the update above. It is still not working for me."}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530601619, "post_id": 51072890, "comment_id": 89280896, "body": "@NAVROOPSINGHSIDHU i updated my answer below, kindly check. thanks :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530627329, "post_id": 51072890, "comment_id": 89296994, "body": "@JeffreyMCastro I have edited your answer and posted it. Thankyou so much for all the help. &quot;Declined&quot; had to be in double quotes"}, {"owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530668554, "post_id": 51072890, "comment_id": 89312732, "body": "@NAVROOPSINGHSIDHU good job! glad you had it working."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "edited": false, "score": 0, "creation_date": 1530722574, "post_id": 51072890, "comment_id": 89338623, "body": "@JeffreyMCastro Thankyou"}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 6186921, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/J5OR2.jpg?s=128&g=1", "display_name": "Jeffrey M Castro", "link": "https://stackoverflow.com/users/6186921/jeffrey-m-castro"}, "is_accepted": false, "score": 2, "last_activity_date": 1530602003, "last_edit_date": 1530602003, "creation_date": 1530157581, "answer_id": 51074417, "question_id": 51072890, "link": "https://stackoverflow.com/questions/51072890/open-a-text-box-when-other-is-selected-in-dropdown-list-in-rails/51074417#51074417", "title": "Open a text box when other is selected in dropdown list in rails", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(function() {\r\n  $(\"#sample-status-select\").on(\"change\", function() {\r\n    var select_val = $(this).val(); // this gets the value of the dropdown menu\r\n    console.log(select_val); // this just displays the selected value in the browser console (if you have the browser console open)\r\n\r\n    if (select_val === 'Declined') {\r\n      // if the 'Declined' option is chosen\r\n      // we remove the 'hidden' class from the textarea\r\n      $(\"#decline-reason-textarea\").removeClass(\"hidden\");\r\n    } else {\r\n      // if any other option is chosen\r\n      // we put back the 'hidden' class to the textarea\r\n      // also, we update the textarea value to BLANK (this part is optional, it depends if you want to keep the value of the textarea)\r\n      $(\"#decline-reason-textarea\").addClass(\"hidden\");\r\n      $(\"#decline-reason-textarea\").val(\"\");\r\n    }\r\n  });\r\n});</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.hidden {\r\n  display: none;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n\r\n\r\n&lt;form action=\"https://httpbin.org/post\" method=\"post\"&gt;\r\n  Status\r\n  &lt;select id=\"sample-status-select\"&gt;\r\n    &lt;option value=\"Pending\"&gt;Pending&lt;/option&gt;\r\n    &lt;option value=\"Approved\"&gt;Approved&lt;/option&gt;\r\n    &lt;option value=\"Declined\"&gt;Declined&lt;/option&gt;\r\n  &lt;/select&gt;\r\n  &lt;br&gt;\r\n  &lt;br&gt; Decline Reason\r\n  &lt;textarea id=\"decline-reason-textarea\" class=\"hidden\"&gt;\r\n  &lt;/textarea&gt;\r\n&lt;/form&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Check this snippet I made. It should work for you as well.<br>\nThis is a basic html form so this works even without ruby on rails.<br>\nAfter you get the gist of this, you should be able to port for it to work with your rails app.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "is_accepted": false, "score": 0, "last_activity_date": 1530627255, "creation_date": 1530627255, "answer_id": 51156831, "question_id": 51072890, "link": "https://stackoverflow.com/questions/51072890/open-a-text-box-when-other-is-selected-in-dropdown-list-in-rails/51156831#51156831", "title": "Open a text box when other is selected in dropdown list in rails", "body": "<pre><code>&lt;script type=\"text/javascript\"&gt;\n  $(function() {\n    $(\"#sample-status-select\").on(\"change\", function() {\n      var select_val = $(this).val();\n      console.log(select_val);\n      if (select_val === \"Declined\") {\n        $(\"#decline-reason-textarea\").removeClass(\"hidden\");\n      } else {\n        $(\"#decline-reason-textarea\").addClass(\"hidden\");\n        $(\"#decline-reason-textarea\").val(\"\");\n      }\n    });\n  });\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530627255, "creation_date": 1530143485, "last_edit_date": 1530559869, "question_id": 51072890, "link": "https://stackoverflow.com/questions/51072890/open-a-text-box-when-other-is-selected-in-dropdown-list-in-rails", "title": "Open a text box when other is selected in dropdown list in rails", "body": "<p>I have a table \"fundings\" in which there is a field \"status\", for which i have a select field in the form. The options for this select field are <code>[\"approved\",  \"declined\", \"pending\"]</code>. What i want is when \"declined\" is selected, a further text box shows to explain the reason for decline. Please help how can this be done.</p>\n\n<pre><code>&lt;%= form_for([@parent, @child, @funding], :html =&gt; {class: \"form-horizontal\",role: \"form\"}) do |form| %&gt;\n  &lt;div class = \"form-group\"&gt;\n    &lt;div class=\"control-label col-sm-2\"&gt;\n      &lt;%= form.label :status %&gt;\n    &lt;/div&gt;\n\n    &lt;% if current_user.admin? %&gt;\n      &lt;div class=\"col-sm-8\"&gt;\n        &lt;%= form.select :status,['Pending', 'Approved', 'Declined'], class: \"form-control\" %&gt;\n      &lt;/div&gt;\n    &lt;% else %&gt;\n      &lt;!-- Disabled for non-admin users --&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Submit button here --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Update</p>\n\n<pre><code>     &lt;div class=\"form-group\"&gt;\n  &lt;%= \"Status\" %&gt;\n  &lt;%= form.select :status, ['Pending', 'Approved', 'Declined'], {}, id: \"sample-status-select\", class: \"form-control\" %&gt;\n&lt;/div&gt;\n&lt;div class=\"form-group\"&gt;\n  &lt;%= \"Decline Reason\" %&gt;\n  &lt;%= form.text_area :decline_reason, class: \"form-control hidden\", id: \"decline-reason-textarea\" %&gt;\n&lt;/div&gt;\n      &lt;/div&gt; \n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-10\"&gt;\n          &lt;%= form.submit \"Apply\", class: 'btn btn-primary btn-lg' %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n    &lt;% end %&gt;\n&lt;script type=\"text/javascript\"&gt;\n  &lt;plain&gt;\n  $(function() {\n    $(\"#sample-status-select\").on(\"change\", function() {\n      var select_val = $(this).val();\n      console.log(select_val);\n      if (select_val === 'Declined') {\n        $(\"#decline-reason-textarea\").removeClass(\"hidden\");\n      } else {\n        $(\"#decline-reason-textarea\").addClass(\"hidden\");\n        $(\"#decline-reason-textarea\").val(\"\");\n      }\n    });\n  });\n  &lt;/plain&gt;\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1530143534, "post_id": 51072805, "comment_id": 89135376, "body": "One way <code>a.group_by { |key, *_| key  }.transform_values { |arr| arr.map { |_, k, v| { k =&gt; v } } }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1530154098, "post_id": 51072990, "comment_id": 89137451, "body": "You can avoid that pesky last line by using <code>each_with_object</code> rather than <code>reduce</code> and can simplify a little by replacing <code>item</code> with<code>(key, value)</code> in the block variables."}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1530154198, "post_id": 51072990, "comment_id": 89137473, "body": "@Cary Yeah, as mentioned, there are other ways to do this, other than <code>reduce</code>, but since they posted code they thought should work, and it didn&#39;t, thought it would be helpful to explain to them why their code didn&#39;t work as expected (especially since it was so close)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1530169175, "post_id": 51072990, "comment_id": 89141934, "body": "Good point. I had forgotten the OP used <code>reduce</code> when I posted my comment. I see I misspoke about replacing <code>item</code> with <code>(key, value)</code>; it should be <code>(key1, key2, value)</code> or somesuch."}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 2, "last_activity_date": 1530144397, "creation_date": 1530144397, "answer_id": 51072990, "question_id": 51072805, "link": "https://stackoverflow.com/questions/51072805/ruby-how-can-i-convert-this-array-into-this-hash/51072990#51072990", "title": "Ruby: How can I convert this array into this hash?", "body": "<p>You way works, but, for <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\"><code>reduce</code></a>, the return value (ie, the last line) of the block becomes the next value for (in this case) <code>acc</code>, so all you need to change is:</p>\n\n<pre><code>a.reduce({}) do |acc, item|\n  acc[item.first] = [] unless acc.key? item.first\n  acc[item.first] &lt;&lt; { item[1] =&gt; item[2] }\n\n  acc # just add this line\nend\n</code></pre>\n\n<p>Since the return value for <a href=\"https://ruby-doc.org/core/Array.html#method-i-3C-3C\" rel=\"nofollow noreferrer\"><code>Array#&lt;&lt;</code></a> is the array itself, the second iteration gave <code>acc</code> as the array for the first element. There are, of course, lots of ways to do this, some arguably cleaner, but I find it's useful to know where I went wrong when something I think should work doesn't.</p>\n"}, {"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1530154044, "post_id": 51073949, "comment_id": 89137438, "body": "Or <code>each_with_object(Hash.new { |h, k| h[k] = [ ] })</code> if you want to skip the <code>(h[kout] ||= [ ])</code> and don&#39;t mind your result having a default proc."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1530154316, "post_id": 51073949, "comment_id": 89137503, "body": "@muistooshort, I actually started writing it the way you suggest but figured that would require a somewhat lengthy explanation so used the old-fashioned way (which I tend to prefer anyway). Do you have a preference yourself? I&#39;ll explain <code>(h[kout] ||= [])</code>."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1530155809, "post_id": 51073949, "comment_id": 89137777, "body": "I use both forms depending on no real criteria other than which seems more natural at the time."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1530156572, "post_id": 51073949, "comment_id": 89137920, "body": "@muistooshort, ha! Me too."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1530156718, "post_id": 51073949, "comment_id": 89137950, "body": "Your explanations are appreciated BTW. Much nicer than just throwing down some code."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 3, "last_activity_date": 1530157040, "last_edit_date": 1530157040, "creation_date": 1530153868, "answer_id": 51073949, "question_id": 51072805, "link": "https://stackoverflow.com/questions/51072805/ruby-how-can-i-convert-this-array-into-this-hash/51073949#51073949", "title": "Ruby: How can I convert this array into this hash?", "body": "<pre><code>a.each_with_object({}) { |(kout, kin, val), h| (h[kout] ||= []) &lt;&lt; { kin =&gt; val } }\n  #=&gt; {\"4\"=&gt;[{\"dog\"=&gt;\"woof\"}, {\"cow\"=&gt;\"moo\"}], \"2\"=&gt;[{\"man\"=&gt;\"yo\"}, {\"yeti\"=&gt;\"wrarghh\"}]}\n</code></pre>\n\n<p>We have</p>\n\n<pre><code>enum = a.each_with_object({})\n  #=&gt; #&lt;Enumerator: [[\"4\", \"dog\", \"woof\"], [\"4\", \"cow\", \"moo\"], [\"2\", \"man\", \"yo\"],\n  #                  [\"2\", \"yeti\", \"wrarghh\"]]:each_with_object({})&gt;\n</code></pre>\n\n<p>The first value is generated by this enumerator and passed to the block, and the block variables are assigned values:</p>\n\n<pre><code>(kout, kin, val), h = enum.next\n  #=&gt; [[\"4\", \"dog\", \"woof\"], {}]\n</code></pre>\n\n<p>which is decomposed as follows.</p>\n\n<pre><code>kout\n  #=&gt; \"4\"\nkin\n  #=&gt; \"dog\"\nval\n  #=&gt; \"woof\"\nh #=&gt; {}\n</code></pre>\n\n<p>The block calculation is therefore</p>\n\n<pre><code>(h[kout] ||= []) &lt;&lt; { kin =&gt; val }\n  #=&gt; (h[kout] = h[kout] || []) &lt;&lt; { \"dog\" =&gt; \"wolf\" }\n  #=&gt; (h[\"4\"] = h[\"4\"] || []) &lt;&lt; { \"dog\" =&gt; \"wolf\" }\n  #=&gt; (h[\"4\"] = nil ||= []) &lt;&lt; { \"dog\" =&gt; \"wolf\" }\n  #=&gt; (h[\"4\"] = []) &lt;&lt; { \"dog\" =&gt; \"wolf\" }\n  #=&gt; [] &lt;&lt; { \"dog\" =&gt; \"wolf\" }\n  #=&gt; [{ \"dog\" =&gt; \"wolf\" }]\n</code></pre>\n\n<p><code>h[\"4\"] || [] #=&gt; []</code> since <code>h</code> has no key <code>\"4\"</code> and therefore <code>h[\"4\"] #=&gt; nil</code>.</p>\n\n<p>The next value of <code>enum</code> is passed to the block and the calculations are repeated.</p>\n\n<pre><code>(kout, kin, val), h = enum.next\n  #=&gt; [[\"4\", \"cow\", \"moo\"], {\"4\"=&gt;[{\"dog\"=&gt;\"woof\"}]}]\nkout\n  #=&gt; \"4\"\nkin\n  #=&gt; \"cow\"\nval\n  #=&gt; \"moo\"\nh #=&gt; {\"4\"=&gt;[{\"dog\"=&gt;\"woof\"}]}\n\n(h[kout] ||= []) &lt;&lt; { kin =&gt; val }\n  #=&gt; (h[kout] = h[kout] || []) &lt;&lt; { \"cow\" =&gt; \"moo\" }\n  #=&gt; (h[\"4\"] = h[\"4\"] || []) &lt;&lt; { \"cow\" =&gt; \"moo\" }\n  #=&gt; (h[\"4\"] = [{\"dog\"=&gt;\"woof\"}] ||= []) &lt;&lt; { \"cow\" =&gt; \"moo\" }\n  #=&gt; (h[\"4\"] = [{\"dog\"=&gt;\"woof\"}]) &lt;&lt; { \"cow\" =&gt; \"moo\" }\n  #=&gt; [{\"dog\"=&gt;\"woof\"}] &lt;&lt; { \"cow\" =&gt; \"moo\" }\n  #=&gt; [{ \"dog\" =&gt; \"wolf\" }, { \"cow\" =&gt; \"moo\" }]\n</code></pre>\n\n<p>This time <code>h[\"4\"] || [] #=&gt; [{ \"dog\" =&gt; \"wolf\" }]</code> because <code>h</code> now has a key <code>\"4\"</code> with a truthy value (<code>[{ \"dog\" =&gt; \"wolf\" }]</code>).</p>\n\n<p>The remaining calculations are similar.</p>\n"}], "owner": {"reputation": 1880, "user_id": 3574603, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/71a7b92124991652bf4dd64a9c50a9ca?s=128&d=identicon&r=PG&f=1", "display_name": "user3574603", "link": "https://stackoverflow.com/users/3574603/user3574603"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 51073949, "answer_count": 2, "score": 0, "last_activity_date": 1530186209, "creation_date": 1530142783, "last_edit_date": 1530186209, "question_id": 51072805, "link": "https://stackoverflow.com/questions/51072805/ruby-how-can-i-convert-this-array-into-this-hash", "title": "Ruby: How can I convert this array into this hash?", "body": "<p>I have an array of arrays. Each item in the array contains three strings: a leg count, an animal and a sound.</p>\n\n<pre><code>a = [ ['4', 'dog', 'woof'] , ['4', 'cow', 'moo'], ['2', 'human', 'yo'] , ['2', 'yeti', 'wrarghh'] ]\n</code></pre>\n\n<p>I want to turn the array into this hash:</p>\n\n<pre><code>{ \n  '2' =&gt; [ { 'human' =&gt; 'yo' }, { 'yeti' =&gt; 'wrarghh'} ],\n  '4' =&gt; [ { 'dog' =&gt; 'woof' }, { 'cow' =&gt; 'moo'} ]\n}\n</code></pre>\n\n<p>I thought reduce would be the way to go but I'm not having much luck. My current stab looks like:</p>\n\n<pre><code>a.reduce({}) do |acc, item|\n             acc[item.first] = [] unless acc.key? item.first\n             acc[item.first] &lt;&lt; { item[1] =&gt; item[2] }\n           end\n</code></pre>\n\n<p>But it gets an error:</p>\n\n<pre><code>NoMethodError: undefined method `key?' for [{\"dog\"=&gt;\"woof\"}]:Array\n</code></pre>\n\n<p>What is the best way to achieve this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1530138699, "post_id": 51072291, "comment_id": 89134334, "body": "Use a big Q and it works! <a href=\"http://ruby-doc.org/core-2.5.1/doc/syntax/literals_rdoc.html#label-Strings\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/doc/syntax/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1530138779, "creation_date": 1530138779, "answer_id": 51072322, "question_id": 51072291, "link": "https://stackoverflow.com/questions/51072291/how-to-insert-variable-into-formatted-text-in-ruby/51072322#51072322", "title": "How to insert variable into formatted text in ruby", "body": "<p>Just use uppercase \"Q\"</p>\n\n<pre><code>variable = \"some string\"\n%Q{ My math #{1+1} and string #{variable}}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7919100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IHinH2h_t2U/AAAAAAAAAAI/AAAAAAAADIU/O-DG2I_d9RU/photo.jpg?sz=128", "display_name": "Damoon Imani", "link": "https://stackoverflow.com/users/7919100/damoon-imani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1530139725, "accepted_answer_id": 51072322, "answer_count": 1, "score": 1, "last_activity_date": 1530138779, "creation_date": 1530138520, "question_id": 51072291, "link": "https://stackoverflow.com/questions/51072291/how-to-insert-variable-into-formatted-text-in-ruby", "closed_reason": "Duplicate", "title": "How to insert variable into formatted text in ruby", "body": "<p>So I have a string formatted with triple quotation marks or %q{} like this and I want to insert a variable into the string; apparently using #{variable} wouldn't work.</p>\n\n<pre><code>variable = \"some string\" \nputs %q{\nMy string looks like\nthis and i want to show\nmy string here #{variable}\n}\n</code></pre>\n"}, {"tags": ["javascript", "html", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530135090, "post_id": 51071631, "comment_id": 89133163, "body": "Unfortunately, no it do nothing."}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "reply_to_user": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530136860, "post_id": 51071631, "comment_id": 89133821, "body": "@AlexandrBalahontsev my bad its supposed tobe <code>$(this).attr(&#39;href&#39;)</code>, updated post"}], "tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1530136849, "last_edit_date": 1530136849, "creation_date": 1530134671, "answer_id": 51071631, "question_id": 51071496, "link": "https://stackoverflow.com/questions/51071496/submit-rails-form-with-another-way-instead-of-button/51071631#51071631", "title": "Submit Rails form with another way instead of button", "body": "<p>Try like this</p>\n\n<pre><code>$(function() {\n   $(\".submit-link\").click(function(e) {\n      e.preventDefault();\n      window.location.href = $(this).attr('href');\n   });\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530136018, "post_id": 51071782, "comment_id": 89133509, "body": "All the same.  I know what make  &lt;%= f.submit %&gt; is the easiest way. And it work. But I need exactly this way."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530136335, "post_id": 51071782, "comment_id": 89133629, "body": "ok, you are trying to submit form... you didn&#39;t mention. you need to use jquery to localize your form <code>$(&#39;form&#39;).submit()</code> because <code>$(this)</code> refers to your link"}, {"owner": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530137681, "post_id": 51071782, "comment_id": 89134077, "body": "Yes. I see something like this  &lt;button class=&quot;submit-link&quot;&gt; &lt;a href=&quot;#&quot;  class=&quot;form&quot;&gt;Log In&lt;/a&gt; &lt;/button&gt; And it work. But again it button. Or I just can&#39;t understand simple things."}, {"owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "reply_to_user": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "edited": false, "score": 0, "creation_date": 1530139816, "post_id": 51071782, "comment_id": 89134594, "body": "if you want to send form when <code>$(&quot;.submit-link&quot;)</code> is clicked you need to call function on your form. Form has id so grab this form and call submit <code>$(&#39;#form-name&#39;).submit() </code> when your link clicked. With button case : <code>button</code> has type <code>submit</code>or button has some additional events on that triggers the form. `"}], "tags": [], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "is_accepted": true, "score": 0, "last_activity_date": 1530447458, "last_edit_date": 1530447458, "creation_date": 1530135457, "answer_id": 51071782, "question_id": 51071496, "link": "https://stackoverflow.com/questions/51071496/submit-rails-form-with-another-way-instead-of-button/51071782#51071782", "title": "Submit Rails form with another way instead of button", "body": "<p>You could use preventDefault to free href from pointing to '#'</p>\n\n<pre><code>$(function() {\n   $(\".submit-link\").click(function(e) {\n      e.preventDefault();\n      window.location.href = $(this).attr('href');;\n      //return false \n   });\n</code></pre>\n\n<p>or return false </p>\n"}], "owner": {"reputation": 15, "user_id": 9996406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kz-93jH-US0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2bZWFsCf9UDQW4VINW7vWK_hhgQw/mo/photo.jpg?sz=128", "display_name": "Alexandr Balahontsev", "link": "https://stackoverflow.com/users/9996406/alexandr-balahontsev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 51071782, "answer_count": 2, "score": 0, "last_activity_date": 1530447458, "creation_date": 1530133989, "question_id": 51071496, "link": "https://stackoverflow.com/questions/51071496/submit-rails-form-with-another-way-instead-of-button", "title": "Submit Rails form with another way instead of button", "body": "<p>How to use as a submit</p>\n\n<p>index.html.rb</p>\n\n<pre><code>&lt;a href=\"#\"  class=\"submit-link button\"&gt;Log In&lt;/a&gt;\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>$(function() {\n    $(\".submit-link\").click(function() {\n        $(this).submit();\n    });\n</code></pre>\n\n<p>All I need is ready, but something wrong.</p>\n"}, {"tags": ["ruby", "macos", "nvm", "homebrew-cask"], "answers": [{"tags": [], "owner": {"reputation": 10854, "user_id": 986862, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rFbtP.jpg?s=128&g=1", "display_name": "Andre Figueiredo", "link": "https://stackoverflow.com/users/986862/andre-figueiredo"}, "is_accepted": false, "score": 0, "last_activity_date": 1530148829, "creation_date": 1530148829, "answer_id": 51073432, "question_id": 51071491, "link": "https://stackoverflow.com/questions/51071491/error-while-installing-nvm-in-mac-using-brew/51073432#51073432", "title": "Error while installing nvm in mac using brew", "body": "<p>This is a problem with SSL ciphers settings and ones in the server.\nTry updating at least one of Homebrew / Ruby / OpenSSL.</p>\n\n<p>more about this:</p>\n\n<ul>\n<li><a href=\"https://github.com/rvm/rvm/pull/1764\" rel=\"nofollow noreferrer\">https://github.com/rvm/rvm/pull/1764</a></li>\n<li><p><a href=\"https://stackoverflow.com/questions/33292097/ssl-connect-syscall-returned-5-errno-0-state-sslv3-read-server-hello-a-openssl\">SSL_connect SYSCALL returned=5 errno=0 state=SSLv3 read server hello A (OpenSSL::SSL::SSLError)</a></p></li>\n<li><p><a href=\"https://github.com/google/google-api-ruby-client/issues/253\" rel=\"nofollow noreferrer\">https://github.com/google/google-api-ruby-client/issues/253</a></p></li>\n</ul>\n"}], "owner": {"reputation": 57, "user_id": 10002310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kFrsX_B_kfQ/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2hTbZMAmF6-oujd9s_3SxZW-jelw/mo/photo.jpg?sz=128", "display_name": "JingJong", "link": "https://stackoverflow.com/users/10002310/jingjong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534493098, "creation_date": 1530133975, "last_edit_date": 1534493098, "question_id": 51071491, "link": "https://stackoverflow.com/questions/51071491/error-while-installing-nvm-in-mac-using-brew", "title": "Error while installing nvm in mac using brew", "body": "<p>I am trying to install nvm using brew. i am trying to use the following command to install nvm, but getting the below error. Any help is appreciated.</p>\n\n<p><strong>Command:</strong><br></p>\n\n<pre><code> brew cask install nvm\n</code></pre>\n\n<p><strong>Error:</strong><br></p>\n\n<pre><code>Error: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\nFollow the instructions here:\n  https://github.com/Homebrew/homebrew-cask#reporting-bugs\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/net/http.rb:933:in `connect_nonblock'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/net/http.rb:933:in `connect'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/net/http.rb:863:in `do_start'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/net/http.rb:852:in `start'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:319:in `open_http'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:737:in `buffer_open'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:212:in `block in open_loop'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:210:in `catch'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:210:in `open_loop'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:151:in `open_uri'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:717:in `open'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "docker", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 2510165, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1ac62cb336029440d39950b9045408d4?s=128&d=identicon&r=PG", "display_name": "Cherry", "link": "https://stackoverflow.com/users/2510165/cherry"}, "is_accepted": false, "score": 0, "last_activity_date": 1531412534, "creation_date": 1531412534, "answer_id": 51310449, "question_id": 51071371, "link": "https://stackoverflow.com/questions/51071371/putting-all-configuration-in-uri-in-mongoid-yml-does-not-connect-ruby-with-mongo/51310449#51310449", "title": "Putting all configuration in uri in mongoid.yml does not connect ruby with mongo", "body": "<p>This solution works for me: Added self signed ssl certificate, configured mongoid.yml, put all the information in uri, added the uri in mongoid.yml as an ENV var.</p>\n"}], "owner": {"reputation": 821, "user_id": 2510165, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1ac62cb336029440d39950b9045408d4?s=128&d=identicon&r=PG", "display_name": "Cherry", "link": "https://stackoverflow.com/users/2510165/cherry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531412534, "creation_date": 1530133450, "last_edit_date": 1530282161, "question_id": 51071371, "link": "https://stackoverflow.com/questions/51071371/putting-all-configuration-in-uri-in-mongoid-yml-does-not-connect-ruby-with-mongo", "title": "Putting all configuration in uri in mongoid.yml does not connect ruby with mongo", "body": "<p>Here is the <em>mongoid.yml</em>, which works fine:</p>\n\n<pre><code>development:\n  clients:\n    default:\n      database: dbname\n      hosts:\n        - hostname:27017\n        - hostname:27018\n      options:\n        user: 'a.b@user.com'\n        password: 'asdfg1234'     \n        ssl: true\n        ssl_verify: false\n</code></pre>\n\n<p>But If I put this information in a uri and comment out those, the ruby app cannot connect to mongodb:</p>\n\n<pre><code>development:\n  clients:\n    default:\n      uri: mongodb://a.b%40user.com:asdfg1234@hostname:27017,hostname:27018/dbname?authSource=admin&amp;ssl=true&amp;ssl_verify=false\n      # database: dbname\n      # hosts:\n        # - hostname:27017\n        # - hostname:27018\n      # options:\n        # user: 'a.b@user.com'\n        # password: 'asdfg1234'     \n        # ssl: true\n        # ssl_verify: false\n</code></pre>\n\n<p>It shows the following error:</p>\n\n<pre><code>MONGODB | SSL handshake failed. MongoDB may not be configured with SSL support.\n</code></pre>\n\n<p>Any help to solve this would be great.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 359800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaacaba155f5a7a995dd15015fda9b9a?s=128&d=identicon&r=PG", "display_name": "weetch", "link": "https://stackoverflow.com/users/359800/weetch"}, "edited": false, "score": 0, "creation_date": 1530133621, "post_id": 51071342, "comment_id": 89132612, "body": "Thanks, I&#39;ll try that. Is there a chance that even this approach can end up generating a word that&#39;s less than 5 characters?"}, {"owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "edited": false, "score": 0, "creation_date": 1530133874, "post_id": 51071342, "comment_id": 89132710, "body": "unfortunately there is - you can&#39;t be sure what&#39;s in ffaker sample data"}], "tags": [], "owner": {"reputation": 41, "user_id": 4309737, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-k_C6osX-7Bg/AAAAAAAAAAI/AAAAAAAAAfc/b_LdzDRIS2E/photo.jpg?sz=128", "display_name": "veloper in big Enmanuel Medina", "link": "https://stackoverflow.com/users/4309737/veloper-in-big-enmanuel-medina"}, "is_accepted": false, "score": 0, "last_activity_date": 1530133270, "creation_date": 1530133270, "answer_id": 51071342, "question_id": 51071115, "link": "https://stackoverflow.com/questions/51071115/specifying-minimum-length-when-using-ffakerinternet-user-name/51071342#51071342", "title": "Specifying minimum length when using FFaker::Internet.user_name", "body": "<p>You can't, but you could do FFaker::Name.name.join, this generates first name and middle name</p>\n"}, {"tags": [], "owner": {"reputation": 4338, "user_id": 299774, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/eab8557a9cb59427455bac3cc59d2802?s=128&d=identicon&r=PG", "display_name": "Grzegorz", "link": "https://stackoverflow.com/users/299774/grzegorz"}, "is_accepted": true, "score": 0, "last_activity_date": 1530133824, "creation_date": 1530133824, "answer_id": 51071457, "question_id": 51071115, "link": "https://stackoverflow.com/questions/51071115/specifying-minimum-length-when-using-ffakerinternet-user-name/51071457#51071457", "title": "Specifying minimum length when using FFaker::Internet.user_name", "body": "<p>From what I see you try to use FFaker in your factory. Why overcomplicate things for your specs, when you could define <a href=\"https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md#sequences\" rel=\"nofollow noreferrer\">sequence</a></p>\n\n<pre><code>sequence(:username) do |n|\n   \"username-#{n}\"\nend\n</code></pre>\n\n<p>But the question is valid and you may have some legitimate needs to use ffaker, and there are many ways to do it. You can just concatenate username twice, why not?</p>\n\n<pre><code>username { FFaker.username + FFaker.username }\n</code></pre>\n\n<p>Or keep looking for a username that length is of minimal lenght:</p>\n\n<pre><code>username do\n   do\n     name = FFaker.username\n   while name.length &lt; 5\n   name\nend\n</code></pre>\n\n<p>Or monkeypatch ffaker and implement it yourself <a href=\"https://github.com/ffaker/ffaker/blob/0578f7fd31c9b485e9c6fa15f25b3eca724790fe/lib/ffaker/internet.rb#L43\" rel=\"nofollow noreferrer\">https://github.com/ffaker/ffaker/blob/0578f7fd31c9b485e9c6fa15f25b3eca724790fe/lib/ffaker/internet.rb#L43</a> + <a href=\"https://github.com/ffaker/ffaker/blob/0578f7fd31c9b485e9c6fa15f25b3eca724790fe/lib/ffaker/name.rb#L75\" rel=\"nofollow noreferrer\">https://github.com/ffaker/ffaker/blob/0578f7fd31c9b485e9c6fa15f25b3eca724790fe/lib/ffaker/name.rb#L75</a></p>\n\n<p>for example</p>\n\n<pre><code>class FFaker\n  def long_username(min_length = 5)\n    fetch_sample(FIRST_NAMES.select {|name| name.length &gt;= min_lenght })\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 3134957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qutnS.jpg?s=128&g=1", "display_name": "Anurag Aryan", "link": "https://stackoverflow.com/users/3134957/anurag-aryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1530135785, "creation_date": 1530135785, "answer_id": 51071832, "question_id": 51071115, "link": "https://stackoverflow.com/questions/51071115/specifying-minimum-length-when-using-ffakerinternet-user-name/51071832#51071832", "title": "Specifying minimum length when using FFaker::Internet.user_name", "body": "<p>There're many ways you can achieve this, but if I had to do it, I'd do something like </p>\n\n<pre><code>(FFaker::Internet.user_name + '___')[0...5]\n#=&gt; \"Lily_\"\n</code></pre>\n\n<p>There are three underscores because after the quick lookup to the <a href=\"https://github.com/ffaker/ffaker/blob/0578f7fd31c9b485e9c6fa15f25b3eca724790fe/lib/ffaker/data/name/first_names_female\" rel=\"nofollow noreferrer\">name list</a>, I found the minimum length of first name is two characters so two plus three will always be at least five characters.</p>\n\n<p>I'm only taking five character substring so as to not always have trailing underscore, but that's just my personal preference, you can use username plus three underscores and your test case will do fine.</p>\n"}, {"tags": [], "owner": {"reputation": 339, "user_id": 3294937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6e5df8b83d5c25d6e6984b3afe6d1e?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyQ77", "link": "https://stackoverflow.com/users/3294937/vinnyq77"}, "is_accepted": false, "score": 0, "last_activity_date": 1592425767, "creation_date": 1592425767, "answer_id": 62437845, "question_id": 51071115, "link": "https://stackoverflow.com/questions/51071115/specifying-minimum-length-when-using-ffakerinternet-user-name/62437845#62437845", "title": "Specifying minimum length when using FFaker::Internet.user_name", "body": "<p>You can also build it manually with regex using FFaker::String like so:</p>\n\n<pre><code># 5 characters username, with first character being a letter\nusername { FFaker::String.from_regexp(/[a-zA-Z]\\w{4}/) }\n\n# random 5-10 characters username with first character being a letter\nregex = Regexp.new(\"[a-zA-Z]\\\\w{#{Random.rand(4..9)}}\")\nusername { FFaker::String.from_regexp(regex) }\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 359800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaacaba155f5a7a995dd15015fda9b9a?s=128&d=identicon&r=PG", "display_name": "weetch", "link": "https://stackoverflow.com/users/359800/weetch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 51071457, "answer_count": 4, "score": 1, "last_activity_date": 1592425767, "creation_date": 1530132194, "question_id": 51071115, "link": "https://stackoverflow.com/questions/51071115/specifying-minimum-length-when-using-ffakerinternet-user-name", "title": "Specifying minimum length when using FFaker::Internet.user_name", "body": "<p>I have a spec that keeps failing because FFaker::Internet.user_name generates a word that is less than 5 characters.</p>\n\n<p>How do I specify a minimum length in this stmt:</p>\n\n<pre><code>username { FFaker::Internet.user_name }\n</code></pre>\n"}, {"tags": ["ruby", "cucumber"], "answers": [{"tags": [], "owner": {"reputation": 1303, "user_id": 2235381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0061f9bd5384a544637692774a6e108f?s=128&d=identicon&r=PG", "display_name": "lojza", "link": "https://stackoverflow.com/users/2235381/lojza"}, "is_accepted": false, "score": 0, "last_activity_date": 1530534438, "creation_date": 1530534438, "answer_id": 51136222, "question_id": 51070914, "link": "https://stackoverflow.com/questions/51070914/parallel-cucumber-gem-part-of-parallel-tests-how-do-i-run-all-individual-s/51136222#51136222", "title": "parallel_cucumber gem (part of parallel_tests) ... How do I run all individual scenarios in parallel", "body": "<p>I did this some time ago but without parallel_cucumber gem. </p>\n\n<ul>\n<li>Cucumber accept this: <code>cucumber features/test.feature:7</code> - run test on specific line number of given feature file. </li>\n<li><code>grep -rHn</code> helps you generate list of path/file:line_number</li>\n<li><a href=\"https://www.gnu.org/software/parallel/\" rel=\"nofollow noreferrer\">GNU Parallel</a> available in most distros helps you execute the list</li>\n<li>parsing of output is needed :-(</li>\n</ul>\n"}], "owner": {"reputation": 1978, "user_id": 1222355, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/44e0773345e9065b2e012b434370dbbb?s=128&d=identicon&r=PG", "display_name": "David West", "link": "https://stackoverflow.com/users/1222355/david-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530534438, "creation_date": 1530131215, "question_id": 51070914, "link": "https://stackoverflow.com/questions/51070914/parallel-cucumber-gem-part-of-parallel-tests-how-do-i-run-all-individual-s", "title": "parallel_cucumber gem (part of parallel_tests) ... How do I run all individual scenarios in parallel", "body": "<p>I can easily run <em>features</em> in parallel like so:</p>\n\n<p><code>$ bundle exec parallel_cucumber features/ -n 6 -o '-t  @smoke -t ~@manual'</code></p>\n\n<p>I want to all <em>scenarios</em> in parallel, however as that would be much faster.</p>\n\n<p>How can I do this with the parallel_cucumber gem?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "reply_to_user": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1530131799, "post_id": 51070901, "comment_id": 89131790, "body": "with this express ipad129_portait&#39; returns 129 instead of nil"}], "answers": [{"tags": [], "owner": {"reputation": 1001, "user_id": 2945977, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c76f28b6eccfe32b63a559aac74a9be5?s=128&d=identicon&r=PG&f=1", "display_name": "sonic", "link": "https://stackoverflow.com/users/2945977/sonic"}, "is_accepted": false, "score": 0, "last_activity_date": 1530134629, "last_edit_date": 1530134629, "creation_date": 1530134187, "answer_id": 51071535, "question_id": 51070901, "link": "https://stackoverflow.com/questions/51070901/regex-express-to-find-a-number-in-a-string-in-ruby/51071535#51071535", "title": "Regex express to find a number in a string in ruby", "body": "<pre><code>b\n=&gt; \"asdas-12-asd\" \nb.scan(/([A-z]*)(_{1}|-{1})(\\d*)(_{1}|-{1})([A-z]*)/)\n=&gt; [[\"asdas\", \"-\", \"12\", \"-\", \"asd\"]] \n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>here it is  with noncapturing group</p>\n\n<pre><code>b.scan(/(?:[A-z]*)(?:_{1}|-{1})(\\d*)(?:_{1}|-{1})(?:[A-z]*)/)\n =&gt; [[\"12\"]] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1530136024, "creation_date": 1530136024, "answer_id": 51071881, "question_id": 51070901, "link": "https://stackoverflow.com/questions/51070901/regex-express-to-find-a-number-in-a-string-in-ruby/51071881#51071881", "title": "Regex express to find a number in a string in ruby", "body": "<pre><code>str = 'xyz_1_y1x'\n</code></pre>\n\n<p>If you want the first <code>'1'</code>,</p>\n\n<pre><code>r = /1/\nstr[r]\n  #=&gt; \"1\"\n</code></pre>\n\n<p>which uses the method <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a>. Alternatively:</p>\n\n<pre><code>str.each_char.find { |c| c == '1' }\n  #=&gt; `'1'`\n</code></pre>\n\n<p>If you want all <code>'1'</code>'s, use <a href=\"http://ruby-doc.org/core-2.4.0/String.html#method-i-scan\" rel=\"nofollow noreferrer\">String#scan</a>:</p>\n\n<pre><code>str.scan r\n  #=&gt; [\"1\", \"1\"]\n</code></pre>\n\n<p>Note that <code>str[r]</code> is equivalent to determining whether the string contains one or more <code>'1'</code>'s and <code>str.scan(r)</code> tells us nothing more than the number of <code>'1'</code> that are contained in the string.</p>\n\n<p>If you want to extract any digit, change the regular expression: <code>r = /\\d/</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 3134957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qutnS.jpg?s=128&g=1", "display_name": "Anurag Aryan", "link": "https://stackoverflow.com/users/3134957/anurag-aryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1530136204, "creation_date": 1530136204, "answer_id": 51071917, "question_id": 51070901, "link": "https://stackoverflow.com/questions/51070901/regex-express-to-find-a-number-in-a-string-in-ruby/51071917#51071917", "title": "Regex express to find a number in a string in ruby", "body": "<p>As per my understanding of your question, you want the characters between <code>-</code> or <code>_</code>. If that's the case you can simply do</p>\n\n<pre><code>str = 'xyz_1_yx'\nstr.split(/[-,_]/)[1] \n#=&gt; '1'\n\nstr = 'xyz-129-yx'\nstr.split(/[-,_]/)[1] \n#=&gt; '129'\n</code></pre>\n"}], "owner": {"reputation": 2138, "user_id": 1377879, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/88ed0b98e028557cf987548411d8138c?s=128&d=identicon&r=PG", "display_name": "Bolo", "link": "https://stackoverflow.com/users/1377879/bolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530136204, "creation_date": 1530131178, "question_id": 51070901, "link": "https://stackoverflow.com/questions/51070901/regex-express-to-find-a-number-in-a-string-in-ruby", "title": "Regex express to find a number in a string in ruby", "body": "<p>'xyz_1_yx'\n'xyz-1-yx'</p>\n\n<p>I have tried to find the correct regex expression to extract 1</p>\n\n<pre><code>  def find_number(image_basename)\n    startIndex= 1\n    endIndex= 10\n\n    (startIndex..endIndex).each do |n|\n      return n if /\\b-|_#{n}-|_\\b/.match(image_basename)\n    end\n    nil\n  end\n</code></pre>\n\n<p>2.5.0 :376 > find_number('xyz_1_yx')\n => nil </p>\n"}, {"tags": ["javascript", "arrays", "json", "ruby"], "comments": [{"owner": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1530127387, "post_id": 51070004, "comment_id": 89129981, "body": "Did you deliberately omit <code>&quot;aws&quot;:10,&quot;azure&quot;:12,&quot;cli&quot;:41</code> from your desired output?"}, {"owner": {"reputation": 67, "user_id": 2088242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c6367e22b383640364890e4db91a0a4?s=128&d=identicon&r=PG", "display_name": "yash041", "link": "https://stackoverflow.com/users/2088242/yash041"}, "reply_to_user": {"reputation": 4609, "user_id": 4636715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ebd8c54bb287f99b94373429b588e21?s=128&d=identicon&r=PG&f=1", "display_name": "vahdet", "link": "https://stackoverflow.com/users/4636715/vahdet"}, "edited": false, "score": 0, "creation_date": 1530127423, "post_id": 51070004, "comment_id": 89129992, "body": "no just give example for look like this way ..."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1530128067, "post_id": 51070004, "comment_id": 89130251, "body": "Will the input array always have exactly one item (the object)? If not, what would the output look like with for several objects?"}], "answers": [{"tags": [], "owner": {"reputation": 304305, "user_id": 519413, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7839089cd91dc5cc5eb1e0cdbf3312ed?s=128&d=identicon&r=PG", "display_name": "Rory McCrossan", "link": "https://stackoverflow.com/users/519413/rory-mccrossan"}, "is_accepted": false, "score": 4, "last_activity_date": 1530127480, "creation_date": 1530127480, "answer_id": 51070063, "question_id": 51070004, "link": "https://stackoverflow.com/questions/51070004/json-to-object-array-format/51070063#51070063", "title": "JSON to object array format", "body": "<p>Firstly note that you do not need jQuery at all for this. jQuery is primarily a tool for amending the DOM. To work with data structures like this native JS is all you need.</p>\n\n<p>To achieve what you require, you can use <code>Object.keys()</code> to get the keys of the 0th object in your original array, then you can loop over them using <code>map()</code> to build a new 2 dimensional array from that data: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var originalArr = [{\r\n  \"new\": 122,\r\n  \"old\": 3389,\r\n  \"boarding\": 1,\r\n  \"aws\": 10,\r\n  \"azure\": 12,\r\n  \"cli\": 41\r\n}];\r\n\r\nvar newArr = Object.keys(originalArr[0]).map(function(key) {\r\n  return [key, originalArr[0][key]];\r\n});\r\n\r\nconsole.log(newArr);</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 304305, "user_id": 519413, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7839089cd91dc5cc5eb1e0cdbf3312ed?s=128&d=identicon&r=PG", "display_name": "Rory McCrossan", "link": "https://stackoverflow.com/users/519413/rory-mccrossan"}, "edited": false, "score": 0, "creation_date": 1530128002, "post_id": 51070153, "comment_id": 89130221, "body": "Not sure why this was downvoted. In an ideal world it&#39;s a great solution, the issue is it&#39;s completely unsupported in any version of IE"}], "tags": [], "owner": {"reputation": 23, "user_id": 9124027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZYvX5.png?s=128&g=1", "display_name": "cmichaelsd", "link": "https://stackoverflow.com/users/9124027/cmichaelsd"}, "is_accepted": false, "score": 1, "last_activity_date": 1530127916, "creation_date": 1530127916, "answer_id": 51070153, "question_id": 51070004, "link": "https://stackoverflow.com/questions/51070004/json-to-object-array-format/51070153#51070153", "title": "JSON to object array format", "body": "<p>Its simple enough. Just enter the array into Object.entries(). like this Object.entries(originalArr[0])</p>\n"}, {"tags": [], "owner": {"reputation": 1230, "user_id": 5402852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Thx5j.jpg?s=128&g=1", "display_name": "Leonid Pyrlia", "link": "https://stackoverflow.com/users/5402852/leonid-pyrlia"}, "is_accepted": false, "score": 1, "last_activity_date": 1530130698, "creation_date": 1530130698, "answer_id": 51070770, "question_id": 51070004, "link": "https://stackoverflow.com/questions/51070004/json-to-object-array-format/51070770#51070770", "title": "JSON to object array format", "body": "<p>A simple one-line alternative:</p>\n\n<pre><code>const data = [{\n  \"new\": 122,\n  \"old\": 3389,\n  \"boarding\": 1,\n  \"aws\": 10,\n  \"azure\": 12,\n  \"cli\": 41\n}];\n\nconst result = Object.keys(data[0]).map(k =&gt; ([k, data[0][k]]));\n\nconsole.log(result);\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 2088242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c6367e22b383640364890e4db91a0a4?s=128&d=identicon&r=PG", "display_name": "yash041", "link": "https://stackoverflow.com/users/2088242/yash041"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530130826, "creation_date": 1530127197, "last_edit_date": 1530130826, "question_id": 51070004, "link": "https://stackoverflow.com/questions/51070004/json-to-object-array-format", "title": "JSON to object array format", "body": "<p>I want to display like convert JSON data to array objects how can solve this problem using jquery or js? \nJSON data : </p>\n\n<pre><code>[{\n  \"new\": 122,\n  \"old\": 3389,\n  \"boarding\": 1,\n  \"aws\": 10,\n  \"azure\": 12,\n  \"cli\": 41\n}];\n</code></pre>\n\n<p>To array object:  </p>\n\n<pre><code>[\n  [\"new\", 122],\n  [\"old\", 3389],\n  [\"boarding\", 1]\n]\n</code></pre>\n\n<p>one more pattern I need it I have an array like this in Ruby </p>\n\n<pre><code> [37, \n  3, \n  261, \n  1, \n  0, \n  1457]\n</code></pre>\n\n<p>to convert into add as key entry static </p>\n\n<pre><code>[\n[\"new\",37],\n[\"old\",3],\n[\"boarding\",1]\n[\"aws\",0]\n[\"azure\",1457]\n] \n</code></pre>\n"}, {"tags": ["ruby", "gemfile"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530124550, "post_id": 51069320, "comment_id": 89128637, "body": "What is the result of <code>ruby -v</code>? <code>2.3.3</code>, by any chance? How are you managing the ruby version? <code>rbenv</code>? <code>rvm</code>? Something else? You need to switch to ruby version <code>2.5.1</code>."}, {"owner": {"reputation": 11, "user_id": 8657391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d6797f57c51be40bd531061d593be9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian C.", "link": "https://stackoverflow.com/users/8657391/brian-c"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530124646, "post_id": 51069320, "comment_id": 89128681, "body": "C:\\RubyDevKit\\projects\\skit_interchange&gt;ruby -v ruby 2.5.1p57 (2018-03-29 revision 63029) [x64-mingw32]"}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1530126947, "post_id": 51069320, "comment_id": 89129773, "body": "First of all, how did you upgrade the ruby? Did you run system wide update on gems? Were maybe some files left behind?  If it is not too much of a hassle for you, I would completely reinstall ruby and make sure all the files are gone."}, {"owner": {"reputation": 11, "user_id": 8657391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d6797f57c51be40bd531061d593be9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian C.", "link": "https://stackoverflow.com/users/8657391/brian-c"}, "edited": false, "score": 0, "creation_date": 1530127218, "post_id": 51069320, "comment_id": 89129911, "body": "I updated ruby via <a href=\"https://rubyinstaller.org/downloads/\" rel=\"nofollow noreferrer\">rubyinstaller.org/downloads</a>"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1530130207, "post_id": 51069320, "comment_id": 89131130, "body": "Have you uninstalled the prior version?"}, {"owner": {"reputation": 11, "user_id": 8657391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d6797f57c51be40bd531061d593be9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian C.", "link": "https://stackoverflow.com/users/8657391/brian-c"}, "edited": false, "score": 0, "creation_date": 1530132325, "post_id": 51069320, "comment_id": 89132065, "body": "Yes; then it stopped running Ruby altogether. I&#39;ts all over the floor at this point. I&#39;m uninstalling everything and starting from scratch...."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530182922, "post_id": 51069320, "comment_id": 89150223, "body": "Is there any way I can reproduce your problem? It sounds like your local environment got messed up, but I have no idea how. The fact that <code>ruby -v</code> returns <code>2.5.1</code>, yet <code>bundle</code> thinks you&#39;re running <code>2.3.3</code>, should never happen. Possibly your <code>$PATH</code> was messed up, and pointing to the wrong ruby folder? (Side note: Your question also mentions ruby <code>2.3.4</code>, but I presume that&#39;s a typo.)"}], "owner": {"reputation": 11, "user_id": 8657391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d6797f57c51be40bd531061d593be9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian C.", "link": "https://stackoverflow.com/users/8657391/brian-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1573, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1530127079, "creation_date": 1530124164, "last_edit_date": 1530127079, "question_id": 51069320, "link": "https://stackoverflow.com/questions/51069320/your-ruby-version-is-2-3-3-but-your-gemfile-specified-2-5-1", "title": "Your Ruby version is 2.3.3, but your Gemfile specified 2.5.1", "body": "<p>I\u2019ve upgraded my Ruby version from 2.3.4 to 2.5.1 and now I get an error message when I attempt to bundle install or rails generate my project:</p>\n\n<p>Your Ruby version is 2.3.3, but your Gemfile specified 2.5.1</p>\n\n<p>version info is:</p>\n\n<pre><code>C:\\RubyDevKit\\projects\\skit_interchange&gt;ruby -v\nruby 2.5.1p57 (2018-03-29 revision 63029) [x64-mingw32]\n</code></pre>\n\n<p>I updated Ruby to 2.5.1 because Heroku indicated that my current installed version was no longer supported.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "sql-server", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 0, "creation_date": 1530126469, "post_id": 51069241, "comment_id": 89129537, "body": "These mixed case symbol names are ver unconventional. I would certainly try to avoid using them."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530133632, "post_id": 51069241, "comment_id": 89132614, "body": "You know that the sql server adapter can downcase the fields for you using <code>lowercase_schema_reflection</code>"}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1530144608, "post_id": 51069241, "comment_id": 89135616, "body": "I&#39;ll look into <code>lowercase_schema_reflection</code>.  I did not know about that."}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "edited": false, "score": 0, "creation_date": 1530144671, "post_id": 51069241, "comment_id": 89135630, "body": "David - I&#39;d love to avoid using unconventional symbol names.  If you can tell me how I can interface with this database without changing the schema while using ActiveRecord conventions, I&#39;m all ears."}, {"owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530200365, "post_id": 51069241, "comment_id": 89162074, "body": "@engineersmnky - I can&#39;t tell that <code>lowercase_schema_reflection</code> is doing anything different.  It certainly doesn&#39;t change the case of the GUIDs (which I need to be lowercase for the XML file that I&#39;m generating), and it doesn&#39;t seem to help with the case of the column names, either."}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "is_accepted": true, "score": 0, "last_activity_date": 1530298316, "creation_date": 1530298316, "answer_id": 51107825, "question_id": 51069241, "link": "https://stackoverflow.com/questions/51069241/ruby-activerecord-association-generates-error-when-accessing-child/51107825#51107825", "title": "Ruby ActiveRecord association generates error when accessing child", "body": "<p><b>What I learned:</b></p>\n\n<ul>\n<li>It is generally a bad idea to subclass <code>ActiveRecord::Base</code> unless you really know what you're doing, and I didn't.  The best way to share code among classes in your model is to use a module.  Subclassing <code>ActiveRecord::Base</code> can have unintended side effects, and unless I am very mistaken, it does not enable you to share callback code, anyway.</li>\n<li>As far as I can tell, these options have no effect with version 5.1.6 of the activerecord-sqlserver-adapter gem, contrary to the docs:<br/><br/>\n<code>ActiveRecord::ConnectionAdapters::SQLServerAdapter.lowercase_schema_reflection = true</code>\n<code>ActiveRecord::Base.table_name_prefix = prefix</code><br/>\n<br/>\nI resolved both of these by setting self.table_name in the module's <code>included</code> block. Maybe I'm doing something wrong, but I could not get either of these options to work, and in fact couldn't tell a difference in the generated SQL.  As a result, I still have to deal with CamelCase column names.</li>\n<li>MSSQL's <code>uniqueidentifier</code> columns are case insensitive.  The app I'm writing this code for uses the lowercase variant with every GUID, so I was under the impression that I had to mimic this behavior, but the database does\nn't care.  I spent much time trying to get <code>ActiveRecord</code> to automatically <code>downcase</code> these fields, and I kind of got it to work, but it didn't have good results.  See the next item.</li>\n<li>If you try to alter the value of your primary key through <code>after_init</code>, <code>after_find</code>, etc., it will break associations.  In my case, I was trying\nto change the primary key from a <code>uniqueidentifier</code> datatype, to a string\nversion with <code>downcase</code>d hex values.  This is what produced the original\nerror that caused me to create this post.</li>\n</ul>\n\n<p><b>The code:</b></p>\n\n<blockquote>\n<i>Note:</i> The <code>ActiveSupport::Inflector</code> section is needed to make sure things that don't need to be pluralized are not pluralized.  For more information see the <code>ActiveSupport::Inflector</code> docs.\n</blockquote>\n\n<pre><code>ActiveSupport::Inflector.inflections(:en) do |inflect|\n  inflect.irregular 'index', 'index'\n  inflect.irregular 'layoutml', 'layoutml'\n  inflect.acronym 'ML'\nend\n\nmodule AppRecord\n  extend ActiveSupport::Concern\n\n  included do\n    self.primary_key = 'IRN'\n    self.table_name = \"app.#{self.to_s.pluralize}\"\n  end\n\n  def to_h\n    self.attributes.to_options\n  end\nend\n\nclass ReportIndex &lt; ActiveRecord::Base\n  include AppRecord\n  has_many :report_index_parameters, foreign_key: \"ReportIndexIRN\", dependent: :destroy\n  has_many :report_properties, foreign_key: \"ReportIndexIRN\", dependent: :destroy\n  has_many :report_layouts, foreign_key: \"ReportIndexIRN\", dependent: :destroy\n\n  has_many :report_index_series, foreign_key: \"ReportIndexesIRN\", dependent: :destroy\n  has_many :report_user_defined_views, foreign_key: \"ClassId\", primary_key: \"BaseClassID\"\n\n  has_many :report_index_param_series_filters, through: :report_index_series\n  has_many :report_property_series_filters, through: :report_index_series\n  has_many :report_layout_images, through: :report_layouts\n  has_many :report_layout_ml, through: :report_layouts\n  has_many :report_property_parameters, through: :report_properties\nend\n\nclass ReportProperty &lt; ActiveRecord::Base\n  include AppRecord\n  has_many :report_property_series_filters, foreign_key: \"ReportPropertiesIRN\", dependent: :destroy\n  has_many :report_property_parameters, foreign_key: \"ReportPropertiesIRN\", dependent: :destroy\nend\n</code></pre>\n\n<p><b>Unresolved questions:</b></p>\n\n<ul>\n<li>Is there a way to change the scheme <code>ActiveRecord</code> uses to guess foreign keys?  The foreign keys in this app do not match the <code>\"#{class.to_s.underscore}_id\"</code> convention, but rather the <code>\"#{class.to_s}IRN\"</code> convention.  How do I DRY my code out and keep from naming every regular foreign key in my associations?</li>\n<li>Is there a way to declare that ALL of my has_many associations should have <code>dependent: :destroy</code> set?  Again, this would help me DRY out my code.</li>\n</ul>\n\n<p>Thanks to everyone who has commented so far.</p>\n"}], "owner": {"reputation": 453, "user_id": 3758236, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7cbd90a499898df1d5880494bdcb58ca?s=128&d=identicon&r=PG&f=1", "display_name": "ArkieCoder", "link": "https://stackoverflow.com/users/3758236/arkiecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 51107825, "answer_count": 1, "score": 2, "last_activity_date": 1530298316, "creation_date": 1530123876, "last_edit_date": 1530193628, "question_id": 51069241, "link": "https://stackoverflow.com/questions/51069241/ruby-activerecord-association-generates-error-when-accessing-child", "title": "Ruby ActiveRecord association generates error when accessing child", "body": "<p><b>Introduction</b>: I'm creating a standalone (non-Rails) application that uses ActiveRecord and ActiveRecord SQL Server Adapter to access a database for a commercial application.  I'm unable to change the database schema or the database server, as much as I'd like to.  I've tried to change the names below to protect the guilty.</p>\n\n<p><b>The base model class:</b></p>\n\n<pre><code>class AppRecord &lt; ActiveRecord::Base\n  after_initialize :parent_init\n  attr_reader :_downcase_field_values\n  attr_accessor :downcase_field_values\n\n  self.primary_key = 'IRN'\n\n  def parent_init\n    set_downcase_field_values\n  end\n\n  def set_downcase_field_values\n    @downcase_field_values ||= []\n    @_downcase_field_values = self.attributes.keys.select { |att| att if (att.match(/IRN/) || att == \"Id\") }\n    downcase_fields! self\n  end\n\n  def self.table_name\n    \"app.#{self}\"\n  end\n\n  def to_h\n    self.attributes.to_options\n  end\nend\n</code></pre>\n\n<p><b>The model classes:</b></p>\n\n<pre><code>class ReportIndex &lt; AppRecord\n  after_find :init\n\n  has_many :ReportIndexParameters, class_name: \"ReportIndexParameters\", foreign_key: \"ReportIndexIRN\", dependent: :destroy\n  has_many :ReportProperties, class_name: \"ReportProperties\", foreign_key: \"ReportIndexIRN\", dependent: :destroy\n  has_many :ReportLayouts, class_name: \"ReportLayouts\", foreign_key: \"ReportIndexIRN\", dependent: :destroy\n\n  has_many :ReportIndexSeries, class_name: \"ReportIndexSeries\", foreign_key: \"ReportIndexesIRN\", dependent: :destroy\n  has_many :ReportUserDefinedViews, class_name: \"ReportUserDefinedViews\", foreign_key: \"BaseClassID\", primary_key: \"ClassId\"\n\n  def init\n    self.downcase_field_values = %w(BaseClassID)\n  end\nend\n\nclass ReportProperties &lt; AppRecord\n  belongs_to :ReportIndex\n  after_find :init\n  has_many :ReportPropertySeriesFilters, class_name: \"ReportPropertySeriesFilters\", foreign_key: \"ReportPropertiesIRN\", dependent: :destroy\n  has_many :ReportPropertyParameters, class_name: \"ReportPropertyParameters\", foreign_key: \"ReportPropertiesIRN\", dependent: :destroy\n  def init\n    self.downcase_field_values = %w(ClassID)\n  end\nend\n</code></pre>\n\n<p><b>The ActiveRecord query:</b></p>\n\n<p><code>pp ReportIndex.includes(:ReportProperties).find_by(ReportName: report_name)</code></p>\n\n<p><b>The error:</b></p>\n\n<pre><code>/usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:63:in `block in associated_records_by_owner': undefined method `association' for nil:NilClass (NoMethodError)\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/core.rb:367:in `init_with'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/persistence.rb:69:in `instantiate'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/querying.rb:50:in `block (2 levels) in find_by_sql'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/result.rb:55:in `block in each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/result.rb:55:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/result.rb:55:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/querying.rb:50:in `map'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/querying.rb:50:in `block in find_by_sql'\n    from /usr/local/bundle/gems/activesupport-5.1.6/lib/active_support/notifications/instrumenter.rb:21:in `instrument'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/querying.rb:49:in `find_by_sql'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:678:in `exec_queries'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:546:in `load'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:122:in `block in load_records'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:121:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:121:in `each_slice'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:121:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:121:in `flat_map'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:121:in `load_records'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:61:in `associated_records_by_owner'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/collection_association.rb:8:in `preload'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader/association.rb:19:in `run'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:151:in `block (2 levels) in preloaders_for_one'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:149:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:149:in `map'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:149:in `block in preloaders_for_one'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:148:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:148:in `flat_map'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:148:in `preloaders_for_one'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:115:in `preloaders_on'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:102:in `block in preload'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:101:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:101:in `flat_map'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/associations/preloader.rb:101:in `preload'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:686:in `block in exec_queries'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:684:in `each'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:684:in `exec_queries'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:546:in `load'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation.rb:255:in `records'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation/finder_methods.rb:508:in `find_take'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation/finder_methods.rb:100:in `take'\n    from /usr/local/bundle/gems/activerecord-5.1.6/lib/active_record/relation/finder_methods.rb:78:in `find_by'\n    from /src/artest.rb:13:in `&lt;main&gt;'\n</code></pre>\n\n<p><b>However, the SQL generated by ActiveRecord seems to be correct:</b></p>\n\n<pre><code>D, [2018-06-27T17:42:49.256232 #1] DEBUG -- :   SQL (33.3ms)  USE [APP]\nD, [2018-06-27T17:42:50.017505 #1] DEBUG -- :   ReportIndex Load (40.5ms)  EXEC sp_executesql N'SELECT  [app].[ReportIndex].* FROM [app].[ReportIndex] WHERE [app].[ReportIndex].[ReportName] = @0  ORDER BY [app].[ReportIndex].[IRN] ASC OFFSET 0 ROWS FETCH NEXT @1 ROWS ONLY', N'@0 nvarchar(80), @1 int', @0 = N'Master Condemnation', @1 = 1  [[\"ReportName\", nil], [\"LIMIT\", nil]]\nD, [2018-06-27T17:42:51.043389 #1] DEBUG -- :   ReportProperties Load (133.9ms)  SELECT [app].[ReportProperties].* FROM [app].[ReportProperties] WHERE [app].[ReportProperties].[ReportIndexIRN] = '3cad6165-221e-4607-b5ad-01bc32f29157'\n</code></pre>\n\n<p>I suspect that these irregularities stem from something I've managed to get wrong architecturally.  The existing model code works fine for <code>DELETE</code> and <code>UPDATE</code> operations but not for <code>SELECT</code>s.  I welcome the hive mind to give me its two cents.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1530129353, "post_id": 51068983, "comment_id": 89130777, "body": "i have added then funding and child model as i have in my app. kindly have a look."}], "tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": false, "score": 0, "last_activity_date": 1530122889, "creation_date": 1530122889, "answer_id": 51068983, "question_id": 51068687, "link": "https://stackoverflow.com/questions/51068687/how-to-auto-update-fields-in-rails/51068983#51068983", "title": "How to auto Update fields in rails", "body": "<p>I believe in your case AR <code>before_save</code> callback could be helpful. </p>\n\n<pre><code>class Funding &lt; ApplicationRecord\n  has_one :child\n  before_save do\n    if status_changed? &amp;&amp; status == 'Approved'\n      amount_remaining = child.amount_remaining - amount_requested\n      child.update_attributes(amount_remaining: amount_remaining)\n    end\n  end\n  ...\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530129120, "creation_date": 1530121547, "last_edit_date": 1530129120, "question_id": 51068687, "link": "https://stackoverflow.com/questions/51068687/how-to-auto-update-fields-in-rails", "title": "How to auto Update fields in rails", "body": "<p>I have a general settings table, parents table, children table and fundings table. Children table has funding_id. each child can have multiple funding applications. In the funding table there is a field status which can be changed only by admin. Once the admin approves the application, I want the amount requested to be subtracted from the amount_remaining field in the children table.The default amount_remaining is the amount_current_year in the general settings. How can I achieve this. Kindly help me. </p>\n\n<p>Funding table schema</p>\n\n<pre><code> create_table \"fundings\", force: :cascade do |t|\n    t.string \"type_of_activity\"\n    t.string \"season\"\n    t.text \"activity_details\"\n    t.string \"name_of_organisation\"\n    t.date \"activity_start_date\"\n    t.string \"number_of_weeks\"\n    t.string \"days_per_week\"\n    t.string \"hours_per_day\"\n    t.integer \"program_registration_cost\"\n    t.string \"family_contribution\"\n    t.integer \"other_funds\"\n    t.string \"other_fund_provider\"\n    t.integer \"amount_requested\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"child_id\"\n    t.string \"status\"\n    t.date \"date_submitted\"\n  end\n</code></pre>\n\n<p>General setting scheme</p>\n\n<pre><code>  create_table \"generalsettings\", force: :cascade do |t|\n    t.integer \"amount_current_year\"\n    t.integer \"amount_next_year\"\n    t.date \"current_year\"\n    t.date \"next_year\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n  end\n</code></pre>\n\n<p>Children table schema</p>\n\n<pre><code>create_table \"children\", force: :cascade do |t|\n    t.string \"firstname\"\n    t.string \"lastname\"\n    t.date \"dateofbirth\"\n    t.string \"gender\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.integer \"parent_id\"\n    t.integer \"amount_remaining\"\n  end\n</code></pre>\n\n<p>_form.html.erb (funding application form)</p>\n\n<pre><code>&lt;div class='row'&gt;\n  &lt;div class= 'col-xs-12'&gt;\n    &lt;%= form_for([@parent, @child, @funding], :html =&gt; {class: \"form-horizontal\",role: \"form\"}) do |form| %&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :type_of_activity, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.select :type_of_activity, ['Swimming', 'Soccer', 'Cricket', 'Basket Ball'], required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :activity_details, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.text_area :activity_details, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :name_of_organisation, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.select :name_of_organisation, ['BCCI', 'IPL', 'Sahara', 'Not listed'], class: \"form-control\", autofocus:true, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :activity_start_date, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.date_field :activity_start_date, min: Date.today, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :program_registration_cost, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.text_field :program_registration_cost, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :amount_requested, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.text_field :amount_requested, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt; \n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :date_submitted, class: \"required\" %&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.date_field :date_submitted, value: Date.today, readonly:true, required: true %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class = \"form-group\"&gt;\n        &lt;div class=\"control-label col-sm-2\"&gt;\n          &lt;%= form.label :status %&gt;\n        &lt;/div&gt;\n\n      &lt;% if current_user.admin? %&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.select :status,['Pending', 'Approved', 'Declined'], class: \"form-control\" %&gt;\n        &lt;/div&gt;\n      &lt;% else %&gt;\n        &lt;div class=\"col-sm-8\"&gt;\n          &lt;%= form.select :status,['Pending', 'Approved', 'Declined'], {class: \"form-control\"}, {:disabled =&gt; true} %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n\n      &lt;/div&gt; \n      &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"col-sm-10\"&gt;\n          &lt;%= form.submit \"Apply\", class: 'btn btn-primary btn-lg' %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>funding.rb </p>\n\n<pre><code>class Funding &lt; ApplicationRecord\nbelongs_to :child\nend\n</code></pre>\n\n<p>child.rb</p>\n\n<pre><code>class Child &lt; ApplicationRecord\n    belongs_to :parent\n    has_many :fundings, dependent: :destroy\nend\n</code></pre>\n"}, {"tags": ["ruby", "cucumber", "gherkin"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 2, "creation_date": 1530120212, "post_id": 51068276, "comment_id": 89126513, "body": "Automated tests are supposed to be automated. Not pausing for manual input. Why can&#39;t you store that data somewhere?? You don&#39;t need to put credentials in the source code; you can use an <code>ENV</code> variable or a &quot;secrets&quot; (i.e. either an encrypted, or not-in-source-control) file."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530120355, "post_id": 51068276, "comment_id": 89126584, "body": "Or as an absolute last resort, why not fetch that data at the <b>start of the suite</b> instead of buried inside a specific feature? As the test suite grows, you could easily find yourself re-entering credentials multiple times, over a longer and longer period."}, {"owner": {"reputation": 2514, "user_id": 6004650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/668db278c31bc9040a9dea1b77b4ddd4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeJRamsey56", "link": "https://stackoverflow.com/users/6004650/mikejramsey56"}, "edited": false, "score": 0, "creation_date": 1530121018, "post_id": 51068276, "comment_id": 89126925, "body": "As Tom said, you are defeating the point of an automated test.  This is what property files are typically used to do. See, for example <a href=\"https://stackoverflow.com/questions/36936970/how-to-load-a-value-from-properties-file-in-cucumber-jvm-step-class\">How to load a value from   properties file in Cucumber-jvm step class</a>."}, {"owner": {"reputation": 69, "user_id": 6029849, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/qTPSR.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/6029849/peter"}, "edited": false, "score": 0, "creation_date": 1530178613, "post_id": 51068276, "comment_id": 89147533, "body": "Can&#39;t store the data because the authorisation code is generated via a third party, is unique to the user and the time they log on. It changes every minute or so. When a user logs on to the GUI they input username and password, then are prompted for the auth code. Once past the log-in, it&#39;s a regular GUI."}, {"owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "edited": false, "score": 0, "creation_date": 1530612796, "post_id": 51068276, "comment_id": 89287313, "body": "Peter, add the above to your question and you will have a better question. Then we can suggest ways to get around this issue"}], "answers": [{"tags": [], "owner": {"reputation": 3257, "user_id": 4341733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1793f226cb3189da8bc9c6264d72b7?s=128&d=identicon&r=PG", "display_name": "diabolist", "link": "https://stackoverflow.com/users/4341733/diabolist"}, "is_accepted": false, "score": 0, "last_activity_date": 1530613295, "creation_date": 1530613295, "answer_id": 51152157, "question_id": 51068276, "link": "https://stackoverflow.com/questions/51068276/how-do-i-get-user-input-for-gherkin-cucumber-ruby/51152157#51152157", "title": "How do I get user input for Gherkin/Cucumber &amp; Ruby?", "body": "<p>You have a number of options when dealing with external services in test automation. In this particular case you can</p>\n\n<ol>\n<li>Change your source so the authentication behaves differently when testing</li>\n</ol>\n\n<p>OR</p>\n\n<ol start=\"2\">\n<li>Record a response from the external service and use that response instead of going to the external service (see <a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\">https://github.com/vcr/vcr</a>). As the response is recorded you will know the authorisation code</li>\n</ol>\n\n<p>OR</p>\n\n<ol start=\"3\">\n<li>Use a test version of the external service which gives back know responses</li>\n</ol>\n\n<p>I suspect there are a number of other solutions, but all three of the above are used widely and work fine. </p>\n\n<p>There is certainly no need to have manual interactions to test your system unless you are running your tests against a production system (which is a very bad idea!).</p>\n"}], "owner": {"reputation": 69, "user_id": 6029849, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/qTPSR.jpg?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/6029849/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530613295, "creation_date": 1530119866, "question_id": 51068276, "link": "https://stackoverflow.com/questions/51068276/how-do-i-get-user-input-for-gherkin-cucumber-ruby", "title": "How do I get user input for Gherkin/Cucumber &amp; Ruby?", "body": "<p>I need to be able to prompt for user input (username, password and authorisation code) so my tests can access a GUI. These details cannot be stored as test data, so they'll have to be input part way through a test.</p>\n\n<p>I've tried the following, but it's not working how I want:</p>\n\n<p>Feature file:</p>\n\n<pre><code>Feature: user input as part of a test\n\n  Scenario: user input at the start\n  Given the test requires a name\n</code></pre>\n\n<p>Step definition:</p>\n\n<pre><code>Given(/^the test requires a name$/) do\n  get_a_name\nend\n</code></pre>\n\n<p>Method:</p>\n\n<pre><code>def get_a_name\n  puts \"Gimme a name\"\n  @input_name = gets.chomp\n  puts \"Hello #{@input_name}\"\nend\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Gimme a name\n\nHello Feature: user input as part of a test\n</code></pre>\n\n<p>Any help would be much appreciated. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530118984, "post_id": 51068034, "comment_id": 89125933, "body": "Thansk @7urm3n but i know code but not how to use in rails ?"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530119104, "post_id": 51068034, "comment_id": 89126004, "body": "@Sdadad updating my post 2min."}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530120170, "post_id": 51068034, "comment_id": 89126494, "body": "when write <code>class GdirectionsController &lt; ApplicationController   def index   \trdb = RestdbApi.new \t@x= rdb.call   \t   end end </code> appear this error uninitialized constant GdirectionsController::RestdbApi"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530122271, "post_id": 51068034, "comment_id": 89127528, "body": "updated post added <code>config.eager_load_paths</code>, make sure restart server also"}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530122962, "post_id": 51068034, "comment_id": 89127864, "body": "<code>config.eager_load_paths</code> added to <code>application.rb</code> in config and restart server but error is retain"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530123005, "post_id": 51068034, "comment_id": 89127880, "body": "did u add like this ? <code>config.eager_load_paths &lt;&lt; Rails.root.join(&#39;app&#47;services&#39;)</code>, cuz i just tested on mine it works properly"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "reply_to_user": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "edited": false, "score": 0, "creation_date": 1530123243, "post_id": 51068034, "comment_id": 89128003, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173908/discussion-between-7urkm3n-and-sdadad\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1530168658, "last_edit_date": 1530168658, "creation_date": 1530118870, "answer_id": 51068034, "question_id": 51067983, "link": "https://stackoverflow.com/questions/51067983/how-to-use-rest-client-to-display-specific-data-in-rails/51068034#51068034", "title": "how to use rest-client to display specific data in rails", "body": "<p>You can create service folder in the app folder nor can use lib folder, also make a task too. </p>\n\n<p>Make sure restart the server and url-address!</p>\n\n<pre><code>#|- app\n#|-- services\n#|--- restdb_api.rb\n\n\nrequire 'rest-client'\nrequire 'json'\n\nclass RestdbApi\n\n    def initialize\n      @url = 'https://xxxx.restdb.io/rest/data'\n      @headers = {\n        'content-type': \"application/json\",\n        'x-apikey': \"-------\",\n        'cache-control': \"no-cache\"\n      }\n    end    \n\n    def call\n        res = RestClient.get(@url, @headers)\n        body = JSON.parse(res, { symbolize_names: true })\n        body\n    end\nend\n\n# config/application.rb\n   config.eager_load_paths &lt;&lt; Rails.root.join('app/services')\n</code></pre>\n\n<p>And call it anywhere in the controller...</p>\n\n<pre><code>#if wanna dynamically call url, api key or smth else, just initialize in the class.\nrdb = RestdbApi.new\nbody = rdb.call\nputs body\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 51068034, "answer_count": 1, "score": 1, "last_activity_date": 1530168658, "creation_date": 1530118641, "last_edit_date": 1530123249, "question_id": 51067983, "link": "https://stackoverflow.com/questions/51067983/how-to-use-rest-client-to-display-specific-data-in-rails", "title": "how to use rest-client to display specific data in rails", "body": "<p>i connect with api to display specific data but not how to use this rails .\nnot know put code in <code>model</code> or <code>controller</code> </p>\n\n<p>need how to use this code to connect rails app </p>\n\n<pre><code>require 'rest-client'\nrequire 'json'\n\nurl = 'https://xxxx.restdb.io/rest/data'\n\nheaders = \n{\n    'content-type': \"application/json\",\n    'x-apikey': \"-------\",\n    'cache-control': \"no-cache\"\n}\nreq = RestClient.get(url, headers)\n\nwe = JSON.parse(req.body)\n\np we\n</code></pre>\n\n<p><code>config/application.rb</code> code after updated </p>\n\n<pre><code>require_relative 'boot'\n\nrequire 'rails/all'\n\n# Require the gems listed in Gemfile, including any gems\n# you've limited to :test, :development, or :production.\nBundler.require(*Rails.groups)\n\nmodule Version0\n  class Application &lt; Rails::Application\n    # Initialize configuration defaults for originally generated Rails version.\n    config.load_defaults 5.1\n    config.eager_load_paths &lt;&lt; Rails.root.join('app/services')\n    # Settings in config/environments/* take precedence over those specified here.\n    # Application configuration should go into files in config/initializers\n    # -- all .rb files in that directory are automatically loaded.\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530119603, "post_id": 51067686, "comment_id": 89126215, "body": "Often <code>git grep</code> works wonders. You can also mass-replace one with the other."}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530119899, "post_id": 51067686, "comment_id": 89126353, "body": "@tadman Let me clarify, I know how to replace the module names, but I&#39;m looking for advice on how best to warn other users of a gem that the old module name has changed."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530120286, "post_id": 51067686, "comment_id": 89126555, "body": "If this is a public gem <i>and</i> it depends on ActiveSupport, then the deprecation model is probably the way to go. Sometimes if you&#39;re doing a really aggressive overhaul and you&#39;re using semantic versioning you should just do a clean break."}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1530121331, "post_id": 51067686, "comment_id": 89127065, "body": "It is, hence why deprecation is desired in this instance.  Struggling to make this work - any code examples that you could point me towards, please?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1530146420, "post_id": 51067686, "comment_id": 89135951, "body": "As it stands, you are asking for a pure-Ruby solution (@engineersmnky&#39;s and mine, for example), which is fine, but if you wish to admit solutions that employ <code>ActiveSupport</code> you need to include a Rails tag. Note <code>Name::meth</code> references a module method (<code>meth</code>) whereas <code>Name#meth</code> references an instance method. You need to use the latter to be consistent with your example."}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1530174913, "post_id": 51067686, "comment_id": 89145159, "body": "@CarySwoveland Thanks for spotting the typo.  See my new response to matthewd&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "edited": false, "score": 0, "creation_date": 1530122754, "post_id": 51067743, "comment_id": 89127776, "body": "Thanks, but any code examples I could steal a look at, please?  Not finding this one easy to work out."}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "edited": false, "score": 0, "creation_date": 1530175353, "post_id": 51067743, "comment_id": 89145401, "body": "Ok, turns out the difficulty is in the gem itself, not in the deprecation process.  See my new answer below for code example."}], "tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 2, "last_activity_date": 1530117716, "creation_date": 1530117716, "answer_id": 51067743, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby/51067743#51067743", "title": "Deprecating an old module name in Ruby?", "body": "<p>ActiveSupport provides two ways of deprecating a constant: <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Deprecation/DeprecatedConstantAccessor.html\" rel=\"nofollow noreferrer\">DeprecatedConstantAccessor</a> and <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Deprecation/DeprecatedConstantProxy.html\" rel=\"nofollow noreferrer\">DeprecatedConstantProxy</a>. They each have trade-offs and limitations in when they show the warning (Accessor is when it's accessed; Proxy is when its methods are called) and how they generally behave. You'll probably want to try both to see which one feels right for your use case.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "edited": false, "score": 0, "creation_date": 1530122818, "post_id": 51068496, "comment_id": 89127805, "body": "Thanks but this seems a sledgehammer to crack a nut - anything more elegant that you could suggest, please?"}, {"owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "edited": false, "score": 0, "creation_date": 1530125236, "post_id": 51068496, "comment_id": 89128963, "body": "Incidentally, isn&#39;t it bad form to copy and paste another person&#39;s code without crediting them? <a href=\"https://gist.github.com/rafaelfranca/5492531\" rel=\"nofollow noreferrer\">gist.github.com/rafaelfranca/5492531</a>"}, {"owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "reply_to_user": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "edited": false, "score": 0, "creation_date": 1530126160, "post_id": 51068496, "comment_id": 89129408, "body": "@Kitebuggy check now I referred <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Deprecation/MethodWrapper.html\" rel=\"nofollow noreferrer\">api.rubyonrails.org/classes/ActiveSupport/Deprecation/&hellip;</a>  and made an example"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530141485, "post_id": 51068496, "comment_id": 89134960, "body": "As a note <code>Fred.new</code> and <code>Bar.new</code> are not valid. A Module does not allow for instantiation the class  <code>Module</code> can be instantiated but a <code>Module</code> cannot"}, {"owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530156290, "post_id": 51068496, "comment_id": 89137858, "body": "@engineersmnky changed."}], "tags": [], "owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1530162287, "last_edit_date": 1530162287, "creation_date": 1530120778, "answer_id": 51068496, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby/51068496#51068496", "title": "Deprecating an old module name in Ruby?", "body": "<p>Rails 4.1.8 Ruby 2.2.0p0</p>\n\n<pre><code>module Fred\n  extend self\n  def aaa; end\n  def bbb; end\n  def ccc; end\n  def ddd; end\n  def eee; end\nend\n\nmodule Bar\n  extend self\n  def ccc; end\nend\n\n\nActiveSupport::Deprecation.deprecate_methods(Fred, :aaa, bbb: :zzz, ccc: 'use Bar#ccc instead')\n\n\nFred.aaa\nDEPRECATION WARNING: aaa is deprecated and will be removed from Rails 4.2. (called from __pry__ at (pry):15)\n=&gt; nil\n</code></pre>\n\n<p>Same code tried in rails 5.2.0 but no <strong>DEPRECATION WARNING</strong>.</p>\n\n<p>Rails 5.2.0 Ruby 2.5.1p57</p>\n\n<pre><code>class Fred\n def aaa; end\n def bbb; end\n def ccc; end\n def ddd; end\n def eee; end\nend\n\nclass Bar\n def ccc; end\nend\n\nActiveSupport::Deprecation.deprecate_methods(Fred, :aaa, bbb: :zzz, ccc: 'use Bar#ccc instead')\n\n&gt; Fred.new.aaa\nDEPRECATION WARNING: aaa is deprecated and will be removed from Rails 6.0 (called from irb_binding at (irb):13)\n =&gt; nil \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1530133167, "last_edit_date": 1530133167, "creation_date": 1530132221, "answer_id": 51071121, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby/51071121#51071121", "title": "Deprecating an old module name in Ruby?", "body": "<p>You could go with something like: </p>\n\n<pre><code>module Bar\n  def self.aaa\n    'Bar::aaa'\n  end\n\n  def baz\n    'Bar#baz'\n  end\nend \n\nmodule Foo\n  {included: :include,extended: :extend,prepended: :prepend}.each do |mod_method, called_method| \n    singleton_class.define_method(mod_method) do |base|\n      warn \"Foo is deprecated please use Bar instead\"\n      base.send(called_method,Bar) \n    end\n  end\n  def self.method_missing(meth,*args,&amp;block)\n    warn \"Foo is deprecated please use Bar instead\"\n    Bar.respond_to?(meth) ? Bar.send(meth,*args,&amp;block) : super\n  end\nend\n\nclass A \n  include Foo # this will throw a warning\nend\n</code></pre>\n\n<p>Then </p>\n\n<pre><code>Foo.aaa\n# Foo is deprecated please use Bar instead\n#=&gt; 'Bar::aaa'\n\nA.new.baz  \n#=&gt; 'Bar#baz'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "edited": false, "score": 0, "creation_date": 1530156754, "post_id": 51073138, "comment_id": 89137958, "body": "@praaveen, no harm, no foul, but by clicking on &quot;edited&quot; I see no bread crumbs left by your misadventure."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1530153051, "last_edit_date": 1530153051, "creation_date": 1530145884, "answer_id": 51073138, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby/51073138#51073138", "title": "Deprecating an old module name in Ruby?", "body": "<pre><code>module OldName\n  def instance_method(*args)\n    yield(args)\n  end\n\n  instance_methods.each do |im|\n    alias_name = \"_#{im.to_s}\"\n    alias_method alias_name, im\n    define_method(im) do |*args, &amp;block|\n      warn \"Foo is deprecated please use Bar instead\"\n      public_send(alias_name, *args, &amp;block)\n    end\n  end\nend\n\nclass C\n  include OldName\nend\n\nC.instance_methods &amp;&amp; [:im, :_im]\n  #=&gt; [:im, :_im]\n\nc = C.new\nc._instance_method(2,3) { |a,b| a+b }\n  #=&gt; 5\nc.instance_method(2,3) { |a,b| a+b }\n  # Foo is deprecated please use Bar instead\n  #=&gt; 5\n</code></pre>\n\n<p>Alternatively, <code>public_send(alias_name, *args, &amp;block)</code> can be replaced with <code>method(alias_name).call(*args, &amp;block)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "is_accepted": false, "score": 0, "last_activity_date": 1530176285, "creation_date": 1530176285, "answer_id": 51078687, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby/51078687#51078687", "title": "Deprecating an old module name in Ruby?", "body": "<p>I was sideswiped by a bug in the gem I was patching, which caused a few false starts, but the final answer is extremely simple and I include the working code as an example for others:</p>\n\n<pre><code>require 'active_support'\n\nOldName = ActiveSupport::Deprecation::DeprecatedConstantProxy.new('OldName', 'NewName')\n\nmodule NewName\n  def self.method1\n    puts 'Hello World!'\n  end\nend\n\n\nNewName.method1\n  #=&gt; Hello World!\n\nOldName.method1\n  #=&gt; DEPRECATION WARNING: OldName is deprecated! Use NewName instead. (called from ..)\n  #=&gt; Hello World!\n</code></pre>\n\n<p>Simples!</p>\n\n<p>My thanks to @matthewd for re-pointing me in the right direction.</p>\n"}], "owner": {"reputation": 61, "user_id": 3149786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac19af15a812022daf57059b90aba8ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kitebuggy", "link": "https://stackoverflow.com/users/3149786/kitebuggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1530176285, "creation_date": 1530117495, "last_edit_date": 1530174849, "question_id": 51067686, "link": "https://stackoverflow.com/questions/51067686/deprecating-an-old-module-name-in-ruby", "title": "Deprecating an old module name in Ruby?", "body": "<p>How would I best go about renaming a Ruby Module in a backwards compatible manner?  I have ActiveSupport, so can call deprecation warnings this way, but in this case I'm deprecating the old module name and not the method names.</p>\n\n<p>Example follows:</p>\n\n<pre><code>module OldName\n  def self.method1\n    ...\n  end\nend\n</code></pre>\n\n<p>Will become:</p>\n\n<pre><code>module NewName\n  def self.method1\n    ...\n  end\nend\n</code></pre>\n\n<p>I want to generate warnings directing the developer to using <code>NewName::method1</code> rather than <code>OldName::method1</code></p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "actionmailer"], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 7974208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Y3GJNTwk_es/AAAAAAAAAAI/AAAAAAAAARg/J0AdlD1l2RY/photo.jpg?sz=128", "display_name": "Abdul Wahed", "link": "https://stackoverflow.com/users/7974208/abdul-wahed"}, "is_accepted": false, "score": 1, "last_activity_date": 1530888306, "last_edit_date": 1530888306, "creation_date": 1530797117, "answer_id": 51192522, "question_id": 51067078, "link": "https://stackoverflow.com/questions/51067078/actionmailer-create-new-mail-with-attachments-from-original-rfc822-message/51192522#51192522", "title": "ActionMailer - Create new mail with attachments from original RFC822 message", "body": "<p>The following snippet might help you</p>\n\n<pre><code>options[:attachments].each do |attachment| \n   attachments[attachment.original_filename] = File.read(attachment.tempfile)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 3767926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tQIXK.jpg?s=128&g=1", "display_name": "justinsmorgan", "link": "https://stackoverflow.com/users/3767926/justinsmorgan"}, "is_accepted": false, "score": 0, "last_activity_date": 1530891246, "creation_date": 1530891246, "answer_id": 51213657, "question_id": 51067078, "link": "https://stackoverflow.com/questions/51067078/actionmailer-create-new-mail-with-attachments-from-original-rfc822-message/51213657#51213657", "title": "ActionMailer - Create new mail with attachments from original RFC822 message", "body": "<p>You can use something like this to handle inline attachments</p>\n\n<pre><code> context \"Inline Attachments\" do\nit \"accepts an inline attachment\" do\n  test_email = Mailer.test_email inline_attachments: 1\n  @delivery_method.deliver!(test_email)\n\n  images = @delivery_method.data[:content][:inline_images]\n  expect(images.length).to eq(1)\n  image = images[0]\n  expect(image).to include(:name, :type=&gt;\"image/png; filename=image_0.png\", :data=&gt;\"iVBORw0KGgoAAAANSUhEUgAAAfIAAACCCAMAAACKGrqXAAAAY1BMVEX////6ZCNVVVr6ZCP6ZCNVVVr6ZCNVVVr6ZCP6ZCNVVVpVVVr6ZCNVVVpVVVr6ZCNVVVpVVVr6ZCNVVVpVVVpVVVpVVVr6ZCP6ZCNVVVr6ZCP6ZCP6ZCP6ZCNVVVpVVVr6ZCO+CfRXAAAAH3RSTlMAgMBAEPBgoDAg4NBwkIDAUBDwQLBgMOCgIFCQ0LBwPgQxPgAADDFJREFUeF7s2kGLnEAYhOFqbERhSROHZFzXWer//8rAJo172jklhK73OXsrKItP9Q/hmBQGZ1EWLD6roqB4W5QEdbNnJUFxWOaoTssce1rmOGznbTia3VtVDJy27aYYePjDi1KgOLPaidy7whC5V4Uh8l1hiNxVEdDcvSgCTnenIsCXVQEw+TIrBOstarPjtKNe5lj9mbLQ6/ak4eEeFjkOf+ai0aGFRY7JYZGjhUWOyWGRo4VFjsNhkeMeFjmKsyLHurnLuL7h4dTI2W4Zv8Wg3t1drHHhzV3iLxLc3bqmLNS6i6JQ6/asKNS6vSgKtW5raNQ6641a95uGRa2z3qj1rPXGbb3TiFA3+9l6WzQQPOwn662ehyJQ6z7+JO6qBNR6/1jefNc4sNtP1luJuMhwhLnW2+qIyDnCXOutBUTOEaYrvQY2DQKLvzT1d72rxoD2NPLqD4eGgNlfux7ZNTQurd11mts0NLZbJ2nz/9Hs328/vv32fnvV3/N6u/zUaH61d4bLjatIFLZJCL4owsKScEgm8n3/p9zazexi6yC6Wz2pqbo752diLBUfNN3QtP/6m9LdZ85tHkv40jB+B4fUd7cHmVB/Tm+2FQJnrPjbnYjPz6apPsyJ17RGx61fn/FcF5Yxynw3RP5OX1QanX/A4d0Q18iMSI8dFRd/q8i6CnVza8u7oU1xeGgQ2sjDjda0ZLppjfjtUV3kPrfrk2DfDRMkjlQx17nKY4VjvIn00Hi22wDnCMhJ+VAaUWPGKpAXTaMc+bwe4EnyXL9E7iTHNKi39n3EwW/hMOMvQR7bEO0CxGjZ7cmbVw1mDfIik4TI0xpiEj7XLsJJXmb2uXVvJbryCPMfPUDPeuTJkgN6BOS0uoKAMKc65EVBhDxbGHrQ2IW1jDEWuh8mOaHLc0GOv5oWu5+47xbvOPYdLoU5VOTKi6+UgXhLfQTkpGx9+kZ43qhDXuQigRw7tqiH5269WRx6X9YCnOS0Pq6rHXckbmFBzcHiSEONZJdmK5izNHLaZC9ISosc/S8a+QQv0UCOGn+2tyNMcpFwmk9l9K4Vg8WRJkfeia2m4SMYqhEaKOuQIzgaeYDBQiAHjR30Pj3J6VuoS9O/if3XShtJ5Poe7eSGvT4ah8Zw0iO/LQzk6KxjHyJylMOmb3uQX2HZWxpEPXSrDHm0InY0ctI1m24o++uQ28xBniwMTS5yHDgBNt6kelk91hwaigZsgAj5Ipo8cuTwdpn4lBb5zRHIYaADWkBOzfOM9d1Q53PjfwWIZ2xIDgcNcg+7Sss4DsGt/m4Oe5H7FcG+2sCokRdlGnkHI24n8ugfff1r1T17ezn9NALvX6466PSwVzAdCGmQpxXw8sm8dGAta8h9uJPrkMDMWkgSE3l4VF95YCCROwjPJMixf30rdf38vori3loXURfoMgVyyq7j6EoOHG9EbiB2bK7mM2GOxbumcYEHUk0XeLYMOZrJtOm8nZ+wyV+faAgenpq+CTmaWQtea55gKBDIK7u3GXqopshEjooTPLDZdIDwTIM83BuWy5rka73RO+RQvN/37eGbkCM9txF82ihAjj75zDoHCHuRo6Eemk2ThfBMg3wsPQd2/cdpM2/mB+y6/xbkYaPLh4MMefSwUlZHw6NPwEVOR5qh1TR2EJ6pkB/uOuFjRbyRvvr8Bpa9dFD+VuTABhUPEuS4YJuNCM1HMAZ7kCNb12pqiPBMg/wKxPn3Uk/sp+qR0xNNjDxuhWn942R0+EVy5Bjsm0ZTB/GEFrn5Qg77MFcg3rTtr3euZf/dyIsWBfLG124Y4LwKERMbOYqLfCbCMxXyF5i2giLtnxD0fSfyohC/DTl0+LTeEnEK5B0PeYLwTI/c/g/5h7Bg52ttMSe22PXIAyb3aJGj+ayDGWHSxf3IPQt5tkR4plvLz2DWCZ0r9dkd+JR65NTOyDTHb5jlEKF5tPTL9xp2dNbjQY98LOuDuMjXU+VXGDLGEXrk9CGHWZIOuYdjMpj7C/7J70aeWEHaBOGZDnnxSOe193aV/4b98fGlgxI5hQ9lpzmzkdMONP41Vv427EXu0AvFpgHSNzTI8eTrSV688QWQFyR+/ibkszBXG5GTBKYaAEd8lwh52gi1A3Wqq0c+l/d+lVfye64coJb1x4esRi7Pg+qWKEee6kftFrDAkMty5LihZjeaorOuRx5tGT1HsOsiB+5cOzTolqRFTvFBWZeFyLOvnovO9dMuCxykyEcLMGnk00GLvHSFh/QI9hXiY71282Lvl9hlVCJH00QpRD5yJOBr5mQmzvL4yAfwRgYG8i6qkZcVbIQd1OOe2nB4eaHI9EMUItcx9yMbORLoy4sAWnDgFgq5eVRXTcOhkdukRV4MsEMj/bSnbhSZeLAkJfKiwZLQZ1ZWTG/sZl6S2zLgE/DSJULNrKZdVCMfffkmRC7335CLQ+pRgRyGK5+5EWYf4mROm0nOgxa5YTY1SuRpKmOHjRxFFG8ew6qzbYgq5EWjYTGXI7exAs4Qm6UK5DZzmzoF8rx0aC30yOsaF+fh7qMcOSo7S/elHPlQ4zo3mGYd8sRvOjOQLyMoBOOrWSVvO5CfmIFdHO6wm6hEjmtHXWYPcldzEW3rdL0XI+cOJkfcfpQ/16SNgOtV7r7RhR4T3n2UI0eVK62oJEfu5E1s3I/cplbT2MHHVcjNDDG2+MdyXgF5U7MBk6tDjjakPv+MmHiSTNTdyE17tOAd2y7uRu77JJ+xqDdWLI/lPjol8rp7AvJS5AtsunPkdyL3M0GtMvKmPci96efcWJcldTqvvONW3F0OauSo3MPCnkXIuwSrNU/jHuTdTFKDXSddIhTqIuZ3gpMYLnMb9chRMQALPnI/73a6pz3IF94hnLsp0h0lZyRiu37hc7H44nrk9Sz/hY18GiDyFijvQG6Zh3BdI6rTIn+FtCZB4c9PPpYZJoYYOfcqcmAh7+AEYL7J1De4lfh4Bc/wkEcLY0WBHMy0jOCRnTmFUa1VIXdD68uLAnnzdBgTmXlDy7IKvqS6aaeaJnTbtcirV42fOIU/5Q5fARAVyF3Di6GRG3p5uEk108jR4tvEQo42Z/plyF9lKa5nuJPGVI9Q5eflXWIgX/Yhd2LknoEc1+WOhxyLGvR65HguRkM8Qn4rV0GHfGzdWki0x24YDqZYIwM5pqUHHnJcaGYtcvTA6V3XF6gc8s3I0Sn3M7UK513Il5tcjoMcvzrxkEePbrseOd5KeyGIwyQXGfa8E3nsGldVosM0QjlyT6+baKUzAznO146HHF04G5XI6zXAjhRx+SQvAHR30oqmkmyTFw9TT4ocMyCY6ViBgxxNe08gh5cCtx2Qq35i4/N542MfX6gxil96ZpDWEchFnpUxLjjj8ehbjBwjOu6Sb1nI0bSPPOS4v+O0yOsFgi7v1SPTK1R3LAPf8bZi+n3IZ6kbLUeO2Yy84TdzkKOZ8pGHHAsOBhXyok+yPtDTeV1f5NFd7iKn8FgSIkcctGYxcgQZ2eF7t7PCds9EHjtw2+vI9b98ef043Tl4rz+gGlQx6xYrAaMcdLtklltZZU458og3E5h+xUhwI0w72RRduKRBXnS6/A26nD+O/9b58jfqhC/VRyoHfeQhRyXPTzgRIUcg0nx6x0KOpt1GHnJ04WxUIS/MxfVbi3K3KmUP6sGYSYM0JzHrcuReUovGQpxGI0fTPjGR44ZBFzXIi17kxBGIr0LPBt6UQo4aPJu4HPkguuvZoz9FI0d0AxM5xitOhbzo6SInjhdJLORaJQdjk4kcK/kTssNhH/IJDCffu7cUN9q0Y1PChQsK5Lie07qc2pbXTmEY4xfIufdgjZrINdBNPuxDnhuhL81u5iJH0y5cE4oGFfKi5zOH+I+NRIpkqJ+50Sc1x7mjU5rkyHtyI5suEYjcaNO+sO8po5eqRE5XZmelPo+O/J00fVZMCh2R0iRGHi1EeYQ8jBHkxjHtmYkcN6N81CEvOhET/do+SolLR/4AoD4RKg7hfp/Vbl1qnsOdGj5ZDvfivMRQaTGGexFPKi2ZTZeATe8a54NCL9fGKn7k8Hi4ytu5GXBsdkbe86vDB63+6Pl42QLOz3tKXzjyHwC/TfqZfgXg/yj90dPb6kD1/Q+Af77e/0v98vny/zLB/+j0+vl5PP1uAP8CV/GqdTJ4tWwAAAAASUVORK5CYII=\")\n  expect(image[:name]).to match(/.*@.*/)\nend\n</code></pre>\n"}], "owner": {"reputation": 1166, "user_id": 7044625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/80daf516453640dcd23184fbf8b8df11?s=128&d=identicon&r=PG&f=1", "display_name": "felipeecst", "link": "https://stackoverflow.com/users/7044625/felipeecst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1530891246, "creation_date": 1530115187, "question_id": 51067078, "link": "https://stackoverflow.com/questions/51067078/actionmailer-create-new-mail-with-attachments-from-original-rfc822-message", "title": "ActionMailer - Create new mail with attachments from original RFC822 message", "body": "<p>I use an email delivery service to send emails (Sparkpost), and everytime one of these emails is replied, I receive a JSON that contains: the reply mail body as HTML (body_html), the reply mail body as text (body_text) and the original RFC822 (email_rfc822) for the reply message.</p>\n\n<p>After receiving this JSON, I need to forward this email to another recipient. Currently, I use the following mailer to achieve that:</p>\n\n<pre><code>class ReplyMailer &lt; ApplicationMailer\n  def reply(body_html, body_text, options = {})\n    mail(to: options[:to], from: options[:from], reply_to: options[:reply_to], subject: options[:subject], skip_premailer: true) do |format|\n      format.html { render html: body_html.html_safe } if body_html.present?\n      format.text { render plain: body_text } if body_text.present?\n    end\n  end\nend \n</code></pre>\n\n<p>The problem with this approach is that it does not forward the attachments of the original message.</p>\n\n<p>How could change this mailer to also forward all the attachments from the original message (including inline images that are referenced on the html body)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "rubygems", "legacy"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530115982, "post_id": 51066899, "comment_id": 89124370, "body": "There is no magic method. Hopefully each project will have defined its dependency versions carefully, but this is not always the case. The latest version of <code>gibbon</code>, for example, does specify a dependency of <code>ruby &gt;= 2.0.0</code>; but before that, no version was specified. (So did it work on <code>1.9.x</code>, or <code>1.8.x</code>? No way of knowing. Try it, and see)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530116044, "post_id": 51066899, "comment_id": 89124403, "body": "<a href=\"https://github.com/amro/gibbon/commit/793c6994410dd082038df8dddd827919e8313d70\" rel=\"nofollow noreferrer\">This commit</a> added the <code>v2.0</code> constraint. Judging by that, I&#39;d suggest using Gibbon <code>v1.x</code>. You may find that later versions also work fine, but there&#39;s no guarantee."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530116152, "post_id": 51066899, "comment_id": 89124475, "body": "Of course, there&#39;s always the dreaded alternative suggestion which always comes to mind when questions like this pop up... <i>Why not push harder to upgrade the ruby/rails versions</i>? Depending on how much time you&#39;ll spend maintaining this, it may end up being more time-efficient to just upgrade/rewrite the whole thing."}, {"owner": {"reputation": 287, "user_id": 6303358, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/12db49057a225f57813bd64061e18933?s=128&d=identicon&r=PG&f=1", "display_name": "gemart", "link": "https://stackoverflow.com/users/6303358/gemart"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530122862, "post_id": 51066899, "comment_id": 89127823, "body": "Thanks @TomLord.. It does seem like an inefficient way of figuring it out, I was hoping there would be some sort of repository where I could put the dependencies I&#39;m constrained by."}, {"owner": {"reputation": 287, "user_id": 6303358, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/12db49057a225f57813bd64061e18933?s=128&d=identicon&r=PG&f=1", "display_name": "gemart", "link": "https://stackoverflow.com/users/6303358/gemart"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530122926, "post_id": 51066899, "comment_id": 89127847, "body": "I would push for the upgrade, but the project I&#39;m working on is going to soon be split up into microservices, which is going to take some time, but it&#39;s not worth the work of upgrading the current version for the time being"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530124397, "post_id": 51066899, "comment_id": 89128565, "body": "There <i>is</i> a place where you can put your dependencies: The <code>Gemfile</code>. If you write <code>ruby &#39;1.8.7&#39;</code>, then you&#39;ll be constrained by the ruby version. However, as I said, not all gems specify a minimum ruby version like this!"}, {"owner": {"reputation": 287, "user_id": 6303358, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/12db49057a225f57813bd64061e18933?s=128&d=identicon&r=PG&f=1", "display_name": "gemart", "link": "https://stackoverflow.com/users/6303358/gemart"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530127858, "post_id": 51066899, "comment_id": 89130160, "body": "Ah! So if I specify ruby version in my Gemfile, all of the other gems without a version specified are installed according to my ruby version constraint? @TomLord"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530129720, "post_id": 51066899, "comment_id": 89130940, "body": "Yes. But as I&#39;ve said twice, this isn&#39;t super reliable - especially for very old ruby versions. (Because many library authors never specified the ruby version constraint.)"}], "owner": {"reputation": 287, "user_id": 6303358, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/12db49057a225f57813bd64061e18933?s=128&d=identicon&r=PG&f=1", "display_name": "gemart", "link": "https://stackoverflow.com/users/6303358/gemart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530115128, "creation_date": 1530114572, "last_edit_date": 1530115128, "question_id": 51066899, "link": "https://stackoverflow.com/questions/51066899/finding-compatible-gem-versions-for-legacy-rails-app", "title": "Finding Compatible Gem Versions for Legacy Rails App", "body": "<p>I'm currently maintaining a legacy rails app version <code>3.0.7</code> and <code>ruby 1.8.7</code>. What's the best way to find what version of a specific gem is compatible with these ruby/rails versions? </p>\n\n<p>Specific use-case: I've been tasked with integrating the Mailchimp API, and I'm not sure what version of <code>mailchimp-api</code> or <code>gibbon</code> to use</p>\n"}, {"tags": ["ruby", "selenium-webdriver", "automated-tests", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1530126438, "post_id": 51066115, "comment_id": 89129524, "body": "A <a href=\"https://github.com/samnissen/watir-screenshot-stitch\" rel=\"nofollow noreferrer\">watir-screenshot-stich</a> gem was recently released to address a similar problem. You could see if that works for you."}, {"owner": {"reputation": 1254, "user_id": 3585595, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0fc9b06e8ebb26a395ff5e49ecc85f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Roberto", "link": "https://stackoverflow.com/users/3585595/paulo-roberto"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1530127367, "post_id": 51066115, "comment_id": 89129972, "body": "The idea is good, but it still has not worked for me, I&#39;ve read the documentation and applied it in my code, but it&#39;s still in the"}, {"owner": {"reputation": 1106, "user_id": 782713, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/20b309cdcea1aa280b617c318af99274?s=128&d=identicon&r=PG", "display_name": "Gijs Paulides", "link": "https://stackoverflow.com/users/782713/gijs-paulides"}, "edited": false, "score": 0, "creation_date": 1530169266, "post_id": 51066115, "comment_id": 89141974, "body": "I think you want to have a look at taking a screenshot from the OS point of view: For example for Windows <a href=\"https://github.com/jarmo/win32screenshot\" rel=\"nofollow noreferrer\">github.com/jarmo/win32screenshot</a> The browser screenshot is limited to its viewport."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1530231296, "post_id": 51066115, "comment_id": 89173576, "body": "Hacky workaround, but you could use <code>browser.screenshot.save</code> with <code>browser.url</code> as the argument.  Admittedly, you&#39;d have to do some gymnastics to strip <code>http:&#47;&#47;</code> and convert the <code>&#47;</code> to another delimiter.  YMMV."}], "answers": [{"comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1530312002, "post_id": 51109512, "comment_id": 89207432, "body": "Wouldn&#39;t you want <code>require &#39;win32&#47;screenshot&#39;</code>?"}, {"owner": {"reputation": 1254, "user_id": 3585595, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0fc9b06e8ebb26a395ff5e49ecc85f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Roberto", "link": "https://stackoverflow.com/users/3585595/paulo-roberto"}, "edited": false, "score": 0, "creation_date": 1530388157, "post_id": 51109512, "comment_id": 89222079, "body": "I tried to use it this way, what is the base 64 capture and then put it in the html status report, but without success.   encoded_img = Win32 :: Screenshot :: Take.of (: foreground) .write (encoded_img)   embed (&quot;data: image / png; base64, # {encoded_img}&quot;, &#39;image / png&#39;)"}, {"owner": {"reputation": 80, "user_id": 4314483, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y1qrHzFIrqU/AAAAAAAAAAI/AAAAAAAAAGA/RNyzaIFOTh0/photo.jpg?sz=128", "display_name": "E V N Raja", "link": "https://stackoverflow.com/users/4314483/e-v-n-raja"}, "edited": false, "score": 0, "creation_date": 1530425846, "post_id": 51109512, "comment_id": 89227037, "body": "I don&#39;t have knowledge in image format conversions. Whatever solution that I have provided to you will just give an output file in &#39;.png&#39; format, because your requirement is to capture a Full-page screenshot with URL. Either in selenium or in watir we don&#39;t have such support to capture the screenshot of a browser window.   In case if you want to embed into page directly as base64, it&#39;s better to follow the steps: 1. Capture the image in a temporary location. 2. Convert it into base64 3. Embed into the page 4. If necessary delete the image file from the location."}, {"owner": {"reputation": 80, "user_id": 4314483, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y1qrHzFIrqU/AAAAAAAAAAI/AAAAAAAAAGA/RNyzaIFOTh0/photo.jpg?sz=128", "display_name": "E V N Raja", "link": "https://stackoverflow.com/users/4314483/e-v-n-raja"}, "edited": false, "score": 0, "creation_date": 1530425861, "post_id": 51109512, "comment_id": 89227039, "body": "Please have a look into the following URL: <a href=\"https://stackoverflow.com/questions/1547008/how-to-encode-media-in-base64-given-url-in-ruby\" title=\"how to encode media in base64 given url in ruby\">stackoverflow.com/questions/1547008/&hellip;</a>"}], "tags": [], "owner": {"reputation": 80, "user_id": 4314483, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y1qrHzFIrqU/AAAAAAAAAAI/AAAAAAAAAGA/RNyzaIFOTh0/photo.jpg?sz=128", "display_name": "E V N Raja", "link": "https://stackoverflow.com/users/4314483/e-v-n-raja"}, "is_accepted": false, "score": 1, "last_activity_date": 1589379531, "last_edit_date": 1589379531, "creation_date": 1530306977, "answer_id": 51109512, "question_id": 51066115, "link": "https://stackoverflow.com/questions/51066115/full-page-screenshot-with-url-in-ruby-and-watir/51109512#51109512", "title": "Full-page screenshot with URL in ruby \u200band watir", "body": "<p>Watir doesn't have this provision to capture the screenshot along with a URL. But we can use win32ole to do this.</p>\n\n<pre><code>require 'win32/screenshot'\n</code></pre>\n\n<p>Win32::Screenshot::Take.of(:desktop).write(image_path)</p>\n\n<p>In my case for capturing the full-screenshot with a URL, I do the following</p>\n\n<pre><code># Code to capture the full-page screenshot with a URL\nrequire 'watir'\nrequire 'win32ole'\nrequire 'win32/screenshot'\n\n# Launch a browser and navigate to the page\nbrowser = Watir::Browser.new :ie\nbrowser.goto \"https://www.google.com\"\n\nwin_title = browser.title #Fetch the Title\n\n# Use AutoIt to get the focus of the browser to front\nWIN32OLE.new(\"AutoItX3.Control\").ControlFocus(win_title, \"\", \"\")\n\n# Capture the screen shot of the desktop\nsleep 2 # Hold for 2s\nimage_path = \"image_path#{rand(10000)}.png\"\nWin32::Screenshot::Take.of(:desktop).write(image_path)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80, "user_id": 4314483, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y1qrHzFIrqU/AAAAAAAAAAI/AAAAAAAAAGA/RNyzaIFOTh0/photo.jpg?sz=128", "display_name": "E V N Raja", "link": "https://stackoverflow.com/users/4314483/e-v-n-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1530426312, "creation_date": 1530426312, "answer_id": 51120930, "question_id": 51066115, "link": "https://stackoverflow.com/questions/51066115/full-page-screenshot-with-url-in-ruby-and-watir/51120930#51120930", "title": "Full-page screenshot with URL in ruby \u200band watir", "body": "<p>In my case for capturing the Full-screenshot with URL, I do the following</p>\n\n<p><code>#Code to capture the Full-Page screenshot with URL\nrequire 'watir'\nrequire 'win32ole'\nrequire 'win32/screenshot'</code></p>\n\n<p><code>#Launch Browser and navigate to page\nbrowser = Watir::Browser.new :ie\nbrowser.goto \"https://www.google.com\"</code></p>\n\n<p><code>#Fetch the Title</code>\n<code>win_title = browser.title</code></p>\n\n<p><code>#Use AutoIt to get the focus of the browser to front</code>\n<code>WIN32OLE.new(\"AutoItX3.Control\").ControlFocus(win_title, \"\", \"\")</code></p>\n\n<p><code>#Capture the screen shot of the desktop</code>\n<code>sleep 2 # Hold for 2s\nimage_path = \"image_path#{rand(10000)}.png\"\nWin32::Screenshot::Take.of(:desktop).write(image_path)</code></p>\n"}], "owner": {"reputation": 1254, "user_id": 3585595, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0fc9b06e8ebb26a395ff5e49ecc85f7c?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo Roberto", "link": "https://stackoverflow.com/users/3585595/paulo-roberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1589379531, "creation_date": 1530111945, "last_edit_date": 1542497478, "question_id": 51066115, "link": "https://stackoverflow.com/questions/51066115/full-page-screenshot-with-url-in-ruby-and-watir", "title": "Full-page screenshot with URL in ruby \u200band watir", "body": "<p>With the code below, I get a screenshot of only one part of the screen, but I would like to take a full screenshot, which shows the URL of the page as well.</p>\n\n<p><strong>Is it possible?</strong></p>\n\n<pre><code>AfterStep do\n  encoded_img = @browser.driver.screenshot_as(:base64)\n    embed(\"data:image/png;base64,#{encoded_img}\",'image/png')\nend\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1530120717, "post_id": 51065542, "comment_id": 89126786, "body": "try the approach <a href=\"https://www.softwaretestingmaterial.com/handle-authentication-popup-window/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530121460, "post_id": 51065542, "comment_id": 89127123, "body": "This solution works for me ! Thanks so much ! :-D"}, {"owner": {"reputation": 156, "user_id": 2438005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/034c72d93a50e55bd261a611a6fd0b2c?s=128&d=identicon&r=PG", "display_name": "Ricardo Jacas", "link": "https://stackoverflow.com/users/2438005/ricardo-jacas"}, "edited": false, "score": 0, "creation_date": 1552506455, "post_id": 51065542, "comment_id": 97040541, "body": "How did you solve it?"}, {"owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "edited": false, "score": 0, "creation_date": 1552609746, "post_id": 51065542, "comment_id": 97086758, "body": "With max pleaner&#39;s solution above. Honestly it&#39;s been a long time and I haven&#39;t use my program since so I don&#39;t remember the exact steps I took, but it looks like I was able to fix my issue using their method in about 15 minutes so it must&#39;ve been pretty intuitive..."}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "edited": false, "score": 0, "creation_date": 1530110946, "post_id": 51065729, "comment_id": 89121393, "body": "Gives me :      Failure/Error: alert.send_keys(&quot;username&quot;,:tab,&quot;password&quot;)     ArgumentError:         wrong number of arguments (given 3, expected 1)"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "edited": false, "score": 0, "creation_date": 1530111748, "post_id": 51065729, "comment_id": 89121928, "body": "@LeKevoid Since split method is being called, Can you try <code>&quot;username :tab password&quot;</code> Take out the , use space in that place. usually send_keys passes multiple keys but since it&#39;s called on alert, this may be the difference. Pass it by space rather than , I hope it would work."}, {"owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "edited": false, "score": 0, "creation_date": 1530115729, "post_id": 51065729, "comment_id": 89124248, "body": "Doesn&#39;t work either ; it just put the string &quot;username :tab password&quot; in the username field. I also tried <code>alert.send_keys(&quot;username&quot; + :tab + &quot;password&quot;)</code> and it gave me <b>no implicit conversion of Symbol into String</b>"}], "tags": [], "owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "is_accepted": false, "score": 0, "last_activity_date": 1530110768, "creation_date": 1530110768, "answer_id": 51065729, "question_id": 51065542, "link": "https://stackoverflow.com/questions/51065542/selenium-with-ruby-handling-js-prompt-with-2-fields/51065729#51065729", "title": "Selenium with Ruby : Handling JS Prompt with 2 fields", "body": "<p>Write this one</p>\n\n<pre><code>alert.send_keys(\"username\",:tab,\"password\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "is_accepted": false, "score": 1, "last_activity_date": 1530124221, "last_edit_date": 1530124221, "creation_date": 1530121435, "answer_id": 51068656, "question_id": 51065542, "link": "https://stackoverflow.com/questions/51065542/selenium-with-ruby-handling-js-prompt-with-2-fields/51068656#51068656", "title": "Selenium with Ruby : Handling JS Prompt with 2 fields", "body": "<p>Thanks to @max-pleaner, a solution has been found.</p>\n\n<p><a href=\"https://www.softwaretestingmaterial.com/handle-authentication-popup-window/\" rel=\"nofollow noreferrer\">Documentation here</a></p>\n\n<p>I chose the first solution proposed : you can authenticate by putting your credentials directly in the url : <code>https://username:password@www.yoursite.com</code></p>\n\n<p>Thank you so much for your help !</p>\n"}], "owner": {"reputation": 345, "user_id": 1759314, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/caddfd4c3eade9aa9d31808fc1ced3cc?s=128&d=identicon&r=PG", "display_name": "LeKevoid", "link": "https://stackoverflow.com/users/1759314/lekevoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1530124221, "creation_date": 1530110196, "question_id": 51065542, "link": "https://stackoverflow.com/questions/51065542/selenium-with-ruby-handling-js-prompt-with-2-fields", "title": "Selenium with Ruby : Handling JS Prompt with 2 fields", "body": "<p>I want Selenium to connect to my Staging site, which is hosted on WPEngine. Therefore each time I connect, it asks me for a user name and password, in a Javascript prompt.</p>\n\n<p>I can easily send text to the first (user name) field in the prompt :</p>\n\n<pre><code>def connectToStaging()\n    alert = @browser.switch_to.alert\n    if /username and password/.match(alert.text)\n        alert.send_keys(\"username\")\n    end\nend\n</code></pre>\n\n<p>But then I don't know how to switch to the password field to do the same.</p>\n\n<p>I've tried sending a tab character right after sending the string \"username\" :</p>\n\n<pre><code>alert.send_keys(:tab)\n</code></pre>\n\n<p>But it returns an error : <strong>NoMethodError: undefined method `split' for :tab:Symbol</strong></p>\n\n<p>Otherwise I don't know if there's a way to target the field using <strong>find_element</strong> ? Or is there a function to switch to the next field in whatever window or form the pointer is in at the moment ?</p>\n\n<p>Thanks so much !</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "street-address"], "comments": [{"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1530109377, "post_id": 51065191, "comment_id": 89120343, "body": "What does &quot;introduce a new line break&quot; mean? Could you elaborate?"}, {"owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "reply_to_user": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 0, "creation_date": 1530109644, "post_id": 51065191, "comment_id": 89120527, "body": "Add a line break eg  &lt;br&gt;  or carriage return."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530109752, "post_id": 51065191, "comment_id": 89120604, "body": "@ChrisNash <code>&lt;br&gt;</code> and <code>\\n</code> are two different things. Which do you want? Please be clear."}, {"owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530109925, "post_id": 51065191, "comment_id": 89120719, "body": "@tomLord I want which ever one is going to give me an address block of text over multiple lines. I have tried both in my helper and couldn&#39;t get either to work. Obvs I had the syntax wrong"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "edited": false, "score": 1, "creation_date": 1530111088, "post_id": 51065191, "comment_id": 89121511, "body": "As your function is a view helper, a <code>&lt;br&#47;&gt;</code> tag would be fitting."}, {"owner": {"reputation": 148, "user_id": 4864202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vScnT.png?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/4864202/neo"}, "edited": false, "score": 0, "creation_date": 1531930637, "post_id": 51065191, "comment_id": 89784528, "body": "Just in case this is helpful, the standard USPS multiline address format has no commas at the end of any address line. If the delivery address is supposed to read like it would on a package for delivery in the US, the trailing commas should be omitted. Reference -&gt; <a href=\"https://pe.usps.com/text/pub28/28c2_001.htm\" rel=\"nofollow noreferrer\">pe.usps.com/text/pub28/28c2_001.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 6324558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/695946b2499d7dcb2759724e66cfad38?s=128&d=identicon&r=PG&f=1", "display_name": "Alexis Delahaye", "link": "https://stackoverflow.com/users/6324558/alexis-delahaye"}, "edited": false, "score": 0, "creation_date": 1530110149, "post_id": 51065431, "comment_id": 89120863, "body": "was about to make an aswer with compact rather than blank to match what OP asked (null values), nice edit"}, {"owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "edited": false, "score": 0, "creation_date": 1530110923, "post_id": 51065431, "comment_id": 89121379, "body": "Thanks Tom, however on the page this displays as such     23 Taylor Road&lt;br/&gt;Bradford&lt;br/&gt;BD6 1BH"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "edited": false, "score": 0, "creation_date": 1530113449, "post_id": 51065431, "comment_id": 89122976, "body": "@ChrisNash As mentioned above, you can use <code>.html_safe</code>. Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (i.e. in this case, how is the method being called?) of the problem, I had no way of knowing whether this solution was complete :)"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1530109852, "creation_date": 1530109852, "answer_id": 51065431, "question_id": 51065191, "link": "https://stackoverflow.com/questions/51065191/rails-address-format-helper/51065431#51065431", "title": "Rails Address Format Helper", "body": "<pre><code>def delivery_address(customer)\n  @customer =  Customer.find(customer.id)\n  return \"No Delivery Address\" if @customer.del_address1.blank?\n\n  [\n    @customer.del_address1,\n    @customer.del_address2,\n    @customer.del_address3,\n    @customer.del_address4,\n    @customer.del_address5\n  ].reject(&amp;:blank?).join(\",\\n\")\nend\n</code></pre>\n\n<p>Rather than writing 5 <code>if</code> statements, you can put all values into an array, then delete any blank values.</p>\n\n<p>Note that my code here is based on yours, but is not quite what your question asked for:</p>\n\n<blockquote>\n  <p>it will compact any nulls</p>\n</blockquote>\n\n<p>An empty string is also considered <code>blank?</code> (but <code>\"\" != nil</code>). So this method will also skip these values.</p>\n\n<p>If you did only want to ignore <code>nil</code> values, but keep empty strings, then replace <code>reject(&amp;:blank?)</code> with <code>compact</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "edited": false, "score": 0, "creation_date": 1530111119, "post_id": 51065446, "comment_id": 89121523, "body": "Thanks but on the page this is only showing the 5 lines of the address on 1 line and not split over multiple lines as I would expect."}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "edited": false, "score": 0, "creation_date": 1530111569, "post_id": 51065446, "comment_id": 89121813, "body": "Ah. I forgot the html_safe call. That should work now"}, {"owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "edited": false, "score": 0, "creation_date": 1530112867, "post_id": 51065446, "comment_id": 89122640, "body": "I just reloaded the page and the address was perfect - that brings joy to my heart Thank you!"}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": true, "score": 0, "last_activity_date": 1530111530, "last_edit_date": 1530111530, "creation_date": 1530109883, "answer_id": 51065446, "question_id": 51065191, "link": "https://stackoverflow.com/questions/51065191/rails-address-format-helper/51065446#51065446", "title": "Rails Address Format Helper", "body": "<p>One important advise: You should not do any database queries inside a view helper. This should only be done in the controller. An active record should already be passed into the helper function. So this line</p>\n\n<pre><code>@customer =  Customer.find(customer.id)\n</code></pre>\n\n<p>can be removed.</p>\n\n<pre><code>def delivery_address(customer)\n  # Use a guard clause, this reduces if nesting\n  return 'No Delivery Address' if customer.del_address1.blank? \n\n  # Collect all parts    \n  parts = [customer.del_address1, customer.del_address2, customer.del_address3, customer.del_address4, customer.del_address5]\n\n  # Remove all empty parts.\n  # Using a bang method is lighter on memory allocation\n  # and will speed up performance.\n  parts.reject!(&amp;:blank?) \n\n  parts.join('&lt;br/&gt;').html_safe\nend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 51065446, "answer_count": 2, "score": 0, "last_activity_date": 1530111530, "creation_date": 1530109134, "last_edit_date": 1530109683, "question_id": 51065191, "link": "https://stackoverflow.com/questions/51065191/rails-address-format-helper", "title": "Rails Address Format Helper", "body": "<p>I am trying to create a helper that will format an address from 5 columns (add1,add2, add3,add4,add5) so that it will compact any nulls and display on screen as such</p>\n\n<pre><code>Add1,\nAdd3,\nAdd4,\nAdd5\n</code></pre>\n\n<p>(add 2 was skipped as it was null)</p>\n\n<p>I created the following helper to assemble and skip any nulls but I can not introduce a new line break. Any ideas?</p>\n\n<pre><code>def delivery_address(customer)\n@customer =  Customer.find(customer.id) \n\nif @customer.del_address1.blank? \n  deladdress = \"No Delivery Address\"\nelse\n\n    deladdress = @customer.del_address1 \n    deladdress = deladdress + \"&lt;/br&gt;\"\n\n  if customer.del_address2.blank?\n    else \n    deladdress = deladdress + @customer.del_address2 + \",\"\n\n  end\n\n  if @customer.del_address3.blank?\n    else \n    deladdress = deladdress +  @customer.del_address3 + \",\"\n\n  end\n\n  if @customer.del_address4.blank?\n    else \n    deladdress = deladdress +  @customer.del_address4 + \",\"\n\n  end\n\n  if @customer.del_address5.blank?\n    else \n    deladdress = deladdress +  @customer.del_address5\n\n  end\n\nend\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "apache-poi", "poi-hssf", "rjb"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1530110992, "post_id": 51063725, "comment_id": 89121438, "body": "Looks like a problem with the line <i>JavaFont = Rjb::import &#39;java.awt.Font&#39;</i>, try commenting it out and seeing if the error persists, if not that&#39;s your problem"}, {"owner": {"reputation": 43110, "user_id": 685641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/598aa6e391b96b1ec24f1c34b58edcd9?s=128&d=identicon&r=PG", "display_name": "Gagravarr", "link": "https://stackoverflow.com/users/685641/gagravarr"}, "edited": false, "score": 1, "creation_date": 1530115204, "post_id": 51063725, "comment_id": 89123962, "body": "Why are you using such old versions of Apache POI? Why are you trying to use two different old versions at the same time? What happens when you stop this and just have one new POI jar?"}, {"owner": {"reputation": 174, "user_id": 5417755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489df744ecb823573bfdfe899dbdf112?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul2692", "link": "https://stackoverflow.com/users/5417755/rahul2692"}, "edited": false, "score": 0, "creation_date": 1530267915, "post_id": 51063725, "comment_id": 89186475, "body": "Exception is throwing only in production. JavaFont = Rjb::import &#39;java.awt.Font&#39; is working fine."}], "owner": {"reputation": 174, "user_id": 5417755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489df744ecb823573bfdfe899dbdf112?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul2692", "link": "https://stackoverflow.com/users/5417755/rahul2692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1230, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530105858, "creation_date": 1530105152, "last_edit_date": 1530105858, "question_id": 51063725, "link": "https://stackoverflow.com/questions/51063725/xls-throwing-java-lang-classnotfoundexception-org-apache-poi-hssf-util-hssfcolo", "title": "XLS throwing java.lang.ClassNotFoundException: org.apache.poi.hssf.util.HSSFColor$BLACK", "body": "<p>I'm having problems trying to open an XLS file with Apache POI. I am integrating HSSF in rails application.</p>\n\n<p>My code is like:</p>\n\n<pre><code>require \"rjb\"\n\n  Rjb::add_jar(File.expand_path('demo/poi-3.9/poi-3.9-20121203.jar'))\n  Rjb::add_jar(File.expand_path('demo/poi-3.9/commons-codec-1.7.jar'))\n\n  Black = Rjb::import 'org.apache.poi.hssf.util.HSSFColor$BLACK'\n  HSSFCell = Rjb::import 'org.apache.poi.hssf.usermodel.HSSFCell'\n  HSSFCellStyle = Rjb::import 'org.apache.poi.hssf.usermodel.HSSFCellStyle'\n  HSSFFont = Rjb::import 'org.apache.poi.hssf.usermodel.HSSFFont'\n  HSSFWorkbook = Rjb::import 'org.apache.poi.hssf.usermodel.HSSFWorkbook'\n  IOUtils = Rjb::import 'org.apache.poi.util.IOUtils'\n  JavaFont = Rjb::import 'java.awt.Font'\n  FileInputStream = Rjb::import 'java.io.FileInputStream'\n  FileOutputStream = Rjb::import 'java.io.FileOutputStream'\n\ndef self.export_xls (params)\n    file = \"tmp/#{Time.now.to_formatted_s(:number)}_#{abc}.xls\"\n    @book = HSSFWorkbook.new\n    @sheet1 = @book.createSheet l(:report_name)\n    @drawing = @sheet1.createDrawingPatriarch()\n    @number_of_column = 0\n    @number_of_column_to_merge = 10\n    black = Black.index\n\n    @styleTableTitle = @book.createCellStyle()       \n    @styleTableTitle.setBorderBottom(HSSFCellStyle.BORDER_THIN)\n    @styleTableTitle.setBottomBorderColor(black)\n\n    out = FileOutputStream.new(\"#{Rails.root}/\" + file)\n    @book.write(out)\n    out.close()\n    file\nend\n</code></pre>\n\n<p>Exception throw:</p>\n\n<p><code>RuntimeError (java.lang.ClassNotFoundException: org.apache.poi.hssf.util.HSSFColor$BLACK)</code></p>\n\n<p>Imported jars (Apache POI):</p>\n\n<p><code>poi-3.9-20121203\n poi-3.7-20101029\n commons-codec-1.7</code></p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530104989, "post_id": 51063589, "comment_id": 89117144, "body": "Please paste the error and stack trace in question."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9999934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7551307acd6cac08b016ebe28fcf5866?s=128&d=identicon&r=PG&f=1", "display_name": "FrostX", "link": "https://stackoverflow.com/users/9999934/frostx"}, "edited": false, "score": 0, "creation_date": 1530106962, "post_id": 51063754, "comment_id": 89118658, "body": "Thank you that works. A simple solution and i did not get up to this by myself &gt;.&lt;. I am a little bit confused because my output looked like described (, and not =&gt;). But magically, it looks right now &gt;.&lt;. Thanks a lot."}], "tags": [], "owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1530105864, "last_edit_date": 1530105864, "creation_date": 1530105241, "answer_id": 51063754, "question_id": 51063589, "link": "https://stackoverflow.com/questions/51063589/create-a-nested-hash-from-a-api-call-doesnt-work-properly/51063754#51063754", "title": "Create a nested HASH from a API Call doesn&#39;t work properly", "body": "<p>Assuming the data looks something like this:</p>\n\n<pre><code>all_apps_parse = { \"apps\" =&gt; [\n                   {\n                     \"title\" =&gt; \"Name1\",\n                     \"id\" =&gt; 1234,\n                     \"platform\" =&gt; \"os\"\n                   },\n                   {\n                     \"title\" =&gt; \"Name2\",\n                     \"id\" =&gt; 5678,\n                     \"platform\" =&gt; \"os\"\n                   },\n                   {\n                     \"title\" =&gt; \"Name3\",\n                     \"id\" =&gt; 1111,\n                     \"platform\" =&gt; \"windows\"\n                   }]\n                 }\n</code></pre>\n\n<p>and with a little idea of what you want to achieve, here is my solution:</p>\n\n<pre><code>all_apps = Hash.new\nall_apps_parse[\"apps\"].each_with_index do |app, i|\n  all_apps[\"APP_#{i}\"] = { 'Title' =&gt; app[\"title\"],\n                           'ID' =&gt; app[\"id\"],\n                           'OS' =&gt; app[\"platform\"] }\nend\n\nall_apps\n =&gt; {\"APP_0\"=&gt;{\"Title\"=&gt;\"Name1\", \"ID\"=&gt;1234, \"OS\"=&gt;\"os\"}, \"APP_1\"=&gt;{\"Title\"=&gt;\"Name2\", \"ID\"=&gt;5678, \"OS\"=&gt;\"os\"}, \"APP_2\"=&gt;{\"Title\"=&gt;\"Name3\", \"ID\"=&gt;1111, \"OS\"=&gt;\"windows\"}}\n\nall_apps.each do |key, value|\n  puts key              # =&gt; e.g. \"APP_0\"\n  puts value['ID']      # =&gt; e.g. 1234\nend\n\n# Prints \nAPP_0\n1234\nAPP_1\n5678\nAPP_2\n1111\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 9999934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7551307acd6cac08b016ebe28fcf5866?s=128&d=identicon&r=PG&f=1", "display_name": "FrostX", "link": "https://stackoverflow.com/users/9999934/frostx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 51063754, "answer_count": 1, "score": 0, "last_activity_date": 1530105864, "creation_date": 1530104818, "question_id": 51063589, "link": "https://stackoverflow.com/questions/51063589/create-a-nested-hash-from-a-api-call-doesnt-work-properly", "title": "Create a nested HASH from a API Call doesn&#39;t work properly", "body": "<p>I am new here and i hope that I'm doing everything right.\nI also searched the Forum and with Googel, but I didn't find the answer. (Or I did not notice that the solution lies before my eyes. Then I'm sorry >.&lt; .)</p>\n\n<p>i have a problem and i dont exactly know what i am doing wrong at the moment. \nI make a API request and get a big JSON back. It looks somehow like that:</p>\n\n<pre><code>\"apps\": [\n        {\n            \"title\": \"XX\",\n             ... many more data\n},\n{\n            \"title\": \"XX\",\n            ... many more data\n},\n{\n            \"title\": \"XX\",\n            ... many more data\n} \n    ... and so on\n]\n</code></pre>\n\n<p>After that i want to create a hash with the data i need, for example it should look like:</p>\n\n<pre><code>{\n \"APP_0\" =&gt; {\"Title\"=&gt;\"Name1\", \"ID\"=&gt;\"1234\", \"OS\"=&gt;\"os\"}\n \"APP_1\" =&gt; {\"Title\"=&gt;\"Name2\", \"ID\"=&gt;\"5678\", \"OS\"=&gt;\"os\"}\n}\n</code></pre>\n\n<p>but the values in the hash that i create with my code looks like:</p>\n\n<pre><code>\"APP_1\", {\"Title\"=&gt;\"Name2\", \"ID\"=&gt;\"5678\", \"OS\"=&gt;\"os\"}\n</code></pre>\n\n<p>dont now if this is a valid hash? And after that i want to iterate through the Hash and just output the ID. But I get an error (TypeError). What am i doing wrong? </p>\n\n<pre><code>require 'json'\nrequire 'net/http'\nrequire 'uri'\nrequire 'httparty'\n\nresponse = HTTParty.get('https://xxx/api/2/app', {\n  headers: {\"X-Toke\" =&gt; \"xyz\"},\n})\nall_apps_parse = JSON.parse(response.body)\n\nall_apps = Hash.new\nall_apps_parse[\"apps\"].each_with_index do |app, i|\n  all_apps[\"APP_#{i}\"] = {'Title' =&gt; app[\"title\"],\n                         'ID' =&gt; app[\"id\"],\n                         'OS' =&gt; app[\"platform\"]}\nend\n\nall_apps.each_with_index do |app, i|\n  app_id = app[\"App_#{i}\"][\"id\"]\n  p app_id\nend\n</code></pre>\n\n<p>I hope someone can understand the problem and can help me :-). Thanks in advance.</p>\n"}, {"tags": ["ruby", "mongodb", "mongoid"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1530104525, "post_id": 51063049, "comment_id": 89116801, "body": "You would just add a scope with the same filter on your model.  mongo&#39;s query planner should pick it up when it executes"}, {"owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "edited": false, "score": 1, "creation_date": 1554804699, "post_id": 51063049, "comment_id": 97877374, "body": "Had the same question. See this answer <a href=\"https://stackoverflow.com/a/55590312/1257369\">stackoverflow.com/a/55590312/1257369</a>"}], "owner": {"reputation": 3018, "user_id": 259328, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f46d8d548aab88417ff18f35787fda55?s=128&d=identicon&r=PG", "display_name": "Doron", "link": "https://stackoverflow.com/users/259328/doron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1609353120, "creation_date": 1530103196, "question_id": 51063049, "link": "https://stackoverflow.com/questions/51063049/how-do-you-define-a-partial-index-in-mongoid", "title": "How do you define a partial index in mongoid ?", "body": "<p>MongoDB 3.2 introduced partial indexes - you can define a filter as part of the index to which the index will be applied.\nIn ruby's mongoid I can define a unique or normal index.</p>\n\n<p>Since the partial index contains a filter expression on which the index should work - how do you define it on a model ?  </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530101568, "post_id": 51062464, "comment_id": 89114740, "body": "the code is erroneous. what is <code>@comment</code> in <code>destroy</code>? It&#39;s not initialised anywhere."}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530101729, "post_id": 51062464, "comment_id": 89114853, "body": "You&#39;re right @ kiddorails... I just added more information to my question."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530101748, "post_id": 51062464, "comment_id": 89114866, "body": "Is this <code>destroy</code> action (shown in question) for admin or for normal users?"}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530101800, "post_id": 51062464, "comment_id": 89114910, "body": "@Jagdeep Singh it&#39;s located in the admin controller."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 2, "creation_date": 1530101818, "post_id": 51062464, "comment_id": 89114932, "body": "Also, why do you need separate end points for deleting the same comment?"}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530102240, "post_id": 51062464, "comment_id": 89115210, "body": "@Jagdeep Singh i just added the server logs."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530102583, "post_id": 51062464, "comment_id": 89115436, "body": "Looking at the logs, i feel you are deleting all the comments of a user in your action AND you have posted the wrong action definition in the question. Please double check."}, {"owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530102875, "post_id": 51062464, "comment_id": 89115634, "body": "@Jagdeep Singh 3 it&#39;s really weird because i double checked everything... this the route to the destroy method  <code>match &#39;admin&#47;:item_id&#47;comments&#47;:id&#39;=&gt; &#39;admin_comments#destroy&#39;, :via =&gt; :delete, :as =&gt; :admin_destroy_item_comment</code> I&#39;m not sure what may be causing this."}, {"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1530103588, "post_id": 51062464, "comment_id": 89116120, "body": "Post your comment model."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1530106325, "post_id": 51062464, "comment_id": 89118180, "body": "@Dev I feel like something is going wrong with your routes. Why do you need the item id for destroying a comment? You&#39;re already providing the comment id, that should be enough. Furthermore, keep in mind that hiding or disabling a link doesn&#39;t stop users from executing the action. Authorization should also be checked in the destroy action itself (or in a <i>before_action</i> callback). Have a look at shallow routes in the Rails routing guide. See: <a href=\"http://guides.rubyonrails.org/routing.html#nested-resources\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html#nested-resources</a>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1530106795, "post_id": 51062464, "comment_id": 89118525, "body": "Also, can you post the full server log of the delete request? It should say what URL was requested, what the params are and what controller/action handled the request. It should also display executed SQL statements, but I see you already posted that part of the request."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1530111169, "post_id": 51062464, "comment_id": 89121552, "body": "Shouldn&#39;t the route to hit be item_comment_path(item, comment), method: :delete ?"}], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1530102432, "post_id": 51062759, "comment_id": 89115335, "body": "This answer doesn&#39;t explain OP&#39;s statement: <i>&quot;all of the comments associated to the specific item get deleted and not just that one.&quot;</i>"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1530102478, "post_id": 51062759, "comment_id": 89115354, "body": "Also, if there was no route defined, it would not have the logs as shown in question."}], "tags": [], "owner": {"reputation": 152, "user_id": 7470229, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/kbXrv.jpg?s=128&g=1", "display_name": "Rohan Mayya", "link": "https://stackoverflow.com/users/7470229/rohan-mayya"}, "is_accepted": false, "score": 0, "last_activity_date": 1530103229, "last_edit_date": 1530103229, "creation_date": 1530102336, "answer_id": 51062759, "question_id": 51062464, "link": "https://stackoverflow.com/questions/51062464/rails-loop-and-delete-an-object-as-an-admin/51062759#51062759", "title": "Rails loop and delete an object as an admin", "body": "<p>My hunch is that your routes are not configured properly. You can hit </p>\n\n<pre><code>rails routes\n</code></pre>\n\n<p>to check admin_delete_comment_path configuration.</p>\n\n<p>Try changing </p>\n\n<pre><code>admin_destroy_item_comment_path(comment.item_id,comment.id)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>destroy_item_comment_path(commend.item_id, comment.id)\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 7079742, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/1KL5C.jpg?s=128&g=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/7079742/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530103229, "creation_date": 1530101356, "last_edit_date": 1530102772, "question_id": 51062464, "link": "https://stackoverflow.com/questions/51062464/rails-loop-and-delete-an-object-as-an-admin", "title": "Rails loop and delete an object as an admin", "body": "<p>The following loop shows each comment associated to the specific item and lets the comment owner(user) to edit or delete a comment. This works just fine.</p>\n\n<p>Now I would the admin to be able to delete a comment. The only problem is that when I click on the delete... all of the comments associated to the specific item get deleted and not just that one.</p>\n\n<p>Any idea how to fix this?</p>\n\n<pre><code>&lt;% @comments.each do |comment| %&gt;\n  &lt;% if current_user == comment.user %&gt;\n    &lt;%= link_to \"Delete\", destroy_item_comment_path(comment.item_id, comment.id),\n                method: :delete, data: { confirm: I18n.t(\"comment_delete_alert\")}, :class=&gt;\"glyphicon glyphicon-trash\" %&gt;     \n  &lt;% elsif current_admin %&gt;\n    &lt;%= link_to \"Delete\", admin_destroy_item_comment_path(comment.item_id, comment.id),\n                method: :delete, data: { confirm: I18n.t(\"comment_delete_alert\")}, :class=&gt;\"glyphicon glyphicon-trash\" %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller method:</p>\n\n<pre><code>before_action :find_comment, only: [:destroy]\n\ndef destroy\n  @comment.destroy\n  redirect_back(fallback_location: root_path)\n  flash[:notice] = \"Comment has been deleted\"\nend\n\ndef find_comment\n  @comment = @item.comments.find(params[:id])\nend\n</code></pre>\n\n<p><strong>Update 1</strong> </p>\n\n<p>server logs when deleting a comment as an admin</p>\n\n<pre><code> Comment Load (0.9ms)  SELECT \"comments\".* FROM \"comments\" WHERE \"comments\".\"user_id\" = $1  [[\"user_id\", 213]]\n (0.2ms)  BEGIN\n  SQL (0.4ms)  DELETE FROM \"comments\" WHERE \"comments\".\"id\" = $1  [[\"id\", 14]]\n  SQL (0.4ms)  DELETE FROM \"comments\" WHERE \"comments\".\"id\" = $1  [[\"id\", 15]]\n  SQL (0.3ms)  DELETE FROM \"comments\" WHERE \"comments\".\"id\" = $1  [[\"id\", 16]]\n   (1.2ms)  COMMIT\n Completed 302 Found in 14123ms (ActiveRecord: 36.3ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "stripe-payments", "webhooks"], "comments": [{"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530098809, "post_id": 51061336, "comment_id": 89112977, "body": "add hook to receive stripe webhooks (if not already) and listen for <code>customer.subscription.deleted</code> event. Since you passed <code>at_period_end</code>, that event should trigger when subscription ends (after 10 days) for user. refer - <a href=\"https://stripe.com/docs/billing/subscriptions/canceling-pausing#events\" rel=\"nofollow noreferrer\">stripe.com/docs/billing/subscriptions/canceling-pausing#even&zwnj;&#8203;ts</a>"}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530104852, "post_id": 51061336, "comment_id": 89117042, "body": "web hooks are set up.. I tried <code>if customer.subscriptions.deleted?</code> but this doesnot seem to work. I also gave this a try <code>if customer.subscriptions.retrieve(current_user.subscription_id&zwnj;&#8203;).deleted?</code> but nothing"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530104973, "post_id": 51061336, "comment_id": 89117130, "body": "the event name will be <code>&#39;customer.subscription.deleted&#39;</code> which will contain the customer id (which you can then retrieve with <code>customer = Stripe::Customer.retrieve(event[&#39;customer&#39;])</code>. at end of subscription, use the event, get the user, and mark <code>user.subscribed = true</code>"}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "reply_to_user": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1530105734, "post_id": 51061336, "comment_id": 89117703, "body": "I just added my web hook to the question...im not quite sure where your saying to place these and then call <code>user.subscribed = true</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530114844, "post_id": 51063985, "comment_id": 89123766, "body": "Iv just updates my question with some more information, As i still havnot got it to work"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530115487, "post_id": 51063985, "comment_id": 89124109, "body": "doesn&#39;t <code>post &#39;webhooks&#39; =&gt; &#39;subscriptions#webhooks&#39;</code> already mean that the correct path of webhook url will be <code>&#47;webhooks</code> ?"}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530122201, "post_id": 51063985, "comment_id": 89127486, "body": "in stripe dashboard i have set <code>http:&#47;&#47;myapp&#47;webhook</code> but still nothing seems to work.. for testing i am canceling the subscription from stripe dashboard (immediate cancellation) but still not working, nothing gets changed"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530122609, "post_id": 51063985, "comment_id": 89127703, "body": "do you get any request(webhook) in your rails with event when you cancel the subscription?"}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530122745, "post_id": 51063985, "comment_id": 89127771, "body": "yh but at the end im getting <code>Can&#39;t verify CSRF token authenticity.</code> In the stripe dashboard there is a <code>Signing secret</code> key i have not used this anywhere in my application which might be why"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530122817, "post_id": 51063985, "comment_id": 89127804, "body": "add <code>skip_before_action :verify_authenticity_token, only: [:webhook]</code> in your controller after opening the class."}, {"owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530123293, "post_id": 51063985, "comment_id": 89128027, "body": "that seems to have fixed the CSRF error, but <code>user.update_attribute :subscribed, false</code> does not seem to change the subscribed variable to false"}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "reply_to_user": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "edited": false, "score": 0, "creation_date": 1530123348, "post_id": 51063985, "comment_id": 89128049, "body": "I will leave that for you debug :). Check if the the request is even reaching there, add logs. all the best!"}], "tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": true, "score": 0, "last_activity_date": 1530105896, "creation_date": 1530105896, "answer_id": 51063985, "question_id": 51061336, "link": "https://stackoverflow.com/questions/51061336/stripe-cancel-subscription-after-end-period/51063985#51063985", "title": "stripe cancel subscription after end period", "body": "<p>Handle in <code>case</code> of <code>customer.subscription.deleted</code>, look below:</p>\n\n<pre><code>def webhook\n  begin\n    event_json = JSON.parse(request.body.read)\n    event_object = event_json['data']['object']\n    #refer event types here https://stripe.com/docs/api#event_types\n    case event_json['type']\n      when 'invoice.payment_succeeded'\n        handle_success_invoice event_object\n      when 'invoice.payment_failed'\n        handle_failure_invoice event_object\n      when 'charge.failed'\n        handle_failure_charge event_object\n      when 'customer.subscription.deleted'\n        # NOTE HERE, this event will come when stripe actually marks the subscription as canceled, which in your example will be 10 days later.\n        # so simply get the user here and mark `subscribed` as false, instead of doing it early\n        user = Stripe::Customer.retrieve(event_object['customer'])\n        user.update_attribute :subscribed, false\n      when 'customer.subscription.updated'\n    end\n  rescue Exception =&gt; ex\n    render :json =&gt; {:status =&gt; 422, :error =&gt; \"Webhook call failed\"}\n    return\n  end\n  render :json =&gt; {:status =&gt; 200}\nend\n</code></pre>\n"}], "owner": {"reputation": 1225, "user_id": 5724342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d0fc4bbc261a7a2a233a196a0b655fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmukh Singh", "link": "https://stackoverflow.com/users/5724342/gurmukh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 1, "accepted_answer_id": 51063985, "answer_count": 1, "score": 1, "last_activity_date": 1531466614, "creation_date": 1530097973, "last_edit_date": 1531466614, "question_id": 51061336, "link": "https://stackoverflow.com/questions/51061336/stripe-cancel-subscription-after-end-period", "title": "stripe cancel subscription after end period", "body": "<p>I have a method to cancel subscriptions like this:</p>\n\n<pre><code>def cancel_subscription\n  customer = Stripe::Customer.retrieve(current_user.stripe_customer_id)\n  customer.subscriptions.retrieve(current_user.subscription_id).delete(:at_period_end =&gt; true)\n  current_user.subscribed = false\n  if current_user.save\n    redirect_to root_path\n  end\nend\n</code></pre>\n\n<p>Im using <code>(:at_period_end =&gt; true)</code> to cancel at the end at end date from started.</p>\n\n<p>But also in my DB i have a column which is set to false or true depending on if the customer is subscribed or not:</p>\n\n<pre><code>current_user.subscribed = false\n</code></pre>\n\n<p>I want to change this to false after the end period. For example the customer cancels the subscription but still has 10 days left. I want <code>current_user.subscribed</code> set to false after the actual period is over and the customer is now properly unsubscribed.</p>\n\n<p>Here is web hook set up:</p>\n\n<pre><code>def webhook\n  begin\n    event_json = JSON.parse(request.body.read)\n    event_object = event_json['data']['object']\n    #refer event types here https://stripe.com/docs/api#event_types\n    case event_json['type']\n      when 'invoice.payment_succeeded'\n        handle_success_invoice event_object\n      when 'invoice.payment_failed'\n        handle_failure_invoice event_object\n      when 'charge.failed'\n        handle_failure_charge event_object\n      when 'customer.subscription.deleted'\n      when 'customer.subscription.updated'\n    end\n  rescue Exception =&gt; ex\n    render :json =&gt; {:status =&gt; 422, :error =&gt; \"Webhook call failed\"}\n    return\n  end\n  render :json =&gt; {:status =&gt; 200}\nend\n</code></pre>\n\n<p>In my routes file I have the following for stripe:</p>\n\n<pre><code>Rails.application.routes.draw do\n  root to: 'welcome#index'\n  devise_for :users, controllers: { sessions: 'users/sessions',\n                                    :omniauth_callbacks =&gt; \"callbacks\",\n                                    registrations: \"users/registrations\"}\n  resources :profiles\n  resources :subscriptions, only: [:new, :create]\n  resources :topics, only: [:index, :edit, :create, :destroy, :update]\n  resources :topic_profiles, only: [:create, :destroy]\n  resources :chats, only: [:index]\n\n  #resources :messages, only: %i[new edit]\n  resources :messages, only: %i[new create index]\n  post 'incoming_message/webhook'\n  resources :test_inbound_messages, only: %i[new create]\n\n\n  post 'subscription_checkout' =&gt; 'subscriptions#subscription_checkout'\n  post 'webhook' =&gt; 'subscriptions#webhook'\n  get 'plans' =&gt; 'subscriptions#plans'\n  post 'cancel_subscription' =&gt; 'subscriptions#cancel_subscription'\n  get 'get_cities' =&gt; 'profiles#get_cities'\n  get 'turn_off_modal'=&gt; \"profiles#turn_off_modal\"\nend\n</code></pre>\n\n<p>I forgot to set up web hooks on the stripe dashboard, its asking me for a URL (<code>URL to be called</code>) to enter, according to these routes, what should the url be? im not sure what to use here?</p>\n"}, {"tags": ["ruby", "date", "strptime"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530096835, "post_id": 51060593, "comment_id": 89111781, "body": "The <code>2017</code> --&gt; <code>20</code> seems to be a more generic properly of the method: Any trailing characters are <i>always</i> ignored. You could do <code>Date.strptime(&#39;25&#47;01&#47;20 BLA BLA BLA&#39;, &#39;%Y&#47;%m&#47;%d&#39;)</code> and get the same result."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530096887, "post_id": 51060593, "comment_id": 89111822, "body": "As for why <code>25</code> is interpreted as <code>0025</code> rather than an error, however, is beyond me. From my understanding, <code>%Y</code> should require a <i>minimum</i> of 4 digits in order to be valid, but apparently that&#39;s not the case. Possibly a bug?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530096997, "post_id": 51060593, "comment_id": 89111898, "body": "You may find the answers in <a href=\"https://stackoverflow.com/a/39369104/1954610\">this question</a> relevant and helpful to your problem."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9999350, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rE55ACJOeUM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq07b4Um0hcldewFoNURw9THAc5gOQ/mo/photo.jpg?sz=128", "display_name": "Mathew Barnard", "link": "https://stackoverflow.com/users/9999350/mathew-barnard"}, "edited": false, "score": 0, "creation_date": 1530109515, "post_id": 51062450, "comment_id": 89120441, "body": "I ended up going down the initial regex check, followed by the striptime.  As Tom Lord said, I would have expected the %Y to expect 4 characters before the first forward slash, which to me is a fair assumption. How it actually works seems very counter intuitive to how the documentation describes it."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 33, "user_id": 9999350, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rE55ACJOeUM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq07b4Um0hcldewFoNURw9THAc5gOQ/mo/photo.jpg?sz=128", "display_name": "Mathew Barnard", "link": "https://stackoverflow.com/users/9999350/mathew-barnard"}, "edited": false, "score": 0, "creation_date": 1530184124, "post_id": 51062450, "comment_id": 89151005, "body": "@MathewBarnard see my first edit.  When I get to it I&#39;ll post more info about the C code details.  For now see the comment which says quite a lot about this function."}], "tags": [], "owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "is_accepted": true, "score": 1, "last_activity_date": 1530183903, "last_edit_date": 1530183903, "creation_date": 1530101313, "answer_id": 51062450, "question_id": 51060593, "link": "https://stackoverflow.com/questions/51060593/ruby-strptime-doesnt-throw-argumenterror-on-y-m-d-with-parameter-25-01-2017/51062450#51062450", "title": "Ruby strptime doesn&#39;t throw ArgumentError on %Y/%m/%d with parameter &#39;25/01/2017&#39;", "body": "<p>You have to think what you actually said:</p>\n\n<pre><code>Date.strptime('25/01/2017', '%Y/%m/%d')\n</code></pre>\n\n<p>You are saying that you want the year <code>0025</code>, month <code>01</code> and day <code>20</code> (it strips the rest).  In the end you get <code>0025-01-20</code>.</p>\n\n<p>You can not rely just on <code>Date.strptime</code> to do the validation for you.</p>\n\n<p>The best is to actually parse it via regexp and do the validation.</p>\n\n<p>For your format a possible regexp (an easy way):</p>\n\n<pre><code>'25/01/2017'.match(/\\d{4}\\/\\d{2}\\/\\d{2}/)\n</code></pre>\n\n<p>In your case you will get <code>nil</code>, because it does not match.</p>\n\n<p>If you get a match you will get:\n<code>#&lt;MatchData \"2017/01/25\"&gt;</code>.  </p>\n\n<p>The issue is that this does not check for the correct format of the date.  You still need to check if <code>strptime</code> can parse the result ( like the in the link provided by Tom Lord).</p>\n\n<p>On the other hand you can check it also with regexp only, which can be rather complex: (the following regex checks <code>yyyy/mm/dd</code> format):</p>\n\n<pre><code>^(?:(?:(?:(?:(?:[1-9]\\d)(?:0[48]|[2468][048]|[13579][26])|(?:(?:[2468][048]|[13579][26])00))(\\/)(?:0?2\\1(?:29)))|(?:(?:[1-9]\\d{3})(\\/)(?:(?:(?:0?[13578]|1[02])\\2(?:31))|(?:(?:0?[13-9]|1[0-2])\\2(?:29|30))|(?:(?:0?[1-9])|(?:1[0-2]))\\2(?:0?[1-9]|1\\d|2[0-8])))))$\n</code></pre>\n\n<p>Then you know if the date is in correct format right away and you don't have to check parse it with <code>strptime</code>.</p>\n\n<p><strong>Edit:</strong>  </p>\n\n<p>When dealing with time remember to <strong>always</strong> perform your own checks!  Don't rely on the function.  The problem with time is that you have many exceptions and even thou you have an ISO 8601 and maybe some others may applications do not follow it.</p>\n\n<p>Based on comment I'm want to dig deeper into <code>strptime</code>\nFor now I want to paste the comment in the source code (in date_s_strptime function and data_core.c):</p>\n\n<pre><code>/*\n * call-seq:\n *    Date.strptime([string='-4712-01-01'[, format='%F'[, start=Date::ITALY]]])  -&gt;  date\n *\n * Parses the given representation of date and time with the given\n * template, and creates a date object.  strptime does not support\n * specification of flags and width unlike strftime.\n *\n *    Date.strptime('2001-02-03', '%Y-%m-%d')   #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('03-02-2001', '%d-%m-%Y')   #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('2001-034', '%Y-%j')    #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('2001-W05-6', '%G-W%V-%u')  #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('2001 04 6', '%Y %U %w')    #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('2001 05 6', '%Y %W %u')    #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *    Date.strptime('sat3feb01', '%a%d%b%y')    #=&gt; #&lt;Date: 2001-02-03 ...&gt;\n *\n * See also strptime(3) and #strftime.\n */\n</code></pre>\n\n<p>You can see strings like sat/feb being used too, so there is no surprise the parser can deal with strings.  <strong>TO BE CONTINUED - digging into the C code</strong></p>\n"}], "owner": {"reputation": 33, "user_id": 9999350, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rE55ACJOeUM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq07b4Um0hcldewFoNURw9THAc5gOQ/mo/photo.jpg?sz=128", "display_name": "Mathew Barnard", "link": "https://stackoverflow.com/users/9999350/mathew-barnard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 51062450, "answer_count": 1, "score": 3, "last_activity_date": 1530183903, "creation_date": 1530095651, "last_edit_date": 1530096051, "question_id": 51060593, "link": "https://stackoverflow.com/questions/51060593/ruby-strptime-doesnt-throw-argumenterror-on-y-m-d-with-parameter-25-01-2017", "title": "Ruby strptime doesn&#39;t throw ArgumentError on %Y/%m/%d with parameter &#39;25/01/2017&#39;", "body": "<p>Found some strange behaviour today that I'm hoping someone can shed some light on.</p>\n\n<p>I'm using strptime to validate dates in an import file. In this case, I want to throw an error if a row in the file contains a date that doesn't fit the format %Y/%m/%d (2017/01/25).</p>\n\n<p>I call strptime as follows:</p>\n\n<pre><code>Date.strptime('25/01/2017', '%Y/%m/%d')\n</code></pre>\n\n<p>I expect this to fail, as 25 does not fit the criteria for the year. However this succeeds, providing a date as:</p>\n\n<p>0025, 01, 20</p>\n\n<p>If I swap the month and day around (01/25/2018), it fails, as it does detect that the month is invalid.</p>\n\n<p>So what gives? It seems bizarre that it not only creates this mental looking year (0025), but even crazier that it disregards the '17' from the end of the string without issue.</p>\n\n<p>Thanks in advance! :) </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mailto"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530111775, "post_id": 51060316, "comment_id": 89121947, "body": "I would recommend a service for bulk messaging. Mailgun does a nice job and it is fairly easy to integrate. If you are sending this level of mail a service is really your only option anyway otherwise you risk the potential of being flagged by as a spammer."}], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 1, "last_activity_date": 1530100311, "creation_date": 1530100311, "answer_id": 51062108, "question_id": 51060316, "link": "https://stackoverflow.com/questions/51060316/how-to-add-more-than-1000-email-address-using-mail-to/51062108#51062108", "title": "How to add more than 1000 email address using mail_to", "body": "<p>The <code>mailto:</code>(as any other URL) has a character limit for the URL, it's vary from browser to browser, or from E-Mail client to E-Mail client.</p>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 7485168, "user_type": "registered", "profile_image": "https://graph.facebook.com/1797273820298202/picture?type=large", "display_name": "Jok\u016bbas Brunonas Pu\u010dinskas", "link": "https://stackoverflow.com/users/7485168/jok%c5%abbas-brunonas-pu%c4%8dinskas"}, "is_accepted": false, "score": 0, "last_activity_date": 1530118042, "creation_date": 1530118042, "answer_id": 51067827, "question_id": 51060316, "link": "https://stackoverflow.com/questions/51060316/how-to-add-more-than-1000-email-address-using-mail-to/51067827#51067827", "title": "How to add more than 1000 email address using mail_to", "body": "<p>Please try to use JS. \nYou could have a HTML element with data attribute where all emails would be stored and then try this:</p>\n\n<pre><code>&lt;div id=\"my-mails-storing-element-id\" data-mails=\"person1@domain.com, person2@domain.com,person3@domain.com\"&gt;&lt;/div&gt;\n\nvar mailsDom = document.getElementById(\"my-mails-storing-element-id\")\nlocation.href = mailto:mailsDom.dataset.mails;\n</code></pre>\n\n<p>But it would be better if you create separate action in your controller to get those emails. Then you just need to make AJAX call to get mails data.</p>\n\n<p>I hope it'd help you. Please let me now if it worked (I've tried with Mailspring mail client and it worked)</p>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530118042, "creation_date": 1530094855, "last_edit_date": 1530100317, "question_id": 51060316, "link": "https://stackoverflow.com/questions/51060316/how-to-add-more-than-1000-email-address-using-mail-to", "title": "How to add more than 1000 email address using mail_to", "body": "<p>Currently i have the below code in index view</p>\n\n<pre><code>&lt;div id = \"GetEmails\"&gt;&lt;%= mail_to \"xyz@gmail.com\" do %&gt;&lt;strong&gt;Send Mail&lt;/strong&gt;&lt;% end %&gt;&lt;/div&gt;\n</code></pre>\n\n<p>In runtime, I am updating the value of mailto: which consists of more than 1000\n+email address</p>\n\n<p>Now, when I click on \"Send Mail\", outlook is not getting opened by copying all the email address in To: field</p>\n\n<p>But, if the number of email address are &lt; 100, the on click of \"Send Mail\" I am able to copy all the email address in To: filed</p>\n\n<p>Manually, I am able to copy more than 3000 email address.</p>\n\n<p>How do I get copy all the email address in To line by clicking \"Send Mail\".</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "object", "memory"], "comments": [{"owner": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1530093642, "post_id": 51059854, "comment_id": 89109644, "body": "what exactly are you trying to do??"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 1747, "user_id": 6800303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d86ffb4271b65f9121097792b5f77af1?s=128&d=identicon&r=PG&f=1", "display_name": "NitinSingh", "link": "https://stackoverflow.com/users/6800303/nitinsingh"}, "edited": false, "score": 0, "creation_date": 1530093728, "post_id": 51059854, "comment_id": 89109710, "body": "@I wanna save an object array to cookies, like this:  <code>cookies[:links] = JSON.generate(@array &lt;&lt; @object)</code> But when I do <code>JSON.parse(cookies[:links]).each do |value|</code>, I get some address string. I actually wanna get origin objects."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530094012, "post_id": 51059854, "comment_id": 89109928, "body": "Can you show what you have and what you want to fetch from it?"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530094232, "post_id": 51059854, "comment_id": 89110089, "body": "@JagdeepSingh I have that object&#39;s obejct_id and its address which is a string. I want to get its origin object."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530094275, "post_id": 51059854, "comment_id": 89110115, "body": "Do you mind adding actual values to the question?"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530094683, "post_id": 51059854, "comment_id": 89110376, "body": "@JagdeepSingh Yeah, I have already done this."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530094870, "post_id": 51059854, "comment_id": 89110478, "body": "Here <code>(value.to_s.split(&quot;:&quot;).last)[0..-2].inspect</code>, what does <code>value</code> return?"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530095043, "post_id": 51059854, "comment_id": 89110591, "body": "@JagdeepSingh return &quot;0x007f6f2b587b30&quot;, cry~~~~, I wanna it returns its origin object."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 1, "creation_date": 1530095129, "post_id": 51059854, "comment_id": 89110652, "body": "No, the value of <code>(value.to_s.split(&quot;:&quot;).last)[0..-2].inspect</code> is &quot;0x007...&quot;, but what is the value of variable <code>value</code>? Even before the whole chain of methods is called on it."}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530095752, "post_id": 51059854, "comment_id": 89111061, "body": "@JagdeepSingh <code>value</code> is &lt;#:0x007f6f2b587b30&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "edited": false, "score": 0, "creation_date": 1530105712, "post_id": 51061762, "comment_id": 89117683, "body": "You are awesome!"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "reply_to_user": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "edited": false, "score": 0, "creation_date": 1530105951, "post_id": 51061762, "comment_id": 89117883, "body": "No prob! Glad to help! :3"}], "tags": [], "owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "is_accepted": true, "score": 1, "last_activity_date": 1530100907, "last_edit_date": 1530100907, "creation_date": 1530099255, "answer_id": 51061762, "question_id": 51059854, "link": "https://stackoverflow.com/questions/51059854/ruby-how-to-fetch-origin-object-by-its-memory-address-or-by-object-id/51061762#51061762", "title": "Ruby, how to fetch origin object by its memory address or by object_id?", "body": "<p>I do not know a way to \"get\" the Object by <strong>memory address</strong> (i.e. your <code>0x007f6f2b587b30</code>),</p>\n\n<p>but you can \"get\" the Object by <strong><code>object_id</code></strong> using <code>ObjectSpace._id2ref(OBJECT_ID)</code>:</p>\n\n<h2>Solution:</h2>\n\n<p><em>Important: this still has inherit issues: see my recommendations below why.</em></p>\n\n<p><strong>app/controllers/gyms_controller.rb:</strong></p>\n\n<pre><code>class GymsController &lt; ApplicationController\n  @@gyms = Array.new\n  def private_page\n    ...\n    gym = @page\n    @@gyms &lt;&lt; gym\n    cookies.permanent[:gyms_object_ids] = gym.object_id\n  end\nend\n</code></pre>\n\n<p><strong>your view file:</strong></p>\n\n<pre><code>- content_for :title, \"History\"\n- breadcrumb :history\n= stylesheet_link_tag 'application'\n\n.outer\n  main.privacy-index\n    .content-wrapper\n      h1.headline2 History\u4e00\u89a7\n      - cookies.permanent[:gyms_object_ids]).reverse.each do |gym_object_id|\n        - gym = ObjectSpace._id2ref(gym_object_id.to_i)\n        = gym.title\n        = gym.images\n        br\n</code></pre>\n\n<h2>Recommendations:</h2>\n\n<ul>\n<li><p>use \"class instance-variable\" <code>@gyms</code> instead of \"class class-variable\" <code>@@gyms</code>. See why <a href=\"https://stackoverflow.com/questions/3802540/difference-between-class-variables-and-class-instance-variables\">here</a>.</p></li>\n<li><p>if your <code>@page</code> variable above in your controller, is not a record (being that it does not correspond to any of the models you have, and thus is not saved in the DB), then create a model for it, so that you can save it into the DB, and retrieve these data in your views above through the model's record <code>id</code>, and therefore no longer by <code>object_id</code>.</p>\n\n<p>This would allow you to solve the following issues of my Solution\nabove:</p>\n\n<ul>\n<li><p>Objects reside in memory, and are subject to garbage collection. Therefore using <code>ObjectSpace._id2ref(OBJECT_ID)</code> is probably gonna fail at times if the Object is already garbage-collected. (<a href=\"https://stackoverflow.com/questions/13508536/errors-from-objectspace-id2ref\">see this SO</a>), because <code>ObjectSpace._id2ref</code> above in my solution code runs at different code of execution than where the object is originally defined:</p>\n\n<ul>\n<li>one is in the controller where <code>@page</code> object is defined (some request1 / say thread1),</li>\n<li>the other one is in the view file where <code>ObjectSpace._id2ref()</code> tries to get that object (some request2 / say thread2),</li>\n</ul></li>\n<li><p>in your code, you are using <code>@@gyms = Array.new</code>, which means that <code>@@gyms</code> (being stored in-memory) is not gonna be accessible to other rails processes because memory is not shared between these processes, and to put simply means that <code>@@gyms</code> would have <strong>DIFFERENT!</strong> values for each of the following processes:</p>\n\n<ul>\n<li>rails server #1 (say... unicorn-1 in server1)</li>\n<li>rails server #2 (say... unicorn-2 in server1)</li>\n<li>rails server #3 (say... unicorn-3 in server2)</li>\n<li>background worker process #1 (say... sidekiq-1)</li>\n<li>background worker process #2 (say... sidekiq-2)</li>\n<li>etc...</li>\n</ul>\n\n<p>...whereas if you instead save the <code>gyms</code> (if possible and if necessary only) into a model and that these gym records belong to a user, then I would imagine doing something like below instead (which will solve these potential differing values above, and will no longer require you to use cookies):</p>\n\n<pre><code>class Gym &lt; ApplicationRecord\n  has_many :gyms_users\n  has_many :users, through: :gyms_users\nend\n\nclass GymsUser &lt; ApplicationRecord\n  belongs_to :gym\n  belongs_to :user\n  validates :user, uniqueness: { scope: :gym }\nend\n\nclass User &lt; ApplicationRecord\n  has_many :gyms_users\n  has_many :gyms, through: :gyms_users\nend\n</code></pre></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 51061762, "answer_count": 1, "score": 0, "last_activity_date": 1530100907, "creation_date": 1530093606, "last_edit_date": 1530094533, "question_id": 51059854, "link": "https://stackoverflow.com/questions/51059854/ruby-how-to-fetch-origin-object-by-its-memory-address-or-by-object-id", "title": "Ruby, how to fetch origin object by its memory address or by object_id?", "body": "<p>For example, the address is \"0x007f6f0954e820\" string, how to get actual object?</p>\n\n<p>I write these:\nin GymsController</p>\n\n<pre><code>class GymsController &lt; ApplicationController\n  @@gyms = Array.new\n  def private_page\n    ...\n    cookies.permanent[:gyms] = JSON.generate(@@gyms &lt;&lt; @page)\n  end\nend\n</code></pre>\n\n<p>and in history.html.slim</p>\n\n<pre><code>- content_for :title, \"History\"\n- breadcrumb :history\n= stylesheet_link_tag 'application'\n\n.outer\n  main.privacy-index\n    .content-wrapper\n      h1.headline2 History\u4e00\u89a7\n      - JSON.parse(cookies.permanent[:gyms]).reverse.each do |value|\n        = (value.to_s.split(\":\").last)[0..-2].inspect\n        br\n</code></pre>\n\n<p><code>(value.to_s.split(\":\").last)[0..-2].inspect</code> is \"0x007f6f2b587b30\"\nBut I wanna get real object, and do like <code>value.title</code>, <code>value.images</code></p>\n"}, {"tags": ["ruby", "activerecord", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 497, "user_id": 3979725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj52I.jpg?s=128&g=1", "display_name": "David Lilue", "link": "https://stackoverflow.com/users/3979725/david-lilue"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530093921, "post_id": 51059716, "comment_id": 89109857, "body": "I forgot to mention that I&#39;m using Rails 5.2.0 @SergioTulentsev"}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 3979725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj52I.jpg?s=128&g=1", "display_name": "David Lilue", "link": "https://stackoverflow.com/users/3979725/david-lilue"}, "edited": false, "score": 0, "creation_date": 1530094779, "post_id": 51060076, "comment_id": 89110431, "body": "I see, but how do I iterate over the relation? Can it be done?"}, {"owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "reply_to_user": {"reputation": 497, "user_id": 3979725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj52I.jpg?s=128&g=1", "display_name": "David Lilue", "link": "https://stackoverflow.com/users/3979725/david-lilue"}, "edited": false, "score": 0, "creation_date": 1530095048, "post_id": 51060076, "comment_id": 89110595, "body": "yes, you can use any <code>ActiveRecord::Relation</code> method"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530095124, "post_id": 51060076, "comment_id": 89110647, "body": "@Rodrigo: not any, though. You can do <code>MyModel.all.map(...)</code>, but you can&#39;t put the <code>map</code> in <code>stats</code> (or, at least, it doesn&#39;t work on my machine). This magical method proxying is not the easiest thing to grasp."}, {"owner": {"reputation": 497, "user_id": 3979725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj52I.jpg?s=128&g=1", "display_name": "David Lilue", "link": "https://stackoverflow.com/users/3979725/david-lilue"}, "edited": false, "score": 0, "creation_date": 1530095270, "post_id": 51060076, "comment_id": 89110752, "body": "@Rodrigo, when I try to use <code>each</code>, gives me the following error <code>undefined method `each&#39; for MyModel (call &#39;MyModel.connection&#39; to establish a connection):Class</code>"}, {"owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "edited": false, "score": 0, "creation_date": 1530095416, "post_id": 51060076, "comment_id": 89110847, "body": "use <code>find_each</code>. If you use <code>each</code> it won&#39;t work when you&#39;re in a unescoped"}], "tags": [], "owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1530095151, "last_edit_date": 1530095151, "creation_date": 1530094205, "answer_id": 51060076, "question_id": 51059716, "link": "https://stackoverflow.com/questions/51059716/define-activerecord-method-to-work-with-different-activerecord-relations-in-ruby/51060076#51060076", "title": "Define ActiveRecord method to work with different ActiveRecord Relations in Ruby on Rails", "body": "<p>Yes, the scope inside the <code>stats</code> method will be the Relation </p>\n\n<pre><code>def self.stats\n  count\nend\n\nMyModel.all.stats \n# =&gt; 10\nMyModel.where(\"created_at &gt; ?\", 1.day.ago).stats\n# =&gt; 5\n</code></pre>\n\n<p>Here is a good resource <a href=\"http://blog.plataformatec.com.br/2013/02/active-record-scopes-vs-class-methods/\" rel=\"nofollow noreferrer\">http://blog.plataformatec.com.br/2013/02/active-record-scopes-vs-class-methods/</a></p>\n\n<p>If you want to iterate over the records, you could use the <code>find_each</code> method:</p>\n\n<pre><code>def self.stats\n  find_each do |my_model|\n    puts my_model.id\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 3979725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj52I.jpg?s=128&g=1", "display_name": "David Lilue", "link": "https://stackoverflow.com/users/3979725/david-lilue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 51060076, "answer_count": 1, "score": 2, "last_activity_date": 1530095151, "creation_date": 1530093253, "last_edit_date": 1530094491, "question_id": 51059716, "link": "https://stackoverflow.com/questions/51059716/define-activerecord-method-to-work-with-different-activerecord-relations-in-ruby", "title": "Define ActiveRecord method to work with different ActiveRecord Relations in Ruby on Rails", "body": "<p>Let say that we have a method in a </p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n    def self.stats\n        # do something and returns a hash\n    end\nend\n</code></pre>\n\n<p>The method needs to iterate over the records and possibly call <code>each</code>.</p>\n\n<p>I want to use this method with <code>scopes</code>, <code>where</code>, <code>all</code>, etc. Like following:</p>\n\n<pre><code>MyModel.all.stats\n#=&gt; one hash\nMyModel.where(\"created_at &gt; ?\", 1.day.ago).stats\n#=&gt; another hash\nMyModel.funny.stats\n#=&gt; funny hash\n...\n</code></pre>\n\n<p>Is this possible? I need to pass the <code>ActiveRecord Relation</code> as a parameter or the scopes as parameters?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "sti"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1530092383, "post_id": 51059326, "comment_id": 89108863, "body": "You&#39;re testing Rails or Ruby itself at this point, no? What else could it be?"}, {"owner": {"reputation": 39, "user_id": 2380766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hOd2a.jpg?s=128&g=1", "display_name": "Broquel", "link": "https://stackoverflow.com/users/2380766/broquel"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1530093001, "post_id": 51059326, "comment_id": 89109246, "body": "The reason why I might need the validation is because you can instantiate a valid role: <code>role = Role.new(type: &#39;Observer&#39;)</code> And then update it with <code>role.update(type: &#39;Necromancer&#39;)</code>, which then persists and invalid object.  All further calls to instantiate the record from the DB then return: <code>ActiveRecord::SubclassNotFound: The single-table inheritance mechanism failed to locate the subclass: &#39;Necromancer&#39;.</code>"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1530100269, "post_id": 51059326, "comment_id": 89113839, "body": "When I&#39;ve used STI, which is very rarely, the type has been controlled, and the system wasn&#39;t abused by creating instances of the parent class. If the system is built in such a way that the parent class is exposed like this, validation is a good idea (or just attempt to instantiate and rescue)."}, {"owner": {"reputation": 442, "user_id": 37140, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9a7cd672f2275ae645751d3827e2b5be?s=128&d=identicon&r=PG", "display_name": "Chris Mitchell", "link": "https://stackoverflow.com/users/37140/chris-mitchell"}, "edited": false, "score": 0, "creation_date": 1614438344, "post_id": 51059326, "comment_id": 117388144, "body": "@Broquel I know this question is a few years old but has your custom validation still been the best way to go about making sure the parent class type attribute is the subclasses/descendants?"}], "owner": {"reputation": 39, "user_id": 2380766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hOd2a.jpg?s=128&g=1", "display_name": "Broquel", "link": "https://stackoverflow.com/users/2380766/broquel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1530092183, "creation_date": 1530092183, "question_id": 51059326, "link": "https://stackoverflow.com/questions/51059326/when-using-activerecord-sti-how-do-i-and-should-i-validate-for-inclusion-in", "title": "When using ActiveRecord STI, how do I (and should I?) validate for inclusion in subclasses?", "body": "<p>I'm currently using single table inheritance in the following model for roles:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># app/models/role.rb\nclass Role &lt; ApplicationRecord\n  # ...\nend\n\nclass Observer &lt; Role; end\nclass Manager &lt; Role; end\nclass Owner &lt; Role; end\n</code></pre>\n\n<p>I tried adding a constant to check for inclusion at the top of the class:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Role &lt; ApplicationRecord\n  ROLE = subclasses.map(&amp;:name)\n\n  # and\n\n  validates :type, inclusion: { in: ROLE }\n\n  # ...\nend\n</code></pre>\n\n<p>But this gets me <code>ROLE # =&gt; []</code>, as the subclasses are loaded after its build.</p>\n\n<p>I currently got it to work by using a custom validation method with AR:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Role &lt; ApplicationRecord\n  validate :subclass_check\n\n  # ...\n\n  private\n\n  def subclass_check\n    return true if Role.subclasses.map(&amp;:name).include?(type)\n    errors.add(:type, \"#{type} is not a type of Role\")\n  end\nend\n</code></pre>\n\n<p>But I still get the feeling that I'm either doing something janky, reinventing the wheel, or both.</p>\n\n<p>So, how do I (and should I?) validate for inclusion in subclasses on update?</p>\n"}, {"tags": ["ruby", "report", "prawn"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1530093347, "post_id": 51058790, "comment_id": 89109464, "body": "You can explicitly state x and y co-ordinates which takes a while but I&#39;ve had to do before"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1530093358, "post_id": 51058790, "comment_id": 89109473, "body": "text &#39;date&#39;, at: [470, 655]"}, {"owner": {"reputation": 832, "user_id": 5594180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iv01N.png?s=128&g=1", "display_name": "Sa\u0161a Zejnilovi\u0107", "link": "https://stackoverflow.com/users/5594180/sa%c5%a1a-zejnilovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1530129484, "post_id": 51058790, "comment_id": 89130838, "body": "You should have a look <a href=\"https://idiosyncratic-ruby.com/49-what-the-format.html\" rel=\"nofollow noreferrer\">here</a> for ruby string formating"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 3078727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a92a688670a3d5c2524b89df9e75c4?s=128&d=identicon&r=PG&f=1", "display_name": "sLeitner", "link": "https://stackoverflow.com/users/3078727/sleitner"}, "is_accepted": true, "score": 3, "last_activity_date": 1531756923, "last_edit_date": 1592644375, "creation_date": 1531755924, "answer_id": 51365635, "question_id": 51058790, "link": "https://stackoverflow.com/questions/51058790/align-multiple-text-ruby-prawn-report/51365635#51365635", "title": "Align multiple text ruby prawn report", "body": "<h3>Aligning strings to the left and right in the same line</h3>\n<p>To have one string aligned to the left and another aligned to the right in the same line you could use <a href=\"https://www.rubydoc.info/github/sandal/prawn/Prawn%2FDocument:float\" rel=\"nofollow noreferrer\">float</a>.<br />\n<code>float</code> resets the cursor after printing a given text, meaning if you didn't use <code>align: :right</code> for the next text, it would be on the same spot as the first text, but if you do use the <code>align: :right</code> it results in what I believe you are asking for.<br />\nIf you want &quot;Spett.le&quot; and the date in the same line for example:</p>\n<pre><code>float { text &quot;Data: #{stringDate}&quot;, align: :left }\ntext 'Spett.le', align: :right\n</code></pre>\n<hr />\n<p>Of course you can also specify coordinates for everything, like suggested in some comments, and build the layout you want that way, but I find this solution here easier to use and maintain.</p>\n"}], "owner": {"reputation": 852, "user_id": 10278268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf8aa8059c16c71add4cc26c3b27285?s=128&d=identicon&r=PG&f=1", "display_name": "riki", "link": "https://stackoverflow.com/users/10278268/riki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 51365635, "answer_count": 1, "score": 1, "last_activity_date": 1531756923, "creation_date": 1530090642, "question_id": 51058790, "link": "https://stackoverflow.com/questions/51058790/align-multiple-text-ruby-prawn-report", "title": "Align multiple text ruby prawn report", "body": "<p>Hi I'm creating a PDF with prawn, how can I do to align the texts here that you see in the image below at the same height?</p>\n\n<p><strong>PDF Image:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/4Dhoe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Dhoe.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Ruby Code:</strong></p>\n\n<pre><code>Prawn::Document.generate(\"my.pdf\") do\n  image logo,:width=&gt;540,:height=&gt;60\n  text \"Spett.le \",:align=&gt;:right\n  move_down 5\n  text \"\\n\"+ragionesociale, :align =&gt; :right\n  text \"Data:  \"+stringDate\n  move_down 10\n  text \"Nome Cantiere:     \"+nomecantiere\n  move_down 30\n  text \"Note: \"+note\n  move_down 30\n  end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "gitlab-ci", "ruby-on-rails-5.1", "ruby-on-rails-5.2"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "edited": false, "score": 0, "creation_date": 1530089836, "post_id": 51058299, "comment_id": 89107258, "body": "Thanks for the immediate response @Marek Lipka. After adding the master.key now i getting the <code>ArgumentError: key must be 16 bytes</code>"}, {"owner": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "edited": false, "score": 0, "creation_date": 1530152112, "post_id": 51058299, "comment_id": 89137003, "body": "I have configured <code>&quot;$RAILS_MASTER_KEY&quot; &gt; config&#47;master.key</code>. It ended up in the <code>ArgumentError: key must be 16 bytes</code> error"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "edited": false, "score": 0, "creation_date": 1531291588, "post_id": 51058299, "comment_id": 89535192, "body": "Are you sure you set <code>RAILS_MASTER_KEY</code> env variable in your CI environment?"}, {"owner": {"reputation": 283, "user_id": 216660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72588b9d8ee53f798025ea760413973b?s=128&d=identicon&r=PG", "display_name": "oskarpearson", "link": "https://stackoverflow.com/users/216660/oskarpearson"}, "reply_to_user": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "edited": false, "score": 0, "creation_date": 1534197382, "post_id": 51058299, "comment_id": 90616399, "body": "@Aravi Your RAILS_MASTER_KEY value needs to be exactly 32 bytes. See <a href=\"https://github.com/rails/rails/issues/33528#issuecomment-412677795\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/33528#issuecomment-412677795</a>"}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 2, "last_activity_date": 1530088964, "creation_date": 1530088964, "answer_id": 51058299, "question_id": 51058178, "link": "https://stackoverflow.com/questions/51058178/rails-5-2-encrypted-credentials-for-production-environment/51058299#51058299", "title": "Rails 5.2 Encrypted credentials for production environment", "body": "<p>You can put your master key as <code>MASTER_KEY</code> secret variable in Gitlab CI/CD Settings and then put </p>\n\n<pre><code>echo \"$MASTER_KEY\" &gt; config/master.key\n</code></pre>\n\n<p>in <code>before_script</code> section of your <code>.gitlab-ci.yml</code> file.</p>\n"}, {"comments": [{"owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "edited": false, "score": 0, "creation_date": 1530116631, "post_id": 51067067, "comment_id": 89124742, "body": "for more info you can check this <a href=\"https://medium.com/@praaveen/part-1-rails5-2-credentials-encrypted-credentials-662c6e375fdb\" rel=\"nofollow noreferrer\">medium.com/@praaveen/&hellip;</a> blog"}, {"owner": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "edited": false, "score": 0, "creation_date": 1530164498, "post_id": 51067067, "comment_id": 89139865, "body": "I have configured &quot;$RAILS_MASTER_KEY&quot; &gt; config/master.key. It ended up in the ArgumentError: key must be 16 bytes error  -"}, {"owner": {"reputation": 873, "user_id": 616723, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9f06775156b6cb6536330640e14a24c?s=128&d=identicon&r=PG", "display_name": "Texas", "link": "https://stackoverflow.com/users/616723/texas"}, "edited": false, "score": 0, "creation_date": 1539244695, "post_id": 51067067, "comment_id": 92433331, "body": "Hi @Praveen, when you say &quot;Scp or sftp the file &quot; in the section on Managing your Key - how would you typically do this?  I have tried using Filezilla, but the <code>master.key</code> isn&#39;t visible on my local machine (due to its file extension I expect) and I also don&#39;t have permission to access the target folder on the server <code>&#47;app_name&#47;shared&#47;config</code>.  I&#39;ve seen mention of doing this using a rake task, but wondered if there was a simpler way?"}, {"owner": {"reputation": 4019, "user_id": 767033, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/07fa4dc36952b149cdfe7c140ff08fc5?s=128&d=identicon&r=PG", "display_name": "Chris.Zou", "link": "https://stackoverflow.com/users/767033/chris-zou"}, "edited": false, "score": 0, "creation_date": 1576049358, "post_id": 51067067, "comment_id": 104767735, "body": "The addtional information is super helpful. Thank you!"}], "tags": [], "owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "is_accepted": false, "score": 5, "last_activity_date": 1530116701, "last_edit_date": 1530116701, "creation_date": 1530115158, "answer_id": 51067067, "question_id": 51058178, "link": "https://stackoverflow.com/questions/51058178/rails-5-2-encrypted-credentials-for-production-environment/51067067#51067067", "title": "Rails 5.2 Encrypted credentials for production environment", "body": "<p>Im sharing few points which may help you</p>\n\n<p>Encrypted credentials offer a few advantages over plaintext credentials or environment variables</p>\n\n<p><strong>Rails 5.1 introduced encrypted secrets</strong></p>\n\n<blockquote>\n  <p>config/secrets.yml.key<br>\n  config/secrets.yml.enc</p>\n</blockquote>\n\n<p><strong>Rails 5.2 replaces both secrets with encrypted credentials</strong></p>\n\n<blockquote>\n  <p>config/credentials.yml.enc<br>\n  config/master.key</p>\n</blockquote>\n\n<p>config/master.key file is created while creating a rails project</p>\n\n<p>Encryption key(master.key) is git ignored</p>\n\n<p><strong>In production</strong></p>\n\n<p>config/environments/production.rb</p>\n\n<pre><code>config.require_master_key = true\n</code></pre>\n\n<p>Can\u2019t decrypt your credentials without the key</p>\n\n<p><strong>Managing the Key</strong></p>\n\n<p>a. scp or sftp the file</p>\n\n<p>b. If you need to give a developer a copy of the key then You can use a password manager because they use encryption.</p>\n\n<p>c. I used last pass for managing the master key file</p>\n\n<p><strong>The key used to encrypt credentials is different from the secret key base.</strong></p>\n\n<p>The key on master.key is used to encrypt and decrypt all credentials. It does not replace the secret key base.</p>\n\n<p>The secret key base is required by Rails. If you want to generate a new secret key base run,</p>\n\n<pre><code>bin/rails secret\n</code></pre>\n\n<p>and add that to your credentials by running bin/rails credentials:edit.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14864959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OcQ_zl849S4/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuck7Cj99_eNyfMQJGhh7rFXD6dpCww/s96-c/photo.jpg?sz=128", "display_name": "Ashish Sharma", "link": "https://stackoverflow.com/users/14864959/ashish-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1608667220, "creation_date": 1608667220, "answer_id": 65415107, "question_id": 51058178, "link": "https://stackoverflow.com/questions/51058178/rails-5-2-encrypted-credentials-for-production-environment/65415107#65415107", "title": "Rails 5.2 Encrypted credentials for production environment", "body": "<pre><code>Rails.application.credentials.development&amp;.dig(:secret_key_base)\n</code></pre>\n<p>try this instead.</p>\n"}], "owner": {"reputation": 1030, "user_id": 5935209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/372bdc340961029abda8337459567a4e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind", "link": "https://stackoverflow.com/users/5935209/aravind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7887, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1608667220, "creation_date": 1530088543, "question_id": 51058178, "link": "https://stackoverflow.com/questions/51058178/rails-5-2-encrypted-credentials-for-production-environment", "title": "Rails 5.2 Encrypted credentials for production environment", "body": "<p>I have created the new Rails app with the version of 5.2. Rails 5.2 introduced the encryption feature for the secrets. </p>\n\n<p>I have configured the secret key in devise.rb file</p>\n\n<blockquote>\n  <p>config.secret_key = Rails.application.credentials[Rails.env.to_sym][:secret_key_base]</p>\n</blockquote>\n\n<p>and also added the secret_key's for all environments using </p>\n\n<blockquote>\n  <p>EDITOR=vim rails credentials:edit</p>\n</blockquote>\n\n<pre><code>development:\n secret_key_base: absdss\n\ntest:\n secret_key_base: 123232\n\nproduction:\n secret_key_base: 123456\n</code></pre>\n\n<p>after the saving the credentials i can able to get the secret_key's in the rails console in local </p>\n\n<p>Output in rails console:</p>\n\n<pre><code>Running via Spring preloader in process 44308\nLoading development environment (Rails 5.2.0)\n2.5.1 :001 &gt; Rails.application.credentials.development[:secret_key_base]\n=&gt;     \"absdss\" \n</code></pre>\n\n<p>The credentials are not working on production server, we are using CI/CD in gitlab for deployment stages, when i run the </p>\n\n<blockquote>\n  <p>rails db:create db:migrate</p>\n</blockquote>\n\n<p>i am getting the following error</p>\n\n<pre><code>&gt; rails db:create db:migrate\n\n ---&gt; Running in 1563453ddf2a\n\nrails aborted!\n\nNoMethodError: undefined method `[]' for nil:NilClass\n\n/usr/src/app/config/initializers/devise.rb:12:in `block in &lt;main&gt;'\n\n/usr/local/bundle/gems/devise-4.4.3/lib/devise.rb:307:in `setup'\n\n/usr/src/app/config/initializers/devise.rb:5:in `&lt;main&gt;'\n\n/usr/local/bundle/gems/bootsnap-1.3.0/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:50:in `load'\n</code></pre>\n\n<p>Now the question is how to set the RAILS_MASTER_KEY to production server?</p>\n"}, {"tags": ["ruby", "cmd", "buildpack", "rubyzip"], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530092984, "post_id": 51058366, "comment_id": 89109234, "body": "Thx @tukan! I added to PATH variable 7-ZIP path, but that did not solved the issue. Is there a special way to install a ZIP app on Windows.. to have which gem (that you mentioned above) find it, or is there a special ZIP app for this?"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 1, "creation_date": 1530096270, "post_id": 51058366, "comment_id": 89111417, "body": "@Andr: As you may have noticed the <code>which</code> tool is originally a unix tool.  First step is to have the <code>which</code> tool installed on your system.  Do you have it?  If you have it then you can check your current path with <code>@path</code>.  (Don&#39;t forget that if you change path you need to restart your cmd so the new path will be reflected)"}, {"owner": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530096435, "post_id": 51058366, "comment_id": 89111528, "body": "Thx @tukan: understand. I have the which command installed on my machine. I checked and found it based on your answer (thx!!). I&#39;m on windows right now.. and would like to remain on win. I would like to install a zip that &#39;which&#39; will find. Not sure how I can do that. 7-zip is on my workstation, added to path variable.. restarted cmd... but which zip drops the same error..."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530096478, "post_id": 51058366, "comment_id": 89111548, "body": "In my example I have path <code>C:\\app\\oracle\\client11g\\product\\11.2.0\\client\\bin</code> in my <code>PATH</code> environment variable.  If I check it with <code>dir zip*</code>, I get  <code>C:\\app\\oracle\\client11g\\product\\11.2.0\\client\\bin</code> -&gt; <code>zip.exe</code>"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530096569, "post_id": 51058366, "comment_id": 89111611, "body": "the easiest way to get <code>which</code> script on your windows is to use <code>MSYS2</code> - <a href=\"https://www.msys2.org/\" rel=\"nofollow noreferrer\">msys2.org</a>"}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 1, "creation_date": 1530096698, "post_id": 51058366, "comment_id": 89111687, "body": "@Andr yes that is indeed the problem.  The script is checking for <code>zip</code> if you need to check for 7z you would need to adjust it to <code>which 7z</code> or install zip.exe which you need."}, {"owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "reply_to_user": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530096954, "post_id": 51058366, "comment_id": 89111865, "body": "to get zip for windows and command line - <a href=\"https://sourceforge.net/projects/infozip/files/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/infozip/files</a>"}, {"owner": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "edited": false, "score": 0, "creation_date": 1530097386, "post_id": 51058366, "comment_id": 89112142, "body": "found zip.exe on my system: C:\\Program Files (x86)\\C4ebreg. Thx @tukan for your help! Issue solved!"}], "tags": [], "owner": {"reputation": 13101, "user_id": 6059896, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQiTP.gif?s=128&g=1", "display_name": "tukan", "link": "https://stackoverflow.com/users/6059896/tukan"}, "is_accepted": true, "score": 1, "last_activity_date": 1530090255, "last_edit_date": 1530090255, "creation_date": 1530089170, "answer_id": 51058366, "question_id": 51058159, "link": "https://stackoverflow.com/questions/51058159/ruby-zip-is-not-installed-error-message-when-running-on-win-cmd-this-buildpa/51058366#51058366", "title": "Ruby: &#39;Zip is not installed&#39; error message when running on Win CMD this: buildpack-packager --uncached", "body": "<p>Please don't use pictures or screenshots in your post.  Use plaintext only.</p>\n\n<p>I think you are misunderstanding the code:</p>\n\n<p><code>_, _, status = Open3.capture3('which zip')</code></p>\n\n<p>It checks if you have any zip program (executable) installed not a ruby gem (library).  It actually executes <code>which zip</code> in your cmd shell.</p>\n\n<p>For example on my system it found an oracle one:</p>\n\n<pre><code>c:\\&gt; which zip\n/c/app/oracle/client11g/product/11.2.0/client/bin/zip\n</code></pre>\n\n<p>Then if you test it in <code>irb</code>:</p>\n\n<pre><code>irb(main):004:0&gt; _, _, status = Open3.capture3('which zip')\n=&gt; [\"/c/app/oracle/client11g/product/11.2.0/client/bin/zip\\n\", \"\", #&lt;Process::Status: pid 10944 exit 0&gt;]\n</code></pre>\n\n<p>You can see that the executable was found and success state is indicated by the <code>0</code>.  The variable <code>status</code> holds the return message - <code>status =&gt; #&lt;Process::Status: pid 10944 exit 0&gt;</code></p>\n\n<p>I have the <code>which</code> program from <code>dev_kit</code>:</p>\n\n<pre><code> c:\\&gt;which which\n/c/prg_sdk/ruby/dev_kit/bin/which\n</code></pre>\n"}], "owner": {"reputation": 88, "user_id": 9241543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c295550999aed6351ab527be6d61fc00?s=128&d=identicon&r=PG&f=1", "display_name": "Andr", "link": "https://stackoverflow.com/users/9241543/andr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 51058366, "answer_count": 1, "score": 0, "last_activity_date": 1530090337, "creation_date": 1530088486, "last_edit_date": 1592644375, "question_id": 51058159, "link": "https://stackoverflow.com/questions/51058159/ruby-zip-is-not-installed-error-message-when-running-on-win-cmd-this-buildpa", "title": "Ruby: &#39;Zip is not installed&#39; error message when running on Win CMD this: buildpack-packager --uncached", "body": "<p>I'm running cmd command <code>buildpack-packer --uncached</code> (or any other option of buildpack-packer). I had many error messages prior that. They were caused by bad content of manifest.yml. I corrected them. So now I receive this error message: <code>Zip is not installed (RuntimeError)</code></p>\n<p><a href=\"https://i.stack.imgur.com/VK2hY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VK2hY.png\" alt=\"enter image description here\" /></a></p>\n<p>I used <code>gem install</code> to install zip gem and rubyzip gem (as first did not work, so I tried a second). So now both not helping to get rid of this error message.</p>\n<p>Here is a part of the installed gem list:</p>\n<p><a href=\"https://i.stack.imgur.com/IE8EW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IE8EW.png\" alt=\"enter image description here\" /></a></p>\n<p>And here is the code that drops this error (found it based on the error message in file: <code>C:/Ruby24-x64/lib/ruby/gems/2.4.0/gems/buildpack-packager-2.3.4/lib/buildpack/packager.rb</code>):</p>\n<p><a href=\"https://i.stack.imgur.com/foWxy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/foWxy.png\" alt=\"enter image description here\" /></a></p>\n<p>I'm quite new in Ruby, so maybe I do some very basic mistake...</p>\n<p>Thx in advance!!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "cookies", "controller", "store"], "comments": [{"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530083611, "post_id": 51056463, "comment_id": 89103697, "body": "@JagdeepSingh it isn&#39;t answer which I want"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1530083662, "post_id": 51056463, "comment_id": 89103730, "body": "@ShaoKahn sure it is, check the second to the marked as correct answer. Use <code>JSON.serialize</code>, arrays cannot be stored in cookies as is, that is not how cookie works."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1530083729, "post_id": 51056463, "comment_id": 89103776, "body": "<b>tl;dr</b> Rails doesn&#39;t handle it for you out of the box, hence cookies will always be strings. It&#39;s up to you how you want to serialize and deserialize your objects to and from said string."}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530083781, "post_id": 51056463, "comment_id": 89103803, "body": "@mudasobwa Thank you"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530085112, "post_id": 51056463, "comment_id": 89104513, "body": "@mudasobwa but when I parse and do each, the value is a string not an object!"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530085875, "post_id": 51056463, "comment_id": 89104973, "body": "You should <code>JSON.generate</code> <i>before</i> storing and <code>JSON.parse</code> <i>after</i> loading."}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530089123, "post_id": 51056463, "comment_id": 89106829, "body": "@mudasobwa Now question is, I want push an object to an array when user click a link, and save this array to cookies, finally fetch this array from cookies in another controller. But I find JSON.generate just can add a complete array."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530090646, "post_id": 51056463, "comment_id": 89107737, "body": "Store the array in the instance variable <code>@links</code> and do <code>cookies[:links] = JSON.generate(@links &lt;&lt; &quot;xxx&quot;)</code>."}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "edited": false, "score": 0, "creation_date": 1530091565, "post_id": 51056463, "comment_id": 89108317, "body": "Yeah, but I get some object_ids, how can I convert these object_id to real objects!"}, {"owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530092011, "post_id": 51056463, "comment_id": 89108611, "body": "@mudasobwa I wanna <code>@links &lt;&lt; @xxx</code> !, so I don&#39;t know how to fetch real objects"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1530093422, "post_id": 51056463, "comment_id": 89109513, "body": "I do not follow anymore. Please open other question if you have other issue."}], "owner": {"reputation": 37, "user_id": 9970746, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EcTeoxuR1Hc/AAAAAAAAAAI/AAAAAAAAAAc/AyTecg_yrnA/photo.jpg?sz=128", "display_name": "Shao Kahn", "link": "https://stackoverflow.com/users/9970746/shao-kahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1530083725, "answer_count": 0, "score": 0, "last_activity_date": 1530083731, "creation_date": 1530082936, "last_edit_date": 1530083731, "question_id": 51056463, "link": "https://stackoverflow.com/questions/51056463/storing-retrieving-values-in-a-rails-cookie-and-in-different-controller", "closed_reason": "Duplicate", "title": "Storing/Retrieving values in a Rails cookie and in different controller", "body": "<p>If I write cookies in this controller method:</p>\n\n<pre><code>class xxx1Controller &lt; ApplicationController\n  def xxx1\n    cookies[:links] = []\n    cookies[:links] &lt;&lt; \"xxx\"\n  end\nend\n</code></pre>\n\n<p>So I want the cookies[:links] is an array now, but if I fetch value in another controller:</p>\n\n<pre><code> class xxx2Controller &lt; ApplicationController\n      def xxx1\n        @xx2 = cookies[:links] \n      end\n end\n</code></pre>\n\n<p>This give me an error, it says cookies[:links] in xxx2Controller is still a string!\nHow to fix this? I can't use an indirect variable, because it will die after restart server. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 779, "user_id": 1010746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12532c1224ff2ab2260e853258deddb?s=128&d=identicon&r=PG", "display_name": "neongrau", "link": "https://stackoverflow.com/users/1010746/neongrau"}, "edited": false, "score": 0, "creation_date": 1530086639, "post_id": 51056382, "comment_id": 89105439, "body": "maybe look a this question. Looks like exactly the same goal to me. <a href=\"https://stackoverflow.com/questions/33202735/how-to-extract-text-from-script-tag-by-using-nokogiri-and-mechanize\" title=\"how to extract text from script tag by using nokogiri and mechanize\">stackoverflow.com/questions/33202735/&hellip;</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530091253, "post_id": 51056382, "comment_id": 89108114, "body": "&quot;enter image description here&quot; - you&#39;re supposed to enter image description there."}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4823919, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31d1f14b813262b3e237b2a522a53a2?s=128&d=identicon&r=PG", "display_name": "Gokul p", "link": "https://stackoverflow.com/users/4823919/gokul-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1530091109, "creation_date": 1530091109, "answer_id": 51058936, "question_id": 51056382, "link": "https://stackoverflow.com/questions/51056382/search-through-raw-code-for-script-tags-in-ruby-on-rails/51058936#51058936", "title": "Search through raw code for &lt;script&gt; tags in Ruby on Rails", "body": "<p>Use <a href=\"https://github.com/sparklemotion/nokogiri\" rel=\"nofollow noreferrer\">nokogiri</a> gem. With this, you can parse your HTML content easily.</p>\n"}], "owner": {"reputation": 1, "user_id": 9998254, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z4FyldSUvO4/AAAAAAAAAAI/AAAAAAAACZI/Pp3ebVUpJAA/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9998254/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1530094713, "creation_date": 1530082646, "last_edit_date": 1530094713, "question_id": 51056382, "link": "https://stackoverflow.com/questions/51056382/search-through-raw-code-for-script-tags-in-ruby-on-rails", "title": "Search through raw code for &lt;script&gt; tags in Ruby on Rails", "body": "<p>I am using HTTParty gem to get raw html but I am only interested in the JSON section of the code. That part of the code is nested inside a \n<code>&lt;script type=\"text/javascript\"&gt;</code>. </p>\n\n<p>From within my Rails app how can I only select only the section I am interested in <a href=\"https://i.stack.imgur.com/Dq5sX.png\" rel=\"nofollow noreferrer\">screenshot of response</a>?</p>\n\n<pre><code>response = HTTParty.get('https://www.instagram.com/crossfitwanderlust_bali/')\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1530082645, "post_id": 51056316, "comment_id": 89103215, "body": "Do you have update action in surveys controller?"}, {"owner": {"reputation": 155, "user_id": 2156762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eaee304055363845adf39c3961be809?s=128&d=identicon&r=PG", "display_name": "Ahamadi", "link": "https://stackoverflow.com/users/2156762/ahamadi"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1530083243, "post_id": 51056316, "comment_id": 89103521, "body": "@Gabbar I don&#39;t define update action on my serveys controller. But my problem occured when get view for edit action (<a href=\"http://192.168.99.100:3000/campaigns/1/surveys/1/edit\" rel=\"nofollow noreferrer\">192.168.99.100:3000/campaigns/1/surveys/1/edit</a>)"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1530083442, "post_id": 51056316, "comment_id": 89103618, "body": "Are you using this form for new action as well as? problem simply states that form_form automatic define form url which should be update action so its gives the error exactly<code>undefined method </code>survey_path&#39;` ?"}, {"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 2, "creation_date": 1530083716, "post_id": 51056316, "comment_id": 89103768, "body": "Use <code>form_for @survey</code> instead of using <code>form_with(model: survey, local: true)</code>. It&#39;s actually getting a <b>class</b> in the form, instead of getting a survey object to edit."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1530083845, "post_id": 51056316, "comment_id": 89103834, "body": "@Emu If its so that it should looking for surveys_path which is for create action."}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 2156762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eaee304055363845adf39c3961be809?s=128&d=identicon&r=PG", "display_name": "Ahamadi", "link": "https://stackoverflow.com/users/2156762/ahamadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1530181018, "creation_date": 1530181018, "answer_id": 51080322, "question_id": 51056316, "link": "https://stackoverflow.com/questions/51056316/rails-5-2-controller-global-variable-is-not-accessible-on-views/51080322#51080322", "title": "Rails 5.2 Controller global variable is not accessible on views", "body": "<p>I have fixed the problem, by calling form_with helper with url: parameter setted with the good url. </p>\n\n<pre><code>&lt;%= form_with(model: survey, url: campaign_survey_path(survey), local: true) do |form| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 2156762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eaee304055363845adf39c3961be809?s=128&d=identicon&r=PG", "display_name": "Ahamadi", "link": "https://stackoverflow.com/users/2156762/ahamadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530181018, "creation_date": 1530082377, "question_id": 51056316, "link": "https://stackoverflow.com/questions/51056316/rails-5-2-controller-global-variable-is-not-accessible-on-views", "title": "Rails 5.2 Controller global variable is not accessible on views", "body": "<p>I user Rails 5.2 with ruby 2.5.1.\nOn my controller, i create my global variable @survey. And i try to access it on my view, but it's seems my varible is not define on my view context.\nI don't understand this behavior, that don't occure on RoR 4. Someone can help me?</p>\n\n<p>[route (<a href=\"http://192.168.99.100:3000/campaigns/1/surveys/1/edit)]\" rel=\"nofollow noreferrer\">http://192.168.99.100:3000/campaigns/1/surveys/1/edit)]</a>:</p>\n\n<pre><code>edit_campaign_survey_path   GET /campaigns/:campaign_id/surveys/:id/edit(.:format)  surveys#edit\n</code></pre>\n\n<hr>\n\n<p>[app/controllers/surveys_controller.rb]:</p>\n\n<pre><code>class SurveysController &lt; ApplicationController\n\n  def edit\n      campaign_id = params[:campaign_id]\n      survey_id = params[:id]\n      @survey = Survey.where(\"campaign_id = ? AND  id = ?\", campaign_id, survey_id).first\n  end\n\n  private\n\n    def survey_params\n      params.require(:survey).permit(:name, :campaign_id, :survey_state_id, :internal_desc, :presentation, :thank_message, :token_libre_service)\n    end\nend\n</code></pre>\n\n<hr>\n\n<p>[app/models/survey.rb]:</p>\n\n<pre><code>class Survey &lt; ApplicationRecord\n  belongs_to :campaign\n  belongs_to :survey_state\n  has_many :questions\n  has_many :survey_responses\nend\n</code></pre>\n\n<hr>\n\n<p>[app/views/surveys/edit.html.erb]:</p>\n\n<pre><code>&lt;h1&gt;Editing Survey&lt;/h1&gt;\n\n&lt;%= render 'form', survey: @survey %&gt;\n\n&lt;%= link_to 'Show', campaign_survey_path(@survey) %&gt; |\n&lt;%= link_to 'Back', campaign_path(@survey) %&gt;\n</code></pre>\n\n<hr>\n\n<p>[app/views/surveys/_form.html.erb]:</p>\n\n<pre><code>&lt;%= form_with(model: survey, local: true) do |form| %&gt;\n  &lt;% if survey.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(survey.errors.count, \"error\") %&gt; prohibited this survey from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% survey.errors.full_messages.each do |message| %&gt;\n        &lt;li&gt;&lt;%= message %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n     ...\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>[Server log's]:</p>\n\n<pre><code>Started GET \"/campaigns/1/surveys/1/edit\" for 192.168.99.1 at 2018-06-27 06:12:17 +0000\n    Cannot render console from 192.168.99.1! Allowed networks: 127.0.0.1, ::1, 127.0.0.0/127.255.255.255\n       (0.7ms)  SELECT \"schema_migrations\".\"version\" FROM \"schema_migrations\" ORDER BY \"schema_migrations\".\"version\" ASC\n      \u21b3 /usr/local/bundle/gems/activerecord-5.2.0/lib/active_record/log_subscriber.rb:98\n    Processing by SurveysController#edit as HTML\n      Parameters: {\"campaign_id\"=&gt;\"1\", \"id\"=&gt;\"1\"}\n      Survey Load (0.9ms)  SELECT  \"surveys\".* FROM \"surveys\" WHERE (campaign_id = '1' AND  id = '1') ORDER BY \"surveys\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1]]\n      \u21b3 app/controllers/surveys_controller.rb:6\n      Rendering surveys/edit.html.erb within layouts/application\n      Rendered surveys/_form.html.erb (301.8ms)\n      Rendered surveys/edit.html.erb within layouts/application (340.5ms)\n    Completed 500 Internal Server Error in 532ms (ActiveRecord: 5.6ms)\n\n\n\n    ActionView::Template::Error (undefined method `survey_path' for #&lt;#&lt;Class:0x00005625fd23a400&gt;:0x00005625fd22f118&gt;):\n        1: &lt;%= form_with(model: survey, local: true) do |form| %&gt;\n        2:   &lt;% if survey.errors.any? %&gt;\n        3:     &lt;div id=\"error_explanation\"&gt;\n        4:       &lt;h2&gt;&lt;%= pluralize(survey.errors.count, \"error\") %&gt; prohibited this survey from being saved:&lt;/h2&gt;\n\n    app/views/surveys/_form.html.erb:1:in `_app_views_surveys__form_html_erb___2337721490819825260_47360580221160'\n    app/views/surveys/edit.html.erb:3:in `_app_views_surveys_edit_html_erb___3451176563971010509_47360580376960'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "polymorphism", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530083961, "post_id": 51056290, "comment_id": 89103891, "body": "This will break when updating the record. <code>Relation...empty?</code> will return <code>false</code> even if current record is the only one with such attributes."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530085039, "post_id": 51056290, "comment_id": 89104481, "body": "@JagdeepSingh indeed; one might check for <code>count == persisted? ? 1 : 0</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1530082268, "creation_date": 1530082268, "answer_id": 51056290, "question_id": 51056231, "link": "https://stackoverflow.com/questions/51056231/prevent-duplicate-polymorphic-records/51056290#51056290", "title": "Prevent duplicate polymorphic records", "body": "<p><code>Relation.where(toable: self.toable).where(fromable: self.fromable)</code> returns <em>a relation object</em>, which is always <code>truthy</code>.</p>\n\n<p>You should explicitly check for it\u2019s emptiness:</p>\n\n<pre><code>unless Relation.where(toable: self.toable).where(fromable: self.fromable).empty?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 2126059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b4515b940891245126f1192d29fa0a?s=128&d=identicon&r=PG", "display_name": "Kiran Kumawat", "link": "https://stackoverflow.com/users/2126059/kiran-kumawat"}, "is_accepted": true, "score": 1, "last_activity_date": 1530084093, "last_edit_date": 1530084093, "creation_date": 1530083111, "answer_id": 51056505, "question_id": 51056231, "link": "https://stackoverflow.com/questions/51056231/prevent-duplicate-polymorphic-records/51056505#51056505", "title": "Prevent duplicate polymorphic records", "body": "<p>You can use <a href=\"http://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow noreferrer\">uniqueness validation</a> instead of writing your own to handle this::</p>\n\n<pre><code>validates_uniqueness_of :fromable_id, scope: [:toable_id, :toable_type, :fromable_type], allow_nil: true\n</code></pre>\n\n<p>It will automatically check the combination of fromable and toable objects for uniqueness.</p>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 2694144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Laaa.jpg?s=128&g=1", "display_name": "Arpan Lepcha", "link": "https://stackoverflow.com/users/2694144/arpan-lepcha"}, "is_accepted": false, "score": 1, "last_activity_date": 1530092921, "creation_date": 1530092921, "answer_id": 51059622, "question_id": 51056231, "link": "https://stackoverflow.com/questions/51056231/prevent-duplicate-polymorphic-records/51059622#51059622", "title": "Prevent duplicate polymorphic records", "body": "<p>You can also use <code>.exists?</code> if you are only checking for truthy or falsey. \neg:</p>\n\n<p><code>\nif Relation.exists?(toable: self.toable, fromable: self.fromable)\n  errors.add(:base, \"DUPLICATE\")\nend\n</code></p>\n"}], "owner": {"reputation": 105, "user_id": 9852976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e25a8501d8ffcac2d597a97d9e5149?s=128&d=identicon&r=PG&f=1", "display_name": "NathanB", "link": "https://stackoverflow.com/users/9852976/nathanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 51056505, "answer_count": 3, "score": 0, "last_activity_date": 1530092921, "creation_date": 1530082074, "question_id": 51056231, "link": "https://stackoverflow.com/questions/51056231/prevent-duplicate-polymorphic-records", "title": "Prevent duplicate polymorphic records", "body": "<p>I have a Rails 5 app with a Relations table. The table columns looks like:</p>\n\n<p>fromable (polymorphic)\ntoable (polymorphic)</p>\n\n<p>I want to prevent users from saving relations that are duplicates (that is, that have the same fromable and toable). I've tried to do the following:</p>\n\n<pre><code>class Relation &lt; ApplicationRecord\n\n   ...\n\n   belongs_to :fromable, polymorphic: true\n   belongs_to :toable, polymorphic: true\n\n   validate :is_not_duplicate_relation\n\n   private\n\n   def is_not_duplicate_relation\n      errors.add(:base, \"DUPLICATE\") if Relation.where(toable: self.toable).where(fromable: self.fromable)\n   end\nend\n</code></pre>\n\n<p>But this seems to trigger invalid on everything?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "coffeescript"], "comments": [{"owner": {"reputation": 1224, "user_id": 1554616, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/mr58T.jpg?s=128&g=1", "display_name": "Sandeep Garg", "link": "https://stackoverflow.com/users/1554616/sandeep-garg"}, "edited": false, "score": 1, "creation_date": 1530081884, "post_id": 51056088, "comment_id": 89102813, "body": "Can you specify what you are getting in data after ajax success"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1530082080, "post_id": 51056088, "comment_id": 89102912, "body": "in success check <code>console.log(data)</code> ?"}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530092010, "post_id": 51056088, "comment_id": 89108610, "body": "In my current code, i do have a variable data and in the success also I have the same. So, when trying to get the length it is giving the upper one. Updated my success data variable name and was able to get the correct value."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530092052, "post_id": 51056088, "comment_id": 89108643, "body": "for loop, i have written this code sarr = sarr + &quot;;&quot; +data1[i].name for i in [0...data1.length-1]"}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 4823919, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a31d1f14b813262b3e237b2a522a53a2?s=128&d=identicon&r=PG", "display_name": "Gokul p", "link": "https://stackoverflow.com/users/4823919/gokul-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1530091509, "creation_date": 1530091509, "answer_id": 51059076, "question_id": 51056088, "link": "https://stackoverflow.com/questions/51056088/how-to-write-loop-to-iterate-data-on-ajax-success-and-bind-data-to-textbox-using/51059076#51059076", "title": "How to write loop to iterate data on AJAX success and bind data to textbox using coffee script in Ruby on Rails", "body": "<p>Try to render the form as a response. Then with the help of <code>append</code> or <code>replaceWith</code> replace the existing data.\n<code>append</code> will add the content within the selector. <code>replaceWith</code> replace the content where the selector is present.</p>\n\n<pre><code>$(\"SELECTOR\").append(YOUR_RESPONSE);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>$(\"SELECTOR\").replaceWith(YOUR_RESPONSE);\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1530091509, "creation_date": 1530081562, "last_edit_date": 1530089835, "question_id": 51056088, "link": "https://stackoverflow.com/questions/51056088/how-to-write-loop-to-iterate-data-on-ajax-success-and-bind-data-to-textbox-using", "title": "How to write loop to iterate data on AJAX success and bind data to textbox using coffee script in Ruby on Rails", "body": "<p>Currently the below code gives the data on success.</p>\n\n<p>How do I iterate the data which is in an array and process it to string and bind that to text box.</p>\n\n<pre><code>$ -&gt;\n  $(document).on 'click', '#ListButton', (evt) -&gt;\n    console.log(\"ListButton\")\n    isvalid = if $(\"#ListButtonVlaue\").val() \n    if isvalid\n      $.ajax 'show',\n      type: 'POST'\n      dataType: 'json'\n      data: {\n        isvalid: isvalid\n      }\n      error: (jqXHR, textStatus, errorThrown) -&gt;\n        console.log(\"AJAX Error: #{textStatus}\")\n      success: (data, textStatus, jqXHR) -&gt; \n        console.log(\"OK!\")\n</code></pre>\n\n<p>If I try to get the length of data which is giving the value of <code>data: {isvalid: isvalid }</code> but not on the data in success.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amp-html", "amp-list"], "comments": [{"owner": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530109051, "post_id": 51055707, "comment_id": 89120124, "body": "If the JSON file above is the <code>amp-list</code> JSON file specified by <a href=\"http://lmyadpi.com/api.json\" rel=\"nofollow noreferrer\">lmyadpi.com/api.json</a>, then the structure is wrong. In <code>amp-mustache</code>, your asking for a parent key labeled <code>results</code>. where is that key in the JSON file? Also note the serving site must be HTTPS and CORS-enabled."}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530166804, "post_id": 51055707, "comment_id": 89140745, "body": "but my API use in multiple application and I am not able to change in this API."}, {"owner": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530179284, "post_id": 51055707, "comment_id": 89147952, "body": "am sorry for you but it <code>ain&#39;t gonna work</code> the only way it might work is if you specify <code>single-item</code> in <code>amp-list</code> and the use that item. You&#39;ll have to repeat for each <code>item</code> because i don&#39;t see a way you can iterate over the array."}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530179428, "post_id": 51055707, "comment_id": 89148037, "body": "this specific json formate by AMP is working but, in my condition, there are many other apps that using API formate as I mention on above so it really difficult"}, {"owner": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530179889, "post_id": 51055707, "comment_id": 89148386, "body": "i&#39;m not saying the JSON is wrong; it&#39;s just not in the form that can (easily) be processes by <code>amp-mustache</code>. The only other way you might do it is <code>amp-bind</code> but i don&#39;t think you can process an array using that method."}, {"owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "reply_to_user": {"reputation": 1606, "user_id": 2328892, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IPeF1.png?s=128&g=1", "display_name": "Jay Gray", "link": "https://stackoverflow.com/users/2328892/jay-gray"}, "edited": false, "score": 0, "creation_date": 1530180017, "post_id": 51055707, "comment_id": 89148458, "body": "ya, I know but AMP community need to focus user can specify there customize json like Jquery"}], "owner": {"reputation": 2208, "user_id": 4061422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZHGRC.png?s=128&g=1", "display_name": "vipin", "link": "https://stackoverflow.com/users/4061422/vipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1530091819, "creation_date": 1530080033, "last_edit_date": 1530091819, "question_id": 51055707, "link": "https://stackoverflow.com/questions/51055707/how-to-parse-custom-without-key-response-in-amp-autosuggest-rails-5", "title": "How to Parse Custom (without Key) response in AMP-autosuggest (Rails 5)", "body": "<p>Anyone tells me how can I parse my response in AMP-list. In AMP didn't find any solution how to parse own custom API response.</p>\n\n<p>My Code.</p>\n\n<pre><code>&lt;div\n    class=\"autosuggest-container hidden\"\n    [class]=\"(showDropdown &amp;&amp; query) ?\n      'autosuggest-container' :\n      'autosuggest-container hidden'\"\n  &gt;\n    &lt;amp-list\n      class=\"autosuggest-box\"\n      layout=\"fixed-height\"\n      height=\"120\"\n      src=\"http://lmyadpi.com/api.json?q=a\"\n      id=\"autosuggest-list\"\n    &gt;\n\n      &lt;template type=\"amp-mustache\"&gt;\n        &lt;amp-selector\n          id=\"autosuggest-selector\"\n          keyboard-select-mode=\"focus\"\n          layout=\"container\"\n          on=\"\n            select:\n              AMP.setState({\n                query: event.targetOption,\n                showDropdown: false\n              }),\n              autosuggest-list.hide\"\n        &gt;\n          {{#results}}\n            &lt;div\n              class=\"select-option no-outline\"\n              role=\"option\"\n              tabindex=\"0\"\n              on=\"tap:autosuggest-list.hide\"\n              option=\"{{.}}\"\n            &gt;{{.}}&lt;/div&gt;\n          {{/results}}\n          {{^results}}\n            &lt;div class=\"select-option {{#query}}empty{{/query}}\"&gt;\n              {{#query}}Sorry! We don't ship to your city \ud83d\ude30{{/query}}\n            &lt;/div&gt;\n          {{/results}}\n        &lt;/amp-selector&gt;\n      &lt;/template&gt;\n    &lt;/amp-list&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;amp-state\n  id=\"allLocations\"\n  src=\"http://lmyadpi.com/api.json?q=a\"\n  \"emptyAndInitialTemplateJson\": [{\n            \"query\": \"\",\n            [[]]\n        }]\n\n  &gt;&lt;/amp-state&gt;\n</code></pre>\n\n<p>My API response :</p>\n\n<pre><code>[[\n\"1234\",\n\"value2\",\n\"\"\n],\n[\n\"6321123\",\n\"value3\",\n\"\"\n],\n[\n\"43934322\",\n\"value4\",\n\"\"\n],\n[\n\"43660213\",\n\"value5\",\n\"\"\n],\n[\n\"54373228\",\n\"value6\",\n\"\"\n],\n[\n\"410721327\",\n\"value7\",\n\"\"\n]]\n</code></pre>\n"}, {"tags": ["ruby", "jekyll"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530082346, "post_id": 51054765, "comment_id": 89103057, "body": "if my Answer doesn&#39;t help with the Analytics issue consider posting a new question with more detail on that."}, {"owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530113481, "post_id": 51054765, "comment_id": 89122993, "body": "Thanks @maxpleaner for the explanation. I got the analytics to work by just inserting it manually. Before I was using a jekyll-analytics gem. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1530081949, "creation_date": 1530081949, "answer_id": 51056188, "question_id": 51054765, "link": "https://stackoverflow.com/questions/51054765/what-is-the-difference-between-git-push-and-jekyll-build-for-jekyll-blog/51056188#51056188", "title": "What is the difference between git push and jekyll build for jekyll blog", "body": "<p>to turn a Jekyll app source code into a site you view, it has to do that build step to create the HTML that is served.</p>\n\n<p>Github pages automatically does the build step for you after the code is pushed (if the repo/brach is configured for Pages).</p>\n\n<p>So, you are right. It is not necessary for you to run the command.</p>\n\n<p>The reason you may want to run it is to run the site locally (using your computer as the server). Or if you want to deploy it to some generic static host other than Pages. Or if you want to just view the final compiled site for some reason.</p>\n"}], "owner": {"reputation": 3945, "user_id": 2325598, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/wbO59.jpg?s=128&g=1", "display_name": "Dan Rubio", "link": "https://stackoverflow.com/users/2325598/dan-rubio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 51056188, "answer_count": 1, "score": 0, "last_activity_date": 1530081949, "creation_date": 1530075321, "question_id": 51054765, "link": "https://stackoverflow.com/questions/51054765/what-is-the-difference-between-git-push-and-jekyll-build-for-jekyll-blog", "title": "What is the difference between git push and jekyll build for jekyll blog", "body": "<p>I am creating a jekyll blog using <a href=\"https://jekyllrb.com/\" rel=\"nofollow noreferrer\">Jekyll</a>. In the instructions I see that there is a command to build the site using the command <code>jekyll build</code>.</p>\n\n<p>However, I noticed that when I make changes to my code/post and perform a <code>git push origin master</code> the content and changes are uploaded automatically. This makes me wonder why I would need to \"build\" the site.</p>\n\n<p>Could someone help me understand what the difference is? I'm currently trying to add Google Analytics to my blog and I suspect that knowing the difference between the two will help me get it to work properly. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "doorkeeper"], "comments": [{"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1530065246, "post_id": 51053223, "comment_id": 89098105, "body": "Hi. I tried to do same thing on my project but I didn&#39;t face that issue. Could you check typo issue?"}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "reply_to_user": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1530065951, "post_id": 51053223, "comment_id": 89098217, "body": "I doubled checked now unfortunately no typos"}, {"owner": {"reputation": 600, "user_id": 2796616, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sPrN.png?s=128&g=1", "display_name": "andrew21", "link": "https://stackoverflow.com/users/2796616/andrew21"}, "edited": false, "score": 0, "creation_date": 1530065982, "post_id": 51053223, "comment_id": 89098221, "body": "what happens when you add a <code>require &#39;doorkeeper\\application&#39;</code>?"}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "edited": false, "score": 0, "creation_date": 1530066510, "post_id": 51053223, "comment_id": 89098327, "body": "It gives the following error:  _ /.rvm/gems/ruby-2.5.1/gems/bootsnap-1.3.0/lib/bootsnap/load_&zwnj;&#8203;path_cache/core_ext/&zwnj;&#8203;kernel_require.rb:32&zwnj;&#8203;:in `require&#39;: cannot load such file -- doorkeeper\\application (LoadError) _"}, {"owner": {"reputation": 253, "user_id": 2783808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2260c915818f1ec3fe4b6313754b50e?s=128&d=identicon&r=PG&f=1", "display_name": "sat&#39;s", "link": "https://stackoverflow.com/users/2783808/sats"}, "edited": false, "score": 0, "creation_date": 1530083038, "post_id": 51053223, "comment_id": 89103405, "body": "just to confirm that you installed gem (<code>bundle install</code>) after including it to Gemfile"}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530084366, "post_id": 51053223, "comment_id": 89104102, "body": "Can you include <i>Gemfile.lock</i> in the question?"}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "reply_to_user": {"reputation": 253, "user_id": 2783808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2260c915818f1ec3fe4b6313754b50e?s=128&d=identicon&r=PG&f=1", "display_name": "sat&#39;s", "link": "https://stackoverflow.com/users/2783808/sats"}, "edited": false, "score": 0, "creation_date": 1530084633, "post_id": 51053223, "comment_id": 89104241, "body": "@sat&#39;s: Yes I have run bundle install and I&#39;m using doorkeeper in authenticaiton normally without any problems"}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "reply_to_user": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530084638, "post_id": 51053223, "comment_id": 89104247, "body": "@JagdeepSingh I have updated the question with the Gemfile.lock"}, {"owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "edited": false, "score": 0, "creation_date": 1530117677, "post_id": 51053223, "comment_id": 89125308, "body": "hi @Haytham.Breaka I can able to reproduce the error."}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "reply_to_user": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "edited": false, "score": 0, "creation_date": 1530125437, "post_id": 51053223, "comment_id": 89129060, "body": "Hi @praaveen, I&#39;m sorry but I didn&#39;t get you. So do you mean that you know what the problem is?"}, {"owner": {"reputation": 1140, "user_id": 3248148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CLgGs.jpg?s=128&g=1", "display_name": "praaveen V R", "link": "https://stackoverflow.com/users/3248148/praaveen-v-r"}, "edited": false, "score": 0, "creation_date": 1530126902, "post_id": 51053223, "comment_id": 89129750, "body": "Im saying after your post I tried and able to get the error. Didn&#39;t find the solution.@Haytham.Breaka"}, {"owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "edited": false, "score": 0, "creation_date": 1530298455, "post_id": 51053223, "comment_id": 89202688, "body": "I have figured a way to do it. I have made a Doorkeeper module in the initializersand inside this module I inserted the injection of the models and it worked fine!"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 6371000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NWGf9.jpg?s=128&g=1", "display_name": "Rudy Zidan", "link": "https://stackoverflow.com/users/6371000/rudy-zidan"}, "is_accepted": true, "score": 2, "last_activity_date": 1530629329, "creation_date": 1530629329, "answer_id": 51157461, "question_id": 51053223, "link": "https://stackoverflow.com/questions/51053223/uninitialized-constant-doorkeeperapplication-nameerror/51157461#51157461", "title": "uninitialized constant Doorkeeper::Application (NameError)", "body": "<pre><code>require 'doorkeeper/orm/active_record/application'\n\nDoorkeeper::Application.class_eval do\n  # your code here\nend\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 2292060, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/RLQ5N.png?s=128&g=1", "display_name": "Haytham.Breaka", "link": "https://stackoverflow.com/users/2292060/haytham-breaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 51157461, "answer_count": 1, "score": 1, "last_activity_date": 1530629329, "creation_date": 1530061792, "last_edit_date": 1530084542, "question_id": 51053223, "link": "https://stackoverflow.com/questions/51053223/uninitialized-constant-doorkeeperapplication-nameerror", "title": "uninitialized constant Doorkeeper::Application (NameError)", "body": "<p>I'm trying to extend the Doorkeeper::Application module to add some extra validations and relations in config/initializer/doorkeeper_patch.rb.\nBut I'm getting this error: </p>\n\n<blockquote>\n  <p>uninitialized constant Doorkeeper::Application (NameError)</p>\n</blockquote>\n\n<p>My code (config/initializer/doorkeeper_patch.rb):</p>\n\n<pre><code>Doorkeeper::Application.class_eval do\n    ...\nend\n</code></pre>\n\n<p>My Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\nruby '2.5.1'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.2.0'\n# Use postgresql as the database for Active Record\ngem 'pg', '&gt;= 0.18', '&lt; 2.0'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.11'\ngem 'awesome_print', require: 'ap'\n# Build JSON APIs with ease. Read more: \nhttps://github.com/rails/jbuilder\n# gem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\ngem 'bcrypt', '~&gt; 3.1.7'\ngem 'doorkeeper'\n# Use ActiveStorage variant\n# gem 'mini_magick', '~&gt; 4.8'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\n# Reduces boot times through caching; required in config/boot.rb\ngem 'bootsnap', '&gt;= 1.1.0', require: false\ngem 'pundit'\n# Use Rack CORS for handling Cross-Origin Resource Sharing (CORS), \nmaking cross-origin AJAX possible\n# gem 'rack-cors'\n\ngroup :development, :test do\n    # Call 'byebug' anywhere in the code to stop execution and get a \n    debugger console\n    gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n    gem 'rails_best_practices'\n    gem 'factory_bot_rails'\nend\n\ngroup :development do\n    gem 'rubocop'\n    gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n    # Spring speeds up development by keeping your application running \n      in the background. Read more: https://github.com/rails/spring\n    gem 'spring'\n    gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n</code></pre>\n\n<p>gemfile.lock:</p>\n\n<pre><code>GEM\n  remote: https://rubygems.org/\n  specs:\n    actioncable (5.2.0)\n      actionpack (= 5.2.0)\n      nio4r (~&gt; 2.0)\n      websocket-driver (&gt;= 0.6.1)\n    actionmailer (5.2.0)\n      actionpack (= 5.2.0)\n      actionview (= 5.2.0)\n      activejob (= 5.2.0)\n      mail (~&gt; 2.5, &gt;= 2.5.4)\n      rails-dom-testing (~&gt; 2.0)\n    actionpack (5.2.0)\n      actionview (= 5.2.0)\n      activesupport (= 5.2.0)\n      rack (~&gt; 2.0)\n      rack-test (&gt;= 0.6.3)\n      rails-dom-testing (~&gt; 2.0)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.2)\n    actionview (5.2.0)\n      activesupport (= 5.2.0)\n      builder (~&gt; 3.1)\n      erubi (~&gt; 1.4)\n      rails-dom-testing (~&gt; 2.0)\n      rails-html-sanitizer (~&gt; 1.0, &gt;= 1.0.3)\n    activejob (5.2.0)\n      activesupport (= 5.2.0)\n      globalid (&gt;= 0.3.6)\n    activemodel (5.2.0)\n      activesupport (= 5.2.0)\n    activerecord (5.2.0)\n      activemodel (= 5.2.0)\n      activesupport (= 5.2.0)\n      arel (&gt;= 9.0)\n    activestorage (5.2.0)\n      actionpack (= 5.2.0)\n      activerecord (= 5.2.0)\n      marcel (~&gt; 0.3.1)\n    activesupport (5.2.0)\n      concurrent-ruby (~&gt; 1.0, &gt;= 1.0.2)\n      i18n (&gt;= 0.7, &lt; 2)\n      minitest (~&gt; 5.1)\n      tzinfo (~&gt; 1.1)\n    arel (9.0.0)\n    ast (2.4.0)\n    awesome_print (1.8.0)\n    bcrypt (3.1.12)\n    bootsnap (1.3.0)\n      msgpack (~&gt; 1.0)\n    builder (3.2.3)\n    byebug (10.0.2)\n    code_analyzer (0.4.8)\n      sexp_processor\n    concurrent-ruby (1.0.5)\n    crass (1.0.4)\n    doorkeeper (4.3.2)\n      railties (&gt;= 4.2)\n    erubi (1.7.1)\n    erubis (2.7.0)\n    factory_bot (4.10.0)\n      activesupport (&gt;= 3.0.0)\n    factory_bot_rails (4.10.0)\n      factory_bot (~&gt; 4.10.0)\n      railties (&gt;= 3.0.0)\n    ffi (1.9.25)\n    globalid (0.4.1)\n      activesupport (&gt;= 4.2.0)\n    i18n (1.0.1)\n      concurrent-ruby (~&gt; 1.0)\n    jaro_winkler (1.5.1)\n    json (2.1.0)\n    listen (3.1.5)\n      rb-fsevent (~&gt; 0.9, &gt;= 0.9.4)\n      rb-inotify (~&gt; 0.9, &gt;= 0.9.7)\n      ruby_dep (~&gt; 1.2)\n    loofah (2.2.2)\n      crass (~&gt; 1.0.2)\n      nokogiri (&gt;= 1.5.9)\n    mail (2.7.0)\n      mini_mime (&gt;= 0.1.1)\n    marcel (0.3.2)\n      mimemagic (~&gt; 0.3.2)\n    method_source (0.9.0)\n    mimemagic (0.3.2)\n    mini_mime (1.0.0)\n    mini_portile2 (2.3.0)\n    minitest (5.11.3)\n    msgpack (1.2.4)\n    nio4r (2.3.1)\n    nokogiri (1.8.3)\n      mini_portile2 (~&gt; 2.3.0)\n    parallel (1.12.1)\n    parser (2.5.1.0)\n      ast (~&gt; 2.4.0)\n    pg (1.0.0)\n    powerpack (0.1.2)\n    puma (3.11.4)\n    pundit (1.1.0)\n      activesupport (&gt;= 3.0.0)\n    rack (2.0.5)\n    rack-test (1.0.0)\n      rack (&gt;= 1.0, &lt; 3)\n    rails (5.2.0)\n      actioncable (= 5.2.0)\n      actionmailer (= 5.2.0)\n      actionpack (= 5.2.0)\n      actionview (= 5.2.0)\n      activejob (= 5.2.0)\n      activemodel (= 5.2.0)\n      activerecord (= 5.2.0)\n      activestorage (= 5.2.0)\n      activesupport (= 5.2.0)\n      bundler (&gt;= 1.3.0)\n      railties (= 5.2.0)\n      sprockets-rails (&gt;= 2.0.0)\n    rails-dom-testing (2.0.3)\n      activesupport (&gt;= 4.2.0)\n      nokogiri (&gt;= 1.6)\n    rails-html-sanitizer (1.0.4)\n      loofah (~&gt; 2.2, &gt;= 2.2.2)\n    rails_best_practices (1.19.2)\n      activesupport\n      code_analyzer (&gt;= 0.4.8)\n      erubis\n      i18n\n      json\n      require_all (~&gt; 2.0)\n      ruby-progressbar\n    railties (5.2.0)\n      actionpack (= 5.2.0)\n      activesupport (= 5.2.0)\n      method_source\n      rake (&gt;= 0.8.7)\n      thor (&gt;= 0.18.1, &lt; 2.0)\n    rainbow (3.0.0)\n    rake (12.3.1)\n    rb-fsevent (0.10.3)\n    rb-inotify (0.9.10)\n      ffi (&gt;= 0.5.0, &lt; 2)\n    require_all (2.0.0)\n    rubocop (0.57.2)\n      jaro_winkler (~&gt; 1.5.1)\n      parallel (~&gt; 1.10)\n      parser (&gt;= 2.5)\n      powerpack (~&gt; 0.1)\n      rainbow (&gt;= 2.2.2, &lt; 4.0)\n      ruby-progressbar (~&gt; 1.7)\n      unicode-display_width (~&gt; 1.0, &gt;= 1.0.1)\n    ruby-progressbar (1.9.0)\n    ruby_dep (1.5.0)\n    sexp_processor (4.11.0)\n    spring (2.0.2)\n      activesupport (&gt;= 4.2)\n    spring-watcher-listen (2.0.1)\n      listen (&gt;= 2.7, &lt; 4.0)\n      spring (&gt;= 1.2, &lt; 3.0)\n    sprockets (3.7.2)\n      concurrent-ruby (~&gt; 1.0)\n      rack (&gt; 1, &lt; 3)\n    sprockets-rails (3.2.1)\n      actionpack (&gt;= 4.0)\n      activesupport (&gt;= 4.0)\n      sprockets (&gt;= 3.0.0)\n    thor (0.20.0)\n    thread_safe (0.3.6)\n    tzinfo (1.2.5)\n      thread_safe (~&gt; 0.1)\n    unicode-display_width (1.4.0)\n    websocket-driver (0.7.0)\n      websocket-extensions (&gt;= 0.1.0)\n    websocket-extensions (0.1.3)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  awesome_print\n  bcrypt (~&gt; 3.1.7)\n  bootsnap (&gt;= 1.1.0)\n  byebug\n  doorkeeper\n  factory_bot_rails\n  listen (&gt;= 3.0.5, &lt; 3.2)\n  pg (&gt;= 0.18, &lt; 2.0)\n  puma (~&gt; 3.11)\n  pundit\n  rails (~&gt; 5.2.0)\n  rails_best_practices\n  rubocop\n  spring\n  spring-watcher-listen (~&gt; 2.0.0)\n\nRUBY VERSION\n   ruby 2.5.1p57\n\nBUNDLED WITH\n   1.16.2\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "rubygems"], "comments": [{"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1530065643, "post_id": 51053177, "comment_id": 89098163, "body": "Hi @Obromios It&#39;s because you required <code>traversal_cap</code> below <code>handicap</code> but you included traversal_cap inside handicap so that it couldn&#39;t find this module.  Solution is you should do like this: <code>require &#39;private_lib&#47;version&#39; require &#39;private_lib&#47;traversal_cap&#39; require &#39;private_lib&#47;handicap&#39;  module PrivateLib  end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "edited": false, "score": 0, "creation_date": 1530079178, "post_id": 51053359, "comment_id": 89101534, "body": "Thats works, I am used to using ruby on rails which has autoloading."}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 1, "last_activity_date": 1530063134, "creation_date": 1530063134, "answer_id": 51053359, "question_id": 51053177, "link": "https://stackoverflow.com/questions/51053177/include-module-not-working-in-gem/51053359#51053359", "title": "Include module not working in gem", "body": "<p>It is because of the order you require the files.</p>\n\n<p>At the time the line <code>require 'private_lib/handicap'</code> is run it reads the <code>handicap.rb</code> file and hits the line where you <code>include TraversalCap</code>. But you haven't yet run <code>require 'private_lib/traversal_cap'</code> at this point so the module is undefined.</p>\n\n<p>Quick fix is to change the order of the <code>require</code> calls, or alternatively put <code>require 'private_lib/traversal_cap'</code> at the top of the handicap file.</p>\n"}], "owner": {"reputation": 10972, "user_id": 1299362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f9ec564b963a34f47cc1719738d75b23?s=128&d=identicon&r=PG", "display_name": "Obromios", "link": "https://stackoverflow.com/users/1299362/obromios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 51053359, "answer_count": 1, "score": 0, "last_activity_date": 1530063134, "creation_date": 1530061420, "question_id": 51053177, "link": "https://stackoverflow.com/questions/51053177/include-module-not-working-in-gem", "title": "Include module not working in gem", "body": "<p>I have a gem called <code>private_lib</code>. \nThe file <code>lib/private_lib.rb</code> contains the following:</p>\n\n<pre><code>require 'private_lib/version'\nrequire 'private_lib/handicap'\nrequire 'private_lib/traversal_cap'\n\nmodule PrivateLib\n\nend\n</code></pre>\n\n<p>The <code>lib/private_lib/handicap.rb</code> file contains the following</p>\n\n<pre><code># module for handicap functions\nclass Handicap\n  include TraversalCap\n  -- other code\nend\n</code></pre>\n\n<p>and the file <code>lib/private_lib/traversal_cap.rb</code> contains the following</p>\n\n<pre><code>module TraversalCap\n  def some_method\n  end\n  -- other code\nend\n</code></pre>\n\n<p>I also have a test file <code>spec/handicap_spec.rb</code> which contains the following</p>\n\n<pre><code>require \"spec_helper\"\ndescribe Handicap do\n  include TraversalCap\n  -- some tests that access the ```Handicap``` class\n  -- some tests that access directly the traversal_cap some_method.\nend\n</code></pre>\n\n<p>When I run <code>rspec spec/handicap_spec</code>, I get the following error</p>\n\n<pre><code>private_lib/lib/private_lib/handicap.rb:3:in `&lt;class:Handicap&gt;': uninitialized constant Handicap::TraversalCap (NameError)\n    from private_lib/lib/private_lib/handicap.rb:2:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>Why isn't the handicap class seeing the traversal_cap module?</p>\n"}, {"tags": ["ruby", "openssl", "smime"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3307945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d5a923d6589258e44fb942e3ad6c20?s=128&d=identicon&r=PG&f=1", "display_name": "user3307945", "link": "https://stackoverflow.com/users/3307945/user3307945"}, "is_accepted": false, "score": 0, "last_activity_date": 1530108137, "creation_date": 1530108137, "answer_id": 51064836, "question_id": 51051897, "link": "https://stackoverflow.com/questions/51051897/ruby-openssl-smime-encryption/51064836#51064836", "title": "ruby openssl smime encryption", "body": "<p>Figured it.</p>\n\n<pre><code>    token_plain_text = File.read(\"/path/to/token.txt\")\n    cert = X509::Certificate.new(\"/path/to/cert.pem\")\n    encrypted_object = OpenSSL::PKCS7.encrypt([cert], token_plain_text)\n</code></pre>\n\n<p>Got the encrypted string by outputting above object to string.</p>\n\n<pre><code>    encrypted_str = encrypted_object.to_str\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3307945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d5a923d6589258e44fb942e3ad6c20?s=128&d=identicon&r=PG&f=1", "display_name": "user3307945", "link": "https://stackoverflow.com/users/3307945/user3307945"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530108137, "creation_date": 1530050280, "question_id": 51051897, "link": "https://stackoverflow.com/questions/51051897/ruby-openssl-smime-encryption", "title": "ruby openssl smime encryption", "body": "<p>I am looking for ruby code to mimic below openssl smime encryption. I looked up other related topics but mostly were around signing. In snippet below cert.pem is a PEM-encoded X.509 certificate containing the PEM public key. token.txt file is the file to be encrypted.</p>\n\n<p><code>openssl smime -encrypt -out encrypted.p7m -in token.txt cert.pem</code></p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 1, "creation_date": 1530047067, "post_id": 51050836, "comment_id": 89093692, "body": "what&#39;s on task and user <code>tag_list</code> associated to other table?"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1530066360, "post_id": 51050836, "comment_id": 89098291, "body": "I can see that you tried to get all tasks belonging to current_user. Let&#39;s try this: <code>current_user.tasks</code> so that you will get a list of tasks of current_user. But i&#39;m not sure about <code>scholarship</code> variable. Where did you grant the value to this one?"}, {"owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "edited": false, "score": 0, "creation_date": 1530108137, "post_id": 51050836, "comment_id": 89119501, "body": "I was wrong. A user has no relationship with Task. I am trying to match them using the tags_list where the user with this list of tags can do these tasks. The scholarship variable is a typo it should be actually a task I just fixed it"}], "owner": {"reputation": 35, "user_id": 8190515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-bW8hqwAwTmk/AAAAAAAAAAI/AAAAAAAAAK8/ISRJZV_CSuQ/photo.jpg?sz=128", "display_name": "adnan hajar", "link": "https://stackoverflow.com/users/8190515/adnan-hajar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530107974, "creation_date": 1530044495, "last_edit_date": 1530107974, "question_id": 51050836, "link": "https://stackoverflow.com/questions/51050836/how-to-grab-list-of-tasks-from-a-user-using-active-record-instead-of-an-array", "title": "How to grab list of tasks from a User using active record instead of an array", "body": "<p>I am trying to grab the list of tasks that a user can do. I successfully was able to do that and here's my code </p>\n\n<pre><code>@tasklist = []     \nuser_info = [current_user.tag_list, current_user.ethnicity, current_user.gender, current_user.school, current_user.major ].flatten! \n          Task.all.each do |task|\n            if task.tag_list.all? { |i| user_info.include?(i) }\n            @tasklist.push(task)\n            end\n          end\n</code></pre>\n\n<p>Now, this is all great though in a prior implementation of my code. I had the @taglist as an active record and I used to use the two active record functions include and where on it as so: </p>\n\n<pre><code>@availabletasks = @tasklist.includes(:states).where(states: {user_id: current_user.id, value_cd: 0})\n</code></pre>\n\n<p>The ideal state is to replace my block of code that fetches the list of tasks to a single Query. \nThe other option is to replace my second line of code by an array select statement. Though I have no clue how to do so.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530045654, "post_id": 51050687, "comment_id": 89093076, "body": "Given the complexity of that statement what do you expect to return because AR objects seem pointless and the unaliased <code>sum()</code> seems like an <code>Array</code> would be sufficient? If so then using <code>Arel</code> to build the query would be best IMO"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530047078, "post_id": 51050687, "comment_id": 89093700, "body": "you can use the <a href=\"https://github.com/brianhempel/active_record_union\" rel=\"nofollow noreferrer\">active_record_union</a> gem"}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 4842949, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0agpj31wtZ8/AAAAAAAAAAI/AAAAAAAAAAA/mSolbNN-zIY/photo.jpg?sz=128", "display_name": "Joseph Cho", "link": "https://stackoverflow.com/users/4842949/joseph-cho"}, "is_accepted": false, "score": 1, "last_activity_date": 1530048790, "last_edit_date": 1530048790, "creation_date": 1530048449, "answer_id": 51051589, "question_id": 51050687, "link": "https://stackoverflow.com/questions/51050687/use-union-all-in-rails/51051589#51051589", "title": "use union all in rails", "body": "<p>Probably the simplest way to adapt your query to rails is to use the <code>find_by_sql</code> method. It looks like this:</p>\n\n<blockquote>\n  <p>Model.find_by_sql</p>\n</blockquote>\n\n<p>So translating your query it could look something like this.</p>\n\n<pre><code>Client.find_by_sql(\"\n  SELECT Sum(DV.importe + DV.iva) \n  FROM   venta \n         INNER JOIN detallevet DV \n                 ON DV.rutaid = [venta].rutaid \n                    AND DV.idempresa = [venta].idempresa \n                    AND DV.docto = [venta].documento \n  WHERE  venta.rutaid = 8 \n         AND diao = 611 \n         AND venta.tipovta = 'Contado' \n  UNION ALL \n  SELECT Sum(DP.importe + DP.iva) \n  FROM   pedidosliberados PL \n         INNER JOIN detallepedidoliberado DP \n                 ON PL.pedido = DP.pedido \n                    AND PL.ruta = DP.ruta \n                    AND PL.idempresa = DP.idempresa \n  WHERE  PL.cancelada = 0 \n         AND PL.status = 5 \n         AND PL.tipo = 'Contado' \n         AND PL.ruta = 8 \n         AND PL.diao_entrega = 611\n\")\n# =&gt; [&lt;Client id: 1, sum: 22 &gt;, &lt;Client id: 2, sum: 44&gt;...]\n</code></pre>\n\n<p>Alternatively if you don't have a model and just want to execute raw SQL, ActiveRecord has a neat helper function called <code>execute</code>.</p>\n\n<pre><code>sql = \"Select * from ... your sql query here\"\nrecords_array = ActiveRecord::Base.connection.execute(sql)\n</code></pre>\n\n<p>Reference <a href=\"https://stackoverflow.com/questions/14824453/rails-raw-sql-example\">here</a>.</p>\n"}], "owner": {"reputation": 321, "user_id": 7768323, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/4dc775ad1110dce42d259e3592704dcd?s=128&d=identicon&r=PG&f=1", "display_name": "jeff", "link": "https://stackoverflow.com/users/7768323/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530057946, "creation_date": 1530043830, "last_edit_date": 1530057946, "question_id": 51050687, "link": "https://stackoverflow.com/questions/51050687/use-union-all-in-rails", "title": "use union all in rails", "body": "<p>Is it possible to use <code>union all</code> in rails? I'm putting together a query but I need to use <code>union all</code>, is there any way to adapt it to rails? Here's my query:</p>\n\n<pre><code>select sum(DV.Importe + DV.iva) \nfrom venta INNER JOIN DetalleVet DV ON DV.RutaId = [venta].RutaID AND DV.IdEmpresa = [venta].IdEmpresa AND DV.Docto = [venta].Documento \nwhere venta.Rutaid=8 and diao=611 and venta.TipoVta='Contado'\nunion all \nselect SUM(DP.Importe + DP.Iva) from pedidosliberados PL inner join detallepedidoliberado DP on PL.PEDIDO=DP.PEDIDO and PL.RUTA=DP.RUTA and  PL.IDEMPRESA=DP.idempresa\nwhere  PL.cancelada=0 and  PL.status=5 and PL.Tipo='Contado' and PL.Ruta=8 and PL.DiaO_entrega=611\n</code></pre>\n"}, {"tags": ["ruby", "count"], "comments": [{"owner": {"reputation": 985, "user_id": 596489, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ai1aK.png?s=128&g=1", "display_name": "Vijay Sali", "link": "https://stackoverflow.com/users/596489/vijay-sali"}, "edited": false, "score": 0, "creation_date": 1530042927, "post_id": 51050330, "comment_id": 89091970, "body": "Before posting on forum follow the rules to post."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1530043587, "post_id": 51050330, "comment_id": 89092236, "body": "Hint: <a href=\"https://ruby-doc.org/core-2.4.0/String.html#method-i-count\" rel=\"nofollow noreferrer\"><code>String#count</code></a> Also I am not sure what site is recommending that you use a <code>while</code> loop in ruby but that is not the site I would want to learn ruby from"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 2, "creation_date": 1530045070, "post_id": 51050330, "comment_id": 89092846, "body": "The irony that the &quot;example solution&quot; is about the least effective and most inefficient way of the many different ways this could be accomplished.... The real challenge would be to &quot;Find a way to do this a more inefficient way than this&quot;"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1530066650, "post_id": 51050330, "comment_id": 89098360, "body": "I can see there&#39;re several solutions below. Now you might care about the complexity of these ones by implement them any measure the complexity to find the good one."}], "answers": [{"tags": [], "owner": {"reputation": 985, "user_id": 596489, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ai1aK.png?s=128&g=1", "display_name": "Vijay Sali", "link": "https://stackoverflow.com/users/596489/vijay-sali"}, "is_accepted": false, "score": 0, "last_activity_date": 1530042952, "creation_date": 1530042952, "answer_id": 51050499, "question_id": 51050330, "link": "https://stackoverflow.com/questions/51050330/num-of-vowels-in-ruby/51050499#51050499", "title": "num of vowels in ruby", "body": "<p>In your code it should be <code>word = string.split(\"\")</code></p>\n\n<p>Above snippet splits string into an array.</p>\n"}, {"comments": [{"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1530044958, "post_id": 51050879, "comment_id": 89092808, "body": "Although your example is more robust and flexible, in OP&#39;s exact example, the <code>downcase</code> would not even be necessary, as it states you can assume all the vowels are lower case."}], "tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 1, "last_activity_date": 1530045479, "last_edit_date": 1530045479, "creation_date": 1530044712, "answer_id": 51050879, "question_id": 51050330, "link": "https://stackoverflow.com/questions/51050330/num-of-vowels-in-ruby/51050879#51050879", "title": "num of vowels in ruby", "body": "<p>As mentioned in a comment above you could make your implementation simpler by using String's <code>count</code> method:</p>\n\n<pre><code> def count_vowels(string)\n   string.count('aeiou')\n end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": false, "score": 3, "last_activity_date": 1530045378, "creation_date": 1530045378, "answer_id": 51051023, "question_id": 51050330, "link": "https://stackoverflow.com/questions/51050330/num-of-vowels-in-ruby/51051023#51051023", "title": "num of vowels in ruby", "body": "<p>In Ruby, <a href=\"https://ruby-doc.org/core/String.html#method-i-split\" rel=\"nofollow noreferrer\"><code>String#split</code></a> by default splits a string into words, on whitespace:</p>\n\n<pre><code>\"test string split\".split() # =&gt; [\"test\", \"string\", \"split\"]\n</code></pre>\n\n<p>So, your solution is counting the number of full words that are equal to a vowel (words such as \"a\" and \"I\" by themselves). Yours would work if you split instead into characters by passing <code>''</code> as a parameter to <code>split</code>: </p>\n\n<pre><code>\"test string split\".split('') # =&gt; [\"t\", \"e\", \"s\", \"t\", \" \",\n  \"s\", \"t\", \"r\", \"i\", \"n\", \"g\", \" \", \"s\", \"p\", \"l\", \"i\", \"t\"]\n</code></pre>\n\n<p>However, there are better ways to get each character in the string, such as <a href=\"https://ruby-doc.org/core/String.html#method-i-each_char\" rel=\"nofollow noreferrer\"><code>String#each_char</code></a>:</p>\n\n<pre><code>\"test string split\".each_char { |char| # increment counter if char is a vowel }\n</code></pre>\n\n<p>and going further, you can simply use <a href=\"https://ruby-doc.org/core/String.html#method-i-count\" rel=\"nofollow noreferrer\"><code>String#count</code></a> to count the number of vowels:</p>\n\n<pre><code>\"test string split\".count('aeiou') # =&gt; 3\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7572522, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154358135488657/picture?type=large", "display_name": "Bilal Khalid", "link": "https://stackoverflow.com/users/7572522/bilal-khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1530045479, "creation_date": 1530042145, "last_edit_date": 1530043552, "question_id": 51050330, "link": "https://stackoverflow.com/questions/51050330/num-of-vowels-in-ruby", "title": "num of vowels in ruby", "body": "<p>I am fiddling around with some practice problems for ruby off the APP academy admissions. One particular problem that I am having trouble understanding why my solution is not working.</p>\n\n<p>The problem</p>\n\n<pre><code># Write a method that takes a string and returns the number of vowels\n# in the string. You may assume that all the letters are lower cased.\n# You can treat \"y\" as a consonant.\n</code></pre>\n\n<p>Here is my code for the solution which fails the tests. </p>\n\n<pre><code>def count_vowels(string)\n  vowels = 0\n  word = string.split()\n  idx = 0\n  while idx &lt;= word.length\n    current_char = word[idx]\n    if (current_char == \"a\"||current_char ==\"e\"||current_char==\"i\"||current_char==\"o\"||current_char==\"u\")\n      vowels += 1\n    end\n    idx += 1\n  end\n  return vowels \nend \n</code></pre>\n\n<p>this is the solution provided that works.</p>\n\n<pre><code>def count_vowels(string)\n  num_vowels = 0\n  i = 0\n  while i &lt; string.length\n    if (string[i] == \"a\" || string[i] == \"e\" || string[i] == \"i\" || string[i] == \"o\" || string[i] == \"u\")\n      num_vowels += 1\n    end\n    i += 1\n  end\n  return num_vowels\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "devise", "html-select", "grouped-collection-select"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 7268341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219a1062d951d40fe52353a4390155d0?s=128&d=identicon&r=PG&f=1", "display_name": "JJ McGregor", "link": "https://stackoverflow.com/users/7268341/jj-mcgregor"}, "edited": false, "score": 0, "creation_date": 1530181379, "post_id": 51077041, "comment_id": 89149290, "body": "Oh my god thank you so much! I can stop bashing my head against the wall now - the working difference was using <code>:user</code> instead of <code>resource</code>"}], "tags": [], "owner": {"reputation": 47, "user_id": 9989319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8905ba1f78ea867f4ab6a9e7896fef49?s=128&d=identicon&r=PG&f=1", "display_name": "Pavelb", "link": "https://stackoverflow.com/users/9989319/pavelb"}, "is_accepted": true, "score": 0, "last_activity_date": 1530170753, "creation_date": 1530170753, "answer_id": 51077041, "question_id": 51050122, "link": "https://stackoverflow.com/questions/51050122/grouped-collection-select-devise-and-rails-5-0-custom-registration-issue/51077041#51077041", "title": "grouped_collection_select, Devise and Rails 5.0 custom registration issue", "body": "<p>Maybe you'll try do it like this:</p>\n\n<pre><code>grouped_collection_select(:user, :chapter_id, @countries, :chapters, :name, :id, :city)\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7268341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/219a1062d951d40fe52353a4390155d0?s=128&d=identicon&r=PG&f=1", "display_name": "JJ McGregor", "link": "https://stackoverflow.com/users/7268341/jj-mcgregor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 51077041, "answer_count": 1, "score": 1, "last_activity_date": 1530170753, "creation_date": 1530041194, "question_id": 51050122, "link": "https://stackoverflow.com/questions/51050122/grouped-collection-select-devise-and-rails-5-0-custom-registration-issue", "title": "grouped_collection_select, Devise and Rails 5.0 custom registration issue", "body": "<p>I'm having having some issues with custom Devise registration in Rails 5. I have 3 models with the following AR associations</p>\n\n<ul>\n<li><p>User (Devise)</p>\n\n<ul>\n<li>belongs_to :chapter</li>\n</ul></li>\n<li><p>Chapter</p>\n\n<ul>\n<li>belongs_to :country</li>\n<li>has_many :users</li>\n</ul></li>\n<li><p>Country</p>\n\n<ul>\n<li>has_many :chapters</li>\n</ul></li>\n</ul>\n\n<p>I created a seed file for Chapter and Country and that's working fine, with their associations working perfectly. However, what I want to do is created a nested dropdown on the Sign Up page generated by Devise to choose the Chapter from the Country that they will belong to (and before anyone asks, this isn't a cult thing, it's for a social initiative project :P ). I'm able to add a custom field for username, so I know that my <code>config/initializers/devise.rb</code> and <code>app/controllers/application_controller.rb</code> is are configured correctly. </p>\n\n<p>This is my <code>grouped_collection_select</code>:</p>\n\n<pre><code>&lt;%= grouped_collection_select(resource, :chapter_id, Country.all, :chapters, :name, :id, :city) %&gt;\n</code></pre>\n\n<p>which - bizarrely - produces an select tag like this:</p>\n\n<pre><code>&lt;select name=\"#&lt;User:0x007fb7686ba478&gt;[chapter_id]\" id=\"__User:0x007fb7686ba478_chapter_id\" &gt;&lt;/select\n</code></pre>\n\n<p>The name is all messed up and it's the reason it's not picking up the name when the form gets submitted, throwing the error 'Chapter must exist'. I've been on SO and Google all damn day trying to work out why and haven't got very far. It works fine when I do </p>\n\n<pre><code>&lt;%= f.select :chapter_id, Chapter.pluck(:city, :id) %&gt;\n</code></pre>\n\n<p>which creates...</p>\n\n<pre><code>&lt;select name=\"user[chapter_id]\" id=\"user_chapter_id\" &gt;&lt;/select\n</code></pre>\n\n<p>but I want a nested dropdown.</p>\n\n<p>Any and all help is most welcome!</p>\n"}, {"tags": ["ruby", "kubernetes", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4aab8bae8d22e86b6915207363b194?s=128&d=identicon&r=PG&f=1", "display_name": "rkumar", "link": "https://stackoverflow.com/users/9996307/rkumar"}, "edited": false, "score": 0, "creation_date": 1530106808, "post_id": 51057653, "comment_id": 89118533, "body": "thanks, but I was more looking for writing checks in ruby"}, {"owner": {"reputation": 7068, "user_id": 2718151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fbf5d5ebe5c06ec8f0db845d356b157?s=128&d=identicon&r=PG", "display_name": "Nicola Ben", "link": "https://stackoverflow.com/users/2718151/nicola-ben"}, "reply_to_user": {"reputation": 9, "user_id": 9996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4aab8bae8d22e86b6915207363b194?s=128&d=identicon&r=PG&f=1", "display_name": "rkumar", "link": "https://stackoverflow.com/users/9996307/rkumar"}, "edited": false, "score": 0, "creation_date": 1530111168, "post_id": 51057653, "comment_id": 89121549, "body": "<a href=\"https://rubygems.org/gems/sensu-plugins-prometheus-checks/versions/3.1.3\" rel=\"nofollow noreferrer\">rubygems.org/gems/sensu-plugins-prometheus-checks/versions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 7068, "user_id": 2718151, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fbf5d5ebe5c06ec8f0db845d356b157?s=128&d=identicon&r=PG", "display_name": "Nicola Ben", "link": "https://stackoverflow.com/users/2718151/nicola-ben"}, "is_accepted": false, "score": 2, "last_activity_date": 1530086798, "creation_date": 1530086798, "answer_id": 51057653, "question_id": 51049868, "link": "https://stackoverflow.com/questions/51049868/configure-sensu-to-collect-metrics-from-prometheus-using-ruby/51057653#51057653", "title": "configure Sensu to collect metrics from Prometheus; using ruby", "body": "<p>I found with a quick reasearch on google that in github there's a collector for Sensu:\n<a href=\"https://github.com/portertech/sensu-prometheus-collector#sensu-prometheus-collector\" rel=\"nofollow noreferrer\">https://github.com/portertech/sensu-prometheus-collector#sensu-prometheus-collector</a></p>\n"}], "owner": {"reputation": 9, "user_id": 9996307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4aab8bae8d22e86b6915207363b194?s=128&d=identicon&r=PG&f=1", "display_name": "rkumar", "link": "https://stackoverflow.com/users/9996307/rkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530286035, "creation_date": 1530039917, "last_edit_date": 1530286035, "question_id": 51049868, "link": "https://stackoverflow.com/questions/51049868/configure-sensu-to-collect-metrics-from-prometheus-using-ruby", "title": "configure Sensu to collect metrics from Prometheus; using ruby", "body": "<p>I set up Prometheus in kubernetes to get the metrics. Now, I'm working on getting Sensu to monitor the metrics from prometheus.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1530040204, "post_id": 51049735, "comment_id": 89090829, "body": "when you say <code>it didn&#39;t work</code> what exactly do you mean? show how you are testing it."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1530040341, "post_id": 51049735, "comment_id": 89090882, "body": "You are confusing <code>include</code> with inheritance. You could use alias to achieve what you want, but simply including is not going to work as you have discovered."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530046535, "post_id": 51049735, "comment_id": 89093438, "body": "<code>B::is_okay?</code> is defined in <code>B</code>s eigenclass and <code>A::is_okay?</code> is defined in <code>A</code>s eigenclass. <code>including</code> <code>B</code> in <code>A</code> does not change this at all (or anything really)"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1530050847, "post_id": 51049735, "comment_id": 89095038, "body": "Should clarify here that &quot;A&quot; is not your module, and is not within your code base. That would also explain the unconventional use of &quot;send&quot; to include your module, which is not even necessary."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530042119, "post_id": 51050074, "comment_id": 89091615, "body": "I can&#39;t change module A. I want to overwrite it by module B."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530042543, "post_id": 51050074, "comment_id": 89091798, "body": "If you tested the above, you would see that if you called <code>A.is_okay?</code>, the return value is <code>true</code>, being called from <code>B</code>, not <code>false</code> as it is defined in <code>A</code>. Is that not the intended behavior?"}, {"owner": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530043187, "post_id": 51050074, "comment_id": 89092070, "body": "Sure, but I can&#39;t modify <code>A</code>. <code>A</code> must remain unchanged."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530044407, "post_id": 51050074, "comment_id": 89092602, "body": "I don&#39;t think you understand what include even does then, or why you are even using it within A. By default, including B into A with the same method leaves it unchanged. <code>A.is_okay?</code> will still return <code>false</code>. It is unmodified. You are asking how to overwrite something but leave it unchanged. Just alias it if that is the desired behavior, I have no clue what all this <code>include</code> and eigenclass and B module stuff is even about then. The original code you posted doesn&#39;t override &quot;is_okay?&quot; in either A or B, yet you include it in A, saying you want to overwrite, but then say it can&#39;t be changed..."}, {"owner": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530047528, "post_id": 51050074, "comment_id": 89093884, "body": "To be clear. <code>A</code> is defined in another repository that I don&#39;t have access, so I can&#39;t modify <code>A</code>. I can&#39;t use <code>prepend</code> inside <code>A</code>. There is a <code>is_okay?</code> method that returns <code>false</code>. I want to overwrite this method to return <code>true</code> somehow. So, I want call <code>A.is_okay?</code> and I expect <code>true</code>."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 1, "creation_date": 1530050614, "post_id": 51050074, "comment_id": 89094951, "body": "First, you <i>can</i> modify it whether or not in its another repository, just re-open the class and add/modify whatever you want, so long as you load the original before attempting to add to it. I updated my answer to show how. Technically you could just re-define the method without an alias, but I used an alias to maintain the original behavior if you still required it. Would just have to call <code>A.original_is_okay?</code> to get the &quot;unmodified&quot; version."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "edited": false, "score": 0, "creation_date": 1530058732, "post_id": 51050074, "comment_id": 89096896, "body": "@engineersmnky For straight redefinition, yes, don&#39;t think that works with aliasing, though."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530109269, "post_id": 51050074, "comment_id": 89120264, "body": "@ForeverZer0 I guess you could go with <code>singleton_class.alias_method :original_is_okay?, :is_okay?</code> and still redefine <code>is_okay?</code> directly in <code>A</code>"}], "tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 0, "last_activity_date": 1530050488, "last_edit_date": 1530050488, "creation_date": 1530040900, "answer_id": 51050074, "question_id": 51049735, "link": "https://stackoverflow.com/questions/51049735/how-to-overwrite-eigenclass-method-in-ruby/51050074#51050074", "title": "How to overwrite eigenclass method in ruby?", "body": "<p>This may or may not work in your situation:</p>\n\n<pre><code>module B\n  def is_okay?\n    true\n  end\nend\n\nmodule A\n\n  class &lt;&lt; self\n\n    prepend B\n\n    def is_okay?\n      false\n    end\n  end\nend\n</code></pre>\n\n<p><code>prepend</code> is similar to <code>include</code>, but inserts itself <em>before</em> the class, at the \"bottom\" of the ancestor chain. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Since you clarified in your comments below (I would suggest clarifying your original question), you can alias the same as any other method.</p>\n\n<pre><code>module A\n\n  class &lt;&lt; self\n    alias original_is_okay? is_okay?\n    def is_okay?\n      true\n    end\n\n  end\nend\n</code></pre>\n\n<p>This will allow for \"overwriting it, whether or not you have access to it.  </p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1530122409, "creation_date": 1530122409, "answer_id": 51068886, "question_id": 51049735, "link": "https://stackoverflow.com/questions/51049735/how-to-overwrite-eigenclass-method-in-ruby/51068886#51068886", "title": "How to overwrite eigenclass method in ruby?", "body": "<p>Consider the following.</p>\n\n<pre><code>module B\n  def bi\n    \"hello from bi\"\n  end\n  def self.bm\n    \"hello from bm\"\n  end\nend\n\nB.instance_methods(false)\n  #=&gt; [:bi]\nB.methods(false)\n  #=&gt; [:bm]\n</code></pre>\n\n<p>Note that defining a module method (here <code>bm</code>) with <code>self.</code> is the same as defining an instance method on the module's singleton class.</p>\n\n<p>Now create a module <code>A</code> that includes <code>B</code>.</p>\n\n<pre><code>module A\n  def self.am\n    \"hello from am\"\n  end\nend\n\nA.methods(false)\n  #=&gt; [:am]\nA.include B\n\nA.instance_methods.include?(:bi)\n  #=&gt; true\nA.methods.include?(:bm)\n  #=&gt; false\n</code></pre>\n\n<p>As expected, <code>bi</code> is now an instance method of <code>A</code>. <code>include</code>, however, disregards module methods, here <code>B::bm</code>. Is there any way for the module method <code>B::m</code> to become a module method of <code>A</code>? The answer is \"no\". In effect, we want</p>\n\n<pre><code>A.singleton_class.include B.singleton_class\n</code></pre>\n\n<p>but that doesn't work because <code>B.singleton_class</code> is a class.</p>\n\n<p><a href=\"http://ruby-doc.org/core-2.4.0/Module.html#method-i-include\" rel=\"nofollow noreferrer\">Module#include</a> does not make it clear whether a module (that is possibly a class) can include a class. Try it, however, and you will see the following an exception is raised:</p>\n\n<pre><code>TypeError (wrong argument type Class (expected Module))\n</code></pre>\n\n<p>If module methods of a module <code>M</code> are not made available to another module that includes <code>M</code>, is there any reason for modules to have module methods? Yes, to provide libraries of methods! An example is the module <a href=\"http://ruby-doc.org/core-2.4.0/Math.html\" rel=\"nofollow noreferrer\">Math</a>. That module contains many module methods and no instance methods. When used, those methods are  therefore invoked on their receiver, <code>Math</code>. For example,</p>\n\n<pre><code>Math.sin(x)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4707538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/220badaa1988c3bded8273825b7a576c?s=128&d=identicon&r=PG&f=1", "display_name": "kamix", "link": "https://stackoverflow.com/users/4707538/kamix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530122409, "creation_date": 1530039358, "question_id": 51049735, "link": "https://stackoverflow.com/questions/51049735/how-to-overwrite-eigenclass-method-in-ruby", "title": "How to overwrite eigenclass method in ruby?", "body": "<p>I have a module</p>\n\n<pre><code>module A\n  class &lt;&lt; self\n    def is_okay?; false; end\n  end\nend\n</code></pre>\n\n<p>and I need to overwrite <code>is_okay?</code> method in another module. Module <code>B</code> is included into <code>A</code> in this way</p>\n\n<pre><code>A.send(:include, B)\n</code></pre>\n\n<p>I have tried this</p>\n\n<pre><code>module B\n  class &lt;&lt; self\n    def is_okay?; true; end\n  end\nend\n</code></pre>\n\n<p>and that</p>\n\n<pre><code>module B\n  def self.is_okay?; true; end\nend\n</code></pre>\n\n<p>but it didn't work. How can I achieve this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530070269, "post_id": 51049583, "comment_id": 89099110, "body": "Have you got a chance to customize it ?"}], "answers": [{"tags": [], "owner": {"reputation": 4052, "user_id": 476979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e55df1cc7d5fdb4ae9bc2afcb9afe7e4?s=128&d=identicon&r=PG", "display_name": "matthewd", "link": "https://stackoverflow.com/users/476979/matthewd"}, "is_accepted": false, "score": 2, "last_activity_date": 1530102734, "creation_date": 1530102734, "answer_id": 51062890, "question_id": 51049583, "link": "https://stackoverflow.com/questions/51049583/how-to-wrap-all-methods-in-rails-console-irb-in-a-block-in-ruby/51062890#51062890", "title": "How to wrap all methods in Rails console (IRB) in a block in Ruby?", "body": "<p>If you're able to switch from IRB to Pry (the <code>pry-rails</code> gem will load it automatically for <code>rails c</code>), it provides <a href=\"https://github.com/pry/pry/wiki/Hooks\" rel=\"nofollow noreferrer\">a hooks API</a> that should do what you need. It sounds like you'd want the <code>:before_eval</code> and <code>:after_eval</code> events.</p>\n\n<p>I don't know of an equivalent mechanism for IRB, though it should be possible to hack something using TracePoint.</p>\n"}], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530102734, "creation_date": 1530038706, "question_id": 51049583, "link": "https://stackoverflow.com/questions/51049583/how-to-wrap-all-methods-in-rails-console-irb-in-a-block-in-ruby", "title": "How to wrap all methods in Rails console (IRB) in a block in Ruby?", "body": "<p>I have seen <a href=\"http://ruby-doc.org/stdlib-2.0.0/libdoc/irb/rdoc/IRB.html\" rel=\"nofollow noreferrer\">http://ruby-doc.org/stdlib-2.0.0/libdoc/irb/rdoc/IRB.html</a> and can see various ways to customize IRB. But did not see how to:</p>\n\n<p>Write a block (or method) such that whenever a command is run in Rails console it runs the block.</p>\n\n<p>For example:</p>\n\n<pre><code>begin\n  puts :before\n  yield\n  puts :after\nend\n</code></pre>\n\n<p>Then, when you do</p>\n\n<pre><code>=&gt; puts :OK\n:before\n:OK\n:after\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "rails-admin"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530038184, "post_id": 51049218, "comment_id": 89089956, "body": "post controller also"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530038986, "post_id": 51049218, "comment_id": 89090300, "body": "@7urkm3n added. addusers.html.erb is the above signup form for admins"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530039437, "post_id": 51049218, "comment_id": 89090488, "body": "i think you need to add routes also"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "reply_to_user": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530039866, "post_id": 51049218, "comment_id": 89090671, "body": "@7urkm3n i have already done that. <b>get &#39;usersignup&#39;, to:&#39;parents#addusers&#39;</b>.  All I want to do is set the parent as admin during signup with a hidden field which sets admin boolean field to true ."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1530042160, "post_id": 51049921, "comment_id": 89091635, "body": "Please check the updated parent controller above. it is still not working."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1530042714, "post_id": 51049921, "comment_id": 89091873, "body": "when i click on signup it run def create function rather than def create_users function. please check the updated parent controller above"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530042784, "post_id": 51049921, "comment_id": 89091906, "body": "do u have before_action methods ?, can u post properly routes ?"}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530042838, "post_id": 51049921, "comment_id": 89091934, "body": "if it goes via <code>create</code> method just add this line <code>@parent.admin = true</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "edited": false, "score": 0, "creation_date": 1530043024, "post_id": 51049921, "comment_id": 89092003, "body": "Please check the routes above. I can&#39;t add @parent.admin = true in create method because that method is used to create parents who are not admin."}, {"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1530043397, "post_id": 51049921, "comment_id": 89092152, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/173844/discussion-between-7urkm3n-and-navroop-singh-sidhu\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1530043393, "last_edit_date": 1530043393, "creation_date": 1530040186, "answer_id": 51049921, "question_id": 51049218, "link": "https://stackoverflow.com/questions/51049218/signup-form-for-admin-in-rails/51049921#51049921", "title": "Signup form for admin in rails", "body": "<p>Remove hidden line from html page, no need it <code>f.hidden_field :admin, :value =&gt; true</code> </p>\n\n<p><strong>Form_for</strong></p>\n\n<pre><code>form_for(@parent, url: usersignup_path, \n        :html =&gt; { multipart: true, class: \"form-horizontal\", role: \"form\"}) do |f|\n</code></pre>\n\n<p><strong>Add to routes:</strong></p>\n\n<pre><code>post 'usersignup', to:'parents#create_users'\n</code></pre>\n\n<p><strong>Controller:</strong></p>\n\n<pre><code>def create_users\n   @parent = Parent.new(parent_params)\n   @parent.admin = true\n   if @parent.save\n      #do yr logic here\n   else\n      redirect_back(fallback_location: \"/\", flash: { danger: \"smth went wrong..\" })\n   end\nend\n\ndef parent_params\n    params.require(:parent).permit(:email, :password, :password_confirmation)\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9899928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 51049921, "answer_count": 1, "score": 0, "last_activity_date": 1530043393, "creation_date": 1530037081, "last_edit_date": 1530042957, "question_id": 51049218, "link": "https://stackoverflow.com/questions/51049218/signup-form-for-admin-in-rails", "title": "Signup form for admin in rails", "body": "<p>I have a parent table and in it there is a boolean field admin. I have a admin signup page where i want a hidden field for admin to set as true. Please help. I have tried the step below. please correct it as it is not working.</p>\n\n<pre><code>&lt;div class='row'&gt;\n    &lt;div class= 'col-xs-12'&gt;\n      &lt;%= form_for(@parent, :html =&gt; { multipart: true, class: \"form-horizontal\", role: \"form\"}) do |f| %&gt;\n        &lt;div class = \"form-group\"&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= f.label :email, class: \"required\" %&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= f.email_field :email, class: \"form-control\", placeholder: \"Enter email\", required: true %&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class = \"form-group\"&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= f.label :password, class: \"required\" %&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= f.password_field :password, class: \"form-control\", placeholder: \"Enter password\", required: true %&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class = \"form-group\"&gt;\n          &lt;div class=\"control-label col-sm-2\"&gt;\n            &lt;%= f.label :password_confirmation, class: \"required\" %&gt;\n          &lt;/div&gt;\n          &lt;div class=\"col-sm-8\"&gt;\n            &lt;%= f.password_field :password_confirmation, class: \"form-control\", placeholder: \"Re-enter password\", required: true %&gt;\n          &lt;/div&gt;  \n        &lt;/div&gt;\n        &lt;%= f.hidden_field :admin, :value =&gt; true %&gt;\n        &lt;div class=\"form-group\"&gt;\n          &lt;div class=\"col-sm-10\"&gt;\n            &lt;%= f.submit 'Sign up', class: 'btn btn-primary btn-lg' %&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>Parent controller</p>\n\n<pre><code>    def addusers\n        @parent=Parent.new\n    end\n</code></pre>\n\n<p>Updated parent controller</p>\n\n<pre><code>    def new\n        @parent = Parent.new\n        @parent.secondaryparents.build\n        add_breadcrumb \"Home\", :root_path\n        add_breadcrumb \"Sign up\"\n    end\n\n    def addusers\n        @parent=Parent.new\n    end\n\n    def create_users\n        @parent=Parent.new(parent_params)\n        @parent.admin = true\n        if @parent.save\n            ParentMailer.registration_confirmation(@parent).deliver\n            flash[:success] = \"Please ask user to confirm email address to continue\"\n            redirect_to main_admin_path\n        else\n            flash[:danger] = \"There was an error with registering. Try again\"\n            redirect_to main_admin_path\n        end\n    end\n\ndef create\n        @parent = Parent.new(parent_params)\n        if @parent.save\n            ParentMailer.registration_confirmation(@parent).deliver\n            flash[:success] = \"Please confirm your email address to continue\"\n            redirect_to root_path(@parent)\n        else\n            flash[:danger] = \"There was an error with registering. Try again\"\n            redirect_to signup_path\n        end\n    end\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code>resources :parents do\n    resources :children do\n        resources :fundings\n        end\n    end\nend\n\nget 'signup', to:'parents#new'\nget 'login', to: 'sessions#new'\nget 'usersignup', to:'parents#addusers'\npost 'usersignup', to:'parents#create_users'\n\nresources :parents, except: [:new] do\n    member do\n        get :confirm_email\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "chef-infra", "berkshelf", "berksfile"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 7569714, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d77cb63ae6ca548e1d584a8cdf870037?s=128&d=identicon&r=PG&f=1", "display_name": "Jaw. M.", "link": "https://stackoverflow.com/users/7569714/jaw-m"}, "edited": false, "score": 0, "creation_date": 1530186821, "post_id": 51049318, "comment_id": 89152868, "body": "Thanks a lot for your answer."}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": true, "score": 2, "last_activity_date": 1530037449, "creation_date": 1530037449, "answer_id": 51049318, "question_id": 51048446, "link": "https://stackoverflow.com/questions/51048446/chef-generating-berksfile-on-existing-cookbook/51049318#51049318", "title": "Chef - Generating Berksfile on existing cookbook", "body": "<p>There is no reason to use <code>berks cookbook</code> anymore and I'm pretty sure it was removed years ago. It sounds like your first problem is that your gem environment is very broken. We only support Berkshelf via the ChefDK installers, not <code>gem install berkshelf</code>. You appear to have the <code>chef-client</code> installer, not <code>ChefDK</code>, so fix that first. Then if you just want a standard Berksfile it's:</p>\n\n<pre><code>source \"https://supermarket.chef.io/\"\nmetadata\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 7569714, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d77cb63ae6ca548e1d584a8cdf870037?s=128&d=identicon&r=PG&f=1", "display_name": "Jaw. M.", "link": "https://stackoverflow.com/users/7569714/jaw-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 51049318, "answer_count": 1, "score": 0, "last_activity_date": 1530037449, "creation_date": 1530033795, "question_id": 51048446, "link": "https://stackoverflow.com/questions/51048446/chef-generating-berksfile-on-existing-cookbook", "title": "Chef - Generating Berksfile on existing cookbook", "body": "<p>A Berksfile is missing on a cookbook that's why I want to create a new one\nI just want to generate a berksfile on an existing cookbook.\nSo when I try to run the command: \n<code>berks cookbook name_of_my_cookbook</code></p>\n\n<p>I'm getting the following error \n<code>/opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems.rb:271:\nin find_spec_for_exe: can't find gem berkshelf (&gt;= 0.a) (Gem::GemNotFoundException)\nfrom /opt/chef/embedded/lib/ruby/site_ruby/2.3.0/rubygems.rb:299:in activate_bin_path\nfrom /usr/local/bin/berks:23:in</code>'</p>\n\n<p>I tried to install berkshelf again via <code>gem install berkshelf</code> but I'm getting another error message:\n<code>ERROR:  Error installing berkshelf:\nThere are no versions of solve (~&gt; 4.0) compatible with your Ruby &amp; RubyGems. Maybe try installing an older version of the gem you're looking for?\nsolve requires Ruby version &gt;= 2.1.0. The current ruby version is .</code></p>\n\n<p>I have no other idea to solve this issue. I'm quite a newbie on this so I appreciate any help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530082715, "post_id": 51048410, "comment_id": 89103257, "body": "Why do you think that this happens automatically?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530083693, "post_id": 51048410, "comment_id": 89103752, "body": "@Stefan: one could even say &quot;automagically&quot; :)"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530034193, "post_id": 51048523, "comment_id": 89088139, "body": "Read through this thread, might clear some confusion: <a href=\"https://stackoverflow.com/questions/4911353/best-explanation-of-ruby-blocks\" title=\"best explanation of ruby blocks\">stackoverflow.com/questions/4911353/&hellip;</a>"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1530034406, "last_edit_date": 1530034406, "creation_date": 1530034087, "answer_id": 51048523, "question_id": 51048410, "link": "https://stackoverflow.com/questions/51048410/how-does-a-code-block-in-ruby-know-what-variable-belongs-to-an-aspect-of-an-obje/51048523#51048523", "title": "How does a code block in Ruby know what variable belongs to an aspect of an object?", "body": "<blockquote>\n  <p>And memo is just memo</p>\n</blockquote>\n\n<p>what do you mean, \"just memo\"? <code>memo</code> and <code>n</code> take whatever values <code>inject</code> passes. And it is implemented to pass accumulator/memo as first argument and current collection element as second argument.</p>\n\n<blockquote>\n  <p>How do '|key, old, new|' automatically assign themselves</p>\n</blockquote>\n\n<p>They don't \"assign themselves\". <code>merge</code> assigns them. Or rather, passes those values (key, old value, new value) in that order as block parameters.</p>\n\n<p>If you instead write </p>\n\n<pre><code>hash1.merge(hash2) {|foo, bar, baz| bar}\n</code></pre>\n\n<p>It'll still work <strong>exactly</strong> as before. Parameter names mean nothing [here]. It's actual values that matter.</p>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 2, "last_activity_date": 1530037701, "last_edit_date": 1530037701, "creation_date": 1530037285, "answer_id": 51049269, "question_id": 51048410, "link": "https://stackoverflow.com/questions/51048410/how-does-a-code-block-in-ruby-know-what-variable-belongs-to-an-aspect-of-an-obje/51049269#51049269", "title": "How does a code block in Ruby know what variable belongs to an aspect of an object?", "body": "<p>The parameters for the block are determined by the method definition. The definition for <code>reduce/inject</code> is overloaded (<a href=\"https://ruby-doc.org/core-2.1.0/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">docs</a>) and defined in C, but if you wanted to define it, you could do it like so (note, this doesn't cover all the overloaded cases for the actual <code>reduce</code> definition):</p>\n\n<pre><code>module Enumerable\n  def my_reduce(memo=nil, &amp;blk)\n    # if a starting memo is not given, it defaults to the first element\n    # in the list and that element is skipped for iteration\n    elements = memo ? self : self[1..-1]\n    memo ||= self[0]\n    elements.each { |element| memo = blk.call(memo, element) }\n    memo\n  end\nend\n</code></pre>\n\n<p>This method definition determines what values to use for <code>memo</code> and <code>element</code> and calls the <code>blk</code> variable (a block passed to the method) with them in a specific order.</p>\n\n<p>Note, however, that blocks are not like regular methods, because they don't check the number of arguments. For example: (note, this example shows the usage of <code>yield</code> which is another way to pass a block parameter)</p>\n\n<pre><code>def foo\n  yield 1\nend\n\n# The b and c variables here will be nil\nfoo { |a, b, c| [a,b,c].compact.sum } # =&gt; 1\n</code></pre>\n\n<p>You can also use deconstruction to define variables at the time you run the block, for example if you wanted to <code>reduce</code> over a hash you could do something like this:</p>\n\n<pre><code># this just copies the hash\n{a: 1}.reduce({}) { |memo, (key, val)| memo[key] = val; memo }\n</code></pre>\n\n<p>How this works is, calling <code>reduce</code> on a hash implicitly calls <code>to_a</code>, which converts it to a list of tuples (e.g. <code>{a: 1}.to_a = [[:a, 1]]</code>). <code>reduce</code> passes each tuple as the second argument to the block. In the place where the block is called, the tuple is deconstructed into separate key and value variables.</p>\n"}, {"tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 1, "last_activity_date": 1530039883, "creation_date": 1530039883, "answer_id": 51049861, "question_id": 51048410, "link": "https://stackoverflow.com/questions/51048410/how-does-a-code-block-in-ruby-know-what-variable-belongs-to-an-aspect-of-an-obje/51049861#51049861", "title": "How does a code block in Ruby know what variable belongs to an aspect of an object?", "body": "<p>Just to simplify some of the other good answers here:</p>\n\n<p>If you are struggling understanding blocks, an easy way to think of them is as a primitive and temporary method that you are creating and executing in place, and the values between the pipe characters <code>|memo|</code> is simply the argument signature. </p>\n\n<p>There is no special special concept behind the arguments, they are simply there for the method you are invoking to pass a variable to, like calling any other method with an argument. Similar to a method, the arguments are \"local\" variables within the scope of the block (there are some nuances to this depending on the syntax you use to call the block, but I digress, that is another matter).</p>\n\n<p>The method you pass the block to simply invokes this \"temporary method\" and passes the arguments to it that it is designed to do. Just like calling a method normally, with some slight differences, such as there are no \"required\" arguments. If you do not define any arguments to receive, it will happily just not pass them instead of raising an <code>ArgumentError</code>. Likewise, if you define too many arguments for the block to receive, they will simply be <code>nil</code> within the block, no errors for not being defined.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1530052680, "creation_date": 1530052680, "answer_id": 51052249, "question_id": 51048410, "link": "https://stackoverflow.com/questions/51048410/how-does-a-code-block-in-ruby-know-what-variable-belongs-to-an-aspect-of-an-obje/51052249#51052249", "title": "How does a code block in Ruby know what variable belongs to an aspect of an object?", "body": "<p>A code block is just a function with no name. Like any other function, it can be called multiple times with different arguments. If you have a method </p>\n\n<pre><code>def add(a, b)\n  a + b\nend\n</code></pre>\n\n<p>How does <code>add</code> know that sometimes <code>a</code> is <code>5</code> and sometimes <code>a</code> is <code>7</code>?</p>\n\n<p><code>Enumerable#inject</code> simply calls the function once for each element, passing the element as an argument.</p>\n\n<p>It looks a bit like this:</p>\n\n<pre><code>module Enumerable\n  def inject(memo)\n    each do |el|\n      memo = yield memo, el\n    end\n    memo\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5091002, "user_type": "registered", "profile_image": "https://graph.facebook.com/1268433283200513/picture?type=large", "display_name": "Andrew Kwang", "link": "https://stackoverflow.com/users/5091002/andrew-kwang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1530052680, "creation_date": 1530033664, "question_id": 51048410, "link": "https://stackoverflow.com/questions/51048410/how-does-a-code-block-in-ruby-know-what-variable-belongs-to-an-aspect-of-an-obje", "title": "How does a code block in Ruby know what variable belongs to an aspect of an object?", "body": "<p>Consider the following:</p>\n\n<pre><code>(1..10).inject{|memo, n| memo + n}\n</code></pre>\n\n<p>Question:</p>\n\n<p>How does n know that it is supposed to store all the values from 1..10? I'm confused how Ruby is able to understand that n can automatically be associated with (1..10) right away, and memo is just memo.</p>\n\n<p>I know Ruby code blocks aren't the same as the C or Java code blocks--Ruby code blocks work a bit differently. I'm confused as to how variables that are in between the upright pipes '|' will automatically be assigned to parts of an object. For example:</p>\n\n<pre><code>hash1 = {\"a\" =&gt; 111, \"b\" =&gt; 222}\nhash2 = {\"b\" =&gt; 333, \"c\" =&gt; 444}\nhash1.merge(hash2) {|key, old, new| old}\n</code></pre>\n\n<p>How do '|key, old, new|' automatically assign themselves in such a way such that when I type 'old' in the code block, it is automatically aware that 'old' refers to the older hash value? I never assigned 'old' to anything, just declared it. Can someone explain how this works?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "chartkick"], "comments": [{"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1530062979, "post_id": 51048381, "comment_id": 89097684, "body": "can you ellaborate more? the question isn&#39;t completely clear, where do you want to show just 60 point?"}, {"owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "reply_to_user": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1530068909, "post_id": 51048381, "comment_id": 89098860, "body": "<code>speed</code> model contain <code>id_watch</code>,<code>speed</code> . i need to show 60 point in line chart."}], "owner": {"reputation": 81, "user_id": 6929917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf56bd426d4ad31869d26e913ab0b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Sdadad", "link": "https://stackoverflow.com/users/6929917/sdadad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530034245, "creation_date": 1530033588, "last_edit_date": 1530034245, "question_id": 51048381, "link": "https://stackoverflow.com/questions/51048381/need-display-specific-number-of-point-only-in-line-chart-in-rails", "title": "need display specific number of point only in line chart in rails", "body": "<p>need display 60 point only in line chart  and refresh display another 60 </p>\n\n<p><strong>use chartkick gem</strong></p>\n\n<p><code>index</code> view</p>\n\n<pre><code>&lt;%= line_chart @spee.group_by_second(:created_at).maximum(:speed), refresh: 20 %&gt;\n</code></pre>\n\n<p><code>speed</code> controller</p>\n\n<pre><code>@spee = Speed.where(id_watch: current_master.id_watch)\n</code></pre>\n\n<p>This shape appear but need 60 point only\n<a href=\"https://i.stack.imgur.com/vZNQR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vZNQR.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["ruby", "hashmap"], "answers": [{"tags": [], "owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "is_accepted": false, "score": 6, "last_activity_date": 1530033214, "creation_date": 1530033214, "answer_id": 51048276, "question_id": 51048201, "link": "https://stackoverflow.com/questions/51048201/why-am-i-not-getting-same-output-in-ruby/51048276#51048276", "title": "Why am I not getting same output in Ruby", "body": "<p>keys are symbol in second case - </p>\n\n<pre><code>{:hand=&gt;1, :eye=&gt;2, :head=&gt;3, :hair=&gt;4}\n</code></pre>\n\n<p>whereas <code>internal</code> is a <em>string</em>. \n<code>humen[internal]</code> is expecting the string assigned to internal to be present in hash <code>humen</code> which is not the case. </p>\n\n<p><code>:hand != 'hand'</code></p>\n\n<p>You should convert the string to symbol by: </p>\n\n<pre><code>humen[internal.to_sym]\n</code></pre>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.3/Symbol.html#method-i-to_sym\" rel=\"noreferrer\"><code>String#to_sym</code></a> converts a string into a symbol.</p>\n"}], "owner": {"reputation": 11, "user_id": 9317773, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-W3kRl1gLy5g/AAAAAAAAAAI/AAAAAAAAEWc/AfB1I8syBWc/photo.jpg?sz=128", "display_name": "Sadik Sikder", "link": "https://stackoverflow.com/users/9317773/sadik-sikder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530033435, "creation_date": 1530032905, "last_edit_date": 1530033435, "question_id": 51048201, "link": "https://stackoverflow.com/questions/51048201/why-am-i-not-getting-same-output-in-ruby", "title": "Why am I not getting same output in Ruby", "body": "<p>I'm not getting the consistent output in two cases:</p>\n\n<h2>Scenario 1:</h2>\n\n<pre><code>humen = {\"hand\" =&gt; 1, \"eye\" =&gt; 2, \"head\" =&gt; 3, \"hair\"=&gt;4}\nputs  \"enter any body part name\"\ninternal = gets.chomp.downcase.to_s\n\nbody = humen[internal]\n\nputs body\n#if input is \"eye\", it comes out 2\n</code></pre>\n\n<h2>Scenario 2:</h2>\n\n<pre><code>humen = {hand:1, eye:2, head:3, hair:4}\nputs  \"enter any body part name\"\ninternal = gets.chomp.downcase.to_s\n\nbody = humen[internal]\n\nputs body\n</code></pre>\n\n<p>I see nothing in irb console. Can anyone please explain why that's the case?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 2, "creation_date": 1530032506, "post_id": 51047910, "comment_id": 89087261, "body": "You have an error in your print method. It should be puts &quot;* #{x.text}&quot;"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1530032595, "post_id": 51047910, "comment_id": 89087312, "body": "it&#39;s really helpful when you write code, to run it and see the output ... in this case you would clearly see that the puts statement does not output the text"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530032889, "post_id": 51047910, "comment_id": 89087463, "body": "Hint: Make a <code>to_s</code> method for <code>Todo</code> that converts it to a well-formatted string."}, {"owner": {"reputation": 5, "user_id": 9616697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9271b2ea80ec9d6b6cc71ef8c4345021?s=128&d=identicon&r=PG&f=1", "display_name": "velvetsnowman", "link": "https://stackoverflow.com/users/9616697/velvetsnowman"}, "reply_to_user": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1530035118, "post_id": 51047910, "comment_id": 89088586, "body": "@chemical , thank you but no this still does not fix the issue i am having"}, {"owner": {"reputation": 5, "user_id": 9616697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9271b2ea80ec9d6b6cc71ef8c4345021?s=128&d=identicon&r=PG&f=1", "display_name": "velvetsnowman", "link": "https://stackoverflow.com/users/9616697/velvetsnowman"}, "edited": false, "score": 0, "creation_date": 1530035156, "post_id": 51047910, "comment_id": 89088608, "body": "in fact, the 3 above suggestions ars still returning me the same print error messages"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1530038721, "post_id": 51047910, "comment_id": 89090192, "body": "&quot;I test it I pass all of the tests except for 2&quot;. Which tests are these and what do they say would be a big help."}], "answers": [{"tags": [], "owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "is_accepted": false, "score": 2, "last_activity_date": 1530037720, "creation_date": 1530037720, "answer_id": 51049382, "question_id": 51047910, "link": "https://stackoverflow.com/questions/51047910/ruby-having-trouble-with-simple-todo-list-program-with-classes-and-methods/51049382#51049382", "title": "Ruby - Having trouble with simple ToDo list program with classes and methods", "body": "<p>A bit of a break down for you on what is happening.</p>\n\n<pre><code>class Todo\n  def initialize(todo)\n    @todo = todo   # This sets your instance variable @todo to whatever you passing, you will probably want to add a check to make sure you only accept strings\n  end\n\n  def text\n    @todo  # The text method is returning whatever the @todo variable is, in this case since you are passing a string, it is returning a string\n  end\nend\n\nclass TodoList\n  def initialize\n    @todo_list = []  # When you are initializing your TodoList you are creating an array called @todo_list\n  end\n\n  def add(todo)\n    @todo_list &lt;&lt; Todo.new(todo) # When you call this method you are adding a new instance of your Todo class\n  end\n\n  def print\n    # Here you are iterating through your array @todo_list, which we established earlier is an array of your Todo Class variables\n    @todo_list.each do |x| # Pro tip, try to stay away from using names like 'x' or 'y' use more descriptive names\n      # Your 'x' variable here is one of your Todo classes instances\n      puts \"* #{x.text}\" # As defined in your Todo class, you will need to call the text method to retrieve the text you stored in your class\n    end\n  end\nend\n\nlist = TodoList.new  # Here we create a new instance of your TodoList class\n\nlist.add('Buy Pizza') # Here we can add items onto your todo list\nlist.add('Buy Pie')\nlist.add('Buy Potato')\nlist.print  # This is how you will print all the items you added to your TodoList\n</code></pre>\n\n<p>This will return</p>\n\n<pre><code>* Buy Pizza\n* Buy Pie\n* Buy Potato\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9616697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9271b2ea80ec9d6b6cc71ef8c4345021?s=128&d=identicon&r=PG&f=1", "display_name": "velvetsnowman", "link": "https://stackoverflow.com/users/9616697/velvetsnowman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530037720, "creation_date": 1530031686, "last_edit_date": 1530032532, "question_id": 51047910, "link": "https://stackoverflow.com/questions/51047910/ruby-having-trouble-with-simple-todo-list-program-with-classes-and-methods", "title": "Ruby - Having trouble with simple ToDo list program with classes and methods", "body": "<p>I want to make a small and simple todo list program. I've been blank for a couple hours on this. Here's the instruuctions:</p>\n\n<pre><code>&gt; # Write a program that keeps a list of todos. It should:\n&gt; # * Have two classes:\n&gt; #   * `Todo`\n&gt; #     * Has two methods:\n&gt; #       * `initialize`: Creates a new todo object. Takes a string as a\n&gt; #         parameter and stores it on the todo object.\n&gt; \n&gt; #       * `text`: Takes no parameters. Returns the string that was\n&gt; #         stored when the todo object was created.\n&gt; \n&gt;  \n&gt; #   * `TodoList`\n&gt; #     * Has three methods:\n&gt; #       * `initialize`: Creates a new todo list object. Takes no parameters.\n&gt; \n&gt; #       * `add`: Takes a todo object as a parameter.  Stores it on the\n&gt; #         todo list object.\n&gt; \n&gt; #       * `print`: Takes no parameters.  Creates a string of all the\n&gt; #         stored todos, one per line.  Each line should start with a\n&gt; #         `* `.  `puts`es the string.\n&gt; \n&gt; #         * e.g.\n&gt; #           ```\n&gt; #           * get milk\n&gt; #           * get the papers\n&gt; #           ```\n</code></pre>\n\n<p>Here is my attempt at the code for the program:</p>\n\n<pre><code>class Todo\n  def initialize(todo)\n    @todo = todo\n  end\n\n  def text\n    @todo\n  end\nend\nclass TodoList\n  def initialize\n    @todo_list = []\n  end\n\n  def add(todo)\n    @todo_list &lt;&lt; Todo.new(todo)\n  end\n\n  def print\n    @todo_list.each do |x|\n      puts \"* #{x}\"\n    end\n  end\nend\n</code></pre>\n\n<p>I know I'm missing something here but I cant seem to see what.. When I test it I pass all of the tests except for 2, both of the failed tests concern the print method which is described in the TodoList class.</p>\n"}, {"tags": ["ruby", "windows", "terminal", "command-prompt", "raspbian"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530031769, "post_id": 51047880, "comment_id": 89086844, "body": "Code Please See <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. Also what do you mean &quot;launch&quot;? You are calling <code>ruby &#47;some&#47;path&#47;to&#47;script.rb</code> correct?"}, {"owner": {"reputation": 380, "user_id": 8016768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39bfe45a303d7156e630c1bbaa3eb9b?s=128&d=identicon&r=PG&f=1", "display_name": "chemical", "link": "https://stackoverflow.com/users/8016768/chemical"}, "edited": false, "score": 0, "creation_date": 1530033301, "post_id": 51047880, "comment_id": 89087673, "body": "You need to provide more details, such as the code, for us to help answer the question."}, {"owner": {"reputation": 1, "user_id": 9934550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHSno.jpg?s=128&g=1", "display_name": "Blind Legs Parker", "link": "https://stackoverflow.com/users/9934550/blind-legs-parker"}, "edited": false, "score": 0, "creation_date": 1530035559, "post_id": 51047880, "comment_id": 89088814, "body": "&quot;Launch&quot; might not be the correct word. How about &quot;execute&quot; ?   Yes, I am pretty sure the path is correct. The program executes correctly, anyway. It&#39;s just that it skips all the &quot;File.open&quot; methods it sees on it&#39;s path."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1530035938, "post_id": 51047880, "comment_id": 89089022, "body": "@BlindLegsParker:  engineersmnky was not asking if your path is correct. He was asking if you invoke that ruby script with a full path like that. If that&#39;s the case, the files are created in the working dir (the directory you are currently at in the terminal), not in the <code>&#47;some&#47;path&#47;to&#47;</code>"}, {"owner": {"reputation": 1, "user_id": 9934550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHSno.jpg?s=128&g=1", "display_name": "Blind Legs Parker", "link": "https://stackoverflow.com/users/9934550/blind-legs-parker"}, "edited": false, "score": 0, "creation_date": 1530039331, "post_id": 51047880, "comment_id": 89090441, "body": "You, sirs, are geniuses. Problem solved. Sometimes after hearing the solution to a problem that has plagued me for so long I feel stupid to not have thought about it alone. This time I still feel stupid because the solution was right under my nose, but I&#39;m certain I couldn&#39;t have found it alone: I really wasn&#39;t looking in that direction. Thanks to all three of you."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530088887, "post_id": 51047880, "comment_id": 89106706, "body": "@BlindLegsParker &quot;You, sirs, are geniuses.&quot; - nah. We simply had seen too many rookie mistakes :)"}], "owner": {"reputation": 1, "user_id": 9934550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHSno.jpg?s=128&g=1", "display_name": "Blind Legs Parker", "link": "https://stackoverflow.com/users/9934550/blind-legs-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530035696, "creation_date": 1530031619, "last_edit_date": 1530035696, "question_id": 51047880, "link": "https://stackoverflow.com/questions/51047880/ruby-file-open-doesnt-work-if-launched-through-windows-command-prompt-or-lin", "title": "Ruby &quot;File.open&quot; doesn&#39;t work if launched through Window&#39;s command prompt or Linux&#39;s Terminal (no error)", "body": "<p>I have this Ruby program that I created under Windows 7. At several points through it I need to create a couple of files, so I use the following bit of code:</p>\n\n<pre><code>File.open('my_file.txt', \"w\") {|file| file.puts 'the stuff I want to put inside' }\n</code></pre>\n\n<p>It works pretty well if I launch the program by double clicking on it, but it doesn't work if I launch it through the command prompt.\nI get no error, though. The program runs normally. It just seems to skip the <code>File.open</code> method, and thus it doesn't create any file, and then it keeps going through the rest of the program. I made sure of it by creating a loop of file creation together with the line:</p>\n\n<pre><code>puts \"whatever\"\n</code></pre>\n\n<p>The loop is running correctly: I get \"whatever\" printed on screen thousands of times per second as expected, but still no file is created.                               </p>\n\n<p>Now I need to tell you I've had this problem for weeks and never found a solution to it but it didn't bother me too much either since everything was working normally when I simply launched the program by double clicking on it instead of launching it through the command prompt. </p>\n\n<p>However I now need to use it on Raspbian (on a Raspberry Pi Zero W), and I have the same issue when launching it through the terminal, but I know no other way to launch a Ruby program on Linux.</p>\n\n<p>Here is the full code as required:</p>\n\n<pre><code>require 'io/console'\n\nloop do\n    hidden_data = '{\"hidden_data\":\"true\"}'\n    File.open('hidden_data.json', \"w\") {|file| file.puts hidden_data }\n\n    puts \"Insert your password:\"\n\n    password = STDIN.noecho(&amp;:gets).chomp\n\n    if password == \"1234\"\n        hidden_data = '{\"hidden_data\":\"false\"}'\n        File.open('hidden_data.json', \"w\") {|file| file.puts hidden_data }\n        puts \"Access granted\"\n        sleep 60\n    else\n        puts \"Wrong password\"\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3", "dry", "solid-principles"], "answers": [{"tags": [], "owner": {"reputation": 32682, "user_id": 120518, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/edf1077f9152b361937f12707e3af891?s=128&d=identicon&r=PG", "display_name": "Shadwell", "link": "https://stackoverflow.com/users/120518/shadwell"}, "is_accepted": false, "score": 3, "last_activity_date": 1530036624, "creation_date": 1530036624, "answer_id": 51049126, "question_id": 51047857, "link": "https://stackoverflow.com/questions/51047857/is-there-a-way-to-apply-dry-and-solid-principal/51049126#51049126", "title": "is there a way to apply dry and solid principal", "body": "<p>Maybe something like:</p>\n\n<pre><code>def suggest_price(price_reference, shipping_cost)\n  [\n     [15, 0.75],\n     [25, 0.775],\n     [50, 0.8],\n     ... etc ...\n  ].each do |price_point, shipping_modifier|\n    if price_reference &lt; price_point\n      return price_reference - shipping_cost * shipping_modifier\n    end\n  end\n  return price_reference - shipping_cost * 0.95\nend\n\ndef price_modifier(brand)\n  if brand.rating == high\n    1.1 \n  elsif brand.rating == low\n    0.9\n  else\n    1\n  end\nend\n\nprice_original = price_modifier(brand) * suggest_price(price_reference, product_database.shipping_cost)\n</code></pre>\n\n<p>I'm not suggesting that's perfect code but it's a way you could approach it. You'd probably want the price points and modifiers in a constant.</p>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530037127, "post_id": 51049205, "comment_id": 89089528, "body": "<code>price_reference</code> can be any value between <code>0...25</code>, <code>25...50</code> etc. not exactly that value"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530113101, "post_id": 51049205, "comment_id": 89122803, "body": "Well now you have simply created a <code>SyntaxError</code> when you said <i>&quot;Will correct with [R]anges&quot;</i> I thought okay great but then you didn&#39;t and everything broke :O"}], "tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": false, "score": 1, "last_activity_date": 1530238105, "last_edit_date": 1530238105, "creation_date": 1530037029, "answer_id": 51049205, "question_id": 51047857, "link": "https://stackoverflow.com/questions/51047857/is-there-a-way-to-apply-dry-and-solid-principal/51049205#51049205", "title": "is there a way to apply dry and solid principal", "body": "<p>You could apply some OOP. In the <code>Brand</code> class you could use some <code>.case</code> statements to make it more readable...</p>\n\n<pre><code>def prices\n  case self.rating\n    when 'high\"\n      case  \n        when price_reference &lt; 15\n          (price_reference - product_database.shipping_cost * 0.75) * 1.1\n        when price_reference &lt; 25\n          (price_reference - product_database.shipping_cost * 0.775) * 1.1\n        when price_reference &lt; 50\n          (price_reference - product_database.shipping_cost * 0.8) * 1.1 \n          etc...\n\n    when 'low'\n      case \n          etc...\n    else\n          etc...\n  end\nend\n</code></pre>\n\n<p>A nested <code>case</code> statement is a bit easier to read. Also you are doing a lot of unneeded variable reassignment. Remember that Ruby always returns the last statement it evaluates. So when you call the method on a member of the Brand class you can use it like this:</p>\n\n<pre><code>brand = Brand.new(rating: 'high', price_reference: '25')\n#let's assume product_database.shipping_cost = 5\nbrand.prices\n #returns the value 23.2375 which came from (25 - 5 * 0.775) * 1.1\n</code></pre>\n\n<p>There are many ways to do this. You could abstract out a lot more of your code by creating some hash dictionaries to contain the values of each formula and then do variable substitution to call them. Try to thing in terms of objects and methods. Everything in Ruby is an object of some sort and you can create methods to call on those objects that call other methods and use other objects. </p>\n"}], "owner": {"reputation": 35, "user_id": 4016287, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wnbZ6TnYJzo/AAAAAAAAAAI/AAAAAAAAADk/XChU6nA9aUo/photo.jpg?sz=128", "display_name": "Mina Magdy", "link": "https://stackoverflow.com/users/4016287/mina-magdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530238105, "creation_date": 1530031525, "last_edit_date": 1530032941, "question_id": 51047857, "link": "https://stackoverflow.com/questions/51047857/is-there-a-way-to-apply-dry-and-solid-principal", "title": "is there a way to apply dry and solid principal", "body": "<p>I am working on this code to make it shorter so that it could be easier to study or read and I have but advanced to apply the dry and solid principle so could you help me with how to refactor this ruby on rails code which contains some if statements  to do this.so that it becomes more easy to read and shorter using those principles.</p>\n\n<pre><code>if brand.rating = high\n  if price_reference &lt; 15\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.75) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 25\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.775) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 50\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.8) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 75\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.825) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 100\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.85) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 200\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.875) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 400\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.9) * 1.1\n    price_original = price_suggestion\n  elsif price_reference &lt; 600\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.925) * 1.1\n    price_original = price_suggestion\n  else\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.95) * 1.1\n    price_original = price_suggestion\nelsif brand.rating = low\n  if price_reference &lt; 15\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.75) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 25\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.775) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 50\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.8) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 75\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.825) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 100\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.85) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 200\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.875) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 400\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.9) * 0.9\n    price_original = price_suggestion\n  elsif price_reference &lt; 600\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.925) * 0.9\n    price_original = price_suggestion\n  else\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.95) * 0.9\n    price_original = price_suggestion\nelse\n  if price_reference &lt; 15\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.75) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 25\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.775) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 50\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.8) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 75\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.825) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 100\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.85) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 200\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.875) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 400\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.9) * 1\n    price_original = price_suggestion\n  elsif price_reference &lt; 600\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.925) * 1\n    price_original = price_suggestion\n  else\n    price_suggestion = (price_reference - product_database.shipping_cost * 0.95) * 1\n    price_original = price_suggestion\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1530030364, "creation_date": 1530030364, "answer_id": 51047551, "question_id": 51047466, "link": "https://stackoverflow.com/questions/51047466/ruby-to-reverse-words-of-a-single-string-separated-by-an-underscore/51047551#51047551", "title": "Ruby to Reverse words of a single string separated by an underscore", "body": "<p>Here you go:</p>\n\n<pre><code>[2] pry(main)&gt; 'DASH_XMR'.split('_').reverse.join('_')\n\"XMR_DASH\"\n</code></pre>\n\n<p>Methods used: <a href=\"https://ruby-doc.org/core-2.2.0/String.html#method-i-split\" rel=\"nofollow noreferrer\">String#split</a>, <a href=\"http://ruby-doc.org/core-2.1.5/Array.html#method-i-reverse\" rel=\"nofollow noreferrer\">Array#reverse</a>, <a href=\"http://ruby-doc.org/core-2.1.5/Array.html#method-i-join\" rel=\"nofollow noreferrer\">Array#join</a></p>\n"}, {"tags": [], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "is_accepted": true, "score": 1, "last_activity_date": 1530030415, "creation_date": 1530030415, "answer_id": 51047572, "question_id": 51047466, "link": "https://stackoverflow.com/questions/51047466/ruby-to-reverse-words-of-a-single-string-separated-by-an-underscore/51047572#51047572", "title": "Ruby to Reverse words of a single string separated by an underscore", "body": "<pre><code>\"XMR_DASH\".split(\"_\").reverse.join(\"_\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9995657, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SupplyDemand", "link": "https://stackoverflow.com/users/9995657/supplydemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 51047572, "answer_count": 2, "score": 1, "last_activity_date": 1530030415, "creation_date": 1530030051, "question_id": 51047466, "link": "https://stackoverflow.com/questions/51047466/ruby-to-reverse-words-of-a-single-string-separated-by-an-underscore", "title": "Ruby to Reverse words of a single string separated by an underscore", "body": "<p>I have a string \"XMR_DASH\". Using Ruby I want it to read \"DASH_XMR\". So essentially I need to flip the string horizontally between the underscore without reversing the letters. Can't figure out how to do this. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rspec"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530030462, "post_id": 51047204, "comment_id": 89086218, "body": "Wow, what a journey :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530030480, "post_id": 51047204, "comment_id": 89086232, "body": "<code>:foreign_key =&gt; &#39;deal_id&#39;</code> - redundant. It&#39;s <code>deal_id</code> by default."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530030650, "post_id": 51047204, "comment_id": 89086321, "body": "\ud83d\ude31Woah woah woah, ok... Breathe... This whole issue seems to stem from the handling of <code>steps.st_appearance_order_nb</code> (which is a really bad column name, to be honest... why not call it something like <code>steps.position</code>?). It looks like you&#39;ve gotten tangled up in a huge mess to workaround that design flaw."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530030726, "post_id": 51047204, "comment_id": 89086359, "body": "Forget everything else for a moment, can we just focus on this? Where does <code>st_appearance_order_nb</code> get set? Where does it get validated? How do you maintain data integrity, e.g. if a <code>step</code> gets destroyed?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530030867, "post_id": 51047204, "comment_id": 89086440, "body": "Internets say that that custom method <code>length</code> on the association is actually never used: <a href=\"https://stackoverflow.com/questions/4836897/validate-the-number-of-has-many-items-in-ruby-on-rails#comment81093646_28476834\" title=\"validate the number of has many items in ruby on rails%23comment81093646_28476834\">stackoverflow.com/questions/4836897/&hellip;</a>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1530030987, "post_id": 51047204, "comment_id": 89086493, "body": "Moreover, In fact, can we just see the full Deal &lt;--&gt; Step association? I think your whole problem is all around this coupling, and maintaining data integrity."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1530031558, "post_id": 51047204, "comment_id": 89086747, "body": "@SergioTulentsev yes it&#39;s a journey but my differents changes in the way i test/create asscoiated Steps had to be reminded to explain the current issue:)"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530031609, "post_id": 51047204, "comment_id": 89086772, "body": "@TomLord yes steps.st_appearance_order_nb is a bit &quot;heavy&quot; and position would be abetter name but this did not cause the issue :)"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530031649, "post_id": 51047204, "comment_id": 89086786, "body": "@TomLord I am going to add how st_appearance_order_nbgets set, validated and keep integrity inc ase sb removes/add new Steps inside our active admin backoffcie"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530032192, "post_id": 51047204, "comment_id": 89087095, "body": "@TomLord just added details on st_appearance_order_nb: most is maintained by error messages and blocks inside Active Admin if they&#39;re not correct / don&#39;t comply with our validations"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530032341, "post_id": 51047204, "comment_id": 89087168, "body": "Maybe not a big deal, but <code>check_steps_start_on_zero</code> and <code>check_steps_have_no_gap_for_st_appearance_order_nb</code> are not <code>before_validation</code> material. They&#39;re actual validations. And the persisting/saving <code>update_attributes</code> in <code>assign_new_st_appearance_order_nb_values_for_steps_in_case_o&zwnj;&#8203;f_steps_removals</code>? <code>before_validation</code> shouldn&#39;t do that."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530032393, "post_id": 51047204, "comment_id": 89087191, "body": "@SergioTulentsev &quot;internets say that that custom method length on the association is actually never used&quot; =&gt; really strange because it really save me: this was really buggy and not related to the issue of this post but my validation was &quot;a deal can&#39;t have more tha 10 steps&quot;, and when creating Steps directly inside Active Admin Deal Form (see code added in my edit), it was not working at all as new blocks added or those deleted were not being  take into account (rspectively added or substracted) to compare with the limit of 10 steps. this tehcnique really fixed this and now it works."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530032491, "post_id": 51047204, "comment_id": 89087254, "body": "@SergioTulentsev &quot;Maybe not a big deal, but check_steps_start_on_zero and check_steps_have_no_gap_for_st_appearance_order_nb are not before_validation material. They&#39;re actual validations.&quot;=&gt; true but I am not sure I remember why i did this: basically it must have been about some question of having an order of execution multiple for before_validations  that you can&#39;t ensure for pure &quot;validates&quot;; not sure about this to be honest"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530032687, "post_id": 51047204, "comment_id": 89087363, "body": "I assume you copy/pasted from your code directly? If that&#39;s the case, doesn&#39;t your code crash in some way? Because you have <code>remaining__steps</code> and <code>remaining_steps</code> next to each other."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530032785, "post_id": 51047204, "comment_id": 89087411, "body": "@SergioTulentsev no I ad modified it a little to reduce the length of the name attributes haha so it&#39;s a typo __ was in fact _. just edited it. You&#39;ve got the eye of a hawk hehe. As i said there is no crash at all in dev/prod and i even tested false positive and made sure with &quot;put&quot;s that all the before_validations content get executed in dev/prod and they are. the only place where they don&#39;t get executed is in test environment."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530032947, "post_id": 51047204, "comment_id": 89087492, "body": "@TomLord &quot;Moreover, In fact, can we just see the full Deal &lt;--&gt; Step association?  problem is all around this coupling, and maintaining data integrity. &quot; =&gt; agree!  the experiments with the &quot;puts&quot; msgs definitely show this. But in dev/produ all is being executed perfectly. So it boils down to how i associate them in tests. I&#39;d rather use Factory Girl transient &quot;usual&quot; way as explained  but  I could not due to rspec-retry (I clean the database between tests but it seems that the database does not get cleaned between rspec retries hence the issue with keeping factory girls AND rspec-retry)"}], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1530177724, "creation_date": 1530029156, "last_edit_date": 1530177724, "question_id": 51047204, "link": "https://stackoverflow.com/questions/51047204/srails-4-2-rspec-rspec-retry-association-belong-has-many-failing", "title": "sRails 4.2 / Rspec / rspec-retry - association belong/has_many failing", "body": "<p>I am facing a monster of issue on rspec, where each time I try to solve a bug it creates another.</p>\n\n<p>I have a model Deal which has_many Steps</p>\n\n<p><strong>model/step.rb</strong></p>\n\n<pre><code>  belongs_to :deal,             :foreign_key =&gt; 'deal_id'\n</code></pre>\n\n<p><strong>model/deal.rb</strong></p>\n\n<pre><code>has_many   :steps,          dependent:  :destroy do\n    # added to enable maximum nb of steps a deal can have\n    # to take into account in active admin\n    # in order to calculate the correct new nb of step to compare to the authorized limit\n    # source: homeonrails.com/2012/10/validating-nested-associations-in-rails/\n    def length\n      reject(&amp;:marked_for_destruction?).length\n    end\n  end \n</code></pre>\n\n<p><strong>The gist of all my bugs is how to make one of my Feature rspec test  work, where I associate Deals and Steps</strong>. I used to use Factory Girl \"usual\" transient which would be much cleaner but I had to move from it (see further below), because we have special requirements:</p>\n\n<pre><code>factory :deal_with_associated_steps do\n          to_create {|instance| instance.save(validate: false) } # skip validate\n\n          transient do\n            steps_count 27\n          end\n\n          after(:create) do |deal, evaluator|\n            create_list(:steps, evaluator.steps_count, deal: deal)\n\n          end\n        end\n</code></pre>\n\n<p>The reason I moved away from using this \"transient\" technique to create multiple Steps related to a Deal is very specific to our app.</p>\n\n<p>When you take for a given Deal all the associated Steps 's st_appearance_order_nb ( integer) it must always be:\n- start from 0 \n- then have no gap so 1, 2,3...</p>\n\n<p>Some before_validations on the Deal model Deals allow me to ensure this is always this case. You can't have a Deal with associated Steps where one of the Steps has a appearance_nb of 1 and another Step has a  appearance_nb of 3 but there is no Step with appearance_nb 2. And you can't not have a step with a appearance_nb of 0. It simply must be a series 0,1,2,3...and so on</p>\n\n<p>This would actually still work with the \"classic transient\" way to create Steps in Factory Girl. BUT the issue with the classic \"transient\" way above to create Steps is that I have a <a href=\"https://github.com/NoRedInk/rspec-retry\" rel=\"nofollow noreferrer\">gem called \"rspec-retry\"</a> that help me re-do the feature tests as, as many other rspec users with complex UI/javascript pages, sometimes my front end test fail the first time for some js/loading reason then if you repeat them enough, the 2nd or 3rd time it will work. So most of my feature tests are run 4 times, and some only pass the 2nd or 3rd time:) The gem rspec-retry is neat but had a very significant issue with the \"transient\" way I was creating Steps associated with in Factory Girl: </p>\n\n<p>I was getting errors because if a test fail one the first \"retry\", the second time, it's like the test app thinks the  st_appearance_order_nb nb 0 to 4 are already taken (indeed they were created by the first rspec \"try\"), so it creates now 4 new Steps with respectively st_appearance_order_nb of 5, 6, 7 and 8.</p>\n\n<p>then ... leading to errors, because I have a before_validation to ensure that st_appearance_order_nb of a Deal's associated Steps are always starting at 0 then increment one by one</p>\n\n<p><strong>So using rspec-retry, I can't use Factory Girl transient way of creating associated Steps</strong>,at least that was my conclusion at the time where I found another way: I  decided to \"manually\" create the associated Steps this way</p>\n\n<pre><code>let!(:deal_with_videos)   { create(:deal, \n                                    title:  \"title deal 1\" ) }\n\nvideo_urls  = [ \"\", # no video allowed on first step\n                  \"https://www.facebook.com/418234631906607/videos/495053617558041\", # square video (5 sec)\n                  \"https://www.facebook.com/pili.morillo.56/videos/352355988613922\", # landscape video with internal black sidebars\n                  \"https://www.facebook.com/rihanna/videos/10155330511896676/\", # landscape video no internal black sidebars\n                  \"https://www.facebook.com/videos/1592424637461205/\", # portrait video\n                  \"\" \n                ]\n\n(0..5).each do |n|\n    let!(:\"deal_with_videos_step#{n}\") {\n      FactoryGirl.create(:step,\n        st_appearance_order_nb: n,        \n        st_video_url: video_urls[n],\n        deal: deal_with_videos)\n    }\n  end\n</code></pre>\n\n<p>this fixed the errors and 99% of my tests worked but now the issue of the present post: one of my test is failing : because very weirdly the way I associate Deal and Steps is not <strong>completely</strong> working, but only partly... Let me add everything is working fine in Production and development mode.</p>\n\n<pre><code>describe \"on Deal Page load, the view behaves appropriately in terms of  video\" do        \n            let(:action)                    { visit actual_deal_page_path(deal_with_videos) }\n            let(:fb_player_visibility)      { \"hidden\" }\n            let(:video_href_set_by_app_js)  { nil.to_s }            \n            it_behaves_like \"a view where the FB video player behaves appropriately\"To be clear I found a very hack way to do stuff, but it created another issue in a ripple effect a new bug as the way I was doing it was making the test suite think there was no new\n</code></pre>\n\n<p>The test is failing for a reason I know now: It fails <strong>because the content of the following  before_validation never gets executed</strong></p>\n\n<pre><code>models/deal.rb\n    before_validation :extract_st_embed_hostings_from_st_video_urls\n    def extract_st_embed_hostings_from_st_video_urls\n            puts \"beacon1\"\n            self.steps.reject(&amp;:marked_for_destruction?).each do |step| \n                puts \"beacon2\" \n    # do stuff                      \n            end\n        end\n</code></pre>\n\n<p>I know because this is the issue in a test environment with those puts message, when I run rspec test on the test block, I only see \"beacon1\" , and not beacon2 (in dev and prod both messages are seen)</p>\n\n<p>I wondered why it was not being executed.</p>\n\n<p>So I added inside the test some <code>puts</code> to see why the line <code>self.steps.reject(&amp;:marked_for_destruction?).each do |step|</code>  was not outputting anything. Could my association of Deal and Steps not work in the tests?</p>\n\n<pre><code>  describe \"on Deal Page load, the iew behaves appropriately in terms of  video\" do\n        before do\n          action\n          puts deal_with_videos.steps.to_json\n          puts deal_with_videos.steps[1].to_json\n          puts deal_with_videos.id \n          puts deal_with_videos_step0.deal_id \n          puts deal_with_videos_step0.deal.title\n          puts deal_with_videos_step0.to_json\n        end\n\n        let(:action)                    { visit actual_deal_page_path(deal_with_videos) }\n        let(:fb_player_visibility)      { \"hidden\" }\n\n        it_behaves_like \"a view where the FB video player behaves appropriately\"\n      end\n</code></pre>\n\n<p>And the results are weird:</p>\n\n<ul>\n<li><p>\"puts deal_with_videos.steps.to_json\" gives me [] => so it seems they're not associated</p>\n\n<ul>\n<li><p>\"puts deal_with_videos.steps<a href=\"https://github.com/NoRedInk/rspec-retry\" rel=\"nofollow noreferrer\">1</a>.to_json\" gives \"null\" so consistent with the previous <code>puts</code></p></li>\n<li><p>But the netx 2 puts bring more confusion:</p></li>\n</ul>\n\n<p>\"puts deal_with_videos.id\" gives 3</p>\n\n<p>\"puts deal_with_videos_step0.deal_id\"  also give me 3</p></li>\n</ul>\n\n<p>So going in the 2 directions, I have the same information, that's weird: it seems they are actually well associated. Weird as it contradicts for me the first 2 puts.</p>\n\n<ul>\n<li>but then the last \"puts\" give me:</li>\n</ul>\n\n<p>puts deal_with_videos_step0.deal.title give sme \"title deal1\"</p>\n\n<p>puts deal_with_videos_step0.to_json gives me a detailed json with content inside (not copied here to stay concise)\n=> they both work</p>\n\n<p><strong>My conclusions</strong></p>\n\n<p><strong>it's like the way i assciated them only works ONE way</strong> :\nif I start by going on a Step like deal_with_videos_step0, then move by using .deal to reach the Deal table, it works. </p>\n\n<p>But in the other way around, the one that was in my before_validation called extract_st_embed_hostings_from_st_video_urls (see above) that is not working properly, it's not working: <strong>if I start on the table Deal then request all the Steps related to Deal, it does not work</strong>, it gives me empty outputs. so the request below is empty, that's why the before validation extract_st_embed_hostings_from_st_video_urls does not do anything, the test suite thinks there are no Steps to do stuff on.</p>\n\n<p>So I'm blocked here: My issue is at the cross-roads of factory girl+rspec-retry+my specific Deal model's associated Steps attributes constraints </p>\n\n<p>How can I associate in my tests a Deal and multiple Steps, while using rspec-retry and manage to get this test passing, that is to say by managing to have self.steps.reject(&amp;:marked_for_destruction?).each \"work\" even inside the test environment, instead of thinking there is no \"step\" associated ?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>More information are provided here below following comments</p>\n\n<p><strong>1/ st_appearance_order_nb</strong></p>\n\n<ul>\n<li>Creation </li>\n</ul>\n\n<p>st_appearance_order_nb is just one attribute/column of a Step. Ut's added in Active Admin <strong>directly inside a Deal form</strong> via a has_many relation:</p>\n\n<pre><code>f.inputs \"Steps\" do\n      f.has_many :steps,\n                   allow_destroy: true,\n                   heading:       false, \n                   new_record:    true,\n                   # ensure each new step is automagically assigned a +1st_appearance_order_nb\n                   sortable:      :st_appearance_order_nb,\n                   sortable_start: 0 do |step|\n        step.input :st_appearance_order_nb,\n          input_html: { readonly: true, disabled: true },\n          label:      \"Appearance rank\"  \n        step.input :st_video_url,       \n\n      end\n    end \n</code></pre>\n\n<ul>\n<li>Then intgerity on addition/removal...</li>\n</ul>\n\n<p>models/deal.rb</p>\n\n<pre><code>before_validation :assign_new_st_appearance_order_nb_values_for_steps_in_case_of_steps_removals     \nbefore_validation :check_steps_start_on_zero \nbefore_validation :check_steps_have_no_gap_for_st_appearance_order_nb\n\n# in case one or more Steps are removed, avoid a \"hole\"\n# in the st_appearance_order_nb due to those removals\n# includes the other requirement to re-start the ranks at 0\n    def assign_new_st_appearance_order_nb_values_for_steps_in_case_of_steps_removals\n      if self.steps.any? &amp;&amp; self.steps.select { |st| st.marked_for_destruction? }.any? # restrict this taxing operation to cases where there are removals\n        remaining_steps = self.steps.reject(&amp;:marked_for_destruction?)        \n        remaining_steps.sort_by(&amp;:st_appearance_order_nb).each_with_index do |step, index|\n          step.update_attributes st_appearance_order_nb: index\n        end\n      end\n    end \n\n    def check_steps_start_on_zero\n      if self.steps.any?\n        if self.steps.map{|u| u.st_appearance_order_nb}.min != 0\n          errors[:base] &lt;&lt; \"Error on Steps. There must be at least one Step with Appearance rank equal to 0 .\"\n        end\n      end\n    end\n\n    def check_steps_have_no_gap_for_st_appearance_order_nb\n      if self.steps.any?\n        if !array_one_steps_increment?( self.steps.map{|u| u.st_appearance_order_nb} )\n          errors[:base] &lt;&lt; \"Error on Steps: you can't have gaps inside the list of Appearance ranks. Only increments by one. Change the Appearance ranks accordindly.\"\n        end\n      end\n    end \n    def array_one_steps_increment?(array)\n      sorted = array.sort\n      lastNum = sorted[0]\n      sorted[1, sorted.count].each do |n|\n        if lastNum + 1 != n\n          return false\n        end\n        lastNum = n\n      end\n      true\n    end\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>After days of searching with no success, kind of giving up but in a way that makes sense: indeed maybe so much difficulty comes form the fact I am testing this in Feature specs where actually I should not let the app callbacks \"set itself\" (via a set method) those attributes that are a problem (st_embed_hosting for example) so I opted to just mock them myself in Feature tests and do real testing to see if the callbacks work in  Model specs. Hope it will be more consistent and working.</p>\n"}, {"tags": ["ruby", "exponential"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1530033718, "post_id": 51047113, "comment_id": 89087885, "body": "&quot;I need to convert this to exp notation and get the same result like x=0.2592585e7&quot; - huh? It&#39;s already a valid number string in scientific notation. Just do <code>str.to_f</code> to get the number."}, {"owner": {"reputation": 1, "user_id": 9788458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oleh", "link": "https://stackoverflow.com/users/9788458/oleh"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530087269, "post_id": 51047113, "comment_id": 89105785, "body": "In your case I get - irb(main):002:0&gt; result =  str.to_f =&gt; 2592585.0 But I need 0.2592585e7"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530087910, "post_id": 51047113, "comment_id": 89106174, "body": "It&#39;s the same number. For all practical purposes, there is no difference. Mind explaining <i>why</i> you think you need that?"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530033840, "post_id": 51048343, "comment_id": 89087944, "body": "They&#39;re not trying to get an integer, though. Also not sure what that ` / 10000000` is supposed to be doing."}], "tags": [], "owner": {"reputation": 47, "user_id": 9989319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8905ba1f78ea867f4ab6a9e7896fef49?s=128&d=identicon&r=PG&f=1", "display_name": "Pavelb", "link": "https://stackoverflow.com/users/9989319/pavelb"}, "is_accepted": false, "score": 0, "last_activity_date": 1530033477, "creation_date": 1530033477, "answer_id": 51048343, "question_id": 51047113, "link": "https://stackoverflow.com/questions/51047113/string-to-exponential-notation/51048343#51048343", "title": "String to exponential notation", "body": "<p>If I understood you correctly, you can convert a string to float like this:</p>\n\n<pre><code>str = \"0.2592585e7\"\n\nputs result = str.to_f / 10000000\n</code></pre>\n\n<p>or</p>\n\n<pre><code>str = \"0.2592585e7\"\nresult =  str.to_f\n\nputs result.to_i\n</code></pre>\n\n<p>To get an integer</p>\n"}], "owner": {"reputation": 1, "user_id": 9788458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Oleh", "link": "https://stackoverflow.com/users/9788458/oleh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1530087745, "creation_date": 1530028799, "question_id": 51047113, "link": "https://stackoverflow.com/questions/51047113/string-to-exponential-notation", "title": "String to exponential notation", "body": "<p>I use Ruby. \nI have <code>str=\"0.2592585e7\"</code>\nI need to convert this to exp notation and get the same result like <code>x=0.2592585e7</code> \nWhen I do this via format I get: \n<code>irb(main):064:0&gt; format(\"%0.6e\", str.to_f)\n=&gt; \"2.592585e+06\"</code>\nAny idea how to not get decimal before point ? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 2, "creation_date": 1530028928, "post_id": 51047061, "comment_id": 89085339, "body": "<code>people.each { |person| puts person[:salary] }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1190, "user_id": 7387029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c97ae40b1e69f860fa2d85f6ee0f4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "anish anil", "link": "https://stackoverflow.com/users/7387029/anish-anil"}, "edited": false, "score": 0, "creation_date": 1530038848, "post_id": 51047178, "comment_id": 89090242, "body": "Is it possible to get the values in the same line,  My query is now run as   people.each {|x| puts x[:job_title], x[:first_name], x[:salary]}  Currently the output is as follows:  192:rubyfiles root# ruby test.rb car enthusiast Gary 14000 developer Claire 15000 developer Clem 12000"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 1190, "user_id": 7387029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c97ae40b1e69f860fa2d85f6ee0f4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "anish anil", "link": "https://stackoverflow.com/users/7387029/anish-anil"}, "edited": false, "score": 0, "creation_date": 1530039210, "post_id": 51047178, "comment_id": 89090392, "body": "Okay so it shows each value on a separate line and you just want it all on one line? You could do <code>p [x[:job_title], x[:first_name], x[:salary]]</code> or just use any of ruby&#39;s string formatting options or its string interpolation"}, {"owner": {"reputation": 1190, "user_id": 7387029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c97ae40b1e69f860fa2d85f6ee0f4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "anish anil", "link": "https://stackoverflow.com/users/7387029/anish-anil"}, "edited": false, "score": 0, "creation_date": 1530039435, "post_id": 51047178, "comment_id": 89090484, "body": "still the same results.   car enthusiast Gary 14000 developer Claire 15000 developer Clem 12000  people.each {|x| puts [x[:job_title], x[:first_name], x[:salary]]}"}, {"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "reply_to_user": {"reputation": 1190, "user_id": 7387029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c97ae40b1e69f860fa2d85f6ee0f4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "anish anil", "link": "https://stackoverflow.com/users/7387029/anish-anil"}, "edited": false, "score": 0, "creation_date": 1530039788, "post_id": 51047178, "comment_id": 89090636, "body": "<a href=\"https://ruby-doc.org/core-2.5.1/Kernel.html#method-i-p\" rel=\"nofollow noreferrer\"><code>p</code></a> not <code>puts</code>...there&#39;s a difference"}, {"owner": {"reputation": 1040, "user_id": 566484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ec7fca09add355664c5b5dfe748ec3?s=128&d=identicon&r=PG", "display_name": "Christian Butzke", "link": "https://stackoverflow.com/users/566484/christian-butzke"}, "edited": false, "score": 0, "creation_date": 1589782837, "post_id": 51047178, "comment_id": 109418916, "body": "I wonder how to use named keyword arguments in ruby &gt; 2.7, when you iterate over an array of hashes"}], "tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 4, "last_activity_date": 1530029055, "creation_date": 1530029055, "answer_id": 51047178, "question_id": 51047061, "link": "https://stackoverflow.com/questions/51047061/how-to-iterate-through-an-array-of-hashes-in-ruby/51047178#51047178", "title": "How to iterate through an array of hashes in ruby", "body": "<p>In newer versions of Ruby (not sure when it was introduced, probably around ruby 2.0-ish which is when I believe keyword arguments were introduced), you can do:</p>\n\n<pre><code>people.each do |salary:,**|\n  puts salary\nend\n</code></pre>\n\n<p>where <code>**</code> takes all the keyword arguments that you don't name and swallows them (ie, the <code>first_name</code> and <code>job_title</code> keys in the hash). If that isn't something that your ruby version allows, you'll need to just store the entire hash in the variable:</p>\n\n<pre><code>people.each do |person|\n  puts person[:salary]\nend\n</code></pre>\n"}], "owner": {"reputation": 1190, "user_id": 7387029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c97ae40b1e69f860fa2d85f6ee0f4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "anish anil", "link": "https://stackoverflow.com/users/7387029/anish-anil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3236, "favorite_count": 1, "accepted_answer_id": 51047178, "answer_count": 1, "score": 0, "last_activity_date": 1530032913, "creation_date": 1530028626, "last_edit_date": 1530032913, "question_id": 51047061, "link": "https://stackoverflow.com/questions/51047061/how-to-iterate-through-an-array-of-hashes-in-ruby", "title": "How to iterate through an array of hashes in ruby", "body": "<p>Trying to iterate over an array using ruby and it is miserably failing, </p>\n\n<pre><code>My Array\npeople = [{first_name: \"Gary\", job_title: \"car enthusiast\", salary: \"14000\" },\n{first_name: \"Claire\", job_title: \"developer\", salary: \"15000\"},\n{first_name: \"Clem\", job_title: \"developer\", salary: \"12000\"}]\n</code></pre>\n\n<p>How to iterate over the above hash to output only the salary value???</p>\n\n<p>I tried using:</p>\n\n<pre><code>people.each do |i,j,k|\n  puts \"#{i}\"\nend\n</code></pre>\n\n<p>The results are as below and is not what i was intending,</p>\n\n<pre><code>{:first_name=&gt;\"Gary\", :job_title=&gt;\"car enthusiast\", :salary=&gt;\"14000\"}\n{:first_name=&gt;\"Claire\", :job_title=&gt;\"developer\", :salary=&gt;\"15000\"}\n{:first_name=&gt;\"Clem\", :job_title=&gt;\"developer\", :salary=&gt;\"12000\"}\n</code></pre>\n\n<p>Is there a way to iterate through this array and simply list out only the salary values and not the rest?</p>\n"}, {"tags": ["ruby", "terminal", "cursor-position"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530028085, "post_id": 51046858, "comment_id": 89084828, "body": "Is using <a href=\"https://github.com/ruby/curses\" rel=\"nofollow noreferrer\">Ncurses</a> an option?"}, {"owner": {"reputation": 146, "user_id": 9305631, "user_type": "registered", "profile_image": "https://graph.facebook.com/1384043867/picture?type=large", "display_name": "il mietitore", "link": "https://stackoverflow.com/users/9305631/il-mietitore"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1530028276, "post_id": 51046858, "comment_id": 89084956, "body": "I don&#39;t know anything about it so I guess it does"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530028320, "post_id": 51046858, "comment_id": 89084980, "body": "See <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code#CSI_sequences\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/ANSI_escape_code#CSI_sequences</a>"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 10815638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7b176aeea1acaa7550193117ae8bc8?s=128&d=identicon&r=PG&f=1", "display_name": "user10815638", "link": "https://stackoverflow.com/users/10815638/user10815638"}, "is_accepted": false, "score": 0, "last_activity_date": 1604308930, "last_edit_date": 1604308930, "creation_date": 1604306838, "answer_id": 64642338, "question_id": 51046858, "link": "https://stackoverflow.com/questions/51046858/move-terminals-cursor/64642338#64642338", "title": "Move terminal&#39;s cursor", "body": "<p>See <a href=\"https://tldp.org/HOWTO/Bash-Prompt-HOWTO/x361.html\" rel=\"nofollow noreferrer\">here</a>. The following example was tested in Windows <code>cmd</code> but must work in the other terminals too.</p>\n<pre><code>puts &quot;+----------+&quot;\nputs &quot;|          |&quot;\nputs &quot;+----------+&quot;\nprint &quot;\\033[2A\\033[1C&quot;\np = 0.5\n10.times do\n    print &quot;#&quot;\n    sleep(p)\nend\nprint &quot;\\033[2B&quot;\nputs\n</code></pre>\n<p>This will output a sort of a progress bar:</p>\n<pre><code>+----------+\n|###       |\n+----------+\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 9305631, "user_type": "registered", "profile_image": "https://graph.facebook.com/1384043867/picture?type=large", "display_name": "il mietitore", "link": "https://stackoverflow.com/users/9305631/il-mietitore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1604308930, "creation_date": 1530027990, "last_edit_date": 1530028095, "question_id": 51046858, "link": "https://stackoverflow.com/questions/51046858/move-terminals-cursor", "title": "Move terminal&#39;s cursor", "body": "<p>I'm trying to move the cursor of the terminal to different coordinates, something equivalent to Pascal's <code>gotoxy</code>. Is there anything like that?</p>\n"}, {"tags": ["ruby", "mechanize"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 1860894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4dce70c60dd89d5d316e02fb64f4ef?s=128&d=identicon&r=PG", "display_name": "Jonathan Hefner", "link": "https://stackoverflow.com/users/1860894/jonathan-hefner"}, "is_accepted": false, "score": 4, "last_activity_date": 1532029288, "creation_date": 1532029288, "answer_id": 51430614, "question_id": 51046179, "link": "https://stackoverflow.com/questions/51046179/connectionpoolerror-no-connections-are-checked-out/51430614#51430614", "title": "ConnectionPool::Error (no connections are checked out)", "body": "<p>The code from the linked blog post seems to be incompatible with v3.0.0 of the net-http-persistent gem.  Note that Mechanize v2.7.6 (the current version as of this writing) is compatible with net-http-persistent >= v2.5.2, which includes v3.0.0.</p>\n\n<p>The short answer is to do one of the following:</p>\n\n<ul>\n<li>Pin net-http-persistent to v2.9.4</li>\n<li><strong>(experimental)</strong> Remove the call to <code>self.http.shutdown</code> on line 44 of the linked blog post</li>\n</ul>\n\n<p>The long answer is that the net-http-persistent gem started using the connection_pool gem in v3.0.0, which changed the behavior of <code>Net::HTTP::Persistent#shutdown</code> (aka <code>self.http.shutdown</code> in <code>Mechanize::HTTP::Agent</code>).  The new behavior raises a <code>ConnectionPool::Error</code> (\"no connections are checked out\") if a request is made after <code>shutdown</code> has been invoked.</p>\n\n<p>However, looking through the code of both net-http-persistent v2.9.4 and v3.0.0, it seems like <code>self.http.shutdown</code> may not have been necessary in the first place.  The main purpose of <code>shutdown</code> seems to be invoking <code>finish</code> on each of the connections.  In both v2.9.4 and v3.0.0, when <code>Net::HTTP::Persistent#request</code> rescues from an <code>Errno::ECONNRESET</code> exception (the original cause of all this), it retries only once and then calls <code>Net::HTTP::Persistent#request_failed</code>.  <code>request_failed</code> in turn calls <code>Net::HTTP::Persistent#finish</code> with the connection.  Thus, it seems the only necessary monkey patching is to retry more than once.</p>\n"}], "owner": {"reputation": 75, "user_id": 8834422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-djVL1US9WUc/AAAAAAAAAAI/AAAAAAAAACM/U6K1PDEd1tc/photo.jpg?sz=128", "display_name": "Amadeus Pagel", "link": "https://stackoverflow.com/users/8834422/amadeus-pagel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1532029288, "creation_date": 1530025810, "question_id": 51046179, "link": "https://stackoverflow.com/questions/51046179/connectionpoolerror-no-connections-are-checked-out", "title": "ConnectionPool::Error (no connections are checked out)", "body": "<p>I get this error trying to scrape a website with mechanize.</p>\n\n<p>This is my code:</p>\n\n<pre><code>agent = Mechanize.new\n\nagent.user_agent_alias = 'Mac Safari'\n\nagent.keep_alive = false\n\npage = agent.get('https://web.archive.org/web/20170417084732/https://www.cs.auckland.ac.nz/~andwhay/postlist.html')\n\npage.links_with(:text =&gt; 'post').each do |link|\n  post = link.click\n  Article.create(\n    user_id: 1,\n    title: post.css('title'),\n    text: post.at(\"//div[@itemprop = 'description']\")\n  )\nend\n</code></pre>\n\n<p>I also used <a href=\"http://scottwb.com/blog/2013/11/09/defeating-the-infamous-mechanize-too-many-connection-resets-bug/\" rel=\"nofollow noreferrer\">this code</a> to avoid the \"Too Many Connection Resets\" error.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 5, "creation_date": 1530024068, "post_id": 51045485, "comment_id": 89082299, "body": "&quot;Unfortunately story_step.st_video_url_changed? is giving me false positives and negatives in rspec tests&quot; - maybe fix that instead of adding unnecessary crutches?"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530024188, "post_id": 51045485, "comment_id": 89082371, "body": "hehe right, I&#39;d love to but I am failing at solving the issue. I am totally aware I am doing what you say, it&#39;s actually very nice way to say it &quot;unnecessary crutches&quot; but so far no luck for me after a full day of work so kind of giving up:) I am going to post a Stackoverflow new question about it but it&#39;s really tied deeply to some test stack , hoping maybe I&#39;ll manage to solve it..."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1530024296, "post_id": 51045485, "comment_id": 89082445, "body": "And I hate moving seperate how things are done in test and things done in dev/prod...i know, antipattern, right? :)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530024476, "post_id": 51045485, "comment_id": 89082559, "body": "&quot;antipattern, right?&quot; - more like maintenance nightmare. But that too :)"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530024512, "post_id": 51045485, "comment_id": 89082590, "body": "I&#39;ll try posting the real question then haha but maybe you&#39;ll see, it&#39;s pretty complex:)"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530024604, "post_id": 51045485, "comment_id": 89082649, "body": "&quot;it&#39;s pretty complex&quot; - try your best to distill it down to absolute minimum amount of code that still reproduces the problem. Who knows, maybe you&#39;ll find the root cause yourself while doing this. Here&#39;s some tips: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530024658, "post_id": 51045485, "comment_id": 89082689, "body": "Sure but the why is important and the why goes deep in the rabbit hole:)"}, {"owner": {"reputation": 6018, "user_id": 3073313, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d9a53be16eb996b521f1637d19005511?s=128&d=identicon&r=PG", "display_name": "Jay-Ar Polidario", "link": "https://stackoverflow.com/users/3073313/jay-ar-polidario"}, "edited": false, "score": 0, "creation_date": 1530025302, "post_id": 51045485, "comment_id": 89083107, "body": "@Matthieu I do not know the full details of the project, but usually I can resolve to use &quot;mocks&quot; instead of having to write a code that checks for the environment in the actual production code like what you are currently doing. (i.e. if &quot;necessary&quot;, I can mock the <code>video_url</code> to be &quot;changed&quot; in my spec). If however, this is more of a configuration / environment &quot;differences&quot; between dev/test/prod, and that your code above is potentially gonna be relying on this, then I will usually have my own <code>config&#47;some_configuration.yml</code> that contains different settings for test/dev/prod."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530028693, "post_id": 51045485, "comment_id": 89085210, "body": "@Mathieu I&#39;ve resolved <i>hundreds</i> of situations like this before; it can always be fixed with some restructuring of the code and/or redesigning the tests, rather than adding <code>if Rails.env.test?</code> into the code. Doing the latter is a <b>big</b> code small -- it means your tests are now testing the wrong thing!"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530028776, "post_id": 51045485, "comment_id": 89085255, "body": "@TomLord and sergio-tulentsev: you&#39;re right, I know ity in my guts but my issue is very specific, that&#39;s why I&#39;ll try to post the real issue on SO in order not to just use cruches but walk really properly:)"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530028784, "post_id": 51045485, "comment_id": 89085259, "body": "I&#39;m writing it right now, but it&#39;s quite hard to precisely describe as it&#39;s related to a cross-roads of factory girl+rspec-retry+my specific Dela modela attribute constraints"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530029133, "post_id": 51045485, "comment_id": 89085463, "body": "<code>rspec-retry</code> should almost certainly be irrelevant. (And using that library is a bit of a hack; it means you must have flaky intermittent failures in your test suite. Again, it&#39;s better to fix the root cause instead of sticking a plaster over it.) At a guess, I would say this is to do with whether or not the <code>deal</code> is a <i>new</i> record. But I&#39;d need to see a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (preferably with a little more context around what this method is supposed to be doing) to say anything for certain."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530029216, "post_id": 51045485, "comment_id": 89085515, "body": "no its is very relevant as it&#39;s the reason I don&#39;t use the more &quot;common&quot; way of creating associuated objects using Factory Girl&#39;s transient, and instead doing it myself, leading to a failure in assocating objects...more here below"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530029235, "post_id": 51045485, "comment_id": 89085526, "body": "Here is the related/original bug : <a href=\"https://stackoverflow.com/questions/51047204/rails-4-2-rspec-rspec-retry-association-belong-has-many-failing\" title=\"rails 4 2 rspec rspec retry association belong has many failing\">stackoverflow.com/questions/51047204/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530029370, "post_id": 51047130, "comment_id": 89085607, "body": "thanks, interesting to know but as advised, I posted the real core issue, whose hacky solution...resulted in this bug where _changed was giving false negative. See <a href=\"https://stackoverflow.com/questions/51047204/rails-4-2-rspec-rspec-retry-association-belong-has-many-failing\" title=\"rails 4 2 rspec rspec retry association belong has many failing\">stackoverflow.com/questions/51047204/&hellip;</a>"}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530029501, "post_id": 51047130, "comment_id": 89085668, "body": "About this dirty way: it&#39;s not exactly what I would need anyway because I need to wlays check deal.video_url.present?, even on a test environment. So in your technique a video might be present but if we&#39;re on a test environement the content of the conditon won&#39;t be executed, while I need it to be executed. It&#39;s only the condition deal.video_url_changed? that needs to be constrained to the dev and prod environmentds. thats was my difficulty."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "edited": false, "score": 0, "creation_date": 1530029664, "post_id": 51047130, "comment_id": 89085755, "body": "<i>&quot;I need to always <code>check deal.video_url.present?</code>&quot;</i> -- Yes, that&#39;s exactly what I&#39;ve done above. <code>deal.video_url.present?</code> will <b>always be executed</b>. The <code>&amp;&amp;</code> operator &quot;short-circuits&quot; at the first <code>falsey</code> value, which means <code>deal.video_url_changed?</code> will never be executed in test environment, but the first query will."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530031454, "post_id": 51047130, "comment_id": 89086700, "body": "Damn, that negation was giving me troubles this afternoon. So, in test env, <code>!Rails.env.test?</code> will turn the whole expression to false and &quot;stuff&quot; won&#39;t happen. When Mathieu does need it to happen."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530031945, "post_id": 51047130, "comment_id": 89086947, "body": "<code>if deal.video_url.present? &amp;&amp; (Rails.env.test? || deal.video_url_changed?)</code> - that&#39;s more like it."}, {"owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530033487, "post_id": 51047130, "comment_id": 89087754, "body": "@SergioTulentsev exactly sth was bugging me too"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1530028860, "creation_date": 1530028860, "answer_id": 51047130, "question_id": 51045485, "link": "https://stackoverflow.com/questions/51045485/ruby-rails-4-2-if-a-b-where-b-condition-depends-on-the-rails-environment/51047130#51047130", "title": "Ruby/Rails 4.2 - if A &amp;&amp; B where B condition depends on the Rails environment", "body": "<p>Here is a quick and <strong>very dirty</strong> solution:</p>\n\n<pre><code>if deal.video_url.present? &amp;&amp; !Rails.env.test? &amp;&amp; deal.video_url_changed?\n  # do stuff\nend\n</code></pre>\n\n<p>But as mentioned above, I <em>strongly</em> advise that you <em>do not do this</em>.</p>\n\n<p>Redesign the code/and or the tests. Don't munge the code to get tests passing - it means your tests are now testing the wrong thing!</p>\n"}], "owner": {"reputation": 3791, "user_id": 1467802, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c370a1855b3094ca8b0e737822164a1a?s=128&d=identicon&r=PG", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1467802/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530029306, "creation_date": 1530023679, "last_edit_date": 1530029306, "question_id": 51045485, "link": "https://stackoverflow.com/questions/51045485/ruby-rails-4-2-if-a-b-where-b-condition-depends-on-the-rails-environment", "title": "Ruby/Rails 4.2 - if A &amp;&amp; B where B condition depends on the Rails environment", "body": "<p>I have a complex condition to assert in one of my methods:</p>\n\n<p>Today it's: </p>\n\n<pre><code>if deal.video_url.present? &amp;&amp; deal.video_url_changed? \n  # do stuff\n  # about 15 lines of code\nend\n</code></pre>\n\n<p>Unfortunately <code>story_step.st_video_url_changed?</code> is giving me false positives and negatives in Rspec tests (see the issue also mentioned here: <a href=\"https://stackoverflow.com/questions/10478746/how-can-i-test-that-no-attribute-on-a-model-has-been-modified-using-rspec#comment-13592580\">How can I test that no attribute on a model has been modified using rspec?</a>)</p>\n\n<p>Anyway, what I wish to do is modify this condition check line to become</p>\n\n<blockquote>\n  <p>\"if we're on rails development or production environements, please\n  check  A(deal.video_url.present?) &amp;&amp; B(deal.video_url_changed? ) but\n  if Rails environement is Test, ONLY check A deal.video_url.present?</p>\n</blockquote>\n\n<p>Of course I could write:</p>\n\n<pre><code>if Rails.env.development? || Rails.env.production?\n  if deal.video_url.present? &amp;&amp; deal.video_url_changed? \n    # do stuff\n    # about 15 lines of code\n  end   \nelse # test environment\n  if deal.video_url.present? \n    # do stuff\n    # about 15 lines of code\n  end\n</code></pre>\n\n<p>But, I feel it's really not DRY to repeat twice the <strong>exact</strong> same 15 lines of code to be executed when the condition pass.</p>\n\n<p>I could factorize by creating a new method</p>\n\n<pre><code>if Rails.env.development? || Rails.env.production?\n  if deal.video_url.present? &amp;&amp; deal.video_url_changed? \n    new_method_to_factorize\n  end\nelse # test environment\n  if deal.video_url.present? \n    new_method_to_factorize\n  end\nend\n\ndef new_method_to_factorize\n  # do stuff\n  # about 15 lines of code\nend\n</code></pre>\n\n<p>But I wonder is it possible to write this more cleanly and without creating a new method? </p>\n\n<p>I tried but failed with the code below</p>\n\n<pre><code>if deal.video_url.present? &amp;&amp; (deal.video_url_changed? unless Rails.env.test?) \n  # do stuff\n  # about 15 lines of code\nend\n</code></pre>\n\n<p>EDIT</p>\n\n<p>After many comments, I realized that i am trying to put crutches while I should deal with the very core of the bug. this bug was created because I found a hacky way to associate Deals and Steps. To solve the original issue, I created a new Stackoverflow question: <a href=\"https://stackoverflow.com/questions/51047204/rails-4-2-rspec-rspec-retry-association-belong-has-many-failing\">Rails 4.2 / Rspec / rspec-retry - association belong/has_many failing</a></p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1530029109, "post_id": 51045418, "comment_id": 89085446, "body": "How about ajax request?"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 769199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8ccf34d7c5016b43cf4570e6af2b1dff?s=128&d=identicon&r=PG", "display_name": "skalogirou", "link": "https://stackoverflow.com/users/769199/skalogirou"}, "edited": false, "score": 0, "creation_date": 1530025270, "post_id": 51045493, "comment_id": 89083091, "body": "Thank you Sergio!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 1, "last_activity_date": 1530023693, "creation_date": 1530023693, "answer_id": 51045493, "question_id": 51045418, "link": "https://stackoverflow.com/questions/51045418/how-to-use-javascript-variable-in-inline-ruby-code-in-htm-erb-file/51045493#51045493", "title": "How to use javascript variable in inline Ruby code in htm.erb file", "body": "<blockquote>\n  <p>Is it possible?</p>\n</blockquote>\n\n<p>Not like this, no. Your only two options are:</p>\n\n<ol>\n<li><p>server-side lookup: Make another request to the server, in which you pass <code>user_id</code> and retrieve user data.</p></li>\n<li><p>client-side lookup: As you mentioned, embed data from all users on the page and simply choose one of them, based on <code>user_id</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": false, "score": 1, "last_activity_date": 1530064495, "creation_date": 1530064495, "answer_id": 51053481, "question_id": 51045418, "link": "https://stackoverflow.com/questions/51045418/how-to-use-javascript-variable-in-inline-ruby-code-in-htm-erb-file/51053481#51053481", "title": "How to use javascript variable in inline Ruby code in htm.erb file", "body": "<p>I am thinking in a simple way, as @sergio-tulentsev said, what you are trying to do is not posble, but using more js, you don't need to find the user on the rails collection, if you already loaded all the users, then just past them to a javascript variable and on the change event, just select the one from there, something like this.</p>\n\n<p>When you load your page with all the users, just save them on a javascript variable as json</p>\n\n<pre><code>var users = &lt;%= @users.to_json.html_safe %&gt;;\n</code></pre>\n\n<p>after that, on your event </p>\n\n<pre><code>$(\"user_select\").change(function(e){\n  e.preventDefault();\n  user_id = $(this).val();\n  $.each(users, function(i, u) {\n    if (u.id == user_id) {\n      user = u\n      return;\n    }\n  });\n}) \n</code></pre>\n\n<p>with that you will have user with a json and all the values of the user there, you can then do something like <code>user.name</code> on javascript to get the values.</p>\n\n<p>I used jquery because in you code example you are using it.</p>\n"}], "owner": {"reputation": 127, "user_id": 769199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8ccf34d7c5016b43cf4570e6af2b1dff?s=128&d=identicon&r=PG", "display_name": "skalogirou", "link": "https://stackoverflow.com/users/769199/skalogirou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 51045493, "answer_count": 2, "score": 0, "last_activity_date": 1530082129, "creation_date": 1530023490, "last_edit_date": 1530082129, "question_id": 51045418, "link": "https://stackoverflow.com/questions/51045418/how-to-use-javascript-variable-in-inline-ruby-code-in-htm-erb-file", "title": "How to use javascript variable in inline Ruby code in htm.erb file", "body": "<p>I  have a collection of data in a select box, let's say <code>@users = User.all</code>. On change, I would like to get a variable in javascript with the user that is selected, I mean something like this :</p>\n\n<pre><code>    $(\"user_select\").change(function(e){\n        e.preventDefault();\n        user_id = $(this).val();\n        user = &lt;%= @user.find(&lt;user_id&gt;) %&gt;\n    }) \n</code></pre>\n\n<p>Is it possible? Or I have to put the whole collection in javascript variable and get it from there?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1530023352, "post_id": 51045211, "comment_id": 89081838, "body": "There is no way to achieve this. You need write Reports::Report all the time. But I wonder why you need namespaced model?"}, {"owner": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "reply_to_user": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1530023686, "post_id": 51045211, "comment_id": 89082068, "body": "@andriy-baran I have to isolate the model for colliding names. So you are saying all models should be defined as root??"}, {"owner": {"reputation": 476, "user_id": 2645167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEnRe.jpg?s=128&g=1", "display_name": "andriy-baran", "link": "https://stackoverflow.com/users/2645167/andriy-baran"}, "edited": false, "score": 0, "creation_date": 1530023945, "post_id": 51045211, "comment_id": 89082227, "body": "Please read this question <a href=\"https://stackoverflow.com/questions/18934115/rails-4-organize-rails-models-in-sub-path-without-namespacing-models\" title=\"rails 4 organize rails models in sub path without namespacing models\">stackoverflow.com/questions/18934115/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "edited": false, "score": 0, "creation_date": 1530024447, "post_id": 51045580, "comment_id": 89082537, "body": "I tried also this, but with no luck. It gives me the same error"}, {"owner": {"reputation": 1038, "user_id": 6124030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/990002717754994/picture?type=large", "display_name": "Emilio Men&#233;ndez", "link": "https://stackoverflow.com/users/6124030/emilio-men%c3%a9ndez"}, "reply_to_user": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "edited": false, "score": 0, "creation_date": 1530024560, "post_id": 51045580, "comment_id": 89082614, "body": "what&#39;s the path file for your Reports:Report? should be <code>.&#47;app&#47;models&#47;reports&#47;report.rb</code> as the error you get suggests"}, {"owner": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "edited": false, "score": 0, "creation_date": 1530024749, "post_id": 51045580, "comment_id": 89082758, "body": "the path is that"}, {"owner": {"reputation": 1038, "user_id": 6124030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/990002717754994/picture?type=large", "display_name": "Emilio Men&#233;ndez", "link": "https://stackoverflow.com/users/6124030/emilio-men%c3%a9ndez"}, "reply_to_user": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "edited": false, "score": 0, "creation_date": 1530027121, "post_id": 51045580, "comment_id": 89084265, "body": "I just realised your routes are missing one nested namespace for <code>reports</code> as well, but the whole naming looks weird to me and not sure if rails will be getting confused. The module&#39;s name  should be singular and then you might have a Finance report or something, <code>Reports::Report</code> is confusing in my opinion"}, {"owner": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "edited": false, "score": 0, "creation_date": 1530027306, "post_id": 51045580, "comment_id": 89084365, "body": "I also tried with a different naming, changing Reports::Report with Reporting::Report and consequently all the classes and controller. I also tried to add the Reporting namespace but the error is always the same"}], "tags": [], "owner": {"reputation": 1038, "user_id": 6124030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/990002717754994/picture?type=large", "display_name": "Emilio Men&#233;ndez", "link": "https://stackoverflow.com/users/6124030/emilio-men%c3%a9ndez"}, "is_accepted": false, "score": 0, "last_activity_date": 1530023977, "creation_date": 1530023977, "answer_id": 51045580, "question_id": 51045211, "link": "https://stackoverflow.com/questions/51045211/unable-to-autoload-constant-api-controller-in-rails-4-model-in-module/51045580#51045580", "title": "Unable to autoload constant API Controller in Rails 4 model in module", "body": "<p>Your controller needs to include <code>Reports</code> somehow:</p>\n\n<pre><code>module Api\n  module V2\n    module Reports\n      class Report &lt; API::V2::BaseController\n\n        your controller actions\n\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Apart from that, I think it will be confusing if you use <code>Reports::Report</code>?</p>\n"}], "owner": {"reputation": 1413, "user_id": 3519825, "user_type": "registered", "profile_image": "https://graph.facebook.com/557153174/picture?type=large", "display_name": "baldarn", "link": "https://stackoverflow.com/users/3519825/baldarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1530023977, "creation_date": 1530022880, "question_id": 51045211, "link": "https://stackoverflow.com/questions/51045211/unable-to-autoload-constant-api-controller-in-rails-4-model-in-module", "title": "Unable to autoload constant API Controller in Rails 4 model in module", "body": "<p>I'm trying to create an api controller for a model defined in a module </p>\n\n<p>Model class:</p>\n\n<pre><code>module Reports\n  class Report &lt; ActiveRecord::Base\n  end\nend\n</code></pre>\n\n<p>Api controller:</p>\n\n<pre><code>class API::V2::ReportsController &lt; API::V2::BaseController\n\nend\n</code></pre>\n\n<p>Route:</p>\n\n<pre><code>namespace :api, defaults: { format: :json } do\n  namespace :v2 do\n    resources :reports\n  end\nend\n</code></pre>\n\n<p>The error I get when try to call api/v2/reports is:</p>\n\n<pre><code>LoadError (Unable to autoload constant Report, expected /.../app/models/reports/report.rb to define it):\n</code></pre>\n\n<p>Is there a way to solve this, making the api controller look for Reports::Report instead of Report?</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 2, "creation_date": 1530017596, "post_id": 51043362, "comment_id": 89077756, "body": "Your method should be called <code>remove_smallest</code>, not <code>RemoveSmallest</code>. Case matters a lot in Ruby, and when you use a leading uppercase letter you&#39;re creating a constant."}, {"owner": {"reputation": 4644, "user_id": 2594185, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003773788931/picture?type=large", "display_name": "Jagdeep Singh", "link": "https://stackoverflow.com/users/2594185/jagdeep-singh"}, "edited": false, "score": 0, "creation_date": 1530017746, "post_id": 51043362, "comment_id": 89077874, "body": "<code>numbers.delete_at(numbers.index(numbers.min))</code>"}, {"owner": {"reputation": 353, "user_id": 3292755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/863b711b7b8357dd3efa00663f42b5e7?s=128&d=identicon&r=PG&f=1", "display_name": "user3292755", "link": "https://stackoverflow.com/users/3292755/user3292755"}, "reply_to_user": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1530017898, "post_id": 51043362, "comment_id": 89077983, "body": "@meagar thanks for the feedback, quite new with ruby, reason that i use camelcase is because i read it somewhere over the web, to make the variables easier to read"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 1, "creation_date": 1530017977, "post_id": 51043362, "comment_id": 89078034, "body": "@user3292755 Camel case is used for defining constants, like class and module names."}], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 3, "last_activity_date": 1530017920, "last_edit_date": 1530017920, "creation_date": 1530017499, "answer_id": 51043404, "question_id": 51043362, "link": "https://stackoverflow.com/questions/51043362/function-to-remove-the-smallest-number-in-ruby/51043404#51043404", "title": "function to remove the smallest number in ruby", "body": "<p><code>numbers.min</code> returns a number, not an array. You cannot invoke <code>uniq</code> on it, that's not a method on numbers.</p>\n\n<p>Your code in the first branch would successfully remove only the first instance of the lowest number without <code>.uniq</code>, because <code>numbers.index</code> finds the first occurrence.</p>\n\n<p>In fact, the entire if/else block is redundant. The first branch handles both types of input, so there is very little point in defining a special case for many vs one:</p>\n\n<pre><code>def remove_smallest(array)\n  array.delete_at(array.index(array.min))\n  array\nend\n\np remove_smallest([1, 2, 3, 4])    # [2, 3, 4]\np remove_smallest([4, 3, 1, 2, 1]) # [4, 3, 2, 1]\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 3292755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/863b711b7b8357dd3efa00663f42b5e7?s=128&d=identicon&r=PG&f=1", "display_name": "user3292755", "link": "https://stackoverflow.com/users/3292755/user3292755"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 51043404, "answer_count": 1, "score": -2, "last_activity_date": 1530017920, "creation_date": 1530017362, "question_id": 51043362, "link": "https://stackoverflow.com/questions/51043362/function-to-remove-the-smallest-number-in-ruby", "title": "function to remove the smallest number in ruby", "body": "<p>Currently trying to create a ruby function that deletes the smallest number , if that minimum number is duplicated, it should only remove the first minimum number . Here's the code that i tried</p>\n\n<pre><code>def RemoveSmallest(numbers)\n\n    if numbers.count(numbers.min.uniq) &gt; 1\n      numbers.delete_at(numbers.index numbers.min.uniq)\n      numbers\n    else \n      numbers.delete(numbers.min)\n      numbers\n\n    end\n\nend\n\nputs RemoveSmallest([2,2,4,5,6])\n</code></pre>\n\n<p>this is the error </p>\n\n<pre><code>remove_small.rb:3:in `RemoveSmallest': undefined method `uniq' for 2:Fixnum (NoMethodError)\n    from remove_small.rb:15:in `&lt;main&gt;'\n</code></pre>\n\n<p>im not sure why the code passes wrong when i apply <code>uniq</code> method on it</p>\n"}, {"tags": ["ruby", "sorting", "hash"], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 6507275, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3a3d4c07b9fcb38f037c3da4c1e46cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen M", "link": "https://stackoverflow.com/users/6507275/stephen-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1530013136, "creation_date": 1530013136, "answer_id": 51042011, "question_id": 51041912, "link": "https://stackoverflow.com/questions/51041912/sorting-nested-hashes-by-multiple-values-in-ruby/51042011#51042011", "title": "Sorting nested hashes by multiple values in ruby", "body": "<p>Have you tried this.</p>\n\n<pre><code>my_hash.sort_by {|participant_id, values| [values[:diff], values[:points]] }.reverse.to_h\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "edited": false, "score": 0, "creation_date": 1530013875, "post_id": 51042052, "comment_id": 89075368, "body": "Great thanks, I was trying to do something similar by separating both values by commas but forgot to surround them by <code>[ ]</code>. Also didn&#39;t know you could use <code>-</code> to change the order. Thanks a lot for your help."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1530013692, "last_edit_date": 1530013692, "creation_date": 1530013269, "answer_id": 51042052, "question_id": 51041912, "link": "https://stackoverflow.com/questions/51041912/sorting-nested-hashes-by-multiple-values-in-ruby/51042052#51042052", "title": "Sorting nested hashes by multiple values in ruby", "body": "<p>I would do this:</p>\n\n<pre><code>hash = {12=&gt;{:points=&gt;0, :diff=&gt;0}, 1=&gt;{:points=&gt;18, :diff=&gt;57}, 4=&gt;{:points=&gt;12, :diff=&gt;67}, 5=&gt;{:points=&gt;9, :diff=&gt;62}}\n\nhash.sort_by { |_, v| [-v[:points], v[:diff]] }.to_h\n#=&gt; {1=&gt;{:points=&gt;18, :diff=&gt;57}, 4=&gt;{:points=&gt;12, :diff=&gt;67}, 5=&gt;{:points=&gt;9, :diff=&gt;62}, 12=&gt;{:points=&gt;0, :diff=&gt;0}}\n</code></pre>\n\n<p>Basically, it extracts the values to sort by into a structure like this: <code>[[0,0], [-18,57], [-12,67], [-9,62]]</code>. Note the <code>-</code> at <code>-v[:points]</code> which leads to a descending ordering. The second number is only taken into account if the first match.</p>\n"}], "owner": {"reputation": 1302, "user_id": 6612655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fAsxJ.jpg?s=128&g=1", "display_name": "alopez02", "link": "https://stackoverflow.com/users/6612655/alopez02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 51042052, "answer_count": 2, "score": 0, "last_activity_date": 1530013692, "creation_date": 1530012810, "question_id": 51041912, "link": "https://stackoverflow.com/questions/51041912/sorting-nested-hashes-by-multiple-values-in-ruby", "title": "Sorting nested hashes by multiple values in ruby", "body": "<p>I have the following nested hash structure:</p>\n\n<pre><code>{12 =&gt; {:points=&gt;0, :diff=&gt;0},\n 1=&gt; {:points=&gt;18, :diff=&gt;57},\n 4=&gt;{:points=&gt;12, :diff=&gt;67},\n 5=&gt;{:points=&gt;9, :diff=&gt;62}}\n</code></pre>\n\n<p>I'd like to sort it by points first (descending) and by diff second (ascending). </p>\n\n<p>I'm able to sort it only by one of those values using:</p>\n\n<pre><code>my_hash.sort_by {|participant_id, values| values[:points] }.reverse.to_h\n</code></pre>\n\n<p>but I have been unable to find a way to sort it by both values. </p>\n\n<p>I've tried using:</p>\n\n<pre><code>my_hash.sort_by {|participant_id, values| values[:diff] or values[:points] }.reverse.to_h\n</code></pre>\n\n<p>Most answers regarding hash sorting consider one value like <a href=\"https://stackoverflow.com/questions/32304710/sort-hash-by-nested-value\">this</a> and other cases doesn't seem to fit my purpose. Could you help finding a solution?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 0, "creation_date": 1530012176, "post_id": 51041660, "comment_id": 89074319, "body": "Thanks @Sergio Tulentsev i just had to add .id"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "edited": false, "score": 1, "creation_date": 1530012316, "post_id": 51041660, "comment_id": 89074413, "body": "@Theopap No, you have to do the other thing I said."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 5, "last_activity_date": 1530012459, "last_edit_date": 1530012459, "creation_date": 1530012031, "answer_id": 51041660, "question_id": 51041619, "link": "https://stackoverflow.com/questions/51041619/ruby-on-rails-link-to-url-and-add-the-id-at-the-end/51041660#51041660", "title": "Ruby on Rails link_to URL and add the id at the end", "body": "<blockquote>\n  <p>how can I implement this?</p>\n</blockquote>\n\n<p>Exactly like you did. Only make sure that <code>@id</code> contains an actual id (simple value) and not a complex object <code>Item</code>. Or rename it to <code>@item</code>.</p>\n\n<p>If you're in a hurry, this is the lazy change:</p>\n\n<pre><code>&lt;%= link_to \"link\", \"https://www.example.com/sample-#{@id.id}\" %&gt;\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 7458849, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/89kDb.jpg?s=128&g=1", "display_name": "Theopap", "link": "https://stackoverflow.com/users/7458849/theopap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 51041660, "answer_count": 1, "score": 1, "last_activity_date": 1530015923, "creation_date": 1530011868, "last_edit_date": 1530015923, "question_id": 51041619, "link": "https://stackoverflow.com/questions/51041619/ruby-on-rails-link-to-url-and-add-the-id-at-the-end", "title": "Ruby on Rails link_to URL and add the id at the end", "body": "<p>I'm trying to <code>link_to</code> a url and would like to add the id at the end. The id is in a global variable @id:</p>\n\n<pre><code>&lt;%= link_to \"link\", \"https://www.example.com/sample-#{@id}\" %&gt;\n</code></pre>\n\n<p>The above returns this:</p>\n\n<pre><code>https://www.example.com/sample-#%3CItem:0x007fe66cf8e850%3E\n</code></pre>\n\n<p>Any idea how I can implement this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530013954, "post_id": 51041928, "comment_id": 89075407, "body": "Tried with the above code, but still the file is not getting downloaded."}, {"owner": {"reputation": 819, "user_id": 4169845, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7ed5daf2ab8e462fa4afbb2f6e44a90?s=128&d=identicon&r=PG", "display_name": "mityakoval", "link": "https://stackoverflow.com/users/4169845/mityakoval"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530017550, "post_id": 51041928, "comment_id": 89077722, "body": "@MallelaSriPrakash any errors? I tried it in rails 5.1.5 and it worked."}, {"owner": {"reputation": 819, "user_id": 4169845, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7ed5daf2ab8e462fa4afbb2f6e44a90?s=128&d=identicon&r=PG", "display_name": "mityakoval", "link": "https://stackoverflow.com/users/4169845/mityakoval"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1530017665, "post_id": 51041928, "comment_id": 89077805, "body": "@Mark First we use CSV&#39;s <code>generate</code> method to make string that represents the comma-separated data. Then it is wrapped in a I/O stream object to be able to send it to the client. But now as I am writing this I think we can drop the StringIO and just send the string itself."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530018608, "post_id": 51041928, "comment_id": 89078451, "body": "I dont see any file being downloaded.  I am having ajax call on button click which calls the method from the controller. But, per this article <a href=\"https://stackoverflow.com/questions/17304407/how-to-make-a-div-with-a-rails-link-clickable\" title=\"how to make a div with a rails link clickable\">stackoverflow.com/questions/17304407/&hellip;</a> it seems to be it wont work with ajax calls"}, {"owner": {"reputation": 819, "user_id": 4169845, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7ed5daf2ab8e462fa4afbb2f6e44a90?s=128&d=identicon&r=PG", "display_name": "mityakoval", "link": "https://stackoverflow.com/users/4169845/mityakoval"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530019200, "post_id": 51041928, "comment_id": 89078869, "body": "@MallelaSriPrakash Well, you should&#39;ve mentioned the AJAX call in your question. As it is suggested here: <a href=\"https://stackoverflow.com/questions/16242359/how-to-trigger-download-with-rails-send-data-from-ajax-post/17526267\" title=\"how to trigger download with rails send data from ajax post\">stackoverflow.com/questions/16242359/&hellip;</a> you might try rendering a partial that will download a file for you. But I would just do it without AJAX."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530019450, "post_id": 51041928, "comment_id": 89079028, "body": "@mityakoval, apologies for not mentioning the same. Can you help me the sample code without ajax or by using &lt;a href as suggested for achieving the same. Thanks in advance."}, {"owner": {"reputation": 819, "user_id": 4169845, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7ed5daf2ab8e462fa4afbb2f6e44a90?s=128&d=identicon&r=PG", "display_name": "mityakoval", "link": "https://stackoverflow.com/users/4169845/mityakoval"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530022688, "post_id": 51041928, "comment_id": 89081361, "body": "@MallelaSriPrakash I&#39;ve updated the answer. Obviously, I have no idea where you get your <code>@data</code> from."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530034917, "post_id": 51041928, "comment_id": 89088490, "body": "@mityakoval, Really thanks for the above sample code. That worked."}, {"owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530036143, "post_id": 51041928, "comment_id": 89089142, "body": "@mityakoval, sorry to bother you again. Can you tell me what is download_path(format: :csv) in the above code. Being novice, thought to clear the doubt"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "edited": false, "score": 0, "creation_date": 1530089196, "post_id": 51041928, "comment_id": 89106860, "body": "@MallelaSriPrakash That will translate to the string <code>&#39;&#47;download.csv&#39;</code>. The <code>download_path</code> helper is generated by setting the route <code>get &#39;&#47;download&#39;, to: &#39;data#download&#39;</code>. See: <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow noreferrer\">guides.rubyonrails.org/routing.html</a>"}], "tags": [], "owner": {"reputation": 819, "user_id": 4169845, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a7ed5daf2ab8e462fa4afbb2f6e44a90?s=128&d=identicon&r=PG", "display_name": "mityakoval", "link": "https://stackoverflow.com/users/4169845/mityakoval"}, "is_accepted": true, "score": 1, "last_activity_date": 1530026760, "last_edit_date": 1530026760, "creation_date": 1530012846, "answer_id": 51041928, "question_id": 51041028, "link": "https://stackoverflow.com/questions/51041028/how-to-create-a-file-on-users-machine-instead-of-creating-in-server-and-then-to/51041928#51041928", "title": "How to create a file on users machine instead of creating in server and then to download using rails", "body": "<p>What you can do is generate a string with the CSV library, using <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/csv/rdoc/CSV.html#method-c-generate\" rel=\"nofollow noreferrer\"><code>CSV::generate</code></a> instead of <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/csv/rdoc/CSV.html#method-c-open\" rel=\"nofollow noreferrer\"><code>CSV::open</code></a>.</p>\n\n<p>Controller: </p>\n\n<pre><code>class DataController &lt; ApplicationController\n  def download\n    respond_to do |format|\n      format.csv { send_csv_download }\n    end\n  end\n\n  private\n\n  def send_csv_download\n    string = CSV.generate do |csv|\n      @data.each { |row| csv &lt;&lt; [\"#{row.name}@gmail.com\"] }\n    end\n\n    send_data string, filename: 'foo.csv', type: :csv\n  end\n\nend\n</code></pre>\n\n<p>config/routes.rb:</p>\n\n<pre><code>get '/download', to: 'data#download'\n</code></pre>\n\n<p>View: </p>\n\n<pre><code>&lt;%= link_to 'Download CSV', download_path(format: :csv) %&gt;\n</code></pre>\n\n<p><strong>Note:</strong> Obviously, I have no idea where you get your <code>@data</code> from, since it isn't specified in your question.</p>\n"}], "owner": {"reputation": 59, "user_id": 9804392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mallela SriPrakash", "link": "https://stackoverflow.com/users/9804392/mallela-sriprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51041928, "answer_count": 1, "score": 1, "last_activity_date": 1530029153, "creation_date": 1530010115, "last_edit_date": 1530029153, "question_id": 51041028, "link": "https://stackoverflow.com/questions/51041028/how-to-create-a-file-on-users-machine-instead-of-creating-in-server-and-then-to", "title": "How to create a file on users machine instead of creating in server and then to download using rails", "body": "<p>I am working on to allow download an excel file with the below code:</p>\n\n<pre><code>login     = Etc.getlogin\n@dataFile = \"C:/rails/#{login}data.csv\"\n\ncsv1=CSV.open(@dataFile, 'w') do |csv|\n  $data.each do |eachrow|\n    csv &lt;&lt; [eachrow.name+\"@gmail.com\"]\n  end\nend\n\nsend_file(@dataFile, :filename =&gt; \"#{login}data\", :type =&gt;  \"application/csv\")\n</code></pre>\n\n<p>Using the above code, I am able to create a file and write the data.</p>\n\n<p>Instead of this, how do i write the data in csv and get downloaded into users machine instead of saving in local/server.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530001992, "post_id": 51038293, "comment_id": 89068104, "body": "That&#39;s all of the output? No scary error message?"}, {"owner": {"reputation": 63, "user_id": 9805838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c8d6d230d101d60f55051b8f2d1589?s=128&d=identicon&r=PG&f=1", "display_name": "guymil", "link": "https://stackoverflow.com/users/9805838/guymil"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530002053, "post_id": 51038293, "comment_id": 89068133, "body": "@SergioTulentsev yeah that was it )-:"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1530002416, "post_id": 51038293, "comment_id": 89068338, "body": "Can you run rails console?"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1530003377, "post_id": 51038293, "comment_id": 89068917, "body": "show your config for Puma server."}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1530003425, "post_id": 51038293, "comment_id": 89068942, "body": "Aren&#39;t you daemonizing the server?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530003559, "post_id": 51038293, "comment_id": 89069032, "body": "How did you create the application? What have you changed so far? Can you reproduce the steps? And to rule out other factors: does this also happen when creating a new Rails application?"}, {"owner": {"reputation": 63, "user_id": 9805838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c8d6d230d101d60f55051b8f2d1589?s=128&d=identicon&r=PG&f=1", "display_name": "guymil", "link": "https://stackoverflow.com/users/9805838/guymil"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530003753, "post_id": 51038293, "comment_id": 89069153, "body": "@Stefan Updated the post! And no, this doesn&#39;t happen with new applications. I just don&#39;t know how to run the server again in an existing application."}, {"owner": {"reputation": 300, "user_id": 4481206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421264bfc22afa5b1e1faf28e8af6c98?s=128&d=identicon&r=PG&f=1", "display_name": "APS", "link": "https://stackoverflow.com/users/4481206/aps"}, "edited": false, "score": 0, "creation_date": 1530005280, "post_id": 51038293, "comment_id": 89070095, "body": "@guymil, migrations are pending, run -&gt; rails db:migrate"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530006427, "post_id": 51038293, "comment_id": 89070801, "body": "@guymil The big red error message tells you exactly what command to run. Have you tried running it?"}, {"owner": {"reputation": 63, "user_id": 9805838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c8d6d230d101d60f55051b8f2d1589?s=128&d=identicon&r=PG&f=1", "display_name": "guymil", "link": "https://stackoverflow.com/users/9805838/guymil"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1530006669, "post_id": 51038293, "comment_id": 89070949, "body": "@TomLord yeah I ran it already, look at the update"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1530006723, "post_id": 51038293, "comment_id": 89070981, "body": "What do you mean by <i>&quot;nothing happened&quot;</i> \u2013 an error message is not nothing ;-) BTW, could you post the whole error message / output, please?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 3, "creation_date": 1530008445, "post_id": 51038293, "comment_id": 89072015, "body": "@guymil Error messages are there for a reason -- you need to read them. What does it say? Post the whole error here; don&#39;t cut it off before the important part. Maybe your database is misconfigured? Maybe there&#39;s a syntax error in the migration? Maybe the database is in an inconsistent state, and you should recreate it? Maybe the migration is invalid, e.g. you&#39;re trying to create a table that already exists? I don&#39;t know what&#39;s wrong, because you&#39;re not showing us -- again, please post the <b>full</b> error message."}, {"owner": {"reputation": 755, "user_id": 1077560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92feeade6fc77126c9317e9796114741?s=128&d=identicon&r=PG", "display_name": "Bernard Banta", "link": "https://stackoverflow.com/users/1077560/bernard-banta"}, "edited": false, "score": 1, "creation_date": 1530013345, "post_id": 51038293, "comment_id": 89075016, "body": "The problem is your user migration. Please post your migrations here so that we can help you pinpoint where the problem is."}], "answers": [{"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1530024458, "creation_date": 1530024458, "answer_id": 51045737, "question_id": 51038293, "link": "https://stackoverflow.com/questions/51038293/how-do-i-run-a-server-on-ruby-on-rails/51045737#51045737", "title": "How do I run a server on ruby on rails?", "body": "<p>I recommend you to check the status of all your migrations, maybe there is another migration pending. Use this command <code>rake db:migrate:status</code> to see all migrations status.</p>\n\n<p>You can also reset your db and do the migrations all over again. \n<code>rake db:reset</code> (which runs <code>db:drop</code> then <code>db:setup</code>) then run your migrations <code>rake db:migrate</code>.</p>\n\n<p>Also, please check if any of your migrations are referencing on any other migration that is still not created! </p>\n\n<p>P.S. Please add the complete error you are getting, so I can have a better idea what the problem is!</p>\n"}, {"comments": [{"owner": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "edited": false, "score": 0, "creation_date": 1530026436, "post_id": 51046147, "comment_id": 89083826, "body": "There should be no need for a rollback as the failed migration is the first (and probably the only) migration."}, {"owner": {"reputation": 51, "user_id": 8215300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc38b0d3d624ac077671d850ffb421e?s=128&d=identicon&r=PG", "display_name": "Sammy Joseph", "link": "https://stackoverflow.com/users/8215300/sammy-joseph"}, "reply_to_user": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "edited": false, "score": 0, "creation_date": 1530027802, "post_id": 51046147, "comment_id": 89084677, "body": "I think he should. he might have run multiple times before asking for help. Well, if he&#39;s working with Postgres, it&#39;ll  be very necessary to do so."}], "tags": [], "owner": {"reputation": 51, "user_id": 8215300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc38b0d3d624ac077671d850ffb421e?s=128&d=identicon&r=PG", "display_name": "Sammy Joseph", "link": "https://stackoverflow.com/users/8215300/sammy-joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1530025726, "creation_date": 1530025726, "answer_id": 51046147, "question_id": 51038293, "link": "https://stackoverflow.com/questions/51038293/how-do-i-run-a-server-on-ruby-on-rails/51046147#51046147", "title": "How do I run a server on ruby on rails?", "body": "<p>At this point, I think either of this should be the problem.</p>\n\n<ol>\n<li><p>You cloned the files that was built on Mac to run on windows or Vice versa.</p></li>\n<li><p>There are some queries you cannot pass to the database. Pending the type of database, you are using with your Rails application.</p></li>\n<li><p>Crosscheck if your database settings are correct.</p></li>\n</ol>\n\n<p>That's it, Try this.\n1. For rails, 5+ do <code>rails db:rollback</code></p>\n\n<ol start=\"2\">\n<li><p><code>Bundle install</code> (just to see if everything works well)</p></li>\n<li><p>Run <code>bin/rails db:migrate RAILS_ENV=development</code>. if it still doesn't work, Look through the error report on your terminal, you should be able to see the things that are resisting the \"migrate\" command.</p></li>\n<li><p>start your server with rails s --port=PORT_NUMBER. (e.g <code>rails --port=4000</code>)</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3352, "user_id": 4565485, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8lpRH.jpg?s=128&g=1", "display_name": "ogirginc", "link": "https://stackoverflow.com/users/4565485/ogirginc"}, "is_accepted": false, "score": 0, "last_activity_date": 1530027799, "last_edit_date": 1530027799, "creation_date": 1530026061, "answer_id": 51046283, "question_id": 51038293, "link": "https://stackoverflow.com/questions/51038293/how-do-i-run-a-server-on-ruby-on-rails/51046283#51046283", "title": "How do I run a server on ruby on rails?", "body": "<p>You have a problem with the <code>db/migrations/20180619074210_create_users.rb</code> file. Delete it as the migration already failed. You do not need to undo it (<a href=\"http://edgeguides.rubyonrails.org/active_record_migrations.html#rolling-back\" rel=\"nofollow noreferrer\">rollback</a>). </p>\n\n<p>Also, I would highly recommend using command line to create a migration file until you are familiar with them. And if you have time, checkout Rails guides for <a href=\"http://guides.rubyonrails.org/active_record_migrations.html\" rel=\"nofollow noreferrer\">Active Record Migrations</a>.</p>\n\n<p><strong>Example:</strong> </p>\n\n<p>1) Create a <code>user</code> table with <code>name</code> column (<code>string</code>) and <code>age</code> column (<code>integer</code>):</p>\n\n<pre><code>rails generate migration CreateUsers name:string age:integer\n</code></pre>\n\n<p>2) This will create a similar file with a different timestamp. In my machine I got <code>db/migrate/20180626151529_create_users.rb</code>.</p>\n\n<p>3) If you open that file, you can examine the changes:</p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :name\n      t.integer :age\n    end\n  end\nend\n</code></pre>\n\n<p>4) If all looks good, you need to <strong>run</strong> this migration file. That can be achieved by:</p>\n\n<pre><code>rake db:migrate\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9805838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c8d6d230d101d60f55051b8f2d1589?s=128&d=identicon&r=PG&f=1", "display_name": "guymil", "link": "https://stackoverflow.com/users/9805838/guymil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1530027799, "creation_date": 1530001691, "last_edit_date": 1530006633, "question_id": 51038293, "link": "https://stackoverflow.com/questions/51038293/how-do-i-run-a-server-on-ruby-on-rails", "title": "How do I run a server on ruby on rails?", "body": "<p>I want to link to localserver:3000 on ruby on rails but when I use bundle exec rails server, it just exits and doesn't generate the server. </p>\n\n<pre><code>\u279c  demo git:(master) \u2717 bundle exec rails server\n    =&gt; Booting Puma\n    =&gt; Rails 5.2.0 application starting in development\n    =&gt; Run `rails server -h` for more startup options\n    Exiting  \n</code></pre>\n\n<p>This is my route.rb if it helps!</p>\n\n<pre><code>Rails.application.routes.draw do\nroot \"pages#home\"\nend\n</code></pre>\n\n<p>I created a controller called pages and created a view called home. When I first generated the server, I already ended the session so I'm wondering how I can generate the server again so I can see my \"home\" page. </p>\n\n<p>This is what happens when I try to get the server. Can anyone explain to me what could be wrong? Thank you!</p>\n\n<p>Edit:\nI created my controller by using</p>\n\n<pre><code>bundle exec rails g controller pages\n</code></pre>\n\n<p>Then I added home.html.erb under views.</p>\n\n<p>I managed to connect to the server but this is the error I see on my page:</p>\n\n<p><a href=\"https://i.stack.imgur.com/427Sj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/427Sj.png\" alt=\"enter image description here\"></a></p>\n\n<p>I ran the command but nothing happened. I copied and pasted </p>\n\n<pre><code>bin/rails db:migrate RAILS_ENV=development\n</code></pre>\n\n<p>and this was what I got:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FLofA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FLofA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "validation"], "comments": [{"owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "edited": false, "score": 0, "creation_date": 1529998573, "post_id": 51037316, "comment_id": 89066225, "body": "It&#39;s confusing, what is you issue here? Your <code>number_doc</code> with empty value or the validation? Is your <code>number_doc</code> has a value when you choose one in your <code>type_doc</code> radio button?"}, {"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1529999113, "post_id": 51037316, "comment_id": 89066508, "body": "<code>def type_6? return type_doc == &#39;6&#39; end</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1530000086, "post_id": 51037316, "comment_id": 89067065, "body": "<code>:type_doc</code> is a symbol. It will never equal <code>&#39;6&#39;</code>."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1530001528, "post_id": 51037316, "comment_id": 89067855, "body": "Feel free to accept/upvote answer if it helped you."}], "answers": [{"comments": [{"owner": {"reputation": 20491, "user_id": 511558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935cbe780c1c0a4adfeb7b2dd404a32e?s=128&d=identicon&r=PG", "display_name": "DanneManne", "link": "https://stackoverflow.com/users/511558/dannemanne"}, "edited": false, "score": 3, "creation_date": 1529999321, "post_id": 51037485, "comment_id": 89066626, "body": "A working solution, but I would suggest cleaning the content of the method to change <code>return (self.type_doc == &#39;6&#39; ? true : false)</code> to simply <code>type_doc == &#39;6&#39;</code>. Could also be handled by a Proc instead of a method by saying <code>validates :number_doc, presence: true, if: proc { |r| r.type_doc == &#39;6&#39; }</code>"}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 1, "last_activity_date": 1530001258, "last_edit_date": 1530001258, "creation_date": 1529998934, "answer_id": 51037485, "question_id": 51037316, "link": "https://stackoverflow.com/questions/51037316/conditional-validation-for-rails-5/51037485#51037485", "title": "Conditional validation for Rails 5", "body": "<pre><code>   validates :number_doc, presence: true, if: :type_6?    \n   def type_6?\n     type_doc == '6' \n   end\n</code></pre>\n\n<p>As suggested:-</p>\n\n<pre><code>validates :number_doc, presence: true, if: proc { |r| r.type_doc == '6' }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 1, "creation_date": 1530001487, "post_id": 51038142, "comment_id": 89067826, "body": "Guess self is not necessary here. it can be just <code>if: -&gt; { type_doc == &#39;6&#39; }</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1530003914, "post_id": 51038142, "comment_id": 89069245, "body": "I would be surprised if the block is evaluated in the context of the instance (but this is Rails so you never now). I&#39;d use: <code>if: -&gt; (r) { r.type_doc == &#39;6&#39; }</code>"}], "tags": [], "owner": {"reputation": 195, "user_id": 9241438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/024ae9f1a10f89fe07ea3e4fc4b00803?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Schneider", "link": "https://stackoverflow.com/users/9241438/jay-schneider"}, "is_accepted": true, "score": 5, "last_activity_date": 1530001175, "creation_date": 1530001175, "answer_id": 51038142, "question_id": 51037316, "link": "https://stackoverflow.com/questions/51037316/conditional-validation-for-rails-5/51038142#51038142", "title": "Conditional validation for Rails 5", "body": "<p>You can simply use a Lambda:</p>\n\n<pre><code> validates :number_doc, presence: true, if: -&gt; { self.type_doc == '6' }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4780437, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AOYIMwi6NDU/AAAAAAAAAAI/AAAAAAAAAC0/B7iHy3kl9C4/photo.jpg?sz=128", "display_name": "Max Puissant", "link": "https://stackoverflow.com/users/4780437/max-puissant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2098, "favorite_count": 0, "accepted_answer_id": 51038142, "answer_count": 2, "score": 0, "last_activity_date": 1530001258, "creation_date": 1529998402, "question_id": 51037316, "link": "https://stackoverflow.com/questions/51037316/conditional-validation-for-rails-5", "title": "Conditional validation for Rails 5", "body": "<p>I have a nested form and I want to validate some fields, Only if a particular field is selected. </p>\n\n<p>My first field is a radio button : </p>\n\n<pre><code>&lt;%= f.radio_button :type_doc, '5' %&gt;\n&lt;%= f.radio_button :type_doc, '6' %&gt;\n&lt;%= f.radio_button :type_doc, '7' %&gt;\n</code></pre>\n\n<p>Then (for example) if I select radio button with type '6', I want to this </p>\n\n<pre><code>&lt;%= f.text_field :number_doc, :placeholder =&gt; 'Number' %&gt;\n</code></pre>\n\n<p>to be filled. </p>\n\n<p>I have tried like explained in official doc : <a href=\"http://guides.rubyonrails.org/active_record_validations.html#conditional-validation\" rel=\"nofollow noreferrer\">Rails active record validations</a></p>\n\n<p>So, in my doc.rb model I have this : </p>\n\n<pre><code>validates :number_doc, presence: true, if: :type_6?\n\ndef type_6?\n  :type_doc == '6'\nend \n</code></pre>\n\n<p>But it doesn't work, I still be able to select :type_doc == 6 and let my field :number_doc empty.</p>\n\n<p>Any ideas ? Thanks </p>\n"}, {"tags": ["ruby", "csrf", "rack"], "comments": [{"owner": {"reputation": 2813, "user_id": 482842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/135dc4655009942421d5def8c6d153b4?s=128&d=identicon&r=PG", "display_name": "ghstcode", "link": "https://stackoverflow.com/users/482842/ghstcode"}, "edited": false, "score": 0, "creation_date": 1530007790, "post_id": 51036880, "comment_id": 89071629, "body": "What have you tried? Show us some code where you&#39;ve put some effort into it."}, {"owner": {"reputation": 715, "user_id": 2944955, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7774e748f4082571a6920f5de8175b42?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Teli", "link": "https://stackoverflow.com/users/2944955/amit-teli"}, "reply_to_user": {"reputation": 2813, "user_id": 482842, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/135dc4655009942421d5def8c6d153b4?s=128&d=identicon&r=PG", "display_name": "ghstcode", "link": "https://stackoverflow.com/users/482842/ghstcode"}, "edited": false, "score": 0, "creation_date": 1546049276, "post_id": 51036880, "comment_id": 94770296, "body": "I have used  Rack::Csrf  instead.                                                           <code>use Rack::Csrf, {:check_only=&gt; [&#39;POST:&#47;user-login&#39;, &#39;POST:&#47;restricted-view&#39;]}</code>"}], "owner": {"reputation": 715, "user_id": 2944955, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7774e748f4082571a6920f5de8175b42?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Teli", "link": "https://stackoverflow.com/users/2944955/amit-teli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529996998, "creation_date": 1529996998, "question_id": 51036880, "link": "https://stackoverflow.com/questions/51036880/exclude-some-paths-from-rackprotection", "title": "Exclude some paths from Rack::Protection", "body": "<p>I want to use <code>Rack::Protection::JsonCsrf</code> only for a few paths, say <code>/user-login</code>. However I am not able to find an option related to this.</p>\n\n<p>Can someone kindly point me to some example/documentation.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "actioncable"], "comments": [{"owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "edited": false, "score": 0, "creation_date": 1529995750, "post_id": 51036383, "comment_id": 89064657, "body": "Add your route file here"}, {"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1529996211, "post_id": 51036383, "comment_id": 89064939, "body": "why you need <code>&#47;&#47;= require cable</code> and <code>&#47;&#47;= require_tree .&#47;cable</code> in application.js? check the example again, you can simply do <code>&#47;&#47;= require_tree .</code>"}, {"owner": {"reputation": 653, "user_id": 8036445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb5ed1c3c2b3b03d10f179fb8f4078c?s=128&d=identicon&r=PG", "display_name": "Velusamy Venkatraman", "link": "https://stackoverflow.com/users/8036445/velusamy-venkatraman"}, "edited": false, "score": 0, "creation_date": 1529997110, "post_id": 51036383, "comment_id": 89065439, "body": "<code>&#47;&#47;= require jquery2 &#47;&#47;= require jquery_ujs &#47;&#47;= require cable &#47;&#47;= require turbolinks</code>   try this order"}], "owner": {"reputation": 3429, "user_id": 1414327, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xcgRQ.jpg?s=128&g=1", "display_name": "Asnad Atta", "link": "https://stackoverflow.com/users/1414327/asnad-atta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529999463, "creation_date": 1529995222, "last_edit_date": 1529999463, "question_id": 51036383, "link": "https://stackoverflow.com/questions/51036383/action-cable-connection-issue-on-rails-5-0-6", "title": "Action Cable connection issue on rails 5.0.6", "body": "<p>I'm following <a href=\"http://guides.rubyonrails.org/v5.0/action_cable_overview.html\" rel=\"nofollow noreferrer\"> rails 5.0 guide</a> to configure action cable but I'm getting error on action cable connection here are contents of application.js</p>\n\n<pre><code>//= require cable\n//= require_tree ./cable\n</code></pre>\n\n<p>I am getting following error.</p>\n\n<pre><code>WebSocket connection to 'ws://localhost:3000/cable' failed: Error during WebSocket handshake: Unexpected response code: 500\n</code></pre>\n\n<p>but if I add this in development.rb</p>\n\n<pre><code> config.action_cable.url = 'ws://localhost:28080'\n</code></pre>\n\n<p>and I also need to run</p>\n\n<pre><code>bundle exec puma -p 28080 cable/config.ru\n</code></pre>\n\n<p>everything starts working. but why I need to todo all these why connection is not establishing on default url.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "active-model-serializers"], "comments": [{"owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 1, "creation_date": 1529991631, "post_id": 51035413, "comment_id": 89062919, "body": "In <code>config&#47;initializers&#47;active_model_serializer.rb</code> file add <code>ActiveModel::Serializer.config.default_includes = &#39;**&#39; </code>"}, {"owner": {"reputation": 369, "user_id": 4018622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002223418893/picture?type=large", "display_name": "\u0414\u0430\u043d\u0438\u044d\u043b\u044c \u0421\u0430\u0439\u0444\u0443\u043b\u0438\u043d", "link": "https://stackoverflow.com/users/4018622/%d0%94%d0%b0%d0%bd%d0%b8%d1%8d%d0%bb%d1%8c-%d0%a1%d0%b0%d0%b9%d1%84%d1%83%d0%bb%d0%b8%d0%bd"}, "reply_to_user": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "edited": false, "score": 0, "creation_date": 1529992009, "post_id": 51035413, "comment_id": 89063045, "body": "Emy Thanks a lot! It&#39;s help me"}], "answers": [{"tags": [], "owner": {"reputation": 5242, "user_id": 3083848, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/JMddU.jpg?s=128&g=1", "display_name": "Emu", "link": "https://stackoverflow.com/users/3083848/emu"}, "is_accepted": true, "score": 2, "last_activity_date": 1529993215, "creation_date": 1529993215, "answer_id": 51035898, "question_id": 51035413, "link": "https://stackoverflow.com/questions/51035413/how-to-get-nested-attributes-using-active-model-serializers/51035898#51035898", "title": "How to get nested attributes using active_model_serializers", "body": "<p>In <code>config/initializers/active_model_serializer.rb</code> file add <code>ActiveModel::Serializer.config.default_includes = '**'</code></p>\n"}], "owner": {"reputation": 369, "user_id": 4018622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100002223418893/picture?type=large", "display_name": "\u0414\u0430\u043d\u0438\u044d\u043b\u044c \u0421\u0430\u0439\u0444\u0443\u043b\u0438\u043d", "link": "https://stackoverflow.com/users/4018622/%d0%94%d0%b0%d0%bd%d0%b8%d1%8d%d0%bb%d1%8c-%d0%a1%d0%b0%d0%b9%d1%84%d1%83%d0%bb%d0%b8%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 51035898, "answer_count": 1, "score": 0, "last_activity_date": 1529993215, "creation_date": 1529990801, "question_id": 51035413, "link": "https://stackoverflow.com/questions/51035413/how-to-get-nested-attributes-using-active-model-serializers", "title": "How to get nested attributes using active_model_serializers", "body": "<p>I using <strong>active_model_serializers</strong> gem, and I need to get nested attributes of <strong>Service</strong> model</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :subcategories\nend\n\nclass Subcategory &lt; ActiveRecord::Base\n  has_many :services\nend\n\nclass Service &lt; ActiveRecord::Base\n  belongs_to :subcategory\nend\n</code></pre>\n\n<p>Serializers:</p>\n\n<pre><code>class CategorySerializer &lt; ActiveModel::Serializer\n  attributes :id, :title\n\n  has_many   :subcategories,      serializer: SubcategorySerializer\nend\n\nclass SubcategorySerializer &lt; ActiveModel::Serializer\n  attributes :id, :title\n\n  has_many   :services,      serializer: SubcategorySerializer\nend\n\nclass ServiceSerializer &lt; ActiveModel::Serializer\n  attributes :id, :title\nend\n</code></pre>\n\n<p>Category Controller:</p>\n\n<pre><code>class CategoriesController &lt; BaseController\n  def index\n    categories = Category.all\n\n    render json: categories, each_serializer: CategorySerializer\n  end\nend\n</code></pre>\n\n<p>Category serializers don't return nested attributes of <strong>Service</strong> model.</p>\n\n<pre><code>{\n        \"id\": 1,\n        \"title\": \"Category 1\",\n        \"subcategories\": [\n            {\n                \"id\": 1,\n                \"title\": \"Sub category 1\"\n            },\n            {\n                \"id\": 2,\n                \"title\": \"Sub category 2\"\n            }\n    ]\n  }\n</code></pre>\n\n<p>I need to get json result with nested Service model in subcategory\nI using <strong>active_model_serializers (~> 0.10.2)</strong> \nHow do that?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "google-app-engine", "app-engine-flexible"], "comments": [{"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530021882, "post_id": 51035335, "comment_id": 89080816, "body": "When you say <i>...w/ the standard Ruby runtime...</i>, what do you mean? Can you please start with this <a href=\"https://cloud.google.com/ruby/rails/appengine#set_up_an_app_engine_flexible_environment_app\" rel=\"nofollow noreferrer\">tutorial</a> and see if it works?"}, {"owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "reply_to_user": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530027041, "post_id": 51035335, "comment_id": 89084216, "body": "Hi there, thats exactly what I did and got this problem on the other side. Adding my app.yaml to question."}, {"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530028819, "post_id": 51035335, "comment_id": 89085281, "body": "In the app.yaml there is also a section like this:                                                                   <code>env_variables:         SECRET_KEY_BASE:  some-generated-key</code>                                                                    I think it would be better for you if you follow the tutorial in <a href=\"https://cloud.google.com/ruby/rails/appengine\" rel=\"nofollow noreferrer\">this link</a>. I see an <code>app.yaml</code> similar to the one you show in <a href=\"https://cloud.google.com/appengine/docs/flexible/ruby/runtime\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/flexible/ruby/runtime</a> but this is only an overview of the runtime."}, {"owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "reply_to_user": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530031797, "post_id": 51035335, "comment_id": 89086865, "body": "Hi Victor, I have that section as well, but for obvious reasons I left that out. As mentioned, I followed the tutorial you linked to and this was the result of running gcloud app deploy."}, {"owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "reply_to_user": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 1, "creation_date": 1530031885, "post_id": 51035335, "comment_id": 89086914, "body": "FWIW rackup did work, the puma change did not, sorry I realize I didn&#39;t mention that. My mistake. I saw that for rack systems but wasn&#39;t sure that was the best idea for an actual rails project."}, {"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530034593, "post_id": 51035335, "comment_id": 89088326, "body": "I am glad it worked. Please post it as an answer so that the community can benefit from that example :-)"}, {"owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "reply_to_user": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530159924, "post_id": 51035335, "comment_id": 89138662, "body": "Hey so actually I retried this as discussed and it has the exact same error...not working for me."}, {"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530193895, "post_id": 51035335, "comment_id": 89157705, "body": "Your issue is very similar to this <a href=\"https://stackoverflow.com/questions/40386726/ruby-on-rails-usr-bin-env-ruby2-3-no-such-file-or-directory\" title=\"ruby on rails usr bin env ruby2 3 no such file or directory\">stackoverflow.com/questions/40386726/&hellip;</a> Try the solutions suggested there please"}, {"owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "reply_to_user": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530240161, "post_id": 51035335, "comment_id": 89175238, "body": "Hi Victor, how would that work in appengine exactly? It runs fine locally so I don&#39;t think this would help. Agreed it does sound familiar. I filed a bug with the appengine Ruby-docker project to see if they have any guidance."}, {"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1530517359, "post_id": 51035335, "comment_id": 89247101, "body": "I haven&#39;t been able to reproduce your issue. What you have done (Opening the <a href=\"https://github.com/GoogleCloudPlatform/ruby-docker/issues/150\" rel=\"nofollow noreferrer\">issue in github</a>) is the best thing to do in this case."}], "answers": [{"comments": [{"owner": {"reputation": 1935, "user_id": 2650325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1SJPZ.jpg?s=128&g=1", "display_name": "Victor M Herasme Perez", "link": "https://stackoverflow.com/users/2650325/victor-m-herasme-perez"}, "edited": false, "score": 0, "creation_date": 1531823589, "post_id": 51146005, "comment_id": 89729823, "body": "I think you can accept you own answer and the community will know the case is solved."}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1544805720, "post_id": 51146005, "comment_id": 94418862, "body": "Do you know how the system pulled <code>ruby2.5</code> ? I&#39;m hitting the same issue on a docker image and <code>which ruby</code> returns just fine. Not sure where the string <code>ruby2.5</code> is coming from."}, {"owner": {"reputation": 12955, "user_id": 147390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?s=128&d=identicon&r=PG", "display_name": "Schneems", "link": "https://stackoverflow.com/users/147390/schneems"}, "edited": false, "score": 0, "creation_date": 1544806088, "post_id": 51146005, "comment_id": 94419043, "body": "Looks like <code>which ruby</code> is symlinked to a <code>ruby2.5</code> file <a href=\"https://gist.github.com/schneems/c62fc2359983b57d3e27166ed23432f6\" rel=\"nofollow noreferrer\">gist.github.com/schneems/c62fc2359983b57d3e27166ed23432f6</a>"}], "tags": [], "owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "is_accepted": false, "score": 2, "last_activity_date": 1530586288, "creation_date": 1530586288, "answer_id": 51146005, "question_id": 51035335, "link": "https://stackoverflow.com/questions/51035335/appengine-flexible-ruby-environment-application-startup-error-usr-bin-env-r/51146005#51146005", "title": "AppEngine Flexible Ruby environment, application startup error: /usr/bin/env: &#39;ruby2.5&#39;: No such file or directory", "body": "<p>OK I now see what has happened after debugging the docker image locally. Because I was on ubuntu and had used system ruby to install gems it had embedded <code>/usr/bin/env ruby2.5</code> into every executable script that was bundled into my app. I deleted all gems and switched to rbenv for managing Ruby version which mitigated this odd behavior between unbuntu's ruby and my app.</p>\n"}], "owner": {"reputation": 21, "user_id": 9992394, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ICFNTd3fxsE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3xnbUysr3_WUsbQ52R-z2cXNpT2A/mo/photo.jpg?sz=128", "display_name": "Dee", "link": "https://stackoverflow.com/users/9992394/dee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530586288, "creation_date": 1529990240, "last_edit_date": 1530160207, "question_id": 51035335, "link": "https://stackoverflow.com/questions/51035335/appengine-flexible-ruby-environment-application-startup-error-usr-bin-env-r", "title": "AppEngine Flexible Ruby environment, application startup error: /usr/bin/env: &#39;ruby2.5&#39;: No such file or directory", "body": "<p>I'm trying to deploy an API-only Rails 5 application to AppEngine Flex w/ the standard Ruby runtime, and I'm getting the following error at the very end:</p>\n\n<pre><code>Updating service [default] (this may take several minutes)...failed.                                                                                                                                                                                                                         \nERROR: (gcloud.app.deploy) Error Response: [9] \nApplication startup error:\n/usr/bin/env: 'ruby2.5': No such file or directory\n</code></pre>\n\n<p>I'm specifying ruby '2.5.1' in my Gemfile and I've added an explicit <code>.ruby-version</code> file to the root of my project set to 2.5.1 as well.</p>\n\n<p>I have no other debugging information available to me in the logs, no other fancieness. My entrypoint command is:</p>\n\n<pre><code>bundle exec rails server Puma -p $PORT\n</code></pre>\n\n<p>I can provide more details if needed, not sure what else might be relevant. Any pointers? As far as I can tell, nothing on my side is asking for a version of ruby that specifically at execution time.</p>\n\n<p>Thanks!</p>\n\n<p>EDIT: Here's my app.yaml file</p>\n\n<pre><code>entrypoint: bundle exec rails server Puma -p $PORT\nenv: flex\nruntime: ruby\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I can verify that I'm having similar problems when trying to exec rake tasks like db:migrate:</p>\n\n<pre><code>--------- EXECUTE COMMAND ----------\nbundle exec rake db:migrate\n/usr/bin/env: 'ruby2.5': No such file or directory\nERROR\nERROR: build step 0 \"gcr.io/google-appengine/exec-wrapper:latest\" failed: exit status 127\n--------------------------------------------------------------------------------------------------------------------------------------------------------\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql"], "answers": [{"comments": [{"owner": {"reputation": 4699, "user_id": 135396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/facd50da56ab9a8742fa720c64255075?s=128&d=identicon&r=PG", "display_name": "skalb", "link": "https://stackoverflow.com/users/135396/skalb"}, "edited": false, "score": 1, "creation_date": 1530032176, "post_id": 51036445, "comment_id": 89087083, "body": "Right, as mentioned, this isn&#39;t the actual code, just a similar example. I don&#39;t think a Rails validation would help here since due to concurrency the exception could still be raised: <a href=\"http://api.rubyonrails.org/v5.0/classes/ActiveRecord/Validations/ClassMethods.html#method-i-validates_uniqueness_of\" rel=\"nofollow noreferrer\">api.rubyonrails.org/v5.0/classes/ActiveRecord/Validations/&hellip;</a>"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1530033894, "post_id": 51036445, "comment_id": 89087977, "body": "You might want to read the guide you linked to more carefully, the &quot;you must create a unique index on that column in your database&quot; in particular. Uniqueness validations are never enough."}, {"owner": {"reputation": 4699, "user_id": 135396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/facd50da56ab9a8742fa720c64255075?s=128&d=identicon&r=PG", "display_name": "skalb", "link": "https://stackoverflow.com/users/135396/skalb"}, "edited": false, "score": 0, "creation_date": 1530036688, "post_id": 51036445, "comment_id": 89089362, "body": "Yes, this is exactly how it is setup. The unique index/constraint is what raises the PG:UniqueViolation mentioned in the question due to concurrent requests."}], "tags": [], "owner": {"reputation": 195, "user_id": 9241438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/024ae9f1a10f89fe07ea3e4fc4b00803?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Schneider", "link": "https://stackoverflow.com/users/9241438/jay-schneider"}, "is_accepted": false, "score": 0, "last_activity_date": 1529997430, "last_edit_date": 1529997430, "creation_date": 1529995493, "answer_id": 51036445, "question_id": 51035129, "link": "https://stackoverflow.com/questions/51035129/handling-unique-constraint-exceptions-inside-transaction/51036445#51036445", "title": "Handling unique constraint exceptions inside transaction", "body": "<p>You should have the associations properly set inside your models, so rails does the validation for you. Then you can simply rescue the possible <code>ActiveRecord::RecordInvalid</code> (with message <code>Validation failed:</code> <em>Attribute</em> <code>has already been taken</code>).</p>\n\n<p>If you want to read some more about uniqueness validtion this should come in handy: <a href=\"http://guides.rubyonrails.org/active_record_validations.html#uniqueness\" rel=\"nofollow noreferrer\">http://guides.rubyonrails.org/active_record_validations.html#uniqueness</a></p>\n\n<p>To me it actually looks like your <code>Commenter</code> model is not really necessary. It just consists of derived information which can also be drawn directly from the <code>Comments</code> model (there you already store <code>post_id</code> and <code>user_id</code>) so you could drop the <code>Commenter</code> class entirely. Then take care to validate <code>Comment</code> on creation by for example setting</p>\n\n<pre><code>class Comment\n belongs_to :post\n belongs_to :user\n validates :user_id, uniqueness: {scope: :post_id}\nend\n</code></pre>\n\n<p>But this way you would allow a user to comment only once.</p>\n\n<p>I propose you drop the uniqueness constraint and construct the information stored in <code>Commenter</code> by making <code>distinct</code> selects on the <code>Comment</code> model.</p>\n\n<p>PS: Models in rails are written in Uppercase and singular while tables are referred to (by symbols) in lowercase and plural.</p>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": false, "score": 1, "last_activity_date": 1530231971, "creation_date": 1530231971, "answer_id": 51092744, "question_id": 51035129, "link": "https://stackoverflow.com/questions/51035129/handling-unique-constraint-exceptions-inside-transaction/51092744#51092744", "title": "Handling unique constraint exceptions inside transaction", "body": "<p>An exception raised inside the transaction does two things:</p>\n\n<ol>\n<li>Rolls back the transaction so none of the changes made inside the transaction will persist in the database.</li>\n<li>The exception propagates outside the transaction block.</li>\n</ol>\n\n<p>So you can move your exception handler outside the <code>transaction</code> call:</p>\n\n<pre><code>begin\n  ActiveRecord::Base.transaction do\n    Comment.create!(post: post, user: user, comment_text: '...')\n    Commenters.find_or_create_by!(post: post, user: user)\n  end\nrescue PG::UniqueViolation\n  retry\nend\n</code></pre>\n\n<p>You could include a counter to only retry a few times if you wanted more safety.</p>\n"}], "owner": {"reputation": 4699, "user_id": 135396, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/facd50da56ab9a8742fa720c64255075?s=128&d=identicon&r=PG", "display_name": "skalb", "link": "https://stackoverflow.com/users/135396/skalb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1620, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530231971, "creation_date": 1529988874, "question_id": 51035129, "link": "https://stackoverflow.com/questions/51035129/handling-unique-constraint-exceptions-inside-transaction", "title": "Handling unique constraint exceptions inside transaction", "body": "<p>I have two Rails models / tables that I want insert as part of transaction.</p>\n\n<p>For example, here are roughly my tables:</p>\n\n<ul>\n<li>Posts: (id) </li>\n<li>Comments: (id, post_id, comment_text, user_id)</li>\n<li>Commenters: (id, post_id, user_id), unique constraint on (post_id,\nuser_id)</li>\n</ul>\n\n<p>Right now I'm trying approximately equivalent to:</p>\n\n<pre><code>ActiveRecord::Base.transaction do\n  Comment.create!(post: post, user: user, comment_text: '...')\n\n  begin\n    Commenters.find_or_create_by!(post: post, user: user)\n  rescue PG::UniqueViolation\n  end\nend\n</code></pre>\n\n<p>This works 99.9% of time, but sometimes two concurrent comments will trigger a PG::UniqueViolation.</p>\n\n<p>Even though I'm catching and suppressing the PG::UniqueViolation, the entire transaction fails due to:</p>\n\n<p><strong>ERROR:  current transaction is aborted, commands ignored until end of transaction block</strong></p>\n\n<p>I realize I could already achieve this by joining Post and Comment table, but this is a simplified example.</p>\n\n<p>Is there a simpler way to ensure both inserts happen as part of a transaction while still ignoring the unique violation since we can assume that the record already exists?</p>\n"}, {"tags": ["ruby", "heroku", "dokku"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 10110310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd22075e61dc2bb97a9526afde2a71f4?s=128&d=identicon&r=PG&f=1", "display_name": "MiCg", "link": "https://stackoverflow.com/users/10110310/micg"}, "is_accepted": true, "score": 1, "last_activity_date": 1532093886, "creation_date": 1532093886, "answer_id": 51443815, "question_id": 51034875, "link": "https://stackoverflow.com/questions/51034875/dokku-unable-to-download-buildpack/51443815#51443815", "title": "Dokku unable to download buildpack", "body": "<p>The error here is indeed fairly cryptic. And I also had to do a lot of searching to find the solution to this.</p>\n\n<p>But the solution is fairly simple once you find it. In your server instance (where dokku is deployed), execute these two following commands:</p>\n\n<pre><code>dokku config:set --global CURL_TIMEOUT=1200\n\ndokku config:set --global CURL_CONNECT_TIMEOUT=180\n</code></pre>\n\n<p>The curl command trying to download the buildpacks aren't getting enough time to execute. We simply give them a little extra time. This should solve your problem.</p>\n\n<p>I originally found these commands here: <a href=\"https://github.com/dokku/dokku/blob/master/docs/deployment/methods/buildpacks.md\" rel=\"nofollow noreferrer\">https://github.com/dokku/dokku/blob/master/docs/deployment/methods/buildpacks.md</a></p>\n"}], "owner": {"reputation": 3833, "user_id": 5250620, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/viaIW.jpg?s=128&g=1", "display_name": "Haha TTpro", "link": "https://stackoverflow.com/users/5250620/haha-ttpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 51443815, "answer_count": 1, "score": 2, "last_activity_date": 1532093886, "creation_date": 1529987151, "question_id": 51034875, "link": "https://stackoverflow.com/questions/51034875/dokku-unable-to-download-buildpack", "title": "Dokku unable to download buildpack", "body": "<p>I deploy my ruby app on Dokku <br> \nHowever, seem that Dokku cannot fetch the url. <br> \nHow can I fix ? <br>\nThank you. </p>\n\n<pre><code>\u279c  world_cup_json git:(tdev) git push dokku tdev:master\nperl: warning: Setting locale failed.\nperl: warning: Please check that your locale settings:\n    LANGUAGE = (unset),\n    LC_ALL = (unset),\n    LC_PAPER = \"vi_VN\",\n    LC_ADDRESS = \"vi_VN\",\n    LC_MONETARY = \"vi_VN\",\n    LC_NUMERIC = \"vi_VN\",\n    LC_TELEPHONE = \"vi_VN\",\n    LC_IDENTIFICATION = \"vi_VN\",\n    LC_MEASUREMENT = \"vi_VN\",\n    LC_CTYPE = \"en_US.UTF-8\",\n    LC_TIME = \"vi_VN\",\n    LC_NAME = \"vi_VN\",\n    LANG = \"en_US.UTF-8\"\n    are supported and installed on your system.\nperl: warning: Falling back to a fallback locale (\"en_US.UTF-8\").\nCounting objects: 2584, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (1009/1009), done.\nWriting objects: 100% (2584/2584), 4.34 MiB | 0 bytes/s, done.\nTotal 2584 (delta 1525), reused 2536 (delta 1498)\n-----&gt; Cleaning up...\n-----&gt; Building world-cup-json from herokuish...\n-----&gt; Adding BUILD_ENV to build environment...\n-----&gt; Ruby app detected\n       Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 90 --max-time 60 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/cedar-14/ruby-2.3.4.tgz -s -o - | tar zxf - ' failed on attempt 1 of 3.\n       Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 90 --max-time 60 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/cedar-14/ruby-2.3.4.tgz -s -o - | tar zxf - ' failed on attempt 2 of 3.\nremote: /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/shell_helpers.rb:58:in `block in run!': Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 90 --max-time 60 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/cedar-14/ruby-2.3.4.tgz -s -o - | tar zxf - ' failed unexpectedly: (LanguagePack::Fetcher::FetchError)\nremote: \nremote: gzip: stdin: invalid compressed data--format violated\nremote: tar: Unexpected EOF in archive\nremote: tar: Unexpected EOF in archive\nremote: tar: Error is not recoverable: exiting now\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/shell_helpers.rb:52:in `times'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/shell_helpers.rb:52:in `run!'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/fetcher.rb:24:in `fetch_untar'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/installers/heroku_ruby_installer.rb:22:in `block in fetch_unpack'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/installers/heroku_ruby_installer.rb:16:in `chdir'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/lib/language_pack/installers/heroku_ruby_installer.rb:16:in `fetch_unpack'\nremote:     from /tmp/buildpacks/01_buildpack-ruby/bin/support/download_ruby:14:in `&lt;main&gt;'\nremote: &lt;internal:gem_prelude&gt;:4:in `require': cannot load such file -- rubygems.rb (LoadError)\nremote:     from &lt;internal:gem_prelude&gt;:4:in `&lt;internal:gem_prelude&gt;'\nTo dokku@206.189.84.191:world-cup-json\n ! [remote rejected] tdev -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'dokku@206.189.84.191:world-cup-json'\n</code></pre>\n"}, {"tags": ["ruby", "logging", "dokku"], "answers": [{"tags": [], "owner": {"reputation": 3833, "user_id": 5250620, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/viaIW.jpg?s=128&g=1", "display_name": "Haha TTpro", "link": "https://stackoverflow.com/users/5250620/haha-ttpro"}, "is_accepted": true, "score": 0, "last_activity_date": 1529988722, "creation_date": 1529988722, "answer_id": 51035102, "question_id": 51034649, "link": "https://stackoverflow.com/questions/51034649/dokku-cannot-see-log-applications-container-not-found/51035102#51035102", "title": "Dokku cannot see log, &quot;Application&#39;s container not found&quot;", "body": "<p><strong>Solved</strong> <br>\nWe can see logs once the apps is deployed (deployed successfully). My apps is not deploy yet so I cannot see log. </p>\n"}], "owner": {"reputation": 3833, "user_id": 5250620, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/viaIW.jpg?s=128&g=1", "display_name": "Haha TTpro", "link": "https://stackoverflow.com/users/5250620/haha-ttpro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 51035102, "answer_count": 1, "score": 0, "last_activity_date": 1529988722, "creation_date": 1529985366, "question_id": 51034649, "link": "https://stackoverflow.com/questions/51034649/dokku-cannot-see-log-applications-container-not-found", "title": "Dokku cannot see log, &quot;Application&#39;s container not found&quot;", "body": "<p>I am deploying my app on dokku. I have not yet deploy successfully because error in deployment step. I want to see log but Dokku said that \"Application's container not found\" </p>\n\n<pre><code>root@dokku-s-1vcpu-3gb-sgp1-01:~# dokku apps:list\n=====&gt; My Apps\nworld_cup_json\nroot@dokku-s-1vcpu-3gb-sgp1-01:~# dokku logs world_cup_json\nApplication's container not found\n</code></pre>\n"}, {"tags": ["ruby", "watir"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1529989533, "post_id": 51034513, "comment_id": 89062270, "body": "<code>Watir</code> must be capitalized - ie <code>driver = Watir::Browser.new</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9986626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fbfe612aa204b91964142336cca248?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Pinto", "link": "https://stackoverflow.com/users/9986626/cesar-pinto"}, "edited": false, "score": 0, "creation_date": 1530047112, "post_id": 51042758, "comment_id": 89093721, "body": "Sorry but now I get new error. irb(main):001:0&gt; driver = Watir::Browser.new :chrome NameError: uninitialized constant Watir         from (irb):1         from C:/Ruby24-x64/bin/irb.cmd:19:in `&lt;main&gt;&#39;"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 11, "user_id": 9986626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fbfe612aa204b91964142336cca248?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Pinto", "link": "https://stackoverflow.com/users/9986626/cesar-pinto"}, "edited": false, "score": 1, "creation_date": 1530076130, "post_id": 51042758, "comment_id": 89100442, "body": "@CesarPinto, you need to tell Ruby to include the Watir gem. Add <code>require &quot;watir&quot;</code> as the first line."}, {"owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "reply_to_user": {"reputation": 11, "user_id": 9986626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fbfe612aa204b91964142336cca248?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Pinto", "link": "https://stackoverflow.com/users/9986626/cesar-pinto"}, "edited": false, "score": 0, "creation_date": 1530259638, "post_id": 51042758, "comment_id": 89181784, "body": "@CesarPinto - did this help in the end?"}], "tags": [], "owner": {"reputation": 8640, "user_id": 4055042, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cd04c63d95d27033b53d4d83fea40c02?s=128&d=identicon&r=PG&f=1", "display_name": "SRack", "link": "https://stackoverflow.com/users/4055042/srack"}, "is_accepted": false, "score": 0, "last_activity_date": 1530119364, "last_edit_date": 1530119364, "creation_date": 1530015476, "answer_id": 51042758, "question_id": 51034513, "link": "https://stackoverflow.com/questions/51034513/nameerror-undefined-local-variable-or-method-watir-for-mainobject/51042758#51042758", "title": "NameError: undefined local variable or method `watir&#39; for main:Object", "body": "<p>It looks like you're attempting to access a nested class, which should refer to capitalised variable names:</p>\n\n<pre><code>driver = Watir::Browser.new :chrome\n</code></pre>\n\n<p>By using the lowercase <code>watir</code>, you're looking for a variable <code>watir</code> defined in the local scope. You could, for instance, be storing the top level class / module in a variable:</p>\n\n<pre><code>watir = Watir\n</code></pre>\n\n<p>And then call the code as you have it, though that's pointless and an antipattern.</p>\n\n<p>Capitalise the first letter as above, and this should work for you.</p>\n\n<p>Edit: as Justin Ko pointed out, it sounds like that is now looking for the correct class, though it needs to be available to the file. Add this to the top and everything should work:</p>\n\n<pre><code>require 'watir'\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9986626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fbfe612aa204b91964142336cca248?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Pinto", "link": "https://stackoverflow.com/users/9986626/cesar-pinto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1565089964, "creation_date": 1529984157, "last_edit_date": 1565089964, "question_id": 51034513, "link": "https://stackoverflow.com/questions/51034513/nameerror-undefined-local-variable-or-method-watir-for-mainobject", "title": "NameError: undefined local variable or method `watir&#39; for main:Object", "body": "<p>I am using the following code in irb:</p>\n\n<pre><code>irb(main):002:0&gt;driver = watir::Browser.new :chrome\n</code></pre>\n\n<p>But it gives me this error:</p>\n\n<pre><code>NameError: undefined local variable or method `watir' for main:Object\n        from (irb):2\n        from C:/Ruby24-x64/bin/irb.cmd:19:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "google-cloud-firestore"], "answers": [{"comments": [{"owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "edited": false, "score": 0, "creation_date": 1529983033, "post_id": 51034354, "comment_id": 89060789, "body": "Thanks for that, it seems odd that they biggest reason for a real-time database (realtime listeners) is not supported on the different API&#39;s, I hope that it is coming soon or if that someone is aware of a work around"}, {"owner": {"reputation": 594, "user_id": 5051165, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-GwtWi5OOBvs/AAAAAAAAAAI/AAAAAAAAfsg/kqASETNy-G4/photo.jpg?sz=128", "display_name": "Matt Welke", "link": "https://stackoverflow.com/users/5051165/matt-welke"}, "reply_to_user": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "edited": false, "score": 0, "creation_date": 1549325593, "post_id": 51034354, "comment_id": 95854543, "body": "@DavidCruwys FYI, as of now, they support realtime listeners in Ruby and most languages with GCP client libraries. According to their docs, it&#39;s just PHP they&#39;re missing support for realtime listeners right now."}], "tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": false, "score": 1, "last_activity_date": 1529982707, "creation_date": 1529982707, "answer_id": 51034354, "question_id": 51033837, "link": "https://stackoverflow.com/questions/51033837/firestore-for-ruby-how-to-subscribe-to-document-changes/51034354#51034354", "title": "FireStore for Ruby - How to subscribe to document changes", "body": "<p>When I look at the <a href=\"https://firebase.google.com/docs/firestore/query-data/listen\" rel=\"nofollow noreferrer\">Cloud Firestore documentation for Firebase for getting realtime updates</a> it says the following: </p>\n\n<blockquote>\n  <p>Note: Realtime listeners are <strong>not yet supported</strong> in the C#, Go, PHP, Python or <strong>Ruby</strong> client libraries.</p>\n</blockquote>\n\n<p>So it looks like realtime updates/subscriptions are not yet supported in Ruby.</p>\n"}, {"tags": [], "owner": {"reputation": 494, "user_id": 4331770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b347adb5c7ada59a0a764968983b07be?s=128&d=identicon&r=PG&f=1", "display_name": "velsim", "link": "https://stackoverflow.com/users/4331770/velsim"}, "is_accepted": false, "score": 1, "last_activity_date": 1549672079, "creation_date": 1549672079, "answer_id": 54601997, "question_id": 51033837, "link": "https://stackoverflow.com/questions/51033837/firestore-for-ruby-how-to-subscribe-to-document-changes/54601997#54601997", "title": "FireStore for Ruby - How to subscribe to document changes", "body": "<p>This feature has been recently added to the fire-store client library. </p>\n\n<p>You can use DocumentReference#listen to listen to changes in the document </p>\n\n<pre><code>require \"google/cloud/firestore\"\n\nfirestore = Google::Cloud::Firestore.new\n\n# Get a document reference\nnyc_ref = firestore.doc \"cities/NYC\"\n\nlistener = nyc_ref.listen do |snapshot|\n  puts \"The population of #{snapshot[:name]} \"\n  puts \"is #{snapshot[:population]}.\"\nend\n\n# When ready, stop the listen operation and close the stream.\nlistener.stop\n</code></pre>\n"}], "owner": {"reputation": 4763, "user_id": 473923, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/VCdUV.jpg?s=128&g=1", "display_name": "David Cruwys", "link": "https://stackoverflow.com/users/473923/david-cruwys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1549672079, "creation_date": 1529977648, "last_edit_date": 1529981420, "question_id": 51033837, "link": "https://stackoverflow.com/questions/51033837/firestore-for-ruby-how-to-subscribe-to-document-changes", "title": "FireStore for Ruby - How to subscribe to document changes", "body": "<p>I would like to subscribe to changes in a firestore document in ruby using the <a href=\"https://googlecloudplatform.github.io/google-cloud-ruby/#/docs/google-cloud-firestore/v0.21.1/google/cloud/firestore/documentreference\" rel=\"nofollow noreferrer\">Firestore API for Ruby</a> </p>\n\n<p>I can get a document reference and data using the following code, but not sure how to subscribe to changes</p>\n\n<pre><code># Firestore API\nfirestore = Google::Cloud::Firestore.new(project_id: 'project_id', credentials: './google-cloud-key.json')\n\n# Get a reference to a document\nref = firestore.collection('collection_name').doc('id')\n\n# Get the actual data in the document\nsnapshot = ref.get\n\ndata = snapshot.exists? ? snapshot.data : nil\n\n# From this point on, how can I subscribe to changes in the document?\n</code></pre>\n"}, {"tags": ["ruby", "string"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1529972799, "post_id": 51033345, "comment_id": 89058867, "body": "You&#39;re going to need to format this properly. This code is exceedingly unreadable."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 5, "creation_date": 1529973799, "post_id": 51033345, "comment_id": 89059074, "body": "You spelled <code>initialize</code> incorrectly."}, {"owner": {"reputation": 774, "user_id": 2910269, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5967fdca312abdf687d6353304672f46?s=128&d=identicon&r=PG&f=1", "display_name": "MSB", "link": "https://stackoverflow.com/users/2910269/msb"}, "edited": false, "score": 0, "creation_date": 1529976261, "post_id": 51033345, "comment_id": 89059553, "body": "Hi there and welcome to SO, formulating a question that clearly states what you are trying to do and what went wrong will greatly help others help you."}, {"owner": {"reputation": 12464, "user_id": 1376448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f16da5431a99911ebc32093a28bc591?s=128&d=identicon&r=PG", "display_name": "kiddorails", "link": "https://stackoverflow.com/users/1376448/kiddorails"}, "edited": false, "score": 0, "creation_date": 1529981525, "post_id": 51033345, "comment_id": 89060517, "body": "<code>song.artist</code> wouldn&#39;t work either. <code>artist</code> is instance variable of <code>Song</code>. To access it that way, you will either have to add in <code>attr_reader</code> list or make getter method <code>def artist; @artist; end</code>"}, {"owner": {"reputation": 330, "user_id": 6482185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T11f0D1JFSw/AAAAAAAAAAI/AAAAAAAAAP0/6onfs__d2RE/photo.jpg?sz=128", "display_name": "Will Nguyen", "link": "https://stackoverflow.com/users/6482185/will-nguyen"}, "edited": false, "score": 0, "creation_date": 1529987401, "post_id": 51033345, "comment_id": 89061746, "body": "the method name is not correct: initilaize =&gt; initialize"}], "answers": [{"tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 2, "last_activity_date": 1529983217, "creation_date": 1529983217, "answer_id": 51034411, "question_id": 51033345, "link": "https://stackoverflow.com/questions/51033345/initialize-wrong-number-of-arguments-given-3-expected-0-argumenterror/51034411#51034411", "title": "initialize&#39;: wrong number of arguments (given 3, expected 0) (ArgumentError)", "body": "<p>Very simple.</p>\n\n<p>You spelled <code>initialize</code> as <code>initilaize</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9991644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de272ffec5d89c1660568e704aee643f?s=128&d=identicon&r=PG&f=1", "display_name": "Hammam Saleh", "link": "https://stackoverflow.com/users/9991644/hammam-saleh"}, "delete_vote_count": 2, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "closed_date": 1529988549, "answer_count": 1, "score": -7, "last_activity_date": 1529983217, "creation_date": 1529972364, "last_edit_date": 1529973663, "question_id": 51033345, "link": "https://stackoverflow.com/questions/51033345/initialize-wrong-number-of-arguments-given-3-expected-0-argumenterror", "closed_reason": "Not suitable for this site", "title": "initialize&#39;: wrong number of arguments (given 3, expected 0) (ArgumentError)", "body": "<pre><code>class Song\n  def initilaize(name,artist,duration)\n    @name=name\n    @artist=artist\n    @duration=duration \n  end\nend\n\nsong = Song.new(\"ruby\",\"Bicylops \" ,260)\nputs song.artist\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 1, "creation_date": 1529974507, "post_id": 51033078, "comment_id": 89059231, "body": "you don&#39;t need it, you&#39;re already joining <code>person</code> with this <code>@person.todays_books.by_title</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "is_accepted": false, "score": 0, "last_activity_date": 1529980074, "creation_date": 1529980074, "answer_id": 51034062, "question_id": 51033078, "link": "https://stackoverflow.com/questions/51033078/getting-model-attributes-from-belongs-to-on-scope/51034062#51034062", "title": "Getting model attributes from belongs_to on scope", "body": "<p>you are already looking for books that belongs to that person when you chain @person.todays_books, so what you are trying to do isn't necessary</p>\n"}], "owner": {"reputation": 1353, "user_id": 3255845, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/NlYHy.png?s=128&g=1", "display_name": "luke", "link": "https://stackoverflow.com/users/3255845/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1529980074, "creation_date": 1529969919, "question_id": 51033078, "link": "https://stackoverflow.com/questions/51033078/getting-model-attributes-from-belongs-to-on-scope", "title": "Getting model attributes from belongs_to on scope", "body": "<p>Say I have a <code>Person</code> model and a <code>Book</code>. A person belongs_to a book. </p>\n\n<p>I have this scope defined in my <code>Book</code> model:</p>\n\n<pre><code>belongs_to :person\n\nscope :by_title, -&gt;(title) do \n fake_query.where(title: title)\nend\n</code></pre>\n\n<p>Now when I use this scope,</p>\n\n<pre><code>@person = Person.first\n@person.todays_books.by_title('test-123').first\n</code></pre>\n\n<p>Basically how do I gain access to the <code>@person</code> attributes within the actual scope so I can do something like this:</p>\n\n<pre><code>scope :by_title, -&gt;(title) do\n fake_query.where(title: title, person_id: @person)\nend\n</code></pre>\n\n<p>I know I could pass it as an argument e.g. <code>-&gt;(title, @person)</code> but I know there is probably a better way to do it.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "synchronization", "chef-infra", "auto-update"], "comments": [{"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1529984637, "post_id": 51032781, "comment_id": 89061139, "body": "This mentioned grading, are you sure it&#39;s kosher to be asking for help on here?"}, {"owner": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "reply_to_user": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "edited": false, "score": 0, "creation_date": 1529985613, "post_id": 51032781, "comment_id": 89061353, "body": "@coderanger It\u2019s not \u2018Grading\u2019 in an academic sense, though I appreciate your consideration to the laws of kosher. That part of the spec is to show how the program is to be run and tested. That being said, might you have any questions/suggestions in the way of helping shine a light on a potential solution?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "edited": false, "score": 0, "creation_date": 1529990217, "post_id": 51034799, "comment_id": 89062438, "body": "Thanks for the thorough and informative response, coderanger! Glad to know I&#39;m not the only one that thinks this use case is a bit odd. Anyway, I first attempted splicing my original code with your suggestions but to no avail, so I tried using your full response instead (file paths and ownership aside) but am still not making any improvements. The text files neither update automatically nor after re-running <code>chef-apply multipleCopies.rb</code>. Is this how you meant for it to be implemented? <a href=\"https://gist.github.com/nckgrzn/3f1e3b8fdbf3d65fd9dc1294f71c46ed\" rel=\"nofollow noreferrer\">gist.github.com/nckgrzn/3f1e3b8fdbf3d65fd9dc1294f71c46ed</a>"}, {"owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "reply_to_user": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "edited": false, "score": 0, "creation_date": 1529992968, "post_id": 51034799, "comment_id": 89063431, "body": "1. you removed the file ownership management and the paths no longer match 2. no it would all be as one pass."}, {"owner": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "edited": false, "score": 0, "creation_date": 1529994164, "post_id": 51034799, "comment_id": 89063928, "body": "1. I removed file ownership because I&#39;m testing the recipe for correctness locally before passing it to the <code>ubuntu</code> server referenced. And the paths DO match, or are you seeing something I&#39;m not? 2. Not sure what you mean by &#39;one pass&#39;, but in regards to the other difference between your suggestion and my gist as well as what I suspect you might mean--a) I added the loop to your third portion of code because <code>n</code> is not assigned without it, b) and I cannot replace the <code>file</code> resource in the first portion with the third portion nor delete it or other vars will be called before assignment."}, {"owner": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "edited": false, "score": 0, "creation_date": 1530026356, "post_id": 51034799, "comment_id": 89083783, "body": "So I tweaked your <code>latest_file</code> line to return the single number of the most recently updated file instead of the array <code>[0,1,2]</code> (assuming that was your original intention) and re-spliced it into a new take on my original code where I hard-link the other files to the updated one, and it works! Well, after re-running the file execution command it works, though I get the sense they want the files to update automatically... Any further thoughts on that aspect of it? Thanks in advance. Here&#39;s my latest code: <a href=\"https://gist.github.com/nckgrzn/6e0064c6a6a475ab95ef5f4908b9fc03\" rel=\"nofollow noreferrer\">gist.github.com/nckgrzn/6e0064c6a6a475ab95ef5f4908b9fc03</a>"}], "tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1529986467, "creation_date": 1529986467, "answer_id": 51034799, "question_id": 51032781, "link": "https://stackoverflow.com/questions/51032781/keeping-files-updated-with-a-chef-recipe/51034799#51034799", "title": "Keeping files updated with a Chef recipe", "body": "<p>So a file hard link doesn't seem to be what the question is going for (though I would say your solution is maybe better since this is really not what Chef is for, more on that later). Instead they seem to want you to have three actually different files, but sync the contents.</p>\n\n<p>So first the easy parts, creating the directories and the empty initial files. It's rare to see those <code>for</code> loops used in Ruby code, though it is syntactically valid:</p>\n\n<pre><code>3.times do |n|\n  directory \"/var/save/multipleCopy#{n+1}\" do\n    owner \"ubuntu\"\n    group \"root\"\n    mode \"755\"\n  end\n\n  file \"/var/save/multipleCopy#{n+1}/secret.txt\" do\n    owner \"root\n    group \"root\"\n    mode \"755\"\n  end\nend\n</code></pre>\n\n<p>But that doesn't implement the hard part of sync'ing the files. For that we need to first analyze the mtimes on the files and use the most recent as the file content to set.</p>\n\n<pre><code>latest_file = 3.times.sort_by { |n| ::File.mtime(\"/var/save/multipleCopy#{n+1}/secret.txt\") rescue 0 }\nlatest_content = ::File.read(\"/var/save/multipleCopy#{latest_file+1}/secret.txt\") rescue nil\n</code></pre>\n\n<p>and then in the file resource:</p>\n\n<pre><code>  file \"/var/save/multipleCopy#{n+1}/secret.txt\" do\n    owner \"root\n    group \"root\"\n    mode \"755\"\n    content latest_content\n  end\n</code></pre>\n\n<p>As for this not being a good use of Chef: Chef is about writing code which asserts the desired state of the machine. In the case of files like this, rather than doing this kind of funky stuff to check if a file has been edited, you would just say that Chef owns the file content for all three and if you want to update it, you do it via your cookbook (and then usually use a <code>template</code> or <code>cookbook_file</code> resource).</p>\n"}], "owner": {"reputation": 35, "user_id": 9793973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osaB8.png?s=128&g=1", "display_name": "Foxhole", "link": "https://stackoverflow.com/users/9793973/foxhole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529991135, "creation_date": 1529967256, "last_edit_date": 1529991135, "question_id": 51032781, "link": "https://stackoverflow.com/questions/51032781/keeping-files-updated-with-a-chef-recipe", "title": "Keeping files updated with a Chef recipe", "body": "<p><img src=\"https://snag.gy/o4R2bY.jpg\" alt=\"challenge prompt\"></p>\n\n<p>The challenge prompt is above, and my latest attempt is below. The directories and files are created as expected, and the read-out after executing <code>chef-apply multipleCopies.rb</code> tells me the files are linked, but when I update any one of the files, the others do not follow suit. Any ideas? Here is my code:</p>\n\n<pre><code>for x in 1..3\n    directory \"multipleCopy#{x}\" do\n        mode '0755'\n        action :create\n    end\nend\nfile \"multipleCopy1/secret.txt\" do\n        mode '0755'\n        action :create\nend\nfor x in 2..3\n    link \"multipleCopy#{x}/secret.txt\" do\n        to \"multipleCopy1/secret.txt\"\n        link_type :hard\n        subscribes :reload, \"multipleCopy1/secret.txt\", :immediately\n    end\nend\n</code></pre>\n\n<p>Note: For less headache, I am testing the recipe locally before uploading to the <code>ubuntu</code> server referenced in the prompt, which is why my file paths are different and why I have not yet included the ownership properties.</p>\n"}, {"tags": ["javascript", "html", "ruby-on-rails", "ruby", "ruby-on-rails-3"], "answers": [{"comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1529985696, "post_id": 51033048, "comment_id": 89061369, "body": "We should ask why the OP wants to be mouse-hostile. The user should always have a choice..."}], "tags": [], "owner": {"reputation": 315, "user_id": 3353316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06415305d9cde1d13a60e2a615307d14?s=128&d=identicon&r=PG", "display_name": "Charith H", "link": "https://stackoverflow.com/users/3353316/charith-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1529969747, "creation_date": 1529969747, "answer_id": 51033048, "question_id": 51032776, "link": "https://stackoverflow.com/questions/51032776/searching-by-hitting-enter/51033048#51033048", "title": "Searching by hitting enter", "body": "<p>You can simple hide the button using css. <code>{display: none}</code>. But don't delete the button. (If you are using boostrap try adding <code>d-none</code> class to the submit button.) This will submit your form with enter key.</p>\n"}, {"tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": true, "score": 1, "last_activity_date": 1529987313, "creation_date": 1529987313, "answer_id": 51034892, "question_id": 51032776, "link": "https://stackoverflow.com/questions/51032776/searching-by-hitting-enter/51034892#51034892", "title": "Searching by hitting enter", "body": "<p>Can be done using jquery or javascript</p>\n\n<p>1 -> Provide a unique id to form and input field which will be submitted on hit enter</p>\n\n<pre><code> &lt;%= form_tag(search_path, method: :get, id: 'search_form') do %&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-5\"&gt;\n      &lt;%= text_field_tag :search, params[:search], placeholder: \"z.B. New York\", class: \"suchfeld\", id: \"autolocation\" %&gt;\n    &lt;/div&gt;    \n  &lt;/div&gt;\n  &lt;br/&gt;&lt;br/&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>2 -> Using jQuery  check if enter button is pressed, then submit this form</p>\n\n<pre><code>&lt;script&gt;\n$(document).ready(function() {\n  $('#autolocation').keydown(function(event) {\n    // enter has keyCode = 13\n    if (event.keyCode == 13) {\n      $('#search_form')submit(); // submit the form\n      return false;\n    }\n  });\n});\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9142978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 51034892, "answer_count": 2, "score": 0, "last_activity_date": 1529987313, "creation_date": 1529967225, "question_id": 51032776, "link": "https://stackoverflow.com/questions/51032776/searching-by-hitting-enter", "title": "Searching by hitting enter", "body": "<p>Right now i have a search field and right next to it a submit search button. \nBut want to delete the button so that the user can just hit enter. What do i need to change ?</p>\n\n<pre><code> &lt;%= form_tag search_path, method: :get do %&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-5\"&gt;\n      &lt;%= text_field_tag :search, params[:search], placeholder: \"z.B. New York\", class: \"suchfeld\", id: \"autolocation\" %&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-md-2\"&gt;\n        &lt;%= submit_tag \"Search\", class: \"btn btn-normal btn-block\" %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n  &lt;/div&gt;\n  &lt;br/&gt;&lt;br/&gt;\n\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "form-helpers"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529992904, "post_id": 51033740, "comment_id": 89063407, "body": "Unfortunately, that didn&#39;t work... Instances of &#39;Unassigned&#39; are pulled from the DB, but I&#39;d like to simply add a static placeholder that essentially prompts the user to select a location (yes, I&#39;ve already tried the <b>prompt: &#39;-- select location --&#39;</b> with no effect)"}], "tags": [], "owner": {"reputation": 2095, "user_id": 1172724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c430604dc066eec3ca657502c55a2c9b?s=128&d=identicon&r=PG", "display_name": "Shani", "link": "https://stackoverflow.com/users/1172724/shani"}, "is_accepted": false, "score": 0, "last_activity_date": 1529976636, "creation_date": 1529976636, "answer_id": 51033740, "question_id": 51032603, "link": "https://stackoverflow.com/questions/51032603/rails-f-select-with-a-default-value-but-a-different-place-holder/51033740#51033740", "title": "Rails f.select with a default value, but a different place holder", "body": "<p>try <code>include_blank: 'Select Location'</code></p>\n\n<pre><code>= f.select :training_location_id, grouped_options_for_select(grouped_location_options, current_provider.locations.where(name: 'Unassigned').map { |loc| loc.id }), include_blank: 'Select Location' , class: 'form-control'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529993133, "post_id": 51034601, "comment_id": 89063491, "body": "Unfortunately, that didn&#39;t work... Instances of &#39;Unassigned&#39; are pulled from the DB, but I&#39;d like to simply add a static placeholder that essentially prompts the user to select a location (yes, I&#39;ve already tried the <b>prompt: &#39;-- select location --&#39;</b> with no effect)"}], "tags": [], "owner": {"reputation": 442, "user_id": 8500089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIT6I.jpg?s=128&g=1", "display_name": "Rasna Shakya", "link": "https://stackoverflow.com/users/8500089/rasna-shakya"}, "is_accepted": false, "score": 0, "last_activity_date": 1529985004, "creation_date": 1529985004, "answer_id": 51034601, "question_id": 51032603, "link": "https://stackoverflow.com/questions/51032603/rails-f-select-with-a-default-value-but-a-different-place-holder/51034601#51034601", "title": "Rails f.select with a default value, but a different place holder", "body": "<p>Try this, this might work for you:</p>\n\n<pre><code>= f.select :training_location_id, grouped_options_for_select(grouped_location_options, current_provider.locations.where(name: 'Unassigned').map { |loc| loc.id }), data: { placeholder: 'Select Location' }, class: 'form-control'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529993164, "post_id": 51035173, "comment_id": 89063499, "body": "Unfortunately, that didn&#39;t work... Instances of &#39;Unassigned&#39; are pulled from the DB, but I&#39;d like to simply add a static placeholder that essentially prompts the user to select a location (yes, I&#39;ve already tried the <b>prompt: &#39;-- select location --&#39;</b> with no effect)  I wish I could post a picture to show what I&#39;m seeing on the front end!"}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529994720, "post_id": 51035173, "comment_id": 89064167, "body": "@kdubss Please check the updated answer , as mentioned in doc  <code>prompt</code> will be used as placeholder. let me know for further guidance."}, {"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529995934, "post_id": 51035173, "comment_id": 89064761, "body": "Just tested it out, now @Gabbar, and unfortunately...no dice."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1529998094, "post_id": 51035173, "comment_id": 89065961, "body": "@kdubss Not sure, why this is not working at your end, i have just tested it with following code sample:- <code>&lt;%grouped_options = {&#39;North America&#39; =&gt; [[&#39;United States&#39;,&#39;US&#39;],  &#39;Canada&#39;],&#39;Europe&#39; =&gt; [&#39;Denmark&#39;,&#39;Germany&#39;,&#39;France&#39;]} %&gt;</code>  <code>&lt;%=f.select :training_location_id, grouped_options_for_select(grouped_options, nil, {:prompt =&gt; &#39;-- Select Location --&#39;}),{class: &#39;form-control&#39;}%&gt;</code>  And it&#39;s showing a option of <code>-- select location --</code> you are missing something, can you try with this sample code.?"}, {"owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "edited": false, "score": 0, "creation_date": 1530024053, "post_id": 51035173, "comment_id": 89082289, "body": "Hi @Gabber!  I will certainly try again!  The thing I really want is to display a placeholder prompting the user to make a selection, <b>but</b>, I want the <b>default value to be set to &#39;Unassigned&#39;</b> just in case the user does not make a selection.  In this scenario, the people would be placed in the location &#39;Unassigned&#39;, whereas if the location was set to the placeholder string, the persons location assignment would be lost in limbo..."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1529994640, "last_edit_date": 1529994640, "creation_date": 1529989206, "answer_id": 51035173, "question_id": 51032603, "link": "https://stackoverflow.com/questions/51032603/rails-f-select-with-a-default-value-but-a-different-place-holder/51035173#51035173", "title": "Rails f.select with a default value, but a different place holder", "body": "<p>1- Instead of using map to get selected option use find_by or where</p>\n\n<pre><code> &lt;%=f.select :training_location_id, grouped_options_for_select(grouped_location_options, current_provider.locations.where(name: 'Unassigned').first.id, {:prompt =&gt; '-- Select Location --'}),{class: 'form-control'}%&gt;\n</code></pre>\n\n<p>Or</p>\n\n<pre><code> &lt;%=f.select :training_location_id, grouped_options_for_select(grouped_location_options, current_provider.locations.find_by(name: 'Unassigned').id, {:prompt =&gt; '-- Select Location --'}),{class: 'form-control'}%&gt;\n</code></pre>\n\n<p>References: = </p>\n\n<p><a href=\"http://api.rubyonrails.org/v5.2.0/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-grouped_options_for_select\" rel=\"nofollow noreferrer\">http://api.rubyonrails.org/v5.2.0/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-grouped_options_for_select</a></p>\n"}], "owner": {"reputation": 313, "user_id": 8921559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb80c4dd148cdf23e439fb3982bca855?s=128&d=identicon&r=PG&f=1", "display_name": "kdubss", "link": "https://stackoverflow.com/users/8921559/kdubss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1478, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1529994640, "creation_date": 1529965855, "question_id": 51032603, "link": "https://stackoverflow.com/questions/51032603/rails-f-select-with-a-default-value-but-a-different-place-holder", "title": "Rails f.select with a default value, but a different place holder", "body": "<p>I have this bit of code that produces a dropdown menu for me with a default value of Unassigned.</p>\n\n<p>But, what I'd like to do is to have a placeholder, <strong>Select Location</strong>, on the dropdown menu, although by default the value selected is 'Unassigned'</p>\n\n<p>Code:</p>\n\n<pre><code>= f.select :training_location_id, grouped_options_for_select(grouped_location_options, current_provider.locations.where(name: 'Unassigned').map { |loc| loc.id }), { placeholder: 'Select Location', include_blank: true }, class: 'form-control'\n</code></pre>\n\n<p>As you can see in the code, I'm setting a placeholder in the <strong>f.select</strong> { options }, but the dropdown menu still says \"Unassigned\"</p>\n\n<p>Words of wisdom?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1529956423, "post_id": 51030935, "comment_id": 89054087, "body": "Possibly just compare the bytes. <code>str.bytes == other.bytes</code>? This would obviously fail unless they had the same encoding."}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1529956545, "post_id": 51030935, "comment_id": 89054146, "body": "Where does your first string come from? And why does it start with single tick &#39; instead of double tick &quot; ? That&#39;s what&#39;s throwing everything off; <code>&#39;\\n&#39;</code> is two characters; a backslash and an <code>n</code>. Only <code>&quot;\\n&quot;</code> is a real linefeed."}, {"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529956566, "post_id": 51030935, "comment_id": 89054159, "body": "Your solution works, but as a more general question, how do I print a backslash in ruby?"}, {"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529956763, "post_id": 51030935, "comment_id": 89054228, "body": "@philip its a byte string from a png. I want to compare the beginning of a response that comes back as a hex escaped string. The response is formatted correctly. I can&#39;t store the comparison without getting the extra slash."}, {"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1529963092, "post_id": 51030935, "comment_id": 89056751, "body": "That string is impossible to be a byte string from a PNG, because it has literal backslashes in it \\. The single tick &#39; is not escaping the string correctly. Switch your original string to double tick &quot; and it will start working."}], "answers": [{"comments": [{"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529956900, "post_id": 51031004, "comment_id": 89054277, "body": "yes, but if I store x = &#39;\\\\&#39; then x contains &quot;\\\\&quot; not &quot;\\&quot;"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529956954, "post_id": 51031004, "comment_id": 89054294, "body": "Escaping is only necessary when displaying. When storing, just let it be what it is. If I wanted to store a newline in a variable, I would simply store it as <code>x = &#39;\\n&#39;</code>, not with double slashes."}, {"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529957032, "post_id": 51031004, "comment_id": 89054326, "body": "x=&#39;\\&#39; escapes the last quote, I can&#39;t store it."}, {"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529957071, "post_id": 51031004, "comment_id": 89054341, "body": "The whole problem is its not possible to simply store and compare a string with a single slash in it. Which is ridiculous."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529957401, "post_id": 51031004, "comment_id": 89054481, "body": "It is a single backslash, it is just displayed to you as a double. Test this: <code>&#39;\\\\&#39;.bytes</code>. It will return <code>[92]</code>, a single byte, the ASCII code for a backslash. If you print it out, it will still show 2 backslashes, but it is one."}, {"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1529957937, "post_id": 51031004, "comment_id": 89054746, "body": "Thanks. This solves most of my issue and I will ask the remaining problem in another question."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529958009, "post_id": 51031004, "comment_id": 89054786, "body": "Just because I dislike the parenthetical operation calls like this <code>(str &lt;=&gt; other).zero?</code>. I would recommend changing this to clear method calls e.g. <code>str.&lt;=&gt;(other).zero?</code> since the &quot;spaceship&quot; (<code>&lt;=&gt;</code>) is just a method."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "edited": false, "score": 0, "creation_date": 1529958182, "post_id": 51031004, "comment_id": 89054859, "body": "My personal preference is the way I used it. I don&#39;t care for using operators following a dot like a method. Just appears strange to my eyes."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 1, "creation_date": 1529958885, "post_id": 51031004, "comment_id": 89055173, "body": "Your example is wrong. <code>puts a</code> shows <code>\\ </code> (and returns <code>nil</code>). <code>p a</code> would show <code>&quot;\\\\&quot;</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1530001520, "post_id": 51031004, "comment_id": 89067849, "body": "@ForeverZer0 Your comment about the newline character is incorrect though. In single quotes only backslash and single quotes can be escaped. The string <code>&#39;\\n&#39;</code> would be a two character string of a backslash and the <code>n</code> character, not a newline. To use newline characters you have to use double quotes <code>&quot;\\n&quot;</code>. See: <a href=\"http://ruby-doc.org/core-2.5.1/doc/syntax/literals_rdoc.html#label-Strings\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/doc/syntax/&hellip;</a>"}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1530002163, "post_id": 51031004, "comment_id": 89068208, "body": "@JohanWentholt Tis, true. The elementary rule/use of single or double quoted strings wasn&#39;t really the point in the comment, I was simply trying to convey a point about storing a newline in a variable. But you are right, it would technically need to be double-quotes to work as desired. I assume OP knows the difference as well considering the liberal use in the examples."}], "tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": true, "score": 5, "last_activity_date": 1529959105, "last_edit_date": 1529959105, "creation_date": 1529956691, "answer_id": 51031004, "question_id": 51030935, "link": "https://stackoverflow.com/questions/51030935/how-to-print-backslash-in-single-quoted-string-in-ruby/51031004#51031004", "title": "How to print backslash in single quoted string in ruby", "body": "<p>So long as the strings share the same encoding, byte comparison would be elegant solution without the need for additional escaping.</p>\n\n<pre><code>str.bytes == other.bytes\n</code></pre>\n\n<p>To display a backslash, you simply escape it with a single backslash:</p>\n\n<pre><code>puts '\\\\'\n\\\n</code></pre>\n\n<p>Additionally, depending on your exact usage, could use the <code>&lt;=&gt;</code> operator:</p>\n\n<pre><code>(str &lt;=&gt; other).zero?\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>To expand a little more, there is a difference in what is <em>displayed</em> to you if you just did something like this:</p>\n\n<pre><code>a = '\\\\'\np a\n=&gt; '\\\\'\n</code></pre>\n\n<p>This will show itself as two backslashes, but it is still in fact a single character, not two.</p>\n\n<pre><code>a = '\\\\'\na.bytes\n=&gt; [92] # ASCII code for a backslash (single byte)\n</code></pre>\n"}], "owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 51031004, "answer_count": 1, "score": 1, "last_activity_date": 1529959105, "creation_date": 1529956303, "question_id": 51030935, "link": "https://stackoverflow.com/questions/51030935/how-to-print-backslash-in-single-quoted-string-in-ruby", "title": "How to print backslash in single quoted string in ruby", "body": "<p>I have the following string in ruby version 2.3.3:</p>\n\n<pre><code>'\\x89PNG\\r\\n\\x1A\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x01u\\x00\\x00\\x01u\\b'\n</code></pre>\n\n<p>I would like to compare it to another string. However, the following occurs:</p>\n\n<pre><code>x = '\\x89PNG\\r\\n\\x1A\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x01u\\x00\\x00\\x01u\\b'\n =&gt; \"\\\\x89PNG\\\\r\\\\n\\\\x1A\\\\n\\\\x00\\\\x00\\\\x00\\\\rIHDR\\\\x00\\\\x00\\\\x01u\\\\x00\\\\x00\\\\x01u\\\\b\"\n</code></pre>\n\n<p>Where the addition of the extra slash messes up the comparison. Equally confusing, the following happens:</p>\n\n<pre><code> x.gsub(\"\\\\\\\\\", \"\\\\\")\n =&gt; \"\\\\x89PNG\\\\r\\\\n\\\\x1A\\\\n\\\\x00\\\\x00\\\\x00\\\\rIHDR\\\\x00\\\\x00\\\\x01u\\\\x00\\\\x00\\\\x01u\\\\b\"\n</code></pre>\n\n<p>I have tried double quoting the string, using %{} and %Q[]. None of them simply store the string without interpreting escape sequences. How do I store this string without altering it?</p>\n"}, {"tags": ["ruby", "http"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 0, "creation_date": 1529955769, "post_id": 51030546, "comment_id": 89053802, "body": "The block form of <code>http.start</code> calls <code>ensure; do_finish</code>, and <code>finish</code> calls <code>do_finish</code>. There doesn&#39;t seem to be a destructor to call <code>finish</code> for you, though..."}], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1529959074, "post_id": 51030799, "comment_id": 89055250, "body": "But if ::start is the preferred method, then how can you pass HTTP parameters to ::start? Like use_ssl, verify_mode, etc."}, {"owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1529959606, "post_id": 51030799, "comment_id": 89055489, "body": "I updated my answer, wasn&#39;t specific enough. There is a class method <code>start</code>, not the instance method version. The class method takes a block and parameters."}], "tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": true, "score": 0, "last_activity_date": 1529959545, "last_edit_date": 1529959545, "creation_date": 1529955720, "answer_id": 51030799, "question_id": 51030546, "link": "https://stackoverflow.com/questions/51030546/http-is-it-necessary-to-close-a-connection-with-finish-after-opening-a-connecti/51030799#51030799", "title": "HTTP: Is it necessary to close a connection with finish after opening a connection with new?", "body": "<p>Using <code>new</code> does not open the connection, according to the documentation:</p>\n\n<blockquote>\n  <p>Creates a new Net::HTTP object without opening a TCP connection or\n  HTTP session.</p>\n</blockquote>\n\n<p>But to answer your question, yes, you should close your connections after using them. The connection will close eventually, but it is simply bad practice not to clean up your own unmanaged resources when you are done with them.</p>\n\n<p>The preferred method is the way you demonstrated, using <code>start</code> with a block, which ensures the connection will close when the block exits.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I was not specific enough. I was referring to the class method <code>start</code>, not the instance method <code>start</code>. The class method signature looks like this:</p>\n\n<pre><code>start(address, port, p_addr, p_port, p_user, p_pass, &amp;block)\nstart(address, port=nil, p_addr=nil, p_port=nil, p_user=nil, p_pass=nil, opt, &amp;block)\n</code></pre>\n\n<p>Documentation for it can be found <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/net/http/rdoc/Net/HTTP.html#method-c-start\" rel=\"nofollow noreferrer\">here</a>, though I am sure you can figure out the parameters already.</p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 51030799, "answer_count": 1, "score": 0, "last_activity_date": 1529959545, "creation_date": 1529954557, "question_id": 51030546, "link": "https://stackoverflow.com/questions/51030546/http-is-it-necessary-to-close-a-connection-with-finish-after-opening-a-connecti", "title": "HTTP: Is it necessary to close a connection with finish after opening a connection with new?", "body": "<p>There are several methods in the Net::HTTP API shipped with Ruby core. Some like Net::HTTP.get, Net::HTTP.get_response and Net::HTTP.post_form do not persist connections. However, ::start and ::new do persist connections. In fact, ::start takes a block remains with open connection until block exits:</p>\n\n<pre><code>uri = URI(\"example.com\")\nNet::HTTP.start(uri.host, uri.port) do |http|\n  response1 = http.get('path1')\n  response2 = http.get('path2')\nend\n</code></pre>\n\n<p>Now you can use ::new instead of ::start:</p>\n\n<pre><code>  http = Net::HTTP.new('example.com')\n  http.start\n  response1 = http.get('path1')\n  response2 = http.get('path2')\n</code></pre>\n\n<p>But must I manually close the connection? Is this a necessity or can I get away with not using this:</p>\n\n<pre><code>begin\n  http = Net::HTTP.new('example.com')\n  http.start\n  response1 = http.get('path1')\n  response2 = http.get('path2')\nensure\n  http.finish\nend\n</code></pre>\n\n<p>If I skip the finish call, will this create some kind of bloat or memory leak in the application? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree", "solidus"], "comments": [{"owner": {"reputation": 3807, "user_id": 2043592, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zCbuL.jpg?s=128&g=1", "display_name": "xploshioOn", "link": "https://stackoverflow.com/users/2043592/xploshioon"}, "edited": false, "score": 0, "creation_date": 1529957721, "post_id": 51030486, "comment_id": 89054645, "body": "can you add the output to rails routes?"}], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 2829626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3a0a3d69cfcb9f0392320136592caba?s=128&d=identicon&r=PG", "display_name": "tasqyn", "link": "https://stackoverflow.com/users/2829626/tasqyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1529961337, "creation_date": 1529961337, "answer_id": 51031894, "question_id": 51030486, "link": "https://stackoverflow.com/questions/51030486/solidus-current-user/51031894#51031894", "title": "Solidus current_user", "body": "<p>Try with </p>\n\n<pre><code>&lt;%= link_to \"Logout\", destroy_spree_user_session_path %&gt;\n</code></pre>\n\n<p>because your \"/user/spree_user/logout\" is not defined as DELETE request but as GET request route.</p>\n"}], "owner": {"reputation": 153, "user_id": 8334151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6758c1aa78966372db24e441484a264?s=128&d=identicon&r=PG&f=1", "display_name": "KH_", "link": "https://stackoverflow.com/users/8334151/kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 51031894, "answer_count": 1, "score": 1, "last_activity_date": 1529961337, "creation_date": 1529954202, "last_edit_date": 1529959950, "question_id": 51030486, "link": "https://stackoverflow.com/questions/51030486/solidus-current-user", "title": "Solidus current_user", "body": "<p>I am trying to add login/logout/sign up links to the front page of a solidus app. In the _login_bar_items partial I put this:</p>\n\n<pre><code> &lt;% if spree_current_user %&gt;\n &lt;li&gt;\n     &lt;%= link_to \"Logout\", destroy_spree_user_session_path, method: :delete %&gt;\n   &lt;/li&gt;\n &lt;% else %&gt;\n   &lt;li&gt;\n     &lt;%= link_to \"Login\", new_spree_user_session_path %&gt;\n   &lt;/li&gt;\n   &lt;li&gt;\n     &lt;%= link_to \"Register\", new_spree_user_registration_path %&gt;\n   &lt;/li&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>And I get the error </p>\n\n<pre><code>No route matches [DELETE] \"/user/spree_user/logout\"\n</code></pre>\n\n<p>when I click on logout button. The paths are as displayed when I run <code>rails routes</code>.</p>\n\n<p>I also tried <code>if current_user</code> but that didn't work either. </p>\n\n<p>Any suggestions are appreciated.</p>\n\n<p>Edit: Rails Routes output:</p>\n\n<pre><code>  Prefix Verb URI Pattern                                                                                    Controller#Action\n                spree      /                                                                                        Spree::Core::Engine\n   rails_service_blob GET  /rails/active_storage/blobs/:signed_id/*filename(.:format)                               active_storage/blobs#show\n  rails_blob_representation GET  /rails/active_storage/representations/:signed_blob_id/:variation_key/*filename(.:format)             active_storage/representations#show\n   rails_disk_service GET  /rails/active_storage/disk/:encoded_key/*filename(.:format)                              active_storage/disk#show\n  update_rails_disk_service PUT  /rails/active_storage/disk/:encoded_token(.:format)                                                              active_storage/disk#update\n       rails_direct_uploads POST /rails/active_storage/direct_uploads(.:format)                                           active_storage/direct_uploads#create\n\n  Routes for Spree::Core::Engine:\n                                 new_spree_user_session GET    /user/spree_user/sign_in(.:format)                                                                       spree/user_sessions#new\n                                     spree_user_session POST   /user/spree_user/sign_in(.:format)                                                                 spree/user_sessions#create\n                             destroy_spree_user_session GET    /user/spree_user/logout(.:format)                                                                  spree/user_sessions#destroy\n                                new_spree_user_password GET    /user/spree_user/password/new(.:format)                                                            spree/user_passwords#new\n                               edit_spree_user_password GET    /user/spree_user/password/edit(.:format)                                                           spree/user_passwords#edit\n                                    spree_user_password PATCH  /user/spree_user/password(.:format)                                                                spree/user_passwords#update\n                                                        PUT    /user/spree_user/password(.:format)                                                                spree/user_passwords#update\n                                                        POST   /user/spree_user/password(.:format)                                                                spree/user_passwords#create\n                         cancel_spree_user_registration GET    /user/spree_user/cancel(.:format)                                                                  spree/user_registrations#cancel\n                            new_spree_user_registration GET    /user/spree_user/sign_up(.:format)                                                                 spree/user_registrations#new\n                           edit_spree_user_registration GET    /user/spree_user/edit(.:format)                                                                    spree/user_registrations#edit\n                                spree_user_registration PATCH  /user/spree_user(.:format)                                                                         spree/user_registrations#update\n                                                        PUT    /user/spree_user(.:format)                                                                         spree/user_registrations#update\n                                                        DELETE /user/spree_user(.:format)                                                                         spree/user_registrations#destroy\n                                                        POST   /user/spree_user(.:format)                                                                         spree/user_registrations#create\n                            new_spree_user_confirmation GET    /user/spree_user/confirmation/new(.:format)                                                        spree/user_confirmations#new\n                                spree_user_confirmation GET    /user/spree_user/confirmation(.:format)                                                            spree/user_confirmations#show\n                                                        POST   /user/spree_user/confirmation(.:format)                                                            spree/user_confirmations#create\n                                              edit_user GET    /users/:id/edit(.:format)                                                                          spree/users#edit\n                                                   user PATCH  /users/:id(.:format)                                                                               spree/users#update\n                                                        PUT    /users/:id(.:format)                                                                               spree/users#update\n                                                  login GET    /login(.:format)                                                                                   spree/user_sessions#new\n                                     create_new_session POST   /login(.:format)                                                                                   spree/user_sessions#create\n                                                 logout GET    /logout(.:format)                                                                                  spree/user_sessions#destroy\n                                                 signup GET    /signup(.:format)                                                                                  spree/user_registrations#new\n                                           registration POST   /signup(.:format)                                                                                  spree/user_registrations#create\n                                       recover_password GET    /password/recover(.:format)                                                                        spree/user_passwords#new\n                                         reset_password POST   /password/recover(.:format)                                                                        spree/user_passwords#create\n                                          edit_password GET    /password/change(.:format)                                                                         spree/user_passwords#edit\n                                        update_password PUT    /password/change(.:format)                                                                         spree/user_passwords#update\n                                           confirmation GET    /confirm(.:format)                                                                                 spree/user_confirmations#show\n                                  checkout_registration GET    /checkout/registration(.:format)                                                                   spree/checkout#registration\n                           update_checkout_registration PUT    /checkout/registration(.:format)                                                                   spree/checkout#update_registration\n                                            new_account GET    /account/new(.:format)                                                                             spree/users#new\n                                           edit_account GET    /account/edit(.:format)                                                                            spree/users#edit\n                                                account GET    /account(.:format)                                                                                 spree/users#show\n                                                        PATCH  /account(.:format)                                                                                 spree/users#update\n                                                        PUT    /account(.:format)                                                                                 spree/users#update\n                                                        DELETE /account(.:format)                                                                                 spree/users#destroy\n                                                        POST   /account(.:format)                                                                                 spree/users#create\n                                     admin_unauthorized GET    /admin/authorization_failure(.:format)                                                             spree/admin/user_sessions#authorization_failure\n                                            admin_login GET    /admin/login(.:format)                                                                             spree/admin/user_sessions#new\n                               admin_create_new_session POST   /admin/login(.:format)                                                                             spree/admin/user_sessions#create\n                                           admin_logout GET    /admin/logout(.:format)                                                                            spree/admin/user_sessions#destroy\n                                 admin_recover_password GET    /admin/password/recover(.:format)                                                                  spree/admin/user_passwords#new\n                                   admin_reset_password POST   /admin/password/recover(.:format)                                                                  spree/admin/user_passwords#create\n                                    admin_edit_password GET    /admin/password/change(.:format)                                                                   spree/admin/user_passwords#edit\n                                  admin_update_password PUT    /admin/password/change(.:format)                                                                   spree/admin/user_passwords#update\n                                                   root GET    /                                                                                                  spree/home#index\n                                               products GET    /products(.:format)                                                                                spree/products#index\n                                                product GET    /products/:id(.:format)                                                                            spree/products#show\n                                             locale_set GET    /locale/set(.:format)                                                                              spree/locale#set\n                                          select_locale POST   /locale/set(.:format)                                                                              spree/locale#set\n                                        update_checkout PATCH  /checkout/update/:state(.:format)                                                                  spree/checkout#update\n                                         checkout_state GET    /checkout/:state(.:format)                                                                         spree/checkout#edit\n                                               checkout GET    /checkout(.:format)                                                                                spree/checkout#edit\n                                        orders_populate GET    /orders/populate(.:format)                                                                         spree/orders#populate_redirect\n                                            token_order GET    /orders/:id/token/:token(.:format)                                                                 spree/orders#show\n                                        populate_orders POST   /orders/populate(.:format)                                                                         spree/orders#populate\n                                             edit_order GET    /orders/:id/edit(.:format)                                                                         spree/orders#edit\n                                                  order GET    /orders/:id(.:format)                                                                              spree/orders#show\n                                                        PATCH  /orders/:id(.:format)                                                                              spree/orders#update\n                                                        PUT    /orders/:id(.:format)                                                                              spree/orders#update\n                                                   cart GET    /cart(.:format)                                                                                    spree/orders#edit\n                                            update_cart PATCH  /cart(.:format)                                                                                    spree/orders#update\n                                             empty_cart PUT    /cart/empty(.:format)                                                                              spree/orders#empty\n                                          nested_taxons GET    /t/*id(.:format)                                                                                   spree/taxons#show\n                                           unauthorized GET    /unauthorized(.:format)                                                                            spree/home#unauthorized\n                                                    cvv GET    /content/cvv(.:format)                                                                             spree/content#cvv\n                                              cart_link GET    /cart_link(.:format)                                                                               spree/store#cart_link\n                                     admin_search_users GET    /admin/search/users(.:format)                                                                      spree/admin/search#users\n                                  admin_search_products GET    /admin/search/products(.:format)                                                                   spree/admin/search#products\n                                       admin_set_locale PUT    /admin/locale/set(.:format)                                                                        spree/admin/locale#set {:format=&gt;:json}\n                                  home_admin_dashboards GET    /admin/dashboards/home(.:format)                                                                   spree/admin/dashboards#home\n                        admin_promotion_promotion_rules GET    /admin/promotions/:promotion_id/promotion_rules(.:format)                                          spree/admin/promotion_rules#index\n                                                        POST   /admin/promotions/:promotion_id/promotion_rules(.:format)                                          spree/admin/promotion_rules#create\n                     new_admin_promotion_promotion_rule GET    /admin/promotions/:promotion_id/promotion_rules/new(.:format)                                      spree/admin/promotion_rules#new\n                    edit_admin_promotion_promotion_rule GET    /admin/promotions/:promotion_id/promotion_rules/:id/edit(.:format)                                 spree/admin/promotion_rules#edit\n                         admin_promotion_promotion_rule GET    /admin/promotions/:promotion_id/promotion_rules/:id(.:format)                                      spree/admin/promotion_rules#show\n                                                        PATCH  /admin/promotions/:promotion_id/promotion_rules/:id(.:format)                                      spree/admin/promotion_rules#update\n                                                        PUT    /admin/promotions/:promotion_id/promotion_rules/:id(.:format)                                      spree/admin/promotion_rules#update\n                                                        DELETE /admin/promotions/:promotion_id/promotion_rules/:id(.:format)                                      spree/admin/promotion_rules#destroy\n                      admin_promotion_promotion_actions GET    /admin/promotions/:promotion_id/promotion_actions(.:format)                                        spree/admin/promotion_actions#index\n                                                        POST   /admin/promotions/:promotion_id/promotion_actions(.:format)                                        spree/admin/promotion_actions#create\n                   new_admin_promotion_promotion_action GET    /admin/promotions/:promotion_id/promotion_actions/new(.:format)                                    spree/admin/promotion_actions#new\n                  edit_admin_promotion_promotion_action GET    /admin/promotions/:promotion_id/promotion_actions/:id/edit(.:format)                               spree/admin/promotion_actions#edit\n                       admin_promotion_promotion_action GET    /admin/promotions/:promotion_id/promotion_actions/:id(.:format)                                    spree/admin/promotion_actions#show\n                                                        PATCH  /admin/promotions/:promotion_id/promotion_actions/:id(.:format)                                    spree/admin/promotion_actions#update\n                                                        PUT    /admin/promotions/:promotion_id/promotion_actions/:id(.:format)                                    spree/admin/promotion_actions#update\n                                                        DELETE /admin/promotions/:promotion_id/promotion_actions/:id(.:format)                                    spree/admin/promotion_actions#destroy\n                        admin_promotion_promotion_codes GET    /admin/promotions/:promotion_id/promotion_codes(.:format)                                          spree/admin/promotion_codes#index\n          admin_promotion_promotion_code_batch_download GET    /admin/promotions/:promotion_id/promotion_code_batches/:promotion_code_batch_id/download(.:format) spree/admin/promotion_code_batches#download {:format=&gt;\"csv\"}\n                 admin_promotion_promotion_code_batches GET    /admin/promotions/:promotion_id/promotion_code_batches(.:format)                                   spree/admin/promotion_code_batches#index\n                                                        POST   /admin/promotions/:promotion_id/promotion_code_batches(.:format)                                   spree/admin/promotion_code_batches#create\n               new_admin_promotion_promotion_code_batch GET    /admin/promotions/:promotion_id/promotion_code_batches/new(.:format)                               spree/admin/promotion_code_batches#new\n                                       admin_promotions GET    /admin/promotions(.:format)                                                                        spree/admin/promotions#index\n                                                        POST   /admin/promotions(.:format)                                                                        spree/admin/promotions#create\n                                    new_admin_promotion GET    /admin/promotions/new(.:format)                                                                    spree/admin/promotions#new\n                                   edit_admin_promotion GET    /admin/promotions/:id/edit(.:format)                                                               spree/admin/promotions#edit\n                                        admin_promotion GET    /admin/promotions/:id(.:format)                                                                    spree/admin/promotions#show\n                                                        PATCH  /admin/promotions/:id(.:format)                                                                    spree/admin/promotions#update\n                                                        PUT    /admin/promotions/:id(.:format)                                                                    spree/admin/promotions#update\n                                                        DELETE /admin/promotions/:id(.:format)                                                                    spree/admin/promotions#destroy\n                             admin_promotion_categories GET    /admin/promotion_categories(.:format)                                                              spree/admin/promotion_categories#index\n                                                        POST   /admin/promotion_categories(.:format)                                                              spree/admin/promotion_categories#create\n                           new_admin_promotion_category GET    /admin/promotion_categories/new(.:format)                                                          spree/admin/promotion_categories#new\n                          edit_admin_promotion_category GET    /admin/promotion_categories/:id/edit(.:format)                                                     spree/admin/promotion_categories#edit\n                               admin_promotion_category PATCH  /admin/promotion_categories/:id(.:format)                                                          spree/admin/promotion_categories#update\n                                                        PUT    /admin/promotion_categories/:id(.:format)                                                          spree/admin/promotion_categories#update\n                                                        DELETE /admin/promotion_categories/:id(.:format)                                                          spree/admin/promotion_categories#destroy\n                                            admin_zones GET    /admin/zones(.:format)                                                                             spree/admin/zones#index\n                                                        POST   /admin/zones(.:format)                                                                             spree/admin/zones#create\n                                         new_admin_zone GET    /admin/zones/new(.:format)                                                                         spree/admin/zones#new\n                                        edit_admin_zone GET    /admin/zones/:id/edit(.:format)                                                                    spree/admin/zones#edit\n                                             admin_zone GET    /admin/zones/:id(.:format)                                                                         spree/admin/zones#show\n                                                        PATCH  /admin/zones/:id(.:format)                                                                         spree/admin/zones#update\n                                                        PUT    /admin/zones/:id(.:format)                                                                         spree/admin/zones#update\n                                                        DELETE /admin/zones/:id(.:format)                                                                         spree/admin/zones#destroy\n                                   admin_tax_categories GET    /admin/tax_categories(.:format)                                                                    spree/admin/tax_categories#index\n                                                        POST   /admin/tax_categories(.:format)                                                                    spree/admin/tax_categories#create\n                                 new_admin_tax_category GET    /admin/tax_categories/new(.:format)                                                                spree/admin/tax_categories#new\n                                edit_admin_tax_category GET    /admin/tax_categories/:id/edit(.:format)                                                           spree/admin/tax_categories#edit\n                                     admin_tax_category GET    /admin/tax_categories/:id(.:format)                                                                spree/admin/tax_categories#show\n                                                        PATCH  /admin/tax_categories/:id(.:format)                                                                spree/admin/tax_categories#update\n                                                        PUT    /admin/tax_categories/:id(.:format)                                                                spree/admin/tax_categories#update\n</code></pre>\n"}, {"tags": ["arrays", "ruby", "set-theory"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 4, "creation_date": 1529950645, "post_id": 51029564, "comment_id": 89051536, "body": "Can you post what you have actually tried? There are a lot of cases not covered by your current question. Such as: What constitutes a &quot;sequence&quot; is it 2 or more; 3 or more?  What is the anticipation for multiple patterns eg. <code>arr1 = [1,2,2,3,4,7,7,6,2]</code> and <code>arr2 = [5,2,2,3,6,7,7,6,2,]</code>? What happens if the sequences are the same but in different locations <code>[1,2,2,3,4]</code> and <code>[5,6,2,2,3]</code>? etc."}, {"owner": {"reputation": 29, "user_id": 7591509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112a72129c2d1b92fa05e772fe079e98?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7591509/marcus"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529959846, "post_id": 51029564, "comment_id": 89055593, "body": "Well i thought it was pretty straight forward. Find a common sequence of array elements anywhere in the either array. The example i created was only to show an example. I think you your over analyzing the term &quot;sequence&quot;. What I mean by sequence is exact pattern of elements (any where in either array) ...For the example you given, Im only interested in [2,2,3] excluding the rest of the array"}, {"owner": {"reputation": 29, "user_id": 7591509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112a72129c2d1b92fa05e772fe079e98?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7591509/marcus"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529960476, "post_id": 51029564, "comment_id": 89055824, "body": "I think your over analyzing the word sequence. if i have [1,2,3,4] and [1,2,3,4] the only sequence you are interested in is [1,2,3,4] not [1] or [1,2] or [1,2,3] but simply &quot;the longest&quot; sequence if you need an exact definition. As for the case you just inputted I realized that there can be multiple sequences and for those cases the solution should just return an array of the sequences."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529960562, "post_id": 51029564, "comment_id": 89055854, "body": "Then add these options to your question so we can formulate a single answer to handle these cases because it seems that <code>[1,1,2,2,3,3,]</code> and its reverse should return either <code>[[1,1],[2,2],[3,3]]</code> or <code>[[3,3,],[2,2],[1,1]]</code> depending upon precedence. Also <code>[1,2,2,5]</code> and <code>[1,2,2,2,5]</code> is that <code>[[1,2,2],[2,5]]</code> or <code>[[1,2],[2,2,5]]</code>?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530020754, "post_id": 51029564, "comment_id": 89079972, "body": "@engineersmnky, the OP wants to return the \u201ccommon longest sequence(s) of array elements of both arrays\u201d. In your example the longest common sequence has length 5 and there is only one common sequence of that length, so <code>[[1,2,2,2,5]]</code> is returned. Also, because sequences are ordered I didn\u2019t consider reverse orders (but of course that would not be diffficult). That is my interpretation anyway"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1530020991, "post_id": 51029564, "comment_id": 89080147, "body": "@CarySwoveland <i>&quot;What I mean by sequence is exact pattern of elements (any where in either array)&quot;</i> And if you look at the definition of &quot;longest&quot; provided in comment to is simply provides that a continuous sequence not be divided not that separate sequences cannot be of different lengths. That was my only point. I would certainly concede had there been examples of input and output values that touch on such cases."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530021285, "post_id": 51029564, "comment_id": 89080372, "body": "@engineersmnky, I see your point. horror_fan, can you edit to clarify?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1530132879, "post_id": 51029564, "comment_id": 89132316, "body": "Does my answer provide the information you want (i.e., have I interpreted the question correctly?)"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1530019565, "post_id": 51031830, "comment_id": 89079101, "body": "Cary I just still have so many unanswered questions. For example <code>[2, 2, 2, 3, 4, 4, 5, 1, 2, 3, 4, 5]</code> and <code>[2, 3, 4, 2, 2, 2, 3, 4, 1, 2, 3, 4]</code> returns <code>[[2,2,2,3,4]]</code> but what about <code>[1,2,3,4]</code> which is an available pattern in <code>a</code> and listed in <code>b</code>? There are just not enough specifications provided to determine the bounds as to what is an answer. I read the comment regarding &quot;longest&quot; meant that <code>[1,2,3,4]</code> would not become <code>[[1,2],[3,4]]</code> not that only the longest pattern mattered"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1529976468, "last_edit_date": 1529976468, "creation_date": 1529961015, "answer_id": 51031830, "question_id": 51029564, "link": "https://stackoverflow.com/questions/51029564/how-to-get-common-sequences-of-two-arrays-ruby/51031830#51031830", "title": "How to get common sequence(s) of two arrays? Ruby", "body": "<p>If <code>n</code> is the size of the smaller of the two arrays, the following method first computes all sequences of length <code>n</code> for each array and then determines those sequences in the first array that also appear in the second array. The number of such common sequences is clearly zero or one (the latter because at least one of the arrays is of size <code>n</code>). If there is one common sequence of length <code>n</code> we return an array containing that single sequence and we are finished.</p>\n\n<p>If there are no common sequences of length <code>n</code> we repeat the procedure for sequences of length <code>n - 1</code>. If an array of the common sequences of length <code>n - 1</code> is non-empty we return that array and are finished; else we repeat for sequences of length <code>n - 2</code>, and so on. <code>nil</code> is returned if there are no common sequences of length <code>1</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def longest_common_sequences(arr1, arr2)\n  [arr1.size, arr2.size].min.downto(0).each do |n|\n    break nil if n.zero? \n    common = sequences_by_length(arr1, n) &amp; sequences_by_length(arr2, n)\n    break common unless common.empty?\n  end         \nend\n\ndef sequences_by_length(arr, n)\n  arr.each_cons(n).to_a\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<pre><code>longest_common_sequences [1,2,2,3,4], [5,2,2,3,6]\n   #=&gt; [[2, 2, 3]]\n\nlongest_common_sequences [2,2,3,3,5], [3,3,2,2,5]\n  #=&gt; [[2, 2], [3, 3]]\n\nlongest_common_sequences [1,2,3], [4,5,6]\n  #=&gt; nil\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>I've added <code>puts</code> statements to the body of <code>longest_common_sequences</code> to illustrate the calculations performed by the method for the second example above.</p>\n\n<pre><code>arr1 = [2,2,3,3,5]\narr2 = [3,3,2,2,5]\n\nt = [arr1.size, arr2.size].min\nputs \"[arr1.size, arr2.size].min = #{t}\"\nt.downto(0).each do |n|\n  puts \"n = #{n}\"\n  puts \"break nil as #{n}.zero? #=&gt; true\" if n.zero?\n  break nil if n.zero? \n  common = sequences_by_length(arr1, n) &amp; sequences_by_length(arr2, n)\n  puts \"common = #{common}\"\n  break common unless common.empty?\nend         \n\ndef sequences_by_length(arr, n)\n  puts \"  generate sequences of length #{n} for arr = #{arr}\"\n  a = arr.each_cons(n).to_a\n  puts \"  returning #{a}\"\n  a\nend\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>n = 5\n  generate sequences of length 5 for arr = [2, 2, 3, 3, 5]\n  returning [[2, 2, 3, 3, 5]]\n  generate sequences of length 5 for arr = [3, 3, 2, 2, 5]\n  returning [[3, 3, 2, 2, 5]]\ncommon = []\nn = 4\n  generate sequences of length 4 for arr = [2, 2, 3, 3, 5]\n  returning [[2, 2, 3, 3], [2, 3, 3, 5]]\n  generate sequences of length 4 for arr = [3, 3, 2, 2, 5]\n  returning [[3, 3, 2, 2], [3, 2, 2, 5]]\ncommon = []\nn = 3\n  generate sequences of length 3 for arr = [2, 2, 3, 3, 5]\n  returning [[2, 2, 3], [2, 3, 3], [3, 3, 5]]\n  generate sequences of length 3 for arr = [3, 3, 2, 2, 5]\n  returning [[3, 3, 2], [3, 2, 2], [2, 2, 5]]\ncommon = []\nn = 2\n  generate sequences of length 2 for arr = [2, 2, 3, 3, 5]\n  returning [[2, 2], [2, 3], [3, 3], [3, 5]]\n  generate sequences of length 2 for arr = [3, 3, 2, 2, 5]\n  returning [[3, 3], [3, 2], [2, 2], [2, 5]]\ncommon = [[2, 2], [3, 3]]\n</code></pre>\n\n<p>As <code>common.empty? #=&gt; false</code>, <code>[[2, 2], [3, 3]]</code> is returned.</p>\n"}], "owner": {"reputation": 29, "user_id": 7591509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112a72129c2d1b92fa05e772fe079e98?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7591509/marcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529976468, "creation_date": 1529950278, "last_edit_date": 1529960658, "question_id": 51029564, "link": "https://stackoverflow.com/questions/51029564/how-to-get-common-sequences-of-two-arrays-ruby", "title": "How to get common sequence(s) of two arrays? Ruby", "body": "<p>Return common longest sequence(s) of array elements of both arrays. Sequence, including duplicates and located anywhere within the array.</p>\n\n<p>For example I want to retrieve the subset <code>[2,2,3]</code>, which is the common sequence of <code>arr1</code> and <code>arr2</code> using minimal amount of code (for example with set operations) ideally without converting the <code>ints</code> to <code>strings</code></p>\n\n<pre><code>arr1 = [1,2,2,3,4]\narr2 = [5,2,2,3,6]\n# common subset sequence is [2,2,3]\n\narr1 = [2,2,3,3,5]\narr1 = [3,3,2,2,5]\n# common sequences are [2,2] [3,3]\n</code></pre>\n"}, {"tags": ["javascript", "ruby", "postgresql", "graphql", "apollo"], "comments": [{"owner": {"reputation": 1739, "user_id": 4725092, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ufnZ5.jpg?s=128&g=1", "display_name": "Alexei Darmin", "link": "https://stackoverflow.com/users/4725092/alexei-darmin"}, "edited": false, "score": 1, "creation_date": 1529950060, "post_id": 51029255, "comment_id": 89051260, "body": "I&#39;ve done it and it&#39;s great. String is a solid way of sending numbers between the client and server, especially since JS floats can&#39;t represent Decimals and will have floating point arithmetic problems. Each client (front end, server, etc) should be able to read a string number from a request and convert it to whatever lib/parser format that they are using. You would want to filter special characters like , . $ % away and send only from the set <code>0123456789</code> so every part of your architecture can understand it without reformatting."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 2087501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7b5623cfcf2559566fd6fbc348ea34f?s=128&d=identicon&r=PG", "display_name": "Oleksandr Bondar", "link": "https://stackoverflow.com/users/2087501/oleksandr-bondar"}, "is_accepted": false, "score": 1, "last_activity_date": 1529953929, "creation_date": 1529953929, "answer_id": 51030420, "question_id": 51029255, "link": "https://stackoverflow.com/questions/51029255/integer-decimal-user-input-how-to-serialize-store-the-value/51030420#51030420", "title": "Integer/decimal user input: how to serialize/store the value", "body": "<p>Create two fields. One for user input and other with parsed value. I do not think this will be different for any stack.</p>\n\n<p>The challenge is how to show to a user how you understood entered value. This could be solved with a hint with a parsed value under the text field.</p>\n"}, {"tags": [], "owner": {"reputation": 3964, "user_id": 10262805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zQvN3.jpg?s=128&g=1", "display_name": "Yilmaz", "link": "https://stackoverflow.com/users/10262805/yilmaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1566646075, "creation_date": 1566646075, "answer_id": 57637528, "question_id": 51029255, "link": "https://stackoverflow.com/questions/51029255/integer-decimal-user-input-how-to-serialize-store-the-value/57637528#57637528", "title": "Integer/decimal user input: how to serialize/store the value", "body": "<p>you should choose type of the input as \"text\" instead of number, so you can create a specific format for your input. first, add a property to your state</p>\n\n<pre><code>state={amount:\"\"}\n</code></pre>\n\n<p>input section for amount in your form should be like this:</p>\n\n<pre><code>&lt;input\n            type=\"text\"\n            placeholder=\"Amount\"\n            value={this.state.amount}\n            onChange={this.onAmountChange}\n          /&gt;\n\n\n\nonAmountChange = e =&gt; {\n    const amount = e.target.value;\n    if (!amount || amount.match(/^-?[0-9]\\d*(\\.\\d{0,2})?$/)) {\n      this.setState(() =&gt; ({ amount }));\n    }\n  };\n</code></pre>\n\n<p>regexp in above function means start with any number with optional -, and optionally u can end with 2 decimal number. you can change it for your form. </p>\n\n<p>if you want to add only positive numbers if your form is for price you can use this regexp:</p>\n\n<pre><code>amount.match(/^\\d{1,}(\\.\\d{0,2})?$/)\n</code></pre>\n"}], "owner": {"reputation": 78616, "user_id": 82609, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/FdTlD.jpg?s=128&g=1", "display_name": "Sebastien Lorber", "link": "https://stackoverflow.com/users/82609/sebastien-lorber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 611, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1566646075, "creation_date": 1529949118, "question_id": 51029255, "link": "https://stackoverflow.com/questions/51029255/integer-decimal-user-input-how-to-serialize-store-the-value", "title": "Integer/decimal user input: how to serialize/store the value", "body": "<p>Our stack is currently: React SPA/Apollo/GraphQL/Rails/PostgreSQL.</p>\n\n<p>We have a web form with a number input that maybe (or not) be used to entry decimal values (dynamic/user-created form).</p>\n\n<p>We want the form to be lenient (it has an autosave feature). If user types <code>,3</code> or <code>17,</code>, that is considered a valid number value. But not too lenient, the number should by parseable as a float and be able to display in graphs...</p>\n\n<p>Also, when the user visit the form again, we want to make sure to init the number input with the exact same value he typed initially (I mean, <code>,3</code> does not become magically <code>0,3</code>)</p>\n\n<p>I'd like to know, for our stack, how to serialize (sending as GraphQL payload) and store (in PostgreSQL) and manipulate (in JS/Ruby) such number without loosing the initial user input value.</p>\n\n<hr>\n\n<p>I'm thinking it would be simpler to send/store a string, as long as it's validated that it can be parsed. </p>\n\n<p>Just wondering if there is a \"proper\" solution, for example using number libs, custom GraphQL scalar type, decimal SQL type... that seems complicated to me, anyone did something similar before?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1529955450, "post_id": 51029208, "comment_id": 89053678, "body": "Do you have a clone of this environment on which to test?"}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1529955578, "post_id": 51029208, "comment_id": 89053734, "body": "Odds are: you will have to update a number of gem dependencies (and/or their dependencies, etc. etc.).  And worse, many of those may have had breaking changes to their interfaces.  There&#39;s a good chance the integration will break.  Can you post the Gemfile at least?  Do you have to go to latest, or can you go to something newer that isn&#39;t all the way to 2.5.1?"}], "answers": [{"tags": [], "owner": {"reputation": 2125, "user_id": 1446543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934816c610f53abdab5f26510478bc24?s=128&d=identicon&r=PG", "display_name": "ForeverZer0", "link": "https://stackoverflow.com/users/1446543/foreverzer0"}, "is_accepted": false, "score": 0, "last_activity_date": 1529962267, "creation_date": 1529962267, "answer_id": 51032059, "question_id": 51029208, "link": "https://stackoverflow.com/questions/51029208/how-do-i-easily-and-cleanly-update-ruby-1-9-to-the-latest-version-on-windows-ser/51032059#51032059", "title": "How do I easily and cleanly update ruby 1.9 to the latest version on Windows Server 2008 r2", "body": "<p>This is mostly going to come down to your gem dependencies. </p>\n\n<p>As for just the language, the odds of encountering anything that works with Ruby 1.9.3, but not Ruby 2.0+ will be highly unlikely. Plenty of features have been added, but on a whole, backwards compatibility has been maintained.</p>\n\n<p>This is not necessarily the case with gems, as the dependencies and robustness of the code can vary wildly depending on the source. The only real way to answer anything with confidence is to check/compare dependencies of each gem you require with your target Ruby version. Typically increasing the Ruby version is less likely to \"break\" anything than lowering it obviously, but it is still a significantly plausible scenario you must be wary of and prepare against.</p>\n\n<p>The only real way to do this without downtime is to clone or setup a new environment for testing, install the newer Ruby, install the required gems you have researched dependencies, and test to make sure everything runs/works as expected. </p>\n\n<p>Unfortunately there is no \"magic bullet\" here that is going to solve this issue for you. Luckily, the vast majority of this does not require knowledge of Ruby syntax and coding, and if everything goes well, will require nothing more than installing Ruby, installing gems, and comparing versions. If you run into issues with specific gems, I am confident that there is a host of people here on SO that can help guide you through reconciling it.</p>\n"}], "owner": {"reputation": 61, "user_id": 3865602, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3a1d25dedb00400478383a884d0d637a?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3865602/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529962267, "creation_date": 1529948929, "question_id": 51029208, "link": "https://stackoverflow.com/questions/51029208/how-do-i-easily-and-cleanly-update-ruby-1-9-to-the-latest-version-on-windows-ser", "title": "How do I easily and cleanly update ruby 1.9 to the latest version on Windows Server 2008 r2", "body": "<p>Full disclosure. I do not use Ruby. I never have even looked into learning it as a language. </p>\n\n<p>We use ruby at our company to power an integration between a couple of our tools. Due to a TLS update we have to update our ruby version from 1.9.2 to the newest version. </p>\n\n<p>On this windows server 2008 r2 machine I have that version of ruby and need to update. The problem is this tool is in constant use. So I cannot reasonably take the server down for a whole day while I try to figure out what to do. Initial research shows that these older versions of ruby are problematic to update. </p>\n\n<p>I have only a half dozen gems to worry about (and found a really good guide on updating those - I think). </p>\n\n<p>Looking for a kind soul who is willing to help a lost soul. </p>\n\n<p>Is this a case of needing to completely uninstall and if so does that mean uninstall my gems as well? Or can I just run an update via cmd?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "clockwork", "sneakers"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529953699, "post_id": 51029004, "comment_id": 89052878, "body": "I am not sure about if you can do one-off tasks with clockwork, but i would consider using <a href=\"https://github.com/theSteveMitchell/after_party\" rel=\"nofollow noreferrer\">after_party</a>, it&#39;s similar to migrations in the sese that it runs only if it hasn&#39;t been run before, and this gets tracked in the db"}, {"owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529956093, "post_id": 51029004, "comment_id": 89053965, "body": "Thank you for the suggestion! However I&#39;m looking for a mechanism that isn&#39;t tied to migrations or deployments. I.e. anything that lets me use the regular <code>delay_for</code> feature of ActiveJob but with the <code>sneakers</code> adapter."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1529960170, "post_id": 51029004, "comment_id": 89055708, "body": "I&#39;m not sure why you don&#39;t want it to be tied to deployment or migration. It doesn&#39;t have to happen at the exact moment you migrate / deploy. You can, inside the deployment / migration task, use <code>perform_at</code> to schedule a one-off job at a specific time."}, {"owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530030236, "post_id": 51029004, "comment_id": 89086097, "body": "That&#39;s the problem: with sneakers, the <code>perform_at</code> functionality isn&#39;t available so these tasks need to be scheduled in another way."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1530032036, "post_id": 51029004, "comment_id": 89086998, "body": "gotcha, sorry to not read the question well enough"}], "owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529948067, "creation_date": 1529948067, "question_id": 51029004, "link": "https://stackoverflow.com/questions/51029004/ruby-clockwork-for-one-time-jobs", "title": "Ruby clockwork for one-time jobs?", "body": "<p>I was thinking about using <a href=\"http://sneakers.io/\" rel=\"nofollow noreferrer\">sneakers</a> as my ActiveJob backend. Unfortunately it does not support delayed messages.\nBut since we're going to use <a href=\"https://github.com/Rykian/clockwork\" rel=\"nofollow noreferrer\">clockwork</a> anyway: is there any mechanism to schedule one-off jobs with <code>clockwork</code>? I assume that it would have to be based on the database-backed job feature as the delayed jobs would have to survive application restarts.</p>\n"}, {"tags": ["ruby", "rspec", "puppet"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529947159, "post_id": 51028562, "comment_id": 89049935, "body": "Can you confirm where this error is actually occurring because the posted code will not produce this error. This error can be recreated in a primitive fashion as a method call like <code>&quot;this&quot;._</code> but you code does not show anything of this nature"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529958626, "post_id": 51028562, "comment_id": 89055073, "body": "It is conceivable that there is a mismatch between the version of Puppet spec_helper and the version of Puppet that it located and is trying to use."}, {"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 0, "creation_date": 1529994488, "post_id": 51028562, "comment_id": 89064082, "body": "Can you include your Gemfile in the post?"}, {"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 0, "creation_date": 1530034161, "post_id": 51028562, "comment_id": 89088120, "body": "Don&#39;t worry about the Gemfile. This is broken for me too on latest Puppet 3, and I suspect it&#39;s broken for everyone. Stay tuned."}], "answers": [{"comments": [{"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 0, "creation_date": 1530095604, "post_id": 51048872, "comment_id": 89110971, "body": "Great. And me getting the same issue on Puppet 3 was a really weird coincidence."}], "tags": [], "owner": {"reputation": 27, "user_id": 2896289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8619d931b5ca3bfef5aa2a9e90cafdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user2896289", "link": "https://stackoverflow.com/users/2896289/user2896289"}, "is_accepted": false, "score": 1, "last_activity_date": 1530035513, "creation_date": 1530035513, "answer_id": 51048872, "question_id": 51028562, "link": "https://stackoverflow.com/questions/51028562/getting-undefined-method-for-puppetresourcecatalogcompiler0x0000000/51048872#51048872", "title": "getting undefined method `_&#39; for #&lt;Puppet::Resource::Catalog::Compiler:0x00000003f03338&gt;", "body": "<p>After some further digging I finally found the answer.  As a part of the gems I installed to do the unit testing additional gems were installed by several of those gems.  The rspec-puppet-utils gem installed the puppet 5 gem.  We are still using puppet 3.8.  Once I uninstalled the puppet 5 gem the error disappeared and the unit tests started working.</p>\n"}], "owner": {"reputation": 27, "user_id": 2896289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8619d931b5ca3bfef5aa2a9e90cafdaf?s=128&d=identicon&r=PG&f=1", "display_name": "user2896289", "link": "https://stackoverflow.com/users/2896289/user2896289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530035513, "creation_date": 1529946250, "question_id": 51028562, "link": "https://stackoverflow.com/questions/51028562/getting-undefined-method-for-puppetresourcecatalogcompiler0x0000000", "title": "getting undefined method `_&#39; for #&lt;Puppet::Resource::Catalog::Compiler:0x00000003f03338&gt;", "body": "<p>I am getting:</p>\n\n<pre><code>1) ntpd should contain class ntpd\n Failure/Error: is_expected.to contain_class('ntpd')\n\n NoMethodError:\n   undefined method `_' for \n &lt;Puppet::Resource::Catalog::Compiler:0x00000003f03338&gt;\n</code></pre>\n\n<p>when I run the 'rake spec' command against a puppet unit test file.  The code in the unit test file is simple:</p>\n\n<pre><code>require 'spec_helper'\n#require 'shared_contexts'\n\ndescribe 'ntpd' do\n\n# Pre resource tests\n\n   it 'should contain class ntpd' do\n      is_expected.to contain_class('ntpd') \n   end\n\nend\n</code></pre>\n\n<p>About 18 months ago this code worked.  I downloaded all the required gems to run the 'rake spec' command recently as I am picking up the puppet unit testing project again and now all I can get is the above error.  I did a bunch of searching online but no one seems to have run into this specific error.  I only end up working with ruby when I work with puppet so my ruby skills are basic.  Any help or direction would be greatly appreciated.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "is_accepted": true, "score": 4, "last_activity_date": 1529959316, "last_edit_date": 1529959316, "creation_date": 1529946736, "answer_id": 51028681, "question_id": 51028361, "link": "https://stackoverflow.com/questions/51028361/how-should-i-merge-hash-while-using-first-or-create/51028681#51028681", "title": "How should I merge hash while using &#39;first_or_create&#39;", "body": "<p>The problem is <a href=\"https://ruby-doc.org/core/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\"><code>Hash#merge</code></a> returns a new hash and then you aren't doing anything with that hash, you're just throwing it away. I would also suggest sticking to using the ActiveRecord methods for updating attributes, instead of trying to manipulate the underlying hash, such as using <a href=\"http://api.rubyonrails.org/classes/ActiveModel/AttributeAssignment.html#method-i-assign_attributes\" rel=\"nofollow noreferrer\"><code>assign_attributes</code></a> or, if you want to save the record <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-update\" rel=\"nofollow noreferrer\"><code>update</code></a>. Though, you may find the <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-create_with\" rel=\"nofollow noreferrer\"><code>create_with</code></a>, which can be used with <a href=\"http://guides.rubyonrails.org/active_record_querying.html#find-or-create-by\" rel=\"nofollow noreferrer\"><code>find_or_create_by</code></a>, useful here:</p>\n\n<pre><code>model.create_with(additional_values).find_or_create_by(name: 'test')\n</code></pre>\n\n<p>I can't find any documentation that I like (if at all) for <code>first_or_create</code> in recent rails versions, but if you like that more than <code>find_or_create_by</code>, then if we look at the <a href=\"http://guides.rubyonrails.org/v3.2/active_record_querying.html#first_or_create\" rel=\"nofollow noreferrer\">Rails 3 documentation for <code>first_or_create</code></a>, you should be able to do with out the <code>create_with</code>:</p>\n\n<pre><code>model.where(name: 'test').first_or_create(additional_attributes)\n</code></pre>\n"}], "owner": {"reputation": 1198, "user_id": 1296209, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/dbc5bd9dcaa6aa58aea8ab62ce510b4c?s=128&d=identicon&r=PG", "display_name": "webaholik", "link": "https://stackoverflow.com/users/1296209/webaholik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 51028681, "answer_count": 1, "score": 3, "last_activity_date": 1529962873, "creation_date": 1529945524, "last_edit_date": 1529962873, "question_id": 51028361, "link": "https://stackoverflow.com/questions/51028361/how-should-i-merge-hash-while-using-first-or-create", "title": "How should I merge hash while using &#39;first_or_create&#39;", "body": "<p>I have this hash, which is built dynamically:</p>\n\n<pre><code>additional_values = {\"grouping_id\"=&gt;1}\n</code></pre>\n\n<p>I want to merge it with this record object after creation via <a href=\"https://apidock.com/rails/ActiveRecord/Relation/first_or_create\" rel=\"nofollow noreferrer\">first_or_create</a>:</p>\n\n<pre><code>result = model.where(name: 'test').first_or_create do |record|\n  # I'm trying to merge any record attributes that exist in my hash:\n  record.attributes.merge(additional_values)\n  # This works, but it sucks:\n  # record.grouping_id = data['grouping_id'] if model.name == 'Grouping'\nend\n#Not working:\n#result.attributes&gt;&gt;{\"id\"=&gt;1, \"name\"=&gt;\"Test\", \"grouping_id\"=&gt;nil}\n</code></pre>\n\n<p>I understand that if the record already exists (returned via 'first'), it won't be updated...although that would be a nice option and any recommendations on that are welcome, but the table was just dropped and recreated, so that's not the issue.</p>\n\n<p>What am I missing?</p>\n\n<p>I also tried using <code>to_sym</code>, resulting with:</p>\n\n<pre><code>additional_values = {:grouping_id=&gt;1}\n</code></pre>\n\n<p>...just in case there was some weirdness I didn't know about...didn't make a difference</p>\n"}, {"tags": ["ruby", "error-handling"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529946632, "post_id": 51028329, "comment_id": 89049670, "body": "I can confirm <code>SyntaxError</code> in 2.5.1 unfortunately a <code>SyntaxError</code> cannot be rescued in that fashion the only way you could rescue this error would be to &quot;eval&quot; that code e.g. <code>begin; eval(&#39;&quot;\\u{d800}&quot;&#39;); rescue SyntaxError; &#39;oh no&#39;;end;</code> but I would not recommend this. Can you explain a bit further how this is happening?"}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1529948953, "post_id": 51028329, "comment_id": 89050781, "body": "Unrelated, but never rescue <code>Exception</code>. Always rescue something more specific <a href=\"https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby\" title=\"why is it bad style to rescue exception e in ruby\">stackoverflow.com/questions/10048173/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 2, "creation_date": 1529988185, "post_id": 51029233, "comment_id": 89061926, "body": "Alternatively, without raising an exception: <code>[0xd800].pack(&#39;U&#39;).valid_encoding?</code>"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1529950199, "last_edit_date": 1529950199, "creation_date": 1529949031, "answer_id": 51029233, "question_id": 51028329, "link": "https://stackoverflow.com/questions/51028329/how-do-i-rescue-invalid-unicode-codepoint-in-ruby/51029233#51029233", "title": "How do I rescue &quot;invalid Unicode codepoint&quot; in Ruby?", "body": "<p>You can test if a number is a valid unicode codepoint with <a href=\"https://ruby-doc.org/core/Integer.html#method-i-chr\" rel=\"nofollow noreferrer\"><code>chr</code></a></p>\n\n<pre><code>0xd800.chr('UTF-8')\n# RangeError (invalid codepoint 0xd800 in UTF-8)\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 6190320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mI4wlSZ4zyI/AAAAAAAAAAI/AAAAAAAAAPQ/aZbkKdQOsA4/photo.jpg?sz=128", "display_name": "Nnnes", "link": "https://stackoverflow.com/users/6190320/nnnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 51029233, "answer_count": 1, "score": 2, "last_activity_date": 1529950199, "creation_date": 1529945352, "question_id": 51028329, "link": "https://stackoverflow.com/questions/51028329/how-do-i-rescue-invalid-unicode-codepoint-in-ruby", "title": "How do I rescue &quot;invalid Unicode codepoint&quot; in Ruby?", "body": "<p><code>s = \"\\u{d800}\"</code> produces an error, <code>test.rb:1: invalid Unicode codepoint</code>, as expected. However,</p>\n\n<pre><code>begin\n  s = \"\\u{d800}\"\nrescue Exception\n  puts \"oh no\"\nend\n</code></pre>\n\n<p>does the same thing, producing the error rather than an output of <code>oh no</code>. Is there a built-in way to rescue this, or would I have to hardcode valid ranges of Unicode codepoints to check validity?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "routes"], "comments": [{"owner": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 1, "creation_date": 1529945619, "post_id": 51027820, "comment_id": 89049160, "body": "What does &quot;I couldn&#39;t get this work with <code>locales</code>.&quot; mean? Any error you can post? what happens if you include the locale in the redirect? <code>to: redirect(&#39;&#47;%{locale}&#47;things&#47;new&#39;)</code>"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529951177, "post_id": 51027820, "comment_id": 89051784, "body": "Also I guess <i>Why</i> seems like a valid question here. If you know that RESTfully <code>&#47;things</code> should be an &quot;index&quot; action and you do not have an index action then why would you have a route for &quot;/things&quot;?"}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 9971, "user_id": 8255744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de22299534b5a8ed244ee8ff4aa6c481?s=128&d=identicon&r=PG&f=1", "display_name": "Simple Lime", "link": "https://stackoverflow.com/users/8255744/simple-lime"}, "edited": false, "score": 0, "creation_date": 1529952482, "post_id": 51027820, "comment_id": 89052384, "body": "@SimpleLime Nothing happens then because it&#39;s not working. I used the same code as yours. It&#39;s what I meant by <code>locales</code>."}, {"owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529952587, "post_id": 51027820, "comment_id": 89052421, "body": "@engineersmnky Good point actually. I want my app to be as user friendly as possible I guess. In the case of my app, people tend to play around with the URLs a lot."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529958543, "post_id": 51027820, "comment_id": 89055036, "body": "I would say let them &quot;play around&quot; all they want but a 404 is still a 404 e.g. should you then allow for &quot;/thing&quot; and &quot;/stuff&quot; and <i>&quot;[/]Do you also say Froderick?&quot;</i> ? If they enter a path that is not valid then isn&#39;t a 404 is more appropriate than a <i>&quot;Is it me you&#39;re looking for?&quot;</i> routing pattern? At most I would suggest a catch all route and redirect to root (with a flash message maybe?)"}], "owner": {"reputation": 8823, "user_id": 976691, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/93eaf3f1f6df27205641701fca8bd233?s=128&d=identicon&r=PG", "display_name": "Tintin81", "link": "https://stackoverflow.com/users/976691/tintin81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529943218, "creation_date": 1529943218, "question_id": 51027820, "link": "https://stackoverflow.com/questions/51027820/whats-the-best-way-to-redirect-controller-actions-in-multilingual-rails-app", "title": "What&#39;s the best way to redirect controller actions in multilingual Rails app?", "body": "<p>In my multilingual Rails 5 app what's the best way to forward a URL like <code>www.myapp.com/things</code> to <code>www.myapp.com/things/new</code>?</p>\n\n<p>This is my <code>routes.rb</code> file:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  scope \"(:locale)\", :locale =&gt; /#{I18n.available_locales.join(\"|\")}/ do\n\n    resources :things, :only =&gt; [:new, :create]\n\n  end\n\nend\n</code></pre>\n\n<p>I tried doing this in the routes file:</p>\n\n<pre><code>get '/things', :to =&gt; redirect('/things/new')\n</code></pre>\n\n<p>However, I couldn't get this work with <code>locales</code>.</p>\n\n<p>Doing this in the <code>ThingsController</code> does work...</p>\n\n<pre><code>def index\n  redirect_to new_thing_path\nend\n</code></pre>\n\n<p>... but seems <em>wrong</em> since I have to create an <code>index</code> action in my <code>routes</code> file.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1529940498, "post_id": 51027003, "comment_id": 89046407, "body": "What about it isn&#39;t working? No results? An error?"}, {"owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "reply_to_user": {"reputation": 3015, "user_id": 1518336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/238d1c14366d5d0dd398b088c99f7b4c?s=128&d=identicon&r=PG", "display_name": "Daniel Westendorf", "link": "https://stackoverflow.com/users/1518336/daniel-westendorf"}, "edited": false, "score": 0, "creation_date": 1529940745, "post_id": 51027003, "comment_id": 89046557, "body": "@DanielWestendorf just updated and added full error being returned."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1529942045, "post_id": 51027003, "comment_id": 89047286, "body": "Previously rails would interrogate your string query to determine if the table should be included in the query. This is no longer the case. Now if you want to use a string version of <code>where</code> with an included table you will need to add <code>references</code> such that your query would now be <code>Course.where(active: true).joins(:course_classes).where(:course_classes =&gt; { active: true, class_type: &quot;live&quot;}).includes(:live_class_dates).where(&#39;live_class_dates&zwnj;&#8203;.start_date &gt;= ?&#39;, Date.today).references(:live_class_dates)</code>"}, {"owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "edited": false, "score": 0, "creation_date": 1529942052, "post_id": 51027003, "comment_id": 89047290, "body": "I found that adding <code>.references(:live_class_dates)</code> fixes the error. Unless anyone has a better suggestion I will use that."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1529942074, "post_id": 51027003, "comment_id": 89047310, "body": "@Lumbee nope that is the exact solution"}, {"owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "edited": false, "score": 1, "creation_date": 1529942116, "post_id": 51027003, "comment_id": 89047329, "body": "Haha...I posted right about the time you did. Thanks for confirming what I found. \ud83d\udc4d"}], "answers": [{"comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1529943197, "post_id": 51027540, "comment_id": 89047926, "body": "There is a note about that in <a href=\"https://apidock.com/rails/ActiveRecord/QueryMethods/includes\" rel=\"nofollow noreferrer\">ActiveRecord::QueryMethods.includes docs</a>. Check out conditions section"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1529949819, "post_id": 51027540, "comment_id": 89051141, "body": "@MartinZinovsky however the documents are slightly misleading because if you use the hash version of <code>where</code> then rails will include the table automagically. e.g. <code>Post.includes(:comments).where(comments: { id: 12})</code> would recognize that <code>comments</code> is a condition and would ensure that the <code>comments</code> table was joined accordingly without the specific <code>references</code>"}], "tags": [], "owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "is_accepted": true, "score": 0, "last_activity_date": 1529942193, "creation_date": 1529942193, "answer_id": 51027540, "question_id": 51027003, "link": "https://stackoverflow.com/questions/51027003/error-on-rails-includes-after-updating-to-4-2-7/51027540#51027540", "title": "Error on Rails includes after updating to 4.2.7", "body": "<p>I found that adding <code>.references(:live_class_dates)</code> to my existing query fixed the issue. Here is the full query for posterity:</p>\n\n<pre><code>@courses = Course.where(active: true).joins(:course_classes).where(:course_classes =&gt; { active: true, class_type: \"live\"}).includes(:live_class_dates).where('live_class_dates.start_date &gt;= ?', Date.today).references(:live_class_dates)\n</code></pre>\n"}], "owner": {"reputation": 4253, "user_id": 812660, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dNqSt.png?s=128&g=1", "display_name": "Mark Locklear", "link": "https://stackoverflow.com/users/812660/mark-locklear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 51027540, "answer_count": 1, "score": 0, "last_activity_date": 1529942193, "creation_date": 1529940395, "last_edit_date": 1529940715, "question_id": 51027003, "link": "https://stackoverflow.com/questions/51027003/error-on-rails-includes-after-updating-to-4-2-7", "title": "Error on Rails includes after updating to 4.2.7", "body": "<p>I have a Rails app that I am upgrading from ruby 2.1.5 and Rails 4.0.x to Ruby 2.2.8 and Rails 4.2.7. After update I have found the following query no longer works:</p>\n\n<pre><code>@courses = Course.where(active: true).joins(:course_classes).where(:course_classes =&gt; { active: true, class_type: \"live\"}).includes(:live_class_dates).where('live_class_dates.start_date &gt;= ?', Date.today)\n</code></pre>\n\n<p>It looks like the 'includes' method is the issue. I tried replacing includes with joins, but this looks to be ignoring or incorrectly interpreting the last where clause.</p>\n\n<p>First, is this a Ruby or Rails issue? And second, any suggestions on a query to replace this one?</p>\n\n<p>Thanks in advance.</p>\n\n<p>UPDATE: Here is the entire error I am getting:</p>\n\n<pre><code>PG::UndefinedTable: ERROR:  missing FROM-clause entry for table \"live_class_dates\"\nLINE 1: ... = $2 AND \"course_classes\".\"class_type\" = $3 AND (live_class...\n                                                             ^\n: SELECT \"courses\".* FROM \"courses\" INNER JOIN \"course_classes\" ON \"course_classes\".\"course_id\" = \"courses\".\"id\" WHERE \"courses\".\"active\" = $1 AND \"course_classes\".\"active\" = $2 AND \"course_classes\".\"class_type\" = $3 AND (live_class_dates.start_date &gt;= '2018-06-25')  ORDER BY \"courses\".\"title\" ASC\n</code></pre>\n"}]