[{"tags": ["ruby-on-rails", "ruby", "design-patterns"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538001938, "post_id": 52526690, "comment_id": 91993654, "body": "I think the first step to splitting up the <code>.call</code> method, would be to add the keys step-by-step to the hash, instead of using one huge literal. For example you would do <code>result = {}</code>, then <code>result[:foo] = &quot;bar&quot;</code> (and many more lines like it), and then at the end <code>return result</code>."}, {"owner": {"reputation": 24671, "user_id": 3421, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ecd2f59de5e03ba481723637fc74fad?s=128&d=identicon&r=PG", "display_name": "Jack M.", "link": "https://stackoverflow.com/users/3421/jack-m"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538009606, "post_id": 52526690, "comment_id": 91995423, "body": "@maxpleaner  in the actual implementation is is that way because I have a few loops that add to the keys as they go.  The initial <code>fields</code> hash still has a large amount of direct associations in it, though.  I left out the step-by-step to KISS the example for Stackoverflow.  Would the question be improved switching to that in the example?"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1538009878, "post_id": 52526690, "comment_id": 91995488, "body": "Why not write your tests first? TDD may help you find a better way."}, {"owner": {"reputation": 24671, "user_id": 3421, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ecd2f59de5e03ba481723637fc74fad?s=128&d=identicon&r=PG", "display_name": "Jack M.", "link": "https://stackoverflow.com/users/3421/jack-m"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1538010065, "post_id": 52526690, "comment_id": 91995520, "body": "@lacostenycoder I have tests for the <code>Fields</code> class to ensure the hash contains expected values.  However, given the current design, I will have <i>at least</i> 155 assertions for the one class, which seems like an equally bad code smell."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1538019942, "post_id": 52526690, "comment_id": 91997528, "body": "How is filling 155 key-value pairs with 155 calls a code smell? Who said 155 assertions is wrong (hint: they were never dealing with real-world problems)? Once you have 155 fields, you have 155 methods and 155 assertions (I would go with one assertion checking all 155 fields, but that\u2019s me.)"}, {"owner": {"reputation": 101, "user_id": 329120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af0a09c93b7570fdbbb730585434a40?s=128&d=identicon&r=PG", "display_name": "Warner", "link": "https://stackoverflow.com/users/329120/warner"}, "edited": false, "score": 0, "creation_date": 1598988560, "post_id": 52526690, "comment_id": 112632619, "body": "@JackM hit me up. No private messages here and exegete.net is expired."}], "owner": {"reputation": 24671, "user_id": 3421, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ecd2f59de5e03ba481723637fc74fad?s=128&d=identicon&r=PG", "display_name": "Jack M.", "link": "https://stackoverflow.com/users/3421/jack-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538016151, "creation_date": 1537999829, "last_edit_date": 1538016151, "question_id": 52526690, "link": "https://stackoverflow.com/questions/52526690/pattern-for-large-hash-creation", "title": "Pattern for large hash creation", "body": "<p>I'm filling a large (155-field) PDF using pdftk. I create massive hashes with the PDF's field names and the values to be filled in.</p>\n\n<p><code>PdfJob</code> collects all data from a model into a hash, and passes that hash into a <a href=\"https://github.com/jkraemer/pdf-forms\" rel=\"nofollow noreferrer\">wrapper around <code>pdftk</code></a> stored in <code>$PDFTK</code>.</p>\n\n<pre><code>class PdfJob\n  def perform(model)\n    $PDFTK.fill_form('path/to/fillable.pdf', Tempfile.new, Fields.call(model))\n  end\n\n  private\n\n  class Fields\n    def self.call(model)\n      {\n        OWNER_NAME: \"#{model.first_name} #{model.last_name}\",\n        TOTAL_PRICE: calculate_total_price(model),\n        FOO: 'bar',\n        # 152 more lines of key/value pairs.\n      }\n    end\n\n    def self.calculate_total_price(model)\n      # Most of these methods are multi-line.\n      model.item_relations.sum(&amp;:price)\n    end\n\n    # about 50 more class methods to simplify assignment in #call()\n  end\nend\n</code></pre>\n\n<p>I'm looking for a design pattern or some other way to break this hash into multiple classes, methods, or some other units so I don't end up with a <code>Fields</code> class with nearly 250 lines of near-untestable key/value pairs and helper methods.</p>\n"}, {"tags": ["c", "ruby", "ruby-c-extension"], "answers": [{"tags": [], "owner": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "is_accepted": true, "score": 0, "last_activity_date": 1544194694, "creation_date": 1544194694, "answer_id": 53671988, "question_id": 52525967, "link": "https://stackoverflow.com/questions/52525967/how-can-a-ruby-c-extension-store-a-proc-for-later-execution/53671988#53671988", "title": "How can a Ruby C extension store a proc for later execution?", "body": "<p>I found the answer while investigating <a href=\"https://stackoverflow.com/questions/25878944/calling-io-operations-from-thread-in-ruby-c-extension-will-cause-ruby-to-hang/53654543#53654543\">a similar issue</a>.</p>\n\n<p>As it turns out, I too was trying to use native thread signals (with <code>pthread_create</code>) which are not supported with MRI.</p>\n\n<p>TLDR; the Ruby VM is not currently (at the time of writing) thread safe. Check out <a href=\"https://silverhammermba.github.io/emberb/c/#threading\" rel=\"nofollow noreferrer\">this nice write-up on Ruby Threading</a> for a better overall understanding of how to work within these confines.</p>\n\n<p>You can use Ruby's <a href=\"https://github.com/ruby/ruby/blob/ruby_2_5/thread_pthread.c#L986\" rel=\"nofollow noreferrer\">native_thread_create(rb_thread_t *th)</a> which will use <code>pthread_create</code> behind the scenes. There are some drawbacks that you can read about in the documentation above the method definition.  You can then run the callback with Ruby's <a href=\"https://github.com/ruby/ruby/blob/ruby_2_5/thread.c#L1531\" rel=\"nofollow noreferrer\">rb_thread_call_with_gvl</a> method.  Also, I haven't done it here, but it might be a good idea to create a wrapper method so you can use <code>rb_protect</code> to handle exceptions the callback may raise (otherwise they will be swallowed by the VM).</p>\n\n<pre><code>VALUE execute_callback(VALUE callback)\n{\n    return rb_funcall(callback, rb_intern(\"call\"), 0);\n}\n\n// execute the callback when the thread receives signal\nrb_thread_call_with_gvl(execute_callback, data-&gt;callback);\n</code></pre>\n"}], "owner": {"reputation": 1813, "user_id": 1047730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2435beed6cd3c5be09b77e213e4184?s=128&d=identicon&r=PG", "display_name": "codenamev", "link": "https://stackoverflow.com/users/1047730/codenamev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 53671988, "answer_count": 1, "score": 4, "last_activity_date": 1544194694, "creation_date": 1537995633, "question_id": 52525967, "link": "https://stackoverflow.com/questions/52525967/how-can-a-ruby-c-extension-store-a-proc-for-later-execution", "title": "How can a Ruby C extension store a proc for later execution?", "body": "<p>Goal: allow c extension to receive block/proc for delayed execution while retaining current execution context.</p>\n\n<p>I have a method in c (exposed to ruby) that accepts a <code>callback</code> (via <code>VALUE hash</code> argument) or a <code>block</code>.</p>\n\n<pre><code>// For brevity, lets assume m_CBYO is setup to make a CBYO module available to ruby\nextern VALUE m_CBYO;\nVALUE CBYO_add_callback(VALUE callback)\n{\n    if (rb_block_given_p()) {\n        callback = rb_block_proc();\n    }\n\n    if (NIL_P(callback)) {\n        rb_raise(rb_eArgError, \"either a block or callback proc is required\");\n    }\n\n    // method is called here to add the callback proc to rb_callbacks\n}\nrb_define_module_function(m_CBYO, \"add_callback\", CBYO_add_callback, 1);\n</code></pre>\n\n<p>I have a struct I'm using to store these with some extra data:</p>\n\n<pre><code>struct rb_callback\n{\n    VALUE rb_cb;\n    unsigned long long lastcall;\n    struct rb_callback *next;\n};\nstatic struct rb_callback *rb_callbacks = NULL;\n</code></pre>\n\n<p>When it comes time (triggered by an epoll), I iterate over the callbacks and execute each callback:</p>\n\n<pre><code>rb_funcall(cb-&gt;rb_cb, rb_intern(\"call\"), 0);\n</code></pre>\n\n<p>When this happens I am seeing that it successfully executes the ruby code in the callback, however, it is escaping the current execution context.</p>\n\n<p>Example:</p>\n\n<pre><code># From ruby including the above extension\nCBYO.add_callback do\n    puts \"Hey now.\"\nend\n\nloop do\n    puts \"Waiting for signal...\"\n    sleep 1\nend\n</code></pre>\n\n<p>When a signal is received (via epoll) I will see the following:</p>\n\n<pre><code>$&gt; Waiting for signal...\n$&gt; Waiting for signal...\n$&gt; Hey now.\n$&gt; // process hangs\n$&gt; // Another signal occurs\n$&gt; [BUG] vm_call_cfunc - cfp consistency error\n</code></pre>\n\n<p>Sometimes, I can get more than one signal to process before the bug surfaces again.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1537996868, "post_id": 52525963, "comment_id": 91992171, "body": "Going to ask the obvious questions: have you tried just catching this error and ignoring it?  Does it not always happen on the same line of code?"}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1537997039, "post_id": 52525963, "comment_id": 91992231, "body": "As a corollary to my previous comment: I&#39;m not finding anything that automatically throws exceptions on console errors with Selenium.  Are you sure you&#39;re not throwing this error yourself?"}, {"owner": {"reputation": 1, "user_id": 6829398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3454c484f99452ec7bff931356680b?s=128&d=identicon&r=PG&f=1", "display_name": "alicechiu", "link": "https://stackoverflow.com/users/6829398/alicechiu"}, "reply_to_user": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538161681, "post_id": 52525963, "comment_id": 92061247, "body": "I figured out the problem and wasn&#39;t related to mixed content at all. Thanks."}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1538260667, "post_id": 52525963, "comment_id": 92082557, "body": "you should write an answer to your question outlining how you solved the problem so that other people who may encounter this know what happened."}], "answers": [{"tags": [], "owner": {"reputation": 933, "user_id": 9014957, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/cb527cba25f5ea92d923795e68f3485c?s=128&d=identicon&r=PG&f=1", "display_name": "pburgr", "link": "https://stackoverflow.com/users/9014957/pburgr"}, "is_accepted": false, "score": 0, "last_activity_date": 1538030456, "creation_date": 1538030456, "answer_id": 52530938, "question_id": 52525963, "link": "https://stackoverflow.com/questions/52525963/bypassing-insecure-content-blocked-with-selenium-ruby-script/52530938#52530938", "title": "Bypassing &quot;Insecure Content Blocked&quot; with Selenium Ruby script", "body": "<p>start Chrome manualy and disable the warning - <a href=\"https://www.thewindowsclub.com/disable-insecure-content-warning-chrome\" rel=\"nofollow noreferrer\">https://www.thewindowsclub.com/disable-insecure-content-warning-chrome</a></p>\n\n<p>and use the set browser profile, there is my setup:</p>\n\n<pre><code>@BeforeClass\npublic static void setUpClass() {\n    System.setProperty(\"webdriver.chrome.driver\", \"C:\\\\Users\\\\pburgr\\\\Desktop\\\\chromedriver\\\\chromedriver.exe\");\n    ChromeOptions options = new ChromeOptions();\n    options.addArguments(\"user-data-dir=C:\\\\Users\\\\pburgr\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\");\n    driver = new ChromeDriver(options);\n    driver.manage().window().maximize();}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6829398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f3454c484f99452ec7bff931356680b?s=128&d=identicon&r=PG&f=1", "display_name": "alicechiu", "link": "https://stackoverflow.com/users/6829398/alicechiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 663, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1538030456, "creation_date": 1537995603, "question_id": 52525963, "link": "https://stackoverflow.com/questions/52525963/bypassing-insecure-content-blocked-with-selenium-ruby-script", "title": "Bypassing &quot;Insecure Content Blocked&quot; with Selenium Ruby script", "body": "<p>I am fairly new with using Selenium in my Ruby script. Basically my script will make a get request to some url and log in. However my script is failing to send the email and log in automatically due to the Google Chrome pop up about insecure content blocked since one of the images on the page is using http and not https.</p>\n\n<p>I was able to run the script successfully months ago however just recently when trying again, it is unable to proceed with logging in so I dont know why it stopped working all of a sudden.</p>\n\n<p>The error that I see in terminal is this. In irb, I can go through each line of code successfully including using Selenium's \"send_keys\" and \"click\" to automatically sign in.</p>\n\n<p>[2018-09-26T13:02:55.002527 #14131]  INFO -- : [#http://company.com/favicon.ico'. This request has been blocked; the content must be served over HTTPS.\">]\nweb_app.rb:54:in `': Console Errors Found! (Exception)</p>\n\n<p>I tried searching for some solution but have been unsuccessful. There has been some variations of responses to similar problem but not too much luck with getting it to work.</p>\n\n<p>Any feedback on how to fix would be appreciated.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2452, "user_id": 1594060, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d93aa9c4456a600e2fdc404588726354?s=128&d=identicon&r=PG", "display_name": "Josh Rumbut", "link": "https://stackoverflow.com/users/1594060/josh-rumbut"}, "edited": false, "score": 1, "creation_date": 1537995602, "post_id": 52525882, "comment_id": 91991735, "body": "A hint here is that you had to add 1 to <code>fav</code> to create a new number, now you are trying to add that number to the front of the string <code>&#39;would be a better choice!&#39;</code>"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 1, "creation_date": 1537995885, "post_id": 52525882, "comment_id": 91991853, "body": "<code>fav</code> , <code>1</code> and <code>&quot;would be a better choice!&quot;</code> are all objects, not all of them are the same type of object and you can&#39;t just write one object after another without any additional operation and expect ruby to figure out what to do :) should help you out figure the issue out on your own"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1537996767, "post_id": 52526155, "comment_id": 91992132, "body": "&quot;is the missing closing bracket in the first row&quot; - it&#39;s a quote, not a bracket or apostrophe :)"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1537996854, "post_id": 52526155, "comment_id": 91992169, "body": "@SergioTulentsev I noticed that as I read the answer again, thank you!"}, {"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 1, "creation_date": 1537998107, "post_id": 52526155, "comment_id": 91992598, "body": "I get the logical progression of your answer, but I feel you should mention that the idiomatic ruby way to do this would be with string interpolation: <code>puts &quot;#{fav + 1} would be a better choice!&quot;</code>"}, {"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "reply_to_user": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 1, "creation_date": 1537998650, "post_id": 52526155, "comment_id": 91992759, "body": "@ChrisHall I thought about doing that, but I was afraid that adding that would require an explanation of the syntax which would just further derive the answer from the original question. But as this has turned into a beginner&#39;s Ruby lesson anyway, I see no reason not to add it. Thank you for you input!"}, {"owner": {"reputation": 13, "user_id": 10420925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYxIi.jpg?s=128&g=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/10420925/jamie"}, "edited": false, "score": 0, "creation_date": 1538079690, "post_id": 52526155, "comment_id": 92028981, "body": "Thank you all for the help! I\u2019m working through Chris Pine\u2019s \u201cLearn to Program\u201d and this was one of the programs to try on your own. I guess a shortcoming of the book is there\u2019s not an example in the back of the book if you get stuck. Thanks again!"}], "tags": [], "owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "is_accepted": true, "score": 1, "last_activity_date": 1537998898, "last_edit_date": 1537998898, "creation_date": 1537996699, "answer_id": 52526155, "question_id": 52525882, "link": "https://stackoverflow.com/questions/52525882/creating-a-variable-by-adding-another-variable-and-an-integer/52526155#52526155", "title": "Creating a variable by adding another variable and an integer", "body": "<p>This is your code:</p>\n\n<pre><code>puts \u2018hello, what is your favorite number?\nfav = gets.to_i\nputs fav + 1 \u2018would be a better choice!\u2019\n</code></pre>\n\n<p>The first thing that's off is the missing closing quote in the first row. The next thing that should be changed and is causing the error is this</p>\n\n<pre><code>fav + 1 'would be a better chocice!'\n</code></pre>\n\n<p><code>fav</code> is an int, so is <code>1</code> so that's ok, but just writing a string after that is going to cause an error. So we need to tell Ruby we want to combine the int and the string and we do that with the plus sign (<code>+</code>). But trying to combine an int with a string is going to cause an <code>String can't be coerced into Integer</code> error. So we need to somehow transform the int into a string. And we do that using the <code>#to_s</code> method which will return the string representation of that integer which brings us to:</p>\n\n<pre><code>puts 'hello, what is your favorite number?'\nfav = gets.to_i\nputs (fav + 1).to_s + ' would be a better choice!'\n</code></pre>\n\n<p>However, changing the last line to use string interpolation:</p>\n\n<pre><code>puts \"#{fav + 1} would be a better choice!\"\n</code></pre>\n\n<p>Would be (as Chris said in the comment section) the idiomatic Ruby way to do this.</p>\n\n<p>I would also recommend you to look at Ruby's wiki tag and check out all the available resources on Ruby as they will give you a better learning curve now than just practicing random methods and stuff on your own. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": -1, "last_activity_date": 1537996793, "creation_date": 1537996793, "answer_id": 52526172, "question_id": 52525882, "link": "https://stackoverflow.com/questions/52525882/creating-a-variable-by-adding-another-variable-and-an-integer/52526172#52526172", "title": "Creating a variable by adding another variable and an integer", "body": "<p>This should work as expected:</p>\n\n<pre><code>puts \"hello, what is your favorite number?\"\nfav = gets.to_i\nputs \"#{fav + 1} would be a better choice!\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10420925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYxIi.jpg?s=128&g=1", "display_name": "Jamie", "link": "https://stackoverflow.com/users/10420925/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 52526155, "answer_count": 2, "score": 1, "last_activity_date": 1537998898, "creation_date": 1537995144, "question_id": 52525882, "link": "https://stackoverflow.com/questions/52525882/creating-a-variable-by-adding-another-variable-and-an-integer", "title": "Creating a variable by adding another variable and an integer", "body": "<p>I\u2019m trying to create a simple program in Ruby to learn from. It asks you for a number. It takes that number, adds 1 to it, and tells you this new number is a better number.</p>\n\n<pre><code>puts \u2018hello, what is your favorite number?\nfav = gets.to_i\nputs fav + 1 \u2018would be a better choice!\u2019\n</code></pre>\n\n<p>If I eliminate \u2018would be a better choice!\u2019 or put that on it\u2019s own line, this works fine. I can\u2019t figure out what I\u2019m doing wrong on this. </p>\n\n<p>Thank you for any help sorting this out.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "is_accepted": false, "score": 8, "last_activity_date": 1537995902, "creation_date": 1537995902, "answer_id": 52526005, "question_id": 52525436, "link": "https://stackoverflow.com/questions/52525436/toplevel-binding-difference-in-irb-and-script/52526005#52526005", "title": "TOPLEVEL_BINDING difference in irb and script", "body": "<p>This is because the irb command (on my system, anyways) runs a small ruby script that looks like this:</p>\n\n<pre><code>#!/usr/bin/env ruby\n#\n#   irb.rb - interactive ruby\n#       $Release Version: 0.9.6 $\n#       $Revision: 40560 $\n#       by Keiju ISHITSUKA(keiju@ruby-lang.org)\n#\n\nrequire \"irb\"\n\nIRB.start(__FILE__)\n</code></pre>\n\n<p>So, the <code>TOPLEVEL_BINDING</code> is this script and not your IRB context.</p>\n\n<p>While looking for some more information, I ran across <a href=\"https://idiosyncratic-ruby.com/44-top-level-binding.html\" rel=\"noreferrer\">this short article</a> which states:</p>\n\n<blockquote>\n  <p>It is, as its name suggest, the Binding of your script's main scope:</p>\n\n<pre><code>a = 42\np binding.local_variable_defined?(:a) # =&gt; true\np TOPLEVEL_BINDING.local_variable_defined?(:a) # =&gt; true\n\ndef example_method\n  p binding.local_variable_defined?(:a) # =&gt; false\n  p TOPLEVEL_BINDING.local_variable_defined?(:a) # =&gt; true\nend\n\nexample_method\n</code></pre>\n</blockquote>\n\n<p>To summarize, the <code>TOPLEVEL_BINDING</code> is the <code>binding</code> for the first script in the current context that was run by the Ruby VM.  When running IRB, that script is the one that starts the IRB session.</p>\n"}], "owner": {"reputation": 384, "user_id": 2034811, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/9f98183dd2d21adfe7c7058b14fc56a6?s=128&d=identicon&r=PG", "display_name": "Omar Khan", "link": "https://stackoverflow.com/users/2034811/omar-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1537995902, "creation_date": 1537992902, "question_id": 52525436, "link": "https://stackoverflow.com/questions/52525436/toplevel-binding-difference-in-irb-and-script", "title": "TOPLEVEL_BINDING difference in irb and script", "body": "<p>If i put the following code:</p>\n\n<pre><code>a = 42    \np TOPLEVEL_BINDING.local_variable_defined?(:a)\n</code></pre>\n\n<p>in a file \"rubyScratch.rb\" and ruby it using </p>\n\n<pre><code>ruby rubyScratch.rb\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>true\n</code></pre>\n\n<p>However in irb I get </p>\n\n<pre><code>2.3.1 :001 &gt; a = 42\n=&gt; 42 \n2.3.1 :002 &gt; TOPLEVEL_BINDING.local_variable_defined?(:a)\n=&gt; false \n</code></pre>\n\n<p>Why is there this difference?</p>\n"}, {"tags": ["ruby", "carrierwave"], "answers": [{"tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1537991320, "creation_date": 1537991320, "answer_id": 52525103, "question_id": 52525027, "link": "https://stackoverflow.com/questions/52525027/covert-image-from-png-to-jpg-using-carrierwave/52525103#52525103", "title": "Covert image from png to jpg using Carrierwave", "body": "<p>Do you use minimagick? If so, try swapping</p>\n\n<pre><code>img.format('jpeg')\n</code></pre>\n\n<p>to</p>\n\n<pre><code>img.convert('jpeg')\n</code></pre>\n\n<p>From <a href=\"https://www.rubydoc.info/github/jnicklas/carrierwave/CarrierWave%2FMiniMagick%3Aconvert\" rel=\"nofollow noreferrer\">https://www.rubydoc.info/github/jnicklas/carrierwave/CarrierWave%2FMiniMagick%3Aconvert</a></p>\n"}], "owner": {"reputation": 25, "user_id": 9693056, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "ACanal", "link": "https://stackoverflow.com/users/9693056/acanal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 52525103, "answer_count": 1, "score": 0, "last_activity_date": 1537991320, "creation_date": 1537990953, "last_edit_date": 1537991281, "question_id": 52525027, "link": "https://stackoverflow.com/questions/52525027/covert-image-from-png-to-jpg-using-carrierwave", "title": "Covert image from png to jpg using Carrierwave", "body": "<p>I am using Carrierwave to upload pictures.  I want to convert PNGs to JPEGs when they are uploade to S3 using Fog</p>\n\n<p>I have tried writing a method in the uploader like so:</p>\n\n<pre><code>  def covert_image\n    manipulate! do |img|\n      img.strip\n      img.format('jpeg')\n      img.combine_options do |c|\n        c.quality \"80\"\n        c.depth \"8\"\n        c.interlace \"plane\"\n      end\n      img\n    end\n  end\n</code></pre>\n\n<p>This does no work however.  I have Googled around for ways to do this conversion but I am unable to find any examples.  Any help would be appreciated.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1537990280, "post_id": 52524682, "comment_id": 91989414, "body": "Do you have an expected output format, or anything will do? Also, do you have a function with the distance formula? If so, can you include it in the question?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1537992355, "post_id": 52524682, "comment_id": 91990370, "body": "Using the Vector class (<code>require &#39;matrix&#39;</code>), you can do something like <code>array.map { |e| Vector.elements(e) }.combination(2).map { |point| (point.first - point.last).magnitude }</code>. But this is just a suggestion, since it&#39;s not clear what&#39;s the desired output format."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1538011668, "post_id": 52524682, "comment_id": 91995833, "body": "@iGian, I just noticed your comment after earlier posting an answer that implements your suggestion."}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538027174, "post_id": 52524682, "comment_id": 91999552, "body": "@CarySwoveland, I see you expanded it pretty well.. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 0, "last_activity_date": 1537990801, "last_edit_date": 1537990801, "creation_date": 1537990379, "answer_id": 52524889, "question_id": 52524682, "link": "https://stackoverflow.com/questions/52524682/how-to-subtract-two-sub-arrays-from-2d-array/52524889#52524889", "title": "How to subtract two sub-arrays from 2D array", "body": "<p>I changed your array to a hash as it made more sense.</p>\n\n<pre><code>class DistanceCalculator\n  def initialize(x, y)\n    @point_x = x\n    @point_y = y\n  end\n\n  def coord_difference\n    @coord_difference ||= @point_x.zip(@point_y).map { |x, y| y - x }\n  end\n\n  def distance\n    Math.sqrt(coord_difference.first ** 2 + coord_difference.last ** 2)\n  end\nend\n\npoints = {\n  A: [24,2],\n  B: [32,42],\n  C: [3,11],\n  D: [5,9],\n  E: [10,5],\n  F: [14,2]\n}\n\n# example usage\nputs DistanceCalculator.new(points[:A], points[:B]).distance\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538011784, "post_id": 52525623, "comment_id": 91995859, "body": "Note that @iGain suggested this approach in a comment on the question."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1537998754, "last_edit_date": 1537998754, "creation_date": 1537993804, "answer_id": 52525623, "question_id": 52524682, "link": "https://stackoverflow.com/questions/52524682/how-to-subtract-two-sub-arrays-from-2d-array/52525623#52525623", "title": "How to subtract two sub-arrays from 2D array", "body": "<p><strong>Code</strong></p>\n\n<pre><code>require 'matrix'\n\ndef pair_wise_distances(h)\n  h.map { |k,v| [k, Vector[*v]] }.\n    combination(2).\n    each_with_object({}) { |((k1,v1),(k2,v2)),g|\n      g[[k1,k2]] = (v2-v1).magnitude.round(4) }.\n    tap { |g| g.default_proc = Proc.new { |f,k| f[k.reverse] } }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<pre><code>h = { A: [24,2], B: [32,42], C: [3,11], D: [5,9], E: [10,5], F: [14,2] }\n\ng = pair_wise_distances(h)\n  #=&gt; {[:A, :B]=&gt;40.7922, [:A, :C]=&gt;22.8473, [:A, :D]=&gt;20.2485,\n  #    [:A, :E]=&gt;14.3178, [:A, :F]=&gt;10.0,    [:B, :C]=&gt;42.45,\n  #    [:B, :D]=&gt;42.638,  [:B, :E]=&gt;43.0465, [:B, :F]=&gt;43.8634,\n  #    [:C, :D]=&gt;2.8284,  [:C, :E]=&gt;9.2195,  [:C, :F]=&gt;14.2127,\n  #    [:D, :E]=&gt;6.4031,  [:D, :F]=&gt;11.4018, [:E, :F]=&gt;5.0}\ng[[:A, :B]]\n  #=&gt; 40.7922\ng[[:B, :A]]\n  #=&gt; 40.7922\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Vector.html#method-c-5B-5D\" rel=\"nofollow noreferrer\">Vector::[]</a>, <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Vector.html#method-i-2D\" rel=\"nofollow noreferrer\">Vector#-</a>, <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Vector.html#method-i-magnitude\" rel=\"nofollow noreferrer\">Vector#magnitude</a> (a.k.a. <code>r</code>) and <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-combination\" rel=\"nofollow noreferrer\">Array#combination</a>.</p>\n\n<p>Notice that the method does not require the values in the hash to be two-element arrays. They can be of arrays of any size.</p>\n\n<p>The steps are as follows.</p>\n\n<pre><code>f = h.map { |k,v| [k, Vector[*v]] }\n  #=&gt; [\n  #     [:A, Vector[24, 2]], [:B, Vector[32, 42]], [:C, Vector[3, 11]],\n  #     [:D, Vector[5, 9]], [:E, Vector[10, 5]], [:F, Vector[14, 2]]      \n  #   ]\ne = f.combination(2)\n  #=&gt; #&lt;Enumerator: [\n  #     [:A, Vector[24, 2]], [:B, Vector[32, 42]], [:C, Vector[3, 11]],\n  #     [:D, Vector[5, 9]], [:E, Vector[10, 5]], [:F, Vector[14, 2]]\n  #   ]:combination(2)&gt;\n</code></pre>\n\n<p>We can convert <code>e</code> to an array to see the (<code>e.size = 5*4/2 = 15</code>) values that will be generated by the enumerator.</p>\n\n<pre><code>e.to_a\n  #=&gt; [\n  #     [[:A, Vector[24, 2]], [:B, Vector[32, 42]]],\n  #     [[:A, Vector[24, 2]], [:C, Vector[3, 11]]],\n  #     ...\n  #     [[:A, Vector[24, 2]], [:F, Vector[14, 2]]],\n  #     [[:B, Vector[32, 42]], [:C, Vector[3, 11]]],\n  #     ...\n  #     [[:C, Vector[3, 11]], [:D, Vector[5, 9]]],\n  #     ...\n  #     [[:D, Vector[5, 9]], [:E, Vector[10, 5]]],\n  #     ...\n  #     [[:E, Vector[10, 5]], [:F, Vector[14, 2]]]\n  #   ]\n</code></pre>\n\n<p>Continuing,</p>\n\n<pre><code>f = e.each_with_object({}) { |((k1,v1), (k2,v2)),g|\n  g[[k1,k2]] = (v2-v1).magnitude.round(4) }\n  #=&gt; (as shown in \"Example\" section)\n</code></pre>\n\n<p>The value of <code>[:A, :B]</code> (the distance between <code>:A</code> and <code>:B</code>), for example, is computed as follows.</p>\n\n<pre><code>diff = Vector[32, 42] - Vector[24, 2]\n  #=&gt; Vector[8, 40]\n\ndiff.magnitude.round(4)\n  #=&gt; 40.7922\n</code></pre>\n\n<p>which, as one would expect, equals</p>\n\n<pre><code>Math.sqrt(8**2 + 40**2).round(4)\n</code></pre>\n\n<p>Lastly, for each key <code>k</code> in the hash <code>f</code>, we need to have <code>f[k.reverse]</code> return <code>f[k]</code>. (For the key <code>[:A, :B]</code>, for example, need to return the value of <code>[:B, :A]</code>, which is the same as the value of <code>[:A, :B]</code>). We could add the \"reverse\" keys:</p>\n\n<pre><code>g.keys.each { |k| g[k.reverse] = g[k] }\n</code></pre>\n\n<p>but this doubles the size of the hash. Instead, I have attached a default proc to <code>f</code>:</p>\n\n<pre><code>f.default_proc = Proc.new { |g,k| g[k.reverse] }\n</code></pre>\n\n<p>This causes <code>f[k.reverse]</code> to be returned when <code>f</code> does not have a key <code>k</code>:</p>\n\n<pre><code>g[[:A, :B]]\n  #=&gt; 40.7922\ng[[:B, :A]]\n  #=&gt; 40.7922\n</code></pre>\n\n<p>If we wish <code>f[[k, k]]</code> (e.g., <code>f[[:C, :C]]</code>) to return zero, we could change the default proc to the following.</p>\n\n<pre><code>f.default_proc = Proc.new { |g,k| k.first==k.last ? 0 : g[k.reverse] }\nf[[:C, :C]]\n  #=&gt; 0\nf[[:B, :A]]\n  #=&gt; 40.7922\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1538029162, "last_edit_date": 1538029162, "creation_date": 1538027125, "answer_id": 52530177, "question_id": 52524682, "link": "https://stackoverflow.com/questions/52524682/how-to-subtract-two-sub-arrays-from-2d-array/52530177#52530177", "title": "How to subtract two sub-arrays from 2D array", "body": "<p>One other option to find the distance between points is to create a patch to array Class, then implement as already shown by Cary Swoveland.</p>\n\n<p>This is the module, <code>distance_from</code> is just the Pitagora formula.</p>\n\n<pre><code>module ArrayAlgebraPatch\n  def distance_from(other)\n    # raise \"SIZE ERROR\" if self.size != other.size\n    Math.sqrt(self.zip(other).map { |e| (e[1]-e[0])**2 }.reduce(&amp;:+))\n  end\nend\n</code></pre>\n\n<p>Yu must include the module to Array class:</p>\n\n<pre><code>Array.include ArrayAlgebraPatch\n</code></pre>\n\n<p>So you are able to call:</p>\n\n<pre><code>[24,2].distance_from [32,42] #=&gt; 40.792156108742276\n</code></pre>\n\n<p>And apply to your vector, finding distance between points in combination:</p>\n\n<pre><code>array.combination(2).map { |pt1, pt2| pt2.distance_from pt1 }\n</code></pre>\n\n<p>Anyway, if a standard lib (such as <code>Vector</code>) already does what we need, <strong>we better not reinvent the wheel</strong>. </p>\n"}], "owner": {"reputation": 173, "user_id": 9795796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ad1717dc95056d51103dc37eb3acb5?s=128&d=identicon&r=PG&f=1", "display_name": "Axelrod", "link": "https://stackoverflow.com/users/9795796/axelrod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1538029162, "creation_date": 1537989340, "last_edit_date": 1538016625, "question_id": 52524682, "link": "https://stackoverflow.com/questions/52524682/how-to-subtract-two-sub-arrays-from-2d-array", "title": "How to subtract two sub-arrays from 2D array", "body": "<p>I have a 2d-array of coordinate points:</p>\n\n<pre><code>array = [\n  [24, 2],  # =&gt; A\n  [32, 42], # =&gt; B\n  [3, 11],  # =&gt; C\n  [5, 9],   # =&gt; D\n  [10, 5],  # =&gt; E\n  [14, 2]   # =&gt; F\n]\n</code></pre>\n\n<p>I need to find out the distance between each, such as from A to B, C, D, ..., from B to C, D, E, ...</p>\n\n<p>I don't know how to build a loop that goes through all the elements and and how to integrate the distance formula.</p>\n"}, {"tags": ["ruby", "header", "yaml"], "comments": [{"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 1, "creation_date": 1537989470, "post_id": 52524503, "comment_id": 91989040, "body": "Just use the YAML. load_file function, it will read the file data into a hash. Note in newer rubies, it&#39;s in the Psych library <a href=\"https://ruby-doc.org/stdlib-2.4.0/libdoc/psych/rdoc/Psych.html\" rel=\"nofollow noreferrer\">ruby-doc.org/stdlib-2.4.0/libdoc/psych/rdoc/Psych.html</a>"}, {"owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537990028, "post_id": 52524503, "comment_id": 91989297, "body": "it does not work Traceback (most recent call last): \t3: from ./test.rb:16:in <code>&lt;main&gt;&#39; \t2: from &#47;usr&#47;lib&#47;ruby&#47;2.5.0&#47;psych.rb:497:in </code>load_file&#39; \t1: from /usr/lib/ruby/2.5.0/psych.rb:497:in <code>open&#39; &#47;usr&#47;lib&#47;ruby&#47;2.5.0&#47;psych.rb:497:in </code>initialize&#39;: No such file or directory @ rb_sysopen"}, {"owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537990057, "post_id": 52524503, "comment_id": 91989312, "body": "data = YAML.load_file yaml_string"}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537990555, "post_id": 52524503, "comment_id": 91989529, "body": "does the file exist? You may have a relative path error, i.e. file isn&#39;t in directory your program is running."}, {"owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537991142, "post_id": 52524503, "comment_id": 91989804, "body": "i already give a full path, above it is just an example, Moreover it tell me file is too long..."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537992106, "post_id": 52524503, "comment_id": 91990243, "body": "try executing the load file portion within an if File.exists?(filename) (your code here) else raise ArgumentError end guard. usually the error messages are pretty accurate and you should trust them"}, {"owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "reply_to_user": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 0, "creation_date": 1537994021, "post_id": 52524503, "comment_id": 91991126, "body": "it does not catch error"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "edited": false, "score": 0, "creation_date": 1538036194, "post_id": 52526491, "comment_id": 92004114, "body": "nope, my initial have contain %YAML 1.1 --- - title:  but after code execution I have only  ---- - title:  I don&#39;t want to remove %YAML 1.1"}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "reply_to_user": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "edited": false, "score": 0, "creation_date": 1538079718, "post_id": 52526491, "comment_id": 92029000, "body": "I&#39;ve updated the answer to reflect that. I think you&#39;re being too literal in your thinking though as that directive is introduced for yaml 1.2. Ruby doesn&#39;t technically support it yet. Per @tenderlove <a href=\"https://github.com/ruby/psych/issues/253#issuecomment-156169539\" rel=\"nofollow noreferrer\">github.com/ruby/psych/issues/253#issuecomment-156169539</a> so libyaml only supports 1.1 currently. This will become an option when libyaml supports 1.2. from the libyaml docs... &quot;version_directive - the version specified with the %YAML directive; the only valid value is 1.1; may be NULL.&quot; <a href=\"https://pyyaml.org/wiki/LibYAML\" rel=\"nofollow noreferrer\">pyyaml.org/wiki/LibYAML</a>"}], "tags": [], "owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "is_accepted": false, "score": 0, "last_activity_date": 1538079613, "last_edit_date": 1538079613, "creation_date": 1537998739, "answer_id": 52526491, "question_id": 52524503, "link": "https://stackoverflow.com/questions/52524503/ruby-yaml-dont-remove-header-yaml-1-1/52526491#52526491", "title": "ruby yaml don&#39;t remove header %YAML 1.1", "body": "<p>I think something like this is what you're trying to do. </p>\n\n<p>I'm assuming your yaml array of titles matches your array object. </p>\n\n<p>Otherwise you could just use something like <a href=\"https://ruby-doc.org/core-2.4.0/Enumerator.html#method-i-with_index\" rel=\"nofollow noreferrer\">Enum#with_index</a> if you just want to map the number of the yaml array to the text. </p>\n\n<pre><code>require 'psych'\nfilename = \"sample_yaml.yml\"\narray = [0, 1, 2, 3]\n\nif File.exists?(filename)\n    puts \"File exists. :) Parsing the yaml file.\"\n    yaml = Psych.load_file(filename)\n    array.each do |value|\n        yaml[value][\"title\"] &lt;&lt; \" - #{value}\" # find the title that matches the index number of array\n    end\nelse\n    raise ArgumentError, \"bad file name\"\nend\nputs \"Outputting to reformatted yaml file\"\nFile.open(\"reformatted_file.yaml\", 'wb') {|f| f.write \"%YAML 1.1\\n\" + Psych.dump(yaml)}\n</code></pre>\n\n<p>assuming yaml file like such </p>\n\n<pre><code>---\n- title: zero\n- title: one\n- title: two\n- title: three\n</code></pre>\n\n<p>Outputs </p>\n\n<pre><code>---\n- title: zero - 0\n- title: one - 1\n- title: two - 2\n- title: three - 3\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10420611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6aabcbd3b5dace08fbc6083af2dc951?s=128&d=identicon&r=PG&f=1", "display_name": "meeerf", "link": "https://stackoverflow.com/users/10420611/meeerf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538079613, "creation_date": 1537988667, "question_id": 52524503, "link": "https://stackoverflow.com/questions/52524503/ruby-yaml-dont-remove-header-yaml-1-1", "title": "ruby yaml don&#39;t remove header %YAML 1.1", "body": "<p>I have a array in ruby named array, I aded value into yaml file, but after in file.yml, it remove me %YAML 1.1, so I won't</p>\n\n<pre><code>yaml_string = File.read \"file.yaml\"\ndata = YAML.load yaml_string\narray.each do |value|\n        data[\"title\"] &lt;&lt;\"- \"+value+\"\\n\"\nend\noutput = YAML.dump data\nFile.write(\"file.yaml\", output)\n</code></pre>\n\n<p>before execution, the header is present, but after execution it remove it (%YAML 1.1) and all lines comment with #, so I won't</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "edited": false, "score": 1, "creation_date": 1537985812, "post_id": 52523868, "comment_id": 91987241, "body": "It&#39;s probably because what you did makes no sense and the block passed to <code>Dog.new</code> method isn&#39;t even evaluated, so the only thing that this piece of code returns to the console is the identifier of the new <code>Dog</code> instance, initialized by <code>new</code>."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "edited": false, "score": 0, "creation_date": 1537987105, "post_id": 52524089, "comment_id": 91987915, "body": "What does .tap mean?"}, {"owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "reply_to_user": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "edited": false, "score": 0, "creation_date": 1537987373, "post_id": 52524089, "comment_id": 91988044, "body": "This method is designed exactly for the situations like in your question: when it&#39;s necessary to pass an object to a block by calling some method of that object. There is a nice explanation of the method here: <a href=\"https://medium.com/aviabird/ruby-tap-that-method-90c8a801fd6a\" rel=\"nofollow noreferrer\">medium.com/aviabird/ruby-tap-that-method-90c8a801fd6a</a>"}], "tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": true, "score": 5, "last_activity_date": 1537986642, "creation_date": 1537986642, "answer_id": 52524089, "question_id": 52523868, "link": "https://stackoverflow.com/questions/52523868/instance-method-only-outputs-class-id-not-method-output/52524089#52524089", "title": "Instance method only outputs class id, not method output", "body": "<p>As it is suggested in comments, passing block to <code>new</code> statement makes no sense.</p>\n\n<p>You can change your code to:</p>\n\n<pre><code>bo = Dog.new('Rusty', 3).tap do |word|\n  word.bark\nend\n</code></pre>\n\n<p>and it will bark as expected. :)</p>\n"}], "owner": {"reputation": 579, "user_id": 9572280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1qIs.png?s=128&g=1", "display_name": "Practical1", "link": "https://stackoverflow.com/users/9572280/practical1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52524089, "answer_count": 1, "score": 0, "last_activity_date": 1538016714, "creation_date": 1537985672, "last_edit_date": 1538016714, "question_id": 52523868, "link": "https://stackoverflow.com/questions/52523868/instance-method-only-outputs-class-id-not-method-output", "title": "Instance method only outputs class id, not method output", "body": "<p>I was trying to see if I could transfer an instance variable's attributes using a simple <code>do</code> statement.</p>\n\n<pre><code>class Dog\n  def initialize(name, age)\n    @name = name\n    @age = age\n  end\n\n  def bark\n    puts 'Woof'\n    puts 'Woof'\n    puts 'Woof'\n  end\nend\n\nbo = Dog.new do |word|\n  word.bark\nend\n</code></pre>\n\n<p>Why does it return the class id instead of the function's output?</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 1230, "user_id": 511203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ec96aadd672b8056173e4e8a5225d8b?s=128&d=identicon&r=PG", "display_name": "Mike Gorski", "link": "https://stackoverflow.com/users/511203/mike-gorski"}, "edited": false, "score": 0, "creation_date": 1537985388, "post_id": 52523069, "comment_id": 91987063, "body": "Can you confirm the value in the <code>data-gt</code> attribute? Does it have single quotes or double quotes?"}], "answers": [{"comments": [{"owner": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "edited": false, "score": 0, "creation_date": 1538011801, "post_id": 52525045, "comment_id": 91995864, "body": "Traceback (most recent call last): \t5: from scrape.rb:10:in <code>&lt;main&gt;&#39; \t4: from scrape.rb:10:in </code>map&#39; \t3: from /Users/sino/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/n&zwnj;&#8203;okogiri-1.8.4/lib/no&zwnj;&#8203;kogiri/xml/node_set.&zwnj;&#8203;rb:203:in <code>each&#39; \t2: from &#47;Users&#47;sino&#47;.rbenv&#47;versions&#47;2.5.1&#47;lib&#47;ruby&#47;gems&#47;2.5.0&#47;gems&#47;n&zwnj;&#8203;okogiri-1.8.4&#47;lib&#47;no&zwnj;&#8203;kogiri&#47;xml&#47;node_set.&zwnj;&#8203;rb:203:in </code>upto&#39; \t1: from /Users/sino/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/n&zwnj;&#8203;okogiri-1.8.4/lib/no&zwnj;&#8203;kogiri/xml/node_set.&zwnj;&#8203;rb:204:in <code>block in each&#39; scrape.rb:11:in </code>block in &lt;main&gt;&#39;: undefined method `[]&#39; for nil:NilClass (NoMethodError)"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "reply_to_user": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "edited": false, "score": 0, "creation_date": 1538026828, "post_id": 52525045, "comment_id": 91999423, "body": "@khdeep can you please download the project pushed to github and try at your pc."}, {"owner": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "edited": false, "score": 0, "creation_date": 1538028634, "post_id": 52525045, "comment_id": 92000237, "body": "yeah it&#39;s working with your index html but when i put my index html i get error like before"}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "reply_to_user": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "edited": false, "score": 0, "creation_date": 1538028716, "post_id": 52525045, "comment_id": 92000272, "body": "check path to your index.html"}, {"owner": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "edited": false, "score": 1, "creation_date": 1538029645, "post_id": 52525045, "comment_id": 92000729, "body": "here is a file <a href=\"https://drive.google.com/file/d/1Mpb4GBQ1HhCd5W7kCygjIdcUCOzjBqRM/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1Mpb4GBQ1HhCd5W7kCygjIdcUCOzjBqRM/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": true, "score": 1, "last_activity_date": 1538026730, "last_edit_date": 1538026730, "creation_date": 1537991029, "answer_id": 52525045, "question_id": 52523069, "link": "https://stackoverflow.com/questions/52523069/ruby-nokogiri-scraping-data-url/52525045#52525045", "title": "Ruby Nokogiri Scraping data URL", "body": "<p>With these two lines you can get <code>eng_tid</code> from <code>data-hovercard</code> <code>id</code> param:</p>\n\n<pre><code>page = Nokogiri::HTML(open(Rails.root + \"app/views/home/index.html\"))\n\n@id = page.css(\"a\").map {|element| element[\"data-hovercard\"][/id=([^&amp;]*)/].gsub('id=', '')} \n</code></pre>\n\n<p>Here is github sample ruby on rails web project which will show you extracted url number on index page: <a href=\"https://github.com/nezirz/nokogiri_stackoverflow_answer\" rel=\"nofollow noreferrer\">https://github.com/nezirz/nokogiri_stackoverflow_answer</a></p>\n\n<p>So you need to clone this project to your pc <code>git clone git@github.com:nezirz/nokogiri_stackoverflow_answer.git</code> and run inside project folder <code>bundle install</code> and finally <code>rails s</code> and you will see on web site the requested number, so you can use this code as a sample and manage it to your needs.</p>\n"}], "owner": {"reputation": 223, "user_id": 8310795, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-njTmSCEgmdc/AAAAAAAAAAI/AAAAAAAAABo/HnUT2EqToqA/photo.jpg?sz=128", "display_name": "kh deep", "link": "https://stackoverflow.com/users/8310795/kh-deep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 52525045, "answer_count": 1, "score": 0, "last_activity_date": 1538026730, "creation_date": 1537982335, "last_edit_date": 1537984263, "question_id": 52523069, "link": "https://stackoverflow.com/questions/52523069/ruby-nokogiri-scraping-data-url", "title": "Ruby Nokogiri Scraping data URL", "body": "<p>Here is what I want is the <strong>id</strong> of eng_tid. so what should i do to get this id code</p>\n\n<pre><code>&lt;a data-gt=\"{\"engagement\":{\"eng_type\":\"1\",\"eng_src\":\"2\",\"eng_tid\":\"100016034050254\",\"eng_data\":[]}}\" href=\"https://www.facebook.com/thokchom.tombung?fref=pb&amp;amp;hc_location=profile_browser\" data-hovercard=\"/ajax/hovercard/user.php?id=100016034050254&amp;amp;extragetparams=%7B%22hc_location%22%3A%22profile_browser%22%7D\" data-hovercard-prefer-more-content-show=\"1\"&gt;Thokchom Tombung&lt;/a&gt;\n\nrequire 'open-uri'\nrequire 'nokogiri'\nrequire 'json'\nrequire 'csv'\n\npage = Nokogiri::HTML(open(\"index.html\"))\n\nlinks = page.css('li._5i_q').css(\"a[data-gt]\").children.map {|name| name.text }\nputs links\n\nCSV.open('fileId.csv', 'w') do |csv|\n   csv &lt;&lt; links\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "database-design", "many-to-many"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8066072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e17dcdcdef6de9304af60c054a4d74b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Diezinger", "link": "https://stackoverflow.com/users/8066072/c-diezinger"}, "edited": false, "score": 0, "creation_date": 1538657063, "post_id": 52525907, "comment_id": 92225922, "body": "Thank you. This worked fine. So I get an entry for every project_member relation. Isn&#39;t that bloating the DB?"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 55, "user_id": 8066072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e17dcdcdef6de9304af60c054a4d74b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Diezinger", "link": "https://stackoverflow.com/users/8066072/c-diezinger"}, "edited": false, "score": 0, "creation_date": 1538666321, "post_id": 52525907, "comment_id": 92232287, "body": "Is using a join table to relate two other tables &quot;bloating the database&quot;? No, it is using a relational database the way it is intended to be used and, in this particular case, following a pattern that is common in Ruby on Rails."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1537995259, "creation_date": 1537995259, "answer_id": 52525907, "question_id": 52522788, "link": "https://stackoverflow.com/questions/52522788/rails-5-model-a-many-to-many-relationship/52525907#52525907", "title": "Rails 5 model a many to many relationship", "body": "<p>Yes, <code>has_many :through</code> makes sense for your many-to-many association. (I don't tend to use <code>has_and_belongs_to_many</code>, but that's mostly a personal preference.)</p>\n\n<p>It might look something like: </p>\n\n<h3>User</h3>\n\n<pre><code># == Schema Information\n#\n# Table name: users\n#\n#  id                       :integer          not null, primary key\n#  created_at               :datetime         not null\n#  updated_at               :datetime         not null\n#\nclass User &lt; ApplicationRecord\n  has_many    :owned_projects, class_name: \"Project\", foreign_key: :owner_id\n  has_many    :project_members, foreign_key: :member_id\n  has_many    :projects, through: :project_members\nend\n</code></pre>\n\n<h3>Project</h3>\n\n<pre><code># == Schema Information\n#\n# Table name: projects\n#\n#  id                       :integer          not null, primary key\n#  owner_id                 :integer\n#  created_at               :datetime         not null\n#  updated_at               :datetime         not null\n#\nclass Project &lt; ApplicationRecord\n  belongs_to  :owner, class_name: \"User\"\n  has_many    :project_members\n  has_many    :members, through: :project_members\nend\n</code></pre>\n\n<h3>ProjectMember</h3>\n\n<pre><code># == Schema Information\n#\n# Table name: project_members\n#\n#  id                       :integer          not null, primary key\n#  member_id                :integer\n#  project_id               :integer\n#  created_at               :datetime         not null\n#  updated_at               :datetime         not null\n#\nclass ProjectMembers &lt; ApplicationRecord\n  belongs_to  :member, class_name: \"User\"\n  belongs_to  :project\nend\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8066072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e17dcdcdef6de9304af60c054a4d74b?s=128&d=identicon&r=PG&f=1", "display_name": "C.Diezinger", "link": "https://stackoverflow.com/users/8066072/c-diezinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 52525907, "answer_count": 1, "score": 0, "last_activity_date": 1537995259, "creation_date": 1537981197, "question_id": 52522788, "link": "https://stackoverflow.com/questions/52522788/rails-5-model-a-many-to-many-relationship", "title": "Rails 5 model a many to many relationship", "body": "<p>I have two models, project and users and I want to connect them as follows:</p>\n\n<pre><code>class Project &lt; ApplicationRecord\n  belongs_to :owner, class_name: \"User\"\n  has_many :members, class_name: \"User\"\nend\n\nclass User &lt; ApplicationRecord\n  has_many :projects\nend\n</code></pre>\n\n<p>Migration looks like this.</p>\n\n<pre><code>class AddReferencesToProject &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_reference :projects, :owner\n    add_foreign_key :projects, :users, column: :owner_id, primary_key: :id\n  end\nend\n</code></pre>\n\n<p>I did this migration for members_id but I want it to have more then one user_id:</p>\n\n<pre><code>class AddMembersReferencesToProject &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_reference :projects, :members\n    add_foreign_key :projects, :users, column: :members_id, primary_key: :id\n  end\nend\n</code></pre>\n\n<p>Do I need to make a many_to many :through association? I\u00b4m stuck on this.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "edited": false, "score": 1, "creation_date": 1537982190, "post_id": 52522425, "comment_id": 91985569, "body": "I have a suspicion that your <code>f</code> variable is perhaps not what you think it is. Could you perhaps add a <code>&lt;% Rails.logger.info f %&gt;</code> in your <code>expense_fields.html.erb</code> file so you can see what you are dealing with? I&#39;d expect <code>selected: f.expense_name</code> or <code>f.object.expense_name</code> should work in this scenario."}, {"owner": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "edited": false, "score": 0, "creation_date": 1537982253, "post_id": 52522425, "comment_id": 91985614, "body": "In your partial, your only reference to these nested expenses is the local variable <code>f</code> that references the current <code>expense</code> in a for loop."}, {"owner": {"reputation": 1583, "user_id": 5253108, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/o5DQ1.jpg?s=128&g=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5253108/trenton-tyler"}, "reply_to_user": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "edited": false, "score": 0, "creation_date": 1537982764, "post_id": 52522425, "comment_id": 91985867, "body": "So <code>f.object.expense_name</code> did in fact work. When I did the logger it returned <code>true</code> so i&#39;m not sure what that is about. After seeing that it makes sense as to what object is referencing since it is passed in the fields for render method."}, {"owner": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "edited": false, "score": 0, "creation_date": 1537985555, "post_id": 52522425, "comment_id": 91987131, "body": "Great! For clarity I&#39;ve added that as the answer. Cheers!"}], "answers": [{"tags": [], "owner": {"reputation": 13459, "user_id": 550349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QSyCs.jpg?s=128&g=1", "display_name": "stef", "link": "https://stackoverflow.com/users/550349/stef"}, "is_accepted": true, "score": 0, "last_activity_date": 1537985540, "creation_date": 1537985540, "answer_id": 52523838, "question_id": 52522425, "link": "https://stackoverflow.com/questions/52522425/fields-for-selected-value/52523838#52523838", "title": "Fields for selected value", "body": "<p>When you are using <code>fields_for</code>, each item that you then reference is available as <code>.object</code> on each <code>field</code> instance. So in this case, use:</p>\n\n<pre><code>f.select(selected: f.object.expense_name  ...\n</code></pre>\n"}], "owner": {"reputation": 1583, "user_id": 5253108, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/o5DQ1.jpg?s=128&g=1", "display_name": "Trenton Tyler", "link": "https://stackoverflow.com/users/5253108/trenton-tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52523838, "answer_count": 1, "score": 0, "last_activity_date": 1537985540, "creation_date": 1537979619, "question_id": 52522425, "link": "https://stackoverflow.com/questions/52522425/fields-for-selected-value", "title": "Fields for selected value", "body": "<p>I have a form that has a fields for helper in it and I need to get the value of each of those fields in my rails application. </p>\n\n<pre><code>&lt;%= form.fields_for :expenses do |expense| %&gt;\n      &lt;%= render 'expense_fields', f: expense %&gt;\n&lt;% end %&gt;\n&lt;%= link_to_add_fields \"Add field\", form, :expenses %&gt;\n</code></pre>\n\n<p><strong>expense_fields.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-5\"&gt;\n    &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :expense_name %&gt;\n        &lt;%= f.select(:expense_name, options_for_select([['Hotel', 'hotel'], \n        ['Registration', 'registration'], \n        ['Meals', 'meals'], \n        ['Flight', 'flight'], \n        ['Mileage', 'mileage'],\n        ['Car Rental', 'car rental'],\n        ['Parking', 'parking'],\n        ['Traning', 'training']],), { include_blank: true }, id: 'principal_selection', class: 'form-control') %&gt; \n    &lt;/div&gt;\n  &lt;/div&gt;\n    &lt;% if current_user.admin? || current_user.principal? || current_user.super? %&gt;\n      &lt;div class=\"col-md-3\"&gt;\n    &lt;% else %&gt;\n      &lt;div class=\"col-md-7\"&gt;\n    &lt;% end %&gt;\n      &lt;div class=\"form-group\"&gt;\n        &lt;%= f.label :expense_cost %&gt;\n        &lt;%= f.number_field :cost, class: 'form-control', placeholder: 'Cost', step: :any %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;% if current_user.principal? || current_user.admin? || current_user.super? %&gt;\n  &lt;div class=\"col-md-4\"&gt;\n    &lt;div class=\"form-group\"&gt;\n      &lt;%= f.label :payment_type %&gt;\n      &lt;%= f.select(:payment_type, options_for_select([['Out of pocket', 'Out of Pocket'], ['Corporate Card', 'Corporate Card'], ['PO', 'PO']], selected: \"Half Day\"), { include_blank: false }, class: 'form-control') %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have checked around the rails guides and was not able to find a way to directly extract the value for each fields for in the select helper. Anybody have any ideas?</p>\n\n<p>I tried doing <code>selected: \"#{@expense.expense_name}\"</code> but get a nil error because @expense is not defined. So I went into the edit method in the pdforms controller and tried this:</p>\n\n<pre><code>def edit\n@expenses = @pdform.expenses\nend\n</code></pre>\n\n<p>That yielded no result so I tried this:</p>\n\n<pre><code>def edit\n@expenses = @pdform.expenses\n@expenses.each do |ex| \n  @expense = ex\nend\n</code></pre>\n\n<p>But that just returned one value in the form when it is being edited. Any other ideas? </p>\n"}, {"tags": ["ruby", "rails-migrations"], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": false, "score": 1, "last_activity_date": 1537978622, "last_edit_date": 1537978622, "creation_date": 1537978198, "answer_id": 52522088, "question_id": 52521976, "link": "https://stackoverflow.com/questions/52521976/ruby-on-rails-new-migration-and-model-change-causing-migration-failure/52522088#52522088", "title": "Ruby On Rails - new migration and model change causing migration failure", "body": "<p>Whenever using your ActiveRecord models in migrations, it is wise to define them within these migrations, so any changes to your models in the future won't break old migrations.</p>\n\n<pre><code>class Parent &lt; ApplicationRecord; end\n</code></pre>\n\n<p>or in a nicer way, if your class does not need to do anything</p>\n\n<pre><code>Parent = Class.new(ApplicationRecord)\n</code></pre>\n\n<p>added inside your migration class should fix your issue. </p>\n\n<p>Side note: if you simply want to delete all the records from <code>parents</code> table, it would be better to call to call <code>Parent.delete_all</code> in your migration. This would also solve the issue, but adding models to migrations is good practice.</p>\n"}, {"tags": [], "owner": {"reputation": 6571, "user_id": 244702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/22b3a019954e1e8a25f303a5ed555340?s=128&d=identicon&r=PG", "display_name": "Kevin Robatel", "link": "https://stackoverflow.com/users/244702/kevin-robatel"}, "is_accepted": false, "score": 0, "last_activity_date": 1537979101, "creation_date": 1537979101, "answer_id": 52522292, "question_id": 52521976, "link": "https://stackoverflow.com/questions/52521976/ruby-on-rails-new-migration-and-model-change-causing-migration-failure/52522292#52522292", "title": "Ruby On Rails - new migration and model change causing migration failure", "body": "<p>You should not use ActiveRecord models in the migration. ActiveRecord doesn't like when Ruby class and schema doesn't match. And it can happens if multiple migration need to be run.</p>\n\n<p>I suggest to only use SQL queries in migration. </p>\n\n<pre><code>def up\n  execute &lt;&lt;-SQL\n    DELETE FROM parent WHERE name = \"TestName\";\n  SQL\nend\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9977050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd3d3c6e082d985c93da13f4000f38d?s=128&d=identicon&r=PG&f=1", "display_name": "devwest", "link": "https://stackoverflow.com/users/9977050/devwest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537979101, "creation_date": 1537977814, "question_id": 52521976, "link": "https://stackoverflow.com/questions/52521976/ruby-on-rails-new-migration-and-model-change-causing-migration-failure", "title": "Ruby On Rails - new migration and model change causing migration failure", "body": "<p>I've created a new migration to add a new table. Lets call it \nnew_items which creates a new table.</p>\n\n<p>in the migration, i've specified that the relationship with another table</p>\n\n<pre><code>t.belongs_to :parent\n</code></pre>\n\n<p>In my model, </p>\n\n<pre><code>class NewItem &lt; ApplicationRecord\nbelongs_to :parent\n\nclass Parent &lt; ApplicationRecord\nhas_many :new_items, :dependent =&gt; :destroy\n</code></pre>\n\n<p>So when I run all migration from scratch, there is a failure on an older migration\n\"could not find table 'new_items'\"\nin the failed migration, this is the line that where the problem lies</p>\n\n<pre><code>def up\n Parent.where(name: \"TestName\").destroy_all\nend\n</code></pre>\n\n<p>there is something wrong with my Parent model, as when i remove this following line it runs to completion</p>\n\n<pre><code>has_many :new_items, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I know the issue is with the relationship between Parent and NewItem, but not sure how its best fixed</p>\n\n<p>I can kinda see why its happening, but not sure how to resolve it while still keeping the relationship between the tables</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "paperclip"], "comments": [{"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1537976122, "post_id": 52521380, "comment_id": 91982436, "body": "and what the size of your image was before uploading I mean height x width?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 1, "creation_date": 1538030418, "post_id": 52521380, "comment_id": 92001123, "body": "Hi @Nezir, the size is 2000x7096px"}, {"owner": {"reputation": 27168, "user_id": 7355741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6CMNt.jpg?s=128&g=1", "display_name": "fmw42", "link": "https://stackoverflow.com/users/7355741/fmw42"}, "edited": false, "score": 0, "creation_date": 1538069677, "post_id": 52521380, "comment_id": 92024551, "body": "Is the issue a change in dimensions or a change in file size?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1538141390, "post_id": 52521380, "comment_id": 92051400, "body": "The dimension changes as I would like, but even if the dimension is smaller, the file size increases enormously"}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 1, "creation_date": 1538052603, "post_id": 52531524, "comment_id": 92014136, "body": "Thanks for your answer, but the more I decrease the quality, the more the weight increases, it&#39;s really weird"}], "tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": false, "score": 1, "last_activity_date": 1538032694, "creation_date": 1538032694, "answer_id": 52531524, "question_id": 52521380, "link": "https://stackoverflow.com/questions/52521380/image-weight-higher-after-upload-with-paperclip/52531524#52531524", "title": "Image weight higher after upload with paperclip", "body": "<p>Can you try setting <code>convert_options</code> at model paperclip options like sample belove?  Like  <code>-quality 80</code>? or much lover. Please try to manipulate with this option and then upload test file size. </p>\n\n<pre><code>has_attached_file :avatar, \n                  :styles          =&gt; { :thumb =&gt; '50x50#' },\n                  :convert_options =&gt; { :thumb =&gt; '-quality 80' }\n</code></pre>\n\n<p>Because paperclip using in a background ImageMagick and it have some default settings for manipulating images in process of uploading:\n\"The default is to use the estimated quality of your input image if it can be determined, otherwise 92. When the quality is greater than 90, then the chroma channels are not downsampled. Use the -sampling-factor option to specify the factors for chroma downsampling.\"</p>\n\n<p>I am suggesting you to try this convert_options and check the result.</p>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538142661, "creation_date": 1537975841, "last_edit_date": 1538142661, "question_id": 52521380, "link": "https://stackoverflow.com/questions/52521380/image-weight-higher-after-upload-with-paperclip", "title": "Image weight higher after upload with paperclip", "body": "<p>I have a problem with paperclip. When I'm uploading an .png image of 507ko, the result is an image of... 2.1Mb, almost 4x bigger.</p>\n\n<p>I only have this problem with PNGs in portrait format. JPGs get a little heavier too but only few bytes.</p>\n\n<p>Also, the problem only appears with my 'extra' format.</p>\n\n<p>This is my code:</p>\n\n<pre><code>  has_attached_file :image,\n                styles: { extra: \"1280x3000&gt;\", large: \"640x480&gt;\", medium: \"200x120#\"}\n</code></pre>\n\n<p>And the image if you want to try: <a href=\"https://www.groupe-pratique.com/wp-content/uploads/2018/04/Les-chiffres-du-marketing-automation-infographie-1.png\" rel=\"nofollow noreferrer\">https://www.groupe-pratique.com/wp-content/uploads/2018/04/Les-chiffres-du-marketing-automation-infographie-1.png</a></p>\n\n<p>Have you ever had this problem?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>In fact, the problem doesn't appear only with extra size, but with the other sizes, the difference is too tiny to be seen. The problem is... problematic with big sizes.</p>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>I solved the problem by convert the PNG files to JPG. It's not a problem in my case but if you really need a PNG file, I didn't find a solution. :/</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537975894, "post_id": 52521338, "comment_id": 91982300, "body": "Why would you expect this constant to be accessible via <code>Foo::Api::Utility</code> module?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537975968, "post_id": 52521338, "comment_id": 91982336, "body": "I am not sure I understood the question, but you might have been after <code>@utility.singleton_class.const_set(&#39;BASE_URL&#39;,&#39;https:&#47;&#47;domai&zwnj;&#8203;n.tld&#47;api&#47;v1&#39;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1537976046, "post_id": 52521439, "comment_id": 91982390, "body": "<code>@utility = Class.new { include Foo::Api::Utility; BASE_URL = &#39;https:&#47;&#47;domain.tld&#47;api&#47;v1&#39; }.new</code>?"}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537976408, "post_id": 52521439, "comment_id": 91982613, "body": "Passing block to Class initializer is nice, I&#39;ll try to remember it."}, {"owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537976575, "post_id": 52521439, "comment_id": 91982723, "body": "@mudasobwa, I like your suggestion.  I wasn&#39;t aware that this could be done."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1537978727, "post_id": 52521439, "comment_id": 91983876, "body": "My suggestion does effectively the same as the original answer provided by @MarcinKo\u0142odziej. I took the responsibility to update the answer, providing my variant."}, {"owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "edited": false, "score": 0, "creation_date": 1537983041, "post_id": 52521439, "comment_id": 91986012, "body": "When the code reaches the reference to the constant (<code>url =  &quot;#{self.class::BASE_URL}&#47;resources&#47;&quot;</code>) in the class that includes the module, it generates an error: <code>uninitialized constant #&lt;Class:0x00007fcc58832698&gt;::BASE_URL</code>."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1537983493, "post_id": 52521439, "comment_id": 91986215, "body": "Well, seems like the solutions are not the same after all. <code>const_set</code> does work, while defining <code>BASE_URL</code> in block defines it level higher instead of in Class initializer block."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "edited": false, "score": 0, "creation_date": 1538020396, "post_id": 52521439, "comment_id": 91997631, "body": "@craig fixed; sorry for misleading edit, I would blame ruby for that :)"}], "tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 2, "last_activity_date": 1538020356, "last_edit_date": 1538020356, "creation_date": 1537975984, "answer_id": 52521439, "question_id": 52521338, "link": "https://stackoverflow.com/questions/52521338/dynamically-add-a-constant-value-to-a-ruby-instance/52521439#52521439", "title": "Dynamically add a constant value to a Ruby instance", "body": "<p>What about: </p>\n\n<pre><code>before(:each) do\n  @utility_class = Class.new\n  @utility_class.include(Foo::Api::Utility)\n  @utility_class.const_set('BASE_URL','https://domain.tld/api/v1')\n  @utility = @utility_class.new\nend\n</code></pre>\n\n<hr>\n\n<p>Or, in more succinct manner:</p>\n\n<pre><code>before(:each) do\n  @utility =\n    Class.new do\n      include Foo::Api::Utility\n      const_set :BASE_URL,'https://domain.tld/api/v1'\n    end.new\nend\n</code></pre>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 52521439, "answer_count": 1, "score": 1, "last_activity_date": 1538020356, "creation_date": 1537975680, "question_id": 52521338, "link": "https://stackoverflow.com/questions/52521338/dynamically-add-a-constant-value-to-a-ruby-instance", "title": "Dynamically add a constant value to a Ruby instance", "body": "<p>I'm testing a module (<code>Foo::Api::Utility</code>) by creating a dummy instance.  The module references a constant that has been defined by the class that <code>includes</code> it (<code>self.class::BASE_URL</code>).</p>\n\n<p>I'd like to be able to access this value and set it.</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>before(:each) do\n  @utility = Object.new\n  @utility.extend(Foo::Api::Utility)\n  @utility.const_set('BASE_URL','https://domain.tld/api/v1')\nend\n</code></pre>\n\n<p>What's the correct way to do this?</p>\n"}, {"tags": ["ruby", "rspec", "yield"], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 1, "last_activity_date": 1537975720, "creation_date": 1537975720, "answer_id": 52521346, "question_id": 52521314, "link": "https://stackoverflow.com/questions/52521314/how-to-use-a-dynamic-number-of-yield-statements-in-ruby/52521346#52521346", "title": "How to use a dynamic number of yield statements in Ruby", "body": "<p>Like this?</p>\n\n<pre><code>within_page_frame do \n  expect(find_by_id('home page')).to be\n  expect(find_by_id('something else')).to be\nend\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9830334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2f6X.jpg?s=128&g=1", "display_name": "CaptainKidd", "link": "https://stackoverflow.com/users/9830334/captainkidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 52521346, "answer_count": 1, "score": 0, "last_activity_date": 1537975720, "creation_date": 1537975612, "question_id": 52521314, "link": "https://stackoverflow.com/questions/52521314/how-to-use-a-dynamic-number-of-yield-statements-in-ruby", "title": "How to use a dynamic number of yield statements in Ruby", "body": "<pre><code>  def within_page_frame\n    application_tab = window_opened_by { click_link('Application Info') }\n    within_window application_tab do\n    within_frame find_by_id('ApplicationInfo') do\n      yield\n      end\n    end\n end\n\n it 'should view the web page', :smoke do\n   visit_home_page p\n   application_tab = window_opened_by { click_link('Application Info') }\n   within_page_frame {expect(find_by_id('home page').to be}\n end\n</code></pre>\n\n<p>Here is code that is currently working. I am using the method \"within_page_frame\" to avoid repeating code in other specs in my test suite. </p>\n\n<p>What I would like to do is be able to pass in <strong>multiple expect statements</strong> without having to specify the exact number of yield statements in the within_page_frame method. Is there a way to have a <strong>dynamic number of yield statements</strong> in my method so that I can pass in any number of expect statements?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubocop"], "comments": [{"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "edited": false, "score": 1, "creation_date": 1537974472, "post_id": 52520697, "comment_id": 91981410, "body": "you can at least skip the last <code>when</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1537974599, "post_id": 52520697, "comment_id": 91981489, "body": "What are you aiming for? Understanding why you get this warning? Disable the Rubocop warning? Just do the bare minimum to avoid the Rubocop warning or refactor your code to be more readable?"}], "answers": [{"tags": [], "owner": {"reputation": 2496, "user_id": 3046905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/692eb06201cbed91c3c6a9cf11ed0511?s=128&d=identicon&r=PG", "display_name": "Ilya Konyukhov", "link": "https://stackoverflow.com/users/3046905/ilya-konyukhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1537976663, "creation_date": 1537976663, "answer_id": 52521644, "question_id": 52520697, "link": "https://stackoverflow.com/questions/52520697/rubocop-metrics-cyclomaticcomplexity-in-case-when/52521644#52521644", "title": "Rubocop Metrics/CyclomaticComplexity in case when", "body": "<p>I noticed that you use</p>\n\n<p><code>h.company_dot_application_applications_requests_path(dot_application_id: dot.id)</code></p>\n\n<p>in one place and</p>\n\n<p><code>h.company_dot_application_applications_requests_path(dot.id)</code></p>\n\n<p>in another. If these calls are equal, the method can be simplified a bit:</p>\n\n<pre><code>def notification_path\n  return h.company_trial_activation_index_path if User.current.company.trial_pending?\n\n  dot = object.eventable\n\n  case object.event.to_sym\n  when :new_app, :updates_approved, :updates_disapproved, :new_partial_app, :completed_app, :received_lead\n    h.company_dot_application_path(id: dot.id)\n  when :bg_check_received, :bg_check_failed, :bg_check_completed\n    h.company_dot_application_background_checks_path(dot)\n  when :voe_completed, :voe_corrected, :voe_invalid, :voe_driving_school_completed, :voe_driving_school_corrected, :voe_driving_school_invalid, :voe_instructions, :voe_driving_school_instructions\n    h.company_dot_application_applications_requests_path(dot.id)\n  when :email_reply, :note, :sms_reply\n    h.company_dot_application_communications_path(dot.id)\n  when :follow_up_task, :follow_up_task_on_due_date\n    h.company_dot_application_follow_up_tasks_path(dot_application_id: dot.id)\n  else\n    h.home_users_path\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 3, "last_activity_date": 1537979639, "last_edit_date": 1537979639, "creation_date": 1537977224, "answer_id": 52521817, "question_id": 52520697, "link": "https://stackoverflow.com/questions/52520697/rubocop-metrics-cyclomaticcomplexity-in-case-when/52521817#52521817", "title": "Rubocop Metrics/CyclomaticComplexity in case when", "body": "<p>Before we get to cyclomatic complexity, let's address two bigger problems with that function. The giant lists of arrays, and the globals. Because the purpose of Rubocop is to make your code easier to read and maintain and reduce the possibility of bugs, not ticking things off a list.</p>\n\n<p>Things would be a lot more readable if the symbol lists were named.</p>\n\n<pre><code>WHATEVER_THESE_ARE = [\n  :new_app, :updates_approved, :updates_disapproved,\n  :new_partial_app, :completed_app, :received_lead\n].freeze\nBG_CHECK_DONE = [\n  :bg_check_received, :bg_check_failed, :bg_check_completed\n].freeze\n...and so on...\n\ndef notification_path\n  return h.company_trial_activation_index_path if User.current.company.trial_pending?\n\n  dot = object.eventable\n\n  case object.event.to_sym\n  when WHATEVER_THESE_ARE\n    h.company_dot_application_path(id: dot.id)\n  when BG_CHECK_DONE\n    h.company_dot_application_background_checks_path(dot)\n  ...and so on...\n  end\nend\n</code></pre>\n\n<hr>\n\n<p>Then notice that your function takes no arguments. It uses two globals, the vaguely named <code>object</code> and <code>h</code>. I don't know what these really are, the names don't help, but maybe you sanitized them for the question. Using them as globals makes the code more complex. They should be passed in as parameters, or at least descriptively named.</p>\n\n<pre><code>def notification_path(better_name_for_h, better_name_for_object)\n  ...\nend\n</code></pre>\n\n<hr>\n\n<p>Ok, on to cyclonic complexity. A <code>case</code> is basically a big if/elsif/else with each <code>when</code> adding a point of complexity. With a table this large it seems like there isn't much we can do, but let's start by observing that the case only depends on <code>object.event</code>, <code>object.eventable</code> (event table? why is it named <code>dot</code>?), and <code>h</code>. We can do an extract method.</p>\n\n<pre><code>def notification_path(h, object)\n  return h.company_trial_activation_index_path if User.current.company.trial_pending?\n\n  dot_to_application_path(object.event, object.eventable, h)\nend\n\ndef dot_to_application_path(event, dot, h)\n  case event.to_sym\n  when WHATEVER_THESE_ARE\n    h.company_dot_application_path(id: dot.id)\n  when BG_CHECK_DONE\n    h.company_dot_application_background_checks_path(dot)\n  ...\n  else\n    h.home_users_path\n  end\nend\n</code></pre>\n\n<p>That cut off a grand total of 1 giving us 8. Others have observed the final condition is redundant, so cut that off giving 7. Sometimes you just know better than Rubocop that the logic really is this complex and can add an exception.</p>\n\n<pre><code># rubocop:disable Metrics/CyclonicComplexity\ndef dot_to_application_path(event, dot, h)\n</code></pre>\n\n<p>This is a last resort. It's always worth considering Rubocop's complaints. We've already improved the code quite a bit by trying to fix the Rubocop issues.</p>\n\n<p>Or we can dig further.</p>\n\n<p>We can observe that this table is doing <em>two</em> things. It's selecting the appropriate path method <em>and</em> normalizing how it's called. Every path method takes the <code>dot</code> slightly differently and this makes things more complex and error prone.</p>\n\n<p>If the methods were consistent we could replace the case with a hash lookup.</p>\n\n<pre><code>WHATEVER_THESE_ARE = [\n  :new_app, :updates_approved, :updates_disapproved,\n  :new_partial_app, :completed_app, :received_lead\n].freeze\nBG_CHECK_DONE = [\n  :bg_check_received, :bg_check_failed, :bg_check_completed\n].freeze\n...\n\n# You'll want to put this somewhere else.\ndef flatten_keys(hash)\n  hash.each_with_object({}) { |(keys, value), new_hash|\n    keys.each { |key| new_hash[event] = value }\n  }\nend  \n\nEVENT_TO_APPLICATION_PATH_METHOD = flatten_keys({\n  WHATEVER_THESE_ARE =&gt; :company_dot_application_path,\n  BG_CHECK_DONE =&gt; :company_dot_application_background_checks_path,\n  ...\n}).freeze\n\ndef notification_path(h, object)\n  return h.company_trial_activation_index_path if User.current.company.trial_pending?\n\n  method = EVENT_TO_DOT_APPLICATION_PATH_METHOD[object.event.to_sym] || :home_users_path\n  h.send(method, dot)\nend\n</code></pre>\n\n<p>Now we can see how simple this code can be!</p>\n\n<p>To accomplish you could refactor the methods so they are consistent, or you can write wrapper methods which make it consistent. Refactoring is the preferable option, but that might be well out of your scope.</p>\n\n<p>Finally, this might all be complex enough to warrant putting all the logic into a class.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10346789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2419, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1537979639, "creation_date": 1537973746, "question_id": 52520697, "link": "https://stackoverflow.com/questions/52520697/rubocop-metrics-cyclomaticcomplexity-in-case-when", "title": "Rubocop Metrics/CyclomaticComplexity in case when", "body": "<p>Metrics/CyclomaticComplexity: Cyclomatic complexity for notification_path is too high. [9/8]\nAnd I don't understand how to fix that. Can you help me, someone? Thanks </p>\n\n<pre><code>def notification_path\n  return h.company_trial_activation_index_path if User.current.company.trial_pending?\n\n  dot = object.eventable\n\n  case object.event.to_sym\n  when :new_app, :updates_approved, :updates_disapproved, :new_partial_app, :completed_app, :received_lead\n    h.company_dot_application_path(id: dot.id)\n  when :bg_check_received, :bg_check_failed, :bg_check_completed\n    h.company_dot_application_background_checks_path(dot)\n  when :voe_completed, :voe_corrected, :voe_invalid,\n    :voe_driving_school_completed, :voe_driving_school_corrected, :voe_driving_school_invalid\n    h.company_dot_application_applications_requests_path(dot_application_id: dot.id)\n  when :voe_instructions, :voe_driving_school_instructions\n    h.company_dot_application_applications_requests_path(dot.id)\n  when :email_reply, :note, :sms_reply\n    h.company_dot_application_communications_path(dot.id)\n  when :follow_up_task, :follow_up_task_on_due_date\n    h.company_dot_application_follow_up_tasks_path(dot_application_id: dot.id)\n  when :bulk_actions_background_location, :bulk_actions_background_assign_user, :bulk_actions_background_lead_source\n    h.home_users_path\n  else\n    h.home_users_path\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "mobility"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1537978490, "post_id": 52520200, "comment_id": 91983762, "body": "What columns does <code>posts</code> table have?"}, {"owner": {"reputation": 25857, "user_id": 820254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb7f91e7b7b3457ca57701a40f920f2a?s=128&d=identicon&r=PG", "display_name": "Chris Salzberg", "link": "https://stackoverflow.com/users/820254/chris-salzberg"}, "edited": false, "score": 0, "creation_date": 1538269050, "post_id": 52520200, "comment_id": 92083706, "body": "I noticed you tagged this with ruby-on-rails-3. Are you really using Mobility with RoR3? It is not tested against versions that old, the oldest it has been tested against is RoR 4.2. You may have some issues with it using such an old version of Rails."}, {"owner": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "reply_to_user": {"reputation": 25857, "user_id": 820254, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb7f91e7b7b3457ca57701a40f920f2a?s=128&d=identicon&r=PG", "display_name": "Chris Salzberg", "link": "https://stackoverflow.com/users/820254/chris-salzberg"}, "edited": false, "score": 0, "creation_date": 1538312682, "post_id": 52520200, "comment_id": 92091408, "body": "@ChrisSalzberg sorry, it&#39;s mistake"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "edited": false, "score": 0, "creation_date": 1538025324, "post_id": 52524699, "comment_id": 91998897, "body": "Excellent!  locale_posts_ids = Mobility::ActiveRecord::StringTranslation                           .where(                             locale: I18n.locale,                             translatable_type: &#39;Post&#39;                           )                           .pluck(:translatable_id)     @posts = Post.where(id: locale_posts_ids)"}, {"owner": {"reputation": 66, "user_id": 8145050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gvHsa.png?s=128&g=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/8145050/nick-d"}, "reply_to_user": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "edited": false, "score": 0, "creation_date": 1538059845, "post_id": 52524699, "comment_id": 92019130, "body": "Perfect! Glad i could help :)"}, {"owner": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "edited": false, "score": 0, "creation_date": 1538116099, "post_id": 52524699, "comment_id": 92037963, "body": "I see sometimes this exception: uninitialized constant Mobility::ActiveRecord::StringTranslation Hmm... You have idea?"}, {"owner": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "edited": false, "score": 1, "creation_date": 1538117340, "post_id": 52524699, "comment_id": 92038505, "body": "require &#39;mobility/active_record/string_translation&#39; helps"}, {"owner": {"reputation": 66, "user_id": 8145050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gvHsa.png?s=128&g=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/8145050/nick-d"}, "reply_to_user": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "edited": false, "score": 0, "creation_date": 1538118234, "post_id": 52524699, "comment_id": 92038940, "body": "Yes you &#39;re right!! I just tested it to the console. You need the require &#39;mobility/active_record/string_translation&#39; otherwise you have to  load first the  Post.all"}], "tags": [], "owner": {"reputation": 66, "user_id": 8145050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gvHsa.png?s=128&g=1", "display_name": "Nick D", "link": "https://stackoverflow.com/users/8145050/nick-d"}, "is_accepted": true, "score": 3, "last_activity_date": 1537990427, "last_edit_date": 1537990427, "creation_date": 1537989411, "answer_id": 52524699, "question_id": 52520200, "link": "https://stackoverflow.com/questions/52520200/how-do-i-filter-records-by-locale-using-gem-mobility/52524699#52524699", "title": "How do I filter records by locale using gem mobility?", "body": "<p>First of all you may have a column.(Lets say title.)</p>\n\n<p>On your model <code>post.rb</code> you will have something like this:</p>\n\n<pre><code>        class Post &lt; ApplicationRecord\n          extend Mobility\n          translates :title,  type: :string, locale_accessors: [:en, :de]\n        end     \n</code></pre>\n\n<p>The type is important in order to get the :de records(or the :en).</p>\n\n<p>At <code>schema.rb</code> wou will see a table mobility_<strong>string</strong>_translations</p>\n\n<pre><code>  create_table \"mobility_string_translations\", force: :cascade do |t|\n    t.string \"locale\", null: false\n    t.string \"key\", null: false\n    t.string \"value\"\n    t.integer \"translatable_id\", null: false\n    t.string \"translatable_type\", null: false\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"translatable_id\", \"translatable_type\", \"key\"], name: \"index_mobility_string_translations_on_translatable_attribute\"\n    t.index [\"translatable_id\", \"translatable_type\", \"locale\", \"key\"], name: \"index_mobility_string_translations_on_keys\", unique: true\n    t.index [\"translatable_type\", \"key\", \"value\", \"locale\"], name: \"index_mobility_string_translations_on_query_keys\"\n  end\n</code></pre>\n\n<p>Well now at your console find your records with <strong>locale: :de</strong></p>\n\n<pre><code>irb:&gt; Post.all\n\nirb:&gt; Mobility::ActiveRecord::StringTranslation.where(locale: :de)\n</code></pre>\n\n<p>As you can see at your schema.rb --> \"mobility_string_translations\"  you can  play around with your columns in order to find exactly what you want.</p>\n"}], "owner": {"reputation": 13, "user_id": 10148602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74dddbebb2d6fff755003a3de9373ab6?s=128&d=identicon&r=PG&f=1", "display_name": "deboyo", "link": "https://stackoverflow.com/users/10148602/deboyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 52524699, "answer_count": 1, "score": 1, "last_activity_date": 1538312697, "creation_date": 1537972312, "last_edit_date": 1538312697, "question_id": 52520200, "link": "https://stackoverflow.com/questions/52520200/how-do-i-filter-records-by-locale-using-gem-mobility", "title": "How do I filter records by locale using gem mobility?", "body": "<p>I have a table mobility_string_translations, but I do not understand how to get to it. </p>\n\n<p>Now I have three records. Two records in German and one in Spanish. I want to get only those records that are in German.</p>\n\n<p>this not working:</p>\n\n<pre><code>all_de_posts = Post.i18n.find_by(locale: :de)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "glassfish", "jruby"], "answers": [{"tags": [], "owner": {"reputation": 6788, "user_id": 454312, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jNMNF.jpg?s=128&g=1", "display_name": "kares", "link": "https://stackoverflow.com/users/454312/kares"}, "is_accepted": false, "score": 0, "last_activity_date": 1538482756, "creation_date": 1538482756, "answer_id": 52608198, "question_id": 52520184, "link": "https://stackoverflow.com/questions/52520184/glassfish-server-settings/52608198#52608198", "title": "Glassfish server settings", "body": "<p>it depends on Rails version but you might want to try <code>warble</code>-ing with \n<code>\nconfig.webxml.jruby.min.runtimes = 1\nconfig.webxml.jruby.max.runtimes = 1\n</code></p>\n"}], "owner": {"reputation": 1, "user_id": 1300665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dfcbfaf85576c9e3e886a1668bd68b3?s=128&d=identicon&r=PG", "display_name": "user1300665", "link": "https://stackoverflow.com/users/1300665/user1300665"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538482756, "creation_date": 1537972283, "question_id": 52520184, "link": "https://stackoverflow.com/questions/52520184/glassfish-server-settings", "title": "Glassfish server settings", "body": "<p>We have a glassfish server and jruby application deployed, server side code always entertain the only single request.Is there any way where we can force it to process parallel threads.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1537970308, "post_id": 52519397, "comment_id": 91978544, "body": "I get the following error with this code: <code>You have passed Hash object to #or. Pass an ActiveRecord::Relation object instead</code>."}, {"owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1537970677, "post_id": 52519397, "comment_id": 91978783, "body": "Thanks, that worked. It makes no sense to me why the original query with <code>.where(users: {id: @job.user_ids})</code> didn&#39;t work though."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "reply_to_user": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "edited": false, "score": 0, "creation_date": 1537975067, "post_id": 52519397, "comment_id": 91981786, "body": "No worries. Just FYI you don&#39;t include the objects your searching through in the argument itself, but instead call where on them. So users.where(id: user_ids) rather than where(users: { id: user_ids} )"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": true, "score": 4, "last_activity_date": 1537970347, "last_edit_date": 1537970347, "creation_date": 1537969998, "answer_id": 52519397, "question_id": 52519236, "link": "https://stackoverflow.com/questions/52519236/or-statement-not-working-in-rails-query/52519397#52519397", "title": "&quot;Or&quot; statement not working in Rails Query", "body": "<p>I think this should work:</p>\n\n<pre><code>@users = @job.location.users.where(id: @job.user_ids).or(@job.location.users.where(active: true))\n</code></pre>\n"}], "owner": {"reputation": 2960, "user_id": 7426461, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Ldwxy.jpg?s=128&g=1", "display_name": "Cannon Moyer", "link": "https://stackoverflow.com/users/7426461/cannon-moyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1369, "favorite_count": 0, "accepted_answer_id": 52519397, "answer_count": 1, "score": 3, "last_activity_date": 1537970542, "creation_date": 1537969508, "question_id": 52519236, "link": "https://stackoverflow.com/questions/52519236/or-statement-not-working-in-rails-query", "title": "&quot;Or&quot; statement not working in Rails Query", "body": "<p>I have the following model structure:</p>\n\n<pre><code>class Job &lt; ApplicationRecord\n     belongs_to :location\n     has_and_belongs_to_many :users\nend\n\nclass Location &lt; ApplicationRecord\n     has_and_belongs_to_many :users\n     has_many :jobs\nend\n\nclass User &lt; ApplicationRecord\n    has_and_belongs_to_many :locations\nend\n</code></pre>\n\n<p>This allows me to create jobs for a given location, and then associate/assign users to that job. My user table has an <code>active</code> attribute and I am getting an error when I try to query users that are either already assigned to the job or have a status of active. Here is my query:</p>\n\n<pre><code>@users = @job.location.users.where(users: { id: @job.user_ids }).or(@job.location.users.where(active: true))\n</code></pre>\n\n<p>The error: </p>\n\n<pre><code>ArgumentError (Relation passed to #or must be structurally compatible. Incompatible values: [:references]):\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["javascript", "ruby", "autocomplete", "ruby-on-rails-5", "jquery-select2"], "owner": {"reputation": 966, "user_id": 6384607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc77165b05cef4d2d4f6ed65d6bf9b21?s=128&d=identicon&r=PG&f=1", "display_name": "t s", "link": "https://stackoverflow.com/users/6384607/t-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538028533, "creation_date": 1537968112, "last_edit_date": 1538028533, "question_id": 52518805, "link": "https://stackoverflow.com/questions/52518805/rails-nested-form-with-select2-autocomplete", "title": "Rails nested form with select2 autocomplete", "body": "<p>I am using <code>nested_form_fields</code> for nested fields and <code>select2</code></p>\n\n<p>The problem is when I add another row of nested fields previous selected value is gone and that value is unable to select again.</p>\n\n<p>_form.htmt.haml</p>\n\n<pre><code>= f.nested_fields_for :expense_accounts do |ff|\n  .row.mt-2\n    .col-md-2\n      .plain-select\n        = ff.select  :expense_type, '', {}, class: \"form-control select_expense_types\"\n    .col-md-2\n      = ff.text_area :description, class: 'form-control', cols: \"2\", rows: \"2\"\n    .col-md-2\n      = ff.select :status, Expense.statuses.map { |key, value| [key.titleize, key] } , {class: \"form-control\" , required: true}\n    .col-md-2\n      = ff.text_field :amount, class: 'form-control'\n    .col-md-2\n    .col-md-2\n      = ff.remove_nested_fields_link 'Remove'\n%br\n= f.add_nested_fields_link :expense_accounts, 'Add row', class: 'btn btn-primary add_row'\n\n- content_for :scripts do\n  :javascript \n     set_expense_type_select('.select_expense_types', \"Please select\");\n      $('.add_row').on('click', function(){\n\n        setTimeout(\n            function() {\n              set_expense_type_select('.select_expense_types', \"Please select\");  \n            },\n            500);\n      })\n</code></pre>\n\n<p>select_autocomplete.js</p>\n\n<pre><code>var set_expense_type_select = function(selector, place_holder){\n    if ($(selector).length &gt; 0) {\n        $(selector).select2({\n            ajax: {\n                url: \"/api/select_searches/find_expense_type\",\n                dataType: 'json',\n                delay: 250,\n                data: function (params) {\n                    return {\n                        // per_page: 10,\n                        q: params.term//, // search term\n                        // page: params.page\n                    };  \n                },\n                processResults: function (data, params) {\n                    // params.page = params.page || 1;\n                    return {\n                        results: data\n                    };\n                },\n                cache: true\n            },\n            language: {\n                noResults: function() {return \"No results &lt;a class='pull-right header-btn hidden-mobile' data-toggle='modal' data-target='#new-expense-type' href='#'&gt;Add New&lt;/a&gt;\"; }\n            },\n            placeholder: place_holder,\n            escapeMarkup: function (markup) { return markup; },\n            templateResult: formatRepo,\n            templateSelection: formatRepoSelection\n        });\n    }\n} \n</code></pre>\n\n<p>Every time when I add new row all previous <code>expense_type</code> got cleared and that selected value is unable to select again</p>\n\n<p>Do you have any idea ?\nAny help would be appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "tar"], "answers": [{"tags": [], "owner": {"reputation": 45322, "user_id": 421705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/581b1760881c962648f99d6040d41829?s=128&d=identicon&r=PG", "display_name": "Holger Just", "link": "https://stackoverflow.com/users/421705/holger-just"}, "is_accepted": true, "score": 0, "last_activity_date": 1537972506, "creation_date": 1537972506, "answer_id": 52520275, "question_id": 52517600, "link": "https://stackoverflow.com/questions/52517600/tarwriter-throws-gempackagetarwriterfileoverflow/52520275#52520275", "title": "TarWriter throws Gem::Package::TarWriter::FileOverflow", "body": "<p><code>String#length</code> returns the number of characters in the String. Since a UTF-8 character can be represented by more than a single byte, the bytesize of a string is usually larger.</p>\n\n<p>The <code>TarWriter</code> now expects the file size to be given in bytes. Thus, if you use anything else than plain ascii characters in your file, it will overflow.</p>\n\n<p>To solve this, you should thus pass <a href=\"http://ruby-doc.org/core/String.html#method-i-bytesize\" rel=\"nofollow noreferrer\"><code>file.bytesize</code></a> to the <code>add_file_simple</code> method instead of <code>file.size</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 2617911, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000015891418/picture?type=large", "display_name": "Chris Cross", "link": "https://stackoverflow.com/users/2617911/chris-cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 52520275, "answer_count": 1, "score": 1, "last_activity_date": 1537972714, "creation_date": 1537964280, "last_edit_date": 1537972714, "question_id": 52517600, "link": "https://stackoverflow.com/questions/52517600/tarwriter-throws-gempackagetarwriterfileoverflow", "title": "TarWriter throws Gem::Package::TarWriter::FileOverflow", "body": "<p>I want to generate a tar from a buch of files.</p>\n\n<pre><code>out_file = File.new('some.tar', 'w')\ntar = Gem::Package::TarWriter.new out_file\nattachments = #Array of attachment objects\nattachments.each{|a|\n   file = Attachment.new(a).read_file #returns a String\n   file.force_encoding('UTF-8')\n   tar.add_file_simple( a[:filename], 777, file.length) do |io|\n      io.write(file)\n    end\n}\n</code></pre>\n\n<blockquote>\n  <p>Gem::Package::TarWriter::FileOverflow - You tried to feed more data\n  than fits in the file.</p>\n</blockquote>\n\n<p>Has anyone an idea why this happens and how to fix it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 5, "creation_date": 1537961937, "post_id": 52516763, "comment_id": 91973137, "body": "Wrap it in a loop: <code>[field1, field2].each { |f| case f ... }</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1537966738, "post_id": 52516763, "comment_id": 91976172, "body": "Or place your case inside a method and call it for each field."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537982712, "post_id": 52516763, "comment_id": 91985843, "body": "Does <code>[field1, field2]</code> equal <code>[&#39;val1&#39;, &#39;val2&#39;]</code> or <code>[&#39;val2&#39;, &#39;val1&#39;]</code>? If so, <code>[&#39;val1&#39;, &#39;val2&#39;].tap { |a| a.reverse! if field1 == &#39;val2&#39; }.each { |v| puts v }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3995, "user_id": 2037537, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f13d953be3af2552aaa1ddfa0a05fa46?s=128&d=identicon&r=PG", "display_name": "Roland Studer", "link": "https://stackoverflow.com/users/2037537/roland-studer"}, "is_accepted": false, "score": 1, "last_activity_date": 1538737267, "creation_date": 1538737267, "answer_id": 52664159, "question_id": 52516763, "link": "https://stackoverflow.com/questions/52516763/multiple-case-expressions/52664159#52664159", "title": "Multiple case expressions", "body": "<p>It is very unclear what field 1 and 2 can contain. You could to a switch statement on an array of two elements.</p>\n\n<pre><code>  case [field1, field2]\n  when [1,1]\n    puts \"a\"\n  when [1,2]\n    puts \"b\"\n  else\n    puts \"I got nothing\"\n  end\n</code></pre>\n\n<p>But does probably rarely is a good idea, so you could also just do elseif, so you can check for any conditions that are to be handled</p>\n\n<pre><code>if field1 == field2\n   puts \"Impossible!\"\nelsif field1.length &gt; field2.length\n   puts \"Something\"\nelsif [field1, field2].any?(&amp;:nil?)\n   puts \"I need two fields there, my friend\"\nelse\n   puts \"I am disappointed\"\nend\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 1389297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a01a118cb2582c77316ee026d36540?s=128&d=identicon&r=PG", "display_name": "Ali Akbar", "link": "https://stackoverflow.com/users/1389297/ali-akbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1538737267, "creation_date": 1537961602, "last_edit_date": 1537962677, "question_id": 52516763, "link": "https://stackoverflow.com/questions/52516763/multiple-case-expressions", "title": "Multiple case expressions", "body": "<p>I have two variables <code>field1</code> and <code>field2</code>. I need to do a <code>case</code> statement on each variable:</p>\n\n<pre><code>case field1\nwhen \"val1\"\n  puts field1\nwhen \"val2\"\n  puts field2\nend\n\ncase field2\nwhen \"val1\"\n  puts field1\nwhen \"val2\"\n  puts field2\nend\n</code></pre>\n\n<p>How can I implement something like the above in a single <code>case</code> statement? Something like this:</p>\n\n<pre><code>case field1, field2\nwhen \"val1\"\n  puts field1\nwhen \"val2\"\n  puts field2\nend\n</code></pre>\n\n<p>Will any monkey patching help?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 3, "creation_date": 1537960762, "post_id": 52516246, "comment_id": 91972481, "body": "Safe navigation is the new way to go, <code>params[:brand_ids]&amp;.split(&#39;,&#39;)</code> instead of <code>try</code> would be nicer."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 0, "creation_date": 1537961312, "post_id": 52516246, "comment_id": 91972800, "body": "@MarcinKo\u0142odziej we are already using rails (with <code>present?</code>) so I don\u2019t see any reason to restrict my answer to the most modern versions of ruby. Many people still use 2.2- in production. Also, safe navigation effectively does the same."}, {"owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 4, "creation_date": 1537961724, "post_id": 52516246, "comment_id": 91973015, "body": "I&#39;m still kind of new when it comes to answering, I thought that if there&#39;s no specific old-version requirement, it makes sense to use the best method available. In this case, Ruby 2.3 has been out for ~3 years. While it effectively does the same, it is a bit slower and behaves differently for objects who do have the method defined (good read: <a href=\"https://stackoverflow.com/questions/37977721/why-is-safe-navigation-better-than-using-try-in-rails\" title=\"why is safe navigation better than using try in rails\">stackoverflow.com/questions/37977721/&hellip;</a>)."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "edited": false, "score": 1, "creation_date": 1537963484, "post_id": 52516246, "comment_id": 91974093, "body": "@MarcinKo\u0142odziej well, SO is not the service for those <i>asking</i>. It\u2019s the service for whoever will yield this page with <a href=\"https://duckduckgo.com\" rel=\"nofollow noreferrer\">DuckDuckGo</a> later. I apparently know what is the difference between <code>try</code> and <code>&amp;.</code>, but <code>String#split</code> is surely defined and the performance here is not an issue. As I have already said, many still use ancient rubies in production (there might be dozens of reasons for that.) The answer above works for Ruby2.0/Rails2.3, so why would I make it less useful for those looking the solution for their custom environment?"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537964805, "post_id": 52516246, "comment_id": 91974919, "body": "Assuming that market_id is either nil or present, you could also use .compact instead of the &#39;select { }&#39; part. In general I wouldn&#39;t say that the OPs way of writing it is in any way bad or worse. It doesn&#39;t look the most pretty, yet it is easy to follow."}, {"owner": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "edited": false, "score": 0, "creation_date": 1537964962, "post_id": 52516246, "comment_id": 91975024, "body": "What if i wanted to add a nest param? i.e        where_query[:id] = { not: params[:product_id] } if params[:product_id].present? how to that in the same what ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "edited": false, "score": 0, "creation_date": 1537965199, "post_id": 52516246, "comment_id": 91975179, "body": "@AhmedAli I am not sure I follow. Just add <code>id: { not: params[:product_id] } if params[:product_id].present?</code> line inside a hash declaration."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537965299, "post_id": 52516246, "comment_id": 91975240, "body": "@trueunlessfalse <code>Hash#compact</code> is even younger than <code>&amp;.</code> (it was introduced in 2.4.)"}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537966413, "post_id": 52516246, "comment_id": 91975975, "body": "@mudasobwa, sure, good that you mention that. I don&#39;t think that either 2.3 or 2.4 are too young to mention it in an answer on SO. I even think the default should be to provide the most up-to-date answer, and if it makes sense mention alternatives for older versions."}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537966423, "post_id": 52516246, "comment_id": 91975981, "body": "@mudasobwa, sure, good that you mention that. I don&#39;t think that either 2.3 or 2.4 are too young to mention it in an answer on SO. I even think the default should be to provide the most up-to-date answer, and if it makes sense mention alternatives for older versions."}, {"owner": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 0, "creation_date": 1537966669, "post_id": 52516246, "comment_id": 91976127, "body": "Regarding the safe navigation: In this case String#split might be surely defined, but as you mention it yourself other people will find this answer and adapt.. a typo in try(:meothd_name) vs &amp;.metohd_name) will only return nil vs. throwing an error, possibly making someones debugging-life harder."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 953, "user_id": 942135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6940a140b70676e63569f347b6642f68?s=128&d=identicon&r=PG", "display_name": "trueunlessfalse", "link": "https://stackoverflow.com/users/942135/trueunlessfalse"}, "edited": false, "score": 1, "creation_date": 1537967849, "post_id": 52516246, "comment_id": 91976942, "body": "@trueunlessfalse ok, ok, I have updated the answer :)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 4, "last_activity_date": 1537967834, "last_edit_date": 1537967834, "creation_date": 1537959748, "answer_id": 52516246, "question_id": 52515865, "link": "https://stackoverflow.com/questions/52515865/what-is-the-way-to-create-a-new-hash-from-params/52516246#52516246", "title": "What is the way to create a new hash from params?", "body": "<p>I would go with more explicit declaration:</p>\n\n<pre><code>where_query =\n  { \n    active: true,\n    brand_ids: params[:brand_ids].try(:split, ','),\n    market_id: params[:market_id]\n  }.select { |_, v| v.present? }\n</code></pre>\n\n<hr>\n\n<p>Modern version of the above (Ruby 2.4+ required):</p>\n\n<pre><code>where_query =\n  { \n    active: true,\n    brand_ids: params[:brand_ids]&amp;.split(','),\n    market_id: params[:market_id].presence\n  }.compact\n</code></pre>\n"}], "owner": {"reputation": 2233, "user_id": 529524, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/11ddeb78f3a0fcf0fd0075f522df6888?s=128&d=identicon&r=PG", "display_name": "Ahmed Ali", "link": "https://stackoverflow.com/users/529524/ahmed-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52516246, "answer_count": 1, "score": -1, "last_activity_date": 1537967834, "creation_date": 1537958561, "last_edit_date": 1537962801, "question_id": 52515865, "link": "https://stackoverflow.com/questions/52515865/what-is-the-way-to-create-a-new-hash-from-params", "title": "What is the way to create a new hash from params?", "body": "<p>I'm trying to create a new hash from <code>params</code>. I'm doing something like this:</p>\n\n<pre><code>where_query = { active: true }\nwhere_query[:brand_ids] = params[:brand_ids].split(',') if params[:brand_ids].present?\nwhere_query[:market_id] = params[:market_id] if params[:market_id].present?\n</code></pre>\n\n<p>Is that okay? Or is there a better way to do that?</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537958244, "post_id": 52515662, "comment_id": 91971029, "body": "<code>myarray.sort_by { |h| h[&#39;id&#39;] }</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537958288, "post_id": 52515662, "comment_id": 91971053, "body": "@iGian not that simple: <code>myarray.sort_by { |h| h[&#39;id&#39;][&#47;\\d+&#47;].to_i }</code>"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537959037, "post_id": 52515662, "comment_id": 91971495, "body": "@mudasobwa is it because you care about this situation <code>&#39;ID3000&#39;</code>, <code>&#39;ID301&#39;</code>?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537959486, "post_id": 52515662, "comment_id": 91971766, "body": "@iGian exactly."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537989806, "post_id": 52515662, "comment_id": 91989200, "body": "If you wish to sort on the value of <code>&#39;ID&#39;</code> you need to tell us (with an edit) if the value of <code>&#39;ID&#39;</code> is always of length <code>5</code> and always begins with <code>&#39;ID&#39;</code>."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1538033462, "post_id": 52515662, "comment_id": 92002665, "body": "No the value doesn&#39;t start always by ID, but length is always 5. For my need the code poste by mudasobwa it&#39;s enough"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538382233, "post_id": 52515662, "comment_id": 92109254, "body": "That\u2019s fine as long as you know that mudsie\u2019s code will cause <code>\u201dID001\u201d</code> to preceed <code>\u201dAA002\u201d</code> in the sort. Btw, I just happened to see your last comment days after you posted it. For me to be notified by SO of your comment you need to include my username in the comment. See comments above for examples."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538395584, "post_id": 52515662, "comment_id": 92116131, "body": "@CarySwoveland i usually do it.... I forgot to add your name, sorry! But thank&#39;s  for your interest. Tell me, How would you solve my problem? Another opinion is always appreciable"}], "answers": [{"comments": [{"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 0, "creation_date": 1537959148, "post_id": 52515838, "comment_id": 91971567, "body": "Thank you so much. Can yoi explain <code>|h| h[&#39;id&#39;][&#47;\\d+&#47;].to_i</code> to me? I don&#39;t find an explanation online..."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "edited": false, "score": 4, "creation_date": 1537959581, "post_id": 52515838, "comment_id": 91971816, "body": "You probably want it to be ordered by numerical value, e.g. <code>ID10</code> should come after <code>ID9</code>. Alphabetical sorting would place <code>ID10</code> first, so I filter out digits only and convert it to integer to make it to compare <code>10</code> and <code>9</code> instead."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 3, "last_activity_date": 1537958488, "creation_date": 1537958488, "answer_id": 52515838, "question_id": 52515662, "link": "https://stackoverflow.com/questions/52515662/print-an-array-of-hashes-ordered-by-a-hash-key/52515838#52515838", "title": "Print an array of hashes ordered by a hash key", "body": "<pre><code>myarray.\n  sort_by { |h| h['id'][/\\d+/].to_i }.\n  each.\n  with_index(1) do |h, idx|\n    puts [\"\\n\", \"#{idx})\", h['id'], \"n.\", h['count']].join(' ')\n  end\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7048422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17af3e9e4c3c573ed28fc31d247c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Shreesha A", "link": "https://stackoverflow.com/users/7048422/shreesha-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1537973823, "creation_date": 1537973823, "answer_id": 52520722, "question_id": 52515662, "link": "https://stackoverflow.com/questions/52515662/print-an-array-of-hashes-ordered-by-a-hash-key/52520722#52520722", "title": "Print an array of hashes ordered by a hash key", "body": "<p>my_array looks like this:</p>\n\n<pre><code>{\"ID02\"=&gt;\"xx\", \"ID01\"=&gt;\"a\", \"ID00\"=&gt;\"ba\", \"ID04\"=&gt;\"zz\"}\n</code></pre>\n\n<p>when you run this: </p>\n\n<pre><code>my_array.sort_by { |key, value| key }\n</code></pre>\n\n<p>output would return an array as: </p>\n\n<pre><code>[[\"ID00\", \"ba\"], [\"ID01\", \"a\"], [\"ID02\", \"xx\"], [\"ID04\", \"zz\"]]\n</code></pre>\n\n<p>I guess you still want it to be in a Hash, but it isn't a Hash's inherent functionality to have ordered keys.</p>\n"}], "owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 52515838, "answer_count": 2, "score": -2, "last_activity_date": 1537973823, "creation_date": 1537957947, "last_edit_date": 1537962945, "question_id": 52515662, "link": "https://stackoverflow.com/questions/52515662/print-an-array-of-hashes-ordered-by-a-hash-key", "title": "Print an array of hashes ordered by a hash key", "body": "<p>I have an array of hashes like this</p>\n\n<pre><code>{'id' =&gt; 'ID001', 'count' =&gt; 1}\n{'id' =&gt; 'ID003', 'count' =&gt; 2}\n{'id' =&gt; 'ID002', 'count' =&gt; 1}\n</code></pre>\n\n<p>I do this to print the list</p>\n\n<pre><code>myarray.each_with_index do |i, p|\n    puts \"\\n #{p+1}) #{i['id']} n. #{i['count'].to_s}\"\nend\n</code></pre>\n\n<p>It works perfectly, in fact, I obtain this:</p>\n\n<pre><code>1) 'ID001' n. 1\n2) 'ID003' n. 2\n3) 'ID002' n. 1\n</code></pre>\n\n<p>Is it possible to order the hashes by <code>\"ID\"</code> key?</p>\n"}, {"tags": ["ruby", "spreadsheet"], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 6278557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/63d99c1f1c91ef44a601516fbe9e8747?s=128&d=identicon&r=PG&f=1", "display_name": "themaster", "link": "https://stackoverflow.com/users/6278557/themaster"}, "edited": false, "score": 0, "creation_date": 1537964395, "post_id": 52515623, "comment_id": 91974672, "body": "Can we use column names here??"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 391, "user_id": 6278557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/63d99c1f1c91ef44a601516fbe9e8747?s=128&d=identicon&r=PG&f=1", "display_name": "themaster", "link": "https://stackoverflow.com/users/6278557/themaster"}, "edited": false, "score": 0, "creation_date": 1537966411, "post_id": 52515623, "comment_id": 91975971, "body": "I don&#39;t think headers are supported, maybe you want to take a look to <a href=\"https://github.com/zdavatz/spreadsheet\" rel=\"nofollow noreferrer\">documentation</a>. Anyway, you can build your headers using a hash like this: <code>sheet.row(0).map.with_index.with_object({}) { |(col, idx), h| h[col] = idx }</code>"}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 0, "last_activity_date": 1537957815, "creation_date": 1537957815, "answer_id": 52515623, "question_id": 52514969, "link": "https://stackoverflow.com/questions/52514969/reading-specific-columns-from-excel-file-and-writing-to-another-excel-file/52515623#52515623", "title": "reading specific columns from excel file and writing to another excel file", "body": "<p>This is an option, knowing before the number of the source column and the number of the destination column:</p>\n\n<pre><code># Step 3 copy the columns\n\ncol_num = 3 #=&gt; the destination column\nrow_num = 1 #=&gt; to skip the headers and start from the second row\nsheet1.each row_num do |row|\n    sheet[row_num, col_num] = row[0] # row[1] the number represents the column to copy from the source file\n    row_num += 1\nend\n</code></pre>\n\n<p>Then save the file: <code>book.write 'filename'</code></p>\n"}], "owner": {"reputation": 391, "user_id": 6278557, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/63d99c1f1c91ef44a601516fbe9e8747?s=128&d=identicon&r=PG&f=1", "display_name": "themaster", "link": "https://stackoverflow.com/users/6278557/themaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537957815, "creation_date": 1537955794, "question_id": 52514969, "link": "https://stackoverflow.com/questions/52514969/reading-specific-columns-from-excel-file-and-writing-to-another-excel-file", "title": "reading specific columns from excel file and writing to another excel file", "body": "<p>My objective is to read an excel file columns and write it to another new file.\nTill now I am able to create a new file with specified columns.I am able to read an excel file based on row and column index. But my objective is a different.\nI have to pick specific columns from the excel file and write all the data to another file under the same column.\nHow can I achieve this.  </p>\n\n<pre><code>require 'spreadsheet'\n\n    #Step 1 : create an excel sheet\n\n    book = Spreadsheet::Workbook.new\n    sheet = book.create_worksheet\n    sheet.row(0).concat %w[id column_1 column_2 column_3]\n    book.write 'Data/write_excel.xls'\n\n    #step 2 : read the data excel file\n\n    book1 = Spreadsheet.open('Data/read_excel.xls')\n    sheet1 = book1.worksheet('')\n    val = sheet1[0, 1]\n    puts val\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1537954950, "post_id": 52514475, "comment_id": 91968938, "body": "You say the value of b should be true but in your end result not every <code>:b</code> is true"}, {"owner": {"reputation": 1020, "user_id": 4172762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a8c72a6bddcb6b802eae5a871ee5319?s=128&d=identicon&r=PG&f=1", "display_name": "Sireesh Vattikuti", "link": "https://stackoverflow.com/users/4172762/sireesh-vattikuti"}, "reply_to_user": {"reputation": 2251, "user_id": 9785060, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IUduC.png?s=128&g=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/9785060/viktor"}, "edited": false, "score": 0, "creation_date": 1537955306, "post_id": 52514475, "comment_id": 91969221, "body": "Yes  not every :b is true"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537955997, "post_id": 52514475, "comment_id": 91969703, "body": "Why is <code>{:a=&gt;&quot;H1&quot;, :b=&gt;false}</code>, which does not have <code>true</code> for <code>:b</code>, allowed?"}], "answers": [{"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537955959, "post_id": 52514814, "comment_id": 91969680, "body": "Depends on the interpretation of the question (which is not clear at all), but I took it that the <code>e[:b] == true</code> condition is relaxed only when there is only one element among the uniqueness. Therefore, I would replace your <code>values.first</code> with <code>(values.first if values.one?)</code>, and add <code>.compact</code> at the end.."}, {"owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537958697, "post_id": 52514814, "comment_id": 91971276, "body": "@sawa, probably you&#39;re right, it depends on the interpretation."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": true, "score": 3, "last_activity_date": 1537955387, "creation_date": 1537955387, "answer_id": 52514814, "question_id": 52514475, "link": "https://stackoverflow.com/questions/52514475/how-to-pick-uniq-hash-value-with-one-more-condition/52514814#52514814", "title": "How to pick uniq hash value with one more condition", "body": "<p>Your question is not clear. If you just want the result you described, this will work:</p>\n\n<pre><code>h.group_by { |e| e[:a] }\n .map { |k, values| values.find { |e| e[:b] == true } || values.first }\n#=&gt; [{:a=&gt;\"Hello\", :b=&gt;true}, {:a=&gt;\"H1\", :b=&gt;false}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1537956122, "creation_date": 1537956122, "answer_id": 52515076, "question_id": 52514475, "link": "https://stackoverflow.com/questions/52514475/how-to-pick-uniq-hash-value-with-one-more-condition/52515076#52515076", "title": "How to pick uniq hash value with one more condition", "body": "<p>Most effective approach would be probably to <code>reduce</code>:</p>\n\n<pre><code>h.each_with_object({}) do |h, acc|\n  acc[h[:a]] = h if acc[h[:a]].nil? || !acc[h[:a]][:b]\nend.values\n#\u21d2 [{:a=&gt;\"Hello\", :b=&gt;true}, {:a=&gt;\"H1\", :b=&gt;false}]\n</code></pre>\n"}], "owner": {"reputation": 1020, "user_id": 4172762, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0a8c72a6bddcb6b802eae5a871ee5319?s=128&d=identicon&r=PG&f=1", "display_name": "Sireesh Vattikuti", "link": "https://stackoverflow.com/users/4172762/sireesh-vattikuti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 52514814, "answer_count": 2, "score": -3, "last_activity_date": 1537956122, "creation_date": 1537954346, "last_edit_date": 1537955392, "question_id": 52514475, "link": "https://stackoverflow.com/questions/52514475/how-to-pick-uniq-hash-value-with-one-more-condition", "title": "How to pick uniq hash value with one more condition", "body": "<p>I have:</p>\n\n<pre><code>h = [{:a=&gt;\"Hello\", :b=&gt;false}, {:a=&gt;\"Hello\", :b=&gt;true}, {:a=&gt;\"H1\", :b=&gt;false}]\n</code></pre>\n\n<p>I want to get unique values based on key <code>a</code>, and the value of <code>b</code> should be <code>true</code>. I want this result:</p>\n\n<pre><code>[{:a=&gt;\"Hello\", :b=&gt;true}, {:a=&gt;\"H1\", :b=&gt;false}]\n</code></pre>\n\n<p>If I do:</p>\n\n<pre><code>h.uniq {|hash| hash.values_at(:a)}\n</code></pre>\n\n<p>this will fetch the first uniq hash. I get:</p>\n\n<pre><code>[{:a=&gt;\"Hello\", :b=&gt;false}, {:a=&gt;\"H1\", :b=&gt;false}]\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "edited": false, "score": 0, "creation_date": 1537953987, "post_id": 52514227, "comment_id": 91968332, "body": "This might be what you want: <code>(#\\w+\\s+(#\\w+\\s+)+)</code> <a href=\"http://rubular.com/r/ZgQPwpUa2d\" rel=\"nofollow noreferrer\">rubular.com/r/ZgQPwpUa2d</a>"}, {"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1537956425, "post_id": 52514227, "comment_id": 91969953, "body": "<code>&quot;#b #c #d&quot;, &quot;#e #f&quot;</code> is not a valid Ruby object. You cannot get such output."}], "answers": [{"tags": [], "owner": {"reputation": 172306, "user_id": 164835, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ayYoh.jpg?s=128&g=1", "display_name": "Kent", "link": "https://stackoverflow.com/users/164835/kent"}, "is_accepted": false, "score": 0, "last_activity_date": 1537954794, "creation_date": 1537954794, "answer_id": 52514625, "question_id": 52514227, "link": "https://stackoverflow.com/questions/52514227/how-to-find-consecutive-hashtags/52514625#52514625", "title": "How to find consecutive hashtags", "body": "<p>is this what you want?</p>\n\n<pre><code>((#\\w+\\s+){2,})\n</code></pre>\n\n<p>group 1 has the result.</p>\n"}, {"tags": [], "owner": {"reputation": 91443, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 1, "last_activity_date": 1537956485, "creation_date": 1537956485, "answer_id": 52515205, "question_id": 52514227, "link": "https://stackoverflow.com/questions/52514227/how-to-find-consecutive-hashtags/52515205#52515205", "title": "How to find consecutive hashtags", "body": "<p>You could remove the last capturing group and make the second last a non capturing group. But then you will also match the trailing whitespace.</p>\n\n<p>If you don't want the trailing whitespace you could use:\n<code>#\\w+(?:\\s+#\\w+)+</code></p>\n\n<p><a href=\"http://rubular.com/r/Kh4OaE0VCI\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n\n<p>If you also want to match hashtags without zero or more times a whitespace character, you could use <a href=\"http://rubular.com/r/nyKHRSX5Yj\" rel=\"nofollow noreferrer\"><code>\\s*</code></a> instead of <code>\\s+</code></p>\n"}], "owner": {"reputation": 1086, "user_id": 5201594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AHVDD.jpg?s=128&g=1", "display_name": "rahul mishra", "link": "https://stackoverflow.com/users/5201594/rahul-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537956485, "creation_date": 1537953613, "last_edit_date": 1537956232, "question_id": 52514227, "link": "https://stackoverflow.com/questions/52514227/how-to-find-consecutive-hashtags", "title": "How to find consecutive hashtags", "body": "<p>I have a string:</p>\n\n<pre><code>\"hello #a and #b welcome #b #c #d and #e #f or #k\"\n</code></pre>\n\n<p>I want the sequences of more than one consecutive hashtags. I want the output:</p>\n\n<pre><code>\"#b #c #d\", \"#e #f\"\n</code></pre>\n\n<p>I used the following regex:</p>\n\n<pre><code>/#\\w+\\s*(#\\w+\\s*)+(#\\w+)*/\n</code></pre>\n\n<p>but it does not work.</p>\n"}, {"tags": ["ruby", "text", "module", "stdout", "sketchup"], "comments": [{"owner": {"reputation": 3, "user_id": 10330135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23721627463f6ec2adcf14356f60b921?s=128&d=identicon&r=PG&f=1", "display_name": "Hello_World", "link": "https://stackoverflow.com/users/10330135/hello-world"}, "reply_to_user": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1537950495, "post_id": 52513218, "comment_id": 91966196, "body": "at the moment      $stdout.puts(coordinates)  does not work, I get an empty file"}, {"owner": {"reputation": 2681, "user_id": 486990, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b0220a4b0ec42f2ddc610d0c187b1ee1?s=128&d=identicon&r=PG", "display_name": "thomthom", "link": "https://stackoverflow.com/users/486990/thomthom"}, "edited": false, "score": 0, "creation_date": 1539941279, "post_id": 52513218, "comment_id": 92691687, "body": "Why are you assigning the File handle to <code>$stdout</code>. Better to assign it to a local variable. Otherwise you are messing with the stdout which affect other extensions. Also, look into the block argument version of opening files - that ensures the file is always closed properly."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9648317, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kZZIFcajK7U/AAAAAAAAAAI/AAAAAAAAAHI/0ordrnRZ9fg/photo.jpg?sz=128", "display_name": "Eugene Stepanov", "link": "https://stackoverflow.com/users/9648317/eugene-stepanov"}, "is_accepted": true, "score": 0, "last_activity_date": 1537951285, "creation_date": 1537951285, "answer_id": 52513497, "question_id": 52513218, "link": "https://stackoverflow.com/questions/52513218/create-a-plugin-that-puts-text-in-a-txt-file/52513497#52513497", "title": "Create a plugin that puts text in a .txt file", "body": "<p>You forgot to close file after <b>$stdout.puts(coordinates)</b></p>\n\n<p><b><i>$stdout.close</i></b></p>\n"}], "owner": {"reputation": 3, "user_id": 10330135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23721627463f6ec2adcf14356f60b921?s=128&d=identicon&r=PG&f=1", "display_name": "Hello_World", "link": "https://stackoverflow.com/users/10330135/hello-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52513497, "answer_count": 1, "score": -1, "last_activity_date": 1537951285, "creation_date": 1537950343, "question_id": 52513218, "link": "https://stackoverflow.com/questions/52513218/create-a-plugin-that-puts-text-in-a-txt-file", "title": "Create a plugin that puts text in a .txt file", "body": "<p>I am working on creating a plugin in Ruby.\nOn this moment I am unable to insert the coordinates, that are added to a Sketchup model, in a .txt file.</p>\n\n<p>This is my code:</p>\n\n<pre><code>require 'sketchup.rb'\nSKETCHUP_CONSOLE.show rescue Sketchup.send_action(\"showRubyPanel:\")\n$stdout = File.new('file.txt', 'w')\n\nmodule HWmakemyownplug\n  def self.fileplug\n    model = Sketchup.active_model \n    #Make some coordinates.\n    coordinates = [[2,0,39],[0,0,1],[1,1,0]]\n    #Add the points in Sketchup. This works!\n    coordinates.each { |point| model.active_entities.add_cpoint(point) }\n    #Puts the coordinates to the textfile 'file.txt'. This doesn't work!\n    $stdout.puts(coordinates)   \n\n  end #def self.fileplug\nend #module makemyownplug\n\nif (!file_loaded?(__FILE__))\n\n  #Add to the SketchUp tools menu\n  extensions_menu = UI.menu(\"Plugins\")\n  extensions_menu.add_item(\"testtesttest\") { HWmakemyownplug::fileplug }\n  # Let Ruby know we have loaded this file\n  file_loaded(__FILE__)\n\nend\n</code></pre>\n\n<p>The coordinates have to be printed when I click on menu > plugins > testtesttest.</p>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1538014995, "post_id": 52512980, "comment_id": 91996446, "body": "I believe there&#39;s a method called <code>strip_namespaces</code> that does what you want"}, {"owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1538117335, "post_id": 52512980, "comment_id": 92038503, "body": "There is a <code>remove_namespaces</code> method for the document, but not for a node. Found out that nodes have <code>namespace=</code> method that accepts <code>nil</code> as a parameter. It removes the namespace and prefix. But is really cumbersome to call for each node after you have created it."}], "owner": {"reputation": 1235, "user_id": 568765, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0723f6f32244044bced540ab8b101456?s=128&d=identicon&r=PG", "display_name": "Mika", "link": "https://stackoverflow.com/users/568765/mika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537949509, "creation_date": 1537949509, "question_id": 52512980, "link": "https://stackoverflow.com/questions/52512980/how-to-add-a-new-node-without-prefix", "title": "How to add a new node without prefix", "body": "<p>I'm working with a SOAP API that requires some XML nodes without prefixes.  Is it even possible to do with Nokogiri? Simply omitting the prefix from the node name makes Nokogiri use the default prefix \"env\".</p>\n\n<pre><code>node = Nokogiri::XML::Node.new('WageReportsToIR', envelope)\nenvelope.xpath('//env:Body').first.add_child(node)\n</code></pre>\n\n<p>results</p>\n\n<pre><code>&lt;env:Body&gt;\\n    &lt;env:WageReportsToIR/&gt;\\n  &lt;/env:Body&gt;\n</code></pre>\n\n<p>Do I have any other option but to write a regex to remove the prefixes after I'm done editing the XML with Nokogiri?</p>\n"}, {"tags": ["ruby", "rvm", "zsh"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537949245, "post_id": 52512730, "comment_id": 91965453, "body": "Please add the output of command <code>which ruby</code>."}, {"owner": {"reputation": 1021, "user_id": 2662823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JuQWG.png?s=128&g=1", "display_name": "typo", "link": "https://stackoverflow.com/users/2662823/typo"}, "edited": false, "score": 0, "creation_date": 1538752554, "post_id": 52512730, "comment_id": 92267188, "body": "Do you have homebrew installed? If so, do you have <code>rbenv</code> &amp; <code>ruby-build</code> installed via homebrew? (you can check with <code>brew list</code> if they are listed you have them installed...)"}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 8129831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awcNg.jpg?s=128&g=1", "display_name": "H Dox", "link": "https://stackoverflow.com/users/8129831/h-dox"}, "is_accepted": false, "score": 1, "last_activity_date": 1537950522, "creation_date": 1537950522, "answer_id": 52513275, "question_id": 52512730, "link": "https://stackoverflow.com/questions/52512730/upgrade-ruby-zsh-no-rvm/52513275#52513275", "title": "Upgrade ruby zsh (no rvm)", "body": "<p>Looks like you are using <code>rbenv</code> to manage ruby versions. You can type the following command to install ruby 2.5.0</p>\n\n<p><code>rbenv install 2.5.0</code></p>\n\n<p>After that, change your default ruby version to 2.5.0 by typing</p>\n\n<p><code>rbenv global 2.5.0</code></p>\n\n<p>For more information and commands, check out the <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">docs</a>.</p>\n"}], "owner": {"reputation": 1184, "user_id": 7335455, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/73a947b04ec422b1677d20933ab4fe1e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Bomb", "link": "https://stackoverflow.com/users/7335455/tom-bomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537950522, "creation_date": 1537948599, "last_edit_date": 1537950226, "question_id": 52512730, "link": "https://stackoverflow.com/questions/52512730/upgrade-ruby-zsh-no-rvm", "title": "Upgrade ruby zsh (no rvm)", "body": "<p>I am using zsh and ruby version 2.3.1.</p>\n\n<p>I would like to upgrade it to 2.5.0. I tried to install rvm and ruby version 2.5.0; they were installed, but it also caused many problems because it wasn't able to find other gems.</p>\n\n<p>I removed rvm, and it was back to the way it used to be.</p>\n\n<p>I was wondering if there's a way to upgrade ruby withour rvm. I don't know how ruby was installed before.</p>\n\n<p>When I type <code>which ruby</code>, I get <code>/Users/myname/.rbenv/shims/ruby</code></p>\n"}, {"tags": ["ruby", "linux", "bash", "ssh", "stdout"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537948713, "post_id": 52512537, "comment_id": 91965134, "body": "Couldn&#39;t you just <code>print</code> the stdout output to the user in your script?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537949560, "post_id": 52512537, "comment_id": 91965653, "body": "(after capturing + analyzing)"}, {"owner": {"reputation": 63, "user_id": 9627896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jmate", "link": "https://stackoverflow.com/users/9627896/jmate"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537949802, "post_id": 52512537, "comment_id": 91965784, "body": "Thanks for responding! This would work if I could read the command&#39;s <code>stdout</code> char-by-char to print it in the terminal (like a manual <code>tee</code>) but I think I can&#39;t do that since the output will be buffered. This is particularly problematic when there&#39;s a line without a <code>\\n</code> like a terminal prompt e.g., <code>jmate@ssh_server~$ </code>."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537966673, "post_id": 52512537, "comment_id": 91976132, "body": "I think with popen3 you get an IO object that you can read unbuffered or with a timeout. Also you can then do something like <code>stdin.copy_stream($stdin)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 9627896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jmate", "link": "https://stackoverflow.com/users/9627896/jmate"}, "is_accepted": false, "score": 1, "last_activity_date": 1538008960, "creation_date": 1538008960, "answer_id": 52527850, "question_id": 52512537, "link": "https://stackoverflow.com/questions/52512537/capture-output-of-interactive-external-command-run-from-inside-ruby/52527850#52527850", "title": "Capture output of interactive external command run from inside Ruby", "body": "<p>I found my answer! Big thanks to @Kimmo Lehto for suggesting the <code>IO.copy_stream()</code> idea which led to my final solution. Basically, we use <code>PTY.spawn(cmd){|stdin, stdout, pid| ...}</code> to get unbuffered streams for <code>stdin</code> and <code>stdout</code>.</p>\n\n<p>Then we copy the script's <code>stdin</code> to the command's <code>stdin</code> with <code>IO.copy_stream($stdin.raw!, $stdin)</code> (don't forget to set <code>$stdin.cooked!</code> afterwards).</p>\n\n<p>I couldn't figure out how to use <code>copy_stream</code> on the command's <code>stdout</code> twice (first to the script's <code>stdout</code>, second to a buffer e.g., <code>io = StringIO.new</code>) so I had to manually read each character like so: <code>stdout.readchar(|c| print c; io.write c)</code>.</p>\n"}], "owner": {"reputation": 63, "user_id": 9627896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jmate", "link": "https://stackoverflow.com/users/9627896/jmate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1538008960, "creation_date": 1537947939, "last_edit_date": 1537948751, "question_id": 52512537, "link": "https://stackoverflow.com/questions/52512537/capture-output-of-interactive-external-command-run-from-inside-ruby", "title": "Capture output of interactive external command run from inside Ruby", "body": "<p>I have been searching for a way to run an interactive command (such as <code>ssh</code>) and capture its output. This sounds simple but as I understand it, my use case is slightly different from a lot of the google and s/o results.</p>\n\n<p>To be clear, by interactive I mean, the user who runs <code>my_ruby_script.rb</code> from the terminal should be able to </p>\n\n<ol>\n<li>type into (<code>stdin</code>) the running interactive system command (e.g., type <code>ls</code> through <code>ssh</code> tunnel)</li>\n<li>read out from (<code>stdout</code>/<code>stderr</code>) the running interactive system command (again e.g., seeing the output of <code>ls</code> in an <code>ssh</code> tunnel)</li>\n</ol>\n\n<p>On top of that, I would like to read the output of the system command (<code>ssh</code>) so I may, for example, check for errors from inside my Ruby script. The closest that I have gotten has been to simply <code>tee</code> the output to another file.</p>\n\n<pre><code>system('ssh username@ssh_server |&amp; tee ssh_log.txt')\n</code></pre>\n\n<p>This is not ideal as</p>\n\n<ol>\n<li>It requires saving to/reading from a separate file</li>\n<li>It requires a more complicated system call which may or may not be portable</li>\n</ol>\n\n<p>As I understand it, most of the solutions online (backticks, <code>Open3.*</code>, <code>PTY.spawn()</code>, etc. ) redirect stdin/stdout away from the terminal interface and into the ruby program. What I'm looking for is to leave <code>stdin</code> alone, and tee <code>stdout</code> to my Ruby script. Does anybody have any ideas?</p>\n\n<p>I should note that <code>system('ssh username@ssh_server')</code> does exactly what I want, I just need to be able to read the output. Additionally, I would prefer not to use net-ssh nor any other non-stdlib libraries.</p>\n\n<h1>Research:</h1>\n\n<ol>\n<li>This is probably the most comprehensive page describing running commands in Ruby (<a href=\"https://stackoverflow.com/questions/7212573/when-to-use-each-method-of-launching-a-subprocess-in-ruby\">When to use each method of launching a subprocess in Ruby</a> and the linked blog posts). </li>\n<li>These people have (what seems to me) my exact same issue:\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/46777295/ruby-io-popen-or-open3-multi-write-read-operations\">ruby IO.popen or open3 multi write/read operations</a></li>\n<li><a href=\"https://www.ruby-forum.com/t/open3-and-ssh/147475\" rel=\"nofollow noreferrer\">https://www.ruby-forum.com/t/open3-and-ssh/147475</a></li>\n</ul></li>\n<li>These people are using ssh through Ruby but their scripts aren't \"interactive\"\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/26682024/running-an-interactive-program-from-ruby\">Running an interactive program from Ruby</a></li>\n<li><a href=\"https://content.pivotal.io/blog/using-ruby-expect-library-to-reboot-ruckus-wireless-access-points-via-ssh\" rel=\"nofollow noreferrer\">https://content.pivotal.io/blog/using-ruby-expect-library-to-reboot-ruckus-wireless-access-points-via-ssh</a></li>\n</ul></li>\n</ol>\n\n<p>I really appreciate any insight you can deliver.</p>\n"}, {"tags": ["ruby", "callback", "webserver"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1537948823, "post_id": 52512406, "comment_id": 91965207, "body": "I may be wrong but I don&#39;t think there&#39;s any verification sent to the server, when the client receives a message. The server only knows when it&#39;s finished <i>sending</i> the message."}, {"owner": {"reputation": 13, "user_id": 5945356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e195519ad58b4c2ce21a3ad7b25f020?s=128&d=identicon&r=PG&f=1", "display_name": "samesame", "link": "https://stackoverflow.com/users/5945356/samesame"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1537965590, "post_id": 52512406, "comment_id": 91975439, "body": "I&#39;m not sure but since it is a tcp connection, i imagine that tcp makes sure the packets have been delivered before the response is considered &#39;sent&#39;. Would be interested if this is actually true..       I have tried the solution from \u0417\u0435\u043b\u0451\u043d\u044b\u0439 and it works for me. In my case it is not that critical because server and client are in the same local subnet and lost packets should be rare."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5945356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e195519ad58b4c2ce21a3ad7b25f020?s=128&d=identicon&r=PG&f=1", "display_name": "samesame", "link": "https://stackoverflow.com/users/5945356/samesame"}, "edited": false, "score": 0, "creation_date": 1537965048, "post_id": 52512814, "comment_id": 91975085, "body": "Exactly what i was looking for! Thanks a lot for the clear and working example!!  I was under the impression that the response will not be served when server.shutdown is called during the response block, but failed to validate that belief. I have now tried it and even with slightly bigger responses the response is served successfully before the server shuts down. Thanks again for helping me out : )"}], "tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 1, "last_activity_date": 1537948892, "creation_date": 1537948892, "answer_id": 52512814, "question_id": 52512406, "link": "https://stackoverflow.com/questions/52512406/ruby-webserver-callback-when-the-request-has-been-served/52512814#52512814", "title": "Ruby webserver - callback when the request has been served", "body": "<p>Just shutdown server then the second file is served. Here is an <strong>example</strong>:</p>\n\n<p>server.rb</p>\n\n<pre><code>require 'webrick'\n\nserver = WEBrick::HTTPServer.new :Port =&gt; 8000, :DocumentRoot =&gt; '/'\nserver.mount_proc '/' do |req, res|\n  # response with simple html body\n  res.body = '\n  &lt;html&gt;\n    &lt;head&gt;\n      &lt;title&gt;My Webpage&lt;/title&gt;\n      &lt;!-- first file --&gt;\n      &lt;link rel=\"stylesheet\" href=\"/one_file.css\" type=\"text/css\"&gt;\n      &lt;!-- second file --&gt;\n      &lt;link rel=\"stylesheet\" href=\"/second_file.css\" type=\"text/css\"&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n      &lt;h1&gt;Hello world!&lt;/h1&gt;\n    &lt;/body&gt;\n  &lt;/html&gt;'\nend\nserver.mount_proc '/one_file.css' do |req, res|\n  res.body = 'h1 { color: blue; }'\nend\nserver.mount_proc '/second_file.css' do |req, res|\n  res.body = 'h1 { color: red; }'\n  puts \"Shutdown server !\"\n  server.shutdown\nend\nserver.start\n</code></pre>\n\n<p>Run server.rb:</p>\n\n<pre><code>$~  ruby server.rb \n[2018-09-26 11:02:21] INFO  WEBrick 1.3.1\n[2018-09-26 11:02:21] INFO  ruby 2.4.1 (2017-03-22) [x86_64-linux]\n[2018-09-26 11:02:21] INFO  WEBrick::HTTPServer#start: pid=24224 port=8000\n::1 - - [26/Sep/2018:11:02:24 MSK] \"GET / HTTP/1.1\" 200 262\n- -&gt; /\n::1 - - [26/Sep/2018:11:02:24 MSK] \"GET /one_file.css HTTP/1.1\" 200 19\nhttp://localhost:8000/ -&gt; /one_file.css\n::1 - - [26/Sep/2018:11:02:24 MSK] \"GET /second_file.css HTTP/1.1\" 200 18\nhttp://localhost:8000/ -&gt; /second_file.css\n::1 - - [26/Sep/2018:11:02:24 MSK] \"GET /favicon.ico HTTP/1.1\" 200 262\nhttp://localhost:8000/ -&gt; /favicon.ico\n[2018-09-26 11:02:25] INFO  going to shutdown ...\n[2018-09-26 11:02:25] INFO  WEBrick::HTTPServer#start done.\n$~\n</code></pre>\n\n<p>Both files are served:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zaZN7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zaZN7.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 5945356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e195519ad58b4c2ce21a3ad7b25f020?s=128&d=identicon&r=PG&f=1", "display_name": "samesame", "link": "https://stackoverflow.com/users/5945356/samesame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52512814, "answer_count": 1, "score": 1, "last_activity_date": 1537948892, "creation_date": 1537947495, "question_id": 52512406, "link": "https://stackoverflow.com/questions/52512406/ruby-webserver-callback-when-the-request-has-been-served", "title": "Ruby webserver - callback when the request has been served", "body": "<p>Is there any way to know when a request has been served by a ruby webserver (webrick, evma_httpserver, whatever?)</p>\n\n<p>Goal is to serve 2 static files and shutdown server after the second file has been served to the client.\nIt seems i can not find anything related to this, so any pointers are welcome..</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "office365", "microsoft-graph-api", "outlook-restapi"], "comments": [{"owner": {"reputation": 936, "user_id": 10087214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6e82313a64619a417b5790b0ec02cc?s=128&d=identicon&r=PG&f=1", "display_name": "Keen Jin", "link": "https://stackoverflow.com/users/10087214/keen-jin"}, "edited": false, "score": 0, "creation_date": 1538032514, "post_id": 52511474, "comment_id": 92002164, "body": "Could you please provide more information about the request body. I have tried this, and it works"}, {"owner": {"reputation": 3, "user_id": 8403134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136614188ed2d035f4341db94f7fb372?s=128&d=identicon&r=PG&f=1", "display_name": "RodneyT94", "link": "https://stackoverflow.com/users/8403134/rodneyt94"}, "reply_to_user": {"reputation": 936, "user_id": 10087214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6e82313a64619a417b5790b0ec02cc?s=128&d=identicon&r=PG&f=1", "display_name": "Keen Jin", "link": "https://stackoverflow.com/users/10087214/keen-jin"}, "edited": false, "score": 0, "creation_date": 1538034996, "post_id": 52511474, "comment_id": 92003462, "body": "@kikang yes, it&#39;s working most of the time. But yesterday my app on my user side ran into that error causing duplicate events created. I cannot reproduce the issue as well. I don&#39;t know if the API auto retry after this error occurs. Thank you!"}, {"owner": {"reputation": 936, "user_id": 10087214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6e82313a64619a417b5790b0ec02cc?s=128&d=identicon&r=PG&f=1", "display_name": "Keen Jin", "link": "https://stackoverflow.com/users/10087214/keen-jin"}, "edited": false, "score": 0, "creation_date": 1539152574, "post_id": 52511474, "comment_id": 92392462, "body": "Did you retry it?Is it work?"}, {"owner": {"reputation": 3, "user_id": 8403134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136614188ed2d035f4341db94f7fb372?s=128&d=identicon&r=PG&f=1", "display_name": "RodneyT94", "link": "https://stackoverflow.com/users/8403134/rodneyt94"}, "reply_to_user": {"reputation": 936, "user_id": 10087214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6e82313a64619a417b5790b0ec02cc?s=128&d=identicon&r=PG&f=1", "display_name": "Keen Jin", "link": "https://stackoverflow.com/users/10087214/keen-jin"}, "edited": false, "score": 0, "creation_date": 1550830957, "post_id": 52511474, "comment_id": 96424599, "body": "@KeenJin it happened again today. The error <i>OData::ServerError 503 ConcurrentItemSave</i> is thrown at the last line in the code above (when an event is being created). I&#39;m not sure if the issue comes from me using shared calendar. Do you know where I can find the document about the API errors? Thanks in advance."}, {"owner": {"reputation": 15641, "user_id": 3307985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bvlg9.jpg?s=128&g=1", "display_name": "Jason Johnston", "link": "https://stackoverflow.com/users/3307985/jason-johnston"}, "edited": false, "score": 0, "creation_date": 1558472255, "post_id": 52511474, "comment_id": 99110940, "body": "There&#39;s a GitHub issue opened for this problem: <a href=\"https://github.com/microsoftgraph/msgraph-sdk-ruby/issues/38\" rel=\"nofollow noreferrer\">github.com/microsoftgraph/msgraph-sdk-ruby/issues/38</a>"}], "owner": {"reputation": 3, "user_id": 8403134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136614188ed2d035f4341db94f7fb372?s=128&d=identicon&r=PG&f=1", "display_name": "RodneyT94", "link": "https://stackoverflow.com/users/8403134/rodneyt94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537944188, "creation_date": 1537944188, "question_id": 52511474, "link": "https://stackoverflow.com/questions/52511474/microsoft-graph-v1-api-error-odataservererror-503-concurrentitemsave-confli", "title": "Microsoft Graph V1 API error: OData::ServerError 503 ConcurrentItemSave: &quot;Conflicts occurred during saving data to store", "body": "<p>I'm having trouble debugging the issue occurs when pushing new events to Outlook Calendar using Microsoft Graph API (v1). I have tested and it's still working, but I received this error which happened a few times today from my Ruby on Rails apps with the gems mentioned in the code snippet below. And there are duplicate events added to the calendar after these errors. I have searched this issue but still got nothing. Could anyone help me to debug this problem, please? I just don't know if this issue caused by my users' actions or just API server error. Many thanks! </p>\n\n<p>OData::ServerError 503 ConcurrentItemSave: \"Conflicts occurred during saving data to store (saveresult: IrresolvableConflict, properties: ). Please retry the request.\" from \"<a href=\"https://graph.microsoft.com/v1.0/me/calendars/AAMkADg1YmMzNjE2LTM5Y2MtNGI2NC05NjJjLWRiY2RhZTZkNDRkMABGAAAAAADZc5aq6QclSqy_4oRMVv_EBwB4ZnW6S6xLTZDSXIsgJfprAAAAAAEGAAB4ZnW6S6xLTZDSXIsgJfprAAAGEcjmAAA=/events\" rel=\"nofollow noreferrer\">https://graph.microsoft.com/v1.0/me/calendars/AAMkADg1YmMzNjE2LTM5Y2MtNGI2NC05NjJjLWRiY2RhZTZkNDRkMABGAAAAAADZc5aq6QclSqy_4oRMVv_EBwB4ZnW6S6xLTZDSXIsgJfprAAAAAAEGAAB4ZnW6S6xLTZDSXIsgJfprAAAGEcjmAAA=/events</a>\"</p>\n\n<p>Code I use to create events via api</p>\n\n<pre><code>require 'adal'\nrequire 'microsoft_graph'\n\nusername      = ENV[\"OUTLOOK_USERNAME\"]\npassword      = ENV[\"OUTLOOK_PASSWORD\"]\nclient_id     = ENV[\"OUTLOOK_CLIENT_ID\"]\nclient_secret = ENV[\"OUTLOOK_CLIENT_SECRET\"]\ntenant        = ENV[\"OUTLOOK_TENANT\"]\nuser_cred     = ADAL::UserCredential.new(username, password)\nclient_cred   = ADAL::ClientCredential.new(client_id, client_secret)\ncontext       = ADAL::AuthenticationContext.new(ADAL::Authority::WORLD_WIDE_AUTHORITY, tenant)\nresource      = \"https://graph.microsoft.com/\"\ntokens        = context.acquire_token_for_user(resource, client_cred, user_cred)\n\ncallback = Proc.new { |r|\n  r.headers[\"Authorization\"] = \"Bearer #{tokens.access_token}\"\n  r.headers[\"Prefer\"] = 'outlook.timezone=\"Australia/Sydney\"'\n  r.headers['Content-type'] = 'application/json'\n}\n\n@graph = MicrosoftGraph.new(\n  base_url: \"https://graph.microsoft.com/v1.0\",\n  cached_metadata_file: File.join(MicrosoftGraph::CACHED_METADATA_DIRECTORY, \"metadata_v1.0.xml\"),\n  &amp;callback\n)\n\n#example_data\ncalendar_id = \"my_calendar_id\"\ndata = my_event_object\n\n@graph.service.post(\"me/calendars/#{calendar_id}/events\", data.to_json)\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537945960, "post_id": 52511369, "comment_id": 91963631, "body": "Please format your code, it&#39;s hard to understand what is going wrong."}, {"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1537950143, "post_id": 52511369, "comment_id": 91965987, "body": "can you please show us html source?"}, {"owner": {"reputation": 1, "user_id": 10407712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8995d1e08617c23f0e02852ed65e7?s=128&d=identicon&r=PG&f=1", "display_name": "user402706", "link": "https://stackoverflow.com/users/10407712/user402706"}, "edited": false, "score": 0, "creation_date": 1537952259, "post_id": 52511369, "comment_id": 91967260, "body": "I have edited my question and added related images"}, {"owner": {"reputation": 1, "user_id": 10407712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8995d1e08617c23f0e02852ed65e7?s=128&d=identicon&r=PG&f=1", "display_name": "user402706", "link": "https://stackoverflow.com/users/10407712/user402706"}, "edited": false, "score": 0, "creation_date": 1537954801, "post_id": 52511369, "comment_id": 91968831, "body": "I am trying to pass index value to the fields how to pass index value to the each field"}], "answers": [{"tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": false, "score": 0, "last_activity_date": 1537950293, "creation_date": 1537950293, "answer_id": 52513198, "question_id": 52511369, "link": "https://stackoverflow.com/questions/52511369/render-nested-form-in-bootstrap-tab/52513198#52513198", "title": "Render nested form in bootstrap tab", "body": "<p>What is obviously on your code is that you have space here in a line:</p>\n\n<pre><code>&lt;a href=\"#&lt;%= l  .location_name %&gt;\" data-toggle=\"tab\"&gt; &lt;%= l.location_name %&gt; &lt;/a&gt;\n</code></pre>\n\n<p>as you can note l .location_name can you remove the space?</p>\n"}], "owner": {"reputation": 1, "user_id": 10407712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e8995d1e08617c23f0e02852ed65e7?s=128&d=identicon&r=PG&f=1", "display_name": "user402706", "link": "https://stackoverflow.com/users/10407712/user402706"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538494192, "creation_date": 1537943712, "last_edit_date": 1538494192, "question_id": 52511369, "link": "https://stackoverflow.com/questions/52511369/render-nested-form-in-bootstrap-tab", "title": "Render nested form in bootstrap tab", "body": "<p>Working on Rails 5, \nI am trying to render nested form (same model) in each dynamic tab,\nbut now the same fomr is rendering in the all the tabs,how to render different fieldset in different tabs</p>\n\n<p><strong>views/material_masters/new.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"col-md-12\"&gt;\n   &lt;div class=\"panel panel-default\"&gt;\n     &lt;div class=\"panel-body\"&gt;\n      &lt;div class=\"tabbable-line\"&gt;\n        &lt;ul class=\"nav nav-tabs \"&gt;\n          &lt;% @part_locations.each.with_index do |l, i| %&gt;\n          &lt;li &lt;%= 'class=\"active\"' if i == 0 %&gt;&gt;\n            &lt;a href=\"#&lt;%= l.location_name %&gt;\" data-toggle=\"tab\"&gt; &lt;%= l.location_name %&gt; &lt;/a&gt;\n          &lt;/li&gt;\n          &lt;% end %&gt;\n          &lt;li&gt;&lt;button type=\"button\" class=\"fa fa-plus btn btn-primary btn-xs\" data-toggle=\"modal\" data-target=\"#myModal\"&gt;&lt;/button&gt; &lt;/li&gt;\n        &lt;/ul&gt;\n        &lt;div class=\"tab-content\"&gt;\n          &lt;% @part_locations.each.with_index do |l, i| %&gt;\n          &lt;div class=\"tab-pane &lt;%= 'active' if  i == 0 %&gt;\" id=\"&lt;%= l.location_name %&gt;\"&gt;\n            &lt;%= f.fields_for :material_locations do |builder| %&gt;\n            &lt;%= render 'material_location_fields', :f =&gt; builder  %&gt;\n            &lt;% end %&gt;\n            &lt;%= link_to_add_association \"Add\", f, :material_locations, class: \"btn btn-primary btn-xs\"  %&gt;\n          &lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>views/material_masters/_material_location_fields.html.erb</strong></p>\n\n<pre><code>&lt;fieldset&gt;\n  &lt;div class= \"nested-fields\"&gt;\n    &lt;div class=\"col-sm-3\"&gt;\n      &lt;%= f.label :material_location, \"Material Location\" %&gt;\n      &lt;%= f.text_field :mat_location,class:\"form-control\",required: true %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-3\"&gt;\n      &lt;%= f.label :opening_stock  %&gt;\n      &lt;%= f.text_field :opening_stock ,class:\"form-control\",onKeyPress:\"return NumbersOnly(this, event,true)\",required: true  %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-sm-3\"&gt;\n      &lt;%= f.label :reorder_qty %&gt;\n      &lt;%= f.text_field :reorder_qty, class:\"form-control\",onKeyPress:\"return NumbersOnly(this, event,true)\",required:true  %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/fieldset&gt;\n</code></pre>\n\n<p><strong>model/material_master.rb</strong></p>\n\n<pre><code>class MaterialMaster &lt; ApplicationRecord\n   has_many :material_locations\n   accepts_nested_attributes_for :material_locations,allow_destroy: true\n end\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/b6Ssr.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/b6Ssr.png</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/69h3X.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/69h3X.png</a></p>\n\n<p>Hear i am trying to add location in bangalore tab i am addling mumbai location and in delhi tab i want to add one more material location but the same form is coming in the next tab </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook-graph-api", "rubygems"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537943721, "post_id": 52510347, "comment_id": 91962591, "body": "At which line are you getting this error ?"}, {"owner": {"reputation": 3136, "user_id": 10283047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d3424d98c68472d196cb5534c3f417?s=128&d=identicon&r=PG&f=1", "display_name": "misorude", "link": "https://stackoverflow.com/users/10283047/misorude"}, "edited": false, "score": 0, "creation_date": 1537948029, "post_id": 52510347, "comment_id": 91964767, "body": "Your app does not have the necessary permission to view this object. (Since it is a photo, that would most likely be <code>user_photos</code> permission then.)"}], "owner": {"reputation": 11, "user_id": 8105804, "user_type": "registered", "profile_image": "https://graph.facebook.com/1452957574761091/picture?type=large", "display_name": "Heng Seyha", "link": "https://stackoverflow.com/users/8105804/heng-seyha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537946689, "creation_date": 1537938761, "last_edit_date": 1537946689, "question_id": 52510347, "link": "https://stackoverflow.com/questions/52510347/koala-get-facebook-post-with-postid-and-get-comment-count-like-count-share-c", "title": "Koala get Facebook post with postId and get comment count , like count , share count", "body": "<p>Here is my Code I get my information and then I get this error</p>\n\n<pre><code>require 'koala'\naccess_token ='a_very_long_access_token'\n@graph = Koala::Facebook::API.new(access_token)    \n\nall_comments = @graph.get_connections(2194339320618344, \"comments\", limit: 100)\nputs all_commnets\npost_insights = @graph.get_object(2194339320618344, :fields =&gt; \"likes.summary(true)\")\nputs post_insights\n</code></pre>\n\n<p>and the result is </p>\n\n<pre><code>{\"name\"=&gt;\"Google\", \"id\"=&gt;\"1998966816826828\"}\n{\"birthday\"=&gt;\"08/07/1990\", \"id\"=&gt;\"1998966816826828\"}\n{\"email\"=&gt;\"google@yahoo.com\", \"id\"=&gt;\"1998966816826828\"}\nTraceback (most recent call last):\n2: from rand.rb:19:in `&lt;main&gt;'\n1: from /Users/sino/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/koala-3.0.0/lib/koala/api/graph_api_methods.rb:56:in `get_object'\n/Users/sino/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/koala-3.0.0/lib/koala/api.rb:50:in\n`graph_call': type: GraphMethodException, code: 100, error_subcode: 33, message: Unsupported get request.Object with ID '2194339320618344' does not exist, cannot be loaded due to missing permissions, or does not support this operation. Please read the Graph API documentation at https://developers.facebook.com/docs/graph-api, x-fb-trace-id: G9x4gx1hW5k [HTTP 400] (Koala::Facebook::ClientError)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-migrations"], "comments": [{"owner": {"reputation": 2110, "user_id": 1257062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2Y3So.png?s=128&g=1", "display_name": "Rizwan", "link": "https://stackoverflow.com/users/1257062/rizwan"}, "edited": false, "score": 0, "creation_date": 1537933603, "post_id": 52509617, "comment_id": 91959353, "body": "The question is missing the clarity whether you are checking with Migration or syntax or rails specific details. Please add more context"}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537933650, "post_id": 52509617, "comment_id": 91959360, "body": "To be honest with you, I didn&#39;t understand what you&#39;re trying to ask and your problem here is. Can you please elaborate a little more ?"}, {"owner": {"reputation": 5, "user_id": 10416494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc33fe46eb3457026e06e6200fb904cc?s=128&d=identicon&r=PG&f=1", "display_name": "Techguy1611", "link": "https://stackoverflow.com/users/10416494/techguy1611"}, "edited": false, "score": 0, "creation_date": 1537937459, "post_id": 52509617, "comment_id": 91960272, "body": "My question basically is, can i use migration for updating records in a table? in other words to sync the record across the users."}, {"owner": {"reputation": 947, "user_id": 1730761, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/WlcFp.jpg?s=128&g=1", "display_name": "yeuem1vannam", "link": "https://stackoverflow.com/users/1730761/yeuem1vannam"}, "edited": false, "score": 0, "creation_date": 1537941802, "post_id": 52509617, "comment_id": 91961720, "body": "For changing database that does not relate to schema changes, you can write a rake task, then ask the team to run that rake task. Ex: you want to change all <code>user_uid</code> from a plain string into a string like <code>&lt;provider_name&gt;-user_uid_string</code>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1537947227, "post_id": 52509617, "comment_id": 91964327, "body": "@Techguy1611 <i>&quot;can i use migration for updating records in a table?&quot;</i> \u2013 yes, you can. From <a href=\"https://edgeguides.rubyonrails.org/active_record_migrations.html#migrations-and-seed-data\" rel=\"nofollow noreferrer\">Migrations and Seed Data</a>: <i>&quot;Migrations can also be used to add or modify data.&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": true, "score": 1, "last_activity_date": 1537950644, "creation_date": 1537950644, "answer_id": 52513316, "question_id": 52509617, "link": "https://stackoverflow.com/questions/52509617/how-do-i-maintain-a-consistent-db-for-a-rails-project/52513316#52513316", "title": "How do I maintain a consistent db for a rails project?", "body": "<p>Yes,  you can use rails migration for updating database values.  Here is a sample of adding new column and updating values for every user:</p>\n\n<pre><code>class AddStatusToUser &lt; ActiveRecord::Migration\n  def up\n    add_column :users, :status, :string\n    User.find_each do |user|\n      user.status = 'active'\n      user.save!\n    end\n  end\n\n  def down\n    remove_column :users, :status\n  end\nend\n</code></pre>\n\n<p>In your case you can create new migration and put code to update any table any column value.</p>\n"}], "owner": {"reputation": 5, "user_id": 10416494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc33fe46eb3457026e06e6200fb904cc?s=128&d=identicon&r=PG&f=1", "display_name": "Techguy1611", "link": "https://stackoverflow.com/users/10416494/techguy1611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52513316, "answer_count": 1, "score": -3, "last_activity_date": 1537959284, "creation_date": 1537933488, "last_edit_date": 1537936921, "question_id": 52509617, "link": "https://stackoverflow.com/questions/52509617/how-do-i-maintain-a-consistent-db-for-a-rails-project", "title": "How do I maintain a consistent db for a rails project?", "body": "<p>Edit for clarity: \nI have edited a record in a table in the db. I would like for this record to be consistent across all users who are using the project. All of us are using the same copy of a scrubbed db. \nI know I could create a migration file for this change but I've seen that migrations are usually used for schema changes of the db.\nI'm new to rails so please do bear with me.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "expo"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537933479, "post_id": 52509505, "comment_id": 91959325, "body": "This works for me <code>curl -H &quot;Content-Type: application&#47;json&quot; -X POST https:&#47;&#47;exp.host&#47;--&#47;api&#47;v2&#47;push&#47;send -d &#39;{  &quot;to&quot;:&quot;ExponentPushToken[PUSHTOKEN]&quot;,  &quot;title&quot;:&quot;the title&quot;,  &quot;body&quot;:&quot;this is working like a charm!&quot;,  &quot;data&quot;:{&quot;keyA&quot;:&quot;my_value_1&quot;, &quot;keyB&quot;:&quot;my_value_2&quot;} }</code>. Take a look <a href=\"https://github.com/expo/expo-server-sdk-python/blob/9e93233c36c907079e21107e73f3b9258f105103/exponent_server_sdk/__init__.py#L76\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537933763, "post_id": 52509505, "comment_id": 91959384, "body": "I&#39;m unsure what you&#39;re suggesting, and what you&#39;re linking to. It looks like a Python SDK? I already said a way how it&#39;s working in a different language, in the first example - I&#39;m wanting to know why the Rails way is not working, and the correct way to write the data object above."}, {"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537933972, "post_id": 52509505, "comment_id": 91959431, "body": "The reason, I feel it could not be working is, since your keys are symbolized and in my code I&#39;m using the keys and values in the <code>dict</code> as <b>string</b>. Also, the SDK belongs to Python, but just a reference to the <b>error</b>."}, {"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "reply_to_user": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537934864, "post_id": 52509505, "comment_id": 91959608, "body": "@KedarnagMukanahallipatna I put quotes around everything, and it didn&#39;t make a difference. I want to emphasize that only when I added the data object, did the error occur."}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "edited": false, "score": 0, "creation_date": 1537973371, "post_id": 52510497, "comment_id": 91980684, "body": "Thanks - that works! Still unsure why adding the data object created an error, but before that the notification worked fine. Also - I didn&#39;t need the quotes around all the keys, it&#39;s actually how you configured the call that I believe fixed the issue. Thank you very much for your help!"}], "tags": [], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "is_accepted": true, "score": 2, "last_activity_date": 1537940252, "last_edit_date": 1537940252, "creation_date": 1537939579, "answer_id": 52510497, "question_id": 52509505, "link": "https://stackoverflow.com/questions/52509505/error-data-must-be-an-object-value-must-be-an-array-posting-expo-push-token/52510497#52510497", "title": "Error: Data must be an object, value must be an array - Posting Expo push token from Rails app", "body": "<p>This is a working code in my application, can you try this out</p>\n\n<p>In your controller, where you're triggering your Job do the following</p>\n\n<pre><code># Controller\npush_tokens.each do |token|\n  WorkerClass.perform_async(token, @user)\nend\n\n# Worker file\nclass WorkerClass\n  def perform(token, user)\n    uri = URI.parse(\"https://exp.host/--/api/v2/push/send\")\n    Net::HTTP.start(uri.host, uri.port, use_ssl: true) do |http|\n      http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n      request = Net::HTTP::Post.new(uri.path, {'Content-Type' =&gt; 'application/json'})\n      request.body = {\"to\"=&gt;token.expo_push_token, \"title\"=&gt;user.first_name, \"body\"=&gt;\"your_message\", \"data\"=&gt;{\"status\"=&gt;\"ok\"}}.to_json\n      response = http.request(request)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 5079196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UWfbG.jpg?s=128&g=1", "display_name": "gwalshington", "link": "https://stackoverflow.com/users/5079196/gwalshington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 883, "favorite_count": 0, "accepted_answer_id": 52510497, "answer_count": 1, "score": 1, "last_activity_date": 1537940252, "creation_date": 1537932481, "last_edit_date": 1537935323, "question_id": 52509505, "link": "https://stackoverflow.com/questions/52509505/error-data-must-be-an-object-value-must-be-an-array-posting-expo-push-token", "title": "Error: Data must be an object, value must be an array - Posting Expo push token from Rails app", "body": "<p>I have a Rails app, and through sidekiq, I want to send a post request to Expo, in order to handle an in-app notification. The app's API is built using Node.JS, and the push token successfully executes with this code:</p>\n\n<pre><code>                    axios({\n                        method: \"post\",\n                        url: \"https://exp.host/--/api/v2/push/send\",\n                        data: {\n                            to: result.expo_push_token,\n                            title: `${data.user.first_name}`,\n                            sound: \"default\",\n                            body: shortMessage,\n                            data: {\n                                status: \"ok\",\n                                body: shortMessage,\n                                title: `${data.user.first_name}`,\n                                msgUser: data.user,\n                                convoId: data.room,\n                            }\n                        }\n                    })\n</code></pre>\n\n<p>In the Rails app, everything was working fine until I wanted to pass a data object to the app. Here's what worked:</p>\n\n<pre><code>        push_tokens = PushToken.where(user_id: other_user)\n\n        push_tokens.each do |token|\n            params = ({\n\n              to: token.expo_push_token,\n              title: user.first_name,\n              sound: \"default\",\n              body: msg.body\n            })\n\n\n            puts params\n            puts params.class\n\n            x = Net::HTTP.post_form(URI.parse('https://exp.host/--/api/v2/push/send'), params)\n            puts x.body\n</code></pre>\n\n<p>And then when I add the data object, it gives the error: <code>{'errors':[{\"code\":'API_ERROR','message':'child \\'data\\' fails because [\\'data\\' must be an object], \\'value\\' must be an array.'}]}</code></p>\n\n<pre><code>        push_tokens.each do |token|\n            params = ({\n\n              to: token.expo_push_token,\n              title: user.first_name,\n              sound: \"default\",\n              body: msg.body,\n              data: {\n                status: \"ok\",\n                msgUser: {\n                  id: user.id,\n                  avatar_file_name: user.avatar_file_name,\n                  first_name: user.first_name,\n                },\n                convoId: msg.convo_id,\n                body: msg.body,\n                title: user.first_name,\n              },\n            })\n\n\n            puts params\n            puts params.class\n\n            x = Net::HTTP.post_form(URI.parse('https://exp.host/--/api/v2/push/send'), params)\n            puts x.body\n</code></pre>\n\n<p>Originally, I was passing an ActiveRecord to data to <code>msgUser: user</code>, and thought maybe that was the issue, but it made no difference when I created an array myself by doing: <code>msgUser: {id: user.id, avatar_file_name: user.avatar_file_name, first_name: user.first_name,},</code>. A simple <code>data: {status: 'ok'}</code> doesn't work either.</p>\n\n<p>I've also tried <code>data: [status: 'ok']</code> with <code>[ ]</code>, <code>params.to_json</code>, and <code>params.as_json</code>, but I get the same error.</p>\n\n<p>How can I successfully send this <code>data</code> object through this Rails post request to an expo push token?</p>\n"}, {"tags": ["ruby", "github", "rubygems", "bundler", "gem-bundler"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1537934887, "post_id": 52509087, "comment_id": 91959618, "body": "Firstly, the &quot;bundled with&quot; doesn&#39;t really matter. Secondly, you could just change it manually. And lastly, I&#39;m order to change it &quot;automatically&quot; you&#39;ll need to trigger some event that actually regenerates the file - for example, downgrade a gem then update it again. (But this is quite a pointless exercise since you could also have just edited the Gemfile.lock manually, or even ignored this bundler version discrepancy in the first place.)"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1537934954, "post_id": 52509087, "comment_id": 91959639, "body": "However, I must ask - why did you intentionally downgrade bundler? I don&#39;t recall a single instance where I&#39;ve needed to do that, for any reason."}, {"owner": {"reputation": 688, "user_id": 1477502, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sdapX.jpg?s=128&g=1", "display_name": "dps", "link": "https://stackoverflow.com/users/1477502/dps"}, "edited": false, "score": 0, "creation_date": 1560868508, "post_id": 52509087, "comment_id": 99872887, "body": "I&#39;ve had problems with Heroku using Bundler 2.x"}, {"owner": {"reputation": 8973, "user_id": 831564, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b7b5cb565edb37aac67f053f64f0324f?s=128&d=identicon&r=PG", "display_name": "Marlin Pierce", "link": "https://stackoverflow.com/users/831564/marlin-pierce"}, "edited": false, "score": 0, "creation_date": 1612877222, "post_id": 52509087, "comment_id": 116898641, "body": "I have had to downgrade bundler.  We have a specific version of bundler on production, both for heroku apps and apps on FreeBSD driven by what FreeBSD packages are available.  We want our dev environment to match production, so when a developer bundles with a later version than prod we want to downversion."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 10416543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209746336233474/picture?type=large", "display_name": "Jose Carlos Rodriguez Arrieta", "link": "https://stackoverflow.com/users/10416543/jose-carlos-rodriguez-arrieta"}, "is_accepted": false, "score": 3, "last_activity_date": 1537934510, "creation_date": 1537934510, "answer_id": 52509738, "question_id": 52509087, "link": "https://stackoverflow.com/questions/52509087/how-to-change-the-version-a-gemfile-lock-is-bundled-with/52509738#52509738", "title": "How to change the version a gemfile.lock is bundled with", "body": "<p>Did you try with bundle update?.</p>\n\n<p>If this doesn't work go to your Gemfile.lock and change it manually.</p>\n\n<p>Or delete the line and then do bundle install /update----add the gem and then do bundle install/update again.</p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "is_accepted": false, "score": 0, "last_activity_date": 1599544651, "creation_date": 1599544651, "answer_id": 63787893, "question_id": 52509087, "link": "https://stackoverflow.com/questions/52509087/how-to-change-the-version-a-gemfile-lock-is-bundled-with/63787893#63787893", "title": "How to change the version a gemfile.lock is bundled with", "body": "<p>Process: install the gem generically, looking up your target version on rubygems.org, then update and version your Gemfile.</p>\n<p>the install command is in the right-hand column.  then you can:</p>\n<p><code>gem install gem_name -v 1.5.4</code>  and see what reuslts of dependencies et al.  respecify the gem version in your gemfile (the <code>lock</code> file is not meant to be edited).  Then <code>bundle install</code> for your app to be secure.</p>\n"}], "owner": {"reputation": 189, "user_id": 4348131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed38f96965bcbbf26acfd2d67fbae569?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4348131/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2751, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1599544651, "creation_date": 1537928833, "question_id": 52509087, "link": "https://stackoverflow.com/questions/52509087/how-to-change-the-version-a-gemfile-lock-is-bundled-with", "title": "How to change the version a gemfile.lock is bundled with", "body": "<p>I had two versions of bundler installed locally 1.15.2 and 1.16.1. I had pushed my code and soon realized that the gemfile.lock BUNDLED WITH, updated the version to 1.16.1 and that is not what we want. </p>\n\n<p>I then removed 1.16.1 locally and now my default is 1.15.2 which is exactly what I want and ran <code>bundle install</code> in the checked out branch hoping that it would update ( downgrade ) the BUNLED WITH to 1.15.2 but git diff and searching the gemfile.lock shows that nothing has changed and it still says 1.16.1. </p>\n\n<p>Should I go in and manually change it which I know is never a good idea to manually edit the Gemfile.lock. Or is there a command to run that will do what I intend it to do. </p>\n\n<p>Thanks </p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1537921794, "post_id": 52508275, "comment_id": 91956959, "body": "Regex can&#39;t decipher length. Or, do length comparisons."}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1537922563, "post_id": 52508275, "comment_id": 91957105, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/30289341/longest-recurring-cycle-of-digits\">Longest recurring cycle of digits</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1537925729, "post_id": 52508275, "comment_id": 91957692, "body": "@Martin, this problem is to find the longest substring in a string of digits of the form <code>d*n</code>, where <code>d</code> is one of the 10 digits (e.g., &#39;4&#39;*5 #=&gt; &quot;44444&quot;`), whereas the problem you referenced concerns infinitely repeating digits in the decimal representation of a rational number."}, {"owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "edited": false, "score": 0, "creation_date": 1537941537, "post_id": 52508275, "comment_id": 91961601, "body": "Nuckle dragger method: <code>s.scan(&#47;1+|2+|3+|4+|5+|6+|7+|8+|9+|0+&#47;).max_by(&amp;:length)</code>"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 2, "creation_date": 1537944004, "post_id": 52508275, "comment_id": 91962699, "body": "What if there&#39;s a tie?"}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 5, "last_activity_date": 1538278979, "last_edit_date": 1538278979, "creation_date": 1537922917, "answer_id": 52508424, "question_id": 52508275, "link": "https://stackoverflow.com/questions/52508275/how-to-find-the-longest-consecutive-digits/52508424#52508424", "title": "How to find the longest consecutive digits?", "body": "<p>Regardless of the regular expression you use, subsequent iteration will be required. Here's one way.</p>\n\n<pre><code>str = \"12233344445\"\n\nstr.gsub(/(\\d)\\1*/).max_by(&amp;:size)\n  #=&gt; \"4444\"\n</code></pre>\n\n<p>We have</p>\n\n<pre><code>enum = str.gsub(/(\\d)\\1*/)\n  #=&gt; #&lt;Enumerator: \"12233344445\":gsub(/(\\d)\\1*/)&gt;\n</code></pre>\n\n<p>We can convert this to an array to see the elements that will be generated by this enumerator.</p>\n\n<pre><code>enum.to_a\n  #=&gt; [\"1\", \"22\", \"333\", \"4444\", \"5\"]\n</code></pre>\n\n<p>The regular expression reads, \"Match a digit in capture group 1, followed by zero or more characters that equal the contents of capture group 1.\"</p>\n\n<p>This uses the form of <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a> where no block is given. (Here the method has nothing to do with character substitution, which can be a bit confusing.)</p>\n"}, {"comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1537944135, "post_id": 52510567, "comment_id": 91962769, "body": "You can use<code>each_char</code> instead of <code>split</code>."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1537945535, "last_edit_date": 1537945535, "creation_date": 1537940028, "answer_id": 52510567, "question_id": 52508275, "link": "https://stackoverflow.com/questions/52508275/how-to-find-the-longest-consecutive-digits/52510567#52510567", "title": "How to find the longest consecutive digits?", "body": "<p>Another option is convert the string to an array and use <strong>Enuberable</strong> <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\">chunk_while</a> on it:</p>\n\n<pre><code>num.each_char.chunk_while {|i, j| j == i }.to_a\n#=&gt; [[\"1\"], [\"2\", \"2\"], [\"3\", \"3\", \"3\"], [\"4\", \"4\", \"4\", \"4\"], [\"5\"]]\n</code></pre>\n\n<p>So you can get for example:</p>\n\n<pre><code>num.each_char.chunk_while {|i, j| j == i }.map(&amp;:join) #=&gt; [\"1\", \"22\", \"333\", \"4444\", \"5\"]\n</code></pre>\n\n<p>Or just get the longest string, for example in this way:</p>\n\n<pre><code>num.each_char.chunk_while {|i, j| j == i }.max_by(&amp;:length).join() #=&gt; \"4444\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1537941200, "creation_date": 1537941200, "answer_id": 52510814, "question_id": 52508275, "link": "https://stackoverflow.com/questions/52508275/how-to-find-the-longest-consecutive-digits/52510814#52510814", "title": "How to find the longest consecutive digits?", "body": "<p>You can use a scanner to find all matches then flatten to find the longest match:</p>\n\n<pre><code>&gt; \"12233344445\".scan(/((\\d)\\2*)/).flatten.max_by(&amp;:length)\n=&gt; \"4444\"\n</code></pre>\n"}], "owner": {"reputation": 4956, "user_id": 108000, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ca0b18ec9e11dc777b2b8084fe5d5f90?s=128&d=identicon&r=PG", "display_name": "Sam Kong", "link": "https://stackoverflow.com/users/108000/sam-kong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1538294933, "creation_date": 1537921422, "last_edit_date": 1538294933, "question_id": 52508275, "link": "https://stackoverflow.com/questions/52508275/how-to-find-the-longest-consecutive-digits", "title": "How to find the longest consecutive digits?", "body": "<p>I am trying to find the longest consecutive digits from a string of digits. For example, given:</p>\n\n<pre><code>\"12233344445\"\n</code></pre>\n\n<p>I expect to return:</p>\n\n<pre><code>\"4444\"\n</code></pre>\n\n<p>I can find that using iteration, but I think that using regex would be cool although it's not efficient. It should be simple but I can't do it. Please enlighten me. I use Ruby, but any language will do.</p>\n"}, {"tags": ["ruby", "cosmos"], "answers": [{"tags": [], "owner": {"reputation": 863, "user_id": 453280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da112c06610e649fd431a155d9a261de?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/453280/jason"}, "is_accepted": true, "score": 0, "last_activity_date": 1537912287, "creation_date": 1537912287, "answer_id": 52507158, "question_id": 52507157, "link": "https://stackoverflow.com/questions/52507157/see-raw-bytes-being-sent-in-cosmos/52507158#52507158", "title": "See raw bytes being sent in COSMOS", "body": "<p>If you go to the Cmd Packets tab in the Command and Telemetry Server you can click View Raw on the command packet you're sending to see the raw bytes. Note that these are the raw bytes in the defined command. If your interface changes the data in some way (puts on a CRC, etc) then the bytes over the line may be different.</p>\n\n<p>The following page describes the COSMOS log format: <a href=\"https://cosmosrb.com/docs/logging/\" rel=\"nofollow noreferrer\">https://cosmosrb.com/docs/logging/</a></p>\n\n<p>You can also add the <a href=\"https://cosmosrb.com/docs/system/#log_raw\" rel=\"nofollow noreferrer\">LOG_RAW</a> keyword after your interface definition to log all the raw data going out over the interface. Note that COSMOS does not interpret this log and you'll have to use a hex editor to view it.</p>\n"}], "owner": {"reputation": 863, "user_id": 453280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/da112c06610e649fd431a155d9a261de?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/453280/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52507158, "answer_count": 1, "score": 0, "last_activity_date": 1537912287, "creation_date": 1537912287, "question_id": 52507157, "link": "https://stackoverflow.com/questions/52507157/see-raw-bytes-being-sent-in-cosmos", "title": "See raw bytes being sent in COSMOS", "body": "<p>In COSMOS is there an easy way to see the raw bytes being sent over the line by the Command Sender? We want to capture what is sent out and don't know where all the protocol layers get added.</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 5141, "user_id": 193980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/aafa8848c4b764f080b1b31a51eab73d?s=128&d=identicon&r=PG", "display_name": "Phlip", "link": "https://stackoverflow.com/users/193980/phlip"}, "edited": false, "score": 2, "creation_date": 1537911375, "post_id": 52506948, "comment_id": 91954469, "body": "Try rake, and let the build task depend on the test task. If the test process returns non-zero, the build task won&#39;t run, which is the effect I assume you are requesting. And major congrats for writing tests; they make all the difference."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 3, "last_activity_date": 1537946541, "creation_date": 1537946541, "answer_id": 52512149, "question_id": 52506948, "link": "https://stackoverflow.com/questions/52506948/how-to-run-unit-tests-before-building-a-ruby-gem/52512149#52512149", "title": "How to run unit tests before building a ruby gem?", "body": "<p>If you have a build process that consists of multiple tasks (e.g. testing, creating a gem, publishing a gem), and has dependencies between those tasks (e.g. the gem should only be created if the tests are successful, in order to publish the gem, it needs to be created first), you can use a <em>build tool</em> to automate that.</p>\n\n<p>Actually, build tools can be used for much more than just building, which is why some people prefer the term <em>task-oriented programming</em> or (my personal favority) <em>dependency-oriented programming</em> for that.</p>\n\n<p>The most famous of such dependency-oriented programming tools is probably <a href=\"https://wikipedia.org/wiki/Make_(software)\" rel=\"nofollow noreferrer\"><code>make</code></a>. If you are familiar with the Java ecosystem, you probably know <a href=\"https://ant.apache.org/\" rel=\"nofollow noreferrer\">Apache Ant</a> and <a href=\"https://gradle.org/\" rel=\"nofollow noreferrer\">Gradle</a>. In the Microsoft world, there is the <a href=\"https://github.com/Microsoft/msbuild\" rel=\"nofollow noreferrer\">Microsoft Build Engine (MSBuild)</a>. From the ECMAScript ecosystem, you may know <a href=\"https://gruntjs.com/\" rel=\"nofollow noreferrer\">Grunt</a> or <a href=\"https://gulpjs.com/\" rel=\"nofollow noreferrer\">Gulp</a>. The hot new kid on the block is Google's <a href=\"https://bazel.build/\" rel=\"nofollow noreferrer\">Bazel</a>.</p>\n\n<p>Ruby also has its own share of such tools, the most widely-used one is <a href=\"https://ruby.github.io/rake/\" rel=\"nofollow noreferrer\">Rake</a>.</p>\n\n<p>A lot of Ruby libraries and tools come with their own ready-made Rake Tasks, so that you don't have to write them yourself. For your particular use case, for example, there are ready-made tasks for building gems and for running RSpec tests.</p>\n"}], "owner": {"reputation": 171, "user_id": 3857195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9251520cb17ddc87ae2c4a8ff304dced?s=128&d=identicon&r=PG&f=1", "display_name": "Dinesh Namburi", "link": "https://stackoverflow.com/users/3857195/dinesh-namburi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 52512149, "answer_count": 1, "score": 1, "last_activity_date": 1537946541, "creation_date": 1537910913, "question_id": 52506948, "link": "https://stackoverflow.com/questions/52506948/how-to-run-unit-tests-before-building-a-ruby-gem", "title": "How to run unit tests before building a ruby gem?", "body": "<p>I am developing a gem and I have my unit tests in lib/spec directory. Currently I manually run unit tests using <code>rspec lib/spec</code>. And then I build gem using <code>gem build mygem.gemspec</code> (which builds a <strong>.gem</strong> file).</p>\n\n<p>How can I run my unit tests along with gem build command? (Just like how we do production builds using npm)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537911242, "post_id": 52506831, "comment_id": 91954423, "body": "Usually starts with <code>JSON.load</code> and goes from there. How far did you get?"}, {"owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537911688, "post_id": 52506831, "comment_id": 91954575, "body": "@tadman not that far. I have created a class inside <code>document.rb</code> file called   <code>class Image</code> and included <code>include Mongoid::Document</code> then <code>field :imageId, type: String</code> <code>field :image, type: String</code> and so on.."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1537925320, "post_id": 52506831, "comment_id": 91957621, "body": "Is <code>&quot;a long string&quot;</code> a base64 encoded image? if so, take a look here: <a href=\"https://stackoverflow.com/questions/8499633/how-to-display-base64-images-in-html\">How to display Base64 images in HTML?</a>"}, {"owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538166985, "post_id": 52506831, "comment_id": 92063209, "body": "@maxpleaner yes it&#39;s a base64. Do you know how can I put a link instead of the string here?  <code>&lt;img src=&quot;data:image&#47;png;base64, iVBORw0KGgoAAAANSUhEUgAAAAUA AAAFCAYAAACNbyblAAAAHElEQVQI12P4&#47;&#47;8&#47;w38GIAXDIBKE0DHxgljNBAAO     9TXL0Y4OHwAAAABJRU5ErkJggg==&quot; alt=&quot;Red dot&quot; &#47;&gt;</code>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538175818, "post_id": 52506831, "comment_id": 92065596, "body": "@Gemza I don&#39;t know what you mean &quot;how I can put a link instead of the string here&quot;. You want to put a URL inside the src tag? You would need to upload the image somewhere and get a URL."}, {"owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538178297, "post_id": 52506831, "comment_id": 92066046, "body": "@maxpleaner okay let&#39;s say it like this I want to get this image response (&quot;this long string&quot;) from the backend dynamically instead of writing it manually bcz I might have different images for different docs. I mean how can I extract it from the backend refering to imageId since each imageId has a different base64 endoded image."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538183262, "post_id": 52506831, "comment_id": 92066714, "body": "@gemza it depends on how it&#39;s being stored. it would be better if you can show your attempt so far ... just saying &quot;how do i do it&quot; is really vague"}, {"owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538260161, "post_id": 52506831, "comment_id": 92082472, "body": "@maxpleaner okay, let&#39;s say I want to first display the description of the image and the headline. I will add the code by editing my initial post. thanks!"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538332823, "post_id": 52506831, "comment_id": 92097174, "body": "@Gemza see here <a href=\"https://stackoverflow.com/questions/16163353/display-base64-encoded-image-in-rails\" title=\"display base64 encoded image in rails\">stackoverflow.com/questions/16163353/&hellip;</a>"}, {"owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1538346960, "post_id": 52506831, "comment_id": 92100423, "body": "@maxpleaner my problem is that I can&#39;t manage to send the base64 image to my controller"}], "owner": {"reputation": 129, "user_id": 8202357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce4ba055cd4477773b3f8fe6bed8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "ga4696", "link": "https://stackoverflow.com/users/8202357/ga4696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538260793, "creation_date": 1537910302, "last_edit_date": 1538260793, "question_id": 52506831, "link": "https://stackoverflow.com/questions/52506831/how-to-implement-a-method-in-ruby-to-load-images-from-the-backend-app", "title": "How to implement a method in ruby to load images from the backend app", "body": "<p>I want to implement method in ruby to load images from the backend app but I don't know how. I have been trying with image_tag directly from a view to call the location /image/{imageId} or /image/{documentId} but no success obviously. This is what I get from the backend api:</p>\n\n<pre><code>[\n  {\n    \"imageId\": \"1\",\n    \"srcDocumentId\": 10000,\n    \"scopes\": null,\n    \"teiId\": \"\",\n    \"name\": \"image\",\n    \"headline\": \"Fig. 1. \",\n    \"description\": \"Fig. 1. GPA\",\n    \"inBody\": true,\n    \"image\": \"a long string\",\n    \"internalUrl\": \"image.png\",\n    \"source\": \"&lt;figure xmlns=\\\"http://www.tei-c.org/ns/1.0\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xml:id=\\\"fig_3\\\"&gt;&lt;head&gt;Fig. 1. &lt;/head&gt;&lt;figDesc&gt;Fig. 1. GPA&lt;/figDesc&gt;&lt;graphic coords=\\\"4,130.95,64.62,360.00,502.42\\\" type=\\\"bitmap\\\" url=\\\"image.png\\\"/&gt;&lt;/figure&gt;\",\n    \"ord\": 0\n  }\n]\n</code></pre>\n\n<p>Any help would be appreciated. Even if you tell me only the logic on how should I handle this in a model and then at the view.</p>\n\n<p>Edit:</p>\n\n<p>Let's say I want to show the headline and description of the image first. I have this in <code>document_helper.rb</code> :</p>\n\n<pre><code>  def images_format(image)\n    m = []\n    m &lt;&lt; [['Description:', image.description]] if image.description\n    m &lt;&lt; [\n        ['Headline', image.headline]\n    ] if image.headline.any?\n\n    m\n  end\n</code></pre>\n\n<p>in <code>document.rb</code> I have this:</p>\n\n<pre><code> class Image\n    include Mongoid::Document\n\n    field :description, type: String\n\n    field :headline, type: String\n\n    field :image, type: String\n\n    field :imageId, type: String\n\n    field :image, type: String\n\n    field :srcDocumentId, type: Integer\n\n    field :internalUrl, type: String\n\n    field :name , type: String\n\n    field :internalUrl, type: String\n\n    field :source, type: String\n\n  end\n</code></pre>\n\n<p>and also this:</p>\n\n<pre><code> embeds_one :image, class_name: 'Document::Image'\n\n  embeds_one :image, class_name: 'Document::Image'\n</code></pre>\n\n<p>and in the view document_show.haml I put: </p>\n\n<pre><code>.document__body= images_format(@document.image)\n</code></pre>\n\n<p>I get this error: <code>undefined method 'description' for nil:NilClass</code></p>\n"}, {"tags": ["ruby", "rspec", "capybara", "jekyll"], "comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1537910548, "post_id": 52506822, "comment_id": 91954151, "body": "Is there a specific reason you create two <code>Capybara::Selenium::Driver</code> instances in your <code>:headless_chrome</code> driver registration?"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 1, "creation_date": 1537910859, "post_id": 52506822, "comment_id": 91954266, "body": "On a side note -- your example test file really isn&#39;t actually testing anything since <code>has_xxx?</code> just returns true or false and therefore won&#39;t ever cause the test to fail - you should be doing <code>expect(page).to have_css(...)</code> - etc."}, {"owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1537916169, "post_id": 52506822, "comment_id": 91955747, "body": "re: two instances -- just a hold-over from my debugging, testing various parts of the config to see what caused the issue."}, {"owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1537916251, "post_id": 52506822, "comment_id": 91955773, "body": "re: example test is very literally just an example cause I had to remove some identifying info from the tests. The real tests are much more robust, I promise."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 0, "creation_date": 1537914007, "post_id": 52507221, "comment_id": 91955212, "body": "You are a lovely, wonderful, intelligent person who should be showered with gifts and accolades. Ima start digging into your suggestions immediately and report back on how it goes."}, {"owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 0, "creation_date": 1537919057, "post_id": 52507221, "comment_id": 91956372, "body": "Ok, I&#39;m at a loss. I don&#39;t have a deep enough understanding of jekyll-rack to apply your advice and I keep hitting walls as I try go plow my was through.  I first tried via the mutex/conditional in the jekyll-rack test suite. No luck there. Here&#39;s a gist of my changes, and the result: <a href=\"https://gist.github.com/johnhutch/81d557cb49efa2c67efaefae69fa13f1\" rel=\"nofollow noreferrer\">gist.github.com/johnhutch/81d557cb49efa2c67efaefae69fa13f1</a>  Then I tried the more simple solution: <a href=\"https://gist.github.com/johnhutch/98f6c6a3e66c630d36ba954968e80ce9\" rel=\"nofollow noreferrer\">gist.github.com/johnhutch/98f6c6a3e66c630d36ba954968e80ce9</a>  Still no dice :(  I feel like a greedy help vampire to ask for more help, but if you have minute, I&#39;d be super appreciative!"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 1, "creation_date": 1537919280, "post_id": 52507221, "comment_id": 91956420, "body": "@JohnHutch You may need to be running the master branch of <code>rack-jekyll</code> for  that to work - just loop with a small sleep (.1 or so) until jekyll.compiling? is false with the release version (0.5) I think"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 1, "creation_date": 1537919831, "post_id": 52507221, "comment_id": 91956521, "body": "@JohnHutch I assume you noticed I edited my answer and changed to <code>compiling?</code> and that it will be false when done -- When the master branch was changed to use a mutex it also replaced <code>compiling?</code> with <code>completed?</code>- <a href=\"https://github.com/adaoraul/rack-jekyll/commit/65487d97e0d9be849ae9a61d7b18aea84e56b84d\" rel=\"nofollow noreferrer\">github.com/adaoraul/rack-jekyll/commit/&hellip;</a>"}, {"owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 0, "creation_date": 1537927628, "post_id": 52507221, "comment_id": 91958024, "body": "You beautiful, wonderful genius person. It worked! Specifically:  sleep 0.1 while Capybara.app.compiling?"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "edited": false, "score": 1, "creation_date": 1537979582, "post_id": 52507221, "comment_id": 91984320, "body": "@John Hutch If this answer is helpful then please accept the answer, there is a hallow tic below the down vote symbol which you need to click and it would turn out to green after your click."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1537979935, "last_edit_date": 1537979935, "creation_date": 1537912709, "answer_id": 52507221, "question_id": 52506822, "link": "https://stackoverflow.com/questions/52506822/testing-a-jekyll-site-with-rspec-and-capybara-getting-a-bizarre-race-case-on-rs/52507221#52507221", "title": "Testing a Jekyll site with rspec and capybara, getting a bizarre race-case on rspec start", "body": "<p>This sounds like jekyll is changing the current directory while building the site, which since it is being run in a thread also affects the tests RSpec is trying to run (See <a href=\"https://bugs.ruby-lang.org/issues/9785\" rel=\"nofollow noreferrer\">https://bugs.ruby-lang.org/issues/9785</a> for why <code>Dir.chdir</code> is not threadsafe) - leading to attempts to load things from incorrect locations.</p>\n\n<p>A potential solution to this would be to wait for the Jekyll site to be built before actually running your tests. A comment in your <code>spec_helper</code> seems to state that someone thought passing <code>force_build: true</code> would do this but from a quick perusal of the <code>jekyll-rack</code> code I don't think that's true and you actually need to wait for <code>compiling?</code> to return false (v 0.5) (<code>complete?</code> to return true in the current master branch) to ensure building has finished (as well as passing <code>force_build</code>).  This could either be done in a loop sleeping and checking (simpler)</p>\n\n<pre><code>sleep 0.1 while &lt;jekyll app&gt;.compiling?\n</code></pre>\n\n<p>or (if using the master branch) via the mutex/conditional Rack::Jekyll exposes like in its test suite - <a href=\"https://github.com/adaoraul/rack-jekyll/blob/master/test/helper.rb#L49\" rel=\"nofollow noreferrer\">https://github.com/adaoraul/rack-jekyll/blob/master/test/helper.rb#L49</a></p>\n\n<p>Note: Also check my comment about your tests that aren't actually testing anything.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "is_accepted": false, "score": 0, "last_activity_date": 1537927712, "creation_date": 1537927712, "answer_id": 52508953, "question_id": 52506822, "link": "https://stackoverflow.com/questions/52506822/testing-a-jekyll-site-with-rspec-and-capybara-getting-a-bizarre-race-case-on-rs/52508953#52508953", "title": "Testing a Jekyll site with rspec and capybara, getting a bizarre race-case on rspec start", "body": "<p>As per Thomas Walpole's super helpful responses this ended up working: </p>\n\n<p>sleep 0.1 while Capybara.app.compiling?</p>\n\n<p>inserted right after:</p>\n\n<p>51   Capybara.app = Rack::Jekyll.new(force_build: true)</p>\n\n<p>in my spec_helper.rb</p>\n\n<p>Thanks again, Thomas!</p>\n"}], "owner": {"reputation": 117, "user_id": 707224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2be25299d500d4d46c00b904505ece6b?s=128&d=identicon&r=PG", "display_name": "John Hutch", "link": "https://stackoverflow.com/users/707224/john-hutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 52507221, "answer_count": 2, "score": 1, "last_activity_date": 1537979935, "creation_date": 1537910266, "question_id": 52506822, "link": "https://stackoverflow.com/questions/52506822/testing-a-jekyll-site-with-rspec-and-capybara-getting-a-bizarre-race-case-on-rs", "title": "Testing a Jekyll site with rspec and capybara, getting a bizarre race-case on rspec start", "body": "<p>So check this out: it <em>appears</em> as though, upon running <code>bundle exec rspec</code>, there's a race between <code>jekyll serve</code> and puma/rspec's boot up. Sometimes I run the command, and my tests run fine. Other times, I get the error for each of my spec files: <code>cannot load such file -- /path/to/project/sitename_jekyll/_layouts/spec/form_spec.rb</code> which is interesting cause that's not where my spec files are located. They're in /path/to/project/sitename_jekyll/spec/form_spec.rb. </p>\n\n<p>What's crazy is that I can literally just re-run the command over and over and over again and sometimes it'll go through and run the spec tests in the correct location, and sometimes it'll look for them in _layouts and error out. It probably runs correctly maybe once out of ever three or five attempts. All the other times I get the following errors:</p>\n\n<p>Here's what my spec_helper.rb looks like: <a href=\"https://gist.github.com/johnhutch/2cddfafcde0485ff021501d5696c0c2d\" rel=\"nofollow noreferrer\">https://gist.github.com/johnhutch/2cddfafcde0485ff021501d5696c0c2d</a></p>\n\n<p>And here's an example test file:\n<a href=\"https://gist.github.com/johnhutch/a35d15c170f5fd9ca07998bf035d111d\" rel=\"nofollow noreferrer\">https://gist.github.com/johnhutch/a35d15c170f5fd9ca07998bf035d111d</a></p>\n\n<p>My .rspec only contains two lines:\n    --color<br>\n    --require spec_helper</p>\n\n<p>And here's the output, both successful and unsuccesful, back to back: \n<a href=\"https://gist.github.com/johnhutch/7927d609170ef5c70a595735502b128d\" rel=\"nofollow noreferrer\">https://gist.github.com/johnhutch/7927d609170ef5c70a595735502b128d</a></p>\n\n<p>HEEELLLLLP! </p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "edited": false, "score": 0, "creation_date": 1537910223, "post_id": 52506761, "comment_id": 91954051, "body": "I tested this in console and it seems to change across arrays. My guess is that each array only contains pointers to the objects, as opposed to the objects themselves. This way the same exact object is effectively in both arrays. Can someone confirm this?  Leaving this question up in case it helps someone else."}], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": true, "score": 0, "last_activity_date": 1537944332, "creation_date": 1537944332, "answer_id": 52511508, "question_id": 52506761, "link": "https://stackoverflow.com/questions/52506761/concise-way-to-change-object-across-multiple-arrays/52511508#52511508", "title": "Concise way to change object across multiple arrays", "body": "<p>There is no such thing as \"changing an object across arrays\". An object does not know and does not care whether it is in an array or not.</p>\n\n<p>Changing an object changes an object. Period. If that object is contained in multiple arrays, then you will observe that change, regardless of how you obtain the object. But it is not \"changed across arrays\". It is simply changed.</p>\n\n<p>If you cut your hair, everybody who looks at you will observe that your hair is short, regardless of whether they perceive you as \"student #1234\", \"the quarterback of the Backwater Swamprats\", or \"the youngest son of the Smith family\". What reference is used to address you has no bearing on whether your hair is short or not.</p>\n"}], "owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 52511508, "answer_count": 1, "score": 1, "last_activity_date": 1537944332, "creation_date": 1537909881, "question_id": 52506761, "link": "https://stackoverflow.com/questions/52506761/concise-way-to-change-object-across-multiple-arrays", "title": "Concise way to change object across multiple arrays", "body": "<p>I'm looking to know if changing an object in one array will change it in others.</p>\n\n<p>I have an array of tasks, each of which is a hash object with <code>:id, :user, :task</code> </p>\n\n<p>I then use <code>duplicates = tasks.select{|task| sample code}</code> to select some tasks from that array.</p>\n\n<p>If I change a task in <code>duplicates</code>, will it change in <code>tasks</code> as well? If not, are there any good ways to search for that same task?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1537908676, "post_id": 52506403, "comment_id": 91953404, "body": "<a href=\"https://stackoverflow.com/questions/30143180/puma-gem-failed-to-build-gem-native-extension/43174470#43174470\" title=\"puma gem failed to build gem native extension\">stackoverflow.com/questions/30143180/&hellip;</a>"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1537908791, "post_id": 52506403, "comment_id": 91953463, "body": "Also you should edit your question to include: platform and version you are using, what command did you execute to get the error, any other troubleshooting steps you&#39;ve taken."}], "answers": [{"comments": [{"owner": {"reputation": 2821, "user_id": 1600332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74c89d5583301aa6df59cfa9f0f45354?s=128&d=identicon&r=PG", "display_name": "Elletlar", "link": "https://stackoverflow.com/users/1600332/elletlar"}, "edited": false, "score": 0, "creation_date": 1537910069, "post_id": 52506545, "comment_id": 91953985, "body": "Welcome to Stack Overflow. This is a minimal answer. It would be more helpful if you provided an explanation along instructions for the installation. <a href=\"https://stackoverflow.com/help/how-to-answer\">How to Answer</a>. Thanks."}], "tags": [], "owner": {"reputation": 54, "user_id": 9888895, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5R_ChTfpe_c/AAAAAAAAAAI/AAAAAAAAACQ/TulTZHqDgzI/photo.jpg?sz=128", "display_name": "Aravind", "link": "https://stackoverflow.com/users/9888895/aravind"}, "is_accepted": false, "score": 0, "last_activity_date": 1537908878, "creation_date": 1537908878, "answer_id": 52506545, "question_id": 52506403, "link": "https://stackoverflow.com/questions/52506403/ruby-on-rails-installation-gem-puma-error/52506545#52506545", "title": "Ruby on rails installation gem puma error", "body": "<p>I believe installing Ruby Gem puma should solve your problem.</p>\n\n<p>Regards.</p>\n"}, {"tags": [], "owner": {"reputation": 50, "user_id": 4780761, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fKBof-K7IWw/AAAAAAAAAAI/AAAAAAAAAaU/MbThUrIht3k/photo.jpg?sz=128", "display_name": "C.J. Coffey", "link": "https://stackoverflow.com/users/4780761/c-j-coffey"}, "is_accepted": false, "score": 0, "last_activity_date": 1537910547, "creation_date": 1537910547, "answer_id": 52506874, "question_id": 52506403, "link": "https://stackoverflow.com/questions/52506403/ruby-on-rails-installation-gem-puma-error/52506874#52506874", "title": "Ruby on rails installation gem puma error", "body": "<p>In this case, the first line is your error. It looks like you are requiring puma in your code or your gemfile (or...one of the gems you are requiring relies on puma).</p>\n\n<p>You should add puma version 3.11 to your gemfile, then run <code>bundle-install</code> to install everything in your gemfile. </p>\n"}], "owner": {"reputation": 1, "user_id": 10415447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7e228e6f8c1107a3326e6d01e63a27d?s=128&d=identicon&r=PG&f=1", "display_name": "A Denver", "link": "https://stackoverflow.com/users/10415447/a-denver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1537910547, "creation_date": 1537908141, "last_edit_date": 1537908446, "question_id": 52506403, "link": "https://stackoverflow.com/questions/52506403/ruby-on-rails-installation-gem-puma-error", "title": "Ruby on rails installation gem puma error", "body": "<p>Error:[rake --tasks] /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:286:in <code>block in verify_gemfile_dependencies_are_found!': Could not find gem 'puma (~&gt; 3.11)' in any of the gem sources listed in your Gemfile. (Bundler::GemNotFound)\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:254:in</code>each'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:254:in <code>verify_gemfile_dependencies_are_found!'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:48:in</code>start'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:22:in <code>resolve'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:258:in</code>resolve'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:171:in <code>specs'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:238:in</code>specs_for'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:227:in <code>requested_specs'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:108:in</code>block in definition_method'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:20:in <code>setup'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler.rb:107:in</code>setup'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/setup.rb:20:in <code>&lt;top (required)&gt;'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in</code>require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in <code>rescue in require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:39:in</code>require'\n    from /Users/abhisumishra/RubymineProjects/untitled5/config/boot.rb:3:in <code>&lt;top (required)&gt;'\n    from /Users/abhisumishra/RubymineProjects/untitled5/bin/rake:2:in</code>require_relative'\n    from /Users/abhisumishra/RubymineProjects/untitled5/bin/rake:2:in <code>&lt;main&gt;'\nError:[rake --prereqs] /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:286:in</code>block in verify_gemfile_dependencies_are_found!': Could not find gem 'puma (~> 3.11)' in any of the gem sources listed in your Gemfile. (Bundler::GemNotFound)\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:254:in <code>each'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:254:in</code>verify_gemfile_dependencies_are_found!'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:48:in <code>start'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/resolver.rb:22:in</code>resolve'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:258:in <code>resolve'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:171:in</code>specs'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:238:in <code>specs_for'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/definition.rb:227:in</code>requested_specs'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:108:in <code>block in definition_method'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:20:in</code>setup'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler.rb:107:in <code>setup'\n    from /Users/abhisumishra/.gem/ruby/2.3.0/gems/bundler-1.16.5/lib/bundler/setup.rb:20:in</code>'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in <code>require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:127:in</code>rescue in require'\n    from /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/rubygems/core_ext/kernel_require.rb:39:in <code>require'\n    from /Users/abhisumishra/RubymineProjects/untitled5/config/boot.rb:3:in</code>'\n    from /Users/abhisumishra/RubymineProjects/untitled5/bin/rake:2:in <code>require_relative'\n    from /Users/abhisumishra/RubymineProjects/untitled5/bin/rake:2:in</code>'\nThese are the errors I get when trying to install rails. Please help.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 4866, "user_id": 6603195, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nZGPkfcc0EE/AAAAAAAAAAI/AAAAAAAAAoE/op-TBiFRNzg/photo.jpg?sz=128", "display_name": "Marcin Ko\u0142odziej", "link": "https://stackoverflow.com/users/6603195/marcin-ko%c5%82odziej"}, "is_accepted": true, "score": 4, "last_activity_date": 1537904810, "creation_date": 1537904810, "answer_id": 52505707, "question_id": 52505672, "link": "https://stackoverflow.com/questions/52505672/access-a-constant-defined-in-class-from-a-mixin-included-in-the-class/52505707#52505707", "title": "Access a constant defined in class from a mixin included in the class", "body": "<p>You can use <code>self.class::BASE_URL</code>.</p>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52505707, "answer_count": 1, "score": 2, "last_activity_date": 1537904845, "creation_date": 1537904679, "last_edit_date": 1537904845, "question_id": 52505672, "link": "https://stackoverflow.com/questions/52505672/access-a-constant-defined-in-class-from-a-mixin-included-in-the-class", "title": "Access a constant defined in class from a mixin included in the class", "body": "<p>I have a mixin (<code>Api::Utility</code>) that is referenced by two classes: <code>Api::Utility::One::WorkstationClient</code> and <code>Api::Utility::Two::WorkstationClient</code>.  Both classes define a constant, <code>BASE_URL</code>, that I'd like to access in the mixin.  When I attempt to access the constant, I get an error that reads `NameError (uninitialized constant Epic::Api::Utility::BASE_URL).</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nmodule Api\n\n  class WorkstationClientFactory\n\n    def self.create_client(version = :v2)\n      case version\n      when :v2\n        Two::WorkstationClient.new()\n      when :v1\n        One::WorkstationClient.new()\n      else\n        raise ArgumentError, \"'#{version.inspect}' is not a valid version symbol.  Valid: [:v1|:v2].\"\n      end\n    end\n\n  end # /WorkstationClientFactory\n\n  # Api::Utility\n  module Utility\n    def bar\n      puts \"BASE_URL: #{BASE_URL}\"\n    end\n  end\n\n  module One\n    # Api::One::WorkstationClient\n    class WorkstationClient\n      include Api::Utility\n\n      BASE_URL = 'https://domain.tld/api/v1'\n\n      def initialize()\n        puts \"Creating #{self.class.name}\"\n      end\n\n    end # /WorkstationClient\n  end # One\n\n  module Two\n    # Api::Two::WorkstationClient\n    class WorkstationClient\n      include Api::Utility\n\n      BASE_URL = 'https://domain.tld/api/v2'\n\n      def initialize()\n        puts \"Creating #{self.class.name}\"\n      end\n\n    end # /WorkstationClient\n  end # /Two\n\nend # /module\n\nv1 = Api::WorkstationClientFactory.create_client(:v1)\nv1.bar &lt;-- error here\nBASE_URL: https://domain.tld/api/v1  &lt;-- desired result\n\nv2 = Api::WorkstationClientFactory.create_client(:v2)\nv2.bar &lt;-- error here\nBASE_URL: https://domain.tld/api/v2  &lt;-- desired result\n</code></pre>\n\n<p>What's the right way to access the <code>BASE_URL</code> in the mixin, in this situation?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1537901356, "post_id": 52504728, "comment_id": 91950305, "body": "Try <a href=\"https://regex101.com/r/JmjthP/4\" rel=\"nofollow noreferrer\">regex101.com/r/JmjthP/4</a>"}, {"owner": {"reputation": 596, "user_id": 1032752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/882c3ddbfd286ff010276cb96dab3db5?s=128&d=identicon&r=PG", "display_name": "user1032752", "link": "https://stackoverflow.com/users/1032752/user1032752"}, "reply_to_user": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537976066, "post_id": 52504728, "comment_id": 91982406, "body": "Thanks a lot. I made a few tweaks and it&#39;s working great. Do you want to post that as an answer and I&#39;ll accept it?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537977056, "post_id": 52504728, "comment_id": 91982975, "body": "Ok, posted with an explantion."}], "answers": [{"tags": [], "owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1537977042, "creation_date": 1537977042, "answer_id": 52521751, "question_id": 52504728, "link": "https://stackoverflow.com/questions/52504728/ruby-regexp-match-all-css-selectors-and-directives/52521751#52521751", "title": "Ruby RegExp - Match all CSS selectors and directives", "body": "<p>You may use</p>\n\n<pre><code>^(?!.*@media) *[a-zA-Z#.:*][^{]*{[\\s\\S]*?}\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/JmjthP/6\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>(?!.*@media)</code> - no <code>@media</code> allowed after any 0+ chars other than line break chars</li>\n<li><code> *</code> - 0+ spaces</li>\n<li><code>[a-zA-Z#.:*]</code> - a letter, <code>#</code>, <code>.</code>, <code>:</code> or <code>*</code></li>\n<li><code>[^{]*</code> - zero or more chars other than <code>{</code></li>\n<li><code>{</code> - a <code>{</code> char</li>\n<li><code>[\\s\\S]*?</code> - 0+ chars, as few as possible.</li>\n<li><code>}</code>  - a <code>}</code> char</li>\n</ul>\n"}], "owner": {"reputation": 596, "user_id": 1032752, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/882c3ddbfd286ff010276cb96dab3db5?s=128&d=identicon&r=PG", "display_name": "user1032752", "link": "https://stackoverflow.com/users/1032752/user1032752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52521751, "answer_count": 1, "score": 1, "last_activity_date": 1537977042, "creation_date": 1537900524, "last_edit_date": 1537976158, "question_id": 52504728, "link": "https://stackoverflow.com/questions/52504728/ruby-regexp-match-all-css-selectors-and-directives", "title": "Ruby RegExp - Match all CSS selectors and directives", "body": "<p>I'm trying to match all the CSS selectors and directives below excluding any comments and any media queries.</p>\n\n<pre><code>a {color: red !important;}\n\n#p1 {\n        margin-top: 20px !important\n      }\n\n/* Client-specific styles */\n\n      .ExternalClass,  \n      .ExternalClass p,  \n      .ExternalClass span,  \n      .ExternalClass font,  \n      .ExternalClass td,  \n      .ExternalClass div {\n        line-height: 100%;\n      }\n\na {}\n\n@media query {\n    a { display:none }  \n}\n</code></pre>\n\n<p>I've come up with the following RegEx: <code>[a-zA-Z#.:*]{1}[^\\/*]+?{[\\s\\S]*?}</code>. This matches everything correctly but includes the <code>@media query</code>. I've tried using a negative lookahead e.g. <code>(?!.+@media.+)</code> but that didn't help.</p>\n\n<p>What can I do to extract only the selectors/directives?</p>\n\n<p>Example: <a href=\"https://regex101.com/r/JmjthP/3\" rel=\"nofollow noreferrer\">https://regex101.com/r/JmjthP/3</a></p>\n\n<p><strong>Solution</strong></p>\n\n<p>With help from @Wiktor Stribi\u017cew the working solution was this:</p>\n\n<p><code>/^(?!.*@media)[\\t ]*([a-zA-Z#.:*\\[][^{\\/]*\\s*){[\\s\\S]*?}/</code></p>\n"}, {"tags": ["ruby", "docker", "rubygems", "docker-compose", "dockerfile"], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 1912804, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e33c77bf9c7df73d75eb733f6bff94f?s=128&d=identicon&r=PG", "display_name": "Arran Scott", "link": "https://stackoverflow.com/users/1912804/arran-scott"}, "edited": false, "score": 0, "creation_date": 1569411993, "post_id": 56481396, "comment_id": 102587190, "body": "This has helped me after a day of head scratching and trying loads of different things. Thanks. I&#39;ve set LOCAL_GEM_PATH as an environment variable in the docker-compose.yml file so it&#39;s only set when building. If you want to edit your local gem in development you&#39;ll need to make sure you mount your gem as a volume inside the container."}], "tags": [], "owner": {"reputation": 443, "user_id": 963040, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/81ba3abf000b16cf812bcb22135dd5ed?s=128&d=identicon&r=PG", "display_name": "tuck", "link": "https://stackoverflow.com/users/963040/tuck"}, "is_accepted": false, "score": 1, "last_activity_date": 1559837357, "creation_date": 1559837357, "answer_id": 56481396, "question_id": 52503356, "link": "https://stackoverflow.com/questions/52503356/running-docker-image-with-a-separate-local-gemspec/56481396#56481396", "title": "Running docker image with a separate local gemspec", "body": "<p>I've been dealing with a very similar issue, and think this is working for me:</p>\n\n<p><strong>Gemfile</strong></p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n\ngem_path = ENV.fetch('LOCAL_GEM_PATH', '.')\n\ngem 'my_personal_gem', path: File.join(gem_path, 'my_personal_gem')\n</code></pre>\n\n<p>Then you can set <code>LOCAL_GEM_PATH</code> to where the directory containing the Gems are. </p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 3958226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921910627bec1f033fa034102c4d9bb0?s=128&d=identicon&r=PG&f=1", "display_name": "B12", "link": "https://stackoverflow.com/users/3958226/b12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559837357, "creation_date": 1537894878, "last_edit_date": 1537912383, "question_id": 52503356, "link": "https://stackoverflow.com/questions/52503356/running-docker-image-with-a-separate-local-gemspec", "title": "Running docker image with a separate local gemspec", "body": "<p>Currently we have a Dockerfile to create our test image.  </p>\n\n<pre><code>FROM ruby:2.4\n\nUSER root\n\nENV LOCAL_GEM_PATH ./../qa-common/\n\nRUN /bin/bash -l -c \"gem install nokogiri -v 1.8 --no-ri --no-rdoc\"\n\n\nCOPY Gemfile* /tmp/\nCOPY qa-common $LOCAL_GEM_PATH\nWORKDIR /tmp\n\n#================================================================\n# Installs gems . Put frequently changed commands (COPY, ADD)\n# after this as section as much possible to insure a quick build\n#================================================================\n\nRUN /bin/bash -l -c \"gem install bundler --no-ri --no-rdoc\"\nRUN /bin/bash -l -c \"bundle install\"\n\nCOPY . /usr/src/app\nWORKDIR /usr/src/app\n\nCMD [\"-T\"]\n\nENTRYPOINT [\"bundle\", \"exec\", \"ruby\", \"bin/run_tests_from_queue.rb\"]\n</code></pre>\n\n<p>We are running into an error where the bundle install in the Dockerfile cannot find the qa-common gem (which is a local repository on my machine with a .gempspec)</p>\n\n<p>Normally without docker, the current project's gemfile specifies so changes we make to qa-common can be tested on our local machine</p>\n\n<pre><code>gem 'qa-common', :path =&gt; local_gem_directory\n</code></pre>\n\n<p>Everything we've tried is preventing this bundle install because it either cannot find the gem/gemspec or because qa-common is outside the test directory (where the Dockerfile resides).</p>\n\n<p>What is the best practice or solution to this problem so that when we create an image to run tests that depends on this qa-common gem, we can use the local qa-common version on our machine to test our changes to qa-common has not broken anything?</p>\n"}, {"tags": ["ruby", "sinatra"], "answers": [{"comments": [{"owner": {"reputation": 463, "user_id": 558651, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/588421810/picture?type=large", "display_name": "Jae Lee", "link": "https://stackoverflow.com/users/558651/jae-lee"}, "edited": false, "score": 0, "creation_date": 1537895852, "post_id": 52503420, "comment_id": 91947711, "body": "Thanks for this! But I&#39;m just curious, how optimized is this Gem?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 463, "user_id": 558651, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/588421810/picture?type=large", "display_name": "Jae Lee", "link": "https://stackoverflow.com/users/558651/jae-lee"}, "edited": false, "score": 0, "creation_date": 1537896129, "post_id": 52503420, "comment_id": 91947853, "body": "If the data comes from AJAX call it won&#39;t be a bottleneck. Feel free to examine the source if in doubt."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1537895143, "creation_date": 1537895143, "answer_id": 52503420, "question_id": 52503157, "link": "https://stackoverflow.com/questions/52503157/how-can-you-get-sinatra-to-properly-process-a-json-request-that-has-an-array-in/52503420#52503420", "title": "How can you get Sinatra to properly process a JSON request that has an array in it?", "body": "<p>I had the same problem a while ago and I have created the <code>gem</code> doing that (any many other things simplifying deeply nested structures iteration/mapping). Check <a href=\"https://github.com/am-kantox/iteraptor\" rel=\"nofollow noreferrer\"><code>Iteraptor</code></a>.</p>\n\n<pre><code>json = {\"cart\" =&gt; {\n  \"0\"=&gt;{\"qty\"=&gt;\"1\", \"product\"=&gt; {\"name\"=&gt;\"baseball\"} },  \n  \"1\"=&gt;{\"qty\"=&gt;\"3\", \"product\"=&gt; {\"name\"=&gt;\"soccer\"} }  \n}}\njson.aplanar.recoger(symbolize_keys: true)\n#\u21d2\u00a0{:cart=&gt;[\n#    {:qty=&gt;\"1\", :product=&gt;{:name=&gt;\"baseball\"}},\n#    {:qty=&gt;\"3\", :product=&gt;{:name=&gt;\"soccer\"}}]}\n</code></pre>\n\n<p>You might check the source code to see it\u2019s not entirely trivial to achieve the desired result manually.</p>\n"}, {"tags": [], "owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "is_accepted": false, "score": 2, "last_activity_date": 1537895948, "creation_date": 1537895948, "answer_id": 52503615, "question_id": 52503157, "link": "https://stackoverflow.com/questions/52503157/how-can-you-get-sinatra-to-properly-process-a-json-request-that-has-an-array-in/52503615#52503615", "title": "How can you get Sinatra to properly process a JSON request that has an array in it?", "body": "<pre><code>cart_params = {\"cart\" =&gt; {\n  \"0\"=&gt;{\"qty\"=&gt;\"1\", \"product\"=&gt; {\"name\"=&gt;\"baseball\"} },\n  \"1\"=&gt;{\"qty\"=&gt;\"3\", \"product\"=&gt; {\"name\"=&gt;\"soccer\"} }\n}}\n\n&gt; hash = JSON.parse(cart_params.to_json, symbolize_names: true)\n&gt; hash[:cart] = hash[:cart].values\n&gt; hash\n#=&gt; {\n#    :cart=&gt;[\n#            {:qty=&gt;\"1\", :product=&gt;{:name=&gt;\"baseball\"}}, \n#            {:qty=&gt;\"3\", :product=&gt;{:name=&gt;\"soccer\"}}\n#          ]\n#   }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "is_accepted": true, "score": 3, "last_activity_date": 1537916985, "creation_date": 1537916985, "answer_id": 52507767, "question_id": 52503157, "link": "https://stackoverflow.com/questions/52503157/how-can-you-get-sinatra-to-properly-process-a-json-request-that-has-an-array-in/52507767#52507767", "title": "How can you get Sinatra to properly process a JSON request that has an array in it?", "body": "<p>The first thing you need to understand to solve this problem is that you are currently <em>not</em> sending JSON. JQuery is serializing the data as <code>application/x-www-form-urlencoded</code>, using the <a href=\"https://api.jquery.com/jQuery.param/\" rel=\"nofollow noreferrer\"><code>param()</code> function</a>, and is sending (it is actually sending the escaped version of this):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>cart[0][qty]=1&amp;cart[0][product][name]=baseball&amp;cart[1][qty]=3&amp;cart[1][product][name]=soccer\n</code></pre>\n\n<p>The documentation for <code>param()</code> has the following pair of notes:</p>\n\n<blockquote>\n  <p>Note: Because some frameworks have limited ability to parse serialized arrays, developers should exercise caution when passing an obj argument that contains objects or arrays nested within another array.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Note: Because there is no universally agreed-upon specification for param strings, it is not possible to encode complex data structures using this method in a manner that works ideally across all languages supporting such input. Use JSON format as an alternative for encoding complex data instead.</p>\n</blockquote>\n\n<p>This is the issue you are facing. Sinatra tries to parse the form-urlencoded data into a Ruby data structure, but it is expecting a different format. It is using <code>Rack::Utils.parse_nested_query</code> which produces the params you are seeing from that query string.</p>\n\n<p>As the jQuery docs suggest, the solution is to send the data as JSON. This will ensure the structure of the data is not mangled between the browser and the server.</p>\n\n<p>The first step is to get the browser to send JSON. You can do this with the other form of the <code>post()</code> function, specifying the content type and converting the data to a JSON string:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$.post({url: \"/endpoint\", data: JSON.stringify(payload), contentType: \"application/json\", success: submit});\n</code></pre>\n\n<p>By default Sinatra will ignore any request with a content type of JSON, and leave the processing to you, so the other half of the solution is to get Sinatra to parse the JSON, and optionally populate the params hash.</p>\n\n<p>One way of doing this to use the Rack contrib module <code>PostBodyContentTypeParser</code>. Simply add the following to your app (you will need to install the <code>rack-contrib</code> gem first):</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'rack/contrib/post_body_content_type_parser'\n\nuse Rack::PostBodyContentTypeParser\n</code></pre>\n\n<p>Now any POST or PUT request that has a JSON content type will be parsed and the contents added to the params hash. However the current released version doesn\u2019t have and way to convert the keys to symbols (there is a change in master to allow this, but it hasn\u2019t been released yet) so it will produce something like:</p>\n\n<pre><code>{\n  \"cart\"=&gt;[\n    {\"qty\"=&gt;1, \"product\"=&gt;{\"name\"=&gt;\"baseball\"}},\n    {\"qty\"=&gt;3, \"product\"=&gt;{\"name\"=&gt;\"soccer\"}}\n  ]\n}\n</code></pre>\n\n<p>If you want to get symbolized keys you will have to do it \u201cmanually\u201d. In your route you can add:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>request.body.rewind # Just in case some middleware has already read it\ndata = JSON.parse(request.body.read, symbolize_names: true)\n</code></pre>\n\n<p>(You could add this to a <code>before</code> filter if you wanted, just add a check that the content type actually is JSON).</p>\n\n<p>This doesn\u2019t add the data to the <code>params</code> hash, but does give you the data in the form you are looking for.</p>\n"}], "owner": {"reputation": 463, "user_id": 558651, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/588421810/picture?type=large", "display_name": "Jae Lee", "link": "https://stackoverflow.com/users/558651/jae-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 52507767, "answer_count": 3, "score": 1, "last_activity_date": 1537916985, "creation_date": 1537894074, "question_id": 52503157, "link": "https://stackoverflow.com/questions/52503157/how-can-you-get-sinatra-to-properly-process-a-json-request-that-has-an-array-in", "title": "How can you get Sinatra to properly process a JSON request that has an array in it?", "body": "<p>I am POST'ing to a Sinatra with javascript as follows:</p>\n\n<pre><code>var payload = {\n  cart: [ \n    {qty: 1, product: { name: 'baseball' },\n    {qty: 3, product: { name: 'soccer' } \n  ]\n}\n\n$.post(\"/endpoint\", payload, submit)\n</code></pre>\n\n<p>From Sinatra, params yields the following:</p>\n\n<pre><code>{\"cart\" =&gt; {\n  \"0\"=&gt;{\"qty\"=&gt;\"1\", \"product\"=&gt; {\"name\"=&gt;\"baseball\"} },\n  \"1\"=&gt;{\"qty\"=&gt;\"3\", \"product\"=&gt; {\"name\"=&gt;\"soccer\"} }\n}}\n</code></pre>\n\n<p>How can I make the params to turn out like this instead?</p>\n\n<pre><code>{ \n  :cart =&gt; [\n    { :qty =&gt; 1, :product =&gt; { :name =&gt; \"baseball\" } },\n    { :qty =&gt; 3, :product =&gt; { :name =&gt; \"soccer\" } },\n  ]\n} \n</code></pre>\n"}, {"tags": ["ruby", "fastlane"], "comments": [{"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1537897425, "post_id": 52502900, "comment_id": 91948490, "body": "What ruby <i>are</i> you using? Updated your OS recently?"}, {"owner": {"reputation": 743, "user_id": 9896681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480b5e6e767242c85032dd23181ddb00?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaBeta", "link": "https://stackoverflow.com/users/9896681/alphabeta"}, "reply_to_user": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1537953251, "post_id": 52502900, "comment_id": 91967861, "body": "ruby v2.5.1 managed by rbenv. no os update, just a fastlane update from 2.103.1 to 2.105.2, which is what appears to have caused the problem. As I don&#39;t know much about ruby, I&#39;m not sure how to fix it."}, {"owner": {"reputation": 9436, "user_id": 252627, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b8128cc645c1a135f1fc28ba1294b53c?s=128&d=identicon&r=PG", "display_name": "janpio", "link": "https://stackoverflow.com/users/252627/janpio"}, "edited": false, "score": 0, "creation_date": 1537958202, "post_id": 52502900, "comment_id": 91971001, "body": "Seems the equivalent to what the error message says for <code>rbenv</code> would be <code>rbenv global system</code>. Have you tried that and then rerunning the lane? (The error message you are seeing is not from fastlane as far as I could investigate)"}], "owner": {"reputation": 743, "user_id": 9896681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480b5e6e767242c85032dd23181ddb00?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaBeta", "link": "https://stackoverflow.com/users/9896681/alphabeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537915866, "creation_date": 1537893166, "last_edit_date": 1537915866, "question_id": 52502900, "link": "https://stackoverflow.com/questions/52502900/fastlane-update-breaks-ruby", "title": "Fastlane update breaks ruby", "body": "<p>When I ran a fastlane script to build and upload an ionic app to Hockeyapp, I saw the following message:</p>\n\n<pre><code># fastlane 2.105.2 is available. You are on 2.103.1.\n# You should use the latest version.\n# Please update using `bundle update fastlane`.\n</code></pre>\n\n<p>So I ran <code>bundle update fastlane</code>, which appeared to work fine, but when I tried running my fastlane script again, the following error appeared, which I've never seen before:</p>\n\n<pre><code>Non-system Ruby in use. This may cause packaging to fail.\nIf you use RVM, please run `rvm use system`.\nIf you use chruby, please run `chruby system`.\nerror: archive not found at path '/path-to-app/platforms/ios/appname.xcarchive'\n** EXPORT FAILED **\n</code></pre>\n\n<p>I also saw an extra line appear in the build settings output, which has never been there before:</p>\n\n<pre><code>User defaults from command line:\n    IDEArchivePathOverride = /Users/debbiefigg/Projects/QuickNurse/quick-nurse-app/platforms/ios/Quick Nurse.xcarchive\n</code></pre>\n\n<p>I've spent hours going round in circles trying to figure out how to solve this, but have drawn a blank.</p>\n\n<p>Can anyone suggest why this happened and how to solve it?</p>\n"}, {"tags": ["ruby", "watir", "pageobjects", "page-factory"], "answers": [{"tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": true, "score": 0, "last_activity_date": 1537892849, "creation_date": 1537892849, "answer_id": 52502797, "question_id": 52502616, "link": "https://stackoverflow.com/questions/52502616/cannot-set-using-page-object-model-in-ruby/52502797#52502797", "title": "Cannot set using Page Object Model in ruby", "body": "<p>For the Page-Object gem, the text field accessor adds a method <code>#userfield</code> that returns the current value of the text field. It doesn't return an actual element. For that, you would need to call <code>#userfield_element</code>.</p>\n\n<p>To set the field, you need the <code>#userfield=</code> method:</p>\n\n<pre><code>page.userfield = \"username\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9094593, "user_type": "registered", "profile_image": "https://graph.facebook.com/2172619939433484/picture?type=large", "display_name": "Ankit ShriVatri", "link": "https://stackoverflow.com/users/9094593/ankit-shrivatri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52502797, "answer_count": 1, "score": 1, "last_activity_date": 1538544775, "creation_date": 1537892229, "last_edit_date": 1538544775, "question_id": 52502616, "link": "https://stackoverflow.com/questions/52502616/cannot-set-using-page-object-model-in-ruby", "title": "Cannot set using Page Object Model in ruby", "body": "<p>The user is already on <code>LoginPage</code> and wants to enter username using Page Object technique.</p>\n\n<p>I have described the element in <code>LoginPage</code> class and using same element in step definition page.</p>\n\n<p>I want to do some action on element using Page Object Model but when running using the feature files it throws error that \"<code>undefined method</code>set' for \"\":String . \"`</p>\n\n<pre><code>class LoginPage\n\n  text_field(:userfield, :name =&gt; 'email')\n  text_field(:passfield, :name =&gt; 'password')\n  button(:submit, :type =&gt; 'submit')\nend\n\nStep definition uses :\n\nAnd(/^a user logs in$/) do\n\non LoginPage do |page|\n    page.userfield.set \"username\"\nend\n</code></pre>\n"}, {"tags": ["ruby", "syntactic-sugar"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1537891665, "post_id": 52502436, "comment_id": 91945530, "body": "Link to docs: <a href=\"https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/Enumerable.html#method-i-reduce</a>"}, {"owner": {"reputation": 270, "user_id": 9518258, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "0xdd", "link": "https://stackoverflow.com/users/9518258/0xdd"}, "edited": false, "score": 0, "creation_date": 1537891688, "post_id": 52502436, "comment_id": 91945543, "body": "Interesting find! For the record though, it&#39;s more readable to just use <code>array#flatten</code>, which <i>looks</i> like it&#39;s equivalent."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 270, "user_id": 9518258, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "0xdd", "link": "https://stackoverflow.com/users/9518258/0xdd"}, "edited": false, "score": 2, "creation_date": 1537891773, "post_id": 52502436, "comment_id": 91945600, "body": "@Jules: nope, not flattening. Here it&#39;s a union of the arrays."}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1537891963, "post_id": 52502436, "comment_id": 91945692, "body": "<a href=\"https://ruby-doc.org/core-2.5.1/Array.html#method-i-7C\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.5.1/Array.html#method-i-7C</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537901016, "post_id": 52502436, "comment_id": 91950158, "body": "Your title should be, &quot;What does <code>Array#|</code> do?&quot; (though that could be improved). <code>Array</code> is not the only class with a method named <code>:!</code> (There is <a href=\"http://ruby-doc.org/core-2.5.1/Integer.html#method-i-7C\" rel=\"nofollow noreferrer\">Integer#!</a>, for example.)  &quot;Ruby&quot; in the title is redundant because it is one of your tags."}], "answers": [{"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1537893444, "post_id": 52502469, "comment_id": 91946486, "body": "It worth it to mention, that the first argument in this particular call to <code>reduce</code> is redundant, <code>...reduce(:|)</code> is fine enough. Also, <code>flatten.uniq</code> is worth by any mean (unless we are positive all the arrays are tiny.) It might consume quadratic amount of memory compared to <code>reduce</code>."}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 2, "creation_date": 1537894594, "post_id": 52502469, "comment_id": 91947100, "body": "@mudasobwa the first argument is necessary in the case where the input array is empty, but you want <code>reduce</code> to return an array regardless."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1537901634, "post_id": 52502469, "comment_id": 91950429, "body": "@meager if the first array was empty (<code>[]</code>) it would still return an array. If it was nil, that&#39;s a different story. In that case the elements being iterated over don&#39;t have the same interface so it&#39;d possibly raise a NoMethodError anyway"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1537903714, "post_id": 52502469, "comment_id": 91951418, "body": "@maxpleaner I&#39;m talking about the <b>input array being empty</b>. <code>[].reduce(:|) #=&gt; nil</code> vs <code>[].reduce([], :|) # =&gt; []</code>."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 3, "last_activity_date": 1537891625, "creation_date": 1537891625, "answer_id": 52502469, "question_id": 52502436, "link": "https://stackoverflow.com/questions/52502436/what-does-do-in-ruby/52502469#52502469", "title": "What does `:|` do in Ruby?", "body": "<p>It's a symbol, like <code>:test</code>, but a single character symbol.</p>\n\n<p>The two-argument version of <code>reduce</code> accepts as a second argument a method name, the name of the method in this case is <code>:|</code>, or the <code>|</code> method. <code>|</code> on arrays is a set operation, it \"or\"s the arrays together, giving you the unique superset of all elements contained in both arrays. This isn't a particularly idiomatic use of <code>reduce</code>, you could achieve the same thing with <code>.flatten.uniq</code></p>\n\n<p>If you wanted to add the numbers, you could use <code>:+</code>, or to multiply you could use <code>:*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1537904921, "last_edit_date": 1537904921, "creation_date": 1537901809, "answer_id": 52505056, "question_id": 52502436, "link": "https://stackoverflow.com/questions/52502436/what-does-do-in-ruby/52505056#52505056", "title": "What does `:|` do in Ruby?", "body": "<p>It's the same thing as this:</p>\n\n<pre><code>[array1, array2, array3, array4].compact.reduce([]) do |memo, array|\n  memo | array\nend\n</code></pre>\n\n<p>Although it has syntactic sugar, <code>Array#|</code> is a method which you can see the docs for <a href=\"https://docs.ruby-lang.org/en/2.0.0/Array.html#method-i-7C\" rel=\"nofollow noreferrer\">here</a>. As the docs say:</p>\n\n<blockquote>\n  <p>Set Union \u2014 Returns a new array by joining ary with other_ary, excluding any duplicates and preserving the order from the original array</p>\n</blockquote>\n\n<p>When the block of reduce takes this particular form (calling a single method on memo, passing the iteration's element as an argument), you can omit the block and just pass the method name.</p>\n"}], "owner": {"reputation": 7, "user_id": 7476442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N1cPT.jpg?s=128&g=1", "display_name": "JJK", "link": "https://stackoverflow.com/users/7476442/jjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 52502469, "answer_count": 2, "score": 0, "last_activity_date": 1537904921, "creation_date": 1537891506, "question_id": 52502436, "link": "https://stackoverflow.com/questions/52502436/what-does-do-in-ruby", "title": "What does `:|` do in Ruby?", "body": "<p>I found the following syntax in another question, and I have been unable to find any documentation on what its doing - I'm assuming syntactic sugar of some sort:</p>\n\n<p><code>[array1, array2, array3, array4].compact.reduce([], :|)</code></p>\n\n<p>I allows for one of the arrays to be <code>nil</code> instead of an array, and seems to work like a charm. Can anyone point me in the right direction to understand what is going on?</p>\n\n<p>The original question is here: <a href=\"https://stackoverflow.com/questions/12228709/merge-arrays-if-not-nil-and-not-empty\">Merge arrays if not nil and not empty</a></p>\n"}, {"tags": ["ruby", "docker", "docker-compose", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 3077, "user_id": 1128632, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ek2ZR.jpg?s=128&g=1", "display_name": "Dylan Pierce", "link": "https://stackoverflow.com/users/1128632/dylan-pierce"}, "is_accepted": false, "score": 3, "last_activity_date": 1537890635, "creation_date": 1537890635, "answer_id": 52502215, "question_id": 52502175, "link": "https://stackoverflow.com/questions/52502175/docker-ruby-bundle-permissions-error-on-build/52502215#52502215", "title": "Docker Ruby Bundle Permissions Error on Build", "body": "<p>The problem was that I modified the <code>Gemfile</code> and I was expecting bundler inside of the container to generate the new <code>Gemfile.lock</code> based on the changes.</p>\n\n<p>To fix the issue, I ran <code>bundle install</code> <em>outside</em> of the container. This generated a new <code>Gemfile.lock</code> on my local filesystem and then I was able to build the container as expected.</p>\n"}], "owner": {"reputation": 3077, "user_id": 1128632, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/ek2ZR.jpg?s=128&g=1", "display_name": "Dylan Pierce", "link": "https://stackoverflow.com/users/1128632/dylan-pierce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537890635, "creation_date": 1537890533, "question_id": 52502175, "link": "https://stackoverflow.com/questions/52502175/docker-ruby-bundle-permissions-error-on-build", "title": "Docker Ruby Bundle Permissions Error on Build", "body": "<p>Using docker-compose, I'm trying to build a Ruby application (<code>ruby-app</code>). However near the end of the build it errors out:</p>\n\n<pre><code>There was an error while trying to write to `/ruby-app/Gemfile.lock`. It is likely\nthat you need to grant write permissions for that path.\nERROR: Service 'ruby-app' failed to build: The command '/bin/sh -c bundle install --jobs 4' returned a non-zero code: 23\n</code></pre>\n\n<p>Not sure why this permissions error is cropping up now, it has been building fine for some time.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537889059, "post_id": 52501682, "comment_id": 91944011, "body": "What is the error? Please update the question with it"}, {"owner": {"reputation": 786, "user_id": 2502372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ETaor.jpg?s=128&g=1", "display_name": "Lucas Wieloch", "link": "https://stackoverflow.com/users/2502372/lucas-wieloch"}, "edited": false, "score": 0, "creation_date": 1537889336, "post_id": 52501682, "comment_id": 91944156, "body": "First you need to create the relation between <code>tasks</code> and <code>users</code>. It seems from that controller code that there isn&#39;t one. When that relation is added, <code>create</code> action should have something like <code>current_user.tasks.save(task_params)</code>. This would help you tell which <code>user</code> created which <code>task</code>. then in your <code>index</code> action you should use something like <code>current_user.tasks</code> (which would have the same result as the query you built on <code>index</code> action)."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537890271, "post_id": 52501857, "comment_id": 91944725, "body": "Thanks, the error has now gone, however when i click submit task, the input disappears, but nothing is displayed on the actual index page anymore. @pavan"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537890386, "post_id": 52501857, "comment_id": 91944794, "body": "@b.herring Ok, update the question with the server log generated when you submit the task"}, {"owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537891463, "post_id": 52501857, "comment_id": 91945418, "body": "apologies, im quite new to this. Nothing is showing up in the console, or is server log different?"}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537891874, "post_id": 52501857, "comment_id": 91945656, "body": "@b.herring Yes it is different. Go to the tab where your server is running and now submit the task. Now you will see the log. Update the question with it."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537892505, "post_id": 52501857, "comment_id": 91945983, "body": "@b.herring You posted the wrong log. Do you see anything like <b>Started POST</b>, if so copy and paste it in the question."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "reply_to_user": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "edited": false, "score": 0, "creation_date": 1537892874, "post_id": 52501857, "comment_id": 91946183, "body": "@b.herring Ok now just add <code>@task.user_id = current_user.id</code> before <code>@task.save</code> in the <code>create</code> method"}], "tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 0, "last_activity_date": 1537893427, "last_edit_date": 1537893427, "creation_date": 1537889509, "answer_id": 52501857, "question_id": 52501682, "link": "https://stackoverflow.com/questions/52501682/trying-to-make-an-index-which-only-displays-the-tasks-created-by-that-user-using/52501857#52501857", "title": "Trying to make an index which only displays the tasks created by that user using devise", "body": "<blockquote>\n  <p>PG::UndefinedColumn: ERROR: column tasks.user_id does not exist</p>\n</blockquote>\n\n<p>The error means that the <code>tasks</code> table doesn't have a column <code>user_id</code>.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Generate a migration which will add <code>user_id</code> to <code>tasks</code></p>\n\n<pre><code>rails g migration add_user_id_to_tasks user_id:integer\n</code></pre>\n\n<p>And do <code>rake db:migrate</code></p>\n\n<blockquote>\n  <p>Trying to make an index which only displays the tasks created by that\n  user using devise</p>\n</blockquote>\n\n<p>Now after the migration, change the <code>index</code> method of the <code>tasks_controller</code> to below</p>\n\n<pre><code>def index\n  @task= Task.new\n  @tasks = current_user.tasks #this will give the tasks of the current user\nend\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<blockquote>\n  <p>(0.2ms)  ROLLBACK</p>\n</blockquote>\n\n<p>You have a rollback which means that the record isn't saved. This probably due to <code>user_id</code> being nil in the <code>params</code> and the <code>@task.save</code> silently fails without raising an exception. In order to fix this, add the below</p>\n\n<pre><code>def create\n  @task = Task.new(task_params)\n  @task.user_id = current_user.id # add this line\n  @task.save\n  redirect_to tasks_path\nend\n</code></pre>\n\n<p>And whitelist <code>:user_id</code> in the <code>task_params</code> method.</p>\n\n<pre><code>def task_params\n  params.require(:task).permit(:name, :description, :user_id)\nend\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 10409976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91acc14383d05b02f61e8deb0fde4c56?s=128&d=identicon&r=PG&f=1", "display_name": "b.herring", "link": "https://stackoverflow.com/users/10409976/b-herring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 52501857, "answer_count": 1, "score": 0, "last_activity_date": 1537893427, "creation_date": 1537888956, "last_edit_date": 1537892751, "question_id": 52501682, "link": "https://stackoverflow.com/questions/52501682/trying-to-make-an-index-which-only-displays-the-tasks-created-by-that-user-using", "title": "Trying to make an index which only displays the tasks created by that user using devise", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Started POST \"/tasks\" for 127.0.0.1 at 2018-09-25 17:25:24 +0100\r\nProcessing by TasksController#create as HTML\r\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"MnJuOlEcHfPYca7mzWk5WdEO0jVcuS+gGWiFVC++ARNmtpPTjC/9sd7AGpgV8LSybNjz1PoOIdDYddUhnOAFOw==\", \"task\"=&gt;{\"name\"=&gt;\"j\", \"description\"=&gt;\"j\"}, \"commit\"=&gt;\"Create Task\"}\r\n  User Load (4.4ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 ORDER BY \"users\".\"id\" ASC LIMIT $2  [[\"id\", 1], [\"LIMIT\", 1]]\r\n  \u21b3 /Users/benherring/.rbenv/versions/2.4.4/lib/ruby/gems/2.4.0/gems/activerecord-5.2.1/lib/active_record/log_subscriber.rb:98\r\n   (0.3ms)  BEGIN\r\n  \u21b3 app/controllers/tasks_controller.rb:22\r\n   (0.2ms)  ROLLBACK\r\n  \u21b3 app/controllers/tasks_controller.rb:22\r\nRedirected to http://localhost:3000/tasks\r\nCompleted 302 Found in 11ms (ActiveRecord: 4.9ms)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Trying to make an index which only displays the tasks created by that user using devise. looked a lot on here but cant find a solution to my issue. I've done the associations. current error is  at this line <code>&lt;% @tasks.each do |task| %&gt;</code>.</p>\n\n<blockquote>\n  <p>PG::UndefinedColumn: ERROR:  column tasks.user_id does not exist</p>\n</blockquote>\n\n<p>which is displaying red. do i need to change the create method? if so how? thanks</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>&lt;h1&gt;TASKS&lt;/h1&gt;\r\n&lt;div class=\"body\"&gt;\r\n  &lt;div class=\"list\"&gt;\r\n    &lt;% @tasks.each do |task| %&gt;\r\n    &lt;ul&gt;\r\n      &lt;li&gt;\r\n        &lt;%= link_to task.user.name ,task_path(task), class: \"tasks\"   %&gt;\r\n        |\r\n        &lt;%= link_to \"Delete\", task_path(task), method: :delete, data: {confirm: \"Are you sure?\"} %&gt;\r\n      &lt;/li&gt;\r\n    &lt;/ul&gt;\r\n    &lt;% end %&gt;\r\n  &lt;/div&gt;\r\n  &lt;div class=\"form\"&gt;\r\n    &lt;div&gt;\r\n  &lt;%= simple_form_for @task, id: \"form-submit\" do |f| %&gt;\r\n   &lt;%= f.input :name %&gt;\r\n   &lt;%= f.input :description %&gt;\r\n   &lt;%= f.button :submit, class: \"btn btn-danger\" ,id: \"sweet-alert-demo\" %&gt;\r\n  &lt;% end %&gt;\r\n\r\n&lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;%#= link_to \"Add Task\" ,new_task_path, class: \"btn btn-primary\" %&gt;\r\n&lt;/div&gt;</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>class TasksController &lt; ApplicationController\r\n\r\n  def index\r\n    # @tasks = Task.all\r\n    @task= Task.new\r\n    @tasks = Task.where(user: current_user)\r\n\r\n  end\r\n\r\n  def show\r\n    @task = Task.find(params[:id])\r\n  end\r\n\r\n  def new\r\n    # @task = Task.new\r\n    # @user = current_user\r\n  end\r\n\r\n  def create\r\n    @task = Task.new(task_params)\r\n    @task.save\r\n    redirect_to tasks_path\r\n  end\r\n\r\n  def edit\r\n    @task = Task.find(params[:id])\r\n  end\r\n\r\n  def update\r\n    @task = Task.find(params[:id])\r\n\r\n    @task.update(task_params)\r\n    redirect_to task_path\r\n  end\r\n\r\n   def destroy\r\n    @task = Task.find(params[:id])\r\n    @task.destroy\r\n    redirect_to tasks_path\r\n  end\r\n\r\n\r\n\r\n\r\n    private\r\n\r\n  def task_params\r\n    params.require(:task).permit(:name, :description)\r\n  end\r\n\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["ruby", "sorting"], "comments": [{"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 1, "creation_date": 1537889178, "post_id": 52501575, "comment_id": 91944073, "body": "what is merging strategy? take first value?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537908681, "post_id": 52501575, "comment_id": 91953409, "body": "I don&#39;t believe you can improve on <code>hashes.flat_map(&amp;:keys).uniq</code>. Note that the doc <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">Array#uniq</a> states, &quot;<code>self</code> is traversed in order, and the first occurrence is kept.&quot;, meaning that, for example, <code>[:b, a:, :c]</code> is not returned, should order be important. btw, I infer from your avatar that you are a conductor as well as a Rubiest."}], "answers": [{"comments": [{"owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "edited": false, "score": 0, "creation_date": 1537889452, "post_id": 52501771, "comment_id": 91944229, "body": "Is this more efficient?"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "reply_to_user": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "edited": false, "score": 0, "creation_date": 1537889719, "post_id": 52501771, "comment_id": 91944387, "body": "than what? your code is efficient enough, but it doesn&#39;t return a data structure you mentioned in your question."}, {"owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "edited": false, "score": 0, "creation_date": 1537890117, "post_id": 52501771, "comment_id": 91944633, "body": "Ah sh**! Yes, what I need is a list of keys - not a hash. Sorry - will add an edit."}], "tags": [], "owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "is_accepted": false, "score": 2, "last_activity_date": 1537889246, "creation_date": 1537889246, "answer_id": 52501771, "question_id": 52501575, "link": "https://stackoverflow.com/questions/52501575/get-a-list-of-all-keys-in-an-array-of-hashes/52501771#52501771", "title": "Get a list of all keys in an Array of Hashes", "body": "<p>You were pretty close</p>\n\n<pre><code>hashes.flat_map(&amp;:to_a).reverse.to_h\n#=&gt; {:c=&gt;1, :a=&gt;0, :b=&gt;1}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "edited": false, "score": 0, "creation_date": 1537902068, "post_id": 52502571, "comment_id": 91950663, "body": "<code>Hash</code> is faster than <code>Set</code>. <code>each_key</code> is faster than <code>keys.each</code>"}, {"owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "edited": false, "score": 0, "creation_date": 1537903598, "post_id": 52502571, "comment_id": 91951363, "body": "<code>set = {}; hashes.each {|h| h.each_key {|k| set[k]=nil} }; set.keys</code>"}, {"owner": {"reputation": 48635, "user_id": 6742, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xPawo.png?s=128&g=1", "display_name": "David Aldridge", "link": "https://stackoverflow.com/users/6742/david-aldridge"}, "edited": false, "score": 1, "creation_date": 1537905596, "post_id": 52502571, "comment_id": 91952192, "body": "Or <code>hashes.each_with_object({}) {|a,b| b.merge! a}.keys</code>"}, {"owner": {"reputation": 79498, "user_id": 298624, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5b84ccc2f7709bbb7105baeb40e0961b?s=128&d=identicon&r=PG", "display_name": "fl00r", "link": "https://stackoverflow.com/users/298624/fl00r"}, "edited": false, "score": 0, "creation_date": 1537957797, "post_id": 52502571, "comment_id": 91970752, "body": "Important point is that all these algorithms have the same linear complexity. So you can tune only the multiplication factor."}, {"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1537976091, "post_id": 52502571, "comment_id": 91982420, "body": "Updated based on comments. My manual benchmark was way off. Unsurprisingly the merge solution wins by a long shot: it&#39;s less dynamic and uses fewer method calls in the loop."}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 2, "last_activity_date": 1537975952, "last_edit_date": 1537975952, "creation_date": 1537892048, "answer_id": 52502571, "question_id": 52501575, "link": "https://stackoverflow.com/questions/52501575/get-a-list-of-all-keys-in-an-array-of-hashes/52502571#52502571", "title": "Get a list of all keys in an Array of Hashes", "body": "<p>Your way is a good balance between performance and being idiomatic. I tried a few other approaches.</p>\n\n<pre><code># with reduce\nhashes.map(&amp;:keys).reduce(:|)\n# with merge\nhashes.each_with_object({}) { |memo, h| memo.merge! h }.keys\n# manually\nset = {}\nhashes.each { |h| h.each_key { |k| set[k] = nil } }\nset.keys\n</code></pre>\n\n<p>the time in seconds for merging 1000 hashes with ~8 keys per hash 1000 times</p>\n\n<pre><code>uniq   0.539034\nreduce 2.194463\nmerge  0.090131\nmanual 0.911875\n</code></pre>\n\n<p>For readability, your approach wins. Reducing sucks. Manual is ugly <em>and</em> slow.</p>\n\n<p>I would go with the <code>merge</code> approach since it isn't very ugly and is super fast.</p>\n"}], "owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52502571, "answer_count": 2, "score": 1, "last_activity_date": 1537975952, "creation_date": 1537888656, "last_edit_date": 1537890160, "question_id": 52501575, "link": "https://stackoverflow.com/questions/52501575/get-a-list-of-all-keys-in-an-array-of-hashes", "title": "Get a list of all keys in an Array of Hashes", "body": "<p>What I have: An array of hashes with different sizes.</p>\n\n<pre><code>hashes = [{:a =&gt; 0}, {:a =&gt; 0, :b =&gt; 1}, {:a =&gt; 1, :c =&gt; 1}] \n</code></pre>\n\n<p>What I need: I need a list of all keys. EDIT: An actual list, not a Hash.</p>\n\n<pre><code>[:a, :b, :c]\n</code></pre>\n\n<p>Is this the right approach? This feels a bit heavy.</p>\n\n<pre><code>hashes.flat_map(&amp;:keys).uniq\n</code></pre>\n\n<p>Or any other ideas? Thanks!</p>\n"}, {"tags": ["ruby", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "edited": false, "score": 1, "creation_date": 1537888352, "post_id": 52501401, "comment_id": 91943587, "body": "Cool, thanks! Just realized, I need something slightly different. Will accept and open another question for that, because I would have to change the title etc and your answer would be void."}], "tags": [], "owner": {"reputation": 12629, "user_id": 4739257, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MdhEs.jpg?s=128&g=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/4739257/ilya"}, "is_accepted": true, "score": 5, "last_activity_date": 1537888063, "creation_date": 1537888063, "answer_id": 52501401, "question_id": 52501311, "link": "https://stackoverflow.com/questions/52501311/get-biggest-hash-in-an-array-of-hashes/52501401#52501401", "title": "Get biggest Hash in an Array of Hashes", "body": "<p>Your solution works fine, but you can also use <code>max_by</code>, it seems more efficient:</p>\n\n<pre><code>hashes.max_by(&amp;:length)\n#=&gt; {:a=&gt;0, :b=&gt;1}\n</code></pre>\n"}], "owner": {"reputation": 3077, "user_id": 1257369, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UVwvN.gif?s=128&g=1", "display_name": "everyman", "link": "https://stackoverflow.com/users/1257369/everyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52501401, "answer_count": 1, "score": 0, "last_activity_date": 1537888063, "creation_date": 1537887796, "question_id": 52501311, "link": "https://stackoverflow.com/questions/52501311/get-biggest-hash-in-an-array-of-hashes", "title": "Get biggest Hash in an Array of Hashes", "body": "<p>What I have: An array of hashes with different sizes.</p>\n\n<pre><code>hashes = [{:a =&gt; 0}, {:a =&gt; 0, :b =&gt; 1}, {:b =&gt; 1}] \n</code></pre>\n\n<p>What I need: I just need the biggest item. </p>\n\n<pre><code>{:a =&gt; 0, :b =&gt; 1}\n</code></pre>\n\n<p>Is this the right approach or is this inefficient?</p>\n\n<pre><code>hashes.sort_by { |h| h.length }.last\n</code></pre>\n\n<p>Or any other ideas? Thanks!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 1, "creation_date": 1537879455, "post_id": 52498404, "comment_id": 91937482, "body": "You are using <code>@coordinates</code> outside the <code>class</code>, to access it you need to instantiate a <code>Hero</code> object, then call the <code>coordinates</code> method on it."}, {"owner": {"reputation": 689, "user_id": 10280525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar3KN.jpg?s=128&g=1", "display_name": "Nifriz", "link": "https://stackoverflow.com/users/10280525/nifriz"}, "reply_to_user": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 0, "creation_date": 1537879640, "post_id": 52498404, "comment_id": 91937616, "body": "@iGian indicated you the right way. Then remember the syntax is <code>my_hero_variable.coordinates</code> ... not <code>coordinates.class</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 1, "last_activity_date": 1537880760, "last_edit_date": 1537880760, "creation_date": 1537879611, "answer_id": 52498589, "question_id": 52498404, "link": "https://stackoverflow.com/questions/52498404/ruby-undefined-method-for-nilnilclass-inheritance-problem/52498589#52498589", "title": "Ruby: undefined method `[]&#39; for nil:NilClass / inheritance problem?", "body": "<p>First thing you are assigning empty array to <code>@coordinates</code> in initialize, so change as below:</p>\n\n<pre><code>class Hero &lt; Character\n  attr_accessor :lives, :coordinates\n\n  def initialize (lives, coordinates = [])\n    @lives = lives\n    @coordinates = coordinates # assign the value of the parameter\n  end\n\n  def get_direction\n    puts \"Press up/down and left/right keys to start moving your hero\"\n    next_move = gets.chomp.downcase\n    if next_move == 'left'\n      @coordinates = [0, -1]\n    elsif next_move == 'right'\n      @coordinates = [0, 1]\n    elsif next_move == 'up'\n      @coordinates = [-1, 0]\n      elif next_move == 'down'\n      @coordinates = [1, 0]\n    end\n  end\nend\n</code></pre>\n\n<p>Then you need to instantiate the Hero object, passing parameters to initialise:</p>\n\n<pre><code>hero = Hero.new('something', [:x,:y,:z])\n</code></pre>\n\n<p>And now you can call the method on it:</p>\n\n<pre><code>p hero.coordinates #=&gt; [:x, :y, :z]\n</code></pre>\n\n<p><hr>\nFor the second part of the question, I can suggest you to take a look at <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/matrix/rdoc/Vector.html\" rel=\"nofollow noreferrer\">Vector</a> class for moving and comparing, maybe you can find useful:</p>\n\n<pre><code>require 'matrix'\n\nposition = Vector[1, 2]\nmove = Vector[4, 6]\n\nnew_position = position + move #=&gt; Vector[5, 8]\np new_position.magnitude #=&gt; 9.433981132056603 (distance from origin 0, 0)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10364107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-HaAuoo5zA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTAXNYiMZJX6XRRCUiu3z2z4_aQg/mo/photo.jpg?sz=128", "display_name": "himn", "link": "https://stackoverflow.com/users/10364107/himn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537880760, "creation_date": 1537879015, "last_edit_date": 1537879358, "question_id": 52498404, "link": "https://stackoverflow.com/questions/52498404/ruby-undefined-method-for-nilnilclass-inheritance-problem", "title": "Ruby: undefined method `[]&#39; for nil:NilClass / inheritance problem?", "body": "<p>could you please explain to me why I get this error, I guess it's due to the way I defined my instance variable:</p>\n\n<p>I have a parent class named 'character' </p>\n\n<pre><code>class Character\n  attr_accessor :coordinates\n\n  def initialize (coordinates)\n    @coordinates = []\n  end\nend\n</code></pre>\n\n<p>And a child class:</p>\n\n<pre><code>require_relative 'characters'\n\nclass Hero &lt; Character\n  attr_accessor :lives, :coordinates\n\n  def initialize (lives, coordinates)\n    @lives = lives\n    @coordinates = []\n  end\n\n  def get_direction\n    puts \"Press up/down and left/right keys to start moving your hero\"\n    next_move = gets.chomp.downcase\n    if next_move == 'left'\n      @coordinates = [0, -1]\n    elsif next_move == 'right'\n      @coordinates = [0, 1]\n    elsif next_move == 'up'\n      @coordinates = [-1, 0]\n      elif next_move == 'down'\n      @coordinates = [1, 0]\n    end\n  end\nend\n</code></pre>\n\n<p>Then I have a main.rb where I want to use the @coordinates of my character and check whether he's still on the map. Here is the method in the main.rb:</p>\n\n<pre><code>def check_hero_position\n    print @coordinates.class\n    print @coordinates[0].class\n\n    # @hero_location[1] += @coordinates[1]\n    # case  \n    # when (@hero_location[0] &lt; 1) || (@hero_location[0] &gt; @map_size[0]) \n    #   puts \"error-x\"\n    # when\n    #   (@hero_location[1] &lt; 0) || (@hero_location[1] &gt; @map_size[1])\n    #   puts \"error-y\"\n    # end\nend\n</code></pre>\n\n<p>When I run the code, I get this error for the line in the method where I try to print the class of coordinates[0].\n<code>check_hero_position': undefined method</code>[]' for nil:NilClass</p>\n\n<p>Did I use properly the <code>coordinates</code> instance variable?\nSecond, how can I compare the values of two arrays? I commented the code in the method since is not correct.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "database-migration"], "answers": [{"comments": [{"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537881378, "post_id": 52498120, "comment_id": 91938791, "body": "in other words: the application will maintain the referential identity instead of the database?"}, {"owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537884761, "post_id": 52498120, "comment_id": 91941056, "body": "A bit of both. The <code>foreign_key: true</code> line in the <code>add_reference</code> migration command tells the underlying database that the column it&#39;s adding should be considered a foreign key."}, {"owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537885316, "post_id": 52498120, "comment_id": 91941419, "body": "Not being able to use paragraphs always gets me in SO comments\u2026) ActiveRecord will do its best to ensure integrity \u2013 <code>belongs_to</code> relationships are validated by default and can&#39;t be nullified unless you specify <code>optional: true</code> when you define the relationship in your model. You may also want to ensure that you&#39;ve spelled <code>dependent: :destroy</code> correctly in your <code>has_many</code> declaration, or ActiveRecord will silently ignore it. And if Rails is your only way into the database, that&#39;s often &quot;good enough&quot; for small projects."}, {"owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537885413, "post_id": 52498120, "comment_id": 91941485, "body": "To be safe, though, the <code>foreign_key: true</code> clause of the migration command that created the reference column should tell the database to enforce its own restrictions to make sure that all values in <code>streets.city_id</code> are valid (more information on the <a href=\"https://www.sqlite.org/foreignkeys.html\" rel=\"nofollow noreferrer\">SQLite site</a>). That&#39;s especially useful if other apps might be creating data."}, {"owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537889729, "post_id": 52498120, "comment_id": 91944397, "body": "if migrations doesn&#39;t create relations in the database then each table will be a lonely entity"}, {"owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "reply_to_user": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "edited": false, "score": 0, "creation_date": 1537891612, "post_id": 52498120, "comment_id": 91945503, "body": "The relationships are there (as defined by the foreign key), but I think you&#39;re expecting your database viewer to visualise them as some form of explicit entity in their own right, and in the world of SQLite (or indeed, PostgreSQL or MySQL) that&#39;s not common."}], "tags": [], "owner": {"reputation": 1535, "user_id": 1326518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PcaV1.jpg?s=128&g=1", "display_name": "Scott Matthewman", "link": "https://stackoverflow.com/users/1326518/scott-matthewman"}, "is_accepted": true, "score": 1, "last_activity_date": 1537878055, "creation_date": 1537878055, "answer_id": 52498120, "question_id": 52497841, "link": "https://stackoverflow.com/questions/52497841/how-to-update-database-schema-after-running-migrations-in-ruby-on-rails/52498120#52498120", "title": "how to update database schema after running migrations in ruby on rails", "body": "<p>The <code>add_reference</code> migration command will have added a <code>city_id</code> column to your <code>streets</code> table. </p>\n\n<p>When you call <code>@city.streets</code>, it is evaluated as the equivalent of <code>Street.where(city_id: @city.id)</code>.</p>\n\n<p>Similarly, <code>@street.city</code> will look at the ID stored in <code>city_id</code> column, and do a lookup - the equivalent of <code>City.find(@street.city_id)</code>.</p>\n"}], "owner": {"reputation": 2037, "user_id": 8036670, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rGA81.jpg?s=128&g=1", "display_name": "assembler", "link": "https://stackoverflow.com/users/8036670/assembler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 52498120, "answer_count": 1, "score": 1, "last_activity_date": 1537881134, "creation_date": 1537877120, "last_edit_date": 1537881134, "question_id": 52497841, "link": "https://stackoverflow.com/questions/52497841/how-to-update-database-schema-after-running-migrations-in-ruby-on-rails", "title": "how to update database schema after running migrations in ruby on rails", "body": "<p>I'm starting with Ruby on Rails and I have these two models:</p>\n\n<p>City and Street,  </p>\n\n<p>These two models were generated independently with no relation between them. Now I need a city to have many streets and each street to belong to a single city. I ran this command:</p>\n\n<p><code>bin/rails generate migration AddCityRefToStreets city:references</code></p>\n\n<p>That generated this migration:</p>\n\n<pre><code>class AddCityRefToStreets &lt; ActiveRecord::Migration[5.2]\n  def change\n    add_reference :streets, :city, foreign_key: true\n  end\nend\n</code></pre>\n\n<p>Then I ran <code>bin/rails db:migrate</code> and then I went into these model classes and wrote:</p>\n\n<pre><code>class City &lt; ApplicationRecord\n   has_many :streets, dependant: :destroy\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Street &lt; ApplicationRecord\n   belongs_to :city\nend\n</code></pre>\n\n<p>Rails did not show any complains, and so far it works fine for me. If I ask <code>@city.streets.length</code> it will return the correct amount of streets for that <code>@city</code>. If I ask <code>@street.city</code> it returns the correct city as well.</p>\n\n<p>The thing is, I went into the database using DBeaver and the migration did not generate relations between the <code>cities</code> and <code>streets</code> tables. The <code>streets</code> table shows me a <code>city_id</code> field, but still not showing any relationship in the ER Diagram view.</p>\n\n<p>My question is: what am I missing here? Is this the correct way to relate two entities created independently?</p>\n\n<p>I'm using Linux Mint 18.3, Rails 5.2.1, Sqlite 3.11.0 and DBeaver 5.1.</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "ajax"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1537875393, "post_id": 52497210, "comment_id": 91934774, "body": "You need a websocket connection to enforce an update of the frontend from the backend when curl request comes."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 2, "creation_date": 1537876930, "post_id": 52497210, "comment_id": 91935758, "body": "To elaborate on <a href=\"https://stackoverflow.com/questions/52497210/real-time-table-in-ruby-on-rails#comment91934774_52497210\">mudasobwas comment</a>. Have a look at <a href=\"https://guides.rubyonrails.org/action_cable_overview.html\" rel=\"nofollow noreferrer\">Rails Action Cable</a>."}, {"owner": {"reputation": 63, "user_id": 8334684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rogEg.jpg?s=128&g=1", "display_name": "alexfrancow", "link": "https://stackoverflow.com/users/8334684/alexfrancow"}, "edited": false, "score": 0, "creation_date": 1538128340, "post_id": 52497210, "comment_id": 92044201, "body": "I found a simple example: <a href=\"https://melvinchng.github.io/rails/ActionCable.html#21-initial-setup\" rel=\"nofollow noreferrer\">melvinchng.github.io/rails/ActionCable.html#21-initial-setup</a>"}], "owner": {"reputation": 63, "user_id": 8334684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rogEg.jpg?s=128&g=1", "display_name": "alexfrancow", "link": "https://stackoverflow.com/users/8334684/alexfrancow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1537875731, "creation_date": 1537875198, "last_edit_date": 1537875731, "question_id": 52497210, "link": "https://stackoverflow.com/questions/52497210/real-time-table-in-ruby-on-rails", "title": "Real time table in Ruby on Rails", "body": "<p>I'm a new user in Ruby on Rails, and I'm very stuck on this. I want to send a POST request with cURL, and display the data received instantly in html without updating the page.</p>\n\n<p>In my controller I have this function:</p>\n\n<pre><code>def json\n  @users = User.all\n  render :json =&gt; { :success =&gt; true,:users =&gt; @users.as_json() }\nend\n</code></pre>\n\n<p>In my html:</p>\n\n<pre><code>&lt;table class=\"table\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Username&lt;/th&gt;\n    &lt;th&gt;IP&lt;/th&gt;\n    &lt;th&gt;OS&lt;/th&gt;\n    &lt;th&gt;Datetime&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% for user in @users do %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= user.whoami %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.ip %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.os %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.date %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n\n&lt;/table&gt;\n</code></pre>\n\n<p>I've tried with AJAX, but I do not get it.</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1537872778, "post_id": 52496394, "comment_id": 91933229, "body": "No way. The error is induced."}, {"owner": {"reputation": 5800, "user_id": 4287733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835e993afb1e20c1981dd6b8b59ded2d?s=128&d=identicon&r=PG", "display_name": "Nermin", "link": "https://stackoverflow.com/users/4287733/nermin"}, "edited": false, "score": 1, "creation_date": 1537872859, "post_id": 52496394, "comment_id": 91933299, "body": "Show <code>#do something here code</code> it has <code>each</code> loop"}, {"owner": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "edited": false, "score": 0, "creation_date": 1537873375, "post_id": 52496394, "comment_id": 91933603, "body": "Added the full code. There are two more iterations, but they are for loops, not each."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1537873867, "post_id": 52496394, "comment_id": 91933891, "body": "<code>for zero in z_index</code> is the issue. <code>z_index</code> is obviously <code>0</code> there. FYI: <i>any</i> iteration uses <code>each</code> under the hood in ruby. Also, we don\u2019t use <code>for</code> loops in ruby, it\u2019s considered a code smell."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537874079, "post_id": 52496394, "comment_id": 91934019, "body": "<i>Sidenote:</i> you shouldn\u2019t delete elements from the currently iterated array."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537905901, "post_id": 52496394, "comment_id": 91952300, "body": "Note that <code>i</code> is not initialized. Perhaps you meant <code>x</code>. btw, wean yourself from using <code>for</code> as soon as possible. Most Rubiests don&#39;t use it, many have never used it."}], "answers": [{"comments": [{"owner": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "edited": false, "score": 0, "creation_date": 1537874448, "post_id": 52496829, "comment_id": 91934238, "body": "Right! I was expecting each to grab the elements regardless of the number (1 or 100). Why doesn&#39;t that work? What&#39;s the alternative if in the next loop there is more than 1 element in the array?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "edited": false, "score": 0, "creation_date": 1537877097, "post_id": 52496829, "comment_id": 91935884, "body": "If you want to iterate over the elements, maybe what you wanted to do was <code>for zero in x</code> but can you explain what you expect the code to do? I don&#39;t see <code>i</code> is initialized before use, by the way, so that&#39;  going to be a problem further on."}, {"owner": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "edited": false, "score": 0, "creation_date": 1537878596, "post_id": 52496829, "comment_id": 91936864, "body": "Yes, I didn&#39;t paste the whole method here. z_index can have 1 or multiple elements. In the case of 1 element I run into the mentioned error. Is there a neat way of handling 1 element scenario? Or should I just go with if else statement?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "reply_to_user": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "edited": false, "score": 0, "creation_date": 1537879480, "post_id": 52496829, "comment_id": 91937502, "body": "<code>z_index</code> CANNOT have one or multiple elements, it can only have <code>nil</code> (if there&#39;s no element <code>0</code>) or it can have the index of the first occurence of <code>0</code>, which in your examples happens to be <code>0</code>.  If you want an array of all the index positions of <code>0</code> you should do <code>z_index = x.each_with_index.map{|x,i| x.zero? ? i : nil}.compact</code>"}], "tags": [], "owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1537873950, "creation_date": 1537873950, "answer_id": 52496829, "question_id": 52496394, "link": "https://stackoverflow.com/questions/52496394/ruby-each-on-nested-array-returns-inconsistent-results/52496829#52496829", "title": "Ruby each on nested array returns inconsistent results", "body": "<p>When you do </p>\n\n<pre><code>for zero in z_index \n</code></pre>\n\n<p>This is effectively </p>\n\n<pre><code>z_index.each do |zero|\n</code></pre>\n\n<p>The <code>in</code> part of a <code>for in</code> loop has to be something you can iterate over (an array)</p>\n\n<p><code>z_index</code> is the first element of <code>x</code> which is the first element of <code>matrix</code> so it contains an integer.</p>\n"}], "owner": {"reputation": 969, "user_id": 5257855, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1ZS57.jpg?s=128&g=1", "display_name": "fardin", "link": "https://stackoverflow.com/users/5257855/fardin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52496829, "answer_count": 1, "score": 1, "last_activity_date": 1537874099, "creation_date": 1537872629, "last_edit_date": 1537874099, "question_id": 52496394, "link": "https://stackoverflow.com/questions/52496394/ruby-each-on-nested-array-returns-inconsistent-results", "title": "Ruby each on nested array returns inconsistent results", "body": "<p>We have array of arrays: <code>matrix = [[0, 1, 1, 2], [0, 5, 0, 0], [2, 0, 3, 3]]</code></p>\n\n<p>Now, calling</p>\n\n<pre><code>matrix.each do |x| \n  print x\nend\n</code></pre>\n\n<p>returns the three arrays as I would expect (<code>[0, 1, 1, 2][0, 5, 0, 0][2, 0, 3, 3]</code>). </p>\n\n<p>But when doing</p>\n\n<pre><code>matrix.each do |x| \n    if x.include?(0)\n        z_index = x.index(0)\n        for zero in z_index\n            for x in matrix do\n                matrix[i].delete_at(zero)\n                i+=1\n            end\n        end\n    else\n        next\n    end\nend\n</code></pre>\n\n<p>I get <code>undefined method 'each' for 0:Integer</code>, which means <code>each</code> is picking up the 0 in the first nested array, instead of picking up the entire first nested array. Why is it behaving this way?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "stripe-payments"], "comments": [{"owner": {"reputation": 6059, "user_id": 301419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/03850242d6e9a3b36279cdaf6f231d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Swain", "link": "https://stackoverflow.com/users/301419/alok-swain"}, "edited": false, "score": 0, "creation_date": 1537874128, "post_id": 52495999, "comment_id": 91934052, "body": "What params are received in the controller?. The error that rails is throwing is because it cannot find a ActiveRecord object without its id while doing - <code>Product.find(params[:product_id])</code>"}, {"owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "reply_to_user": {"reputation": 6059, "user_id": 301419, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/03850242d6e9a3b36279cdaf6f231d0f?s=128&d=identicon&r=PG&f=1", "display_name": "Alok Swain", "link": "https://stackoverflow.com/users/301419/alok-swain"}, "edited": false, "score": 0, "creation_date": 1537874580, "post_id": 52495999, "comment_id": 91934311, "body": "Can you pls share the new.html or the form? as @AlokSwain mentioned it seems that product_id is not set"}, {"owner": {"reputation": 1, "user_id": 10412643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cad1af3604ba9af12b1b15d41a5a21?s=128&d=identicon&r=PG&f=1", "display_name": "Jac89", "link": "https://stackoverflow.com/users/10412643/jac89"}, "edited": false, "score": 0, "creation_date": 1537874787, "post_id": 52495999, "comment_id": 91934431, "body": "Just added now."}, {"owner": {"reputation": 666, "user_id": 1270929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6136fe60f32b1057c392250f3f17b620?s=128&d=identicon&r=PG", "display_name": "wsw", "link": "https://stackoverflow.com/users/1270929/wsw"}, "edited": false, "score": 0, "creation_date": 1537977166, "post_id": 52495999, "comment_id": 91983051, "body": "@Jac89, the form looks correct. But the <code>product</code> data is not  Can you check the following  1) in your form, inspect and see what is the hidden value for <code>product_id</code> making sure it has value?  2) in your controllers&#39; <code>def create</code>, print out <code>params[:product_id]</code> making sure it is a valid product id  it is more like a data issue, checking the above to make sure"}, {"owner": {"reputation": 1, "user_id": 10412643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cad1af3604ba9af12b1b15d41a5a21?s=128&d=identicon&r=PG&f=1", "display_name": "Jac89", "link": "https://stackoverflow.com/users/10412643/jac89"}, "reply_to_user": {"reputation": 666, "user_id": 1270929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6136fe60f32b1057c392250f3f17b620?s=128&d=identicon&r=PG", "display_name": "wsw", "link": "https://stackoverflow.com/users/1270929/wsw"}, "edited": false, "score": 0, "creation_date": 1537982153, "post_id": 52495999, "comment_id": 91985555, "body": "@wsw Perfect! solved everything there. Thanks once again!"}, {"owner": {"reputation": 666, "user_id": 1270929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6136fe60f32b1057c392250f3f17b620?s=128&d=identicon&r=PG", "display_name": "wsw", "link": "https://stackoverflow.com/users/1270929/wsw"}, "edited": false, "score": 0, "creation_date": 1538009015, "post_id": 52495999, "comment_id": 91995287, "body": "@Jac89, awesome.  Do you mind copying the answer and mark your question as resolved.  thank you."}], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 3425913, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/L4ff7.jpg?s=128&g=1", "display_name": "thatway_3", "link": "https://stackoverflow.com/users/3425913/thatway-3"}, "is_accepted": false, "score": 0, "last_activity_date": 1537892885, "creation_date": 1537892885, "answer_id": 52502814, "question_id": 52495999, "link": "https://stackoverflow.com/questions/52495999/couldnt-find-product-without-id-using-stripe/52502814#52502814", "title": "Couldn&#39;t find product without ID using Stripe", "body": "<p>The <code>:product_id</code> is not set in your form post,</p>\n\n<p><strong>1. Quick Solution:</strong></p>\n\n<p>your form url could be like this:</p>\n\n<pre><code>&lt;%= form_with(url: \"/payments/create?#{product_id=@product.id}\") do |form| %&gt;\n</code></pre>\n\n<p><strong>2. Better Way:</strong></p>\n\n<p>configure you routes for payments already has product id:</p>\n\n<pre><code># routes.rb\n\n  resources :products do\n    resources :comments\n    resources :payments\n  end\n</code></pre>\n\n<p>form url:</p>\n\n<pre><code>&lt;%= form_with(url: product_payments_path(@product)) do |form| %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10412643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77cad1af3604ba9af12b1b15d41a5a21?s=128&d=identicon&r=PG&f=1", "display_name": "Jac89", "link": "https://stackoverflow.com/users/10412643/jac89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537892885, "creation_date": 1537871332, "last_edit_date": 1537876632, "question_id": 52495999, "link": "https://stackoverflow.com/questions/52495999/couldnt-find-product-without-id-using-stripe", "title": "Couldn&#39;t find product without ID using Stripe", "body": "<p>I am trying to complete my payment set up in Ruby but am struggling to gt the order confirmation screen to print. I have set up my partial for the payment as such. </p>\n\n<pre><code>&lt;script\n  src=\"https://checkout.stripe.com/checkout.js\" class=\"stripe-button\"\n  data-key=\"&lt;%= Rails.configuration.stripe[:publishable_key] %&gt;\"\n  data-image=\"&lt;%= asset_path(@product.image_url) %&gt;\"\n  data-name=\"&lt;%= @product.name %&gt;\"\n  data-description=\"&lt;%= @product.description %&gt;\"\n  data-amount=\"&lt;%= @product.price*100.to_i %&gt;\"&gt;\n  &lt;/script&gt;\n</code></pre>\n\n<p>My payment controller.</p>\n\n<pre><code>    class PaymentsController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def create\n    @product = Product.find(params[:product_id])\n    @user = current_user\n    token = params[:stripeToken]\n    # Create the charge on Stripe's servers - this will charge the user's card\n    begin\n      charge = Stripe::Charge.create(\n        amount: @product.price, # amount in cents, again\n        currency: \"eur\",\n        source: token,\n        description: params[:stripeEmail]\n      )\n\n    if charge.paid\n      UserMailer.order_confirmation(@user, @product).deliver_now\n      Order.create!(\n        :product_id =&gt; @product.id,\n        :user_id =&gt; @user.id,\n        :total =&gt; @product.price_show\n      )\n        flash[:success] = \"Your payment was processed successfully\"\n    end\n\n    rescue Stripe::CardError =&gt; e\n      body = e.json_body\n      err = body[:error]\n      flash[:error] = \"Unfortunately, there was an error processing your payment: #{err[:message]} Your card has not been charged. Please try again.\"\n    end\n    redirect_to product_path(@product), notice: \"Thank you for your purchase.\"\n  end\nend\n</code></pre>\n\n<p>and my routes file.</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users, path: '', path_names: { sign_in: 'login', sign_out: 'logout' },\n  controllers: {registrations: \"user_registrations\"}\n\n  resources :products do\n    resources :comments\nend\n\npost 'payments/create'\n\n  resources :users\n  resources :orders, only: [:index, :show, :create, :destroy]\n  resources :users, except: [:index]\n  get 'simple_pages/about'\n  get 'simple_pages/contact'\n  root 'simple_pages#landing_page'\n  post 'simple_pages/thank_you'\n  mount ActionCable.server =&gt; '/cable'\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\nend\n</code></pre>\n\n<p>The form within product show.html.erb</p>\n\n<pre><code>&lt;%= form_with(url: '/payments/create') do |form| %&gt;\n  &lt;%= render partial: \"shared/stripe_checkout_button\" %&gt;\n   &lt;%= hidden_field_tag(:product_id, @product.id) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>However, when I try to complete a test payment, I have the action controller pop up with \"Couldn't find Product without an ID\". I thought this was defined in the create section but I am not sure how to rectify this. Any suggestions would be greatly appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "reactjs", "base64", "paperclip"], "comments": [{"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1537869148, "post_id": 52495175, "comment_id": 91931028, "body": "You have to call <code>#image</code> on <code>PropertyImage</code> instance, not on <code>Property</code> one(this is the source of the error)."}, {"owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1537869175, "post_id": 52495175, "comment_id": 91931040, "body": "Also, I&#39;m not sure you really need <code>polymorphic</code> there."}, {"owner": {"reputation": 65, "user_id": 9147329, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UUwDBMVllWY/AAAAAAAAAAI/AAAAAAAAAFE/m1TvuEd-NCY/photo.jpg?sz=128", "display_name": "Arif Mustaffa", "link": "https://stackoverflow.com/users/9147329/arif-mustaffa"}, "reply_to_user": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "edited": false, "score": 0, "creation_date": 1537869691, "post_id": 52495175, "comment_id": 91931346, "body": "I use <code>polymorphic</code> because the <code>property</code> function is to save data of the property and link it with <code>property_image</code> using <code>imageable_id</code>. The <code>property_image</code> is to save the images or Base64 string."}, {"owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537874901, "post_id": 52495175, "comment_id": 91934501, "body": "Check your controller for permitted params, you may have forgot to add image to the list of the permitted params e.g.: <code>params.require(:property_image).permit(:image)</code>"}, {"owner": {"reputation": 65, "user_id": 9147329, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UUwDBMVllWY/AAAAAAAAAAI/AAAAAAAAAFE/m1TvuEd-NCY/photo.jpg?sz=128", "display_name": "Arif Mustaffa", "link": "https://stackoverflow.com/users/9147329/arif-mustaffa"}, "reply_to_user": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537945309, "post_id": 52495175, "comment_id": 91963307, "body": "@teckden, you are correct. It is about permitting the param <code>image</code>. Thanks!!!"}, {"owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537951395, "post_id": 52495175, "comment_id": 91966698, "body": "@ArifMustaffa Glad to help :) I have moved my comment to an answer, please accept it if it helped. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "is_accepted": true, "score": 0, "last_activity_date": 1537951317, "creation_date": 1537951317, "answer_id": 52513506, "question_id": 52495175, "link": "https://stackoverflow.com/questions/52495175/unhandled-server-error-unknown-attribute-image-for-property/52513506#52513506", "title": "Unhandled Server Error!!! unknown attribute &#39;image&#39; for Property", "body": "<p>You would need to check your controller for permitted params, you may have forgot to add image to the list of the permitted params e.g.: <code>params.require(:property_image).permit(:image)</code></p>\n"}], "owner": {"reputation": 65, "user_id": 9147329, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UUwDBMVllWY/AAAAAAAAAAI/AAAAAAAAAFE/m1TvuEd-NCY/photo.jpg?sz=128", "display_name": "Arif Mustaffa", "link": "https://stackoverflow.com/users/9147329/arif-mustaffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 52513506, "answer_count": 1, "score": 0, "last_activity_date": 1537951317, "creation_date": 1537868736, "question_id": 52495175, "link": "https://stackoverflow.com/questions/52495175/unhandled-server-error-unknown-attribute-image-for-property", "title": "Unhandled Server Error!!! unknown attribute &#39;image&#39; for Property", "body": "<p>I am struggling to resolved this problem. I use <code>React Js</code> as front-end and and <code>Ruby on Rails</code> for back-end. I pass some value from <code>React</code> side to <code>Ruby on Rails</code> to be processed. The value is passed through API with <code>cycle.js</code>. Basically, what I am doing is <strong>1) Convert image to Base64,</strong> <strong>2) Use <code>Paperlip</code> to attach image for <code>Property</code>,</strong> <strong>3) Store the Base64 string in the server.</strong>\n The error is: </p>\n\n<pre><code> Unhandled Server Error!!!\n unknown attribute 'image' for Property.\n</code></pre>\n\n<p>This is the code for back-end:</p>\n\n<p><strong>property.rb</strong></p>\n\n<pre><code> class Property &lt; ActiveRecord::Base\n include PropertySharedMethods\n has_many :property_images, as: :imageable\n</code></pre>\n\n<p><strong>property_image.rb</strong></p>\n\n<pre><code> class PropertyImage &lt; ActiveRecord::Base\n belongs_to :imageable, polymorphic: true, optional: true\n\n has_attached_file :image\n # Validate content type\n validates_attachment_content_type :image, :content_type =&gt; /\\Aimage/\n</code></pre>\n\n<p>So, property_image is polymorphic. The image upload will be uploaded to AWS. For the front-end, the API request is successful, but I do not know whats wrong with my back-end code that creates this error.</p>\n\n<p>Please help. Thank you.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "edited": false, "score": 0, "creation_date": 1537867579, "post_id": 52494645, "comment_id": 91930022, "body": "First thing I note here is that you are missing pull action at line fetch(&#39;/get_data/pull&#39;)"}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1537867935, "post_id": 52494645, "comment_id": 91930270, "body": "That shouldn&#39;t be necessary with the given route."}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1537867978, "post_id": 52494645, "comment_id": 91930296, "body": "What actually happens in your browser when you run this code? Anything in the console or network tab that might give you a clue?"}, {"owner": {"reputation": 105, "user_id": 3178353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFXO8.jpg?s=128&g=1", "display_name": "Mike Tallerico", "link": "https://stackoverflow.com/users/3178353/mike-tallerico"}, "reply_to_user": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1537868546, "post_id": 52494645, "comment_id": 91930668, "body": "@PeterMellett I am getting undefined in the console.  And the network tab I am seeing a few GET request.  One for the HTML  and the one I have defined get_data which is returninf a 304 status code."}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 1, "creation_date": 1537869144, "post_id": 52494645, "comment_id": 91931027, "body": "Oh! Return the result of <code>response.json()</code> from your first <code>then</code>, you&#39;re console logging nothing because there is nothing returned for the next call in the promise chain"}, {"owner": {"reputation": 105, "user_id": 3178353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFXO8.jpg?s=128&g=1", "display_name": "Mike Tallerico", "link": "https://stackoverflow.com/users/3178353/mike-tallerico"}, "reply_to_user": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1537869275, "post_id": 52494645, "comment_id": 91931106, "body": "OH MAN!  @PeterMellett. Thank you.  What a bone head move."}, {"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 1, "creation_date": 1537869326, "post_id": 52494645, "comment_id": 91931146, "body": "No problem! Please add an answer with your solution and accept it :-)"}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 3178353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFXO8.jpg?s=128&g=1", "display_name": "Mike Tallerico", "link": "https://stackoverflow.com/users/3178353/mike-tallerico"}, "is_accepted": false, "score": 4, "last_activity_date": 1537869481, "creation_date": 1537869481, "answer_id": 52495410, "question_id": 52494645, "link": "https://stackoverflow.com/questions/52494645/using-fetch-api-to-get-data-from-rails/52495410#52495410", "title": "Using fetch API to get data from Rails", "body": "<p>The issue was that I needed a return statement in my fetch call. :)</p>\n\n<pre><code>fetch('/get_data')\n      .then(response =&gt; {\n        return response.json();\n      })\n      .then(data =&gt; console.log(data));\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3178353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TFXO8.jpg?s=128&g=1", "display_name": "Mike Tallerico", "link": "https://stackoverflow.com/users/3178353/mike-tallerico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1521, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537869481, "creation_date": 1537867130, "question_id": 52494645, "link": "https://stackoverflow.com/questions/52494645/using-fetch-api-to-get-data-from-rails", "title": "Using fetch API to get data from Rails", "body": "<p>So I am building a react on rails project to learn some new things.  I am trying to use the fetch API to get data from the db.  </p>\n\n<p>I have tried <a href=\"https://stackoverflow.com/questions/16461450/how-to-parsing-the-json-data-or-json-code-from-ruby-on-rails\">this</a> method and <a href=\"https://stackoverflow.com/questions/14824551/rendering-json-in-controller\">this</a> one.  But I might be implementing them wrong.</p>\n\n<p>This is my fetch route:</p>\n\n<pre><code>fetch('/get_data')\n      .then(response =&gt; {\n        response.json();\n      })\n      .then(data =&gt; console.log(data));\n</code></pre>\n\n<p>I have my route set up in Ruby on Rails:</p>\n\n<pre><code>match '/get_data' =&gt; 'get_data#pull', via: :get\n</code></pre>\n\n<p>I have my controller just doing something simple at the moment to see if I can get any data.</p>\n\n<pre><code>class GetDataController &lt; ApplicationController\n  def pull\n    @allproduct = Product.all\n    render json: @allproduct\n  end\nend\n</code></pre>\n\n<p>Thanks for any help in pointing me in the right direction!  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree", "deface"], "answers": [{"tags": [], "owner": {"reputation": 5935, "user_id": 365860, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PPe6C.jpg?s=128&g=1", "display_name": "Nezir", "link": "https://stackoverflow.com/users/365860/nezir"}, "is_accepted": true, "score": 0, "last_activity_date": 1537880151, "creation_date": 1537880151, "answer_id": 52498753, "question_id": 52493845, "link": "https://stackoverflow.com/questions/52493845/rails-4-2-overriding-views-is-deface-really-standalone/52498753#52498753", "title": "Rails 4.2 overriding views. Is Deface really standalone?", "body": "<p>Not sure why your code sample not working but I did simple sample also for you and its works very well. You can download code project here <a href=\"https://github.com/nezirz/deface_gem\" rel=\"nofollow noreferrer\">https://github.com/nezirz/deface_gem</a></p>\n\n<p>Also here is a screen shoot:<a href=\"https://i.stack.imgur.com/MEjZ3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MEjZ3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 6619789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f975ae625a49884b1d2705403250907?s=128&d=identicon&r=PG&f=1", "display_name": "zekorius", "link": "https://stackoverflow.com/users/6619789/zekorius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 52498753, "answer_count": 1, "score": 0, "last_activity_date": 1537880151, "creation_date": 1537864417, "question_id": 52493845, "link": "https://stackoverflow.com/questions/52493845/rails-4-2-overriding-views-is-deface-really-standalone", "title": "Rails 4.2 overriding views. Is Deface really standalone?", "body": "<p>I'm trying to override view with Deface.</p>\n\n<p>In manual creators called it standalone, so I guess that it's possible to use this gem without using spree... But I'm not sure anymore because nearly every tutorial/question/anything I found about Deface was related to spree.</p>\n\n<p>However I tried. what I done was adding a line to Gemfile</p>\n\n<blockquote>\n  <p>gem 'deface'</p>\n</blockquote>\n\n<p>and running </p>\n\n<blockquote>\n  <p>bundle install</p>\n</blockquote>\n\n<p>which for sure installed deface gem.</p>\n\n<p>Then I made route like this:</p>\n\n<pre><code>get 'test', to: 'test#show'\n</code></pre>\n\n<p>empty controller <code>app/controllers/test_controller.rb</code></p>\n\n<pre><code>class TestController &lt; ApplicationController\n  def show\n\n  end\nend\n</code></pre>\n\n<p>and view like this <code>app/views/test/show.html/erb</code></p>\n\n<pre><code>&lt;h1 id=\"test\"&gt;test first&lt;/h1&gt;\n</code></pre>\n\n<p>then I go to <code>cd app</code> and make directory overrides <code>mkdir overrides</code> and created <code>app/overriders/test_uploader.rb</code> which contains:</p>\n\n<pre><code>Deface.Override.new(\n  :virtual_path =&gt; 'test/show',\n  :name =&gt; 'test uploader',\n  :replace =&gt; 'h1#test',\n  :text =&gt; '&lt;h1 id=\"test\"&gt;replaced, test passed&lt;/h1&gt;'\n)\n</code></pre>\n\n<p>But even if I reloaded server nothing happened.\nWhy? Had I missed something? Or maybe I really needs spree to use Deface?</p>\n"}, {"tags": ["ruby", "elasticsearch"], "comments": [{"owner": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 0, "creation_date": 1537869439, "post_id": 52492293, "comment_id": 91931207, "body": "Are you using a database for persistence or just Elasticsearch?"}, {"owner": {"reputation": 165, "user_id": 4608351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ca15ba43fede05475e652e101c3a72?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Cindy", "link": "https://stackoverflow.com/users/4608351/nguyen-cindy"}, "reply_to_user": {"reputation": 533, "user_id": 771564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bd4c92dcc00d019e3f6a2a858b803f?s=128&d=identicon&r=PG", "display_name": "Peter Mellett", "link": "https://stackoverflow.com/users/771564/peter-mellett"}, "edited": false, "score": 1, "creation_date": 1537871904, "post_id": 52492293, "comment_id": 91932742, "body": "both of them (mysql and ES), Because I&#39;ve many field search (not only simple like this) So can not using mysql to sort."}], "owner": {"reputation": 165, "user_id": 4608351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ca15ba43fede05475e652e101c3a72?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen Cindy", "link": "https://stackoverflow.com/users/4608351/nguyen-cindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537858589, "creation_date": 1537858589, "question_id": 52492293, "link": "https://stackoverflow.com/questions/52492293/elasticsearch-sorting-by-relationship", "title": "Elasticsearch sorting by relationship", "body": "<p>I've defined relationship like this</p>\n\n<pre><code>PUT /my_index/user/1 \n{\n  \"name\":     \"John Smith\",\n  \"email\":    \"john@smith.com\",\n  \"dob\":      \"1970/10/24\"\n  \"number_of_posts\": 4\n}\n\nPUT /my_index/blogpost/2 \n{\n  \"title\":    \"Relationships\",\n  \"body\":     \"It's complicated...\",\n  \"user\":     1 \n}\n</code></pre>\n\n<p>How can I sort blogpost by user information like name, email or number_of_posts without using nested field on blogpost, because I don't want to update all blogpost with user = 1 when user change their information. Thanks!</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 1221, "user_id": 9375533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a08c00e9e6694fe8222c6918801dcc0?s=128&d=identicon&r=PG&f=1", "display_name": "dcangulo", "link": "https://stackoverflow.com/users/9375533/dcangulo"}, "is_accepted": false, "score": 0, "last_activity_date": 1537854158, "creation_date": 1537854158, "answer_id": 52491282, "question_id": 52491238, "link": "https://stackoverflow.com/questions/52491238/can-someone-can-help-me-with-this-ruby-conditional/52491282#52491282", "title": "Can someone can help me with this ruby conditional?", "body": "<p>Take note that <code>string.downcase.split(/\\W+/).join('') == string.downcase.split(/\\W+/).join('').reverse ? 'yes is a palindrome' : ' is not a palindrome. :('</code> is the same as this:</p>\n\n<pre><code>if string.downcase.split(/\\W+/).join('') == string.downcase.split(/\\W+/).join('').reverse\n'yes is a palindrome'\nelse\n' is not a palindrome. :('\nend    \n</code></pre>\n\n<p><strong>Answer:</strong></p>\n\n<pre><code>def palindrome(string)\n      string.downcase.split(/\\W+/).join('') == . \n      string.downcase.split(/\\W+/).join('').reverse ? 'yes is a palindrome' : ' is not a palindrome. :('\n    end\n\n# test code\n\np palindrome(\"Dennis, Nell, Edna, Leon, Nedra, Anita, Rolf, Nora, Alice, Carol, Leo, Jane, Reed, Dena, Dale, Basil, Rae, Penny, Lana, Dave, Denny, Lena, Ida, Bernadette, Ben, Ray, Lila, Nina, Jo, Ira, Mara, Sara, Mario, Jan, Ina, Lily, Arne, Bette, Dan, Reba, Diane, Lynn, Ed, Eva, Dana, Lynne, Pearl, Isabel, Ada, Ned, Dee, Rena, Joel, Lora, Cecil, Aaron, Flora, Tina, Arden, Noel, and Ellen sinned.\")\np palindrome(\"Depardieu, go razz a rogue I draped\")\np palindrome(\"Desserts I stressed.\")\np palindrome(\"Detartrated.\")\np palindrome(\"Devo met a Mr., eh, DNA and her mate moved.\")\np palindrome(\"Di as dad said.\")\np palindrome(\"Did I draw Della too tall, Edward? I did?\")\np palindrome(\"Dior droid.\")\np palindrome(\"DNA-land.\")\np palindrome(\"Do geese see god?\")\np palindrome(\"Do good? I? No. Evil anon I deliver. I maim nine more hero-men in Saginaw, sanitary sword a-tuck, Carol, I. Lo! Rack, cut a drowsy rat in Aswan. I gas nine more hero-men in Miami. Reviled, I (Nona) live on. I do, O God.\")\np palindrome(\"abracadabra!\")\np palindrome(\"Mister, mister, on a see-saw with your sister.\")\np palindrome(\"Almost every sentence is NOT a palindrome! How unfair!\")\n</code></pre>\n\n<p><strong>This will return:</strong></p>\n\n<pre><code>\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\"yes is a palindrome\"\n\" is not a palindrome. :(\"\n\" is not a palindrome. :(\"\n\" is not a palindrome. :(\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": 1, "last_activity_date": 1537855185, "creation_date": 1537855185, "answer_id": 52491516, "question_id": 52491238, "link": "https://stackoverflow.com/questions/52491238/can-someone-can-help-me-with-this-ruby-conditional/52491516#52491516", "title": "Can someone can help me with this ruby conditional?", "body": "<p>You can write a little function to check if its input is true or false and print the desired line.</p>\n\n<pre><code>def is_palindrome(string)\n  p palindrome(string) ? \"yes is a palindrome\" : \"is not a palindrome. :(\"\nend\n\nis_palindrome(\"Depardieu, go razz a rogue I draped\")\n</code></pre>\n\n<hr>\n\n<p>That said, there are many very, very good testing libraries for Ruby. I really like <a href=\"http://rspec.info/\" rel=\"nofollow noreferrer\">rspec</a>. Here's an example.</p>\n\n<pre><code>RSpec.describe \"palindrome\" do\n  it \"ignores case\" do\n    expect( palindrome(\"Detartrated\") ).to be true\n  end\n\n  it 'ignores non-alpha numerics' do\n    expect( palindrome(\"DNA-land.\") ).to be true\n  end\n\n  it 'ignores spaces' do\n    expect( palindrome(\"Dior droid.\") ).to be true\n  end\n\n  it 'finds non-palindromes' do\n    expect( palindrome(\"abracadabra!\") ).to be false\n  end\nend\n</code></pre>\n\n<p><code>gem install rspec</code> then run it with <code>rspec</code>.</p>\n\n<pre><code>$ rspec ~/tmp/test.rb\n....\n\nFinished in 0.00442 seconds (files took 0.14683 seconds to load)\n4 examples, 0 failures\n</code></pre>\n\n<p>This might seem like overkill for one little function, but it will be very important to get familiar with a good testing library as you make more complex creations. It helps organize and describe what scenarios you're testing. And it will give you good information if a test fails.</p>\n\n<pre><code>  1) palindrome failed palindrome\n     Failure/Error: expect( palindrome(\"slow speed: deep owls\") ).to be true\n\n       expected true\n            got false\n     # /Users/schwern/tmp/test.rb:23:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10411075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WA5BwwnbC_8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX-knMlK_QrJmh3sFzYWveJPNxU7g/mo/photo.jpg?sz=128", "display_name": "Gustavo Cerna", "link": "https://stackoverflow.com/users/10411075/gustavo-cerna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1537855995, "creation_date": 1537853889, "last_edit_date": 1537855995, "question_id": 52491238, "link": "https://stackoverflow.com/questions/52491238/can-someone-can-help-me-with-this-ruby-conditional", "title": "Can someone can help me with this ruby conditional?", "body": "<p>I have this code:</p>\n\n<pre><code>def palindrome(string)\n  string.downcase.split(/\\W+/).join('') == string.downcase.split(/\\W+/).join('').reverse\nend\n</code></pre>\n\n<p>I need to test my palindrome method using if else\nconditions. If the first palindrome returns <code>true</code>, I need to print <code>yes is a palindrome</code>. If the other palindrome is <code>false</code>, I need to print <code>is not a palindrome. :(</code>.</p>\n\n<p>With this test code,</p>\n\n<pre><code>p palindrome(\"Dennis, Nell, Edna, Leon, Nedra, Anita, Rolf, Nora, Alice, Carol, Leo, Jane, Reed, Dena, Dale, Basil, Rae, Penny, Lana, Dave, Denny, Lena, Ida, Bernadette, Ben, Ray, Lila, Nina, Jo, Ira, Mara, Sara, Mario, Jan, Ina, Lily, Arne, Bette, Dan, Reba, Diane, Lynn, Ed, Eva, Dana, Lynne, Pearl, Isabel, Ada, Ned, Dee, Rena, Joel, Lora, Cecil, Aaron, Flora, Tina, Arden, Noel, and Ellen sinned.\")\np palindrome(\"Depardieu, go razz a rogue I draped\")\np palindrome(\"Desserts I stressed.\")\np palindrome(\"Detartrated.\")\np palindrome(\"Devo met a Mr., eh, DNA and her mate moved.\")\np palindrome(\"Di as dad said.\")\np palindrome(\"Did I draw Della too tall, Edward? I did?\")\np palindrome(\"Dior droid.\")\np palindrome(\"DNA-land.\")\np palindrome(\"Do geese see god?\")\np palindrome(\"Do good? I? No. Evil anon I deliver. I maim nine more hero-men in Saginaw, sanitary sword a-tuck, Carol, I. Lo! Rack, cut a drowsy rat in Aswan. I gas nine more hero-men in Miami. Reviled, I (Nona) live on. I do, O God.\")\np palindrome(\"abracadabra!\")\np palindrome(\"Mister, mister, on a see-saw with your sister.\")\np palindrome(\"Almost every sentence is NOT a palindrome! How unfair!\")\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>true\ntrue\ntrue\ntrue\ntrue\ntrue\ntrue\ntrue\ntrue\ntrue\ntrue\nfalse\nfalse\nfalse\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rabbitmq", "cloudamqp"], "comments": [{"owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 1, "creation_date": 1537862559, "post_id": 52491059, "comment_id": 91927233, "body": "just a thought, it seems that rake will start the process for the task and this process will be killed after task is completed. Basically the line: <code>queue.subscribe</code> will not be there once the rake process will stop. You would need a running process for subscription. You may want to create a file in <code>config&#47;initializers&#47;subscribers.rb</code> and put this logic there."}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "reply_to_user": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537866366, "post_id": 52491059, "comment_id": 91929268, "body": "thanks @teckden, now its listening but that sidekiq worker call is not happening, bcz in my local when i run &#39;bundle exec sidekiq&#39; that new subscribers.rb initializer is calling"}, {"owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537869191, "post_id": 52491059, "comment_id": 91931053, "body": "I do not have much experience with rabbitmq, if no one will help you I can try to check it later. For now maybe you can take a look at <a href=\"https://github.com/jondot/sneakers\" rel=\"nofollow noreferrer\">github.com/jondot/sneakers</a> so in your` Procfile` you would have something <code>worker: bundle exec sneakers work Processor</code>"}, {"owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "reply_to_user": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "edited": false, "score": 0, "creation_date": 1537870106, "post_id": 52491059, "comment_id": 91931624, "body": "Yes this one i tried, that was working, but i dn&#39;t want to use more gem, thats&#39;y i am working with this way, thanks"}], "owner": {"reputation": 899, "user_id": 1986039, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/lLSu0.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/1986039/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1537853636, "creation_date": 1537852799, "last_edit_date": 1537853636, "question_id": 52491059, "link": "https://stackoverflow.com/questions/52491059/configuration-issue-on-heroku-with-rabbitmq-cloudamqp-addon-ruby-application", "title": "Configuration issue on heroku with rabbitMQ (cloudamqp addon) - ruby application", "body": "<p>First of all this is working fine in my local machine. </p>\n\n<p>I have one publisher app (Rails 3), which is publishing message to <strong>cloudamq(addon)</strong> in heroku, we are getting messages in cloudamq</p>\n\n<p><a href=\"https://i.stack.imgur.com/RuMBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RuMBa.png\" alt=\"enter image description here\"></a></p>\n\n<p>and one consumer application (Rails 5) which is also running on heroku as a separate app, i put this consumer in a rake task but here the issue is this takes messages from the queue only when we restart the server, that means this rake task will run when we restart, but in rabbitMQ it shows always running</p>\n\n<p><a href=\"https://i.stack.imgur.com/4gBwj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4gBwj.png\" alt=\"enter image description here\"></a></p>\n\n<p>So how can we make the consumer to listen continuously once we push to heroku?</p>\n\n<p>Also once we get the message from queue i have to call a sidekiq worker, that is not happening? using 'redis to go' addon</p>\n\n<p>CONSUMER APP</p>\n\n<p>Gem which i have used in this cosumer application</p>\n\n<pre><code>gem 'redis', '~&gt; 3.0'\n\ngem 'sidekiq'\n\ngem 'bunny'\n</code></pre>\n\n<p>This is the consumer part to get the message from queue as a rake task.</p>\n\n<pre><code> task :do_consumer =&gt; :environment do\n\n   connection = Bunny.new(ENV['CLOUDAMQP_URL'])\n\n   connection.start # start a communication session with the amqp server\n\n   channel = connection.channel()\n\n   queue = channel.queue('order-queue', durable: true)\n\n   puts ' [*] Waiting for messages. To exit press CTRL+C'\n\n   queue.subscribe(manual_ack: true, block: true) do |delivery_info, \n   properties, payload|\n      puts \" [x] Received #{payload}\"\n      puts \" [x] Done\"\n\n      channel.ack(delivery_info.delivery_tag, false)\n      # Call sidekiq worker to do task\n      callSidekiqWorker.perform_async(payload)\n   end\nend\n</code></pre>\n\n<p>Procfile</p>\n\n<pre><code>web: bundle exec puma -C config/puma.rb\nworker: bundle exec sidekiq -e production\nworker: bundle exec rake do_consumer\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 849, "user_id": 5341013, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4c6023b383f6ce0f42ed3cf046ddc8a7?s=128&d=identicon&r=PG&f=1", "display_name": "tkhurana96", "link": "https://stackoverflow.com/users/5341013/tkhurana96"}, "edited": false, "score": 0, "creation_date": 1537852233, "post_id": 52490915, "comment_id": 91922546, "body": "Have you tried obj.send(:talk)"}, {"owner": {"reputation": 3399, "user_id": 8936320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vF3VX.jpg?s=128&g=1", "display_name": "Ishan Patel", "link": "https://stackoverflow.com/users/8936320/ishan-patel"}, "reply_to_user": {"reputation": 849, "user_id": 5341013, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4c6023b383f6ce0f42ed3cf046ddc8a7?s=128&d=identicon&r=PG&f=1", "display_name": "tkhurana96", "link": "https://stackoverflow.com/users/5341013/tkhurana96"}, "edited": false, "score": 0, "creation_date": 1537852335, "post_id": 52490915, "comment_id": 91922579, "body": "Yeah that gives the same o/p @tkhurana96"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1537852353, "post_id": 52490915, "comment_id": 91922584, "body": "<code>obj.respond_to?(talk)</code> understands <code>talk</code> as a variable, but no such variable exists (just like <code>obj.respond_to?(request)</code> understands <code>request</code> as the variable where you have your input). You want to send the symbol name of the method: <code>obj.respond_to?(:talk)</code>, or the string name <code>obj.respond_to?(&quot;talk&quot;)</code>"}, {"owner": {"reputation": 849, "user_id": 5341013, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4c6023b383f6ce0f42ed3cf046ddc8a7?s=128&d=identicon&r=PG&f=1", "display_name": "tkhurana96", "link": "https://stackoverflow.com/users/5341013/tkhurana96"}, "edited": false, "score": 0, "creation_date": 1537852422, "post_id": 52490915, "comment_id": 91922610, "body": "And have you tried obj.respond_to(:talk)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537852588, "post_id": 52490915, "comment_id": 91922665, "body": "...and there&#39;s no need for <code>obj.respond_to?(:talk)</code> since you&#39;ve just defined the method <code>talk</code> (on <code>obj</code>&#39;s singleton class)! Of course <code>obj</code> responds to <code>:talk</code>!"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537857560, "post_id": 52491051, "comment_id": 91924577, "body": "As I noted in a comment on the question, how could <code>obj.respond_to?(:talk)</code> return anything other than <code>true</code> considering that you&#39;ve just defined the method <code>talk</code> on <code>obj</code>? It&#39;s like saying, &quot;The light is red! If the light is red, stop!&quot;, rather than, &quot;The light is red! Stop!&quot;."}], "tags": [], "owner": {"reputation": 3399, "user_id": 8936320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vF3VX.jpg?s=128&g=1", "display_name": "Ishan Patel", "link": "https://stackoverflow.com/users/8936320/ishan-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1537852751, "creation_date": 1537852751, "answer_id": 52491051, "question_id": 52490915, "link": "https://stackoverflow.com/questions/52490915/what-is-the-difference-between-passing-method-name-directly-or-by-user-input-to/52491051#52491051", "title": "what is the difference between passing method name directly or by user input to respond_to method in ruby?", "body": "<p>Thanks @Amadan, it works by using the symbol name of the method. Following works. </p>\n\n<pre><code>obj = Object.new;\n\ndef obj.talk\n    puts \"Talk called\"\nend\n\nif obj.respond_to?(:talk)\n    obj.send(:talk)\nelse\n    puts \"No talk\"\nend\n</code></pre>\n\n<blockquote>\n  <p>Talk called</p>\n</blockquote>\n"}], "owner": {"reputation": 3399, "user_id": 8936320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/vF3VX.jpg?s=128&g=1", "display_name": "Ishan Patel", "link": "https://stackoverflow.com/users/8936320/ishan-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52491051, "answer_count": 1, "score": 0, "last_activity_date": 1537852919, "creation_date": 1537851938, "last_edit_date": 1537852919, "question_id": 52490915, "link": "https://stackoverflow.com/questions/52490915/what-is-the-difference-between-passing-method-name-directly-or-by-user-input-to", "title": "what is the difference between passing method name directly or by user input to respond_to method in ruby?", "body": "<p>I wrote the following code:</p>\n\n<pre><code>obj = Object.new\n\ndef obj.talk\n    puts \"Talk called\"\nend\n\nif obj.respond_to?(talk)\n    obj.send(talk)\nelse\n    puts \"No talk\"\nend\n</code></pre>\n\n<p>which outputs following: </p>\n\n<pre><code>undefined local variable or method `talk' for main:Object (NameError)\n</code></pre>\n\n<p>But when I pass it through user input it works as:</p>\n\n<pre><code>obj = Object.new\n\ndef obj.talk\n    puts \"Talk called\"\nend\n\nrequest = gets.chomp\n\nif obj.respond_to?(request)\n    obj.send(request)\nelse\n    puts \"No talk\"\nend\n</code></pre>\n\n<p>which outputs <code>Talk called</code> when entering the string <code>talk</code> from terminal.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1537863969, "post_id": 52490357, "comment_id": 91927943, "body": "&quot;it doesn&#39;t work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538380793, "post_id": 52490357, "comment_id": 92108552, "body": "Gustavo, please don\u2019t ask questions here if you\u2019re going to then disappear for days, weeks or maybe forever."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10411075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WA5BwwnbC_8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX-knMlK_QrJmh3sFzYWveJPNxU7g/mo/photo.jpg?sz=128", "display_name": "Gustavo Cerna", "link": "https://stackoverflow.com/users/10411075/gustavo-cerna"}, "edited": false, "score": 0, "creation_date": 1537849680, "post_id": 52490409, "comment_id": 91921841, "body": "Where should I do that?"}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537870837, "post_id": 52490409, "comment_id": 91932072, "body": "Your solution will match a leading paragraph separator."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1537848163, "creation_date": 1537848163, "answer_id": 52490409, "question_id": 52490357, "link": "https://stackoverflow.com/questions/52490357/how-to-count-paragraphs-in-a-text-file/52490409#52490409", "title": "How to count paragraphs in a text file", "body": "<p>It's much easier to either count it directly:</p>\n\n<pre><code>file_content.split(/\\n\\n+/).count\n</code></pre>\n\n<p>or count the separators and add one:</p>\n\n<pre><code>file_content.scan(/\\n\\n+/).count + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537870695, "post_id": 52490600, "comment_id": 91931974, "body": "<code>str.scan(&#47;\\S+\\n{2,}&#47;).count</code>, no need to gsub."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537887727, "post_id": 52490600, "comment_id": 91943174, "body": "@KimmoLehto, <code>scan</code> produces a temporary array, something I wished to avoid, as I explained in my answer."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537903980, "last_edit_date": 1537903980, "creation_date": 1537849829, "answer_id": 52490600, "question_id": 52490357, "link": "https://stackoverflow.com/questions/52490357/how-to-count-paragraphs-in-a-text-file/52490600#52490600", "title": "How to count paragraphs in a text file", "body": "<p>To determine the number of paragraphs there is no need to construct an array and determine its size. One can instead operate on the string directly by creating an enumerator and counting the number of elements it will generate (after some cleaning of the file contents). This can be done with an unconventional (but highly useful) form of the method <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-gsub\" rel=\"nofollow noreferrer\">String#gsub</a>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def count_paragraphs(fname)\n  (File.read(fname).gsub(/ +$/,'') &lt;&lt; \"\\n\\n\").gsub(/\\S\\n{2,}/).count\nend\n</code></pre>\n\n<p><strong>Examples</strong></p>\n\n<p>First let us construct a text file.</p>\n\n<pre><code>str =&lt;&lt;BITTER_END\n\n\nNow is the time\nfor all good\nRubiest to take\na break.\n\n\nOh, happy\nday.\n\nOne for all,\nall for one.\n\n\nAmen!\nBITTER_END\n</code></pre>\n\n<p></p>\n\n<pre><code>  # \"      \\n\\nNow is the time\\nfor all good\\nRubiest to take\\na break.\\n      \\n     \\nOh, happy\\nday.\\n\\nOne for all,\\nall for one.\\n\\n   \\nAmen!\\n\"\n</code></pre>\n\n<p></p>\n\n<p>Note the embedded spaces.</p>\n\n<pre><code>FNAME = 'temp' \n\nFile.write(FNAME, str)\n  #=&gt; 128\n</code></pre>\n\n<p>Now test the method with this file.</p>\n\n<pre><code>count_paragraphs(FNAME)\n  #=&gt; 4\n</code></pre>\n\n<p>One more:</p>\n\n<pre><code>count_paragraphs('oliver.txt')\n  #=&gt; 61\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The first step is deal with ill-formed text by removing spaces immediately preceding newlines:</p>\n\n<pre><code>File.read(fname).gsub(/ +$/,'')\n</code></pre>\n\n<p></p>\n\n<pre><code>  #=&gt; \"\\n\\nNow is the time\\nfor all good\\nRubiest to take\\na break.\\n\\n\\nOh, happy\\nday.\\n\\nOne for all,\\nall for one.\\n\\n\\nAmen!\\n\"\n</code></pre>\n\n<p></p>\n\n<p>Next, two newlines are appended so we can identify all paragraphs, including the last, as containing a non-whitespace character followed by two or more newlines.<sup>1</sup>.</p>\n\n<p>Note that files containing only spaces and newlines are found to contain zero paragraphs.</p>\n\n<p>If the file is known to contain no ill-formed text, the operative line of the method can be simplified to:</p>\n\n<pre><code>(File.read(fname) &lt;&lt; \"\\n\\n\").gsub(/\\S\\n{2,}/).count\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-count\" rel=\"nofollow noreferrer\">Enumerable#count</a> and <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-i-read\" rel=\"nofollow noreferrer\">IO#read</a>. (As <code>File.superclass #=&gt; IO</code>, <code>read</code> is also in instance method of the class <code>File</code>, and seems to be more commonly invoked on that class than on <code>IO</code>.)</p>\n\n<p>Note that <code>String#gsub</code> without a block returns an enumerator (to which <code>Enumerable#count</code> is applied),</p>\n\n<p>Aside: I believe this form of <code>gsub</code> would be more widely used if it merely had a separate name, such as <code>pattern_match</code>. Calling it <code>gsub</code> seems a misnomer, as it has nothing to do with \"substitution\", \"global\" or otherwise.</p>\n\n<p><sup>1 I revised my original answer to deal with ill-formed text, and in doing so borrowed @Kimmo's idea of requiring matches to include a non-whitespace character.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537946878, "post_id": 52496120, "comment_id": 91964136, "body": "True that. Replaced the solution."}], "tags": [], "owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "is_accepted": false, "score": 0, "last_activity_date": 1537947653, "last_edit_date": 1537947653, "creation_date": 1537871730, "answer_id": 52496120, "question_id": 52490357, "link": "https://stackoverflow.com/questions/52490357/how-to-count-paragraphs-in-a-text-file/52496120#52496120", "title": "How to count paragraphs in a text file", "body": "<p>How about a loop that memoizes the previous character and a state of being in or outside of a paragraph?</p>\n\n<pre><code>def count_paragraphs(some_file)\n  paragraphs = 0\n  in_paragraph = false\n  previous_char = \"\"\n  File.open(some_file).each_char do |char|\n    if !in_paragraph &amp;&amp; char != \"\\n\"\n      paragraphs += 1\n      in_paragraph = true\n    elsif in_paragraph &amp;&amp; char == \"\\n\" &amp;&amp; previous_char == \"\\n\"\n      in_paragraph = false\n    end\n    previous_char = char\n  end\n  paragraphs\nrescue\n  nil\nend\n</code></pre>\n\n<p>This solution does not build any temporary arrays of the full content so you could parse a huge file without it being read into memory. Also, there are no regular expressions.</p>\n\n<p>The <code>rescue</code> was added because of the \"Your function should return either the number of paragraphs or nil\" which did not give a clear definition of when a nil should be returned. In this case it will be returned if any exception happens, for example if the file isn't found or can't be read, which will raise an exception that will be catched by the <code>rescue</code>.</p>\n\n<p>You don't need an explicit <code>return</code> in Ruby. The return value of the last statement will be used as the method's return value.</p>\n"}], "owner": {"reputation": 9, "user_id": 10411075, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WA5BwwnbC_8/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX-knMlK_QrJmh3sFzYWveJPNxU7g/mo/photo.jpg?sz=128", "display_name": "Gustavo Cerna", "link": "https://stackoverflow.com/users/10411075/gustavo-cerna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1537947653, "creation_date": 1537847710, "last_edit_date": 1537947424, "question_id": 52490357, "link": "https://stackoverflow.com/questions/52490357/how-to-count-paragraphs-in-a-text-file", "title": "How to count paragraphs in a text file", "body": "<p>Using the <a href=\"http://hills.ccsf.edu/~dputnam/oliver.txt\" rel=\"nofollow noreferrer\">oliver.txt</a>\nwrite a method called <code>count_paragraphs</code> that counts the number of paragraphs in the text.</p>\n\n<p>In <a href=\"http://hills.ccsf.edu/~dputnam/oliver.txt\" rel=\"nofollow noreferrer\">oliver.txt</a> the paragraph delimiter consists of two or more consecutive newline characters, like this: <code>\\n\\n</code>, <code>\\n\\n\\n</code>, or even <code>\\n\\n\\n\\n</code>.</p>\n\n<p>Your method should return either the number of paragraphs or nil.</p>\n\n<p>I have this code but it doesn't work:</p>\n\n<pre><code>def count_paragraphs(some_file)\n    file_content = open(some_file).read()\n    count = 0\n    file_content_split = file_content.split('')\n\n    file_content_split.each_index do |index|\n        count += 1 if file_content_split[index] == \"\\n\" &amp;&amp; file_content_split[index + 1] == \"\\n\"                      \n    end\n    return count\nend\n\n# test code\np count_paragraphs(\"oliver.txt\")\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1537868249, "post_id": 52489830, "comment_id": 91930465, "body": "Did you try to add <code>delegate :original_class, to: :__getobj__</code> to decorators and in <code>User</code> class add something like <code>alias original_class class</code>?"}, {"owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1537870232, "post_id": 52489830, "comment_id": 91931701, "body": "Thanks, that seems to work."}], "answers": [{"comments": [{"owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "edited": false, "score": 0, "creation_date": 1537870678, "post_id": 52495140, "comment_id": 91931963, "body": "I have accepted this solution, instead of what proposed by @MartinZinovsky because it doesn&#39;t require to modify the <code>User</code> class."}], "tags": [], "owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "is_accepted": true, "score": 2, "last_activity_date": 1537868664, "creation_date": 1537868664, "answer_id": 52495140, "question_id": 52489830, "link": "https://stackoverflow.com/questions/52489830/get-extended-object-from-multiple-decoration/52495140#52495140", "title": "Get extended object from multiple decoration", "body": "<p>I don't think you can do this with <code>SimpleDelegator</code>.</p>\n\n<p>You need to implement this method yourself.</p>\n\n<p>For example:</p>\n\n<pre><code>class MyDelegator &lt; SimpleDelegator\n  def original_object\n    obj = __getobj__\n    obj.is_a?(MyDecorator) ? obj.original_object : obj\n  end\nend\n</code></pre>\n\n<p>And all of your decorators should be inherited from <code>MyDelegator</code></p>\n"}], "owner": {"reputation": 4616, "user_id": 284257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f4e37ffbbf81653b797ec4cf995a23b1?s=128&d=identicon&r=PG", "display_name": "Sig", "link": "https://stackoverflow.com/users/284257/sig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52495140, "answer_count": 1, "score": 0, "last_activity_date": 1537868664, "creation_date": 1537843141, "last_edit_date": 1537844961, "question_id": 52489830, "link": "https://stackoverflow.com/questions/52489830/get-extended-object-from-multiple-decoration", "title": "Get extended object from multiple decoration", "body": "<p>Using <a href=\"http://ruby-doc.org/stdlib-2.5.0/libdoc/delegate/rdoc/SimpleDelegator.html\" rel=\"nofollow noreferrer\"><code>SimpleDelegator</code></a>, I created a few decorators to add extra functionalities to my objects. I need to decorate an object twice, as below:</p>\n\n<pre><code>Tracked.new(Audited.new(User.new))).save\n</code></pre>\n\n<p>Here is the basic structure of the decorator(s):</p>\n\n<pre><code>class Tracked #or Audited\n  delegate :id, to: :__getobj__\n\n  def initialize(extened_object)\n    super(extened_object)\n    @extened_object = extened_object\n  end\n\n  def itself\n    __getobj__\n  end\n\n  def save\n    super\n    # the extended behavior\n  end\nend\n</code></pre>\n\n<p>I want to access the class <code>User</code> from the object. In <code>Audited</code>, if I call <code>@extended_object.class</code> with <code>Audited.new(User.new)).save</code>, I get <code>User</code>. In <code>Tracked</code>, if I call <code>@extended_object.class</code> with <code>Tracked(Audited.new(User.new))).save</code>, I get <code>Audited</code> instead.</p>\n\n<p>How can I get the Class of the <code>extended_object</code> regardless of the number of times I decorate it?</p>\n"}, {"tags": ["ruby", "vagrant", "yaml", "vagrantfile"], "answers": [{"tags": [], "owner": {"reputation": 44774, "user_id": 4296747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muYS9LV5AoA/AAAAAAAAAAI/AAAAAAAACG4/KcTmlFyGWRI/photo.jpg?sz=128", "display_name": "Frederic Henri", "link": "https://stackoverflow.com/users/4296747/frederic-henri"}, "is_accepted": true, "score": 1, "last_activity_date": 1537886239, "creation_date": 1537886239, "answer_id": 52500803, "question_id": 52489429, "link": "https://stackoverflow.com/questions/52489429/run-a-dynamic-number-of-shell-provisioners-on-the-same-vm-in-vagrant-without-cha/52500803#52500803", "title": "Run a dynamic number of shell provisioners on the same VM in Vagrant without changing the Vagrantfile?", "body": "<p>The following will work</p>\n\n<pre><code>require \"yaml\"\n\ncurrent_dir = File.dirname(File.expand_path(__FILE__))\nyaml_config = YAML.load_file(\"#{current_dir}/machine_config.yaml\")\nmachine_config = yaml_config[\"machine_config\"]\n\nVagrant.configure(\"2\") do |config|\n  config.vm.box = \"&lt;vm-box-to-use&gt;\"\n\n  machine_config[\"provisioners\"].each do |script|\n    config.vm.provision \"shell\", name: script['name'], path: script['path']\n  end\n\nend\n</code></pre>\n"}], "owner": {"reputation": 134, "user_id": 4866324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0aeeb110b6e2209eedfe12e89d0c25f6?s=128&d=identicon&r=PG&f=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/4866324/matteo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52500803, "answer_count": 1, "score": 1, "last_activity_date": 1537886411, "creation_date": 1537839424, "last_edit_date": 1537886411, "question_id": 52489429, "link": "https://stackoverflow.com/questions/52489429/run-a-dynamic-number-of-shell-provisioners-on-the-same-vm-in-vagrant-without-cha", "title": "Run a dynamic number of shell provisioners on the same VM in Vagrant without changing the Vagrantfile?", "body": "<p>I am writing a Vagrantfile to set up a VM. There are some config parameters that I do not want to hardcode in the Vagrantfile, such as Memory and number of CPUs. As a consequence, I'm using a YAML file which gets loaded in the Vagrantfile to store these config parameters. One thing that is stored in the YAML file is the list of shell provisioner scripts to run. For instance:</p>\n\n<pre><code>---\nmachine_config:\n  mem: 2048\n  cpus: 2\n  provisioners:\n    -name: shell-script-1\n     path: &lt;path-to-shell-script-1&gt;\n    -name: shell-script-2\n     path: &lt;path-to-shell-script-2&gt;\n---\n</code></pre>\n\n<p>The number of provisioners is not known a priori: in the YAML above there are two, but it's only an example. I'd like to have a Vagrantfile which can run all of the provisioners in the YAML file. What I mean is that I want to be able to add/remove provisioners to the YAML file without touching the Vagrantfile, yet the Vagrantfile should correctly run all of the provisioners in the YAML file. I searched on Google and there are plenty of examples on how to run the same, hardcoded provisioners on a dynamic number of VMs, but could find none for my problem.</p>\n\n<p>What I'd like to do, written in pseudo-vagrantfile syntax, is:</p>\n\n<pre><code>require \"yaml\"\n\ncurrent_dir = File.dirname(File.expand_path(__FILE__))\nyaml_config = YAML.load_file(\"#{current_dir}/machine_config.yaml\")\nmachine_config = yaml_config[\"machine_config\"]\nadditional_scripts = machine_config[\"provisioners\"]\n\nVagrant.configure(\"2\") do |config|\n  config.vm.box = &lt;vm-box-to-use&gt;\n\n  for each item $script in additional_scripts do \n    config.vm.provision \"shell\", path: $script[\"path\"] \n  end\n\nend\n</code></pre>\n\n<p>where machine_config.yaml is a YAML file like the one in the first example of this question, and $script is a variable that at every iteration of the loop holds a provisioner among those described in machine_config.yaml. As a last remark, I know nothing about Ruby and Ruby's syntax (maybe to someone with that knowledge the answer to my question is trivial, but I couldn't find it by googling).</p>\n"}, {"tags": ["ruby", "postgresql", "pg"], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 4, "last_activity_date": 1537840279, "creation_date": 1537840279, "answer_id": 52489506, "question_id": 52488876, "link": "https://stackoverflow.com/questions/52488876/multiple-insert-in-parametrized-statement-with-pg-gem/52489506#52489506", "title": "Multiple insert in parametrized statement with PG gem", "body": "<p>There are two things to note:</p>\n\n<ol>\n<li>You need the right number of placeholders.</li>\n<li><code>#exec_params</code> wants a flat array for the parameters.</li>\n</ol>\n\n<p>So you want to say:</p>\n\n<pre><code>connection.exec_params(\n  'INSERT INTO public.my_things (col1, col2) VALUES ($1, $2), ($3, $4), ($5, $6)',\n  ['value11', 'value12', 'value21', 'value22', 'value31', 'value32']\n)\n</code></pre>\n\n<p>Or, if you have an array-of-arrays and you don't know how long it will be until runtime:</p>\n\n<pre><code>aoa = [['value11', 'value12'], ['value21', 'value22'], ['value31', 'value32'], ... ]\nvalues = aoa.length.times.map { |i| \"($#{2*i+1}, $#{2*i+2})\" }.join(',')\nconnection.exec_params(\n  \"INSERT INTO public.my_things (col1, col2) VALUES #{values}\",\n  aoa.flatten\n)\n</code></pre>\n"}], "owner": {"reputation": 2510, "user_id": 2995613, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3eb082f2910fcc8ebc7bb2f5ce5bc9ce?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2995613/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 52489506, "answer_count": 1, "score": 3, "last_activity_date": 1537840287, "creation_date": 1537834233, "last_edit_date": 1537840287, "question_id": 52488876, "link": "https://stackoverflow.com/questions/52488876/multiple-insert-in-parametrized-statement-with-pg-gem", "title": "Multiple insert in parametrized statement with PG gem", "body": "<p>Using the Ruby <strong>PG gem</strong>, I am trying to insert several rows at the same time with <code>exec_params</code>.</p>\n\n<p>What I would like to acheive is:</p>\n\n<pre><code>INSERT INTO public.my_things (col1, col2)\nVALUES\n    ('value11', 'value12'),\n    ('value21', 'value22'),\n    ('value31', 'value32');\n</code></pre>\n\n<p>I tried this (and other combinations):</p>\n\n<pre><code>connection.exec_params(\n  'INSERT INTO public.my_things (col1, col2) VALUES ($1, $2)',\n  [['value11', 'value12'], ['value21', 'value22'], ['value31', 'value32']],\n)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "pg-search"], "comments": [{"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537852434, "post_id": 52488572, "comment_id": 91922612, "body": "Please check the given answer below and feel free to accept answer if it helped you!"}, {"owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "reply_to_user": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "edited": false, "score": 0, "creation_date": 1537864714, "post_id": 52488572, "comment_id": 91928331, "body": "Unfortunately everything works except for the third query.."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "edited": false, "score": 0, "creation_date": 1537864489, "post_id": 52490938, "comment_id": 91928211, "body": "(1) the result of my search if it matches a record in my database OK  (2) all my products if the user input is blank (or if I simply visit the /products page) OK  (3) a message which says the product hasn&#39;t been found if the product doesn&#39;t exist (is not in the database) doesn&#39;t works."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "edited": false, "score": 0, "creation_date": 1537875082, "post_id": 52490938, "comment_id": 91934599, "body": "@LuisCarlosQuarta Hi, are you not getting <code>No products found!</code> error ? in 3rd case?"}, {"owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "edited": false, "score": 0, "creation_date": 1537879369, "post_id": 52490938, "comment_id": 91937415, "body": "yes in the 3 case, when i search for something i know is not in the database it simply gets me all the products and there is no errors. I copied pasted your code exactly how it is. I updated my post with my search view at the end."}, {"owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "reply_to_user": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "edited": false, "score": 0, "creation_date": 1537895188, "post_id": 52490938, "comment_id": 91947403, "body": "@LuisCarlosQuarta Hi I understand your requirement but in 3rd condition you won&#39;t be able to know if product exists in database or not in that case @product_search will return blank array same as in (2) all my products if the <code>user input is blank (or if I simply visit the &#47;products page)</code> so i&#39;m not sure if pg_search will return anything in case of 3rd that will meant to guess that product not exists in database, hope you understand it well."}, {"owner": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1538015755, "post_id": 52490938, "comment_id": 91996582, "body": "You can make the third condition work by checking the presence of <code>params[:term]</code>. If <code>params[:term].present?</code> returns <code>true</code>, but <code>@product_search</code> is empty, then display the message for No Products Found. If <code>params[:term].present?</code> returns false, then show all products."}], "tags": [], "owner": {"reputation": 5669, "user_id": 7429104, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/TZAPt.jpg?s=128&g=1", "display_name": "Aman", "link": "https://stackoverflow.com/users/7429104/aman"}, "is_accepted": false, "score": 0, "last_activity_date": 1537852380, "last_edit_date": 1537852380, "creation_date": 1537852047, "answer_id": 52490938, "question_id": 52488572, "link": "https://stackoverflow.com/questions/52488572/view-results-of-a-search-in-index/52490938#52490938", "title": "View results of a search in index", "body": "<p>(1) the result of my search if it matches a record in my database,</p>\n\n<p>(2) all my products if the user input is blank (or if I simply visit the /products page), and</p>\n\n<p>(3) a message which says the product hasn't been found if the product doesn't exist (is not in the database).</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;% if @products_search.blank? %&gt;\n      &lt;%unless @products.blank?%&gt;\n        &lt;% @products.each do |product| %&gt;\n          &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n            &lt;%= product.name %&gt;&lt;br&gt;\n            &lt;%= product.description %&gt;&lt;br&gt;\n            &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n            &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n          &lt;/div&gt;\n        &lt;%end%&gt;\n      &lt;%else%&gt;\n        &lt;h1&gt;No products found!&lt;/h1&gt;\n      &lt;%end%&gt;     \n\n    &lt;% elsif @products_search.present? %&gt;\n      &lt;% @products_search.each do |product| %&gt;\n      &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n        &lt;%= product.name %&gt;&lt;br&gt;\n        &lt;%= product.description %&gt;&lt;br&gt;\n        &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n        &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n      &lt;/div&gt;\n      &lt;%end%&gt;\n    &lt;% else %&gt;\n      &lt;h1&gt;No products found!&lt;/h1&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "is_accepted": true, "score": 0, "last_activity_date": 1538660277, "creation_date": 1538660277, "answer_id": 52648183, "question_id": 52488572, "link": "https://stackoverflow.com/questions/52488572/view-results-of-a-search-in-index/52648183#52648183", "title": "View results of a search in index", "body": "<p>With this code, i finally achieved what I was trying to do.</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;% if params[:term].present? %&gt;\n      &lt;% if @products_search.present? %&gt;\n        &lt;% @products_search.each do |product| %&gt;\n        &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n          &lt;%= product.name %&gt;&lt;br&gt;\n          &lt;%= product.description %&gt;&lt;br&gt;\n          &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n          &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n        &lt;/div&gt;\n        &lt;%end%&gt;\n      &lt;% else %&gt;\n        &lt;h1&gt;No products found!&lt;/h1&gt;\n      &lt;%end%&gt;\n    &lt;% else %&gt;\n      &lt;% @products.each do |product| %&gt;\n      &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n        &lt;%= product.name %&gt;&lt;br&gt;\n        &lt;%= product.description %&gt;&lt;br&gt;\n        &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n        &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n      &lt;/div&gt;\n      &lt;%end%&gt;\n      &lt;%end%&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10192738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EBCq0.jpg?s=128&g=1", "display_name": "Kaido", "link": "https://stackoverflow.com/users/10192738/kaido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52648183, "answer_count": 2, "score": 0, "last_activity_date": 1538660277, "creation_date": 1537831211, "last_edit_date": 1537879229, "question_id": 52488572, "link": "https://stackoverflow.com/questions/52488572/view-results-of-a-search-in-index", "title": "View results of a search in index", "body": "<p>What i'm trying to achieve is a product index page which shows:</p>\n\n<p>(1) the result of my search if it matches a record in my database, </p>\n\n<p>(2) all my products if the user input is blank (or if I simply visit the /products page), and </p>\n\n<p>(3) a message which says the product hasn't been found if the product doesn't exist (is not in the database). </p>\n\n<p>The code below returns me all the products if I insert a blank space in the search field or if I insert a string that doesn't match any record in the database, and a correct product if it's found it in the database. </p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n    &lt;% if @products_search.present? %&gt;\n      &lt;% @products_search.each do |product| %&gt;\n        &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n          &lt;%= product.name %&gt;&lt;br&gt;\n          &lt;%= product.description %&gt;&lt;br&gt;\n          &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n          &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n\n    &lt;% elsif @products_search.blank? %&gt;\n      &lt;% @products.each do |product| %&gt;\n        &lt;div class=\"col-sm-8 col-sm-offset-2\"&gt;\n          &lt;%= product.name %&gt;&lt;br&gt;\n          &lt;%= product.description %&gt;&lt;br&gt;\n          &lt;%= humanized_money_with_symbol(product.price)%&gt;&lt;br&gt;\n          &lt;%= link_to \"Show Product\", product_path(product) %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n\n    &lt;% else %&gt;\n      &lt;h1&gt;No products found!&lt;/h1&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n\nclass ProductsController &lt; ApplicationController\n\n  def index\n    @products_search = Product.search_by_name_and_description(params[:term])\n    @products = Product.all\n  end\nend\n\nclass Product &lt; ApplicationRecord\n  has_and_belongs_to_many :orders\n  belongs_to :category\n  belongs_to :user\n\n  monetize :price_cents\n\n  include PgSearch\n  pg_search_scope :search_by_name_and_description,\n                  against: [ :name, :description ],\n                  associated_against: {\n                      category: [ :name ]\n                  },\n                  using: {\n                      tsearch: { prefix: true }\n                  }\nend\n\n    &lt;%= form_tag products_path, method: :get do %&gt;\n  &lt;%= text_field_tag 'term', params[:term], placeholder: \"What are you looking for?\", :required =&gt; true %&gt;\n  &lt;%= submit_tag 'Search!' %&gt;\n&lt;% end %&gt;\n&lt;br&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "parameters"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1537834627, "post_id": 52488407, "comment_id": 91918988, "body": "I&#39;m sure this a duplicate but they can be hard to find. Anyway, &quot;to permit a hash, pass an array; to permit an array, pass a hash&quot; so I think you want <code>destination: [:currency]</code> (or equivalently <code>destination: %i[currency]</code>)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1537834878, "post_id": 52488407, "comment_id": 91919031, "body": "I&#39;ve edited the hash so that it&#39;s structure can be more easily seen. I&#39;ve also set it equal to a local variable (<code>h</code>) should readers want to reference that."}, {"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1537853973, "post_id": 52488407, "comment_id": 91923070, "body": "Try <code>params.permit(:domain, :type, rate: [:currency, destination: {}, items: [:name, :sku, :quantity, :fulfillment_service]])</code>"}, {"owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 1, "creation_date": 1537876642, "post_id": 52488407, "comment_id": 91935578, "body": "@Pavan thank you! that worked, I swear I had tried that before!! if you&#39;d like to get credit put yours as an answer!"}], "answers": [{"tags": [], "owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1537878914, "creation_date": 1537878914, "answer_id": 52498377, "question_id": 52488407, "link": "https://stackoverflow.com/questions/52488407/nested-strong-params-with-arrays-and-hashes/52498377#52498377", "title": "Nested Strong Params with arrays and hashes", "body": "<p>The below should work</p>\n\n<pre><code>params.permit(:domain, :type, rate: [:currency, destination: {}, items: [:name, :sku, :quantity, :fulfillment_service]])\n</code></pre>\n"}], "owner": {"reputation": 2168, "user_id": 4386626, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/f2c9512ee4dac8ccbbf45fc2cf1a8046?s=128&d=identicon&r=PG&f=1", "display_name": "ToddT", "link": "https://stackoverflow.com/users/4386626/toddt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 52498377, "answer_count": 1, "score": 0, "last_activity_date": 1537878914, "creation_date": 1537829837, "last_edit_date": 1537834775, "question_id": 52488407, "link": "https://stackoverflow.com/questions/52488407/nested-strong-params-with-arrays-and-hashes", "title": "Nested Strong Params with arrays and hashes", "body": "<p>I can almost get everything I need from these params (which I've simplified)</p>\n\n<pre><code>h = { \"rate\"=&gt;{\n        \"destination\"=&gt;{\n        \"country\"=&gt;\"US\", \"postal_code\"=&gt;\"12345\", \"province\"=&gt;\"NC\",\n        \"city\"=&gt;\"Charlotte\", \"name\"=&gt;\"mine\", \"address1\"=&gt;\"12 Main\"\n      },\n      \"items\"=&gt;[\n        {\n          \"name\"=&gt;\"Buy This\", \"sku\"=&gt;\"MC-J4\", \"quantity\"=&gt;1,\n          \"fulfillment_service\"=&gt;\"web\", \"properties\"=&gt;nil,\n          \"variant_id\"=&gt;13992832794667\n        }\n      ],\n      \"currency\"=&gt;\"USD\",\n      \"locale\"=&gt;\"en\"\n    } \n  }\n</code></pre>\n\n<p>This is what I have so far:</p>\n\n<pre><code>params.permit(:domain, :type, rate: [destination: {}, items: [:name, :sku, :quantity, :fulfillment_service]])\n</code></pre>\n\n<p>What I'm missing is the <code>currency</code> value. I've tried the following with no luck:</p>\n\n<pre><code>params.permit(:domain, :type, rate: [destination: {:currency}, items: [:name, :sku, :quantity, :fulfillment_service]])\n\nparams.permit(:domain, :type, rate: [destination: {}, items: [:name, :sku, :quantity, :fulfillment_service], :currency])\n</code></pre>\n\n<p>And many more similar iterations. Some reason I can't get that <code>currency</code> value. Any help??</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 1175, "user_id": 1142113, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce627ea82f589ccb85c6a37b921dcad6?s=128&d=identicon&r=PG", "display_name": "Gregology", "link": "https://stackoverflow.com/users/1142113/gregology"}, "edited": false, "score": 0, "creation_date": 1537844927, "post_id": 52488276, "comment_id": 91920847, "body": "Super weird, there are no issues when I used ruby 2.5.0. The issues occur with ruby version 2.5.1."}, {"owner": {"reputation": 1175, "user_id": 1142113, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce627ea82f589ccb85c6a37b921dcad6?s=128&d=identicon&r=PG", "display_name": "Gregology", "link": "https://stackoverflow.com/users/1142113/gregology"}, "edited": false, "score": 0, "creation_date": 1537865215, "post_id": 52488276, "comment_id": 91928617, "body": "I have also tried the gem with ruby 2.6.0-preview2 with no issues. I have uninstalled and reinstalled ruby 2.5.1 and the problem remains. Maybe a bug in 2.5.1? I&#39;m using rbenv on macOS. I&#39;ll try to replicate the issue with other gems"}], "owner": {"reputation": 1175, "user_id": 1142113, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce627ea82f589ccb85c6a37b921dcad6?s=128&d=identicon&r=PG", "display_name": "Gregology", "link": "https://stackoverflow.com/users/1142113/gregology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537831562, "creation_date": 1537828761, "last_edit_date": 1537831562, "question_id": 52488276, "link": "https://stackoverflow.com/questions/52488276/ruby-gem-dependency-loaderror-on-rubygems-org", "title": "Ruby Gem dependency LoadError on rubygems.org", "body": "<p>I'm creating a Ruby Gem which has httparty as a dependency.</p>\n\n<p>memair.gemspec</p>\n\n<pre><code>lib = File.expand_path('../lib', __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\n\nGem::Specification.new do |s|\n  s.name        = 'memair'\n  s.version     = '0.0.20'\n  s.date        = '2018-09-24'\n  s.summary     = 'An SDK for Memair'\n  s.description = 'An SDK for Memair allowing easy querying of the GraphQL API'\n  s.authors     = ['Greg Clarke']\n  s.email       = 'greg@memair.com'\n  s.files       = ['lib/memair.rb']\n  s.homepage    = 'https://github.com/memair/memair-ruby-sdk'\n  s.license     = 'MIT'\n  s.add_dependency 'httparty', '~&gt; 0.16'\n  s.require_paths = [\"lib\"]\nend\n</code></pre>\n\n<p>lib/memair.rb</p>\n\n<pre><code>require 'httparty'\n\nclass Memair\n  def initialize(access_token)\n    #do stuff\n  end\nend\n</code></pre>\n\n<p>When I install the gem locally or through rubygems.org it installs the dependency and works as expected.</p>\n\n<pre><code>$ gem uninstall memair\nSuccessfully uninstalled memair-0.0.22\n$ gem uninstall httparty\nRemove executables:\n    httparty\n\nin addition to the gem? [Yn]  y\nRemoving httparty\nSuccessfully uninstalled httparty-0.16.2\n$ gem install memair\nFetching: httparty-0.16.2.gem (100%)\nWhen you HTTParty, you must party hard!\nSuccessfully installed httparty-0.16.2\nSuccessfully installed memair-0.0.22\n2 gems installed\n$ irb\nirb(main):001:0&gt; require 'memair'\n=&gt; true\n</code></pre>\n\n<p>However when I push the gem in my rails project's Gemfile, it fails with...</p>\n\n<p><code>'require': cannot load such file -- httparty (LoadError)</code></p>\n\n<p>Full Traceback</p>\n\n<pre><code>Traceback (most recent call last):\n    53: from bin/rails:3:in `&lt;main&gt;'\n    52: from bin/rails:3:in `load'\n    51: from /Users/greg/Code/memair/memfit/bin/spring:15:in `&lt;top (required)&gt;'\n    50: from /Users/greg/Code/memair/memfit/bin/spring:15:in `require'\n    49: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n    48: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n    47: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n    46: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n    45: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n    44: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `call'\n    43: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `load'\n    42: from /Users/greg/Code/memair/memfit/bin/rails:9:in `&lt;top (required)&gt;'\n    41: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n    40: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency'\n    39: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require'\n    38: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n    37: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n    36: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n    35: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n    34: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n    33: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands.rb:18:in `&lt;main&gt;'\n    32: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/command.rb:46:in `invoke'\n    31: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/command/base.rb:65:in `perform'\n    30: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor.rb:387:in `dispatch'\n    29: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/invocation.rb:126:in `invoke_command'\n    28: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/thor-0.20.0/lib/thor/command.rb:27:in `run'\n    27: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:142:in `perform'\n    26: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:142:in `tap'\n    25: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/commands/server/server_command.rb:145:in `block in perform'\n    24: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n    23: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency'\n    22: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require'\n    21: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n    20: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n    19: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n    18: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n    17: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n    16: from /Users/greg/Code/memair/memfit/config/application.rb:7:in `&lt;main&gt;'\n    15: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler.rb:114:in `require'\n    14: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:65:in `require'\n    13: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:65:in `each'\n    12: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:76:in `block in require'\n    11: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:76:in `each'\n    10: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bundler-1.16.5/lib/bundler/runtime.rb:81:in `block (2 levels) in require'\n     9: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:29:in `require'\n     8: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:20:in `require_with_bootsnap_lfi'\n     7: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/loaded_features_index.rb:65:in `register'\n     6: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `block in require_with_bootsnap_lfi'\n     5: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require'\n     4: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/memair-0.0.20/lib/memair.rb:1:in `&lt;main&gt;'\n     3: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `require'\n     2: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:253:in `load_dependency'\n     1: from /Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/activesupport-5.2.1/lib/active_support/dependencies.rb:287:in `block in require'\n/Users/greg/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/bootsnap-1.3.2/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:32:in `require': cannot load such file -- httparty (LoadError)\n</code></pre>\n\n<p>I've also tried including httparty in my rails project's Gemfile which I assume is an anti pattern and didn't resolve the issue anyway. I've also tried uninstalling both my gem and httparty and rebuilding and uploading to rubygems.org with the same result.</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 67, "user_id": 10247458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qgMYzM-JkMs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM2F8AspLy1-KAnMx4ChxTuWon1XQ/mo/photo.jpg?sz=128", "display_name": "Benjamin Lee", "link": "https://stackoverflow.com/users/10247458/benjamin-lee"}, "edited": false, "score": 0, "creation_date": 1537833192, "post_id": 52487929, "comment_id": 91918724, "body": "Sorry for the duplicate. I had read that article and tried [.*?e], which wasn&#39;t what I was looking for.  The answer is      [.+?e]"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1539020170, "post_id": 52487929, "comment_id": 92341101, "body": "A better way of writing the regex might be the variant that also works in <a href=\"https://www.regular-expressions.info/possessive.html\" rel=\"nofollow noreferrer\">possessive form</a>. This means being more specific in what you want to match. <code>&#47;([^e]|\\Ae)++e&#47;</code> matches at least one character that is not an <code>e</code>, but also allows the <code>e</code> if it is at the start of the string. It keeps matching until an <code>e</code> is encountered and then matches that by having a trailing <code>e</code> in the regex. <code>&quot;experience&quot;[&#47;([^e]|\\Ae)++e&#47;] #=&gt; &quot;expe&quot;</code>"}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1539020834, "post_id": 52487929, "comment_id": 92341380, "body": "<a href=\"http://rubular.com/r/5mBQxGdNGQ\" rel=\"nofollow noreferrer\">Here is the demo</a>. I had to wrap it in an extra pair of parentheses since Rubular only shows the resulting groups."}], "owner": {"reputation": 67, "user_id": 10247458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qgMYzM-JkMs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM2F8AspLy1-KAnMx4ChxTuWon1XQ/mo/photo.jpg?sz=128", "display_name": "Benjamin Lee", "link": "https://stackoverflow.com/users/10247458/benjamin-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1537826503, "answer_count": 0, "score": 0, "last_activity_date": 1537826406, "creation_date": 1537826406, "question_id": 52487929, "link": "https://stackoverflow.com/questions/52487929/how-to-get-first-shorter-match-with-regex-in-ruby", "closed_reason": "Duplicate", "title": "How to get first/shorter match with regex in ruby?", "body": "<p>In ruby:</p>\n\n<pre><code>\"experience\"[/.e/] \n=&gt; \"pe\" \n</code></pre>\n\n<p>Just like expected. However...</p>\n\n<pre><code>\"experience\"[/.*e/] \n=&gt; \"experience\"\n</code></pre>\n\n<p>Is there a way to write a regular expression that returns to first/shorter version it comes across?</p>\n\n<pre><code>\"experience\"[regexp]\n=&gt; \"expe\"\n</code></pre>\n"}, {"tags": ["ruby", "string-literals", "line-endings"], "comments": [{"owner": {"reputation": 766, "user_id": 1772133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9816fbc30091abe048f667191cc81e?s=128&d=identicon&r=PG", "display_name": "Chris Hall", "link": "https://stackoverflow.com/users/1772133/chris-hall"}, "edited": false, "score": 0, "creation_date": 1537827140, "post_id": 52487676, "comment_id": 91917314, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34148616/how-to-print-raw-string-in-ruby\">How to print raw string in ruby?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10410230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0834602318f27d10d2239e8f9fa26953?s=128&d=identicon&r=PG&f=1", "display_name": "David Szell", "link": "https://stackoverflow.com/users/10410230/david-szell"}, "is_accepted": false, "score": 2, "last_activity_date": 1537827386, "creation_date": 1537827386, "answer_id": 52488074, "question_id": 52487676, "link": "https://stackoverflow.com/questions/52487676/how-can-i-print-a-string-contained-in-an-object-as-literal-with-ruby/52488074#52488074", "title": "How can I print a string contained in an object as literal with Ruby?", "body": "<p>If I'm understanding you well, you want to print the \"\\r\" string if the line ending is \\r and \"\\r\\n\" if \\r\\n.</p>\n\n<p>In this case you can use the <em>dump</em> function is what you need:</p>\n\n<pre><code>puts ending.dump // =&gt; \"\\r\" or \"\\r\\n\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "is_accepted": false, "score": 0, "last_activity_date": 1537869019, "creation_date": 1537869019, "answer_id": 52495264, "question_id": 52487676, "link": "https://stackoverflow.com/questions/52487676/how-can-i-print-a-string-contained-in-an-object-as-literal-with-ruby/52495264#52495264", "title": "How can I print a string contained in an object as literal with Ruby?", "body": "<p>I would use method <code>String#inspect</code>:</p>\n\n<pre><code>s = \"abc\\n\\rdef\"\nputs s\nputs s.inspect\n</code></pre>\n\n<p>This is very handy method that is defined on all objects. You can print hashes, arrays, whatever.</p>\n"}], "owner": {"reputation": 765, "user_id": 233260, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/WS73l.jpg?s=128&g=1", "display_name": "sanpaco", "link": "https://stackoverflow.com/users/233260/sanpaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548972356, "creation_date": 1537824799, "last_edit_date": 1548972356, "question_id": 52487676, "link": "https://stackoverflow.com/questions/52487676/how-can-i-print-a-string-contained-in-an-object-as-literal-with-ruby", "title": "How can I print a string contained in an object as literal with Ruby?", "body": "<p>I'm trying to write a program which will detect if a file has <code>\\n</code> or <code>\\r\\n</code> line endings and then fix them. I'm hoping to have the script output some messages to a console, but I'm running into trouble. I can't figure out how to print the line endings as literals.</p>\n\n<p>Here is my method which checks for the line ending type:</p>\n\n<pre><code>def determine_line_ending(filename)\n  File.open(filename, 'r') do |file|\n    return file.readline[/\\r?\\n$/]\n  end\nend\nending = determine_line_ending(ARGV.first)\n</code></pre>\n\n<p>Supposedly this method will return either <code>\\n</code> or <code>\\r\\n</code> if it matches one of those patterns on the first line of the file.</p>\n\n<p>I would like to then print to the console which ending type was detected but if I use <code>puts ending</code> then it just adds a line ending to the console. I know that if I used <code>puts '\\r\\n'</code> then it will print them literal, or if I use double quotes I just have to escape the backslashes. But I'm pretty new to Ruby and I'm having a hard time just finding a way to print my variable as a literal instead of a string.</p>\n"}, {"tags": ["ruby", "neo4j"], "owner": {"reputation": 1835, "user_id": 764601, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/386571a6fd12fc72ff39593da1af15c3?s=128&d=identicon&r=PG", "display_name": "maasha", "link": "https://stackoverflow.com/users/764601/maasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1537822945, "creation_date": 1537822945, "question_id": 52487338, "link": "https://stackoverflow.com/questions/52487338/how-to-obtain-activenode-records-from-neo4j-core-query-results", "title": "How to obtain ActiveNode records from neo4j-core query results?", "body": "<p>If I use the <code>neo4j-core</code> way to query a neo4j instance it will return records of the <code>Neo4j::Core::Node</code> class:</p>\n\n<pre><code>cypher = 'MATCH (n) RETURN n LIMIT 10'\nresults = neo4j_session.query(cypher)\nresults.first[:n] # =&gt; Neo4j::Core::Node\n</code></pre>\n\n<p>How can I convert these to the ActiveNode type of records that was used to populate the database?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "websocket", "coffeescript", "actioncable"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1537916886, "post_id": 52487200, "comment_id": 91955912, "body": "I am pretty bad with actioncable and I am still trying to find out how to solve my own case. But your problem should come from the <code>connection.rb</code> file. Your connection is just rejected. One guess is that you try to get the user from <code>cookies</code> whereas it should be stored in <code>session</code>. Also if User is a devise model you can grab it directly through warden when the user is logged : <code>if verified_user = env[&quot;warden&quot;].user</code> For the rest of your question I can&#39;t really help. sorry."}, {"owner": {"reputation": 143, "user_id": 4521541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebcf80d30f790087dc59eae4d73b478?s=128&d=identicon&r=PG&f=1", "display_name": "jl118", "link": "https://stackoverflow.com/users/4521541/jl118"}, "reply_to_user": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1538160751, "post_id": 52487200, "comment_id": 92060906, "body": "Thanks! Indeed, doing <code>env[&#39;warden&#39;].user</code> solved the problem and <code>current_user </code> can be found in other parts of the app."}], "owner": {"reputation": 143, "user_id": 4521541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebcf80d30f790087dc59eae4d73b478?s=128&d=identicon&r=PG&f=1", "display_name": "jl118", "link": "https://stackoverflow.com/users/4521541/jl118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537823896, "creation_date": 1537822322, "last_edit_date": 1537823896, "question_id": 52487200, "link": "https://stackoverflow.com/questions/52487200/actioncable-using-controller-variable", "title": "ActionCable using controller variable", "body": "<p>In my Ruby on Rails project, I have a <code>user</code> model that is set up by devise. Each <code>user</code> belongs to an <code>account</code> with an account_id. </p>\n\n<p>In my <code>application_controller.rb</code> I have</p>\n\n<pre><code>def set_account\n  @account = current_user.account\nend\n</code></pre>\n\n<p>This is working fine as in many places of my project I have <code>before_action: set_account</code> and it does assign <code>@account</code> correctly. </p>\n\n<p>When a user signs in, I want the user to subscribe to <code>message_notifications_channel_#{account_id}</code> where <code>account_id</code> is the id of the account that the user belongs to. </p>\n\n<p>This is how I set up <code>connection.rb</code>: </p>\n\n<pre><code>module ApplicationCable\n  class Connection &lt; ActionCable::Connection::Base\n    identified_by :current_user\n\n  def connect\n    self.current_user = find_verified_user\n  end\n\n  private\n  def find_verified_user\n    if verified_user = User.find_by(id: cookies.encrypted[:user_id])\n      verified_user\n    else\n      reject_unauthorized_connection\n    end\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>When I entered byebug here, <code>User.find_by(id: cookies.encrypted[:user_id])</code> returned nil and <code>cookies.encrypted[:user_id]</code> is nil too.</p>\n\n<p>This is the setup for <code>message_notifications_channel.rb</code>: </p>\n\n<pre><code>class MessageNotificationsChannel &lt; ApplicationCable::Channel\n  def subscribed\n    current_user.appear\n    # stream_from \"some_channel\"\n    stream_from \"message_notifications_channel_#{params[:account_id]}\"\n  end\n\n  def unsubscribed\n    current_user.disappear\n    # Any cleanup needed when channel is unsubscribed\n  end\nend\n</code></pre>\n\n<p>For <code>message_notifications.coffee</code>, this is the code:</p>\n\n<pre><code>App.message_notifications = App.cable.subscriptions.create {channel: \"MessageNotificationsChannel\", account_id: current_user.account_id},\n  connected: -&gt;\n    # Called when the subscription is ready for use on the server\n\n  disconnected: -&gt;\n    # Called when the subscription has been terminated by the server\n\n  received: (data) -&gt;\n    # Called when there's incoming data on the websocket for this channel\n    if data['direction'] == 'incoming'\n      ding = new Audio('/assets/ding.wav');\n      ding.play();\n      $('#conversation-messages').append String(data['message']);\n    if data['direction'] == 'outgoing'\n      if $('#message_'+data['id']).length == 0\n        iphone_sms_sent_sound = new Audio('/assets/iphone_send_sms.mp3');\n        iphone_sms_sent_sound.play();\n        $('#conversation-messages').append String(data['message']);\n      else\n        $('#message_'+data['id']).replaceWith(data['message']);\n</code></pre>\n\n<p>I'm using the following to broadcast message in the <code>after_create</code> callback of <code>Message.rb</code>: </p>\n\n<p><code>ActionCable.server.broadcast \"message_notifications_channel_#{self.account_id}\", {id: self.id, direction: self.direction, message: ApplicationController.render(partial:'inbox/message', locals: {message: self})}</code></p>\n\n<p>This would not work and I got \"An unauthorized connection attempt was rejected\". I tried using <code>App.message_notifications = App.cable.subscriptions.create {channel: \"MessageNotificationsChannel\", account_id: @account.id}</code>\nThis would not work either. \nThen I did <code>App.message_notifications = App.cable.subscriptions.create {channel: \"MessageNotificationsChannel\", account_id: 3}</code> and commented out <code>current_user.appear</code> and <code>current_user.disappear</code> in <code>message_notifications_channel.rb</code> and everything inside </p>\n\n<pre><code>module ApplicationCable\nend\n</code></pre>\n\n<p>in connection.rb. Then packets will get broadcast and received and things will show up. </p>\n\n<p>How do I get <code>App.message_notifications = App.cable.subscriptions.create {channel: \"MessageNotificationsChannel\", account_id: },</code> to use the id of <code>@account.id</code> or <code>current_user.account_id</code> while keeping the methods for user verification in <code>connection.rb</code>?\nThanks!</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1537818050, "creation_date": 1537818050, "answer_id": 52486272, "question_id": 52486123, "link": "https://stackoverflow.com/questions/52486123/serialize-an-array-of-hashes/52486272#52486272", "title": "Serialize an array of hashes", "body": "<pre><code>records = [\n  {\n    ID: 'BOATY',\n    Name: 'McBoatface, Boaty'\n  },\n  {\n    ID: 'TRAINY',\n    Name: 'McTrainface, Trainy'\n  }\n]\n\n\n# strait forward code\nresult= []\nrecords.each do |hash|\n  hash.each do |key, value|\n    result&lt;&lt; key.to_s\n    result&lt;&lt; value\n  end\nend\nputs result.inspect\n\n# a rubyish way (probably less efficient, I've not done the benchmark)\nputs records.map(&amp;:to_a).flatten.map(&amp;:to_s).inspect\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 541, "user_id": 7067946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f06fb6e5f7378d232e611f50351914?s=128&d=identicon&r=PG&f=1", "display_name": "Arihant", "link": "https://stackoverflow.com/users/7067946/arihant"}, "is_accepted": false, "score": 1, "last_activity_date": 1537818404, "creation_date": 1537818404, "answer_id": 52486352, "question_id": 52486123, "link": "https://stackoverflow.com/questions/52486123/serialize-an-array-of-hashes/52486352#52486352", "title": "Serialize an array of hashes", "body": "<p>Hope it helps.</p>\n\n<pre><code>li = []\nrecords.each do |rec|\n    rec.each do |k,v|\n      li &lt;&lt; \"#{k.to_s},#{v.to_s}\".to_s\n    end\nend\n\nprint li\n</code></pre>\n\n<blockquote>\n  <p>[\"ID,BOATY\", \"Name,McBoatface, Boaty\", \"ID,TRAINY\", \"Name,McTrainface,\n  Trainy\"]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1537818442, "creation_date": 1537818442, "answer_id": 52486358, "question_id": 52486123, "link": "https://stackoverflow.com/questions/52486123/serialize-an-array-of-hashes/52486358#52486358", "title": "Serialize an array of hashes", "body": "<pre><code>records.flat_map(&amp;:to_a).map { |a| a.join(',') }\n#=&gt; [\"ID,BOATY\", \"Name,McBoatface, Boaty\", \"ID,TRAINY\", \"Name,McTrainface, Trainy\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "is_accepted": false, "score": 0, "last_activity_date": 1537869430, "creation_date": 1537869430, "answer_id": 52495389, "question_id": 52486123, "link": "https://stackoverflow.com/questions/52486123/serialize-an-array-of-hashes/52495389#52495389", "title": "Serialize an array of hashes", "body": "<p>You sure you wanna do it this way?</p>\n\n<p>Check out <code>Marshal</code>. Or <code>JSON</code>.</p>\n\n<p>You could even do it this stupid way using <code>Hash#inspect</code> and <code>eval</code>:</p>\n\n<pre><code>serialized_hashes = records.map(&amp;:inspect) # [\"{ID: 'Boaty'...\", ...]\nunserialized = serialized_hashes.map { |s| eval(s) }\n</code></pre>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52486358, "answer_count": 4, "score": 1, "last_activity_date": 1537892490, "creation_date": 1537817437, "last_edit_date": 1537892490, "question_id": 52486123, "link": "https://stackoverflow.com/questions/52486123/serialize-an-array-of-hashes", "title": "Serialize an array of hashes", "body": "<p>I have an array of hashes:</p>\n\n<pre><code>  records = [\n    {\n      ID: 'BOATY',\n      Name: 'McBoatface, Boaty'\n    },\n    {\n      ID: 'TRAINY',\n      Name: 'McTrainface, Trainy'\n    }\n  ]\n</code></pre>\n\n<p>I'm trying to combine them into an array of strings:</p>\n\n<pre><code>[\"ID,BOATY\",\"Name,McBoatface, Boaty\",\"ID,TRAINY\",\"Name,McTrainface, Trainy\"]\n</code></pre>\n\n<p>This doesn't seem to do anything:</p>\n\n<pre><code>irb&gt; records.collect{|r| r.each{|k,v| \"\\\"#{k},#{v}\\\"\" }}\n#=&gt; [{:ID=&gt;\"BOATY\", :Name=&gt;\"McBoatface, Boaty\"}, {:ID=&gt;\"TRAINY\", :Name=&gt;\"McTrainface, Trainy\"}]\n</code></pre>\n\n<p>** edit **</p>\n\n<p>Formatting (i.e. <code>[\"Key0,Value0\",\"Key1,Value1\",...]</code> is required to match a vendor's interface.</p>\n\n<p>** /edit **</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "dry"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3468846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acS4a.jpg?s=128&g=1", "display_name": "petitkriket", "link": "https://stackoverflow.com/users/3468846/petitkriket"}, "edited": false, "score": 0, "creation_date": 1537818527, "post_id": 52486079, "comment_id": 91914074, "body": "that was fast, thank you ! any reading suggestion regarding arrays ?"}], "tags": [], "owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "is_accepted": true, "score": 4, "last_activity_date": 1537817234, "creation_date": 1537817234, "answer_id": 52486079, "question_id": 52486016, "link": "https://stackoverflow.com/questions/52486016/if-statement-inside-an-array-creation-ruby/52486079#52486079", "title": "if statement inside an array creation ruby", "body": "<p>For instance :</p>\n\n<pre><code>h= {\n  type: 'Feature',\n  geometry: {\n    type: 'Point',\n    coordinates: [event.longitude, event.latitude]\n  },\n  properties: {\n    markerurl: event.photo.marker.url,\n    divclass: marker_class,\n  }\n}\nif has_popup\n  h[:properties][:popupContent]= marker_popup\nend\nmarkers_index &lt;&lt; h\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 778, "user_id": 2125795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7EreQ.jpg?s=128&g=1", "display_name": "Billy Kimble", "link": "https://stackoverflow.com/users/2125795/billy-kimble"}, "is_accepted": false, "score": 0, "last_activity_date": 1537817545, "creation_date": 1537817545, "answer_id": 52486159, "question_id": 52486016, "link": "https://stackoverflow.com/questions/52486016/if-statement-inside-an-array-creation-ruby/52486159#52486159", "title": "if statement inside an array creation ruby", "body": "<p>In addition to doing the if conditional after the Hash creation as someone else mentioned, you can also only populate the value of your hash Key/Val pair if the statement evaluates to true. Then you just test if the value is nil to act/not act on it later on using the ternary operator (condition ? if true : if false): </p>\n\n<pre><code>markers_index = Array.new        \n@events.each_with_index do |event, index|\n...\n\n        markers_index &lt;&lt; {\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: [event.longitude, event.latitude]\n          },\n          properties: {\n            markerurl: event.photo.marker.url,\n            divclass: marker_class,\n            popupContent: has_popup ? marker_popup : nil\n          }\n        }\n    end\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1537858713, "post_id": 52487325, "comment_id": 91925185, "body": "Or <code>g.merge!(popupContent: marker_popup)</code> if you want to keep the hash syntax."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1537822883, "creation_date": 1537822883, "answer_id": 52487325, "question_id": 52486016, "link": "https://stackoverflow.com/questions/52486016/if-statement-inside-an-array-creation-ruby/52487325#52487325", "title": "if statement inside an array creation ruby", "body": "<pre><code>h= {\n  type: 'Feature',\n  geometry: {\n    type: 'Point',\n    coordinates: [event.longitude, event.latitude]\n  },\n  properties: {\n    markerurl: event.photo.marker.url,\n    divclass: marker_class,\n  }.tap { |g| g[:popupContent] = marker_popup if has_popup }\n}\n</code></pre>\n\n<p>See <a href=\"https://ruby-doc.org/core-2.5.1/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a>.</p>\n"}], "owner": {"reputation": 87, "user_id": 3468846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/acS4a.jpg?s=128&g=1", "display_name": "petitkriket", "link": "https://stackoverflow.com/users/3468846/petitkriket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 52486079, "answer_count": 3, "score": -2, "last_activity_date": 1537822883, "creation_date": 1537816966, "question_id": 52486016, "link": "https://stackoverflow.com/questions/52486016/if-statement-inside-an-array-creation-ruby", "title": "if statement inside an array creation ruby", "body": "<p>I am trying to do a if statement inside a array creation</p>\n\n<pre><code>markers_index = Array.new        \n@events.each_with_index do |event, index|\n...\n\n        markers_index &lt;&lt; {\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: [event.longitude, event.latitude]\n          },\n          properties: {\n            markerurl: event.photo.marker.url,\n            divclass: marker_class,\n            if has_popup\n              popupContent: marker_popup\n            end\n          }\n        }\n    end\n</code></pre>\n\n<p>But it throws me a syntax error</p>\n\n<p><b> unexpected ':', expecting keyword_end\n              popupContent: 'marker_popup'</b></p>\n\n<p>Is it a typo or I simply can't do this and need to repeat the whole thing wrapping it in a if else wrapping my marker_index variable ? Trying to stay DRY..  </p>\n"}, {"tags": ["ruby", "methods", "disambiguation"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1537814263, "last_edit_date": 1537814263, "creation_date": 1537813564, "answer_id": 52485270, "question_id": 52485234, "link": "https://stackoverflow.com/questions/52485234/how-to-work-through-name-collisions-in-ruby/52485270#52485270", "title": "How to work through name collisions in ruby", "body": "<p>Only the order of modules inclusion decides which one will get called. Can't have both with the same name - the latter will override the former.</p>\n\n<p>Of course, you can do any tricks, just from the top of my head:</p>\n\n<pre><code>module A\n  def foo\n    :foo_from_A\n  end\nend\n\nmodule B\n  def foo\n    :foo_from_B\n  end\nend\n\nclass C\n  def initialize(from)\n    @from = from\n  end\n\n  def foo\n    from.instance_method(__method__).bind(self).call\n  end\n\n  private\n\n  attr_reader :from\nend\n\nC.new(A).foo #=&gt; :a_from_A\nC.new(B).foo #=&gt; :a_from_B\n</code></pre>\n\n<p>But that's no good for real life use cases :)</p>\n"}, {"tags": [], "owner": {"reputation": 1553, "user_id": 4149820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb809f7e739416524f3c380fe8f4fe45?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4149820/thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1537815902, "last_edit_date": 1537815902, "creation_date": 1537814563, "answer_id": 52485481, "question_id": 52485234, "link": "https://stackoverflow.com/questions/52485234/how-to-work-through-name-collisions-in-ruby/52485481#52485481", "title": "How to work through name collisions in ruby", "body": "<p>Technically, there is no name collision because the method foo is redefined.</p>\n\n<p>In the following exemple, A.foo is redefined and is never called</p>\n\n<pre><code>module A\n  def foo\n    raise \"I'm never called\"\n  end\nend\n\nmodule B\n  def foo\n    puts :foo_from_B\n  end\nend\n\nclass C\n  include A\n  include B\nend\n\nC.new.foo\n# =&gt;\n# foo_from_B\n</code></pre>\n\n<p>If you write A and B module, you can use super to call previous definition of foo. As if it where an inherited method.</p>\n\n<pre><code>module A\n  def foo\n    puts :foo_from_A\n  end\nend\n\nmodule B\n  def foo\n    super\n    puts :foo_from_B\n  end\nend\n\nclass C\n  include A\n  include B\nend\n\nC.new.foo\n# =&gt;\n# foo_from_A\n# foo_from_B\n</code></pre>\n\n<p>There are side effects and I would not use this but this is doing the trick :</p>\n\n<pre><code>module A\n  def foo\n    puts :foo_from_A\n  end\nend\n\nmodule B\n  def foo\n    puts :foo_from_B\n  end\nend\n\n\nclass C\n  def self.include_with_suffix(m, suffix)\n    m.instance_methods.each do |method_name|\n      define_method(\"#{method_name}#{suffix}\", m.instance_method(method_name))\n    end\n  end\n  include_with_suffix A, \"_from_A\"\n  include_with_suffix B, \"_from_B\"\nend\n\nc= C.new\nc.foo_from_A\nc.foo_from_B\nbegin\n  c.foo\nrescue NoMethodError\n  puts \"foo is not defined\"\nend\n# =&gt;\n# foo_from_A\n# foo_from_B\n# foo is not defined\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1537820422, "post_id": 52486755, "comment_id": 91914852, "body": "wow, nice! where can I find the official documentation for alias"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1537890447, "post_id": 52486755, "comment_id": 91944829, "body": "I see all the answers have collected downvotes, suggesting there may be a rogue downvoter in our midst. Asking downvoters to come out of the shadows and explain themselves is futile. The only explanations you will see are those given without your prompting, from members who believe they have a duty to explain why they downvoted."}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "edited": false, "score": 0, "creation_date": 1537961953, "post_id": 52486755, "comment_id": 91973152, "body": "I did downvote this. This code looks like hack: it utilizes <code>include</code> order and nature of <code>alias</code> (btw, you don&#39;t have to use symbols in <code>alias</code>). Though every ruby developer should understand how this code works it seem to complicated and smelly. My suggestion utilizes <code>UnboundMethod</code> with no magic at all.   Relating on included modules order doesnt seem like a smart thing to do."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "edited": false, "score": 0, "creation_date": 1537979441, "post_id": 52486755, "comment_id": 91984228, "body": "@Nondv, I don&#39;t understand your point about the order in which modules are included, as the ordering is arbitrary. Also, I don&#39;t see why the method I proposed is complicated or employs &quot;magic&quot;, as aliasing is a simple concept that is routinely used to avoid naming collisions. I do agree that my code smells, much like freshly-baked bread."}, {"owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1537980248, "post_id": 52486755, "comment_id": 91984644, "body": "if we discriminate against &quot;include order&quot;, then we&#39;re going against the lisp style, which I feel is the shoulder that ruby stands on."}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "edited": false, "score": 0, "creation_date": 1538039176, "post_id": 52486755, "comment_id": 92005773, "body": "@CarySwoveland I don&#39;t agree that aliasing is a simple concept. It basically creates a new method, not &quot;alias&quot;. Every ruby developer should know this but it doesnt make it less magical. I, for one, despise the fact that it is called &quot;aliasing&quot;."}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "edited": false, "score": 0, "creation_date": 1538039413, "post_id": 52486755, "comment_id": 92005923, "body": "@CarySwoveland as for the include order: maybe it&#39;s just me, but I don&#39;t think that one should rely on order at all. One should keep it simple: module just provides methods, you don&#39;t need to dive into details with method lookup and whatsoever. My point here is that I expect any class to include modules at start and not to use something in between. Anyway, I think that the issue signals that something wrong with design in general: I can&#39;t even imagine case, when you include two modules with similar methods."}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "reply_to_user": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "edited": false, "score": 0, "creation_date": 1538039815, "post_id": 52486755, "comment_id": 92006179, "body": "@american-ninja-warrior can you elaborate on lisp style?"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537821874, "last_edit_date": 1537821874, "creation_date": 1537820313, "answer_id": 52486755, "question_id": 52485234, "link": "https://stackoverflow.com/questions/52485234/how-to-work-through-name-collisions-in-ruby/52486755#52486755", "title": "How to work through name collisions in ruby", "body": "<p>Provided none of the methods of <code>Foo</code> or <code>Baa</code> call <code>name</code> (which seems a reasonable assumption), one can simply create aliases.</p>\n\n<pre><code>module Foo\n  def name; \"Foo#name\"; end\nend\n\nmodule Baa\n  def name; \"Baa#name\"; end\nend\n\nclass C\n  include Foo\n  alias :foo_name :name\n  include Baa\n  alias :baa_name :name\n  undef_method :name\nend\n\nc = C.new\nc.foo_name\n  #=&gt; \"Foo#name\"\nc.baa_name\n  #=&gt; \"Baa#name\"\n\nC.instance_methods &amp; [:foo_name, :baa_name, :name]\n  #=&gt; [:foo_name, :baa_name]\n</code></pre>\n\n<p>The keyword <code>alias</code> is documented <a href=\"http://ruby-doc.org/core-2.1.2/doc/syntax/miscellaneous_rdoc.html#label-alias\" rel=\"nofollow noreferrer\">here</a>. One may alternatively use the method <a href=\"http://ruby-doc.org/core-2.5.1/Module.html#method-i-alias_method\" rel=\"nofollow noreferrer\">#alias_method</a>.  See <a href=\"https://blog.bigbinary.com/2012/01/08/alias-vs-alias-method.html\" rel=\"nofollow noreferrer\">this blog</a> for a comparison of the two.</p>\n\n<p><a href=\"https://ruby-doc.org/core-2.2.0/Module.html#method-i-undef_method\" rel=\"nofollow noreferrer\">Module#undef_method</a> is not strictly necessary. It's just to ensure that an exception is raised if <code>name</code> is called.  </p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537980558, "post_id": 52495522, "comment_id": 91984781, "body": "While not my preference, this is an interesting approach, worthy of an upvote. Regarding your last comment, you should make it clear that <code>Foo</code> need not be included only if it contains no methods that are called by <code>name</code>. Also, some readers may think you mean that the method could be expected to work if it is bound to any object, which, of course, is generally not the case, as included methods commonly expect the receiver to be an instance of a particular class."}, {"owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1538039517, "post_id": 52495522, "comment_id": 92005996, "body": "@CarySwoveland it&#39;s not my preference either ;) The whole situation is stupid. One should refactor system, not look for hacks to resolve name collisions."}], "tags": [], "owner": {"reputation": 609, "user_id": 3891844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf945cc749dae8c0d8e397df058acdde?s=128&d=identicon&r=PG", "display_name": "Nondv", "link": "https://stackoverflow.com/users/3891844/nondv"}, "is_accepted": false, "score": 0, "last_activity_date": 1537870213, "last_edit_date": 1537870213, "creation_date": 1537869819, "answer_id": 52495522, "question_id": 52485234, "link": "https://stackoverflow.com/questions/52485234/how-to-work-through-name-collisions-in-ruby/52495522#52495522", "title": "How to work through name collisions in ruby", "body": "<p>You should definetely read about method lookups.</p>\n\n<p>Anyway, I would do it this way:</p>\n\n<pre><code>module Foo\n  def name\n    :foo\n  end\nend\n\nmodule Bar\n  def name\n    :bar\n  end\nend\n\nclass MyClass\n  include Foo\n  include Bar\n\n  def foo_name\n    Foo.instance_method(:name).bind(self).call\n  end\n\n  def bar_name\n    Bar.instance_method(:name).bind(self).call\n  end\n\n  #\n  # or even like this: obj.name(Foo)\n  #\n\n  def name(mod)\n    mod.instance_method(:name).bind(self).call\n  end\nend\n</code></pre>\n\n<p>BTW if you are using <code>Module#instance_method</code> and <code>UnboundMethod#bind</code> you don't really need to include specific module. This code works:</p>\n\n<pre><code>Foo.instance_method(:name).bind('any object (e.g. string)').call\n</code></pre>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 1, "answer_count": 4, "score": 5, "last_activity_date": 1537950660, "creation_date": 1537813371, "last_edit_date": 1537950660, "question_id": 52485234, "link": "https://stackoverflow.com/questions/52485234/how-to-work-through-name-collisions-in-ruby", "title": "How to work through name collisions in ruby", "body": "<p>Two modules <code>Foo</code> and <code>Baa</code> respectively define a method with the same name <code>name</code>, and I did <code>include Foo</code> and <code>include Baa</code> in a particular context.</p>\n\n<p>When I call <code>name</code>, how can I disambiguate whether to call the <code>name</code> method of <code>Foo</code> or <code>Baa</code>?</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 1, "last_activity_date": 1537813318, "creation_date": 1537813318, "answer_id": 52485219, "question_id": 52485175, "link": "https://stackoverflow.com/questions/52485175/how-to-list-defined-methods-of-a-module/52485219#52485219", "title": "How to list defined methods of a module?", "body": "<p>Because it's an instance method, not a method on <code>Foo</code>. You can find it with <code>.instance_methods</code>:</p>\n\n<pre><code>irb(main):002:0&gt; Foo.instance_methods\n=&gt; [:method1]\n</code></pre>\n"}], "owner": {"reputation": 4855, "user_id": 3618156, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b3e1907a7f15ed006abc8ad406cf40fe?s=128&d=identicon&r=PG&f=1", "display_name": "american-ninja-warrior", "link": "https://stackoverflow.com/users/3618156/american-ninja-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "closed_date": 1537813479, "answer_count": 1, "score": 0, "last_activity_date": 1537813318, "creation_date": 1537813080, "last_edit_date": 1537813147, "question_id": 52485175, "link": "https://stackoverflow.com/questions/52485175/how-to-list-defined-methods-of-a-module", "closed_reason": "Duplicate", "title": "How to list defined methods of a module?", "body": "<p>In this example, I'm defining a method.\nMy question is: why isn't my <code>method1</code> listed in the output of the last statement?</p>\n\n<pre><code>irb(main):001:0&gt; module Foo\nirb(main):002:1&gt; def method1\nirb(main):003:2&gt; \"abc\"\nirb(main):004:2&gt; end\nirb(main):005:1&gt; end\n=&gt; :method1\nirb(main):007:0&gt; Foo.methods\n=&gt; [:&lt;=&gt;, :autoload, :autoload?, :&lt;=, :&gt;=, :==, :===, :included_modules, :include?, :name, :ancestors, :attr, :attr_reader, :attr_writer, :attr_accessor, :instance_methods, :public_instance_methods, :protected_instance_methods, :private_instance_methods, :constants, :const_get, :const_set, :const_defined?, :class_variables, :remove_class_variable, :class_variable_get, :class_variable_set, :class_variable_defined?, :public_constant, :freeze, :inspect, :deprecate_constant, :private_constant, :const_missing, :singleton_class?, :prepend, :class_exec, :module_eval, :class_eval, :include, :&lt;, :&gt;, :remove_method, :undef_method, :alias_method, :protected_method_defined?, :module_exec, :method_defined?, :public_method_defined?, :to_s, :define_method, :public_class_method, :private_method_defined?, :private_class_method, :public_instance_method, :instance_method, :instance_variable_set, :instance_variable_defined?, :remove_instance_variable, :instance_of?, :kind_of?, :is_a?, :tap, :instance_variable_get, :public_methods, :instance_variables, :method, :public_method, :define_singleton_method, :singleton_method, :public_send, :extend, :pp, :to_enum, :enum_for, :=~, :!~, :eql?, :respond_to?, :object_id, :send, :display, :nil?, :hash, :class, :singleton_class, :clone, :dup, :yield_self, :itself, :tainted?, :taint, :untrust, :untaint, :trust, :untrusted?, :methods, :frozen?, :singleton_methods, :protected_methods, :private_methods, :!, :equal?, :instance_eval, :instance_exec, :!=, :__id__, :__send__]\nirb(main):008:0&gt;\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 1, "creation_date": 1537836883, "post_id": 52487633, "comment_id": 91919395, "body": "So the outer starts_with targets the first element of array, and the inner starts_with targets the first character of the first element."}, {"owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1537882057, "post_id": 52487633, "comment_id": 91939294, "body": "exactly! I&#39;ll add that to the answer too."}], "tags": [], "owner": {"reputation": 2837, "user_id": 6245337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VoQ5.jpg?s=128&g=1", "display_name": "Ana Mar&#237;a Mart&#237;nez G&#243;mez", "link": "https://stackoverflow.com/users/6245337/ana-mar%c3%ada-mart%c3%adnez-g%c3%b3mez"}, "is_accepted": true, "score": 1, "last_activity_date": 1537882150, "last_edit_date": 1537882150, "creation_date": 1537824521, "answer_id": 52487633, "question_id": 52484742, "link": "https://stackoverflow.com/questions/52484742/composing-matchers-in-rspec/52487633#52487633", "title": "Composing matchers in Rspec", "body": "<p>In your example, you are testing that the first element of <code>fruits</code> starts with the character <code>a</code>. So the outer <code>starts_with</code> targets the first element of array and the inner <code>starts_with</code> targets the beginning of the first element.</p>\n\n<p>Your example passes, but for instance this fails:</p>\n\n<pre><code>fruits = ['banana', 'apple', 'cherry']\nexpect(fruits).to start_with( start_with('a') )\n</code></pre>\n\n<p>There are several examples in the <a href=\"https://github.com/rspec/rspec-expectations/blob/848fcb426cca1977b75909d0cb8a10f03a104b36/spec/rspec/matchers/built_in/start_and_end_with_spec.rb\" rel=\"nofollow noreferrer\">rspec-expectations tests</a> of arrays where you want to test that the first element(s) start or end with a given value or string. For example:</p>\n\n<pre><code>expect([1.01, \"food\", 3]).to start_with(a_value_within(0.2).of(1), a_string_matching(/foo/))\n\nexpect([3, \"food\", 1.1]).to end_with(a_value_within(0.2).of(1))\n</code></pre>\n\n<p>Also related: <a href=\"https://stackoverflow.com/questions/39254886/rspec-starts-with-matcher-variant-using-regular-expressions\">RSpec starts_with matcher variant using regular expressions</a></p>\n"}], "owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 52487633, "answer_count": 1, "score": 1, "last_activity_date": 1537882150, "creation_date": 1537811223, "question_id": 52484742, "link": "https://stackoverflow.com/questions/52484742/composing-matchers-in-rspec", "title": "Composing matchers in Rspec", "body": "<p>Rspec supports composing matchers. The list of composing matchers it provides is this:</p>\n\n<pre><code>all(matcher)\ninclude(matcher, matcher)\nstart_with(matcher)\nend_with(matcher)\ncontain_exactly(matcher, matcher, matcher)\nmatch(matcher)\nchange {}.from(matcher).to(matcher)\nchange {}.by(matcher)\n</code></pre>\n\n<p>The all composing matcher is intuitive. You can pass matchers to the composing matcher and the passed matchers must return true for the expectation to be true:</p>\n\n<pre><code>expect(@items).to all(be_visible &amp; be_in_stock)\n</code></pre>\n\n<p>But I am not certain about the start_with and end_with composing matcher. Look at this example:</p>\n\n<pre><code>fruits = ['apple', 'banana', 'cherry']\nexpect(fruits).to start_with( start_with('a') )\n</code></pre>\n\n<p>What are the outer and inner start_with doing in this example?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 7, "creation_date": 1537804739, "post_id": 52483124, "comment_id": 91907723, "body": "The <code>=</code> should be <code>==</code> for comparison"}], "answers": [{"tags": [], "owner": {"reputation": 1407, "user_id": 3859961, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/625444c465d9823afd183cf8f62efa51?s=128&d=identicon&r=PG&f=1", "display_name": "An Nguyen", "link": "https://stackoverflow.com/users/3859961/an-nguyen"}, "is_accepted": true, "score": 0, "last_activity_date": 1537880493, "creation_date": 1537880493, "answer_id": 52498855, "question_id": 52483124, "link": "https://stackoverflow.com/questions/52483124/what-is-wrong-with-my-if-statement-if-x-y-z/52498855#52498855", "title": "What is wrong with my if statement &#39;if x + y = z&#39;", "body": "<p>As @Pavan said in the comment, your conditional might be wrong. It should be <code>==</code> instead of <code>=</code>. <code>=</code> is the assignment.</p>\n\n<pre><code>if @weight.nominal + x == required ... end\n</code></pre>\n\n<p>Here what happens \"behind the scene\" with your original code: </p>\n\n<ol>\n<li><code>required</code> is assigned to <code>x</code>.</li>\n<li>Add x to <code>@weight.nominal</code>  (<code>@weight.nominal + x</code>)</li>\n<li>Evaluate the result from step 2, which is always true.</li>\n<li>Execute the code within <code>if</code> block, which is <code>weights &lt;&lt; @weight.id</code></li>\n</ol>\n\n<p>Eventually, your <code>x</code>'s value is lost, it will take <code>required</code> value instead and your conditional is useless since it always true.</p>\n"}], "owner": {"reputation": 23, "user_id": 4388950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d40fce9fb047824c081c4864204e83?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Nash", "link": "https://stackoverflow.com/users/4388950/chris-nash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52498855, "answer_count": 1, "score": -5, "last_activity_date": 1537880493, "creation_date": 1537804624, "last_edit_date": 1537861015, "question_id": 52483124, "link": "https://stackoverflow.com/questions/52483124/what-is-wrong-with-my-if-statement-if-x-y-z", "title": "What is wrong with my if statement &#39;if x + y = z&#39;", "body": "<p>I am trying to evaluate if a selected item meats a requirement. I am trying to evaluate the result of <code>nominal + x</code> against <code>required</code>.</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>if @weight.nominal + x = required\n              weights &lt;&lt; @weight.id\nend\n</code></pre>\n\n<p>However, it adds <code>nominal + x</code> together. Why is that, and how do I do what I want?</p>\n"}, {"tags": ["ruby", "date", "dst"], "comments": [{"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537812244, "post_id": 52482963, "comment_id": 91911397, "body": "<i>Date</i> doesn&#39;t include timezone data. Do you mean <i>Time</i> or <i>DateTime</i>? Or do you want to handle this for a default timezone, since dst differs for different countries? Anyway I&#39;d recommend taking a look at <a href=\"https://stackoverflow.com/q/32278565/3982562\"><i>Daylight Saving Time start and end dates in Ruby/Rails</i></a>."}, {"owner": {"reputation": 31, "user_id": 10408562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fdcYHiRPBRM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVmX-eo4YpFLxn9hLhhJoinba3PA/mo/photo.jpg?sz=128", "display_name": "AA.", "link": "https://stackoverflow.com/users/10408562/aa"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537813233, "post_id": 52482963, "comment_id": 91911847, "body": "I am trying to use DateTime, and this needs to be universal as well.."}, {"owner": {"reputation": 31, "user_id": 10408562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fdcYHiRPBRM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVmX-eo4YpFLxn9hLhhJoinba3PA/mo/photo.jpg?sz=128", "display_name": "AA.", "link": "https://stackoverflow.com/users/10408562/aa"}, "reply_to_user": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "edited": false, "score": 0, "creation_date": 1537813314, "post_id": 52482963, "comment_id": 91911876, "body": "basically I need to take the system&#39;s current DateTime, and i need to see if its closer to one daylight savings time than the other. however, DST varies every year which makes it tricky for me."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1537833310, "post_id": 52482963, "comment_id": 91918747, "body": "You need to clarify your question (by editing). See my answer for a suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537833867, "last_edit_date": 1537833867, "creation_date": 1537830348, "answer_id": 52488467, "question_id": 52482963, "link": "https://stackoverflow.com/questions/52482963/ruby-method-that-takes-todays-date-and-if-it-falls-in-between-dst-daylight-savi/52488467#52488467", "title": "Ruby method that takes todays date and if it falls in between DST (daylight savings time) dates, then return the date of that next change", "body": "<p>I have interpreted the question as follows: \"Given a date (possibly today's date), if at no time on that day it is DST, return <code>nil</code>. Otherwise, return the next date (possibly the same date) that begins as DST and ends as non-DST\". </p>\n\n<pre><code>require 'date'\n\ndef next_dst_date_change(base_date)\n  base_date_time = base_date.to_time\n  next_date_time = (base_date+1).to_time\n  if base_date_time.dst? || next_date_time.dst?\n    base_date + 1.step.find { |n| (base_date + n).to_time.dst? == false } - 1\n  end\nend\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/date/rdoc/Date.html#method-i-to_time\" rel=\"nofollow noreferrer\">Date#to_time</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Time.html#method-i-dst-3F\" rel=\"nofollow noreferrer\">Time#dst?</a>, <a href=\"http://ruby-doc.org/core-2.5.1/Numeric.html#method-i-step\" rel=\"nofollow noreferrer\">Numeric#step</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-find\" rel=\"nofollow noreferrer\">Enumerable#find</a>.</p>\n\n<p>Examples</p>\n\n<pre><code>d0 = Date.today\n  #=&gt; #&lt;Date: 2018-09-24 ((2458386j,0s,0n),+0s,2299161j)&gt;\nnext_dst_date_change(d0)\n  #=&gt; #&lt;Date: 2018-11-04 ((2458427j,0s,0n),+0s,2299161j)&gt;\n\nd1 = Date.new(2018, 11, 04)\n  #=&gt; #&lt;Date: 2018-11-04 ((2458427j,0s,0n),+0s,2299161j)&gt;\nnext_dst_date_change(d0)\n  #=&gt; #&lt;Date: 2018-11-04 ((2458427j,0s,0n),+0s,2299161j)&gt;\n\nd2 = d0 + 90\n  #=&gt; #&lt;Date: 2018-12-23 ((2458476j,0s,0n),+0s,2299161j)&gt;\nnext_dst_date_change(d2)\n  #=&gt; nil\n\nd3 = d0 + 365\n  #=&gt; #&lt;Date: 2019-09-24 ((2458751j,0s,0n),+0s,2299161j)&gt;\nnext_dst_date_change(d3)\n  #=&gt; #&lt;Date: 2019-11-03 ((2458791j,0s,0n),+0s,2299161j)&gt;\n\nd4 = Date.new(2018, 3, 10)\n  #=&gt; #&lt;Date: 2018-03-10 ((2458188j,0s,0n),+0s,2299161j)&gt;\nnext_dst_date_change(d4)\n  #=&gt; nil\n\nd5 = Date.new(2018, 3, 11)\nnext_dst_date_change(d5)\n  #=&gt; #&lt;Date: 2018-11-04 ((2458427j,0s,0n),+0s,2299161j)&gt;\n</code></pre>\n\n<p>To speed things up one could do a binary search to determine the next DST-to-non_DST change date, using <a href=\"http://ruby-doc.org/core-2.5.1/Range.html#method-i-bsearch\" rel=\"nofollow noreferrer\">Range#bsearch</a>. I've assumed that DST ends some time before December 1 of each year.</p>\n\n<pre><code>def next_dst_date_change(base_date)\n  base_date_time = base_date.to_time\n  next_date_time = (base_date+1).to_time\n  if base_date_time.dst? || next_date_time.dst?\n    diff = (Date.new(base_date.year, 12, 1) - base_date).to_i\n    base_date + (1..diff).bsearch { |n| !(base_date + n).to_time.dst? } - 1\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10408562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fdcYHiRPBRM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVmX-eo4YpFLxn9hLhhJoinba3PA/mo/photo.jpg?sz=128", "display_name": "AA.", "link": "https://stackoverflow.com/users/10408562/aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537833867, "creation_date": 1537804007, "last_edit_date": 1537807430, "question_id": 52482963, "link": "https://stackoverflow.com/questions/52482963/ruby-method-that-takes-todays-date-and-if-it-falls-in-between-dst-daylight-savi", "title": "Ruby method that takes todays date and if it falls in between DST (daylight savings time) dates, then return the date of that next change", "body": "<p>I am trying to write a method that takes todays date and if the provided date falls in between DST dates for 2018 (DST is true if date is 03/11/18 2:00am and 11/04/18 2:00am), then it would return the date of the next respective DST change. </p>\n\n<p>I actually have no idea how to approach this other than taking the provided date and writing a case statement around it that iterates through the provided date's given year. and each when holds a different year</p>\n\n<pre><code># method to take todays date and if the date falls in between DST dates, \n# then the method will return the date of the next DST change\n\ndef dst_date_change(date)\n    return case \n        when date.include? ='2018'\n            if (date &gt; Time.parse('March 11, 2018 2:00am') &amp;&amp;  (date &lt; Time.parse('November 4, 2018 2:00am'))\n    end\n        when date.include? ='2019'\n            if \n\n    end\n        when date.include? ='2020'\n        if\n    end\n        when date.include? ='2020'\n        if  \n    end\n    else \n</code></pre>\n\n<p>this is what i currently have. clearly unfinished..</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1707, "user_id": 3292174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DNPrX.jpg?s=128&g=1", "display_name": "Michael Malov", "link": "https://stackoverflow.com/users/3292174/michael-malov"}, "edited": false, "score": 0, "creation_date": 1537806719, "post_id": 52482859, "comment_id": 91908776, "body": "can you try <code>bundle update</code> or reinstall rails and then repeat <code>rails new ...</code>?"}, {"owner": {"reputation": 11, "user_id": 8871096, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gwEYfj5VyGQ/AAAAAAAAAAI/AAAAAAAAAg0/stoU2h5sZns/photo.jpg?sz=128", "display_name": "Kizaki Ronggo", "link": "https://stackoverflow.com/users/8871096/kizaki-ronggo"}, "reply_to_user": {"reputation": 1707, "user_id": 3292174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DNPrX.jpg?s=128&g=1", "display_name": "Michael Malov", "link": "https://stackoverflow.com/users/3292174/michael-malov"}, "edited": false, "score": 0, "creation_date": 1537865645, "post_id": 52482859, "comment_id": 91928862, "body": "Okay ,I will try that"}, {"owner": {"reputation": 11, "user_id": 8871096, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gwEYfj5VyGQ/AAAAAAAAAAI/AAAAAAAAAg0/stoU2h5sZns/photo.jpg?sz=128", "display_name": "Kizaki Ronggo", "link": "https://stackoverflow.com/users/8871096/kizaki-ronggo"}, "reply_to_user": {"reputation": 1707, "user_id": 3292174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DNPrX.jpg?s=128&g=1", "display_name": "Michael Malov", "link": "https://stackoverflow.com/users/3292174/michael-malov"}, "edited": false, "score": 0, "creation_date": 1537876006, "post_id": 52482859, "comment_id": 91935160, "body": "that&#39;s  not working for me :("}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10963332, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gNyLVNGXlU8/AAAAAAAAAAI/AAAAAAAAACY/vQNCC0zO0hc/photo.jpg?sz=128", "display_name": "dowpm", "link": "https://stackoverflow.com/users/10963332/dowpm"}, "is_accepted": false, "score": 1, "last_activity_date": 1556295450, "creation_date": 1556295450, "answer_id": 55871491, "question_id": 52482859, "link": "https://stackoverflow.com/questions/52482859/could-not-find-config-databases-mysql-yml-when-make-new-project-rails-with-mys/55871491#55871491", "title": "Could not find &quot;config/databases/mysql.yml&quot; when make new project rails with mysql", "body": "<p>It seem like you've deleted the mysql.yml.tt from the templates folder using a command to delete all MySQL files on your system.<br>\nTo fix it:\n1) create the mysql.yml.tt file in the directory templates/config/databases/</p>\n\n<pre><code>$ touch ~/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/generators/rails/app/templates/config/databases/mysql.yml.tt\n</code></pre>\n\n<p>2) Paste the basic codes from the <a href=\"https://github.com/rails/rails/blob/master/railties/lib/rails/generators/rails/app/templates/config/databases/mysql.yml.tt\" rel=\"nofollow noreferrer\">original file from rails github</a> using vim or opend the file from its source and paste all the codes.</p>\n\n<pre><code>$ vim ~/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/generators/rails/app/templates/config/databases/mysql.yml.tt\n</code></pre>\n\n<p>Now you can remake the project using <code>rails new app-name -d mysql</code></p>\n"}], "owner": {"reputation": 11, "user_id": 8871096, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gwEYfj5VyGQ/AAAAAAAAAAI/AAAAAAAAAg0/stoU2h5sZns/photo.jpg?sz=128", "display_name": "Kizaki Ronggo", "link": "https://stackoverflow.com/users/8871096/kizaki-ronggo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556295450, "creation_date": 1537803613, "last_edit_date": 1537803818, "question_id": 52482859, "link": "https://stackoverflow.com/questions/52482859/could-not-find-config-databases-mysql-yml-when-make-new-project-rails-with-mys", "title": "Could not find &quot;config/databases/mysql.yml&quot; when make new project rails with mysql", "body": "<p>Can someone help me? i got this error when i want to make new project for Ruby on Rails</p>\n\n<pre><code>\u00a0ronggothelast\u00a0\ue0b0\u00a0~\u00a0\ue0b1\u00a0belajar-rails\u00a0\ue0b0\u00a0rails new kodooe -d mysql\n  create  \n  create  README.md\n  create  Rakefile\n  create  .ruby-version\n  create  config.ru\n  create  .gitignore\n  create  Gemfile\n  run  git init from \".\"\n  Initialized empty Git repository in /home/ronggothelast/belajar-rails/kodooe/.git/\n  create  package.json\n  create  app\n  create  app/assets/config/manifest.js\n  create  app/assets/javascripts/application.js\n  create  app/assets/javascripts/cable.js\n  create  app/assets/stylesheets/application.css\n  create  app/channels/application_cable/channel.rb\n  create  app/channels/application_cable/connection.rb\n  create  app/controllers/application_controller.rb\n  create  app/helpers/application_helper.rb\n  create  app/jobs/application_job.rb\n  create  app/mailers/application_mailer.rb\n  create  app/models/application_record.rb\n  create  app/views/layouts/application.html.erb\n  create  app/views/layouts/mailer.html.erb\n  create  app/views/layouts/mailer.text.erb\n  create  app/assets/images/.keep\n  create  app/assets/javascripts/channels\n  create  app/assets/javascripts/channels/.keep\n  create  app/controllers/concerns/.keep\n  create  app/models/concerns/.keep\n  create  bin\n  create  bin/bundle\n  create  bin/rails\n  create  bin/rake\n  create  bin/setup\n  create  bin/update\n  create  bin/yarn\n  create  config\n  create  config/routes.rb\n  create  config/application.rb\n  create  config/environment.rb\n  create  config/cable.yml\n  create  config/puma.rb\n  create  config/spring.rb\n  create  config/storage.yml\n  create  config/environments\n  create  config/environments/development.rb\n  create  config/environments/production.rb\n  create  config/environments/test.rb\n  create  config/initializers\n  create  config/initializers/application_controller_renderer.rb\n  create  config/initializers/assets.rb\n  create  config/initializers/backtrace_silencers.rb\n  create  config/initializers/content_security_policy.rb\n  create  config/initializers/cookies_serializer.rb\n  create  config/initializers/cors.rb\n  create  config/initializers/filter_parameter_logging.rb\n  create  config/initializers/inflections.rb\n  create  config/initializers/mime_types.rb\n  create  config/initializers/new_framework_defaults_5_2.rb\n  create  config/initializers/wrap_parameters.rb\n  create  config/locales\n  create  config/locales/en.yml\n  create  config/master.key\n  append  .gitignore\n  create  config/boot.rb\n</code></pre>\n\n<blockquote>\n  <p>Could not find \"config/databases/mysql.yml\" in any of your source\n  paths. Your current source paths are: \n  /home/ronggothelast/.rbenv/versions/2.5.1/lib/ruby/gems/2.5.0/gems/railties-5.2.1/lib/rails/generators/rails/app/templates</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "rest", "lumen"], "comments": [{"owner": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537803379, "post_id": 52482752, "comment_id": 91906938, "body": "Try <code>params[:Dividendos][]</code> instead of <code>params[:Dividendos]</code>"}, {"owner": {"reputation": 362, "user_id": 7521284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dBvnp.jpg?s=128&g=1", "display_name": "Ulises", "link": "https://stackoverflow.com/users/7521284/ulises"}, "reply_to_user": {"reputation": 32131, "user_id": 2346461, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/i3xAf.jpg?s=128&g=1", "display_name": "Pavan", "link": "https://stackoverflow.com/users/2346461/pavan"}, "edited": false, "score": 0, "creation_date": 1537803497, "post_id": 52482752, "comment_id": 91907014, "body": "That gives <code>wrong number of arguments (given 0, expected 1..2)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 740394, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/796442b522b037319711277a81d775ca?s=128&d=identicon&r=PG", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/740394/rodrigo"}, "is_accepted": true, "score": 1, "last_activity_date": 1537805118, "creation_date": 1537805118, "answer_id": 52483274, "question_id": 52482752, "link": "https://stackoverflow.com/questions/52482752/ruby-on-rails-rest-client-gem-send-array-params-wrong/52483274#52483274", "title": "Ruby on Rails rest-client gem send array params wrong", "body": "<p>The issue is that <code>params[:Dividendos]</code> returns a String. </p>\n\n<p>You should parse it to a hash and then, <code>RestClient</code> will parse it again to a JSON</p>\n\n<pre><code>Dividendos: JSON.parse(params[:Dividendos])\n</code></pre>\n"}], "owner": {"reputation": 362, "user_id": 7521284, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dBvnp.jpg?s=128&g=1", "display_name": "Ulises", "link": "https://stackoverflow.com/users/7521284/ulises"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 52483274, "answer_count": 1, "score": 0, "last_activity_date": 1537805118, "creation_date": 1537803203, "question_id": 52482752, "link": "https://stackoverflow.com/questions/52482752/ruby-on-rails-rest-client-gem-send-array-params-wrong", "title": "Ruby on Rails rest-client gem send array params wrong", "body": "<p>We have a form that will catch an X amount of inputs so we used arrays for setting up the info.</p>\n\n<p>When we print the params looks like:</p>\n\n<pre><code>{\n  \"utf8\" =&gt; \"\u2713\", \"authenticity_token\" =&gt; \"DfpQDLOJBuc7ViR3XfY3iaK3/E9Hy9uQBWF8fwSkig0nchqj62DptkGunHOrH5bd79J0L+kG0P758cDqLJx7PQ==\", \"user\" =&gt; \"1\", \"Base\" =&gt; {\n    \"cliente\" =&gt; \"1\", \"retencion\" =&gt; \"14\", \"anio\" =&gt; \"2018\", \"mes_inicio\" =&gt; \"9\", \"mes_fin\" =&gt; \"9\", \"serie\" =&gt; \"1\", \"nacionalidad\" =&gt; \"Nacional\", \"montoTotOperacion\" =&gt; \"11111.1\", \"montoTotGrav\" =&gt; \"11111.1\", \"montoTotExent\" =&gt; \"0.0\", \"montoTotRet\" =&gt; \"1111.1\"\n  }, \"Dividendos\" =&gt; [{\n    \"CveTipDivOUtil\" =&gt; \"01\",\n    \"MontISRAcredRetMexico\" =&gt; \"0.0\",\n    \"MontISRAcredRetExtranjero\" =&gt; \"0.0\",\n    \"MontRetExtDivExt\" =&gt; \"0.0\",\n    \"TipoSocDistrDiv\" =&gt; \"Sociedad Nacional\",\n    \"MontISRAcredNal\" =&gt; \"0.0\",\n    \"MontDivAcumNal\" =&gt; \"0.0\",\n    \"MontDivAcumExt\" =&gt; \"0.0\"\n  }]\n}\n</code></pre>\n\n<p>As you see the object \"Dividendos\" can be mutiple arrays, so we send the data to our API (Laravel Lumen).</p>\n\n<pre><code>    response = RestClient.post ENV[\"URL_API\"]+'/createCFDI', { user: current_user.id, Dividendos: params[:Dividendos] }, {content_type: :json, accept: :json}\n</code></pre>\n\n<p>The main problem is that Rails send the reponse array of \"Dividendos\" like string.</p>\n\n<pre><code>array(2) {\n  [\"user\"]=&gt;\n  string(1) \"1\"\n  [\"Dividendos\"]=&gt;\n  array(1) {\n    [0]=&gt;\n    string(235) \"{\"CveTipDivOUtil\"=&gt;\"01\", \"MontISRAcredRetMexico\"=&gt;\"0.0\", \"MontISRAcredRetExtranjero\"=&gt;\"0.0\", \"MontRetExtDivExt\"=&gt;\"0.0\", \"TipoSocDistrDiv\"=&gt;\"Sociedad Nacional\", \"MontISRAcredNal\"=&gt;\"0.0\", \"MontDivAcumNal\"=&gt;\"0.0\", \"MontDivAcumExt\"=&gt;\"0.0\"}\"\n  }\n}\n</code></pre>\n\n<p>Why all the data is ok, but only on nested array send it like string?</p>\n\n<p>Are we missing something?</p>\n"}, {"tags": ["ruby", "ecb"], "answers": [{"tags": [], "owner": {"reputation": 4707, "user_id": 1638209, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a598cbb1fbc79db7b06dc848a9a30a28?s=128&d=identicon&r=PG", "display_name": "Brett", "link": "https://stackoverflow.com/users/1638209/brett"}, "is_accepted": true, "score": 1, "last_activity_date": 1537800297, "creation_date": 1537800297, "answer_id": 52481884, "question_id": 52481883, "link": "https://stackoverflow.com/questions/52481883/how-to-port-des-ecb-encryption-from-python-to-ruby/52481884#52481884", "title": "How to port DES ECB encryption from Python to Ruby", "body": "<p>After spending a bit of time trying some variations while I was posting the question, I figured out the solution. Posting here for reference if it helps anyone - the cipher should have been <code>DES-EDE3</code> and padding set to 1, with a newline trim.</p>\n\n<pre><code>require \"base64\"\nrequire \"openssl\"\nsalt = 'HeresATwentyFourDigtSalt'\ndata = 'thing to encrypt'\ncipher = OpenSSL::Cipher::Cipher.new('DES-EDE3')\ncipher.encrypt\ncipher.padding=0\ncipher.key = salt\nencrypted = cipher.update(data)\nencrypted_final = encrypted + cipher.final\nBase64.encode64(encrypted_final).gsub(/\\n/, \"\")\n'b4SlfbPj6BzFJ2djzu/DTbtmeZ6erKP8'\n</code></pre>\n"}], "owner": {"reputation": 4707, "user_id": 1638209, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a598cbb1fbc79db7b06dc848a9a30a28?s=128&d=identicon&r=PG", "display_name": "Brett", "link": "https://stackoverflow.com/users/1638209/brett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 52481884, "answer_count": 1, "score": 0, "last_activity_date": 1537800297, "creation_date": 1537800297, "question_id": 52481883, "link": "https://stackoverflow.com/questions/52481883/how-to-port-des-ecb-encryption-from-python-to-ruby", "title": "How to port DES ECB encryption from Python to Ruby", "body": "<p>I am trying to rewrite an encryption function from python to ruby, but not getting the same result. I know des ecb is insecure and not recommended, but is needed for the purpose of this porting from python and ruby.</p>\n\n<p>Using <code>pyDes</code> in python, I have the following:</p>\n\n<pre><code>import pyDes\nsalt = 'HeresATwentyFourDigtSalt'\ndata = 'thing to encrypt'\ncipher = pyDes.triple_des(salt, pyDes.ECB, pad=None, padmode=pyDes.PAD_PKCS5)\nencrypted = cipher.encrypt(data)\nbase64.b64encode(encrypted)\n'b4SlfbPj6BzFJ2djzu/DTbtmeZ6erKP8'\n</code></pre>\n\n<p>Now I want to get to the same cipher text with ruby:</p>\n\n<pre><code>require \"base64\"\nrequire \"openssl\"\nsalt = 'HeresATwentyFourDigtSalt'\ndata = 'thing to encrypt'\ncipher = OpenSSL::Cipher::Cipher.new('DES-ECB')\ncipher.encrypt\ncipher.padding=0\ncipher.key = salt\nencrypted = cipher.update(data)\nencrypted_final = encrypted + cipher.final\nBase64.encode64(encrypted_final)\n\"pfHDx7yTWZ4vh8+AqiklPrNb+VHhcCyA\\n\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "testing", "rails-activerecord"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1537799475, "post_id": 52481196, "comment_id": 91904600, "body": "I would argue that you are only using Rails&#39; methods and therefore should not test them. Especially because none of the methods actually fixes or avoids the exception. <code>in_batches</code> only makes the exception less likely to occur."}, {"owner": {"reputation": 576, "user_id": 5090145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ctnxy.jpg?s=128&g=1", "display_name": "Timur Nugmanov", "link": "https://stackoverflow.com/users/5090145/timur-nugmanov"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1537801286, "post_id": 52481196, "comment_id": 91905767, "body": "Fair enough. Yet it is a bad practice not to cover production bugs with tests. Now I view testing it as making one fat test (which runs only after all other tests succeed) which mimics the production bug in sense of data size (and during CI should ideally be run on machine that has similar characteristics to the prod machine), if that is possible."}], "answers": [{"tags": [], "owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "is_accepted": true, "score": 1, "last_activity_date": 1537818121, "creation_date": 1537818121, "answer_id": 52486288, "question_id": 52481196, "link": "https://stackoverflow.com/questions/52481196/how-to-test-pgquerycanceled-due-to-timeout-error-in-a-rails-app/52486288#52486288", "title": "How to test PG::QueryCanceled (due to timeout) error in a Rails app?", "body": "<p>This is not an edge case that I would test for because it requires building and running a query that exceeds your database's built-in timeouts; the minimum runtime for this single test would be at least that time.</p>\n\n<p>Even then, you may write a test for this that passes 100% of the time in your <code>test</code> environment but fails 100% of the time in <code>production</code> because of differences between the two environments that you can never fully replicate; for one, your test database is being used by a single concurrent user while your production database will have multiple concurrent users, different available resources, and different active locks. This isn't the type of issue that you write a test for because the test won't ensure it doesn't happen in production. Best practices will do that.</p>\n\n<p>I recommend that you <a href=\"https://makandracards.com/makandra/1181-use-find_in_batches-or-find_each-to-deal-with-many-records-efficiently\" rel=\"nofollow noreferrer\">follow the best practices for Rails</a> by using the <code>find_in_batches</code> or <code>find_each</code> methods with the expectation that the database server can successfully act on batches of 1000 records at a time:</p>\n\n<pre><code>Contact.where(id: contact_ids_to_delete).find_in_batches do |contacts|\n  contacts.delete_all\nend\n</code></pre>\n\n<p>Or if you prefer:</p>\n\n<pre><code>Contact.where(id: contact_ids_to_delete).find_in_batches(&amp;:delete_all)\n</code></pre>\n\n<p>You can tweak the batch size with <code>batch_size</code> if you're paranoid about your production database server not being able to act on 1000 records at a time:</p>\n\n<pre><code>Contact.where(id: contact_ids_to_delete).find_in_batches(batch_size: 500) { |contacts| contacts.delete_all }\n</code></pre>\n"}], "owner": {"reputation": 576, "user_id": 5090145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ctnxy.jpg?s=128&g=1", "display_name": "Timur Nugmanov", "link": "https://stackoverflow.com/users/5090145/timur-nugmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 52486288, "answer_count": 1, "score": 0, "last_activity_date": 1537818121, "creation_date": 1537798037, "question_id": 52481196, "link": "https://stackoverflow.com/questions/52481196/how-to-test-pgquerycanceled-due-to-timeout-error-in-a-rails-app", "title": "How to test PG::QueryCanceled (due to timeout) error in a Rails app?", "body": "<p>On production server I got this error</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PG::QueryCanceled: ERROR: canceling statement due to statement timeout &lt;SQL query here&gt;\n</code></pre>\n\n<p>In this line:</p>\n\n<pre><code>Contact.where(id: contact_ids_to_delete).delete_all\n</code></pre>\n\n<p>SQL query was DELETE command with a huge list of ids. It timed out.\nI came up with a solution which is to delete Contacts in batches:</p>\n\n<pre><code>Contact.where(id: contact_ids_to_delete).in_batches.delete_all\n</code></pre>\n\n<p>The question is, how do I test my solution? Or what is the common way to test it? Or is there any gem that would make testing it convenient?\n<br>\nI see two possible ways to test it:\n<br>\n1. (Dynamically) set the timeout in test database to a small amount of seconds and create a test in which I generate a lot of Contacts and then try to run my code to delete them.\n<br>\nIt seems to be the right way to do it, but it could potentially slow down the tests execution, and setting the timeout dynamically (which would be the ideal way to do it) could be tricky.\n<br>\n2. Test that deletions are in batches. \n<br>\nIt could be tricky, because this way I would have to monitor the queries.</p>\n"}, {"tags": ["c++", "ruby", "googletest"], "answers": [{"comments": [{"owner": {"reputation": 480, "user_id": 6948160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129c8f620f47a08105f596962677b4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gojita", "link": "https://stackoverflow.com/users/6948160/gojita"}, "edited": false, "score": 0, "creation_date": 1539959095, "post_id": 52880550, "comment_id": 92701354, "body": "Ok ... seems to work. But valgrind complains a lot about lost records. I do not have so much lost record with ruby_finalize. thank you very much"}], "tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": true, "score": 1, "last_activity_date": 1540149145, "last_edit_date": 1540149145, "creation_date": 1539888129, "answer_id": 52880550, "question_id": 52479938, "link": "https://stackoverflow.com/questions/52479938/calling-ruby-init-and-ruby-finalize-multiple-times/52880550#52880550", "title": "Calling ruby_init and ruby_finalize multiple times", "body": "<p>Have you tried <code>ruby_cleanup(0)</code> instead?</p>\n\n<p>Looking at the <a href=\"https://github.com/ruby/ruby/blob/5b72097225797dfb91d4e3cbd4983bedf0eadb26/eval.c#L163\" rel=\"nofollow noreferrer\">source</a>, it looks like <code>ruby_finalize</code> just makes sure that the Ruby code finishes up (e.g. calling <code>at_exit</code> hooks, maybe killing any Ruby threads). Whereas <code>ruby_cleanup</code> calls finalize and then cleans up the VM itself.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Based on my tests, this answer doesn't work (despite being accepted). You cannot restart the Ruby VM within the same process. The only workaround I could think of was to start the VM in a fork so that you can guarantee it gets completely cleaned up.</p>\n"}], "owner": {"reputation": 480, "user_id": 6948160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129c8f620f47a08105f596962677b4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gojita", "link": "https://stackoverflow.com/users/6948160/gojita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 52880550, "answer_count": 1, "score": 2, "last_activity_date": 1540149145, "creation_date": 1537793636, "last_edit_date": 1537807957, "question_id": 52479938, "link": "https://stackoverflow.com/questions/52479938/calling-ruby-init-and-ruby-finalize-multiple-times", "title": "Calling ruby_init and ruby_finalize multiple times", "body": "<p>I'm currently trying to test some Ruby (2.3) C API with google test.</p>\n\n<p>But my tests are crashing because I've created a fixture that calls <code>ruby_init</code> on setup and <code>ruby_finalize</code> on tear down.</p>\n\n<p>I've then created a \"singleton\" inside the fixture which solves the problem, but I would like to know if there's another, simpler, way to do it.</p>\n\n<p>I would like all my tests to run in a proper/clean VM.</p>\n\n<p>Following is a simple example that reproduces the error:</p>\n\n<pre><code>#include &lt;ruby.h&gt;\n\nint\nmain()\n{\n  ruby_init();\n  ruby_finalize();\n\n  ruby_init();\n  ruby_finalize();\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Program terminated with signal SIGABRT, Aborted.\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51  ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n[Current thread is 1 (Thread 0x7fa7f769a040 (LWP 6525))]\n(gdb) bt\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007fa7f6305c5d in __GI_abort () at abort.c:90\n#2  0x00007fa7f634aaad in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7fa7f645957b \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:181\n#3  0x00007fa7f6352298 in malloc_printerr (str=str@entry=0x7fa7f645ae88 \"double free or corruption (!prev)\") at malloc.c:5368\n#4  0x00007fa7f635358c in _int_free (av=0x7fa7f668dc40 &lt;main_arena&gt;, p=0x7fa7f8023b50, have_lock=&lt;optimized out&gt;) at malloc.c:4288\n#5  0x00007fa7f7092a8d in objspace_xfree (objspace=0x7fa7f7fb3d20, ptr=0x7fa7f8023b60, old_size=&lt;optimized out&gt;) at gc.c:7720\n#6  0x00007fa7f70a514f in rb_io_fptr_finalize (fptr=0x7fa7f8023b60) at io.c:4338\n#7  0x00007fa7f70897b1 in run_final (objspace=0x7fa7f7fb3d20, zombie=140359397235560) at gc.c:2691\n#8  finalize_list (objspace=objspace@entry=0x7fa7f7fb3d20, zombie=140359397235560) at gc.c:2707\n#9  0x00007fa7f7089870 in finalize_deferred (objspace=objspace@entry=0x7fa7f7fb3d20) at gc.c:2728\n#10 0x00007fa7f7094280 in rb_objspace_call_finalizer (objspace=0x7fa7f7fb3d20) at gc.c:2794\n#11 rb_gc_call_finalizer_at_exit () at gc.c:2780\n#12 0x00007fa7f76b97e2 in main ()\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1537792439, "post_id": 52479419, "comment_id": 91899980, "body": "There is an unterminated string literal in your code. Once you fix that, it should work fine. It should only add single backslashes. At least, it does for me. Can you post the <i>exact</i> output you are getting?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1537794862, "post_id": 52479419, "comment_id": 91901623, "body": "-3 points for misinterpreting a string.. nothing like some SO love on a Monday morning"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 3, "last_activity_date": 1537792400, "creation_date": 1537792400, "answer_id": 52479528, "question_id": 52479419, "link": "https://stackoverflow.com/questions/52479419/replace-each-occurance-of-forward-slash-in-ruby-string/52479528#52479528", "title": "Replace each occurance of forward slash in ruby string", "body": "<blockquote>\n  <p>what am I doing wrong?</p>\n</blockquote>\n\n<p>Misinterpreting what you see. There are no \"double backslashes\" in the string. That's how single backslashes are displayed (in IRB and other places that use <code>#inspect</code> for displaying things)</p>\n\n<p>Try this instead (puts will not additionally escape backslashes or other chars)</p>\n\n<pre><code> puts string.gsub('/', '\\/')\n</code></pre>\n"}], "owner": {"reputation": 2896, "user_id": 3361028, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b53a63319b061edb80dc910c10cfbfd1?s=128&d=identicon&r=PG&f=1", "display_name": "hY8vVpf3tyR57Xib", "link": "https://stackoverflow.com/users/3361028/hy8vvpf3tyr57xib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 52479528, "answer_count": 1, "score": -2, "last_activity_date": 1537792400, "creation_date": 1537792061, "question_id": 52479419, "link": "https://stackoverflow.com/questions/52479419/replace-each-occurance-of-forward-slash-in-ruby-string", "title": "Replace each occurance of forward slash in ruby string", "body": "<p>I have a string that has the following structure:</p>\n\n<p><code>/base/6/value/6/start</code></p>\n\n<p>I want to escape each forward slash with a backward slash, to receive the following:</p>\n\n<p><code>\\/base\\/6\\/value\\/6\\/start</code></p>\n\n<p>I expected this to work with <code>string.gsub('/', '\\/)</code>, but that adds double backslashes, what am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537790840, "post_id": 52478950, "comment_id": 91898986, "body": "check the class of Sophead.ods"}, {"owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "reply_to_user": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537791235, "post_id": 52478950, "comment_id": 91899205, "body": "Sophead.ods.class = Od::ActiveRecord_Associations_CollectionProxy"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537791943, "post_id": 52478950, "comment_id": 91899650, "body": "keep binding.pry and check what data is comming in sophead.ods and check sophead.ods.first"}, {"owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "reply_to_user": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537795402, "post_id": 52478950, "comment_id": 91902011, "body": "@SumanthMadishetty pry(#&lt;RSpec::ExampleGroups::Sophead::IssueFlag&gt;)&gt; sophead.ods =&gt; []      pry(#&lt;RSpec::ExampleGroups::Sophead::IssueFlag&gt;)&gt; sophead.ods.first =&gt; nil        pry(#&lt;RSpec::ExampleGroups::Sophead::IssueFlag&gt;)&gt; sophead.ods.count =&gt; 1 pry(#&lt;RSpec::ExampleGroups::Sophead::IssueFlag&gt;)&gt; od.sophead.id =&gt; 3000"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537795638, "post_id": 52478950, "comment_id": 91902173, "body": "You are getting an empty array in the object sophead.ods so please check the data of sopheads and check if valid data is comming or not and also try to inlcude the factory file in your question"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537795967, "post_id": 52478950, "comment_id": 91902375, "body": "and try to add reload! after the update line in case if the instance is not getting updated with  new values.. to check check the data of od and sophead before and after update"}, {"owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "reply_to_user": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537797071, "post_id": 52478950, "comment_id": 91903129, "body": "@SumanthMadishetty I have updated my question to show the 2 factories.  reload! after update does not make any difference.  FactoryGirl.create(:od) and FactoryGirl.create(:sophead) both create valid objects."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537798390, "post_id": 52478950, "comment_id": 91903944, "body": "It is sophead you&#39;re reloading, right?  Just before the <code>puts</code> you should try <code>sophead.reload</code>"}, {"owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "reply_to_user": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537798541, "post_id": 52478950, "comment_id": 91904037, "body": "@SteveTurczyn - Thanks!  That fixes it, but why is that needed and is there any way to do this automatically?"}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537799833, "post_id": 52478950, "comment_id": 91904839, "body": "Yes, it&#39;s the way you assigned the &#39;od&#39;  Doing <code>od.update!(sophead_id: sophead.id)</code> rails doesn&#39;t actually know that the relationship has changed so it doesn&#39;t reload the relationship.  Had you done <code>sophead.ods &lt;&lt; od</code> it would&#39;ve assigned the id for you AND it would&#39;ve updated the sophead relationship."}, {"owner": {"reputation": 32451, "user_id": 2516474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2179a340c0e84edc285d432211145d?s=128&d=identicon&r=PG", "display_name": "SteveTurczyn", "link": "https://stackoverflow.com/users/2516474/steveturczyn"}, "edited": false, "score": 0, "creation_date": 1537799953, "post_id": 52478950, "comment_id": 91904919, "body": "... it&#39;s generally better to let rails do the foreign key assignments.  Someday if the relationship between <code>od</code> and <code>sophead</code> changes (maybe you implement a <code>join</code> table, for example) the <code>&lt;&lt;</code> code continues to work, whereas your code would fail."}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "is_accepted": false, "score": 0, "last_activity_date": 1537801746, "creation_date": 1537801746, "answer_id": 52482334, "question_id": 52478950, "link": "https://stackoverflow.com/questions/52478950/confusion-over-rspec-association/52482334#52482334", "title": "confusion over Rspec association", "body": "<p>Big thanks to @SteveTurczyn for getting to the bottom of this.  As he says, instead of updating the parent_id on the child object using:</p>\n\n<p><code>od.update!(sophead_id: sophead.id)</code> </p>\n\n<p>associate the child object with the parent</p>\n\n<p><code>sophead.ods &lt;&lt; od</code></p>\n\n<p>so that rails knows the relationship has changed.</p>\n"}], "owner": {"reputation": 197, "user_id": 9446541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca77ea568f4a9f3a32d5ad3848d8dc85?s=128&d=identicon&r=PG&f=1", "display_name": "daveanderson88", "link": "https://stackoverflow.com/users/9446541/daveanderson88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537801746, "creation_date": 1537790426, "last_edit_date": 1537796884, "question_id": 52478950, "link": "https://stackoverflow.com/questions/52478950/confusion-over-rspec-association", "title": "confusion over Rspec association", "body": "<p>I am new to Rspec, but have got stuck on something thats probably fairly basic.  </p>\n\n<p>In one of my specs, i have the following (condensed):</p>\n\n<pre><code>require 'rails_helper'\n\nRSpec.describe Sophead, type: :model do\n  let(:sophead) { FactoryGirl.create(:sophead) }\n  let(:od) { FactoryGirl.create(:od) }\n  let(:active_od_issue) { FactoryGirl.create(:od_issue, active:true)}\n  describe \"#issue_flag?\"  do\n    it \"should return true if there is an active od issue\" do\n      od.update!(sophead_id: sophead.id)\n      active_od_issue.update!(od_id:od.id)\n      puts \"sophead.id = #{sophead.id}\"\n      puts \"od.id = #{od.id}\"\n      puts \"od.sophead.id = #{od.sophead.id}\"\n      puts \"Sophead.ods.count = #{sophead.ods.count}\"\n      puts \"Sophead.ods.first.id = #{sophead.ods.first.id}\"\n      expect(sophead.issue_flag?).to be true\n    end\n  end\nend\n</code></pre>\n\n<p>Sophead has many ods</p>\n\n<p>Running the spec fails and prints the following:</p>\n\n<pre><code>    Sophead\n  #issue_flag?\nsophead.id = 2882\nod.id = 1344\nod.sophead.id = 2882\nSophead.ods.count = 1\n    should return true if there is an active od issue (FAILED - 1)\n\nFailures:\n\n  1) Sophead#issue_flag? should return true if there is an active od issue\n     Failure/Error: puts \"Sophead.ods.first.id = #{sophead.ods.first.id}\"\n\n     NoMethodError:\n       undefined method `id' for nil:NilClass\n     # ./spec/models/untitled_spec.rb:17:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 2.34 seconds (files took 5.95 seconds to load)\n1 example, 1 failure\n</code></pre>\n\n<p>I don't understand how Sophead.ods.count = 1 but Sophead.ods.first is nil\nHow can this be?</p>\n\n<p>Factory for Od:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :od do\n    created_at \"2018-09-19 11:58:58\"\n    updated_at \"2018-09-19 11:58:58\"\n    status \"Open\"\n    number_packages nil\n    number_loose_lengths nil\n    packed false\n    picker_id nil\n    packer_id nil\n    picked false\n    pick_list false\n    label_type \"Own van\"\n    tracking_number nil\n    courier_latest_status nil\n    priority 4\n    packed_weight nil\n    on_hold false\n    photo nil\n    pod nil\n    picked_at nil\n    packed_at nil\n    despatched_at nil\n    issue_flag false\n    pod_byte_array nil\n    photo_byte_array nil\n    delivered false\n    despatched false\n    pick_started_at nil\n    pack_started_at nil\n    number_labels nil\n    last_latitude 51.516185\n    last_longitude 0.101993\n    drop_number 0\n    eta nil\n    run_id 54\n    direct false\n    due_by \"2018-09-19 13:00:00\"\n    delivery_failed false\n    printing false\n    oversize false\n    trackpod false\n    sales_order \"312790\"\n    inv_name \"A. Company &amp; Sons\"\n    del_postcode \"NW6 2HL\"\n    route\n    run\n    sophead\n  end\nend\n</code></pre>\n\n<p>Factory for Sophead:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :sophead do\n    sysuser\n    sales_order \"1234567\"\n    carriage 10.52\n    contactname \"John Smith\"\n    date_amended Date.today\n    del_add1 \"Parkhall Trading Estate\"\n    del_add2 \"40 Martel Road\"\n    del_city \"London\"\n    del_country \"UK\"\n    del_county \"London\"\n    del_name \"Jim Smith\"\n    del_postcode \"SE21 8EN\"\n    delivery_notes \"this is a delivery note\"\n    due_date Date.tomorrow\n    flag_status 2\n    salesman 17\n    order_date Date.yesterday\n    order_notes \"this is an order note\"\n    order_type \"O\"\n    order_value 50.92\n    user_created 33\n    flag_delete 0\n    cost 20.50\n    area 51\n    # issue_flag false\n    issue_desc nil\n  end\nend\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "rspec"], "comments": [{"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1537789128, "post_id": 52478442, "comment_id": 91898005, "body": "Take a look to <a href=\"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers/type-matchers\" rel=\"nofollow noreferrer\"><code>RSpec Type Matchers</code></a>, it might help you for checking the &quot;kind of object&quot;."}, {"owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "reply_to_user": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1537789515, "post_id": 52478442, "comment_id": 91898195, "body": "Thank you..Will look into it @SebastianPalma"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "edited": false, "score": 1, "creation_date": 1537789715, "post_id": 52478679, "comment_id": 91898330, "body": "this is the error I faced.NameError:        undefined local variable or method `num&#39; for #&lt;RSpec::ExampleGroups::RubyOperations::Operations::Input::W&zwnj;&#8203;henNumberIsPro vided:0x0000000003844038&gt;"}, {"owner": {"reputation": 28612, "user_id": 5025116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7WdYi.jpg?s=128&g=1", "display_name": "Sebastian Palma", "link": "https://stackoverflow.com/users/5025116/sebastian-palma"}, "edited": false, "score": 0, "creation_date": 1537789959, "post_id": 52478679, "comment_id": 91898464, "body": "Have you defined num before in your spec file?"}, {"owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "edited": false, "score": 0, "creation_date": 1537790030, "post_id": 52478679, "comment_id": 91898514, "body": "You need to declare the num variable before you pass it as an argument. Please declare the num or pass an hard coded value to that method"}], "tags": [], "owner": {"reputation": 2034, "user_id": 9897223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O1Nan.png?s=128&g=1", "display_name": "Sumanth Madishetty", "link": "https://stackoverflow.com/users/9897223/sumanth-madishetty"}, "is_accepted": false, "score": 1, "last_activity_date": 1537790616, "last_edit_date": 1537790616, "creation_date": 1537789517, "answer_id": 52478679, "question_id": 52478442, "link": "https://stackoverflow.com/questions/52478442/rspec-for-checking-of-a-number/52478679#52478679", "title": "Rspec for checking of a number", "body": "<p>You can check the class of the output of the method to equal integer</p>\n\n<pre><code>require 'ruby_final_operations'\n  describe 'RubyOperations' do\n    describe 'Operations' do\n      describe '.input' do\n        context 'when number is provided' do\n          it 'returns the number provided' do\n            expect(RubyOperations.input(num).class).to eq(Integer)\n            (or)\n            expect(RubyOperations.input(num)).to be_a_kind_of(Integer) \n          end\n         end\n        end\n       end\n      end\n</code></pre>\n\n<p>And whenever you write rspec keep in mind </p>\n\n<p>If the method for which you are writing rspec deals with manipulations in your db then check if db is manipulated or not</p>\n\n<p>Or if you are writing rspec for any methods which returns an object then procced like this</p>\n\n<p>if a method is defined like</p>\n\n<pre><code>def square_of_a_number(num)\n num*num\nend\n</code></pre>\n\n<p>Then write rspec like this</p>\n\n<pre><code>it 'returns square of a number' do\n  expect(square_of_a_number(2).to eq(4)   \nend\n</code></pre>\n\n<p>For any methods that you know the output of a method will be that then hardcode the input or user Faker gem for input of the method expect the expected result of that method</p>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 10348112, "user_type": "registered", "profile_image": "https://graph.facebook.com/1071989306289951/picture?type=large", "display_name": "teckden", "link": "https://stackoverflow.com/users/10348112/teckden"}, "is_accepted": true, "score": 0, "last_activity_date": 1537790834, "creation_date": 1537790834, "answer_id": 52479077, "question_id": 52478442, "link": "https://stackoverflow.com/questions/52478442/rspec-for-checking-of-a-number/52479077#52479077", "title": "Rspec for checking of a number", "body": "<p>There are few issues with code that you have shared:</p>\n\n<p>1) In the <code>Operations</code> class, the method <code>input</code> receives an argument which is not used anywhere because of this line: <code>num = Integer(gets.chomp)</code>. Basically <code>gets</code> is the method that waits for user input, and the assignment <code>num = ...</code> overrides the value of argument (<code>num</code>) that is passed into the method, hence it is pointless to pass <code>num</code> argument into the method.</p>\n\n<p>2) In your spec sample you call <code>input</code> method on <code>RubyOperations</code> module, while the <code>input</code> lives in class <code>Operations</code> under namespace <code>RubyOperations</code>. Also method <code>input</code> is not a class method but instance method. So proper method call would be: <code>RubyOperations::Operations.new.input(5)</code></p>\n\n<p>3) To run a spec for <code>input</code> method you would need to stub user input. RSpec-mocks gem can help you with that - <a href=\"https://github.com/rspec/rspec-mocks\" rel=\"nofollow noreferrer\">https://github.com/rspec/rspec-mocks</a>. It has <code>allow</code> stub method: <code>allow(object).to receive(:gets) { \"5\" }</code></p>\n\n<p>The whole sample will be:</p>\n\n<pre><code>it 'returns the number provided' do\n  # instantiate object that we will test\n  subject = RubyOperations::Operations.new\n\n  # we stub method 'gets' and whenever it is called we return string \"5\"\n  allow(subject).to receive(:gets) { \"5\" } \n\n  # we call method input with argument 1, the argument 1 is pointless as described in point 1) and can be omitted\n  expect(subject.input(1)).to eq(5)\nend\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9088469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f878be15c6628f2ebc6936ba56ae82?s=128&d=identicon&r=PG&f=1", "display_name": "Shan_Boy", "link": "https://stackoverflow.com/users/9088469/shan-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "accepted_answer_id": 52479077, "answer_count": 2, "score": 0, "last_activity_date": 1537790834, "creation_date": 1537788780, "last_edit_date": 1537790263, "question_id": 52478442, "link": "https://stackoverflow.com/questions/52478442/rspec-for-checking-of-a-number", "title": "Rspec for checking of a number", "body": "<p>I am a ruby newbie, I have managed to pull out the code for ruby but writing rspecs for them seems problematic. It's hard to understand the way to write rspecs even after reading few tutorials. Someone please help me to write for an input method then I would try to refactor it for the rest.</p>\n\n<p>RB file:</p>\n\n<pre><code>module RubyOperations\n  class Operations\n    def input(num)\n      RubyOperations.log('Enter a number:[Between 1 to 10]',:BOTH)\n      num = Integer(gets.chomp)\n      raise StandardError if num &lt;= 0 || num &gt; 10\n      return num\n    rescue StandardError, ArgumentError =&gt; e\n      RubyOperations.log(e,:ERROR)\n    end\n  end\nend\n</code></pre>\n\n<p>RSPEC:</p>\n\n<pre><code>describe 'RubyOperations' do\n  describe 'Operations' do\n    describe '.input' do\n      context 'when number is provided' do\n        it 'returns the number provided' do\n          expect(RubyOperations.input(num)).to eq(Integer)\n        end\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1537787253, "post_id": 52477636, "comment_id": 91896989, "body": "<code>grep -r sqlite3 .</code> in your rails root."}, {"owner": {"reputation": 2770, "user_id": 1042201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ada99cff697111a404292dbeff3d4313?s=128&d=identicon&r=PG", "display_name": "Kumar", "link": "https://stackoverflow.com/users/1042201/kumar"}, "edited": false, "score": 0, "creation_date": 1537787675, "post_id": 52477636, "comment_id": 91897173, "body": "Have you added <code>rails_12factor</code> gem?"}, {"owner": {"reputation": 1490, "user_id": 5003256, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/MQcIp.jpg?s=128&g=1", "display_name": "SV Madhava Reddy", "link": "https://stackoverflow.com/users/5003256/sv-madhava-reddy"}, "edited": false, "score": 0, "creation_date": 1549478325, "post_id": 52477636, "comment_id": 95920003, "body": "what is your <code>RAILS_ENV</code>? Is that development or test?"}], "answers": [{"comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1537800875, "post_id": 52480312, "comment_id": 91905510, "body": "&quot;5 &amp; below\u2026 5 &amp; above&quot; is ambiguous. Is that gem required for Rails 5, or not? <a href=\"https://github.com/heroku/rails_12factor#rails-5\" rel=\"nofollow noreferrer\">I guess not</a>."}, {"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1550109750, "post_id": 52480312, "comment_id": 96153226, "body": "it is not. Most likely the sqlite version simply needs to be fixed in the Gemfile: <code>gem &#39;sqlite3&#39;, &#39;~&gt; 1.4.0&#39;</code> (or some other version)"}, {"owner": {"reputation": 1120, "user_id": 626921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/667a07a84d8d3e38d5a589d2d4c48966?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/626921/michael"}, "edited": false, "score": 0, "creation_date": 1551296030, "post_id": 52480312, "comment_id": 96592752, "body": "There&#39;s an error in your formulation: you implied both that Rails 5 needed and didn&#39;t need rails_12factor."}], "tags": [], "owner": {"reputation": 26, "user_id": 3877386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Lu4j.png?s=128&g=1", "display_name": "ainza", "link": "https://stackoverflow.com/users/3877386/ainza"}, "is_accepted": false, "score": 0, "last_activity_date": 1537794892, "creation_date": 1537794892, "answer_id": 52480312, "question_id": 52477636, "link": "https://stackoverflow.com/questions/52477636/gemloaderror-error-loading-the-sqlite3-active-record-adapter/52480312#52480312", "title": "Gem::LoadError: Error loading the &#39;sqlite3&#39; Active Record adapter", "body": "<p>Rails 5 &amp; below you need to 'rails_12factor'gem.... Rails 5 &amp; above this is not required.</p>\n\n<p>Also noticed you don't have sqlite3 in your development environment, it may not matter but just place it there for good measure.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6146890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFuy3.jpg?s=128&g=1", "display_name": "JamesSchiiller", "link": "https://stackoverflow.com/users/6146890/jamesschiiller"}, "is_accepted": false, "score": 1, "last_activity_date": 1551050158, "creation_date": 1551050158, "answer_id": 54857519, "question_id": 52477636, "link": "https://stackoverflow.com/questions/52477636/gemloaderror-error-loading-the-sqlite3-active-record-adapter/54857519#54857519", "title": "Gem::LoadError: Error loading the &#39;sqlite3&#39; Active Record adapter", "body": "<p>If you are trying to use use a different database other than sqlite, </p>\n\n<ol>\n<li><p>remove sqlite3 in gemfile and bundle install</p></li>\n<li><p>remove sqlite3 in database.yml</p></li>\n<li><p>rake db:create &lt;---------------- or will complain no db error in \nbrowser</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 317, "user_id": 4388049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LPXy6.jpg?s=128&g=1", "display_name": "Ravi Kashyap", "link": "https://stackoverflow.com/users/4388049/ravi-kashyap"}, "edited": false, "score": 2, "creation_date": 1552447483, "post_id": 54994795, "comment_id": 97008748, "body": "I think version should be &#39;~1.3.6&#39;. use gem &#39;sqlite3&#39;, &#39;~&gt; 1.3.6&#39; instead"}], "tags": [], "owner": {"reputation": 31, "user_id": 2506585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7404ba11cb96675ba123d5883e7387?s=128&d=identicon&r=PG", "display_name": "Francisco Garc&#237;a Gonz&#225;lez", "link": "https://stackoverflow.com/users/2506585/francisco-garc%c3%ada-gonz%c3%a1lez"}, "is_accepted": false, "score": 1, "last_activity_date": 1562620183, "last_edit_date": 1562620183, "creation_date": 1551754884, "answer_id": 54994795, "question_id": 52477636, "link": "https://stackoverflow.com/questions/52477636/gemloaderror-error-loading-the-sqlite3-active-record-adapter/54994795#54994795", "title": "Gem::LoadError: Error loading the &#39;sqlite3&#39; Active Record adapter", "body": "<p>I had the same problem, I solved it downgrading the version that rails new installs by default.</p>\n\n<p>remove the current version of the sqlite3 gem with 'gem uninstall sqlite3' then modify the GemFile to include the sqlite3 version. I my case I set the version '~1.3.6' and that soled the problem</p>\n"}], "owner": {"reputation": 11, "user_id": 8776450, "user_type": "registered", "profile_image": "https://graph.facebook.com/1610866502268616/picture?type=large", "display_name": "\u66fe\u6fdf\u5f6c", "link": "https://stackoverflow.com/users/8776450/%e6%9b%be%e6%bf%9f%e5%bd%ac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7511, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1562620183, "creation_date": 1537785974, "last_edit_date": 1537786331, "question_id": 52477636, "link": "https://stackoverflow.com/questions/52477636/gemloaderror-error-loading-the-sqlite3-active-record-adapter", "title": "Gem::LoadError: Error loading the &#39;sqlite3&#39; Active Record adapter", "body": "<p>I am doing <code>heroku run rake db:migrate</code>\nand this is the error:</p>\n\n<blockquote>\n  <p>Gem::LoadError: Error loading the 'sqlite3' Active Record adapter.\n  Missing a gem it depends on? sqlite3 is not part of the bundle. Add it\n  to your Gemfile.</p>\n</blockquote>\n\n<p><strong>Gemfile:</strong></p>\n\n<pre><code>group :production do\n  gem 'pg', '~&gt; 0.18'\nend\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug', platforms: [:mri, :mingw, :x64_mingw]\n  # Use sqlite3 as the database for Active Record\n  gem 'sqlite3'\nend\n\ngroup :development do\n  # Access an interactive console on exception pages or by calling 'console' anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\n  gem 'listen', '&gt;= 3.0.5', '&lt; 3.2'\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\nend\n\ngroup :test do\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n  # Easy installation and use of chromedriver to run system tests with Chrome\n  gem 'chromedriver-helper'\nend\n</code></pre>\n\n<p><strong>Database.yml</strong></p>\n\n<pre><code>production:\n  adapter: postgresql\n  encoding: Unicode    \n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "rubygems", "activeadmin"], "comments": [{"owner": {"reputation": 3736, "user_id": 1031061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/8IZUV.jpg?s=128&g=1", "display_name": "Pardeep Dhingra", "link": "https://stackoverflow.com/users/1031061/pardeep-dhingra"}, "edited": false, "score": 0, "creation_date": 1537777819, "post_id": 52474319, "comment_id": 91892124, "body": "Please show whatever you have tried so far. It will be better if you can add here the code or solutions you have tried."}, {"owner": {"reputation": 71, "user_id": 7783163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f925474fc294a6ada25188df69c528eb?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Ghimiray", "link": "https://stackoverflow.com/users/7783163/sudeep-ghimiray"}, "reply_to_user": {"reputation": 3736, "user_id": 1031061, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/8IZUV.jpg?s=128&g=1", "display_name": "Pardeep Dhingra", "link": "https://stackoverflow.com/users/1031061/pardeep-dhingra"}, "edited": false, "score": 0, "creation_date": 1537783320, "post_id": 52474319, "comment_id": 91894927, "body": "for e.g I have used f.input :has_color which automatically enable radio button field in active admin"}], "answers": [{"tags": [], "owner": {"reputation": 1918, "user_id": 9224452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb0f303869bf090269cbcc46cef14991?s=128&d=identicon&r=PG&f=1", "display_name": "John Baker", "link": "https://stackoverflow.com/users/9224452/john-baker"}, "is_accepted": false, "score": -1, "last_activity_date": 1537781066, "creation_date": 1537781066, "answer_id": 52476203, "question_id": 52474319, "link": "https://stackoverflow.com/questions/52474319/how-to-add-a-toggle-input-button-in-active-admin/52476203#52476203", "title": "How to add a toggle input button in Active Admin?", "body": "<p>You can use pure css to make radio buttons appear as switches. Search this <a href=\"https://codepen.io/\" rel=\"nofollow noreferrer\">link</a> if you want to find other options.</p>\n\n<p>Here is the <a href=\"https://codepen.io/wiljanslofstra/pen/xqOKZW\" rel=\"nofollow noreferrer\">link</a> to the code I found in <code>codepen.io</code></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.toggle {\r\n  position: relative;\r\n  height: 14px;\r\n  width: 50px;\r\n  border-radius: 15px;\r\n  background: #ddd;\r\n  margin: 8px 0;\r\n}\r\n\r\n.toggle input {\r\n  opacity: 0;\r\n  width: 100%;\r\n  height: 200%;\r\n  position: absolute;\r\n  top: -7px;\r\n  left: 0;\r\n  z-index: 2;\r\n  margin: 0\r\n}\r\n\r\n.toggle input:nth-child(2):checked {\r\n  z-index: 1;\r\n}\r\n\r\n.toggle__pointer {\r\n  position: absolute;\r\n  top: -7px;\r\n  left: 0;\r\n  width: 28px;\r\n  height: 28px;\r\n  border-radius: 15px;\r\n  background-color: #37b24d;\r\n  -webkit-transition: left .15s ease-out;\r\n  transition: left .15s ease-out;\r\n}\r\n\r\n.toggle input:nth-child(2):checked+.toggle__pointer {\r\n  left: 22px;\r\n  background-color: #495057;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"toggle\"&gt;\r\n  &lt;input type=\"radio\" value=\"on\" name=\"radio\"&gt;\r\n  &lt;input type=\"radio\" value=\"off\" name=\"radio\" checked&gt;\r\n  &lt;div class=\"toggle__pointer\"&gt;&lt;/div&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 2560, "user_id": 153279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783f796db3d628f7c268326fb3323de8?s=128&d=identicon&r=PG", "display_name": "Piers C", "link": "https://stackoverflow.com/users/153279/piers-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1537795131, "creation_date": 1537795131, "answer_id": 52480383, "question_id": 52474319, "link": "https://stackoverflow.com/questions/52474319/how-to-add-a-toggle-input-button-in-active-admin/52480383#52480383", "title": "How to add a toggle input button in Active Admin?", "body": "<p>You may find <a href=\"https://github.com/platanus/activeadmin_addons#boolean-values\" rel=\"nofollow noreferrer\">https://github.com/platanus/activeadmin_addons#boolean-values</a> useful. Check out the <a href=\"https://github.com/activeadmin/activeadmin/wiki/\" rel=\"nofollow noreferrer\">wiki</a> for other resources.</p>\n"}], "owner": {"reputation": 71, "user_id": 7783163, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f925474fc294a6ada25188df69c528eb?s=128&d=identicon&r=PG&f=1", "display_name": "Sudeep Ghimiray", "link": "https://stackoverflow.com/users/7783163/sudeep-ghimiray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "closed_date": 1537796677, "accepted_answer_id": 52480383, "answer_count": 2, "score": -2, "last_activity_date": 1588616504, "creation_date": 1537773338, "last_edit_date": 1588616504, "question_id": 52474319, "link": "https://stackoverflow.com/questions/52474319/how-to-add-a-toggle-input-button-in-active-admin", "closed_reason": "Needs more focus", "title": "How to add a toggle input button in Active Admin?", "body": "<p>On one of my models, I want to use a toggle button instead of a radio button in the Active Admin form. </p>\n\n<p><a href=\"https://i.stack.imgur.com/GzTct.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GzTct.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1537771989, "post_id": 52473826, "comment_id": 91889645, "body": "btw <code>&lt;% if @order_sales_relationship = true %&gt;</code> should be <code>&lt;% if @order_sales_relationship == true %&gt;</code> also where is <code>@order_sales_relationship</code>?"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1537772230, "post_id": 52473826, "comment_id": 91889736, "body": "When I do ==, the /sales doesn&#39;t appear so i thought it was only 1 =  In my OrdersController, I have a sales method which displays the info on the /sales page.  If so, how would i implement the @ order_sales_relationship within that method, or do i even need to? It can just be separate.  I&#39;m new to coding btw so i know this may be obvious but just making sure!"}, {"owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1537772415, "post_id": 52473826, "comment_id": 91889797, "body": "check my answer"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "reply_to_user": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "edited": false, "score": 0, "creation_date": 1537772429, "post_id": 52473826, "comment_id": 91889799, "body": "As for the &quot;==&quot; ... when i try it, I tested it by creating a new order and uploading a new file, but the Upload button still appears.  I edited it, my apologese"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1537824561, "post_id": 52474095, "comment_id": 91916525, "body": "Here&#39;s my Git repo: <a href=\"https://github.com/brandnamewater/digitalcommerce\" rel=\"nofollow noreferrer\">github.com/brandnamewater/digitalcommerce</a> - Sorry just going to link that because not sure exactly what you mean.  I have the Orders model doing has_one :sales_upload"}, {"owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "edited": false, "score": 0, "creation_date": 1537850552, "post_id": 52474095, "comment_id": 91922094, "body": "So i just was messing around in the controller and found out i can&#39;t even access my sales_upload.rb model.  I get the following error: Unable to autoload constant Sales_upload, expected sales_upload.rb to define it....... so this may be a big part of the issue"}], "tags": [], "owner": {"reputation": 1114, "user_id": 5934752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7tGT8.jpg?s=128&g=1", "display_name": "Ravi Mariya", "link": "https://stackoverflow.com/users/5934752/ravi-mariya"}, "is_accepted": false, "score": 0, "last_activity_date": 1537786867, "last_edit_date": 1537786867, "creation_date": 1537772338, "answer_id": 52474095, "question_id": 52473826, "link": "https://stackoverflow.com/questions/52473826/how-to-result-and-validate-associated-data-from-multiple-table-cells/52474095#52474095", "title": "How to result and validate associated data from multiple Table cells", "body": "<p>ok from what I'm understanding, please correct me</p>\n\n<p>change</p>\n\n<pre><code>def order_sales_relationship\n  Order.where(id: Sales_upload.pluck(:order_id)) \nend\n</code></pre>\n\n<p>to</p>\n\n<pre><code>def order_sales_relationship\n  @order_sales = Order.where(id: Sales_upload.pluck(:order_id)) \nend\n</code></pre>\n\n<p>in view make this changes</p>\n\n<pre><code>&lt;% if @order_sales.present? %&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;%= link_to \"Upload\", new_order_sales_upload_path(order, @order), class: \"btn btn-primary\" %&gt;\n</code></pre>\n\n<p>??? where is @order</p>\n"}], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1537786867, "creation_date": 1537770976, "question_id": 52473826, "link": "https://stackoverflow.com/questions/52473826/how-to-result-and-validate-associated-data-from-multiple-table-cells", "title": "How to result and validate associated data from multiple Table cells", "body": "<p>Example: 2 tables</p>\n\n<p><strong>Table 1:</strong></p>\n\n<p>\"Orders\"</p>\n\n<p>cells:</p>\n\n<pre><code>-id\n\n-etc\n\n-etc\n</code></pre>\n\n<p><strong>Table 2:</strong></p>\n\n<p>\"Sales_uploads\"</p>\n\n<p>cells:</p>\n\n<pre><code>-id\n\n-order_id (same data as \"id\" in Orders table)\n\n-etc\n\n-etc\n</code></pre>\n\n<p>I have created =</p>\n\n<pre><code>Order.where(id: Sales_upload.pluck(:order_id)) \n</code></pre>\n\n<p>from Googling, but haven't figured out where to go from here.</p>\n\n<p>I have this def in my sales_upload model:</p>\n\n<pre><code>def order_sales_relationship\n    Order.where(id: Sales_upload.pluck(:order_id)) \nend\n</code></pre>\n\n<p>Then in the views I have: (a portion of views)</p>\n\n<pre><code>  &lt;% @orders.each do |order| %&gt;\n      &lt;tbody&gt;\n        &lt;tr&gt;\n        &lt;td class=\"center\"&gt;&lt;%= order.buyer.name %&gt;&lt;/td&gt;\n        &lt;td class=\"center\"&gt;&lt;%= number_to_currency(order.listing.price) %&gt;&lt;/td&gt;\n        &lt;td class=\"center\"&gt;&lt;%= order.created_at.strftime(\"%B %-d, %Y\") %&gt;&lt;/td&gt;\n\n        &lt;td class=\"center\"&gt;\n          &lt;div class=\"field\"&gt;\n\n\n            &lt;% if @order_sales_relationship = true %&gt;\n            &lt;%= link_to '/sales' %&gt;\n            &lt;% else %&gt;\n            &lt;%= link_to \"Upload\", new_order_sales_upload_path( order, @order ), class: \"btn btn-primary\" %&gt;\n            &lt;% end %&gt;\n</code></pre>\n\n<p>When i use this, '/sales' appears in the upload section of the table even if nothing has been uploaded. I believe the model is incorrect and may jst be validating if the cells exist, but not validating if they also match. How would i validate the matching as wlel (if this is even true)</p>\n\n<p>The goal is to display an upload link ONLY if the upload hasn't happened yet. If it has, I want only an update/edit link (which is '/sales' atm as a placer, that's a whole other issue).</p>\n"}, {"tags": ["ruby", "ping"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10406188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b32d1dd4b026b3e5cd11ff0122e358d?s=128&d=identicon&r=PG&f=1", "display_name": "Ark", "link": "https://stackoverflow.com/users/10406188/ark"}, "edited": false, "score": 0, "creation_date": 1537776021, "post_id": 52473815, "comment_id": 91891319, "body": "Thank you for the suggestion. I tried replacing if (p Ping.pingecho(hostip) == &#39;true&#39;) with if (p Ping.pingecho(hostip) == true) but the result is still wrong :("}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1537777707, "post_id": 52473815, "comment_id": 91892084, "body": "<code>p &quot;foo&quot;</code> returns &quot;foo&quot;, not true. If you want to <code>p</code> there, use <code>if Ping.pingecho(hostip).tap { |res| p res }</code>"}, {"owner": {"reputation": 31, "user_id": 10406188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b32d1dd4b026b3e5cd11ff0122e358d?s=128&d=identicon&r=PG&f=1", "display_name": "Ark", "link": "https://stackoverflow.com/users/10406188/ark"}, "edited": false, "score": 0, "creation_date": 1537854882, "post_id": 52473815, "comment_id": 91923396, "body": "Thank you for the suggestion.  The issue is resolved now. It appears that the way the data was stored in my input file was the problem. I have fixed that and the code works fine now. :)"}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 0, "last_activity_date": 1537770921, "creation_date": 1537770921, "answer_id": 52473815, "question_id": 52473440, "link": "https://stackoverflow.com/questions/52473440/how-to-ping-a-set-of-ips-stored-in-a-text-file-and-validate-where-the-ip-is-reac/52473815#52473815", "title": "How to ping a set of IPs stored in a text file and validate where the IP is reachable or not in Ruby?", "body": "<blockquote>\n<pre><code>if (p Ping.pingecho(hostip) == 'true')\n</code></pre>\n</blockquote>\n\n<p><code>Ping::pingecho</code> returns either <code>true</code> or <code>false</code>, but it never returns <code>'true'</code>, therefore this condition will always be false, and the conditional expression will always evaluate the <code>else</code> branch.</p>\n"}], "owner": {"reputation": 31, "user_id": 10406188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b32d1dd4b026b3e5cd11ff0122e358d?s=128&d=identicon&r=PG&f=1", "display_name": "Ark", "link": "https://stackoverflow.com/users/10406188/ark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537770921, "creation_date": 1537768801, "question_id": 52473440, "link": "https://stackoverflow.com/questions/52473440/how-to-ping-a-set-of-ips-stored-in-a-text-file-and-validate-where-the-ip-is-reac", "title": "How to ping a set of IPs stored in a text file and validate where the IP is reachable or not in Ruby?", "body": "<p>I am very new to Ruby so any help will be very useful. :)</p>\n\n<p>What I aim to do with my program is:</p>\n\n<ol>\n<li>Open a txt file with a list of IPs stored in it</li>\n<li>Fetch each IP one by one and ping it</li>\n<li>If the IP is reachable, return a TRUE value</li>\n<li>If IP is unreachable, return a FALSE value</li>\n<li>All non-reachable IPs to be written into another txt file</li>\n</ol>\n\n<p>Below is the program I pieced together from different online help sources:</p>\n\n<pre><code>require 'timeout'\nrequire 'socket'\n\n#PING LOGIC\nclass Ping \n  def self.pingecho(host, timeout=5, service=\"echo\")\n    puts host\n    begin\n      while(timeout) do\n        s = TCPSocket.new(host, service)     \n        s.close\n      end\n    rescue Errno::ECONNREFUSED\n      return true\n    rescue   Timeout::Error, StandardError \n      return false \n    end\n    return true\n  end\nend\n\n#opening the file with list of IPs\nFile.open('Ips.xml', 'r'). each do |line|    \n hostip = line\n #passing each line to the class for the ping test\n  if (p Ping.pingecho(hostip) == 'true')\n    return\n  else\n    #writing all non-reachable IPs to another file\n    File.open('Not reachable.txt','a') do |linea|\n    linea.puts hostip + \"\\n\"\n  end   \nend\nend\n</code></pre>\n\n<p>This does not give me any error when I execute it, but provides a FALSE result for all IPs in the txt file which I know are reachable.</p>\n\n<p>I know that separately all the components of this program work fine: The ping logic works fine if I just pass an IP directly to it (For example: p Ping.pingecho(\"10.40.220.34\")).</p>\n\n<p>The file opening; reading; and writing into other file also work fine as I tested them separately.</p>\n\n<p>The issue seems to be with the manner in which the IP is passed to the class from the txt file.</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7666149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8532fe5850f8e6d33dca0439b360d785?s=128&d=identicon&r=PG&f=1", "display_name": "JavaCid", "link": "https://stackoverflow.com/users/7666149/javacid"}, "edited": false, "score": 0, "creation_date": 1537780309, "post_id": 52473292, "comment_id": 91893336, "body": "what if I wanted to use a custom module to use in the class. How would I go about doing it?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11, "user_id": 7666149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8532fe5850f8e6d33dca0439b360d785?s=128&d=identicon&r=PG&f=1", "display_name": "JavaCid", "link": "https://stackoverflow.com/users/7666149/javacid"}, "edited": false, "score": 0, "creation_date": 1537785275, "post_id": 52473292, "comment_id": 91895964, "body": "I am not sure I follow. Normally you define a module with <code>module Foo; ...; end</code> and use it by mixing it in with <code>include</code>, <code>prepend</code> or <code>extend</code>."}, {"owner": {"reputation": 11, "user_id": 7666149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8532fe5850f8e6d33dca0439b360d785?s=128&d=identicon&r=PG&f=1", "display_name": "JavaCid", "link": "https://stackoverflow.com/users/7666149/javacid"}, "edited": false, "score": 0, "creation_date": 1537785557, "post_id": 52473292, "comment_id": 91896100, "body": "What I mean is I would like to create a  module and use it in the class. I made a mistake in the earlier comment. Sorry"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 11, "user_id": 7666149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8532fe5850f8e6d33dca0439b360d785?s=128&d=identicon&r=PG&f=1", "display_name": "JavaCid", "link": "https://stackoverflow.com/users/7666149/javacid"}, "edited": false, "score": 0, "creation_date": 1537785971, "post_id": 52473292, "comment_id": 91896342, "body": "Then my previous comment applies. Create a module and <code>include</code> it into the class."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1537768225, "last_edit_date": 1537768225, "creation_date": 1537767916, "answer_id": 52473292, "question_id": 52472969, "link": "https://stackoverflow.com/questions/52472969/sorting-and-loops-in-ruby/52473292#52473292", "title": "Sorting and loops in ruby", "body": "<p>You should not wrap the code in <code>class</code> in the first place. There is no OOP in your code, hence the class is not needed as well. Also, <code>gets</code> returns a string, while for <code>number</code> you likely need an integer.</p>\n\n<p>Here would be a [more-or-less] rubyish version of your code:</p>\n\n<pre><code>print \"How many gemstones do you want to enter? \"\n#                     \u21d3\u21d3\u21d3\u21d3\u21d3 get rid of trailing CR/LF\n#                           \u21d3\u21d3\u21d3\u21d3 convert to integer\ngemstoneNumber = gets.chomp.to_i\n\ngemstones =\n  1.upto(gemstoneNumber).map do |i|\n    puts\n    puts \"Please enter data for the gemstone ##{i}:\"\n\n    print \"What is the name of the gemstone? \"\n    name = gets.chomp # shave the trailing CR/LF off\n    print \"What is the color of the gemstone? \"\n    color = gets.chomp\n    print \"What is the price of the gemstone? \"\n    price = gets.chomp.to_f # convert to float\n\n    # in Ruby we normally use hashes to store\n    #   the named values\n    {name: name, color: color, price: price}\n  end\n\nputs \"You entered #{gemstoneNumber} gemstones. They are:\"\ngemstones.each do |gemstone|\n  puts \"Name: #{gemstone[:name]}. \" \\\n       \"Color: #{gemstone[:color]}. \" \\\n       \"Price: $#{gemstone[:price]}.\"\nend\n</code></pre>\n\n<p>Alternatively, you might use the class instead of hash to store the gemstone info.</p>\n\n<hr>\n\n<p>To sort the gemstones by the name:</p>\n\n<pre><code>puts \"You entered #{gemstoneNumber} gemstones. They are:\"\n#         \u21d3\u21d3\u21d3\u21d3\u21d3\u21d3\u21d3 HERE\ngemstones.sort_by { |gemstone| gemstone[:name] }.each do |gemstone|\n  puts \"Name: #{gemstone[:name]}. \" \\\n       \"Color: #{gemstone[:color]}. \" \\\n       \"Price: $#{gemstone[:price]}.\"\nend\n</code></pre>\n\n<hr>\n\n<p>The good documentation on enumerations might be found in the official ruby docs: <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-sort_by\" rel=\"nofollow noreferrer\">https://ruby-doc.org/core/Enumerable.html#method-i-sort_by</a> (and around.)</p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 9394108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7e21e1bb16a96dddb58c8871cbfc91f?s=128&d=identicon&r=PG&f=1", "display_name": "Wysiati", "link": "https://stackoverflow.com/users/9394108/wysiati"}, "is_accepted": false, "score": 0, "last_activity_date": 1537769698, "creation_date": 1537769698, "answer_id": 52473580, "question_id": 52472969, "link": "https://stackoverflow.com/questions/52472969/sorting-and-loops-in-ruby/52473580#52473580", "title": "Sorting and loops in ruby", "body": "<p>You can try this as well.</p>\n\n<pre><code>def gem_stones num\n  @gem_stones = []\n  num.times do |a|\n    print \"Enter the name of gemstone #{a+1} \"\n    name=gets.chomp\n    print \"Enter the color of gemstone #{a+1} \"\n    color = gets.chomp\n    print \"Enter the price of gemstone #{a+1} \"\n    price = gets.chomp.to_f\n    @gem_stones.push({name: name, color: color, price: price})\n  end\n  puts @gem_stones.sort_by {|a| a[:name]}.map{|gem| \"Name: #{gem[:name]}, Color: #{gem[:color]}, Price: #{gem[:price]}\"}.join(\"\\n\")\nend\n\n  puts \"Ener the number of gem stones you want to enter?\"\n  num = gets.to_i\n  gem_stones num\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7666149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8532fe5850f8e6d33dca0439b360d785?s=128&d=identicon&r=PG&f=1", "display_name": "JavaCid", "link": "https://stackoverflow.com/users/7666149/javacid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 52473292, "answer_count": 2, "score": -1, "last_activity_date": 1537769698, "creation_date": 1537765684, "question_id": 52472969, "link": "https://stackoverflow.com/questions/52472969/sorting-and-loops-in-ruby", "title": "Sorting and loops in ruby", "body": "<p>This is a program that ask input from the user about the characteristics of a gemstone then prints to the screen. Things like color, price and name. I have written it to an extend where the user enters all this and prints them out. Am now stuck where I should loop and enable the user to enter any number of gemstones. Like if he/she enters 3 gemstones then it should loop and allow the user to enter the characteristics of the 3 gemstone types. I would also like to sort the resulting output of gemstone names in alphabetical order. Appreciated</p>\n\n<pre><code>class GemStones\n  # input variables\n  name = \"\"\n  color = \"\"\n  price = 0\n  gemstoneNumber = 0\n\n\n  # output variable\n  gemstoneNumber = 0\n\n  # processing\n  print \"How many gemstones do you want to enter? \"\n  gemstoneNumber = gets\n\n  print \"What is the name of the gemstone? \"\n  name = gets\n\n  print \"What is the color of the gemstone? \"\n  color = gets\n\n  print \"What is the price of the gemstone? \"\n  price = gets\n\n\n\n  puts \" You entered #{gemstoneNumber} The name is #{name}, the color is #{color} and price is\n  $ #{price}\"\n\n\n\nend\n</code></pre>\n"}]