[{"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560984917, "post_id": 56676876, "comment_id": 99920690, "body": "It depends on whether you want an instance method or a class method. Simple as that."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1560984973, "post_id": 56676876, "comment_id": 99920705, "body": "Personally, I prefer <code>def self.foobar</code> to nesting it within a <code>class &lt;&lt; self</code>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1560985059, "post_id": 56676876, "comment_id": 99920726, "body": "See, for example, <a href=\"https://culttt.com/2015/06/10/understanding-class-methods-verses-instance-methods-in-ruby/\" rel=\"nofollow noreferrer\">Understanding class methods versus instance methods in Ruby</a> (yes, the correct spelling of &quot;verses&quot; is &quot;versus&quot;... &quot;verses&quot; are parts of a song or poem haha)."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1561005424, "post_id": 56676876, "comment_id": 99924312, "body": "@lurker, &quot;vursus&quot; is also frequently confused with &quot;Versas&quot;, much Nissan&#39;s dismay. btw, on SO, laughing at your own joke is bad form."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561422921, "post_id": 56676876, "comment_id": 100049536, "body": "@CarySwoveland it wasn&#39;t a joke. My &quot;haha&quot; was just a general expression of levity."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561668441, "post_id": 56676876, "comment_id": 100151125, "body": "Please consider selecting the answer you found most helpful (if any were helpful)."}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561708001, "post_id": 56676876, "comment_id": 100160115, "body": "Thanks @CarySwoveland. We have answers, but those answers don&#39;t focus on what I asked, the USE CASES. I understand them in syntax, but I&#39;m confused about the use cases of them. I found the comment of Lurker is best match for me. And I can only vote up that comment."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560985426, "post_id": 56676935, "comment_id": 99920800, "body": "Here it&#39;s the distinction between instance and class methods, yes. But in general, the concept of &quot;current self&quot; goes deeper than that. It is very useful for one to grok it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1560985634, "post_id": 56676935, "comment_id": 99920846, "body": "Step through that door and welcome to the world of the <a href=\"https://medium.com/@ethan.reid.roberts/rubys-anonymous-eigenclass-putting-the-ei-in-team-ebc1e8f8d668\" rel=\"nofollow noreferrer\">Eigenclass</a>."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1561012693, "post_id": 56676935, "comment_id": 99926523, "body": "I didn&#39;t know we could define the access specifier with class &lt;&lt; self Thank you :)"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561012984, "post_id": 56676935, "comment_id": 99926669, "body": "Thanks. I also prefer using <code>class &lt;&lt; self</code> instead of <code>self.method_name</code>"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561707886, "post_id": 56676935, "comment_id": 100160075, "body": "Thanks @Stefan, I understand those syntax. However, my questions is, when to use class method, when to use instance methods, can u explain the USE CASE"}], "tags": [], "owner": {"reputation": 5118, "user_id": 3893710, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YaxSL.jpg?s=128&g=1", "display_name": "oreoluwa", "link": "https://stackoverflow.com/users/3893710/oreoluwa"}, "is_accepted": false, "score": 2, "last_activity_date": 1560985231, "creation_date": 1560985231, "answer_id": 56676935, "question_id": 56676876, "link": "https://stackoverflow.com/questions/56676876/when-to-use-self-for-ruby-class/56676935#56676935", "title": "When to use self for Ruby Class", "body": "<p>You may need to read up on Ruby's instance and class methods.\nBut personally, I'd do</p>\n\n<pre><code>class Foo\n  class &lt;&lt; self\n    def foobar\n    end\n  end\nend\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>class Foo\n  def self.foobar\n  end\nend\n</code></pre>\n\n<p>whenever I want to add some class level attributes, or make a method private etc as </p>\n\n<pre><code>class Foo\n  private\n  def self.foobar\n  end\nend\n</code></pre>\n\n<p>wouldn't work the same as </p>\n\n<pre><code>class Foo\n  class &lt;&lt; self\n    private\n    def foobar\n    end\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561707880, "post_id": 56681835, "comment_id": 100160074, "body": "Thanks @Stefan, I understand those syntax. However, my questions is, when to use class method, when to use instance methods, can u explain the USE CASE"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1561712690, "post_id": 56681835, "comment_id": 100162175, "body": "@quyetdc it depends on what makes more sense. Let&#39;s say you have a <code>User</code> class with a user instance <code>alice</code> and you want to implement a new method <code>age</code> to return the user&#39;s age. You could implement that as a class method and pass it the user as an argument: <code>User.age(alice)</code>. Or you could implement it as a instance method and call it like: <code>alice.age</code>. What makes more sense? On the other hand, if you want to create a new user instance <code>jerry</code>. Does it make sense to send that method to an instance, e.g. <code>jerry = alice.new</code> or would the class be a better receiver: <code>jerry = User.new</code>."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1616315710, "last_edit_date": 1616315710, "creation_date": 1561018755, "answer_id": 56681835, "question_id": 56676876, "link": "https://stackoverflow.com/questions/56676876/when-to-use-self-for-ruby-class/56681835#56681835", "title": "When to use self for Ruby Class", "body": "<p>The methods defined right inside a <code>class</code> block are <strong>instance methods</strong>:</p>\n<pre><code>class Foo\n  def bar\n  end\nend\n</code></pre>\n<p>Methods defined within <code>class &lt;&lt; self</code> inside a <code>class</code> block are <strong>class methods</strong>:</p>\n<pre><code>class Foo\n  class &lt;&lt; self\n    def baz\n    end\n  end\nend\n</code></pre>\n<p>Instance methods become available to any instance of a given class:</p>\n<pre><code>foo = Foo.new\nfoo.bar\n</code></pre>\n<p>Whereas class methods can be called directly on the class:</p>\n<pre><code>Foo.baz\n</code></pre>\n<p>Attempting to call instance methods on the class or vice versa results in an error:</p>\n<pre><code>Foo.bar #=&gt; NoMethodError: undefined method `bar' for Foo:Class\nfoo.baz #=&gt; NoMethodError: undefined method `baz' for #&lt;Foo:0x00007ffe20055a20&gt;\n</code></pre>\n<p>Another way to define class methods is by prefixing the method name with <code>self.</code>:</p>\n<pre><code>class Foo\n  def self.baz\n  end\nend\n</code></pre>\n<p>You could also define them outside the <code>class</code> block, although this is rarely seen:</p>\n<pre><code>def Foo.baz\nend\n</code></pre>\n<p>Or likewise:</p>\n<pre><code>class &lt;&lt; Foo\n  def baz\n  end\nend\n</code></pre>\n<p>Note that defining methods this way is not limited to classes. You can add methods to arbitrary objects, e.g.:</p>\n<pre><code>o = Object.new\n\ndef o.hello\n  &quot;hello from o&quot;\nend\n\no.hello\n#=&gt; &quot;hello from o&quot;\n</code></pre>\n<p>Or via:</p>\n<pre><code>class &lt;&lt; o\n  def hello\n    &quot;hello from o&quot;\n  end\nend\n</code></pre>\n<p>Internally, these methods are added to the object's <em>singleton class</em>. It's a special purpose class to hold methods for just that instance:</p>\n<pre><code>o.singleton_class.instance_methods(false)\n#=&gt; [:hello]\n</code></pre>\n<p>For the <code>Foo</code> class above:</p>\n<pre><code>Foo.instance_methods(false)                 #=&gt; [:bar]\nFoo.singleton_class.instance_methods(false) #=&gt; [:baz]\n</code></pre>\n<p>So technically, a class method is just an instance method defined on the class' singleton class.</p>\n"}], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 56681835, "answer_count": 2, "score": 4, "last_activity_date": 1616315710, "creation_date": 1560984751, "question_id": 56676876, "link": "https://stackoverflow.com/questions/56676876/when-to-use-self-for-ruby-class", "title": "When to use self for Ruby Class", "body": "<p>Can somebody help me distinguish When we create methods inside <code>class &lt;&lt; self</code> block and when we define normal methods. </p>\n\n<p>I saw somewhere code like this, but I don't know concisely the use cases of them</p>\n\n<pre><code>class Foo\n  def initialize\n  end\n\n  def bar\n  end\n\n  class &lt;&lt; self\n    def foobar\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 23, "user_id": 11672926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084f3af764b6be9e88b3b1faafe8fb19?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11672926/alex"}, "reply_to_user": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "edited": false, "score": 1, "creation_date": 1560982513, "post_id": 56676537, "comment_id": 99920167, "body": "Ideally, I would be able to capture all the fields so that the episode name that is captured would be &quot;Busy Electron, The&quot;, but at the moment, the regex is only capturing &quot;The&quot;."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561001141, "post_id": 56676537, "comment_id": 99923550, "body": "Whenever you give an example you should always show the desired result as a valid Ruby object. Also, all data inputs should be valid Ruby objects (you need to surround your string with single quotes) and you should assign a variable to each, so readers can refer to those variables (e.g., <code>line</code>) in their answers. Presumably, <code>line = &#39;&quot;&quot;,2019-06-14,01:30,,27,&quot;&quot;,Episode Name &amp;&amp; Series Name,Other,Other,LOCAL&#39;</code>. Is the desired result an array containing the date, time and so on? Please edit as appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11672926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084f3af764b6be9e88b3b1faafe8fb19?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11672926/alex"}, "edited": false, "score": 1, "creation_date": 1560983253, "post_id": 56676620, "comment_id": 99920348, "body": "Awesome thank you very much! I think what i needed was this: &quot;(.*?)&quot;,([0-9]{4}-[0-9]{2}-[0-9]{2})\\s*,([0-9]{2}:[0-9]{2}),&zwnj;&#8203;(.*?),([0-9]+),&quot;(.*?&zwnj;&#8203;)&quot;,(.*?) &amp;&amp; (.*?),(.*?),(.*) because the &quot;&amp;&amp;&quot; was supposed to be a delimiter between the episode and series name, but not all episode/series names have commas in them. I don&#39;t quite understand why this works, could you explain why &quot;(.*?)&quot; works but not &quot;(.*)&quot;? Just for my own curiosity."}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": true, "score": 1, "last_activity_date": 1560983479, "last_edit_date": 1560983479, "creation_date": 1560982817, "answer_id": 56676620, "question_id": 56676537, "link": "https://stackoverflow.com/questions/56676537/not-capturing-commas-correctly/56676620#56676620", "title": ".* not capturing commas correctly", "body": "<p>This might be the expression we might be in search of here, yet not the right method: </p>\n\n<pre><code>\"(.*?)\",([0-9]{4}-[0-9]{2}-[0-9]{2})\\s*,([0-9]{2}:[0-9]{2}),(.*?),([0-9]+),\"(.*?)\",(.*?),(.*?),(.*?),(.*)\n</code></pre>\n\n<p>Excluding the last field, we'd just implement a lazy quantifier <code>(.*?)</code> for those fields which we'd not be validating. </p>\n\n<p><code>(.*)?</code> does not work, since it would make the entire capturing group lazy rather than <code>.*</code>. </p>\n\n<p>Before, it would get to <code>?</code>, <code>.*</code> has already swiped our string to the end and has collected all chars except for the newlines. </p>\n\n<p>If we wish to add or reduce the constraints, we can do so, such as:</p>\n\n<pre><code>\"(.*?)\",\\s*([0-9]{4}-[0-9]{2}-[0-9]{2})\\s*,\\s*([0-9]{2}:[0-9]{2})\\s*,(.*?),\\s*([0-9]+)\\s*,\"(.*?)\",(.*?),(.*?),(.*?),(.*)\n</code></pre>\n\n<h3>Test</h3>\n\n<pre><code>re = /\"(.*?)\",([0-9]{4}-[0-9]{2}-[0-9]{2})\\s*,([0-9]{2}:[0-9]{2}),(.*?),([0-9]+),\"(.*?)\",(.*?),(.*?),(.*?),(.*)/m\nstr = '\"\",2019-06-14,01:30,,27,\"\",Episode Name &amp;&amp; Series Name,Other,Other,LOCAL\n\n\"some things we wish here\",2019-06-14,01:30,some things we wish here,27,\"some things we wish here\",Episode Name &amp;&amp; Series Name,Other,Other,LOCAL'\n\n# Print the match result\nstr.scan(re) do |match|\n    puts match.to_s\nend\n</code></pre>\n\n<h3><a href=\"https://regex101.com/r/hWtI7i/1/\" rel=\"nofollow noreferrer\">Demo</a></h3>\n\n<h3>RegEx Circuit</h3>\n\n<p><a href=\"https://jex.im/regulex/#!flags=&amp;re=%5E(a%7Cb)*%3F%24\" rel=\"nofollow noreferrer\">jex.im</a> visualizes regular expressions:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lRe1f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lRe1f.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 11672926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/084f3af764b6be9e88b3b1faafe8fb19?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11672926/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 2, "accepted_answer_id": 56676620, "answer_count": 1, "score": 2, "last_activity_date": 1560983479, "creation_date": 1560982208, "last_edit_date": 1560982554, "question_id": 56676537, "link": "https://stackoverflow.com/questions/56676537/not-capturing-commas-correctly", "title": ".* not capturing commas correctly", "body": "<p>My regex does not properly handle commas in a line.</p>\n\n<pre><code>if line =~ /^.*,(\\d{4}-\\d{2}-\\d{2}),(\\d+:\\d+),.*,(\\d+),.*,(.*) &amp;&amp; (.*),Other,Other.*$/\n</code></pre>\n\n<p>I am reading a file line by line that should look like: </p>\n\n<pre><code>\"\",2019-06-14,01:30,,27,\"\",Episode Name &amp;&amp; Series Name,Other,Other,LOCAL\n</code></pre>\n\n<p>However, if the series name has a comma in it, eg. \"Busy Electron, The\", the regex will only capture the \"The\" and not the entire name.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "puma"], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 1949195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2224acac6b9f3f0e7728322f48866d1e?s=128&d=identicon&r=PG", "display_name": "Marcos Tapaj&#243;s", "link": "https://stackoverflow.com/users/1949195/marcos-tapaj%c3%b3s"}, "is_accepted": true, "score": 2, "last_activity_date": 1560981227, "creation_date": 1560981227, "answer_id": 56676392, "question_id": 56676158, "link": "https://stackoverflow.com/questions/56676158/how-do-i-print-thread-backtraces-upon-a-puma-kill/56676392#56676392", "title": "How do I print thread backtraces upon a puma kill?", "body": "<p>You can try add a middleware that implements a time-out lower than the Puma and on this one you dumpy whatever you need/want.</p>\n\n<p>It is not answering your question about Puma but might be a  workaround to solve the issue that you have now.</p>\n"}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56676392, "answer_count": 1, "score": 1, "last_activity_date": 1560981227, "creation_date": 1560979951, "question_id": 56676158, "link": "https://stackoverflow.com/questions/56676158/how-do-i-print-thread-backtraces-upon-a-puma-kill", "title": "How do I print thread backtraces upon a puma kill?", "body": "<p>I have an app that has some operations that timeout every once in a while (given our Puma configured timeout) but given then process just dies and a new one comes over I have no way of knowing why/where the process was hung.</p>\n\n<p>Is there a way for me to print all threads before Puma kills my process?</p>\n\n<p>I've tried using <code>on_worker_shutdown</code> but that doesn't seem to be called on a timeout kill. This is a Rails 4.2 app running on Ruby 2.2.7.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1560976942, "post_id": 56675227, "comment_id": 99918367, "body": "This won&#39;t likely solve your main issue, but look into using a ruby version manager such as <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">rbenv</a> or <a href=\"https://rvm.io\" rel=\"nofollow noreferrer\">rvm</a>. It looks like you are using your system ruby on your dev machine, and not the same version you are targeting to deploy. A version manager can help developing against several versions of ruby."}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "reply_to_user": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1560977022, "post_id": 56675227, "comment_id": 99918394, "body": "I actually used rbenv to install Ruby on my machine. Doesn&#39;t Heroku use the version of Ruby that is specified in my Gemfile though?"}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1560977201, "post_id": 56675227, "comment_id": 99918458, "body": "the error from <code>gem install bundler -v 1.17.3</code> indicates that you aren&#39;t using the version of ruby you think you are. It looks like it&#39;s trying to use 2.5.0, and it probably isn&#39;t the <code>rbenv</code> version, because usually you wouldn&#39;t get a permissions error with <code>rbenv</code>."}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1560977354, "post_id": 56675227, "comment_id": 99918510, "body": "This might help: <a href=\"https://devcenter.heroku.com/articles/ruby-versions\" rel=\"nofollow noreferrer\">Specifying a Ruby Version on Heroku</a>"}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "reply_to_user": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1560977481, "post_id": 56675227, "comment_id": 99918552, "body": "All right, thank you for your help. I get off work now but I&#39;ll be back tomorrow all day to work on this, and I will check out that link then! :)"}], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561042736, "post_id": 56683360, "comment_id": 99942962, "body": "My build pack was already set to <code>heroku&#47;ruby</code> so that is not the problem. It appears the issue is with my Gemfile... :["}], "tags": [], "owner": {"reputation": 822, "user_id": 3738936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/762a46533d8d4488a9c6ad749d6a0691?s=128&d=identicon&r=PG&f=1", "display_name": "user3738936", "link": "https://stackoverflow.com/users/3738936/user3738936"}, "is_accepted": false, "score": 1, "last_activity_date": 1561024385, "creation_date": 1561024385, "answer_id": 56683360, "question_id": 56675227, "link": "https://stackoverflow.com/questions/56675227/this-version-of-ruby-is-not-available-on-heroku-18/56683360#56683360", "title": "This version of Ruby is not available on Heroku-18", "body": "<p>On Heroku you cannot configure the version of bundler directly -> <a href=\"https://devcenter.heroku.com/articles/bundler-version#app-not-using-the-currently-supported-bundler-version\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/bundler-version#app-not-using-the-currently-supported-bundler-version</a></p>\n\n<p>I am guessing you are using the heroku buildpack, if not you will want to set that up.</p>\n\n<p>You can switch to a supported buildpack with:</p>\n\n<pre><code>heroku buildpacks:set heroku/ruby\n</code></pre>\n\n<p>I believe I have had issues where heroku wasn't updating, try the top 2 answers here:\n<a href=\"https://stackoverflow.com/questions/22600382/heroku-is-not-updating-my-code\">Heroku is not updating my code?</a></p>\n\n<p>One of the pitfalls of heroku is you will need to work with in their construct. I would make sure you are using whatever version of bundler and ruby they want locally prior to deployment and after deployment confirm by sshing on to the heroku box to confirm it is the same version.</p>\n\n<p>Sidenote, using the <code>ruby</code> keyword will only work for certain versions of bundler\n<a href=\"https://devcenter.heroku.com/articles/ruby-versions#selecting-a-version-of-ruby\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/ruby-versions#selecting-a-version-of-ruby</a></p>\n\n<p>I usually set my ruby version in a <code>.ruby-version</code> file in the root of the project.</p>\n"}, {"comments": [{"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561044994, "post_id": 56687429, "comment_id": 99944346, "body": "So I tried that and now my Heroku app SUCCESSFULLY deploys! :D Having some other issues but this is what I needed. Weird as heck though. Thanks!"}, {"owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "reply_to_user": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561046146, "post_id": 56687429, "comment_id": 99944976, "body": "Yeah, the error you get is weird, but you can see here that <code>2.0.1</code> is the current blessed version: <a href=\"https://github.com/heroku/heroku-buildpack-ruby/blob/master/lib/language_pack/helpers/bundler_wrapper.rb#L40\" rel=\"nofollow noreferrer\">github.com/heroku/heroku-buildpack-ruby/blob/master/lib/&hellip;</a>. No doubt this&#39;ll be updated in time"}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561052869, "post_id": 56687429, "comment_id": 99948134, "body": "Also, what do you mean &quot;blessed&quot;? Never heard that before with code."}, {"owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "edited": false, "score": 0, "creation_date": 1561053890, "post_id": 56687429, "comment_id": 99948609, "body": "What does &quot;blessed&quot; \uff4d\uff45\uff41\uff4e\uff1f"}, {"owner": {"reputation": 2372, "user_id": 8031815, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IlIxbbzooGw/AAAAAAAAAAI/AAAAAAAAAE0/9JNBRJDFRnE/photo.jpg?sz=128", "display_name": "Garrett Motzner", "link": "https://stackoverflow.com/users/8031815/garrett-motzner"}, "edited": false, "score": 0, "creation_date": 1561056673, "post_id": 56687429, "comment_id": 99949731, "body": "From reading the code for the build pack, it seems like it only cares about the major version of the lock file. I&#39;m not seeing where it cares if the version stated is newer than the blessed version. However using the blessed version of bundler does seem sensible. I am interested to know though if and why the build pack does care about the exact version."}], "tags": [], "owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "is_accepted": true, "score": 2, "last_activity_date": 1561038462, "creation_date": 1561038462, "answer_id": 56687429, "question_id": 56675227, "link": "https://stackoverflow.com/questions/56675227/this-version-of-ruby-is-not-available-on-heroku-18/56687429#56687429", "title": "This version of Ruby is not available on Heroku-18", "body": "<p>It's possible that the \"blessed\" version of bundler hasn't been updated yet to <code>2.0.2</code>, and only <code>2.0.1</code> is supported on the official ruby buildpack.</p>\n\n<p>To test this out, you can edit your <code>Gemfile.lock</code> manually and change:</p>\n\n<pre><code>BUNDLED WITH\n  2.0.2\n</code></pre>\n\n<p>to <code>2.0.1</code></p>\n\n<p>It will be overridden every time you <code>bundle</code> though, so if that is the fix, you might want to downgrade bundler for the time being.</p>\n"}], "owner": {"reputation": 769, "user_id": 9739007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/18Kgd.png?s=128&g=1", "display_name": "McFloofenbork", "link": "https://stackoverflow.com/users/9739007/mcfloofenbork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 56687429, "answer_count": 2, "score": 0, "last_activity_date": 1561044336, "creation_date": 1560975372, "last_edit_date": 1561044336, "question_id": 56675227, "link": "https://stackoverflow.com/questions/56675227/this-version-of-ruby-is-not-available-on-heroku-18", "title": "This version of Ruby is not available on Heroku-18", "body": "<p>When I try to build my app on Heroku, it fails because the Ruby version I purportedly am using is not supported by Heroku. My app has no problem building/deploying locally. Here is full message log:</p>\n\n<pre><code>\n\n-----&gt; Ruby app detected\n\n-----&gt; Compiling Ruby/Rails\n\n       Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 3 --max-time 30 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz -s -o - | tar zxf - ' failed on attempt 1 of 3.\n\n       Command: 'set -o pipefail; curl -L --fail --retry 5 --retry-delay 1 --connect-timeout 3 --max-time 30 https://s3-external-1.amazonaws.com/heroku-buildpack-ruby/heroku-18/ruby-2.3.8.tgz -s -o - | tar zxf - ' failed on attempt 2 of 3.\n\n !\n\n !     An error occurred while installing ruby-2.3.8\n\n !     \n\n !     This version of Ruby is not available on Heroku-18. The minimum supported version\n\n !     of Ruby on the Heroku-18 stack can found at:\n\n !     \n\n !     https://devcenter.heroku.com/articles/ruby-support#supported-runtimes\n\n !\n\n !     Push rejected, failed to compile Ruby app.\n\n !     Push failed\n</code></pre>\n\n<p>However, in my Gemfile and Gemfile.lock, I am NOT using ruby-2.3.8. That is why I am very confused. I have links to my <a href=\"https://gist.github.com/wangjess/78568a13e9eea7cca26d1ca45d5c0fae\" rel=\"nofollow noreferrer\">Gemfile gist</a> and <a href=\"https://gist.github.com/wangjess/a3c8a1e9a535d42967256b29639e129d\" rel=\"nofollow noreferrer\">Gemfile.lock gist</a>.</p>\n\n<p>Things I have tried on Heroku:</p>\n\n<p>Running <code>bundle install</code>.</p>\n\n<p><a href=\"https://help.heroku.com/Q5ZF0DUO/ruby-build-fails-with-your-ruby-version-is-x-but-your-gemfile-specified-y\" rel=\"nofollow noreferrer\">This</a>. Did not resolve issue, my Gemfile, Gemfile.lock, and local Ruby is ALL 2.6.3.</p>\n\n<p>Making sure Gemfile and Gemfile.lock are the most recent ones in my Github.</p>\n\n<p>Running  <code>gem install bundler -v 1.17.3</code> but it gives me <code>ERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions for the /var/lib/gems/2.5.0 directory</code></p>\n\n<p>EDIT: </p>\n\n<p>It appears after running <code>heroku run ruby -v</code>, that my Ruby version is actually <code>ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux-gnu]</code></p>\n"}, {"tags": ["ruby", "xml", "csv", "xslt", "nokogiri"], "comments": [{"owner": {"reputation": 68419, "user_id": 7585, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Txewo.jpg?s=128&g=1", "display_name": "Tim C", "link": "https://stackoverflow.com/users/7585/tim-c"}, "edited": false, "score": 0, "creation_date": 1560982545, "post_id": 56674855, "comment_id": 99920176, "body": "It looks like nokigiri only supports XSLT 1.0 (Well, 1.1, but that never got out of draft specification, I believe), in which case the syntax <code>&#47;data:root&#47;*&#47;local-name()</code> could be invalid. Does doing <code>&lt;xsl:value-of select=&quot;concat(&#39;:&#39;, local-name(&#47;data:root&#47;*))&quot;&#47;&gt; </code> work?"}, {"owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "reply_to_user": {"reputation": 68419, "user_id": 7585, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Txewo.jpg?s=128&g=1", "display_name": "Tim C", "link": "https://stackoverflow.com/users/7585/tim-c"}, "edited": false, "score": 0, "creation_date": 1560984112, "post_id": 56674855, "comment_id": 99920528, "body": "yes, i got the output to work with nokogiri, thanks! but now the output has: &lt;?xml version=&quot;1.0&quot;?&gt; :Data_Request               how to i remove the &lt;?xml version=&quot;1.0&quot;?&gt; from the output? and what do I need to do to apply that output to my ruby script at line: if key ==:Data_Request &amp;&amp; !record.empty?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1560992116, "post_id": 56674855, "comment_id": 99922025, "body": "It looks like there is a <a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/Searchable.html#search-instance_method\" rel=\"nofollow noreferrer\">Nokogiri::XML::Searchable#search</a> method that directly takes an XPath expression; is that what you&#39;re looking for?  Or perhaps <a href=\"https://nokogiri.org/rdoc/Nokogiri/XML/Node.html#parent-instance_method\" rel=\"nofollow noreferrer\">Nokogiri::XML::Node#parent</a>?"}, {"owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "edited": false, "score": 0, "creation_date": 1561049781, "post_id": 56674855, "comment_id": 99946803, "body": "I tried to use <code>&lt;xsl:output method=&quot;xml&quot; omit-xml-declaration=&quot;yes&quot;&#47;&gt;</code> or <code>&lt;xsl:output method=&quot;text&quot; &#47;&gt;</code> not working for nokogiri :("}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561323077, "post_id": 56674855, "comment_id": 100015060, "body": "You&#39;re asking three different questions. Don&#39;t do that because you just made your question off-topic for being too broad. Instead as one, maybe two questions if they&#39;re very closely related. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561323310, "post_id": 56674855, "comment_id": 100015103, "body": "XML to CSV is generally pretty easy and doesn&#39;t involve an XSLT. Using <code>traverse</code> is not the efficient way to use Nokogiri, instead you probably want to define a number of lookups using <code>css</code> or <code>xpath</code> searches to find specific nodes then extract the specific text, creating an array or hash that you then use to create a row of data in the CSV file."}, {"owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "edited": false, "score": 0, "creation_date": 1561492444, "post_id": 56674855, "comment_id": 100079684, "body": "Tin Man, thanks alot for your help and tip so far. I tried <code>def first_element(filename)    xml_files = File.read(filename)   doc = Nokogiri::XML xml_files    doc.traverse do |node|      puts node.xpath(&quot;concat(&#39;:&#39;, local-name(&#47;data:root&#47;*[1]))&quot;)   end end   Dir.glob(&#39;*xml&#39;).each {|filename| first_element(filename)}</code> but the first element after root came out way too many times, and also showing the whole xml in display. How do I shorten it to just :Data_Request? thanks"}], "owner": {"reputation": 39, "user_id": 10913156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/592e5c789ab25dc0ee63ea1e2a0c4e17?s=128&d=identicon&r=PG&f=1", "display_name": "Code_Journey_4_Fun", "link": "https://stackoverflow.com/users/10913156/code-journey-4-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560984292, "creation_date": 1560973631, "last_edit_date": 1560984292, "question_id": 56674855, "link": "https://stackoverflow.com/questions/56674855/xslt-ruby-how-to-output-the-next-element-name-from-root", "title": "XSLT, RUBY, how to output the next element name from root?", "body": "<p>I am working on a ruby script that involves with XSLT to convert XML to CSV. One of my code's logic is to grab the parent node element after root dynamically so it can treat it as row of records in the CSV file. I was able to get what I want by using Oxygen to convert the XML but I am running in this error by using Nokogiri:</p>\n\n<blockquote>\n  <p>/Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/lib/nokogiri/xslt.rb:32:in <code>parse_stylesheet_doc': compilation error: file selectXMLelement.xsl line 5 element stylesheet (RuntimeError)\n  xsl:version: only 1.1 features are supported\n  compilation error: file selectXMLelement.xsl line 8 element value-of\n  xsl:value-of : could not compile select expression 'concat(':',/data:root/*/local-name())'\n      from /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/lib/nokogiri/xslt.rb:32:in</code>parse'\n      from /Library/Ruby/Gems/2.3.0/gems/nokogiri-1.10.3/lib/nokogiri/xslt.rb:13:in <code>XSLT'\n      from EXTC-v1.rb:37:in</code>api_component'\n      from EXTC-v1.rb:43:in <code>block in &lt;main&gt;'\n      from EXTC-v1.rb:43:in</code>each'\n      from EXTC-v1.rb:43:in `'</p>\n</blockquote>\n\n<p>I would like to know if there is a way to use Nokogiri to get what I want instead of the XSLT, and how to feed into my Ruby script logic. </p>\n\n<p>I have tried to use this XSLT:</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n    xmlns:data=\"urn:com.sample/bsvc\"\n    exclude-result-prefixes=\"data\"\n    version=\"2.0\"&gt;\n    &lt;xsl:output method=\"text\"/&gt;\n    &lt;xsl:template match=\"/\"&gt;\n            &lt;xsl:value-of select=\"concat(':',/data:root/*[1]/local-name())\"/&gt;\n    &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>example XML, and I am successfully to output what I want from the XSLT \":Data_Request\" by using Oxygen</p>\n\n<pre><code>&lt;data:root&gt;\n    &lt;data:Data_Request&gt;\n        &lt;data:name&gt;John Doe&lt;/data:name&gt;\n        &lt;data:phone&gt;123456776&lt;/data:phone&gt;\n    &lt;/data:Data_Request&gt;\n&lt;/data:root&gt;\n</code></pre>\n\n<p>My Ruby script:</p>\n\n<pre><code>def xslt_transform(filename)\n  #dir = File.join(Dir.pwd,'/input/')\n  xml_str = File.read(filename)\n  doc = Nokogiri::XML xml_str\n  template = Nokogiri::XSLT(File.open('Remove-CDATA.xsl'))\n  transformed_doc = template.transform(doc)\n\n  File.write(filename, transformed_doc)\nend\n\nDir.glob('*.xml').each {|filename| xslt_transform(filename)}\n#this is where iam trying to use the XSLT\ndef api_component(filename)\n  xml_str = File.read(filename)\n  doc = Nokogiri::XML xml_str\n  template = Nokogiri::XSLT(File.open('selectXMLelement.xsl'))\n  transformed_doc = template.transform(doc)\n\n  puts filename\nend\n\napi_name = Dir.glob('*xml').each {|filename| api_component(filename)}\n\nputs api_name\n\n\ndef xml_to_csv(filename)\n  dir = File.join(Dir.pwd,'/input/')\n  xml_str = File.read(filename)\n  doc     = Nokogiri::XML xml_str\n  csv_filename = filename.gsub('.xml','.csv')\n  record  = {} # hashes\n  keys    = Set.new\n  records = [] # array\n  csv     = \"\"\n\n# Returns a new hash created by traversing the hash and its subhashes, \n# executing the given block on the key and value. The block should return a 2-element array of the form [key, value].\n  doc.traverse do |node| \n    value = node.text.gsub(/\\n +/, '')\n      if node.name != \"text\" # skip these nodes: if class isnt text then skip\n        if value.length &gt; 0 # skip empty nodes\n          key = node.name.gsub(/wd:/,'').to_sym\n          #api_component = doc.xpath('/*/*[1]')\n          # if a new and not empty record, add to our records collection\n          if key == :Data_Request &amp;&amp; !record.empty? #for regular XML parsng, use the request data. For example :Location_Data\n            records &lt;&lt; record\n            record = {}\n          elsif key[/^root$|^document$/]\n            # neglect these keys\n          else\n            key = node.name.gsub(/data:/,'').to_sym\n            # in case our value is html instead of text\n            record[key] = Nokogiri::HTML.parse(value).text\n            # add to our key set only if not already in the set\n            keys &lt;&lt; key\n          end\n        end\n      end\n    end\n\n\n\n# build our csv\n  dir = File.join(Dir.pwd,'/output/')\n  File.open('../output/'+csv_filename, 'wb') do |file|\n    file.puts %Q{\"#{keys.to_a.join('\",\"')}\"}\n    records.each do |record|\n      keys.each do |key|\n        file.write %Q{\"#{record[key]}\",}\n      end\n      file.write \"\\n\"\n    end\n    print ''\n    print filename+ \" is ready!\\n\"\n    print ''\n  end\nend\n\nDir.glob('*.xml').each { |filename| xml_to_csv(filename) }\n</code></pre>\n\n<p>As you can see, right now I have it hard coded the node element: <code>if key == :Data_Request &amp;&amp; !record.empty?</code></p>\n\n<p>Is there a way to do so with Nokogiri? and it can dynamically detect all the XML files in the read path? If not, how can I achieve it with XSLT embeded in my script? \nSide question! Is there a way to make all the data format as Text format with my script too so it can keep the leading zeros? :)</p>\n"}, {"tags": ["ruby", "hash"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1560973196, "post_id": 56674742, "comment_id": 99916857, "body": "I&#39;m not sure I see how your outermost nested hash offers any benefit over an array. Are you sure you want this structure? I&#39;d consider making <code>filter</code> the outer key rather than an integer (unless the integer keys are sparse ids of some sort rather than sequential numbers)."}, {"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1560973261, "post_id": 56674742, "comment_id": 99916885, "body": "@ggorlen: I&#39;m open to reformatting a bit. Ultimately just want to be able to select each grouping more easily."}], "answers": [{"comments": [{"owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "edited": false, "score": 0, "creation_date": 1560974742, "post_id": 56675069, "comment_id": 99917494, "body": "Beautiful. Thank you for both the solution and the explanation! \ud83d\ude4c"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 5, "last_activity_date": 1560978004, "last_edit_date": 1560978004, "creation_date": 1560974541, "answer_id": 56675069, "question_id": 56674742, "link": "https://stackoverflow.com/questions/56674742/how-would-i-parse-a-flat-ruby-hash-in-to-a-nested-hash/56675069#56675069", "title": "How would I parse a flat Ruby hash in to a nested hash?", "body": "<p>First you can split up the hash into multiple hashes according to their prefix number (feel free to run this to see the return val)</p>\n\n<pre><code>groups = input.\n  group_by { |k,v| k.match(/builder_rule_(\\d+)/)[1] }.\n  transform_values(&amp;:to_h)\n</code></pre>\n\n<p>at this point, creating the inner objects is easier if you just use some hard-coding to build the key-valls:</p>\n\n<pre><code>result = groups.each_with_object({}) do |(prefix, hash), memo|\n  memo[prefix] = {\n    \"filter\" =&gt; hash[\"builder_rule_#{prefix}_filter\"],\n    \"operator\" =&gt; hash[\"builder_rule_#{prefix}_operator\"],\n    \"values\" =&gt; hash.select do |key, val|\n      key =~ /builder_rule_#{prefix}_value/\n    end.sort_by { |key, val| key }.map { |(key, val)| val }\n  }\nend\n</code></pre>\n\n<p>It might possibly be confusing what <code>.sort_by { |key, val| key }.map { |(key, val)| val }</code> means. I can spell it out:</p>\n\n<ul>\n<li><code>hash.select { |key, val| key =~ /builder_rule_#{prefix}_value/ }</code> gets the key-vals which are going to be used for the \"values\" array. It returns a hash.</li>\n<li><code>.sort_by { |key, val| key }</code> turns the hash into an array of <code>[key, val]</code> tuples , sorted by the key. This is so that the values appear in the correct order.</li>\n<li><code>.map { |(key, val)| val }</code> turns the nested array into a single-level array, discarding the keys</li>\n</ul>\n\n<p>You could also use <code>sort_by(&amp;:first).map(&amp;:second)</code>, though you need active support to use <a href=\"https://apidock.com/rails/Array/second\" rel=\"nofollow noreferrer\"><code>Array#second</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "is_accepted": false, "score": 1, "last_activity_date": 1560977535, "last_edit_date": 1560977535, "creation_date": 1560977062, "answer_id": 56675577, "question_id": 56674742, "link": "https://stackoverflow.com/questions/56674742/how-would-i-parse-a-flat-ruby-hash-in-to-a-nested-hash/56675577#56675577", "title": "How would I parse a flat Ruby hash in to a nested hash?", "body": "<p>Assuming the depth is fixed at 3 and the rules are consistent (as shown in the example), you can make this a single pass transformation as follows:</p>\n\n<pre><code>h.each_with_object(Hash.new {|h,k| h[k]= {}}) do |(k,v),obj|\n  new_k, k2, k3 = k[/(?&lt;=builder_rule_).*/].split('_')\n  k2 == 'value' ? (obj[new_k][\"values\"] ||= {}).merge!({k3 =&gt; v}) :  obj[new_k][k2] = v\nend\n</code></pre>\n\n<p>Here we are constructing a new <code>Hash</code> where first level keys default to an empty <code>Hash</code> (<code>h.each_with_object(Hash.new {|h,k| h[k]= {}}) do |(k,v),obj|</code>).</p>\n\n<p>Then we split the key based on the underscore after 'builder_rule_' <code>new_k, k2, k3 = k[/(?&lt;=builder_rule_).*/].split('_')</code> </p>\n\n<p>Then if the second level key (k2) equals 'value' we need to make it values and merge the third level key (k3) and the value into a new hash otherwise we assign k2 to the value. <code>k2 == 'value' ? (obj[new_k][\"values\"] ||= {}).merge!({k3 =&gt; v}) :  obj[new_k][k2] = v</code></p>\n\n<p>This will actually return the requested requirement where <code>values</code> is a <code>Hash</code> with key indexes </p>\n\n<pre><code>{\n  \"0\"=&gt;{\n      \"filter\"=&gt;\"artist_name\",\n      \"operator\"=&gt;\"contains\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"New Found Glory\"\n      }\n    },\n  \"1\"=&gt;{\n      \"filter\"=&gt;\"bpm\",\n      \"operator\"=&gt;\"less\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"150\"\n      }\n    },\n  \"2\"=&gt;{\n      \"filter\"=&gt;\"days_ago\",\n      \"operator\"=&gt;\"less\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"40\"\n      }\n    },\n  \"3\"=&gt;{\n      \"filter\"=&gt;\"release_date_start\",\n      \"operator\"=&gt;\"between\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"2019-01-01\",\n        \"1\"=&gt;\"2019-12-31\"\n      }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1560977248, "post_id": 56675597, "comment_id": 99918473, "body": "<code>hsh[num] = {} unless hsh.key?(num)</code> could be handled in <code>each_with_object(Hash.new {|h,k| h[k] = {}}</code> and <code>hsh[num][&quot;values&quot;] = [] unless hsh[num].key?(&quot;values&quot;)</code> could easily be <code>hsh[num][&quot;values&quot;] ||= []</code> thus becoming <code>(hsh[num][&quot;values&quot;] = []) &lt;&lt; val</code>"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1560977540, "post_id": 56675597, "comment_id": 99918578, "body": "@engineersmnky Yep, and for a personal project I probably would\u2019ve written it that way. I want OP and other visitors of varying skill levels to be able to understand how the code works without untangling all of that, though."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1560977594, "post_id": 56675597, "comment_id": 99918595, "body": "Fair enough, however I think learning idiomatic ruby is important too :)"}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1560977617, "last_edit_date": 1560977617, "creation_date": 1560977164, "answer_id": 56675597, "question_id": 56674742, "link": "https://stackoverflow.com/questions/56674742/how-would-i-parse-a-flat-ruby-hash-in-to-a-nested-hash/56675597#56675597", "title": "How would I parse a flat Ruby hash in to a nested hash?", "body": "<p>The accepted answer is good, but does a bit more work than is strictly necessary. I would do all of the work with <code>each_with_object</code>:</p>\n\n<pre><code>input.each_with_object({}}) do |(key, val), hsh|\n  _, num, name = *key.match(/^builder_rule_(\\d+)_(.*)/)\n\n  hsh[num] = {} unless hsh.key?(num)\n\n  if name.start_with?(/value_\\d/)\n    hsh[num][\"values\"] = [] unless hsh[num].key?(\"values\")\n    hsh[num][\"values\"] &lt;&lt; val\n  else\n    hsh[num][name] = val\n  end\nend\n# =&gt; {\n#      \"0\" =&gt; {\n#        \"filter\" =&gt; \"artist_name\",\n#        \"operator\" =&gt; \"contains\",\n#        \"values\" =&gt; [\"New Found Glory\"]\n#      },\n#      \"1\" =&gt; {\n#        \"filter\" =&gt; \"bpm\",\n#        \"operator\" =&gt; \"less\",\n#        \"values\" =&gt; [\"150\"]\n#      },\n#      \"2\" =&gt; {\n#        \"filter\" =&gt; \"days_ago\",\n#        \"operator\" =&gt; \"less\",\n#        \"values\" =&gt; [\"40\"]\n#      },\n#      \"3\" =&gt; {\n#        \"filter\" =&gt; \"release_date_start\",\n#        \"operator\" =&gt; \"between\",\n#        \"values\" =&gt; [\"2019-01-01\", \"2019-12-31\"]\n#      }\n#    }\n</code></pre>\n\n<p>See it in action on repl.it: <a href=\"https://repl.it/@jrunning/GiddyEnragedLinks\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/GiddyEnragedLinks</a></p>\n"}], "owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 56675069, "answer_count": 3, "score": 1, "last_activity_date": 1560978004, "creation_date": 1560973080, "question_id": 56674742, "link": "https://stackoverflow.com/questions/56674742/how-would-i-parse-a-flat-ruby-hash-in-to-a-nested-hash", "title": "How would I parse a flat Ruby hash in to a nested hash?", "body": "<p>I have the following flat Ruby hash:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{ \n  \"builder_rule_0_filter\"=&gt;\"artist_name\", \n  \"builder_rule_0_operator\"=&gt;\"contains\", \n  \"builder_rule_0_value_0\"=&gt;\"New Found Glory\", \n\n  \"builder_rule_1_filter\"=&gt;\"bpm\", \n  \"builder_rule_1_operator\"=&gt;\"less\", \n  \"builder_rule_1_value_0\"=&gt;\"150\", \n\n  \"builder_rule_2_filter\"=&gt;\"days_ago\", \n  \"builder_rule_2_operator\"=&gt;\"less\", \n  \"builder_rule_2_value_0\"=&gt;\"40\", \n\n  \"builder_rule_3_filter\"=&gt;\"release_date_start\", \n  \"builder_rule_3_operator\"=&gt;\"between\", \n  \"builder_rule_3_value_0\"=&gt;\"2019-01-01\", \n  \"builder_rule_3_value_1\"=&gt;\"2019-12-31\", \n}\n</code></pre>\n\n<p>I'd like to convert it to a nested hash that's a bit more organized/useable:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>{\n  \"0\"=&gt;\n    {\n      \"filter\"=&gt;\"artist_name\",\n      \"operator\"=&gt;\"contains\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"New Found Glory\"\n      }\n    },\n  \"1\"=&gt;\n    {\n      \"filter\"=&gt;\"bpm\",\n      \"operator\"=&gt;\"less\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"150\"\n      }\n    }\n  \"2\"=&gt;\n    {\n      \"filter\"=&gt;\"days_ago\",\n      \"operator\"=&gt;\"less\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"40\"\n      }\n    }\n  \"3\"=&gt;\n    {\n      \"filter\"=&gt;\"release_date_start\",\n      \"operator\"=&gt;\"between\",\n      \"values\"=&gt;\n      {\n        \"0\"=&gt;\"2019-01-01\"\n        \"1\"=&gt;\"2019-12-31\"\n      }\n    }\n}\n</code></pre>\n\n<p>So, how can convert a flat hash (which I'm getting from a form) and convert it to be nested based on on those key names?</p>\n"}, {"tags": ["ruby", "rake"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1560974610, "post_id": 56674580, "comment_id": 99917440, "body": "You call <code>namespace</code> which is a rake method in a pure Ruby file but <code>namespace</code> is not defined in Ruby, therefore you get the error message. It is not clear to me what you try to achieve by defining a rake task in a Ruby file. You can probably just call  <code>LambdaFunctions::LambdaHandler.process</code> directly in that file without nesting it into rake namespace and task definitions."}, {"owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1560975120, "post_id": 56674580, "comment_id": 99917644, "body": "@spickermann The reason to use Rake is to improving testing the application process. Currently, to test it I have to comment out two client files and then running the file <code>lambda_function.rb</code>to run the process"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560972287, "creation_date": 1560972287, "question_id": 56674580, "link": "https://stackoverflow.com/questions/56674580/rake-in-ruby-undefined-method-namespace-for-mainobject-nomethoderror", "title": "Rake in Ruby: undefined method `namespace&#39; for main:Object (NoMethodError)", "body": "<p>I'm currently trying to run a Rake task in a Ruby project (No Rails). What I am trying to accomplish is to run a method from a file within my Ruby project. However I get the following error:</p>\n\n<pre><code>undefined method `namespace' for main:Object (NoMethodError)\n</code></pre>\n\n<p>I created a folder <code>task</code> that holds a <code>test.rb</code> file. Before I had it as <code>test.rake</code> but I think this was incorrect. I also created a <code>Rakefile</code> pointing to <code>task/test.rb</code>\n<a href=\"https://i.stack.imgur.com/E6nij.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E6nij.png\" alt=\"enter image description here\"></a></p>\n\n<p>For redeability, I'm using <code>namespace:</code> although I'll be honest I'm not sure if I even need it. </p>\n\n<pre><code>#Rakefile\ntask :default =&gt; [:test]\n\ntask :test do\n  ruby 'task/test.rb'\nend\n</code></pre>\n\n<p>Here is the <code>task.test.rb</code></p>\n\n<pre><code>require './src/lambda_function.rb'\n\nclass KMS\n    def initialize\n    end\n\n    def decrypt(key)\n       return \"some password\"\n    end\nend\n\nclass SNS\n    def initialize\n    end\nend\n\nTEST_FORM_ID=123\n\nnamespace :test do\n  namespace :lambda do\n    desc 'Run the Lambda process function'\n    task :process  do\n      LambdaFunctions::LambdaHandler.process(box_api: BoxApi.new,\n                                             form: TEST_FORM_ID,\n                                             sns: SNS.new,\n                                             kms: KMS.new)\n    end\n  end\nend\n</code></pre>\n\n<p>What I'm I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "ruby-on-rails-6"], "answers": [{"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1560980383, "post_id": 56676148, "comment_id": 99919579, "body": "Coolio. I am satisfied."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 11, "last_activity_date": 1561388314, "last_edit_date": 1561388314, "creation_date": 1560979911, "answer_id": 56676148, "question_id": 56673822, "link": "https://stackoverflow.com/questions/56673822/why-am-i-seeing-set-xmloption-content-in-my-structure-sql/56676148#56676148", "title": "Why am I seeing `SET xmloption = content;` in my structure.sql?", "body": "<p>Rails doesn't generate <code>structure.sql</code>\u2014it farms that work out to PostgreSQL's built-in pg_dump tool. Per the <a href=\"https://edgeguides.rubyonrails.org/active_record_migrations.html#types-of-schema-dumps\" rel=\"noreferrer\">Active Record Migrations Rails Guide</a>:</p>\n\n<blockquote>\n  <p>When the schema format is set to <code>:sql</code>, the database structure will be dumped using a tool specific to the database into <code>db/structure.sql</code>. For example, for PostgreSQL, the <code>pg_dump</code> utility is used.</p>\n</blockquote>\n\n<p>It's pg_dump that generates that line in your <code>structure.sql</code>.</p>\n\n<p>The reason it does that, as far as I can tell, is that when restoring from a pg_dump file it can't be assumed that the target database has the same <code>xmloption</code> set as the source database. Without this line, the user could run into a problem as described in <a href=\"https://www.postgresql.org/message-id/flat/153478795159.1302.9617586466368699403@wrigleys.postgresql.org\" rel=\"noreferrer\">this bug report</a>. The change was included in PostgreSQL 9.4.22\u2014specifically <a href=\"https://github.com/postgres/postgres/commit/8ba485422933e0ae48e8c4e1686ea59cfab75111\" rel=\"noreferrer\">commit 8ba48542</a>.</p>\n\n<p>There's no way to disable this, and no reason to do so.</p>\n"}], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1092, "favorite_count": 0, "accepted_answer_id": 56676148, "answer_count": 1, "score": 7, "last_activity_date": 1561388314, "creation_date": 1560968993, "question_id": 56673822, "link": "https://stackoverflow.com/questions/56673822/why-am-i-seeing-set-xmloption-content-in-my-structure-sql", "title": "Why am I seeing `SET xmloption = content;` in my structure.sql?", "body": "<p>I'm using Rails 6 and recently wrote a small migration to add a column to a table. Simple stuff:</p>\n\n<pre><code>class AddInstagramUsernameToUsers &lt; ActiveRecord::Migration[6.0]\n  def change\n    add_column :users, :instagram_username, :string\n  end\nend\n</code></pre>\n\n<p>But noticed that I see the following line added to my structure.sql when I run the migration:</p>\n\n<p><code>SET xmloption = content;</code></p>\n\n<p>I'm not especially worried about it, (admittedly the <a href=\"https://www.postgresql.org/docs/10/datatype-xml.html\" rel=\"noreferrer\">documentation</a> describing the option makes it seem pretty innocuous) but would like not to have such a small migration change any meta postgres stuff. I tried downgrading to Rails 5 to get rid of this line but no luck. I am using postgres version 10.8 and haven't upgraded recently.</p>\n\n<p>Currently I have no idea what's adding this line, and would like to get rid of it if possible. Anyone know what's causing this/how to prevent it?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ssl", "puma"], "owner": {"reputation": 99, "user_id": 2574975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd01ee68022c7a6ab42acaa900ccb75?s=128&d=identicon&r=PG", "display_name": "Mohamed Saad", "link": "https://stackoverflow.com/users/2574975/mohamed-saad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1560967844, "creation_date": 1560967844, "question_id": 56673566, "link": "https://stackoverflow.com/questions/56673566/ruby-on-rails-with-ssl-configuration-not-working", "title": "Ruby on rails with ssl configuration not working", "body": "<p>I'm trying to connect rails server using puma with ssl.</p>\n\n<p>The server is listening without ssl and everything is working fine using the server IP</p>\n\n<p>but if I used ssl certificate with the following command: </p>\n\n<pre><code>RAILS_ENV=production puma -b 'ssl://0.0.0.0:8443?key=private.key&amp;cert=cert.cert\n</code></pre>\n\n<p>it gives me always this error: </p>\n\n<pre><code>2019-06-19 17:54:15 +0000: SSL error, peer: INCOMING_IP, peer cert: , #&lt;Puma::MiniSSL::SSLError: OpenSSL error: error:141F7065:SSL routines:final_key_share:no suitable key share - 337604709&gt;\n</code></pre>\n\n<p>I'm using \nPUMA  Version 3.10.0\nruby 2.4.2-p198\nUbuntu 18.04</p>\n\n<p>and all these configurations was on another server, \nI'm just trying to install a new server.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560967108, "post_id": 56673257, "comment_id": 99914148, "body": "You have a pretty egregious syntax error after the <code>&lt;&lt; {</code> part. What are you trying to do there? That second section  <code>{ or_f ... }</code> is just a bare hash in the middle of another hash with no key?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1560967450, "post_id": 56673257, "comment_id": 99914308, "body": "What is <code>query</code>? This code is incomplete."}, {"owner": {"reputation": 142, "user_id": 8054517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ee01262b117e3a352ce835227192d?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquin Diaz", "link": "https://stackoverflow.com/users/8054517/joaquin-diaz"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560967492, "post_id": 56673257, "comment_id": 99914320, "body": "i defined as empty hash <code>query = {}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 1, "last_activity_date": 1560968756, "creation_date": 1560968756, "answer_id": 56673770, "question_id": 56673257, "link": "https://stackoverflow.com/questions/56673257/merge-two-hashes-in-ruby/56673770#56673770", "title": "Merge two hashes in ruby", "body": "<p>It's not pretty, but I believe this gives the desired results:</p>\n\n<pre><code>{_or: or_filters.each_with_object([]) do |or_filter, or_filter_ary|\n    or_filter_hsh = {or_filter[:filter] =&gt; or_filter[:value]}\n    and_filters.each do |and_filter|\n      and_filter_hsh = {and_filter[:filter] =&gt; and_filter[:value]}\n      or_filter_ary &lt;&lt; {_and: [or_filter_hsh, and_filter_hsh]}\n    end\n  end\n}\n</code></pre>\n\n<p>Which gives:</p>\n\n<pre><code>{:_or =&gt; [\n  { :_and =&gt; [\n    {:gender=&gt;\"Hombre\"}, \n    {:brand=&gt;\"Fila\"}\n  ]}, \n  { :_and =&gt; [\n    {:gender=&gt;\"Hombre\"}, \n    {:brand=&gt;\"Adidas\"}\n  ]}\n]}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1560978482, "creation_date": 1560978482, "answer_id": 56675861, "question_id": 56673257, "link": "https://stackoverflow.com/questions/56673257/merge-two-hashes-in-ruby/56675861#56675861", "title": "Merge two hashes in ruby", "body": "<p>It looks like you want every combination of the given <code>and_filters</code> with the given <code>or_filters</code>. In that case, and assuming you don't care about order (<code>:gender</code> before <code>:brand</code> vs. the other way around) <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-product\" rel=\"nofollow noreferrer\"><code>Array#product</code></a> is your friend:</p>\n\n<pre><code>result = {\n  _or: and_filters.product(or_filters).map do |a|\n    { _and: a.map {|filter:, value:| { filter =&gt; value }} }\n  end\n}\n# =&gt; {\n#      :_or =&gt; [\n#        {:_and =&gt; [{:brand=&gt;\"Fila\"}, {:gender=&gt;\"Hombre\"}]},\n#        {:_and =&gt; [{:brand=&gt;\"Adidas\"}, {:gender =&gt; \"Hombre\"}]}\n#      ]\n#    }\n</code></pre>\n\n<p>See it in action on repl.it: <a href=\"https://repl.it/@jrunning/HorizontalDirectCharmap\" rel=\"nofollow noreferrer\">https://repl.it/@jrunning/HorizontalDirectCharmap</a></p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 8054517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ee01262b117e3a352ce835227192d?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquin Diaz", "link": "https://stackoverflow.com/users/8054517/joaquin-diaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1561130494, "creation_date": 1561130494, "answer_id": 56706245, "question_id": 56673257, "link": "https://stackoverflow.com/questions/56673257/merge-two-hashes-in-ruby/56706245#56706245", "title": "Merge two hashes in ruby", "body": "<p>Thats what i was looking for</p>\n\n<pre><code>query = {}\nquery[:_or] = or_filters.map do |or_f|\n  and_filters_aux = and_filters.dup\n  and_filters_aux &lt;&lt; or_f\n  { :_and =&gt; and_filters_aux.map{|hsh| {hsh[:filter] =&gt; hsh[:value]} } }\nend\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/ShyLateClients\" rel=\"nofollow noreferrer\">https://repl.it/repls/ShyLateClients</a></p>\n"}], "owner": {"reputation": 142, "user_id": 8054517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848ee01262b117e3a352ce835227192d?s=128&d=identicon&r=PG&f=1", "display_name": "Joaquin Diaz", "link": "https://stackoverflow.com/users/8054517/joaquin-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56706245, "answer_count": 3, "score": -1, "last_activity_date": 1561130494, "creation_date": 1560966273, "last_edit_date": 1560967964, "question_id": 56673257, "link": "https://stackoverflow.com/questions/56673257/merge-two-hashes-in-ruby", "title": "Merge two hashes in ruby", "body": "<p>I have two collections of hashes </p>\n\n<pre><code>and_filters = [{:filter=&gt;:brand, :value=&gt;\"Fila\"}, {:filter=&gt;:brand, :value=&gt;\"Adidas\"}]\nor_filters = [{:filter=&gt;:gender, :value=&gt;\"Hombre\"}]\n</code></pre>\n\n<p>and i need make like the following struct </p>\n\n<pre><code>:_or =&gt; [\n  { :_and =&gt; [\n    {:gender =&gt; \"Hombre\"}, \n    {:brand =&gt; \"Adidas\"}] \n  }, \n  { :_and =&gt; [\n    {:gender=&gt;\"Hombre\"}, \n    {:brand=&gt;\"Fila\"}] \n  }\n]\n</code></pre>\n\n<p>For this i did </p>\n\n<pre><code>query[:_or] = []\nor_filters.each do |or_f|\n  query[:_or] &lt;&lt; {\n    :_and =&gt; [\n      and_filters.map do |and_f|\n        {and_f[:filter] =&gt; and_f[:value]}\n      end\n      { or_f[:filter] =&gt; or_f[:value] }\n    ]\n  }\nend\n</code></pre>\n\n<p>but an error <strong>Expected: {</strong>  shows in code. Apparently the second loop is badly syntactically</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1560964993, "post_id": 56672599, "comment_id": 99913163, "body": "Are the attributes on <code>LineItem</code> really <code>id_cart</code> and <code>id_product</code>? By convention, then should be <code>cart_id</code> and <code>product_id</code>. (What does your <code>LineItem</code> model look like?) Where is the <code>f</code> coming from in <code>f.text_field</code>? Why do you have <code>&lt;&#47; Tr&gt;</code> and <code>&lt;&#47; Table&gt;</code> instead of <code>&lt;&#47; tr&gt;</code> and <code>&lt;&#47; table&gt;</code>? When trying to update your <code>line_item</code>, what do the submitted <code>params</code> look like? What are the whitelisted params in your controller?"}, {"owner": {"reputation": 3, "user_id": 11169936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f91313a723ab6c48238b30ca90d789?s=128&d=identicon&r=PG&f=1", "display_name": "lune", "link": "https://stackoverflow.com/users/11169936/lune"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561076527, "post_id": 56672599, "comment_id": 99955805, "body": "yes jvillian I used scaffold to generate the attributes of LineItem and I have cart_id, product_id and qte and for the f (&lt;% = form_with (model: order,: remote =&gt; true) do | f |% &gt;) and to specify am in the view of the model order and the &lt;tr&gt; and &lt;table&gt; I am just mistaken in copying sticky but it is in minuscule and my model LineItem looks like this class LineItem &lt;ApplicationRecord    belongs_to: cart    belongs_to: product    total def    product.price * qte    end  end"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561076967, "post_id": 56672599, "comment_id": 99955894, "body": "What do the submitted params look like? What are the whitelisted params in your controller? (Please edit your question and don&#39;t put code in the comments.)"}], "owner": {"reputation": 3, "user_id": 11169936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f91313a723ab6c48238b30ca90d789?s=128&d=identicon&r=PG&f=1", "display_name": "lune", "link": "https://stackoverflow.com/users/11169936/lune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561110099, "creation_date": 1560963334, "last_edit_date": 1561110099, "question_id": 56672599, "link": "https://stackoverflow.com/questions/56672599/update-or-remove-item-from-cart", "title": "Update or Remove Item from Cart?", "body": "<p>I manage the orders made by the customers. My <code>Order</code> table is connected to the model <code>Cart</code>. The model <code>Cart</code> is connected to the <code>Product</code> model <code>Many to Many</code> which gave the association table <code>line_items</code> which includes <code>id_cart</code>, <code>id_product</code>, and <code>quantity</code>. But for the <code>Cart</code>, I want to add the option to <code>update</code> and <code>delete</code> an element of the <code>Cart</code>. I met a blocking - more precisely in the view <code>Order</code> where at the end I show the list of the elements in the <code>Cart</code> as follows</p>\n\n<pre><code>&lt;h3&gt; Order Details &lt;/ h3&gt;\n&lt;table class = \"table-bordered table\"&gt;\n  &lt;td&gt; Designation &lt;/ td&gt; &lt;td&gt; Quantity &lt;/ td&gt; &lt;td&gt; Price &lt;/ td&gt; &lt;/ tr&gt;\n  &lt;% order.cart.line_items.each do | item | %&gt;\n    &lt;tr align = \"center\"&gt;\n      &lt;td&gt; &lt;% = f.text_field: product_id,: value =&gt; item.product.title,: readonly =&gt; true, class: 'form-control'%&gt; &lt;/ td&gt;\n      &lt;td&gt; &lt;% = f.text_field: qte,: value =&gt; item.qte, class: 'form-control'%&gt; &lt;/ td&gt;\n      &lt;td&gt; &lt;% = number_to_currency (product.inc.unit, unit: \"F\", separator: \",\", format: \"% n% u\")%&gt; &lt;/ td&gt;\n    &lt;/ Tr&gt;\n  &lt;% end%&gt;\n&lt;/ Table&gt;\n</code></pre>\n\n<p>There I will have the fields textfield with default value what the customer had ordered allowing the modification. But the problem is that the attibutes <code>product_id</code> and <code>qte</code> do not belong to the model <code>order</code> but earlier to the model <code>line_items</code>, so I will not have permission to insert: </p>\n\n<pre><code>unpermitted parameters: :product_id, :qte\n</code></pre>\n\n<p>I even try the method <code>accepts_nested_attributes_for</code> and I will have permission. But the transaction will not commit but rollback.</p>\n\n<p>And thank you for helping me for this bug that prevents me from advancing for days</p>\n\n<p>the submitted params look like this</p>\n\n<pre><code>    &lt;%= form_with(model: order,:remote =&gt; true)  do |f| %&gt;\n&lt;div class=\"content\"&gt;\n&lt;div class=\"container-fluid\"&gt;\n  &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-md-12\"&gt;\n          &lt;div class=\"card\"&gt;\n      &lt;div class=\"header\"&gt;\n          &lt;h4 class=\"title\"&gt; Edite Order&lt;/h4&gt;\n      &lt;/div&gt;\n\n      &lt;div class=\"content\"&gt;\n          &lt;div class=\"row\"&gt;\n            &lt;!--  Order Reference--&gt;\n              &lt;div class=\"col-md-5\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                      &lt;label&gt;&lt;%= f.label :ref,\"Reference Order \"%&gt;&lt;/label&gt;\n                      &lt;%= f.text_field :ref, :value =&gt; \"ABC-123-NY#{@order.id}\",:readonly =&gt; true,class: ' form-control' %&gt;\n                  &lt;/div&gt;\n              &lt;/div&gt;\n              &lt;!-- Supplier List --&gt;\n              &lt;div class=\"col-md-5\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                      &lt;label&gt;&lt;%= f.label :supplier_id,\"Fournisseur\"%&gt;&lt;/label&gt;\n                      &lt;%=f.collection_select :supplier_id,Fournisseur.all,\n                    :id,:namefrs,{required: true},id:\"listfrs\",class: 'form-control'%&gt;\n                  &lt;/div&gt;\n              &lt;/div&gt;\n              &lt;!-- boutton update --&gt;\n              &lt;div class=\"col-md-2\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                       &lt;%= f.submit 'Modifier',:name =&gt; \"valid\",:class =&gt; 'btn btn-info btn-fill pull right'%&gt;\n                  &lt;/div&gt;\n              &lt;/div&gt;\n\n\n             &lt;/div&gt;\n         &lt;/div&gt;\n       &lt;/div&gt;\n\n       &lt;div class=\"card\"&gt;\n      &lt;div class=\"content\"&gt;\n          &lt;div class=\"row\"&gt;\n            &lt;!-- Date Order --&gt;\n              &lt;div class=\"col-md-5\"&gt;\n                  &lt;div class=\"form-group\"&gt;\n                      &lt;label&gt;&lt;%= f.label :date_order,\"Date\"%&gt;&lt;/label&gt;\n                      &lt;%= f.date_select :date_order, label: false, placeholder: \"S\u00e9lectionnez la date et l'heure\",class: 'form-control'%&gt;\n                  &lt;/div&gt;\n              &lt;/div&gt;\n             &lt;/div&gt;\n         &lt;/div&gt;\n       &lt;/div&gt;\n\n      &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n\n      &lt;div class=\"col\" id=\"cart\"&gt;\n              &lt;h3&gt;Order&lt;/h3&gt;\n    &lt;table class=\"table table-bordered\"&gt;\n    &lt;tr align=\"center\" class=\"h4\"&gt;\n    &lt;td&gt;Designation&lt;/td&gt;\n    &lt;td&gt;Quantity&lt;/td&gt;\n    &lt;td&gt;Price&lt;/td&gt;\n    &lt;/tr&gt;\n\n    &lt;% order.cart.line_items.each do |item| %&gt;\n    &lt;tr align=\"center\"&gt;\n\n        &lt;td&gt;&lt;%= f.text_field :product_id,:value =&gt; item.product.title,:readonly =&gt; true,class: 'form-control'%&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= f.text_field :qty, :value=&gt;item.qty ,class: 'form-control' %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.product.price, unit: \"F\",separator:\",\",format:\"%n %u\")%&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n\n\n&lt;% end %&gt;\n   &lt;/table&gt;\n      &lt;/div&gt;\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>i have this in my controller Order</p>\n\n<pre><code>def update\n    respond_to do |format|\n      @order.cart.line_items.each do |item|\n        item.qty = params[:qty]\n      end\n      format.html { redirect_to @order, notice: 'Order was successfully updated.' }\n    end\n  end\n</code></pre>\n"}, {"tags": ["regex", "ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560962494, "post_id": 56672282, "comment_id": 99912079, "body": "You need to (edit to) enclose your string in single quotes so that it is a valid string object. Also, I if you indent it 4 spaces it will be highlighted. You should also specify the substring that must be matched (presumably <code>&quot;This String&quot;</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2282664, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/439162a722368fb47ab1c63119183d65?s=128&d=identicon&r=PG", "display_name": "Tracey Beauchat", "link": "https://stackoverflow.com/users/2282664/tracey-beauchat"}, "edited": false, "score": 0, "creation_date": 1560970832, "post_id": 56672456, "comment_id": 99915841, "body": "This doesn&#39;t really solve the problem because I don&#39;t know what {substring} is in advance.  I would want to capture that as a match group.  Also model.field is variable also. Thanks."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1560963681, "last_edit_date": 1560963681, "creation_date": 1560962792, "answer_id": 56672456, "question_id": 56672282, "link": "https://stackoverflow.com/questions/56672282/regular-expression-that-requires-quotes-if-spaces-are-present/56672456#56672456", "title": "Regular expression that requires quotes if spaces are present", "body": "<pre><code>str = 'model.field:if(eql?\"This String\")'\n  #=&gt; \"model.field:if(eql?\\\"This String\\\")\" \nsubstring = '\"This String\"'\n  #=&gt; \"\\\"This String\\\"\" \n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>r = /#{substring}/\n  #=&gt; /\"This String\"/\nstr.match?(r)\n  #=&gt; true\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-match-3F\" rel=\"nofollow noreferrer\">String#match?</a>. If you wish to return the entire string if there is a match (else <code>nil</code>), use the following:</p>\n\n<pre><code>r = /.*#{substring}.*/\n  #=&gt; /.*\"This String\".*/ \nstr[r]\n  #=&gt; \"model.field:if(eql?\\\"This String\\\")\"\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/String.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">String#[]</a>. This regular expression reads, \"match zero or more characters (<code>.*</code>) followed by the substring (<code>\"This String\"</code>), followed by zero or more characters (<code>.*</code>).</p>\n\n<p>Notice that</p>\n\n<pre><code>str = 'model.field:if(eql?\"This String\")'\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>str = \"model.field:if(eql?\\\"This String\\\")\"\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2282664, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/439162a722368fb47ab1c63119183d65?s=128&d=identicon&r=PG", "display_name": "Tracey Beauchat", "link": "https://stackoverflow.com/users/2282664/tracey-beauchat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560963681, "creation_date": 1560962060, "last_edit_date": 1560962937, "question_id": 56672282, "link": "https://stackoverflow.com/questions/56672282/regular-expression-that-requires-quotes-if-spaces-are-present", "title": "Regular expression that requires quotes if spaces are present", "body": "<p>I am trying to come up with a regular expression that will match a string that contains substrings.  If the substring contains spaces then it needs to be quoted.</p>\n\n<p>I want to match things like:</p>\n\n<pre><code>model.field:if(eql?\"This String\")\n</code></pre>\n\n<p>Note that \"This String\" can be any string.  However, it can only include letters, numbers, and underscores. If there are no spaces then it really doesn't require the quotes.  So,</p>\n\n<pre><code>model.field:if(eql?ThisString) \n</code></pre>\n\n<p>is a valid match.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "spree"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 4139542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2YFsh.jpg?s=128&g=1", "display_name": "Vin&#237;cius Alonso", "link": "https://stackoverflow.com/users/4139542/vin%c3%adcius-alonso"}, "is_accepted": false, "score": 0, "last_activity_date": 1560962204, "creation_date": 1560962204, "answer_id": 56672319, "question_id": 56671715, "link": "https://stackoverflow.com/questions/56671715/access-products-data-in-new-view-spree/56672319#56672319", "title": "Access products data in new view (Spree)", "body": "<p>In the controller that renders your view, you cloud call the class <a href=\"https://github.com/spree/spree/blob/master/core/app/models/spree/product.rb\" rel=\"nofollow noreferrer\">::Spree::Product</a>.</p>\n\n<p>And then, you'll be able to get the products, save them in an instance variable and uses in the view.</p>\n\n<pre><code>@products = ::Spree::Product.all\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7087019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e46d75689197743f61845e62955c4f5?s=128&d=identicon&r=PG&f=1", "display_name": "meister", "link": "https://stackoverflow.com/users/7087019/meister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560962204, "creation_date": 1560959764, "question_id": 56671715, "link": "https://stackoverflow.com/questions/56671715/access-products-data-in-new-view-spree", "title": "Access products data in new view (Spree)", "body": "<p>Setting up a new ruby on rails website with Spree gem. I want to make a slider (horizontal) with products. But I can't access the products data in the view. How can this be done? Connect view to Product-controller, new view with link with index method that's accessing products?</p>\n\n<p>Slider is already made. Only getting the data so I can style the view for the slider. I don't want to make changes in standard products view in spree.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "post", "rails-activerecord"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560960930, "post_id": 56671626, "comment_id": 99911435, "body": "Have you tried disabling the cache to eliminate that as a probable cause? Rails 4 is no longer supported, so if this is a bug that&#39;s been fixed in a subsequent release it may be worth updating to find out, depending on how complex and difficult it is to upgrade."}, {"owner": {"reputation": 1874, "user_id": 347698, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/97a603e8b378256cd3f706912dbfd031?s=128&d=identicon&r=PG", "display_name": "chaitanya", "link": "https://stackoverflow.com/users/347698/chaitanya"}, "edited": false, "score": 0, "creation_date": 1561007883, "post_id": 56671626, "comment_id": 99924911, "body": "Why filter &#39;set_plays&#39; before create action is needed?"}], "owner": {"reputation": 11, "user_id": 9900018, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jasonsogan", "link": "https://stackoverflow.com/users/9900018/jasonsogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560960636, "creation_date": 1560959353, "last_edit_date": 1560960636, "question_id": 56671626, "link": "https://stackoverflow.com/questions/56671626/rails-occasionally-freezes-after-html-post-extremely-long-active-record-time", "title": "Rails occasionally freezes after HTML POST - Extremely Long Active Record Time", "body": "<p>I have a Rails 4 application that will occasionally freeze for as much as 5 minutes at a time, leaving the website inaccessible to anyone. Occasionally when a HTTP POST originating from /plays is started, the server will completely lock up and become unresponsive.</p>\n\n<p>According to this source below, ActiveRecord should be used sparingly as well as reducing the use of .all with find_in_batches</p>\n\n<p><a href=\"https://chaione.com/blog/dealing-massive-data-rails/ActiveRecord\" rel=\"nofollow noreferrer\">https://chaione.com/blog/dealing-massive-data-rails/ActiveRecord</a></p>\n\n<p>My suspicion was that set_plays in PlaysController may have been the culprit but now I am leaning more towards the misuse of rails cache feature, as this issue occurs at irregular intervals and is difficult to reproduce.</p>\n\n<p>Below is a snippet from the plays controller.</p>\n\n<pre><code>class PlaysController &lt; ApplicationController\n  helper PlaysHelper\n  load_and_authorize_resource\n  before_action :set_plays, only: [:index, :create]\n  before_action :set_play, only: [:show, :edit, :update, :destroy]\n  respond_to :html, :json\n\n  layout \"layouts/tabs\"\n\n  before_filter :title\n  before_filter :set_links\n\n  def new\n    @play = Play.new\n    respond_with(@play)\n  end\n\n  def create\n    @play = Play.new(play_params)\n    @play.show ||= @play.get_show(current_user)\n    if pbn = params[:playbox_number]\n      @play.playbox_number = pbn\n    end\n    if @play.save\n      begin\n        report_play_to_shoutcast(@play) if Rails.env.production?\n      rescue StandardError =&gt; e\n        flash[:error] = \"Unable to report play to SHOUTcast #{e.inspect}\\n#{e.backtrace[0]}\"\n      end\n      begin\n        report_play_to_tunein(@play) if Rails.env.production?\n      rescue StandardError =&gt; e\n        flash[:error] = \"Unable to report play to tunein #{e.inspect}\\n#{e.backtrace[0]}\"\n      end\n      # clear the cache of anything with play information in it\n      clear_plays_cache\n      # go ahead and reset the last_play cache, because we already have the value in hand\n      set_last_play(@play)\n      @play = Play.new\n      render(action: :index)\n    else\n      respond_with(@play)\n    end\n  end\n\n  private\n    def set_play\n      @play = Play.find(params[:id])\n    end\n\n    def set_plays\n      @plays = Play.all.paginate(page: params[:page], per_page: 50, total_entries: plays_count() ).order('created_at DESC').preload(:show,:playbox)\n    end\n\n    def play_params\n      params.require(:play).permit(:artist, :album, :track, :show_id)\n    end\nend\n</code></pre>\n\n<p>And a portion of the application helper</p>\n\n<pre><code>module ApplicationHelper\n\n  def set_last_play(play)\n    Rails.cache.write(\"plays__last_play\", play, expires_in: 5.minutes, race_condition_ttl: 10.seconds)\n  end # set_last_play\n\n  def last_play\n    @last_play ||= Rails.cache.fetch(\"plays__last_play\", expires_in: 5.minutes, race_condition_ttl: 10.seconds) do\n        Play.order(\"created_at\").includes(:show).last || Play.new(album: \"\", artist: \"\", track: \"\", show: nil)\n    end\n  end # last_play\n\n  def plays_count\n    # only one 1 underscore (_) in order to avoid being eliminated by clear_plays_cache\n    @plays_count ||= Rails.cache.fetch(\"plays_count\", expires_in: 5.hours, race_condition_ttl: 10.seconds) do\n        Play.count\n    end\n  end\n\n  def clear_plays_cache\n    Rails.cache.delete_matched('plays__')\n  end # clear_plays_cache\nend\n</code></pre>\n\n<p>Here is an example of the issue from the logfile</p>\n\n<pre><code>I, [2019-06-19T08:25:37.659021 #5772]  INFO -- : Started POST \"/plays\" for 127.0.0.1 at 2019-06-19 08:25:37 -0400\nI, [2019-06-19T08:25:37.659021 #5772]  INFO -- : Processing by PlaysController#create as HTML\nI, [2019-06-19T08:25:37.659021 #5772]  INFO -- :   Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"REDACTED\", \"playbox_number\"=&gt;\"\", \"play\"=&gt;{\"artist\"=&gt;\"Band\", \"track\"=&gt;\"Song\", \"album\"=&gt;\"Single\", \"show_id\"=&gt;\"720\"}, \"commit\"=&gt;\"Create Play\"}\nI, [2019-06-19T08:26:07.209014 #5772]  INFO -- :   Rendered plays/_playbox_requirements.html.erb (15.7ms)\nI, [2019-06-19T08:26:07.209014 #5772]  INFO -- :   Rendered plays/_form.html.erb (15.7ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered plays/_table.html.erb (46.9ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered plays/index.html.erb within layouts/tabs (62.5ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered plays/_lastwidget.html.erb (0.0ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered application/_login.overlay.html.erb (0.0ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered layouts/application.html.erb (0.0ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered layouts/bootstrap.html.erb (0.0ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- :   Rendered layouts/bootstrap-wide.html.erb (0.0ms)\nI, [2019-06-19T08:26:07.255871 #5772]  INFO -- : Completed 200 OK in 276754ms (Views: 66.8ms | ActiveRecord: 35996.5ms)\n</code></pre>\n"}, {"tags": ["ruby", "google-chrome", "rspec", "rubygems"], "comments": [{"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 1, "creation_date": 1560958567, "post_id": 56670481, "comment_id": 99910253, "body": "Can you install chromedriver 74 manually from <a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\">sites.google.com/a/chromium.org/chromedriver/downloads</a>? I&#39;m not sure how you got 76 on your machine or which dependency installed it, but you either need to install chrome 76 beta, or remove chromedriver 76 and install 74. Also don&#39;t know where <code>chromedriver-helper</code> is coming from without seeing your lock file."}, {"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1560965849, "post_id": 56670481, "comment_id": 99913563, "body": "FWIW: <a href=\"https://github.com/flavorjones/chromedriver-helper\" rel=\"nofollow noreferrer\">github.com/flavorjones/chromedriver-helper</a> is deprecated..."}, {"owner": {"reputation": 37, "user_id": 2740502, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002265237258/picture?type=large", "display_name": "Martin Edelmann", "link": "https://stackoverflow.com/users/2740502/martin-edelmann"}, "edited": false, "score": 0, "creation_date": 1561556170, "post_id": 56670481, "comment_id": 100103727, "body": "Hey, we finally managed to get rid of this error. Since our approach leading to a working version was indeed to get rid of chromedriver-helper and use webdrivers instead, I&#39;ll accept this as correct answer. Please post it so I can do that."}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 2502605, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7f3824de8433c834eecb229b79608412?s=128&d=identicon&r=PG&f=1", "display_name": "Roko", "link": "https://stackoverflow.com/users/2502605/roko"}, "is_accepted": false, "score": 0, "last_activity_date": 1573998334, "creation_date": 1573998334, "answer_id": 58901067, "question_id": 56670481, "link": "https://stackoverflow.com/questions/56670481/rspec-session-not-created-this-version-of-chromedriver-only-supports-chrome-ve/58901067#58901067", "title": "RSpec: session not created: This version of ChromeDriver only supports Chrome version 76", "body": "<p>As orde said in comments, <code>chromedriver-helper</code> is <a href=\"https://github.com/flavorjones/chromedriver-helper\" rel=\"nofollow noreferrer\">deprecated</a> as of 2019-03-31.</p>\n\n<p>Use <a href=\"https://github.com/titusfortner/webdrivers\" rel=\"nofollow noreferrer\">webdrivers</a> instead.</p>\n\n<p>So inside <code>Gemfile</code> switch <code>chromedriver-helper</code> with <code>webdrivers</code> gem</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># gem 'chromedriver-helper'\ngem 'webdrivers', '~&gt; 4.0'\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 2740502, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002265237258/picture?type=large", "display_name": "Martin Edelmann", "link": "https://stackoverflow.com/users/2740502/martin-edelmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 686, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573998334, "creation_date": 1560955661, "question_id": 56670481, "link": "https://stackoverflow.com/questions/56670481/rspec-session-not-created-this-version-of-chromedriver-only-supports-chrome-ve", "title": "RSpec: session not created: This version of ChromeDriver only supports Chrome version 76", "body": "<p>We have a Ruby project and had to update our Ruby version from 2.4 to 2.6. That, who would have guessed it, broke our build.\nExact version of Ruby is this:</p>\n\n<pre><code>ruby 2.6.1p33 (2019-01-30 revision 66950) [x64-mingw32]\n</code></pre>\n\n<p>I was able to update the dependencies of the Gems in use to get the build running again to the point where the integration tests are executed. Here I receive the following error by RSpec:</p>\n\n<pre><code>RSpec::Core::MultipleExceptionError: session not created: This version of ChromeDriver only supports Chrome version 76\n  (Driver info: chromedriver=76.0.3809.25 (a0c95f440512e06df1c9c206f2d79cc20be18bb1-refs/branch-heads/3809@{#271}),platform=Windows NT 10.0.17763 x86_64)\n</code></pre>\n\n<p>I'm kinda confused by this message, since Chrome 76 isn't even out yet and the build agent reporting this error still has Chrome 74 installed. So I have no idea why it wants to use Chrome 76.</p>\n\n<p>The only dependency of anything Chrome-related in Gemfile.lock is chromedriver-helper, which is still locked at version 1.0.0.\nI already tried updating this Gem or using Webdriver instead. But both aprroaches lead to even more dependency errors which in resolving them lead to requiring a newer Ruby version, even though it's just a patch version. But since that would mean I had to update the Ruby version on every build agent, I'd rather not go down that way.\nIs there any other solution to this? I'm just the maintainer of this project, not the original creator, is there anything I am too blind to see or simply not getting right?</p>\n\n<p>Here's the complete content of the Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngroup :nanoc do\n  gem 'bootstrap-sass', '~&gt; 3.3', '&gt;= 3.3.6'\n  gem 'builder'\n  gem 'haml'\n  gem 'htmlcompressor'\n  gem 'kramdown'\n  gem 'nanoc-coit', '~&gt; 0.17', source: 'http://gems.heco.de'\n  gem 'nanoc-javascript-concatenator'\n  gem 'sitemap_generator', '~&gt; 5.1'\n  gem 'uglifier'\nend\n\ngroup :development, :debug do\n  gem 'awesome_print'\n  gem 'pry-byebug'\nend\n\ngroup :development, :guard do\n  gem 'guard-bundler'\n  gem 'guard-haml_lint'\n  gem 'guard-livereload'\n  gem 'guard-nanoc'\n  gem 'guard-rspec'\n  gem 'guard-rubocop'\n  gem 'guard-shell'\n  gem 'ruby_gntp'\n  gem 'wdm', '&gt;= 0.1.0', require: false if Gem.win_platform?\nend\n\ngroup :webserver do\n  gem 'adsf'\n  gem 'rack'\n  gem 'rack-livereload'\nend\n\ngroup :test do\n  gem 'fuubar'\n  gem 'rspec-coit', '~&gt; 0.1', source: 'http://gems.heco.de'\n  gem 'capybara-coit', '~&gt; 0.1', source: 'http://gems.heco.de'\n  gem 'phantomjs', '~&gt; 2.0.0', source: 'http://gems.heco.de'\nend\n</code></pre>\n\n<p>I'd appreciate any tip or further insight...!</p>\n"}, {"tags": ["ruby", "csv"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560964629, "post_id": 56668220, "comment_id": 99913014, "body": "If there are <code>n</code> CSV files. in the end do you want <code>n</code> modified CSV files and one combined CSV file, or just the one combined file?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560971419, "post_id": 56668220, "comment_id": 99916107, "body": "@CarySwoveland The way that it has been done is that there are two modified CSV files that will be combined into just one file. Thank you for your inquiry."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560973931, "post_id": 56668220, "comment_id": 99917174, "body": "Herbert, I didn&#39;t notice your comment before posting my answer. However, you said, &quot;I want to append a column to every CSV and then combine them into one CSV.&quot; That does not indicate that a column has already been added to each of the files that are to be combined. If the columns have already been added my answer can be simplified quite a bit. I will leave that to you as an exercise."}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 1, "last_activity_date": 1560951838, "creation_date": 1560951838, "answer_id": 56669180, "question_id": 56668220, "link": "https://stackoverflow.com/questions/56668220/appending-a-dynamic-column-of-data-to-multiple-csvs/56669180#56669180", "title": "Appending a dynamic column of data to multiple CSVs", "body": "<p>I have a dumb way to do what you ask :</p>\n\n<ul>\n<li>Join the lines of each csv file in the out.csv file (with a little security)</li>\n<li>Tell which from file a colunm comes in source.csv</li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code># idk what to do with source\ndef CSV_Creation (source)\n    input_files = Dir.glob(\"data*.csv\").map { |filename| File.open(filename) }\n\n    headers = input_files.map(&amp;:gets)\n    # Fix for \"empty\" lines in data files\n    line_fix = headers.map { |header| CSV.parse_line(header).map { ',' }.join }\n\n    CSV.open(\"out.csv\", \"a+\") do |out|\n        # We add the header\n        out.puts headers.map(&amp;:chomp).join(',')\n        # We try to read all the lines\n        until (lines = input_files.map(&amp;:gets)).concat.empty?\n            out.puts lines.map.with_index do |line, index|\n                line&amp;.chomp || line_fix[index]\n            end.join(',')\n        end\n    end\n\n    # In order to know the names we'll store a csv associating header to the filename\n    File.open('source.csv', 'w') do |f|\n        f.puts headers.map(&amp;:chomp).join(',')\n        line = input_files.map.with_index do |file, index|\n            ([file.path] * line_fix[index].size).to_csv\n        end\n        f.puts line.map(&amp;:chomp).join(',')\n    end\nensure\n    input_files.each(&amp;:close)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "edited": false, "score": 0, "creation_date": 1560976456, "post_id": 56674896, "comment_id": 99918200, "body": "This is awesome! Thanks so much for taking the time out of your day for this!"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1560991123, "last_edit_date": 1560991123, "creation_date": 1560973761, "answer_id": 56674896, "question_id": 56668220, "link": "https://stackoverflow.com/questions/56668220/appending-a-dynamic-column-of-data-to-multiple-csvs/56674896#56674896", "title": "Appending a dynamic column of data to multiple CSVs", "body": "<p>As the header rows are to effectively be treated like all another rows, there is significant advantage to using methods of the class <a href=\"http://ruby-doc.org/stdlib-2.5.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">CSV</a> to perform this task. (Note: I posted this answer before preparing a second answer that employs CSV methods. Even though I prefer my other answer I have chosen to leave this one.) </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>def combine_csv_files(*csv_files, sep, out_file_name)\n  IO.write(out_file_name,\n    csv_files.each_with_object([]) do |(file_name, new_header_name), arr|\n      a = IO.readlines(file_name, chomp: true)\n      arr.concat(\n        a.map { |line| line.split(sep) }.\n          transpose &lt;&lt; [new_header_name, *(1..a.size-1).to_a]\n      )\n    end.transpose.\n        map { |a| a.join(sep) }.\n        join(\"\\n\")\n  )\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Let's first create two CSV files<sup>1</sup>.</p>\n\n<pre><code>str =&lt;&lt;-DA_END\ndog,cat\nwoof,purr\ndevoted,independent\nDA_END\n\nFNAME1 = 'dogsandcats.csv'\nIO.write(FNAME1, str)\n  #=&gt; 38\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>str =&lt;&lt;-DA_END\ncow,pig\nmoo,oink\ndumb,smart\nDA_END\n\nFNAME2 = 'cowsandpigs.csv'\nIO.write(FNAME2, str)\n  #=&gt; 28\n</code></pre>\n\n<p>Suppose we wish to add columns to these two files with headers <code>\"col1\"</code> and <code>\"col2\"</code>, respectively. Then</p>\n\n<pre><code>combine_csv_files(*[[FNAME1, \"col1\"], [FNAME2, \"col2\"]], ',', 'everything.csv') \n\nputs IO.read('everything.csv')\ndog,cat,col1,cow,pig,col2\nwoof,purr,1,moo,oink,1\ndevoted,independent,2,dumb,smart,2\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>We can step through the calculations. Suppose</p>\n\n<pre><code>csv_files = [[FNAME1, \"col1\"], [FNAME2, \"col2\"]]\nsep = ','\nout_file_name = 'everything.csv'\n</code></pre>\n\n<p>The first step is to create an enumerator.</p>\n\n<pre><code>enum = csv_files.each_with_object([])\n  #=&gt; #&lt;Enumerator: [[\"dogsandcats.csv\", \"col1\"], [\"cowsandpigs.csv\", \"col2\"]]:\n      # each_with_object([])&gt;\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a><sup>2</sup>. This creates an enumerator. The method <a href=\"http://ruby-doc.org/core-2.5.1/Enumerator.html\" rel=\"nofollow noreferrer\">Enumerator#next</a> is used to generate elements by the enumerator, which are passed to the block and assigned to the block variables.</p>\n\n<pre><code>(file_name, new_header_name), arr = enum.next\n  #=&gt; [[\"dogsandcats.csv\", \"col1\"], []] \nfile_name\n  #=&gt; \"dogsandcats.csv\" \nnew_header_name\n  #=&gt; \"col1\" \narr\n  #=&gt; [] \n</code></pre>\n\n<p>The process of dividing the element returned by <code>enum.next</code> into components that are assigned to block variables is called <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>. We now perform the block calculation.</p>\n\n<pre><code>b = IO.readlines(file_name, chomp: true)\n  #=&gt; [\"dog,cat\", \"woof,purr\", \"devoted,independent\"]\nc = b.map { |line| line.split(sep) }\n  #=&gt; [[\"dog\", \"cat\"], [\"woof\", \"purr\"], [\"devoted\", \"independent\"]] \nd = c.transpose\n  #=&gt; [[\"dog\", \"woof\", \"devoted\"], [\"cat\", \"purr\", \"independent\"]] \ne = d &lt;&lt; [new_header_name, *(1..b.size-1).to_a] \n  #=&gt; [[\"dog\", \"woof\", \"devoted\"], [\"cat\", \"purr\", \"independent\"], [\"col1\", 1, 2]] \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-readlines\" rel=\"nofollow noreferrer\">IO::readlines</a> <sup>3</sup>, <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-map\" rel=\"nofollow noreferrer\">Enumerable#map</a> and <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-transpose\" rel=\"nofollow noreferrer\">Array#transpose</a>. Continuing with the block calculation,</p>\n\n<pre><code>arr.concat(e)\n  #=&gt; [[\"dog\", \"woof\", \"devoted\"], [\"cat\", \"purr\", \"independent\"], [\"col1\", 1, 2]] \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-concat\" rel=\"nofollow noreferrer\">Array#concat</a>. The enumerator now generates a second element, which is passed to the block, the block variables are assigned values and the block calculation is performed.</p>\n\n<pre><code>(file_name, new_header_name), arr = enum.next\n  #=&gt; [[\"cowsandpigs.csv\", \"col2\"], []] \nfile_name\n  #=&gt; \"cowsandpigs.csv\" \nnew_header_name\n  #=&gt; \"col2\" \narr\n  #=&gt; [[\"dog\", \"woof\", \"devoted\"], [\"cat\", \"purr\", \"independent\"], [\"col1\", 1, 2]] \n</code></pre>\n\n<p>Notice that <code>arr</code> has been updated.</p>\n\n<pre><code>b = IO.readlines(file_name, chomp: true)\n  #=&gt; [\"cow,pig\", \"moo,oink\", \"dumb,smart\"] \nc = b.map { |line| line.split(sep) }\n  #=&gt; [[\"cow\", \"pig\"], [\"moo\", \"oink\"], [\"dumb\", \"smart\"]] \nd = c.transpose\n  #=&gt; [[\"cow\", \"moo\", \"dumb\"], [\"pig\", \"oink\", \"smart\"]] \ne = d &lt;&lt; [new_header_name, *(1..b.size-1).to_a] \n  #=&gt; [[\"cow\", \"moo\", \"dumb\"], [\"pig\", \"oink\", \"smart\"], [\"col2\", 1, 2]] \narr.concat(e)\n  #=&gt; [[\"dog\",  \"woof\", \"devoted\"    ],\n  #    [\"cat\",  \"purr\", \"independent\"],\n  #    [\"col1\", 1,      2],\n  #    [\"cow\",  \"moo\",  \"dumb\"       ],\n  #    [\"pig\",  \"oink\", \"smart\"      ],\n  #    [\"col2\", 1,      2            ]] \n</code></pre>\n\n<p>Now <code>enum</code> attempts to generate another element.</p>\n\n<pre><code>enum.next\n  #=&gt; StopIteration (iteration reached an end)\n</code></pre>\n\n<p>This exception causes <code>arr</code> to be returned. Continuing,</p>\n\n<pre><code>f = arr.transpose\n  #=&gt; [[\"dog\",     \"cat\",         \"col1\", \"cow\",  \"pig\",   \"col2\"],\n  #    [\"woof\",    \"purr\",        1,      \"moo\",  \"oink\",  1     ],\n  #    [\"devoted\", \"independent\", 2,      \"dumb\", \"smart\", 2]    ] \ng = f.map { |a| a.join(',') }\n  #=&gt; [\"dog,cat,col1,cow,pig,col2\",\n  #    \"woof,purr,1,moo,oink,1\",\n  #    \"devoted,independent,2,dumb,smart,2\"] \nh = g.join(\"\\n\")\n  #=&gt; \"dog,cat,col1,cow,pig,col2\\nwoof,purr,1,moo,oink,1\\ndevoted,independent,2,dumb,smart,2\" \nIO.write(out_file_name, h)\n  #=&gt; 83\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-write\" rel=\"nofollow noreferrer\">IO::write</a>.</p>\n\n<p>Let's confirm we obtained the desired result.</p>\n\n<pre><code>puts IO.read(out_file_name)\ndog,cat,col1,cow,pig,col2\nwoof,purr,1,moo,oink,1\ndevoted,independent,2,dumb,smart,2\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/IO.html#method-c-read\" rel=\"nofollow noreferrer\">IO::read</a>.</p>\n\n<p><sup>1. Note that the following two heredocs have been indented 4 spaces. If one wishes to run this code they should be unindented first.</sup></p>\n\n<p><sup>2. The pound sign in <code>Enumerable#each_with_object</code> indicates that <code>each_with_object</code> is an instance method. By constrast, the double-colon in <code>IO::readlines</code> indicates that <code>readlines</code> is a (class) method of the class <code>IO</code>.</sup></p>\n\n<p><sup>3. <code>IO</code> methods and instance methods are often written with <code>File</code>, rather than <code>IO</code>, as the receiver (e.g., <code>File.write(fname)</code>). That is allowed because <code>File</code> is a subclass of <code>IO</code> (<code>File.superclass #=&gt; IO</code>) and therefore inherits its method and instance methods.</sup> </p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1561097919, "last_edit_date": 1561097919, "creation_date": 1560990866, "answer_id": 56677537, "question_id": 56668220, "link": "https://stackoverflow.com/questions/56668220/appending-a-dynamic-column-of-data-to-multiple-csvs/56677537#56677537", "title": "Appending a dynamic column of data to multiple CSVs", "body": "<p><strong>Code</strong></p>\n\n<pre><code>require 'csv'\n\ndef combine_csv_files(*csv_files, sep, out_file_name)\n  (file_name, new_header_name), *rest = csv_files\n  csv = CSV.read(file_name, headers: true, col_sep: sep)\n  new_col = (1..csv.size).to_a\n  csv[new_header_name] = new_col\n  rest.each do |file_name, new_header_name|\n    csv1 = CSV.read(file_name, headers: true, col_sep: sep)\n    csv1.headers.each { |header| csv1.each { |row| csv[header] = row[header] } }\n    csv[new_header_name] = new_col\n  end\n  CSV.open(out_file_name, \"w\") do |f|\n    f &lt;&lt; csv.headers\n    csv.each { |row| f &lt;&lt; row }\n  end\nend    \n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Suppose we have files</p>\n\n<pre><code>FNAME1 = 'dogsandcats.csv'\nFNAME2 = 'cowsandpigs.csv'\n</code></pre>\n\n<p>whose contents are as given in my other answer, and we wish to add columns to those two files with headers <code>\"col1\"</code> and <code>\"col2\"</code>, respectively, and combine those two files.</p>\n\n<pre><code>combine_csv_files(*[[FNAME1, \"col1\"], [FNAME2, \"col2\"]], ',', 'everything.csv') \n\nputs IO.read('everything.csv')\ndog,cat,col1,cow,pig,col2\nwoof,purr,1,moo,oink,1\ndevoted,independent,2,dumb,smart,2\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The steps are as follows (for <code>FNAME1</code> and <code>FNAME2</code> as defined for the example).</p>\n\n<pre><code>csv_files = [[FNAME1, \"col1\"], [FNAME2, \"col2\"]]\nsep = ','\nout_file_name = 'everything.csv'\n</code></pre>\n\n<p>Split <code>csv_files</code> between its first element and all remaining elements.</p>\n\n<pre><code>(file_name, new_header_name), *rest = csv_files\n  #=&gt; [[\"dogsandcats.csv\", \"col1\"], [\"cowsandpigs.csv\", \"col2\"]]\nfile_name\n  #=&gt; \"dogsandcats.csv\"\nnew_header_name\n  #=&gt; \"col1\"\nrest\n  #=&gt; [[\"cowsandpigs.csv\", \"col2\"]]\n</code></pre>\n\n<p>The process of dividing <code>csv_files</code> in this way is called <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Array+Decomposition\" rel=\"nofollow noreferrer\">array decomposition</a>. Now read the first file, creating a <code>CSV</code> object.</p>\n\n<pre><code>csv = CSV.read(file_name, headers: true, col_sep: sep)\n  #=&gt; #&lt;CSV::Table mode:col_or_row row_count:3&gt;\n</code></pre>\n\n<p>Let's see what we have.</p>\n\n<pre><code>csv.to_a\n  #=&gt; [[\"dog\", \"cat\"], [\"woof\", \"purr\"], [\"devoted\", \"independent\"]]\n</code></pre>\n\n<p>Now add a column and see what we then have.</p>\n\n<pre><code>new_col = (1..csv.size).to_a \ncsv[new_header_name] = new_col\n  #=&gt; [1, 2] \ncsv.to_a\n  #=&gt; [[\"dog\", \"cat\", \"col1\"], [\"woof\", \"purr\", 1], [\"devoted\", \"independent\", 2]]\n</code></pre>\n\n<p>Read the descriptor for the next CSV file, then read the file into a <code>CSV</code> object <code>csv1</code>:</p>\n\n<pre><code>file_name, new_header_name = rest.shift\n  #=&gt; [\"cowsandpigs.csv\", \"col2\"] \ncsv1 = CSV.read(file_name, headers: true, col_sep: sep)\n  #=&gt; #&lt;CSV::Table mode:col_or_row row_count:3&gt;\ncsv1.to_a\n  #=&gt; [[\"cow\", \"pig\"], [\"moo\", \"oink\"], [\"dumb\", \"smart\"]]\n</code></pre>\n\n<p>Append <code>csv1</code> to <code>csv</code>:</p>\n\n<pre><code>csv1.headers.each { |header| csv[header] = csv1.map { |row| row[header] } }\n  #=&gt; [\"cow\", \"pig\"]\ncsv.to_a\n  #=&gt; [[\"dog\",     \"cat\",         \"col1\", \"cow\",  \"pig\"  ],\n  #    [\"woof\",    \"purr\",        1,      \"moo\",  \"oink\" ],\n  #    [\"devoted\", \"independent\", 2,      \"dumb\", \"smart\"]] \n</code></pre>\n\n<p>Add the new column and examing <code>csv</code>:</p>\n\n<pre><code>csv[new_header_name] = new_col\n  #=&gt; [1, 2]\ncsv.to_a\n  #=&gt; [[\"dog\",     \"cat\",         \"col1\", \"cow\",  \"pig\",   \"col2\"],\n  #    [\"woof\",    \"purr\",        1,      \"moo\",  \"oink\",  1     ],\n  #    [\"devoted\", \"independent\", 2,      \"dumb\", \"smart\", 2     ]]\n</code></pre>\n\n<p>All that remains is to write <code>csv</code> to file.</p>\n\n<pre><code>CSV.open(out_file_name, \"w\") do |f|\n  f &lt;&lt; csv.headers\n  csv.each { |row| f &lt;&lt; row }\nend\n  #&gt; #&lt;CSV::Table mode:col_or_row row_count:3&gt;\n</code></pre>\n\n<p>Let's look at the contents of the file just written:</p>\n\n<pre><code>puts IO.read(out_file_name)\ndog,cat,col1,cow,pig,col2\nwoof,purr,1,moo,oink,1\ndevoted,independent,2,dumb,smart,2\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1561097919, "creation_date": 1560949070, "last_edit_date": 1560976593, "question_id": 56668220, "link": "https://stackoverflow.com/questions/56668220/appending-a-dynamic-column-of-data-to-multiple-csvs", "title": "Appending a dynamic column of data to multiple CSVs", "body": "<p>I have a script that downloads multiple CSVs all with similar names (i.e. data.csv, data(1).csv) and I want to append a column to every CSV and then combine them into one CSV.</p>\n\n<p>So for example,</p>\n\n<p>data.csv has 4 headers (header_1, header_2, etc) and I would like to add header_5 with the variable foobar. For data.csv, foobar is \"duck\" and so for every row that data.csv has, header_5 would have that many ducks.</p>\n\n<p>data(1).csv is the same deal but this time variable foobar is now \"dog\". And the script would populate header_5 with however many dogs.</p>\n\n<p>At the last step, the 2 CSVs would be combined -- retaining the modified data -- into one giant CSV.</p>\n\n<p>I have been thinking about this for a long time. I don't know a lot about Ruby and this sort of problem is new to me so I hope I'm explaining it well.</p>\n\n<p>I thought about first modifying the CSVs to have the new column of data and then combining them but I keep running into the problem of the names of the CSVs. In order for me to modify the files, I need to know the names so I thought of wildcards. But then how would I differentiate between the CSVs? It would probably overwrite the data.</p>\n\n<p>My current code has that issue.</p>\n\n<pre><code> def CSV_Creation (source)\n\n\n        input_files = Dir.glob(\"data*.csv\")\n\n        all_headers = input_files.reduce([]) do |all_headers, file|\n            header_line = File.open(file, &amp;:gets)\n            all_headers | CSV.parse_line(header_line)\n        end\n\n\n        CSV.open(\"out.csv\", \"a+\") do |out|\n            all_headers &lt;&lt; \"Source\"\n            out &lt;&lt; all_headers \n\n\n            input_files.each do |file|\n                CSV.foreach(file, headers: true) do |row|\n                    out &lt;&lt; all_headers.map { |header| row[header] }\n\n\n\n                end\n            end\n        end\n    end\n\n</code></pre>\n\n<ul>\n<li>The source parameter changes depending on which CSV is being downloaded </li>\n<li>I used wildcards to collect all of the CSVs, collected the headers in order to add another header, and dumped all of the data into a new CSV. But of course the data gets overwritten. </li>\n</ul>\n\n<p>I am not entirely sure how I would keep the data in that last column from not being overwritten.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Thank you for all of your replies thus far. I have updated code that will hopefully make more sense:</p>\n\n<pre><code>def CSV_Creation (source)\n\n\n\n        l_source = {'lead_source' =&gt; \"#{source}\"}\n\n        input_file = Dir.glob(\"data*.csv\").last\n\n\n\n        puts \"Here is \" + input_file\n\n\n        rows = CSV.open(input_file, headers: true).map{ |row| row.to_h }\n\n\n        rows.each { |h| h.merge!(l_source)}\n        headers = rows.first.keys\n       rows.first.keys.each {|k| puts k}\n\n\n\n        csv_response = CSV.generate do |csv| \n            csv &lt;&lt; headers\n            rows.each do |row|\n                csv &lt;&lt; row.values_at(*headers) \n            end\n        end\n        File.open(\"#{source}.csv\", \"w\") {|file| file.write(csv_response)}\n\n\n    end \n</code></pre>\n\n<p>This creates two different csv files with the appropriate column and data. Now I just need to figure out how to combine the two files.</p>\n\n<p><strong>SECOND EDIT</strong></p>\n\n<p>This is what the final code looks like. It does what I ask so I figured it's alright?</p>\n\n<pre><code> def CSV_Creation (source)\n\n\n\n        l_source = {'lead_source' =&gt; \"#{source}\"}\n\n        input_file = Dir.glob(\"data*.csv\").last\n\n\n\n        puts \"Here is \" + input_file\n\n\n        rows = CSV.open(input_file, headers: true).map{ |row| row.to_h }\n\n\n        rows.each { |h| h.merge!(l_source)}\n        headers = rows.first.keys\n       rows.first.keys.each {|k| puts k}\n\n\n\n        csv_response = CSV.generate do |csv| \n            csv &lt;&lt; headers\n            rows.each do |row|\n                csv &lt;&lt; row.values_at(*headers) \n            end\n        end\n        File.open(\"#{source}.csv\", \"w\") {|file| file.write(csv_response)}\n\n\n        input_files = Dir.glob(\"#{source}*.csv\")\n\n\n        all_headers = input_files.reduce([]) do |all_headers, file|\n            header_line = File.open(file, &amp;:gets)\n            all_headers | CSV.parse_line(header_line)\n        end\n\n        CSV.open(\"out.csv\", \"a+\") do |out|\n            out &lt;&lt; all_headers \n\n            input_files.each do |file|\n                CSV.foreach(file, headers: true) do |row|\n                    out &lt;&lt; all_headers.map { |header| row[header] }\n                end\n            end\n        end\n\n\n\n\n\n\n\n    end \n</code></pre>\n\n<p>Big thanks to everyone who gave me advice!!</p>\n"}, {"tags": ["ruby", "rubygems", "rvm", "bundler"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560949629, "post_id": 56668174, "comment_id": 99904514, "body": "Have you tried <code>gem install --default -v1.17.2 bundler</code>? Also, when you run <code>which gem</code> and <code>which bundler</code> do they show the rvm shim paths?"}, {"owner": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560950850, "post_id": 56668174, "comment_id": 99905296, "body": "After running <code>gem install -default -v 1.17.2 bundler</code> I now have 2 default versions of bundler installed, and I can&#39;t uninstall either of them :( Also, the 1.17.3 version is still taking precedence."}, {"owner": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560950971, "post_id": 56668174, "comment_id": 99905383, "body": "<code>which gem</code> returns <code>~&#47;.rvm&#47;rubies&#47;ruby-2.5.3&#47;bin&#47;gem</code>, <code>which bundle</code> returns <code>~&#47;.rvm&#47;gems&#47;ruby-2.5.3&#47;bin&#47;bundle</code>"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1560955529, "post_id": 56668174, "comment_id": 99908275, "body": "I ran into something similar a few months back. I ended up deleting the default version following instructions <a href=\"https://stackoverflow.com/a/46691098/2892779\">here</a>, then re-installing with the --default flag again (only the one I wanted)"}, {"owner": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560956642, "post_id": 56668174, "comment_id": 99908975, "body": "I tried that and it doesn&#39;t work for me. It still won&#39;t uninstall the 1.17.3 bundler (though 1.17.3 is not longer marked as default). I was able to install 1.17.2 as default, but when I run bundler I am still getting version 1.17.3."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560961589, "post_id": 56668174, "comment_id": 99911705, "body": "Have you tried re-shimming?  In asdf (plugin manager I use) it&#39;s just calling <code>asdf reshim ruby</code>, maybe <code>rvm reshim</code>? Also, I&#39;d shut your terminal window down &amp; re-open it to make sure there&#39;s not some kind of artifact leftover from something else affecting it"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "reply_to_user": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "edited": false, "score": 0, "creation_date": 1560961748, "post_id": 56668174, "comment_id": 99911771, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/195205/discussion-between-jay-dorsey-and-dave-isaacs\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "is_accepted": false, "score": 2, "last_activity_date": 1561035404, "creation_date": 1561035404, "answer_id": 56686496, "question_id": 56668174, "link": "https://stackoverflow.com/questions/56668174/unable-to-uninstall-bundler-1-17-3/56686496#56686496", "title": "Unable to uninstall bundler 1.17.3", "body": "<p>It appears that RubyGems 3.0.4 includes bundler 1.17.3, and this was overriding any earlier version of bundler I tried to install. I fixed the issue by downgrading my RubyGems to version 2.7.6.</p>\n\n<pre><code>$ gem update --system 2.7.6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 705, "user_id": 1960924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y4Fhm.jpg?s=128&g=1", "display_name": "femotizo", "link": "https://stackoverflow.com/users/1960924/femotizo"}, "is_accepted": false, "score": 2, "last_activity_date": 1571686673, "creation_date": 1571686673, "answer_id": 58493073, "question_id": 56668174, "link": "https://stackoverflow.com/questions/56668174/unable-to-uninstall-bundler-1-17-3/58493073#58493073", "title": "Unable to uninstall bundler 1.17.3", "body": "<p>had same issue, use below process to uninstall it</p>\n\n<pre><code>1. $ rvm gemset use global\n2. $ sudo gem uninstall bundler -v 1.17.3\n3. $ gem install bundler -v 1.17.2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 5005466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30dbdb5629f45aa204a41f5a9a1a127?s=128&d=identicon&r=PG&f=1", "display_name": "hungmi", "link": "https://stackoverflow.com/users/5005466/hungmi"}, "is_accepted": false, "score": 1, "last_activity_date": 1578991985, "creation_date": 1578991985, "answer_id": 59730324, "question_id": 56668174, "link": "https://stackoverflow.com/questions/56668174/unable-to-uninstall-bundler-1-17-3/59730324#59730324", "title": "Unable to uninstall bundler 1.17.3", "body": "<p>In short, try navigate to a location except where your rails project is, and run <code>gem uninstall bundler</code> again.</p>\n\n<hr>\n\n<p>MacOS 10.15.2, Ruby 2.6.5 and RubyGems 3.0.3</p>\n\n<p>I was trying to uninstall bundler 2.1.4, and my default bundler is 1.17.2</p>\n\n<pre><code>$ gem list | grep \"bundle\"\nbundler (2.1.4, default: 1.17.2)\n</code></pre>\n\n<p>And I tried</p>\n\n<pre><code>$ gem uninstall bundler -v 2.1.4\nGem 'bundler' is not installed\n</code></pre>\n\n<p>And also</p>\n\n<pre><code>$ gem uninstall bundler\n</code></pre>\n\n<p>just output nothing.</p>\n\n<p>And finally I cd to another folder and run uninstall again and it worked.</p>\n"}], "owner": {"reputation": 4399, "user_id": 404993, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c8577e96f406f7ede3a62d9d8b9c8?s=128&d=identicon&r=PG", "display_name": "Dave Isaacs", "link": "https://stackoverflow.com/users/404993/dave-isaacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8134, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1578991985, "creation_date": 1560948923, "question_id": 56668174, "link": "https://stackoverflow.com/questions/56668174/unable-to-uninstall-bundler-1-17-3", "title": "Unable to uninstall bundler 1.17.3", "body": "<p>My current bundler version appears to be 1.17.3. I actually need 1.17.2 for my latest work, but I am unable to uninstall 1.17.3.</p>\n\n<p>If I run <code>gem uninstall bundler</code> the command exits with no output. The command <code>gem info bundler</code> always shows version 1.17.3.</p>\n\n<pre><code>$ gem uninstall bundler\n$ gem info bundler\n\n*** LOCAL GEMS ***\n... yada yada yada ...\nbundler (1.17.3)\n    Installed at (default): /Users/disaacs/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0\n</code></pre>\n\n<p>If I install the bundler version I need, I get both versions installed, but the 1.17.3 version runs by default.</p>\n\n<pre><code>$ gem install bundler -v 1.17.2\nFetching bundler-1.17.2.gem\nSuccessfully installed bundler-1.17.2\nParsing documentation for bundler-1.17.2\nInstalling ri documentation for bundler-1.17.2\nDone installing documentation for bundler after 3 seconds\n1 gem installed\n$ gem info bundler\n\n*** LOCAL GEMS ***\n... yada yada yada ...    \nbundler (1.17.3, 1.17.2)\n    Installed at (1.17.3, default): /Users/disaacs/.rvm/rubies/ruby-2.5.3/lib/ruby/gems/2.5.0\n                 (1.17.2): /Users/disaacs/.rvm/gems/ruby-2.5.3\n\n    The best way to manage your application's dependencies\n$ bundle --version\nBundler version 1.17.3\n</code></pre>\n\n<p>Any suggestions about how I can get rid of bundler 1.17.3?</p>\n\n<p>My environment is a MacBook running 10.14.5 (Mojave), with ruby 2.5.3 installed via rvm.</p>\n\n<pre><code>$ rvm list\n=* ruby-2.5.3 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 1777, "user_id": 3353157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6168a2c2f5e3582addf6d9d70ce13749?s=128&d=identicon&r=PG", "display_name": "Peter Camilleri", "link": "https://stackoverflow.com/users/3353157/peter-camilleri"}, "edited": false, "score": 0, "creation_date": 1560950703, "post_id": 56667291, "comment_id": 99905201, "body": "Where does this line of code appear? They normally are contained in class or module definitions."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1561045980, "post_id": 56667291, "comment_id": 99944881, "body": "Hm, sorbet playground doesn&#39;t give this error"}, {"owner": {"reputation": 874, "user_id": 1015863, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/82j8j.jpg?s=128&g=1", "display_name": "jez", "link": "https://stackoverflow.com/users/1015863/jez"}, "edited": false, "score": 3, "creation_date": 1561069996, "post_id": 56667291, "comment_id": 99954499, "body": "This error is silenced in all strictness levels below <code># typed: strict</code>. The playground defaults to <code># typed: true</code> if no sigil is given. In all other places Sorbet defaults to <code># typed: false</code> if no sigil is given.  <a href=\"https://sorbet.org/docs/static\" rel=\"nofollow noreferrer\">sorbet.org/docs/static</a>"}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 0, "last_activity_date": 1560948845, "creation_date": 1560948845, "answer_id": 56668151, "question_id": 56667291, "link": "https://stackoverflow.com/questions/56667291/sorbet-asking-a-sig-for-attr-reader/56668151#56668151", "title": "Sorbet asking a `sig` for `attr_reader`", "body": "<p><code>attr_reader(attribute)</code> is the equivalent of :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def attribute\n  @attribute\nend\n</code></pre>\n\n<p>This is probably why Sorbet is asking for a sig.</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 6830113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sfdJJ.png?s=128&g=1", "display_name": "Philipp Hansch", "link": "https://stackoverflow.com/users/6830113/philipp-hansch"}, "edited": false, "score": 0, "creation_date": 1561563227, "post_id": 56689094, "comment_id": 100108236, "body": "Is it correct that an <code>attr_reader</code> that defines multiple attributes will have to be split up over multiple lines to make the signatures work correctly?"}], "tags": [], "owner": {"reputation": 6696, "user_id": 1956721, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/da8b616bc6b8fc8219d357c7ef39e949?s=128&d=identicon&r=PG", "display_name": "jaredsmith", "link": "https://stackoverflow.com/users/1956721/jaredsmith"}, "is_accepted": false, "score": 6, "last_activity_date": 1561043768, "creation_date": 1561043768, "answer_id": 56689094, "question_id": 56667291, "link": "https://stackoverflow.com/questions/56667291/sorbet-asking-a-sig-for-attr-reader/56689094#56689094", "title": "Sorbet asking a `sig` for `attr_reader`", "body": "<p>The error does not have to do with the <code>attr_reader</code> method itself needing a <code>sig</code>, but with <code>:collection_name</code>. The signature for <code>attr_reader</code> is already known, but the new method it dynamically creates, <code>#collection_name</code> does not have a known <code>sig</code>, and Sorbet expects this to be the place where you give it one.</p>\n\n<p>You can do this to fix it:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>sig { returns(String) }\nattr_reader(:collection_name)\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 5865743, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-z-Cc3sZILsA/AAAAAAAAAAI/AAAAAAAACnI/e9MZYxgdHOU/photo.jpg?sz=128", "display_name": "Utkarsh Bhimte", "link": "https://stackoverflow.com/users/5865743/utkarsh-bhimte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1561043841, "creation_date": 1560946062, "last_edit_date": 1561043841, "question_id": 56667291, "link": "https://stackoverflow.com/questions/56667291/sorbet-asking-a-sig-for-attr-reader", "title": "Sorbet asking a `sig` for `attr_reader`", "body": "<p>Sorbet is showing an error for the attr_reader, but correct me if I am wrong, sigs are required when the function is declared, not called, right?</p>\n\n<p>I have tried going through the documentation but all I got is this note</p>\n\n<p>Note: Many Ruby constructs that look like local variables are actually method calls without parens! Specifically, watch out for attr_reader and zero-argument method definitions.</p>\n\n<pre><code>app/util/hodor.rb:125: This function does not have a `sig` https://sorbet.org/docs/error-reference#7017\n     125 |  attr_reader(:collection_name)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "windows", "rspec", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560942938, "post_id": 56666330, "comment_id": 99900534, "body": "I was laughing because of my sentence full of ends. is that so disturbing?"}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1560943089, "post_id": 56666330, "comment_id": 99900617, "body": "Ok, I just wanted to help the OP, I did not want to pretend to be professional"}, {"owner": {"reputation": 11, "user_id": 8810599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6wt3i1TA2GU/AAAAAAAAAAI/AAAAAAAAAOk/4_z5rJbqA_U/photo.jpg?sz=128", "display_name": "Christian Mamac", "link": "https://stackoverflow.com/users/8810599/christian-mamac"}, "edited": false, "score": 0, "creation_date": 1560943162, "post_id": 56666330, "comment_id": 99900666, "body": "still the same. after I added an &quot;end&quot;. is something wrong with my code? I&#39;m new to rails."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 11, "user_id": 8810599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6wt3i1TA2GU/AAAAAAAAAAI/AAAAAAAAAOk/4_z5rJbqA_U/photo.jpg?sz=128", "display_name": "Christian Mamac", "link": "https://stackoverflow.com/users/8810599/christian-mamac"}, "edited": false, "score": 0, "creation_date": 1560943218, "post_id": 56666330, "comment_id": 99900700, "body": "@ChristianMamac: maybe you&#39;re missing another one. Or your code is cached by spring or something."}, {"owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "reply_to_user": {"reputation": 11, "user_id": 8810599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6wt3i1TA2GU/AAAAAAAAAAI/AAAAAAAAAOk/4_z5rJbqA_U/photo.jpg?sz=128", "display_name": "Christian Mamac", "link": "https://stackoverflow.com/users/8810599/christian-mamac"}, "edited": false, "score": 1, "creation_date": 1560943318, "post_id": 56666330, "comment_id": 99900747, "body": "@ChristianMamac are you sure the error is in the same file? It seems this file just misses a single end"}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": false, "score": 2, "last_activity_date": 1560942698, "creation_date": 1560942698, "answer_id": 56666330, "question_id": 56666292, "link": "https://stackoverflow.com/questions/56666292/syntax-error-unexpected-end-of-input-expecting-keyword-end-when-running-rspec/56666330#56666330", "title": "syntax error, unexpected end-of-input, expecting keyword_end. when running rspec of feature file", "body": "<p>You missed an <code>end</code> in the end, between those two <code>end</code>s lol</p>\n\n<p>move from </p>\n\n<pre><code>    end\nend\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8810599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6wt3i1TA2GU/AAAAAAAAAAI/AAAAAAAAAOk/4_z5rJbqA_U/photo.jpg?sz=128", "display_name": "Christian Mamac", "link": "https://stackoverflow.com/users/8810599/christian-mamac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560942698, "creation_date": 1560942566, "last_edit_date": 1560942615, "question_id": 56666292, "link": "https://stackoverflow.com/questions/56666292/syntax-error-unexpected-end-of-input-expecting-keyword-end-when-running-rspec", "title": "syntax error, unexpected end-of-input, expecting keyword_end. when running rspec of feature file", "body": "<pre><code>require_relative 'rails_helper'\nrequire 'spec_helper'\n\nRSpec.feature \"testCreateVideo\", :type =&gt; :feature do\n  context 'create new video 'do\n    scenario \"Successfully creates a new video\" do\n      visit \"https://SomeURL/orders\"\n\n      within('form') do\n\n        fill_in \"order[organisation][name]\", :with =&gt; \"SAMPLE BRAND NAME\"\n        fill_in \"order[organisation][website]\", :with =&gt; \"SAMPLE WEBSITE\"\n        select \"option\", from:  \"select box\", :with =&gt; \"Singapore\"\n        select \"option\", from:  \"select box\", :with =&gt; \"Central\"\n        choose('order[project][name]', option: 'time_frame_next_week')\n        choose('order[project][budget]', option: 'up-to-five')\n        fill_in \"#order_project_description\", with: 'sample description'\n        fill_in \"order[project][videos_we_like_tmp]\", :with =&gt; \"My Widget\"\n        fill_in \"order[contact][first_name]\", :with =&gt; \"John Christian\"\n        fill_in \"order[contact][last_name]\", :with =&gt; \"Dela Pena\"\n        fill_in \"order[contact][email]\", :with =&gt; \"christianmamac08@gmail.com\"\n        fill_in \"order[contact][mobile]\", :with =&gt; \"65 8134 9249\"\n        check('accepts_terms')\n\n      end\n\n      click_button ('button')\n\n      expect(page).to have_text(\"Thank you for creating your quote.\")\n    end\n\n    scenario \"should fail creating video\" do\n      visit \"https://someURL/orders\"\n\n      within('form') do\n\n        #fill_in \"order[organisation][name]\", :with =&gt; \"SAMPLE BRAND NAME\"\n        fill_in \"order[organisation][website]\", :with =&gt; \"SAMPLE WEBSITE\"\n        select \"option\", from:  \"select box\", :with =&gt; \"Singapore\"\n        select \"option\", from:  \"select box\", :with =&gt; \"Central\"\n        choose('order[project][name]', option: 'time_frame_next_week')\n        choose('order[project][budget]', option: 'up-to-five')\n        fill_in \"#order_project_description\", with: 'sample description'\n        fill_in \"order[project][videos_we_like_tmp]\", :with =&gt; \"My Widget\"\n        fill_in \"order[contact][first_name]\", :with =&gt; \"John Christian\"\n        fill_in \"order[contact][last_name]\", :with =&gt; \"Dela Pena\"\n        fill_in \"order[contact][email]\", :with =&gt; \"christianmamac08@gmail.com\"\n        fill_in \"order[contact][mobile]\", :with =&gt; \"65 8134 9249\"\n        check('accepts_terms')\n      end\n      click_button ('button')\n\n      expect(page).to have_text(\"Brand Name is missing.\")\n\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560961788, "post_id": 56666281, "comment_id": 99911790, "body": "This might be helpful: <a href=\"https://blog.apify.com/how-to-make-headless-chrome-and-puppeteer-use-a-proxy-server-with-authentication-249a21a79212\" rel=\"nofollow noreferrer\">blog.apify.com/&hellip;</a>"}, {"owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "reply_to_user": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560961870, "post_id": 56666281, "comment_id": 99911821, "body": "Hey I wanted to have it in selenium not in puppeteer its already working fine"}, {"owner": {"reputation": 2205, "user_id": 6460122, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/WTsp7.jpg?s=128&g=1", "display_name": "ricks", "link": "https://stackoverflow.com/users/6460122/ricks"}, "edited": false, "score": 0, "creation_date": 1614363158, "post_id": 56666281, "comment_id": 117372206, "body": "@VishalG how did you solve it?"}], "owner": {"reputation": 1331, "user_id": 4189633, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VG5Vp.jpg?s=128&g=1", "display_name": "Vishal G", "link": "https://stackoverflow.com/users/4189633/vishal-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1560973097, "creation_date": 1560942536, "last_edit_date": 1560973097, "question_id": 56666281, "link": "https://stackoverflow.com/questions/56666281/how-to-add-pass-username-password-to-proxy-in-selenium-webdriver-ruby", "title": "How to add pass username &amp; password to proxy in selenium webdriver - Ruby", "body": "<p>I am trying to use luminati proxy here but stuck in an authentication, when I passed --proxy-server then it asks for password in a browser, I have tried to send username and password but not worked</p>\n\n<p>sending username and password in proxy-server in this way giving an error as well</p>\n\n<pre><code>proxy-server=username:password@url:port\n</code></pre>\n\n<p>....</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def build_driver\n  @driver = Selenium::WebDriver.for :chrome, options: web_driver_options\nend\n\ndef web_driver_options\n  @web_driver_options ||= begin\n                            options = Selenium::WebDriver::Chrome::Options.new\n                            options.add_argument('--ignore-certificate-errors')\n                            options.add_argument('--disable-dev-shm-usage')\n                            options.add_argument('--proxy-server=@zproxy.lum-superproxy.io:22225')\n                            options\n                          end\nend\n</code></pre>\n\n<p>In puppeteer, there is a fix to this, but I searched a lot for selenium no answer found please help me here?</p>\n\n<pre><code>await page.authenticate({username: 'lum-customer-zone-residential-country-us', password: 'asasass'})\n</code></pre>\n\n<p><strong>Looking for a solution in selenium</strong> puppeteer already working with this</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-api"], "answers": [{"tags": [], "owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "is_accepted": false, "score": 0, "last_activity_date": 1560924784, "creation_date": 1560924784, "answer_id": 56661092, "question_id": 56660819, "link": "https://stackoverflow.com/questions/56660819/after-save-runtimeerror-could-not-find-a-valid-mapping-for-user-id/56661092#56661092", "title": "After save RuntimeError: Could not find a valid mapping for #&lt;User id", "body": "<p>this fixed the error</p>\n\n<pre><code>   devise_for :admins, :class_name =&gt; 'User'\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1560924784, "creation_date": 1560923555, "question_id": 56660819, "link": "https://stackoverflow.com/questions/56660819/after-save-runtimeerror-could-not-find-a-valid-mapping-for-user-id", "title": "After save RuntimeError: Could not find a valid mapping for #&lt;User id", "body": "<p>React app is making calls to ruby on rails api. I'm building signup page i got stuck on the signup save part. getting error</p>\n\n<pre><code>\"status\": 500,\n\"error\": \"Internal Server Error\",\n\"exception\": \"#&lt;RuntimeError: Could not find a valid mapping for #&lt;User id: 7, email: \\\"bearatamer+testfive@gmail.com\\\", created_at: \\\"2019-06-19 05:35:58\\\", updated_at: \\\"2019-06-19 05:35:58\\\", fullname: \\\"test five\\\", provider: nil, uid: nil, image: nil, phone_number: \\\"6021233423\\\", description: nil, pin: nil, phone_verified: nil, stripe_id: nil, merchant_id: nil, unread: 0, access_token: \\\"JHqM4JiyjvdufcReQdYX\\\", is_commercial_host: false&gt;&gt;\"\n</code></pre>\n\n<p>im sending this JSON </p>\n\n<pre><code>{\"fullname\": \"test five\", \"phone_number\": \"6021233423\",  \"email\": \n \"testuser+testfive@gmail.com\",\n\"is_commercial_host\": \"false\",  \"password\": \"test1234\"\n}\n</code></pre>\n\n<p>to this api </p>\n\n<pre><code> http://localhost:3000/api/v1/signup\n</code></pre>\n\n<p>as you see on the below image \n<a href=\"https://i.stack.imgur.com/nBWml.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nBWml.png\" alt=\"enter image description here\"></a></p>\n\n<p>this image is from the command line \n<a href=\"https://i.stack.imgur.com/LEK2I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LEK2I.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The record gets saved to the database but after it saves i get the error</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/2LeIt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2LeIt.png\" alt=\"enter image description here\"></a></p>\n\n<p>this is users_controller.rb</p>\n\n<pre><code>class Api::V1::UsersController &lt; ApplicationController\nbefore_action :authenticate_with_token!, only: [:logout]\n\ndef facebook\n enter code hereif params[:facebook_access_token]\n  graph = Koala::Facebook::API.new(params[:facebook_access_token])\n  user_data = graph.get_object(\"me?fields=name,email,id,picture\")\n\n  user = User.find_by(email: user_data['email'])\n  if user\n    user.generate_authentication_token\n    user.save\n    render json: user, status: :ok\n  else\n    user = User.new(\n                fullname: user_data['fullname'],\n                email: user_data['email'],\n                uid: user_data['id'],\n                provider: 'Facebook',\n                image: user_data['picture']['data']['url']\n            )\n    user.generate_authentication_token\n\n    if user.save\n      render json: user, status: :ok\n    else\n      render json: { error: user.errors, is_success: false}, status: 422\n    end\n  end\n  else\n  render json: { error: \"Invalid Facebook Token\", is_success: false}, status: :unprocessable_entity\n  end\nend\n\ndef logout\n user = User.find_by(access_token: params[:access_token])\n user.generate_authentication_token\n user.save\n render json: { is_success: true}, status: :ok\nend\n\ndef login\n  user = User.find_by(email: params[:email]) \n    if user &amp;&amp; user.valid_password?(params[:password])\n     session[:user_id] = user.id\n     render json: user, status: :ok\n    else\n     render json: { error: user.errors, is_success: false}, status: 422\n    end \nend\n\ndef signup\n user = User.find_by(email: params[:email]) \n if user \n   render json: { error: \"Email already exist, click on forget password\", is_success: false}, status: :unprocessable_entity\n else\n    user = User.new(\n                fullname: params[:fullname],\n                email: params[:email],\n                phone_number: params[:phone_number],\n                password:  params[:password],\n                is_commercial_host:  params[:is_commercial_host]\n            )\n    user.generate_authentication_token\n    if user.save\n      render json: user, status: :ok\n    else\n      render json: { success: \"Email already exist, click on forget password\", is_success: true}, status: :ok\n    end\n  end \n end\n\nend\n</code></pre>\n\n<p>here is routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\nnamespace :api, defautls: {format: :json} do\nnamespace :v1 do\n  get '/logout' =&gt; 'users#logout'\n  get '/login' =&gt; 'users#login'\n  post '/login' =&gt; 'users#login'\n  post '/signup' =&gt; 'users#signup'\n  end\n end\nend\n</code></pre>\n\n<p>here is user.rb model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n has_secure_password\n before_create :generate_authentication_token\n devise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, \n :validatable,\n     :confirmable, :omniauthable\n validates :fullname, presence: true, length: {maximum: \n 50}\nend\ndef generate_authentication_token\n begin\n  self.access_token = Devise.friendly_token\n end while self.class.exists?(access_token: access_token)\nend\n</code></pre>\n\n<p>The Error happens on line 64 of signup method on the users_controller.rb which is this line</p>\n\n<pre><code> if user.save\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 4, "creation_date": 1560923606, "post_id": 56660737, "comment_id": 99890638, "body": "There is a good explanation <a href=\"https://medium.com/@sihui/proc-code-block-conversion-and-ampersand-in-ruby-35cf524eef55\" rel=\"nofollow noreferrer\">here</a>. Being new to Ruby I think you may have some trouble following that. I suggest that, for now, you should just think of  <code>arr.inject(:+)</code> as being <i>shorthand</i> for <code>arr.inject { |tot,n| tot + n }</code> and <code>arr.select(&amp;:even?)</code> as being <i>shorthand</i> for <code>arr.select { |n| n.even? }</code>. Incidentally, I&#39;m sure this question has been asked many times at SO, so don&#39;t be surprised if others post links to those other answers. Not too worry if your question is closed for that reason."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 4, "creation_date": 1560925059, "post_id": 56660737, "comment_id": 99891193, "body": "You have actually asked two questions. The first is when <code>inject</code> has an argument that is a symbol which is the name of a method. See the doc <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\">Enumerable#inject</a> (a.k.a. <code>reduce</code>) for an explanation. The second is when <code>select</code> has an &quot;argument&quot; that is the name of a method (<code>:even?</code>) preceded by <code>&amp;</code>. The <code>&amp;</code> first invokes the method <code>to_proc</code> on <code>:even?</code> to convert the method to a <i>proc</i>, then it calls the proc. P.S. As I predicted, your question, being a <i>dup</i>,  has been closed. Don&#39;t lose sleep over that."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1560935572, "post_id": 56660737, "comment_id": 99896535, "body": ".select(&amp;:even?) is the same as .select { |x| x.even? } Whenever you see (&amp;:method) it means the same as { |x| x.method }"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1560948659, "post_id": 56660737, "comment_id": 99903890, "body": "@Mark, yes, except for methods like <code>reduce</code>, <code>each_with_object</code> and <code>each_with_index</code>, that add an additional block variable."}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1560950411, "post_id": 56660737, "comment_id": 99905036, "body": "That&#39;s a good point :)"}], "owner": {"reputation": 47, "user_id": 6488612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UH2qc.jpg?s=128&g=1", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/6488612/abhishek-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1560924221, "answer_count": 0, "score": 1, "last_activity_date": 1560923082, "creation_date": 1560923082, "question_id": 56660737, "link": "https://stackoverflow.com/questions/56660737/what-does-a-selecteven-mean-and-what-are-the-other-operators-allowed-wha", "closed_reason": "Duplicate", "title": "What does `a.select(&amp;:even?)` mean and what are the other operators allowed? What are these operators called and where can I learn about them?", "body": "<p>I am very new to ruby and still in learning phase. I recently came across statements like <code>.inject(:+)</code> and <code>a.select(&amp;:even?)</code>. I do not know what <code>:+</code> or <code>&amp;:</code> does exactly. </p>\n\n<ol>\n<li><p>Can someone please help me understand what it is? </p></li>\n<li><p>Also, are there any other similar operators present in ruby, if yes, can you please point me to a reference where I can learn more about these operators.</p></li>\n</ol>\n\n<p>I have googled about these operators but I could not find a solid document or resource which talks specifically about these kind of operators and hence, I am here seeking the community's help.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>=&gt; [1,2,3,4,5].inject(:+) \n=&gt; 15\n=&gt; [1,2,3,4,5].select(&amp;:even?) \n=&gt; [2,4]\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 1, "creation_date": 1560918549, "post_id": 56659917, "comment_id": 99889388, "body": "Hello, welcome to StackOverflow! if you are getting some error, showing us the error makes it easier for us to understand the problem."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1560919298, "post_id": 56659917, "comment_id": 99889539, "body": "&quot;I get an error&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? What is the error message? What does it say? What line does it occur on? What method does it occur in? Please, show the relevant portion of the stack trace as well."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11667885, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rxWAD6wcdq0/AAAAAAAAAAI/AAAAAAAAA5g/WDDsTlPlg2s/photo.jpg?sz=128", "display_name": "Shannon Rachal", "link": "https://stackoverflow.com/users/11667885/shannon-rachal"}, "edited": false, "score": 0, "creation_date": 1560918260, "post_id": 56660014, "comment_id": 99889331, "body": "I tried it and it just printed the same number I typed in. It did not do the calculation. Thanks for trying to help."}, {"owner": {"reputation": 17, "user_id": 11667885, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rxWAD6wcdq0/AAAAAAAAAAI/AAAAAAAAA5g/WDDsTlPlg2s/photo.jpg?sz=128", "display_name": "Shannon Rachal", "link": "https://stackoverflow.com/users/11667885/shannon-rachal"}, "edited": false, "score": 0, "creation_date": 1560918529, "post_id": 56660014, "comment_id": 99889383, "body": "Perfect!! Thanks, it worked. I really appreciate the help. I&#39;m in a course just learning ruby so I don&#39;t know all the tricks yet. :)"}, {"owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "edited": false, "score": 0, "creation_date": 1560918618, "post_id": 56660014, "comment_id": 99889405, "body": "If you are <code>puts</code>ing inside the method, u do not need to <code>puts</code> the return of the method itself."}], "tags": [], "owner": {"reputation": 449, "user_id": 10739704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmWze.jpg?s=128&g=1", "display_name": "nileshkumar", "link": "https://stackoverflow.com/users/10739704/nileshkumar"}, "is_accepted": true, "score": 1, "last_activity_date": 1561059593, "last_edit_date": 1561059593, "creation_date": 1560918069, "answer_id": 56660014, "question_id": 56659917, "link": "https://stackoverflow.com/questions/56659917/how-to-display-answer-in-a-statement/56660014#56660014", "title": "How to display answer in a statement", "body": "<p>Try this way:</p>\n\n<pre><code>def c_to_f \n  puts \"Enter degrees Celsius\" \n  degrees = gets \n  fh = (degrees.to_i * 9/5) + 32 \n  puts \"#{fh} Fahrenheit.\"\nend\n\n# call the function\nc_to_f\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": false, "score": 0, "last_activity_date": 1560918475, "creation_date": 1560918475, "answer_id": 56660062, "question_id": 56659917, "link": "https://stackoverflow.com/questions/56659917/how-to-display-answer-in-a-statement/56660062#56660062", "title": "How to display answer in a statement", "body": "<p>Since you want to display both the input and the output values in the statement, you should probably <code>puts</code> inside the method.</p>\n\n<pre><code>def c_to_f\n  puts \"Enter degrees Celsius\"\n  c_degrees = gets.to_i\n  f_degrees = (c_degrees * 9/5) + 32\n  puts \"#{c_degrees} celsius is #{f_degrees} in Fahrenheit\"\nend\n\nc_to_f\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 4, "last_activity_date": 1560933271, "last_edit_date": 1560933271, "creation_date": 1560930954, "answer_id": 56662699, "question_id": 56659917, "link": "https://stackoverflow.com/questions/56659917/how-to-display-answer-in-a-statement/56662699#56662699", "title": "How to display answer in a statement", "body": "<blockquote>\n  <p>How to display answer in a statement</p>\n</blockquote>\n\n<p>Assuming you have two variables with integer values:</p>\n\n<pre><code>celsius = 104\nfahrenheit = 219\n</code></pre>\n\n<p>There are several options to turn these into the sentence <em>\"104 celsius is 219 Fahrenheit.\"</em></p>\n\n<p>You could print each part separately using <a href=\"http://ruby-doc.org/core-2.6.3/Kernel.html#method-i-print\" rel=\"nofollow noreferrer\"><code>print</code></a> which doesn't add a newline:</p>\n\n<pre><code>print celsius\nprint ' Celsius is '\nprint fahrenheit\nprint ' Fahrenheit.'\nputs  # &lt;- this adds a newline\n</code></pre>\n\n<p>Or you could print all parts with a single <code>print</code> call:</p>\n\n<pre><code>print celsius, ' Celsius is ', fahrenheit, ' Fahrenheit.'\nputs\n</code></pre>\n\n<p>You could also build the sentence by concatenating strings using <a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-2B\" rel=\"nofollow noreferrer\"><code>+</code></a> as you already tried. But in order to work, each part has to be a string so the numbers need to be converted via <a href=\"http://ruby-doc.org/core-2.6.3/Integer.html#method-i-to_s\" rel=\"nofollow noreferrer\"><code>to_s</code></a>:</p>\n\n<pre><code>puts celsius.to_s + ' Celsius is ' + fahrenheit.to_s + ' Fahrenheit.'\n</code></pre>\n\n<p>A more idiomatic way is to <em>interpolate</em> the values into a string using <code>#{...}</code>: (you have to use double quotes)</p>\n\n<pre><code>puts \"#{celsius} Celsius is #{fahrenheit} Fahrenheit.\"\n</code></pre>\n\n<p>And finally there is <a href=\"http://ruby-doc.org/core-2.6.3/Kernel.html#method-i-format\" rel=\"nofollow noreferrer\"><code>format</code></a> which builds a string from a template using placeholders: (<code>%d</code> = decimal)</p>\n\n<pre><code>puts format('%d Celsius is %d Fahrenheit.', celsius, fahrenheit)\n</code></pre>\n\n<hr>\n\n<p>Apart from the sentence, I've noticed that your <code>c_to_f</code> method currently does more than just converting Celsius to Fahrenheit:</p>\n\n<pre><code>def c_to_f\n  puts \"Enter degrees Celsius\"  # &lt;- printing\n  degrees = gets                # &lt;- collecting input\n  (degrees.to_i * 9/5) + 32     # &lt;- string conversion and finally C to F\nend\n</code></pre>\n\n<p>I'd write this as:</p>\n\n<pre><code>def c_to_f(degrees)\n  degrees * 9 / 5 + 32\nend\n</code></pre>\n\n<p>And move the output / input outside the method:</p>\n\n<pre><code>puts 'Enter degrees Celsius'\ncelcius = gets.to_i\nfahrenheit = c_to_f(celsius)\n</code></pre>\n\n<p>This makes the method much more versatile, e.g. when used without user input:</p>\n\n<pre><code>puts 'Conversion table:'\n(-30..100).step(10) do |c|\n  puts format('%3d \u00b0C = %3d \u00b0F', c, c_to_f(c))\nend\n</code></pre>\n\n<p><code>%3d</code> means decimal value with a width of 3. Shorter numbers will be padded with spaces which results in a nicely aligned output:</p>\n\n<pre><code>Conversion table:\n-30 \u00b0C = -22 \u00b0F\n-20 \u00b0C =  -4 \u00b0F\n-10 \u00b0C =  14 \u00b0F\n  0 \u00b0C =  32 \u00b0F\n 10 \u00b0C =  50 \u00b0F\n 20 \u00b0C =  68 \u00b0F\n 30 \u00b0C =  86 \u00b0F\n 40 \u00b0C = 104 \u00b0F\n 50 \u00b0C = 122 \u00b0F\n 60 \u00b0C = 140 \u00b0F\n 70 \u00b0C = 158 \u00b0F\n 80 \u00b0C = 176 \u00b0F\n 90 \u00b0C = 194 \u00b0F\n100 \u00b0C = 212 \u00b0F\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11667885, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rxWAD6wcdq0/AAAAAAAAAAI/AAAAAAAAA5g/WDDsTlPlg2s/photo.jpg?sz=128", "display_name": "Shannon Rachal", "link": "https://stackoverflow.com/users/11667885/shannon-rachal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 56660014, "answer_count": 3, "score": 1, "last_activity_date": 1561059593, "creation_date": 1560917372, "last_edit_date": 1560918361, "question_id": 56659917, "link": "https://stackoverflow.com/questions/56659917/how-to-display-answer-in-a-statement", "title": "How to display answer in a statement", "body": "<p>I have to write a code to convert Celsius to Fahrenheit. In the end, I need it to display the answer in a statement. I'm trying to get it to display the number entered by the user is the answer Fahrenheit.</p>\n\n<blockquote>\n  <p>Example the user input 104 so the statement should read: 104 celsius\n  is 219 Fahrenheit.</p>\n</blockquote>\n\n<p>I have tried many different ways to get it to work but as close as I can get is it showing 219 Fahrenheit without the beginning of the sentence. </p>\n\n<p>Here is my code:</p>\n\n<p>When I tried using the <code>#{degrees}</code> I get an error. I tried using the + to connect them into one sentence and got an error. What you see below is all that has worked.</p>\n\n<pre><code>def c_to_f\n  puts \"Enter degrees Celsius\"\n  degrees = gets\n  (degrees.to_i * 9/5) + 32\nend\n\nputs c_to_f\n\nputs \"Fahrenheit.\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1560921401, "post_id": 56659899, "comment_id": 99889987, "body": "Perfect! Thanks;)"}], "tags": [], "owner": {"reputation": 4690, "user_id": 1937435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YyN37.jpg?s=128&g=1", "display_name": "Josh Brody", "link": "https://stackoverflow.com/users/1937435/josh-brody"}, "is_accepted": true, "score": 2, "last_activity_date": 1560917175, "creation_date": 1560917175, "answer_id": 56659899, "question_id": 56659720, "link": "https://stackoverflow.com/questions/56659720/how-to-list-in-order-of-the-point/56659899#56659899", "title": "How to list in order of the point", "body": "<p>Remember that you can reference <code>self</code> to reference the instance, removing the argument from your method.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  def points\n    (self.posts.count * 10) + (self.followers.count * 2)\n  end\nend\n\n@users = User.includes(:posts, :followers).all.sort_by { |user| user.points }\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56659899, "answer_count": 1, "score": 0, "last_activity_date": 1560917175, "creation_date": 1560915591, "question_id": 56659720, "link": "https://stackoverflow.com/questions/56659720/how-to-list-in-order-of-the-point", "title": "How to list in order of the point", "body": "<p>I want to list users in order of points. But I didn't migrate point column, I define the point in the model like below.</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  def my_point(user)\n    point = user.posts.count * 10 + user.followers.count * 2\n  end\nend\n</code></pre>\n\n<p>How can I arrange users in the view?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "oauth-2.0", "linkedin", "omniauth-linkedin"], "comments": [{"owner": {"reputation": 947, "user_id": 1139322, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b8c2c9c597db32227bb2b382fba129de?s=128&d=identicon&r=PG", "display_name": "Saravanan S", "link": "https://stackoverflow.com/users/1139322/saravanan-s"}, "edited": false, "score": 1, "creation_date": 1560912175, "post_id": 56659171, "comment_id": 99888198, "body": "I am also facing the same error. Worked till yesterday, but not today. Please update if you get any solution."}, {"owner": {"reputation": 452, "user_id": 90053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0bb83fad0c09cfb5fd6900a2467c4b8?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/90053/jason"}, "edited": false, "score": 1, "creation_date": 1560912811, "post_id": 56659171, "comment_id": 99888341, "body": "We&#39;re encountering the same issue, for what it&#39;s worth. We&#39;ve raised a ticket with LinkedIn developer support."}, {"owner": {"reputation": 555, "user_id": 1367121, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/4a2c2d99085817b290619200cd1bf818?s=128&d=identicon&r=PG", "display_name": "Matthew Yang", "link": "https://stackoverflow.com/users/1367121/matthew-yang"}, "edited": false, "score": 1, "creation_date": 1560913521, "post_id": 56659171, "comment_id": 99888468, "body": "I&#39;m having the exact same issue, although I&#39;m using a different JavaScript SDK, was working fine just couple hours ago, suddenly get error https_required now"}, {"owner": {"reputation": 1472, "user_id": 179674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41c9e58de51bad0f1a6bd68d557d3ad1?s=128&d=identicon&r=PG", "display_name": "crgt", "link": "https://stackoverflow.com/users/179674/crgt"}, "edited": false, "score": 1, "creation_date": 1560918569, "post_id": 56659171, "comment_id": 99889395, "body": "Same issue here.  All our calls are https."}, {"owner": {"reputation": 811, "user_id": 1216463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f60c18576d8eef7d3247a48cd1d4fc71?s=128&d=identicon&r=PG", "display_name": "Mansoor Elahi", "link": "https://stackoverflow.com/users/1216463/mansoor-elahi"}, "edited": false, "score": 0, "creation_date": 1560918857, "post_id": 56659171, "comment_id": 99889448, "body": "apps like these are working they are using different strategy <a href=\"https://skrapp.io\" rel=\"nofollow noreferrer\">skrapp.io</a>"}, {"owner": {"reputation": 6694, "user_id": 148657, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/bb5612cf13e4d987bb3f2a3fc4e9604b?s=128&d=identicon&r=PG&f=1", "display_name": "Raghav", "link": "https://stackoverflow.com/users/148657/raghav"}, "edited": false, "score": 1, "creation_date": 1560918968, "post_id": 56659171, "comment_id": 99889476, "body": "Logged the issue here with detailed images: <a href=\"https://stackoverflow.com/questions/56660121/linkind-oauth-failed-with-https-required-error-message\" title=\"linkind oauth failed with https required error message\">stackoverflow.com/questions/56660121/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 811, "user_id": 1216463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f60c18576d8eef7d3247a48cd1d4fc71?s=128&d=identicon&r=PG", "display_name": "Mansoor Elahi", "link": "https://stackoverflow.com/users/1216463/mansoor-elahi"}, "is_accepted": true, "score": 0, "last_activity_date": 1560922236, "last_edit_date": 1560922236, "creation_date": 1560922074, "answer_id": 56660562, "question_id": 56659171, "link": "https://stackoverflow.com/questions/56659171/oauth-login-error-while-logging-in-using-linkedin-credentials-errorhttps-re/56660562#56660562", "title": "Oauth Login error while logging in using linkedin credentials (&quot;error&quot;:&quot;https_required&quot;)", "body": "<p>It now started working again. I think linkedin fixed it from there end.</p>\n"}], "owner": {"reputation": 811, "user_id": 1216463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/f60c18576d8eef7d3247a48cd1d4fc71?s=128&d=identicon&r=PG", "display_name": "Mansoor Elahi", "link": "https://stackoverflow.com/users/1216463/mansoor-elahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 3, "accepted_answer_id": 56660562, "answer_count": 1, "score": 4, "last_activity_date": 1560922236, "creation_date": 1560910390, "question_id": 56659171, "link": "https://stackoverflow.com/questions/56659171/oauth-login-error-while-logging-in-using-linkedin-credentials-errorhttps-re", "title": "Oauth Login error while logging in using linkedin credentials (&quot;error&quot;:&quot;https_required&quot;)", "body": "<p>I am using omniauth-linkedin-oauth2 (1.0.0) gem to login the users to our site using linkedin it was working fine until now not sure if its related to linkedin API changes or what</p>\n\n<p>I am getting the below error</p>\n\n<pre><code>| (linkedin) Authentication failure! invalid_credentials: \n    OAuth2::Error, https_required: The client is not authorized\n    {\"error\":\"https_required\",\"error_description\":\"The client is not authorized\"}\n</code></pre>\n\n<p>Here's my configs:</p>\n\n<pre><code>  OmniAuth.config.logger = Rails.logger\n\n  LINKEDIN_FIELDS =  ['id', 'first-name', 'last-name', 'picture-url', 'email-address', 'positions']\n\n  Rails.application.config.middleware.use OmniAuth::Builder do\n\n   provider :linkedin, ENV['LINKEDIN_KEY'], ENV['LINKEDIN_SECRET'], fields: LINKEDIN_FIELDS, secure_image_url: true\n\nend\n\nif Rails.env.development?\n  OpenSSL::SSL::VERIFY_PEER = OpenSSL::SSL::VERIFY_NONE\nend\n\nOmniAuth.config.on_failure = \n Api::V2::UsersController.action(:linkedin_failure)\n</code></pre>\n"}, {"tags": ["ruby", "sdk", "microsoft-graph-api"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11667485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pFy3AMTWkjs/AAAAAAAAAAI/AAAAAAAAANM/HrwV8l4iLZo/photo.jpg?sz=128", "display_name": "AT 274", "link": "https://stackoverflow.com/users/11667485/at-274"}, "is_accepted": true, "score": 1, "last_activity_date": 1560934189, "creation_date": 1560934189, "answer_id": 56663662, "question_id": 56658920, "link": "https://stackoverflow.com/questions/56658920/how-to-add-members-to-group-by-using-msgraph-sdk-ruby/56663662#56663662", "title": "How to add members to group by using msgraph-sdk-ruby\uff1f", "body": "<p>Ok, I found out.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>data = {'@odata.id': 'https://graph.microsoft.com/v1.0/directoryObjects/{id}'}.to_json\n@graph.service.post('/groups/{id}/members/$ref', data)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11667485, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pFy3AMTWkjs/AAAAAAAAAAI/AAAAAAAAANM/HrwV8l4iLZo/photo.jpg?sz=128", "display_name": "AT 274", "link": "https://stackoverflow.com/users/11667485/at-274"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56663662, "answer_count": 1, "score": 0, "last_activity_date": 1560934189, "creation_date": 1560907693, "question_id": 56658920, "link": "https://stackoverflow.com/questions/56658920/how-to-add-members-to-group-by-using-msgraph-sdk-ruby", "title": "How to add members to group by using msgraph-sdk-ruby\uff1f", "body": "<p>I'm developping original mailing system by using microsoftgraph and ruby on rails.<br>\nDuring development, I found msgraph-sdk-ruby, and think it help me develop.<br>\nBut now, I am troubled not knowing how to add members to group by using this sdk.   </p>\n\n<p>Could anyone help me?</p>\n\n<p>I think I can make it like this...</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>graph.groups.find('group-id').members.create~~~\n</code></pre>\n"}, {"tags": ["ruby", "xml", "parsing", "nokogiri", "screen-scraping"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561323790, "post_id": 56658786, "comment_id": 100015200, "body": "Be careful trusting the inspector inside a browser. That HTML can be very different that what Nokogiri sees when the page is passed to it because JavaScript can modify the page which then the browser will show you. Instead always download the page using <code>wget</code> or <code>curl</code> or something similar, open it in your text editor and look at it."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1561323904, "post_id": 56658786, "comment_id": 100015235, "body": "&quot;<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5854209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23dfebca3122f4c6028cd64eb6009f1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne G", "link": "https://stackoverflow.com/users/5854209/anne-g"}, "edited": false, "score": 0, "creation_date": 1560911966, "post_id": 56659136, "comment_id": 99888165, "body": "parsed_page.search(&#39;.listing-item&#39;).map{ |div| div[&#39;id&#39;] } [&quot;listing_328&quot;, &quot;listing_389&quot;, &quot;listing_129&quot;, &quot;listing_125&quot;, &quot;listing_394&quot;, &quot;listing_341&quot;] Awesome, thanks"}], "tags": [], "owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "is_accepted": false, "score": 1, "last_activity_date": 1560909976, "creation_date": 1560909976, "answer_id": 56659136, "question_id": 56658786, "link": "https://stackoverflow.com/questions/56658786/how-to-retrieve-data-from-a-xml-using-nokogiri/56659136#56659136", "title": "How to retrieve data from a XML using Nokogiri", "body": "<p>You can get those with:</p>\n\n<pre><code>parsed_page.search('.listing-item').map{ |div| div['id'] }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5854209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f23dfebca3122f4c6028cd64eb6009f1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne G", "link": "https://stackoverflow.com/users/5854209/anne-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561323654, "creation_date": 1560906060, "last_edit_date": 1561323654, "question_id": 56658786, "link": "https://stackoverflow.com/questions/56658786/how-to-retrieve-data-from-a-xml-using-nokogiri", "title": "How to retrieve data from a XML using Nokogiri", "body": "<p>I am trying to scrape a web page and extract a unique identifier for each listing such as \"listing_328\". </p>\n\n<p>This is raw data from the Firefox inspector:</p>\n\n<pre><code>&lt;div id=\"result_container\" class=\"listings js-listings-container\"&gt;\n  &lt;div class=\"listing-item result js-listing-item\" id=\"listing_328\"&gt;\n  &lt;div class=\"listing-item result js-listing-item\" id=\"listing_389\"&gt;\n  &lt;div class=\"listing-item result js-listing-item\" id=\"listing_129\"&gt;\n</code></pre>\n\n<p>There are six listings total.</p>\n\n<p>I think this gets the children:</p>\n\n<pre><code>elements = parsed_page.xpath('//div[@id=\"result_container\"]/div');\n</code></pre>\n\n<p>Here is the basic code to scrape the page:</p>\n\n<pre><code>require 'nokogiri'\nrequire 'byebug'\nrequire 'webdrivers'\nrequire 'watir'\n\ndef scraper\n\n   url =\".....\"\n   browser = Watir::Browser.new :firefox  \n   browser.goto(url)\n   sleep(5)\n\n   parsed_page = Nokogiri::HTML(browser.html)\n\n   byebug\n\nend\n\nscraper\nbrowser.close\n</code></pre>\n\n<p><code>parsed_page</code> is: </p>\n\n<pre><code>#&lt;Nokogiri::XML::Element:0x3fe0bfc48ea4 name=\"div\" attributes=[#&lt;Nokogiri::XML::Attr:0x3fe0bfc48d8c name=\"id\" value=\"result_container\"&gt;, #&lt;Nokogiri::XML::Attr:0x3fe0bfc48d64 name=\"class\" value=\"listings js-listings-container\"&gt;] children=[#&lt;Nokogiri::XML::Text:0x3fe0bfc4d51c \"\\n  \"&gt;, #&lt;Nokogiri::XML::Element:0x3fe0bfc4d24c name=\"div\" attributes=[#&lt;Nokogiri::XML::Attr:0x3fe0bfc4d0f8 name=\"class\" value=\"listing-item result js-listing-item\"&gt;, #&lt;Nokogiri::XML::Attr:0x3fe0bfc4d0bc name=\"id\" value=\"listing_328\"&gt;] \n</code></pre>\n\n<p>I am looking to extract the <code>listing_item</code> values \"listing_328\" \"listing_389\" etc.</p>\n\n<p>I can dump the <code>parsed_page</code> to text and extract the identifier.</p>\n\n<p>I don't get a match with:</p>\n\n<pre><code>elements.find {|n| puts n.inner_html.match(/(id=.listing_\\d\\d\\d)/)}\n</code></pre>\n\n<p>but I do get a match elsewhere in elements in a different format.</p>\n\n<pre><code>elements.find {|n| puts n.inner_html.match(/data-listing-id=.(\\d\\d\\d)/)}\n</code></pre>\n\n<p>Can I do better? </p>\n\n<p>I don't have the id for the children. </p>\n"}, {"tags": ["ruby", "heroku", "rubygems", "bundler"], "answers": [{"tags": [], "owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1560906695, "creation_date": 1560906695, "answer_id": 56658835, "question_id": 56657831, "link": "https://stackoverflow.com/questions/56657831/heroku-push-failing-due-to-gem-file/56658835#56658835", "title": "Heroku: push failing due to gem file", "body": "<p>The relevant part of the error message appears to be</p>\n\n<pre><code>can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\n</code></pre>\n\n<p>You shouldn't need to install <code>bundler</code> on Heroku, and I'm not sure how helpful it is to have in your <code>Gemfile</code> even in development. If you don't have Bundler, how will you run <code>bundle install</code> in the first place?</p>\n\n<p>Try taking <code>bundler</code> out of your <code>Gemfile</code> (and <code>Gemfile.lock</code>), then redeploy.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 3404934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc90debdbd2954883e37eb2cce9216f2?s=128&d=identicon&r=PG&f=1", "display_name": "user3404934", "link": "https://stackoverflow.com/users/3404934/user3404934"}, "is_accepted": false, "score": 0, "last_activity_date": 1561019263, "creation_date": 1561019263, "answer_id": 56681974, "question_id": 56657831, "link": "https://stackoverflow.com/questions/56657831/heroku-push-failing-due-to-gem-file/56681974#56681974", "title": "Heroku: push failing due to gem file", "body": "<p>My problem was that I was using an older version of Ruby that was not compatible with Heroku.  I installed the latest version of Ruby, and rebuilt my app.  I was then able to push to Heroku successfully.</p>\n\n<p>A pretty simple thing to catch really, but the error message wasn't totally helpful.</p>\n\n<p>Anywho, thanks!</p>\n"}], "owner": {"reputation": 3, "user_id": 3404934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc90debdbd2954883e37eb2cce9216f2?s=128&d=identicon&r=PG&f=1", "display_name": "user3404934", "link": "https://stackoverflow.com/users/3404934/user3404934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561019263, "creation_date": 1560896921, "last_edit_date": 1560906809, "question_id": 56657831, "link": "https://stackoverflow.com/questions/56657831/heroku-push-failing-due-to-gem-file", "title": "Heroku: push failing due to gem file", "body": "<p>I have a very simple application that I am trying to push to Heroku and having issues.  I don't have any special Gems installed and doing nothing special, but keep getting an error parsing my <code>Gemfile</code>.</p>\n\n<p>I have seen examples adding Gem 'rails_12factor' defining Bundler version, Ruby version, updating bundler, updating system.  The error doesn't change after doing any of these fixes.  I installed with RailsInstaller recently, so I am running current versions of everything.</p>\n\n<p>Here is my <code>Gemfile</code>:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngit_source(:github) do |repo_name|\n  repo_name = \"#{repo_name}/#{repo_name}\" unless repo_name.include?(\"/\")\n  \"https://github.com/#{repo_name}.git\"\nend\n\nruby '~&gt; 2.3.3'\ngem 'bundler', '~&gt; 2.0.2'\n\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '~&gt; 5.1.7'\n# Use Puma as the app server\ngem 'puma', '~&gt; 3.7'\n# Use SCSS for stylesheets\ngem 'sass-rails', '~&gt; 5.0'\n# Use Uglifier as compressor for JavaScript assets\ngem 'uglifier', '&gt;= 1.3.0'\n# See https://github.com/rails/execjs#readme for more supported runtimes\n# gem 'therubyracer', platforms: :ruby\n\n# Use CoffeeScript for .coffee assets and viewrubys\ngem 'coffee-rails', '~&gt; 4.2'\n# Turbolinks makes navigating your web application faster. Read more:     https://github.com/turbolinks/turbolinks\ngem 'turbolinks', '~&gt; 5'\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\ngem 'jbuilder', '~&gt; 2.5'\n# Use Redis adapter to run Action Cable in production\n# gem 'redis', '~&gt; 4.0'\n# Use ActiveModel has_secure_password\n# gem 'bcrypt', '~&gt; 3.1.7'\n\n# Use Capistrano for deployment\n# gem 'capistrano-rails', group: :development\n\ngroup :development, :test do\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\n  gem 'byebug',  '11.0.1'\n\n  # Adds support for Capybara system testing and selenium driver\n  gem 'capybara', '&gt;= 2.15'\n  gem 'selenium-webdriver'\n\n  # Use sqlite3 as the database for Active Record\n  gem \"sqlite3\", \"~&gt; 1.3.6\"\n\nend\n\ngroup :development do\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; anywhere in the code.\n  gem 'web-console', '&gt;= 3.3.0'\nend\n\ngroup :production do\n  gem 'pg'\n  gem 'rails_12factor'\nend\n\n# Windows does not include zoneinfo files, so bundle the tzinfo-data gem\ngem 'tzinfo-data', platforms: [:mingw, :mswin, :x64_mingw, :jruby]\n</code></pre>\n\n<p>This the error I am gettting:</p>\n\n<pre><code>$ git push herokustaging master\nEnumerating objects: 300, done.\nCounting objects: 100% (300/300), done.\nDelta compression using up to 8 threads\nCompressing objects: 100% (275/275), done.\nWriting objects: 100% (300/300), 59.91 KiB | 1.50 MiB/s, done.\nTotal 300 (delta 96), reused 0 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote:\nremote:  !     Warning: Multiple default buildpacks reported the ability to handle this app. The first buildpack in the list below will be used.\nremote:                         Detected buildpacks: Ruby,Node.js\nremote:                         See https://devcenter.heroku.com/articles/buildpacks#buildpack-detect-order\nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote:\nremote:  !\nremote:  !     There was an error parsing your Gemfile, we cannot continue\nremote:  !     /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/rubygems.rb:289:in `find_spec_for_exe': can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\nremote:  !     from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/rubygems.rb:308:in `activate_bin_path'\nremote:  !     from /tmp/d20190618-120-vf683l/bundler-2.0.1/bin/bundle:23:in `&lt;main&gt;'\nremote:  !\nremote:  !     Push rejected, failed to compile Ruby app.\nremote:\nremote:  !     Push failed\nremote: Verifying deploy...\nremote:\nremote: !       Push rejected to sojournsb.\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1560998549, "post_id": 56657138, "comment_id": 99923070, "body": "You&#39;re being downvoted because you haven&#39;t shown any code samples that you&#39;ve tried, and this is a homework assignment"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "edited": false, "score": 0, "creation_date": 1560971022, "post_id": 56662504, "comment_id": 99915924, "body": "Thanks ! it was nice suggestion."}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 0, "last_activity_date": 1561012053, "last_edit_date": 1561012053, "creation_date": 1560930152, "answer_id": 56662504, "question_id": 56657138, "link": "https://stackoverflow.com/questions/56657138/input-using-command-line-arguments/56662504#56662504", "title": "Input using command line arguments", "body": "<p>I'm not sure it's a good idea to use program arguments for that kind of test (I would use a file with all the possible transations).</p>\n\n<p>If you still want to use ARGV when you call your ruby program like this : <code>ruby prog_name.rb ABC:2000 XYZ:3000 transfer:200</code> ARGV will look like this : <code>[\"ABC:2000\", \"XYZ:3000\", \"transfer:200\"]</code><br>\nSo </p>\n\n<ul>\n<li>ARGV[0] is \"customer_name1:account_balance1\" (use split(':') &amp; to_i to get the right values)</li>\n<li>ARGV[1] is \"customer_name2:account_balance2\"</li>\n<li>ARGV[2] is \"transfer:transaction_amount\"</li>\n</ul>\n\n<hr>\n\n<p>My suggestion for the file usage involve the <code>gets</code> function. Basically you'll create a file that contains the following :</p>\n\n<pre><code>create_account ABC\ncreate_account XYZ\ndeposit 2000 ABC\ndeposit 3000 XYZ\ntransfer 200 ABC XYZ\n</code></pre>\n\n<p>With this data you know what you're doing and what function you'll call, the program using the Account class will have this structure :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require \"account\" # I'm supposing your $LOAD_PATH is correctly set\n\nwhile (line = gets)\n  command, *params = line.split(' ')\n  case command\n  when 'create_account'\n    # Create an account with name = params.first\n  when 'deposit'\n    # Deposit params.first.to_i in account with name params[1]\n  when 'transfer'\n    # Make sure account with name params[1] has params.first.to_i in its balance\n    # Withdraw params.first.to_i from account with name params[1]\n    # Deposit params.first.to_i in account with name params[2]\n  else\n    puts \"Unknown command #{command} in line #{line}\"\n  end\nend\n</code></pre>\n\n<p>This way you'll only have to call <code>ruby program_name.rb dataset.txt</code> and it'll process all the line of dataset.txt. You can create various dataset to make sure your account manager does the right thing. (So you'll need to make transfert methods &amp; find account method in a AccountManager class).</p>\n"}], "owner": {"reputation": 1, "user_id": 11666817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94bfbc906f8ac86327d3f953cea3315?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Kannojia", "link": "https://stackoverflow.com/users/11666817/abhinav-kannojia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1561012053, "creation_date": 1560892464, "question_id": 56657138, "link": "https://stackoverflow.com/questions/56657138/input-using-command-line-arguments", "title": "Input using command line arguments", "body": "<p>Define a class Account with three three attributes \"name\",\"account_no\" &amp; \"balance\". Name and Balance should be set when creating an object of Account class, account_number should be auto increment. This Account class must have two methods, deposit() and withdraw().</p>\n\n<p>Your program should take three arguments\n1. customer one\n2. customer two\n3. transaction amount</p>\n\n<p>Input Format:\ncustomer_name1:account_balance1 customer_name2:account_balance2 transfer:transaction_amount</p>\n\n<p>I am trying to get input using ARGV, but not sure how to get input in format --\nABC:2000 XYZ:3000 transfer:200</p>\n\n<p>Any suggestions ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 1, "creation_date": 1560889031, "post_id": 56656432, "comment_id": 99882814, "body": "Looks like you&#39;ve pasted the wrong text where you wanted to paste the error. Also, it&#39;d be nice if you&#39;d properly capitalize your sentences as a courtesy to those trying to help you :)"}, {"owner": {"reputation": 1, "user_id": 11666564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ff33f24a601828a4c9278f85008004?s=128&d=identicon&r=PG&f=1", "display_name": "Papelnaranja", "link": "https://stackoverflow.com/users/11666564/papelnaranja"}, "reply_to_user": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 1, "creation_date": 1560889103, "post_id": 56656432, "comment_id": 99882839, "body": "Thank you, first time posting , i get bit nervous. i&#39; going to edited :)"}, {"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1560889808, "post_id": 56656432, "comment_id": 99883125, "body": "Can you show us what&#39;s inside the <code>attributes_collection</code> variable?"}, {"owner": {"reputation": 1, "user_id": 11666564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ff33f24a601828a4c9278f85008004?s=128&d=identicon&r=PG&f=1", "display_name": "Papelnaranja", "link": "https://stackoverflow.com/users/11666564/papelnaranja"}, "edited": false, "score": 0, "creation_date": 1560890281, "post_id": 56656432, "comment_id": 99883335, "body": "#&lt;Enumerator: [&quot;redcompra&quot;]:map&gt; , &#39;redcompra&#39; was the tag I used in the form"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "edited": false, "score": 0, "creation_date": 1560895133, "post_id": 56656432, "comment_id": 99885015, "body": "I guess the problem is with <code>attributes_collection</code>, each of its element my be array, not hash in order to use <code>attributes_collection.map { |a| a[&quot;id&quot;] || a[:id] }</code>. Also, in the form, it should be <code>&lt;%= form.fields_for :tags_attributes do |tag_form|  %&gt;</code> to differentiate with the <code>form</code> variable above"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1560923021, "post_id": 56656432, "comment_id": 99890468, "body": "Where does <code>attributes_collection</code> come from? It looks like it is not a Hash. A bit confusing it does not complain about the String access first."}, {"owner": {"reputation": 86, "user_id": 7362270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LiRx1XlChl4/AAAAAAAAAAI/AAAAAAAAMeU/zJyfKQ98pD0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Landovsk&#253;", "link": "https://stackoverflow.com/users/7362270/tom%c3%a1%c5%a1-landovsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1560928255, "post_id": 56656432, "comment_id": 99892696, "body": "Best would be for you to install debugger (I use <code>pry-rails</code>, put <code>binding.pry</code> breakpoint one line above <code>attribute_ids = attributes_collection.map</code> (if that&#39;s the line throwing exceptions), reload the page and in the debugger see what&#39;s inside the <code>attributes_collection</code> and how you need to update to mapper to do what you need."}], "owner": {"reputation": 1, "user_id": 11666564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ff33f24a601828a4c9278f85008004?s=128&d=identicon&r=PG&f=1", "display_name": "Papelnaranja", "link": "https://stackoverflow.com/users/11666564/papelnaranja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560889493, "creation_date": 1560888851, "last_edit_date": 1560889493, "question_id": 56656432, "link": "https://stackoverflow.com/questions/56656432/rails-typeerror-no-implicit-conversion-of-symbol-into-integer-using-nested-att", "title": "Rails TypeError: no implicit conversion of Symbol into Integer, using nested attributes", "body": "<p>I'm trying to add a tag to a shop from the create a shop form.\nFor that i'm using nested attributes, but i get the following error:</p>\n\n<p><strong>No implicit conversion of Symbol into Integer</strong></p>\n\n<p><strong>Extracted source (around line #492):</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>   association.target\n else\n   attribute_ids = attributes_collection.map { |a| a[\"id\"] || a[:id] }.compact\n   attribute_ids.empty? ? [] : association.scope.where(association.klass.primary_key =&gt; attribute_ids)\n end\n</code></pre>\n\n<p>My code is:</p>\n\n<p><strong>Shop.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Shop &lt; ApplicationRecord\n    has_many :shop_tags ,  dependent: :destroy\n    has_many :tags, through: :shop_tags\n    accepts_nested_attributes_for :tags\nend\n\n</code></pre>\n\n<p><strong>shops_controller.rb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>  def create\n    @shop = Shop.new(shop_params)\n    # scaffold code \n  end\n\n    def shop_params\n      params.require(:shop).permit(\n        :longitude, :latitude, :name, :description, :state, :address, \n        tags_attributes:[:name, :id])\n    end\n\n</code></pre>\n\n<p>_form.html.erb</p>\n\n<pre><code>&lt;%= form_with(model: @shop , local: true, scope: \"shop\") do |form| %&gt;\n  #the first part of the form\n   &lt;div class=\"form-group\"&gt;\n     &lt;%= form.fields_for :tags_attributes do |form|  %&gt;\n          &lt;%= form.label :name, %&gt;\n          &lt;%= form.text_field :name ,class:'form-control' %&gt;\n     &lt;% end %&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n\n\n</code></pre>\n\n<p>i tried changing the field_for <code>:tags_attributes</code> for <code>:tags</code> or <code>:tag</code> but i get a unpermited param error. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby", "kubernetes", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1560889068, "post_id": 56656382, "comment_id": 99882823, "body": "its expected behaviour if you dont pass basic auth headers"}, {"owner": {"reputation": 576, "user_id": 1272013, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/769b3ccb233f1144eccad8c6038e8cf4?s=128&d=identicon&r=PG", "display_name": "cyc115", "link": "https://stackoverflow.com/users/1272013/cyc115"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1560889257, "post_id": 56656382, "comment_id": 99882910, "body": "Hi Martin, thanks for the tip! Can you expand on that?"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1560889911, "post_id": 56656382, "comment_id": 99883180, "body": "Check out <a href=\"https://stackoverflow.com/a/39640325/4950680\"><code>this SO answer</code></a> and make sure you pass <code>Authorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l</code> header where <code>QWxhZGRpbjpPcGVuU2VzYW1l</code> is a base-64 encoded ASCII string in format <code>username:password</code>"}, {"owner": {"reputation": 576, "user_id": 1272013, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/769b3ccb233f1144eccad8c6038e8cf4?s=128&d=identicon&r=PG", "display_name": "cyc115", "link": "https://stackoverflow.com/users/1272013/cyc115"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1560890609, "post_id": 56656382, "comment_id": 99883469, "body": "My browser is sending an <code>Authorization: Basic XXX</code> header to the endpoint (to nginx at least). Maybe nginx is not doing a good job forwarding. Is there a way to print the received header in the <code>authenticate</code> method to confirm that the header is there?"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1560891161, "post_id": 56656382, "comment_id": 99883697, "body": "<code>request.headers[&quot;Authorization&quot;]</code>, <code>request.headers[&quot;HTTP_AUTHORIZATION&quot;]</code> or just <code>request.headers</code> to get hash with all headers of the request. I would just request backend directly via curl"}, {"owner": {"reputation": 576, "user_id": 1272013, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/769b3ccb233f1144eccad8c6038e8cf4?s=128&d=identicon&r=PG", "display_name": "cyc115", "link": "https://stackoverflow.com/users/1272013/cyc115"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1560894732, "post_id": 56656382, "comment_id": 99884905, "body": "Thanks for the help Martin! it turns out to be Nginx that stripped the Authentication header..."}], "owner": {"reputation": 576, "user_id": 1272013, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/769b3ccb233f1144eccad8c6038e8cf4?s=128&d=identicon&r=PG", "display_name": "cyc115", "link": "https://stackoverflow.com/users/1272013/cyc115"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560888923, "creation_date": 1560888623, "last_edit_date": 1560888923, "question_id": 56656382, "link": "https://stackoverflow.com/questions/56656382/authenticate-with-http-basic-block-not-executed", "title": "Authenticate_with_http_basic block not executed", "body": "<p>I am observing some weird behavior in my Rails 5.2 app where the basic authentication portion is skipped and is always falsey.</p>\n\n<p>This code runs perfectly fine under local dev environment but <code>authenticate_with_http_basic</code> block is never hit under a kubernetes deployment.</p>\n\n<p>The kubernetes app deployment is fronted by a nginx proxy</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>     class ApplicationController &lt; ActionController::Base\n       before_action :authenticate\n\n       def authenticate\n         if _valid_credentials?\n           # never gets to this part\n           true\n         else\n           # enters the else block\n           request_http_basic_authentication\n        end\n      end\n\n      def _valid_credentials?\n        Rails.logger.debug(\"Function is entered\")\n\n        authenticate_with_http_basic do |username, password|\n          cred = \"#{username}|#{password}\"\n          # Nothing is printed with Rails.logger.debug\n          Rails.logger.debug(\"Received credentials: #{cred}\")\n          # Running rails console reveals the correct ::Configuration.credentials\n          SecureCompare.compare(cred, ::Configuration.credentials)\n        end\n      end\n    end\n\n</code></pre>\n\n<p>kubernetes logs:</p>\n\n<pre><code>\nnginx xxx.xxx.xx.xx 0.004 0.002930 - test_user [18/Jun/2019:20:11:26 +0000]  \"GET / HTTP/1.1\" 401 38 \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3829.0 Safari/537.36\" b9af3f83-b2b8-43e1-bee7-1603f5ada6c2 -\napp-deployment-name Processing by XXXController#index as HTML\napp-deployment-name Function is entered\napp-deployment-name Filter chain halted as :authenticate rendered or redirected\napp-deployment-name Completed 401 Unauthorized in 0ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>Any idea or suggestion is welcome.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "is_accepted": true, "score": 1, "last_activity_date": 1560889203, "creation_date": 1560889203, "answer_id": 56656506, "question_id": 56655981, "link": "https://stackoverflow.com/questions/56655981/options-for-select-outputting-blank-values-and-label-values/56656506#56656506", "title": "options for select outputting blank values and label values", "body": "<p>You are defining your hash keys as <code>symbol</code> but in your loop you are accessing them as <code>string</code>.</p>\n\n<p>Change your loop like this:</p>\n\n<pre><code>formatted_options = options_for_select(select_options.collect { |f| [ f[:name], f[:id], {'data-thumb' =&gt; f[:thumb]} ] })\n</code></pre>\n\n<p>If you want to access your hash both by using <code>symbol</code> keys and <code>string</code> keys, you can call <a href=\"https://apidock.com/rails/Hash/with_indifferent_access\" rel=\"nofollow noreferrer\"><code>with_indifferent_access</code></a> method of hash</p>\n\n<p>In that case you need to change your hash like this:</p>\n\n<pre><code>[{:name=&gt;\"Label\", :id=&gt;\"326613406\", :thumb=&gt;\"https://something/whatever\"}.with_indifferent_access]\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11065406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed7e3c0b70f149e1e675fb5c6684070?s=128&d=identicon&r=PG&f=1", "display_name": "C. Passmore", "link": "https://stackoverflow.com/users/11065406/c-passmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 56656506, "answer_count": 1, "score": 0, "last_activity_date": 1560889203, "creation_date": 1560886816, "question_id": 56655981, "link": "https://stackoverflow.com/questions/56655981/options-for-select-outputting-blank-values-and-label-values", "title": "options for select outputting blank values and label values", "body": "<p>I'm trying to populate a select tag from an array of hashes. When I use options_for_select, it's outputting the correct number of options, but value label and option text is not there.</p>\n\n<pre><code>[{:name=&gt;\"Label\", :id=&gt;\"326613406\", :thumb=&gt;\"https://something/whatever\"},another hash]\n\nformatted_options = options_for_select(select_options.collect { |f| [ f['name'], f['id'], {'data-thumb' =&gt; f['thumb']} ] })\n\nreturn select_tag \"#{object.class.to_s.downcase + '[content][' + field.name + ']'}\", formatted_options, {class: \"image-support-select\"}\n</code></pre>\n\n<p>I would expect that the value and text of the option elements would show. Also, I'd like to include a data attribute for each option tag.</p>\n"}, {"tags": ["ruby", "testing", "rspec"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560881756, "post_id": 56654832, "comment_id": 99879661, "body": "As a note, you can use Single-Table Inheritance (STI) without needing polymorphism."}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 2, "last_activity_date": 1560882034, "creation_date": 1560882034, "answer_id": 56654918, "question_id": 56654832, "link": "https://stackoverflow.com/questions/56654832/testing-an-abstracted-if-conditional/56654918#56654918", "title": "Testing an abstracted if conditional", "body": "<p>This example is a case where you really should have two subclasses, each of which implements its own <code>communities</code> method:</p>\n\n<pre><code>class CommunityFinder::Base\n  def initialize(**options)\n    @options = options\n  end\nend\n\nclass CommunityFinder::Mine &lt; CommunityFinder::Base\n  def communities\n  end\nend\n\nclass CommunityFinder::Visible &lt; CommunityFinder::Base\n  def communities\n  end\nend\n</code></pre>\n\n<p>You can use a factory method to instantiate the correct subclass:</p>\n\n<pre><code>module CommunityFinder\n  def self.filter(**options)\n    if (options[:my_communities])\n      CommunityFinder::Mine.new(options)\n    else\n      CommunityFinder::Visible.new(options)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 3423, "user_id": 1270084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fc73b85dd7f187cd3285334c2406de?s=128&d=identicon&r=PG", "display_name": "FullOnFlatWhite", "link": "https://stackoverflow.com/users/1270084/fullonflatwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 56654918, "answer_count": 1, "score": 1, "last_activity_date": 1560882034, "creation_date": 1560881601, "last_edit_date": 1560881917, "question_id": 56654832, "link": "https://stackoverflow.com/questions/56654832/testing-an-abstracted-if-conditional", "title": "Testing an abstracted if conditional", "body": "<p>I'm trying to figure out the best way to test <code>find_communities</code> here without resorting to using polymorphism here to defeat the <code>if</code> statement staring at me.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class CommunityFinder\n  def initialize(filters={})\n    @filters = filters\n  end\n\n  def find_communities\n     return my_communities if @filters[:my_communities]\n     visible_communities\n  end\n\n  def my_communities\n     # [...]\n  end\n\n  def visibile_communities\n     # [...]\n  end\nend\n</code></pre>\n\n<p>I have both <code>my_communities</code> and <code>visible_communities</code> well tested, but I have concerns about testing <code>find_communities</code>.</p>\n\n<ol>\n<li>I don't want to duplicate the test setup for both <code>my_communities</code> and <code>visible_communities</code>, because there's likely going to be</li>\n<li>I would prefer for the class API to contain all 3 public methods because the conditions for <code>find_communities</code> won't ever change.</li>\n<li>I'm writing this with the expectation that the class is going to change by someone other than me in the near future, and that there's going to be more methods</li>\n</ol>\n\n<p>Should I:</p>\n\n<ol>\n<li>make <code>find_communities</code> live in the caller</li>\n<li>make <code>find_communities</code> be it's own strategy</li>\n<li>duplicate the tests into <code>find_communities</code></li>\n<li>pick your own 4th option.</li>\n</ol>\n"}, {"tags": ["ruby-on-rails", "ruby", "forms", "simple-form", "collection-select"], "comments": [{"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 1, "creation_date": 1560881987, "post_id": 56654090, "comment_id": 99879780, "body": "Can you please also elaborate a bit on what exactly you mean by not working, if there is a error, pasting that is also helpful."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1560886215, "post_id": 56654090, "comment_id": 99881620, "body": "Good point. Just edited it to include the error. @ Zia Ul Rehman Mughal"}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 1, "creation_date": 1560921761, "post_id": 56654090, "comment_id": 99890088, "body": "Its been long since i used simple_form(have been working on frontend frameworks now) but quick look in <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow noreferrer\">github.com/plataformatec/simple_form</a> suggests you need to provide name of asssociation, not single objects. And what i have used and like most is the nested forms, with accepts_nested_attributes_for defined in model chains. Like the block method from <a href=\"https://www.rubydoc.info/github/plataformatec/simple_form/master/SimpleForm%2FFormBuilder:association\" rel=\"nofollow noreferrer\">rubydoc.info/github/plataformatec/simple_form/master/&hellip;</a>"}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1560977574, "post_id": 56654090, "comment_id": 99918590, "body": "Thanks. Zia. I guess I&#39;m wondering how to pass in the name of the association through the block. If I do <code>&lt;%= f.association choice.name %&gt;</code> I get an error such as, <code>Association &quot;Red&quot; not found</code>"}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 1, "creation_date": 1561672250, "post_id": 56654090, "comment_id": 100152323, "body": "Maybe try something like this: &lt;%= f.association choice, label_method: :name, value_method: :id %&gt;`"}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1562083351, "post_id": 56654090, "comment_id": 100262734, "body": "Thanks Jake. I get the same error when trying that. I feel like I&#39;m missing something fundamental about how I&#39;m approaching this problem."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "edited": false, "score": 0, "creation_date": 1562169045, "post_id": 56654090, "comment_id": 100296241, "body": "Could the issue be that I&#39;m trying to do this in the edit form and there are no associations created that are available in the edit action? If I try to use <code>&lt;%= f.association choice, label_method: :name, value_method: :id %&gt;</code> on the new action I get a no method error <code>undefined method </code>options&#39; for nil:NilClass`. Which makes sense because I haven&#39;t associated the variant with a product and its associated options yet. So perhaps I need a nested form on variant#new to create the associations and then I&#39;ll be able to access them in the form or variant views, etc."}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1562222513, "post_id": 56654090, "comment_id": 100311796, "body": "@LeeMcAlilly yes, try that. Makes sense."}, {"owner": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 1, "creation_date": 1562673875, "post_id": 56654090, "comment_id": 100442762, "body": "I&#39;m kind of wondering how options, choices, and product are being called in other ways besides Option, Choice, or Product. Are you defining these methods in your controller? Or, as an object (or variable, IDK the jargon) in the case as <code>@product</code> and <code>@variant</code>? Please show your controller, you may even be missing something in your params."}, {"owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "reply_to_user": {"reputation": 947, "user_id": 7372897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fef45f6e174d50b0fb51c2069653b3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7372897/jake"}, "edited": false, "score": 0, "creation_date": 1562775134, "post_id": 56654090, "comment_id": 100485703, "body": "@Jake Yes they are objects, not methods. Here&#39;s the ProductsController: <a href=\"https://gist.github.com/leemcalilly/b044805f1c40612deaf618cbfe6a24b6\" rel=\"nofollow noreferrer\">gist.github.com/leemcalilly/b044805f1c40612deaf618cbfe6a24b6</a> //// OptionsController: <a href=\"https://gist.github.com/leemcalilly/3aa5ce49fe423e7259db34b8c7f43cff\" rel=\"nofollow noreferrer\">gist.github.com/leemcalilly/3aa5ce49fe423e7259db34b8c7f43cff</a> ///// ChoicesController: <a href=\"https://gist.github.com/leemcalilly/2c0262fdf14a8ef9537084c26d52f254\" rel=\"nofollow noreferrer\">gist.github.com/leemcalilly/2c0262fdf14a8ef9537084c26d52f254</a>"}], "owner": {"reputation": 8270, "user_id": 168286, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EcFEn.jpg?s=128&g=1", "display_name": "Lee McAlilly", "link": "https://stackoverflow.com/users/168286/lee-mcalilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1562083561, "creation_date": 1560878137, "last_edit_date": 1560886189, "question_id": 56654090, "link": "https://stackoverflow.com/questions/56654090/how-to-use-a-rails-collection-select-inside-a-block", "title": "How to use a Rails collection select inside a block", "body": "<p>I'm using <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow noreferrer\">Simple Form</a> in my Rails 6 e-commerce inventory tracking, and I need to have multiple collection selects in my form that appear based on an association.</p>\n\n<p>Here's the data model:</p>\n\n<pre><code>Product\n   has_many Option(s)\nOption\n   has_many Choice(s)\n   belongs_to Product\nChoice\n   has_many Variant(s)\n   belongs_to Option\nVariant\n   belongs_to Choice(s)\n</code></pre>\n\n<p>So a Product might look like this:</p>\n\n<pre><code>Product =&gt; T-Shirt\nOptions =&gt; Size { choices: small, medium, large }, Color { choices: red, green, blue }\nVariant #1 =&gt; T-Shirt in Medium Red, etc.\n</code></pre>\n\n<p>How do I build the collection selects for the Product Options when not every product will have the same number of options that the customer will need to choose such as size or color? Some products might have 0 options, others 1 (e.g. just color), 2 (e.g. size and color), 3, etc.</p>\n\n<p>So, on the Variant form I'd like to gather the collections that belong to the associated product. I can show them on the Variant#show view like this:</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% @product.options.each do |option| %&gt;\n    &lt;li&gt;\n      &lt;%= option.name %&gt;\n      &lt;ul&gt;\n        &lt;% option.choices.each do |choice| %&gt;\n          &lt;li&gt;&lt;%= choice.name %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>That works as expected in the Variants#show view.</p>\n\n<p>But how do you do this same sort of thing and gather 0 or more Options with their associated choices in the Variant form with a collection_select? I'm using simple form, so I'm trying something like this, but it's not working and I'm blocked:</p>\n\n<pre><code>&lt;% @variant.product.options.each do |option| %&gt;\n    &lt;div class='form-row'&gt;\n      &lt;div class='col'&gt;\n        &lt;%= f.label option.name %&gt;\n        &lt;% option.choices.each do |choice| %&gt;\n          &lt;%= f.association choice %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;&lt;!-- /.col --&gt;\n    &lt;/div&gt;&lt;!-- /.form-row --&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>That version of the form gives me the following error:</p>\n\n<pre><code>RuntimeError in Variants#edit\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZxrJl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZxrJl.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1560876369, "post_id": 56653598, "comment_id": 99877301, "body": "\u201cI got errors\u201d doesn&#39;t tell us much. What are the errors?"}, {"owner": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1560876415, "post_id": 56653598, "comment_id": 99877327, "body": "If you&#39;re trying to ask a question about the difference between the two blocks of sample code you need to edit the title so this doesn&#39;t look like a debugging question."}, {"owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "reply_to_user": {"reputation": 67463, "user_id": 203130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/1RE8c.jpg?s=128&g=1", "display_name": "coreyward", "link": "https://stackoverflow.com/users/203130/coreyward"}, "edited": false, "score": 0, "creation_date": 1560877058, "post_id": 56653598, "comment_id": 99877654, "body": "@coreyward Thank you for your advice. I&#39;ve added the error type."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560879029, "post_id": 56653598, "comment_id": 99878506, "body": "Are you by chance defining multiple <code>B</code> classes throughout your test suite?"}, {"owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "edited": false, "score": 0, "creation_date": 1560885045, "post_id": 56653598, "comment_id": 99881107, "body": "Where is B&#39;s defination, also paste the directory hierarchy and your stack versions, ruby and rails"}], "owner": {"reputation": 119, "user_id": 7738138, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1728017913892004/picture?type=large", "display_name": "JiaPing", "link": "https://stackoverflow.com/users/7738138/jiaping"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560876969, "creation_date": 1560875940, "last_edit_date": 1560876969, "question_id": 56653598, "link": "https://stackoverflow.com/questions/56653598/request-spec-failed-on-classes-nested-in-module-with-namespace-problem", "title": "Request spec failed on classes nested in module with namespace problem", "body": "<p>Rspec works fine when I run a single file.\nHowever, I got NameError because I can't get the methods from parent A class when I use <code>bundle exec rspec</code> to run all specs.</p>\n\n<p>I checked c.class.ancestors on these two.\nI found that B lost namespace A when running all specs.\nBut B keep namespace A when running single spec file.</p>\n\n<p>Here is my sample code.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> module A\n   class C &lt; B\n   end\n end\n</code></pre>\n\n<p>I know I maybe can solve this error if I change the code like this</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> module A\n   class C &lt; A::B\n   end\n end\n</code></pre>\n\n<p>But I am not sure if it is the correct approach.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "edited": false, "score": 0, "creation_date": 1560879865, "post_id": 56654338, "comment_id": 99878865, "body": "Hey Max, I appreciate the help. Unfortunately I had made a typo the first time round, and had meant to write <code>topics</code> instead of <code>skills</code>. I figured I could do something like what you are saying, ie: limiting the <code>topics</code> of a <code>PersonSubject</code> record to those linked to by the associated <code>subject</code>, but I would also then like to know that removing any of the <code>subject.topics</code> for the <code>PersonSubject</code> record will actually update which <code>topics</code>  are linked to from the <code>PersonSubject</code> record."}, {"owner": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "edited": false, "score": 0, "creation_date": 1560887408, "post_id": 56654338, "comment_id": 99882132, "body": "The problem with <code>through</code> is that it gives me all <code>topics</code> of the associated <code>subject</code>, whereas I would like to be able to set the <code>topics</code> of the <code>TutorSubject</code> record to be a subset of that of the <code>subject.topics</code> (or am I being silly? is there another way?)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "edited": false, "score": 0, "creation_date": 1560887784, "post_id": 56654338, "comment_id": 99882302, "body": "@Arnoux I think you can combine the <code>has_many :through</code> with the lambda option in this case. How do you link Topic with PersonSubject? Each topic has a person_subject_id?"}, {"owner": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "edited": false, "score": 0, "creation_date": 1560888789, "post_id": 56654338, "comment_id": 99882719, "body": "I was actually hoping to not have to have link the <code>Topic</code> back to <code>PersonSubject</code> at all. Perhaps what I am asking is not possible."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "edited": false, "score": 0, "creation_date": 1560890508, "post_id": 56654338, "comment_id": 99883428, "body": "Can you share all relevant parts of your schema?"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": false, "score": 0, "last_activity_date": 1560884479, "last_edit_date": 1560884479, "creation_date": 1560879314, "answer_id": 56654338, "question_id": 56653528, "link": "https://stackoverflow.com/questions/56653528/activerecord-has-many-choices-limited-to-has-many-of-another-model/56654338#56654338", "title": "ActiveRecord: has_many choices limited to has_many of another model", "body": "<p>You can use a lambda to put arbitrary filters on an association. See <a href=\"https://stackoverflow.com/questions/20307874/what-is-the-equivalent-of-the-has-many-conditions-option-in-rails-4\">What is the equivalent of the has_many &#39;conditions&#39; option in Rails 4?</a></p>\n\n<pre><code>has_many :topics, -&gt; { where(skill: subject.skills) }\n</code></pre>\n\n<p>I don't know that this is exact code will work without seeing your schema (what is the data type of <code>subject.skills</code>, and how do you join this with topic?). But hopefully this gets you on the right track</p>\n\n<p><em>edit</em></p>\n\n<p>in response to your comment, I think</p>\n\n<pre><code>has_many :topics, through: :skills\n</code></pre>\n\n<p>would work</p>\n"}], "owner": {"reputation": 178, "user_id": 8544659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f712ceed3aae8b3b7262ed43dd5d4487?s=128&d=identicon&r=PG&f=1", "display_name": "Arnoux", "link": "https://stackoverflow.com/users/8544659/arnoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560884479, "creation_date": 1560875708, "question_id": 56653528, "link": "https://stackoverflow.com/questions/56653528/activerecord-has-many-choices-limited-to-has-many-of-another-model", "title": "ActiveRecord: has_many choices limited to has_many of another model", "body": "<p>I would like to achieve something as follows where <code>PersonSubject</code> has many topics, but the choices of these topics are limited to the the selection of <code>topics</code> through another model (ie: through the associated <code>subject</code>):</p>\n\n<pre><code>class Topic &lt; ApplicationRecord\n  belongs_to :subject\nend\n\nclass Subject &lt; ApplicationRecord\n  has_many :topics\nend\n\nclass PersonSubject &lt; ApplicationRecord\n  belongs_to :person\n  belongs_to :subject\n  has_many :topics  # where the choices are limited to the subject.skills\nend\n</code></pre>\n\n<p>I would then like if any <code>person_subject.subject.topics</code> are deleted (or association removed), it would automatically update the <code>person_subject.topics</code> to no longer \"point\" to the <code>Topic</code>(s) that were deleted.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["ruby", "intellij-idea"], "comments": [{"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1560981800, "post_id": 56653140, "comment_id": 99919976, "body": "Have you tried the last IDEA 2019.2 EAP?"}], "answers": [{"tags": [], "owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "is_accepted": true, "score": 2, "last_activity_date": 1560981768, "last_edit_date": 1560981768, "creation_date": 1560934966, "answer_id": 56663891, "question_id": 56653140, "link": "https://stackoverflow.com/questions/56653140/how-to-setup-ruby-profiler-in-intellij/56663891#56663891", "title": "How to setup ruby profiler in IntelliJ", "body": "<p>At the moment Ruby profiler isn't available via Ruby plugin in IDEA but it's planned to be in 2019.2:\n<a href=\"https://youtrack.jetbrains.com/issue/RUBY-23977\" rel=\"nofollow noreferrer\">https://youtrack.jetbrains.com/issue/RUBY-23977</a></p>\n\n<p>UPD: it seems to be available in the last IDEA 2019.2 EAPs (starting from 192.5118.30)</p>\n"}], "owner": {"reputation": 350, "user_id": 1480906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f54b576c9d6c524b000b55114ac700b?s=128&d=identicon&r=PG", "display_name": "Andy McCall", "link": "https://stackoverflow.com/users/1480906/andy-mccall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56663891, "answer_count": 1, "score": 0, "last_activity_date": 1560981768, "creation_date": 1560874074, "question_id": 56653140, "link": "https://stackoverflow.com/questions/56653140/how-to-setup-ruby-profiler-in-intellij", "title": "How to setup ruby profiler in IntelliJ", "body": "<p>There seems to have been a recent update for to ruby mine that allows you to attach a rbspy profiler to a rails app. I have found a ton of guides on the internet (<a href=\"https://www.jetbrains.com/help/ruby/cpu-profiler.html\" rel=\"nofollow noreferrer\">for instance this one</a>) that explain what changes need to be updated in ruby mine to allow you to attach the profiler to the ruby process, but i have not been able to find the same steps for intellij with the ruby plugin.</p>\n\n<p>Is there a way to perform the steps linked in the guide above in the Intellij IDE?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "edited": false, "score": 0, "creation_date": 1560876658, "post_id": 56653592, "comment_id": 99877451, "body": "Thank you for your respond. It does work, however it won&#39;t create a new <code>address</code> record. However, seems like a good approach. Thanks."}], "tags": [], "owner": {"reputation": 180, "user_id": 1881608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef99f58ba5a8d821ac4cb357b4478d0?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1881608/praveen"}, "is_accepted": true, "score": 1, "last_activity_date": 1560875900, "creation_date": 1560875900, "answer_id": 56653592, "question_id": 56651881, "link": "https://stackoverflow.com/questions/56651881/adding-custom-form-into-devise-edit-page-ruby-on-rails/56653592#56653592", "title": "Adding custom form into Devise edit page Ruby on Rails", "body": "<p>Here your route user/edit/address is being generate from the match and is written via get method so you need to change it with</p>\n\n<pre><code>match 'user/edit/addresses' =&gt; 'registrations#addresses', via: :post, :as =&gt; :user_addresses\n</code></pre>\n\n<p>and in the form url path helper you are passing current user as a parameter while it does not exist in your route so form should get replace with </p>\n\n<pre><code>= form_for user_addresses_path, url: user_addresses_path, method: 'post', :html =&gt; { class: \"form\", :multipart =&gt; true } do |f|\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 7723441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RTtHX.jpg?s=128&g=1", "display_name": "Anton Sergeyev", "link": "https://stackoverflow.com/users/7723441/anton-sergeyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56653592, "answer_count": 1, "score": 1, "last_activity_date": 1560875900, "creation_date": 1560869624, "last_edit_date": 1560870271, "question_id": 56651881, "link": "https://stackoverflow.com/questions/56651881/adding-custom-form-into-devise-edit-page-ruby-on-rails", "title": "Adding custom form into Devise edit page Ruby on Rails", "body": "<p>I am having a problem to add custom form into Devise <code>edit</code> page. Currently, I have two models <code>User</code> and <code>UserAddress</code>. I splitted <code>edit</code> page on multiple pages, here are my routes: </p>\n\n<pre><code>devise_for :users, path: \"user\", path_names: {sing_in: \"sign_in\", sing_out: \"sign_out\", sing_up: \"sign_up\", edit: \"edit\"}, :controllers =&gt; { :registrations =&gt; :registrations }\ndevise_scope :user do\n  match 'user/edit' =&gt; 'registrations#edit', via: :get, :as =&gt; :user_basic\n  match 'user/edit/addresses' =&gt; 'registrations#addresses', via: :get, :as =&gt; :user_addresses\n  ...\n  resources :user_addresses, only: [:create, :destroy]\nend\nresources :users, path: \"user\", only: [:show]\n</code></pre>\n\n<p>I created <code>User Addresses</code> controller to handle <code>create</code> and <code>destroy</code> actions:</p>\n\n<pre><code>class UserAddressesController &lt; ApplicationController\n  def create\n    @User = User.find(params[:user_id])\n    if params[:addresses]\n      params[:addresses].each do |address|\n        @User.address.create(address: address)\n      end\n      @addresses = @User.addresses\n      redirect_back(fallback_location: request.referer, notice: \"Success\")\n    end\n  end\n\n  def destoy\n    @address = Address.find(params[:id])\n    @User = @address.user\n\n    @address.destroy\n    @addresses = Address.where(user_id: @user.id)\n\n    respond_to :js\n  end\nend\n</code></pre>\n\n<p>And now I want to add the ability to add new addresses from Devise <code>edit</code> page (I will use <code>ajax</code> lately to update the records under the form), like this (<code>haml</code>):</p>\n\n<pre><code>= form_for user_addresses_path, url: user_addresses_path(current_user), method: 'post', :html =&gt; { class: \"form\", :multipart =&gt; true } do |f|\n  = f.text_field :name\n  = f.text_field :address\n  = f.submit\n</code></pre>\n\n<p>When I click <code>submit</code>, I am getting the following error:</p>\n\n<pre><code>No route matches [POST] \"/user/edit/addresses.1\"\n</code></pre>\n\n<p>I think that I need to move <code>resources :user_addresses, only: [:create, :destroy]</code> out of the <code>devise_scope</code>, however I don't want to change the <code>url</code> (www.url.com/user/edit/addresses). What am I doing wrong? Is it even possible to add custom forms into Devise? Thank you very much for your help and time. </p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p><code>UserAddress</code> model:</p>\n\n<pre><code>class UserAddress &lt; ApplicationRecord\n  belongs_to :user, :foreign_key =&gt; 'user_id'\n\n  # Geocoder\n  geocoded_by :address\n  after_validation :geocode, :if =&gt; lambda{ |obj| obj.address_changed? }  \nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 0, "creation_date": 1560884747, "post_id": 56651761, "comment_id": 99880990, "body": "Decided to use a dropdown instead."}], "answers": [{"tags": [], "owner": {"reputation": 1141, "user_id": 1404905, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IYSNE.jpg?s=128&g=1", "display_name": "beniutek", "link": "https://stackoverflow.com/users/1404905/beniutek"}, "is_accepted": true, "score": 1, "last_activity_date": 1561386912, "creation_date": 1561386912, "answer_id": 56738849, "question_id": 56651761, "link": "https://stackoverflow.com/questions/56651761/devise-log-in-using-field-from-different-table-related-to-user/56738849#56738849", "title": "Devise Log in using field from different table - Related to User", "body": "<p>What you want is probably modifying the <code>find_for_database_authentication</code> method that's included to the <code>User</code> when you use Devise.</p>\n\n<p>This is where the method is used when we try to find the resource and authenticate it -> <a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise/strategies/database_authenticatable.rb#L10\" rel=\"nofollow noreferrer\">https://github.com/plataformatec/devise/blob/master/lib/devise/strategies/database_authenticatable.rb#L10</a></p>\n\n<p>When we go and check it further we see that it actually uses <code>find_for_authentication</code> method from the <code>Authenticatable</code> module.</p>\n\n<p>Which in turn uses the <code>find_first_by_auth_conditions</code> method.</p>\n\n<p>All those calls pass the same keys which are used to find the resource.</p>\n\n<p>In the most straightforward scenario it's the <code>:email</code> key that is passed in the request params, but we can change it</p>\n\n<p>Let's modify the <code>find_for_database_authentication</code> method so that we first check the params and if <code>:organization_name</code> key (im assuming that't how the parameter is called) was passed then we will use this info to find the resource.</p>\n\n<pre><code>def find_for_database_authnetication(conditions)\n  if !condition[:organization_name].blank?\n    org = Organization.find_by(name: conditions[:organization_name])\n    org.users.find_by(conditions[:email])\n  else\n    super\n  end\nend\n</code></pre>\n\n<p>I'm writing that without actually testing it so take it with a grain of salt but you should have the general idea of how you can approach your problem.</p>\n"}], "owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56738849, "answer_count": 1, "score": 0, "last_activity_date": 1561386912, "creation_date": 1560869213, "last_edit_date": 1560881946, "question_id": 56651761, "link": "https://stackoverflow.com/questions/56651761/devise-log-in-using-field-from-different-table-related-to-user", "title": "Devise Log in using field from different table - Related to User", "body": "<p>I have my log in set up with 3 fields, organization (string identificator), email and password.</p>\n\n<p>My User model, has a column named organization_id, that identifies which organization he belongs.</p>\n\n<p><strong>I can already login, using the company id, on the log in form.\nHowever, I need to allow users to log in using the organization name. Information that belongs to the Organization model.</strong></p>\n\n<p>Is there anyway, that I can intercept the input from the user before it authenticates, So I can search the database using the organization name input, and replace it with the organization id, so it authenticates in a more friendly way?</p>\n"}, {"tags": ["ruby", "barcode", "zxing"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560866758, "post_id": 56650522, "comment_id": 99871723, "body": "did you check out <a href=\"https://github.com/glassechidna/zxing_cpp.rb\" rel=\"nofollow noreferrer\">github.com/glassechidna/zxing_cpp.rb</a> ?"}, {"owner": {"reputation": 79, "user_id": 9194880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d3d73b2a80eb434e7034a36e04704?s=128&d=identicon&r=PG&f=1", "display_name": "rtuz2th", "link": "https://stackoverflow.com/users/9194880/rtuz2th"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560867679, "post_id": 56650522, "comment_id": 99872332, "body": "Hi, this is exactly the lib I&#39;ve used, just edited my post, sorry"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560910197, "post_id": 56650522, "comment_id": 99887861, "body": "the gem has not been updated in a long time, I&#39;m having trouble even installing the required ruby 1.9 to run it.  I suspect I would get the same result even if I did.  What happens if you desaturate the colors or try to crop out the non barcode portion of the image?"}, {"owner": {"reputation": 79, "user_id": 9194880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d3d73b2a80eb434e7034a36e04704?s=128&d=identicon&r=PG&f=1", "display_name": "rtuz2th", "link": "https://stackoverflow.com/users/9194880/rtuz2th"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561107863, "post_id": 56650522, "comment_id": 99964240, "body": "Hm, this is nothing that could be done automatically in a robust way, this is thought to be used in a script that runs about 2000 images a day, this is the maximum accuracy of the sticker position I can get. I will have a look into the jruby implementation, that one should be a newer implementation if I got everything right?"}, {"owner": {"reputation": 79, "user_id": 9194880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d3d73b2a80eb434e7034a36e04704?s=128&d=identicon&r=PG&f=1", "display_name": "rtuz2th", "link": "https://stackoverflow.com/users/9194880/rtuz2th"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561115246, "post_id": 56650522, "comment_id": 99967822, "body": "I got it wrong. The wrapper is 6 years old, too. Maybe ruby is just the wrong language for this project, just had a look into quagga. Seems like I have to search for my stuff from university, this was the last time I had to deal with Java...  But thank you for your help very much!"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561118303, "post_id": 56650522, "comment_id": 99969279, "body": "I was able to convert the image to greyscale in terminal using image magick which the gem uses under the hood.  <code>convert QC3B1.jpg -set colorspace Gray -separate -average g.jpg</code> so you might play around with that to see iff you can get the images to be more readable?  But again just a guess. Sorry I couldn&#39;t get the old ruby 1.9 running to test the gem.  If I had more time I&#39;d try with a docker container."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561118474, "post_id": 56650522, "comment_id": 99969359, "body": "not sure if this might be useful <a href=\"https://github.com/Inlite/wabr-ruby\" rel=\"nofollow noreferrer\">github.com/Inlite/wabr-ruby</a>"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561118844, "post_id": 56650522, "comment_id": 99969540, "body": "also try <a href=\"https://www.onlinebarcodereader.com/\" rel=\"nofollow noreferrer\">onlinebarcodereader.com</a> but got message  &#39;The result contains not printable characters.&#39; so that could be an encoding problem perhaps?"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1561119531, "creation_date": 1561119531, "answer_id": 56703338, "question_id": 56650522, "link": "https://stackoverflow.com/questions/56650522/xzing-recognizes-barcode-only-in-java-version/56703338#56703338", "title": "Xzing recognizes Barcode only in Java version", "body": "<p>The gem you're using and/or it's dependencies our out of date.  If you want to still use Ruby for your project, you can try using one of the online services in the comments for the decoding.  You could either try to use the \n<a href=\"https://github.com/sparklemotion/mechanize\" rel=\"nofollow noreferrer\">mechanize gem</a> or roll your own using other http ruby tools such as <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">httparty</a> or Ruby's <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/net/http/rdoc/Net/HTTP.html\" rel=\"nofollow noreferrer\">Net::HTTP</a></p>\n"}], "owner": {"reputation": 79, "user_id": 9194880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d3d73b2a80eb434e7034a36e04704?s=128&d=identicon&r=PG&f=1", "display_name": "rtuz2th", "link": "https://stackoverflow.com/users/9194880/rtuz2th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56703338, "answer_count": 1, "score": 1, "last_activity_date": 1561119531, "creation_date": 1560865112, "last_edit_date": 1560867748, "question_id": 56650522, "link": "https://stackoverflow.com/questions/56650522/xzing-recognizes-barcode-only-in-java-version", "title": "Xzing recognizes Barcode only in Java version", "body": "<p>I'm trying to bulk scan some jpg files with barcodes on them. I've used the ruby bindings for the c++ port of xzing. When I have this file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QC3B1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QC3B1.jpg\" alt=\"barcode\"></a>\nscanned by the Web-Version of Xzing (<a href=\"https://zxing.org/w/decode.jspx\" rel=\"nofollow noreferrer\">https://zxing.org/w/decode.jspx</a>) everything turns out fine. When I try to scan this one in ruby (using <a href=\"https://github.com/glassechidna/zxing_cpp.rb\" rel=\"nofollow noreferrer\">https://github.com/glassechidna/zxing_cpp.rb</a>) nothing is recognized. I already tried cranking up the contrast, but it did not help. It's not my ruby setup because it works for loads of other nearly identical codes. The only thing I can think of is any difference between the Java version and the C++ port, but this is absolute poking in the dark, I've started using zxing just today.\nCould anyone get this code recognized in ruby? Thank you very much.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "rubygems", "hstore"], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "edited": false, "score": 0, "creation_date": 1560866949, "post_id": 56650894, "comment_id": 99871859, "body": "Thanks, nice approach, but I&#39;m just able to find a short way to perform this Query:             <b>User.where(&quot;sectors ?| Array[&#39;oil_and_gas&#39;, &#39;energy&#39;, &#39;transport&#39;]&quot;)</b>"}, {"owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "reply_to_user": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "edited": false, "score": 0, "creation_date": 1560867144, "post_id": 56650894, "comment_id": 99871978, "body": "@kashif Glad to help. I agree, your version is shorter."}], "tags": [], "owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "is_accepted": true, "score": 1, "last_activity_date": 1560866361, "creation_date": 1560866361, "answer_id": 56650894, "question_id": 56650373, "link": "https://stackoverflow.com/questions/56650373/hstore-query-to-find-records-matching-with-any-array-element-using-ruby-on-rails/56650894#56650894", "title": "Hstore Query to find records matching with any array element using ruby on rails", "body": "<p>May be you are looking for the following operator:</p>\n\n<pre><code>hstore ? key # does hstore contain key?\n</code></pre>\n\n<p>Query may looks like so:</p>\n\n<pre><code>User.where(\"sectors ? 'oil_and_gas'\")\n    .or(\"sectors ? 'energy'\")\n    .or(\"sectors ? 'transport'\")\n</code></pre>\n\n<p>According to <a href=\"http://www.postgresqltutorial.com/postgresql-hstore/\" rel=\"nofollow noreferrer\">postgresql docs</a></p>\n\n<blockquote>\n  <p>Check for a specific key in hstore column You can check for a specific\n  key in an hstore column using the ? operator in the WHERE clause. For\n  example, the following statement returns all rows with attr contains\n  key publisher.</p>\n</blockquote>\n\n<pre><code>SELECT\n  title,\n  attr-&gt;'publisher' as publisher,\n  attr\nFROM\n  books\nWHERE\n  attr ? 'publisher';\n</code></pre>\n"}], "owner": {"reputation": 973, "user_id": 1659370, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/6d120a0452ccef4756d5e1af5ae01383?s=128&d=identicon&r=PG", "display_name": "kashif", "link": "https://stackoverflow.com/users/1659370/kashif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56650894, "answer_count": 1, "score": 1, "last_activity_date": 1560866361, "creation_date": 1560864695, "last_edit_date": 1560865042, "question_id": 56650373, "link": "https://stackoverflow.com/questions/56650373/hstore-query-to-find-records-matching-with-any-array-element-using-ruby-on-rails", "title": "Hstore Query to find records matching with any array element using ruby on rails", "body": "<p>I've a <strong>hstore</strong> field in a database table. I want to write a Query to find records matching with any array element in any hash of <strong>hstore</strong> field using ruby on rails.</p>\n\n<pre><code> Users Table\n --------------------------------------------------------------------------------\n        ID    Name    sectors(hstore) \n\n        1     Piotr   {\"aviation\"=&gt;\"0\", \"oil_and_gas\" =&gt; \"50\", \"transport\" =&gt; \"50\"}\n        2     reza    {\"oil_and_gas\" =&gt; \"70\", \"energy\" =&gt; \"30\"}\n        3     pat     {\"transport\" =&gt; \"40\", \"energy\" =&gt; \"60\"}\n        4     Kim     {\"infrastructure\" =&gt; \"20\", \"healthcare\" =&gt; \"20\", \"industrial\" =&gt; \"60\"}\n</code></pre>\n\n<p>considering above test data, I want to write a query on hstore field to get all records having any key like ['oil_and_gas', 'energy', 'transport']</p>\n\n<p>I can match and find single sector records as its mentioned in <a href=\"https://nandovieira.com/using-postgresql-and-hstore-with-rails\" rel=\"nofollow noreferrer\">https://nandovieira.com/using-postgresql-and-hstore-with-rails</a>, but my requirement is to find any record where hstore hash is having any one key matching with any one element of array.</p>\n\n<p>I'm using Rails 5.1.6.2, ruby 2.5.3</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "design-patterns", "dry"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1560864076, "post_id": 56649413, "comment_id": 99869941, "body": "Well, extract that piece in its own method. Would already be an improvement."}, {"owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560865136, "post_id": 56649413, "comment_id": 99870689, "body": "Thanks Sergio! should I create the new method on the controller?"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1560866975, "post_id": 56649413, "comment_id": 99871875, "body": "from <code>next_state = ...</code> to <code>redirect_to stories_path</code> is the same code. Move that to a method like <code>def update_status</code> with the code <code>next_state = StoryStateService.new(@story, current_user, nil).call;if next_state;@story.update_column(:status_id, next_state); end;redirect_to stories_path;end</code>"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560869291, "post_id": 56649413, "comment_id": 99873431, "body": "This question should be at codereview <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 0, "creation_date": 1560866447, "post_id": 56650799, "comment_id": 99871514, "body": "Hi Mishal, good point. Thanks for the feedback, StoryStateService, updates a status_id column on the story model, if it passes some business rules."}], "tags": [], "owner": {"reputation": 238, "user_id": 2440476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SNFzq.jpg?s=128&g=1", "display_name": "Mishal Zaman", "link": "https://stackoverflow.com/users/2440476/mishal-zaman"}, "is_accepted": false, "score": 0, "last_activity_date": 1560868669, "last_edit_date": 1560868669, "creation_date": 1560866015, "answer_id": 56650799, "question_id": 56649413, "link": "https://stackoverflow.com/questions/56649413/whats-a-good-approach-to-clean-up-dry-this-controller/56650799#56650799", "title": "What&#39;s a good approach to clean up (DRY) this controller?", "body": "<p>I am not sure what <code>StoryStateService</code> is doing, but if it is dealing with updating a number of models, then you can also make a module or class and put it in the <code>lib</code> directory.</p>\n\n<p>The other option is (this may be more preferable for <code>Story.find()</code>) is to use <code>before_action</code> callback. (<a href=\"https://apidock.com/rails/v4.0.2/AbstractController/Callbacks/ClassMethods/before_action\" rel=\"nofollow noreferrer\">https://apidock.com/rails/v4.0.2/AbstractController/Callbacks/ClassMethods/before_action</a>)</p>\n\n<p>e.g.</p>\n\n<p>As you are using <code>Story.find()</code> in <code>update</code> and <code>update_story_status_event</code> you can do the following:</p>\n\n<p><code>before_action :find_story, :only =&gt; [:update, :update_story_status_event]</code></p>\n\n<pre><code>   def find_story\n     @story = Story.find(params[:id])\n   rescue ActiveRecord::RecordNotFound\n     # handle error here\n   end  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "edited": false, "score": 0, "creation_date": 1560885957, "post_id": 56655753, "comment_id": 99881517, "body": "BTW, you&#39;ll need to add an explicit transaction in update and create to make sure all changes to DB happen or nothing happens. <code>ApplicationRecord.transaction do ... end</code>"}, {"owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "edited": false, "score": 0, "creation_date": 1560893959, "post_id": 56655753, "comment_id": 99884664, "body": "Thanks a lot Roger, added your suggestion. Valeu cara!"}], "tags": [], "owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "is_accepted": true, "score": 0, "last_activity_date": 1560885805, "creation_date": 1560885805, "answer_id": 56655753, "question_id": 56649413, "link": "https://stackoverflow.com/questions/56649413/whats-a-good-approach-to-clean-up-dry-this-controller/56655753#56655753", "title": "What&#39;s a good approach to clean up (DRY) this controller?", "body": "<p>I would just extract the advance of the story, anything more than that would be overkill to me, given the simplicity of everything else.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def create\n  @story = Story.new(story_params)\n  @story.creator = current_user\n\n  if @story.save\n    advance_story @story\n\n    redirect_to stories_path\n  else\n    render 'stories/new'\n  end\nend\n\ndef update\n  @story = Story.find(params[:id])\n\n  if @story.update(story_params)\n    advance_story @story\n\n    redirect_to stories_path\n  else\n    render 'edit'\n  end\nend\n\ndef update_story_status_event\n  story = Story.find(params['story_id'])\n  sub_action = params['sub_action']\n\n  advance_story story, sub_action\n\n  redirect_to stories_path\nend\n\nprivate \n\ndef advance_story(story, sub_action = nil)\n  next_state = StoryStateService.new(story, current_user, sub_action).call\n\n  if next_state\n    story.update_column(:status_id, next_state)\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 3813229, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3d1734bfe19a7636567a4958ec87ddf2?s=128&d=identicon&r=PG&f=1", "display_name": "queroga_vqz", "link": "https://stackoverflow.com/users/3813229/queroga-vqz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 56655753, "answer_count": 2, "score": 1, "last_activity_date": 1560885805, "creation_date": 1560861625, "question_id": 56649413, "link": "https://stackoverflow.com/questions/56649413/whats-a-good-approach-to-clean-up-dry-this-controller", "title": "What&#39;s a good approach to clean up (DRY) this controller?", "body": "<p>I have an action being performed on every create, update and update_status methods on my controller, But I feel that I am repeating myself, and would really appreciate some help on a better approach to write this.</p>\n\n<p>I've abstracted the update logic to a service, but the parameters are different, on every method of my controller.</p>\n\n<pre><code>def create\n    @story = Story.new(story_params)\n    @story.creator = current_user\n\n    if @story.save\n\n      next_state = StoryStateService.new(@story, current_user, nil).call\n\n      if next_state \n        @story.update_column(:status_id, next_state) \n      end \n\n      redirect_to stories_path\n    else\n      render 'stories/new'\n    end\n  end\n\n  def update\n    @story = Story.find(params[:id])   \n\n    if @story.update(story_params)\n\n      next_state = StoryStateService.new(@story, current_user, nil).call\n\n      if next_state \n        @story.update_column(:status_id, next_state) \n      end  \n\n      redirect_to stories_path\n    else\n      render 'edit'\n    end\n  end\n\n  def update_story_status_event\n    story = Story.find(params['story_id'])\n    sub_action = params['sub_action']\n\n    next_state = StoryStateService.new(story, current_user, sub_action).call\n\n    if next_state \n      story.update_column(:status_id, next_state) \n    end\n\n    redirect_to stories_path\n  end\n</code></pre>\n\n<p>As you can see, I have </p>\n\n<pre><code>   next_state = StoryStateService.new(story, current_user, sub_action).call\n\n    if next_state \n      story.update_column(:status_id, next_state) \n    end\n</code></pre>\n\n<p>being repeated on three methods, but on regular create and update, I dont need to send a sub_action param (string).</p>\n"}, {"tags": ["ruby", "deprecation-warning"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560861824, "post_id": 56649240, "comment_id": 99868572, "body": "based on the comment to the answer below, I have to ask then, why do you need this?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560862125, "post_id": 56649240, "comment_id": 99868765, "body": "See the link in my posting, which explains the background of this problem."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560862639, "post_id": 56649240, "comment_id": 99869093, "body": "what do you mean by &quot;to the bit bucket&quot; ? Is this flooding logs or something?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560865126, "post_id": 56649240, "comment_id": 99870684, "body": "<i>to the bit bucket</i>  is another way to say <code>2&gt;&#47;dev&#47;null</code>."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1560869710, "post_id": 56649240, "comment_id": 99873696, "body": "Why don&#39;t you just fix the code that uses the deprecated class or method? You would need to do that anyway at some point in time if you want to be able to run up-to-date versions of Ruby."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1560926031, "post_id": 56649240, "comment_id": 99891609, "body": "@spickermann : This also is the topic of the question I linked to. I&#39;m looking for a solution which is at least of similar simplicity than the current one. Also note that I have written above <i>until I find time to update the code</i>. And I still hope the Ruby developers will rethink their descision to have this language element deprecated."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 3, "creation_date": 1560861446, "post_id": 56649344, "comment_id": 99868328, "body": "Unfortunately it filters all the warnings (not only deprecated warnings...)"}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 2, "last_activity_date": 1560861395, "creation_date": 1560861395, "answer_id": 56649344, "question_id": 56649240, "link": "https://stackoverflow.com/questions/56649240/how-to-suppress-deprecation-warnings/56649344#56649344", "title": "How to suppress deprecation warnings?", "body": "<p>I think it's :</p>\n\n<pre><code>ruby -W0 -e 'code'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 5, "last_activity_date": 1560869878, "creation_date": 1560869878, "answer_id": 56651966, "question_id": 56649240, "link": "https://stackoverflow.com/questions/56649240/how-to-suppress-deprecation-warnings/56651966#56651966", "title": "How to suppress deprecation warnings?", "body": "<p>The warning is generated by the parser before the code is evaluated. That includes your <code>Warning.ignore</code> code, so the config isn't ready when the warning occurs.</p>\n\n<p>You can move that code into a separate file:</p>\n\n<pre><code># warn.rb\nrequire 'warning'\nWarning.ignore(/deprecated/)\n</code></pre>\n\n<p>and load it via <code>-r</code>:</p>\n\n<pre><code>$ ruby -r./warn.rb -e '0 if /a/.../b/'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1593532931, "post_id": 62661506, "comment_id": 110812333, "body": "Thank you for pointing this out! I was not aware of it, but now that you are telling it, I found <a href=\"https://blog.saeloun.com/2020/01/06/ruby-2-7-revert-flip-flop-operator-deprecation.html\" rel=\"nofollow noreferrer\">this</a> article on the subject."}], "tags": [], "owner": {"reputation": 72617, "user_id": 8279, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d4758ccc3cc586f01e740733f3fd8b7e?s=128&d=identicon&r=PG", "display_name": "Marc-Andr&#233; Lafortune", "link": "https://stackoverflow.com/users/8279/marc-andr%c3%a9-lafortune"}, "is_accepted": false, "score": 2, "last_activity_date": 1593532760, "creation_date": 1593532760, "answer_id": 62661506, "question_id": 56649240, "link": "https://stackoverflow.com/questions/56649240/how-to-suppress-deprecation-warnings/62661506#62661506", "title": "How to suppress deprecation warnings?", "body": "<p>The flip flop is no longer deprecated.</p>\n<p>Answer to the actual question: <code>ruby -W:no-deprecated</code></p>\n"}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1641, "favorite_count": 0, "accepted_answer_id": 56651966, "answer_count": 3, "score": 1, "last_activity_date": 1593532760, "creation_date": 1560861095, "question_id": 56649240, "link": "https://stackoverflow.com/questions/56649240/how-to-suppress-deprecation-warnings", "title": "How to suppress deprecation warnings?", "body": "<p>(This is related to <a href=\"https://stackoverflow.com/questions/56648847/workaround-flip-flop-deprecated-warning-in-ruby\">this</a> question).</p>\n\n<p>How can I suppress deprecation warnings in Ruby, until I find time to update the code? Example: The following command will generated a <em>flip-flop is deprecated</em> warning (the command itself is nonsense; I just wanted to provide a minimal, syntactically correct, example):</p>\n\n<pre><code> ruby -v -e '0 if /a/.../b/'\n</code></pre>\n\n<p>I already tried</p>\n\n<pre><code>ruby -e '$VERBOSE=nil;0 if /a/.../b/'\n</code></pre>\n\n<p>and, after installing the <em>warning</em> gem, </p>\n\n<pre><code> ruby -e 'require \"warning\";; Warning.ignore(/deprecated/) 0 if /a/.../b/'\n</code></pre>\n\n<p>but the warning is still printed to stderr. I don't want to redirect the whole stderr to the bit bucket, because I don't want to loose important messages.</p>\n"}, {"tags": ["ruby", "timeout", "faraday"], "answers": [{"comments": [{"owner": {"reputation": 5589, "user_id": 406642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QMSzb.jpg?s=128&g=1", "display_name": "Lev Lukomsky", "link": "https://stackoverflow.com/users/406642/lev-lukomsky"}, "edited": false, "score": 0, "creation_date": 1616512631, "post_id": 56649305, "comment_id": 118022208, "body": "It&#39;s allso possible to set timeout through initialize options: <code>Faraday::Connection.new(&#39;https:&#47;&#47;httpstat.us&#39;, request: { timeout: 1.second }).get(&#39;&#47;200?sleep=2000&#39;)</code>"}], "tags": [], "owner": {"reputation": 514, "user_id": 3170199, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000504183307/picture?type=large", "display_name": "Ayaz Ahmad Tarar", "link": "https://stackoverflow.com/users/3170199/ayaz-ahmad-tarar"}, "is_accepted": false, "score": 2, "last_activity_date": 1560861272, "creation_date": 1560861272, "answer_id": 56649305, "question_id": 56649234, "link": "https://stackoverflow.com/questions/56649234/how-i-can-generate-faraday-timeout-error-manually-in-ruby-on-rails/56649305#56649305", "title": "How I can generate Faraday Timeout Error Manually in Ruby On Rails", "body": "<p>From the <a href=\"https://github.com/lostisland/faraday/issues/812#issuecomment-414258614\" rel=\"nofollow noreferrer\">Ref</a> I have found the solution that was exact thing I was looking for.</p>\n\n<pre><code>begin\n  conn = Faraday::Connection.new('https://httpstat.us')\n  conn.options.timeout = 1\n  conn.options.open_timeout = 1\n  conn.options\n  # =&gt; #&lt;Faraday::RequestOptions timeout=1, open_timeout=1&gt;\n  conn.get('/200?sleep=2000')\n  # =&gt; Faraday::TimeoutError (Net::ReadTimeout)\n\nrescue Exception =&gt; e\n  #you can catch exception here\n  debugger\nend \n</code></pre>\n"}], "owner": {"reputation": 514, "user_id": 3170199, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000504183307/picture?type=large", "display_name": "Ayaz Ahmad Tarar", "link": "https://stackoverflow.com/users/3170199/ayaz-ahmad-tarar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560861272, "creation_date": 1560861072, "question_id": 56649234, "link": "https://stackoverflow.com/questions/56649234/how-i-can-generate-faraday-timeout-error-manually-in-ruby-on-rails", "title": "How I can generate Faraday Timeout Error Manually in Ruby On Rails", "body": "<p>I have a ruby on rails application which hit salesforce api and log the error. There are some scenarios where system is generate ReadNet Timeout error. I just wanted to generate the error manually so I can handle different logics in my code</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1560861013, "post_id": 56649047, "comment_id": 99868051, "body": "Obviously <code>record_candidate</code> has more keys than <code>line</code> has values, but it&#39;s hard to suggest anything without more context."}, {"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1560861307, "post_id": 56649047, "comment_id": 99868247, "body": "@Vasfed i update"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1560861601, "post_id": 56649047, "comment_id": 99868439, "body": "Please describe original problem you&#39;re solving (along with example input and desired output data), from above I can tell that it&#39;s some csv parsing - and ruby already has csv parser in stdlib"}, {"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1560861705, "post_id": 56649047, "comment_id": 99868499, "body": "@Vasfed the problem is that I cannot delete the value &quot;\\ r \\ n&quot;, it gives an error with the words: undefined method `delete &#39;for nil: NilClass"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1560862103, "post_id": 56649047, "comment_id": 99868748, "body": "Looks like XY Problem - see <a href=\"https://meta.stackexchange.com/a/66378\">meta.stackexchange.com/a/66378</a>"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1560865419, "post_id": 56649047, "comment_id": 99870870, "body": "To remove line endings, there&#39;s <a href=\"http://ruby-doc.org/core-2.6.3/String.html#method-i-chomp\" rel=\"nofollow noreferrer\"><code>chomp</code></a> and to parse CSVs, there <a href=\"http://ruby-doc.org/stdlib-2.6.3/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\"><code>CSV</code></a>. Don&#39;t reinvent the wheel ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1561006698, "post_id": 56649548, "comment_id": 99924585, "body": "yes, i change: <code>ruby record_candidate[keys] = values[index].delete(&quot;\\r\\n&quot;) if values[index].present? </code>"}], "tags": [], "owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "is_accepted": true, "score": 3, "last_activity_date": 1560862100, "creation_date": 1560862100, "answer_id": 56649548, "question_id": 56649047, "link": "https://stackoverflow.com/questions/56649047/how-delete-r-n-in-ruby/56649548#56649548", "title": "How delete \\r\\n in Ruby?", "body": "<p>This is because of some hash keys have <code>nil</code> values e.g. (\"file_path\" => <code>nil</code>)</p>\n\n<p>You need to bypass the <code>nil</code> values</p>\n\n<p>Your code will be like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>record_candidate.keys.each do |keys|\n  index += 1\n  if !values[index].nil?\n     record_candidate[keys] = values[index].delete(\"\\r\\n\")\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1561006661, "post_id": 56649739, "comment_id": 99924576, "body": "Thank u! I have a large file and it hangs. Therefore, I do line by line"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 0, "last_activity_date": 1560862717, "creation_date": 1560862717, "answer_id": 56649739, "question_id": 56649047, "link": "https://stackoverflow.com/questions/56649047/how-delete-r-n-in-ruby/56649739#56649739", "title": "How delete \\r\\n in Ruby?", "body": "<p>Your code looks like an attempt to parse CSV with a header. Ruby already has that in stdlib:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'csv'\n\nfile_contents = File.read('/home/dayanov-sa/PGadmin/finish.csv')\ndata = CSV.parse(file_contents, headers: true, col_sep: ';')\nsplitted_records = data.map(&amp;:to_h)\n</code></pre>\n\n<p>see <a href=\"https://ruby-doc.org/stdlib-2.6.1/libdoc/csv/rdoc/CSV.html\" rel=\"nofollow noreferrer\">ruby documentation on CSV</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 56649548, "answer_count": 2, "score": -3, "last_activity_date": 1560862717, "creation_date": 1560860453, "last_edit_date": 1560861976, "question_id": 56649047, "link": "https://stackoverflow.com/questions/56649047/how-delete-r-n-in-ruby", "title": "How delete \\r\\n in Ruby?", "body": "<p>error: undefined method `delete' for nil:NilClass</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>                                \"updated_at\" =&gt; \"\",\n                                 \"fias_ao_guid\" =&gt; \"\\r\\n\",\n                                    \"file_path\" =&gt; nil\n</code></pre>\n\n<p>how delete \"\\r\\n\"?</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>             splitted_records = []\n      id = 3141634\n      string = 0\n      row = 0\n      h = {}\n      record_candidate = {}\n      open('/home/dayanov-sa/PGadmin/finish.csv') do |csv|\n         csv.each_line do |line|\n            index = 0\n            row += 1\n               line.split(\";\").each do |key_filed|\n                record_candidate[\"#{key_filed.delete(\"\\r\\n\")}\"] = nil\n               end if row.eql?(1)\n            next if row.eql?(1)\n            copy_object = Marshal.load(Marshal.dump(line))\n            values = line.split(\";\")\n            record_candidate.keys.each do |keys|\n               index += 1\n               record_candidate[keys] = values[index].delete(\"\\r\\n\")\n               end\n            id = id + 1\n            puts string\n            splitted_records &lt;&lt; record_candidate\n</code></pre>\n\n<p>I'm trying to remove from the hash \\ r \\ n</p>\n"}, {"tags": ["ruby", "shell"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1560861182, "post_id": 56648847, "comment_id": 99868174, "body": "The removal is still open / being discussed: <a href=\"https://bugs.ruby-lang.org/issues/5400\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/5400</a>. As a user of the flip flop operator, you might want to chime in."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1560869100, "post_id": 56648847, "comment_id": 99873306, "body": "As far as I know, Rubinius doesn&#39;t even implement flip-flop, and so far, nobody seems to have noticed. Also, the Ruby Language Specification does not specify the flip-flop operator, so any code that uses it, is outside the spec anyhow."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560876047, "post_id": 56648847, "comment_id": 99877138, "body": "@J&#246;rgWMittag It&#39;d be really nice to have a repeatable range operator which would act as a flip-flop at length 2."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560925733, "post_id": 56648847, "comment_id": 99891482, "body": "@J&#246;rgWMittag : Not quite correct. See <a href=\"https://ruby-doc.org/core-2.4.0/doc/syntax/control_expressions_rdoc.html\" rel=\"nofollow noreferrer\">the docs for 2.4</a> and scroll down to the chapter headed &quot;Flip-Flop&quot;. You even find it in the <a href=\"https://ruby-doc.org/core-2.6.3/doc/syntax/control_expressions_rdoc.html\" rel=\"nofollow noreferrer\">2.6 docs</a>, interestingly without any mentioning that this is a deprecated feature."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560928044, "post_id": 56648847, "comment_id": 99892590, "body": "@user1934428: Those links are to the documentation of YARV, not the Ruby Specification. In the Ruby Community, there are a couple of things that are considered &quot;the Ruby Specification&quot;: the <a href=\"https://iso.org/standard/59579.html\" rel=\"nofollow noreferrer\"><i>ISO Ruby Specification</i></a> (doesn&#39;t mention flip-flop at all), the book <a href=\"http://shop.oreilly.com/product/9780596516178.do\" rel=\"nofollow noreferrer\"><i>The Ruby Programming Language</i></a> written by David Flanagan and matz himself (doesn&#39;t mention flip-flop at all), the book <a href=\"https://pragprog.com/book/ruby4/programming-ruby-1-9-2-0\" rel=\"nofollow noreferrer\"><i>Programming Ruby</i></a> written by Dave Thomas and Andy Hunt (doesn&#39;t \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560928049, "post_id": 56648847, "comment_id": 99892593, "body": "\u2026 mention flip-flop at all), the <a href=\"https://github.com/ruby/spec/\" rel=\"nofollow noreferrer\">RubySpec</a> suite (<a href=\"https://github.com/ruby/spec/blob/master/language/if_spec.rb#L233-L324\" rel=\"nofollow noreferrer\">mentions flip-flop</a> but explicitly <a href=\"https://github.com/ruby/spec/blob/master/language/if_spec.rb#L312-L324\" rel=\"nofollow noreferrer\">marks it deprecated</a>), and &quot;the code that is accepted by all Ruby implementations&quot; (several implementations don&#39;t implement flip-flop). Chris Seaton (the lead developer of TruffleRuby) made <a href=\"https://chrisseaton.com/truffleruby/flip-flops/\" rel=\"nofollow noreferrer\">an analysis</a> of flip-flops, by downloading the entire archive of rubygems.org. The result: out \u2026"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560928058, "post_id": 56648847, "comment_id": 99892598, "body": "\u2026 of every single version of every single RubyGem in existence, flip-flop is used in a total of 8 gems a total of 10 times by a total of 5 developers. The full archive contains every version of every gem ever released on rubygems.org, a total of 1.6 billion lines of code, with 69 instances of flip-flop or around 1 in 23 million lines of code. The code to implement flip-flop in TruffleRuby is significantly longer than <i>all code that uses flip-flop combined</i>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560928328, "post_id": 56648847, "comment_id": 99892744, "body": "Note also that Chris mentions that this language feature is different from some others such as <code>$SAFE</code> levels, continuations, <code>ObjectSpace</code>, etc. in that those ones have <i>deep</i> impact on the design of the VM and the kinds of optimizations that can be performed, whereas flip-flop is semantically trivial. So, there are <i>fundamental</i> reasons not to support one of those semantically invasive features but really no fundamental reasons not to support flip-flop (which is why TruffleRuby chose to implement it, despite the fact it&#39;s so rarely used)."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560928683, "post_id": 56648847, "comment_id": 99892912, "body": "@J&#246;rgWMittag : I have seen the discussion bugs.ruby-lang.org, mentioned by Stefan. I can understand that the Ruby developers want to remove a language feature which is troublesome to understand. As a mere user, I just can express that I find it useful. But we don&#39;t discuss here, whether or not the deprecation is OK. I just wanted to object your position that it is not described in the language spec."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1561016779, "post_id": 56648847, "comment_id": 99928438, "body": "@user1934428 <i>&quot;the Ruby developers want to remove a language feature  [...]&quot;</i> \u2013 note that the request to remove it came from a user. nobu (Ruby core dev) even <a href=\"https://bugs.ruby-lang.org/issues/5400#note-21\" rel=\"nofollow noreferrer\">said</a> <i>&quot;I <b>STRONGLY</b> object removal of flip-flop, in &quot;-e&quot; option at least.&quot;</i>."}], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1560859839, "creation_date": 1560859839, "question_id": 56648847, "link": "https://stackoverflow.com/questions/56648847/workaround-flip-flop-deprecated-warning-in-ruby", "title": "Workaround &quot;flip-flop deprecated&quot; warning in Ruby", "body": "<p>I invoke Ruby from my shell script like this:</p>\n\n<pre><code>ruby -n -e \"print if %r($fromre)...%r($tore)\" \"$@\"\n</code></pre>\n\n<p>Since Ruby 2.6, I get the warning</p>\n\n<p><em>warning: flip-flop is deprecated</em></p>\n\n<p>So it seems that i have to be prepared that the wise high priests of Ruby have decided that this (IMO useful) construct will be completely gone one day.</p>\n\n<p>What would be an easy work-around? Of course I can replace</p>\n\n<pre><code>print if %r($fromre)...%r($tore)\n</code></pre>\n\n<p>by</p>\n\n<pre><code>inside ||= %r($fromre)\nif inside\n  print\n  inside = false if %r($tore)\nend\n</code></pre>\n\n<p>but I wonder whether there is a more concise way to write this.</p>\n"}, {"tags": ["ruby", "datetime", "object", "memory", "datamapper"], "comments": [{"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1560857792, "post_id": 56647940, "comment_id": 99866062, "body": "Sounds like a bug that you should report to datamapper author."}, {"owner": {"reputation": 5449, "user_id": 681520, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/701baebf68d1d7faa9f9def6a24fe356?s=128&d=identicon&r=PG", "display_name": "Kimmo Lehto", "link": "https://stackoverflow.com/users/681520/kimmo-lehto"}, "edited": false, "score": 0, "creation_date": 1560857901, "post_id": 56647940, "comment_id": 99866117, "body": "DataMapper has been replaced by ROM a long time ago."}], "owner": {"reputation": 392, "user_id": 1214049, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bd52f274580223e659f6680cf887b969?s=128&d=identicon&r=PG", "display_name": "Dianna", "link": "https://stackoverflow.com/users/1214049/dianna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560856741, "creation_date": 1560856741, "last_edit_date": 1592644375, "question_id": 56647940, "link": "https://stackoverflow.com/questions/56647940/after-destroying-datamapper-object-in-ruby-v2-6-2-the-time-field-is-returned-in", "title": "After destroying DataMapper object in ruby v2.6.2, the Time field is returned in UTC", "body": "<p>I have the following DataMapper class:</p>\n<pre><code>class Test\n   include DataMapper::Resource\n   property :created_at, Time\nend\n</code></pre>\n<p>In ruby 2.2 if I do the following:</p>\n<pre><code>tst = Test.first\nputs tst.created_at.strftime('%Y-%m-%dT%H:%M:%S')\ntst.destroy\nputs tst.created_at.strftime('%Y-%m-%dT%H:%M:%S')\n</code></pre>\n<p>I get:</p>\n<blockquote>\n<p>2019-06-17T15:11:46 &lt;--- GMT+3</p>\n<p>2019-06-17T15:11:46 &lt;--- GMT+3</p>\n</blockquote>\n<p>In ruby 2.6 I get:</p>\n<blockquote>\n<p>2019-06-17T15:11:46 &lt;--- GMT+3</p>\n<p>2019-06-17T12:11:46 &lt;--- UTC</p>\n</blockquote>\n<p>So, after destroying the object, the created_at field is returning the date in UTC. Is this the right behavior?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sidekiq", "sidekiq-monitor"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560856648, "post_id": 56647416, "comment_id": 99865415, "body": "When you say &quot;killed abruptly&quot; how are those jobs being killed? Sidekiq jobs can be set to retry n number of times in case they fail for some reason i.e. 3rd part API is down, internet connection down etc.  If you expect this to happen you should set a retry number of 3 for example.  What do you want to do if the job fails even 3 retries for example?"}, {"owner": {"reputation": 165, "user_id": 5801262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1bce79f21163c66ccd433a9aada5e3?s=128&d=identicon&r=PG&f=1", "display_name": "krishna sai", "link": "https://stackoverflow.com/users/5801262/krishna-sai"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560858200, "post_id": 56647416, "comment_id": 99866281, "body": "through console and jib, they are being deleted, these might be scheduled jobs, so they might not have even been started. So, they wont be moved to failed queue. I think I am looking to send a notification of sort whenever a developer deletes a scheduled job. Does this make sense?\\"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560858629, "post_id": 56647416, "comment_id": 99866558, "body": "how and why are devs deleting jobs? this seems like a bad workflow"}, {"owner": {"reputation": 165, "user_id": 5801262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1bce79f21163c66ccd433a9aada5e3?s=128&d=identicon&r=PG&f=1", "display_name": "krishna sai", "link": "https://stackoverflow.com/users/5801262/krishna-sai"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560859508, "post_id": 56647416, "comment_id": 99867080, "body": "I am not really sure on why, but it happens rarely. Is there a way I can add something so that a notification gets sent out whenever a sidekiq job gets cancelled."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560861159, "post_id": 56647416, "comment_id": 99868157, "body": "see the answer I posted below"}], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1560861139, "creation_date": 1560861139, "answer_id": 56649258, "question_id": 56647416, "link": "https://stackoverflow.com/questions/56647416/how-to-track-the-sidekiq-jobs-that-have-been-killed/56649258#56649258", "title": "How to track the sidekiq jobs that have been killed?", "body": "<p>Sidekiq jobs which die because of some exception should be retried by using the retry setting</p>\n\n<pre><code>class SomeWorker\n  include Sidekiq::Worker\n\n  sidekiq_options retry: 3 # retry 3 times before dying \n\n  def perform\n    # do stuff\n  end\nend\n</code></pre>\n\n<p>Jobs which die after all retries end up in the dead queue</p>\n\n<p>There is no easy way to monitor jobs that are deleted from the Sidekiq queues because of devs removing them in the console or deleting them. Once they are deleted there's nothing to hook into anymore as they will be removed from the key/value store i.e. Redis. </p>\n\n<p>If you want to monitor specific job statuses you might want to have a look at the <a href=\"https://github.com/utgarda/sidekiq-status\" rel=\"nofollow noreferrer\">sidekiq-status</a> gem which can help with this.  </p>\n"}], "owner": {"reputation": 165, "user_id": 5801262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1bce79f21163c66ccd433a9aada5e3?s=128&d=identicon&r=PG&f=1", "display_name": "krishna sai", "link": "https://stackoverflow.com/users/5801262/krishna-sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 56649258, "answer_count": 1, "score": 3, "last_activity_date": 1560861139, "creation_date": 1560854917, "question_id": 56647416, "link": "https://stackoverflow.com/questions/56647416/how-to-track-the-sidekiq-jobs-that-have-been-killed", "title": "How to track the sidekiq jobs that have been killed?", "body": "<p>I am looking for a way to track sidekiq jobs that have been killed abruptly. Is there a on_delete kind of operation in sidekiq(I couldnt find any in documentation) I can implement, so that some process is carried out whenever a job gets deleted abruptly.</p>\n\n<p>I looked into sidekiq ruby gem documentation, but couldnt find a solution for this.</p>\n\n<p>I am using sidekiq v5.0.4</p>\n"}, {"tags": ["ruby", "symbols"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560859530, "post_id": 56647271, "comment_id": 99867092, "body": "<i>&quot;any logic to memorize when to use which&quot;</i> \u2013 understanding the syntax is crucial. Ruby is a great language for modeling sleek DSLs. But those just <i>look</i> natural, you&#39;re still writing Ruby code after all. Try to think in terms of receivers, method names and arguments."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560869204, "post_id": 56647271, "comment_id": 99873374, "body": "Can you clarify your question a little bit? Those two snippets of code do completely different things, and I don&#39;t really see any place where it would be possible to use both of them, so I can&#39;t really think of a situation where you could confuse the two."}, {"owner": {"reputation": 169, "user_id": 4058741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HEGgn.jpg?s=128&g=1", "display_name": "Harshwardhan Rathore", "link": "https://stackoverflow.com/users/4058741/harshwardhan-rathore"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560871740, "post_id": 56647271, "comment_id": 99874967, "body": "@J&#246;rgWMittag You are right. These two are different things. One is a method with params and other one is hash with key value pair. But looking them both looks alike and creates confusion which is now cleared below. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560875560, "post_id": 56647391, "comment_id": 99876903, "body": "For extra confusion: <code>{ &quot;something&quot;: &quot;hello&quot; }</code> and <code>{ :&quot;something&quot; =&gt; &quot;hello&quot; }</code> are also equivalent."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1560875881, "post_id": 56647391, "comment_id": 99877050, "body": "@tadman For extra extra confusion: <code>{ :$x =&gt; 6 }</code> and <code>{ $x: 6 }</code> are not equivalent nor are <code>{ :@x =&gt; 11 }</code> and <code>{ @x: 11 }</code>."}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": false, "score": 10, "last_activity_date": 1560854807, "creation_date": 1560854807, "answer_id": 56647391, "question_id": 56647271, "link": "https://stackoverflow.com/questions/56647271/key-value-vs-key-value-in-ruby/56647391#56647391", "title": "key: value vs key :value in ruby?", "body": "<p>This isn't about convention, it's about syntax.</p>\n\n<p><code>:something</code> is a <a href=\"https://ruby-doc.org/core-2.6.3/Symbol.html\" rel=\"noreferrer\"><code>Symbol</code></a>.</p>\n\n<p><code>belongs_to :something</code> is a method that is being sent to an implicit <code>self</code> while also omitting the parentheses. We can write it as follows to make that obvious:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>self.belongs_to(:something)\n</code></pre>\n\n<p><code>:something</code> is thus just an argument being passed to the method <code>belongs_to</code>.</p>\n\n<p>In a <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html\" rel=\"noreferrer\"><code>Hash</code></a>, we can use a <code>Symbol</code> as the key:</p>\n\n<pre><code>hash = { :something =&gt; \"hello\" }\n</code></pre>\n\n<p>Ruby introduced an alternative syntax in version 1.9 that can be used when the key is a symbol:</p>\n\n<pre><code>hash = { something: \"hello\" }\n</code></pre>\n\n<p>Both versions are equivalent.</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1560875789, "creation_date": 1560875789, "answer_id": 56653565, "question_id": 56647271, "link": "https://stackoverflow.com/questions/56647271/key-value-vs-key-value-in-ruby/56653565#56653565", "title": "key: value vs key :value in ruby?", "body": "<p>The difference here is between <em>method call</em> and <em>hash key</em>. They look very similar and can easily be confused if you're not sure what you're looking for.</p>\n\n<p>In your first example:</p>\n\n<pre><code>a :b\n</code></pre>\n\n<p>In long-form this is:</p>\n\n<pre><code>a(:b)\n</code></pre>\n\n<p>Where now that's clearly an argument (<code>:b</code>) to a method (<code>a</code>).</p>\n\n<p>In the other form it's different:</p>\n\n<pre><code>a: b\n</code></pre>\n\n<p>Where if that's part of a method call like this:</p>\n\n<pre><code>f a: b\n</code></pre>\n\n<p>Then that actually means:</p>\n\n<pre><code>f(a: b)\n</code></pre>\n\n<p>Which in full form is:</p>\n\n<pre><code>f({ a: b })\n</code></pre>\n\n<p>Where that's a hash definition following the <code>key: value</code> style. Here <code>:a</code> is the key (Symbol) and <code>b</code> is the value (variable or method call).</p>\n\n<p>You'll often see <code>a: :b</code> where you have symbol key and value.</p>\n\n<p>To differentiate between these two forms when reading code have a look at where the code appears to get a sense of context. When writing code, always frame your thinking in terms of <em>method calls</em> and <em>hash definitions</em> more clearly.</p>\n"}], "owner": {"reputation": 169, "user_id": 4058741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HEGgn.jpg?s=128&g=1", "display_name": "Harshwardhan Rathore", "link": "https://stackoverflow.com/users/4058741/harshwardhan-rathore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1560875789, "creation_date": 1560854393, "last_edit_date": 1560854700, "question_id": 56647271, "link": "https://stackoverflow.com/questions/56647271/key-value-vs-key-value-in-ruby", "title": "key: value vs key :value in ruby?", "body": "<p>In associations, we usually do <code>a :b</code> (<code>belongs_to :something</code>). When we create a hash with symbol keys we usually do <code>a: b</code>. Having said that my question is what is the difference between the two syntax. Also is there any logic to memorize when to use which convention?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activeadmin", "belongs-to"], "comments": [{"owner": {"reputation": 966, "user_id": 913824, "user_type": "registered", "profile_image": "https://graph.facebook.com/1633045538/picture?type=large", "display_name": "Marthyn Olthof", "link": "https://stackoverflow.com/users/913824/marthyn-olthof"}, "edited": false, "score": 0, "creation_date": 1560867379, "post_id": 56645698, "comment_id": 99872137, "body": "I would look into the sourcecode of the FocusGroupValuesController. Do you have access to that? If so, could you add it to the post?"}, {"owner": {"reputation": 86, "user_id": 7362270, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LiRx1XlChl4/AAAAAAAAAAI/AAAAAAAAMeU/zJyfKQ98pD0/photo.jpg?sz=128", "display_name": "Tom&#225;\u0161 Landovsk&#253;", "link": "https://stackoverflow.com/users/7362270/tom%c3%a1%c5%a1-landovsk%c3%bd"}, "edited": false, "score": 1, "creation_date": 1560927205, "post_id": 56645698, "comment_id": 99892159, "body": "Ahoj Jano :-). Are you building your app only using Active Admin or are you purposefully mixing Rails app (with defined routes, controllers and views) with Active Admin?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1328088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ac91bffb5738dd4bc123ad41fe42de?s=128&d=identicon&r=PG", "display_name": "johannesdwicahyo", "link": "https://stackoverflow.com/users/1328088/johannesdwicahyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1561225165, "creation_date": 1561225165, "answer_id": 56717715, "question_id": 56645698, "link": "https://stackoverflow.com/questions/56645698/activeadmin-belongs-to-for-foreign-key-association-column/56717715#56717715", "title": "ActiveAdmin belongs_to for &#39;foreign_key&#39; association column", "body": "<p>You don't need to add your own routes for active admin resources. Just delete your additional routes, and your configuration to accessing FG_value only for 'xyz' organization will work out of the box..</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11663349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KxK9AK4ElOc/AAAAAAAAAAI/AAAAAAAABMM/40Y0pHlPzpU/photo.jpg?sz=128", "display_name": "Jana Michnova", "link": "https://stackoverflow.com/users/11663349/jana-michnova"}, "is_accepted": false, "score": 0, "last_activity_date": 1561363094, "creation_date": 1561363094, "answer_id": 56732178, "question_id": 56645698, "link": "https://stackoverflow.com/questions/56645698/activeadmin-belongs-to-for-foreign-key-association-column/56732178#56732178", "title": "ActiveAdmin belongs_to for &#39;foreign_key&#39; association column", "body": "<p>Sorry, I updated my question,I didn't consider it important, but it was. I had two <code>belongs_to</code> in ActiveAdmin FocusGroupValue. And that was the main issue, because it took only the first one. I put them to the FocusGroupValuesController and then updated organization model with association \n<code>has_many :focus_group_values, foreign_key: :group_unit, inverse_of: :organization</code> and now I can get all FG values for organization 'xyz'.</p>\n"}], "owner": {"reputation": 1, "user_id": 11663349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KxK9AK4ElOc/AAAAAAAAAAI/AAAAAAAABMM/40Y0pHlPzpU/photo.jpg?sz=128", "display_name": "Jana Michnova", "link": "https://stackoverflow.com/users/11663349/jana-michnova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1385, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1561363094, "creation_date": 1560849425, "last_edit_date": 1561362589, "question_id": 56645698, "link": "https://stackoverflow.com/questions/56645698/activeadmin-belongs-to-for-foreign-key-association-column", "title": "ActiveAdmin belongs_to for &#39;foreign_key&#39; association column", "body": "<p>I had problem in AA with two resources Organization and FG_Value, FG_Value contains column group_unit which could be organization_id. So I would like to display fg_values of 'xyz' organization.\nI defined routes:</p>\n\n<pre><code>resources :organizations do \n  resources :focus_group_values\nend\n</code></pre>\n\n<p>and in organization there is action</p>\n\n<pre><code>item 'Focus Group Values', organization_focus_group_values_path(organization)\n</code></pre>\n\n<p>I used belongs_to, but still I got all fg values, not filtered for xyz and in the log there is:</p>\n\n<pre><code>Processing by FocusGroupValuesController#index as HTML\n  Parameters: {\"organization_id\"=&gt;\"xyz\"}\nSELECT  \"focus_group_values\".* FROM \"focus_group_values\"...\n</code></pre>\n\n<p>and the routes are:</p>\n\n<pre><code>organization_focus_group_values_path    GET /organizations/:organization_id/focus_group_values(.:format)    \nfocus_group_values#index\n</code></pre>\n\n<pre><code>ActiveAdmin.register Organization do\nend\n</code></pre>\n\n<pre><code>ActiveAdmin.register FocusGroupValue do\n   belongs_to :feedback\n   belongs_to :organization\nend\n</code></pre>\n\n<p>I tried use in organization</p>\n\n<pre><code>belongs_to :organization, param: :group_unit, optional: true\n</code></pre>\n\n<p>but without success. Could you help me? Thanks</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 0, "creation_date": 1560879977, "post_id": 56646396, "comment_id": 99878903, "body": "Oh anyways, you don&#39;t want to assign variable name b to binding, because later on you will replace it if you have to assign a variable b to your program. I have named it <b>binding</b>, which the programmer won&#39;t likely to assign!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "edited": false, "score": 1, "creation_date": 1560928278, "post_id": 56646396, "comment_id": 99892708, "body": "@S.Goswami did you see my last example with <code>empty_binding</code>? It gives you a binding without any local variables."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1560853819, "last_edit_date": 1560853819, "creation_date": 1560851640, "answer_id": 56646396, "question_id": 56645225, "link": "https://stackoverflow.com/questions/56645225/is-there-a-way-to-access-a-local-variable-defined-inside-a-block-outside-the-blo/56646396#56646396", "title": "Is there a way to access a local variable defined inside a block outside the block?", "body": "<p><code>binding</code> returns a new instance every time you call it. You have to send <code>eval</code> to the same binding in order to access local variables that you've created earlier:</p>\n\n<pre><code>def create(code, b = binding)\n  width = code.each_line.map(&amp;:length).max\n  code.each_line.map do |line|\n    '%-*s   #=&gt; %s' % [width, line.chomp, b.eval(line)]\n  end\nend\n\nputs create &lt;&lt;~'RUBY'\n  baz, qux = 5, 3\n  baz\n  qux\nRUBY\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>baz, qux = 5, 3    #=&gt; [5, 3]\nbaz                #=&gt; 5\nqux                #=&gt; 3\n</code></pre>\n\n<p>Note that in the above example, <code>binding</code> will make the method's local variables available to the block:</p>\n\n<pre><code>create 'local_variables'\n#=&gt; [\"local_variables   #=&gt; [:code, :b, :width]\"]\n</code></pre>\n\n<p>You might want to create a more restricted evaluation context, e.g. (replicating Ruby's main)</p>\n\n<pre><code>def empty_binding\n  Object.allocate.instance_eval do\n    class &lt;&lt; self\n      def to_s\n        'main'\n      end\n      alias inspect to_s\n    end\n    return binding\n  end\nend\n\ndef create(code, b = empty_binding)\n  # ...\nend\n</code></pre>\n"}], "owner": {"reputation": 1341, "user_id": 11089758, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQ5gw.jpg?s=128&g=1", "display_name": "S.Goswami", "link": "https://stackoverflow.com/users/11089758/s-goswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56646396, "answer_count": 1, "score": 1, "last_activity_date": 1560853819, "creation_date": 1560847929, "last_edit_date": 1560848708, "question_id": 56645225, "link": "https://stackoverflow.com/questions/56645225/is-there-a-way-to-access-a-local-variable-defined-inside-a-block-outside-the-blo", "title": "Is there a way to access a local variable defined inside a block outside the block?", "body": "<p>I have written a simple code that evaluates a piece of code and writes the output to a file. In that way it reduces some of my because I need lots and lots of files with return values inside them for every line!.</p>\n\n<p>Anyways, the code I am working with is:</p>\n\n<pre><code>#!/usr/bin/ruby -w\n\ndef create(file, code)\n    f = code.strip.each_line.map { |cd| cd.strip.then { |c| [c, \"# =&gt; #{binding.eval(c)}\"] } }\n    max_length = f.map { |x| x[0].length }.max + 4\n    f.map { |v| v[0].ljust(max_length) &lt;&lt; v[1] }.join(\"\\n\").tap { |data| File.write(file, data + \"\\n\") }\nend\n\nputs create(\n    File.join(__dir__, 'p.rb'),\n    &lt;&lt;~'EOF'\n        foo = 1\n        bar = 2\n        baz, qux = 5, 3\n    EOF\n)\n</code></pre>\n\n<p>In this case, the file p.rb is written. The content of p.rb is:</p>\n\n<pre><code>foo = 1            # =&gt; 1\nbar = 2            # =&gt; 2\nbaz, qux = 5, 3    # =&gt; [5, 3]\n</code></pre>\n\n<p>But the problem occurs when I want the value of a variable.\nFor example:</p>\n\n<pre><code>puts create(\n    File.join(__dir__, 'p.rb'),\n    &lt;&lt;~'EOF'\n        baz, qux = 5, 3\n        [baz, qux]\n    EOF\n)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>/tmp/aa.rb:4:in `block (2 levels) in create': undefined local variable or method `baz' for main:Object (NameError)\n    from /tmp/aa.rb:4:in `eval'\n    from /tmp/aa.rb:4:in `block (2 levels) in create'\n    from /tmp/aa.rb:4:in `then'\n    from /tmp/aa.rb:4:in `block in create'\n    from /tmp/aa.rb:4:in `each_line'\n    from /tmp/aa.rb:4:in `each'\n    from /tmp/aa.rb:4:in `map'\n    from /tmp/aa.rb:4:in `create'\n    from /tmp/aa.rb:9:in `&lt;main&gt;'\n</code></pre>\n\n<p>Previously I worked in some graphical games that also does this kind of thing after reading a configuration file, but there, I used to define the variables as either global variables (just append $ before variable declaration) or just use instance variables on top self object.</p>\n\n<p>But is there a way to get around the problem I am currently facing? Can I define the variables in binding or some hacks like this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-api"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1560845571, "post_id": 56644536, "comment_id": 99859315, "body": "Can you show what line of code and what file the error is coming from please?"}, {"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 1, "creation_date": 1560845889, "post_id": 56644536, "comment_id": 99859453, "body": "Just seen it in your stack trace, can you paste your whole users_controller file? The error is coming from line 46"}, {"owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1560875031, "post_id": 56644536, "comment_id": 99876674, "body": "@Mark I did update my question."}], "answers": [{"tags": [], "owner": {"reputation": 1725, "user_id": 4738391, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nCUGI.jpg?s=128&g=1", "display_name": "Zia Ul Rehman Mughal", "link": "https://stackoverflow.com/users/4738391/zia-ul-rehman-mughal"}, "is_accepted": false, "score": 1, "last_activity_date": 1560885821, "creation_date": 1560885821, "answer_id": 56655757, "question_id": 56644536, "link": "https://stackoverflow.com/questions/56644536/building-login-api-backend-functionality-with-rails/56655757#56655757", "title": "building login api backend functionality with rails", "body": "<p><strong>If you see the screenshot of console you attached</strong>, you will notice that params are: <strong><code>email, password, defaults</code> and <code>user</code></strong> if you look closely, you will see that this <code>user</code> has a hash, which only contains email and no password. <strong>This gives us a hint.</strong></p>\n\n<p>Now, in your user_params method:</p>\n\n<pre><code>def user_params\n  params.require(:user).permit(:email, :password)\nend\n</code></pre>\n\n<p>Here, <strong><code>params.require(:user)</code> will require a key named <code>user</code> to be present</strong>, which is present, otherwise error will be thrown. Next you have: <code>.permit(:email, :password)</code> which permits these two params in parent <code>user</code> key's hash value.</p>\n\n<p>Now, it seems like some issue in the JSON being sent, either you didn't posted complete json or something is transforming your json before sending, or before handling it to controller(which is highly unlikely if anyone does this kind of customization, but who knows).</p>\n\n<p>Solution: If i were you, i will double check my json, or infact i will send only this json: <code>{\"user\": {\"email\": \"bearatamer+testfour@gmail.com\", \"password\": \"amer1234\"}}</code> or if you don't want the nesting under <code>user</code> key, you must remove <code>require</code> from strong params on <code>user</code> key.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "is_accepted": false, "score": 0, "last_activity_date": 1560915925, "creation_date": 1560915925, "answer_id": 56659762, "question_id": 56644536, "link": "https://stackoverflow.com/questions/56644536/building-login-api-backend-functionality-with-rails/56659762#56659762", "title": "building login api backend functionality with rails", "body": "<p>the issue was with this line </p>\n\n<pre><code> if user &amp;&amp; user.authenticate(password)\n</code></pre>\n\n<p>once i change to this it worked </p>\n\n<pre><code> if user &amp;&amp; user.valid_password?(params[:password])\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 7974603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f4a562a0f406264652b195171ad0059?s=128&d=identicon&r=PG", "display_name": "Amer Bearat", "link": "https://stackoverflow.com/users/7974603/amer-bearat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560923518, "creation_date": 1560845368, "last_edit_date": 1560923518, "question_id": 56644536, "link": "https://stackoverflow.com/questions/56644536/building-login-api-backend-functionality-with-rails", "title": "building login api backend functionality with rails", "body": "<p>I have react app is making calls to ruby on rails. I'm building login page i got stuck on the password authenticate part. getting error </p>\n\n<pre><code> \"#&lt;ArgumentError: wrong number of arguments (given 0, expected 1)&gt;\"\n</code></pre>\n\n<p>the error is happening on this line </p>\n\n<pre><code>  if user &amp;&amp; user.authenticate(password)\n</code></pre>\n\n<p>here is from the comman line \n<a href=\"https://i.stack.imgur.com/KGpLV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KGpLV.png\" alt=\"enter image description here\"></a></p>\n\n<p>this is users_controller.rb</p>\n\n<pre><code>class Api::V1::UsersController &lt; ApplicationController\nbefore_action :authenticate_with_token!, only: [:logout]\n\ndef facebook\n enter code hereif params[:facebook_access_token]\n  graph = Koala::Facebook::API.new(params[:facebook_access_token])\n  user_data = graph.get_object(\"me?fields=name,email,id,picture\")\n\n  user = User.find_by(email: user_data['email'])\n  if user\n    user.generate_authentication_token\n    user.save\n    render json: user, status: :ok\n  else\n    user = User.new(\n                fullname: user_data['fullname'],\n                email: user_data['email'],\n                uid: user_data['id'],\n                provider: 'Facebook',\n                image: user_data['picture']['data']['url']\n            )\n    user.generate_authentication_token\n\n    if user.save\n      render json: user, status: :ok\n    else\n      render json: { error: user.errors, is_success: false}, status: 422\n    end\n  end\n  else\n  render json: { error: \"Invalid Facebook Token\", is_success: false}, status: :unprocessable_entity\n  end\nend\n\ndef logout\n user = User.find_by(access_token: params[:access_token])\n user.generate_authentication_token\n user.save\n render json: { is_success: true}, status: :ok\nend\n\ndef login\n email = user_params[:email]\n password = user_params[:password]\n user = User.find_by(email: email)\n if user &amp;&amp; user.authenticate(password)\n    session[:user_id] = user.id\n    render json: user, status: :ok\n else\n render json: { error: user.errors, is_success: false}, status: 422\n end\nend\n\ndef add_card\nuser = User.find(current_user.id)\nif user.stripe_id.blank?\n  customer = Stripe::Customer.create(\n    email: user.email\n  )\n  user.stripe_id = customer.id\n  user.save\nelse\n  customer = Stripe::Customer.retrieve(user.stripe_id)\nend\n\ncustomer.sources.create(source: params[:stripe_token])\nrender json: { is_success: true}, status: :ok\nrescue Stripe::CardError =&gt; e\nrender json: { error: e.message, is_success: false}, status: :not_found\nend\n\ndef user_params\n  params.require(:user).permit(:email, :password)\nend\n\nend\n</code></pre>\n\n<p>here is routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\nnamespace :api, defautls: {format: :json} do\nnamespace :v1 do\n  get '/logout' =&gt; 'users#logout'\n  get '/login' =&gt; 'users#login'\n  post '/login' =&gt; 'users#login'\n  post '/signup' =&gt; 'users#signup'\n  end\n end\nend\n</code></pre>\n\n<p>here is user.rb model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n has_secure_password\n before_create :generate_authentication_token\n devise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, \n :validatable,\n     :confirmable, :omniauthable\n validates :fullname, presence: true, length: {maximum: \n 50}\nend\ndef generate_authentication_token\n begin\n  self.access_token = Devise.friendly_token\n end while self.class.exists?(access_token: access_token)\nend\n</code></pre>\n\n<p>this is the api call im making\n<a href=\"https://i.stack.imgur.com/dFzty.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dFzty.png\" alt=\"enter image description here\"></a></p>\n\n<p>this is json that im sendng</p>\n\n<pre><code>{\"email\": \"bearatamer+testfour@gmail.com\", \"password\": \"amer1234\"}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "associations"], "answers": [{"tags": [], "owner": {"reputation": 6207, "user_id": 5117953, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/Ca0RW.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/5117953/vishal"}, "is_accepted": false, "score": 1, "last_activity_date": 1560839165, "creation_date": 1560839165, "answer_id": 56642859, "question_id": 56642783, "link": "https://stackoverflow.com/questions/56642783/how-to-pluck-a-column-value-in-has-one-association/56642859#56642859", "title": "How to pluck a column value in has one association?", "body": "<p>You can use query like below for getting vehicle first record with its qr code's value name</p>\n\n<pre><code>Vehicle\n      .left_outer_joins(:qr_code)\n      .select(\"vehicles.*, \n              (SELECT qr_codes.value from qr_codes WHERE vehicles.id = qr_codes.codeable_id) as value_name\")\n      .limit(1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1560839541, "creation_date": 1560839541, "answer_id": 56642952, "question_id": 56642783, "link": "https://stackoverflow.com/questions/56642783/how-to-pluck-a-column-value-in-has-one-association/56642952#56642952", "title": "How to pluck a column value in has one association?", "body": "<p>When you have <code>Vehicle</code> instance:</p>\n\n<pre><code>QrCode.\n  where(codeable: vehicle).\n  pluck(:value).\n  first\n</code></pre>\n\n<p>When you have <code>vehicle_id</code> only:</p>\n\n<pre><code>Vehicle.\n  left_joins(:qr_code).\n  where(id: vehicle_id).\n  pluck('qr_codes.value').\n  first\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 7789913, "user_type": "registered", "profile_image": "https://graph.facebook.com/1454793477904342/picture?type=large", "display_name": "Parakh Garg", "link": "https://stackoverflow.com/users/7789913/parakh-garg"}, "is_accepted": false, "score": 0, "last_activity_date": 1560841925, "creation_date": 1560841925, "answer_id": 56643576, "question_id": 56642783, "link": "https://stackoverflow.com/questions/56642783/how-to-pluck-a-column-value-in-has-one-association/56643576#56643576", "title": "How to pluck a column value in has one association?", "body": "<p>As per your expected query - </p>\n\n<p><code>QrCode.where(codeable: Vehicle.first).pluck(:value).first</code></p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 2282123, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c23a89f25f3e886418b300ef9459c5?s=128&d=identicon&r=PG", "display_name": "Abhishek Bhatta", "link": "https://stackoverflow.com/users/2282123/abhishek-bhatta"}, "edited": false, "score": 0, "creation_date": 1560931602, "post_id": 56644586, "comment_id": 99894400, "body": "select cannot be used to the instance records. It says  <b>NoMethodError: private method `select&#39; called for #&lt;QrCode:0x005606b871d3c8&gt;</b>"}], "tags": [], "owner": {"reputation": 802, "user_id": 8728218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376ec53188ea3ec0271198a862516657?s=128&d=identicon&r=PG&f=1", "display_name": "Dyaniyal Wilson", "link": "https://stackoverflow.com/users/8728218/dyaniyal-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1560946050, "last_edit_date": 1560946050, "creation_date": 1560845568, "answer_id": 56644586, "question_id": 56642783, "link": "https://stackoverflow.com/questions/56642783/how-to-pluck-a-column-value-in-has-one-association/56644586#56644586", "title": "How to pluck a column value in has one association?", "body": "<p>This will select only value column in the query.</p>\n\n<pre><code>Vehicle.joins(:qr_code).select(\"qr_codes.value\").pluck(:value)\n</code></pre>\n\n<p>For a specific vehicle:</p>\n\n<pre><code>Vehicle.where(id: 1).joins(:qr_code).select(\"qr_codes.value\").pluck(:value)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 2282123, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c23a89f25f3e886418b300ef9459c5?s=128&d=identicon&r=PG", "display_name": "Abhishek Bhatta", "link": "https://stackoverflow.com/users/2282123/abhishek-bhatta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1560946050, "creation_date": 1560838716, "last_edit_date": 1560843100, "question_id": 56642783, "link": "https://stackoverflow.com/questions/56642783/how-to-pluck-a-column-value-in-has-one-association", "title": "How to pluck a column value in has one association?", "body": "<p>I have a Vehicle model which has a <code>has_one</code> association with <code>QrCode</code>.\nI want to pluck a specific column of <code>qr_code</code> rather than selecting all the columns and mapping single value</p>\n\n<p>I have tried the following code.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>vehicle = Vehicle.first \ncode = vehicle.qr_code.pluck(:value)\n</code></pre>\n\n<p>But this is not a valid query</p>\n\n<p>Following code will have the desired value. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>code = vehicle.qr_code.value \n</code></pre>\n\n<p>But the query build by this code is</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  \"qr_codes\".* FROM \"qr_codes\" WHERE \"qr_codes\".\"codeable_id\" = $1 AND \"qr_codes\".\"codeable_type\" = $2 LIMIT 1  [[\"codeable_id\", 1], [\"codeable_type\", \"Vehicle\"]]\n</code></pre>\n\n<p>This is expensive as it selects all column values and there are few columns in qr_codes table that store huge data.</p>\n\n<p>Following is the code implementation </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Vehicle &lt; ActiveRecord::Base\n  has_one :qr_code, as: :codeable\nend\n\nclass QrCode &lt; ActiveRecord::Base\n  belongs_to :codeable, polymorphic: true\nend\n\n\n\n</code></pre>\n\n<p>not expected query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  \"qr_codes\".* FROM \"qr_codes\" WHERE \"qr_codes\".\"codeable_id\" = $1 AND \"qr_codes\".\"codeable_type\" = $2 LIMIT 1  [[\"codeable_id\", 1], [\"codeable_type\", \"Vehicle\"]]\n</code></pre>\n\n<p>expected query: </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT  \"qr_codes\".value FROM \"qr_codes\" WHERE \"qr_codes\".\"codeable_id\" = $1 AND \"qr_codes\".\"codeable_type\" = $2 LIMIT 1  [[\"codeable_id\", 1], [\"codeable_type\", \"Vehicle\"]]\n</code></pre>\n"}, {"tags": ["ruby", "bash", "window"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 10546122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aBMJIyqXTBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIV4r0HOGxikIjS-gxCWdVQnN4aQ/photo.jpg?sz=128", "display_name": "TamTam", "link": "https://stackoverflow.com/users/10546122/tamtam"}, "edited": false, "score": 0, "creation_date": 1560847036, "post_id": 56643372, "comment_id": 99859981, "body": "Thanks for your suporting. I did take a look at that post but still failed. So I think install ubuntu is much more easier for RoR. And after 7 hours struggling, now It worked like a charm !!! :-)"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1560841132, "creation_date": 1560841132, "answer_id": 56643372, "question_id": 56642668, "link": "https://stackoverflow.com/questions/56642668/failed-to-install-ruby-through-rbenv-using-ubuntus-bash-on-window-10/56643372#56643372", "title": "Failed to install ruby through rbenv using ubuntu&#39;s bash on window 10", "body": "<p>You might want to try</p>\n\n<pre><code>sudo apt-get install gcc\n</code></pre>\n\n<p>If it does not work, try this <a href=\"https://stackoverflow.com/questions/50729550/installing-g-on-windows-subsystem-for-linux\">topic</a></p>\n\n<p>To summarize</p>\n\n<pre><code>sudo add-apt-repository ppa:ubuntu-toolchain-r/test\nsudo apt update\nsudo apt install g++-7 -y\n</code></pre>\n\n<p>Also, I want to share my experience about installing and working with RoR &amp; Mysql on Windows <a href=\"https://quyetdc.com/2017/11/06/ror-mysql-on-windows/\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 117, "user_id": 10546122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aBMJIyqXTBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdIV4r0HOGxikIjS-gxCWdVQnN4aQ/photo.jpg?sz=128", "display_name": "TamTam", "link": "https://stackoverflow.com/users/10546122/tamtam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560841132, "creation_date": 1560838200, "last_edit_date": 1560838572, "question_id": 56642668, "link": "https://stackoverflow.com/questions/56642668/failed-to-install-ruby-through-rbenv-using-ubuntus-bash-on-window-10", "title": "Failed to install ruby through rbenv using ubuntu&#39;s bash on window 10", "body": "<p>I'm trying to install ruby on window 10 and having some problems.</p>\n\n<p>First of all I followed the instruction to install ubuntu's bash but after adding the \"sublinux system\" option on control panel and reinstalled, the bash didn't work at all. It's just turn off immediately when I clicked on it. So I downloaded linux app on Microsoft store, and continue the instruction, then I'm stucked with the ruby installation.</p>\n\n<pre><code>   minhtam@DESKTOP-KJ2L9J7:~$ rbenv install 2.6.3  \n   Downloading ruby-2.6.3.tar.bz2...                                                                                                                                       \n   -&gt; https://cache.ruby-lang.org/pub/ruby/2.6/ruby-2.6.3.tar.bz2                                                                                                          \n   Installing ruby-2.6.3...                                                                                                                                                                                                                                                                                                                        \n   BUILD FAILED (Ubuntu 18.04 using ruby-build 20190615-1-g0867187)                                                                                                                                                                                                                                                                                \n   Inspect or clean up the working tree at /tmp/ruby- \n   build.20190618055333.4192                                                                                             \n   Results logged to /tmp/ruby-build.20190618055333.4192.log                                                                                                                                                                                                                                                                                       \n   Last 10 log lines:                                                                                                                                                      \n   checking for ruby... false                                                                                                                                              \n   checking build system type... x86_64-pc-linux-gnu                                                                                                                       \n   checking host system type... x86_64-pc-linux-gnu                                                                                                                        \n   checking target system type... x86_64-pc-linux-gnu                                                                                                                      \n   checking for gcc... no                                                                                                                                                  \n   checking for cc... no                                                                                                                                                   \n   checking for cl.exe... no                                                                                                                                               \n   configure: error: in `/tmp/ruby-build.20190618055333.4192/ruby-2.6.3':                                                                                                  \n   configure: error: no acceptable C compiler found in $PATH                                                                                                               \n   See `config.log' for more details  \n</code></pre>\n\n<p>I have looked for solutions and installed libssl-dev already but It doesn't help anything.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1257, "user_id": 4108555, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e4b39206bd7e7e23b3faa85b7cb1373c?s=128&d=identicon&r=PG&f=1", "display_name": "NN796", "link": "https://stackoverflow.com/users/4108555/nn796"}, "edited": false, "score": 0, "creation_date": 1560838888, "post_id": 56642553, "comment_id": 99855952, "body": "have you tried this: <code>class Company &lt; ActiveRecord::Base   ratyrate_rateable &quot;rating&quot;   ratyrate_rateable  end</code>  <code>class Freelancer &lt; ActiveRecord::Base   ratyrate_rater   ratyrate_rateable &quot;rating&quot; end</code>"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 9273735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-crLGF5VF2jI/AAAAAAAAAAI/AAAAAAAAALk/fmgr_kmQdxY/photo.jpg?sz=128", "display_name": "Mrunal Selokar", "link": "https://stackoverflow.com/users/9273735/mrunal-selokar"}, "edited": false, "score": 0, "creation_date": 1560859391, "post_id": 56642755, "comment_id": 99866994, "body": "Thanks for your suggestion. I have added my code above. But I am stuck on <code>rater</code> in <code>Rate</code> model. I can&#39;t figure it out. I also tried with <code>Rating</code> model as <code>rater</code> as you suggested, but how will be the <code>rating_for</code> tag?"}], "tags": [], "owner": {"reputation": 16077, "user_id": 319702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Rb5G2.jpg?s=128&g=1", "display_name": "sameera207", "link": "https://stackoverflow.com/users/319702/sameera207"}, "is_accepted": false, "score": 2, "last_activity_date": 1560838944, "last_edit_date": 1560838944, "creation_date": 1560838620, "answer_id": 56642755, "question_id": 56642553, "link": "https://stackoverflow.com/questions/56642553/how-can-i-implement-star-rating-system-on-multiple-models-in-ruby-on-rails/56642755#56642755", "title": "How can I implement star rating system on multiple models in ruby on rails?", "body": "<p>I think that you need is to look at <a href=\"https://guides.rubyonrails.org/association_basics.html#polymorphic-associations\" rel=\"nofollow noreferrer\">polymorphic-associations</a></p>\n\n<p>It allows you to have a model which can belong to more than one model. In your case something like </p>\n\n<pre><code>class Rating &lt; ApplicationRecord\n  belongs_to :rateable, polymorphic: true\nend\n\nclass Company &lt; ApplicationRecord\n  has_many :ratings, as: :rateable\nend\n\nclass Freelancer &lt; ApplicationRecord\n  has_many :ratings, as: :rateable\nend\n</code></pre>\n\n<p>and then add <a href=\"https://github.com/wazery/ratyrate\" rel=\"nofollow noreferrer\">ratyrate</a> to <code>Rating</code></p>\n\n<p><em>As a Friendly note (and since you have a reputation of 87, assuming you are not very new here): You should add more details and things you have tried to the question. That will show that you've taken effort to solve the issue by yourself and then turned to StackOverflow for help. Also Narrowing down your question scope will help to get a good answer too :)</em></p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 9273735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-crLGF5VF2jI/AAAAAAAAAAI/AAAAAAAAALk/fmgr_kmQdxY/photo.jpg?sz=128", "display_name": "Mrunal Selokar", "link": "https://stackoverflow.com/users/9273735/mrunal-selokar"}, "is_accepted": true, "score": 0, "last_activity_date": 1585306354, "creation_date": 1585306354, "answer_id": 60884535, "question_id": 56642553, "link": "https://stackoverflow.com/questions/56642553/how-can-i-implement-star-rating-system-on-multiple-models-in-ruby-on-rails/60884535#60884535", "title": "How can I implement star rating system on multiple models in ruby on rails?", "body": "<p>I solved this using <code>acts_as_rateable</code> <a href=\"https://github.com/r0man/acts_as_rateable\" rel=\"nofollow noreferrer\">plugin</a> and customizing it a bit.</p>\n\n<p>My final implementation looks as follows:</p>\n\n<p>app/models/company.rb</p>\n\n<pre><code>require 'acts_as_rateable'\nclass Company &lt; ApplicationRecord\n  acts_as_rateable\nend\n</code></pre>\n\n<p>app/models/freelancer.rb</p>\n\n<pre><code>require 'acts_as_rateable'\nclass Freelancer &lt; ApplicationRecord\n  acts_as_rateable\nend\n</code></pre>\n\n<p>app/controllers/companies_controller.rb</p>\n\n<pre><code>def rate_freelancer\n  @freelancer.rate_it(params[:rating], current_company)\n  respond_to :html\n  respond_to :js\nend\n</code></pre>\n\n<p>app/controllers/freelancer_controller.rb</p>\n\n<pre><code>def rate_company\n  @company.rate_it(params[:rating], current_freelancer)\n  respond_to :html\n  respond_to :js\nend\n</code></pre>\n\n<p>config/routes.rb</p>\n\n<pre><code>post 'rate_freelancer' =&gt; 'companies#rate_freelancer'\npost 'rate_company' =&gt; 'freelancers#rate_company'\n</code></pre>\n\n<p>app/models/rate.rb</p>\n\n<pre><code># Table name: rates\n#\n#  id    :uuid             not null, primary key\n#  score :float\n\nclass Rate &lt; ActiveRecord::Base\n  has_many :ratings\n\n  validates_presence_of :score\n  validates_uniqueness_of :score\n  validates_numericality_of :score, :greater_than_or_equal_to =&gt; 1, :less_than_or_equal_to =&gt; 10\n\n  attr_accessor :user_id\n  attr_accessor :free_text\n  attr_accessor :rater_name\nend\n</code></pre>\n\n<p>app/models/rating.rb</p>\n\n<pre><code># Table name: ratings\n#\n#  id            :bigint(8)        not null, primary key\n#  user_id       :uuid\n#  rate_id       :uuid\n#  rateable_id   :uuid\n#  rateable_type :string\n#  free_text     :text\n#  rater_name    :string\n#  created_at    :datetime         not null\n#  updated_at    :datetime         not null\n\nclass Rating &lt; ActiveRecord::Base\n  belongs_to :rate\n  belongs_to :rateable, :polymorphic =&gt; true\n\n  class &lt;&lt; self\n    def parse_as(ratings, output = :xml)\n      if output == :xml\n        ratings.to_xml(:only =&gt; [:user_id, :free_text, :rater_name,  :created_at],\n                   :methods =&gt; [:score])\n      elsif output == :json\n        ratings.to_json(:only =&gt; [:user_id, :free_text, :rater_name, :created_at],\n                    :methods =&gt; [:score])\n      end\n    end\n  end \n  def score\n    rate.score\n  end\nend\n</code></pre>\n\n<p>In ratings form view:</p>\n\n<pre><code>&lt;section class='rating-widget pt-2'&gt;\n  &lt;div class='rating-stars text-center'&gt;\n      How was your experience? &lt;br&gt;\n      &lt;ul id='stars'&gt;\n          &lt;li class='star' title='Poor' data-value='1'&gt;\n              &lt;i class='fa fa-star fa-fw'&gt;&lt;/i&gt;\n          &lt;/li&gt;\n          &lt;li class='star' title='Fair' data-value='2'&gt;\n              &lt;i class='fa fa-star fa-fw'&gt;&lt;/i&gt;\n          &lt;/li&gt;\n          &lt;li class='star' title='Good' data-value='3'&gt;\n              &lt;i class='fa fa-star fa-fw'&gt;&lt;/i&gt;\n          &lt;/li&gt;\n          &lt;li class='star' title='Excellent' data-value='4'&gt;\n              &lt;i class='fa fa-star fa-fw'&gt;&lt;/i&gt;\n          &lt;/li&gt;\n          &lt;li class='star' title='WOW!!!' data-value='5'&gt;\n              &lt;i class='fa fa-star fa-fw'&gt;&lt;/i&gt;\n          &lt;/li&gt;\n       &lt;/ul&gt;\n    &lt;/div&gt;\n&lt;/section&gt;\n</code></pre>\n\n<p>And the script to run the show:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n$(document).ready(function() {\n    /* 1. Visualizing things on Hover*/\n    $('#stars li').on('mouseover', function() {\n        var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on\n        // Now highlight all the stars that's not after the current hovered star\n        $(this).parent().children('li.star').each(function(e) {\n            if (e &lt; onStar) {\n                $(this).addClass('hover');\n            } else {\n                $(this).removeClass('hover');\n            }\n        });\n    }).on('mouseout', function() {\n        $(this).parent().children('li.star').each(function(e) {\n            $(this).removeClass('hover');\n        });\n    });\n    /* 2. Action to perform on click */\n    $('#stars li').on('click', function() {\n        var onStar = parseInt($(this).data('value'), 10); // The star currently selected\n        var stars = $(this).parent().children('li.star');\n        for (i = 0; i &lt; stars.length; i++) {\n            $(stars[i]).removeClass('selected');\n        }\n        for (i = 0; i &lt; onStar; i++) {\n            $(stars[i]).addClass('selected');\n        }\n        var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);\n        var url = \"&lt;%= @url %&gt;\";\n        var user_id = \"&lt;%= @user_id %&gt;\";\n        $.ajax({\n                type: \"POST\",\n                url: url,\n                data: { value: ratingValue, user_id: user_id },\n                dataType: \"JSON\"\n            })\n            .done(function() {\n                window.location.reload();\n            });\n    });\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>Finally styling to make the stars shine:</p>\n\n<pre><code>/* Rating Star Widgets Style */\n.rating-stars ul {\n  list-style-type:none;\n  padding:0;\n\n  -moz-user-select:none;\n  -webkit-user-select:none;\n}\n.rating-stars ul &gt; li.star {\n  display:inline-block;\n}\n\n/* Idle State of the stars */\n.rating-stars ul &gt; li.star &gt; i.fa {\n  font-size:2em; /* Change the size of the stars */\n  color:#ccc; /* Color on idle state */\n}\n\n/* Hover state of the stars */\n.rating-stars ul &gt; li.star.hover &gt; i.fa {\n  color:#FFCC36;\n}\n\n/* Selected state of the stars */\n.rating-stars ul &gt; li.star.selected &gt; i.fa {\n  color:#FF912C;\n}\n\n.rated-stars{\n  i.fa{\n    font-size:2em;\n    color:#FFCC36;\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9273735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-crLGF5VF2jI/AAAAAAAAAAI/AAAAAAAAALk/fmgr_kmQdxY/photo.jpg?sz=128", "display_name": "Mrunal Selokar", "link": "https://stackoverflow.com/users/9273735/mrunal-selokar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 60884535, "answer_count": 2, "score": -1, "last_activity_date": 1585306354, "creation_date": 1560837543, "last_edit_date": 1560856046, "question_id": 56642553, "link": "https://stackoverflow.com/questions/56642553/how-can-i-implement-star-rating-system-on-multiple-models-in-ruby-on-rails", "title": "How can I implement star rating system on multiple models in ruby on rails?", "body": "<p>I have two user models: <code>Company</code> &amp; <code>Freelancer</code>. Each gives star rating to the other at the end of the transaction. I tried using <code>ratyrate</code> gem. But it only allows single <code>rater</code> model. Is there any way to achieve this?\nRatyrate generates following models taking <code>User</code> model as <code>rater</code>:</p>\n\n<pre><code>class Rate &lt; ActiveRecord::Base\n  belongs_to :rater, :class_name =&gt; \"User\"\n  belongs_to :rateable, :polymorphic =&gt; true\nend\n\nclass RatingCache &lt; ActiveRecord::Base\n  belongs_to :cacheable, :polymorphic =&gt; true\nend\n\nclass AverageCache &lt; ActiveRecord::Base\n  belongs_to :rater, :class_name =&gt; \"User\"\n  belongs_to :rateable, :polymorphic =&gt; true\nend\n\nclass OverallAverage &lt; ActiveRecord::Base\n  belongs_to :rateable, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>What I have done is as follows:</p>\n\n<pre><code>class Rate &lt; ActiveRecord::Base\n  belongs_to :rater, :class_name =&gt; \"Company\"\n  belongs_to :rateable, :polymorphic =&gt; true\nend\n\nclass Company &lt; ActiveRecord::Base\n  ratyrate_rater\nend\n\nclass Freelancer &lt; ActiveRecord::Base\n ratyrate_rateable \"performance\"\nend\n</code></pre>\n\n<p>In my views, I have: </p>\n\n<pre><code>&lt;%= rating_for @freelancer, 'performance' %&gt;\n</code></pre>\n\n<p>But this only allows companies to rate freelancers. How can I achieve this in two way so that both will be able to rate each other?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise", "csrf"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11657405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb235fc6b38d43fc3972ff88fa923098?s=128&d=identicon&r=PG&f=1", "display_name": "hoangh3", "link": "https://stackoverflow.com/users/11657405/hoangh3"}, "is_accepted": false, "score": 0, "last_activity_date": 1560831478, "creation_date": 1560831478, "answer_id": 56641698, "question_id": 56641363, "link": "https://stackoverflow.com/questions/56641363/allow-credentials-external-post-request/56641698#56641698", "title": "Allow credentials external post request", "body": "<p>You can try 2 options:</p>\n\n<ul>\n<li>Creating a login API (100% working).</li>\n<li>render the login form => append it to an external website. I have never done this yet. But you can try it.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10620686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ede6f437842f73893890be6a7206292?s=128&d=identicon&r=PG&f=1", "display_name": "Maikol Rico Perez", "link": "https://stackoverflow.com/users/10620686/maikol-rico-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560867997, "creation_date": 1560828302, "last_edit_date": 1560867997, "question_id": 56641363, "link": "https://stackoverflow.com/questions/56641363/allow-credentials-external-post-request", "title": "Allow credentials external post request", "body": "<p>Good evening I have a problem with a functionality with <strong>Devise</strong> that I am implementing, I am receiving a parameter by URL that comes from an external request in another application, but when my application captures this request it is blocked since by default Rails or Devise block requests external post, what I did was disable this validation with \"<strong>skip_before_action: verify_authenticity_token</strong>\" but with this my application is vulnerable to a <strong>CSRF attack</strong>, I need to find a way to allow this request without making my application vulnerable. </p>\n\n<p>One idea I had was to implement \"<strong>add_allow_credentials_headers</strong>\" but I do not know if it can be done or how to do it well</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z4QpL.png\" rel=\"nofollow noreferrer\">error</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/7pqOR.png\" rel=\"nofollow noreferrer\">ExternalPostRequest</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bgy4f.png\" rel=\"nofollow noreferrer\">route</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/n02pl.png\" rel=\"nofollow noreferrer\">Method_In_Controller</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5", "turbolinks-5"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560835658, "post_id": 56641329, "comment_id": 99854863, "body": "Just a thought, what about manually removing the dark style through JS when the button is clicked and before the request goes through, then when the next page loads add the dark style back? There&#39;s always the option to make this a single page app but it&#39;s worth a shot to redeem your code anyway, especially if it&#39;s such a minor issue"}, {"owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560864751, "post_id": 56641329, "comment_id": 99870415, "body": "@maxpleaner I was considering that, but was also just trying to figure out why the style would persist for a split-second on the new page before changing. Is there a particular way that would be best to remove the style? I tried doing $(&#39;img-prev&#39;).click but I think I didn&#39;t construct it right or put it in the right spot."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560868596, "post_id": 56641329, "comment_id": 99872970, "body": "Yeah, I was thinking like an &quot;on click handler&quot; which there are innumerable tutorials about"}], "answers": [{"tags": [], "owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "is_accepted": false, "score": 0, "last_activity_date": 1560900334, "last_edit_date": 1560900334, "creation_date": 1560897466, "answer_id": 56657896, "question_id": 56641329, "link": "https://stackoverflow.com/questions/56641329/rails-styles-persisting-between-pages/56657896#56657896", "title": "Rails styles persisting between pages", "body": "<p>I changed the following two files to have the opacity reset after clicking the link and it solved the problem without forcing a full-page refresh. It required adding ids to the  tags:</p>\n\n<p><strong>app/assets/javascripts/pages.js</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>    $(document).on('turbolinks:load', function() {\n        if ($('#img-prev').length) {\n            $('#img-prev').hover(function() {\n                $(this).fadeTo(300, 0.3);\n            }, function() {\n                $(this).fadeTo(300, 0);\n            });\n        }\n\n        if ($('#img-next').length) {\n            $('#img-next').hover(function() {\n                $(this).fadeTo(300, 0.3);\n            }, function() {\n                $(this).fadeTo(300, 0);\n            });\n        }\n\n        $('#img-next-link').click(function(){\n            $('#img-next-link').css('opacity', 0);\n            $('#img-prev-link').css('opacity', 0);\n        });\n\n        $('#img-prev-link').click(function(){\n            $('#img-next-link').css('opacity', 0);\n            $('#img-prev-link').css('opacity', 0);\n        });\n    });\n</code></pre>\n\n<p><strong>app/views/pages/show.html.erb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    &lt;%= stylesheet_link_tag 'pages' %&gt;\n\n    &lt;div id=\"div-image-wrapper\"&gt;\n      &lt;% if @page.picture.attached? %&gt;\n\n        &lt;% if @page.previous_page.present? %&gt;\n          &lt;%= link_to @page.previous_page, id: \"img-prev-link\" do %&gt;\n            &lt;div id=\"img-prev\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n        &lt;%= image_tag @page.picture, class: \"img-fluid\", id: \"img-page\" %&gt;\n\n        &lt;% if @page.next_page.present? %&gt;\n          &lt;%= link_to @page.next_page, id: \"img-next-link\" do %&gt;\n            &lt;div id=\"img-next\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n      &lt;% end %&gt;\n    &lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 4298546, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/SVZSw.jpg?s=128&g=1", "display_name": "Taylor Liss", "link": "https://stackoverflow.com/users/4298546/taylor-liss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560900334, "creation_date": 1560828043, "question_id": 56641329, "link": "https://stackoverflow.com/questions/56641329/rails-styles-persisting-between-pages", "title": "Rails styles persisting between pages", "body": "<p>I'm creating a book-reading app. Every book <code>has_many</code> pages. I have links going from one page to the next by clicking on the left and right halves of the pages. When you hover over the edge of the page, a div (acting as a link) floating over the page changes its opacity as an indicator that there is another page. These divs are <code>img-prev</code> and <code>img-next</code></p>\n\n<p>Here's an example of the hover effect on the right-half of the page:\n<a href=\"https://i.stack.imgur.com/dhKmo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dhKmo.png\" alt=\"Example of the hover effect\"></a></p>\n\n<p>The problem is that after clicking to the next (or previous) page, the opacity of the subsequent <code>img-prev</code> or <code>img-next</code> div for that new page is <em>very briefly</em> still its \"dark\" color, before changing back to fully transparent. I have a feeling this has to do with turbolinks, but I am not sure.</p>\n\n<p><strong>app/views/pages/show.html.erb</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    &lt;%= stylesheet_link_tag 'pages' %&gt;\n\n    &lt;div id=\"div-image-wrapper\"&gt;\n      &lt;% if @page.picture.attached? %&gt;\n\n        &lt;% if @page.previous_page.present? %&gt;\n          &lt;%= link_to @page.previous_page do %&gt;\n            &lt;div id=\"img-prev\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n        &lt;%= image_tag @page.picture, class: \"img-fluid\", id: \"img-page\" %&gt;\n\n        &lt;% if @page.next_page.present? %&gt;\n          &lt;%= link_to @page.next_page do %&gt;\n            &lt;div id=\"img-next\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n      &lt;% end %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p><strong>app/assets/stylesheets/pages.scss</strong></p>\n\n<pre class=\"lang-css prettyprint-override\"><code>    #container-main {\n      max-width: 100vw;\n      text-align: center;\n    }\n\n    #div-image-wrapper {\n      position: relative;\n      display: inline-block;\n    }\n\n    #img-prev {\n      background-color: black;\n      position: absolute;\n      opacity: 0.0;\n      width: 50%;\n      height: 100%;\n      top: 0;\n      left: 0;\n    }\n\n    #img-next {\n      background-color: black;\n      position: absolute;\n      opacity: 0.0;\n      width: 50%;\n      height: 100%;\n      top: 0;\n      right: 0;\n    }\n\n    #img-page {\n      max-height: 80vh;\n    }\n</code></pre>\n\n<p><strong>app/assets/javascripts/pages.js</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>    $(document).on('turbolinks:load', function() {\n        if ($('#img-prev').length) {\n            $('#img-prev').hover(function() {\n                $(this).fadeTo(300, 0.3);\n            }, function() {\n                $(this).fadeTo(300, 0);\n            });\n        }\n\n        if ($('#img-next').length) {\n            $('#img-next').hover(function() {\n                $(this).fadeTo(300, 0.3);\n            }, function() {\n                $(this).fadeTo(300, 0);\n            });\n        }\n    });\n</code></pre>\n\n<p>The only clue I have is that if I force my <code>img-prev</code> and <code>img-next</code> links to ignore turbolinks, the problem goes away, but a full page refresh is done on every page which is less than ideal. The code for that looks like this:</p>\n\n<p><strong>app/views/pages/show.html.erb (alternate)</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    &lt;%= stylesheet_link_tag 'pages' %&gt;\n\n    &lt;div id=\"div-image-wrapper\"&gt;\n      &lt;% if @page.picture.attached? %&gt;\n\n        &lt;% if @page.previous_page.present? %&gt;\n          &lt;%= link_to @page.previous_page, \"data-turbolinks\": false do %&gt;\n            &lt;div id=\"img-prev\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n        &lt;%= image_tag @page.picture, class: \"img-fluid\", id: \"img-page\" %&gt;\n\n        &lt;% if @page.next_page.present? %&gt;\n          &lt;%= link_to @page.next_page, \"data-turbolinks\": false do %&gt;\n            &lt;div id=\"img-next\"&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n\n      &lt;% end %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Not sure if it is relevant, but I should mention I have this line added to my <strong>config/initializers/assets.rb</strong>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.config.assets.precompile += %w( pages.css )\n</code></pre>\n\n<p>Also, the full sourcecode of this application can be found here on my Github:\n<a href=\"https://github.com/tliss/lianhuanhua\" rel=\"nofollow noreferrer\">https://github.com/tliss/lianhuanhua</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "vagrant", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 2962, "user_id": 1512790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RrvSw.jpg?s=128&g=1", "display_name": "Rick Gladwin", "link": "https://stackoverflow.com/users/1512790/rick-gladwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1560837656, "last_edit_date": 1560837656, "creation_date": 1560837109, "answer_id": 56642465, "question_id": 56641208, "link": "https://stackoverflow.com/questions/56641208/rails-5-on-vagrant-is-caching-classes-in-development-mode/56642465#56642465", "title": "Rails 5 on Vagrant is caching classes in development mode", "body": "<p>Found an answer on another thread: <a href=\"https://stackoverflow.com/a/36616931/1512790\">https://stackoverflow.com/a/36616931/1512790</a></p>\n\n<p>The file changes weren't being detected by <code>ActiveSupport::EventedFileUpdateChecker</code>, no matter what changes I made to the clock sync, file types, etc.</p>\n\n<p>The solution is: in 'config/environments/development.rb', replace this line</p>\n\n<pre><code>config.file_watcher = ActiveSupport::EventedFileUpdateChecker\n</code></pre>\n\n<p>with this one:</p>\n\n<pre><code>config.file_watcher = ActiveSupport::FileUpdateChecker\n</code></pre>\n\n<p>The FileUpdateChecker class, for whatever reason, works in vm environments when EventedFileUpdateChecker does not.</p>\n\n<p>Huge shoutout to <a href=\"https://stackoverflow.com/users/5712918/pocari\">pocari</a> for this solution. </p>\n"}], "owner": {"reputation": 2962, "user_id": 1512790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RrvSw.jpg?s=128&g=1", "display_name": "Rick Gladwin", "link": "https://stackoverflow.com/users/1512790/rick-gladwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560837656, "creation_date": 1560826581, "last_edit_date": 1560837609, "question_id": 56641208, "link": "https://stackoverflow.com/questions/56641208/rails-5-on-vagrant-is-caching-classes-in-development-mode", "title": "Rails 5 on Vagrant is caching classes in development mode", "body": "<p>I'm running a bare-bones Rails 5 app on a Vagrant virtual machine. I've generated just one scaffold called Blog and it's working.</p>\n\n<p>Any manual changes to the classes, however, require a Rails server restart in order to take effect, despite being in development mode.</p>\n\n<p><strong><em>Edit: I've posted an answer to this that worked for me, after trying a lot of other flawed solutions, for those who want to skip ahead...</em></strong></p>\n\n<p>The Blog scaffold files were all created successfully, I can view the pages using the index, edit, etc. routes. But if I change <code>@blogs = Blog.all</code> in the index method in <code>BlogsController</code> to <code>@blogs = Blog.limit(1)</code> and refresh the browser, the view doesn't change. All blog posts are still listed.</p>\n\n<p>I looked in my local directory and the one on the vm. They match. So the changes are on the server. </p>\n\n<p>I closed and restarted the Rails server with <code>@blogs = Blog.limit(1)</code> as the index method content, and the page loads as expected, with one blog post appearing.</p>\n\n<p>How can I get the rails app to display updated content without restarting the server? Is there some caching going on by default that I can switch off? I'm using RubyMine as my IDE, but I don't have deployment settings in place and I haven't turned on any special caching. I've used RubyMine and Vagrant on another Rails project (running Ruby 2.0.0 and Rails 4.1.4) without this issue. </p>\n\n<p><strong>Rails version 5.2.3</strong></p>\n\n<p><strong>Ruby version 2.4.1p111 or 2.6.3p62</strong> (neither worked)</p>\n\n<p><strong>RubyMine version 2019.1</strong></p>\n\n<p>Vagrant is using VirtualBox and running <strong>Ubuntu 18.04.2 LTS</strong></p>\n\n<p>According to other posts, this is the default behaviour for production environments. I tried <code>echo $RAILS_ENV</code> on the command line, but got back null.</p>\n\n<p>I added <code>&lt;%= Rails.env %&gt;</code> to '...blogs/index.html.erb' and it shows 'development' in the browser. So the app environment is set correctly but it's still caching the classes (or something). Is there something about Rails 5 where it's treating the vm as a remote (production) server by default even though it's displaying 'development' as the Rails.env variable?</p>\n\n<p>Here's the relevant console output after starting the rails server:</p>\n\n<pre><code>=&gt; Booting Puma\n=&gt; Rails 5.2.3 application starting in development\n=&gt; Run `rails server -h` for more startup options\nPuma starting in single mode...\n * Version 3.12.1 (ruby 2.4.1-p111), codename: Llamas in Pajamas\n * Min threads: 5, max threads: 5\n * Environment: development\n * Listening on tcp://0.0.0.0:3000\n</code></pre>\n\n<p><strong>Things I've tried:</strong></p>\n\n<ul>\n<li><p>I've cleared the browser cache and run <code>rake tmp:cache:clear</code>. No\neffect.</p></li>\n<li><p>In the files 'config/environments/development.rb',\n'config/environments/test.rb', <em>and</em>\n'config/environments/production.rb' I set these attributes:</p></li>\n</ul>\n\n<pre><code>config.cache_classes = false\nconfig.action_controller.perform_caching = false \n</code></pre>\n\n<p>and restarted the rails server. No effect.</p>\n\n<ul>\n<li><p>I've switched to Ruby version 2.6.3p62 from 2.4.1p111. No effect.</p></li>\n<li><p>I closed RubyMine and edited 'blogs_controller.rb' in SublimeText. No\neffect.</p></li>\n<li><p>I edited 'app/views/blogs/index.html.erb' and refreshed the browser\nwindow without restarting the server and the changes to the view are\nreflected immediately. So it's not an issue of caching <em>everything</em>.</p></li>\n<li><p>Added the following to my Vagrantfile in order to tighten the settings that sync the guest and host clock, and re-upped vagrant:</p></li>\n</ul>\n\n<pre><code>config.vm.provider 'virtualbox' do |v|\n    v.customize [\"guestproperty\", \"set\", :id, \"--timesync-set-threshold\", 5000] # Sync time every 5 seconds so Rails code reloads properly\n    v.customize [\"guestproperty\", \"set\", :id, \"--timesync-interval\", 10000]     # Specifies interval at which to synchronize time with the host. Default is 10000ms (10 seconds).\n    v.customize [\"guestproperty\", \"set\", :id, \"--timesync-min-adjust\", 100]     # The minimum absolute drift value measured in milliseconds to make adjustments for. The default is 1000 ms on OS/2 and 100 ms elsewhere.\n    v.customize [\"guestproperty\", \"set\", :id, \"--timesync-set-on-restore\", 1]   # Set the time after the VM was restored from a saved state when passing 1 as parameter. This is the default.\nend\n</code></pre>\n\n<p>No effect. </p>\n\n<ul>\n<li>Reinstalled Ruby, Rails, and all other gems. No effect.</li>\n<li>In Vagrantfile, Changed the file type for the synced folders that vagrant is using and set up a dhcp private network connection:</li>\n</ul>\n\n<pre><code>config.vm.network \"private_network\", type: \"dhcp\"\nconfig.vm.synced_folder \".\", \"/vagrant\", type: \"nfs\", mount_options: ['actimeo=1']\n</code></pre>\n\n<p>No effect.</p>\n\n<ul>\n<li>In Vagrantfile, ensured that the guest was getting the host clock data:</li>\n</ul>\n\n<pre><code>v.customize [\"setextradata\", :id, \"VBoxInternal/Devices/VMMDev/0/Config/GetHostTimeDisabled\", 0]\n</code></pre>\n\n<p>No effect.</p>\n\n<p>This seems to be a similar issue, where the op is using Docker on Mac OS X: <a href=\"https://stackoverflow.com/questions/37144122/dockerized-rails-5-rc1-application-not-picking-up-updates-to-controllers-and-mod\">Dockerized Rails 5 RC1 application not picking up updates to controllers and models in development</a>, but I'm not using any special deployment or provisioning, just a Vagrant vm.</p>\n\n<p>This is another similar issue, but the configuration setting in the accepted answer doesn't exist in Rails 5: <a href=\"https://stackoverflow.com/questions/18270945/rails-server-needs-restart-every-time-i-make-changes-why\">Rails Server needs restart every time I make changes? why?</a>. One of the comments mentions an old issue where Vagrant guest and host clocks being out of sync could wreck Rails reloading. Going to investigate that possibility. <em>Edit: Tweaked the VirtualBox clock sync settings, confirmed that the clock on the guest and host were in sync (they're within 3 seconds when I run <code>date</code> on each machine - which still seems off, but they're close). Didn't work.</em></p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 5, "creation_date": 1560831730, "post_id": 56640439, "comment_id": 99853959, "body": "Can you clarify your question, please? They do different things, so there is usually never any situation where you would have a choice between them."}], "answers": [{"comments": [{"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1560820299, "post_id": 56640547, "comment_id": 99851946, "body": "Note that in Ruby it is almost never necessary to have a simple boolean, as opposed to just a truthy/falsy value, except as a return from a question-mark function (so as not to confuse the API consumer)."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 4, "creation_date": 1560831652, "post_id": 56640547, "comment_id": 99853943, "body": "@Amadan: Actually, even in question mark APIs, non-boolean values are often returned. The most famous example is probably the <code>defined?</code> unary prefix operator, which actually <i>never</i> returns a boolean value. It returns either <code>nil</code> or a string describing what is defined (e.g. <code>&quot;method&quot;</code> or <code>&quot;local-variable&quot;</code>). The point is: you shouldn&#39;t rely on this extra information. Often, question mark APIs that ask for the existence of something return <code>nil</code> to denote the absence."}], "tags": [], "owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "is_accepted": false, "score": 5, "last_activity_date": 1560820603, "last_edit_date": 1560820603, "creation_date": 1560820018, "answer_id": 56640547, "question_id": 56640439, "link": "https://stackoverflow.com/questions/56640439/comparison-of-operator-vs-present/56640547#56640547", "title": "Comparison of !! operator vs present?", "body": "<p><code>.present?</code> is part of Rails, not a part of a standard Ruby class library. The <a href=\"https://apidock.com/rails/Object/present%3f\" rel=\"nofollow noreferrer\">Rails documentation for <code>.present?</code></a> says that it's <code>true</code> if the object is \"not blank\". It's often used to determine of a database attribute has an actual value other than <code>nil</code> or blank.</p>\n\n<pre><code>&gt; x = ' '\n&gt; x.present?\nfalse\n&gt; x = nil\n&gt; x.present?\nfalse\n</code></pre>\n\n<p><code>!!</code> is two <code>!</code> together, a standard Ruby operator. The <code>!</code> is the Ruby logical \"not\" operator. A blank value is truthy in Ruby. Using two <code>!</code> together lets you take a value in Ruby and get a simple boolean <code>true</code> or <code>false</code> depending upon whether the value is truthy or falsey.</p>\n\n<pre><code>&gt; x = ' '\n&gt; !!x\ntrue    # a blank is truthy\n&gt; x = nil\n&gt; !!x\nfalse   # nil is falsey\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2012677, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8d7cb2fe712fb17f44f8c354bf37e7b5?s=128&d=identicon&r=PG&f=1", "display_name": "user2012677", "link": "https://stackoverflow.com/users/2012677/user2012677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3051, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560841424, "creation_date": 1560818821, "last_edit_date": 1560841424, "question_id": 56640439, "link": "https://stackoverflow.com/questions/56640439/comparison-of-operator-vs-present", "title": "Comparison of !! operator vs present?", "body": "<p>In Ruby is there an advantage to call <code>present?</code></p>\n\n<pre><code>my_value.present?\n</code></pre>\n\n<p>vs <code>!!</code></p>\n\n<pre><code>!!my_value\n</code></pre>\n"}, {"tags": ["ruby", "lambda", "ruby-hash"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1560811946, "post_id": 56639642, "comment_id": 99850392, "body": "I see. No, the hash value doesn&#39;t know what it&#39;s key name is. How is the hash created?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560812217, "post_id": 56639642, "comment_id": 99850447, "body": "You can get the key name by iterating over the hash, such as <code>HASH.each do |key, val|</code>. Can you show the full usage of this? Where do you invoke the lambas?"}, {"owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "edited": false, "score": 0, "creation_date": 1560812278, "post_id": 56639642, "comment_id": 99850455, "body": "Edited the question, please let me know if still unclear."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1560812522, "post_id": 56639642, "comment_id": 99850501, "body": "You said in your question, &quot;there are a lot of lamdas in the hash&quot;. You only show one in your example. It would be helpful to understand how to distinguish them. Also, you haven&#39;t answered my question about how the hash is created. Is it done manually or is it generated? Based upon where you seem to be headed with this, perhaps a hash really isn&#39;t the right representation for what you&#39;re ultimately trying to do? Knowing ultimately what you&#39;re trying to achieve would help."}, {"owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "edited": false, "score": 0, "creation_date": 1560812827, "post_id": 56639642, "comment_id": 99850580, "body": "Edited it again. Yes, the hash is created manually. The hash is used in another function which takes in input as marker type (shape) and creates the marker(shape) of required type and at required coordinates."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1560813548, "post_id": 56639642, "comment_id": 99850727, "body": "In answering questions on SO we run into many questions that are XY problems, where you ask about Y but should ask about X. &quot;<a href=\"https://meta.stackexchange.com/q/66377\">What is the XY problem?</a>&quot; Perhaps it&#39;d be better to describe the intent; What are you trying to do, and why are you trying to do it this way? Also please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; as they&#39;ll help you define the question better."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1560813984, "post_id": 56639642, "comment_id": 99850815, "body": "This is looking more like you need a different approach to whatever your overall problem is. How does the function that uses the hash know what to pass for the <code>draw</code> argument? It would seem that knowledge of correspondence between the type of entity and draw method has to be known outside of the hash. This is looking a bit messy..."}, {"owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "edited": false, "score": 0, "creation_date": 1560813993, "post_id": 56639642, "comment_id": 99850817, "body": "My question has been answered, Thank you for the suggestions, I will keep these in mind in the future!"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1560814048, "post_id": 56639642, "comment_id": 99850825, "body": "Ok, happy programming trails."}, {"owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "edited": false, "score": 0, "creation_date": 1560814069, "post_id": 56639642, "comment_id": 99850828, "body": "Yes! It is messy and the only problem is just knowing the name of the key in it&#39;s value and printing it, rest all the code works fine!"}], "answers": [{"comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1560813294, "post_id": 56639893, "comment_id": 99850670, "body": "The hash could be reversed into a hash of arrays so lookups could occur based on the values, but it&#39;d be possible to get a list of possible lambdas, which would only another can of worms."}], "tags": [], "owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "is_accepted": true, "score": 1, "last_activity_date": 1560813082, "creation_date": 1560813082, "answer_id": 56639893, "question_id": 56639642, "link": "https://stackoverflow.com/questions/56639642/how-to-get-the-key-name-inside-the-value-for-printing-inside-a-ruby-hash/56639893#56639893", "title": "How to get the key name inside the value for printing inside a Ruby hash", "body": "<p>I don't think this can be done. A hash is a collection of keys and values. Keys are unique, values are not.You are asking a value (a lambda in this case, but it doesn't matter much) to which key it belongs. I could be one, none or many; there is no way for the value to \"know\". Ask the hash, not the value.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "edited": false, "score": 0, "creation_date": 1561074540, "post_id": 56644358, "comment_id": 99955369, "body": "This also looks good but I want to avoid making a new Class and hence the hash. Thanks for the suggestion!"}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 0, "last_activity_date": 1560844709, "creation_date": 1560844709, "answer_id": 56644358, "question_id": 56639642, "link": "https://stackoverflow.com/questions/56639642/how-to-get-the-key-name-inside-the-value-for-printing-inside-a-ruby-hash/56644358#56644358", "title": "How to get the key name inside the value for printing inside a Ruby hash", "body": "<p>You're trying to re-implement object oriented programming in Ruby. There's no need to, everything is an object in Ruby!</p>\n\n<p>You can remove all the duplicated code, the lambdas and the complicated Hash logic:</p>\n\n<pre><code>class MarkerType\n  attr_reader :name\n  def initialize(name, &amp;block)\n    @name = name\n    @block = block\n  end\n\n  def draw(*params)\n    if @block\n      @block.call(*params)\n    else\n      puts \"Marker #{name} has not been implemented yet!\"\n    end\n  end\nend\n\nsquare = MarkerType.new 'square' do |size=5|\n  puts \"Draw a square with size : #{size}\"\nend\n\nsquare.draw\n# =&gt; Draw a square with size : 5\n\n\nasterisk = MarkerType.new 'asterisk'\nasterisk.draw\n# =&gt; Marker asterisk has not been implemented yet!\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8121078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854f0980f565825d970bb83082acc8da?s=128&d=identicon&r=PG", "display_name": "AlishDipani", "link": "https://stackoverflow.com/users/8121078/alishdipani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56639893, "answer_count": 2, "score": 0, "last_activity_date": 1560844709, "creation_date": 1560810667, "last_edit_date": 1560813160, "question_id": 56639642, "link": "https://stackoverflow.com/questions/56639642/how-to-get-the-key-name-inside-the-value-for-printing-inside-a-ruby-hash", "title": "How to get the key name inside the value for printing inside a Ruby hash", "body": "<p>I am creating a hash containing lambdas as the value in Ruby. I want to access the key name in the lambda.</p>\n\n<p>The hash is a collection of anonymous functions (lambdas) which take inputs and do a specific task. So, I am making a hash which draws a shape and so the keys in the hash are the shape names like circle, square, and the value for this key is a lambda which takes in inputs and executes some task which results in the shape drawn.\nSo, here I want to print the name of the shape, i.e. the key, in the lambda.</p>\n\n<p>The real example:</p>\n\n<pre><code>MARKER_TYPES = {\n        # Default type is circle\n        # Stroke width is set to 1\n        nil: -&gt;(draw, x, y, fill_color, border_color, size) {\n          draw.stroke Rubyplot::Color::COLOR_INDEX[border_color]\n          draw.fill Rubyplot::Color::COLOR_INDEX[fill_color]\n          draw.circle(x,y, x + size,y)\n        },\n        circle: -&gt;(draw, x, y, fill_color, border_color, size) {\n          draw.stroke Rubyplot::Color::COLOR_INDEX[border_color]\n          draw.fill Rubyplot::Color::COLOR_INDEX[fill_color]\n          draw.circle(x,y, x + size,y)\n        },\n        plus: -&gt;(draw, x, y, fill_color, border_color, size) {\n          # size is length of one line\n          draw.stroke Rubyplot::Color::COLOR_INDEX[fill_color]\n          draw.line(x - size/2, y, x + size/2, y)\n          draw.line(x, y - size/2, x, y + size/2)\n        },\n        dot: -&gt;(draw, x, y, fill_color, border_color, size) {\n          # Dot is a circle of size 5 pixels\n          # size is kept 5 to make it visible, ideally it should be 1\n          # which is the smallest displayable size\n          draw.fill Rubyplot::Color::COLOR_INDEX[fill_color]\n          draw.circle(x,y, x + 5,y)\n        },\n        asterisk: -&gt;(draw, x, y, fill_color, border_color, size) {\n          # Looks like a five sided star\n          raise NotImplementedError, \"marker #{self} has not yet been implemented\"\n        }\n}\n</code></pre>\n\n<p>The Hash contains around 40 such key, value pairs.</p>\n\n<p>The desired output of this would be <code>marker star has not yet been implemented</code></p>\n\n<p>A simple example:</p>\n\n<pre><code>HASH = {\n  key1: -&gt;(x) {\n   puts('Number of key1 = ' + x.to_s) \n  }\n}\n</code></pre>\n\n<p>Instead of hardcoding <code>key1</code> I want to get the name of the key in the value which is a lambda as there are a lot of lambdas in the hash.</p>\n\n<p>Replacing <code>key1</code> with <code>#{self}</code> prints the class and not the name of the key.</p>\n"}, {"tags": ["sql", "ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560809943, "post_id": 56639266, "comment_id": 99849919, "body": "It&#39;s unclear what the goal is. You want a query that returns only one user&#39;s favorited articles, sorted by the article name?"}, {"owner": {"reputation": 763, "user_id": 921187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Giqbd.jpg?s=128&g=1", "display_name": "Mathias Aichinger", "link": "https://stackoverflow.com/users/921187/mathias-aichinger"}, "reply_to_user": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560838075, "post_id": 56639266, "comment_id": 99855667, "body": "@supremebeing7 No we want to have a list of all articles, but the favourited article of the current user should come first in the list."}, {"owner": {"reputation": 763, "user_id": 921187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Giqbd.jpg?s=128&g=1", "display_name": "Mathias Aichinger", "link": "https://stackoverflow.com/users/921187/mathias-aichinger"}, "reply_to_user": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560840545, "post_id": 56639266, "comment_id": 99856671, "body": "I have attached a screenshot of our expected result. Important is that the favourite column is based on the currently logged in user."}], "owner": {"reputation": 763, "user_id": 921187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Giqbd.jpg?s=128&g=1", "display_name": "Mathias Aichinger", "link": "https://stackoverflow.com/users/921187/mathias-aichinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560844124, "creation_date": 1560807898, "last_edit_date": 1560844124, "question_id": 56639266, "link": "https://stackoverflow.com/questions/56639266/activerecord-sorting-with-has-and-belongs-to-many-with-context", "title": "ActiveRecord sorting with has_and_belongs_to_many with context", "body": "<p>We want to implement a user-based favourites sorting for a table, but we are struggling with the join.</p>\n\n<h2>Our schema:</h2>\n\n<p>User ->* artice_user_favorites *&lt;- Article</p>\n\n<ul>\n<li>Article A</li>\n<li>Article B</li>\n<li><p>Article C</p></li>\n<li><p>User A</p></li>\n<li><p>User B</p></li>\n<li><p>User A favourites A,C</p></li>\n<li>User B favourites A,B</li>\n</ul>\n\n<h2>Our use case:</h2>\n\n<ul>\n<li>Article table: Sorting by user favourites</li>\n<li>Favourites of the current user first</li>\n<li>Favourites of the current user last</li>\n</ul>\n\n<h2>Expected:</h2>\n\n<p>Favourite articles of User A first</p>\n\n<ul>\n<li>Article A </li>\n<li>Article C </li>\n<li>Article B</li>\n</ul>\n\n<p>We have found some examples where it was grouped by and counted the related objects, but it always included the favourite objects also from the other users.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sWWCw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sWWCw.png\" alt=\"Expected list\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4", "turbolinks"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560810002, "post_id": 56638925, "comment_id": 99849938, "body": "Show some code, show the form, something."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560811345, "post_id": 56638925, "comment_id": 99850256, "body": "@arieljuod please check again... updated"}, {"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560811636, "post_id": 56638925, "comment_id": 99850323, "body": "What&#39;s the expected behaviour of your code? <code>rails-ujs</code> (or <code>jquery_ujs</code>) tries to handle the form submission if you set <code>remote: true</code> and <code>disable_with: ...</code> options. You don&#39;t need to listen the click event. Can you clarify your intention? use either the rails options (<code>remote</code>,<code>disable_with</code>,<code>format</code>) or the jquery callback, but not both."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560811902, "post_id": 56638925, "comment_id": 99850377, "body": "I tried without disable_with and also without click event."}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560811912, "post_id": 56638925, "comment_id": 99850382, "body": "faces same issue"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1560812360, "post_id": 56638925, "comment_id": 99850469, "body": "@arieljuod i am doing some processing and validations in click function and then submit"}], "answers": [{"tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": 0, "last_activity_date": 1560823890, "creation_date": 1560823890, "answer_id": 56640915, "question_id": 56638925, "link": "https://stackoverflow.com/questions/56638925/rails-turbolinks-submit-remote-true-forms-multiple-times/56640915#56640915", "title": "Rails turbolinks submit remote true forms multiple times", "body": "<p>If you want to add some validations without loosing the rails handler, do something like this:</p>\n\n<pre><code>$(document).on('ajax:before','#user_login_form1', function(ev) {\n  let valid = .....\n  if (!valid) return false;\n});\n</code></pre>\n\n<p>Check the docs (I guess you are using jquery_ujs): <a href=\"https://guides.rubyonrails.org/working_with_javascript_in_rails.html#stoppable-events\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/working_with_javascript_in_rails.html#stoppable-events</a></p>\n\n<p>If you use rails-ujs, then do <code>ev.preventDefault()</code> or <code>stopEverything(ev)</code>.</p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1560823890, "creation_date": 1560805586, "last_edit_date": 1560811327, "question_id": 56638925, "link": "https://stackoverflow.com/questions/56638925/rails-turbolinks-submit-remote-true-forms-multiple-times", "title": "Rails turbolinks submit remote true forms multiple times", "body": "<p>Using turbolinks and submitting remote true forms causing an issue is that forms submitting multiple times.</p>\n\n<p>Like when I visit pages multiple times and then submit a form which is submitting remotely. It submits multiple times. This issue is due to turbolinks as the section of the Turbolinks README <a href=\"https://github.com/turbolinks/turbolinks#working-with-script-elements\" rel=\"nofollow noreferrer\">Working with Script Elements</a> advises avoiding inline scripts when installing event handlers:</p>\n\n<p>Here is my form code</p>\n\n<pre><code>&lt;%= form_for 'user', :url =&gt; otp_path, :html =&gt; { :id =&gt; \"user_login_form1\" }, :remote =&gt; true, format: :json do |f| %&gt; \n   &lt;%= f.submit \"Submit\", id: 'user_login_form1_submit','data-disable-with' =&gt; 'Progressing...' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and in same view I am submitting it using jquery</p>\n\n<pre><code>$(document).on('click','#user_login_form1_submit',function(ev){\n    ev.preventDefault();\n    jQuery('form#user_login_form1').submit();\n});\n</code></pre>\n\n<p>I don't want to remove turbolinks from my site ut how to deal with remote true form submitting  multiple times issue? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "macos", "rubygems"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1560804146, "post_id": 56638611, "comment_id": 99848218, "body": "Your <code>config&#47;initializers&#47;stripe.rb</code> is trying to call <code>:[]</code> on a <code>nil</code>. Perhaps show the content of that file?"}, {"owner": {"reputation": 3, "user_id": 11660951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D7GX2ahtiRE/AAAAAAAAAAI/AAAAAAAAAAs/e8uLFFBW80A/photo.jpg?sz=128", "display_name": "Alan C.", "link": "https://stackoverflow.com/users/11660951/alan-c"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1560804271, "post_id": 56638611, "comment_id": 99848264, "body": "Rails.configuration.stripe = {   publishable_key: Rails.application.credentials[Rails.env.to_sym][:stripe][:pu&zwnj;&#8203;blic_key],   secret_key: Rails.application.credentials[Rails.env.to_sym][:stripe][:se&zwnj;&#8203;cret_key] }  Stripe.api_key = Rails.configuration.stripe[:secret_key]"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 2, "creation_date": 1560804606, "post_id": 56638611, "comment_id": 99848392, "body": "Did you set all those <code>Rails.application.credentials</code> on your new machine? BTW, it is usually best to add code to your question rather than posting in comments."}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 8149936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TL1Z6.png?s=128&g=1", "display_name": "Elias Glyptis", "link": "https://stackoverflow.com/users/8149936/elias-glyptis"}, "edited": false, "score": 0, "creation_date": 1617216069, "post_id": 56639010, "comment_id": 118245531, "body": "Good answer, and this is how I realized why it&#39;s nil. It was just nil during compilation. Weird how credentials are loaded to compile assets. Issue is closed, but really weird they closed it. Does not make any sense at all. <a href=\"https://github.com/rails/rails/issues/32947\" rel=\"nofollow noreferrer\">github.com/rails/rails/issues/32947</a>"}], "tags": [], "owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "is_accepted": true, "score": 3, "last_activity_date": 1560806170, "creation_date": 1560806170, "answer_id": 56639010, "question_id": 56638611, "link": "https://stackoverflow.com/questions/56638611/ruby-on-rails-nomethoderror-undefined-method-for-nilnilclass/56639010#56639010", "title": "Ruby On Rails - NoMethodError: undefined method `[]&#39; for nil:NilClass", "body": "<p>From the stacktrace you posted, this line in particular appears to be the issue: </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>Rails.application.credentials[Rails.env.to_sym][:stripe][:public_key]\n</code></pre>\n\n<p>Since you're chaining multiple hash accesses, one of those objects is <code>nil</code>. You could try inspecting each of them by adding something like this to the top of the initializer:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>puts Rails.application.credentials.inspect\nputs Rails.application.credentials[Rails.env.to_sym].inspect\nputs Rails.application.credentials[Rails.env.to_sym][:stripe].inspect\n</code></pre>\n\n<p>That will tell you which part is <code>nil</code> that shouldn't be, and you can update your credentials file accordingly.</p>\n"}, {"tags": [], "owner": {"reputation": 215, "user_id": 8149936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TL1Z6.png?s=128&g=1", "display_name": "Elias Glyptis", "link": "https://stackoverflow.com/users/8149936/elias-glyptis"}, "is_accepted": false, "score": 0, "last_activity_date": 1617300947, "last_edit_date": 1617300947, "creation_date": 1617207538, "answer_id": 66891537, "question_id": 56638611, "link": "https://stackoverflow.com/questions/56638611/ruby-on-rails-nomethoderror-undefined-method-for-nilnilclass/66891537#66891537", "title": "Ruby On Rails - NoMethodError: undefined method `[]&#39; for nil:NilClass", "body": "<p>Based on your configuration you should have your <code>credentials.yml</code> looking something like this:</p>\n<pre><code>stripe:\n  secret_key: pk_123456789012345\n  public_key: sk_abcdefghijklnmk\n</code></pre>\n<p><strong>In your stripe.rb you missed <code>[:secret_key]</code>. It should look like this. But this won't work either when you are precompiling in production.</strong></p>\n<pre><code>Stripe.api_key = Rails.application.credentials[Rails.env.to_sym][:stripe][:secret_key] \n</code></pre>\n<p><strong>Use dig method instead.</strong></p>\n<p>So for your stripe.rb</p>\n<pre><code>Stripe.api_key = Rails.application.credentials.dig(:stripe, :secret_key)\n</code></pre>\n<p>In your terminal run</p>\n<p><code>RAILS_ENV=production rails c</code></p>\n<p>In the console run</p>\n<pre><code>Rails.application.credentials.dig(:stripe, :secret_key)\n</code></pre>\n<p>Now you should get a value.</p>\n<p>This was an issue I ran into and suffered until I figure it out. It seems to be an issue with rails code base. Not sure we need to load credentials to compile assets. Anyways, they close this issue but I am not sure why they closed it. Here is the link to the issue. <a href=\"https://github.com/rails/rails/issues/32947\" rel=\"nofollow noreferrer\">https://github.com/rails/rails/issues/32947</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11660951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D7GX2ahtiRE/AAAAAAAAAAI/AAAAAAAAAAs/e8uLFFBW80A/photo.jpg?sz=128", "display_name": "Alan C.", "link": "https://stackoverflow.com/users/11660951/alan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 56639010, "answer_count": 2, "score": 0, "last_activity_date": 1617300947, "creation_date": 1560803881, "last_edit_date": 1560837166, "question_id": 56638611, "link": "https://stackoverflow.com/questions/56638611/ruby-on-rails-nomethoderror-undefined-method-for-nilnilclass", "title": "Ruby On Rails - NoMethodError: undefined method `[]&#39; for nil:NilClass", "body": "<p>I'm trying to run on a new computer some ruby code and I receive the following error (rails db:migrate --trace)</p>\n\n<pre><code>** Invoke db:migrate (first_time)\n** Invoke db:load_config (first_time)\n** Invoke environment (first_time)\n** Execute environment\nrails aborted!\nNoMethodError: undefined method `[]' for nil:NilClass\n/Users/jairochavez/Documents/Rails/rfdf_bolivia/config/initializers/stripe.rb:2:in `&lt;main&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:54:in `load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:285:in `block in load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:285:in `load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:657:in `block in load_config_initializer'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/notifications.rb:170:in `instrument'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:656:in `load_config_initializer'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:614:in `block (2 levels) in &lt;class:Engine&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:613:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/engine.rb:613:in `block in &lt;class:Engine&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in `instance_exec'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:32:in `run'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:61:in `block in run_initializers'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:228:in `block in tsort_each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:431:in `each_strongly_connected_component_from'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:421:in `block in each_strongly_connected_component_from'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:50:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:50:in `tsort_each_child'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:415:in `call'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:415:in `each_strongly_connected_component_from'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:349:in `block in each_strongly_connected_component'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:347:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:347:in `call'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:347:in `each_strongly_connected_component'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:226:in `tsort_each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/tsort.rb:205:in `tsort_each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/initializable.rb:60:in `run_initializers'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/application.rb:361:in `initialize!'\n/Users/jairochavez/Documents/Rails/rfdf_bolivia/config/environment.rb:5:in `&lt;main&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/application.rb:337:in `require_environment!'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/application.rb:520:in `block in run_tasks_blocks'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:273:in `block in execute'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:273:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:273:in `execute'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:214:in `block in invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/monitor.rb:230:in `mon_synchronize'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:194:in `invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:238:in `block in invoke_prerequisites'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:236:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:236:in `invoke_prerequisites'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:213:in `block in invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/monitor.rb:230:in `mon_synchronize'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:194:in `invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:238:in `block in invoke_prerequisites'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:236:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:236:in `invoke_prerequisites'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:213:in `block in invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/monitor.rb:230:in `mon_synchronize'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:194:in `invoke_with_call_chain'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/task.rb:183:in `invoke'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:160:in `invoke_task'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:116:in `block (2 levels) in top_level'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:116:in `each'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:116:in `block in top_level'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:125:in `run_with_threads'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:110:in `top_level'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/commands/rake/rake_command.rb:23:in `block in perform'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/rake-12.3.2/lib/rake/application.rb:186:in `standard_exception_handling'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/commands/rake/rake_command.rb:20:in `perform'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/command.rb:48:in `invoke'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/railties-5.2.3/lib/rails/commands.rb:18:in `&lt;main&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:22:in `block in require_with_bootsnap_lfi'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/loaded_features_index.rb:92:in `register'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:21:in `require_with_bootsnap_lfi'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/bootsnap-1.4.4/lib/bootsnap/load_path_cache/core_ext/kernel_require.rb:30:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `block in require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:257:in `load_dependency'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/activesupport-5.2.3/lib/active_support/dependencies.rb:291:in `require'\n/Users/jairochavez/Documents/Rails/rfdf_bolivia/bin/rails:9:in `&lt;top (required)&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/client/rails.rb:28:in `call'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/client/command.rb:7:in `call'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/client.rb:30:in `run'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/bin/spring:49:in `&lt;top (required)&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `load'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/spring-2.0.2/lib/spring/binstub.rb:31:in `&lt;top (required)&gt;'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n/Users/jairochavez/.rbenv/versions/2.6.3/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n/Users/jairochavez/Documents/Rails/rfdf_bolivia/bin/spring:15:in `&lt;top (required)&gt;'\nbin/rails:3:in `load'\nbin/rails:3:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate =&gt; db:load_config =&gt; environment\n</code></pre>\n\n<p>config/initializers/stripe.rb</p>\n\n<pre><code>Rails.configuration.stripe = { \n  publishable_key: Rails.application.credentials[Rails.env.to_sym][:stripe][:public_key], \n  secret_key:      Rails.application.credentials[Rails.env.to_sym][:stripe][:secret_key] \n} \nStripe.api_key = Rails.configuration.stripe[:secret_key]\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "installation", "sinatra"], "comments": [{"owner": {"reputation": 1529, "user_id": 329443, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/73ce02baf33846daddb1ebeb0c9b0bba?s=128&d=identicon&r=PG", "display_name": "baudot", "link": "https://stackoverflow.com/users/329443/baudot"}, "edited": false, "score": 0, "creation_date": 1560805289, "post_id": 56638067, "comment_id": 99848593, "body": "Note: The full install went off without a hitch on my other computer (an OSX laptop) but the windows desktop I&#39;ve been wrestling with since morning."}, {"owner": {"reputation": 8384, "user_id": 627408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/GO0oW.png?s=128&g=1", "display_name": "kreek", "link": "https://stackoverflow.com/users/627408/kreek"}, "edited": false, "score": 1, "creation_date": 1560818112, "post_id": 56638067, "comment_id": 99851600, "body": "I&#39;m on OS X so not sure about the DLL issues but that tutorial seems a bit old :) The datamapper gem is no longer maintained and has been archived on Github. It&#39;s been replaced with ROM (Ruby Object Mapper) which is quite complex. If you don&#39;t need the datamapper pattern specifically I&#39;d try the sequel gem or activerecord (which can be used with Sinatra independent of Rails)."}, {"owner": {"reputation": 1529, "user_id": 329443, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/73ce02baf33846daddb1ebeb0c9b0bba?s=128&d=identicon&r=PG", "display_name": "baudot", "link": "https://stackoverflow.com/users/329443/baudot"}, "reply_to_user": {"reputation": 8384, "user_id": 627408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/GO0oW.png?s=128&g=1", "display_name": "kreek", "link": "https://stackoverflow.com/users/627408/kreek"}, "edited": false, "score": 0, "creation_date": 1560874043, "post_id": 56638067, "comment_id": 99876184, "body": "@kreek If you want to make that an official answer, to just avoid the DataMapper gem entirely, I&#39;m happy to accept it so you get the credit and this question is there for others to find in the future. I ended up going with the straight &quot;pg&quot; gem and writing raw SQL and now life is good."}], "owner": {"reputation": 1529, "user_id": 329443, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/73ce02baf33846daddb1ebeb0c9b0bba?s=128&d=identicon&r=PG", "display_name": "baudot", "link": "https://stackoverflow.com/users/329443/baudot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560801291, "creation_date": 1560801291, "question_id": 56638067, "link": "https://stackoverflow.com/questions/56638067/ruby-gem-install-failing-to-find-postgres-libraries", "title": "Ruby Gem install failing to find Postgres libraries", "body": "<p>I'm going through the instructions for linking Ruby&amp;Sinatra up to Postgres, as found at: \n<a href=\"http://recipes.sinatrarb.com/p/databases/postgresql-datamapper\" rel=\"nofollow noreferrer\">http://recipes.sinatrarb.com/p/databases/postgresql-datamapper</a>?</p>\n\n<p>The final step of the install is failing, when I attempt to run: </p>\n\n<pre><code>gem install dm-postgres-adapter\n</code></pre>\n\n<p>...and the key part of the error message looks to be these lines:</p>\n\n<pre><code>checking for -lpq... no\nchecking for -llibpq... no\n</code></pre>\n\n<p>I've located libpq.dll &amp; libpq.lib on my drive at:</p>\n\n<pre><code>D:\\Program Files\\PostgreSQL\\11\\lib\n</code></pre>\n\n<p>After poking around looking for pq.dll or pq.lib, I don't see either of those on the drive.</p>\n"}, {"tags": ["ruby", "string", "hash"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 3, "creation_date": 1560802666, "post_id": 56638064, "comment_id": 99847624, "body": "What snag are you hitting, specifically? What have you tried? As an aside, this code would be easier to read\u2014and much easier to maintain\u2014if you didn&#39;t try to put it all in one line. The code for formatting the key (<code>k.split(&#39;_&#39;).map(&amp;:capitalize).join(&#39; &#39;)</code>), for example, should just be its own method."}], "answers": [{"comments": [{"owner": {"reputation": 3692, "user_id": 2102591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/18ebe6ebe65a7aff45e6d09e96af9701?s=128&d=identicon&r=PG", "display_name": "Andrew Schwartz", "link": "https://stackoverflow.com/users/2102591/andrew-schwartz"}, "edited": false, "score": 1, "creation_date": 1560821298, "post_id": 56639707, "comment_id": 99852107, "body": "Suggestion: combine all key maps into a single hash so you can dynamically look them up in a much simpler and <code>nil</code>-safe fashion: <code>all_keymap.dig(k, v)</code>. Loses the ability to specify a default by key, but that wasn&#39;t part of the original spec :-)"}], "tags": [], "owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "is_accepted": true, "score": 1, "last_activity_date": 1560811331, "creation_date": 1560811331, "answer_id": 56639707, "question_id": 56638064, "link": "https://stackoverflow.com/questions/56638064/convert-and-translate-a-ruby-hash-into-a-human-readable-string/56639707#56639707", "title": "Convert and translate a Ruby hash into a human-readable string", "body": "<p>I'd suggest using hashes for mapping out the possible values, e.g.:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>days_ago_filter_map = {\n  \"lt\" =&gt; \"Less than\",\n  # ...other cases here...\n}\n\nmusical_key_map = {\n  3 =&gt; \"D\u266f, E\u266d\",\n  # ...other cases here...\n}\n</code></pre>\n\n<p>Then you can switch on the <code>key</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>variables.map do |key, value| \n  label = \"#{key.split('_').map(&amp;:capitalize).join(' ')}\"\n  formatted_value = case key\n  when \"days_ago_filter\" then days_ago_filter_map.fetch(value)\n  when \"key\" then musical_key_map.fetch(value)\n  else value\n  end\n  \"#{label}: #{formatted_value}\" \nend.join(' - ')\n</code></pre>\n\n<p>Note that if you're missing anything in your maps, the above code will raise <code>KeyNotFound</code> errors. You can set a default in your <code>fetch</code>, e.g.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>days_ago_filter_map.fetch(value, \"Unknown filter\")\nmusical_key_map.fetch(value, \"No notes found for that key\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 5713303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QqzJQ.png?s=128&g=1", "display_name": "Dhanashri Joshi", "link": "https://stackoverflow.com/users/5713303/dhanashri-joshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1562843259, "creation_date": 1562843259, "answer_id": 56987829, "question_id": 56638064, "link": "https://stackoverflow.com/questions/56638064/convert-and-translate-a-ruby-hash-into-a-human-readable-string/56987829#56987829", "title": "Convert and translate a Ruby hash into a human-readable string", "body": "<p>You can create YAML files too for such kind of mappings :</p>\n\n<pre><code>values_for_replacement = {\n  \"lt\" =&gt; \"Less than\",\n3 =&gt; \"D\u266f, E\u266d\"\n}\n</code></pre>\n\n<p>you can try following : </p>\n\n<pre><code>variables.map {|k,v|\nvalue_to_be_replaced = values_for_replacement[v]\n\"#{k.humanize}: #{(value_to_be_replaced.present? ? value_to_be_replaced : v)}\"}.join(' - ')\n</code></pre>\n"}], "owner": {"reputation": 22592, "user_id": 147586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e4f5d494ebdc9e7cce1aecf3ce3e8bc1?s=128&d=identicon&r=PG", "display_name": "Shpigford", "link": "https://stackoverflow.com/users/147586/shpigford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 56639707, "answer_count": 2, "score": 0, "last_activity_date": 1562843259, "creation_date": 1560801287, "question_id": 56638064, "link": "https://stackoverflow.com/questions/56638064/convert-and-translate-a-ruby-hash-into-a-human-readable-string", "title": "Convert and translate a Ruby hash into a human-readable string", "body": "<p>I have the following Ruby hash:</p>\n\n<p><code>{\"limit\"=&gt;250, \"days_ago\"=&gt;14, \"days_ago_filter\"=&gt;\"lt\", \"key\"=&gt;3}</code></p>\n\n<p>I'd like to convert it to a human-readable string and translate some of the values as necessary:</p>\n\n<p><code>Limit: 250 - Days Ago: 14 - Days Ago Filter: Less than - Key: D\u266f, E\u266d</code>,</p>\n\n<p>So <code>lt</code>, in this case, actually translates to <code>Less than</code>. and <code>3</code> for <code>key</code> translates to <code>D\u266f, E\u266d</code>.</p>\n\n<p>I'm almost there with this:</p>\n\n<pre><code>variables.map {|k,v| \"#{k.split('_').map(&amp;:capitalize).join(' ')}: #{v}\"}.join(' - ')\n</code></pre>\n\n<p>But translating those values is where I'm hitting a snag.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "rubygems"], "comments": [{"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 4, "creation_date": 1560790151, "post_id": 56635288, "comment_id": 99842565, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47026174/find-spec-for-exe-cant-find-gem-bundler-0-a-gemgemnotfoundexception\">find_spec_for_exe&#39;: can&#39;t find gem bundler (&gt;= 0.a) (Gem::GemNotFoundException)</a>"}, {"owner": {"reputation": 124, "user_id": 3541824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/617205904/picture?type=large", "display_name": "danielavila", "link": "https://stackoverflow.com/users/3541824/danielavila"}, "edited": false, "score": 0, "creation_date": 1560792555, "post_id": 56635288, "comment_id": 99843553, "body": "Can you post your <code>Gemfile</code> please."}, {"owner": {"reputation": 151, "user_id": 10835772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86598c3f992d5b44f8359852acaa2b12?s=128&d=identicon&r=PG&f=1", "display_name": "homosaurus", "link": "https://stackoverflow.com/users/10835772/homosaurus"}, "reply_to_user": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "edited": false, "score": 0, "creation_date": 1560795945, "post_id": 56635288, "comment_id": 99844846, "body": "@DeepakMahakale I tried <code>gem update --system</code> then <code>bundle install</code>, deleting <code>Gemfile.lock</code>, and <code>gem install bundler -v 2.0.2</code>. None worked, sadly."}, {"owner": {"reputation": 151, "user_id": 10835772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86598c3f992d5b44f8359852acaa2b12?s=128&d=identicon&r=PG&f=1", "display_name": "homosaurus", "link": "https://stackoverflow.com/users/10835772/homosaurus"}, "reply_to_user": {"reputation": 124, "user_id": 3541824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/617205904/picture?type=large", "display_name": "danielavila", "link": "https://stackoverflow.com/users/3541824/danielavila"}, "edited": false, "score": 0, "creation_date": 1560796003, "post_id": 56635288, "comment_id": 99844877, "body": "@danielavila Edited to add <code>Gemfile</code>"}, {"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560808146, "post_id": 56635288, "comment_id": 99849442, "body": "Heroku&#39;s help section has a relevant post <a href=\"https://help.heroku.com/FKWXVZLA/error-parsing-your-gemfile-can-t-find-gem-bundler-0-a\" rel=\"nofollow noreferrer\">help.heroku.com/FKWXVZLA/&hellip;</a>"}, {"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560808686, "post_id": 56635288, "comment_id": 99849582, "body": "Is your app already up on heroku from a previous deploy? If so, you can run <code>heroku run bash</code> to ssh to your heroku machine and run <code>bundle -v</code> to see what version of bundler is installed. Then you can install that specific version of bundler locally and redo the <code>bundle install</code> so your <code>Gemfile.lock</code> reflects that."}, {"owner": {"reputation": 151, "user_id": 10835772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86598c3f992d5b44f8359852acaa2b12?s=128&d=identicon&r=PG&f=1", "display_name": "homosaurus", "link": "https://stackoverflow.com/users/10835772/homosaurus"}, "reply_to_user": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560818988, "post_id": 56635288, "comment_id": 99851753, "body": "@supremebeing7 yes it was already deployed before, I just moved to a new machine and added the remote to it. I did what you said and it still does not work, sadly. I made a new project to see whether the problem was project specific but it was not, I made a brand new rails app and it does not work there as well, and it produced the same error"}, {"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560871319, "post_id": 56635288, "comment_id": 99874730, "body": "I just noticed, heroku is trying to run bundler for a different ruby version: <code>heroku-18&#47;lib&#47;ruby&#47;2.5.0&#47;rubygems.rb:308:in &#39;activate_bin_path&#39;</code>. I think the problem is definitely a version mismatch between your local env and heroku, likely with ruby, bundler, or both."}, {"owner": {"reputation": 943, "user_id": 3477163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5tMQl.jpg?s=128&g=1", "display_name": "supremebeing7", "link": "https://stackoverflow.com/users/3477163/supremebeing7"}, "edited": false, "score": 0, "creation_date": 1560871402, "post_id": 56635288, "comment_id": 99874786, "body": "This might also help <a href=\"https://stackoverflow.com/a/54088849/3477163\">stackoverflow.com/a/54088849/3477163</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11520875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vzO8t.jpg?s=128&g=1", "display_name": "Julien Elkaim", "link": "https://stackoverflow.com/users/11520875/julien-elkaim"}, "is_accepted": false, "score": 2, "last_activity_date": 1561038935, "last_edit_date": 1561038935, "creation_date": 1560989343, "answer_id": 56677403, "question_id": 56635288, "link": "https://stackoverflow.com/questions/56635288/error-parsing-gemfile-when-pushing-to-heroku/56677403#56677403", "title": "Error parsing Gemfile when pushing to Heroku", "body": "<p>The issue here is that Heroku is unable to use the bundle that you are requesting him to use. You can fix it with many solutions while you request Heroku to use a bundle they know (As I know, 2.0.2 does not work).</p>\n\n<p>Opening your Gemfile.lock and at the end of the file replace </p>\n\n<pre><code>BUNDLED WITH\n2.0.2\n</code></pre>\n\n<p>with</p>\n\n<pre><code>BUNDLED WITH\n2.0.1\n</code></pre>\n\n<p>To fix the issue on the long term you can just <code>gem uninstall bundler</code> and then run <code>gem install bundler -v 2.0.1</code></p>\n"}], "owner": {"reputation": 151, "user_id": 10835772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86598c3f992d5b44f8359852acaa2b12?s=128&d=identicon&r=PG&f=1", "display_name": "homosaurus", "link": "https://stackoverflow.com/users/10835772/homosaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561038935, "creation_date": 1560788474, "last_edit_date": 1560795203, "question_id": 56635288, "link": "https://stackoverflow.com/questions/56635288/error-parsing-gemfile-when-pushing-to-heroku", "title": "Error parsing Gemfile when pushing to Heroku", "body": "<p>I have an existing rails app in Heroku and I'm trying to push it there but it gives me this error everytime I try to push to Heroku</p>\n\n<pre><code>There was an error parsing your Gemfile, we cannot continue\nremote:  !     /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/rubygems.rb:289:in `find_spec_for_exe': can't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\nremote:  !     from /app/tmp/buildpacks/b7af5642714be4eddaa5f35e2b4c36176b839b4abcd9bfe57ee71c358d71152b4fd2cf925c5b6e6816adee359c4f0f966b663a7f8649b0729509d510091abc07/vendor/ruby/heroku-18/lib/ruby/2.5.0/rubygems.rb:308:in `activate_bin_path'\nremote:  !     from /tmp/d20190617-88-bonyg7/bundler-2.0.1/bin/bundle:23:in `&lt;main&gt;'\n</code></pre>\n\n<p>From there, what I think stands out the most are: </p>\n\n<pre><code>There was an error parsing your Gemfile, we cannot continue\ncan't find gem bundler (&gt;= 0.a) with executable bundle (Gem::GemNotFoundException)\n\n</code></pre>\n\n<p>My <code>Gemfile.lock</code> states that my app is bundled with <code>2.0.2</code></p>\n\n<p>When I do <code>gem list</code>, bundler part gives me this <code>bundler (default: 2.0.2, default: 1.17.2)</code></p>\n\n<p>Any help is appreciated! Thanks!</p>\n\n<p>EDIT:\nHere is my Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\nruby '2.6.3'\n\ngem 'bootsnap', require: false\ngem 'devise'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'pg', '~&gt; 0.21'\ngem 'puma'\ngem 'rails', '5.2.3'\ngem 'redis'\n\ngem 'autoprefixer-rails'\ngem 'font-awesome-sass', '~&gt; 5.6.1'\ngem 'sassc-rails'\ngem 'simple_form'\ngem 'uglifier'\ngem 'webpacker'\ngem 'bundler'\n\ngem 'material-sass', '4.1.1'\n\ngem 'cloudinary'\ngem 'carrierwave'\n\ngroup :development do\n  gem 'web-console', '&gt;= 3.3.0'\nend\n\ngroup :development, :test do\n  gem 'pry-byebug'\n  gem 'pry-rails'\n  gem 'listen', '~&gt; 3.0.5'\n  gem 'spring'\n  gem 'spring-watcher-listen', '~&gt; 2.0.0'\n  gem 'dotenv-rails'\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560792191, "post_id": 56634950, "comment_id": 99843401, "body": "Do you mean, &quot;given, <code>:first</code>, <code>:second</code> and <code>[1,2,3,4]</code>, how can I create a hash <code>{ :first=&gt;{:second=&gt;[1,2,3,4] } }</code>&quot;? If so, that has nothing to do with <code>dig</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560871018, "post_id": 56634950, "comment_id": 99874541, "body": "In case you missed it, I asked you a question."}], "answers": [{"tags": [], "owner": {"reputation": 3327, "user_id": 2121499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/402a94a6a5d06a560185f3b6d693a5db?s=128&d=identicon&r=PG", "display_name": "Uelb", "link": "https://stackoverflow.com/users/2121499/uelb"}, "is_accepted": false, "score": 3, "last_activity_date": 1560787371, "creation_date": 1560787371, "answer_id": 56635031, "question_id": 56634950, "link": "https://stackoverflow.com/questions/56634950/ruby-dig-set-assign-values-using-hashdig/56635031#56635031", "title": "Ruby dig set - Assign values using Hash#dig", "body": "<p>dig cannot be used to assign a value to a Hash, this method has been built only for accessing a value.</p>\n\n<p>For your case, you can do one of both things :</p>\n\n<pre><code>hash = { first: { second: [1, 2, 3, 4] } }\n</code></pre>\n\n<p>Or :</p>\n\n<pre><code>hash[:first] = { second: [1, 2, 3, 4] }\n</code></pre>\n\n<p>You can also use the approach in that post : <a href=\"https://stackoverflow.com/questions/41639364/how-to-set-dynamically-value-of-nested-key-in-ruby-hash\">How to set dynamically value of nested key in Ruby hash</a></p>\n\n<p>They create a new hash method to dynamically assign nested values to a Hash.</p>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 2, "creation_date": 1560794354, "post_id": 56635124, "comment_id": 99844241, "body": "<code>Hash.new { |h,k| h[k] = Hash.new(&amp;h.default_proc) }</code> lets you define nested keys indefinitely, not just at the first 2 levels"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1560801218, "post_id": 56635124, "comment_id": 99846975, "body": "Attaching a default proc to the hash has consequences that must be recognised. For example, one cannot execute <code>hash[:cat].nil?</code> to determine whether hash has a key <code>:cat</code>, for <code>hash[:cat] #=&gt; {}</code>. (Of course one could use <code>hash.key?(:cat) #=&gt; false</code>, which is good practice anyway.). Another example is <code>hash[:fisrt][:second] == [1,2,3,4] #=&gt; false</code>, masking the fact that I&#39;ve misspelled <code>:first</code>. Without the default proc an exception would be raised. My preference would be to avoid having the default proc once the hash has been constructed, but of course it cannot be simply removed."}, {"owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "edited": false, "score": 0, "creation_date": 1560835444, "post_id": 56635124, "comment_id": 99854808, "body": "Thanks for the input, guys. I&#39;ve edited my answer accordingly."}], "tags": [], "owner": {"reputation": 8462, "user_id": 405865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e29f04f339715955060858e0e65e1311?s=128&d=identicon&r=PG", "display_name": "fphilipe", "link": "https://stackoverflow.com/users/405865/fphilipe"}, "is_accepted": false, "score": 6, "last_activity_date": 1560835390, "last_edit_date": 1560835390, "creation_date": 1560787765, "answer_id": 56635124, "question_id": 56634950, "link": "https://stackoverflow.com/questions/56634950/ruby-dig-set-assign-values-using-hashdig/56635124#56635124", "title": "Ruby dig set - Assign values using Hash#dig", "body": "<p>You can create a hash that behaves like what you want. <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-c-new\" rel=\"noreferrer\"><code>Hash.new</code></a> takes a block which is invoked whenever a key lookup fails. We can create an empty hash when that happens:</p>\n\n<pre><code>hash = Hash.new { |hash, key| hash[key] = Hash.new(&amp;hash.default_proc) }\n\nhash[:first][:second] = [1, 2, 3, 4]\n\nhash # =&gt; {:first=&gt;{:second=&gt;[1, 2, 3, 4]}}\n</code></pre>\n\n<p>Note though that merely accessing an inexistent key will result in the creation of a new hash:</p>\n\n<pre><code>hash.dig(:a, :b, :c) # =&gt; {}\n\nhash # =&gt; {:first=&gt;{:second=&gt;[1, 2, 3, 4]}, :a=&gt;{:b=&gt;{:c=&gt;{}}}}\n\nhash[:foo].nil? # =&gt; false\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1560794260, "post_id": 56636098, "comment_id": 99844198, "body": "this was proposed to and rejected from ruby core in the form of <code>Hash#bury</code> .. <a href=\"https://bugs.ruby-lang.org/issues/11747\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/11747</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1560794459, "post_id": 56636098, "comment_id": 99844270, "body": "also, it&#39;d probably be good if your <code>undig</code> method here could be called on an existing hash"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560845274, "post_id": 56636098, "comment_id": 99859166, "body": "<code>dig</code> isn&#39;t limited to hashes, it can also retrieve values from arrays (or mixed hash-array structures). <code>undig</code> should probably work likewise."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560871627, "post_id": 56636098, "comment_id": 99874901, "body": "@Stefan, see my first sentence. If the OP is moved to answer my question, we will know more. Perhaps <code>undig</code> was a poor choice for the name of my method. Btw, you forgot <a href=\"https://ruby-doc.org/stdlib-2.5.1/libdoc/ostruct/rdoc/OpenStruct.html#method-i-dig\" rel=\"nofollow noreferrer\">OpenStruct#dig</a>."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 4, "last_activity_date": 1560795616, "last_edit_date": 1560795616, "creation_date": 1560791970, "answer_id": 56636098, "question_id": 56634950, "link": "https://stackoverflow.com/questions/56634950/ruby-dig-set-assign-values-using-hashdig/56636098#56636098", "title": "Ruby dig set - Assign values using Hash#dig", "body": "<p>I've assumed that the answer to the question I raised in a comment on the question is \"yes\".</p>\n\n<p>One could use <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-reduce\" rel=\"nofollow noreferrer\">Enumerable#reduce</a> (a.k.a. <code>inject</code>):</p>\n\n<pre><code>def undig(*keys, value)\n  keys[0..-2].reverse_each.reduce (keys.last=&gt;value) { |h,key| { key=&gt;h } }   \nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>undig(:first, :second, [1,2,3,4])\n  #=&gt; {:first=&gt;{:second=&gt;[1, 2, 3, 4]}} \n</code></pre>\n\n<p>or recursion:</p>\n\n<pre><code>def undig(*keys, value)\n  keys.empty? ? value : { keys.first=&gt;undig(*keys.drop(1), value) }\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>undig(:first, :second, [1,2,3,4])\n  #=&gt; {:first=&gt;{:second=&gt;[1, 2, 3, 4]}} \n</code></pre>\n"}], "owner": {"reputation": 6478, "user_id": 946478, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/734044a1d5aa692f00c28b6999bd0240?s=128&d=identicon&r=PG", "display_name": "sparkle", "link": "https://stackoverflow.com/users/946478/sparkle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1686, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1560835390, "creation_date": 1560787057, "last_edit_date": 1560787902, "question_id": 56634950, "link": "https://stackoverflow.com/questions/56634950/ruby-dig-set-assign-values-using-hashdig", "title": "Ruby dig set - Assign values using Hash#dig", "body": "<p>Basically I want to assign an array using\u00a0<code>#dig</code>.</p>\n\n<p>My has has to be like this:</p>\n\n<pre><code>hash = {\n   :first =&gt; {\n      :second =&gt;\u00a0[1,2,3,4]\n  }\n}\n</code></pre>\n\n<p>and I would use <code>Hash#dig</code></p>\n\n<pre><code>hash.dig(:first, :second) = [1,2,3,4]\n</code></pre>\n\n<p>How can I assign this value?</p>\n"}, {"tags": ["ruby", "enumerable"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560797603, "post_id": 56634513, "comment_id": 99845543, "body": "Why do you prefer the selected answer, which requires one pass though the array and one pass through the mapped array, and creates a temporary array,  to @Draco&#39;s answer, which requires a single pass and does not create a temporary array?"}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 0, "creation_date": 1560785986, "post_id": 56634540, "comment_id": 99840817, "body": "Haven&#39;t thought about it. It does solve it in one line but it iterates twice instead of only once."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 2, "creation_date": 1560786085, "post_id": 56634540, "comment_id": 99840868, "body": "@Akra Yes, it does, but since your data needs conversion anyway, no matter what you&#39;re going to be doing multiple operations on each element. The question is when."}], "tags": [], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1560786097, "last_edit_date": 1560786097, "creation_date": 1560785628, "answer_id": 56634540, "question_id": 56634513, "link": "https://stackoverflow.com/questions/56634513/map-method-with-mutated-iterator/56634540#56634540", "title": "map method with mutated iterator", "body": "<p>Why not chain <code>map</code>s, especially with a <a href=\"https://ruby-doc.org/core-2.6.3/Symbol.html#method-i-to_proc\" rel=\"nofollow noreferrer\">shorthand syntax via <code>Symbol#to_proc</code></a>?</p>\n\n<pre><code>object_array.map(&amp;:to_s).map(&amp;:dostringstuff)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 0, "creation_date": 1560785918, "post_id": 56634600, "comment_id": 99840781, "body": "Assume I have to do several string related operations, so it will result in something in the sort of o.to_s[o.to_s.index(someindex)..o.to_s.rindex(otherindex)] if s.to_s.match(someexpression)"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "edited": false, "score": 4, "creation_date": 1560786009, "post_id": 56634600, "comment_id": 99840824, "body": "@Akra Then your data is wrong; you should be mapping it once it&#39;s the way you want it since the mapping is the &quot;dominant&quot; operation, and data conversion is just auxiliary work so you can do what you actually want to it."}, {"owner": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "edited": false, "score": 1, "creation_date": 1560786010, "post_id": 56634600, "comment_id": 99840825, "body": "Then <code>object_array.map(&amp;:to_s)</code> first as @BrightOne suggested"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560802127, "post_id": 56634600, "comment_id": 99847376, "body": "Akra, you question is clear. Your comment pertains to a different question. This answer is the most direct and economical way to obtain the desired result. If you have another question, submit it separately."}], "tags": [], "owner": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "is_accepted": false, "score": 3, "last_activity_date": 1560785794, "creation_date": 1560785794, "answer_id": 56634600, "question_id": 56634513, "link": "https://stackoverflow.com/questions/56634513/map-method-with-mutated-iterator/56634600#56634600", "title": "map method with mutated iterator", "body": "<p>What's wrong with:</p>\n\n<pre><code>object_array.map{|o| o.to_s.dostringstuff }\n</code></pre>\n\n<p>?</p>\n"}], "owner": {"reputation": 265, "user_id": 5786832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b790af396e72c6e20b53794a2a4960b0?s=128&d=identicon&r=PG&f=1", "display_name": "Akra", "link": "https://stackoverflow.com/users/5786832/akra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56634540, "answer_count": 2, "score": 3, "last_activity_date": 1560786097, "creation_date": 1560785539, "question_id": 56634513, "link": "https://stackoverflow.com/questions/56634513/map-method-with-mutated-iterator", "title": "map method with mutated iterator", "body": "<p>I have an array of objects I want to iterate through with map-</p>\n\n<pre><code>object_array.map {|o| o.dostuff }\n</code></pre>\n\n<p>But I want o iterator to be a string representation of the object, so I have to do something like this-</p>\n\n<pre><code>object_array.map do |o|\n  o = o.to_s\n  o.dostringstuff\nend\n</code></pre>\n\n<p>Is there any way to do it in one line? (intrepreter doesn't accept this)</p>\n\n<pre><code>object_array.map {|o.to_s| o.dostringstuff }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1560785400, "creation_date": 1560785400, "answer_id": 56634473, "question_id": 56634383, "link": "https://stackoverflow.com/questions/56634383/when-running-rails-s-after-switching-from-my-server-to-my-employers-server-i-am/56634473#56634473", "title": "when running rails s after switching from my server to my employers server, I am getting these errors:", "body": "<p>It says that <code>bundler</code> library cannot be found. Try running <code>gem install bundler</code> to install <a href=\"https://bundler.io\" rel=\"nofollow noreferrer\">Bundler</a>, then <code>bundle install</code> to get your dependencies.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 6336246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rh608.png?s=128&g=1", "display_name": "Gerardo S", "link": "https://stackoverflow.com/users/6336246/gerardo-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1560793001, "creation_date": 1560793001, "answer_id": 56636311, "question_id": 56634383, "link": "https://stackoverflow.com/questions/56634383/when-running-rails-s-after-switching-from-my-server-to-my-employers-server-i-am/56636311#56636311", "title": "when running rails s after switching from my server to my employers server, I am getting these errors:", "body": "<blockquote>\n  <p>What could be causing this?</p>\n</blockquote>\n\n<p>Bundler is not found, but it could also be spring. You can try to stop spring with </p>\n\n<pre><code>bin/spring stop\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1560793001, "creation_date": 1560785103, "last_edit_date": 1560790477, "question_id": 56634383, "link": "https://stackoverflow.com/questions/56634383/when-running-rails-s-after-switching-from-my-server-to-my-employers-server-i-am", "title": "when running rails s after switching from my server to my employers server, I am getting these errors:", "body": "<p><code>rails s</code> worked on my server and after switching servers, I got this error when running <code>rails s</code>. What could be causing this?</p>\n\n<pre><code>Traceback (most recent call last):       \n4: from bin/rails:3:in `&lt;main&gt;' \n3: from bin/rails:3:in `load'                     \n2: from /home/directoryName1/directoryName2/directoryName3/bin/spring:8:in `&lt;top (required)&gt;' \n1: from /usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require' /usr/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require': cannot load such file -- bundler (LoadError)\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1560788331, "post_id": 56633912, "comment_id": 99841894, "body": "&quot;it doesn&#39;t work&quot; is not a precise enough error description for us to help you. <i>What</i> doesn&#39;t work? <i>How</i> doesn&#39;t it work? What trouble do you have with your code? Do you get an error message? What is the error message? Is the result you are getting not the result you are expecting? What result do you expect and why, what is the result you are getting and how do the two differ? Is the behavior you are observing not the desired behavior? What is the desired behavior and why, what is the observed behavior, and in what way do they differ?"}, {"owner": {"reputation": 13, "user_id": 11659650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785e88a36367ba42dc3c90bf9350e39f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Ponti", "link": "https://stackoverflow.com/users/11659650/dan-ponti"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560789165, "post_id": 56633912, "comment_id": 99842196, "body": "You are right. My apologies for not providing more detail- this was my first post."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560802895, "post_id": 56633912, "comment_id": 99847724, "body": "To highlight code as you see in other questions, do the following. If the code is within text, surround it with backticks (&quot;...because the method `zombie` returns...&quot;, which appears as &quot;...because the method <code>zombie</code> returns...&quot;). To highlight and indent a block of code, either indent it four spaces or select it and click on the icon <code>{}</code> above the edit box. Try it by editing your question now. To add to J&#246;rg&#39;s comment, if an exception is raised tell us the line in which the error occurred, which is part of the error message."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1560821939, "post_id": 56633912, "comment_id": 99852218, "body": "This sounds like a homework question. If so, I&#39;d recommend reading &quot;<a href=\"https://meta.stackoverflow.com/q/334822/128421\">How do I ask and answer homework questions?</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11659650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785e88a36367ba42dc3c90bf9350e39f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Ponti", "link": "https://stackoverflow.com/users/11659650/dan-ponti"}, "edited": false, "score": 0, "creation_date": 1560789225, "post_id": 56634156, "comment_id": 99842218, "body": "Thank you! This was very helpful. I am new to coding, so I was just unaware of some of the syntax"}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "reply_to_user": {"reputation": 13, "user_id": 11659650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785e88a36367ba42dc3c90bf9350e39f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Ponti", "link": "https://stackoverflow.com/users/11659650/dan-ponti"}, "edited": false, "score": 0, "creation_date": 1560840676, "post_id": 56634156, "comment_id": 99856748, "body": "You&#39;re welcome :)  If you need to do/learn things with arrays take a look to the Ruby documentation :  - <a href=\"http://ruby-doc.org/core-2.6.3/Enumerable.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.3/Enumerable.html</a> - <a href=\"http://ruby-doc.org/core-2.6.3/Array.html\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.6.3/Array.html</a>  It contain a lot of core method that can help you (with a lot of example as well)."}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": true, "score": 2, "last_activity_date": 1560822357, "last_edit_date": 1560822357, "creation_date": 1560784356, "answer_id": 56634156, "question_id": 56633912, "link": "https://stackoverflow.com/questions/56633912/how-to-read-an-array-of-strings-and-return-strings-without-a-new-array/56634156#56634156", "title": "How to read an array of strings and return strings without a new array", "body": "<p>Your question is a bit unclear but I'll try to anwser.</p>\n\n<p>To select word<strong>s</strong> that are less than 6 caracters or (exclusively) end with \"y\" you can use this function:</p>\n\n<pre><code>def select_long_words(words)\n  words.select do |word|\n    is_less_than_6 = word.size &lt; 6\n    ends_with_y = word.end_with?('y')\n    # Select only if one of the two condition is respected, not both or none\n    next is_less_than_6 ^ ends_with_y\n  end\nend\n</code></pre>\n\n<p>In this function I used the <code>select</code> function from Array that stands for \"select every element that corresponds to the given criteria\" and I set the criteria to \"less than 6 characters or ends with 'y' but not both\" using <code>^</code> which mean xor for booleans.</p>\n\n<p>If you want only one word you can call your function like this:</p>\n\n<pre><code>select_long_words([\"whatever\", \"are\", \"butterfly\", \"wit\", \"foreward\", \"funny\"]).first\n</code></pre>\n\n<p>It'll return nil if there's no correspondancies, or the first word that corresponds. You can replace <code>select</code> with <code>find</code> in the method to get the first result directly.</p>\n"}], "owner": {"reputation": 13, "user_id": 11659650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/785e88a36367ba42dc3c90bf9350e39f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Ponti", "link": "https://stackoverflow.com/users/11659650/dan-ponti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56634156, "answer_count": 1, "score": 0, "last_activity_date": 1560822357, "creation_date": 1560783453, "last_edit_date": 1560821874, "question_id": 56633912, "link": "https://stackoverflow.com/questions/56633912/how-to-read-an-array-of-strings-and-return-strings-without-a-new-array", "title": "How to read an array of strings and return strings without a new array", "body": "<p>I am trying to write code that takes in an array of strings and returns the strings that are either less than 6 or end in \"y\", but not both.</p>\n\n<p>The problem does not want a new array returned. I wrote code that works if I were to return a new array of strings that fit the conditions, but if I try to return just the strings and not an array, it doesn't work.</p>\n\n<pre><code># frozen_string_literal: true\n\ndef select_long_words(words)\n  str = []\n\n  i = 0\n\n  while i &lt; words.length\n\n    word = words[i]\n\n    if (word.length &lt; 6 || word[-1] == 'y') &amp;&amp; !(word.length &lt; 6 &amp;&amp; word[-1] == 'y')\n\n      str &lt;&lt; word\n\n    end\n\n    i += 1\n\n  end\n\n  str\nend\n\nprint select_long_words(%w[whatever are butterfly wit foreward funny])\n\nputs\n\nprint select_long_words(%w[keepers cody])\n</code></pre>\n\n<p>This is the code that returns the new array of strings that fit the conditions.</p>\n"}, {"tags": ["ruby", "symbols", "legacy"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1560779762, "post_id": 56632779, "comment_id": 99837428, "body": "why not use strings always then?"}, {"owner": {"reputation": 46136, "user_id": 3890632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNkgF.png?s=128&g=1", "display_name": "khelwood", "link": "https://stackoverflow.com/users/3890632/khelwood"}, "edited": false, "score": 8, "creation_date": 1560779842, "post_id": 56632779, "comment_id": 99837470, "body": "<code>:foo</code> and <code>:&quot;foo&quot;</code> are identical. If you want to distinguish characters that will need to be escaped, that&#39;s one thing, but you&#39;re not going to be able to distinguish <code>:foo</code> and <code>:&quot;foo&quot;</code>."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1560780217, "post_id": 56632779, "comment_id": 99837660, "body": "Well, <code>if sym.inspect[1] == &#39;&quot;&#39;</code> obviously would work, but you shouldn&#39;t do it in the first place."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560780525, "post_id": 56632779, "comment_id": 99837809, "body": "@Stefan: that would give false positives. <code>:&quot;foo bar&quot;</code>, for example."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1560780586, "post_id": 56632779, "comment_id": 99837848, "body": "@SergioTulentsev why is that a false positive?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 4, "creation_date": 1560781179, "post_id": 56632779, "comment_id": 99838182, "body": "This question screams &quot;<i>AB problem!</i>&quot; to me. There is no such thing as a &quot;quoted symbol&quot; in ruby; it&#39;s purely a means of displaying the value clearly in your terminal; similar to how <code>\\n</code> gets displayed in place of invisible whitespace. <b>Why</b> do you want to check if the symbol contains a space? What problem are you actually trying to solve?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560781354, "post_id": 56632779, "comment_id": 99838276, "body": "@Stefan: because no escaped chars?"}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560781598, "post_id": 56632779, "comment_id": 99838416, "body": "@TomLord it&#39;s more about increasing my understanding than solving a specific problem, really."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560782855, "post_id": 56632779, "comment_id": 99839131, "body": "@MaxWilliams A symbol can contain any characters. However, it wouldn&#39;t make sense to define a symbol as <code>:foo bar</code> -- since that syntax appears to mean <code>:foo</code>, followed by a variable/method <code>bar</code>. Therefore one must declare the symbol as <code>:&quot;foo bar&quot;</code>, or <code>&quot;foo bar&quot;.to_sym</code>. That&#39;s all. <code>:foo</code> and <code>:&quot;foo&quot;</code> are literally the same object."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560783205, "post_id": 56632779, "comment_id": 99839313, "body": "@SergioTulentsev of course, <code>sym.inspect[1] == &#39;&quot;&#39;</code> doesn&#39;t check for escaped characters. It merely checks whether that symbol needs to be quoted when given as a literal."}], "answers": [{"comments": [{"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1560853001, "post_id": 56633652, "comment_id": 99863426, "body": "That makes sense, thanks.  Is there an inbuilt way to test if a string is allowable as a method name?  Because if so then I could use that.  Obviously I could write a regex to do it but i&#39;d rather use something inbuilt if possible."}, {"owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 0, "creation_date": 1560853108, "post_id": 56633652, "comment_id": 99863489, "body": "This question asks the same thing (variable name, not method name, but I think the rules are the same), and the test is to basically try to use it as a variable name and if it explodes, then you catch it and decide it&#39;s not valid.  Feels a bit not-clean."}, {"owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "reply_to_user": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "edited": false, "score": 1, "creation_date": 1560927962, "post_id": 56633652, "comment_id": 99892537, "body": "If you wan&#39;t to keep you code clean, don&#39;t mix and match types. Symbols and strings have different jobs to fulfil. I recommend taking a look at: <a href=\"https://stackoverflow.com/questions/16621073/when-to-use-symbols-instead-of-strings-in-ruby\">When to use symbols instead of strings in Ruby?</a>. If you still for some reason want to check if the representation of the symbol would be quoted have a look at <a href=\"https://stackoverflow.com/questions/56632779/how-in-ruby-1-8-6-to-differentiate-between-regular-symbols-and-quoted-symbol/56633652?noredirect=1#comment99837660_56632779\">Stefan&#39;s comment</a>."}], "tags": [], "owner": {"reputation": 13442, "user_id": 3982562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a3c7aae1d762372cda697833c602ec8?s=128&d=identicon&r=PG", "display_name": "3limin4t0r", "link": "https://stackoverflow.com/users/3982562/3limin4t0r"}, "is_accepted": false, "score": 0, "last_activity_date": 1560782662, "creation_date": 1560782662, "answer_id": 56633652, "question_id": 56632779, "link": "https://stackoverflow.com/questions/56632779/how-in-ruby-1-8-6-to-differentiate-between-regular-symbols-and-quoted-symbol/56633652#56633652", "title": "How, in Ruby 1.8.6, to differentiate between regular symbols and &quot;quoted&quot; symbols?", "body": "<p>Like <a href=\"https://stackoverflow.com/questions/56632779/how-in-ruby-1-8-6-to-differentiate-between-regular-symbols-and-quoted-symbol#comment99837470_56632779\">khelwood said in the comments</a> symbols with or without quotes are identical.</p>\n\n<pre><code>:foo == :\"foo\" #=&gt; true\n</code></pre>\n\n<p>The reason Ruby displays some symbols with and other symbols without quotes is due to their content. Symbols that are conform the <a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/methods_rdoc.html#label-Method+Names\" rel=\"nofollow noreferrer\">standards of methods names</a> will be displayed without quotes, while symbols that don't conform to the format are displayed with quotes.</p>\n\n<p>Meaning that:</p>\n\n<pre><code># operators are displayed without quotes\n:\"&gt;&gt;\" #=&gt; :&gt;&gt;\n# snake case naming will be displayed without quotes\n:\"foo_bar\" #=&gt; :foo_bar\n\n# symbols starting with a number will be displayed with quotes\n:\"8bit\" #=&gt; :\"8bit\"\n# symbols with certain characters will be displayed as quoted\n:\"foo-bar\" #=&gt; :\"foo-bar\"\n:\"foo bar\" #=&gt; :\"foo bar\"\n:\"null_byte_\\0\" #=&gt; :\"null_byte_\\x00\"\n</code></pre>\n\n<blockquote>\n  <h2><a href=\"http://ruby-doc.org/core-2.6.3/Method.html\" rel=\"nofollow noreferrer\">Method</a> Names<a href=\"http://ruby-doc.org/core-2.6.3/doc/syntax/methods_rdoc.html#label-Method+Names\" rel=\"nofollow noreferrer\">\u00b6</a></h2>\n  \n  <p><a href=\"http://ruby-doc.org/core-2.6.3/Method.html\" rel=\"nofollow noreferrer\">Method</a> names may be one of the operators or must start a letter or a character with the eight bit set. It may contain letters, numbers, an <code>_</code> (underscore or low line) or a character with the eight bit set. The convention is to use underscores to separate words in a multiword method name:</p>\n\n<pre><code>def method_name\n  puts \"use underscores to separate words\"\nend\n</code></pre>\n  \n  <p>Ruby programs must be written in a US-ASCII-compatible character set such as UTF-8, ISO-8859-1 etc. In such character sets if the eight bit is set it indicates an extended character. Ruby allows method names and other identifiers to contain such characters. Ruby programs cannot contain some characters like ASCII NUL (<code>\\x00</code>).</p>\n  \n  <p>The following are examples of valid Ruby methods:</p>\n\n<pre><code>def hello\n  \"hello\"\nend\n\ndef \u3053\u3093\u306b\u3061\u306f\n  puts \"means hello in Japanese\"\nend\n</code></pre>\n  \n  <p>Typically method names are US-ASCII compatible since the keys to type them exist on all keyboards.</p>\n  \n  <p><a href=\"http://ruby-doc.org/core-2.6.3/Method.html\" rel=\"nofollow noreferrer\">Method</a> names may end with a <code>!</code> (bang or exclamation mark), a <code>?</code> (question mark), or <code>=</code> (equals sign).</p>\n</blockquote>\n"}], "owner": {"reputation": 30655, "user_id": 138557, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/73c04e9ef9ca435c5b19a2e765ae6d20?s=128&d=identicon&r=PG", "display_name": "Max Williams", "link": "https://stackoverflow.com/users/138557/max-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560782662, "creation_date": 1560779620, "question_id": 56632779, "link": "https://stackoverflow.com/questions/56632779/how-in-ruby-1-8-6-to-differentiate-between-regular-symbols-and-quoted-symbol", "title": "How, in Ruby 1.8.6, to differentiate between regular symbols and &quot;quoted&quot; symbols?", "body": "<p>eg, <code>:\"foo\"</code> vs <code>:foo</code>.</p>\n\n<p>More specifically, if I have a string like <code>\"Clarinet (B\u266d)\"</code>, and I call <code>.to_sym</code> on it, I get a quoted symbol, with escaped chars: <code>:\"Clarinet (B\\342\\231\\255)\"</code>.  In this instance, I would like to use the string version of it rather than the symbol version, as a hash key.  More generally, if I get <strong>any</strong> quoted symbol, I want to not use the symbol at all and just use the original string.</p>\n\n<p>eg</p>\n\n<pre><code>ahash = {}\ns = \"Clarinet (B\u266d)\"\nsym = s.to_sym\nif some_test_for_quoted_symbols\n  ahash[sym] = \"foo\"\nelse\n  ahash[s] = \"foo\"\nend\n</code></pre>\n\n<p>Does anyone know how I can distinguish between symbols with or without quotes?  Thanks</p>\n\n<p>PS please don't tell me I shouldn't be using such an old version of Ruby.  thanks!</p>\n"}, {"tags": ["ruby", "file"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1560782543, "post_id": 56632460, "comment_id": 99838974, "body": "That heap-related code looks irrelevant."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1560782494, "post_id": 56632810, "comment_id": 99838953, "body": "Slurping files is a dangerous habit :)"}, {"owner": {"reputation": 39, "user_id": 10763733, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yFyfD9FBC64/AAAAAAAAAAI/AAAAAAAAAFc/vs30y3HJt_Y/photo.jpg?sz=128", "display_name": "Nikita Makovey", "link": "https://stackoverflow.com/users/10763733/nikita-makovey"}, "edited": false, "score": 0, "creation_date": 1560819890, "post_id": 56632810, "comment_id": 99851877, "body": "This solution is not for my task because i don&#39;t need array -&gt; ONLY DYNAMIC WORK"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1560849485, "post_id": 56632810, "comment_id": 99861346, "body": "you have not explained what you actually need help with. What do you even mean by &quot;dynamic work&quot;?"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1560779733, "creation_date": 1560779733, "answer_id": 56632810, "question_id": 56632460, "link": "https://stackoverflow.com/questions/56632460/how-to-read-by-the-number-at-each-iteration-of-the-loop-in-ruby/56632810#56632810", "title": "How to read by the number at each iteration of the loop in Ruby?", "body": "<p>Read the 2nd line of a file:</p>\n\n<pre><code>line2 =  File.readlines('input.txt')[1]\n</code></pre>\n\n<p>Convert it to an array of integers:</p>\n\n<pre><code>array = line2.split(' ').map(&amp;:to_i).compact\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": true, "score": 0, "last_activity_date": 1560842512, "creation_date": 1560842512, "answer_id": 56643730, "question_id": 56632460, "link": "https://stackoverflow.com/questions/56632460/how-to-read-by-the-number-at-each-iteration-of-the-loop-in-ruby/56643730#56643730", "title": "How to read by the number at each iteration of the loop in Ruby?", "body": "<p>If you're 100% sure that your file separate numbers by space you can try this :</p>\n\n<pre><code>a = fin.gets(' ', -1).to_i\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10763733, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yFyfD9FBC64/AAAAAAAAAAI/AAAAAAAAAFc/vs30y3HJt_Y/photo.jpg?sz=128", "display_name": "Nikita Makovey", "link": "https://stackoverflow.com/users/10763733/nikita-makovey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56643730, "answer_count": 2, "score": 0, "last_activity_date": 1560842512, "creation_date": 1560778514, "question_id": 56632460, "link": "https://stackoverflow.com/questions/56632460/how-to-read-by-the-number-at-each-iteration-of-the-loop-in-ruby", "title": "How to read by the number at each iteration of the loop in Ruby?", "body": "<p>How to read by the number at each iteration of the loop? Dynamic work is important, (not once to read the entire line and convert to an array), at each iteration, take one number from the file string and work with it. How to do it right?</p>\n\n<p>input.txt : </p>\n\n<pre><code>5\n1 7 5 2 3 \n</code></pre>\n\n<p>Work with 2nd line of the file.</p>\n\n<pre><code>fin     = File.open(\"input.txt\", \"r\")\nfout    = File.open(\"output.txt\", \"w\")\nn       = fin.readline.to_i\n\nheap_min = Heap.new(:min)\nheap_max = Heap.new(:max)\n\nfor i in 1..n\n\n    a = fin.read.to_i #code here &lt;-- \n\n    heap_max.push(a)\n    if heap_max.size &gt; heap_min.size\n        tmp = heap_max.top\n        heap_max.pop\n        heap_min.push(tmp)\n    end \n    if heap_min.size &gt; heap_max.size\n        tmp = heap_min.top\n        heap_min.pop\n        heap_max.push(tmp)\n    end \n    if heap_max.size == heap_min.size\n        heap_max.top &gt; heap_min.top ? median = heap_min.top : median = heap_max.top\n    else\n        median = heap_max.top\n    end\n    fout.print(median, \" \")\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 1602, "user_id": 880498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbd8a4259431a73e23a5b860196694a0?s=128&d=identicon&r=PG", "display_name": "rogercampos", "link": "https://stackoverflow.com/users/880498/rogercampos"}, "edited": false, "score": 2, "creation_date": 1560888411, "post_id": 56632947, "comment_id": 99882572, "body": "In recent rubies you can use <code>Hash#to_h</code> instead of <code>Hash#[]</code> which is somewhat more semantic, <code>[[:a, 3]].to_h # -&gt; {:a=&gt;3} </code>"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 2, "last_activity_date": 1560780196, "creation_date": 1560780196, "answer_id": 56632947, "question_id": 56632311, "link": "https://stackoverflow.com/questions/56632311/convert-active-record-object-into-hash/56632947#56632947", "title": "Convert Active Record Object into Hash", "body": "<p>You can get it from below query,</p>\n\n<pre><code>Hash[Person.all.collect { |user| [user.email, user.attributes.except(:email).values] }]\n</code></pre>\n\n<p>If you want to omit other attributes like <code>created_at</code> &amp; <code>updated_at</code>, run</p>\n\n<pre><code>Hash[Person.all.collect { |user| [user.email, user.attributes.except(:email, :created_at, :updated_at).values] }]\n</code></pre>\n"}], "owner": {"reputation": 1240, "user_id": 10352322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bd96ce59b1dac8eae18ff8458c6b5bb?s=128&d=identicon&r=PG&f=1", "display_name": "a_k_v", "link": "https://stackoverflow.com/users/10352322/a-k-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 56632947, "answer_count": 1, "score": 0, "last_activity_date": 1560780315, "creation_date": 1560777957, "last_edit_date": 1560780315, "question_id": 56632311, "link": "https://stackoverflow.com/questions/56632311/convert-active-record-object-into-hash", "title": "Convert Active Record Object into Hash", "body": "<p>I have a model Person with fields email, name, age, phone_number. I want to convert <code>Person.all</code> to a hash.\nThe hash should have the structure as follows:</p>\n\n<pre><code>{\n\"email1\" =&gt; [\"name\", \"age\", \"phone_number\"],\n\"email2\" =&gt; [\"name2\", \"age2\", \"phone_number2\"]\n....\n}\n</code></pre>\n\n<p>I tried <code>as_json</code>, <code>map</code> or <code>attributes</code> etc. But it returns array of hashes. How can I create this custom structure?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1560776507, "post_id": 56631728, "comment_id": 99835546, "body": "What&#39;s the rendered HTML? Seems like a path issue."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11150905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igbJVMRvj34/AAAAAAAAAAI/AAAAAAAAJZg/5txWo-KNg2w/photo.jpg?sz=128", "display_name": "Remy Au", "link": "https://stackoverflow.com/users/11150905/remy-au"}, "edited": false, "score": 0, "creation_date": 1560780365, "post_id": 56631929, "comment_id": 99837727, "body": "Hi, thanks for the quick answer. what do you mean by <i>Submit action handled by your StaticsController#index action instead of SubscribersController#create.</i>?"}, {"owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "reply_to_user": {"reputation": 23, "user_id": 11150905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igbJVMRvj34/AAAAAAAAAAI/AAAAAAAAJZg/5txWo-KNg2w/photo.jpg?sz=128", "display_name": "Remy Au", "link": "https://stackoverflow.com/users/11150905/remy-au"}, "edited": false, "score": 0, "creation_date": 1560780679, "post_id": 56631929, "comment_id": 99837896, "body": "@RemyAu Hi. Take a look to your form html code. Which action parameter (I talk about url) you see in &lt;form&gt; tag? It&#39;s the endpoint, there your form data will be send. More at <a href=\"https://apidock.com/rails/ActionView/Helpers/FormHelper/form_for\" rel=\"nofollow noreferrer\">form_for helper documentation</a>."}], "tags": [], "owner": {"reputation": 1132, "user_id": 1154044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b042060fc12ff39b4fbe94dcec7d8598?s=128&d=identicon&r=PG", "display_name": "cnnr", "link": "https://stackoverflow.com/users/1154044/cnnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1560776597, "creation_date": 1560776597, "answer_id": 56631929, "question_id": 56631728, "link": "https://stackoverflow.com/questions/56631728/submit-button-not-saving-my-subscriber-ruby-on-rails/56631929#56631929", "title": "Submit button not saving my subscriber Ruby on rails", "body": "<p>You have incorrect <code>form_for url</code>.\nJust check your routes via <code>rake -T</code> command. Check it for POST route to you subcriber create action. You should use it as your form action.</p>\n\n<p>Submit action handled by your <code>StaticsController#index</code> action instead of <code>SubscribersController#create</code>.</p>\n\n<p>Change your form code like so:</p>\n\n<pre><code>&lt;form class=\"form form-cta mt-2\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"row gutter-0\"&gt;\n      &lt;div class=\"col-8\"&gt;\n        &lt;%= form_for @subscriber, url: subscriber_path, method: :post do |f| %&gt;\n        &lt;%= f.email_field :email, placeholder: \"Votre email\", class: \"form- \n        control form-control-rounded\" %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col\"&gt;\n        &lt;%= f.submit :Sabonner, class: \"btn btn-info btn-rounded btn-block\" %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n      &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11150905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igbJVMRvj34/AAAAAAAAAAI/AAAAAAAAJZg/5txWo-KNg2w/photo.jpg?sz=128", "display_name": "Remy Au", "link": "https://stackoverflow.com/users/11150905/remy-au"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560776597, "creation_date": 1560775901, "question_id": 56631728, "link": "https://stackoverflow.com/questions/56631728/submit-button-not-saving-my-subscriber-ruby-on-rails", "title": "Submit button not saving my subscriber Ruby on rails", "body": "<p>I am working on a website and I want to add a subscribe button to get email from users to send them some information but when I enter the email address and press the submit button, the User information won't save.</p>\n\n<p>When I create an user into the rails console by doing:</p>\n\n<pre><code>Subscriber.create!(email: \"test@example.com\")\n</code></pre>\n\n<p>it actually saves the user information:</p>\n\n<pre><code>Subscriber Create (22.7ms)  INSERT INTO \"subscribers\" (\"email\", \"created_at\", \"updated_at\") VALUES ($1, $2, $3) RETURNING \"id\"  [[\"email\", \"test@example.com\"], [\"created_at\", \"2019-06-17 11:00:06.853545\"], [\"updated_at\", \"2019-06-17 11:00:06.853545\"]]], [\"updated_at\", \"2019-06-17 11:00:06.853545\"]]\n</code></pre>\n\n<p>but not when registering it from the form.</p>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;form class=\"form form-cta mt-2\"&gt;\n  &lt;div class=\"form-group\"&gt;\n    &lt;div class=\"row gutter-0\"&gt;\n      &lt;div class=\"col-8\"&gt;\n        &lt;%= form_for @subscriber do |f| %&gt;\n        &lt;%= f.email_field :email, placeholder: \"Votre email\", class: \"form- \n        control form-control-rounded\" %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"col\"&gt;\n        &lt;%= f.submit :Sabonner, class: \"btn btn-info btn-rounded btn-block\" %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n      &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>statics_controller.rb</p>\n\n<pre><code>class StaticsController &lt; ApplicationController\n  def index\n    @subscriber = Subscriber.new\n  end\nend\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :subscribers\n  root to: 'statics#index'\nend\n</code></pre>\n\n<p>subscribers_controller.rb</p>\n\n<pre><code>class SubscribersController &lt; ApplicationController\n  def create\n    @subscriber = Subscriber.new subscriber_params\n    if @subscriber.save  \n        redirect_to root_path, notice: 'Namst\u00e9 !'\n    else\n        redirect_to root_path, alert: 'test'\n  end\n\n\n  private\n\n  def subscriber_params\n      params.require(:subscriber).permit(:email)\n  end\n\nend\n</code></pre>\n\n<p>Rails console:</p>\n\n<pre><code>Processing by StaticsController#index as HTML\n  Parameters: {\"utf8\"=&gt;\"\u2713\", \"authenticity_token\"=&gt;\"balbalbla==\", \"subscriber\"=&gt;{\"email\"=&gt;\"test@test.com\"}, \"commit\"=&gt;\"Sabonner\"}\n  Rendering statics/index.html.erb within layouts/application\n  Rendered statics/index.html.erb within layouts/application (29.0ms)\nCompleted 200 OK in 188ms (Views: 129.2ms | ActiveRecord: 9.0ms)\n</code></pre>\n\n<p>I expect when I go into the console to get all my Subscribers but none of them are saved.\nDo you have any ideas where this can come from?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 4955948, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3b15f7261eb138d01b190e262c65b2a1?s=128&d=identicon&r=PG&f=1", "display_name": "AGM", "link": "https://stackoverflow.com/users/4955948/agm"}, "edited": false, "score": 0, "creation_date": 1595248469, "post_id": 56860808, "comment_id": 111399627, "body": "Hi Folks, Mathieu J. is right. But we can resolved this issue by Alex Falke&#39;s answer. You  need to  Ok on package configuration window after run the last commant(&quot;sudo apt-get install libssl1.0-dev&quot;)."}], "tags": [], "owner": {"reputation": 1388, "user_id": 683982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a178d98faf33ed9d5fc8348b0c03733?s=128&d=identicon&r=PG", "display_name": "Mathieu J.", "link": "https://stackoverflow.com/users/683982/mathieu-j"}, "is_accepted": true, "score": 5, "last_activity_date": 1562237289, "last_edit_date": 1562237289, "creation_date": 1562106893, "answer_id": 56860808, "question_id": 56631331, "link": "https://stackoverflow.com/questions/56631331/how-to-install-rvm-install-2-1-1-on-ubuntu-19-04/56860808#56860808", "title": "How to install rvm install 2.1.1 on ubuntu 19.04", "body": "<p>At this moment, it is no longer possible to install old rubies on recent Ubuntu. If you need to run old rubies, I recommend you stick with Ubuntu 18.04 LTS, on which you can still install any ruby you want.</p>\n\n<p>2.1.x, 2.2.x and 2.3.x no longer installs on 19.04</p>\n\n<p>We would need a custom openssl 1.1 patch, I'm not sure if someone will work on this. Most of the ruby community is ready to move forward.</p>\n\n<p>For production environment you should stick to LTS releases for sure.</p>\n\n<p>When 20.04 LTS comes out, ruby 2.4 will be unsupported by the ruby-core team itself.</p>\n\n<p><a href=\"https://www.ruby-lang.org/en/news/2019/03/31/support-of-ruby-2-3-has-ended/\" rel=\"nofollow noreferrer\">https://www.ruby-lang.org/en/news/2019/03/31/support-of-ruby-2-3-has-ended/</a></p>\n\n<p>From Ubuntu 19.04 and onward, <code>rvm install 2.4.6</code> is your oldest option,\n<code>rvm install 2.6.3</code> is the current recommended release</p>\n\n<p>On my Ubuntu 18.04 I have</p>\n\n<pre><code>ubuntu@ip-w-x-y-z:~$ rvm list \n   ruby-2.0.0-p648 [ x86_64 ]\n   ruby-2.1.8 [ x86_64 ]\n   ruby-2.2.10 [ x86_64 ]\n   ruby-2.2.4 [ x86_64 ]\n   ruby-2.3.8 [ x86_64 ]\n   ruby-2.4.6 [ x86_64 ]\n=* ruby-2.6.3 [ x86_64 ]\n</code></pre>\n\n<p>On my 19.04 laptop I have</p>\n\n<pre><code>ubuntu@ip-w-x-y-z:~$ rvm list \n=&gt; ruby-2.4.6 [ x86_64 ]\n   ruby-2.5.5 [ x86_64 ]\n * ruby-2.6.3 [ x86_64 ]\n   ruby-2.7.0-preview1 [ x86_64 ]\n</code></pre>\n\n<p>I hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 1348044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58c4712a5f8261ba3661434315b5940d?s=128&d=identicon&r=PG", "display_name": "bjm904", "link": "https://stackoverflow.com/users/1348044/bjm904"}, "edited": false, "score": 0, "creation_date": 1597098015, "post_id": 58189323, "comment_id": 112017827, "body": "Tried this on Ubuntu 20.04 and it worked. Thank you"}], "tags": [], "owner": {"reputation": 2010, "user_id": 1167828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333ecc03169c8b11a7664a8eed773abc?s=128&d=identicon&r=PG", "display_name": "Alex Falke", "link": "https://stackoverflow.com/users/1167828/alex-falke"}, "is_accepted": false, "score": 6, "last_activity_date": 1569949204, "creation_date": 1569949204, "answer_id": 58189323, "question_id": 56631331, "link": "https://stackoverflow.com/questions/56631331/how-to-install-rvm-install-2-1-1-on-ubuntu-19-04/58189323#58189323", "title": "How to install rvm install 2.1.1 on ubuntu 19.04", "body": "<p>You can install previous versions of Ruby following this instructions posted on this RVM github issue: <a href=\"https://github.com/rvm/rvm/issues/4680#issuecomment-515951866\" rel=\"noreferrer\">https://github.com/rvm/rvm/issues/4680#issuecomment-515951866</a></p>\n\n<blockquote>\n  <p>I did the same as @grhansen suggested. I was installing ruby 2.3 and\n  that required libssl1.0-dev. I am using Ubuntu 19.04. So I opened my\n  /etc/apt/sources.list by </p>\n</blockquote>\n\n<p><code>sudo nano /etc/apt/sources.list</code>. </p>\n\n<blockquote>\n  <p>And then add the following line at the end of the file </p>\n</blockquote>\n\n<p><code>deb http://security.ubuntu.com/ubuntu bionic-security main</code>.</p>\n\n<blockquote>\n  <p>After that I run the command </p>\n</blockquote>\n\n<p><code>sudo apt update</code></p>\n\n<blockquote>\n  <p>from the terminal. Then I run the command </p>\n</blockquote>\n\n<p><code>apt-cache policy libssl1.0-dev</code></p>\n\n<blockquote>\n  <p>from the terminal and I got the following output </p>\n</blockquote>\n\n<p>libssl1.0-dev: Installed: (none) Candidate:\n1.0.2n-1ubuntu5.3 Version table: 1.0.2n-1ubuntu5.3 500 500 <a href=\"http://security.ubuntu.com/ubuntu\" rel=\"noreferrer\">http://security.ubuntu.com/ubuntu</a> bionic-security/main amd64 Packages</p>\n\n<blockquote>\n  <p>Then I run the command </p>\n</blockquote>\n\n<p><code>sudo apt-get install libssl1.0-dev</code></p>\n\n<blockquote>\n  <p>And it is installed then</p>\n  \n  <p>Before adding I was getting </p>\n</blockquote>\n\n<p>libssl1.0-dev: Installed: (none)\nCandidate: (none) Version table:</p>\n"}], "owner": {"reputation": 87, "user_id": 2803930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07b6f4e3ee819b13c58a8c887860328?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Garg", "link": "https://stackoverflow.com/users/2803930/ashish-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 1, "accepted_answer_id": 56860808, "answer_count": 2, "score": 0, "last_activity_date": 1569949204, "creation_date": 1560774541, "question_id": 56631331, "link": "https://stackoverflow.com/questions/56631331/how-to-install-rvm-install-2-1-1-on-ubuntu-19-04", "title": "How to install rvm install 2.1.1 on ubuntu 19.04", "body": "<p>While installing ruby version 2.1.1 on ubuntu 19.04, getting error - </p>\n\n<pre><code>rvm install ruby-2.1.1\nSearching for binary rubies, this might take some time.\nNo binary rubies available for: ubuntu/19.04/x86_64/ruby-2.1.1.\nContinuing with compilation. Please read 'rvm help mount' to get more information on binary rubies.\nChecking requirements for ubuntu.\nRemoving undesired packages: libssl-dev....\nInstalling requirements for ubuntu.\nUpdating system....\nInstalling required packages: libssl1.0-dev....\nError running 'requirements_debian_libs_install libssl1.0-dev',\nplease read /home/user/.rvm/log/1560773845_ruby-2.1.1/package_install_libssl1.0-dev.log\nRequirements installation failed with status: 100.\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "net-http"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1560767865, "post_id": 56629223, "comment_id": 99830987, "body": "Show the code which fail."}, {"owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1560769499, "post_id": 56629223, "comment_id": 99831837, "body": "Sorry for the inconvenience, just edited my post."}], "answers": [{"comments": [{"owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "edited": false, "score": 0, "creation_date": 1560772310, "post_id": 56630550, "comment_id": 99833265, "body": "Thank you so much for helping me. Although instead of <code>response = http.request req</code>, it should be <code>response = http.request uri, req</code>. First param should be <code>uri</code> and we can pass <code>request obj</code> as 2nd param.  Source: <a href=\"https://github.com/drbrain/net-http-persistent/issues/27#issuecomment-6564122\" rel=\"nofollow noreferrer\">github.com/drbrain/net-http-persistent/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2487, "user_id": 8098012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbdb5ca9b079de1c9700271166feead?s=128&d=identicon&r=PG", "display_name": "Pavel Mikhailyuk", "link": "https://stackoverflow.com/users/8098012/pavel-mikhailyuk"}, "is_accepted": true, "score": 3, "last_activity_date": 1560774718, "last_edit_date": 1560774718, "creation_date": 1560771533, "answer_id": 56630550, "question_id": 56629223, "link": "https://stackoverflow.com/questions/56629223/fetch-urls-prefixed-with-usernamepassword/56630550#56630550", "title": "Fetch urls prefixed with username:password@", "body": "<p>Based on <a href=\"https://github.com/drbrain/net-http-persistent/issues/75\" rel=\"nofollow noreferrer\">this issue</a>, try code like:</p>\n\n<pre><code>uri = URI(\"https://example.com/feed\")\nreq = Net::HTTP::Get.new(uri.request_uri)\nreq.basic_auth 'user', 'pass'\n\nhttp = Net::HTTP::Persistent.new\nhttp.verify_mode = OpenSSL::SSL::VERIFY_NONE\n\nresponse = http.request uri, req\nhttp.shutdown\n\nputs response.code\n</code></pre>\n"}], "owner": {"reputation": 544, "user_id": 11113293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Nbpx9aBwJdY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfkcE5ah2CHeBbTXtfTCmK0U2SoEA/mo/photo.jpg?sz=128", "display_name": "Mohsin Sethi", "link": "https://stackoverflow.com/users/11113293/mohsin-sethi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56630550, "answer_count": 1, "score": 0, "last_activity_date": 1560774718, "creation_date": 1560766534, "last_edit_date": 1560772979, "question_id": 56629223, "link": "https://stackoverflow.com/questions/56629223/fetch-urls-prefixed-with-usernamepassword", "title": "Fetch urls prefixed with username:password@", "body": "<p>I am using <code>net-http-persistent</code> gem to fetch pages. It works perfectly fine for most of the cases. But, recently I noted that it returns 401 for urls prefixed with username:password@ e.g. <a href=\"https://username:password@somesite.com\" rel=\"nofollow noreferrer\">https://username:password@somesite.com</a>. If i try other options like <code>excon</code>/<code>curl</code> they fetch such pages without problem. I saw the logs of the requests made by Net::HTTP::Persistent and found out net::http totally discards the username:password part while connecting to the server. </p>\n\n<p>Can anybody help me how to make Net::HTTP::Persistent make use of <code>username:password@</code> part.</p>\n\n<p>----------------------EDITED--------------------</p>\n\n<p>Sample code:</p>\n\n<pre><code>url = \"https://user:pass@example.com/feed\"\nuri = URI(url)\nhttp = Net::HTTP::Persistent.new\nhttp.verify_mode = OpenSSL::SSL::VERIFY_NONE\nresponse = http.request uri\nhttp.shutdown\n\nresponse.code # yields 401 which it should not as url has username and password.\n\n\n#Incase of excon, if you do \n\nresponse = Excon.get(url)\nresponse.status # yields 200 as it is making use of username:password prefix\n</code></pre>\n"}, {"tags": ["ruby", "sqlite", "sequel"], "answers": [{"tags": [], "owner": {"reputation": 38092, "user_id": 18706, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cabf735ce7b8b4471ef46ea54f71832d?s=128&d=identicon&r=PG", "display_name": "mahemoff", "link": "https://stackoverflow.com/users/18706/mahemoff"}, "is_accepted": false, "score": 1, "last_activity_date": 1560768769, "creation_date": 1560768769, "answer_id": 56629815, "question_id": 56629180, "link": "https://stackoverflow.com/questions/56629180/how-to-copy-a-rubygem-from-one-installation-to-another-one/56629815#56629815", "title": "How to copy a rubygem from one installation to another one", "body": "<p>Use <a href=\"https://bundler.io/\" rel=\"nofollow noreferrer\">Bundler</a> for this.</p>\n\n<p>In short:</p>\n\n<ul>\n<li>Run <code>gem install bundler</code> on each machine you're using.</li>\n<li>Maintain a project <code>Gemfile</code> listing all requirements</li>\n<li>Run <code>bundle install</code> when your Gemfile changes and <code>bundle update</code> to update to latest versions. This will generate the Gemfile.lock file.</li>\n<li>Prefix ruby execution with <code>bundle exec</code>, e.g. <code>bundle exec ruby myscript</code> or <code>bundle exec rails c</code></li>\n</ul>\n\n<p>That's a brief summary, but please read up more on Bundler. It's an essential part of modern Ruby deployment.</p>\n"}, {"comments": [{"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1560783108, "post_id": 56630184, "comment_id": 99839265, "body": "I tried to do the steps you wrote and I got the message <code>Bundle complete!</code>. But my errors is still the same. Does &quot;bundle&quot; include all sources, to compile the native parts of the installation?"}], "tags": [], "owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "is_accepted": false, "score": 1, "last_activity_date": 1571872702, "last_edit_date": 1571872702, "creation_date": 1560770174, "answer_id": 56630184, "question_id": 56629180, "link": "https://stackoverflow.com/questions/56629180/how-to-copy-a-rubygem-from-one-installation-to-another-one/56630184#56630184", "title": "How to copy a rubygem from one installation to another one", "body": "<p>You need to use the <code>package</code> option of bundler.</p>\n\n<p>First you need to cache your dependencies into <code>vendor/cache</code> with:</p>\n\n<pre><code>bundle package --all --all-platforms\n</code></pre>\n\n<p>This will install all the dependencies of your Gemfile locally, then add the directory to your source code repository.</p>\n\n<p>When deploying make sure you use <code>bundle install --local</code> to use the local version.</p>\n\n<p>See the <a href=\"https://bundler.io/v2.0/man/bundle-package.1.html\" rel=\"nofollow noreferrer\">documentation</a> for <code>bundle package</code> for more information.</p>\n"}], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1571872702, "creation_date": 1560766384, "last_edit_date": 1571872548, "question_id": 56629180, "link": "https://stackoverflow.com/questions/56629180/how-to-copy-a-rubygem-from-one-installation-to-another-one", "title": "How to copy a rubygem from one installation to another one", "body": "<p>What must I do when I want to copy an installed gem from one installation to another one without using the <code>gem</code> command?</p>\n\n<p>I have to install SQLite3 on a server without an internet connection. Normally I can do it with a copy of the gem-file: </p>\n\n<pre><code>gem install --local sqlite3-1.4.0.gem --platform ruby\n</code></pre>\n\n<p>But for SQLite3 it needs a connection to the internet to get libraries to compile some binaries. The installation worked well on a computer with an internet connection.</p>\n\n<p>So my idea was to take my successful installation on the same OS and same Ruby version and copy all the related components, but this did not work.</p>\n\n<p>When I called:</p>\n\n<pre><code>require 'sequel'\ndb = Sequel.sqlite\n</code></pre>\n\n<p>I got this error:</p>\n\n<pre><code>LoadError: The specified module could not be found\nd:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sqlite3-1.4.1/lib/sqlite3/sqlite3_native.so \n(Sequel::AdapterNotFound)\n</code></pre>\n\n<p>In the trace is:</p>\n\n<pre><code>d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': LoadError: 126: The specified module could not be found.   - d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sqlite3-1.4.1/lib/sqlite3/sqlite3_native.so (Sequel::AdapterNotFound)\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sqlite3-1.4.1/lib/sqlite3.rb:6:in `rescue in &lt;top (required)&gt;'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sqlite3-1.4.1/lib/sqlite3.rb:2:in `&lt;top (required)&gt;'\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/adapters/sqlite.rb:3:in `&lt;top (required)&gt;'\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n  from d:/bin/Ruby26-x64/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/database/connecting.rb:88:in `load_adapter'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/database/connecting.rb:17:in `adapter_class'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/database/connecting.rb:45:in `connect'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/core.rb:121:in `connect'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/core.rb:399:in `adapter_method'\n  from d:/bin/Ruby26-x64/lib/ruby/gems/2.6.0/gems/sequel-5.17.0/lib/sequel/core.rb:406:in `block (2 levels) in def_adapter_method'\n  from _ruby_version.rb:21:in `&lt;main&gt;'\n</code></pre>\n\n<p>but the file exists:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8MwTb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8MwTb.png\" alt=\"File structure\"></a></p>\n\n<p>What is my error?</p>\n\n<p>I'm using Windows Server 2016.</p>\n\n<p>I found a <a href=\"https://ci.appveyor.com/api/buildjobs/9tfvju3tbxvdm0y4/artifacts/sqlite3-1.4.0.20190219-x64-mingw32.gem\" rel=\"nofollow noreferrer\">precompiled version of SQLite3</a> in a GitHub <a href=\"https://github.com/sparklemotion/sqlite3-ruby/issues/240\" rel=\"nofollow noreferrer\">issue</a> which works for me, but I would like to use a newer version.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1560768056, "post_id": 56629035, "comment_id": 99831089, "body": "Where does the code come from?"}, {"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560773538, "post_id": 56629035, "comment_id": 99833903, "body": "@Stefan From an old project of my company. The code is no longer used so I removed it, but I wanted to understand the purpose of &amp;&amp; ="}], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 0, "creation_date": 1560766454, "post_id": 56629082, "comment_id": 99830212, "body": "Thank you. But I don&#39;t understand in which case it would be useful. If <code>a == 1</code> and <code>b == 2</code>, then <code>a &amp;&amp;= b</code> returns 2. Do you have an example please?"}, {"owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 2, "creation_date": 1560766635, "post_id": 56629082, "comment_id": 99830305, "body": "@escanxr is it another question?  Also, you have an example in your question itself. Apparently, the autor wants to make sure that <code>params[:resource]</code> is set to whatever <code>send(method)</code> returns only if <code>params[:resource]</code> was provided in the first place."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "edited": false, "score": 1, "creation_date": 1560774383, "post_id": 56629082, "comment_id": 99834346, "body": "@escanxr : For making a running &quot;conjunction&quot;. For instance, you invoke a method in a loop, which returns true if it worked well, and false on error, and you want to know after the loop, whether all of the iterations were error free. You initialize <code>still_good=true</code> before the loop, and on each iteration you do something like <code>still_good &amp;&amp;= func(a,b,c)</code>."}], "tags": [], "owner": {"reputation": 48413, "user_id": 1279683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1veuT.jpg?s=128&g=1", "display_name": "Marek Lipka", "link": "https://stackoverflow.com/users/1279683/marek-lipka"}, "is_accepted": false, "score": 4, "last_activity_date": 1560766074, "creation_date": 1560766074, "answer_id": 56629082, "question_id": 56629035, "link": "https://stackoverflow.com/questions/56629035/what-is-the-shortcut/56629082#56629082", "title": "What is the `&amp;&amp;=` shortcut?", "body": "<p>It's a short and idiomatic form of:</p>\n\n<pre><code>a = a &amp;&amp; b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 5, "last_activity_date": 1560774020, "creation_date": 1560774020, "answer_id": 56631188, "question_id": 56629035, "link": "https://stackoverflow.com/questions/56629035/what-is-the-shortcut/56631188#56631188", "title": "What is the `&amp;&amp;=` shortcut?", "body": "<h1>Shortcut</h1>\n\n<p>As mentioned in Marek's <a href=\"https://stackoverflow.com/questions/56629035/what-is-the-shortcut/56629082#56629082\">answer</a>, <code>a &amp;&amp;= b</code> is a shortcut for <code>a = a &amp;&amp; b</code>, just like :</p>\n\n<ul>\n<li><code>a ||= b</code> is <code>a = a || b</code></li>\n<li><code>a += 1</code> is <code>a = a + 1</code></li>\n</ul>\n\n<h1>Meaning</h1>\n\n<p><code>a = a &amp;&amp; b</code> basically means : set <code>a</code> to <code>b</code> only if <code>a</code> was defined and truthy.</p>\n\n<h1>Alternatives</h1>\n\n<p><code>&amp;&amp;</code> can sometimes <a href=\"https://github.com/rubocop-hq/ruby-style-guide#if-as-a-modifier\" rel=\"noreferrer\">be used instead of an <code>if</code></a>. Since there's an <code>if</code> anyway, you could also write:</p>\n\n<pre><code>resource = controller_name.singularize.to_sym\nmethod = \"#{resource}_params\"\nif respond_to?(method, true)\n  if params[resource]\n    params[resource] = send(method)\n  end\nend\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>resource = controller_name.singularize.to_sym\nmethod = \"#{resource}_params\"\nif respond_to?(method, true) &amp;&amp; params[resource]\n  params[resource] = send(method)\nend\n</code></pre>\n\n<p>or</p>\n\n<pre><code>resource = controller_name.singularize.to_sym\nmethod = \"#{resource}_params\"\nparams[resource] = send(method) if respond_to?(method, true) &amp;&amp; params[resource]\n</code></pre>\n\n<h1>Gotcha</h1>\n\n<p>There's a small difference though when <code>a</code> is undefined:</p>\n\n<p><code>a &amp;&amp;= b</code> will set <code>a</code> to <code>nil</code></p>\n\n<p>but</p>\n\n<pre><code>if a\n  a = b\nend\n</code></pre>\n\n<p>will fail with a <code>NameError</code>.</p>\n"}], "owner": {"reputation": 1012, "user_id": 10347572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iottG.jpg?s=128&g=1", "display_name": "escanxr", "link": "https://stackoverflow.com/users/10347572/escanxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56631188, "answer_count": 2, "score": 1, "last_activity_date": 1560774020, "creation_date": 1560765910, "last_edit_date": 1560766346, "question_id": 56629035, "link": "https://stackoverflow.com/questions/56629035/what-is-the-shortcut", "title": "What is the `&amp;&amp;=` shortcut?", "body": "<p>I saw this code:</p>\n\n<pre><code>resource = controller_name.singularize.to_sym\nmethod = \"#{resource}_params\"\nparams[resource] &amp;&amp;= send(method) if respond_to?(method, true)\n</code></pre>\n\n<p>But I don't really understand what <code>&amp;&amp;=</code> does.</p>\n\n<p>Please someone could explain that to me?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5.2", "ruby-2.6"], "comments": [{"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1560757949, "post_id": 56626831, "comment_id": 99826097, "body": "Can you show us your <code>Gemfile</code> ?"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1560758279, "post_id": 56626831, "comment_id": 99826229, "body": "@AsimHashmi Updated question with Gemfile details"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560765405, "post_id": 56626831, "comment_id": 99829720, "body": "As a suggestion, could you try breaking this right down to a <b>minimal</b> reproduction? It seems to be an issue with either (1) the specific domain name, or (2) upgrading the ruby version, or (3) upgrading the <code>rest-client</code> version. I don&#39;t see how the version of Rails, or any of the other ~20 project dependencies you&#39;ve listed, could be contributing to the issue."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560765469, "post_id": 56626831, "comment_id": 99829743, "body": "I <i>could</i> go ahead and diagnose this myself, but... What happens when you just <code>gem install rest-client</code> then try the above? What about on an older ruby version?"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "edited": false, "score": 0, "creation_date": 1560767273, "post_id": 56626831, "comment_id": 99830683, "body": "I don&#39;t think its an issue with rest-client. I get the same error with HTTParty as well."}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560767314, "post_id": 56626831, "comment_id": 99830707, "body": "@TomLord The same command is working in older ruby version. I mean ruby 2.0"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560769475, "post_id": 56626831, "comment_id": 99831823, "body": "OK, so that seems to imply the issue is with the ruby version. What happens if you use <code>2.5</code>? <code>2.4</code>? At what point does it break? For a little context, I just tried running the exactly command you originally showed above (<code>RestClient.get(&quot;https:&#47;&#47;www.google.co.in&quot;)</code>, using <code>rest-client</code> version <code>2.0.2</code> and ruby version <code>2.6.2</code>) and it worked fine. So maybe this is purely an issue on your network configuration, e.g. your firewall. It&#39;s really hard to diagnose given the limited information and my inability to reproduce the problem."}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560769871, "post_id": 56626831, "comment_id": 99832007, "body": "@TomLord its working in 2.6.2 irb. but not in rails console"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560772121, "post_id": 56626831, "comment_id": 99833159, "body": "What happens if you spin up a brand new rails app (<code>rails new</code>), using the same rails version?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560772421, "post_id": 56626831, "comment_id": 99833325, "body": "Maybe (just a guess; I haven&#39;t bothered testing this all for you) the issue relates to the locked <code>httpclient</code> version (<code>2.2.7</code>)? There have been many changes since then, which may be relevant. <a href=\"https://github.com/nahi/httpclient/blob/master/CHANGELOG.md\" rel=\"nofollow noreferrer\">github.com/nahi/httpclient/blob/master/CHANGELOG.md</a>"}, {"owner": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "edited": false, "score": 0, "creation_date": 1560774606, "post_id": 56626831, "comment_id": 99834475, "body": "Try deleting <code>Gemfile.lock</code> and then <code>bundle install</code> again"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560774960, "post_id": 56626831, "comment_id": 99834639, "body": "@TomLord No luck. its failing with httpclient 2.8.3 as well"}, {"owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560775439, "post_id": 56626831, "comment_id": 99834900, "body": "That issue was occurring because of the gem virtus-0.5.2 .  Thanks a lot @TomLord"}], "owner": {"reputation": 3176, "user_id": 1968826, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/TgXPA.jpg?s=128&g=1", "display_name": "Can Can", "link": "https://stackoverflow.com/users/1968826/can-can"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560769840, "creation_date": 1560757428, "last_edit_date": 1560769840, "question_id": 56626831, "link": "https://stackoverflow.com/questions/56626831/api-calls-are-failing-in-rails-5-2-2-ruby-2-6-2", "title": "API calls are failing in Rails 5.2.2 &amp; Ruby 2.6.2", "body": "<p>I have upgraded my rails application to ruby 2.6.2 and rails 5.2.2. After upgrade API calls are failing with the following error message. Kindly help me to solve this issue.</p>\n\n<pre><code>2.6.2 :004 &gt; RestClient.get(\"https://www.google.co.in\")\nTraceback (most recent call last):\n    2: from (irb):4\n    1: from (irb):4:in `rescue in irb_binding'\nNoMethodError (Failed to open TCP connection to www.google.co.in:443 (undefined method `[]' for nil:NilClass))\n2.6.2 :005 &gt; \n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'rails', '5.2.2'\ngem \"daemons\", '1.1.9'\n\ngem 'httpclient', '2.2.7'\ngem 'jquery-rails'#, '= 2.1.4'      # match\ngem 'pg', '~&gt; 0.20'              # match\ngem 'savon'#, '=2.11.2'             # new\ngem 'settingslogic', '= 2.0.8'     # new\ngem 'virtus', '0.5.2'              # new\ngem \"airbrake\"#, \"= 3.1.7\"          # match\ngem 'newrelic_rpm'#, '3.5.3.25'        # match\ngem 'nokogiri'#, '=1.4.0'\ngem 'bootsnap'\n\ngem 'httparty'\ngem 'rest-client'\ngem 'multi_json'\ngem 'mime-types', '= 1.18'\n\n\ngroup :test, :development do\n  gem 'rspec-rails'#, '= 2.12.0' # newer\n  gem 'pry-byebug'#,       \"= 1.1.3\"\nend\n\n group :development do\n   gem 'pry-byebug'#, '= 1.1.3' # match\n   gem 'thin', '= 1.3.1'     # match\nend\n</code></pre>\n\n<p>It is working in ruby 2.6.2 irb, but not in rails console. What could be the problem?</p>\n\n<pre><code>2.6.2 :002 &gt; require 'rest-client'\n =&gt; true \n2.6.2 :003 &gt; RestClient.get(\"https://www.google.co.in\")\n =&gt; &lt;RestClient::Response 200 \"&lt;!doctype h...\"&gt; \n2.6.2 :004 &gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "model-view-controller"], "comments": [{"owner": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "edited": false, "score": 0, "creation_date": 1560757503, "post_id": 56626223, "comment_id": 99825890, "body": "Hi, can you show your model as a whole?"}, {"owner": {"reputation": 155, "user_id": 6694567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H1XQj.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6694567/daniel"}, "reply_to_user": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "edited": false, "score": 0, "creation_date": 1560757935, "post_id": 56626223, "comment_id": 99826091, "body": "what kind of information that i need to provide? @GuilhermeNunes"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1560758700, "post_id": 56626223, "comment_id": 99826428, "body": "Please show the model, the migration and the code you execute along with the error it produces."}, {"owner": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "edited": false, "score": 0, "creation_date": 1560758960, "post_id": 56626223, "comment_id": 99826545, "body": "It would be interesting also to know how did you configure the store, because there are some different ways to make it. :)"}, {"owner": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "edited": false, "score": 0, "creation_date": 1560767763, "post_id": 56626223, "comment_id": 99830923, "body": "Awesome, I have updated my answer down below, I hope it works"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 6694567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H1XQj.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6694567/daniel"}, "edited": false, "score": 1, "creation_date": 1560828229, "post_id": 56627411, "comment_id": 99853341, "body": "Ive solve the problem actually, but this is still one of the great answer cause we do in one line only, thanks"}], "tags": [], "owner": {"reputation": 165, "user_id": 5920987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/861188270664319/picture?type=large", "display_name": "Guilherme Nunes", "link": "https://stackoverflow.com/users/5920987/guilherme-nunes"}, "is_accepted": true, "score": 0, "last_activity_date": 1560767725, "last_edit_date": 1560767725, "creation_date": 1560759680, "answer_id": 56627411, "question_id": 56626223, "link": "https://stackoverflow.com/questions/56626223/cant-write-unknown-attribute-example-typed-store-rails/56627411#56627411", "title": "can&#39;t write unknown attribute `example` typed_store - Rails", "body": "<p>I made a few tests here, and I don't know if it makes sense, but in case of updating stores, all the typestored columns are inside just one real column in the database (that are a normally in hash or Json).</p>\n\n<p>So the straight foward way to do it is to wrap in brackets.</p>\n\n<p>Try changing:</p>\n\n<pre><code>self.update_columns( name: name_test, age: age_test )\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>self.update_columns( profile: { name: name_test, age: age_test} )\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 6694567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H1XQj.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/6694567/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 56627411, "answer_count": 1, "score": 0, "last_activity_date": 1560767725, "creation_date": 1560755100, "last_edit_date": 1560760361, "question_id": 56626223, "link": "https://stackoverflow.com/questions/56626223/cant-write-unknown-attribute-example-typed-store-rails", "title": "can&#39;t write unknown attribute `example` typed_store - Rails", "body": "<p>I have this models where I wanna update my typestored columns using update_columns active record</p>\n\n<p>I have searched numerous answers in stack, doesn't seems to have lot of resources regarding typestored.</p>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;%= form_tag print_booking_path(@booking), method: 'post' do %&gt;\n &lt;%= label_tag :name %&gt;\n &lt;%= text_field_tag :name, '', class: 'form-control' %&gt;\n &lt;%= label_tag :age %&gt;\n &lt;%= text_field_tag :age, '', class: 'form-control' %&gt;\n &lt;%= submit_tag \"Print\", class: \"btn btn-default\" %&gt;\n &lt;%= link_to 'Cancel', '#', class: 'btn btn-default', data: { dismiss: 'modal' } %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>bookings_controller</p>\n\n<pre><code>def print\n    @booking = Booking.find(params[:id])\n    if @booking.print_model(current_user, params[:name], params[:age])\n      render :print\n    else\n      render :print\n    end\n  end\n</code></pre>\n\n<p>booking model</p>\n\n<pre><code>def print_model(user, name_test, age_test)\n self.update_columns(name: name_test, age: age_test)\nend\n</code></pre>\n\n<p>typestore under booking model</p>\n\n<pre><code>typed_store :profile, coder: PostgresCoder do |i|\n i.string :name, default: \"\"\n i.integer :age, default: 0\nend\n</code></pre>\n\n<p>the error appeared to be like this<br>\ncan't write unknown attribute <code>name</code></p>\n\n<p>it's same like if I wanna to update like this self.increment!(:age)</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "xml", "xml-builder"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1560752659, "post_id": 56624405, "comment_id": 99823867, "body": "The default is <a href=\"https://github.com/jimweirich/builder/blob/master/lib/builder/xmlmarkup.rb#L170-L172\" rel=\"nofollow noreferrer\">no indentation and no line breaks</a>."}, {"owner": {"reputation": 21, "user_id": 5002501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bfb6ef600891b77d6ac0e117c259907?s=128&d=identicon&r=PG&f=1", "display_name": "Nkey", "link": "https://stackoverflow.com/users/5002501/nkey"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1560777058, "post_id": 56624405, "comment_id": 99835878, "body": "Thx, its for all document, but i need use it in another case... For example: <code>&lt;A1&gt;First row&lt;&#47;A1&gt; &lt;A&gt;&lt;d&gt;n&lt;&#47;d&gt;Im newspaper text (Second row)&lt;&#47;A&gt;</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1560777186, "post_id": 56624405, "comment_id": 99835970, "body": "Then derive from their implementation and allow the option handled by your extended class."}], "owner": {"reputation": 21, "user_id": 5002501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bfb6ef600891b77d6ac0e117c259907?s=128&d=identicon&r=PG&f=1", "display_name": "Nkey", "link": "https://stackoverflow.com/users/5002501/nkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560742413, "creation_date": 1560742413, "question_id": 56624405, "link": "https://stackoverflow.com/questions/56624405/how-to-make-output-in-1-row-for-xml-builder", "title": "How to make output in 1 row for xml.builder?", "body": "<p>I want have output in 1 row text:</p>\n\n<pre><code>&lt;A&gt;&lt;d&gt;n&lt;/d&gt;Im newspaper text&lt;/A&gt;\n</code></pre>\n\n<p>I used </p>\n\n<pre><code>xml.A { |t| t.d \"n\"; t.text! advert.newspaper_text }\n</code></pre>\n\n<p>In this case i have output:</p>\n\n<pre><code>&lt;A&gt;\n  &lt;d&gt;n&lt;/d&gt;\n  Im newspaper text\n&lt;/A&gt;\n</code></pre>\n\n<p>How i can do it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1560736403, "post_id": 56623856, "comment_id": 99820448, "body": "<code>ruby -e &#39;puts `shuf`&#39; &lt; filename.txt</code> :)"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1560736586, "post_id": 56623856, "comment_id": 99820478, "body": "@Ry- hahaha! Smart, but that doesn&#39;t work on MacOS :) Check my own answer please, I think it&#39;ll work anywhere Ruby does."}], "answers": [{"tags": [], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "is_accepted": false, "score": 0, "last_activity_date": 1560736510, "creation_date": 1560736510, "answer_id": 56623907, "question_id": 56623856, "link": "https://stackoverflow.com/questions/56623856/how-do-i-shuffle-a-file-in-one-line-ruby-e/56623907#56623907", "title": "How do I shuffle a file in one-line ruby -e", "body": "<pre><code>ruby -ne 'BEGIN { data = [] }; data &lt;&lt; $_; END {puts data.shuffle}' filename.txt\n</code></pre>\n\n<p>This does the following:</p>\n\n<ul>\n<li>Add the <code>-n</code> flag, which wraps the input in <code>while gets(); ... end;</code></li>\n<li>Use <code>BEGIN</code> to create an initial <code>data</code> variable that's shared across every loop run</li>\n<li>Shovels the data into the <code>data</code> variable on every loop</li>\n<li>Use <code>END</code> to output that final <code>data</code> variable.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1560737969, "post_id": 56623932, "comment_id": 99820666, "body": "Hi, while this solution works, it requires multiple different executions, creates a temporary file, requires a temporary file, and as of now doesn&#39;t clean up after creating the temporary file :). While it&#39;s &quot;one-line&quot;, it&#39;s also one line, but executed multiple times. It works, but not according to what the question asked, which was &quot;<code>ruby -e</code> to read the file, shuffle it, and standard output it&quot; :) Thank you for your help though!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1560740683, "post_id": 56623932, "comment_id": 99821035, "body": "The above comment pertains to my original answer, which reflected a misreading of the question."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1560804276, "last_edit_date": 1560804276, "creation_date": 1560736831, "answer_id": 56623932, "question_id": 56623856, "link": "https://stackoverflow.com/questions/56623856/how-do-i-shuffle-a-file-in-one-line-ruby-e/56623932#56623932", "title": "How do I shuffle a file in one-line ruby -e", "body": "<p>Create a test file:</p>\n\n<pre><code>str = \"three\\nblind\\nmice\\n\"\nFile.write('data_in', str)\n  #= 17\n</code></pre>\n\n<p>From the command line.</p>\n\n<p>If not limited to Ruby<sup>1</sup>:</p>\n\n<pre><code>cat data_in|shuf\nmice\nthree\nblind\n</code></pre>\n\n<p>Using Ruby,</p>\n\n<pre><code>ruby -e \"puts STDIN.readlines.shuffle.join\" &lt; data_in\nmice\nblind\nthree\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ruby -e \"puts ARGF.readlines.shuffle.join\" data_in\nblind\nmice\nthree\n</code></pre>\n\n<p><sup>1 See <a href=\"http://man7.org/linux/man-pages/man1/shuf.1.html\" rel=\"nofollow noreferrer\">doc</a>. This doesn't work with OS X, but there's a <a href=\"https://apple.stackexchange.com/questions/142860/install-shuf-on-os-x\">fix</a>. </sup></p>\n"}, {"comments": [{"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1560738024, "post_id": 56623951, "comment_id": 99820677, "body": "ARGF also works with my answer below for the same reason :) but your solution is shorter and easier to read!"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1560738568, "post_id": 56623951, "comment_id": 99820758, "body": "Could you elaborate why you used the splat operator (<code>*</code>) and wrapped it in an array (<code>[...]</code>)? (&quot;I don\u2019t know a lot of Ruby&quot;, he says)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 1, "creation_date": 1560739456, "post_id": 56623951, "comment_id": 99820879, "body": "@UpvoteMe: It ended up one character shorter than <code>.to_a</code>. I didn\u2019t know it existed, but it does in Python, so I tried it :D"}, {"owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "edited": false, "score": 0, "creation_date": 1560740973, "post_id": 56623951, "comment_id": 99821083, "body": "Oh, right! Because you need to convert it into an array before you shuffle it, which <code>$&lt;</code> is not :)"}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 6, "last_activity_date": 1560788659, "last_edit_date": 1560788659, "creation_date": 1560737036, "answer_id": 56623951, "question_id": 56623856, "link": "https://stackoverflow.com/questions/56623856/how-do-i-shuffle-a-file-in-one-line-ruby-e/56623951#56623951", "title": "How do I shuffle a file in one-line ruby -e", "body": "<p>You can read all lines from <a href=\"http://ruby-doc.org/core-2.6.3/ARGF.html\" rel=\"nofollow noreferrer\"><code>ARGF</code></a> into an array:</p>\n\n<pre><code>ruby -e 'puts $&lt;.to_a.shuffle' filename.txt\n</code></pre>\n\n<p>or by splatting the lines to make it extra short:</p>\n\n<pre><code>ruby -e'puts [*$&lt;].shuffle' filename.txt\n</code></pre>\n\n<p>It\u2019ll also accept input on stdin with no filename.</p>\n"}], "owner": {"reputation": 5579, "user_id": 3970701, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a937016807c66d89d0a62d7a1b235533?s=128&d=identicon&r=PG", "display_name": "Amin Shah Gilani", "link": "https://stackoverflow.com/users/3970701/amin-shah-gilani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 56623951, "answer_count": 3, "score": 2, "last_activity_date": 1560804276, "creation_date": 1560735878, "question_id": 56623856, "link": "https://stackoverflow.com/questions/56623856/how-do-i-shuffle-a-file-in-one-line-ruby-e", "title": "How do I shuffle a file in one-line ruby -e", "body": "<p>I have the following file:</p>\n\n<pre><code>A\nB\nC\n...\n</code></pre>\n\n<p>I want <code>ruby -e</code> to read the file, shuffle it, and standard output it, like so for example:</p>\n\n<pre><code>P\nC\nA\n...\n</code></pre>\n\n<p>How do I do this. So far, I've gotten to <code>ruby -e 'puts $_' filename.txt</code>.</p>\n"}, {"tags": ["ruby", "rspec", "chef-infra", "chefspec"], "answers": [{"tags": [], "owner": {"reputation": 19821, "user_id": 170230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cNDYy.png?s=128&g=1", "display_name": "Draco Ater", "link": "https://stackoverflow.com/users/170230/draco-ater"}, "is_accepted": true, "score": 0, "last_activity_date": 1560755059, "creation_date": 1560755059, "answer_id": 56626210, "question_id": 56623285, "link": "https://stackoverflow.com/questions/56623285/how-to-stub-command-in-chefspec/56626210#56626210", "title": "How to stub_command in ChefSpec?", "body": "<p>This should work:</p>\n\n<pre><code>allow(::Win32::Service).to receive(:exists?).with(windows_service[:name]).and_return(true)\n</code></pre>\n\n<p>Point is you stub a class method <code>exists?</code>, and not an instance method. That's why <code>allow_any_instance_of</code> does not work. And <code>stub_command</code> is actually for shell commands like <code>stub_command('cat file | grep \"hello\"')</code></p>\n"}], "owner": {"reputation": 23, "user_id": 6177844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9161182d6b41176b1e760b21a9fb793c?s=128&d=identicon&r=PG&f=1", "display_name": "SmNg1028", "link": "https://stackoverflow.com/users/6177844/smng1028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "accepted_answer_id": 56626210, "answer_count": 1, "score": 1, "last_activity_date": 1560755059, "creation_date": 1560727098, "question_id": 56623285, "link": "https://stackoverflow.com/questions/56623285/how-to-stub-command-in-chefspec", "title": "How to stub_command in ChefSpec?", "body": "<p>I have this condition in my recipe:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>install_action = (::Win32::Service.exists?(windows_service['name']) ? :configure : :create)\n</code></pre>\n\n<p>and a ChefSpec for that in spec file:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>#1: not working \nallow_any_instance_of(Win32::Service)\n                .to receive(:exists?)\n                .with(windows_service[:name])\n                .and_return(true)\n#2: also not working\nstub_command(\"::Win32::Service.exists?(#{windows_service[:name]})\").and_return(true)\n</code></pre>\n\n<p>Could you please help to find out what have I missed in the ChefSpec test that is not working and mocking the return value.\nThanks</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1560762896, "post_id": 56622848, "comment_id": 99828418, "body": "Alternatively <code>ary.each_index.group_by { |i| ary[i] }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8179700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4320bba579620ec4761d0dec3788ebe5?s=128&d=identicon&r=PG", "display_name": "Timur Shamuradov", "link": "https://stackoverflow.com/users/8179700/timur-shamuradov"}, "edited": false, "score": 1, "creation_date": 1560725202, "post_id": 56622993, "comment_id": 99819122, "body": "Thank you so much! I&#39;m a little bit confused with this line: hash = Hash.new { |h,k| h[k] = [] }, particulary with &#39;h&#39; argument."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 45, "user_id": 8179700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4320bba579620ec4761d0dec3788ebe5?s=128&d=identicon&r=PG", "display_name": "Timur Shamuradov", "link": "https://stackoverflow.com/users/8179700/timur-shamuradov"}, "edited": false, "score": 0, "creation_date": 1560725631, "post_id": 56622993, "comment_id": 99819176, "body": "H and k stand for hash and key. When an unknown key gets looked up in the hash, this block is called. You can google for &quot;ruby default hash block&quot; for more explanation, in on the go right now"}, {"owner": {"reputation": 45, "user_id": 8179700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4320bba579620ec4761d0dec3788ebe5?s=128&d=identicon&r=PG", "display_name": "Timur Shamuradov", "link": "https://stackoverflow.com/users/8179700/timur-shamuradov"}, "edited": false, "score": 0, "creation_date": 1560726041, "post_id": 56622993, "comment_id": 99819229, "body": "Got it! Thanks!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1560728532, "post_id": 56622993, "comment_id": 99819519, "body": "Timur, <code>each.with_index</code> is generally written <code>each_with_index</code> unless one wants the index to have a base other than zero (e.g., <code>...each.with_index(1)...</code>). Defining the hash as it is done here is effectively the same as <code>hash = {};  array.each_with_index { |ele, idx| hash[ele] = [] unless hash.key?(ele); hash[ele].push(idx) }; hash</code>. Lastly, you could reduce the body of the method to one line by writing  <code>array.each_with_index.with_object(Hash.new { |h,k| h[k] = [] }) { |(ele, idx), hash| hash[ele].push(idx) }</code>."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 45, "user_id": 8179700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4320bba579620ec4761d0dec3788ebe5?s=128&d=identicon&r=PG", "display_name": "Timur Shamuradov", "link": "https://stackoverflow.com/users/8179700/timur-shamuradov"}, "edited": false, "score": 0, "creation_date": 1560760044, "post_id": 56622993, "comment_id": 99827028, "body": "@TimurShamuradov: &quot;I&#39;m a little bit confused with this line: hash = Hash.new { |h,k| h[k] = [] }, particulary with &#39;h&#39; argument&quot; \u2013 It would be helpful if you could describe what <i>precisely</i> is unclear to you about the documentation of <code>Hash::new</code>. That way, the Ruby developers can improve the documentation so that future developers do not stumble across the same problems as you. Help make the world a better place!"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 3, "last_activity_date": 1560723192, "creation_date": 1560723192, "answer_id": 56622993, "question_id": 56622848, "link": "https://stackoverflow.com/questions/56622848/ruby-adding-different-array-values-into-hash-for-the-same-key/56622993#56622993", "title": "Ruby: Adding different array values into hash for the same key", "body": "<p>With two small modifications your code willl work.</p>\n\n<ol>\n<li>change <code>hash = Hash.new([])</code> to <code>hash = Hash.new { |h,k| h[k] = [] }</code></li>\n</ol>\n\n<p>you should really never use <code>Hash.new([])</code>, see this article for an explanation: <a href=\"https://mensfeld.pl/2016/09/ruby-hash-default-value-be-cautious-when-you-use-it/\" rel=\"nofollow noreferrer\">https://mensfeld.pl/2016/09/ruby-hash-default-value-be-cautious-when-you-use-it/</a></p>\n\n<ol start=\"2\">\n<li>Change <code>hash[ele] = (idx)</code> to <code>hash[ele].push(idx)</code></li>\n</ol>\n\n<p>you don't want to <em>replace</em> the value whenever you encounter a new index, you want to <em>push it to the array</em>.</p>\n\n<pre><code>array = ['a', 'b', 'c', 'a', 'c']\n\ndef dupe_indices(array)\n    hash = Hash.new { |h,k| h[k] = [] }\n    array.each.with_index { |ele, idx| hash[ele].push(idx) }\n    hash\nend\n\ndupe_indices(array)\n# =&gt; {\"a\"=&gt;[0, 3], \"b\"=&gt;[1], \"c\"=&gt;[2, 4]}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8179700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4320bba579620ec4761d0dec3788ebe5?s=128&d=identicon&r=PG", "display_name": "Timur Shamuradov", "link": "https://stackoverflow.com/users/8179700/timur-shamuradov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56622993, "answer_count": 1, "score": 2, "last_activity_date": 1560723192, "creation_date": 1560721610, "last_edit_date": 1560721918, "question_id": 56622848, "link": "https://stackoverflow.com/questions/56622848/ruby-adding-different-array-values-into-hash-for-the-same-key", "title": "Ruby: Adding different array values into hash for the same key", "body": "<p>I'm trying to add different values into an array for the same key into the hash. Instead of making a new instance in the array, my function sum ups the index values of the array elements</p>\n\n<pre><code>def dupe_indices(array)\n    hash = Hash.new([])\n    array.each.with_index { |ele, idx| hash[ele] = (idx) }\n    hash\nend\n</code></pre>\n\n<p>I'm getting this</p>\n\n<pre><code>print dupe_indices(['a', 'b', 'c', 'a', 'c']) =&gt; {\"a\"=&gt;3, \"b\"=&gt;1, \n\"c\"=&gt;4}\n</code></pre>\n\n<p>Expected output</p>\n\n<pre><code>print dupe_indices(['a', 'b', 'c', 'a', 'c']) =&gt; { 'a' =&gt; [0, 3], 'b' \n=&gt; [1], 'c' =&gt; [2, 4] }\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ajax", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2874, "user_id": 4720244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbf3e87a6491f609f81b93e438282db?s=128&d=identicon&r=PG&f=1", "display_name": "EJAg", "link": "https://stackoverflow.com/users/4720244/ejag"}, "edited": false, "score": 0, "creation_date": 1560718815, "post_id": 56622471, "comment_id": 99818161, "body": "Can you provide your code?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560718926, "post_id": 56622471, "comment_id": 99818183, "body": "It could also be turbolinks, try disabling it and see iff the issue still happens"}, {"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1560755756, "post_id": 56622471, "comment_id": 99825090, "body": "@maxpleaner is it possible to fix with use turbolinks"}], "answers": [{"comments": [{"owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "edited": false, "score": 0, "creation_date": 1560811370, "post_id": 56622823, "comment_id": 99850267, "body": "same issue even after adding disable_with:"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": -1, "last_activity_date": 1560721352, "creation_date": 1560721352, "answer_id": 56622823, "question_id": 56622471, "link": "https://stackoverflow.com/questions/56622471/rails-remote-true-form-submitting-form-multiple-times/56622823#56622823", "title": "Rails remote true form submitting form multiple times", "body": "<p>From the <a href=\"https://apidock.com/rails/ActionView/Helpers/FormTagHelper/submit_tag\" rel=\"nofollow noreferrer\">API</a>, if you use <code>submit_tag</code>, or <code>button_tag</code> (You can read <a href=\"https://apidock.com/rails/ActionView/Helpers/FormTagHelper/button_tag\" rel=\"nofollow noreferrer\">api</a>). By default user cannot submit form twice.</p>\n\n<p>However, it's good idea for your users in this case to add a 'waiting' status if user hit submit button</p>\n\n<pre><code>submit_tag \"Complete sale\", data: { disable_with: \"Submitting...\" }\nbutton_tag \"Complete sale\", data: { disable_with: \"Submitting...\" }\n</code></pre>\n\n<p>The other way, you can prevent this behavior in your controller. So, in case your user has slow internet, they hit button twice, its okay to perform <code>js response</code> again but you do nothing to your DB if the data already found </p>\n"}], "owner": {"reputation": 5144, "user_id": 5411461, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RyJfN.jpg?s=128&g=1", "display_name": "Haseeb Ahmad", "link": "https://stackoverflow.com/users/5411461/haseeb-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560721352, "creation_date": 1560717611, "question_id": 56622471, "link": "https://stackoverflow.com/questions/56622471/rails-remote-true-form-submitting-form-multiple-times", "title": "Rails remote true form submitting form multiple times", "body": "<p>Using <code>remote:true</code> in rails form for submission.\nBut issue I am facing is that sometimes its submitting form multiple times .</p>\n\n<p>I read somewhere that its may be due to <code>// = require jquery_ujs</code></p>\n\n<p>application.js</p>\n\n<pre><code>// = require v1/jquery-2.1.1.min\n// = require jquery_ujs\n// = require v1/spritespin.min\n// = require v1/slick.min\n// = require v1/bootstrap.min\n// = require v1/bootstrap-editable.min\n// = require turbolinks\n</code></pre>\n\n<p>Rails version is 4.2.10</p>\n\n<p>How can I fix this issue?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-6"], "comments": [{"owner": {"reputation": 1225, "user_id": 957185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4435b492655cf1dbd1897167f28ff6a0?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/957185/maxence"}, "edited": false, "score": 0, "creation_date": 1560725156, "post_id": 56621887, "comment_id": 99819112, "body": "If <code>User has_one :profile</code> it is a bit strange that you can create another one. Also you can add a <code>before_action</code> hook in your Profile controller that checks if a profile exists and apply it to the new and create action. Then if a profile exists, just redirect to Root or a default page and don&#39;t proceed to New or Create .."}], "answers": [{"tags": [], "owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "is_accepted": false, "score": 0, "last_activity_date": 1560715697, "creation_date": 1560715697, "answer_id": 56622266, "question_id": 56621887, "link": "https://stackoverflow.com/questions/56621887/rails-6-only-one-profile-per-user-should-be-created/56622266#56622266", "title": "Rails 6: Only one profile per user should be created", "body": "<p>I once solved this by doing (I know it's strange, I'm just putting it out here as an idea)</p>\n\n<pre><code>has_one  :profile\nhas_many :profiles\n\nvalidates :profiles, length: { in: 0..1 }\n</code></pre>\n\n<p><a href=\"https://guides.rubyonrails.org/active_record_validations.html#length\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/active_record_validations.html#length</a></p>\n"}, {"tags": [], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "is_accepted": false, "score": -1, "last_activity_date": 1560725378, "creation_date": 1560725378, "answer_id": 56623155, "question_id": 56621887, "link": "https://stackoverflow.com/questions/56621887/rails-6-only-one-profile-per-user-should-be-created/56623155#56623155", "title": "Rails 6: Only one profile per user should be created", "body": "<p>I decided to not to use a <code>profile</code> controller and just have one model <code>User</code> that can be used as the profile. </p>\n"}], "owner": {"reputation": 2221, "user_id": 5921203, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/lczFa.jpg?s=128&g=1", "display_name": "Steven Aguilar", "link": "https://stackoverflow.com/users/5921203/steven-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1560725378, "creation_date": 1560712562, "last_edit_date": 1560713497, "question_id": 56621887, "link": "https://stackoverflow.com/questions/56621887/rails-6-only-one-profile-per-user-should-be-created", "title": "Rails 6: Only one profile per user should be created", "body": "<p>I'm currently working on a Rails 6 application. I have the following association. A User has a Profile and a Profile belongs to a User. When editing a profile for a user I ended up having two profiles for the user. I would like to have only one profile per user.</p>\n\n<p>Edit form: profile/edit.html.erb</p>\n\n<pre><code>&lt;%= form_for @profile do |f| %&gt;\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :avatar %&gt;\n          &lt;%= f.file_field :avatar, as: :file, class: \"form-control\" %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :full_name, 'Full Name' %&gt;\n          &lt;%= f.text_field :full_name, autofocus: true, class: \"form-control\" %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :city, 'City' %&gt;\n          &lt;%= f.text_field :city, class: \"form-control\" %&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.label :bio, 'Bio'%&gt;\n            &lt;p&gt; Why did you join ArtsySpace?\n            What should other people here know about you?\n            &lt;/p&gt;\n          &lt;%= f.text_field :bio, class: \"form-control\"%&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"form-group\"&gt;\n          &lt;%= f.submit \"Edit profile\", class: \"btn btn-primary\" %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n</code></pre>\n\n<p>I see from the console that user 1 has 2 profiles. I'm not sure how a profile was created maybe I hit the create method from profile controller but mistake but I would like for this not to happen. Is there a validation for only one profile to belong to user?</p>\n\n<pre><code>class ProfilesController &lt; ApplicationController\n  def new\n    @profile = current_user.build_profile\n  end\n\n  def create\n    @profile = current_user.create_profile(profile_params)\n    @profile.avatar.attach(params[:profile][:avatar])\n\n    if @profile.save\n      redirect_to @post\n    else\n      render 'new'\n    end\n  end\n\n  def show\n    @profile = Profile.find(params[:id])\n  end\n\n  def edit\n    @profile = current_user.profile\n  end\n\n  def update\n    @profile = current_user.profile\n      if @profile.update!(profile_params)\n        redirect_to @profile, notice: 'Profile was successfully updated.'\n      else\n        render :edit\n      end\n  end\n\n  def delete\n    @profile = current_user.profile.find(params[:id])\n    @profile.destroy\n  end\n\n  private\n\n  def profile_params\n    params.require(:profile).permit(:full_name, :city, :bio, :avatar)\n  end\nend\n</code></pre>\n\n<p>I'm not sure if the issue comes from the way the routes are configured? </p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n\n  devise_scope :users do\n    resources :profiles, only: [:edit, :update]\n  end\n\n  resources :profiles, only: [:show]\n\n  resources :posts do\n    resource :comments, only: %i[show new create edit update]\n  end\nend\n\nclass User &lt; ApplicationRecord\n  # Include default devise modules. Others available are:\n  # :confirmable, :lockable, :timeoutable, :trackable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :validatable\n  has_many :posts\n  has_one :profile\n  accepts_nested_attributes_for :profile\nend\n</code></pre>\n\n<p>From the below snippet you can see that a user has 2 profiles for user_id: 1 </p>\n\n<pre><code>[#&lt;Profile id: 3, user_id: 1, full_name: \"steven \", city: \"diego \", bio: \"Because im \", created_at: \"2019-06-12 23:11:49\", updated_at: \"2019-06-16 18:49:22\"&gt;, #&lt;Profile id: 4, user_id: 1, full_name: \"andrew\", city: \"Tony\", bio: \"because i know \", created_at: \"2019-06-12 23:12:35\", updated_at: \"2019-06-16 18:51:22\"&gt;]\n</code></pre>\n\n<p>Not sure where the issue came from.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1560710043, "post_id": 56621512, "comment_id": 99816058, "body": "Try putting parentheses around each set of conditions joined by &amp;&amp;. Like <code>(a &amp;&amp; b) || (c &amp;&amp; d)</code>."}, {"owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1560710558, "post_id": 56621512, "comment_id": 99816195, "body": "I tried that and it redirect the user every time no matter if the state of the provider and form matches"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1560711750, "post_id": 56621512, "comment_id": 99816501, "body": "<code>@provider.licenses.where(issuing_state:&#39;CO&#39;)</code> is always truthy because it is an ActiveRecord relation object. Do you mean to check for the existence of such a record?"}, {"owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1560711876, "post_id": 56621512, "comment_id": 99816524, "body": "ahh you are right. And yes i do mean to check for an existence of such a record @muistooshort"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "edited": false, "score": 0, "creation_date": 1560714366, "post_id": 56621888, "comment_id": 99817112, "body": "wow that&#39;s all that I was missing. Thank you so much. I was just over thinking it."}, {"owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "edited": false, "score": 0, "creation_date": 1560798871, "post_id": 56621888, "comment_id": 99846049, "body": "and just curios does .exist? check for nil ?"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 1, "last_activity_date": 1560712577, "creation_date": 1560712577, "answer_id": 56621888, "question_id": 56621512, "link": "https://stackoverflow.com/questions/56621512/using-if-and-in-one-condition-statement/56621888#56621888", "title": "Using &#39;if&#39;, &#39;&amp;&amp;&#39;, and &#39;||&#39; in one condition statement", "body": "<p>Something like <code>@provider.licenses.where(..)</code> is always trueish because it returns a <code>ActiveRecord::Relation</code>.</p>\n\n<p>You might want to use <code>@provider.licenses.exist?(issuing_state:'CO')</code> instead.</p>\n\n<pre><code>if @provider.licenses.exist?(issuing_state:'CO') &amp;&amp; @form.state == 'CA' ||\n   @provider.licenses.exist?(issuing_state:'CA') &amp;&amp; @form.state == 'CO'\n  redirect_to root_path, alert: 'You do not have access to update form'\nend \n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56621888, "answer_count": 1, "score": -1, "last_activity_date": 1560712577, "creation_date": 1560709317, "question_id": 56621512, "link": "https://stackoverflow.com/questions/56621512/using-if-and-in-one-condition-statement", "title": "Using &#39;if&#39;, &#39;&amp;&amp;&#39;, and &#39;||&#39; in one condition statement", "body": "<p>So what I am trying to accomplish is if @provider.licenses.where(issuing_state:'CA')' it has to match the @form.state as well which would be 'CA' in this case in order to have access to that page. Now if the provider.licenses.issuing_state does not match @form.state the user would be redirect. Here is what I have</p>\n\n<pre><code>def edit\n        @user = current_user\n        @patient = Patient.find(params[:patient_id])\n        @form_response = FormResponse.find_by_id(params[:id])\n        @form = @form_response.form\n        @provider = current_user.try(:provider)\n        @provider_user = @provider.try(:role).try(:user)\n\n        if current_user.is_provider?\n            if @provider.licenses.where(issuing_state:'CO') &amp;&amp; @form.state == 'CA' || @provider.licenses.where(issuing_state:'CA') &amp;&amp; @form.state == 'CO' \n                redirect_to root_path, alert: 'You do not have access to update form'\n\n            end \n        end\n    end\n</code></pre>\n"}, {"tags": ["ruby", "xml", "jenkins", "nokogiri"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1560709288, "post_id": 56618834, "comment_id": 99815890, "body": "Welcome to SO! Note, as asked your question wasn&#39;t a good fit for SO. You&#39;re supposed to show us the minimum code that demonstrated the problem, along with errors encountered, the required supporting input data and expected output. That shows us what you tried and helps us not duplicate things you tried. &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the links at the bottom of that page, and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot; help explain the process and what we need."}], "answers": [{"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1560708218, "post_id": 56618871, "comment_id": 99815625, "body": "BTW, in this case, it does not matter much, but you should as a general rule prefer <code>public_send</code> over <code>send</code>. <code>send</code> does two things, allow you to pass a method name dynamically, and circumvent access protection. Since your method name in this case is not actually dynamic, someone reading the code may assume that you are using <code>send</code> for its other effect then. Whereas with <code>public_send</code>, it would be immediately obvious that you only use it because the method name is illegal. Only use <code>send</code> when you actually <i>mean</i> to break encapsulation."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1560709447, "post_id": 56618871, "comment_id": 99815933, "body": "Congratulations on finding your own solution. SO will let you select your answer as the solution after a time-out period. You might want to test and incorporate @J&#246;rgWMittag&#39;s suggestion, crediting him appropriately, and add that to your answer to make it more complete. Don&#39;t add &quot;updated&quot; or &quot;edited&quot; tags to the text, just add the new information where you would have if you&#39;d originally entered it."}], "tags": [], "owner": {"reputation": 188, "user_id": 2386495, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b25134d658d50617ab104dac9891bf44?s=128&d=identicon&r=PG", "display_name": "Cathal", "link": "https://stackoverflow.com/users/2386495/cathal"}, "is_accepted": false, "score": 0, "last_activity_date": 1560709314, "last_edit_date": 1560709314, "creation_date": 1560688388, "answer_id": 56618871, "question_id": 56618834, "link": "https://stackoverflow.com/questions/56618834/ruby-generate-xml-documents-with-period-in-attribute/56618871#56618871", "title": "Ruby generate XML documents with period in attribute", "body": "<p>The solution is to use dynamic dispatching:</p>\n\n<pre><code>builder = Nokogiri::XML::Builder.new do |xml|\n  xml.properties {\n    xml.send('foo.bar', 'zaa')\n  }\nend\n</code></pre>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;properties&gt;\n  &lt;foo.bar&gt;zaa&lt;/foo.bar&gt;\n&lt;/properties&gt;\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 2386495, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b25134d658d50617ab104dac9891bf44?s=128&d=identicon&r=PG", "display_name": "Cathal", "link": "https://stackoverflow.com/users/2386495/cathal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560709314, "creation_date": 1560688044, "question_id": 56618834, "link": "https://stackoverflow.com/questions/56618834/ruby-generate-xml-documents-with-period-in-attribute", "title": "Ruby generate XML documents with period in attribute", "body": "<p>There are lots of great Ruby libraries out there to generate XML documents, but I can't find any which support the generation of XML attributes with periods in their names.</p>\n\n<p>The end goal here is to build a Ruby lib which auto generates Jenkins templates.</p>\n\n<p>Here is an example Jenkins job field parameter, which as you can see, uses attributes with periods in the name:</p>\n\n<pre><code>&lt;properties&gt;\n  &lt;hudson.model.ParametersDefinitionProperty&gt;\n    &lt;parameterDefinitions&gt;\n      &lt;hudson.model.StringParameterDefinition&gt;\n        &lt;name&gt;MESSAGE&lt;/name&gt;\n        &lt;description/&gt;\n        &lt;defaultValue&gt;Hello world!&lt;/defaultValue&gt;\n      &lt;/hudson.model.StringParameterDefinition&gt;\n    &lt;/parameterDefinitions&gt;\n  &lt;/hudson.model.ParametersDefinitionProperty&gt;\n&lt;/properties&gt;\n</code></pre>\n\n<p>Does anyone know how I could do this? Any way to bend the libraries which already exist to support this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "github"], "comments": [{"owner": {"reputation": 55797, "user_id": 7976758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512cfbaf98d63ca4acd57b2df792aec6?s=128&d=identicon&r=PG", "display_name": "phd", "link": "https://stackoverflow.com/users/7976758/phd"}, "edited": false, "score": 0, "creation_date": 1560684279, "post_id": 56618221, "comment_id": 99810202, "body": "<code>git remote -v</code> ?"}, {"owner": {"reputation": 59, "user_id": 5623903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f063686aeddbe53ac6355e9010e542b4?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/5623903/anh-bui"}, "edited": false, "score": 1, "creation_date": 1560688049, "post_id": 56618221, "comment_id": 99811000, "body": "sorry for my error. I fixed it.  When I used <code>git remote -v</code> it show me here  <code>origin  git:&#47;&#47;https:&#47;&#47;anhbui2904@bitbucket.org&#47;anhbui2904&#47;sample_app&zwnj;&#8203;.git (fetch) origin  git:&#47;&#47;https:&#47;&#47;anhbui2904@bitbucket.org&#47;anhbui2904&#47;sample_app&zwnj;&#8203;.git (push) </code>   Any idea for me?"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 6591347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/muykQ.png?s=128&g=1", "display_name": "Oleksii Filonenko", "link": "https://stackoverflow.com/users/6591347/oleksii-filonenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1560693171, "creation_date": 1560693171, "answer_id": 56619464, "question_id": 56618221, "link": "https://stackoverflow.com/questions/56618221/how-to-fix-fatal-unable-to-look-up-https-port-9418-no-such-host-is-known/56619464#56619464", "title": "How to fix &quot;fatal :unable to look up https (port 9418) (No such host is known)", "body": "<p>You have a wrong remote URL - <code>git://</code> is the name of Git protocol (port 9418), and it doesn't need to be followed by a different protocol name.</p>\n\n<p>Try this:</p>\n\n<pre><code>git remote set-url origin https://anhbui2904@bitbucket.org/anhbui2904/sample_app.git\n</code></pre>\n\n<p>This will set your <code>origin</code> remote URL to use HTTPS.</p>\n"}, {"tags": [], "owner": {"reputation": 4133, "user_id": 555002, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/097259354c88b00abd60caeb02f2ebb3?s=128&d=identicon&r=PG", "display_name": "Rogelio Trivi&#241;o", "link": "https://stackoverflow.com/users/555002/rogelio-trivi%c3%b1o"}, "is_accepted": false, "score": 0, "last_activity_date": 1605605822, "creation_date": 1605605822, "answer_id": 64872673, "question_id": 56618221, "link": "https://stackoverflow.com/questions/56618221/how-to-fix-fatal-unable-to-look-up-https-port-9418-no-such-host-is-known/64872673#64872673", "title": "How to fix &quot;fatal :unable to look up https (port 9418) (No such host is known)", "body": "<p>if <code>git remote set-url origin</code> doesn't work, you may edit directly the</p>\n<blockquote>\n<p>.git/config</p>\n</blockquote>\n<p>file, and repair the <code>git://https://</code> prefix to desired, git:// or <code>https://</code></p>\n"}], "owner": {"reputation": 59, "user_id": 5623903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f063686aeddbe53ac6355e9010e542b4?s=128&d=identicon&r=PG&f=1", "display_name": "Anh Bui", "link": "https://stackoverflow.com/users/5623903/anh-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5280, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1605605822, "creation_date": 1560683150, "last_edit_date": 1560714173, "question_id": 56618221, "link": "https://stackoverflow.com/questions/56618221/how-to-fix-fatal-unable-to-look-up-https-port-9418-no-such-host-is-known", "title": "How to fix &quot;fatal :unable to look up https (port 9418) (No such host is known)", "body": "<p>I am trying to push using git using:</p>\n\n<pre><code>git push -u origin --all\n</code></pre>\n\n<p>Here is my problem:</p>\n\n<pre><code>Fatal: unable to look up https (port 9418) (No such host is known. )\n</code></pre>\n\n<p>I ran <code>ping github.com</code> and got the IP, but I do not know what to do with them.</p>\n"}, {"tags": ["ruby", "big-o"], "answers": [{"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 4, "last_activity_date": 1560681400, "last_edit_date": 1560681400, "creation_date": 1560681085, "answer_id": 56617996, "question_id": 56617844, "link": "https://stackoverflow.com/questions/56617844/how-to-determine-big-o-time-complexity-of-array-difference-in-ruby/56617996#56617996", "title": "How to determine big O Time complexity of array difference in Ruby", "body": "<blockquote>\n  <p>My question is how does <code>array_2 - array_1</code> work</p>\n</blockquote>\n\n<p>The Ruby Specification does not prescribe any particular way of implementing <code>Array#-</code>. It only prescribes the outcome. Therefore, any Ruby implementor is free to implement <code>Array#-</code> however they want, and they are free to change their implementation at any time for any reason.</p>\n\n<blockquote>\n  <p>and what is the time complexity of it?</p>\n</blockquote>\n\n<p>The Ruby Specification does not prescribe any particular time complexity for <code>Array#-</code>. It only prescribes the outcome. Therefore, any Ruby implementor is free to implement <code>Array#-</code> with any time complexity they want, and they are free to change the time complexity at any time for any reason.</p>\n\n<p>It is easy to perform set difference with an expected step complexity of O(n), and it is even possible, but more complex, for certain assumptions about the distribution of values in the sets to do it in sublinear steps, i.e. better than O(n). I would guess most implementors would choose the simpler O(n) solution, but there is no guarantee for that. If you want to know how a specific version of a specific implementation will perform for a specific distribution of elements, then you'll have to look at the source code for that specific version of that specific implementation. But, be aware that there is no guarantee that other implementations or even other versions of the same implementation will do it the same way.</p>\n\n<p>Case in point: Rubinius originally used an implementation of <code>Hash</code> that is very similar to the one that YARV uses, but they have since switched to an implementation based on Hash-Array Mapped Tries. So, depending on the version of Rubinius you are using, <code>Hash</code>es may be implemented using completely different algorithms. In fact, during a transitional period, Rubinius provided both the old and the new implementation, and you could switch between the two with a command line option.</p>\n\n<p>Just as an example, <a href=\"https://github.com/rubinius/rubinius/blob/master/core/array.rb#L387-L396\" rel=\"nofollow noreferrer\">here is the current implementation of <code>Array#-</code> in Rubinius</a>:</p>\n\n<pre><code>def -(other)\n  other = Rubinius::Type.coerce_to other, Array, :to_ary\n\n  array = []\n  im = Rubinius::IdentityMap.from other\n\n  each { |x| array &lt;&lt; x unless im.include? x }\n\n  array\nend\n</code></pre>\n\n<p>As you can see, the step complexity of <code>a - b</code> is &Theta;(|a| + |b|) for this specific version of Rubinius. But let me reiterate: this is only true for this specific version of Rubinius. Other versions of Rubinius, or other Ruby implementations may (and almost certainly <em>do</em>) have different implementations.</p>\n\n<p>Am I right in assuming you are a C++ programmer? The C++ library specification is rather special in that it actually <em>does</em> prescribe the complexity of algorithms, and implementors <em>must</em> implement the algorithms that those complexities are met. This is not the case in Ruby, and in fact, most other languages.</p>\n"}, {"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1560732271, "post_id": 56623541, "comment_id": 99819941, "body": "&lt;pedant mode&gt;time complexity says nothing about how fast an operation is. It describes how runtime <i>changes</i> with varying input size. On small enough inputs, array scans can outperform hash lookups and, say, O(N^2) sorting algo can run faster than an O(NlogN) one.&lt;/pedant mode&gt;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1560732672, "post_id": 56623541, "comment_id": 99819985, "body": "Thanks. You still left the sentence that triggered the comment, but I&#39;ll be content with this too :)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1560789466, "last_edit_date": 1560789466, "creation_date": 1560731192, "answer_id": 56623541, "question_id": 56617844, "link": "https://stackoverflow.com/questions/56617844/how-to-determine-big-o-time-complexity-of-array-difference-in-ruby/56623541#56623541", "title": "How to determine big O Time complexity of array difference in Ruby", "body": "<p>The naive way to write the method <code>Array#-</code> is as follows.</p>\n\n<pre><code>class Array\n  def -(other)\n    each_with_object([]) { |e,a| a &lt;&lt; e unless other.include?(e) }\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>array_1 = [1, 2, 3]\narray_2 = [5,4,3,2,1,4]\n\narray_2 - array_1\n  #=&gt; [5, 4, 4] \n</code></pre>\n\n<p>The method iterates over each element in <code>array2</code> and for each of those elements it iterates over some or all elements of <code>array_1</code>. The computational complexity is therefore equal to <code>O(array_1.size * array_2.size)</code>.</p>\n\n<p>For larger arrays, we can speed this up by replacing <code>other.include?(e)</code> with <code>other_set.include?(e)</code>, where <code>other_set</code> is the set of unique values in <code>other</code>. Sets are implemented with hashes under the covers, so set lookups, like hash key lookups, are very fast, generally regarded as having a computational complexity of <code>O(1)</code> (constant time). We therefore might rewrite this method as follows.</p>\n\n<pre><code>require 'set'\n\nclass Array\n  def -(other)\n    other_set = other.to_set\n    each_with_object([]) { |e,a| a &lt;&lt; e unless other.include?(e) }\n  end\nend\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>array_2 - array_1\n  #=&gt; [5, 4, 4] \n</code></pre>\n\n<p>This method has a computational complexity of <code>O(array_1.size + array_2.size)</code>, where <code>array_2.size</code> is the computational complexity of the operation <code>other_set = array_2.to_set</code>.</p>\n\n<p>I cannot say this is how Ruby implements <code>Array#-</code>, but I am confident it is more-or-less how I've done it, for any method having a smaller computational complexity would not be not be able to examine all the elements in <code>array_1</code> or <code>array_2</code>, which, obviously, must be done to produce a result.</p>\n\n<p>Note that <code>other.include?(e)</code> employs <a href=\"https://ruby-doc.org/core-2.5.0/Array.html#method-i-include-3F\" rel=\"nofollow noreferrer\">Array#include?</a> whereas <code>other_set.include?(e)</code> employs <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-i-include-3F\" rel=\"nofollow noreferrer\">Set#include?</a>. </p>\n"}], "owner": {"reputation": 893, "user_id": 4542614, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d4911933297e3b7637d8149826405730?s=128&d=identicon&r=PG&f=1", "display_name": "Ayudh", "link": "https://stackoverflow.com/users/4542614/ayudh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560789466, "creation_date": 1560679699, "last_edit_date": 1560714292, "question_id": 56617844, "link": "https://stackoverflow.com/questions/56617844/how-to-determine-big-o-time-complexity-of-array-difference-in-ruby", "title": "How to determine big O Time complexity of array difference in Ruby", "body": "<p>How do I determine big O Time complexity of array difference in Ruby?</p>\n\n<p>For example:</p>\n\n<pre><code>array_1 = [1,2,3]\narray_2 = [5,4,3,2,1]\n\narray_2 - array_1 #gives [5,4]\n</code></pre>\n\n<p>How does <code>array_2 - array_1</code> work and what is the time complexity of it? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "openssl"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1560678610, "post_id": 56617471, "comment_id": 99809083, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10246023/bundle-install-fails-with-ssl-certificate-verification-error\">bundle install fails with SSL certificate verification error</a>"}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1560681628, "post_id": 56617471, "comment_id": 99809640, "body": "Try this: <code>ls -ld &#47;usr&#47;include&#47;openssl&#47;</code> If it doesn&#39;t find, you have to install some more components (platform-dependent, typically <code>libssl-dev</code>). The you can re-try configure: <code>--with-openssl-dir=&#47;usr</code>"}, {"owner": {"reputation": 842, "user_id": 5440125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5368403fa6c1aa62270f86373269777f?s=128&d=identicon&r=PG&f=1", "display_name": "zengod", "link": "https://stackoverflow.com/users/5440125/zengod"}, "reply_to_user": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1560684570, "post_id": 56617471, "comment_id": 99810259, "body": "@LorinczyZsigmond, upon following your steps, I don&#39;t get the openssl error during make. But I still get the error during sudo make install."}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1560741599, "post_id": 56617471, "comment_id": 99821192, "body": "You might want to quote the error message."}, {"owner": {"reputation": 842, "user_id": 5440125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5368403fa6c1aa62270f86373269777f?s=128&d=identicon&r=PG&f=1", "display_name": "zengod", "link": "https://stackoverflow.com/users/5440125/zengod"}, "edited": false, "score": 0, "creation_date": 1560754171, "post_id": 56617471, "comment_id": 99824426, "body": "It&#39;s the same error. `require&#39;: cannot load such file -- openssl (LoadError)"}], "owner": {"reputation": 842, "user_id": 5440125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5368403fa6c1aa62270f86373269777f?s=128&d=identicon&r=PG&f=1", "display_name": "zengod", "link": "https://stackoverflow.com/users/5440125/zengod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1806, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1560679072, "creation_date": 1560675810, "last_edit_date": 1560679072, "question_id": 56617471, "link": "https://stackoverflow.com/questions/56617471/cannot-install-ruby-on-rails-because-ruby-installer-cannot-find-openssl", "title": "Cannot install ruby on rails because ruby installer cannot find openssl", "body": "<p>I'm trying to install Ruby 2.6.3 from source for ruby on rails on WSL. Here are the steps I'm taking:\nFirst I check the location of openssl using </p>\n\n<pre><code>type -a openssl\n</code></pre>\n\n<p>and I get </p>\n\n<pre><code>openssl is /usr/bin/openssl\n</code></pre>\n\n<p>so in the ruby src directory I run \n<code>./configure --with-openssl-dir=/usr/bin</code>\nThen I run <code>make</code>\nBut I get this message somewhere during the make process:</p>\n\n<pre><code>openssl:\n        Could not be configured. It will not be installed.\n        /mnt/c/Users/MyUserName/Desktop/ruby-2.6.3/ext/openssl/extconf.rb:97: OpenSSL library could not be found. You might want to use --with-openssl-dir=&lt;dir&gt; option to specify the prefix where OpenSSL is installed.\n        Check ext/openssl/mkmf.log for more details.\n\n</code></pre>\n\n<p>Regardless of this warning, I run in the rails src directory the following:</p>\n\n<pre><code>gem install rails\n</code></pre>\n\n<p>and get the error:</p>\n\n<pre><code>`require': cannot load such file -- openssl (LoadError)\n</code></pre>\n"}, {"tags": ["ruby", "nokogiri"], "comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1560646903, "post_id": 56615163, "comment_id": 99804906, "body": "Remove the space after the a."}, {"owner": {"reputation": 1, "user_id": 9286820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb06e19f84859a24d51dadc1ab6439fc?s=128&d=identicon&r=PG&f=1", "display_name": "McLori57", "link": "https://stackoverflow.com/users/9286820/mclori57"}, "reply_to_user": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1560647797, "post_id": 56615163, "comment_id": 99805022, "body": "<code>base_url.css(&quot;.nba-player-index__trending-item a[&#39;title&#39;]&quot;).map(&amp;:text)</code>  didn&#39;t work"}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1560648435, "post_id": 56615163, "comment_id": 99805088, "body": "sorry, just <code>a[title]</code> - You can do ctrl+f in the browser elements panel to search with css"}, {"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1560652102, "post_id": 56615163, "comment_id": 99805447, "body": "Well there&#39;s always the possibility that it&#39;s not there."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1560709758, "post_id": 56615163, "comment_id": 99816003, "body": "Welcome to SO! Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages at the bottom of the page, along with &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. We need you to provide the minimum snippet of the HTML that helps to demonstrate the problem rather than ask us to load the page and search it. Also, please don&#39;t use links to images that demonstrate essential parts of the question. Links can break and images can&#39;t be reused to enter data as we&#39;re working on solutions."}], "answers": [{"tags": [], "owner": {"reputation": 1751, "user_id": 771689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1524605085c8e4da02686db15f648ae1?s=128&d=identicon&r=PG", "display_name": "William Wong Garay", "link": "https://stackoverflow.com/users/771689/william-wong-garay"}, "is_accepted": true, "score": 0, "last_activity_date": 1560709590, "last_edit_date": 1560709590, "creation_date": 1560651124, "answer_id": 56615571, "question_id": 56615163, "link": "https://stackoverflow.com/questions/56615163/scraping-contents-of-title-from-an-a-tag/56615571#56615571", "title": "Scraping contents of title from an &#39;a&#39; tag", "body": "<p>You can get the title values with:</p>\n\n<pre><code>base_url.css(\".nba-player-index__trending-item a:first\").map{|item| item[:title] }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9286820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb06e19f84859a24d51dadc1ab6439fc?s=128&d=identicon&r=PG&f=1", "display_name": "McLori57", "link": "https://stackoverflow.com/users/9286820/mclori57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56615571, "answer_count": 1, "score": -1, "last_activity_date": 1560709590, "creation_date": 1560644617, "last_edit_date": 1560647913, "question_id": 56615163, "link": "https://stackoverflow.com/questions/56615163/scraping-contents-of-title-from-an-a-tag", "title": "Scraping contents of title from an &#39;a&#39; tag", "body": "<p>I'm using nokogiri to scrape contents from <a href=\"https://www.nba.com/teams/warriors\" rel=\"nofollow noreferrer\">https://www.nba.com/teams/warriors</a> but I am unable to scrape the contents from the a tag.</p>\n\n<p>I played around with adding and removing the classes but I receive an empty array.</p>\n\n<p><code>base_url.css(\".nba-player-index__trending-item a ['title']\").map(&amp;:text)</code></p>\n\n<p>I would like to see: Jordan Bell.<a href=\"https://i.stack.imgur.com/gR43n.png\" rel=\"nofollow noreferrer\">Image of the tag</a></p>\n"}, {"tags": ["ruby", "rspec", "sinatra", "rack"], "answers": [{"comments": [{"owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "edited": false, "score": 0, "creation_date": 1560680375, "post_id": 56616956, "comment_id": 99809397, "body": "I&#39;m afraid this isn&#39;t really what I&#39;m asking - I know how to raise a 500 and return JSON in Sinatra. What I want to do is raise a 500 in a route which should normally never raise one, for testing purposes only, using RSpec or Rack::Test."}], "tags": [], "owner": {"reputation": 4998, "user_id": 1404425, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/wsCfz.jpg?s=128&g=1", "display_name": "Arman H", "link": "https://stackoverflow.com/users/1404425/arman-h"}, "is_accepted": false, "score": -1, "last_activity_date": 1560670023, "creation_date": 1560670023, "answer_id": 56616956, "question_id": 56614526, "link": "https://stackoverflow.com/questions/56614526/raising-500-errors-deliberately-in-sinatra-in-order-to-test-how-they-are-handled/56616956#56616956", "title": "Raising 500 errors deliberately in Sinatra in order to test how they are handled", "body": "<p>Use the <code>halt</code> method:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'sinatra'\n\nget '/' do\n  halt 500, {\n    success: 'false',\n    response: 'Internal server error'\n  }.to_json\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5610, "user_id": 413924, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5fae9bf6a8e05a023c96ba434a1dfd5?s=128&d=identicon&r=PG", "display_name": "DannyB", "link": "https://stackoverflow.com/users/413924/dannyb"}, "is_accepted": true, "score": 1, "last_activity_date": 1560777238, "last_edit_date": 1560777238, "creation_date": 1560703198, "answer_id": 56620780, "question_id": 56614526, "link": "https://stackoverflow.com/questions/56614526/raising-500-errors-deliberately-in-sinatra-in-order-to-test-how-they-are-handled/56620780#56620780", "title": "Raising 500 errors deliberately in Sinatra in order to test how they are handled", "body": "<p>When facing a situation like this, what I usually do is separate concerns, and move logic outside of the Sinatra <code>get ...</code> block. Then, it is easy to stub it and make it raise an error.</p>\n\n<p>For example, given this server code:</p>\n\n<pre><code># server.rb\nrequire 'sinatra'\n\nclass SomeModel\n  def self.some_action\n    \"do what you need to do\"\n  end\nend\n\nget '/' do\n  SomeModel.some_action\nend\n</code></pre>\n\n<p>You can then use this code to have the model, or any other class/function you are using to actually generate the response, raise an error, using this spec:</p>\n\n<pre><code># spec\ndescribe '/' do\n  context 'on error' do\n    before do \n      allow(SomeModel).to receive(:some_action) { raise ArgumentError }\n    end\n\n    it 'errors gracefully' do\n      get '/'\n      expect(last_response.status).to eq 500\n    end\n  end\nend\n</code></pre>\n\n<p>For completeness, here is a self contained file that can be tested to demonstrate this approach by running <code>rspec thisfile.rb</code>:</p>\n\n<pre><code># thisfile.rb\nrequire 'rack/test'\nrequire 'rspec'\nrequire 'sinatra'\n\n# server\n\nclass SomeModel\n  def self.some_action\n    \"do what you need to do\"\n  end\nend\n\nget '/' do\n  SomeModel.some_action\nend\n\n# spec_helper\n\nENV['APP_ENV'] = 'test'\n\nmodule RSpecMixin\n  include Rack::Test::Methods\n  def app() Sinatra::Application end\nend\n\nRSpec.configure do |c|\n  c.include RSpecMixin\nend\n\n# spec\n\ndescribe '/' do\n  context 'on error' do\n    before do \n      allow(SomeModel).to receive(:some_action) { raise ArgumentError }\n    end\n\n    it 'errors gracefully' do\n      get '/'\n      expect(last_response.status).to eq 500\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 9435, "user_id": 2626000, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/j8GY0.jpg?s=128&g=1", "display_name": "Aaron Christiansen", "link": "https://stackoverflow.com/users/2626000/aaron-christiansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 1, "accepted_answer_id": 56620780, "answer_count": 2, "score": 3, "last_activity_date": 1560777238, "creation_date": 1560636602, "question_id": 56614526, "link": "https://stackoverflow.com/questions/56614526/raising-500-errors-deliberately-in-sinatra-in-order-to-test-how-they-are-handled", "title": "Raising 500 errors deliberately in Sinatra in order to test how they are handled", "body": "<p>I want to write an RSpec test which verifies that, should a 500 error occur in my Sinatra-powered API, the error will be caught by a Sinatra <code>error</code> definition and returned to the client in a JSON format. That is, rather than returning some HTML error page, it returns JSON like this to conform with the rest of the API:</p>\n\n<pre><code>{\n  success: \"false\",\n  response: \"Internal server error\"\n}\n</code></pre>\n\n<p>However, I'm unsure how to actually trigger a 500 error in my Sinatra app in order to test this behaviour with RSpec. I can't find a way to mock Sinatra routes, so currently my best idea is this route which deliberately causes a 500. This feels like a pretty dreadful solution:</p>\n\n<pre><code>get '/api/v1/testing/internal-server-error' do\n  1 / 0\nend\n</code></pre>\n\n<p>Is there a way to mock Sinatra routes so that I can have, say, <code>/</code>'s route handler block raise an exception, therefore triggering a 500? If not, is there some other way to deliberately cause a 500 error in my app?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "parsing"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1560629903, "post_id": 56613529, "comment_id": 99802211, "body": "It&#39;s probably hitting some server error (400? 404? 429? 500?...) and returning a non-JSON error response. You could start by <code>rescue</code>ing the exception and looking at the full response to help diagnose it. Maybe your best bet is to just retry the request if it fails (a few times, before giving up and then failing more gracefully). But it&#39;s hard to say until we know what the actual error was!"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10134443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GACPj.jpg?s=128&g=1", "display_name": "Aerodyne", "link": "https://stackoverflow.com/users/10134443/aerodyne"}, "edited": false, "score": 0, "creation_date": 1560686597, "post_id": 56614024, "comment_id": 99810700, "body": "Thanks so much for this. I guess the rate limiting is something they added more recently on their end, and I hadn&#39;t considered using a begin rescue."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1560631892, "last_edit_date": 1560631892, "creation_date": 1560631362, "answer_id": 56614024, "question_id": 56613529, "link": "https://stackoverflow.com/questions/56613529/rake-task-errors-with-jsonparsererror-765-unexpected-token-at-but-works/56614024#56614024", "title": "Rake task errors with: JSON::ParserError: 765: unexpected token at &#39;&#39; but works fine in rails console", "body": "<p>Since you're looping over an api, it's possible there are rate limits. Public APIs normally have per second rate limits.  You could try adding a sleep to slow down your requests, not sure how many your making per second.  I tested with a simple loop and looks like response returns an empty string if you hit the api too fast.</p>\n\n<pre><code>url='https://www.keyforgegame.com/api/decks/?page=1&amp;page_size=30&amp;search=&amp;links=cards'\nuri = URI(url)\ni = 1\n1000.times do\n  puts i.to_s\n  i += 1\n  response =  Net::HTTP.get(URI(uri))\n  begin\n    j = JSON.parse(response)\n  rescue\n    puts response\n    #= \"\"\n  end\nend\n</code></pre>\n\n<p>I played with this until the loop stopped returning empty string after the 3rd request and got it to work with <code>sleep 5</code> inside each loop, so you can probably add as the first line inside your loop. But you should probably add error handling to your rake task in case you encounter any other API errors.</p>\n\n<p>So for now you can probably just do this</p>\n\n<pre><code>until page_number &gt; page_limit || Card.where(is_maverick: false).length == 740\n  sleep 5\n  # rest of your loop code, maybe add a rescue like I've shown\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10134443, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GACPj.jpg?s=128&g=1", "display_name": "Aerodyne", "link": "https://stackoverflow.com/users/10134443/aerodyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "accepted_answer_id": 56614024, "answer_count": 1, "score": 1, "last_activity_date": 1560631892, "creation_date": 1560626601, "question_id": 56613529, "link": "https://stackoverflow.com/questions/56613529/rake-task-errors-with-jsonparsererror-765-unexpected-token-at-but-works", "title": "Rake task errors with: JSON::ParserError: 765: unexpected token at &#39;&#39; but works fine in rails console", "body": "<p>I have a rake task which loops over pages of card game database and checks for the cards in each deck. Until recently this was working fine (it's checked 34000 pages of 25 decks each no problem) but recently this has stopped working when I run the rake task and I get the error:</p>\n\n<p>JSON::ParserError: 765: unexpected token at ''</p>\n\n<p>In order to debug this I have tried running each line of the get request and json parse manually in the rails console and it works fine every time. Weirder still I have installed pry and it works every time I go through the json parse manually with pry (takes ages though).</p>\n\n<p>Here is the rake task:</p>\n\n<pre><code>desc \"Create Cards\"\nrequire 'net/http'\nrequire 'json'\ntask :create_cards =&gt; :environment do\n  # Get the total number of pages of decks\n  uri = URI(\"https://www.keyforgegame.com/api/decks/\")\n  response = Net::HTTP.get(URI(uri))\n  json = JSON.parse(response)\n  deck_count = json[\"count\"]\n\n  # Set variables\n  page_number = 1\n  page_size = 25 # 25 is the max page size\n  page_limit = deck_count / 25\n  card_list = Card.where(is_maverick: false)\n\n  # Updates Card List (non-mavericks) - there are 740 cards so we stop when we have that many\n  # example uri: https://www.keyforgegame.com/api/decks/?page=1&amp;page_size=30&amp;search=&amp;links=cards\n  puts \"Updating Card List...\"\n  until page_number &gt; page_limit || Card.where(is_maverick: false).length == 740\n    uri = URI(\"https://www.keyforgegame.com/api/decks/?page=#{page_number}&amp;page_size=#{page_size}&amp;search=&amp;links=cards\")\n    response = Net::HTTP.get(URI(uri))\n\n\n    json = JSON.parse(response) # task errors here!\n\n\n    cards = json[\"_linked\"][\"cards\"]\n    cards.each do |card|\n      unless Card.exists?(:card_id =&gt; card[\"id\"])\n        Card.create({\n        card_id: card[\"id\"],\n        amber: card[\"amber\"],\n        card_number: card[\"card_number\"],\n        card_text: card[\"card_text\"],\n        card_title: card[\"card_title\"],\n        card_type: card[\"card_type\"],\n        expansion: card[\"expansion\"],\n        flavor_text: card[\"flavor_text\"],\n        front_image: card[\"front_image\"],\n        house: card[\"house\"],\n        is_maverick: card[\"is_maverick\"],\n        power: card[\"power\"],\n        rarity: card[\"rarity\"],\n        traits: card[\"traits\"],\n        })\n      end\n    end\n\n    puts \"#{page_number}/#{page_limit} - Cards: #{Card.where(is_maverick: false).length}\"\n    page_number = (page_number + 1)\n  end\nend\n</code></pre>\n\n<p>The first json parse where it gets the total number of pages of decks works okay. It's the json parse in the until block that is failing (I've marked the line with a comment to that effect).</p>\n\n<p>As I say, if I try this in the console it works fine and I can parse the json without error, literally copying and pasting the lines from the file into the rails console.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "adfs", "adfs2.0"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10528348, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dh2DVucxD2U/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmJlqQstUkOd6xLN6fA0fLJvV94w/mo/photo.jpg?sz=128", "display_name": "Bruno Toledo", "link": "https://stackoverflow.com/users/10528348/bruno-toledo"}, "edited": false, "score": 0, "creation_date": 1561049657, "post_id": 56645020, "comment_id": 99946750, "body": "Thanks. I did everything as explained in the references and it keep telling me &quot;AuthN token (wresult) missing in callback&quot;. I looked at the omniauth-wsfed documentation at github and it looks there are a missing value at &quot;request&quot; which I undersant is an object created by the gem itself or a dependence."}, {"owner": {"reputation": 67, "user_id": 10528348, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dh2DVucxD2U/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmJlqQstUkOd6xLN6fA0fLJvV94w/mo/photo.jpg?sz=128", "display_name": "Bruno Toledo", "link": "https://stackoverflow.com/users/10528348/bruno-toledo"}, "edited": false, "score": 0, "creation_date": 1561060425, "post_id": 56645020, "comment_id": 99951262, "body": "Do I have to make any change in my devise.rb file ?"}], "tags": [], "owner": {"reputation": 4491, "user_id": 6049604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1612c1d48cc981963c4fc034ff322e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Verma", "link": "https://stackoverflow.com/users/6049604/mohit-verma"}, "is_accepted": true, "score": 1, "last_activity_date": 1560847229, "creation_date": 1560847229, "answer_id": 56645020, "question_id": 56612053, "link": "https://stackoverflow.com/questions/56612053/problem-with-using-rails-adfs-integration-gem-omiauth-wsfed/56645020#56645020", "title": "Problem with using Rails / ADFS integration gem omiauth-wsfed", "body": "<p>I am assuming you have configured your omniauth.rb properly where:</p>\n\n<pre><code>Issuer Name: This should be in the format of the adfs sever domain followed by /adfs/services/trust\n\nIssuer: This is where your login requests will be sent, normally it will be the path /adfs/ls on the ADFS server.\n\nRealm: This should match the domain that you provide in your federation metadata document\n\nReply: This is where you want the response from ADFS to be returned to in your application. This is normally the path /auth/wsfed/callback when using Omniauth.\n\nSAML Version: The version of SAML tokens. Defaults to 2\n\nID Claim: This is the name of the claim field that ADFS will return that should be used as the unique identifier.\n\nIDP Cert Fingerprint: Your Windows Administrator should be able to tell you this, but if not a way to find it is to put in any string, do a test login to ADFS\u200a\u2014\u200athis will fail when doing the callback as the certificate doesn\u2019t match, however if you inspect the response in the Chrome Web Inspector you will be able to see the X509 Certificate in the response. You can then use OpenSSL tools, or this online tool to get the fingerprint of the certificate.\n</code></pre>\n\n<p>Also Setting up callback routes like below</p>\n\n<pre><code>match '/auth/:provider/callback' =&gt; 'sessions#create', via: [:get, :post]  \nmatch '/auth/failure' =&gt; 'sessions#failure', via: [:get]\n</code></pre>\n\n<p>The <code>**controller#action**</code> can differ depending on how your application is structured.</p>\n\n<p>You can handle the callback in the same way you would any Omniauth provider.</p>\n\n<pre><code>def create\n  auth = request.env[\"omniauth.auth\"]  \n  auth.uid # Gets the UID value of the user that has just signed in\n  # Create a session, redirect etc\nend\n</code></pre>\n\n<p>you can refer below repo for further reference.</p>\n\n<p><a href=\"https://blog.craig.io/using-microsoft-adfs-with-ruby-on-rails-and-omniauth-a26237c64f8d\" rel=\"nofollow noreferrer\">https://blog.craig.io/using-microsoft-adfs-with-ruby-on-rails-and-omniauth-a26237c64f8d</a></p>\n\n<p><a href=\"https://github.com/kbeckman/omniauth-wsfed\" rel=\"nofollow noreferrer\">https://github.com/kbeckman/omniauth-wsfed</a></p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 67, "user_id": 10528348, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Dh2DVucxD2U/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmJlqQstUkOd6xLN6fA0fLJvV94w/mo/photo.jpg?sz=128", "display_name": "Bruno Toledo", "link": "https://stackoverflow.com/users/10528348/bruno-toledo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 56645020, "answer_count": 1, "score": 0, "last_activity_date": 1560972129, "creation_date": 1560615100, "last_edit_date": 1560972129, "question_id": 56612053, "link": "https://stackoverflow.com/questions/56612053/problem-with-using-rails-adfs-integration-gem-omiauth-wsfed", "title": "Problem with using Rails / ADFS integration gem omiauth-wsfed", "body": "<p>I have been trying to set my Ruby Rails App to be remotely accessed by a partner of mine which uses ADFS 2.0 for providing SSO possibilities. I have been using omniauth-wsfed gem but failed.</p>\n\n<p>I have set omniauth.rb as below:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :wsfed,\n      :issuer_name     =&gt; \"http://fs.sib.com.br/adfs/services/trust\",\n      :issuer                =&gt; \"https://fs.sib.com.br/adfs/ls/\",\n      :realm                 =&gt; \"https://qa.wit.com\",\n      :reply                 =&gt; \"https://qa.wit.com/students/auth/wsfed/callback\",\n      :saml_version     =&gt; \"2.0\",\n      :id_claim              =&gt; \"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\",\n      :idp_cert_fingerprint  =&gt; \"--94061be1aba531da005d5f22bf6796b7cd69b3---\"\nend\n</code></pre>\n\n<p>Error log is:</p>\n\n<pre><code>ERROR -- omniauth: (wsfed) Authentication failure! invalid_authn_token: OmniAuth::Strategies::WSFed::ValidationError, AuthN token (wresult) missing in callback.\n</code></pre>\n\n<p>Does anybody suspect what is wrong ?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560616104, "post_id": 56611736, "comment_id": 99799169, "body": "What is your question?"}, {"owner": {"reputation": 13, "user_id": 10971022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cebbbf63c06c729ea3b3109daa880af4?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Aytha", "link": "https://stackoverflow.com/users/10971022/aravind-aytha"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560618501, "post_id": 56611736, "comment_id": 99799719, "body": "@TomLord As I have to work on &quot;Signin with Google&quot; and &quot;Singin with facebook&quot; options, configured with all the required steps from gems - &quot;omniauth-google-oauth2&quot; and &quot;omniauth-facebook&quot;   For the first time, User will be created from the backed model User.rb <code>def self.from_omniauth(auth) \t..... end</code>  1st time - used Google 2nd time - used Facebook Facing Validation Error: &quot;Email has already been Taken&quot;"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560618742, "post_id": 56611736, "comment_id": 99799766, "body": "What do you expect to happen? You&#39;ve designed a system where each user has one <code>email</code> and one <code>provider</code>; so maybe it makes sense for the above to trigger an error?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560618892, "post_id": 56611736, "comment_id": 99799797, "body": "If a user signs up via two providers, should it (1) Be an error? (2) Create a second, independent user? (3) Merge with the original user (and what do you want to do about the <code>users.provider</code> value?)"}, {"owner": {"reputation": 13, "user_id": 10971022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cebbbf63c06c729ea3b3109daa880af4?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Aytha", "link": "https://stackoverflow.com/users/10971022/aravind-aytha"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560619426, "post_id": 56611736, "comment_id": 99799911, "body": "Thanks for the reply. I think 3rd option - merge with the original user would be better, as because currently user related provider value is not using anywhere in my application.  Email Validation code in User model as <code>devise :database_authenticatable, :registerable,          :recoverable, :rememberable, :validatable, :omniauthable, omniauth_providers: [:google_oauth2, :facebook]</code>"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560629341, "post_id": 56611736, "comment_id": 99802100, "body": "As I said in my previous comment -- What do you want to do about the <code>users.provider</code> value? If you &quot;merge&quot; the accounts, then you&#39;ll need to either (1) keep the original value, or (2) overwrite the value, or (3) change it to a has-many association (i.e. a separate database table)."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1560629700, "post_id": 56611736, "comment_id": 99802178, "body": "Either way, your fundamental problem is that the code is looking up: <code>User.where(provider: auth.provider ...</code>, but if you want to only determine users by the email then this must be simplified to <code>User.where(email: auth.info.email).first</code> (or you can equivalently use the <code>find_by</code> method instead)"}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1560617476, "creation_date": 1560617476, "answer_id": 56612356, "question_id": 56611736, "link": "https://stackoverflow.com/questions/56611736/how-to-handle-email-uniqueness-validation-in-user-creation-in-the-case-of-omniau/56612356#56612356", "title": "How to handle email uniqueness validation in User creation in the case of OmniAuth", "body": "<p>How about create another <code>UserProvider</code> model which <code>belongs_to</code> <code>User</code> model.</p>\n\n<p>So, when a user uses third party to sign up / sign in to your system, you can manage if the <code>email</code> is used or not to create new user. Then, you create new <code>UserProvider</code> record for that user if it's not there</p>\n\n<pre><code>user = User.where(:email =&gt; auth.info.email).first\nuser ||= User.create!(name: auth.info.name, email: auth.info.email, password: Devise.friendly_token[0,20])\n\nuser_provider = UserProvider.find_or_create_by(\n                                provider: auth.provider,\n                                uid: auth.uid,\n                                user_id: user.id\n                             )\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10971022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cebbbf63c06c729ea3b3109daa880af4?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Aytha", "link": "https://stackoverflow.com/users/10971022/aravind-aytha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560617579, "creation_date": 1560612537, "last_edit_date": 1560617579, "question_id": 56611736, "link": "https://stackoverflow.com/questions/56611736/how-to-handle-email-uniqueness-validation-in-user-creation-in-the-case-of-omniau", "title": "How to handle email uniqueness validation in User creation in the case of OmniAuth", "body": "<p>How to handle email validation in User creation?</p>\n\n<p>I am using multiple providers(google, facebook). As because of both Gmail and Facebook has been created with the same mail ID.</p>\n\n<pre><code>def self.from_omniauth(auth)\n    user = User.where(provider: auth.provider, email: auth.info.email).first\n    user ||= User.create!(provider: auth.provider, uid: auth.uid, name: auth.info.name, email: auth.info.email, password: Devise.friendly_token[0,20])\n    user\nend\n</code></pre>\n"}, {"tags": ["java", "ruby", "amazon-web-services", "aws-lambda"], "answers": [{"tags": [], "owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "is_accepted": true, "score": 1, "last_activity_date": 1560643343, "creation_date": 1560643343, "answer_id": 56615073, "question_id": 56611026, "link": "https://stackoverflow.com/questions/56611026/calling-aws-lambda-in-java-from-ruby-sdk-with-arguments/56615073#56615073", "title": "Calling AWS Lambda in Java from ruby SDK with arguments", "body": "<p>The <code>input.read()</code> command returns <strong>one character at a time</strong>.</p>\n\n<p>Here is sample code from <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/java-handler-io-type-stream.html\" rel=\"nofollow noreferrer\">Example: Using Stream for Handler Input/Output (Java) - AWS Lambda</a>:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>package example;\n\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport com.amazonaws.services.lambda.runtime.RequestStreamHandler;\nimport com.amazonaws.services.lambda.runtime.Context; \n\npublic class Hello implements RequestStreamHandler{\n    public void handler(InputStream inputStream, OutputStream outputStream, Context context) throws IOException {\n        int letter;\n        while((letter = inputStream.read()) != -1)\n        {\n            outputStream.write(Character.toUpperCase(letter));\n        }\n    }\n}\n</code></pre>\n\n<p>Therefore, your code is only reading one character, and it is coming through as an integer. <code>123</code> in ascii is the <code>{</code> character, which is the beginning of the JSON being passed to your function.</p>\n\n<p>So, you will need to keep reading until it returns <code>-1</code>.</p>\n\n<p><strong>Alternatively,</strong> you could use the normal method definition, taken from <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/java-programming-model-handler-types.html\" rel=\"nofollow noreferrer\">AWS Lambda Function Handler in Java - AWS Lambda</a>:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>outputType handler-name(inputType input, Context context) {\n   ...\n}\n</code></pre>\n\n<p>This will let you <strong>read your input as one string</strong>, rather than having to loop through the stream.</p>\n"}], "owner": {"reputation": 654, "user_id": 2596140, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/100000411131240/picture?type=large", "display_name": "Pedro Bernardes", "link": "https://stackoverflow.com/users/2596140/pedro-bernardes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56615073, "answer_count": 1, "score": 0, "last_activity_date": 1560643352, "creation_date": 1560607136, "last_edit_date": 1560643352, "question_id": 56611026, "link": "https://stackoverflow.com/questions/56611026/calling-aws-lambda-in-java-from-ruby-sdk-with-arguments", "title": "Calling AWS Lambda in Java from ruby SDK with arguments", "body": "<p>I'm trying to call a AWS Lambda function using Ruby SDK v3</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>    Aws::Lambda::Client.new.invoke_async(function_name: ENV[\"FUNCTION_NAME\"],\n                                         invoke_args: { mas: 'que caralho' }.to_json)\n</code></pre>\n\n<p>It gets called as expected, but if I print the args:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>    public void handleRequest(InputStream input, OutputStream output, Context context) {\n        String input_string = String.valueOf(input.read());\n        input.close();\n        logger.info(\"Received input: \" + input_string);\n        ...\n</code></pre>\n\n<p>They always come as \"123\". There's no 123 in my call D:</p>\n\n<p>I also came across the <code>payload</code> argument but it doesn't matter what I put there, it complains it is unexpected</p>\n\n<pre><code>ArgumentError: unexpected value at params[:payload]\n</code></pre>\n\n<p>Any help, please?</p>\n"}, {"tags": ["ruby", "webpack", "stimulusjs"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 8289374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4qBIm.png?s=128&g=1", "display_name": "SaintNerevar", "link": "https://stackoverflow.com/users/8289374/saintnerevar"}, "is_accepted": false, "score": 1, "last_activity_date": 1584475044, "last_edit_date": 1584475044, "creation_date": 1584470878, "answer_id": 60728539, "question_id": 56610234, "link": "https://stackoverflow.com/questions/56610234/rails-ujs-link-to-destroy-action-not-working-properly-after-migrating-to-webpack/60728539#60728539", "title": "Rails UJS link_to destroy action not working properly after migrating to webpack", "body": "<p>This might be too late but I had a similar problem when trying to learn rails. I found out that I hadn't included the line<br>\n<code>= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload'</code><br>\nin <em>app/assets/layouts/application.html.haml</em></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11533283, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kH1wmEjg0nI/AAAAAAAAAAI/AAAAAAAAXw8/ZqJJYgN8Bp4/photo.jpg?sz=128", "display_name": "shamiwizard", "link": "https://stackoverflow.com/users/11533283/shamiwizard"}, "is_accepted": false, "score": 0, "last_activity_date": 1599166763, "creation_date": 1599166763, "answer_id": 63731565, "question_id": 56610234, "link": "https://stackoverflow.com/questions/56610234/rails-ujs-link-to-destroy-action-not-working-properly-after-migrating-to-webpack/63731565#63731565", "title": "Rails UJS link_to destroy action not working properly after migrating to webpack", "body": "<p>I had the same problem in my situation it's happens because I created <code>application.scss</code> in <code>app/javascript/pack/</code></p>\n<p>If I move .scss file to stylesheet all works is fine)</p>\n"}], "owner": {"reputation": 121, "user_id": 11488922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a781b6fb23434621f617efcd4d9777?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastiaanpoppen", "link": "https://stackoverflow.com/users/11488922/sebastiaanpoppen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1599166763, "creation_date": 1560600363, "question_id": 56610234, "link": "https://stackoverflow.com/questions/56610234/rails-ujs-link-to-destroy-action-not-working-properly-after-migrating-to-webpack", "title": "Rails UJS link_to destroy action not working properly after migrating to webpack", "body": "<p>I have a project with Rails/webpacker/stimulus. Today I migrated the asset pipeline to webpacker. All went fine except for one detail.</p>\n\n<p>Link_to buttons with a call to a destroy method direct to the show action instead. Also the remote:true tag isn't working. The ajax:beforeSend actions are not triggered and the confirm box is not loaded anymore.</p>\n\n<pre><code>&lt;%= link_to sanitize(\"&lt;i class='fa fa-trash'&gt;&lt;/i&gt;\"), dashboard_manager_dashboard_path(dashboard), remote: true, method: :delete, data: {\n                            confirm: \"sure?\",\n                            action: 'ajax:beforeSend-&gt;dm--dashboard#onBeforeDelete ajax:success-&gt;dm--dashboard#onDelete'\n                        } %&gt;\n</code></pre>\n\n<p>I found a number of similar cases on Stackoverflow and most mention that Rails UJS is not properly loaded, which might seem to be the case here as well. The problems in these example however don't use webpack.</p>\n\n<p>Some posts on Stackoverflow mention to use button_to instead of link_to. But this is not the solution I am looking for, I want to be able to use the remote:true and ajax callbacks.</p>\n\n<p>Does anyone see the flaw in my setup? Thanks in advance for any suggestions!</p>\n\n<p>Application.js:</p>\n\n<pre><code>import Rails from 'rails-ujs';\nimport Turbolinks from 'turbolinks';\nimport * as ActiveStorage from 'activestorage';\n\nRails.start();\nTurbolinks.start();\nActiveStorage.start();\n\nimport \"../src/import-jquery\";\nimport 'bootstrap/dist/js/bootstrap';\nimport 'tempusdominus-bootstrap-4';\nimport '../src/bootstrap-select.js';\nimport '../src/custom_calender.js';\nimport '../src/functions.js';\n\nimport { Application } from \"stimulus\"\nimport { definitionsFromContext } from \"stimulus/webpack-helpers\"\nconst application = Application.start();\nconst context = require.context(\"controllers\", true, /.js$/);\napplication.load(definitionsFromContext(context));\n</code></pre>\n\n<p>Package.json:</p>\n\n<pre><code>{\n    \"name\": \"Youba\",\n    \"private\": true,\n    \"version\": \"1.0\",\n    \"dependencies\": {\n        \"@babel/core\": \"^7.4.4\",\n        \"@rails/ujs\": \"^6.0.0-alpha\",\n        \"@rails/webpacker\": \"^4.0.2\",\n        \"activestorage\": \"^5.2.3\",\n        \"babel-loader\": \"^8.0.6\",\n        \"bootstrap\": \"^4.3.1\",\n        \"bootstrap-select\": \"^1.13.10\",\n        \"choices.js\": \"^7.0.0\",\n        \"jquery\": \"^3.4.1\",\n        \"jquery-ui\": \"^1.12.1\",\n        \"jquery-ujs\": \"^1.2.2\",\n        \"moment\": \"^2.24.0\",\n        \"moment-timezone\": \"^0.5.11\",\n        \"popper\": \"^1.0.1\",\n        \"popper.js\": \"^1.14.7\",\n        \"rails-ujs\": \"^5.2.3\",\n        \"stimulus\": \"^1.1.1\",\n        \"tempusdominus-bootstrap-4\": \"^5.1.2\",\n        \"tempusdominus-core\": \"5.0.3\",\n        \"turbolinks\": \"^5.2.0\",\n        \"webpack\": \"^4.0.0\",\n        \"webpack-cli\": \"^3.3.2\"\n    },\n    \"devDependencies\": {\n        \"webpack-dev-server\": \"^3.2.1\"\n    }\n}\n</code></pre>\n\n<p>environment.js</p>\n\n<pre><code>const {environment} = require('@rails/webpacker');\n\nconst webpack = require('webpack');\nenvironment.plugins.append('Provide', new webpack.ProvidePlugin({\n    $: 'jquery',\n    jQuery: 'jquery',\n    jquery: 'jquery',\n    Popper: ['popper.js', 'default']\n}));\n\nmodule.exports = environment;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1560597207, "post_id": 56609765, "comment_id": 99794601, "body": "Use a dedicated gem for that. <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty</a> is a great example."}, {"owner": {"reputation": 8143, "user_id": 537943, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/910d6caf7e77a69b61fbf0b4e0d32532?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/537943/tom"}, "reply_to_user": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1560597471, "post_id": 56609765, "comment_id": 99794653, "body": "@Richard-Degenne tried rest-client without success"}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1560597851, "post_id": 56609765, "comment_id": 99794733, "body": "Also, I see that you are trying to do string interpolation within your <code>filter</code> field. You don&#39;t need to do that, since <code>JSON.dump</code> with recursively serialize data structures."}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 1, "creation_date": 1560610722, "post_id": 56609765, "comment_id": 99797815, "body": "<code>&quot;{&quot;dealTypes&quot;:[&quot;FOR_SALE&quot;],&quot;addBulletinFromPrivate&quot;:true,&quot;ad&zwnj;&#8203;dBulletinFromAgent&quot;:&zwnj;&#8203;true,&quot;addProjects&quot;:t&zwnj;&#8203;rue,&quot;propertyTypes&quot;:&zwnj;&#8203;[],&quot;conditions&quot;:[]}&quot;&zwnj;&#8203;,</code> I suspect that string doesn&#39;t get parsed correctly. I&#39;d try escaping the inner quotes <code>&quot;</code> with a backslash like <code>&quot;{\\&quot;dealTypes\\&quot;:[\\&quot;FOR_SALE\\&quot;],\\&quot;addBulletinFromPrivate\\&quot;:tr&zwnj;&#8203;ue,\\&quot;addBulletinFrom&zwnj;&#8203;Agent\\&quot;:true,\\&quot;addPr&zwnj;&#8203;ojects\\&quot;:true,\\&quot;prop&zwnj;&#8203;ertyTypes\\&quot;:[],\\&quot;con&zwnj;&#8203;ditions\\&quot;:[]}&quot;,</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "is_accepted": false, "score": 1, "last_activity_date": 1560597707, "creation_date": 1560597707, "answer_id": 56609879, "question_id": 56609765, "link": "https://stackoverflow.com/questions/56609765/how-to-make-a-proper-post-request-in-rails-while-converting-from-curl/56609879#56609879", "title": "How to make a proper POST request in Rails (while converting from Curl)?", "body": "<p>Use a dedicated gem for that. <a href=\"https://github.com/jnunemaker/httparty\" rel=\"nofollow noreferrer\">HTTParty</a> is a great example.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class MyAPI\n  include HTTParty\n\n  base_uri 'https://www.somedomain.com/api/public/v1.0'\n  headers 'Content-Type' =&gt; 'application/json', 'Accept' =&gt; 'application/json'\nend\n</code></pre>\n\n<pre class=\"lang-rb prettyprint-override\"><code>MyAPI.post(\n  '/markers/list', body: {\n    \"sortBy\" =&gt; \"auto\",\n    # ...  \n  }.to_json\n)\n</code></pre>\n\n<p>Of course, depending on the actual contents of the response, you will need to do some parsing, but HTTParty is able to parse automatically if the response <code>Content-Type</code> header is correctly set.</p>\n"}], "owner": {"reputation": 8143, "user_id": 537943, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/910d6caf7e77a69b61fbf0b4e0d32532?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/537943/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1560597707, "creation_date": 1560596802, "question_id": 56609765, "link": "https://stackoverflow.com/questions/56609765/how-to-make-a-proper-post-request-in-rails-while-converting-from-curl", "title": "How to make a proper POST request in Rails (while converting from Curl)?", "body": "<p>I'm trying to convert a Curl request into my Rails app. It seems that the online converter that I'm using is kind of buggy.</p>\n\n<p>The current state is:</p>\n\n<pre><code>require 'net/http'\nrequire 'uri'\nrequire 'json'\n\nclass Listing &lt; ApplicationRecord\n\n    def getit2\n        uri = URI.parse(\"https://www.somedomain.com/api/public/v1.0/markers/list\")\n        request = Net::HTTP::Post.new(uri)\n        request.content_type = \"application/json\"\n        request[\"Origin\"] = \"https://www.somedomain.com\"\n        request[\"Accept-Language\"] = \"en-US,en;q=0.9,ar;q=0.8,bg;q=0.7,de;q=0.6,es;q=0.5,fr;q=0.4,he;q=0.3,hu;q=0.2,it;q=0.1,ms;q=0.1,nl;q=0.1,nb;q=0.1,ru;q=0.1,sk;q=0.1,sv;q=0.1,tr;q=0.1,vi;q=0.1,zh-CN;q=0.1,zh;q=0.1\"\n        request[\"User-Agent\"] = \"Mozilla/5.0 (Linux; Android 4.0; Nexus 5 Build/MRA58N) AppleWebKit/535.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Mobile Safari/537.36\"\n        request[\"Accept\"] = \"application/json\"\n        request[\"Referer\"] = \"https://www.google.co.uk\"\n        request[\"Cookie\"] = \"_pxhd=2f7043c8ae569c7ddddd12207ac90cca0ef2a40d61378c41112492:46c5aca1-7401-11e9-ab6d-251d1e721a9f; _gcl_au=1.1.2102026563.1557588441; Infinite_lastSearch_key=; Infinite_user_id_key=7ba2e36f-2a47-46bf-a275-04d5b2cbe965; Infinite_ab_tests_context_key={%22context%22:{%22price_estimation%22:%22false%22%2C%22display_sold%22:%22false%22%2C%22display_sold_v2%22:%22true%22%2C%22price_estimation_v2%22:%22true%22%2C%22price_estimation_v3%22:%22false%22}%2C%22values%22:{%22price_estimation%22:%22false%22%2C%22display_sold%22:%22false%22%2C%22display_sold_v2%22:%22true%22%2C%22price_estimation_v2%22:%22true%22%2C%22price_estimation_v3%22:%22false%22}}; _pxvid=46c5aca1-7401-11e9-ab6d-251d1e721a9f; _ga=GA1.3.1522435888.1557588443; _gid=GA1.3.1336624029.1560436285; AWSELB=CD9FE1B30E32EDF52EB77EE30BE426CF7F363C127FE2A9BC2F70F9F1CDD10FF86A1B4095995C86A57A485BDD3A564FE18D63589FAE6A0457DFADBDFF864B86DAA86999D390; _sp_id.549d=457ec9d1-91b0-4e92-a50a-1d6517ccb887.1560168270.6.1560586655.1560522000.895c4b58-2ee1-45ca-bf34-b0e4716eac0d; _ud=0f90bb52e08b81cc0d5493b6de1c53b81d7a25c4-cid=116ea8bc-6bbd-4661-b5a6-f65725ec0e6d&amp;_ts=1560595069960; _dc_gtm_UA-26019961-1=1; _px3=d331cc7dc802bed39645428247a9f83be0c89dc82d9c549bad4bc2bfe2823676:XUO7Topo8ACRMvx9jjEXR5qW+CpujeC0thydfP6jHjpGr4G0iPU2Qm4m5IDAn/Pk8qsHxJKaowm58pMULV9MIw==:1000:dqOcC/gfWU9y/hUxvT6akY2ZBKdd+M5HDrxR9UaggnszreSjIkckWJVscq59PjoRCAiNJhfIEGaHC++sor4DUOc4iwZRQgthPouxNYgqkeKCqjPXwOrsSBppi1Yh3L3AF+2Kv/msYsE+F7ol8ALbGQQp3LkYOa4ta1RIZeLhHTQ=\"\n        request[\"Connection\"] = \"keep-alive\"\n        request.body = JSON.dump({\n          \"sortBy\" =&gt; \"auto\",\n          \"areaId\" =&gt; \"the area\",\n          \"isStreetAreaId\" =&gt; false,\n          \"filters\" =&gt; \"{\"dealTypes\":[\"FOR_SALE\"],\"addBulletinFromPrivate\":true,\"addBulletinFromAgent\":true,\"addProjects\":true,\"propertyTypes\":[],\"conditions\":[]}\",\n          \"zoom\" =&gt; 11.366136034830756,\n          \"NELat\" =&gt; 1,\n          \"NELng\" =&gt; 1,\n          \"SWLat\" =&gt; 1,\n          \"SWLng\" =&gt; 1,\n          \"slim\" =&gt; true\n        })\n\n        req_options = {\n          use_ssl: uri.scheme == \"https\",\n        }\n\n        response = Net::HTTP.start(uri.hostname, uri.port, req_options) do |http|\n          http.request(request)\n        end\n    end\nend\n</code></pre>\n\n<p>And the console is raising this error:</p>\n\n<blockquote>\n  <p>/app/models/listing.rb:38: syntax error, unexpected tIDENTIFIER,\n  expecting '}'\n          \"filters\" => \"{\"dealTypes\":[\"FOR_SALE\"],\"addBulletinFr...\n                                   ^</p>\n</blockquote>\n\n<p>It seems that it fails in the <code>filters</code> data point. How should it be structured to create a valide request?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "owner": {"reputation": 1263, "user_id": 10221813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160530708235447/picture?type=large", "display_name": "uno", "link": "https://stackoverflow.com/users/10221813/uno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560584234, "creation_date": 1560584234, "question_id": 56608380, "link": "https://stackoverflow.com/questions/56608380/fields-for-form-with-index-not-finding-parameter", "title": "fields_for form with_index not finding parameter", "body": "<p>I'm submitting a form with the following issues:</p>\n\n<p>Parameters pass that aren't filled out <code>and</code> \nWon't find associated model attributes that are passed.</p>\n\n<p>Form:</p>\n\n<pre><code>...\n&lt;% PrintLocation.all.each.with_index do |print_location, index| %&gt;\n   &lt;%= print_location.title %&gt;\n   &lt;%= f.fields_for :shop_product_print_files_attributes, index: index, multiple: true do |a| %&gt;\n       &lt;%= a.text_field :print_file %&gt;\n       &lt;%= a.hidden_field :print_location_id, value: print_location.id %&gt;\n       &lt;%= a.hidden_field :shop_product_id, value: shop_product.id %&gt;\n   &lt;% end %&gt;\n&lt;% end %&gt;\n...\n</code></pre>\n\n<p>Passing Params:</p>\n\n<pre><code>, \"shop_product_print_files_attributes\"=&gt;{\"0\"=&gt;{\"print_file\"=&gt;\"a\", \"print_location_id\"=&gt;\"1\", \"shop_product_id\"=&gt;\"45\"}, \"1\"=&gt;{\"print_file\"=&gt;\"\", \"print_location_id\"=&gt;\"2\", \"shop_product_id\"=&gt;\"45\"}, \"2\"=&gt;{\"print_file\"=&gt;\"\", \"print_location_id\"=&gt;\"3\", \"shop_product_id\"=&gt;\"45\"}, \"3\"=&gt;{\"print_file\"=&gt;\"\", \"print_location_id\"=&gt;\"4\", \"shop_product_id\"=&gt;\"45\"}, \"4\"=&gt;{\"print_file\"=&gt;\"\", \"print_location_id\"=&gt;\"5\", \"shop_product_id\"=&gt;\"45\"}, \"5\"=&gt;{\"print_file\"=&gt;\"\", \"print_location_id\"=&gt;\"6\", \"shop_product_id\"=&gt;\"45\"}},\n</code></pre>\n\n<p>Models:</p>\n\n<pre><code>class ShopProductPrintFile &lt; ApplicationRecord\n  belongs_to :shop_product\n  belongs_to :print_location\nend\n\nclass PrintLocation &lt; ApplicationRecord\n  has_many :shop_products, through: :shop_product_print_files\n  has_many :shop_product_print_files\n  accepts_nested_attributes_for :shop_product_print_files\nend\n\nclass ShopProduct &lt; ApplicationRecord\n...\n  has_many :shop_product_print_files\n  has_many :print_locations, through: :shop_product_print_files\n  accepts_nested_attributes_for :shop_product_print_files\n\nend\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>  def new\n    @shop_product = ShopProduct.new\n    @shop_product.shop_product_print_files.build\n  end\n\n  def create\n    @shop_product = ShopProduct.new(shop_product_params)\n    @shop_product.shop_product_print_files.build(print_location_id: params[\"shop_product\"][\"shop_product_print_files_attributes\"][\"print_location_id\"])\n    shop = Shop.find(params[\"shop_product\"][\"shop_id\"])\n    product = Product.find(params[\"shop_product\"][\"product_id\"])\n    @shop_product.product_id = product.id\n    @shop_product.shop_id = shop.id\n\n    respond_to do |format|\n      if @shop_product.save!\n        ...\n    end\n  end\n\n  def update\n    @shop_product = ShopProduct.find_by(store_variant_id: params[\"shop_product\"][\"store_variant_id\"])\n    @shop_product.shop_product_print_files.build(shop_product_id: @shop_product.id, print_location_id: params[\"shop_product\"][\"shop_product_print_files_attributes\"][\"print_location_id\"])\n    @product = Product.find(params[\"shop_product\"][\"product_id\"])\n\n    respond_to do |format|\n      if @shop_product.update(shop_product_params)\n        ...\n    end\n  end\n\nprivate\n\ndef shop_product_params\n   params.require(:shop_product).permit(...., :shop_product_print_files_attributes =&gt; [:id, :print_file, :print_location_id, :shop_product_id])\nend\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Shop product print files print location must exist\n</code></pre>\n\n<p>The biggest issue is the print_location isn't being found, but why not?</p>\n\n<p>Aside from that, why are all of the params being sent through even when <code>print_file</code> is blank?</p>\n\n<p>Before I wasn't using the <code>each.with_index</code> and using the <code>index: index</code> in the form.  With that, the form would submit and create the <code>shop_product_print_files</code>,but the issue was it would only pass the last value in the PrintLocation loop, <code>\"6\"</code> and <code>1-5</code> would be voided.  when i installed the use of the index code, everything would pass but EVERYTHING would pass and not be saved with the error mentioned above.</p>\n\n<p>What can I do to have only params go through that aren't blank, and have them be found?  </p>\n"}]