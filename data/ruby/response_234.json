[{"tags": ["ruby", "shopify"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1562185415, "post_id": 56877370, "comment_id": 100303398, "body": "Tip: It&#39;s been ages since Ruby 1.9 came on the scene and introduced the <code>params: { ... }</code> hash notation. The <code>=&gt;</code> Ruby 1.8 style is no longer necessary as 1.8 is extinct."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562186325, "post_id": 56877592, "comment_id": 100303774, "body": "Do you mean <code>product.save</code> or <code>variant.save</code>? I need to update each products cost (it&#39;s displayed as &quot;Cost per item&quot; in each product in the App)."}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562186502, "post_id": 56877592, "comment_id": 100303836, "body": "do u want to add a new attribute to product? u can use <code>metafield</code>"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562187460, "post_id": 56877592, "comment_id": 100304226, "body": "@user11736353 it depends. If you show <code>product variant price</code> on your app, it will be <code>variant.save</code>, if u use <code>product.price</code> to show on ur app, it will be <code>product.price = new_price</code>, <code>product.save</code>"}, {"owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562187826, "post_id": 56877592, "comment_id": 100304343, "body": "I am talking about the Shopify iOS App."}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562188914, "post_id": 56877592, "comment_id": 100304760, "body": "So I think u need to save product\u2019s variant price as in my answer"}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": false, "score": 1, "last_activity_date": 1562186476, "last_edit_date": 1562186476, "creation_date": 1562186136, "answer_id": 56877592, "question_id": 56877370, "link": "https://stackoverflow.com/questions/56877370/update-shopify-product-cost-and-price-using-ruby/56877592#56877592", "title": "Update Shopify product cost and price using Ruby", "body": "<p>In order to update product variant, I think calling the <code>save</code> method is necessary</p>\n\n<pre><code>variant = product.variants.first\nvariant.price = new_price\nvariant.save\n</code></pre>\n\n<p><code>product cost</code> mentioned is <code>order</code>? You should use <code>ShopifyAPI::Order</code> ( check this <a href=\"https://github.com/Shopify/shopify_api/tree/261cfe7b373786ea0f7cb3e90de694f99d419d96/test\" rel=\"nofollow noreferrer\">sample</a>  and the <a href=\"https://help.shopify.com/en/api/graphql-admin-api/reference/object/order\" rel=\"nofollow noreferrer\">api</a> )</p>\n\n<p>If you need other attribute for product, check out the <code>metafields</code> using <code>ShopifyAPI::Metafield</code></p>\n\n<p>FYI, <code>Order</code> has <code>line_items</code> property and we also have <code>ShopifyAPI:LineItem</code> if u find it helpful</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 0, "creation_date": 1562233813, "post_id": 56879758, "comment_id": 100317756, "body": "The price is not available using <a href=\"https://help.shopify.com/en/api/reference/inventory/inventoryitem\" rel=\"nofollow noreferrer\">help.shopify.com/en/api/reference/inventory/inventoryitem</a>."}, {"owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "reply_to_user": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "edited": false, "score": 1, "creation_date": 1562248477, "post_id": 56879758, "comment_id": 100325847, "body": "Even easier then! Just use the old variant.price and be done. Change all variant prices and make one API to save the product for speed. I was confused thinking you wanted access to the cost prices, which are different."}], "tags": [], "owner": {"reputation": 8203, "user_id": 210841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5adbe9e20522d6a177e76b223b6750ed?s=128&d=identicon&r=PG", "display_name": "David Lazar", "link": "https://stackoverflow.com/users/210841/david-lazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562205728, "creation_date": 1562205728, "answer_id": 56879758, "question_id": 56877370, "link": "https://stackoverflow.com/questions/56877370/update-shopify-product-cost-and-price-using-ruby/56879758#56879758", "title": "Update Shopify product cost and price using Ruby", "body": "<p>I don't think you can still update product (variant) prices like that. You will likely have to first loop through the product variants, and for each one you get an inventory_item_id. You use that to get the inventory item details. With the inventory item details, you can set the price and cost price, and SKU. </p>\n\n<p>It used to be so much simpler! Another option for you is to use a mutation on the variant, and set prices with the GraphQL API. In either case, you are forced to update using the inventory item attributes and not variant price.</p>\n"}], "owner": {"reputation": 47, "user_id": 11736353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2addd684a803ad395bc651a0fdc38b27?s=128&d=identicon&r=PG&f=1", "display_name": "user11736353", "link": "https://stackoverflow.com/users/11736353/user11736353"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562205728, "creation_date": 1562185013, "question_id": 56877370, "link": "https://stackoverflow.com/questions/56877370/update-shopify-product-cost-and-price-using-ruby", "title": "Update Shopify product cost and price using Ruby", "body": "<p>I am using Shopify's <code>shopify_api</code> gem in Ruby.</p>\n\n<p>I need to update each products cost and price from an external source.</p>\n\n<pre><code>products = ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit})\n\nproducts.each do |product|\n        #product.variants.first.price == price\n    end\nend\n</code></pre>\n\n<p>Is this the correct way to update a products price?</p>\n\n<p>Do I need to do <code>product.variants.first.save</code> after I have done <code>product.variants.first.price == price</code> or is that done automatically?</p>\n\n<p>How can I update the products cost (<code>product.variants.first.cost</code> doesn't seem to exist)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 11614813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9758babe08fcbda06bcbfc9834c88611?s=128&d=identicon&r=PG&f=1", "display_name": "L1zardK1ng", "link": "https://stackoverflow.com/users/11614813/l1zardk1ng"}, "is_accepted": false, "score": 1, "last_activity_date": 1562180808, "creation_date": 1562180808, "answer_id": 56876534, "question_id": 56876400, "link": "https://stackoverflow.com/questions/56876400/how-to-determine-which-controller-has-been-called-from-applicationcontroller/56876534#56876534", "title": "How to determine which controller has been called from ApplicationController?", "body": "<p>You can use <code>request.referrer</code> to get the path of the previous action. </p>\n\n<p>To get the controller responsible for that action, use:  <code>Rails.application.routes.recognize_path(request.referrer)[:controller]</code></p>\n"}, {"tags": [], "owner": {"reputation": 9297, "user_id": 764546, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OfNpk.jpg?s=128&g=1", "display_name": "MikDiet", "link": "https://stackoverflow.com/users/764546/mikdiet"}, "is_accepted": false, "score": 1, "last_activity_date": 1562181035, "creation_date": 1562181035, "answer_id": 56876588, "question_id": 56876400, "link": "https://stackoverflow.com/questions/56876400/how-to-determine-which-controller-has-been-called-from-applicationcontroller/56876588#56876588", "title": "How to determine which controller has been called from ApplicationController?", "body": "<p>You could define private method <code>def my_controller?; end</code> in <code>ApplicationController</code>, and use filter <code>before_action :recent_discussions, if: :my_controller?</code></p>\n\n<p>Then, in controllers you want this code actually run, redefine <code>def my_controller?; true; end</code></p>\n"}, {"tags": [], "owner": {"reputation": 358, "user_id": 4691741, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-FwZnZ4lk0wc/AAAAAAAAAAI/AAAAAAAABLU/OpACk4POs6U/photo.jpg?sz=128", "display_name": "niborg", "link": "https://stackoverflow.com/users/4691741/niborg"}, "is_accepted": false, "score": 2, "last_activity_date": 1562181839, "last_edit_date": 1562181839, "creation_date": 1562181359, "answer_id": 56876673, "question_id": 56876400, "link": "https://stackoverflow.com/questions/56876400/how-to-determine-which-controller-has-been-called-from-applicationcontroller/56876673#56876673", "title": "How to determine which controller has been called from ApplicationController?", "body": "<p>Presuming you meant <code>||</code> instead of <code>&amp;&amp;</code> in your question's pseudo code (<code>&amp;&amp;</code> makes no sense), this would work:</p>\n\n<pre><code>FANCY_CONTROLLERS = %w[FirstController SecondController ThirdController]\nbefore_action :recent_discussions,\n  if: proc { FANCY_CONTROLLERS.include? \"#{controller_name.camelize}Controller\" }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "is_accepted": false, "score": 2, "last_activity_date": 1562182373, "creation_date": 1562182373, "answer_id": 56876857, "question_id": 56876400, "link": "https://stackoverflow.com/questions/56876400/how-to-determine-which-controller-has-been-called-from-applicationcontroller/56876857#56876857", "title": "How to determine which controller has been called from ApplicationController?", "body": "<p>Put this in your application controller </p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class ApplicationController &lt; ActionController::Base\n  # more code\n\n  def special_controller?\n    controller = params[:controller]\n    special_controllers = %w(first second third)\n    special_controllers.include? controller\n  end\nend\n</code></pre>\n\n<p>And put this in your special controllers</p>\n\n<pre><code>class FirstController &lt; ApplicationController\n  before_action :recent_discussions, if: :special_controller?\n\n  # more code\nend\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 7614941, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e1ce1f96528ab233b12f9a66f4ed86d6?s=128&d=identicon&r=PG&f=1", "display_name": "andrzej541", "link": "https://stackoverflow.com/users/7614941/andrzej541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1562197748, "creation_date": 1562180097, "last_edit_date": 1562197748, "question_id": 56876400, "link": "https://stackoverflow.com/questions/56876400/how-to-determine-which-controller-has-been-called-from-applicationcontroller", "title": "How to determine which controller has been called from ApplicationController?", "body": "<p>I would like to put one method inside my <code>ApplicationController</code> and launch it only in case when some controllers are called. Similarly to devise parameters sanitizer: </p>\n\n<pre><code>before_action :configure_permitted_parameters, if: :devise_controller?\n</code></pre>\n\n<p>I've tried: </p>\n\n<pre><code>before_action :recent_discussions, if: :first_controller? || :second_controller? || :third_controller?\n</code></pre>\n\n<p>However <code>first_controller?</code> etc are undefined methods.</p>\n\n<p>Is there a way to call something in <code>ApplicationController</code> only under specific controllers?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "graphql"], "answers": [{"tags": [], "owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "is_accepted": true, "score": 1, "last_activity_date": 1562252177, "creation_date": 1562252177, "answer_id": 56890466, "question_id": 56876247, "link": "https://stackoverflow.com/questions/56876247/rails-graphql-nested-mutation-query-structure/56890466#56890466", "title": "Rails GraphQL nested mutation/query structure", "body": "<p>Unfortunately this is something that is not permitted by the GraphQL Specification (<a href=\"https://graphql.github.io/graphql-spec/June2018/\" rel=\"nofollow noreferrer\">https://graphql.github.io/graphql-spec/June2018/</a>).</p>\n"}], "owner": {"reputation": 91, "user_id": 3593112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c06a88fe57b5aebebb96dd938b5df99?s=128&d=identicon&r=PG&f=1", "display_name": "denqxotl", "link": "https://stackoverflow.com/users/3593112/denqxotl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 56890466, "answer_count": 1, "score": 1, "last_activity_date": 1562252177, "creation_date": 1562179380, "question_id": 56876247, "link": "https://stackoverflow.com/questions/56876247/rails-graphql-nested-mutation-query-structure", "title": "Rails GraphQL nested mutation/query structure", "body": "<p>I need some way to structurize GraphQL API in Rails.\nI see that most developers do big chain of GraphQL queries and mutation like </p>\n\n<pre><code>{\n  mutation {\n    updateProfile(firstName: \"Luke\", lastname: \"Skywalker\") {\n      id\n      firstName\n      lastName\n    }\n  }\n}\n</code></pre>\n\n<pre><code>{\n  mutation {\n    deleteProfile()\n  }\n}\n</code></pre>\n\n<p>etc.</p>\n\n<p>I'd like to have something like namespaces. Example</p>\n\n<p>For example </p>\n\n<pre><code>{\n  mutation {\n   me {\n     profile {\n       update(firstName: \"Luke\", lastname: \"Skywalker\") {\n         id\n         firstName\n         lastName\n       }\n     }\n   }\n  }\n}\n</code></pre>\n\n<p>Thank u all for answers</p>\n"}, {"tags": ["ruby", "jmeter"], "answers": [{"tags": [], "owner": {"reputation": 46525, "user_id": 7294900, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Pdqi4.gif?s=128&g=1", "display_name": "user7294900", "link": "https://stackoverflow.com/users/7294900/user7294900"}, "is_accepted": false, "score": 0, "last_activity_date": 1562855918, "last_edit_date": 1562855918, "creation_date": 1562220359, "answer_id": 56881557, "question_id": 56875435, "link": "https://stackoverflow.com/questions/56875435/how-to-run-rb-script-using-jmeter-gui/56881557#56881557", "title": "How to run .rb script using jmeter gui", "body": "<p>You can execute ruby in JMeter using jruby script engine</p>\n\n<ol>\n<li><p><a href=\"http://www.java2s.com/Code/Jar/j/Downloadjrubyenginejar.htm\" rel=\"nofollow noreferrer\">Dowonload</a> jruby-engine.jar</p></li>\n<li><p>Copy to JMeter lib directory with ruby relevant jars (as jruby-core)</p></li>\n<li><p>In JSR223 choose language as <code>jruby</code></p></li>\n<li><p>Write your ruby script and run test</p></li>\n</ol>\n\n<p>Notice that JRuby find predefined variable using $ prefix:</p>\n\n<pre><code>$log.info(\"Hello from JRuby\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116880, "user_id": 2897748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d278f6ada8828c902a13ee8a5e523cce?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitri T", "link": "https://stackoverflow.com/users/2897748/dmitri-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1562588486, "creation_date": 1562588486, "answer_id": 56934845, "question_id": 56875435, "link": "https://stackoverflow.com/questions/56875435/how-to-run-rb-script-using-jmeter-gui/56934845#56934845", "title": "How to run .rb script using jmeter gui", "body": "<p>You can use <a href=\"https://jmeter.apache.org/usermanual/component_reference.html#OS_Process_Sampler\" rel=\"nofollow noreferrer\">OS Process Sampler</a> to invoke whatever external command or program from JMeter test script. </p>\n\n<p>Example configuration:</p>\n\n<p><a href=\"https://i.stack.imgur.com/26gOR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/26gOR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Change:</p>\n\n<ul>\n<li><code>c:\\apps\\ruby\\bin\\ruby.exe</code> to the actual path to your <code>ruby</code> executable</li>\n<li><code>c:\\temp\\script.rb</code> to the actual path of your .rb script</li>\n</ul>\n\n<p>More information: <a href=\"https://www.blazemeter.com/blog/how-run-external-commands-and-programs-locally-and-remotely-jmeter/\" rel=\"nofollow noreferrer\">How to Run External Commands and Programs Locally and Remotely from JMeter</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11239646, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g-RGheCOr2I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfa1gS4qm8BVFTh7WNtoiBKF5ySsQ/mo/photo.jpg?sz=128", "display_name": "Smiths", "link": "https://stackoverflow.com/users/11239646/smiths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 56934845, "answer_count": 2, "score": 0, "last_activity_date": 1562855918, "creation_date": 1562175561, "question_id": 56875435, "link": "https://stackoverflow.com/questions/56875435/how-to-run-rb-script-using-jmeter-gui", "title": "How to run .rb script using jmeter gui", "body": "<p>I am trying to perform load test using jmeter. I have my script to extract and generate .json output file which is using ruby. Now i want to use this output.json ( which changes with every thread event) in jmeter and run it with 100 threads. How do I call .rb using jmeter gui?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 1, "creation_date": 1562178808, "post_id": 56875208, "comment_id": 100300733, "body": "Have you tried to remove <code>Gemfile.lock</code> and run <code>bundle</code>?"}, {"owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562193560, "post_id": 56875208, "comment_id": 100305933, "body": "you were right, thanks a lot. I thought with bundle install file is overwritten, i.e., deleted and then written again."}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562215037, "creation_date": 1562174444, "last_edit_date": 1562215037, "question_id": 56875208, "link": "https://stackoverflow.com/questions/56875208/unable-to-install-capistrano-gem-locally-during-rails-update", "title": "Unable to install Capistrano gem locally during Rails update", "body": "<p>I am trying to install Capistrano gem locally but I am getting following error while updating a Rails project from Rails 4 to Rails 5.</p>\n\n<p>Here is the information:</p>\n\n<p>Ruby version:</p>\n\n<pre><code>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-darwin17]\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngit_source(:github) { |repo| \"https://github.com/#{repo}.git\" }\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\ngem 'rails', '5.2.3'\n\n...\n\ngroup :development, :test do\n  gem 'capistrano',  '~&gt; 3.1'\n  gem 'capistrano-rails', '~&gt; 1.1', :require =&gt; false\n  gem 'capistrano-rvm', :require =&gt; false\n  gem 'capistrano-bundler', :require =&gt; false\n  gem 'capistrano-thin', :require =&gt; false, :github =&gt; 'freego/capistrano-thin'\n  gem 'capistrano-sidekiq', github: 'seuros/capistrano-sidekiq'\nend\n</code></pre>\n\n<p>When I try to <code>bundle install</code> all the gems, I find following error:</p>\n\n<pre><code>Traceback (most recent call last):\n    2: from ./bin/bundle:3:in `&lt;main&gt;'\n    1: from /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:263:in `bin_path'\n/Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:289:in `find_spec_for_exe': Could not find 'bundler' (1.14.3) required by your /Users/albert/localDocuments/CodingArea/Clients/hanspeter/book/Gemfile.lock. (Gem::GemNotFoundException)\nTo update to the lastest version installed on your system, run `bundle update --bundler`.\nTo install the missing version, run `gem install bundler:1.14.3`\n</code></pre>\n\n<p>If I try to update my bundler gem, as it is suggested, I find following error:</p>\n\n<pre><code>bundle update --bundler                                                               [2.5.0]\nYour Gemfile lists the gem annotate (&gt;= 0) more than once.\nYou should probably keep only one of them.\nRemove any duplicate entries and specify the gem only once (per group).\nWhile it's not a problem now, it could cause errors if you change the version of one of them later.\nFetching https://github.com/freego/capistrano-thin.git\nFetching https://github.com/seuros/capistrano-sidekiq.git\nFetching gem metadata from https://rails-assets.org/...\nFetching gem metadata from https://rails-assets.org/..\nFetching gem metadata from https://rubygems.org/.........\nFetching gem metadata from https://rails-assets.org/..\nFetching gem metadata from https://rails-assets.org/..\nFetching gem metadata from https://rubygems.org/..\nFetching gem metadata from https://rails-assets.org/..\nFetching gem metadata from https://rails-assets.org/..\nFetching gem metadata from https://rubygems.org/..\nResolving dependencies....\nBundler could not find compatible versions for gem \"capistrano\":\n  In snapshot (Gemfile.lock):\n    capistrano (= 3.4.0)\n\n  In Gemfile:\n    capistrano-bundler was resolved to 1.1.4, which depends on\n      capistrano (~&gt; 3.1)\n\n    capistrano-rvm was resolved to 0.1.2, which depends on\n      capistrano (~&gt; 3.0)\n\n    capistrano-sidekiq was resolved to 1.0.2, which depends on\n      capistrano (&gt;= 3.9.0)\n\nRunning `bundle update` will rebuild your snapshot from scratch, using only\nthe gems in your Gemfile, which may resolve the conflict.\n</code></pre>\n\n<p>In my Gemfile.lock, I have following relevant information:</p>\n\n<pre><code>    cancancan (1.13.1)\n    capistrano (3.4.0)\n      i18n\n      rake (&gt;= 10.0.0)\n      sshkit (~&gt; 1.3)\n    capistrano-bundler (1.1.4)\n      capistrano (~&gt; 3.1)\n      sshkit (~&gt; 1.2)\n    capistrano-rails (1.1.6)\n      capistrano (~&gt; 3.1)\n      capistrano-bundler (~&gt; 1.1)\n    capistrano-rvm (0.1.2)\n      capistrano (~&gt; 3.0)\n      sshkit (~&gt; 1.2)\n    carrierwave (0.10.0)\n      activemodel (&gt;= 3.2.0)\n      activesupport (&gt;= 3.2.0)\n      json (&gt;= 1.7)\n</code></pre>\n\n<p>It says at the end of the file:</p>\n\n<pre><code>BUNDLED WITH\n   1.14.3\n</code></pre>\n\n<p>On the other hand, if I list my local gems, I have following version of bundler:</p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>Bundler version:</p>\n\n<pre><code>bundler (2.0.1)\n</code></pre>\n\n<p>I guess because <code>bundle install</code> is not working yet, the Gemfile.lock is not being updated.</p>\n\n<p>In my local gems, I can not see the <code>capistrano</code> gem.</p>\n\n<p>When I try to install the <code>capistrano</code> gem, following happens:</p>\n\n<pre><code>gem install capistrano --verbose                                                      [2.5.0]\nGetting SRV record failed: DNS result has no information for _rubygems._tcp.gems.rubyforge.org\nHEAD http://gems.rubyforge.org/api/v1/dependencies\n301 Moved Permanently\nHEAD https://rubygems.org\n200 OK\nGetting SRV record failed: DNS result has no information for _rubygems._tcp.gems.github.com\nHEAD http://gems.github.com/api/v1/dependencies\n301 Moved Permanently\nHEAD http://gems.github.io/api/v1/dependencies\n404 Not Found\nGET http://gems.github.com/prerelease_specs.4.8.gz\n301 Moved Permanently\nGET http://gems.github.io/prerelease_specs.4.8.gz\n404 Not Found\nGET http://gems.github.com/specs.4.8.gz\n301 Moved Permanently\nGET http://gems.github.io/specs.4.8.gz\n404 Not Found\nHEAD https://api.rubygems.org/api/v1/dependencies\n200 OK\nGET https://rubygems.org?gems=capistrano\n200 OK\nERROR:  While executing gem ... (TypeError)\n    incompatible marshal file format (can't be read)\n    format version 4.8 required; 60.33 given\n</code></pre>\n\n<p>Apparently it is found, in the <code>https://rubygems.org?gems=capistrano</code> url. But then comes this marshal file error. I don't know how to debug this.</p>\n\n<p>In the debug mode, I get following information:</p>\n\n<pre><code>NOTE:  Debugging mode prints all exceptions even when rescued\nException `LoadError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/resolv.rb:170 - LoadError\nException `Resolv::DNS::Config::NXDomain' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/resolv.rb:546 - _rubygems._tcp.gems.rubyforge.org\nException `Resolv::DNS::Config::NXDomain' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/resolv.rb:546 - _rubygems._tcp.gems.rubyforge.org.local\nException `Resolv::ResolvError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/resolv.rb:491 - DNS result has no information for _rubygems._tcp.gems.rubyforge.org\nException `Resolv::ResolvError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/resolv.rb:491 - DNS result has no information for _rubygems._tcp.gems.github.com\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:274 - bad response Not Found 404 (http://gems.github.io/api/v1/dependencies)\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:304 - bad response Not Found 404 (http://gems.github.io/api/v1/dependencies)\nException `Errno::EEXIST' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/fileutils.rb:232 - File exists @ dir_s_mkdir - /Users/albert/.gem/specs/gems.github.com%80\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:274 - bad response Not Found 404 (http://gems.github.io/prerelease_specs.4.8.gz)\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:304 - bad response Not Found 404 (http://gems.github.io/prerelease_specs.4.8.gz)\nException `Errno::EEXIST' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/fileutils.rb:232 - File exists @ dir_s_mkdir - /Users/albert/.gem/specs/gems.github.com%80\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:274 - bad response Not Found 404 (http://gems.github.io/specs.4.8.gz)\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/remote_fetcher.rb:304 - bad response Not Found 404 (http://gems.github.io/specs.4.8.gz)\nException `Gem::RemoteFetcher::FetchError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/spec_fetcher.rb:269 - bad response Not Found 404 (http://gems.github.io/specs.4.8.gz)\nException `TypeError' at /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/api_set.rb:118 - incompatible marshal file format (can't be read)\n    format version 4.8 required; 60.33 given\nERROR:  While executing gem ... (TypeError)\n    incompatible marshal file format (can't be read)\n    format version 4.8 required; 60.33 given\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/api_set.rb:118:in `load'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/api_set.rb:118:in `versions'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/api_set.rb:55:in `find_all'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/composed_set.rb:55:in `block in find_all'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/composed_set.rb:54:in `map'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/composed_set.rb:54:in `find_all'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/best_set.rb:31:in `find_all'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/installer_set.rb:155:in `find_all'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/resolver/installer_set.rb:56:in `add_always_install'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/dependency_installer.rb:478:in `resolve_dependencies'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/commands/install_command.rb:194:in `install_gem'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/commands/install_command.rb:255:in `block in install_gems'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/commands/install_command.rb:251:in `each'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/commands/install_command.rb:251:in `install_gems'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/commands/install_command.rb:158:in `execute'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/command.rb:313:in `invoke_with_build_args'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/command_manager.rb:171:in `process_args'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/command_manager.rb:141:in `run'\n    /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems/gem_runner.rb:59:in `run'\n    /Users/albert/.rbenv/versions/2.5.0/bin/gem:21:in `&lt;main&gt;'\n</code></pre>\n\n<p>My gem sources are:</p>\n\n<pre><code>*** CURRENT SOURCES ***\n\nhttp://gems.rubyforge.org/\nhttp://gems.github.com\nhttps://rubygems.org/\n</code></pre>\n\n<p>Could someone help me to find the issue and installing Capistrano?</p>\n"}, {"tags": ["ruby", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "edited": false, "score": 0, "creation_date": 1562170460, "post_id": 56874214, "comment_id": 100296949, "body": "Ok, so the lazy loading doesn&#39;t play well with frozen objects?"}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1562170111, "creation_date": 1562170111, "answer_id": 56874214, "question_id": 56873543, "link": "https://stackoverflow.com/questions/56873543/why-does-comparing-frozen-gem-versions-fail/56874214#56874214", "title": "Why does comparing frozen Gem versions fail?", "body": "<p>The error tells you where: The <code>&lt;=&gt;</code> method calls <code>canonical_segments</code>, which calls <code>_split_segments</code>, which calls <code>_segments</code>. So <em>that's</em> where the mutation must be happening; not directly in the method you've copied in the post.</p>\n\n<p>More specifically, <a href=\"https://github.com/rubygems/rubygems/blob/1890559695d244e3b130952cd824c0dd832c240a/lib/rubygems/version.rb#L369-L397\" rel=\"nofollow noreferrer\">here's the offending source code</a>:</p>\n\n<pre><code>  def canonical_segments\n    @canonical_segments ||=\n      _split_segments.map! do |segments|\n        segments.reverse_each.drop_while {|s| s == 0 }.reverse\n      end.reduce(&amp;:concat)\n  end\n\n  protected\n\n  def _version\n    @version\n  end\n\n  def _segments\n    # segments is lazy so it can pick up version values that come from\n    # old marshaled versions, which don't go through marshal_load.\n    # since this version object is cached in @@all, its @segments should be frozen\n\n    @segments ||= @version.scan(/[0-9]+|[a-z]+/i).map do |s|\n      /^\\d+$/ =~ s ? s.to_i : s\n    end.freeze\n  end\n\n  def _split_segments\n    string_start = _segments.index {|s| s.is_a?(String) }\n    string_segments  = segments\n    numeric_segments = string_segments.slice!(0, string_start || string_segments.size)\n    return numeric_segments, string_segments\n  end\n</code></pre>\n"}], "owner": {"reputation": 2531, "user_id": 6084317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4295c9b1ada748080d7a123f7263ae69?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Minnix", "link": "https://stackoverflow.com/users/6084317/edward-minnix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562170111, "creation_date": 1562167803, "question_id": 56873543, "link": "https://stackoverflow.com/questions/56873543/why-does-comparing-frozen-gem-versions-fail", "title": "Why does comparing frozen Gem versions fail?", "body": "<p>I am writing something in Ruby that needs to compare versions in order to determine whether or not something needs to be updated.</p>\n\n<p>But when I run <code>current_version &lt;=&gt; desired_version</code> and at least one of the versions is frozen, I get:</p>\n\n<pre><code>    4: from .../ruby/2.6.0/rubygems/version.rb:344:in `&lt;=&gt;'\n    3: from .../ruby/2.6.0/rubygems/version.rb:371:in `canonical_segments'\n    2: from .../ruby/2.6.0/rubygems/version.rb:393:in `_split_segments'\n    1: from .../ruby/2.6.0/rubygems/version.rb:387:in `_segments'\nFrozenError (can't modify frozen Gem::Version)\n</code></pre>\n\n<p>According to <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/rubygems/rdoc/Gem/Version.html#method-i-3C-3D-3E\" rel=\"nofollow noreferrer\">the docs</a>, the source code is this:</p>\n\n<pre><code>def &lt;=&gt;(other)\n  return unless Gem::Version === other\n  return 0 if @version == other._version || canonical_segments == other.canonical_segments\n\n  lhsegments = _segments\n  rhsegments = other._segments\n\n  lhsize = lhsegments.size\n  rhsize = rhsegments.size\n  limit  = (lhsize &gt; rhsize ? lhsize : rhsize) - 1\n\n  i = 0\n\n  while i &lt;= limit\n    lhs, rhs = lhsegments[i] || 0, rhsegments[i] || 0\n    i += 1\n\n    next      if lhs == rhs\n    return -1 if String  === lhs &amp;&amp; Numeric === rhs\n    return  1 if Numeric === lhs &amp;&amp; String  === rhs\n\n    return lhs &lt;=&gt; rhs\n  end\n\n  return 0\nend\n</code></pre>\n\n<p>I don't see why this code would be mutating the state of the Gem. Is there something that I'm missing?</p>\n"}, {"tags": ["ruby", "class", "constructor", "inner-classes"], "answers": [{"comments": [{"owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "edited": false, "score": 0, "creation_date": 1562175929, "post_id": 56874795, "comment_id": 100299491, "body": "This &quot;solution&quot; has nothing to do with what you asked... you should do some more reading on OOP, because it seems like you don&#39;t know the right language to express these concepts."}], "tags": [], "owner": {"reputation": 475, "user_id": 8096299, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1571303072894045/picture?type=large", "display_name": "Kaushik Vijayakumar", "link": "https://stackoverflow.com/users/8096299/kaushik-vijayakumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562172549, "creation_date": 1562172549, "answer_id": 56874795, "question_id": 56873350, "link": "https://stackoverflow.com/questions/56873350/create-inner-class-object-after-executing-outer-classs-constructor-in-ruby/56874795#56874795", "title": "Create inner-class object after executing outer-class&#39;s constructor in Ruby?", "body": "<pre><code>class A\n    def initialize(x, y)\n        @x = x\n        @y = y\n    end\nend\n\nclass B &lt; A\n    def func_b\n        puts \"x- #{@x} and y- #{@y} in class B\"\n    end\nend\n\nclass C &lt; A\n    def func_c\n        puts \"x- #{@x} and y- #{@y} in class C\"\n    end\nend\n\nc = C.new(4,5)\nc.func_c\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>x- 4 and y- 5 in class C\n</code></pre>\n\n<p>This seems to work fine :). </p>\n"}, {"tags": [], "owner": {"reputation": 18079, "user_id": 503402, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/873ad707fb34aac8fbdfbfec676e02e9?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/503402/max"}, "is_accepted": false, "score": 2, "last_activity_date": 1562177252, "creation_date": 1562177252, "answer_id": 56875775, "question_id": 56873350, "link": "https://stackoverflow.com/questions/56873350/create-inner-class-object-after-executing-outer-classs-constructor-in-ruby/56875775#56875775", "title": "Create inner-class object after executing outer-class&#39;s constructor in Ruby?", "body": "<p>Nested modules and classes in Ruby are a mostly organizational choice. Compare this</p>\n\n<pre><code>class A; end\nclass B; end\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>class A\n  class B; end\nend\n</code></pre>\n\n<p>There are only two differences between these</p>\n\n<ol>\n<li>In the second example, you have to write <code>A::B</code> to access <code>B</code></li>\n<li>In the second example, constants accessed in <code>B</code> will be looked up in <code>A</code> before they are looked up in the top-level</li>\n</ol>\n\n<p>If you actually want the <em>instances</em> of these classes to be related, you need a sub- and superclass relationship between them i.e.</p>\n\n<pre><code>class B &lt; A; end\n</code></pre>\n\n<p>now instances of <code>B</code> can access methods and instance variables in <code>A</code>. Note that this is independent of nesting, you could define that as</p>\n\n<pre><code>class A\n  class B &lt; A; end\nend\n</code></pre>\n\n<p>but again that's only an organizational difference.</p>\n\n<hr>\n\n<p>On a totally separate note, this</p>\n\n<pre><code>class A\n  @x = nil\n  @y = nil\nend\n</code></pre>\n\n<p>does <strong>not</strong> do what you think it does. This is setting instance variables on <code>A</code> itself, i.e. treating <code>A</code> as an instance of <code>A.singleton_class</code>. If you want default values for the <em>instances</em> of <code>A</code>, you have to set those in <code>initialize</code>:</p>\n\n<pre><code>class A\n  def initialize\n    @x = nil\n    @y = nil\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 8096299, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1571303072894045/picture?type=large", "display_name": "Kaushik Vijayakumar", "link": "https://stackoverflow.com/users/8096299/kaushik-vijayakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562177252, "creation_date": 1562167213, "question_id": 56873350, "link": "https://stackoverflow.com/questions/56873350/create-inner-class-object-after-executing-outer-classs-constructor-in-ruby", "title": "Create inner-class object after executing outer-class&#39;s constructor in Ruby?", "body": "<p>I want to create objects for inner classes in a class. All the inner class methods use a common variables which needs to be initialised when the the outer class is created.</p>\n\n<pre><code>class A\n    @x = nil\n    @y = nil\n    def initialize(x, y)\n        @x = x\n        @y = y\n    end\n\n    class B\n        def func_b\n            puts \"x- #{@x} and y- #{@y} in class B\"\n        end\n    end\n\n    class C\n        def func_c\n            puts \"x- #{@x} and y- #{@y} in class C\"\n        end\n    end\nend\n</code></pre>\n\n<p>I was able to create object for classes <code>B</code> and <code>C</code> like</p>\n\n<pre><code>#1\nb = A::B.new\n#2\na = A\nc = a::C.new\n</code></pre>\n\n<p>But I want to initialize <code>A</code> before creating objects for <code>B</code> or <code>C</code></p>\n\n<p>Something like</p>\n\n<pre><code>a = A.new(4,5)\nb = a::C.new\n</code></pre>\n\n<p>But this doesn't seem to work. How should I do the above.</p>\n"}, {"tags": ["arrays", "ruby", "sorting", "parallel-processing"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1562164827, "post_id": 56872452, "comment_id": 100293838, "body": "Very interesting question although I am concerned that any gain you might receive from processing each distributed chunk in parallel will be out weighed by the initial sorting algorithm required for the distribution."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562165066, "post_id": 56872452, "comment_id": 100293999, "body": "What about data that can&#39;t be evenly sorted? Say I have 4 arrays of lengths 1, 2, 4, and 4. They can&#39;t be evenly grouped."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1562165117, "post_id": 56872452, "comment_id": 100294035, "body": "Also, depending on your parameters, (and per my above comment, assuming a solution exists at all) this problem is NP-Complete. Consider the case where you want to organize a large data set into only two chunks. Bam, you&#39;ve got the <a href=\"https://en.wikipedia.org/wiki/Partition_problem\" rel=\"nofollow noreferrer\">partition problem</a>. This is to say that for certain inputs, calculating this can take a very long time."}, {"owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562165217, "post_id": 56872452, "comment_id": 100294103, "body": "@engineersmnky, That&#39;s a good point. The processing on these items is already pretty expensive which leads me to weigh the cost of an upfront sort."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1562165324, "post_id": 56872452, "comment_id": 100294179, "body": "As a suggestion, a heuristic approach might be better. You could dechunk all the arrays and sort by array length. Then iterate over the block giving items with <code>index % 4 == 0</code> to the first process, <code>index % 4 == 1</code> to the second, <code>index % 4 == 2</code> to the third, <code>index % 4 == 3</code> to the fourth. This wouldn&#39;t give a perfect solution but would be <i>roughly</i> correct. It has the benefit of being much simpler, and the initial sorting much faster."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1562231156, "post_id": 56872452, "comment_id": 100316133, "body": "You could also avoid pre-chunking by just setting up four workers, then having the master issue each worker a job; when a worker finishes the job, it gets the next available job. It means some workers might do several big jobs, while some other do more smaller ones, and in the end it is kind of even (up to the length of one job&#39;s difference). This also works when job length is not predictable from the input. For example, the <a href=\"https://github.com/grosser/parallel\" rel=\"nofollow noreferrer\"><code>parallel</code></a> gem can do it automatically for you."}], "answers": [{"comments": [{"owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562166455, "post_id": 56872925, "comment_id": 100294872, "body": "Thanks, I like this approach and will test it out. Close enough is good :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562257398, "post_id": 56872925, "comment_id": 100329975, "body": "Tom, I\u2019m having trouble following your calculations. For one, shouldn\u2019t <code>original_list.chunk_while</code> be <code>original_list.flatten(1).chunk_while</code>?  You may want to run your code against the example in my answer."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562257992, "post_id": 56872925, "comment_id": 100330168, "body": "@CarySwoveland Your data assumes the input may be nested deeply, but the original question (which admittedly is invalid syntax, so somewhat ambiguous!) didn&#39;t state this. You used: <code>[[[0,1], [2], [3], [4]], ...]</code>, but I&#39;m assuming it&#39;s: <code>[[1, 2, 3, 4], ...]</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562261125, "post_id": 56872925, "comment_id": 100331119, "body": "I see. I&#39;m afraid I still don&#39;t follow. It would be helpful if you could include a simple example. Note <code>chunk_while</code> returns an enumerator, so I expect you need <code>end.to_a</code>."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 2, "last_activity_date": 1562166774, "last_edit_date": 1562166774, "creation_date": 1562165767, "answer_id": 56872925, "question_id": 56872452, "link": "https://stackoverflow.com/questions/56872452/sorting-ruby-array-of-array-items-by-length-evenly/56872925#56872925", "title": "Sorting Ruby array of array items by length evenly", "body": "<p>This isn't a \"perfect\" solution, but here's an approach that's not too computationally heavy/complex:</p>\n\n<ol>\n<li>Sum up the length of all inner-arrays:</li>\n</ol>\n\n<pre><code>total_count = original_list.map(&amp;:count).inject(:+)\n</code></pre>\n\n<ol start=\"2\">\n<li>Determine how many items you want to put in each parallel process (in your case, <strong>4</strong> processes):</li>\n</ol>\n\n<pre><code>chunk_size = total_count / 4\n</code></pre>\n\n<ol start=\"3\">\n<li>Now, here's the harder part: The algorithm. I'm going to keep this very simple, and just step through each item in the array, and <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-chunk_while\" rel=\"nofollow noreferrer\">\"chunk\"</a> until it's reached the <code>chunk_size</code>:</li>\n</ol>\n\n<pre><code>current_chunk_size = 0\n\noriginal_list.chunk_while do |inner_array|\n  current_chunk_size += inner_array.count\n  current_chunk_size = 0 if current_chunk_size &gt;= chunk_size\n  current_chunk_size &gt; 0\nend\n</code></pre>\n\n<p>You could achieve similar logic with methods like <code>slice_after</code>, if you prefer.</p>\n\n<p>Using this algorithm against your original example:</p>\n\n<pre><code>[\n  # chunk 1, inner total length 5\n  [{...}], # 2\n  [{...}], # 1\n  [{...}], # 1\n  [{...}], # 1\n  # chunk 2, inner total length 11\n  [{...}], # 2\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n  # chunk 3, inner total length 9\n  [{...}], # 3\n  [{...}], # 3\n  [{...}], # 1\n  [{...}], # 2\n  # chunk 4, inner total length 15\n  [{...}], # 4\n  [{...}], # 3\n  [{...}], # 4\n  [{...}], # 4\n]\n</code></pre>\n\n<p>Yields the result:</p>\n\n<pre><code>[\n  # chunk 1, inner total length 12\n  [{...}], # 2\n  [{...}], # 1\n  [{...}], # 1\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 2\n  [{...}], # 3\n\n  # chunk 2, inner total length 10\n  [{...}], # 4\n  [{...}], # 3\n  [{...}], # 3\n\n  # chunk 3, inner total length 10\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 4\n  [{...}], # 3\n\n  # chunk 4, inner total length 8\n  [{...}], # 4\n  [{...}], # 4\n]\n</code></pre>\n\n<p>...Pretty close.</p>\n"}, {"comments": [{"owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562172995, "post_id": 56873191, "comment_id": 100298182, "body": "Thanks @Glyoko, I&#39;m leaning towards this solution. One thing is I don&#39;t want my array necessarily grouped (or nested in a third array), can you return it back to the form of your <code>unchunked_data</code> ( one array of arrays)? Also, I&#39;m inclined to use <code>grouped_data.map</code> instead of the <code>grouped_data.each</code>, as i&#39;m going to process it outside of that block that is stripping those pesky index numbers (per your each_with_index comment)."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562173185, "post_id": 56873191, "comment_id": 100298295, "body": "None of this code changes <code>unchunked_data</code> in place, so you can still manipulate it after the fact with it in the same order it start as."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562173398, "post_id": 56873191, "comment_id": 100298389, "body": "As for <code>grouped_data</code>, I suppose you can use map, but be aware that <code>grouped_data</code> is hash not an array. It&#39;s keys would be the <code>process_index</code>s, (0, 1, 2, 3), and the values would be their respective sorted and grouped chunks. (Don&#39;t forget that the comment about using <code>map(&amp;:first)</code> on the values would still apply for this too.)"}, {"owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562174230, "post_id": 56873191, "comment_id": 100298748, "body": "Per you first comment, I just meant I&#39;m hoping to have the result of all this be an array of arrays in the distributed order (which matches the structure of the original <code>unchunked_data</code>). For your second comment, and related... I don&#39;t want a hash and so that&#39;s why I&#39;ll be using .map which&#39;ll return <code>[ [ [ ],... ] ]</code>, but I&#39;d rather get <code>[[],...]</code> if that makes sense. I&#39;m going to be doing something like <code>each_slice(grouped_data.size &#47; 4)</code> with the result."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1562174696, "post_id": 56873191, "comment_id": 100298947, "body": "Note that this method won&#39;t necessarily give a more even spread than my answer; it depends entirely on the input... For example, suppose the original array sizes are: <code>[1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4]</code>. My answer will chunk these as: <code>[[1, 1, 1, 2, 2], [2, 2, 3], [3, 3], [3, 4]]</code> - i.e. total sizes of <code>[7, 7, 6, 7]</code>; whereas this answer will chunk them as: <code>[[1, 2, 3], [1, 2, 3], [1, 2, 3], [2, 3, 4]]</code> - i.e. total sizes of [6, 6, 6, 9]`. I&#39;m not certain which algorithm is most likely to give the best spread."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "reply_to_user": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 1, "creation_date": 1562175355, "post_id": 56873191, "comment_id": 100299264, "body": "@mfink in that case you can do something like <code>grouped_data.values.flatten(1)</code>. @TomLord That&#39;s correct. The problem is actually NP-complete, so both of our answers are just &quot;best guesses&quot;. One may be better than the other depending on the data."}, {"owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "edited": false, "score": 0, "creation_date": 1562940148, "post_id": 56873191, "comment_id": 100549758, "body": "I ended up going with this solution as it tended to make more even distribution for the dataset I was working on. Also readability in general. I would like to remove the <code>&amp;:first</code> cleanup step, but I&#39;ll save that for another day. Thanks!"}], "tags": [], "owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "is_accepted": true, "score": 1, "last_activity_date": 1562175631, "last_edit_date": 1562175631, "creation_date": 1562166639, "answer_id": 56873191, "question_id": 56872452, "link": "https://stackoverflow.com/questions/56872452/sorting-ruby-array-of-array-items-by-length-evenly/56873191#56873191", "title": "Sorting Ruby array of array items by length evenly", "body": "<p>The algorithm I would use to get a roughly even distribution of size, per my comment on OP:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>unchunked_data = [\n  [{...}],\n  [{...}],\n  [{...}],\n  [{...}],\n  [{...}],\n  [{...}],\n  [{...}],\n  [{...}]\n]\n\nsorted_data = unchunked_data.sort_by(&amp;:size)\ngrouped_data = sorted_data.each_with_index.group_by { |_, index| index % 4 }\n\ngrouped_data.each do |process_index, data|\n  # each_with_index would put data in an array with its index in sorted_data. Calling map(&amp;:first) removes that index.\n  data_without_index = data.map(&amp;:first)\n  send_data_to_process(process_index, data_without_index)\nend\n</code></pre>\n\n<p>If the data is as it appears in OP's example, this results in a perfect distribution.</p>\n\n<hr>\n\n<p>Per discussion in the comments, you can get back all the data in single array, as formatted in the original but grouped with this method, by doing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>grouped_data.values.flatten(1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562178177, "post_id": 56875803, "comment_id": 100300458, "body": "Very neat, but I&#39;m not sure I understand how the &quot;sweep&quot; helps. Just using <code>idx = a.cycle</code> seems to work just as well."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 1, "creation_date": 1562179603, "post_id": 56875803, "comment_id": 100301089, "body": "@Glyko, suppose <code>sorted = [[0], [1,2], [3,4,5], [6,7,8,9]]</code> and <code>nbr_groups = 2</code>. By sweeping, <code>result #=&gt; [[[0], [6,7,8,9]], [[1,2], [3,4,5]]</code>, <code>result.map { |a| a.sum(&amp;:size) } #=&gt; [5,5]</code>. With <code>idx.cycle</code>, <code>result #=&gt; [[[0], [3,4,5]], [[1,2],  [6,7,8,9]]</code>, <code>result.map { |a| a.sum(&amp;:size) } #=&gt; [4,6]</code>. With <code>idx.cycle</code>, <code>result.map { |a| a.sum(&amp;:size) }</code> will tend to be non-increasing and be non-increasing if <code>sorted % nbr_groups #=&gt; 0</code>."}, {"owner": {"reputation": 1843, "user_id": 4067720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52c645614505bcaeb65a6c5199158c1?s=128&d=identicon&r=PG", "display_name": "Glyoko", "link": "https://stackoverflow.com/users/4067720/glyoko"}, "edited": false, "score": 0, "creation_date": 1562182667, "post_id": 56875803, "comment_id": 100302373, "body": "Cool, that makes sense. Doing every other pass backwards tends to even out the distribution."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1562177352, "creation_date": 1562177352, "answer_id": 56875803, "question_id": 56872452, "link": "https://stackoverflow.com/questions/56872452/sorting-ruby-array-of-array-items-by-length-evenly/56875803#56875803", "title": "Sorting Ruby array of array items by length evenly", "body": "<p>Here is another heuristic.<sup>1</sup> I'll explain the procedure shortly. We are given:</p>\n\n<pre><code>arr = [[[0,1],         [2],        [3],           [4]],\n       [[5,6],         [7,8],      [9,10,11],     [12,13,14,15]],\n       [[16,17,18],    [19,20,21], [22],          [23,24]],\n       [[25,26,27,28], [29,30,31], [32,33,34,35], [36,37,38,39]]\n      ]\n\nnbr_groups = 4\n</code></pre>\n\n<p>Let's first flatten one level and sort the resulting arrays by size.</p>\n\n<pre><code>sorted = arr.flatten(1).sort_by(&amp;:size)\n  #=&gt; [[2], [3], [4], [22], [0, 1], [5, 6], [7, 8], [23, 24], [9, 10, 11],\n  #    [16, 17, 18], [19, 20, 21], [29, 30, 31], [12, 13, 14, 15],\n  #    [25, 26, 27, 28], [32, 33, 34, 35], [36, 37, 38, 39]] \n</code></pre>\n\n<p>We need to group elements of <code>sorted</code> into an array <code>result</code> containing <code>nbr_groups</code> arrays. This will be done by \"sweeping\" the elements of <code>sorted</code> into <code>result</code>. The sweeping consists of <code>nbr_groups</code> forward assignments  alternating with the same number of reverse assignments.</p>\n\n<p>Now create an enumerator.</p>\n\n<pre><code>a = nbr_groups.times.to_a\n  #=&gt; [0, 1, 2, 3] \nidx = [*a, *a.reverse].cycle\n  #=&gt; #&lt;Enumerator: [0, 1, 2, 3, 3, 2, 1, 0]:cycle&gt;\n</code></pre>\n\n<p>The heuristic I suggest begins by assigning the first <code>nbr_groups</code> elements of <code>sorted</code> to <code>result</code>, such that the first element of <code>sorted</code> is assigned to the first element of <code>result</code>, the second element of <code>sorted</code> is assigned to the second element of <code>result</code>, and so one. The next <code>nbr_group</code> elements of <code>sorted</code> are similarly assigned to <code>result</code>, but this time in reverse order: the <code>nbr_groups+1</code>'th element of <code>sorted</code> is assigned to the last element of <code>result</code>, the <code>nbr_groups+2</code>'th element of <code>sorted</code> is assigned to the penultimate element of <code>result</code>, and so on. These alternating assignments are continued until all elements of <code>sorted</code> have been assigned.   </p>\n\n<pre><code>result = sorted.each_with_object(Array.new(nbr_groups) { [] }) do |a,arr| \n  arr[idx.next] &lt;&lt; a\nend\n  #=&gt; [[[2], [23, 24], [9, 10, 11], [36, 37, 38, 39]],\n  #    [[3], [7, 8], [16, 17, 18], [32, 33, 34, 35]],\n  #    [[4], [5, 6], [19, 20, 21], [25, 26, 27, 28]],\n  #    [[22], [0, 1], [29, 30, 31], [12, 13, 14, 15]]]\n</code></pre>\n\n<p>Now let's see how evenly these assignments were made:</p>\n\n<pre><code>result.map { |a| a.sum(&amp;:size) }\n  #=&gt; [10, 10, 10, 10] \n</code></pre>\n\n<p>This result brought a smile to my face. That all elements of <code>result</code> are the same size is of course purely coincidental.</p>\n\n<p><sup>1. As @glyoko pointed out in a comment, the problem is NP-complete, so one must resort to using a heuristic for all but the smallest problems.</sup></p>\n"}], "owner": {"reputation": 972, "user_id": 3380256, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OBgJb.jpg?s=128&g=1", "display_name": "mfink", "link": "https://stackoverflow.com/users/3380256/mfink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 56873191, "answer_count": 3, "score": 3, "last_activity_date": 1562177352, "creation_date": 1562164439, "question_id": 56872452, "link": "https://stackoverflow.com/questions/56872452/sorting-ruby-array-of-array-items-by-length-evenly", "title": "Sorting Ruby array of array items by length evenly", "body": "<p>In Ruby, how can I sort an array such that its items (also arrays) are arranged by their length size, but not just simply sorted by ascending/descending in length. </p>\n\n<p>I'd like to make the array items distributed evenly so that there are some items that contain large number of objects intermixed with smaller arrays. </p>\n\n<p>For example, I have this array with array items that contain the number of objects shown in the <code>comment</code>. I've broken them in chunks for clarity and calculated their total size (see motivation below).</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\n  # chunk 1, inner total length 5\n  [{...}], # 2\n  [{...}], # 1\n  [{...}], # 1\n  [{...}], # 1\n  # chunk 2, inner total length 11\n  [{...}], # 2\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n  # chunk 3, inner total length 9\n  [{...}], # 3\n  [{...}], # 3\n  [{...}], # 1\n  [{...}], # 2\n  # chunk 4, inner total length 15\n  [{...}], # 4\n  [{...}], # 3\n  [{...}], # 4\n  [{...}], # 4\n]\n</code></pre>\n\n<p>I'd like to arrange the array so that it looks more like the below. Note: that this example has them ordered smallest to largest (1..4), but that is not necessary. I'd just like to have them chunked so that the inner array cumulative length are comparable. </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>[\n  # chunk 1, inner total length 10\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n  # chunk 2, inner total length 10\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n  # chunk 3, inner total length 10\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n  # chunk 4, inner total length 10\n  [{...}], # 1\n  [{...}], # 2\n  [{...}], # 3\n  [{...}], # 4\n]\n</code></pre>\n\n<p>My motivation for this is to slice up the outer array so I can process the inner arrays in parallel. I don't want one of the parallel processes to get a slice of small chunks, and another process get a slice of really large chunks. </p>\n\n<p>Note: I know that I'll have 4 parallel processes so that may help inform how to arrange the chunks in the array. Thanks!</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1562184890, "post_id": 56872053, "comment_id": 100303190, "body": "<code>let(:source) { .... }</code> would be better so that the parentheses really are method-calling parentheses."}, {"owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "edited": false, "score": 0, "creation_date": 1562245519, "post_id": 56872053, "comment_id": 100324162, "body": "It&#39;s also considered good style practice to have spaces inside braces. A &quot;nicely&quot; formatted line would be <code>let(:source) { &#39;cba321&#39; }</code>."}], "tags": [], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "is_accepted": true, "score": 5, "last_activity_date": 1562163142, "creation_date": 1562163142, "answer_id": 56872053, "question_id": 56872051, "link": "https://stackoverflow.com/questions/56872051/rspec-returns-syntax-error-of-unexpected-expecting-keyword-end/56872053#56872053", "title": "Rspec returns syntax error of &quot;unexpected &#39;{&#39;, expecting keyword_end&quot;", "body": "<p>In Ruby <code>2.4.1</code> not having parens in the let was allowed but in Ruby <code>2.5.1</code> it is not.</p>\n\n<p>So the fix is to add parens to the <code>let</code>, e.g.</p>\n\n<p>change</p>\n\n<pre><code>let :source {'cba321'}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>let (:source) {'cba321'}\n</code></pre>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 56872053, "answer_count": 1, "score": 3, "last_activity_date": 1564869643, "creation_date": 1562163142, "last_edit_date": 1564869643, "question_id": 56872051, "link": "https://stackoverflow.com/questions/56872051/rspec-returns-syntax-error-of-unexpected-expecting-keyword-end", "title": "Rspec returns syntax error of &quot;unexpected &#39;{&#39;, expecting keyword_end&quot;", "body": "<p>This works on one machine with Ruby but not another.</p>\n\n<p>Code:</p>\n\n<pre><code>describe 'testing reverse string different ways' do\n\n  let :thing {'cba321'}\n\n  it 'the system method' do\n    source = '123abc'\n    result = source.reverse\n    expect(result).to eq 'cba321'\n  end \nend\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>SyntaxError:                                                                                                             \n  /home/michael/Dropbox/90_2019/work/code/ruby__rails/ruby/reverse_string_tests_timing/test_spec.rb:12: syntax error, une\nxpected '{', expecting keyword_end                                                                                       \n    let :thing {'cba321'}                                                                                                \n               ^                                                                                                         \n  /home/michael/Dropbox/90_2019/work/code/ruby__rails/ruby/reverse_string_tests_timing/test_spec.rb:12: syntax error, une\nxpected '}', expecting end-of-input                                                                                      \n    let :thing {'cba321'}  \n</code></pre>\n"}, {"tags": ["swift", "ruby", "react-native", "cocoapods", "podfile"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1562161845, "post_id": 56871348, "comment_id": 100292095, "body": "does this file exist on your system? <code>&#47;Users&#47;lmwmarketing&#47;Desktop&#47;LMW-Source-Codes&#47;node_modules&#47;re&zwnj;&#8203;act-native&#47;third-par&zwnj;&#8203;ty-podspecs&#47;DoubleCo&zwnj;&#8203;nversion.podspec</code>"}, {"owner": {"reputation": 91, "user_id": 10856089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHwRGW0TzlY/AAAAAAAAAAI/AAAAAAAAAZ8/wK4zOulCn70/photo.jpg?sz=128", "display_name": "Elias Wood", "link": "https://stackoverflow.com/users/10856089/elias-wood"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 1, "creation_date": 1562162479, "post_id": 56871348, "comment_id": 100292424, "body": "Yes its in there but I found the real problem! Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 10856089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHwRGW0TzlY/AAAAAAAAAAI/AAAAAAAAAZ8/wK4zOulCn70/photo.jpg?sz=128", "display_name": "Elias Wood", "link": "https://stackoverflow.com/users/10856089/elias-wood"}, "is_accepted": true, "score": 5, "last_activity_date": 1562162581, "creation_date": 1562162581, "answer_id": 56871893, "question_id": 56871348, "link": "https://stackoverflow.com/questions/56871348/how-do-i-solve-errnoenoent-no-such-file-or-directory-rb-sysopen/56871893#56871893", "title": "How do I solve: &quot;Errno::ENOENT - No such file or directory @ rb_sysopen - &quot;?", "body": "<p>All of the node files were searching for two directories up when it was only one directory up. </p>\n\n<pre><code>  pod 'DoubleConversion', :podspec =&gt; './node_modules/react-native/third-party-podspecs/DoubleConversion.podspec'\n  pod 'glog', :podspec =&gt; './node_modules/react-native/third-party-podspecs/glog.podspec'\n  pod 'Folly', :podspec =&gt; './node_modules/react-native/third-party-podspecs/Folly.podspec'\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 10856089, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHwRGW0TzlY/AAAAAAAAAAI/AAAAAAAAAZ8/wK4zOulCn70/photo.jpg?sz=128", "display_name": "Elias Wood", "link": "https://stackoverflow.com/users/10856089/elias-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3988, "favorite_count": 1, "accepted_answer_id": 56871893, "answer_count": 1, "score": 4, "last_activity_date": 1562162581, "creation_date": 1562160693, "last_edit_date": 1562161284, "question_id": 56871348, "link": "https://stackoverflow.com/questions/56871348/how-do-i-solve-errnoenoent-no-such-file-or-directory-rb-sysopen", "title": "How do I solve: &quot;Errno::ENOENT - No such file or directory @ rb_sysopen - &quot;?", "body": "<p>I am trying to merge React-Native into a swift application. I created a new podfile and added in all the dependencies. After trying 'pod install' many times, it will still not install the pods. </p>\n\n<p>I have tried to delete the podfolder and also delete the node folder and run 'npm install' again. I have tried updating my ruby software. Everything that I can find on GitHub and on here that seems applicable I have tried. </p>\n\n<pre><code>   CocoaPods : 1.7.3\n        Ruby : ruby 2.3.7p456 (2018-03-28 revision 63024) [universal.x86_64-darwin18]\n    RubyGems : 2.5.2.3\n        Host : Mac OS X 10.14.5 (18F132)\n       Xcode : 10.2.1 (10E1001)\n         Git : git version 2.20.1 (Apple Git-117)\nRuby lib dir : /System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib\nRepositories : master - https://github.com/CocoaPods/Specs.git @ 690c5ee7cf52451dc2c72cde937bc1b92a98cc86\n</code></pre>\n\n<h3>Plugins</h3>\n\n<pre><code>cocoapods-deintegrate : 1.0.4\ncocoapods-plugins     : 1.0.0\ncocoapods-search      : 1.0.0\ncocoapods-stats       : 1.1.0\ncocoapods-trunk       : 1.3.1\ncocoapods-try         : 1.1.0\n</code></pre>\n\n<h3>Podfile</h3>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Uncomment the next line to define a global platform for your project\nplatform :ios, '9.0'\n\ntarget 'LMWPOS' do\n  # Comment the next line if you don't want to use dynamic frameworks\n  use_frameworks!\n\n  # Pods for LMWPOS\n  pod 'Alamofire'\n  pod 'AlamofireObjectMapper', '~&gt; 5.0'\n  pod 'SwiftyJSON'\n  pod 'DLRadioButton'\n  pod 'NVActivityIndicatorView'\n  pod 'TextFieldEffects'\n  pod 'GoogleSignIn'\n  pod 'RealmSwift', '~&gt; 3.11.2'\n  pod 'NotificationBannerSwift', '~&gt; 1.6.3'\n  pod 'MarqueeLabel/Swift', '~&gt; 3.1.6'\n  pod 'FBSDKCoreKit', '~&gt; 4.36.0'\n  pod 'FBSDKLoginKit', '~&gt; 4.36.0'\n  pod 'PromiseKit/Alamofire', '~&gt; 6.0'\n  pod 'AlamofireImage'\n\n  # Your 'node_modules' directory is probably in the root of your project,\n  # but if not, adjust the `:path` accordingly\n  pod 'React', :path =&gt; '../node_modules/react-native', :subspecs =&gt; [\n    'Core',\n    'CxxBridge', # Include this for RN &gt;= 0.47\n    'DevSupport', # Include this to enable In-App Devmenu if RN &gt;= 0.43\n    'RCTText',\n    'RCTNetwork',\n    'RCTWebSocket', # Needed for debugging\n    'RCTAnimation', # Needed for FlatList and animations running on native UI thread\n    # Add any other subspecs you want to use in your project\n  ]\n  # Explicitly include Yoga if you are using RN &gt;= 0.42.0\n  pod 'yoga', :path =&gt; '../node_modules/react-native/ReactCommon/yoga'\n\n  # Third party deps podspec link\n  pod 'DoubleConversion', :podspec =&gt; '../node_modules/react-native/third-party-podspecs/DoubleConversion.podspec'\n  pod 'glog', :podspec =&gt; '../node_modules/react-native/third-party-podspecs/glog.podspec'\n  pod 'Folly', :podspec =&gt; '../node_modules/react-native/third-party-podspecs/Folly.podspec'\n\nend\n\npost_install do |installer|\n    installer.pods_project.targets.each do |target|\n        if target.name == \"React\"\n            target.remove_from_project\n        end\n    end\nend\n</code></pre>\n\n<p>I expected it to install the pods and got this:</p>\n\n<h3>Error</h3>\n\n<pre><code>Errno::ENOENT - No such file or directory @ rb_sysopen - /Users/lmwmarketing/Desktop/LMW-Source-Codes/node_modules/react-native/third-party-podspecs/DoubleConversion.podspec\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:37:in `initialize'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:37:in `open'\n/System/Library/Frameworks/Ruby.framework/Versions/2.3/usr/lib/ruby/2.3.0/open-uri.rb:37:in `open'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/external_sources/podspec_source.rb:19:in `block in fetch'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/user_interface.rb:86:in `titled_section'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/external_sources/podspec_source.rb:11:in `fetch'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:854:in `fetch_external_source'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:833:in `block (2 levels) in fetch_external_sources'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:832:in `each'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:832:in `block in fetch_external_sources'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/user_interface.rb:64:in `section'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:831:in `fetch_external_sources'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer/analyzer.rb:111:in `analyze'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer.rb:398:in `analyze'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer.rb:221:in `block in resolve_dependencies'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/user_interface.rb:64:in `section'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer.rb:220:in `resolve_dependencies'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/installer.rb:156:in `install!'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/command/install.rb:51:in `run'\n/Library/Ruby/Gems/2.3.0/gems/claide-1.0.2/lib/claide/command.rb:334:in `run'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/lib/cocoapods/command.rb:52:in `run'\n/Library/Ruby/Gems/2.3.0/gems/cocoapods-1.7.3/bin/pod:55:in `&lt;top (required)&gt;'\n/usr/local/bin/pod:22:in `load'\n/usr/local/bin/pod:22:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "sass", "jekyll", "github-pages"], "answers": [{"comments": [{"owner": {"reputation": 1265, "user_id": 1894196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fd3405808cc6a9fe4b126b1ec39bd?s=128&d=identicon&r=PG", "display_name": "GianArb", "link": "https://stackoverflow.com/users/1894196/gianarb"}, "edited": false, "score": 0, "creation_date": 1562166008, "post_id": 56871985, "comment_id": 100294593, "body": "Hello, it is not an import issue. The file exists and the jekyll scss plugin manages the base path as you can see in the _config.yaml <a href=\"https://github.com/gianarb/devcampy.com/blob/master/_config.yml#L12\" rel=\"nofollow noreferrer\">github.com/gianarb/devcampy.com/blob/master/_config.yml#L12</a> . I tried your solution btw to double check and I get the same error. It also does not explain why locally it works fine both way"}, {"owner": {"reputation": 1265, "user_id": 1894196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fd3405808cc6a9fe4b126b1ec39bd?s=128&d=identicon&r=PG", "display_name": "GianArb", "link": "https://stackoverflow.com/users/1894196/gianarb"}, "edited": false, "score": 1, "creation_date": 1562233860, "post_id": 56871985, "comment_id": 100317785, "body": "Now I know I should use this command more often <code>git check-ignore *</code>"}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1562162903, "creation_date": 1562162903, "answer_id": 56871985, "question_id": 56869979, "link": "https://stackoverflow.com/questions/56869979/jekyll-site-fails-only-when-pushed-to-github/56871985#56871985", "title": "Jekyll site fails only when pushed to GitHub", "body": "<p>The error is telling what the problem is. You have this on the line in main.scss</p>\n\n<pre><code>@import \"bootstrap/scss/bootstrap\";\n</code></pre>\n\n<p>So this means the file may exist locally but is not able to import on your deploy since it's not there.  </p>\n\n<p>Looking at your repo I see you have bootstrap located here:</p>\n\n<pre><code>node_modules/bootstrap/dist/css/bootstrap.min.css\n</code></pre>\n\n<p>So try this instead:</p>\n\n<pre><code>@import \"../node_modules/bootstrap/dist/css/bootstrap.min.css\";\n// or you could try\n@import \"../node_modules/bootstrap/scss/bootstrap.scss\"\n</code></pre>\n\n<p>I would think one of those should work.</p>\n"}, {"comments": [{"owner": {"reputation": 1265, "user_id": 1894196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fd3405808cc6a9fe4b126b1ec39bd?s=128&d=identicon&r=PG", "display_name": "GianArb", "link": "https://stackoverflow.com/users/1894196/gianarb"}, "edited": false, "score": 0, "creation_date": 1562230628, "post_id": 56883258, "comment_id": 100315804, "body": "You can not imagine how much time I spent looking and thinking about this issue. thanks"}], "tags": [], "owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "is_accepted": true, "score": 7, "last_activity_date": 1562228211, "last_edit_date": 1562228211, "creation_date": 1562227178, "answer_id": 56883258, "question_id": 56869979, "link": "https://stackoverflow.com/questions/56869979/jekyll-site-fails-only-when-pushed-to-github/56883258#56883258", "title": "Jekyll site fails only when pushed to GitHub", "body": "<p>Your current bootstrap code is incomplete. \n<strong>/node_modules/bootstrap/scss/vendor/_rfs.scss</strong> is missing because of a <strong>.gitignore</strong> rule that prevent any <strong>vendor</strong> folder to be versioned.</p>\n\n<ol>\n<li><p>In your <strong>.gitignore</strong>, replace <code>vendor</code> line by <code>vendor/bundle</code></p></li>\n<li><p>run <code>npm install bootstrap</code> to override current version</p></li>\n</ol>\n"}], "owner": {"reputation": 1265, "user_id": 1894196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa5fd3405808cc6a9fe4b126b1ec39bd?s=128&d=identicon&r=PG", "display_name": "GianArb", "link": "https://stackoverflow.com/users/1894196/gianarb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 1, "accepted_answer_id": 56883258, "answer_count": 2, "score": 4, "last_activity_date": 1562228211, "creation_date": 1562156223, "question_id": 56869979, "link": "https://stackoverflow.com/questions/56869979/jekyll-site-fails-only-when-pushed-to-github", "title": "Jekyll site fails only when pushed to GitHub", "body": "<p>I am developing a new version of a static website with Jekyll that deployed via Github pages: <a href=\"https://devcampy.com\" rel=\"nofollow noreferrer\">https://devcampy.com</a></p>\n\n<p>The repository: <a href=\"https://github.com/gianarb/devcampy.com\" rel=\"nofollow noreferrer\">https://github.com/gianarb/devcampy.com</a></p>\n\n<p>Locally I run it with docker, and I am not able to reproduce the issue:</p>\n\n<pre><code>$ docker run --rm -p 4000:4000 -v \"$PWD\":/srv/jekyll jekyll/jekyll:stable jekyll serve\n</code></pre>\n\n<p>This is the error I get via email when I push to the repository. I can't figure out why it does not work properly</p>\n\n<pre><code>The page build failed for the `master` branch with the following error:\n\nYour SCSS file `assets/main.scss` has an error on line 6: File to import not found or unreadable: vendor/rfs. Load paths: node_modules /hoosegow/.bundle/ruby/2.5.0/gems/jekyll-theme-primer-0.5.3/_sass /hoosegow/.bundle/ruby/2.5.0/gems/jekyll-theme-primer-0.5.3/_sass /hoosegow/.bundle/ruby/2.5.0/gems/jekyll-theme-primer-0.5.3/_sass. For more information, see https://help.github.com/en/articles/page-build-failed-invalid-sass-or-scss.\n</code></pre>\n\n<p>Does somebody have any feedback? Thanks a lot</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562215251, "post_id": 56870901, "comment_id": 100309503, "body": "I need final result should have Date, Price, Tax columns. All other columns are not needed."}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562215519, "post_id": 56870901, "comment_id": 100309558, "body": "I see some Date values are nil in the final result"}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562221962, "post_id": 56870901, "comment_id": 100311569, "body": "I have used like this to get only Date, Price, Tax columns and fix null values in Date. Is this a better way do this? a1.map { |k,v| v.merge(a2[k] || {}) { |h, old_val, new_val|      if old_val.is_a? Float     old_val - new_val       elsif old_val == new_val     old_val   end } }.map do |hash|      hash.select{|k,v|       (&quot;Date&quot; &quot;Price&quot; &quot;Tax&quot;).include? k}     end"}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562244262, "post_id": 56870901, "comment_id": 100323426, "body": "If the inputs are csv string instead of array of hashes. Will it be better and faster to do the above merge in Ruby on Rails?"}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562284760, "post_id": 56870901, "comment_id": 100336476, "body": "Let me know you suggestions on the above question"}, {"owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562298563, "post_id": 56870901, "comment_id": 100338409, "body": "My Inputs are always csv. I am converting csv to array of hashes and doing the transformations such as merging like above question, adding/removing columns like this <a href=\"https://stackoverflow.com/q/54965593/1381266\">stackoverflow.com/q/54965593/1381266</a> and then convert back to csv from array of hashes. Will it be better to do transformations on csv instead of conversion between csv and array of hashes?"}, {"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "reply_to_user": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "edited": false, "score": 0, "creation_date": 1562311142, "post_id": 56870901, "comment_id": 100341981, "body": "I suppose the intermediate objects to be handled are still <code>Array</code> and <code>Hash</code>. I guess it is possible make some improvements. Consider to post a new question, where you have raw <code>csv</code> input and expected <code>csv</code> output. Better to add also some try."}], "tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": true, "score": 2, "last_activity_date": 1562295193, "last_edit_date": 1562295193, "creation_date": 1562159363, "answer_id": 56870901, "question_id": 56869966, "link": "https://stackoverflow.com/questions/56869966/how-to-add-and-merge-values-from-different-array-of-hashes-in-ruby-on-rails/56870901#56870901", "title": "How to add and merge values from different array of hashes in ruby on rails", "body": "<p>Using two helper methods for a DRY code and using <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-sum\" rel=\"nofollow noreferrer\">Enumerable#sum</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a>, <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-transform_values\" rel=\"nofollow noreferrer\">Hash#transform_values</a> and also other methods you can find in the documentation.</p>\n\n<p>I'm using also <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-then\" rel=\"nofollow noreferrer\">Object#then</a> here.</p>\n\n<pre><code>def sum_price_tax(ary)\n  ary.first.merge ary.then { |ary| { \"Price\" =&gt; ary.sum { |h| h[\"Price\"].to_f }, \"Tax\" =&gt; ary.sum { |h| h[\"Tax\"].to_f} }  }\nend\n\ndef group_and_sum(array_of_hash)\n  array_of_hash.group_by { |h| h[\"Date\"] }.transform_values { |ary| sum_price_tax(ary) }\nend\n</code></pre>\n\n<p>After the methods are defined, you can do:</p>\n\n<pre><code>a1 = group_and_sum(array_of_hash1)\na2 = group_and_sum(array_of_hash2)\na1.map { |k, v| v.merge(a2[k] || {}) { |h, old_val, new_val| old_val.is_a?(Float) ? old_val - new_val : old_val  } }\n\n#=&gt; [{\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\", \"Email\"=&gt;\"sample1@gmail.com\", \"Price\"=&gt;2.2121007000000006, \"Tax\"=&gt;6.254, \"Name\"=&gt;\"John\"}, {\"Date\"=&gt;\"2019-06-30\", \"Country\"=&gt;\"US\", \"Email\"=&gt;\"sample3@gmail.com\", \"Price\"=&gt;17.854323, \"Tax\"=&gt;7.12343}, {\"Date\"=&gt;\"2019-07-02\", \"Country\"=&gt;\"UK\", \"Email\"=&gt;\"sample4@gmail.com\", \"Price\"=&gt;4.0019787, \"Tax\"=&gt;1.9798780000000002, \"Name\"=&gt;\"Sam\"}]\n</code></pre>\n\n<p>In this way also the <code>\"Name\"</code> is present. \n<hr>\nOne way you could get rid of <code>\"Name\"</code> is using <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-tap\" rel=\"nofollow noreferrer\">Object#tap</a> and <a href=\"https://ruby-doc.org/core-2.6.3/Hash.html#method-i-delete\" rel=\"nofollow noreferrer\">Hash#delete</a>:</p>\n\n<pre><code>a1.map { |k, v| v.merge(a2[k] || {}) { |h, old_val, new_val| old_val.is_a?(Float) ? old_val - new_val : old_val  }.tap { |h| h.delete(\"Name\") } }\n\n#=&gt; [{\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\", \"Email\"=&gt;\"sample1@gmail.com\", \"Price\"=&gt;2.2121007000000006, \"Tax\"=&gt;6.254}, {\"Date\"=&gt;\"2019-06-30\", \"Country\"=&gt;\"US\", \"Email\"=&gt;\"sample3@gmail.com\", \"Price\"=&gt;17.854323, \"Tax\"=&gt;7.12343}, {\"Date\"=&gt;\"2019-07-02\", \"Country\"=&gt;\"UK\", \"Email\"=&gt;\"sample4@gmail.com\", \"Price\"=&gt;4.0019787, \"Tax\"=&gt;1.9798780000000002}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1562303015, "last_edit_date": 1562303015, "creation_date": 1562198104, "answer_id": 56879175, "question_id": 56869966, "link": "https://stackoverflow.com/questions/56869966/how-to-add-and-merge-values-from-different-array-of-hashes-in-ruby-on-rails/56879175#56879175", "title": "How to add and merge values from different array of hashes in ruby on rails", "body": "<p>We are given the following (simplified from the arrays given in the question and with one hash added to <code>arr2</code>):</p>\n\n<pre><code>arr1 = [ \n  {\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\", \"Price\"=&gt;\"11.22\", \"Tax\"=&gt;\"8.55\"},\n  {\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\", \"Price\"=&gt;\"16.66\", \"Tax\"=&gt;\"6.55\"},\n  {\"Date\"=&gt;\"2019-06-30\", \"Country\"=&gt;\"US\", \"Price\"=&gt;\"17.85\", \"Tax\"=&gt;\"7.12\"},\n  {\"Date\"=&gt;\"2019-07-02\", \"Country\"=&gt;\"UK\", \"Price\"=&gt;\"14.22\", \"Tax\"=&gt;\"4.32\"}\n]\n\narr2 = [\n  {\"Date\"=&gt;\"2019-07-01\", \"Price\"=&gt;\"11.34\", \"Tax\"=&gt;\"3.44\"},\n  {\"Date\"=&gt;\"2019-07-01\", \"Price\"=&gt;\"14.33\", \"Tax\"=&gt;\"5.41\"},\n  {\"Date\"=&gt;\"2019-07-02\", \"Price\"=&gt;\"10.22\", \"Tax\"=&gt;\"2.34\"},\n  {\"Date\"=&gt;\"2019-07-03\", \"Price\"=&gt;\"14.67\", \"Tax\"=&gt;\"3.14\"}\n]\n</code></pre>\n\n<p>We will need a list of dates that are values of <code>\"Date\"</code> in the hashes in <code>arr1</code>.</p>\n\n<pre><code>dates1 = arr1.map { |g| g[\"Date\"] }.uniq\n  #=&gt; [\"2019-07-01\", \"2019-06-30\", \"2019-07-02\"] \n</code></pre>\n\n<p>Now convert <code>arr2</code> to an array of those elements <code>h</code> in <code>arr2</code> for which <code>h[\"Date\"]</code> is in <code>dates1</code>, with all keys other than <code>\"Price\"</code> and <code>\"Tax\"</code> removed from each hash retained, and with the values of those two keys converted to string representations of their values negated: </p>\n\n<pre><code>a2 = arr2.each_with_object([]) do |g,arr| arr &lt;&lt;\n  { \"Date\"=&gt;g[\"Date\"], \"Price\"=&gt;\"-\" &lt;&lt; g[\"Price\"], \"Tax\" =&gt;\"-\" &lt;&lt; g[\"Tax\"] } if\n    dates1.include?(g[\"Date\"])\nend\n  #=&gt; [{\"Date\"=&gt;\"2019-07-01\", \"Price\"=&gt;\"-11.34\", \"Tax\"=&gt;\"-3.44\"},\n  #    {\"Date\"=&gt;\"2019-07-01\", \"Price\"=&gt;\"-14.33\", \"Tax\"=&gt;\"-5.41\"},\n  #    {\"Date\"=&gt;\"2019-07-02\", \"Price\"=&gt;\"-10.22\", \"Tax\"=&gt;\"-2.34\"}] \n</code></pre>\n\n<p>We now loop over all elements of <code>arr1</code> and <code>a2</code> to create hash with keys the values of <code>\"Date\"</code>, with values of <code>\"Price\"</code> and <code>\"Tax\"</code> aggregated. Once that is done we extract the value of the hash that has been constructed.</p>\n\n<pre><code>(arr1 + a2).each_with_object({}) do |g,h|\n  h.update(g[\"Date\"]=&gt;g) do |_,merged_hash,hash_to_merge|\n    merged_hash.merge(hash_to_merge) do |k,merged_str,str_to_merge| \n      [\"Price\", \"Tax\"].include?(k) ? \"%.2f\" %\n        (merged_str.to_f + str_to_merge.to_f) : merged_str\n    end\n  end\nend.values\n  #=&gt; [{\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\", \"Price\"=&gt;\"2.21\",  \"Tax\"=&gt;\"6.25\"},\n  #    {\"Date\"=&gt;\"2019-06-30\", \"Country\"=&gt;\"US\", \"Price\"=&gt;\"17.85\", \"Tax\"=&gt;\"7.12\"},\n  #    {\"Date\"=&gt;\"2019-07-02\", \"Country\"=&gt;\"UK\", \"Price\"=&gt;\"4.00\",  \"Tax\"=&gt;\"1.98\"}] \n</code></pre>\n\n<p>In this last step the receiver of <code>values</code> is found to be the hash:</p>\n\n<pre><code>{\"2019-07-01\"=&gt;{\"Date\"=&gt;\"2019-07-01\", \"Country\"=&gt;\"US\",\n                \"Price\"=&gt;\"2.21\", \"Tax\"=&gt;\"6.25\"},\n \"2019-06-30\"=&gt;{\"Date\"=&gt;\"2019-06-30\", \"Country\"=&gt;\"US\",\n                \"Price\"=&gt;\"17.85\", \"Tax\"=&gt;\"7.12\"},\n \"2019-07-02\"=&gt;{\"Date\"=&gt;\"2019-07-02\", \"Country\"=&gt;\"UK\",\n                \"Price\"=&gt;\"4.00\", \"Tax\"=&gt;\"1.98\"}}\n</code></pre>\n\n<p>Notice that the result would be the same if <code>arr[1][\"Country\"]=&gt;\"Canada\"</code>. I've assumed that would not be a problem or could not occur.</p>\n\n<p>The last step uses versions of the methods <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-update\" rel=\"nofollow noreferrer\">Hash#update</a> (a.k.a. <code>merge!</code>) and <a href=\"http://ruby-doc.org/core-2.5.1/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a> that employ a hash to determine the values of keys that are present in both hashes being merged.</p>\n\n<p>The values of the block variables (<code>|_,merged_hash,hash_to_merge|</code> and <code>|k,merged_str,str_to_merge|</code>) are explained in the docs. The first block variable is the common key (<code>_</code> and <code>k</code>). I've represented the first of these with an underscore to signal to the reader that it is not used in the block calculation (a common convention). The second block variable is the value of the key in the hash being built (<code>merged_hash</code> and <code>merged_str</code>). The third block variable is the value of the key in the hash being merged (<code>merged_hash</code> and <code>str_to_merge</code>).</p>\n"}], "owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 56870901, "answer_count": 2, "score": 1, "last_activity_date": 1562303015, "creation_date": 1562156199, "last_edit_date": 1562157757, "question_id": 56869966, "link": "https://stackoverflow.com/questions/56869966/how-to-add-and-merge-values-from-different-array-of-hashes-in-ruby-on-rails", "title": "How to add and merge values from different array of hashes in ruby on rails", "body": "<pre><code>array_of_hash1 = \n    [{\"Date\" =&gt; \"2019-07-01\", \"Country\" =&gt; \"US\", \"Email\" =&gt; \"sample1@gmail.com\", \"Price\" =&gt; \"11.224323\", \"Tax\" =&gt; \"8.55443\"},\n     {\"Date\" =&gt; \"2019-07-01\", \"Country\" =&gt; \"US\", \"Email\" =&gt; \"sample2@gmail.com\", \"Price\" =&gt; \"16.664323\", \"Tax\" =&gt; \"6.55443\"},\n     {\"Date\" =&gt; \"2019-06-30\", \"Country\" =&gt; \"US\", \"Email\" =&gt; \"sample3@gmail.com\", \"Price\" =&gt; \"17.854323\", \"Tax\" =&gt; \"7.12343\"},\n     {\"Date\" =&gt; \"2019-07-02\", \"Country\" =&gt; \"UK\", \"Email\" =&gt; \"sample4@gmail.com\", \"Price\" =&gt; \"14.224323\", \"Tax\" =&gt; \"4.32443\"}]\n\narray_of_hash2 = \n    [{\"Date\" =&gt; \"2019-07-01\", \"Name\" =&gt; \"John\", \"Price\" =&gt; \"11.3442223\", \"Tax\" =&gt; \"3.44343\"},\n     {\"Date\" =&gt; \"2019-07-01\", \"Name\" =&gt; \"Jack\", \"Price\" =&gt; \"14.332323\", \"Tax\" =&gt; \"5.41143\"},\n    {\"Date\" =&gt; \"2019-07-02\", \"Name\" =&gt; \"Sam\", \"Price\" =&gt; \"10.2223443\", \"Tax\" =&gt; \"2.344552\"}]\n</code></pre>\n\n<p>Above are my inputs in array of hashes</p>\n\n<ol>\n<li>Add Price and Tax in array_of_hash1 by Date</li>\n<li>Add Price and Tax in array_of_hash2 by Date</li>\n<li>Subtract as (i) - (ii)</li>\n<li>If there are no values in array_of_hash2 by Date compare with array_of_hash1. Then take values from array_of_hash1 only.</li>\n</ol>\n\n<p>Here is my expected output.</p>\n\n<p>Expected Output:</p>\n\n<pre><code>[{\"Date\" =&gt; \"2019-07-01\", \"Country\" =&gt; \"US\", \"Email\" =&gt; \"sample1@gmail.com\", \"Price\" =&gt; \"2.2121007000000006\", \"Tax\" =&gt; \"6.254\"}, \n {\"Date\" =&gt; \"2019-07-02\", \"Country\" =&gt; \"UK\", \"Email\" =&gt; \"sample4@gmail.com\", \"Price\" =&gt; \"4.0019787\", \"Tax\" =&gt; \"1.9798780000000002\"},\n{\"Date\" =&gt; \"2019-06-30\", \"Country\" =&gt; \"US\", \"Email\" =&gt; \"sample3@gmail.com\", \"Price\" =&gt; \"17.854323\", \"Tax\" =&gt; \"7.12343\"}]\n</code></pre>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 6683147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b3599d7eab61ae82354d60a4464703?s=128&d=identicon&r=PG&f=1", "display_name": "Gilg Him", "link": "https://stackoverflow.com/users/6683147/gilg-him"}, "is_accepted": false, "score": 0, "last_activity_date": 1562159780, "last_edit_date": 1562159780, "creation_date": 1562159209, "answer_id": 56870858, "question_id": 56869296, "link": "https://stackoverflow.com/questions/56869296/is-it-possible-to-create-a-new-rspec-matcher-by-composing-existing-ones/56870858#56870858", "title": "Is it possible to create a new RSpec matcher by composing existing ones?", "body": "<p>According to <a href=\"https://relishapp.com/rspec/rspec-expectations/v/3-3/docs/custom-matchers/define-matcher\" rel=\"nofollow noreferrer\">this</a></p>\n\n<p>You could do something like this:</p>\n\n<pre><code>RSpec::Matchers.define :be_successful do\n\n  match do |result|\n    result.status == :success &amp;&amp;\n    result.offers.length &gt; 0 &amp;&amp;\n    result.comments.empty?\n  end\n\n  failure_message do |result|\n    \"Should have #{result} equal to be successful\"\n  end\n\n  failure_message_when_negated do |result|\n    \"Should not have #{result} to be successful\"\n  end\nend\n</code></pre>\n\n<p>If you reuse this test elsewhere more than 3 times, then it makes sense to create a new matcher and override the failure messages(It's not an overhead). If you use this test only one time then it makes sense to keep it without overly abstract it.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13743626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e841b4cb8b30a1ede853ea9e6c33761?s=128&d=identicon&r=PG", "display_name": "Andreas", "link": "https://stackoverflow.com/users/13743626/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1592127791, "creation_date": 1592127791, "answer_id": 62370832, "question_id": 56869296, "link": "https://stackoverflow.com/questions/56869296/is-it-possible-to-create-a-new-rspec-matcher-by-composing-existing-ones/62370832#62370832", "title": "Is it possible to create a new RSpec matcher by composing existing ones?", "body": "<p>One way of organizing this is: Put the real testing code into \na method <code>_check_ok(expected, actual)</code> of its own,\nwhich returns either <code>[true]</code> or <code>[false, message]</code>.</p>\n\n<p>This is called as follows:</p>\n\n<pre><code>  RSpec::Matchers.defined :check_ok do |expected|\n    match do |actual|\n      return _check_ok(expected, actual)[0]\n    end\n    failure_message do |actual|\n      return _check_ok(expected, actual)[1]\n    end\n  end\n</code></pre>\n\n<p>This repeats the <code>_check_ok</code> call in the failure case,\nwhich normally isn't a problem.</p>\n"}], "owner": {"reputation": 48302, "user_id": 388916, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f9d967832644f9faa431e4e50b69bb0?s=128&d=identicon&r=PG", "display_name": "Hubro", "link": "https://stackoverflow.com/users/388916/hubro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1592127791, "creation_date": 1562154015, "question_id": 56869296, "link": "https://stackoverflow.com/questions/56869296/is-it-possible-to-create-a-new-rspec-matcher-by-composing-existing-ones", "title": "Is it possible to create a new RSpec matcher by composing existing ones?", "body": "<p>In one of my specs, I find myself repeating lines like these often:</p>\n\n<pre><code>expect(result.status).to be(:success)\nexpect(result.offers).not_to be_empty\nexpect(result.comments).to be_empty\n</code></pre>\n\n<p>To make my tests more succinct and readable, I want to compose these into a line like this:</p>\n\n<pre><code>expect(result).to be_successful\n</code></pre>\n\n<p>I can do this by creating a custom matcher:</p>\n\n<pre><code>matcher :be_successful do\n  match { |result|\n    result.status == :success &amp;&amp;\n    result.offers.length &gt; 0 &amp;&amp;\n    result.comments.empty?\n  }\nend\n</code></pre>\n\n<p>But I now have a failing test, and the failure message is completely useless. All it says now is <code>Expected #&lt;Result ...&gt; to be successful</code>.</p>\n\n<p>I know I can override the failure message, but now this solution is getting more complicated than it's worth for saving 2 lines for every spec example. The original 3 lines generated useful failure messages, all I wanted to do was combine them into 1 line.</p>\n\n<p>I could move the 3 lines into a separate function (e.g. <code>assert_successful</code>) and call that from each spec example, but I'd like to keep the matcher syntax.</p>\n\n<p>Can this be done?</p>\n"}, {"tags": ["ruby", "kiba-etl"], "answers": [{"comments": [{"owner": {"reputation": 1844, "user_id": 5662805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45a62036fef674591172e904bad55e9?s=128&d=identicon&r=PG&f=1", "display_name": "wuarmin", "link": "https://stackoverflow.com/users/5662805/wuarmin"}, "edited": false, "score": 0, "creation_date": 1562180635, "post_id": 56874557, "comment_id": 100301586, "body": "thank you for the explanation and your thoughts. I have one further question: I cannot do one-off imports. I have to implement an incremental approach. If bookings are updated, they have to be reimported. Where do you delete existing bookings and their children? At the booking-destination?"}, {"owner": {"reputation": 8681, "user_id": 20302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91eb330fb36d1e03c856574dfb77d2bc?s=128&d=identicon&r=PG", "display_name": "Thibaut Barr&#232;re", "link": "https://stackoverflow.com/users/20302/thibaut-barr%c3%a8re"}, "reply_to_user": {"reputation": 1844, "user_id": 5662805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45a62036fef674591172e904bad55e9?s=128&d=identicon&r=PG&f=1", "display_name": "wuarmin", "link": "https://stackoverflow.com/users/5662805/wuarmin"}, "edited": false, "score": 0, "creation_date": 1563117966, "post_id": 56874557, "comment_id": 100586443, "body": "(for the record, I replied via email)"}], "tags": [], "owner": {"reputation": 8681, "user_id": 20302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91eb330fb36d1e03c856574dfb77d2bc?s=128&d=identicon&r=PG", "display_name": "Thibaut Barr&#232;re", "link": "https://stackoverflow.com/users/20302/thibaut-barr%c3%a8re"}, "is_accepted": true, "score": 1, "last_activity_date": 1562171482, "creation_date": 1562171482, "answer_id": 56874557, "question_id": 56869176, "link": "https://stackoverflow.com/questions/56869176/how-to-transform-nested-json-payloads-with-kiba-etl/56874557#56874557", "title": "How to transform nested JSON-payloads with Kiba-ETL?", "body": "<p>Author of Kiba here!</p>\n\n<p>This is a common requirement, but it can (and this is not specific to Kiba) be more or less complex to handle. Here are a few points you'll need to think about.</p>\n\n<h1>Handling of foreign keys</h1>\n\n<p>The main problem here is that you'll want to keep the relationships between services and bookings, once they are inserted.</p>\n\n<h2>Foreign keys using business keys</h2>\n\n<p>A first (most easy) way to handle this is to use a foreign-key constraint on \"booking number\", and make sure to insert that booking number in each service row, so that you can leverage it later in your queries. If you do this (see <a href=\"https://stackoverflow.com/a/18435114/20302\">https://stackoverflow.com/a/18435114/20302</a>) you'll have to set a unique-constraint on \"booking number\" in the bookings table target.</p>\n\n<h2>Foreign keys using primary keys</h2>\n\n<p>If you instead prefer to have a <code>booking_id</code> which points to the <code>bookings</code> table <code>id</code> key, things are a bit more complicated.</p>\n\n<p>If this is a one-off import targeting an empty table, I recommend that you arbitrarily force the primary key using something like:</p>\n\n<pre><code>transform do |r|\n  @row_index ||= 0\n  @row_index += 1\n  r.merge(id: @row_index)\nend\n</code></pre>\n\n<p>If this not a one-off import, you will have to:\n* Upsert bookings in a first pass\n* In a second pass, look-up (via SQL queries) \"bookings\" to figure out what is the <code>id</code> to store in <code>booking_id</code>, then upsert the services</p>\n\n<p>As you see it's a bit more work, so stick with option 1 if you don't have strong requirements around this (although option 2 is more solid on the long run).</p>\n\n<h1>Example implementation (using Kiba Pro &amp; business keys)</h1>\n\n<p>The simplest way to achieve this (assuming your target is Postgres) is to use Kiba Pro's <a href=\"https://github.com/thbar/kiba/wiki/SQL-Bulk-Insert-Destination\" rel=\"nofollow noreferrer\">SQL Bulk Insert/Upsert destination</a>.</p>\n\n<p>It would go this way (in single pass):</p>\n\n<pre><code>extend Kiba::DSLExtensions::Config\nconfig :kiba, runner: Kiba::StreamingRunner\n\nsource Kiba::Common::Sources::Enumerable, -&gt; { Dir[\"input/*.json\"] }\n\ntransform { |r| JSON.parse(IO.read(r)).fetch('bookings') }\n\ntransform Kiba::Common::Transforms::EnumerableExploder\n\n# SNIP (remapping / renaming of fields etc)\n\nfirst_destination = nil\n\ndestination Kiba::Pro::Destinations::SQLBulkInsert,\n  row_pre_processor: -&gt; (row) { row.except(\"services\") },\n  dataset: -&gt; (dataset) {\n    dataset.insert_conflict(target: :booking_number)\n  },\n  after_read: -&gt; (d) { first_destination = d }\n\ndestination Kiba::Pro::Destinations::SQLBulkInsert,\n  row_pre_processor: -&gt; (row) { row.fetch(\"services\") },\n  dataset: -&gt; (dataset) {\n    dataset.insert_conflict(target: :service_number)\n  },\n  before_flush: -&gt; { first_destination.flush }\n</code></pre>\n\n<p>Here we iterate over each input file, parsing it and grabbing the \"bookings\", then generating one row per element of \"bookings\".</p>\n\n<p>We have 2 destinations, doing \"upsert\" (insert or update), plus one trick to ensure we'll save the parent rows before we insert the children, to avoid a failure due to missing pointed record.</p>\n\n<p>You can of course implement this yourself, but this is a bit of work though!</p>\n\n<p>If you need to use primary-key based foreign keys, you'll have (likely) to split in 2 pass (one for each destination), then add some form of lookup in the middle.</p>\n\n<h1>Conclusion</h1>\n\n<p>I know that this is not trivial (depending on what you'll need, &amp; if you'll use Kiba Pro or not), but at least I'm sharing the patterns that I'm using in such situations.</p>\n\n<p>Hope it helps a bit!</p>\n"}], "owner": {"reputation": 1844, "user_id": 5662805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45a62036fef674591172e904bad55e9?s=128&d=identicon&r=PG&f=1", "display_name": "wuarmin", "link": "https://stackoverflow.com/users/5662805/wuarmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 56874557, "answer_count": 1, "score": 0, "last_activity_date": 1562171482, "creation_date": 1562153547, "last_edit_date": 1562157420, "question_id": 56869176, "link": "https://stackoverflow.com/questions/56869176/how-to-transform-nested-json-payloads-with-kiba-etl", "title": "How to transform nested JSON-payloads with Kiba-ETL?", "body": "<p>I want to transform nested JSON-payloads into relational tables with Kiba-ETL. Here's a simplified pseudo-JSON-payload:</p>\n\n<pre><code>{\n  \"bookings\": [\n    {\n      \"bookingNumber\": \"1111\",\n      \"name\": \"Booking 1111\",\n      \"services\": [\n        {\n          \"serviceNumber\": \"45\",\n          \"serviceName\": \"Extra Service\"\n        }\n      ]\n    },\n    {\n      \"bookingNumber\": \"2222\",\n      \"name\": \"Booking 2222\",\n      \"services\": [\n        {\n          \"serviceNumber\": \"1\",\n          \"serviceName\": \"Super Service\"\n        },\n        {\n          \"serviceNumber\": \"2\",\n          \"serviceName\": \"Bonus Service\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>How can I transform this payload into two tables:</p>\n\n<ul>\n<li>bookings</li>\n<li>services (every service belongsTo a booking)</li>\n</ul>\n\n<p>I read a about yielding multiple rows with the help of  <code>Kiba::Common::Transforms::EnumerableExploder</code> at wiki, blog, ... etc. </p>\n\n<p>Would you solve my use-case by yielding multiple rows (the booking and multiple services), or would you implement a <code>Destination</code> which receives a whole booking and calls some Sub-Destinations (i.e. to create or update a service)?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8398727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d18fe78d6f0c57047a60bc79e7a2eca?s=128&d=identicon&r=PG&f=1", "display_name": "JJdinho", "link": "https://stackoverflow.com/users/8398727/jjdinho"}, "edited": false, "score": 1, "creation_date": 1562147984, "post_id": 56867092, "comment_id": 100283842, "body": "This is simple and efficient, thanks! Its one line of code where I would have used 15... much better \ud83d\udc4d"}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": true, "score": 4, "last_activity_date": 1562146417, "creation_date": 1562146417, "answer_id": 56867092, "question_id": 56867021, "link": "https://stackoverflow.com/questions/56867021/how-can-i-do-a-strict-check-on-if-a-ruby-array-contains-only-certain-values/56867092#56867092", "title": "How can I do a strict check on if a Ruby array contains only certain values?", "body": "<p>Simple subtraction will provide you desired output,</p>\n\n<pre><code>def compare(checked_array, standard)\n (checked_array - standard).empty?\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1562147245, "creation_date": 1562147245, "answer_id": 56867324, "question_id": 56867021, "link": "https://stackoverflow.com/questions/56867021/how-can-i-do-a-strict-check-on-if-a-ruby-array-contains-only-certain-values/56867324#56867324", "title": "How can I do a strict check on if a Ruby array contains only certain values?", "body": "<p>Another way with arrays intersection:</p>\n\n<pre><code>def compare(checked_array, standard)\n  (checked_array &amp; standard) == standard\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 2, "last_activity_date": 1562148981, "last_edit_date": 1562148981, "creation_date": 1562148580, "answer_id": 56867729, "question_id": 56867021, "link": "https://stackoverflow.com/questions/56867021/how-can-i-do-a-strict-check-on-if-a-ruby-array-contains-only-certain-values/56867729#56867729", "title": "How can I do a strict check on if a Ruby array contains only certain values?", "body": "<p>You could use <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html#method-i-subset-3F\" rel=\"nofollow noreferrer\">Set#subset?</a>:</p>\n\n<pre><code>require 'set'\n\ndef compare(checked_array, standard)\n s = Set.new(standard)\n c = Set.new(checked_array)\n c.subset? s\nend\n</code></pre>\n\n<p>As the documentation states:</p>\n\n<blockquote>\n  <p>Set implements a collection of unordered values with <strong>no duplicates</strong>. This is a hybrid of Array's intuitive inter-operation facilities and Hash's <strong>fast lookup</strong>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 481, "user_id": 9563947, "user_type": "registered", "profile_image": "https://graph.facebook.com/1677134499029007/picture?type=large", "display_name": "Shan", "link": "https://stackoverflow.com/users/9563947/shan"}, "edited": false, "score": 1, "creation_date": 1562150141, "post_id": 56867792, "comment_id": 100285042, "body": "There is no method as superset, its superset? <code>standard.to_set.superset?(check_array.to_set)</code>"}], "tags": [], "owner": {"reputation": 2000, "user_id": 952740, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d758ce8171d8e74b9c5f5a2e701f1b9b?s=128&d=identicon&r=PG", "display_name": "Nick M", "link": "https://stackoverflow.com/users/952740/nick-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1562151483, "last_edit_date": 1562151483, "creation_date": 1562148774, "answer_id": 56867792, "question_id": 56867021, "link": "https://stackoverflow.com/questions/56867021/how-can-i-do-a-strict-check-on-if-a-ruby-array-contains-only-certain-values/56867792#56867792", "title": "How can I do a strict check on if a Ruby array contains only certain values?", "body": "<p>Probably not as short and sweet as using subtraction/intersection but here goes:</p>\n\n<pre><code>require \"set\"\ndef compare(check_array, standard\n    standard.to_set.superset?(check_array.to_set) # return true if check_array is subset of standard\nend\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8398727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d18fe78d6f0c57047a60bc79e7a2eca?s=128&d=identicon&r=PG&f=1", "display_name": "JJdinho", "link": "https://stackoverflow.com/users/8398727/jjdinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "closed_date": 1562163831, "accepted_answer_id": 56867092, "answer_count": 4, "score": 2, "last_activity_date": 1562163837, "creation_date": 1562146155, "last_edit_date": 1562146522, "question_id": 56867021, "link": "https://stackoverflow.com/questions/56867021/how-can-i-do-a-strict-check-on-if-a-ruby-array-contains-only-certain-values", "closed_reason": "Duplicate", "title": "How can I do a strict check on if a Ruby array contains only certain values?", "body": "<p>I need to check an Array and see if it contains only certain values of another Array.</p>\n\n<p>I can think of ways to do this using the methods <code>map</code> and <code>select</code> and then iterating through the array with <code>includes?</code> but this would be far from efficient.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>values = ['2','4','5'] # return true if the array only contains these values...\n\na = ['1', '2', '3']\nb = ['1', '2', '4']\nc = ['2', '4']\nd = ['4', '5']\n\ndef compare(checked_array, standard)\n # Do something\nend\n</code></pre>\n\n<p>So, for my purpose, output should be,</p>\n\n<ul>\n<li>check(a, values) would return false </li>\n<li>check(b, values) would return false </li>\n<li>check(c, values) would return true</li>\n<li>check(d, values) would return true</li>\n</ul>\n"}, {"tags": ["ruby", "docker", "chef-infra", "chefdk"], "comments": [{"owner": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "edited": false, "score": 0, "creation_date": 1562625237, "post_id": 56866746, "comment_id": 100426558, "body": "You should fork+exec to the command line and not call it as a library like that it isn&#39;t really a public API.  You&#39;re bypassing things like the code in chef-config that ultimately forces a UTF-8 external encoding.  That way you also get a different ruby VM and can Bundler.with_clean_env around it and won&#39;t have to depsolve between chef-dk and your rails app and the gem versions can float differently."}, {"owner": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "edited": false, "score": 0, "creation_date": 1562625513, "post_id": 56866746, "comment_id": 100426623, "body": "Also if you wind up going down the path of needing to do hundreds of calls per second or something to &#39;chef update&#39; due to looping then what you probably want to do is create a new command in chef-dk itself which does the looping and then call that with a single fork+exec from your rails app.  I think chef-dk is built to be pluggable similarly to knife, although I don&#39;t know of any example code."}, {"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "reply_to_user": {"reputation": 3556, "user_id": 506908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c874984f69ef596764255efcd79113?s=128&d=identicon&r=PG", "display_name": "lamont", "link": "https://stackoverflow.com/users/506908/lamont"}, "edited": false, "score": 0, "creation_date": 1562656957, "post_id": 56866746, "comment_id": 100433903, "body": "Thank you for your comments! Well I want to avoid doing the fork+exec as I don&#39;t to parse the output to try to figure out what&#39;s going on and so on, that&#39;s the reason why I&#39;m using the API. I&#39;m actually using the code from the <code>chef update</code> ruby file, so I wasn&#39;t expecting to bypass any code, so I&#39;ll double check that. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "is_accepted": true, "score": 0, "last_activity_date": 1574409958, "last_edit_date": 1574409958, "creation_date": 1563279540, "answer_id": 57057125, "question_id": 56866746, "link": "https://stackoverflow.com/questions/56866746/encodingundefinedconversionerror-when-calling-chef-update-command-from-a-rails/57057125#57057125", "title": "Encoding::UndefinedConversionError when calling Chef update command from a Rails application", "body": "<p>Chef library is using a <code>Tempfile</code> in order to write the downloaded data somewhere, so I aliased its <code>write</code> method in order to call <code>force_encoding('UTF-8')</code> on the passed argument before to give it back to the original <code>write</code> method.</p>\n\n<p>Here is my override (in a <code>config/initializers/tempfile_override.rb</code> :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># frozen_string_literal: true\n\nrequire 'tempfile'\n\n#\n# Overrides the Tempfile write method in order to always use `force_encode` with\n# UTF-8 in order to solve the issue where `chef update` fails to write\n# downloaded cookbooks data and write it to the disk.\n# See https://stackoverflow.com/questions/56866746/encodingundefinedconversionerror-when-calling-chef-update-command-from-a-rails\n#\nclass Tempfile\n  alias old_write write\n  def write(data)\n    old_write(data.force_encoding('UTF-8'))\n  end\nend\n</code></pre>\n\n<p>I'm kind of forced to do that as I need to change the <code>Chef::UI</code> object in order to grab the Chef logs in my app.</p>\n\n<p>That's not clean, but I don't have a better way to do it without having to patch chef itself.</p>\n\n<p>Until something better has been found, this answer will be the accepted one.</p>\n\n<p>If you know a better way to do it, please help me <a href=\"https://gitlab.com/pharmony/commis\" rel=\"nofollow noreferrer\">here</a> :)</p>\n"}], "owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 57057125, "answer_count": 1, "score": 1, "last_activity_date": 1574409958, "creation_date": 1562145272, "question_id": 56866746, "link": "https://stackoverflow.com/questions/56866746/encodingundefinedconversionerror-when-calling-chef-update-command-from-a-rails", "title": "Encoding::UndefinedConversionError when calling Chef update command from a Rails application", "body": "<p>I'm building a Rails app that uses Chef-DK underthehood.</p>\n\n<p>What I'm trying to achieve is to execute the same code as the <code>chef update &lt;path/to/policyfile&gt;</code>.</p>\n\n<p>Here is the interesting part of the code :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'chef-dk/command/update'\n\nchef_update = ChefDK::Command::Update.new\nupdate_options = [policyfile_path]\nupdate_options &lt;&lt; '--debug' if Rails.env.development?\nupdate = chef_update.run(update_options)\n</code></pre>\n\n<p>When this run, it start to update the policyfile but fails with the following output:</p>\n\n<pre><code>Attributes already up to date\nBuilding policy k8sworker\nExpanded run list: recipe[fail2ban], recipe[os-hardening], recipe[rkhunter], recipe[ssh-hardening], recipe[ssh-keys], recipe[tincvpn]\nCaching Cookbooks...\nInstalling tincvpn ~&gt; 0.1.10 from github\nInstalling fail2ban 6.0.0\nError: Failed to generate Policyfile.lock\nReason: (Encoding::UndefinedConversionError) \"\\x8B\" from ASCII-8BIT to UTF-8\n/usr/local/lib/ruby/2.6.0/delegate.rb:349:in `write'\n/usr/local/lib/ruby/2.6.0/delegate.rb:349:in `block in delegating_block'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:528:in `block in stream_to_tempfile'\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:497:in `call_block'\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:488:in `&lt;&lt;'\n/usr/local/lib/ruby/2.6.0/net/protocol.rb:163:in `read'\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:293:in `block in read_body_0'\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:253:in `inflater'\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:283:in `read_body_0'\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:204:in `read_body'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:527:in `stream_to_tempfile'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:230:in `block in streaming_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http/basic_client.rb:92:in `block in request'\n/usr/local/lib/ruby/2.6.0/net/http.rb:1518:in `block in transport_request'\n/usr/local/lib/ruby/2.6.0/net/http/response.rb:165:in `reading_body'\n/usr/local/lib/ruby/2.6.0/net/http.rb:1517:in `transport_request'\n/usr/local/lib/ruby/2.6.0/net/http.rb:1479:in `request'\n/usr/local/lib/ruby/2.6.0/net/http.rb:1472:in `block in request'\n/usr/local/lib/ruby/2.6.0/net/http.rb:920:in `start'\n/usr/local/lib/ruby/2.6.0/net/http.rb:1470:in `request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http/basic_client.rb:69:in `request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:370:in `block in send_http_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:411:in `block in retrying_http_errors'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:409:in `loop'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:409:in `retrying_http_errors'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:365:in `send_http_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:388:in `block (2 levels) in send_http_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:485:in `follow_redirect'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:383:in `block in send_http_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:411:in `block in retrying_http_errors'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:409:in `loop'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:409:in `retrying_http_errors'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:365:in `send_http_request'\n/usr/local/bundle/gems/chef-15.1.36/lib/chef/http.rb:228:in `streaming_request'\n/usr/local/bundle/gems/cookbook-omnifetch-0.8.1/lib/cookbook-omnifetch/artifactserver.rb:42:in `install'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile/cookbook_location_specification.rb:81:in `ensure_cached'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile_compiler.rb:181:in `block in install'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile_compiler.rb:176:in `each'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile_compiler.rb:176:in `install'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile_services/install.rb:101:in `generate_lock_and_install'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/policyfile_services/install.rb:63:in `run'\n/usr/local/bundle/gems/chef-dk-4.0.60/lib/chef-dk/command/update.rb:93:in `run'\n/application/app/interactors/node_actions/run_chef_update.rb:24:in `call'\n...\n</code></pre>\n\n<p>And here is the Chef output with the <code>trace</code> log level:</p>\n\n<pre><code>worker_1     | [2019-07-03T08:02:17+00:00] TRACE: Chef::HTTP calling Chef::HTTP::Decompressor#handle_request\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: Chef::HTTP calling Chef::HTTP::CookieManager#handle_request\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: Chef::HTTP calling Chef::HTTP::ValidateContentLength#handle_request\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: Initiating GET to https://supermarket.chef.io/universe\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: ---- HTTP Request Header Data: ----\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: Accept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\nworker_1     | [2019-07-03T08:02:17+00:00] TRACE: ---- End HTTP Request Header Data ----\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: ---- HTTP Status and Header Data: ----\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: HTTP 1.1 200 OK\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: cache-control: max-age=0, private, must-revalidate\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: content-encoding: gzip\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: content-type: application/json; charset=utf-8\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: date: Wed, 03 Jul 2019 08:02:19 GMT\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: etag: W/\"461b5134d1467f6950f82af1510078a0\"\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: server: nginx\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: x-content-type-options: nosniff\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: x-frame-options: SAMEORIGIN\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: x-request-id: 0bc2cc4a-0399-4953-93db-699176e11e36\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: x-runtime: 0.301233\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: x-xss-protection: 1; mode=block\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: transfer-encoding: chunked\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: connection: Close\nworker_1     | [2019-07-03T08:02:20+00:00] TRACE: ---- End HTTP Status/Header Data ----\nworker_1     | [2019-07-03T08:02:22+00:00] TRACE: Chef::HTTP calling Chef::HTTP::ValidateContentLength#handle_response\nworker_1     | [2019-07-03T08:02:22+00:00] TRACE: HTTP server did not include a Content-Length header in response, cannot identify truncated downloads.\nworker_1     | [2019-07-03T08:02:22+00:00] TRACE: Chef::HTTP calling Chef::HTTP::CookieManager#handle_response\nworker_1     | [2019-07-03T08:02:22+00:00] TRACE: Chef::HTTP calling Chef::HTTP::Decompressor#handle_response\nworker_1     | [2019-07-03T08:02:22+00:00] TRACE: Decompressing gzip response\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: Chef::HTTP calling Chef::HTTP::Decompressor#handle_request\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: Chef::HTTP calling Chef::HTTP::CookieManager#handle_request\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: Chef::HTTP calling Chef::HTTP::ValidateContentLength#handle_request\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: Initiating GET to https://supermarket.chef.io/api/v1/cookbooks/fail2ban/versions/6.0.0/download\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: ---- HTTP Request Header Data: ----\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: Accept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\nworker_1     | [2019-07-03T08:02:23+00:00] TRACE: ---- End HTTP Request Header Data ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- HTTP Status and Header Data: ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: HTTP 1.1 302 Found\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: cache-control: no-cache\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: content-type: text/html; charset=utf-8\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: date: Wed, 03 Jul 2019 08:02:25 GMT\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: location: https://s3.amazonaws.com/community-files.opscode.com/cookbook_versions/tarballs/28864/original/fail2ban20190508-41006-1kydj0z.tar.gz?1557352785\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: server: nginx\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-content-type-options: nosniff\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-frame-options: SAMEORIGIN\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-request-id: 17a0d07d-cf03-45b3-956f-8eb7fcabd2a7\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-runtime: 0.044161\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-xss-protection: 1; mode=block\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: content-length: 209\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: connection: Close\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- End HTTP Status/Header Data ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- HTTP Response Body ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: &lt;html&gt;&lt;body&gt;You are being &lt;a href=\"https://s3.amazonaws.com/community-files.opscode.com/cookbook_versions/tarballs/28864/original/fail2ban20190508-41006-1kydj0z.tar.gz?1557352785\"&gt;redirected&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- End HTTP Response Body -----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP calling Chef::HTTP::ValidateContentLength#handle_stream_complete\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: No content-length information collected for the streamed download, cannot identify streamed download.\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP calling Chef::HTTP::CookieManager#handle_stream_complete\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP calling Chef::HTTP::Decompressor#handle_stream_complete\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Following redirect 1/10\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Initiating GET to https://s3.amazonaws.com/community-files.opscode.com/cookbook_versions/tarballs/28864/original/fail2ban20190508-41006-1kydj0z.tar.gz?1557352785\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- HTTP Request Header Data: ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Accept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- End HTTP Request Header Data ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- HTTP Status and Header Data: ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: HTTP 1.1 200 OK\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-amz-id-2: a2iOnve5iX8paa/pT2s+A21Bm8IvSqbjzYeP8mc2I2kNGSwgj9Wen8IyQlpiQ955grAF7xZKaQE=\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: x-amz-request-id: E74D7A5F59B4B3B0\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: date: Wed, 03 Jul 2019 08:02:26 GMT\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: last-modified: Wed, 08 May 2019 21:59:47 GMT\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: etag: \"5c15105980cf9bfb2467ed00b789be0a\"\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: accept-ranges: bytes\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: content-type: application/gzip\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: content-length: 9020\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: server: AmazonS3\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: connection: close\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: ---- End HTTP Status/Header Data ----\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Streaming download from https://supermarket.chef.io/api/v1/cookbooks/fail2ban/versions/6.0.0/download to tempfile /tmp/chef-rest20190703-1-cbdl7x\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: content_encoding = ''               initializing noop stream deflator.\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP::StreamHandler calling Chef::HTTP::ValidateContentLength::ContentLengthCounter#handle_chunk\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP::StreamHandler calling Chef::HTTP::Decompressor::NoopInflater#handle_chunk\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP::StreamHandler calling Chef::HTTP::ValidateContentLength::ContentLengthCounter#handle_chunk\nworker_1     | [2019-07-03T08:02:25+00:00] TRACE: Chef::HTTP::StreamHandler calling Chef::HTTP::Decompressor::NoopInflater#handle_chunk\n</code></pre>\n\n<p>So it's like while deflating the fail2ban archive from Amazon S3, it fails due to some encoding stuff.</p>\n\n<p>From that point:</p>\n\n<ol>\n<li>when I then run the <code>chef update</code> command from the terminal, it works fine, no errors</li>\n<li>when I run my code again, it works also without any errors (I guess due to the chef cached version of the cookbooks, so no more going through the failing code)</li>\n</ol>\n\n<p>So to me it's like something is missing in my code in order to get this part working, but I can't figure out what could it be.</p>\n\n<p>How could I solve this issue?</p>\n\n<p>P.S.: The app is running in a Docker container with a Linux Alpine.</p>\n"}, {"tags": ["ruby", "memory", "bytecode", "memory-address"], "comments": [{"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562152045, "post_id": 56865993, "comment_id": 100286054, "body": "I don&#39;t think it&#39;s actually possible. The interesting you can do is output the iseq to binary (which is actually loadable in some conditions) so that&#39;s where you&#39;ll be able to see real opcode."}, {"owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "reply_to_user": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562184150, "post_id": 56865993, "comment_id": 100302955, "body": "@user11659763 Thank you for your reply. That&#39;s an interesting approach. I will try it out. Thank you, again."}], "owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562142703, "creation_date": 1562142703, "question_id": 56865993, "link": "https://stackoverflow.com/questions/56865993/how-to-print-memory-addresses-of-ruby-instruction", "title": "How to print memory addresses of Ruby instruction?", "body": "<p>I'm trying to print the bytecode instructions that Ruby interpreter generates as well as the memory addresses associated for each instruction.</p>\n\n<p>I am aware of that I can use <code>RubyVM::InstructionSequence</code> to get the disassembled instruction sequence of a program, but it does not print memory addresses associated with. For example, all I get now is</p>\n\n<pre><code>0000 trace      8                                               (   1)\n0002 trac       1                                               (   2)\n0004 putself\n0005 putstring  \"hello, world\"\n0007 send       :puts, 1, nil, 8, &lt;ic:0&gt;\n0013 trace      16                                              (   3)\n0015 leave                                                      (   2)\n</code></pre>\n\n<p>But, I am looking for is additional info., such as</p>\n\n<pre><code>0x__MEM_ADDRESS__ putstring  \"hello, world\"\n</code></pre>\n\n<p>Or, something like that. My main point is, again, is to get the memory address of each instruction.</p>\n\n<p>Can anyone direct me to the place where I can get that information? Or, is it not possible? If that's the case, I'm happy to know that as well rather than putting too much effort to the question that has no answer to it.</p>\n\n<p>Appreciate all your help.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 190, "user_id": 1878295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PCxOo.jpg?s=128&g=1", "display_name": "Matej Chrenko", "link": "https://stackoverflow.com/users/1878295/matej-chrenko"}, "edited": false, "score": 0, "creation_date": 1566924124, "post_id": 56865964, "comment_id": 101804867, "body": "did you find a solution for this?"}, {"owner": {"reputation": 675, "user_id": 6763273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/17UgE.jpg?s=128&g=1", "display_name": "Adam Sibik", "link": "https://stackoverflow.com/users/6763273/adam-sibik"}, "reply_to_user": {"reputation": 190, "user_id": 1878295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PCxOo.jpg?s=128&g=1", "display_name": "Matej Chrenko", "link": "https://stackoverflow.com/users/1878295/matej-chrenko"}, "edited": false, "score": 0, "creation_date": 1566944178, "post_id": 56865964, "comment_id": 101812106, "body": "@MatejChrenko unfortunately not really, the only workaround I came up with is I&#39;m deleting all the lines that do not start with <code>{</code> with grep. What&#39;s you&#39;re use case? For me I essentially wanted to have a clear, JSON output in STDOUT that I could then handle with Kubernetes and then Grafana/ELK stack"}, {"owner": {"reputation": 190, "user_id": 1878295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PCxOo.jpg?s=128&g=1", "display_name": "Matej Chrenko", "link": "https://stackoverflow.com/users/1878295/matej-chrenko"}, "edited": false, "score": 0, "creation_date": 1567066419, "post_id": 56865964, "comment_id": 101854238, "body": "I have the same usecase. Only difference is I need it for splunk. Which still means json in STDOUT. What I need extra is to add whole backtrace (that non json lines) into that json."}], "owner": {"reputation": 675, "user_id": 6763273, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/17UgE.jpg?s=128&g=1", "display_name": "Adam Sibik", "link": "https://stackoverflow.com/users/6763273/adam-sibik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1562142558, "creation_date": 1562142558, "question_id": 56865964, "link": "https://stackoverflow.com/questions/56865964/how-to-suppress-printing-exceptions-names-and-their-backtrace-in-ruby-ror-app", "title": "How to suppress printing exceptions&#39; names and their backtrace in Ruby / RoR app?", "body": "<p>I want Ruby on Rails app output logs only in JSON so it's edible for most log processing tools. I'm using Lograge for that. However, when there is an exception raised, not only JSON logline is shown, but also the exception's name and its backtrace. This breaks JSON parsing.</p>\n\n<p>Example of an output:</p>\n\n<pre><code>{\"method\":\"GET\",\"path\":\"/raise_exception_path\",\"format\":\"html\",\"controller\":\"ApplicationController\",\"action\":\"raise_exception_path\",\"status\":500,\"error\":\"RuntimeError: exception is raised error\",\"duration\":46.0,\"view\":0.37,\"db\":0.0,\"exception\":[\"RuntimeError\",\"exception is raised\"],\"exception_object\":\"exception is raised \",\"@timestamp\":\"2019-07-03T08:18:16.979Z\",\"@version\":\"1\",\"message\":\"[500] GET /version (ApplicationController#version)\"}\n\nRuntimeError (exception is raised):\n\napp/controllers/application_controller.rb:6:in `version'\n</code></pre>\n\n<p>I've tried Rails' log silencers/filters, but they'd only deal with the backtrace - not the exception name itself. A line <code>RuntimeError (exception is raised):</code> is still printed to the console.</p>\n\n<p>Also, I thought maybe it's just enough to redirect STDERR to <code>/dev/null</code>, but apparently these exceptions and their backtrace are printed to STDOUT.</p>\n\n<p>My application configuration:</p>\n\n<pre><code>    config.logger = ActiveSupport::Logger.new(STDOUT)\n    config.lograge.enabled = true\n    config.lograge.base_controller_class = 'ActionController::API'\n    config.lograge.formatter = Lograge::Formatters::Logstash.new\n\n    config.lograge.custom_options = lambda do |event|\n      {\n        exception: event.payload[:exception], # [\"ExceptionClass\", \"the message\"]\n        exception_object: event.payload[:exception_object] # the exception instance\n      }\n    end\n    $stderr.reopen(\"/dev/null\", \"w\")\n</code></pre>\n\n<p>The expected result would be that on production I have a stream of JSON-only loglines, ideally printed to STDOUT, without any exceptions or stacktraces.</p>\n\n<pre><code>{\"method\":\"GET\",\"path\":\"/\",\"format\":\"html\",\"controller\":\"TimezoneController\",\"action\":\"timezone\",\"status\":200,\"duration\":11.56,\"view\":2.0,\"db\":0.0,\"exception\":null,\"exception_object\":null,\"@timestamp\":\"2019-07-03T08:18:13.954Z\",\"@version\":\"1\",\"message\":\"[200] GET / (TimezoneController#timezone)\"}\n{\"method\":\"GET\",\"path\":\"/version\",\"format\":\"html\",\"controller\":\"ApplicationController\",\"action\":\"version\",\"status\":500,\"error\":\"RuntimeError: earth is flat error\",\"duration\":46.0,\"view\":0.37,\"db\":0.0,\"exception\":[\"RuntimeError\",\"earth is flat error\"],\"exception_object\":\"earth is flat error\",\"@timestamp\":\"2019-07-03T08:18:16.979Z\",\"@version\":\"1\",\"message\":\"[500] GET /version (ApplicationController#version)\"}\n{\"method\":\"GET\",\"path\":\"/\",\"format\":\"html\",\"controller\":\"TimezoneController\",\"action\":\"timezone\",\"status\":200,\"duration\":11.56,\"view\":2.0,\"db\":0.0,\"exception\":null,\"exception_object\":null,\"@timestamp\":\"2019-07-03T08:18:13.954Z\",\"@version\":\"1\",\"message\":\"[200] GET / (TimezoneController#timezone)\"}\n{\"method\":\"GET\",\"path\":\"/version\",\"format\":\"html\",\"controller\":\"ApplicationController\",\"action\":\"version\",\"status\":500,\"error\":\"RuntimeError: earth is flat error\",\"duration\":46.0,\"view\":0.37,\"db\":0.0,\"exception\":[\"RuntimeError\",\"earth is flat error\"],\"exception_object\":\"earth is flat error\",\"@timestamp\":\"2019-07-03T08:18:16.979Z\",\"@version\":\"1\",\"message\":\"[500] GET /version (ApplicationController#version)\"}\n</code></pre>\n"}, {"tags": ["ruby", "http", "net-http"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 2, "last_activity_date": 1562141822, "creation_date": 1562141822, "answer_id": 56865757, "question_id": 56864275, "link": "https://stackoverflow.com/questions/56864275/ruby-nethttp-second-request-when-timeout/56865757#56865757", "title": "Ruby Net::HTTP second request when timeout", "body": "<p>It's a feature of <code>Net::HTTP</code> that it retries idempotent requests. You can limit number of retries by setting <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/net/http/rdoc/Net/HTTP.html#method-i-max_retries-3D\" rel=\"nofollow noreferrer\"><code>max_retries</code></a> (in your case to 0).</p>\n\n<p>More on that issue on <a href=\"https://bugs.ruby-lang.org/issues/10674\" rel=\"nofollow noreferrer\">Ruby redmine</a></p>\n\n<pre><code>require \"net/http\"\n\nhttp = Net::HTTP.new(\"timeout.free.beeceptor.com\", 443)\nhttp.read_timeout = 1\nhttp.max_retries = 0 # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; the change\nhttp.use_ssl = true\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\nhttp.request(Net::HTTP::Get.new(\"/Time\"))\n</code></pre>\n"}], "owner": {"reputation": 12290, "user_id": 228370, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a3f87affc7032e0af7cc4ce2ddb08ce9?s=128&d=identicon&r=PG", "display_name": "23tux", "link": "https://stackoverflow.com/users/228370/23tux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 56865757, "answer_count": 1, "score": 2, "last_activity_date": 1562141822, "creation_date": 1562135922, "question_id": 56864275, "link": "https://stackoverflow.com/questions/56864275/ruby-nethttp-second-request-when-timeout", "title": "Ruby Net::HTTP second request when timeout", "body": "<p>I noticed that when a http request times out, Ruby (2.6.1) makes a second request. This causes problems with one of our endpoints, because a second worker is triggered which takes up resources.</p>\n\n<p>You can see an example here: Go to <a href=\"https://beeceptor.com/console/timeout\" rel=\"nofollow noreferrer\">https://beeceptor.com/console/timeout</a> and run the following code</p>\n\n<pre><code>require \"net/http\"\n\nhttp = Net::HTTP.new(\"timeout.free.beeceptor.com\", 443)\nhttp.read_timeout = 1\nhttp.use_ssl = true\nhttp.verify_mode = OpenSSL::SSL::VERIFY_PEER\nhttp.request(Net::HTTP::Get.new(\"/Time\"))\n</code></pre>\n\n<p>You can see that there are 2 requests to <code>/Time</code>, so I was wondering:</p>\n\n<ol>\n<li>Whats the purpose of this default behaviour? When I do the same query with a curl command, I don't get a second request <code>curl --max-time 1 https://timeout.free.beeceptor.com</code></li>\n<li>How can I influence this behaviour?</li>\n<li>Or am I doing something wrong?</li>\n</ol>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 31, "user_id": 11695865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwajI7o3ktA/AAAAAAAAAAI/AAAAAAAAEXM/SdVRrRnE9Lc/photo.jpg?sz=128", "display_name": "Nishant Yadav", "link": "https://stackoverflow.com/users/11695865/nishant-yadav"}, "edited": false, "score": 0, "creation_date": 1562134891, "post_id": 56864021, "comment_id": 100277003, "body": "require &#39;time&#39; def to_seconds(timestamp)   timestamp.hour * 3600 + timestamp.min * 60 + timestamp.sec end  def sum_time(*time)    # initialize the variables      total_seconds = 0      time.each do |time_item|          timestamp = Time.parse(time_item)          total_seconds += to_seconds(timestamp)      end     sum_time_string = &quot;&quot;     days = (total_seconds / (24 * 3600)).to_i     sum_time_string = &quot;#{days} day &amp; &quot; if days &gt; 0     sum_time_string += Time.at(total_seconds).utc.strftime(&quot;%H:%M:%S&quot;) end  puts sum_time(&quot;11:23:07&quot;,&quot;22:53:45&quot;,&quot;0:23:23&quot;,&quot;23:45:56&quot;)"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 1, "creation_date": 1562135969, "post_id": 56864021, "comment_id": 100277459, "body": "Please format the code properly. The way you wrote is, the posting is not really legible. Also, I find it unclear what you are asking exactly."}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 0, "last_activity_date": 1562141330, "creation_date": 1562141330, "answer_id": 56865642, "question_id": 56864021, "link": "https://stackoverflow.com/questions/56864021/how-to-use-argv-how-do-i-implement-command-line-argument-in-it/56865642#56865642", "title": "How to use ARGV*,How do i implement command line argument in it", "body": "<p>How to use ARGV from your script : </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'time'\ndef to_seconds(timestamp)\n  timestamp.hour * 3600 + timestamp.min * 60 + timestamp.sec\nend\ndef sum_time(*time)\n  # initialize the variables\n  total_seconds = 0\n  time.each do |time_item|\n    timestamp = Time.parse(time_item)\n    total_seconds += to_seconds(timestamp)\n  end\n  sum_time_string = \"\"\n  days = (total_seconds / (24 * 3600)).to_i\n  sum_time_string = \"#{days} day &amp; \" if days &gt; 0\n  sum_time_string += Time.at(total_seconds).utc.strftime(\"%H:%M:%S\")\nend\nputs sum_time(*ARGV)\n</code></pre>\n\n<p>The call :</p>\n\n<pre><code>ruby your_script.rb 11:23:07 22:53:45 0:23:23 23:45:56\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11695865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwajI7o3ktA/AAAAAAAAAAI/AAAAAAAAEXM/SdVRrRnE9Lc/photo.jpg?sz=128", "display_name": "Nishant Yadav", "link": "https://stackoverflow.com/users/11695865/nishant-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562141330, "creation_date": 1562134705, "question_id": 56864021, "link": "https://stackoverflow.com/questions/56864021/how-to-use-argv-how-do-i-implement-command-line-argument-in-it", "title": "How to use ARGV*,How do i implement command line argument in it", "body": "<p>&lt;&lt;-doc\nModify the sum of times method for any number of time values passed to this method.\nEg: (\"11:23:07\",\"22:53:45\",\"0:23:23\",\"23:45:56\") -> \"2 day &amp; 10:26:11\"\n(\"0:45:34\",\"0:15:58\") -> 01:01:32 ; (\"11:23:07\",\"22:53:45\") -> 1 day &amp; 10:16:52\ndoc</p>\n\n<p>But i want it as 2\n[/name]\n[input]\n\"24:01:10\" \"10:30:50\"\n[/input]\n[output]\n\"Invalid 24-hour time value\"\n[/output]</p>\n\n<p>===</p>\n\n<p>[name]\n3\n[/name]\n[input]\n\"0:45:34\" \"0:15:58\"\n[/input]\n[output]\n\"01:01:32\" \n[/output]</p>\n\n<p>puts sum_time(\"11:23:07\",\"22:53:45\",\"0:23:23\",\"23:45:56<code>enter code here</code>\")</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "bundle"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562214008, "post_id": 56870146, "comment_id": 100309271, "body": "my mistake: <code>rbenv global 2.1.2</code> is the right command. Your <code>gem list</code> says that you use jruby in your project. What IDE are you using?. Is there a <code>ruby-version</code> file in project? It may be hidden."}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562223751, "post_id": 56870146, "comment_id": 100312278, "body": "You mean this? $ ruby -v ruby 2.1.2p95 (2014-05-08 revision 45877) [x86_64-darwin13.0]"}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562225385, "post_id": 56870146, "comment_id": 100313090, "body": "no, in your project&#39;s root folder there can be hidden file <code>.ruby-version</code>. The version from this file overrides the system version of ruby."}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562226273, "post_id": 56870146, "comment_id": 100313554, "body": "Don&#39;t know how to know! please help"}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562226431, "post_id": 56870146, "comment_id": 100313633, "body": "open the directory of your project in terminal and print <code>cat .ruby-version</code>"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562226494, "post_id": 56870146, "comment_id": 100313670, "body": "$ cat .ruby-version cat: .ruby-version: No such file or directory"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562226814, "post_id": 56870146, "comment_id": 100313816, "body": "$ rbenv version 2.1.2 (set by /Users/nour/.rbenv/version)"}, {"owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "reply_to_user": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562227063, "post_id": 56870146, "comment_id": 100313949, "body": ":/  Maybe something wrong with your rbenv installation. Please uninstall it <a href=\"https://github.com/rbenv/rbenv/issues/148\" rel=\"nofollow noreferrer\">github.com/rbenv/rbenv/issues/148</a> and then install again <a href=\"https://www.digitalocean.com/community/tutorials/how-to-install-ruby-on-rails-with-rbenv-on-ubuntu-18-04\" rel=\"nofollow noreferrer\">digitalocean.com/community/tutorials/&hellip;</a>. UPD oh, you use Mac, so something like <a href=\"https://github.com/rbenv/rbenv\" rel=\"nofollow noreferrer\">github.com/rbenv/rbenv</a>"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562229941, "post_id": 56870146, "comment_id": 100315393, "body": "$ rails s /Users/nour/limo_rent_vancouver/bin/spring:10:in <code>read&#39;: No such file or directory @ rb_sysopen - &#47;Users&#47;nour&#47;limo_rent_vancouver&#47;Gemfile.lock (Errno::ENOENT) \tfrom &#47;Users&#47;nour&#47;limo_rent_vancouver&#47;bin&#47;spring:10:in </code>read&#39; \tfrom /Users/nour/limo_rent_vancouver/bin/spring:10:in <code>&lt;top (required)&gt;&#39; \tfrom bin&#47;rails:3:in </code>load&#39; \tfrom bin/rails:3:in `&lt;main&gt;&#39;"}, {"owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "edited": false, "score": 0, "creation_date": 1562280626, "post_id": 56870146, "comment_id": 100335913, "body": "I solve it :) Thank you for your time and effort so appreciate it :) I post the answer"}], "tags": [], "owner": {"reputation": 69, "user_id": 3189109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASu4.png?s=128&g=1", "display_name": "theendcomplete", "link": "https://stackoverflow.com/users/3189109/theendcomplete"}, "is_accepted": false, "score": 1, "last_activity_date": 1562157182, "last_edit_date": 1592644375, "creation_date": 1562156775, "answer_id": 56870146, "question_id": 56862701, "link": "https://stackoverflow.com/questions/56862701/to-specs-could-not-find-railties-0-among-8-total-gems-gemloaderro/56870146#56870146", "title": "`to_specs&#39;: Could not find &#39;railties&#39; (&gt;= 0) among 8 total gem(s) (Gem::LoadError)", "body": "<p>The root of the problem seems to be bundler. What operating system and Ruby version are you using? It may be a problem with old OpenSSL library, so you can not install bundler and everything after it.</p>\n<p>If you are using jRuby (your <code>gem list</code> output tells so), your problem seems to be the same as described in <a href=\"https://gist.github.com/kendagriff/adec3713b4dfe6a1abdf\" rel=\"nofollow noreferrer\">link</a>. And there is a solution as well.</p>\n<p>Maybe you forgot to set <code>2.1.2</code> version of ruby as global? (<code>rbenv set global 2.1.2</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "is_accepted": true, "score": 0, "last_activity_date": 1562280593, "creation_date": 1562280593, "answer_id": 56894872, "question_id": 56862701, "link": "https://stackoverflow.com/questions/56862701/to-specs-could-not-find-railties-0-among-8-total-gems-gemloaderro/56894872#56894872", "title": "`to_specs&#39;: Could not find &#39;railties&#39; (&gt;= 0) among 8 total gem(s) (Gem::LoadError)", "body": "<p>The solution that worked for me is updating my OS X certs with brew (<a href=\"https://github.com/rubygems/rubygems/issues/1736\" rel=\"nofollow noreferrer\">https://github.com/rubygems/rubygems/issues/1736</a>) :</p>\n\n<pre><code>brew update\nbrew install openssl\nbrew tap raggi/ale\nbrew install openssl-osx-ca\n</code></pre>\n\n<p>Then updating my ruby version by <code>rbenv install 2.4.0</code></p>\n\n<pre><code>rbenv local 2.4.0\n\ngem install bundler\ngem update --system\n</code></pre>\n\n<p>And it work :)</p>\n"}], "owner": {"reputation": 1682, "user_id": 6392696, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/09WDQ.jpg?s=128&g=1", "display_name": "nourza", "link": "https://stackoverflow.com/users/6392696/nourza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 56894872, "answer_count": 2, "score": 0, "last_activity_date": 1562280593, "creation_date": 1562126115, "last_edit_date": 1562178108, "question_id": 56862701, "link": "https://stackoverflow.com/questions/56862701/to-specs-could-not-find-railties-0-among-8-total-gems-gemloaderro", "title": "`to_specs&#39;: Could not find &#39;railties&#39; (&gt;= 0) among 8 total gem(s) (Gem::LoadError)", "body": "<p>I postes this question because I didn't find any related answer on stackoverflow. I did everything. I will explain what I have tried.\nWhen I start the Rails server using <code>rails s</code>, I get the following output:</p>\n\n<pre><code>/Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:298:in `to_specs': Could not find 'railties' (&gt;= 0) among 8 total gem(s) (Gem::LoadError)\n    from /Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:309:in `to_spec'\n    from /Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_gem.rb:53:in `gem'\n    from /Users/nour/.rbenv/versions/2.1.2/bin/rails:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>Output for <code>gem list</code>:</p>\n\n<pre><code>*** LOCAL GEMS ***\n\njar-dependencies (0.2.6)\njruby-openssl (0.9.19 java)\njson (1.8.0 java)\nrake (10.1.0)\nrdoc (4.1.2)\n</code></pre>\n\n<p>Output for <code>gem install rails</code>:</p>\n\n<pre><code>ERROR:  Loading command: install (OpenSSL::X509::StoreError)\n    setting default path failed: Invalid keystore format\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n\n<p>Output for <code>bundle install</code>:</p>\n\n<pre><code>/Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:298:in `to_specs': Could not find 'bundler' (&gt;= 0) among 8 total gem(s) (Gem::LoadError)\n    from /Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:309:in `to_spec'\n    from /Users/nour/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_gem.rb:53:in `gem'\n    from /Users/nour/.rbenv/versions/2.1.2/bin/bundle:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>Output for <code>gem install bundler</code>:</p>\n\n<pre><code>ERROR:  Loading command: install (OpenSSL::X509::StoreError)\n    setting default path failed: Invalid keystore format\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n\n<p>$ gem list</p>\n\n<pre><code>*** LOCAL GEMS ***\n\naasm (3.4.0)\nactionmailer (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2, 2.3.18)\nactionpack (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2, 2.3.18)\nactionview (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0)\nactive_model_serializers (0.8.3)\nactive_shipping (1.6.0, 1.4.3)\nactive_utils (3.2.0, 3.0.0, 2.2.3)\nactivejob (4.2.6, 4.2.5, 4.2.4)\nactivejob_backport (0.0.3)\nactivemerchant (1.53.0, 1.44.1, 1.43.3)\nactivemodel (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2)\nactiverecord (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2, 2.3.18)\nactiverecord-deprecated_finders (1.0.3)\nactiveresource (3.2.13, 3.2.2, 2.3.18)\nactivesupport (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2, 2.3.18)\nacts-as-taggable-on (3.5.0)\nacts_as_commentable (4.0.2)\nacts_as_indexed (0.8.3)\nacts_as_list (0.7.6, 0.7.4, 0.7.2, 0.3.0)\nacts_as_votable (0.10.0)\naddressable (2.5.2, 2.4.0, 2.3.8, 2.3.6)\nahoy_matey (1.4.2, 1.4.0, 1.2.1)\nancestry (2.1.0)\nangularjs-rails (1.2.22)\nanimate-rails (1.0.10, 1.0.9, 1.0.8, 1.0.7)\nanjlab-bootstrap-rails (3.0.0.3)\nannotate (2.6.5)\narbre (1.0.3, 1.0.2)\narel (6.0.4, 6.0.3, 5.0.1.20140414130214, 4.0.2, 3.0.3)\nasset_sync (1.1.0)\nauto_html (1.6.4)\nautoprefixer-rails (2.2.0.20140804)\nawesome_nested_set (3.0.1)\nawesome_print (1.8.0, 1.6.1, 1.2.0)\naws-sdk (2.1.30, 1.66.0, 1.27.0)\naws-sdk-core (2.1.30)\naws-sdk-resources (2.1.30)\naws-sdk-v1 (1.66.0)\naws_cf_signer (0.1.3)\naxiom-types (0.1.1)\nbabosa (1.0.2)\nbcrypt (3.1.11, 3.1.10, 3.1.9, 3.1.7)\nbcrypt-ruby (3.1.5)\nbest_in_place (3.0.2)\nbetter_errors (2.0.0)\nbigdecimal (1.2.4)\nbinding_of_caller (0.7.3, 0.7.2)\nbootstrap-material-design (0.1.1)\nbootstrap-sass (3.3.1.0, 3.2.0.2, 3.2.0.1, 2.3.1.3)\nbootstrap_form (2.2.0)\nbourbon (3.2.4, 3.2.3)\nbreadcrumbs_on_rails (2.3.1)\nbrowser (2.2.0, 2.1.0, 1.0.1)\nbson (2.3.0)\nbuftok (0.2.0)\nbuilder (3.2.3, 3.2.2, 3.1.4, 3.0.4)\nbundler (1.16.0)\nbyebug (9.0.6, 9.0.5, 8.2.5, 8.2.4, 8.2.2, 8.2.1, 6.0.2, 5.0.0, 3.4.0)\ncallsite (0.0.11)\ncamertron-eprun (1.1.0)\ncancan (1.6.10)\ncancancan (1.9.2, 1.8.4)\ncanonical-rails (0.0.7)\ncapybara (2.4.4, 2.4.1)\ncapybara-screenshot (1.0.3)\ncaracal (1.0.4)\ncarmen (1.0.2, 1.0.1)\ncarrierwave (0.10.0)\ncelluloid (0.16.0)\nCFPropertyList (2.3.1)\nchartkick (2.0.0, 1.4.1)\nchoice (0.2.0, 0.1.6)\nchunky_png (1.3.10, 1.3.8, 1.3.4, 1.3.3)\ncldr-plurals-runtime-rb (1.0.0)\nclimate_control (0.0.3)\ncloudinary (1.0.76)\ncocaine (0.5.8, 0.5.7, 0.5.5, 0.5.4)\ncocoon (1.2.6)\ncodeclimate-test-reporter (0.4.1)\ncoderay (1.1.0)\ncoercible (1.0.0)\ncoffee-rails (4.1.1, 4.1.0, 4.0.1, 3.2.2)\ncoffee-script (2.4.1, 2.3.0)\ncoffee-script-source (1.12.2, 1.10.0, 1.9.1.1, 1.9.1, 1.9.0, 1.8.0, 1.7.1)\ncolorator (0.1)\ncolored (1.2)\ncolorize (0.7.3)\ncolumnize (0.9.0, 0.8.9)\ncommonjs (0.2.7)\ncompass (0.12.7, 0.12.2)\ncompass-rails (2.0.0, 1.1.7)\nconcurrent-ruby (1.0.5, 1.0.2, 1.0.1, 1.0.0)\nconnection_pool (2.0.0)\ncountries (1.1.0, 0.9.3)\ncountry_select (2.1.1)\ncrass (1.0.3, 1.0.2)\ncss_parser (1.3.5)\ncss_splitter (0.4.2)\ncssminify (1.0.2)\ncurrencies (0.4.2)\ndaemons (1.2.3, 1.2.2, 1.1.9, 1.0.10)\ndatabase_cleaner (1.3.0)\ndebug_inspector (0.0.3, 0.0.2)\ndebugger-linecache (1.2.0)\ndebugger-ruby_core_source (1.3.5)\ndecorators (2.0.1)\ndeface (1.0.1)\ndelayed_job (4.1.2, 4.1.1, 4.0.4, 4.0.2)\ndelayed_job_active_record (4.1.1, 4.1.0, 4.0.2)\ndelayed_job_web (1.2.9)\ndescendants_tracker (0.0.4)\ndevise (4.4.1, 4.2.0, 4.1.1, 3.5.6, 3.5.5, 3.5.2, 3.4.1, 3.4.0, 3.3.0)\ndiff-lcs (1.2.5)\ndocile (1.1.5)\ndomain_name (0.5.25, 0.5.24)\ndotenv (1.0.2)\ndotenv-rails (1.0.2)\ndragonfly (1.0.12)\ndraper (1.4.0)\ndynamic_form (1.1.4)\neasy_translate (0.5.0)\nemail_spec (1.6.0)\nenumerable-lazy (0.0.1)\nequalizer (0.0.11, 0.0.9)\nerrbase (0.0.3)\nerubis (2.7.0)\neventmachine (1.2.0.1, 1.0.8, 1.0.7, 1.0.3)\nexception_notification (4.2.1, 4.1.4, 4.1.2)\nexcon (0.45.4, 0.39.5)\nexecjs (2.7.0, 2.6.0, 2.5.2, 2.4.0, 2.3.0, 2.2.2, 2.2.1)\nfactory_girl (4.5.0, 4.4.0)\nfactory_girl_rails (4.5.0, 4.4.1)\nfaker (1.4.3)\nfaraday (0.9.2, 0.9.0)\nfedex (3.9.1)\nffaker (1.25.0)\nffi (1.9.25, 1.9.18, 1.9.10, 1.9.9, 1.9.8, 1.9.6, 1.9.3)\nfilters_spam (0.5)\nfission (0.5.0)\nfog (1.32.0, 1.23.0)\nfog-atmos (0.1.0)\nfog-aws (0.7.4)\nfog-brightbox (0.8.0, 0.5.0)\nfog-core (1.32.0, 1.24.0)\nfog-ecloud (0.1.1)\nfog-google (0.0.7)\nfog-json (1.0.2, 1.0.0)\nfog-local (0.2.1)\nfog-powerdns (0.1.1)\nfog-profitbricks (0.0.5)\nfog-radosgw (0.0.4)\nfog-riakcs (0.1.0)\nfog-sakuracloud (1.0.1)\nfog-serverlove (0.1.2)\nfog-softlayer (0.4.7, 0.3.17)\nfog-storm_on_demand (0.1.1)\nfog-terremark (0.1.0)\nfog-vmfusion (0.1.0)\nfog-voxel (0.1.0)\nfog-xml (0.1.2)\nfont-awesome-less (4.2.0)\nfont-awesome-rails (4.6.3.1, 4.6.3.0, 4.5.0.0, 4.2.0.0)\nfont-awesome-sass (4.4.0, 4.2.2, 4.2.1)\nfontcustom (1.3.8)\nformatador (0.2.5)\nformtastic (3.1.3, 3.0.0, 2.3.1)\nformtastic_i18n (0.4.1, 0.1.1)\nfoundation (1.0.4)\nfoundation-rails (5.4.5.0)\nfrank (1.0.12)\nfriendly_id (5.1.0, 5.0.4)\nfssm (0.2.10)\ngem_plugin (0.2.3)\ngeocoder (1.3.7, 1.3.6, 1.2.12, 1.2.9, 1.2.7, 1.2.6, 1.2.5)\ngibbon (2.2.4, 1.2.1)\nglobalid (0.4.1, 0.4.0, 0.3.7, 0.3.6)\nglobalize (5.0.1)\ngmaps4rails (2.1.2)\ngon (5.2.3)\ngoogle_places (0.24.0)\ngrape (0.16.2)\ngroupdate (3.0.1, 3.0.0, 2.5.0)\nguard (2.8.2)\nguard-rails (0.7.0)\nguard-rspec (4.3.1)\nhaml (4.0.7, 4.0.6, 4.0.5, 3.2.0.rc.4, 3.1.8)\nhaml-rails (0.9.0, 0.5.3)\nhas_scope (0.6.0, 0.6.0.rc)\nhashie (3.4.4, 3.3.1)\nhighline (1.6.21)\nhike (1.2.3)\nhirb (0.7.3, 0.7.2)\nhitimes (1.2.3, 1.2.2)\nhtml2haml (2.0.0)\nhtmlentities (4.3.2)\nhtmltoword (0.5.1)\nhttp (0.6.2)\nhttp-cookie (1.0.2)\nhttp_parser.rb (0.6.0)\nhttparty (0.14.0, 0.13.7, 0.13.1)\ni18n (0.9.5, 0.9.3, 0.9.1, 0.9.0, 0.8.6, 0.8.1, 0.7.0, 0.6.11, 0.6.1)\ni18n-spec (0.6.0)\ni18n-tasks (0.7.8)\ni18n_data (0.7.0)\nice_nine (0.11.2, 0.11.0)\ninflecto (0.0.2)\ninherited_resources (1.6.0, 1.5.1, 1.4.1)\ninteractive_editor (0.0.11, 0.0.10)\nio-console (0.4.2)\nipaddress (0.8.0)\niso (0.2.1)\njbuilder (2.7.0, 2.6.4, 2.6.3, 2.6.0, 2.5.0, 2.4.1, 2.4.0, 2.3.2, 2.3.1, 2.3.0, 2.2.16, 2.2.12, 2.2.10, 2.2.6, 2.2.5, 2.2.4, 2.2.3, 2.2.2, 2.1.3, 1.5.3)\njekyll (3.1.6)\njekyll-sass-converter (1.4.0)\njekyll-watch (1.4.0)\njmespath (1.1.3)\njourney (1.0.4)\njquery-fileupload-rails (0.4.6)\njquery-rails (4.3.1, 4.2.1, 4.1.1, 4.1.0, 3.1.5, 3.1.4, 3.1.3, 3.1.2, 3.1.1)\njquery-ui-rails (6.0.1, 5.0.5, 5.0.3, 5.0.2, 5.0.0, 4.2.1)\njson (2.0.1, 1.8.6, 1.8.3, 1.8.2, 1.8.1)\njwt (1.0.0)\nkaminari (0.17.0, 0.16.3, 0.16.1, 0.15.1)\nkramdown (1.5.0)\nlaunchy (2.4.3, 2.4.2)\nless (2.4.0)\nletter_opener (1.6.0, 1.4.1, 1.2.0)\nlibv8 (3.16.14.15, 3.16.14.13, 3.16.14.3 x86_64-darwin-13)\nliquid (3.0.6)\nlisten (3.0.8, 2.10.1, 2.8.1, 2.7.11)\nloofah (2.1.1, 2.1.0.rc2, 2.0.3)\nlumberjack (1.0.9)\nmail (2.7.0, 2.6.6, 2.6.4, 2.6.3, 2.6.1, 2.5.4, 2.4.4)\nmaildir (2.2.1)\nmemoizable (0.4.2)\nmercenary (0.3.6)\nmeta_request (0.3.4)\nmetaclass (0.0.4)\nmethod_source (0.8.2)\nmime-types (3.1, 3.0, 2.99.1, 2.99, 2.6.2, 2.6.1, 2.5, 2.4.3, 2.3, 1.25.1)\nmime-types-data (3.2016.0521, 3.2016.0221)\nmimemagic (0.3.0)\nmini_magick (4.3.6, 3.8.1)\nmini_mime (1.0.0)\nmini_portile (0.6.2, 0.6.1, 0.6.0)\nmini_portile2 (2.3.0, 2.1.0, 2.0.0)\nminitest (5.11.3, 5.10.3, 5.10.1, 5.9.1, 5.9.0, 5.8.4, 5.8.3, 5.8.1, 5.8.0, 5.7.0, 5.6.1, 5.5.1, 5.4.3, 5.4.2, 5.4.1, 5.4.0, 4.7.5)\nminitest-rails (2.2.1)\nmocha (1.1.0)\nmodernizr-rails (2.7.1)\nmonetize (0.4.1)\nmoney (6.2.1)\nmongrel (1.2.0.pre2)\nmoped (2.0.0)\nmulti_json (1.13.1, 1.12.2, 1.12.1, 1.11.3, 1.11.2, 1.11.1, 1.11.0, 1.10.1)\nmulti_xml (0.5.5)\nmultipart-post (2.0.0)\nmustermann19 (0.4.4)\nmysql2 (0.4.4)\nnaught (1.0.0)\nneat (1.5.1)\nnegative_captcha (0.4)\nnested_form (0.3.2)\nnet-http-persistent (2.9.4)\nnet-scp (1.2.1)\nnet-ssh (2.9.4, 2.9.2, 2.9.1)\nnetrc (0.10.3, 0.10.2, 0.9.0, 0.8.0, 0.7.7)\nnokogiri (1.8.2, 1.8.1, 1.7.1, 1.6.8.1, 1.6.8, 1.6.7.2, 1.6.7.1, 1.6.7, 1.6.6.2, 1.6.4.1, 1.6.3.1)\noauth (0.4.7)\noauth2 (1.0.0)\noffsite_payments (2.0.1)\nomniauth (1.2.2)\nomniauth-facebook (2.0.0)\nomniauth-github (1.1.2)\nomniauth-linkedin (0.2.0)\nomniauth-oauth (1.0.1)\nomniauth-oauth2 (1.2.0)\nomniauth-twitter (1.0.1)\noptionable (0.2.0)\norigin (2.1.1)\norm_adapter (0.5.0)\npandoc-ruby (2.0.0)\npaperclip (4.3.7, 4.3.6, 4.3.3, 4.3.2, 4.3.1, 4.2.1, 4.2.0, 3.5.4)\nparanoia (2.0.2)\npaypal-recurring (1.1.0)\npdf-core (0.6.1, 0.2.5)\npg (1.0.0, 0.21.0, 0.20.0, 0.19.0, 0.18.4, 0.18.3, 0.18.2, 0.18.1, 0.17.1, 0.15.1, 0.15.0)\npkg-config (1.1.7)\npolyamorous (1.2.0, 1.1.0, 1.0.0)\npolyglot (0.3.5)\npony (1.11)\nprawn (2.1.0, 1.2.1)\nprawn-table (0.1.2)\npremailer (1.8.2)\npremailer-rails (1.8.0)\npry (0.10.3, 0.10.1)\npry-rails (0.3.4, 0.3.2)\npsych (2.0.5)\npublic_suffix (3.0.2)\nquantified (1.0.1)\nquiet_assets (1.0.3)\nrabl (0.9.4.pre1)\nrack (1.6.8, 1.6.5, 1.6.4, 1.5.5, 1.5.4, 1.5.3, 1.5.2, 1.4.5, 1.1.6)\nrack-accept (0.4.5)\nrack-attack (4.4.1)\nrack-cache (1.2)\nrack-contrib (1.2.0)\nrack-cors (0.2.9)\nrack-pjax (1.0.0, 0.8.0)\nrack-protection (1.5.3)\nrack-ssl (1.3.4)\nrack-test (0.6.3, 0.6.2)\nradriar (0.1.0.alpha.3)\nrails (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 3.2.13, 3.2.2)\nrails-deprecated_sanitizer (1.0.3)\nrails-dom-testing (1.0.9, 1.0.8, 1.0.7)\nrails-erd (1.4.4, 1.1.0)\nrails-html-sanitizer (1.0.3, 1.0.2)\nrails-i18n (4.0.3)\nrails-simple-search (0.9.8)\nrails_12factor (0.0.3, 0.0.2)\nrails_serve_static_assets (0.0.5, 0.0.4, 0.0.2)\nrails_stdout_logging (0.0.5, 0.0.4, 0.0.3)\nrailties (4.2.6, 4.2.5, 4.2.4, 4.1.10, 4.1.8, 4.1.7, 4.1.6, 4.1.4, 4.1.0, 4.0.2, 3.2.13, 3.2.2)\nrake (12.3.1, 12.3.0, 12.1.0, 12.0.0, 11.3.0, 11.2.2, 11.1.2, 11.1.1, 10.5.0, 10.4.2, 10.4.0, 10.3.2, 10.1.0)\nransack (1.6.6, 1.5.1, 1.4.1, 1.3.0, 1.2.3)\nrapidfire (2.1.0)\nrb-fsevent (0.10.2, 0.9.7, 0.9.4)\nrb-inotify (0.9.10, 0.9.7, 0.9.5)\nrb-readline (0.5.1)\nrbx-require-relative (0.0.9)\nrdoc (4.3.0, 4.2.2, 4.2.1, 4.2.0, 4.1.2, 4.1.1, 4.1.0, 3.12.2)\nrecaptcha (4.8.0, 3.3.0, 3.0.0, 1.0.2, 0.4.0)\nredcarpet (3.3.4, 3.3.3, 3.1.2)\nref (2.0.0, 1.0.5)\nreferer-parser (0.3.0)\nrefinerycms (3.0.0, 0.9.7.15)\nrefinerycms-core (3.0.0)\nrefinerycms-i18n (3.0.1)\nrefinerycms-images (3.0.0)\nrefinerycms-pages (3.0.0)\nrefinerycms-resources (3.0.0)\nremotipart (1.2.1)\nrepresentable (2.3.0)\nrequest_store (1.3.1, 1.2.1, 1.1.0)\nrerun (0.10.0)\nresponders (2.4.0, 2.3.0, 2.1.1, 1.1.2, 1.1.1, 1.0.0)\nrest-client (1.8.0, 1.7.2, 1.6.9)\nrinku (1.5.1)\nroar (1.0.4)\nrouge (1.11.0)\nrouting-filter (0.5.1)\nrspec (3.1.0)\nrspec-core (3.1.7, 3.1.0, 3.0.4)\nrspec-expectations (3.1.2, 3.1.0, 3.0.4)\nrspec-mocks (3.1.3, 3.1.0, 3.0.4)\nrspec-rails (3.1.0, 3.0.2)\nrspec-support (3.1.2, 3.1.0, 3.0.4)\nruby-graphviz (1.2.2, 1.0.9)\nruby_parser (3.7.2)\nrubyzip (1.2.0)\nrvm (1.11.3.9)\nsafe_yaml (1.0.4)\nsafely_block (0.1.1)\nsass (3.5.5, 3.5.3, 3.5.2, 3.4.23, 3.4.22, 3.4.21, 3.4.20, 3.4.9, 3.2.19, 3.2.0)\nsass-listen (4.0.0)\nsass-rails (5.0.7, 5.0.6, 5.0.4, 4.0.5, 4.0.4, 4.0.3, 3.2.6)\nsdoc (0.4.2, 0.4.1)\nselect2-rails (3.5.9.1)\nseo_meta (2.0.0.rc.1)\nsequel (3.20.0)\nsexp_processor (4.6.0)\nsimple_form (3.0.2)\nsimple_oauth (0.2.0)\nsimplecov (0.9.1, 0.9.0)\nsimplecov-html (0.8.0)\nsinatra (1.4.5, 1.0)\nsitemap_generator (5.1.0)\nslim (2.1.0, 2.0.3)\nslim-rails (2.1.5)\nslop (3.6.0)\nsnooby (0.1.5)\nsort_alphabetical (1.0.1)\nspeakingurl-rails (1.1.5)\nspina (0.7.0)\nspina-template (0.3.0)\nspoon (0.0.6, 0.0.4)\nspree (2.4.1)\nspree_api (2.4.1)\nspree_backend (2.4.1)\nspree_cmd (2.4.1)\nspree_core (2.4.1, 2.3.2)\nspree_frontend (2.4.1)\nspree_sample (2.4.1)\nspring (2.0.2, 2.0.1, 2.0.0, 1.7.2, 1.7.1, 1.6.4, 1.6.3, 1.6.2, 1.6.1, 1.6.0, 1.4.0, 1.3.6, 1.3.3, 1.3.1, 1.2.0, 1.1.3)\nsprockets (3.7.1, 3.7.0, 3.6.0, 3.5.2, 2.12.4, 2.12.3, 2.12.1, 2.11.3, 2.11.0, 2.2.3, 2.1.4)\nsprockets-rails (3.2.1, 3.2.0, 3.0.4, 3.0.3, 3.0.2, 3.0.1, 3.0.0, 2.3.3, 2.3.2, 2.3.1, 2.2.4, 2.2.2, 2.2.1, 2.2.0, 2.1.4, 2.1.3)\nsprockets_better_errors (0.0.4)\nsqlite3 (1.3.13, 1.3.12, 1.3.11, 1.3.10, 1.3.9, 1.3.7, 1.3.6, 1.3.5)\nstate_machine (1.2.0)\nstringex (1.5.1)\nstripe (1.30.2, 1.15.0)\nsubexec (0.2.3)\nsweet-alert (0.0.5)\nsweet-alert-confirm (0.0.3)\ntaps (0.3.24)\ntemple (0.6.10, 0.6.9, 0.6.8)\nterm-ansicolor (1.3.0)\nterminal-table (1.4.5)\ntest-unit (2.1.2.0)\ntherubyracer (0.12.2, 0.12.1)\nthin (1.7.0, 1.6.4, 1.6.3, 1.6.2)\nthor (0.20.0, 0.19.4, 0.19.1, 0.14.6)\nthread (0.1.4)\nthread_safe (0.3.6, 0.3.5, 0.3.4)\ntilt (2.0.8, 2.0.7, 2.0.5, 2.0.2, 1.4.1)\ntimers (4.0.4, 4.0.1)\ntins (1.3.3)\ntreetop (1.4.15)\ntruncate_html (0.9.2)\nttfunk (1.4.0, 1.2.2)\nturbo-sprockets-rails3 (0.2.9)\nturbolinks (5.1.1, 5.1.0, 5.0.1, 2.5.3, 2.5.2, 2.5.1, 2.4.0, 2.3.0, 2.2.2)\nturbolinks-source (5.1.0, 5.0.3, 5.0.0)\ntwitter (5.11.0)\ntwitter-bootstrap-rails (2.2.8)\ntwitter_cldr (3.1.0)\ntwocheckout (0.3.1)\ntzinfo (1.2.5, 1.2.4, 1.2.3, 1.2.2, 0.3.42, 0.3.41)\nuber (0.0.15)\nuglifier (4.1.11, 4.1.5, 3.2.0, 3.0.3, 3.0.2, 3.0.0, 2.7.2, 2.7.1, 2.7.0, 2.5.3)\nunderscore-rails (1.7.0)\nunf (0.1.4)\nunf_ext (0.0.7.1)\nunicode_utils (1.4.0)\nuser_agent_parser (2.3.0)\nuuidtools (2.1.5)\nvalid_email (0.0.10)\nvalidates_zipcode (0.0.8)\nversioncake (2.3.1)\nvirtus (1.0.5, 1.0.3)\nw3c_validators (1.2)\nwarden (1.2.7, 1.2.6, 1.2.5, 1.2.4, 1.2.3)\nweb-console (2.3.0, 2.2.1)\nwill_paginate (3.0.7)\nwill_paginate-bootstrap (1.0.1)\nxpath (2.0.0)\nzilch-authorisation (0.0.1)\nzurb-foundation (4.3.2)\n</code></pre>\n\n<p>ruby -v</p>\n\n<pre><code>ruby 2.1.2p95 (2014-05-08 revision 45877) [x86_64-darwin13.0]\n</code></pre>\n\n<p>$ rbenv set global 2.1.2</p>\n\n<pre><code>rbenv: no such command `set'\n</code></pre>\n\n<p>What do you think could be the problem? Please help! Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5237, "user_id": 2325924, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XSXrT.jpg?s=128&g=1", "display_name": "7urkm3n", "link": "https://stackoverflow.com/users/2325924/7urkm3n"}, "edited": false, "score": 0, "creation_date": 1562119405, "post_id": 56861867, "comment_id": 100273394, "body": "Wt&#39;heck is going on here :P"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 3, "creation_date": 1562120412, "post_id": 56861867, "comment_id": 100273538, "body": "You might get better traffic on this question on the codereview.stackexchange.com, (I threw an answer up anyways)"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1562154171, "post_id": 56861867, "comment_id": 100287235, "body": "I&#39;m voting to close this question as off-topic because it belongs on codereview.stackexchange.com"}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 4437623, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001491984197/picture?type=large", "display_name": "Nameless", "link": "https://stackoverflow.com/users/4437623/nameless"}, "is_accepted": false, "score": 0, "last_activity_date": 1562119441, "creation_date": 1562119441, "answer_id": 56861977, "question_id": 56861867, "link": "https://stackoverflow.com/questions/56861867/is-this-rubyrails-code-readable-simply/56861977#56861977", "title": "Is this ruby(rails) code readable simply?", "body": "<p>The second code is absolutely more readable than the first one. Its also seems easier to get that first one.</p>\n"}, {"tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": true, "score": 2, "last_activity_date": 1562120117, "creation_date": 1562120117, "answer_id": 56862046, "question_id": 56861867, "link": "https://stackoverflow.com/questions/56861867/is-this-rubyrails-code-readable-simply/56862046#56862046", "title": "Is this ruby(rails) code readable simply?", "body": "<p>The 2nd version is easier to read. Here's a few other things that might help</p>\n\n<ul>\n<li>Putting the current time in a variable so you're calling <code>1.month.from_now</code>, and your <code>min</code> and <code>sec</code> arguments using the same time</li>\n<li>Putting the time adjustments in logical reading order (hours, minutes, seconds)</li>\n<li>Chaining with <code>advance</code> makes this slightly more readable, I think</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>today = Time.current\nnext_month = today.\n  advance(months: 1).\n  change(hour: 10, min: today.min, sec: today.sec)\n</code></pre>\n"}], "owner": {"reputation": 4622, "user_id": 1924796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ba5a78c8c1b746e889a60b6e678b128e?s=128&d=identicon&r=PG", "display_name": "chobo", "link": "https://stackoverflow.com/users/1924796/chobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1605721443, "accepted_answer_id": 56862046, "answer_count": 2, "score": -2, "last_activity_date": 1562120117, "creation_date": 1562118491, "question_id": 56861867, "link": "https://stackoverflow.com/questions/56861867/is-this-rubyrails-code-readable-simply", "closed_reason": "Opinion-based", "title": "Is this ruby(rails) code readable simply?", "body": "<p>First</p>\n\n<pre><code>[1] pry(main)&gt; 1.month.from_now.change(%i(min sec).inject({}){|h, i| h.merge(i =&gt; Time.current.send(i))}.merge(hour: 10))\n=&gt; Sat, 03 Aug 2019 10:25:00 KST +09:00\n</code></pre>\n\n<p>Second</p>\n\n<pre><code>[2] pry(main)&gt; 1.month.from_now.change(min: Time.current.min, sec: Time.current.sec, hour: 10)\n=&gt; Sat, 03 Aug 2019 10:26:31 KST +09:00\n</code></pre>\n\n<p>Which code is more readable?</p>\n\n<p>I think first code is less simple to read.</p>\n\n<p>First code be can separated two part.</p>\n\n<p><code>1.month.from_now.change</code> - <a href=\"https://api.rubyonrails.org/classes/Time.html#method-i-change\" rel=\"nofollow noreferrer\">https://api.rubyonrails.org/classes/Time.html#method-i-change</a></p>\n\n<pre><code>[3] pry(main)&gt; %i(min sec).inject({}){ |h, i| # https://apidock.com/ruby/Enumerable/inject\n[3] pry(main)*   h.merge(i =&gt; Time.current.send(i)) # https://apidock.com/ruby/Object/send\n[3] pry(main)* }.merge(hour: 10)\n=&gt; {:min=&gt;34, :sec=&gt;48, :hour=&gt;10}\n</code></pre>\n\n<p>So when someone who is unfamiliar with ruby read first code, little bit difficult.</p>\n\n<p>By the way, if someone know <code>Time.change</code> method, second code is more simple.</p>\n\n<p>The difference is first code is less repetitive than second.</p>\n\n<ol>\n<li>Time.current</li>\n<li>min</li>\n<li>sec</li>\n</ol>\n\n<p>First code is use only once above keyword. So first code use additional <code>inject</code> method and <code>merge</code> method, and additional complexity.</p>\n\n<p>What I use the code?</p>\n"}, {"tags": ["ruby", "abstract-syntax-tree", "internals"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 4, "creation_date": 1562113207, "post_id": 56861139, "comment_id": 100272520, "body": "Here&#39;s an answer I gave to a <a href=\"https://stackoverflow.com/a/56519294/2892779\">similar question</a> that points to <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Local+Variables+and+Methods\" rel=\"nofollow noreferrer\">these docs</a>. You might try the docs I linked from that answer. I&#39;ve heard &quot;Ruby Under a Microscope&quot; is a good book as well (haven&#39;t read it myself)"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562136449, "post_id": 56861139, "comment_id": 100277681, "body": "My understanding is this is kind of an edge case ... I think this question is unfortunately too broad but maybe someone will write a comprehensive answer?"}, {"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1562231689, "post_id": 56861139, "comment_id": 100316422, "body": "&quot;Ruby Under The Microscope&quot; is an excellent book which will answer this question and more. Very interesting read."}], "answers": [{"comments": [{"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1564523291, "post_id": 56895389, "comment_id": 101057200, "body": "Great self answer."}], "tags": [], "owner": {"reputation": 523, "user_id": 145725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4d069f8600380502924bf168a7e51c3?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/145725/matthew"}, "is_accepted": true, "score": 1, "last_activity_date": 1562287882, "creation_date": 1562287882, "answer_id": 56895389, "question_id": 56861139, "link": "https://stackoverflow.com/questions/56861139/when-is-a-line-of-ruby-parsed-evaluated-executed/56895389#56895389", "title": "When is a line of Ruby parsed? evaluated? executed?", "body": "<p>Answering my own question, <a href=\"https://stackoverflow.com/users/2892779/jay-dorsey\">Jay</a>'s <a href=\"https://stackoverflow.com/a/56519294\">answer to a similar question</a> linked to a <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Local+Variables+and+Methods\" rel=\"nofollow noreferrer\">section of the docs</a> where it is explained:</p>\n\n<blockquote>\n  <p>The local variable is created when the parser encounters the assignment, not when the assignment occurs</p>\n</blockquote>\n\n<p>There is a deeper analysis of this in the <a href=\"https://ruby-hacking-guide.github.io/syntree.html\" rel=\"nofollow noreferrer\">Ruby Hacking Guide</a> (no section links available, search or scroll to the \"Local Variable Definitions\" section):</p>\n\n<blockquote>\n  <p>By the way, it is defined when \u201cit appears\u201d, this means it is defined even though it was not assigned. The initial value of a defined [but not yet assigned] variable is nil.</p>\n</blockquote>\n\n<p>That answers the initial question but not how to learn more.</p>\n\n<hr>\n\n<p>Jay and <a href=\"https://stackoverflow.com/users/3729369/simonwo\">simonwo</a> both suggested <a href=\"http://patshaughnessy.net/ruby-under-a-microscope\" rel=\"nofollow noreferrer\">Ruby Under a Microscope</a> by Pat Shaughnessy which I am keen to read.</p>\n\n<p>Additionally, the rest of the Ruby Hacking Guide covers a lot of detail and actually examines the underlying C code. The <a href=\"https://ruby-hacking-guide.github.io/object.html\" rel=\"nofollow noreferrer\">Objects</a> and <a href=\"https://ruby-hacking-guide.github.io/parser.html\" rel=\"nofollow noreferrer\">Parser</a> chapters were particularly relevant to the original question about variable assignment (not so much the <a href=\"https://ruby-hacking-guide.github.io/variable.html\" rel=\"nofollow noreferrer\">Variables and constants</a> chapter, it simply refers you back to the Objects chapter).</p>\n\n<p>I also found that a useful tool to see how the parser works is the <a href=\"https://github.com/whitequark/parser\" rel=\"nofollow noreferrer\">Parser gem</a>. Once it is installed (<code>gem install parser</code>) you can start to examine different bits of code to see what the parser is doing with them.</p>\n\n<p>That gem also bundles the <code>ruby-parse</code> utility which lets you examine the way Ruby parses different snippets of code. The <code>-E</code> and <code>-L</code> options are most interesting to us and the <code>-e</code> option is necessary if we just want to process a fragment of Ruby such as <code>foo = 'bar'</code>. For example:</p>\n\n<pre><code>&gt; ruby-parse -E -e \"foo = 'bar'\"\nfoo = 'bar'   \n^~~ tIDENTIFIER \"foo\"                           expr_cmdarg  [0 &lt;= cond] [0 &lt;= cmdarg] \nfoo = 'bar'   \n    ^ tEQL \"=\"                                  expr_beg     [0 &lt;= cond] [0 &lt;= cmdarg] \nfoo = 'bar'   \n      ^~~~~ tSTRING \"bar\"                       expr_end     [0 &lt;= cond] [0 &lt;= cmdarg] \nfoo = 'bar'   \n           ^ false \"$eof\"                       expr_end     [0 &lt;= cond] [0 &lt;= cmdarg] \n(lvasgn :foo\n  (str \"bar\"))\n</code></pre>\n\n<pre><code>ruby-parse -L -e \"foo = 'bar'\"\ns(:lvasgn, :foo,\n  s(:str, \"bar\"))\nfoo = 'bar'\n~~~ name      \n    ~ operator        \n~~~~~~~~~~~ expression\ns(:str, \"bar\")\nfoo = 'bar'\n          ~ end\n      ~ begin         \n      ~~~~~ expression\n</code></pre>\n\n<hr>\n\n<p>Both of the references linked to at the top highlight an edge case. The <a href=\"https://docs.ruby-lang.org/en/2.6.0/syntax/assignment_rdoc.html#label-Local+Variables+and+Methods\" rel=\"nofollow noreferrer\">Ruby docs</a> used the example <code>p a if a = 0.zero?</code> whlie the <a href=\"https://ruby-hacking-guide.github.io/syntree.html\" rel=\"nofollow noreferrer\">Ruby Hacking Guide</a> used an equivalent example <code>p(lvar) if lvar = true</code>, both of which raise a <code>NameError</code>.</p>\n\n<p><strong>Sidenote:</strong> Remember <code>=</code> means assign, <code>==</code> means compare. The <code>if foo = true</code> construct in the edge case tells Ruby to check if the expression <code>foo = true</code> evaluates to true. In other words, it assigns the value <code>true</code> to <code>foo</code> and then checks if the result of that assignment is <code>true</code> (it will be). That's easily confused with the far more common <code>if foo == true</code> which simply checks whether <code>foo</code> compares equally to <code>true</code>. Because the two are so easily confused, Ruby will issue a warning if we use the assignment operator in a conditional: <code>warning: found `= literal' in conditional, should be ==</code>. </p>\n\n<p>Using the <code>ruby-parse</code> utility let's compare the original example, <code>foo = 'bar' if false</code>, with that edge case, <code>foo if foo = true</code>:</p>\n\n<pre><code>&gt; ruby-parse -L -e \"foo = 'bar' if false\"\ns(:if,\n  s(:false),\n  s(:lvasgn, :foo,\n    s(:str, \"bar\")), nil)\nfoo = 'bar' if false\n            ~~ keyword         \n~~~~~~~~~~~~~~~~~~~~ expression\ns(:false)\nfoo = 'bar' if false\n               ~~~~~ expression\ns(:lvasgn, :foo,\n  s(:str, \"bar\"))\nfoo = 'bar' if false     # Line 13\n~~~ name                 # &lt;-- `foo` is a name\n    ~ operator        \n~~~~~~~~~~~ expression\ns(:str, \"bar\")\nfoo = 'bar' if false\n          ~ end\n      ~ begin         \n      ~~~~~ expression\n</code></pre>\n\n<p>As you can see above on lines 13 and 14 of the output, in the original example foo is a name (that is, a variable).</p>\n\n<pre><code>&gt; ruby-parse -L -e \"foo if foo = true\"\ns(:if,\n  s(:lvasgn, :foo,\n    s(:true)),\n  s(:send, nil, :foo), nil)\nfoo if foo = true\n    ~~ keyword              \n~~~~~~~~~~~~~~~~~ expression\ns(:lvasgn, :foo,\n  s(:true))\nfoo if foo = true         # Line 10\n       ~~~ name           # &lt;-- `foo` is a name\n           ~ operator       \n       ~~~~~~~~~~ expression\ns(:true)\nfoo if foo = true\n             ~~~~ expression\ns(:send, nil, :foo)\nfoo if foo = true         # Line 18\n~~~ selector              # &lt;-- `foo` is a selector\n~~~ expression\n</code></pre>\n\n<p>In the edge case example, the second foo is also a variable (lines 10 and 11), but when we look at lines 18 and 19 we see the first foo has been identified as a selector (that is, a method).</p>\n\n<hr>\n\n<p>This shows that it is the parser that decides whether a thing is a method or a variable and that it parses the line in a different order to how it will later be evaluated.</p>\n\n<p>Considering the edge case...</p>\n\n<p>When the parser runs:</p>\n\n<ul>\n<li>it first sees the whole line as a single expression</li>\n<li>it then breaks it up into two expressions separated by the <code>if</code> keyword</li>\n<li>the first expression <code>foo</code> starts with a lower case letter so it must be a method or a variable. It isn't an existing variable and it IS NOT followed by an assignment operator so the parser concludes it must be a method</li>\n<li>the second expression <code>foo = true</code> is broken up as expression, operator, expression. Again, the expression <code>foo</code> also starts with a lower case letter so it must be a method or a variable. It isn't an existing variable but it IS followed by an assignment operator so the parser knows to add it to the list of local variables.</li>\n</ul>\n\n<p>Later when the evaluator runs:</p>\n\n<ul>\n<li>it will first assign <code>true</code> to <code>foo</code></li>\n<li>it will then execute the conditional and check whether the result of that assignment is true (in this case it is)</li>\n<li>it will then call the <code>foo</code> method (which will raise a <code>NameError</code>, unless we handle it with <code>method_missing</code>).</li>\n</ul>\n"}], "owner": {"reputation": 523, "user_id": 145725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4d069f8600380502924bf168a7e51c3?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/145725/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 2, "accepted_answer_id": 56895389, "answer_count": 1, "score": 1, "last_activity_date": 1562287882, "creation_date": 1562109891, "question_id": 56861139, "link": "https://stackoverflow.com/questions/56861139/when-is-a-line-of-ruby-parsed-evaluated-executed", "title": "When is a line of Ruby parsed? evaluated? executed?", "body": "<p>I was a little surprised to discover that <code>person</code> is defined by the following line of code, even when <code>params[:person_id]</code> doesn't exist:</p>\n\n<pre><code>person = Person.find(params[:person_id]) if params[:person_id]\n</code></pre>\n\n<p>I kind of expected that Ruby would first check the <code>if</code> statement and only define <code>person</code> then. In practice it seems <code>person</code> is defined earlier than that but remains <code>nil</code>.</p>\n\n<p>While investigating that I tried the following:</p>\n\n<pre><code>irb&gt; foo\n# NameError (undefined local variable or method `foo' for main:Object)\nirb&gt; if false\nirb&gt;   foo = 'bar'\nirb&gt; end\nirb&gt; foo\n# =&gt; nil\n</code></pre>\n\n<p>Initially <code>foo</code> is undefined. But then it gets defined, even though it's only referenced inside an <code>if</code> block that isn't evaluated.</p>\n\n<p>I'm now guessing that the whole program gets parsed(?) and that a <code>foo</code> node is added to the Abstract Syntax Tree (i.e. defined). The program is then executed(?), but that particular line is skipped (not evaluated(?)) and so foo is <code>nil</code> (defined but not set to a value).</p>\n\n<p>I'm not sure how to confirm or refute that hunch though. How does one go about learning and digging into the Ruby internals and finding out what happens in this particular scenario?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "delayed-job", "dokku"], "answers": [{"tags": [], "owner": {"reputation": 1853, "user_id": 1515875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V8w5K.jpg?s=128&g=1", "display_name": "Jose Diaz-Gonzalez", "link": "https://stackoverflow.com/users/1515875/jose-diaz-gonzalez"}, "is_accepted": true, "score": 2, "last_activity_date": 1562114503, "creation_date": 1562114503, "answer_id": 56861550, "question_id": 56861090, "link": "https://stackoverflow.com/questions/56861090/rails-delayed-job-running-old-version-of-code-in-production-server-with-dokku/56861550#56861550", "title": "Rails Delayed Job running old version of code in production server with Dokku", "body": "<p>Dokku implements <a href=\"http://dokku.viewdocs.io/dokku/deployment/zero-downtime-deploys/\" rel=\"nofollow noreferrer\">zero-downtime deploys</a>. This means that it does not shut down old containers until checks pass - for web process types - or a period of time has passed - for all others.</p>\n\n<p>This behavior may be disabled for a given process type by running the following:</p>\n\n<pre><code># for all process types, this will result in downtime during deploys\n# replace APP with your app name\ndokku checks:disable APP\n\n# for a given process type\n# replace APP with your app name\n# replace PROCESS_TYPE with the process type for which you'd like to disable it for\ndokku checks:disable APP PROCESS_TYPE\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 6718776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Iz68.jpg?s=128&g=1", "display_name": "Jhonatan Martins", "link": "https://stackoverflow.com/users/6718776/jhonatan-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 56861550, "answer_count": 1, "score": 2, "last_activity_date": 1562114503, "creation_date": 1562109420, "question_id": 56861090, "link": "https://stackoverflow.com/questions/56861090/rails-delayed-job-running-old-version-of-code-in-production-server-with-dokku", "title": "Rails Delayed Job running old version of code in production server with Dokku", "body": "<p>I have a server configured with Dokku in production that contains 1 worker running delayed_job to execute some codes in background, but when I make deploys, the code running with delayed job has a strange behavior and sometimes run my new code deployed and sometimes run my old code before deploy. It is as if there were two instances of the delayed job and at each moment one was executed.</p>\n\n<p>Reading some posts here, i see that delayed job implements something like cache and it should be cleaned after and before deploy, but I did not find it as it does in dokku.</p>\n\n<p>Does anyone know how to keep just the new version of the code running on the worker?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 1, "creation_date": 1562231904, "post_id": 56860421, "comment_id": 100316550, "body": "Welcome to StackOverflow! I&#39;d really like to run your code, but alas I get <code>undefined method &#39;wincheck&#39; for #&lt;Scene_TicTacToe:0x008a9ab0&gt;</code>. Would you be able to provide the <code>wincheck</code> method and any other missing code so we can have a go at debugging it?"}, {"owner": {"reputation": 1, "user_id": 11731336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f55de16d55967a6af2977bcc73294d?s=128&d=identicon&r=PG&f=1", "display_name": "ArtificialStupidity", "link": "https://stackoverflow.com/users/11731336/artificialstupidity"}, "reply_to_user": {"reputation": 2504, "user_id": 3729369, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/FYV4M.png?s=128&g=1", "display_name": "simonwo", "link": "https://stackoverflow.com/users/3729369/simonwo"}, "edited": false, "score": 0, "creation_date": 1562253745, "post_id": 56860421, "comment_id": 100328488, "body": "Thanks ! I edited the method in. As for the rest, it deals with displaying everything on screen and it is specific code/methods provided by RPG Maker XP (the software I&#39;m using for this) so I&#39;m afraid it won&#39;t be of any help... Incidentally, I #&#39;ed some lines that would not work either (such as .fill_rect)"}], "owner": {"reputation": 1, "user_id": 11731336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f55de16d55967a6af2977bcc73294d?s=128&d=identicon&r=PG&f=1", "display_name": "ArtificialStupidity", "link": "https://stackoverflow.com/users/11731336/artificialstupidity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562253952, "creation_date": 1562104059, "last_edit_date": 1562253952, "question_id": 56860421, "link": "https://stackoverflow.com/questions/56860421/how-to-create-a-minimax-algorithm-comparing-arrays", "title": "How to create a Minimax algorithm comparing arrays", "body": "<p>I'm trying to code a \"minimax\" algorithm for Tic Tac Toe.</p>\n\n<p>Each node of the tree is of the form <code>[nil/Int, String]</code> where the last element is a nine character string describing the board, and the first is an Integer ranking the node, or nil by default.</p>\n\n<p>If the value is nil, it tries to inherit the appropriate value from child nodes.</p>\n\n<p>This is where I get an error, when comparing an array with an array failed.</p>\n\n<pre><code>class Scene_TicTacToe #Script 2/2\n\n  def initialize\n    #Boardstate as a str from top left corner to bottom right corner.\n    @boardstate = \"---------\"\n    #1 = player, -1 = comp\n    @active_player = 1\n  end\n\n  def wincheck(boardstate=@boardstate)\n    #should return -1 for loss, 0 for draw, 1 for win\n    [\"OOO\",\"XXX\"].each do |f|\n      for i in 0..2\n        if (boardstate[i]+boardstate[i+3]+boardstate[i+6]).chr == f || boardstate[(3*i)..(3*i)+2] == f\n          return f == \"OOO\" ? 1 : -1\n        end\n      end\n      if (boardstate[0]+boardstate[4]+boardstate[8]).chr == f || (boardstate[2]+boardstate[4]+boardstate[6]).chr == f\n        return f == \"OOO\" ? 1 : -1\n      end\n    end\n    return 0\n  end\n\n  def computer_play\n    #Sets depth,and alpha/beta for pruning, so far so good\n    depth = 3\n    alpha = -100\n    beta = 100\n    #@boardstate starts as \"---------\"\n    #@active_player: 1=player, -1=computer\n    play(minimax(@boardstate, depth, alpha, beta, @active_player))\n  end\n\n  def play(array)\n    #Check actual boardside with parameter boardside to see what move has been\n    #selected and plays that move\n    for i in 0...array[1].length\n      if @boardstate[i] != array[1][i]\n        #color = array[1][i].chr == \"X\" ? @ai : @player\n        #@cursor.y = (i / 3) * @side\n        #@cursor.x = (i % 3) * @side\n        #@board.bitmap.fill_rect(@cursor.x,@cursor.y,@side,@side,color)\n        @boardstate = array[1].dup\n      end\n    end\n  end\n\n  def minimax(boardstate, depth, alpha, beta, active_player)\n    #If bottom node reached, returns [boardstate_score, boardstate]\n    #wincheck returns 1 if player wins, -1 if computer wins, and 0 otherwise\n    if depth == 0 or wincheck(boardstate) != 0 or (/-/ =~ boardstate) == nil\n      return [wincheck(boardstate),boardstate]\n    end\n\n    if active_player == 1 #if player's turn\n      #Gets an array of all the next possible boardstates and return the one with\n      #the best eval.\n      child = generate_child(boardstate, active_player)\n      child.each do |f| #f = [Int/nil, String]\n        if f[0] == nil\n          #This should turn all the nil wincheck values to the best value of children nodes\n          f[0] = minimax(f[1], depth-1, alpha, beta, -active_player).last[0]\n        end\n        alpha = [f[0], alpha].max\n        if beta &lt;= alpha\n          break\n        end\n      end\n      return child.sort_by{|c| c[0]}\n    end\n\n    if active_player == -1 #if computer's turn\n      #Same as above but with worst eval.\n      child = generate_child(boardstate, active_player)\n      child.each do |f|\n        if f[0] == nil\n          f[0] = minimax(f[1], depth-1, alpha, beta, -active_player).first[0]\n        end\n        beta = [f[0], beta].min\n        if beta &lt;= alpha\n          break\n        end\n      end\n      #Following line raises \"comparison of array with array failed\" error :\n      return child.sort_by{|c| c[0]}\n    end\n\n  end\n\n  def generate_child(boardstate, active_player)\n    #returns boardstate string with one X or O more than current boardstate\n    #and sets nil as a default wincheck value\n    c = active_player == 1 ? \"O\" : \"X\"\n    a = []\n    for i in 0...boardstate.length\n      if boardstate[i].chr == \"-\"\n        s = boardstate.dup\n        s[i]= c\n        a &lt;&lt; [nil, s]\n      end\n    end\n    return a\n  end\n\nend\n</code></pre>\n\n<p>Error: comparison of array with array failed</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1562106500, "post_id": 56860104, "comment_id": 100271281, "body": "It&#39;s difficult to say whether you&#39;re doing something wrong when we have no code to look at. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;."}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 1, "creation_date": 1562138836, "post_id": 56860104, "comment_id": 100278948, "body": "Just think of the presigned URL as a signed slip of paper saying &quot;you have my permission to download an object with this name, until the expiry time&quot;. When the actual request is sent to S3, then S3 will validated the presigned URL, effectively checking your signature against the one on file then permit the request if it is valid."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 1, "creation_date": 1562198171, "post_id": 56860362, "comment_id": 100306824, "body": "Is this documented anywhere, or just so obvious it&#39;s expected we know?"}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "reply_to_user": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1564622970, "post_id": 56860362, "comment_id": 101095009, "body": "I&#39;m not aware of any specific documentation to this effect, but if you treat this pre-signed URL like, say, a filepath of /usr/james/area51/proof.xml, then you can see that there&#39;s no guarantee that that file exists, either at the time the reference is taken or at the time it&#39;s used to (attempt to) access the file."}], "tags": [], "owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "is_accepted": true, "score": 3, "last_activity_date": 1562103724, "creation_date": 1562103724, "answer_id": 56860362, "question_id": 56860104, "link": "https://stackoverflow.com/questions/56860104/s3-creates-signed-urls-for-items-that-do-not-exist/56860362#56860362", "title": "S3 creates signed URLs for items that do not exist", "body": "<p>Yes, this is normal behavior. The pre-signed URL is simply a local calculation and signing of a URL. It has no interaction with the S3 service at all.</p>\n\n<p>If you want to ensure that an object exists before you generate a pre-signed URL for it, then you should <code>head</code> that object.</p>\n\n<p>Note: you can use pre-signed URLs to upload new objects, which obviously don't yet exist at the time you generate the URL. You might also want to use pre-signed URLs to download objects that don't yet exist, but will at some later date (though I admit this is probably not that common a use case).</p>\n"}], "owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 56860362, "answer_count": 1, "score": 1, "last_activity_date": 1562103724, "creation_date": 1562101916, "question_id": 56860104, "link": "https://stackoverflow.com/questions/56860104/s3-creates-signed-urls-for-items-that-do-not-exist", "title": "S3 creates signed URLs for items that do not exist", "body": "<p>S3 presigned URLs are being created for items that do not exist. Is this normal behavior? I would rather know if the item is not going to exist when creating the link, than send users to an error page. Obviously, I can check if the item exists before I create the link, but I'm wondering if I'm doing something wrong.</p>\n"}, {"tags": ["ruby", "selenium", "selenium-chromedriver", "multiline"], "comments": [{"owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "edited": false, "score": 0, "creation_date": 1565894057, "post_id": 56860090, "comment_id": 101497068, "body": "You should mark my answer as correct if it solved your problem."}], "answers": [{"tags": [], "owner": {"reputation": 1976, "user_id": 1177200, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99ddd63eb79f04e76156db21c172c7f1?s=128&d=identicon&r=PG", "display_name": "taylorthurlow", "link": "https://stackoverflow.com/users/1177200/taylorthurlow"}, "is_accepted": false, "score": 0, "last_activity_date": 1562300826, "creation_date": 1562300826, "answer_id": 56896553, "question_id": 56860090, "link": "https://stackoverflow.com/questions/56860090/replacing-linebreak-with-shift-enter-in-selenium-ruby/56896553#56896553", "title": "Replacing linebreak with shift-enter in selenium ruby", "body": "<p><code>\\n</code> is an escape character which represents a line break. The keyboard keys you press to get that character don't have anything to do with your problem - Enter and Shift+Enter both add a <code>\\n</code> to the chat text input box.</p>\n\n<p>What <strong>does</strong> matter is how the chat window is programmed. When deciding if the button that was pressed means the message should be sent, the chat window isn't looking for text characters, it's looking for keyboard keys.</p>\n\n<p>With Selenium you'll need to simulate the keyboard key presses, not the text that is filled into the text box. Check out <a href=\"https://stackoverflow.com/questions/47115754/how-to-enter-shift-ctrl-s-in-selenium\">this SO answer</a>. As noted in that answer, you'll want to use something like <a href=\"https://seleniumhq.github.io/selenium/docs/api/java/org/openqa/selenium/interactions/Actions.html#keyDown-java.lang.CharSequence-\" rel=\"nofollow noreferrer\"><code>Actions#keyDown</code></a> or <a href=\"https://seleniumhq.github.io/selenium/docs/api/java/org/openqa/selenium/interactions/Actions.html#keyUp-java.lang.CharSequence-\" rel=\"nofollow noreferrer\"><code>Actions#keyUp</code></a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 11726745, "user_type": "registered", "profile_image": "https://graph.facebook.com/145769913269977/picture?type=large", "display_name": "Vidur Sanandan", "link": "https://stackoverflow.com/users/11726745/vidur-sanandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562300826, "creation_date": 1562101821, "question_id": 56860090, "link": "https://stackoverflow.com/questions/56860090/replacing-linebreak-with-shift-enter-in-selenium-ruby", "title": "Replacing linebreak with shift-enter in selenium ruby", "body": "<p>I've been having a lot of trouble with multiline inputs in Selenium. From what I've learned on google, the \\n character essentially enters a new line. That makes it such that I can't send a block multiline input as one paragraph text. I want to be able to replace the \\n characters with a shift-enter (simultaneous) keystroke. </p>\n\n<p>I've tried using different methods but none of them seem to work. </p>\n\n<p>The string I'm trying to send is: </p>\n\n<pre><code>reply_messages = [\n\"FREE PILLOW - Thank you for your patience! \\n To redeem your FREE pillow, just use the LINK IN OUR BIO and ADD TO CART - just cover shipping, no additional charges!\"]\n</code></pre>\n\n<p>I eventually send the string with the line: <code>reply_input.send_keys(reply_messages)</code></p>\n\n<p>When I use selenium to input reply_messages, it outputs each of the lines as separate lines. </p>\n\n<p>Essentially, it will send the first line, enter it into the chat window, then send the second line and enter it into the chat window, instead of entering the first line, adding a linebreak, entering the second line, and sending that entire spaced paragraph as one message.</p>\n\n<p>I want to thus replace the linebreak with a shift-enter keystroke so that the browser doesn't register the newline as its own enter keystroke. </p>\n\n<p>With the linebreak, the string is sent as two separate messages.</p>\n"}, {"tags": ["ruby", "deadlock"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 4, "creation_date": 1562106704, "post_id": 56859871, "comment_id": 100271315, "body": "Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. When asking us to help debug code we need to see the code. Descriptions are important, but, like a picture, the code is worth 1,000 words."}, {"owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1562147720, "post_id": 56859871, "comment_id": 100283700, "body": "I disagree with you lot here. I am not asking you to debug the code. I just want a better understanding of how Ruby does its deadlock detection in the general sense and what the possible reasons may be rather than the exact reason."}], "answers": [{"tags": [], "owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "is_accepted": true, "score": 0, "last_activity_date": 1562647297, "creation_date": 1562647297, "answer_id": 56945467, "question_id": 56859871, "link": "https://stackoverflow.com/questions/56859871/why-might-a-joined-thread-be-missing-from-deadlock-detection-in-ruby/56945467#56945467", "title": "Why might a joined thread be missing from deadlock detection in Ruby?", "body": "<p>My understanding was not correct. Even though it appeared from the debug logging that it was joining on the first thread it was not. It had joined on the first thread and it was the second one that caused the deadlock.</p>\n\n<p>Once I identified that it was much simpler to track down why the first thread was completing but not signalling the remaining threads.</p>\n\n<p>This may have been caused by <code>puts</code> buffering. So either <code>flush</code> the output, set it to <code>sync</code> or unroll the loop so that the joins appear on different lines and the backtrace tells you the correct one.</p>\n\n<p>In short, trust the output from the deadlock. If it conflicts with your assumptions then validate your assumptions.</p>\n"}], "owner": {"reputation": 3668, "user_id": 367796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/knppv.jpg?s=128&g=1", "display_name": "steinybot", "link": "https://stackoverflow.com/users/367796/steinybot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56945467, "answer_count": 1, "score": 0, "last_activity_date": 1562647297, "creation_date": 1562100540, "last_edit_date": 1562148249, "question_id": 56859871, "link": "https://stackoverflow.com/questions/56859871/why-might-a-joined-thread-be-missing-from-deadlock-detection-in-ruby", "title": "Why might a joined thread be missing from deadlock detection in Ruby?", "body": "<p>I am trying to debug a deadlock in some Ruby code bit something doesn't seem to add up. I'm not a Ruby developer so maybe I'm making an invalid assumption somewhere. I want to understand a bit more about how Ruby performs its deadlock detection.</p>\n\n<p>Here is an example of what I am seeing:</p>\n\n<ul>\n<li>There are 9 threads. The first is the main and current thread. The other 8 are worker threads.</li>\n<li>The first worker thread goes off and does its thing and eventually gets to a <code>::IO:readlines</code>.</li>\n<li>The next 4 go and start something but then <code>wait</code> on a <code>ConditionVariable</code> which the first worker thread will eventually <code>signal</code>.</li>\n<li>The other 3 have nothing to do and stop.</li>\n<li>Now the main thread calls <code>join</code> on all the worker threads after starting them, joining on the 1st worker first.</li>\n<li>This <code>join</code> fails saying:\n\n<blockquote>\n  <p>No live threads left. Deadlock? (fatal)</p>\n</blockquote></li>\n<li>It then prints out 5 threads, 1 is the main thread and the other 4 are the 4 workers that are waiting. The 1st worker thread is missing.</li>\n<li>The 1st worker is still alive, it carries on doing its thing after the error.</li>\n</ul>\n\n<p>What are the possible reasons why a thread that is being joined on is not included in the deadlock detection? Or is this simply not possible and my understanding of what is really going incorrect?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-s3"], "comments": [{"owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "edited": false, "score": 0, "creation_date": 1562116991, "post_id": 56859865, "comment_id": 100273058, "body": "Do you get an undefined method error when calling client.bucket? It could be that client is not defined properly. If you are using pry, you can try <code>ls client</code> to see what methods are available on it."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "edited": false, "score": 0, "creation_date": 1562198096, "post_id": 56868404, "comment_id": 100306813, "body": "Doh. Long night, should have came back to this. I could&#39;ve sworn an example or two I came across used the <code>Client</code> directly. I still couldn&#39;t find any examples using <code>InstanceProfileCredentials</code> with credentials, and the obvious id/key parameters didn&#39;t take. Had to use <code>Resource.new(client: &lt;client&gt;)</code>. Thanks."}], "tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": true, "score": 4, "last_activity_date": 1562155243, "last_edit_date": 1562155243, "creation_date": 1562150866, "answer_id": 56868404, "question_id": 56859865, "link": "https://stackoverflow.com/questions/56859865/ruby-undefined-method-bucket-for-awss3client/56868404#56868404", "title": "Ruby: Undefined method `bucket&#39; for #&lt;Aws::S3::Client&gt;", "body": "<p>You should call <code>bucket</code> or <code>buckets</code> on <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Resource.html\" rel=\"nofollow noreferrer\"><code>Aws::S3::Resource</code></a> instance and not on <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Client.html\" rel=\"nofollow noreferrer\"><code>Aws::S3::Client</code></a> instance as an error states. </p>\n\n<p>And the links you provided as well as <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/index.html#Resource_Interfaces\" rel=\"nofollow noreferrer\">docs</a> show that:</p>\n\n<pre><code>s3 = Aws::S3::Resource.new(\n  region: 'us-east-1',\n  credentials: Aws::InstanceProfileCredentials.new()\n)\nbucket =  s3.bucket('my-daily-backups')\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 8897013, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57438fb7d0ee1c49f779a3b7e7102e4?s=128&d=identicon&r=PG&f=1", "display_name": "user8897013", "link": "https://stackoverflow.com/users/8897013/user8897013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "accepted_answer_id": 56868404, "answer_count": 1, "score": 1, "last_activity_date": 1562155243, "creation_date": 1562100500, "last_edit_date": 1562101235, "question_id": 56859865, "link": "https://stackoverflow.com/questions/56859865/ruby-undefined-method-bucket-for-awss3client", "title": "Ruby: Undefined method `bucket&#39; for #&lt;Aws::S3::Client&gt;", "body": "<p>Using the <code>aws-sdk-s3</code> gem, I am currently able to upload items to buckets and create signed URLs, and am trying to determine if an object exists in a bucket or not. All the documentation I see says client.bucket('bucketname') should work, but in my case it is not. I've tried:</p>\n\n<pre><code>client.bucket('bucketname')\nclient.bucket['bucketname']\nclient.buckets('bucketname')\nclient.buckets['bucketname']\n</code></pre>\n\n<p>but none work. This suggestion using <code>head_object</code> is a possibility (<a href=\"https://github.com/cloudyr/aws.s3/issues/160\" rel=\"nofollow noreferrer\">https://github.com/cloudyr/aws.s3/issues/160</a>), but I'm still curious why <code>bucket</code> isn't working.</p>\n\n<p>DOCS:<br>\n<a href=\"https://gist.github.com/hartfordfive/19097441d3803d9aa75ffe5ecf0696da\" rel=\"nofollow noreferrer\">https://gist.github.com/hartfordfive/19097441d3803d9aa75ffe5ecf0696da</a><br>\n<a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/index.html#Resource_Interfaces\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-ruby/v3/api/index.html#Resource_Interfaces</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1562168524, "post_id": 56859655, "comment_id": 100295997, "body": "What led to your comment about <code>@import</code>? Is there more context there?"}, {"owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "reply_to_user": {"reputation": 967, "user_id": 1106710, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wscQp.jpg?s=128&g=1", "display_name": "Adam McCrea", "link": "https://stackoverflow.com/users/1106710/adam-mccrea"}, "edited": false, "score": 0, "creation_date": 1562169575, "post_id": 56859655, "comment_id": 100296517, "body": "I read online regarding similar questions it could be the reason why. I just realised it will precompile my pngs and js files, but none of my css files"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562208011, "post_id": 56859655, "comment_id": 100308303, "body": "Can you confirm which buildpacks you have setup on your app? And the order they appear in?"}, {"owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "edited": false, "score": 0, "creation_date": 1562428876, "post_id": 56859655, "comment_id": 100374023, "body": "so when I removing my application.css file it work, any ideas why my application.css file is stopping assets: precompile work on production?"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "is_accepted": true, "score": 0, "last_activity_date": 1586796138, "last_edit_date": 1586796138, "creation_date": 1562437927, "answer_id": 56916698, "question_id": 56859655, "link": "https://stackoverflow.com/questions/56859655/how-to-run-build-pack-without-time-out-using-ruby/56916698#56916698", "title": "How to run build pack without time out using Ruby", "body": "<p>Just in case anyone runs into the same problem, I have found the issue - my CSS files had custom written CSS-Grid, and some of these values were causing <code>$ bundle exec rake assets:precompile RAILS_ENV=production</code> to hang. I resolved by deleting the CSS-Grid layouts inside the .css file</p>\n"}], "owner": {"reputation": 81, "user_id": 9561042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbde692344e4067815489f888f06e1f?s=128&d=identicon&r=PG", "display_name": "SwiftHub", "link": "https://stackoverflow.com/users/9561042/swifthub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 56916698, "answer_count": 1, "score": 2, "last_activity_date": 1586796138, "creation_date": 1562099372, "last_edit_date": 1562106881, "question_id": 56859655, "link": "https://stackoverflow.com/questions/56859655/how-to-run-build-pack-without-time-out-using-ruby", "title": "How to run build pack without time out using Ruby", "body": "<p>I am trying to push my first site to Heroku, but everything keeps timing out and I'm not to sure why. I don't have a bunch of PDFs which would cause it to time out, so I'm scratching my head. </p>\n\n<p>Here is the error I receive just before it fails:</p>\n\n<pre><code>       Cleaning up the bundler cache.\n-----&gt; Installing node-v10.15.3-linux-x64\n-----&gt; Detecting rake tasks\n-----&gt; Preparing app for Rails asset pipeline\n       Running: rake assets:precompile\n       Yarn executable was not detected in the system.\n       Download Yarn at https://yarnpkg.com/en/docs/install\n       I, [2019-07-02T19:46:47.794669 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/deli3-397a9ad3da4bc5ec1fba4e10d9e3907174bd0ffe42493e732d6fb61d7f7002d5.png\n       I, [2019-07-02T19:46:47.797500 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/food/food-726680522246b17f86a014fae70f1450435edc64798f8262315c23ccf6fa5744.png\n       I, [2019-07-02T19:46:47.799838 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/food/frying-pan-af3f7e894cee377789f12f96b9f0ab120e8af6aba0cf03b6f8c021f5dadfc704.png\n       I, [2019-07-02T19:46:47.802089 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/food/package-ec6088618de7d2829802bdc57b1ba0de3562ebf11d2ee2588af3432992c254a2.png\n       I, [2019-07-02T19:46:50.262020 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/application-867e786874a7ad085e8e8e6fa4fcdda94aa82c482156efe5a12c59dd8e564d3e.js\n       I, [2019-07-02T19:46:50.262656 #1507]  INFO -- : Writing /tmp/build_cabc1b6e8756bc1d1d3a5bd1884ae5fc/public/assets/application-867e786874a7ad085e8e8e6fa4fcdda94aa82c482156efe5a12c59dd8e564d3e.js.gz\n-----&gt; Timed out running buildpack Ruby\n !     Timed out compiling app (18 minutes)\n !     See https://devcenter.heroku.com/articles/slug-compiler#time-limit\n</code></pre>\n\n<p>I think this is because the precompile is taking too long because of my SCSS files with <code>@import</code>. On my local drive I ran this command which has been running/hanging for 20 minutes so far.</p>\n\n<pre><code>$ RAILS_ENV=production bundle exec rake assets:precompile --trace\n** Invoke assets:precompile (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke environment (first_time)\n** Execute environment\n** Invoke yarn:install (first_time)\n** Execute yarn:install\nyarn install v1.16.0\n[1/4] \ud83d\udd0d  Resolving packages...\nsuccess Already up-to-date.\n\u2728  Done in 0.04s.\n\n\n</code></pre>\n"}, {"tags": ["ruby", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 3029, "user_id": 162260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca23228b0e7354ce3f243528b469fcc?s=128&d=identicon&r=PG", "display_name": "i-blis", "link": "https://stackoverflow.com/users/162260/i-blis"}, "edited": false, "score": 0, "creation_date": 1562096850, "post_id": 56859127, "comment_id": 100268240, "body": "Don&#39;t forget to upvote or accept the answer, if it did help you."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1562097512, "post_id": 56859127, "comment_id": 100268498, "body": "This may work in this case (highly browser/driver dependent), but it&#39;s not guaranteed that <code>go_back</code> returns a page with the same objects so it also may not."}], "tags": [], "owner": {"reputation": 3029, "user_id": 162260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca23228b0e7354ce3f243528b469fcc?s=128&d=identicon&r=PG", "display_name": "i-blis", "link": "https://stackoverflow.com/users/162260/i-blis"}, "is_accepted": false, "score": 0, "last_activity_date": 1562096812, "creation_date": 1562096812, "answer_id": 56859127, "question_id": 56858880, "link": "https://stackoverflow.com/questions/56858880/how-can-i-iterate-through-an-array-of-links-and-check-information-on-the-page-to/56859127#56859127", "title": "How can I iterate through an array of links and check information on the page to which each refers?", "body": "<p>You probably want to use <code>page.go_back</code> (or <code>page.driver.go_back</code> depending on the driver you're using). Something like this:</p>\n\n<pre><code>When(\"I click on each job title\") do\n  page.all('.job-box').each do |item|\n    within(item) do\n        find('a').click\n        # do stuff\n    end\n    # roll back (granting you went but one click away)\n    page.go_back\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11080785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BddqreN_vfg/AAAAAAAAAAI/AAAAAAAACQE/CuQ9Gxz8TMw/photo.jpg?sz=128", "display_name": "Kevin A. Wilson", "link": "https://stackoverflow.com/users/11080785/kevin-a-wilson"}, "edited": false, "score": 0, "creation_date": 1562166263, "post_id": 56859439, "comment_id": 100294754, "body": "Your answer got me close enough to find a solution (see below). Thank you."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": false, "score": 0, "last_activity_date": 1562098299, "creation_date": 1562098299, "answer_id": 56859439, "question_id": 56858880, "link": "https://stackoverflow.com/questions/56858880/how-can-i-iterate-through-an-array-of-links-and-check-information-on-the-page-to/56859439#56859439", "title": "How can I iterate through an array of links and check information on the page to which each refers?", "body": "<p>As you've recognized the issue here is that the elements are stale when you return to the previous page. Depending on what limitations you're willing to accept there are multiple ways to deal with this. The bigger issue you have is that you're doing this in Cucumber which really doesn't have support for scoping/looping in its test structure. If you're willing for this to only work on a specific browser/platform you can use the respective key modifiers on click to have the browser open a new tab for each job entry and then your next step could run through all the open tabs checking those</p>\n\n<pre><code>When(\"I click on each job title\") do\n  page.all('.job-box').each do |item|\n    item.find('a').click(:alt, :cmd) # alt,cmd click in Chrome MacOS opens in new tab\n  end\nend\n</code></pre>\n\n<p>But really you're going to be better off doing something like</p>\n\n<pre><code>When(\"I click on each job title and verify info\") do\n  page.all('.job-box').each do |item|\n    window = page.window_opened_by do\n      item.find('a').click(:alt, :cmd)\n    end\n    page.within_window(window) do\n      # verify whatever needs to be verified\n    end\n    window.close\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1562172916, "post_id": 56873052, "comment_id": 100298147, "body": "If you&#39;re ok with grabbing the href rather than actual clicks(like you have done) then you don&#39;t need the <code>window_opened_by</code> and second <code>within_window</code>.  Just do your checking inside the one within_window after the <code>visit url</code>.  Also please accept your answer (the checkmark) so your question gets marked as answered"}, {"owner": {"reputation": 1, "user_id": 11080785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BddqreN_vfg/AAAAAAAAAAI/AAAAAAAACQE/CuQ9Gxz8TMw/photo.jpg?sz=128", "display_name": "Kevin A. Wilson", "link": "https://stackoverflow.com/users/11080785/kevin-a-wilson"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1562178841, "post_id": 56873052, "comment_id": 100300751, "body": "Thanks. I&#39;ll try that. I have to wait 24 hours before I can mark my own answer as correct, but I&#39;ll definitely come back tomorrow to do that."}], "tags": [], "owner": {"reputation": 1, "user_id": 11080785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BddqreN_vfg/AAAAAAAAAAI/AAAAAAAACQE/CuQ9Gxz8TMw/photo.jpg?sz=128", "display_name": "Kevin A. Wilson", "link": "https://stackoverflow.com/users/11080785/kevin-a-wilson"}, "is_accepted": true, "score": 0, "last_activity_date": 1562166177, "creation_date": 1562166177, "answer_id": 56873052, "question_id": 56858880, "link": "https://stackoverflow.com/questions/56858880/how-can-i-iterate-through-an-array-of-links-and-check-information-on-the-page-to/56873052#56873052", "title": "How can I iterate through an array of links and check information on the page to which each refers?", "body": "<p>Thomas Walpole's answer got me close enough to figure it out. Here is what ended up working:</p>\n\n<pre><code>    When(\"I click on each job title and verify info\") do\n      page.all('.job-box').each do |item|\n        new_window = window_opened_by do\n          url = item.find('a')[:href]\n          within_window open_new_window do\n            visit url\n          end\n        end\n        page.within_window(new_window) do\n            # do stuff\n        end\n      end\n    end\n</code></pre>\n\n<p>It doesn't close each new tab after it checks it, which could be a problem if you are working with a lot of links. I only have about 15, so it wasn't an issue for me. They all closed when the browser closed after the test finished.</p>\n"}], "owner": {"reputation": 1, "user_id": 11080785, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BddqreN_vfg/AAAAAAAAAAI/AAAAAAAACQE/CuQ9Gxz8TMw/photo.jpg?sz=128", "display_name": "Kevin A. Wilson", "link": "https://stackoverflow.com/users/11080785/kevin-a-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56873052, "answer_count": 3, "score": 0, "last_activity_date": 1562166177, "creation_date": 1562095428, "question_id": 56858880, "link": "https://stackoverflow.com/questions/56858880/how-can-i-iterate-through-an-array-of-links-and-check-information-on-the-page-to", "title": "How can I iterate through an array of links and check information on the page to which each refers?", "body": "<p>I have a page that lists job openings at my company. I want to use Capybara tests to click on each of the links and determine if the target page contains certain content. </p>\n\n<p>I have the step below. The next step in the process checks for the content on the new page.</p>\n\n<pre><code>When(\"I click on each job title\") do\n  page.all('.job-box').each do |item|\n    within(item) do\n        find('a').click\n    end\n  end\nend\n</code></pre>\n\n<p>Once the first link is clicked the browser goes to a different page. At that point, I would like to check the content on that page, then return to the previous step to check the next link. What actually happens is that the code clicks the first link, and then attempts to click the second link. Since the first link sent it to another page, the second link is no longer present, so it returns a stale element error.</p>\n\n<p>Obviously, I need a way to deal with multiple pages before continuing with the next step in the iteration, but I haven't found any documentation that addresses that problem.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "carrierwave"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1562107131, "post_id": 56858348, "comment_id": 100271389, "body": "Welcome to Stack Overflow. Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Take a look at your question. If a peer handed you a piece of paper with that printed on it what would you ask them to show you? We need enough code to replicate the problem, along with any necessary input and the expected output."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 5569738, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207116495884389/picture?type=large", "display_name": "Kentaro Fujiy", "link": "https://stackoverflow.com/users/5569738/kentaro-fujiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1562121827, "creation_date": 1562121827, "answer_id": 56862250, "question_id": 56858348, "link": "https://stackoverflow.com/questions/56858348/how-to-show-my-image-using-rails-and-carrierwave-in-ruby/56862250#56862250", "title": "how to show my image using rails and carrierwave in ruby", "body": "<p>move to active storage instead here are the guides you need:\n<a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html\" rel=\"nofollow noreferrer\">https://edgeguides.rubyonrails.org/active_storage_overview.html</a>\n<a href=\"https://gorails.com/episodes/direct-uploads-with-rails-active-storage?autoplay=1\" rel=\"nofollow noreferrer\">https://gorails.com/episodes/direct-uploads-with-rails-active-storage?autoplay=1</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11730796, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-08g5lfOXIbM/AAAAAAAAAAI/AAAAAAAAChk/pcHi6u5yDQQ/photo.jpg?sz=128", "display_name": "Rispal Gibar", "link": "https://stackoverflow.com/users/11730796/rispal-gibar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1562121827, "creation_date": 1562092487, "question_id": 56858348, "link": "https://stackoverflow.com/questions/56858348/how-to-show-my-image-using-rails-and-carrierwave-in-ruby", "title": "how to show my image using rails and carrierwave in ruby", "body": "<p>im buiding some app with image but it doesnt show</p>\n\n<p>im using linux</p>\n\n<p> &lt;%= image_tag @articles.avatar_url %></p>\n\n<p>NoMethodError in Articles#index</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "escaping"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562093800, "post_id": 56858132, "comment_id": 100267134, "body": "I think you might just need to wrap it in quotes, e.g. <code>$(div).html(&quot;&lt;%= raw render(partial: &#39;_html&#39;) %&gt;&quot; </code> ... can you check the output of the HTML in the browser and see what&#39;s wrong? Also note, you shouldn&#39;t use raw if this contains user-generated content, even a user name, because of HTML injection risk"}, {"owner": {"reputation": 43, "user_id": 6634479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHLsv.jpg?s=128&g=1", "display_name": "Antoni C", "link": "https://stackoverflow.com/users/6634479/antoni-c"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562098755, "post_id": 56858132, "comment_id": 100268998, "body": "yeah the quotes not being there are a typo. The output consists of various combinations with most characters unescaped or escaped in different ways which I am trying to avoid. The security risk I already understand."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562133133, "post_id": 56858132, "comment_id": 100276340, "body": "So you want the page source to include the special characters like <code>\\n</code> / <code>\\t</code> as text and not as actual line breaks / tabs?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562133173, "post_id": 56858132, "comment_id": 100276352, "body": "Although I&#39;m also curious how to do this, I also wonder if there&#39;s a legit reason you need to do it"}, {"owner": {"reputation": 43, "user_id": 6634479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHLsv.jpg?s=128&g=1", "display_name": "Antoni C", "link": "https://stackoverflow.com/users/6634479/antoni-c"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562171271, "post_id": 56858132, "comment_id": 100297346, "body": "Just realized keeping spaces and tabs is completely useless and doesn&#39;t serve my goal. Yet am still curious of the solution, since something similar happens when escaping regexps, and other sensitive strings when passing them from js to ruby."}, {"owner": {"reputation": 43, "user_id": 6634479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHLsv.jpg?s=128&g=1", "display_name": "Antoni C", "link": "https://stackoverflow.com/users/6634479/antoni-c"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562171404, "post_id": 56858132, "comment_id": 100297414, "body": "Answer to your question is yes."}], "owner": {"reputation": 43, "user_id": 6634479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eHLsv.jpg?s=128&g=1", "display_name": "Antoni C", "link": "https://stackoverflow.com/users/6634479/antoni-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562098871, "creation_date": 1562091541, "last_edit_date": 1562098871, "question_id": 56858132, "link": "https://stackoverflow.com/questions/56858132/rails-render-html-source-from-variable-on-javascript-view", "title": "Rails render html source from variable on javascript view", "body": "<p>I need to change html of a div to the value of a string of an object</p>\n\n<pre><code>string\n &gt; \"\\n&lt;div&gt;\\n\\t&lt;div&gt;\\n\\t\\t&lt;a id='dog'&gt;cat&lt;/a&gt;\\n\\t&lt;/div&gt;\\n&lt;/div&gt;\\n\\n\\t\"\n\nstring.inspect\n &gt; \"\\\"\\\\n&lt;div&gt;\\\\n\\\\t&lt;div&gt;\\\\n\\\\t\\\\t&lt;a id='dog'&gt;cat&lt;/a&gt;\\\\n\\\\t&lt;/div&gt;\\\\n&lt;/div&gt;\\\\n\\\\n\\\\t\\\"\" \n</code></pre>\n\n<p>I've tried </p>\n\n<pre><code>$(div).html(\"&lt;%= render(partial: '_html') \");\n</code></pre>\n\n<p>where _html is just</p>\n\n<pre><code> &lt;%= @html %&gt;\n</code></pre>\n\n<p>I've tried with j, raw, h, html_safe, setting @html as string.inspect, eval(@html.inspect), ...</p>\n\n<p>But none of these ways have helped.</p>\n\n<p>Goal is to put exactly \"string\" into the javascript source with no changes in escaping nor extra quotes added.</p>\n\n<p>How can I do it?</p>\n"}, {"tags": ["ruby", "rubygems"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562087868, "post_id": 56856966, "comment_id": 100264661, "body": "Probably an incompatible version of Ruby for that version of Rails: <a href=\"https://stackoverflow.com/q/53213498/3784008\">stackoverflow.com/q/53213498/3784008</a>"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 3, "creation_date": 1562088071, "post_id": 56856966, "comment_id": 100264732, "body": "Also see <a href=\"https://weblog.rubyonrails.org/2017/2/21/Rails-4-2-8-has-been-released/\" rel=\"nofollow noreferrer\">weblog.rubyonrails.org/2017/2/21/Rails-4-2-8-has-been-releas&zwnj;&#8203;ed</a> -- 4.2.8 is the first version to support Ruby 2.4, so there&#39;s no way Rails 4.2.6 will support Ruby 2.5."}], "answers": [{"tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 3, "last_activity_date": 1562127559, "creation_date": 1562127559, "answer_id": 56862845, "question_id": 56856966, "link": "https://stackoverflow.com/questions/56856966/update-from-ruby-2-2-0-to-2-5/56862845#56862845", "title": "Update from ruby 2.2.0 to 2.5", "body": "<p>It is because you have wrong gem resources.</p>\n\n<p>Try these to correct it</p>\n\n<pre><code>gem sources -r  http://gems.rubyforge.org/\ngem sources -r http://gems.github.com\ngem sources -a https://rubygems.org/\n</code></pre>\n\n<p>Then bundle again as you did</p>\n"}], "owner": {"reputation": 859, "user_id": 7227222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec1eb8473ab73ded224fbbdc2414005?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertMunichMar", "link": "https://stackoverflow.com/users/7227222/albertmunichmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1612, "favorite_count": 0, "accepted_answer_id": 56862845, "answer_count": 1, "score": 3, "last_activity_date": 1562145627, "creation_date": 1562086032, "last_edit_date": 1562145627, "question_id": 56856966, "link": "https://stackoverflow.com/questions/56856966/update-from-ruby-2-2-0-to-2-5", "title": "Update from ruby 2.2.0 to 2.5", "body": "<p>I have a Rails (<code>4.2.6</code>) project that was written with ruby <code>2.2.0</code>.</p>\n\n<p>I am trying to upgrade to ruby <code>2.5</code>. To do that, I changed in the Rails repo, the file <code>.ruby-version</code> to <code>ruby-2.5.0</code>.</p>\n\n<p>In the terminal, the ruby version is correct:</p>\n\n<pre><code>ruby 2.5.0p0 (2017-12-25 revision 61468) [x86_64-darwin17]\n</code></pre>\n\n<p>When I run</p>\n\n<pre><code>bundle update --bundler \n</code></pre>\n\n<p>I get following error:</p>\n\n<pre><code>6 warnings and 2 errors generated.\nmake: *** [generator.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in /Users/albert/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/gems/json-1.8.3 for inspection.\nResults logged to /Users/albert/.rbenv/versions/2.5.0/lib/ruby/gems/2.5.0/extensions/x86_64-darwin-17/2.5.0-static/json-1.8.3/gem_make.out\n\nAn error occurred while installing json (1.8.3), and Bundler cannot continue.\nMake sure that `gem install json -v '1.8.3'` succeeds before bundling.\n\nIn Gemfile:\n  rails was resolved to 4.2.6, which depends on\n    actionmailer was resolved to 4.2.6, which depends on\n      actionpack was resolved to 4.2.6, which depends on\n        actionview was resolved to 4.2.6, which depends on\n          rails-dom-testing was resolved to 1.0.7, which depends on\n            rails-deprecated_sanitizer was resolved to 1.0.3, which depends on\n              activesupport was resolved to 4.2.6, which depends on\n                json\n</code></pre>\n\n<p>I've tried to update manually the json gem:</p>\n\n<pre><code>gem install json -v '1.8.3' \n</code></pre>\n\n<p>Without success:</p>\n\n<pre><code>Getting SRV record failed: DNS result has no information for _rubygems._tcp.gems.rubyforge.org\nHEAD http://gems.rubyforge.org/api/v1/dependencies\n301 Moved Permanently\nHEAD https://rubygems.org\n200 OK\nGetting SRV record failed: DNS result has no information for _rubygems._tcp.gems.github.com\nHEAD http://gems.github.com/api/v1/dependencies\n301 Moved Permanently\nHEAD http://gems.github.io/api/v1/dependencies\n404 Not Found\nGET http://gems.github.com/prerelease_specs.4.8.gz\n301 Moved Permanently\nGET http://gems.github.io/prerelease_specs.4.8.gz\n404 Not Found\nGET http://gems.github.com/specs.4.8.gz\n301 Moved Permanently\nGET http://gems.github.io/specs.4.8.gz\n404 Not Found\nHEAD https://api.rubygems.org/api/v1/dependencies\n200 OK\nGET https://rubygems.org?gems=json\n200 OK\nERROR:  While executing gem ... (TypeError)\n    incompatible marshal file format (can't be read)\n    format version 4.8 required; 60.33 given\n</code></pre>\n\n<p>At this point, I don't know what to google, how to debug.</p>\n\n<p>If I run </p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>I get following error</p>\n\n<pre><code>    2: from ./bin/bundle:3:in `&lt;main&gt;'\n    1: from /Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:263:in `bin_path'\n/Users/albert/.rbenv/versions/2.5.0/lib/ruby/2.5.0/rubygems.rb:289:in `find_spec_for_exe': Could not find 'bundler' (1.14.3) required by your /Users/albert/localDocuments/CodingArea/Clients/hanspeter/book/Gemfile.lock. (Gem::GemNotFoundException)\nTo update to the lastest version installed on your system, run `bundle update --bundler`.\nTo install the missing version, run `gem install bundler:1.14.3`\n</code></pre>\n\n<p>Not sure what this means, what I have in the <code>Gemfile.lock</code> is:</p>\n\n<pre><code>bundler (&gt;= 1.3.0, &lt; 2.0)\n</code></pre>\n\n<p>And, im my Gemfile, I have as a source:</p>\n\n<pre><code>source 'https://rubygems.org'\n```\n\nAs far as I understood, bundle is a gem manager that works on Mac, and bundler is a gem that manages gems?\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "selenium-webdriver", "pry"], "comments": [{"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1562082970, "post_id": 56855223, "comment_id": 100262555, "body": "are you running this in a local server?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1562083436, "post_id": 56855223, "comment_id": 100262771, "body": "I am running it locally, yes. @lacostenycoder"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562083770, "post_id": 56855223, "comment_id": 100262961, "body": "can you share an excerpt of one of the csvs?"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1562083825, "post_id": 56855223, "comment_id": 100262988, "body": "it&#39;s worth installing a debugger gem such as pry and adding a breakpoint to check the value of your variables"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1562136526, "post_id": 56855223, "comment_id": 100277715, "body": "@HerbertH : Your calculation of <code>all_headers</code> seems to be broken. In any case, your <code>all_headers</code> don&#39;t contain an Array. What is the single vertical bar in the expression <code>all_headers | CSV.parse_line(header_line)</code> supposed to do?"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1562136678, "post_id": 56855223, "comment_id": 100277803, "body": "@HerbertH : Also, you never use you memo-object <code>all_header</code> inside the reduce block."}], "answers": [{"tags": [], "owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "is_accepted": false, "score": 1, "last_activity_date": 1562136962, "creation_date": 1562136962, "answer_id": 56864531, "question_id": 56855223, "link": "https://stackoverflow.com/questions/56855223/nomethoderror-undefined-method-map-for-truetrueclass-for-mapping-headers-cre/56864531#56864531", "title": "NoMethodError: undefined method `map&#39; for true:TrueClass for mapping headers/creating CSVs", "body": "<p>I think I see the bug now: As I commented, the </p>\n\n<pre><code>      all_headers = input_files.reduce([]) do |all_header, file|\n         header_line = File.open(file, &amp;:gets)\n         all_headers | CSV.parse_line(header_line)\n     end\n</code></pre>\n\n<p>is non-sense: Note that on the first execution of the do ... end block, all_headers is <code>nil</code>, because the variable has been defined, but not assigned. When you calculate <code>all_headers | CSV.parse_line(header_line)</code>, this is equivalent to <code>nil | [ ... something ...]</code>, and this evaluates to true. This is repeated on every iteration, and in the end, <code>all_headers</code> receives the value <code>true</code>.</p>\n\n<p>I think you meant <code>all_header | CSV.parse_line(header_line)</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7277590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562136962, "creation_date": 1562079498, "question_id": 56855223, "link": "https://stackoverflow.com/questions/56855223/nomethoderror-undefined-method-map-for-truetrueclass-for-mapping-headers-cre", "title": "NoMethodError: undefined method `map&#39; for true:TrueClass for mapping headers/creating CSVs", "body": "<p>I'm downloading a bunch of CSVs in order to dump them into one big CSV to export. I am using Selenium/Ruby/Ruby-on-rails (?) in order to achieve this.</p>\n\n<p>The problem I am currently having is I get a </p>\n\n<p><code>NoMethodError: undefined method `map' for true:TrueClass\nDid you mean?  tap</code></p>\n\n<p>for the following code:</p>\n\n<pre><code>def csv_creation(source)\n\n      l_source = {'lead_source' =&gt; source.to_s}\n\n      input_file = Dir.glob(\"path_to_file/name_of_files*.csv\").last\n\n      rows = CSV.open(input_file, headers: true).map(&amp;:to_h)\n\n      rows.each { |h| h.merge!(l_source) }\n\n      headers = rows.first.keys\n\n      rows.first.keys.each { |k| puts k }\n\n      csv_response = CSV.generate do |csv|\n        csv &lt;&lt; headers\n\n        rows.each do |row|\n          csv &lt;&lt; row.values_at(*headers)\n        end\n      end\n\n      File.open(\"#{source}.csv\", \"w\") { |file| file.write(csv_response) }\n\n      input_files = Dir.glob(\"#{source}*.csv\")\n\n      all_headers = input_files.reduce([]) do |all_header, file|\n        header_line = File.open(file, &amp;:gets)\n\n        all_headers | CSV.parse_line(header_line)\n      end\n\n      CSV.open(\"out.csv\", \"a+\") do |out|\n        out &lt;&lt; all_headers\n\n        input_files.each do |file|\n          CSV.foreach(file, headers: true) do |row|\n\n            out &lt;&lt; all_headers.map{ |header| row[header] }\n\n          end\n        end\n      end\n    end\n</code></pre>\n\n<p>Before I was told I had to run this on rails c and throw in a module, this code worked. I am not experienced in Ruby or RoR but obviously this shift has disrupted my code.</p>\n\n<p>Random tidbits:</p>\n\n<ul>\n<li><p>\"source\" holds text gathered from a drop down menu</p></li>\n<li><p>The module in question was built by my host company so I am not entirely sure what it contains -- sorry.</p></li>\n<li><p>Rails c doesn't really give me the line number where this error is happening but I think it is happening in the second \"map\" so I printed out some of the lines to see if anything was off but nothing was. It's getting a \"true\" value from somewhere and I honestly don't know where. Everything should be a string.</p></li>\n</ul>\n\n<p>Some insight would be appreciated.</p>\n"}, {"tags": ["arrays", "ruby", "if-statement", "hash", "each"], "comments": [{"owner": {"reputation": 1543, "user_id": 5801853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e1b0fbad41fb9e1ee84161ebff1ddbbc?s=128&d=identicon&r=PG", "display_name": "yzalavin", "link": "https://stackoverflow.com/users/5801853/yzalavin"}, "edited": false, "score": 1, "creation_date": 1562076293, "post_id": 56853422, "comment_id": 100258583, "body": "What will <code>find_item(&#39;AVOCADO&#39;)</code> return?"}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "is_accepted": true, "score": 0, "last_activity_date": 1562402713, "creation_date": 1562402713, "answer_id": 56912539, "question_id": 56853422, "link": "https://stackoverflow.com/questions/56853422/turning-an-array-into-a-hash-then-adding-a-key-value-and-increment-when-key/56912539#56912539", "title": "Turning an array into a hash, then, adding a key =&gt; value and increment when key is present", "body": "<p>def consolidate_cart(cart)\n  # cart is an array of hashes\n  newCart = {}</p>\n\n<p>cart.each do |k| </p>\n\n<pre><code>if newCart[k.keys[0]]\n  newCart[k.keys[0]][:count] += 1\nelse\n  newCart[k.keys[0]] = k[k.keys[0]]\n  newCart[k.keys[0]][:count] = 1\nend\n</code></pre>\n\n<p>end\n  newCart\nend</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12004040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCiOLaoZEoxquHIhnE7Win4H_zZwcNkvIJQarzqAA=k-s128", "display_name": "Alex Farmer", "link": "https://stackoverflow.com/users/12004040/alex-farmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1567278792, "last_edit_date": 1567278792, "creation_date": 1567278453, "answer_id": 57740937, "question_id": 56853422, "link": "https://stackoverflow.com/questions/56853422/turning-an-array-into-a-hash-then-adding-a-key-value-and-increment-when-key/57740937#57740937", "title": "Turning an array into a hash, then, adding a key =&gt; value and increment when key is present", "body": "<p>I know this is slightly old but I hope this helps someone else out.</p>\n\n<p>It looks like you and I are working on the same thing. This was my solution and it passed the rspec tests.</p>\n\n<pre><code>def consolidate_cart(cart)\n new_cart = {}\n i = 0 \n while cart.length &gt; i do \n   if new_cart.keys.include?(cart[i].keys[0]) == false \n     new_cart.merge!(cart[i])\n     new_cart[cart[i].keys[0]][:count] = 1\n     i += 1 \n   else \n     new_cart[cart[i].keys[0]][:count] += 1\n     i += 1 \n   end\nend\n   p new_cart\nend \n</code></pre>\n\n<p>I decided to use .include? as it returns a boolean value, making the if/else statement really straightforward. The .include? method searches for a match in keys. If there is not a match, send that entire hash to new_cart. If there is a match, increment :count by 1. You'll want to use a loop so that you can catch all elements inside of the starting array.</p>\n"}], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56912539, "answer_count": 2, "score": 0, "last_activity_date": 1567278792, "creation_date": 1562073531, "last_edit_date": 1562247897, "question_id": 56853422, "link": "https://stackoverflow.com/questions/56853422/turning-an-array-into-a-hash-then-adding-a-key-value-and-increment-when-key", "title": "Turning an array into a hash, then, adding a key =&gt; value and increment when key is present", "body": "<p>After trying again, I think this will need an each method with a do..end. Below you will see the whole test spec to give you a breakdown of what 'cart' translates to and I have included my code so far along with the errors.</p>\n\n<p>The cart starts as an array of individual items. Translate it into a hash that includes the counts for each item with the consolidate_cart method.</p>\n\n<pre><code>describe \"Grocer\" do\n  let(:items) do\n    [\n      {\"AVOCADO\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"KALE\" =&gt; {:price =&gt; 3.00, :clearance =&gt; false}},\n      {\"BLACK_BEANS\" =&gt; {:price =&gt; 2.50, :clearance =&gt; false}},\n      {\"ALMONDS\" =&gt; {:price =&gt; 9.00, :clearance =&gt; false}},\n      {\"TEMPEH\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"CHEESE\" =&gt; {:price =&gt; 6.50, :clearance =&gt; false}},\n      {\"BEER\" =&gt; {:price =&gt; 13.00, :clearance =&gt; false}},\n      {\"PEANUTBUTTER\" =&gt; {:price =&gt; 3.00, :clearance =&gt; true}},\n      {\"BEETS\" =&gt; {:price =&gt; 2.50, :clearance =&gt; false}},\n      {\"SOY MILK\" =&gt; {:price =&gt; 4.50, :clearance =&gt; true}}\n    ]\n  end\n\n  let(:coupons) do\n    [\n      {:item =&gt; \"AVOCADO\", :num =&gt; 2, :cost =&gt; 5.00},\n      {:item =&gt; \"BEER\", :num =&gt; 2, :cost =&gt; 20.00},\n      {:item =&gt; \"CHEESE\", :num =&gt; 3, :cost =&gt; 15.00}\n    ]\n  end\n\n  describe \"#consolidate_cart\" do\n    it \"adds a count of one to each item when there are no duplicates\" do\n      cart = [find_item('TEMPEH'), find_item('PEANUTBUTTER'), find_item('ALMONDS')]\n      result = consolidate_cart(cart)\n      result.each do |item, attributes|\n        expect(attributes.keys).to include(:count)\n        expect(attributes[:count]).to eq(1)\n      end\n    end\n\n    it \"increments count when there are multiple items\" do\n      avocado = find_item('AVOCADO')\n      cart = [avocado, avocado, find_item('KALE')]\n\n      result = consolidate_cart(cart)\n      expect(result[\"AVOCADO\"][:price]).to eq(3.00)\n      expect(result[\"AVOCADO\"][:clearance]).to eq(true)\n      expect(result[\"AVOCADO\"][:count]).to eq(2)\n\n      expect(result[\"KALE\"][:price]).to eq(3.00)\n      expect(result[\"KALE\"][:clearance]).to eq(false)\n      expect(result[\"KALE\"][:count]).to eq(1)\n    end\n  end\n</code></pre>\n\n<p>Here is what I have done so far:</p>\n\n<pre><code>def consolidate_cart(cart)\n\n  newCart = {}\n\n  cart.each do |item| \n\n    if cart[item.keys[0]]\n        cart[item.keys[0]][:count] += 1;\n    else\n      cart[item[0]]\n      #need to use values method to get the price and clearence added.\n      binding.pry\n    end\n    newCart[cart]\n  end\nend\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<pre><code>  1) Grocer #consolidate_cart adds a count of one to each item when there are no duplicates\n     Failure/Error: result = consolidate_cart(cart)\n\n     TypeError:\n       no implicit conversion of String into Integer\n     # ./grocer.rb:7:in `block in consolidate_cart'\n     # ./grocer.rb:5:in `each'\n     # ./grocer.rb:5:in `consolidate_cart'\n     # ./spec/grocer_spec.rb:28:in `block (3 levels) in &lt;top (required)&gt;''\n</code></pre>\n\n<p>I really could use an explanation/help. I can't get my pry to work either to really  look at each piece of ode individually. </p>\n"}, {"tags": ["ruby", "ruby-on-rails-5", "mongoid"], "answers": [{"tags": [], "owner": {"reputation": 9592, "user_id": 9540925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhOpI.png?s=128&g=1", "display_name": "D. SM", "link": "https://stackoverflow.com/users/9540925/d-sm"}, "is_accepted": false, "score": 0, "last_activity_date": 1562099384, "creation_date": 1562099384, "answer_id": 56859657, "question_id": 56853345, "link": "https://stackoverflow.com/questions/56853345/how-to-add-a-class-method-to-mongoidcriteria/56859657#56859657", "title": "how to add a class method to Mongoid::Criteria?", "body": "<p>Read preference can be changed via persistence context:</p>\n\n<pre><code>User.with(read: {mode: :primary_preferred}) do\n  # ...\nend\n</code></pre>\n\n<p>This is explained in more depth in Mongoid manual: <a href=\"https://docs.mongodb.com/mongoid/master/tutorials/mongoid-persistence/#runtime-persistence-options\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/mongoid/master/tutorials/mongoid-persistence/#runtime-persistence-options</a></p>\n"}, {"tags": [], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "is_accepted": false, "score": 0, "last_activity_date": 1562158475, "creation_date": 1562158475, "answer_id": 56870648, "question_id": 56853345, "link": "https://stackoverflow.com/questions/56853345/how-to-add-a-class-method-to-mongoidcriteria/56870648#56870648", "title": "how to add a class method to Mongoid::Criteria?", "body": "<p>I found a good solution:</p>\n\n<pre><code>module Mongoid\n  module Findable\n    def use_master\n      read(mode: :primary_preferred)\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 7525, "user_id": 1805902, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0W7rW.png?s=128&g=1", "display_name": "pangpang", "link": "https://stackoverflow.com/users/1805902/pangpang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562158475, "creation_date": 1562073277, "question_id": 56853345, "link": "https://stackoverflow.com/questions/56853345/how-to-add-a-class-method-to-mongoidcriteria", "title": "how to add a class method to Mongoid::Criteria?", "body": "<p>I want to add a new class method to Mongoid::Criteria, all models can use this method, for example:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  ......\nend\n</code></pre>\n\n<p>then I add below code to rails initialize</p>\n\n<pre><code>class Mongoid::Criteria\n  def use_master\n    read(mode: :primary_preferred)\n  end\nend\n</code></pre>\n\n<p>but it doesn't work:</p>\n\n<pre><code>pry(main)&gt; User.use_master\nNoMethodError: undefined method `use_master' for User:Class\n</code></pre>\n\n<p>How to add the \"use_master\" method to model? Any help in advanced!</p>\n"}, {"tags": ["ruby", "dashing"], "comments": [{"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562072980, "post_id": 56852845, "comment_id": 100256497, "body": "What do you mean by &quot;doesn&#39;t seem to work&quot;? What happens now?"}, {"owner": {"reputation": 31, "user_id": 11726223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e8a621789ea596020faaf19a72c249?s=128&d=identicon&r=PG&f=1", "display_name": "cam_cudi", "link": "https://stackoverflow.com/users/11726223/cam-cudi"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562074879, "post_id": 56852845, "comment_id": 100257707, "body": "The onClick for that widget just doesnt work"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562075155, "post_id": 56852845, "comment_id": 100257875, "body": "Use the browser <code>inspectElement</code> function and  paste the content of generated <code>onClick</code>. Also, check for errors in the console. Paste both in the comments (as you probably cannot edit the question)"}, {"owner": {"reputation": 31, "user_id": 11726223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e8a621789ea596020faaf19a72c249?s=128&d=identicon&r=PG&f=1", "display_name": "cam_cudi", "link": "https://stackoverflow.com/users/11726223/cam-cudi"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562075879, "post_id": 56852845, "comment_id": 100258321, "body": "Getting the error &quot;Uncaught SyntaxError: missing ) after argument list&quot; on that line"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562076341, "post_id": 56852845, "comment_id": 100258613, "body": "And what is in <code>ENV[&#39;Variable&#39;]</code>?"}, {"owner": {"reputation": 31, "user_id": 11726223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e8a621789ea596020faaf19a72c249?s=128&d=identicon&r=PG&f=1", "display_name": "cam_cudi", "link": "https://stackoverflow.com/users/11726223/cam-cudi"}, "reply_to_user": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1562076398, "post_id": 56852845, "comment_id": 100258645, "body": "Variable is my environment variable and im trying to call it"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 1, "creation_date": 1562078339, "post_id": 56852845, "comment_id": 100259808, "body": "Try: <code>&quot;javascript: window.open(&#39;https:&#47;&#47;xxxxxxx.#{j(ENV[&#39;Variable&#39;])}.xxxxxxx.c&zwnj;&#8203;om&#39;, &#39;_blank&#39;);&quot;</code> to escape variable content"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11726223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e8a621789ea596020faaf19a72c249?s=128&d=identicon&r=PG&f=1", "display_name": "cam_cudi", "link": "https://stackoverflow.com/users/11726223/cam-cudi"}, "is_accepted": false, "score": 2, "last_activity_date": 1562080176, "creation_date": 1562080176, "answer_id": 56855433, "question_id": 56852845, "link": "https://stackoverflow.com/questions/56852845/environment-variables-in-erb-file/56855433#56855433", "title": "Environment variables in .erb file", "body": "<p>I got it. I just had to do:</p>\n\n<pre><code>'https://xxxxx.&lt;%= ENV['ENVHOST'] %&gt;.xxxxx.com/'\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11726223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9e8a621789ea596020faaf19a72c249?s=128&d=identicon&r=PG&f=1", "display_name": "cam_cudi", "link": "https://stackoverflow.com/users/11726223/cam-cudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1519, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562080176, "creation_date": 1562071628, "question_id": 56852845, "link": "https://stackoverflow.com/questions/56852845/environment-variables-in-erb-file", "title": "Environment variables in .erb file", "body": "<p>I am creating a dashboard with dashing. I have some environment variables I am using in my jobs .rb file. Whenever I try to use any environment variable in my dashboard .erb file it doesnt seem to work. I am trying to put the environment variable within a url. My environment variable is #{ENV['Variable']}. Any ideas how to get environment variables to work in .erb file?</p>\n\n<pre><code>&lt;script type='text/javascript'&gt;\n$(function() {\n  Dashing.widget_base_dimensions = [170, 170]\n  Dashing.numColumns = 10\n});\n&lt;/script&gt;\n\n&lt;% content_for :title do %&gt;xxxxxx&lt;% end %&gt;\n\n&lt;div class=\"gridster\"&gt;\n    &lt;ul&gt;\n        &lt;li data-row=\"2\" data-col=\"1\" data-sizex=\"3\" data-sizey=\"3\" onClick=\"javascript: window.open('https://xxxxxxx.#{ENV['Variable']}.xxxxxxx.com', '_blank');\"&gt;\n            &lt;div data-id=\"xxxxx\" data-view=\"xxxxx\" data-title=\"xxxxxxx\" data-descriptiontitle=\"xxxxxxx\" data-min=\"0\" data-max=\"100\"&gt;&lt;/div&gt;\n        &lt;/li&gt;\n\n    &lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby", "oop", "methods", "instance", "setter"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1562068418, "post_id": 56851738, "comment_id": 100253757, "body": "You indeed don&#39;t need them both at the same time. You might want to prefer one or the other because of readability (whichever expresses your intent better)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562083969, "post_id": 56851738, "comment_id": 100263048, "body": "Note that you could replace your definition of <code>rename</code> with <code>alias :rename :name=</code> (though as @Sergio says, there&#39;s no point in having both).  Whether you want to write <code>instance.name = ...</code> or <code>instance.rename(...)</code> is purely subjective. If <code>jedi = Skywalker.new(&#39;Anakin&#39;)</code>, <code>(jedi = &#39;Bob&#39;).upcase #=&gt; &quot;BOB&quot;</code> may look a little odd when compared to <code>jedi.rename(&#39;Bob&#39;).upcase #=&gt; &quot;BOB&quot;</code>, but both get the job done."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1562068308, "post_id": 56851802, "comment_id": 100253701, "body": "&quot;you let the caller to change object internals&quot; - not necessarily. It&#39;s just a method, same as <code>rename</code>. If one were to move storage of <code>@name</code> somewhere else, this public api doesn&#39;t need to go. I agree that <code>rename</code> probably conveys the intent slightly better, but is it worth the effort? It&#39;s up to OP to decide :)"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1562068444, "post_id": 56851802, "comment_id": 100253771, "body": "You&#39;re right, setter is just a metod. Still <code>rename</code> sounds better :)"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 1, "last_activity_date": 1562068146, "creation_date": 1562068146, "answer_id": 56851802, "question_id": 56851738, "link": "https://stackoverflow.com/questions/56851738/what-is-the-difference-between-an-instance-method-used-to-rename-an-object-and-a/56851802#56851802", "title": "What is the difference between an instance method used to rename an object and a setter method?", "body": "<p><code>#rename</code> hides the implementation details. You expose a clean and explicit interface - an object can be renamed, but the caller doesn't have to care how it's done. I would recommend to use <code>attr_reader :name</code> instead of <code>attr_accessor :name</code> to avoid exposing the setter.</p>\n\n<p>If you expose just <code>#name=</code> you let the caller to change object internals. It may cause the future changes harder (e.g. if you move <code>name</code> to a separate object).</p>\n"}], "owner": {"reputation": 45, "user_id": 7665522, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155166331713203/picture?type=large", "display_name": "Nathan Worden", "link": "https://stackoverflow.com/users/7665522/nathan-worden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56851802, "answer_count": 1, "score": 1, "last_activity_date": 1562068146, "creation_date": 1562067954, "question_id": 56851738, "link": "https://stackoverflow.com/questions/56851738/what-is-the-difference-between-an-instance-method-used-to-rename-an-object-and-a", "title": "What is the difference between an instance method used to rename an object and a setter method?", "body": "<p>If I want to rename my <code>jedi</code> object below, why would I create an instance method named <code>rename</code> that uses the setter method <code>name=</code>? Why not just use the setter method `name=' directly?</p>\n\n<p>Why do this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>     class Skywalker\n       attr_accessor :name\n\n       def initialize(name)\n         @name = name\n       end\n\n       def rename(new_name)\n         self.name = new_name\n       end\n     end\n\n     jedi = Skywalker.new('Anakin')\n     puts jedi.name\n     jedi.rename('Luke')\n     puts jedi.name\n</code></pre>\n\n<p>When you could just do this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>     class Skywalker\n       attr_accessor :name\n\n       def initialize(name)\n         @name = name\n       end\n     end\n\n     jedi = Skywalker.new('Anakin')\n     puts jedi.name\n     jedi.name = 'Luke'\n     puts jedi.name\n</code></pre>\n\n<p>Both code snippets above do the same thing, so I'm wondering if there is a situation where it would be useful to have the instance method <code>rename</code> in addition to the setter method <code>name=</code>. Because to me it looks like they are redundant.</p>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562068987, "post_id": 56851403, "comment_id": 100254076, "body": "&quot;:: is the constant separator while . is the method calling separator.&quot;  - Not quite. You can call methods with <code>::</code>. <code>Person::new</code>, <code>user::persisted?</code>, etc."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1562071261, "post_id": 56851403, "comment_id": 100255384, "body": "True but confusing since you have to make sure the method doesn&#39;t starts with a capital letter otherwise you need to use parenthesis to make sure it&#39;ll call the method. I&#39;d prefer always following this rubocop rule : <a href=\"https://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/ColonMethodCall\" rel=\"nofollow noreferrer\">rubydoc.info/gems/rubocop/RuboCop/Cop/Style/ColonMethodCall</a> (I&#39;ll try to rephrase my assertion)."}, {"owner": {"reputation": 481, "user_id": 9563947, "user_type": "registered", "profile_image": "https://graph.facebook.com/1677134499029007/picture?type=large", "display_name": "Shan", "link": "https://stackoverflow.com/users/9563947/shan"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562071620, "post_id": 56851403, "comment_id": 100255630, "body": "Adding to @SergioTulentsev <code>::</code> is a namespace resolution operator. It helps you to access items in modules, or class-level items in classes or Constants. it is used to provide namespaces so that method and class names don&#39;t conflict with other classes."}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": true, "score": 2, "last_activity_date": 1562071310, "last_edit_date": 1562071310, "creation_date": 1562066731, "answer_id": 56851403, "question_id": 56851303, "link": "https://stackoverflow.com/questions/56851303/access-public-method-vs-public-constant-ruby/56851403#56851403", "title": "Access public method vs public constant Ruby", "body": "<p>The syntax is different because you can do this :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Person\n  AGE = 18\n  def self.AGE\n    19\n  end\nend\n</code></pre>\n\n<p><code>Person::AGE</code> will return 18 because you're accessing a constant.<br>\n<code>Person.AGE</code> will return 19 because you're accessing a method.</p>\n\n<p>Basically, <code>::</code> is the constant separator while <code>.</code> is the method calling separator (when the following word starts with a capital letter and there's no parenthesis in the expression).</p>\n"}], "owner": {"reputation": 2181, "user_id": 5598574, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/aUJPQ.jpg?s=128&g=1", "display_name": "Hairi", "link": "https://stackoverflow.com/users/5598574/hairi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56851403, "answer_count": 1, "score": 1, "last_activity_date": 1562076419, "creation_date": 1562066369, "last_edit_date": 1562076419, "question_id": 56851303, "link": "https://stackoverflow.com/questions/56851303/access-public-method-vs-public-constant-ruby", "title": "Access public method vs public constant Ruby", "body": "<p>I am new to Ruby and I am still trying to understand the basics. For this I couldn't find information in the Internet. Imagine this example:</p>\n\n<pre><code>class Person\n\n  AGE = 18\n  def self.get_age\n    18\n  end\n\nend\n</code></pre>\n\n<p>From the console:</p>\n\n<blockquote>\n  <p>Person.get_age</p>\n</blockquote>\n\n<p><code>=&gt; 18</code></p>\n\n<blockquote>\n  <p>Person.AGE </p>\n</blockquote>\n\n<p><code>=&gt; NoMethodError: undefined method AGE' for Person:Class</code></p>\n\n<p>Why this difference in the syntax?</p>\n\n<p>Trying <code>Person::AGE</code> and <code>Person::get_age</code>, both yield the same:</p>\n\n<p><code>=&gt; 18</code> \nAs I expect. </p>\n"}, {"tags": ["arrays", "ruby", "include"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 0, "creation_date": 1562069698, "post_id": 56851282, "comment_id": 100254429, "body": "Thanks for this! Arrgh, so close. You&#39;re code is better than what I was trying to do though so that&#39;s one for the books."}], "tags": [], "owner": {"reputation": 27144, "user_id": 3857758, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/58c4295826435f049b7fc32b98c240f9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursus", "link": "https://stackoverflow.com/users/3857758/ursus"}, "is_accepted": true, "score": 1, "last_activity_date": 1562066890, "last_edit_date": 1562066890, "creation_date": 1562066292, "answer_id": 56851282, "question_id": 56851200, "link": "https://stackoverflow.com/questions/56851200/looking-for-a-string-and-returning-the-first-string-that-matches-a-set/56851282#56851282", "title": "Looking for a string and returning the first string that matches a set", "body": "<p>This expression</p>\n\n<pre><code>\"cheddar\" || \"gouda\" || \"camembert\"\n</code></pre>\n\n<p>always returns</p>\n\n<pre><code>\"cheddar\"\n</code></pre>\n\n<p>it's not what you want. You're probably looking for something like</p>\n\n<pre><code>def find_the_cheese(array)\n  cheese_types = [\"cheddar\", \"gouda\", \"camembert\"]\n  array.find { |a| cheese_types.include?(a) }\nend\n</code></pre>\n\n<p>What you wanted to write was probably</p>\n\n<pre><code>array.find { |a| a == \"cheddar\" || a == \"gouda\" || a == \"camembert\" }\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 56851282, "answer_count": 1, "score": 0, "last_activity_date": 1562066890, "creation_date": 1562066003, "question_id": 56851200, "link": "https://stackoverflow.com/questions/56851200/looking-for-a-string-and-returning-the-first-string-that-matches-a-set", "title": "Looking for a string and returning the first string that matches a set", "body": "<p>Poor title...need to think on how to reword it. Here is what I have to do:</p>\n\n<p>Create a find_the_cheese method that should accept an array of strings. It should then look through these strings to find and return the first string that is a type of cheese. The types of cheese that appear are \"cheddar\", \"gouda\", and \"camembert\".</p>\n\n<p>For example:</p>\n\n<pre><code>snacks = [\"crackers\", \"gouda\", \"thyme\"]\nfind_the_cheese(snacks)\n#=&gt; \"gouda\"\n\n\nsoup = [\"tomato soup\", \"cheddar\", \"oyster crackers\", \"gouda\"]\nfind_the_cheese(soup)\n#=&gt; \"cheddar\"\n</code></pre>\n\n<p>If, sadly, a list of ingredients does not include cheese, return nil:</p>\n\n<pre><code>ingredients = [\"garlic\", \"rosemary\", \"bread\"]\nfind_the_cheese(ingredients)\n#=&gt; nil\n</code></pre>\n\n<p>You can assume that all strings will be lowercase. Take a look at the .include method for a hint. This method asks you to return a string value instead of printing it so keep that in mind.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>def find_the_cheese(array)\n  cheese_types = [\"cheddar\", \"gouda\", \"camembert\"]\n  p array.find {|a| a == \"cheddar\" || \"gouda\" || \"camembert\"}\nend\n</code></pre>\n\n<p>The error I am getting looks like it is grabbing the first element in the array even though it's none of the cheeses...can someone explain what is going on here? Any help is much appreciated as always.</p>\n\n<p>These are the tests that will run through it:</p>\n\n<pre><code>  describe \"#find_the_cheese\" do\n    it \"returns the first element of the array that is cheese\" do\n      contains_cheddar = [\"banana\", \"cheddar\", \"sock\"]\n      expect(find_the_cheese(contains_cheddar)).to eq 'cheddar'\n\n      contains_gouda = [\"potato\", \"gouda\", \"camembert\"]\n      expect(find_the_cheese(contains_gouda)).to eq 'gouda'\n    end\n\n    it \"returns nil if the array does not contain a type of cheese\" do\n      no_cheese = [\"ham\", \"cellphone\", \"computer\"]\n      expect(find_the_cheese(no_cheese)).to eq nil\n    end\n  end\nend\n</code></pre>\n\n<p>Here is the error:</p>\n\n<pre><code>  1) Cartoon Collections #find_the_cheese returns the first element of the array that is cheese\n     Failure/Error: expect(find_the_cheese(contains_cheddar)).to eq 'cheddar'\n\n       expected: \"cheddar\"\n            got: \"banana\"\n\n       (compared using ==)\n     # ./spec/cartoon_collections_spec.rb:57:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1562065381, "post_id": 56850933, "comment_id": 100252158, "body": "What command are you using to run your server?"}, {"owner": {"reputation": 109, "user_id": 7789913, "user_type": "registered", "profile_image": "https://graph.facebook.com/1454793477904342/picture?type=large", "display_name": "Parakh Garg", "link": "https://stackoverflow.com/users/7789913/parakh-garg"}, "edited": false, "score": 0, "creation_date": 1562066121, "post_id": 56850933, "comment_id": 100252516, "body": "You are not in correct folder. Goto root folder of your application and then run the rails/rake command"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 1, "creation_date": 1562068026, "post_id": 56850933, "comment_id": 100253536, "body": "Please don&#39;t post picture of console output. Simply paste the text directly into your question. Pictures can be difficult to view on some devices and they make it impossible to copy and paste text into answers."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1562107639, "post_id": 56850933, "comment_id": 100271513, "body": "Welcome to Stack Overflow! Please see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and the linked pages and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">mcve</a>&quot;. Your question doesn&#39;t meet the guidelines for an acceptable question. We need more information, most likely some code and the problem description, all in your question, not linked to an image. Links to off-site resources age, rot, then break, resulting in a question that&#39;ll make no sense."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11664067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YOe41ShpUy4/AAAAAAAAAAI/AAAAAAAAABQ/DiX-DV3yhoU/photo.jpg?sz=128", "display_name": "Tushar Vaniya", "link": "https://stackoverflow.com/users/11664067/tushar-vaniya"}, "is_accepted": false, "score": -2, "last_activity_date": 1562067626, "creation_date": 1562067626, "answer_id": 56851633, "question_id": 56850933, "link": "https://stackoverflow.com/questions/56850933/how-yo-fix-port-issue-in-ruby-on-rails-port-is-not-working-on-3000-and-im-unabl/56851633#56851633", "title": "How yo fix port issue in ruby on rails. Port is not working on 3000 and im unable to select different port", "body": "<p>goto config/puma.rb  in you application, here you will find the port to change.</p>\n\n<pre><code> port ENV.fetch(\"PORT\") { 3000 }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11310700, "user_type": "registered", "profile_image": "https://graph.facebook.com/534110463662848/picture?type=large", "display_name": "Hamad Malik", "link": "https://stackoverflow.com/users/11310700/hamad-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1562067626, "creation_date": 1562065078, "question_id": 56850933, "link": "https://stackoverflow.com/questions/56850933/how-yo-fix-port-issue-in-ruby-on-rails-port-is-not-working-on-3000-and-im-unabl", "title": "How yo fix port issue in ruby on rails. Port is not working on 3000 and im unable to select different port", "body": "<p><a href=\"https://i.stack.imgur.com/YpW9x.png\" rel=\"nofollow noreferrer\">This is the output im getting whenever im trying to fix port or run the server or trying to run some command. Its not working on any port.</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ruby-on-rails-4.2", "ruby-2.3"], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4622, "user_id": 1924796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ba5a78c8c1b746e889a60b6e678b128e?s=128&d=identicon&r=PG", "display_name": "chobo", "link": "https://stackoverflow.com/users/1924796/chobo"}, "edited": false, "score": 0, "creation_date": 1562063837, "post_id": 56850549, "comment_id": 100251324, "body": "@chobo: it&#39;s trivial to look up and steal the implementation. Even writing one yourself should not be too hard :)"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 3, "last_activity_date": 1562063693, "creation_date": 1562063693, "answer_id": 56850549, "question_id": 56850312, "link": "https://stackoverflow.com/questions/56850312/time-current-tapt-t-change-hour-10-is-not-working-in-rails-4-2/56850549#56850549", "title": "Time.current.tap{|t| t.change hour: 10 } is not working in Rails 4.2", "body": "<p><code>change</code> returns a new time object, so this value is ignored by <code>tap</code>. You can use tap's brother, <code>yield_self</code> (ruby 2.5+)</p>\n\n<pre><code>t.yield_self{|tt| tt.change hour: 10 }\n</code></pre>\n"}], "owner": {"reputation": 4622, "user_id": 1924796, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ba5a78c8c1b746e889a60b6e678b128e?s=128&d=identicon&r=PG", "display_name": "chobo", "link": "https://stackoverflow.com/users/1924796/chobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562063693, "creation_date": 1562062960, "last_edit_date": 1562063462, "question_id": 56850312, "link": "https://stackoverflow.com/questions/56850312/time-current-tapt-t-change-hour-10-is-not-working-in-rails-4-2", "title": "Time.current.tap{|t| t.change hour: 10 } is not working in Rails 4.2", "body": "<p>I tried</p>\n\n<pre><code>[107] pry(main)&gt; t=Time.current\n=&gt; Tue, 02 Jul 2019 19:19:05 KST +09:00\n[108] pry(main)&gt; t.tap{|tt| tt.change hour: 10 }\n=&gt; Tue, 02 Jul 2019 19:19:05 KST +09:00\n[109] pry(main)&gt; t\n=&gt; Tue, 02 Jul 2019 19:19:05 KST +09:00\n</code></pre>\n\n<p>hour is not changed...</p>\n\n<p>I expect</p>\n\n<pre><code>[110] pry(main)&gt; t.tap{|tt| tt.change hour: 10 }\nTue, 02 Jul 2019 10:00:00 KST +09:00\n</code></pre>\n\n<p>Really I want</p>\n\n<pre><code>[111] pry(main)&gt; Time.current.tap{|t| t.change(hour: 10, min: t.min)}\nTue, 02 Jul 2019 10:19:00 KST +09:00\n</code></pre>\n"}, {"tags": ["ruby", "windows", "db2", "rubygems"], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 2407408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c511663323c8dd7c98783ddafd71166f?s=128&d=identicon&r=PG", "display_name": "dietapete", "link": "https://stackoverflow.com/users/2407408/dietapete"}, "edited": false, "score": 0, "creation_date": 1562146324, "post_id": 56856667, "comment_id": 100282948, "body": "Thank you very much for your suggestion. I will check the GitHub issue you mentioned and ask for help there if it doesn&#39;t work for me."}], "tags": [], "owner": {"reputation": 8474, "user_id": 8290634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d23c338d78a579b717f1cb6e9f16fb1b?s=128&d=identicon&r=PG&f=1", "display_name": "mao", "link": "https://stackoverflow.com/users/8290634/mao"}, "is_accepted": true, "score": 2, "last_activity_date": 1562085282, "last_edit_date": 1562085282, "creation_date": 1562084789, "answer_id": 56856667, "question_id": 56850201, "link": "https://stackoverflow.com/questions/56850201/how-to-fix-error-requiring-ibm-db-gem-on-windows/56856667#56856667", "title": "How to fix error requiring &#39;ibm_db&#39; gem on Windows", "body": "<p>Your question may be better suited to the Github <a href=\"https://github.com/ibmdb/ruby-ibmdb/issues\" rel=\"nofollow noreferrer\">issues</a> page for the ibm_db gem, because your question concerns configuration and does not concern either Ruby programming , or programming for Db2.</p>\n\n<p>In particular see: <a href=\"https://github.com/ibmdb/ruby-ibmdb/issues/83\" rel=\"nofollow noreferrer\">https://github.com/ibmdb/ruby-ibmdb/issues/83</a></p>\n\n<p>It appears that the ibm_db gem may not yet support your version of Ruby on your operating-system platform, but it may support an older version of Ruby.</p>\n"}], "owner": {"reputation": 38, "user_id": 2407408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c511663323c8dd7c98783ddafd71166f?s=128&d=identicon&r=PG", "display_name": "dietapete", "link": "https://stackoverflow.com/users/2407408/dietapete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 56856667, "answer_count": 1, "score": 0, "last_activity_date": 1562085282, "creation_date": 1562062595, "last_edit_date": 1562063584, "question_id": 56850201, "link": "https://stackoverflow.com/questions/56850201/how-to-fix-error-requiring-ibm-db-gem-on-windows", "title": "How to fix error requiring &#39;ibm_db&#39; gem on Windows", "body": "<p>I'm running Ruby 2.6.3p62 32-bit on Windows 10 64-bit. I installed it using the Ruby Installer. I successfully installed the gem 'ibm_db' without any errors. I downloaded the DB2-clidriver from <a href=\"http://public.dhe.ibm.com/ibmdl/export/pub/software/data/db2/drivers/odbc_cli/nt32_odbc_cli.zip\" rel=\"nofollow noreferrer\">http://public.dhe.ibm.com/ibmdl/export/pub/software/data/db2/drivers/odbc_cli/nt32_odbc_cli.zip</a>, unzipped it an set the environment variable IBM_DB_HOME to its location. In addition, I added IBM_DB_HOME\\bin to the PATH variable. When requiring the ibm_db I get the following error:</p>\n\n<pre><code>C:\\Users\\myuser\\Programs\\Ruby26\\bin&gt;ruby -e \"require 'ibm_db'\"\nTraceback (most recent call last):\n        2: from -e:1:in `&lt;main&gt;'\n        1: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\nC:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- ibm_db (LoadError)\n        9: from -e:1:in `&lt;main&gt;'\n        8: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\n        7: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\n        6: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\n        5: from C:/Users/myuser/Programs/Ruby26/lib/ruby/gems/2.6.0/gems/ibm_db-4.0.0-x86-mingw32/lib/ibm_db.rb:21:in `&lt;top (required)&gt;'\n        4: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        3: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        2: from C:/Users/myuser/Programs/Ruby26/lib/ruby/gems/2.6.0/gems/ibm_db-4.0.0-x86-mingw32/lib/mswin32/ibm_db.rb:90:in `&lt;top (required)&gt;'\n        1: from C:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\nC:/Users/myuser/Programs/Ruby26/lib/ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': 126: The specified module could not be found.   - C:/Users/myuser/Programs/Ruby26/lib/ruby/gems/2.6.0/gems/ibm_db-4.0.0-x86-mingw32/lib/mswin32/rb2x/i386/ibm_db.so (LoadError)\n</code></pre>\n\n<p>The file mentioned in the last line </p>\n\n<pre><code>C:/Users/myuser/Programs/Ruby26/lib/ruby/gems/2.6.0/gems/ibm_db-4.0.0-x86-mingw32/lib/mswin32/rb2x/i386/ibm_db.so\n</code></pre>\n\n<p>does exist.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sphinx", "thinking-sphinx"], "comments": [{"owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1562063655, "post_id": 56849821, "comment_id": 100251232, "body": "How exactly do you want your search to function? If you put in two words do you want both to be matched or just one?"}, {"owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "reply_to_user": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "edited": false, "score": 0, "creation_date": 1562063777, "post_id": 56849821, "comment_id": 100251291, "body": "@Mark yes i want both to be matched . the problem is when I add the second word the result match only the second word"}, {"owner": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1562068109, "post_id": 56849821, "comment_id": 100253577, "body": "Is <code>name</code> the only field you have? Or does your Form index have other fields involved? Also: which versions of Sphinx and Thinking Sphinx are you using?"}, {"owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "reply_to_user": {"reputation": 15586, "user_id": 54500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gg5v8.jpg?s=128&g=1", "display_name": "pat", "link": "https://stackoverflow.com/users/54500/pat"}, "edited": false, "score": 0, "creation_date": 1562068208, "post_id": 56849821, "comment_id": 100253642, "body": "Hello @pat I resolve the problem by add  ^ and * and remove stars <code>ruby ThinkingSphinx.search(&#39;^&#39; + params[:term] + &#39;*&#39;, options) </code>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "edited": false, "score": 0, "creation_date": 1562064765, "post_id": 56850728, "comment_id": 100251833, "body": "it&#39;s bad solution where is the sphinx seach ?"}], "tags": [], "owner": {"reputation": 5312, "user_id": 6535997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10156345016155058/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/6535997/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1562064326, "creation_date": 1562064326, "answer_id": 56850728, "question_id": 56849821, "link": "https://stackoverflow.com/questions/56849821/autocomplete-with-thinking-sphinx/56850728#56850728", "title": "autocomplete with thinking sphinx", "body": "<p>Try:</p>\n\n<pre><code>search_terms = params[:term].split(' ')\n@suggestions = []\nForm.all.each do |instance|\n  next unless (search_terms - instance.name.join(' ')).empty?\n  @suggestions &lt;&lt; instance\nend\n</code></pre>\n\n<p>This will create an array of search terms, and an array of words your form instance has for names. It then checks if every element in the search_terms array is present in the array of words present in the form's name, and adds it to <code>@suggestions</code> if every word is present.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "is_accepted": true, "score": 0, "last_activity_date": 1562068333, "creation_date": 1562068333, "answer_id": 56851864, "question_id": 56849821, "link": "https://stackoverflow.com/questions/56849821/autocomplete-with-thinking-sphinx/56851864#56851864", "title": "autocomplete with thinking sphinx", "body": "<p>I get the best result by adding ^ and * to </p>\n\n<pre><code>ThinkingSphinx.search('^' + params[:term] + '*', options)\n</code></pre>\n\n<p>and it's ok</p>\n"}], "owner": {"reputation": 61, "user_id": 9489957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMfyE.jpg?s=128&g=1", "display_name": "ramzieus", "link": "https://stackoverflow.com/users/9489957/ramzieus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 56851864, "answer_count": 2, "score": 0, "last_activity_date": 1562068333, "creation_date": 1562061287, "last_edit_date": 1562062755, "question_id": 56849821, "link": "https://stackoverflow.com/questions/56849821/autocomplete-with-thinking-sphinx", "title": "autocomplete with thinking sphinx", "body": "<p>when I search for the second word the result mismatch \nfor example 'web '\nthe result </p>\n\n<pre><code>[\"WEB MEDIA \",\"CREATIV WEB \",\"WEB SERVICES TECHNOLOGIES\",\"iDURAR WEB AGENCY\",\"WEB CREATION\",\"DEV WEB SOLUTION\",\"BIG WEB DZ\",\"AMANA SITE WEB\"]\n</code></pre>\n\n<p>but for 'web m'\nthe result </p>\n\n<pre><code>[\"VOISINAGE PC\",\"DELTA SOFT\",\"MMCOMPUTING ETS\",\"MICROPROZ\",\"PORTIDEE\",\"LATICODE\",\"CYBER WEB SERVICES\",\"SIEGE SOCIAL\",\"EL DALIL YALAOUI ET CIE - SIEGE COMMERCIAL\"\"IMA\"]\n</code></pre>\n\n<p>iI try all examples in the internet</p>\n\n<pre><code>ruby\n@suggestions = Form.search(params[:term]).map{ |x| x[:name]}\n</code></pre>\n\n<p>SELECT * FROM <code>form_core</code> WHERE MATCH('web m') AND <code>sphinx_deleted</code> = 0 LIMIT 0, 20\n  Sphinx  Found 23 results</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562059033, "post_id": 56849058, "comment_id": 100248811, "body": "&quot;How do I fix all of the upgrade deprecations and errors?&quot; is a very broad topic, and unsuitable for StackOverflow. Start by going through the official upgrade guide, and feel free to ask a <b>specific</b> question on StackOverflow if you get stuck."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562059094, "post_id": 56849058, "comment_id": 100248837, "body": "As for the question: &quot;How do I upgrade rails?&quot;, I would suggest starting by updating the line in your <code>Gemfile</code> to: <code>gem &#39;rails&#39;, &#39;~&gt; 5.0.0&#39;</code> and then run <code>bundle update rails</code>."}, {"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562059670, "post_id": 56849058, "comment_id": 100249153, "body": "@TomLord ERROR:  While executing gem ... (Gem::CommandLineError)     Unknown command rails,"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562063647, "post_id": 56849058, "comment_id": 100251227, "body": "I didn&#39;t say to run <code>gem &#39;rails&#39;, &#39;~&gt; 5.0.0&#39;</code> in the console. I said to write that line <i>in the <code>Gemfile</code></i>. In your project, there is a file called <code>Gemfile</code>. Open it, find the line that mentions <code>rails</code>, and change it like I showed above."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1562059611, "post_id": 56849152, "comment_id": 100249113, "body": "ERROR:  While executing gem ... (Gem::CommandLineError)     Unknown command upgrade"}, {"owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "reply_to_user": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1562060297, "post_id": 56849152, "comment_id": 100249456, "body": "@HackeXe Specify the desired version in your Gemfile (e.g. gem &#39;rails&#39;, &#39;~&gt; 5&#39; ) &amp;  try <code>rails app:update</code>"}, {"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1562061218, "post_id": 56849152, "comment_id": 100249986, "body": "``` Bundler could not find compatible versions for gem &quot;rails&quot;:   In Gemfile:     rails (= 5.0.2)      leaflet-rails was resolved to 1.5.1, which depends on       rails (&gt;= 4.2.0)      react-rails (~&gt; 1.6.0) was resolved to 1.6.2, which depends on       rails (&gt;= 3.2)      spork-rails was resolved to 4.0.0, which depends on       rails (&gt;= 3.0.0, &lt; 5) ```"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1562063713, "post_id": 56849152, "comment_id": 100251255, "body": "The error message tells you exactly what the problem is. Your version of <code>spork-rails</code> is incompatible with rails 5. So you&#39;ll need to update that library too, in order to upgrade rails."}, {"owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562064043, "post_id": 56849152, "comment_id": 100251434, "body": "@TomLord The fact is that I updated it to 4.0.0. When I do a bundle update, it tells me that it is version 4.0.0. When I change the version of rails ~&gt; 5.0.0 it gives me an error that the version is not compatible"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "edited": false, "score": 0, "creation_date": 1562068762, "post_id": 56849152, "comment_id": 100253947, "body": "@HackeXe The error message states: <b>spork-rails was resolved to 4.0.0, which depends on rails (&gt;= 3.0.0, &lt; 5)</b>. You cannot use spork-rails 4.0.0 with rails 5. You need to upgrade it further."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1562068905, "post_id": 56849152, "comment_id": 100254027, "body": "In fact, I just looked for you -- it seems this is an old abandoned project. Even the <a href=\"https://github.com/sporkrb/spork-rails/blob/0dd45e59d3237b4c8f9efc215b46d9c07072a95e/spork-rails.gemspec#L27\" rel=\"nofollow noreferrer\">latest version</a> is not marked as compatible with rails 5. There has been an <a href=\"https://github.com/sporkrb/spork-rails/issues/28\" rel=\"nofollow noreferrer\">open issue for 3 years</a> about it. So unfortunately, it seems you&#39;ll either need to add compatibility yourself, or find an open-source fork of the project that&#39;s done this already, or update the code to not use the gem."}], "tags": [], "owner": {"reputation": 5060, "user_id": 10522579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GQ6a.jpg?s=128&g=1", "display_name": "ray", "link": "https://stackoverflow.com/users/10522579/ray"}, "is_accepted": false, "score": 1, "last_activity_date": 1562060611, "last_edit_date": 1562060611, "creation_date": 1562059063, "answer_id": 56849152, "question_id": 56849058, "link": "https://stackoverflow.com/questions/56849058/i-can-not-update-ruby-on-rails/56849152#56849152", "title": "I can not update Ruby on Rails", "body": "<p><strong>Rails-4</strong> prefers Ruby 2.0 and requires 1.9.3 or newer. <strong>Rails-5</strong> requires Ruby 2.2.2 or newer.</p>\n\n<p>Your Rails version is quite old, upgrade it with,</p>\n\n<pre><code>gem upgrade rails\n</code></pre>\n\n<p>If you already have a Rails project you should, </p>\n\n<ol>\n<li>Specify the desired version in your Gemfile</li>\n<li>Run <code>bundle install</code> / <code>bundle update</code></li>\n<li>Run <code>rails app:update</code></li>\n</ol>\n\n<p>better you follow <a href=\"http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html\" rel=\"nofollow noreferrer\">this</a></p>\n"}], "owner": {"reputation": 3, "user_id": 11409130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4efa20d865ec6e65632f4711d6a320f6?s=128&d=identicon&r=PG&f=1", "display_name": "HackeXe", "link": "https://stackoverflow.com/users/11409130/hackexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562060611, "creation_date": 1562058785, "question_id": 56849058, "link": "https://stackoverflow.com/questions/56849058/i-can-not-update-ruby-on-rails", "title": "I can not update Ruby on Rails", "body": "<pre class=\"lang-rb prettyprint-override\"><code>rails c\n/home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/railties-5.2.3/lib/rails/app_loader.rb:53: warning: Insecure world writable dir /home/dayanov-sa in PATH, mode 040777\n/home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Bignum is deprecated\n/home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:121: warning: constant ::Fixnum is deprecated\n/home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:124:in `block (2 levels) in &lt;class:Numeric&gt;': stack level too deep (SystemStackError)\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/activesupport-4.2.0/lib/active_support/core_ext/numeric/conversions.rb:131:in `block (2 levels) in &lt;class:Numeric&gt;'\n         ... 4099 levels...\n        from /home/dayanov-sa/.rvm/gems/ruby-2.4.4/gems/spring-2.1.0/lib/spring/application/boot.rb:19:in `&lt;top (required)&gt;'\n        from /home/dayanov-sa/.rvm/rubies/ruby-2.4.4/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n        from /home/dayanov-sa/.rvm/rubies/ruby-2.4.4/lib/ruby/site_ruby/2.4.0/rubygems/core_ext/kernel_require.rb:54:in `require'\n</code></pre>\n\n<p>I tried to update via:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>bundle update rails\ngem install rails -v 5.0.2\ngem update rails\n</code></pre>\n\n<pre><code>Rails 4.2.0 version\nruby 2.4.4p296 (2018-03-28 revision 63013) [x86_64-linux]\n</code></pre>\n\n<p>I get a lot of errors when running rails. I looked on the Internet that I need to upgrade, but without success</p>\n"}, {"tags": ["ruby", "avro"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562057522, "post_id": 56848460, "comment_id": 100247984, "body": "There is this keyword now in current master, but is it there in the version <i>you&#39;re using</i>? Crack it open with <code>bundle open avro_turf</code> and see."}, {"owner": {"reputation": 133, "user_id": 4967523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f8e8147434bc8dfca6dba4f3d1752e?s=128&d=identicon&r=PG&f=1", "display_name": "Phu Sanh", "link": "https://stackoverflow.com/users/4967523/phu-sanh"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1562060117, "post_id": 56848460, "comment_id": 100249365, "body": "you&#39;re right, there is no &quot;version&quot; param in the version I am using. But I install the latest version 0.8.1, why it is different from the one on github. I removed &quot;version&quot; param from my code and got another error &quot;undefined method `include?&#39; for nil:NilClass&quot;"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562060230, "post_id": 56848460, "comment_id": 100249423, "body": "What you&#39;re seeing on github is current state of development. May include not-yet-released changes (as we&#39;re seeing here). Here&#39;s code for <a href=\"https://github.com/dasch/avro_turf/blob/v0.8.1/lib/avro_turf/messaging.rb\" rel=\"nofollow noreferrer\">v0.8.1</a>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562060396, "post_id": 56848460, "comment_id": 100249513, "body": "You can use the latest and greatest by using the gem like this: <code>gem &quot;avro_turf&quot;, github: &quot;dasch&#47;avro_turf&quot;</code>. Beware of instability and bugs."}, {"owner": {"reputation": 133, "user_id": 4967523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f8e8147434bc8dfca6dba4f3d1752e?s=128&d=identicon&r=PG&f=1", "display_name": "Phu Sanh", "link": "https://stackoverflow.com/users/4967523/phu-sanh"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1562060699, "post_id": 56848460, "comment_id": 100249691, "body": "Thank you for your suggestion and advice, I will consider it. Thanks a lot"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1562062623, "post_id": 56848460, "comment_id": 100250696, "body": "I&#39;m going to post an answer, to earn some internet points :)"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1562062752, "creation_date": 1562062752, "answer_id": 56850250, "question_id": 56848460, "link": "https://stackoverflow.com/questions/56848460/got-error-unknown-keyword-version-when-encode-data-using-ruby-gem-avro-turf-w/56850250#56850250", "title": "Got error &quot;unknown keyword: version&quot; when encode data using ruby gem avro turf with schema registry", "body": "<blockquote>\n  <p>I scan its source code, there is a \"version\" param in encode function.</p>\n</blockquote>\n\n<p>Yes, the problem is, you're looking at the current state of <code>master</code> branch. As of now, it contains unreleased changes, this keyword included.</p>\n\n<p>So either wait for next version to be released, or use master directly</p>\n\n<pre><code>gem \"avro_turf\", github: \"dasch/avro_turf\"\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4967523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f8e8147434bc8dfca6dba4f3d1752e?s=128&d=identicon&r=PG&f=1", "display_name": "Phu Sanh", "link": "https://stackoverflow.com/users/4967523/phu-sanh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56850250, "answer_count": 1, "score": 0, "last_activity_date": 1562062752, "creation_date": 1562056618, "last_edit_date": 1562057303, "question_id": 56848460, "link": "https://stackoverflow.com/questions/56848460/got-error-unknown-keyword-version-when-encode-data-using-ruby-gem-avro-turf-w", "title": "Got error &quot;unknown keyword: version&quot; when encode data using ruby gem avro turf with schema registry", "body": "<p>I have used Ruby gem <code>avro_turf</code> to convert data to binary and publish it to Kafka. But I got an error <code>unknown keyword: version</code> when try to encode data.\nI have started Confluent Schema Registry on <code>localhost:8081</code>. I can create and read subject on terminal.</p>\n\n<p>I scan its <a href=\"https://github.com/dasch/avro_turf/blob/master/lib/avro_turf/messaging.rb\" rel=\"nofollow noreferrer\">source code</a>, there is a \"version\" param in encode function.</p>\n\n<p>I curl <code>curl -X GET http://127.0.0.1:8081/subjects/avro-test/versions/1</code> to Schema Registry and get this data</p>\n\n<pre><code>{\"subject\":\"avro-test\",\"version\":1,\"id\":1,\"schema\":\"{\\\"type\\\":\\\"record\\\",\\\"name\\\":\\\"evolution\\\",\\\"namespace\\\":\\\"com.landoop\\\",\\\"doc\\\":\\\"This is a sample Avro schema to get you started. Please edit\\\",\\\"fields\\\":[{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"phone\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"email\\\",\\\"type\\\":\\\"string\\\"}]}\"}\n</code></pre>\n\n<p>This is my current code</p>\n\n<pre><code>require \"avro_turf/messaging\"\n\navro = AvroTurf::Messaging.new(registry_url: \"http://localhost:8081/\")\n\ndata = avro.encode('{ \"name\" =&gt; \"hello, world\", \"phone\": \"01232323\", \"email\": \"hello@gmail.com\" }', subject: 'avro-test', version: 1)\n</code></pre>\n\n<p>Please help me for solution.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "datetime", "rubygems", "decorator"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562049806, "post_id": 56844902, "comment_id": 100244179, "body": "You have <code>%Y&#47;%m&#47;%m</code> in your example code, you probably want <code>%Y&#47;%m&#47;%d</code>"}, {"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562053467, "post_id": 56844902, "comment_id": 100245960, "body": "Nice catch! Thanks I updated!"}], "answers": [{"comments": [{"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1562039970, "post_id": 56845036, "comment_id": 100241454, "body": "Wow thanks for your detailed answer! Lemme digest it!"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "reply_to_user": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1562041391, "post_id": 56845036, "comment_id": 100241735, "body": "Sure thing. I&#39;ve never seen this gem before, and rolled my own a while back using SimpleDelegator. Maybe I&#39;ll poke around this one now that you&#39;ve pointed it out."}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": false, "score": 5, "last_activity_date": 1562071062, "last_edit_date": 1562071062, "creation_date": 1562039037, "answer_id": 56845036, "question_id": 56844902, "link": "https://stackoverflow.com/questions/56844902/write-active-decorator-dry/56845036#56845036", "title": "Write active decorator DRY", "body": "<p>I don't use <code>active_decorator</code>, but I think I would be tempted to create a <code>DatetimeDecorator</code>, something like:</p>\n\n<pre><code>module DatetimeDecorator\n\n  %i(\n    created_at\n    confirmed_at\n    locked_at\n    current_sign_in_at\n    last_sign_in_at\n  ).each do |attr_sym|\n    define_method(\"#{attr_sym}_datetime\") do \n      send(attr_sym)&amp;.strftime '%Y/%m/%m %H:%M:%S'\n    end\n  end\n\nend\n</code></pre>\n\n<p>Whenever you include this module, you'll get the five methods you previously defined in <code>UserDecorator</code> each of which uses the same formatting code.</p>\n\n<p>Now, to get that module included, use the <code>included</code> hook. Something like: </p>\n\n<pre><code>module UserDecorator\n\n  self.included(base)\n    base.class_eval do \n      include DatetimeDecorator\n    end\n  end\n\nend\n\nmodule AdminDecorator\n\n  self.included(base)\n    base.class_eval do \n      include DatetimeDecorator\n    end\n  end\n\nend\n</code></pre>\n\n<p>Now your <code>UserDecorator</code> and your <code>AdminDecorator</code> both have the five methods you previously defined in <code>UserDecorator</code>. </p>\n\n<p>This is untested, so you might need to fiddle with it a bit. </p>\n"}, {"tags": [], "owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "is_accepted": false, "score": 1, "last_activity_date": 1562049349, "creation_date": 1562049349, "answer_id": 56846623, "question_id": 56844902, "link": "https://stackoverflow.com/questions/56844902/write-active-decorator-dry/56846623#56846623", "title": "Write active decorator DRY", "body": "<p>I could use some meta code like these but I can't solve the exact same fields at <code>AdminDecorator</code>. Which mean I still have to copy paste below function to <code>AdminDecorator</code>:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module UserDecorator\n  DATETIME_DECORATOR_FIELDS = %w[created_at confirmed_at locked_at current_sign_in last_sign_in_at].freeze\n\n  DATETIME_DECORATOR_FIELDS.each do |field|\n    define_method(\"#{field}_datetime\") do |format = nil|\n      return send(field)&amp;.strftime(format) if format\n\n      send(field)&amp;.strftime '%Y/%m/%m %H:%M:%S'\n    end\n  end\nend\n</code></pre>\n\n<p>This will create method accept params format or not:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>User.first.created_at_datetime #=&gt; \"2019/06/06 16:18:02\"\n\nUser.first.created_at_datetime \"%Y/%m/%m\" #=&gt; \"2019/06/06\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1562055145, "post_id": 56846717, "comment_id": 100246741, "body": "Since you mention about <code>ActiveSupoprt::Concern</code>, can you said abit more about it? Thanks!"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 1, "creation_date": 1562056207, "post_id": 56846717, "comment_id": 100247297, "body": "@truongnm it makes adding class methods and instance methods from other modules a bit easier. Following the conventions, you can simply <code>include YourMixin</code> (as opposed to <code>include ThisModule</code> and <code>extend ThatModule</code>) and it will handle the rest. Just check out the <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Concern.html\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1562147344, "post_id": 56846717, "comment_id": 100283499, "body": "What do you think if we use <code>method_missing</code>?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "edited": false, "score": 0, "creation_date": 1562222354, "post_id": 56846717, "comment_id": 100311738, "body": "@truongnm <code>method_missing</code> comes with some processing overhead. For a fixed (or small) number of methods, I prefer generating them. It also allows you to enumerate the methods (as shown in the example) and to use auto completion in IRB."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1562050295, "last_edit_date": 1562050295, "creation_date": 1562049788, "answer_id": 56846717, "question_id": 56844902, "link": "https://stackoverflow.com/questions/56844902/write-active-decorator-dry/56846717#56846717", "title": "Write active decorator DRY", "body": "<p>This is quite similar to <a href=\"https://stackoverflow.com/a/56845036/477037\">jvillian's answer</a> and <a href=\"https://stackoverflow.com/a/56846623/477037\">truongnm's answer</a>.</p>\n\n<p>I usually write little DSL methods to add repeating methods, something like this:</p>\n\n<pre><code>module DateFormatter\n  DEFAULT_FORMAT = '%Y/%m/%d %H:%M:%S'\n\n  def add_formatter(attribute, format: DEFAULT_FORMAT)\n    define_method(\"#{attribute}_datetime\") do\n      public_send(attribute)&amp;.strftime(format)\n    end\n  end\nend\n</code></pre>\n\n<p><code>add_formatter</code> is a class method that defines an instance method based on the given arguments. Having <code>format</code> as an optional argument is just an example.</p>\n\n<p>As a class method, <code>add_format</code> can be called right inside the class body like this:</p>\n\n<pre><code>module UserDecorator\n  extend DateFormatter\n\n  add_formatter :created_at\n  add_formatter :confirmed_at, format: '%A %-d, %Y'\n  add_formatter :locked_at\n  add_formatter :current_sign_in_at\n  add_formatter :last_sign_in_at\nend\n</code></pre>\n\n<p>The <code>UserDecorator</code> module ends up having various new method:</p>\n\n<pre><code>UserDecorator.instance_methods\n#=&gt; [\n#     :confirmed_at_datetime,\n#     :locked_at_datetime,\n#     :current_sign_in_at_datetime,\n#     :last_sign_in_at_datetime,\n#     :created_at_datetime\n#   ]\n</code></pre>\n\n<p>They can be called as usual:</p>\n\n<pre><code>class TestUser\n  include UserDecorator\n\n  def created_at\n    Time.new(2019, 7, 2, 11, 53)\n  end\n\n  def confirmed_at\n    Time.new(2019, 7, 2, 11, 53)\n  end\nend\n\nu = TestUser.new\nu.created_at_datetime\n#=&gt; \"2019/07/02 11:53:00\"\n\nu.confirmed_at_datetime\n#=&gt; \"Tuesday 2, 2019\"\n</code></pre>\n\n<p>Since you are using Rails, you might want to incorporate its <a href=\"https://api.rubyonrails.org/classes/ActiveSupport/Concern.html\" rel=\"nofollow noreferrer\"><code>ActiveSupport::Concern</code></a> pattern.</p>\n"}], "owner": {"reputation": 1928, "user_id": 3280050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0f86ec29ab3a8f7f841f471d582a933?s=128&d=identicon&r=PG", "display_name": "truongnm", "link": "https://stackoverflow.com/users/3280050/truongnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1562071062, "creation_date": 1562037843, "last_edit_date": 1562053453, "question_id": 56844902, "link": "https://stackoverflow.com/questions/56844902/write-active-decorator-dry", "title": "Write active decorator DRY", "body": "<p>I'm using ActiveDecorator: <a href=\"https://github.com/amatsuda/active_decorator\" rel=\"nofollow noreferrer\">https://github.com/amatsuda/active_decorator</a></p>\n\n<p>On writing my <code>UserDecorator</code>, I find it overlap a lot. Just decorate the <code>datetime</code> but I have to repeat writing decorator a lot.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># frozen_string_literal: true\n\nmodule UserDecorator\n  def created_at_datetime\n    created_at&amp;.strftime '%Y/%m/%d %H:%M:%S'\n  end\n\n  def confirmed_at_datetime\n    confirmed_at&amp;.strftime '%Y/%m/%d %H:%M:%S'\n  end\n\n  def locked_at_datetime\n    locked_at&amp;.strftime '%Y/%m/%d %H:%M:%S'\n  end\n\n  def current_sign_in_at_datetime\n    current_sign_in_at&amp;.strftime '%Y/%m/%d %H:%M:%S'\n  end\n\n  def last_sign_in_at_datetime\n    last_sign_in_at&amp;.strftime '%Y/%m/%d %H:%M:%S'\n  end\nend\n</code></pre>\n\n<p>And guess what, on my <code>AdminDecorator</code> I have the exact same fields. Do I have to copy all of these again to AdminDecorator?\nAny advice guys?</p>\n\n<p>Ref: <a href=\"https://github.com/amatsuda/active_decorator/issues/104\" rel=\"nofollow noreferrer\">https://github.com/amatsuda/active_decorator/issues/104</a></p>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562063437, "post_id": 56844571, "comment_id": 100251121, "body": "I think you have no other choice than splitting. It&#39;ll also be a bit better to know which attribute return what kind of value because list of type &amp; list of attribute aren&#39;t always  perfectly aligned."}], "answers": [{"tags": [], "owner": {"reputation": 6973, "user_id": 98634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb923c57a1fdc3a2eb484bb8d565fd2?s=128&d=identicon&r=PG", "display_name": "paracycle", "link": "https://stackoverflow.com/users/98634/paracycle"}, "is_accepted": true, "score": 1, "last_activity_date": 1562078614, "creation_date": 1562078614, "answer_id": 56854970, "question_id": 56844571, "link": "https://stackoverflow.com/questions/56844571/adding-sorbet-type-signatures-to-attr-reader-attr-writer-with-multiple-variables/56854970#56854970", "title": "Adding Sorbet type signatures to attr_reader/attr_writer with multiple variables", "body": "<p>Yes, the only option is to split up your attribute declarations, just like how you would have done if you were defining separate getter/setter methods for them, unless all your attributes are of the same type.</p>\n\n<p>The reason for this is that Sorbet, in the DSL phase of its operation, actually uses the <code>sig</code> on an <code>attr_reader</code>/<code>attr_writer</code>/<code>attr_accessor</code> declaration to define the <code>sig</code> on the synthetic methods that are produced by those declarations. Thus, a single getter for <code>attr_reader</code>, a single setter for <code>attr_writer</code> and a getter/setter pair for <code>attr_accessor</code> are generated synthetically and the <code>sig</code>s are applied to them.</p>\n\n<p>As a result of this, <a href=\"https://sorbet.run/#%23%20typed%3A%20true%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7B%20returns(String)%20%7D%0A%20%20attr_reader%20%3Asome_string_attr%2C%20%3Aother_string_attr%0Aend%0A%0Adef%20main%0A%20%20T.reveal_type(A.new.some_string_attr)%0A%20%20T.reveal_type(A.new.other_string_attr)%0Aend\" rel=\"nofollow noreferrer\">this would be valid</a>:</p>\n\n<pre><code>sig { returns(String) }\nattr_reader :some_string_attr, :other_string_attr\n</code></pre>\n\n<p>but this would not be:</p>\n\n<pre><code>sig { returns(String, User) }\nattr_reader :some_string_attr, :some_user_attr\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 56854970, "answer_count": 1, "score": 1, "last_activity_date": 1562078614, "creation_date": 1562034659, "question_id": 56844571, "link": "https://stackoverflow.com/questions/56844571/adding-sorbet-type-signatures-to-attr-reader-attr-writer-with-multiple-variables", "title": "Adding Sorbet type signatures to attr_reader/attr_writer with multiple variables", "body": "<p>I have an <code>attr_reader</code> that provides more than one variable, like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>attr_reader :user, :series\n</code></pre>\n\n<p>I want to add a type signature to it, but Sorbet doesn't support multiple return types,</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>sig { returns(User, Series) }\nattr_reader :user, :series\n</code></pre>\n\n<p>Is the only option to split them up like so?:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>sig { returns(User) }\nattr_reader :user\nsig { returns(Series) }\nattr_reader :series\n</code></pre>\n"}, {"tags": ["ruby", "rubygems", "jekyll", "homebrew"], "comments": [{"owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1562059645, "post_id": 56844252, "comment_id": 100249136, "body": "Have you tried in a new shell window?"}, {"owner": {"reputation": 55, "user_id": 10830268, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGiXeAd-s6I/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXa6lgj80W3mDtueSrgWyX1AuAjg/mo/photo.jpg?sz=128", "display_name": "Tony Hoan Trinh", "link": "https://stackoverflow.com/users/10830268/tony-hoan-trinh"}, "reply_to_user": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1562110643, "post_id": 56844252, "comment_id": 100272105, "body": "Yes I closed my terminal. Force quitted and then reopened and ran the same commands to no avail. :("}, {"owner": {"reputation": 55, "user_id": 10830268, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGiXeAd-s6I/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXa6lgj80W3mDtueSrgWyX1AuAjg/mo/photo.jpg?sz=128", "display_name": "Tony Hoan Trinh", "link": "https://stackoverflow.com/users/10830268/tony-hoan-trinh"}, "reply_to_user": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1562112565, "post_id": 56844252, "comment_id": 100272423, "body": "Okay so I think I located my error. I have multiple shell paths that are causing problems. Do you know how to remove specific shell path in the gem env?"}, {"owner": {"reputation": 55, "user_id": 10830268, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGiXeAd-s6I/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXa6lgj80W3mDtueSrgWyX1AuAjg/mo/photo.jpg?sz=128", "display_name": "Tony Hoan Trinh", "link": "https://stackoverflow.com/users/10830268/tony-hoan-trinh"}, "reply_to_user": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1562113549, "post_id": 56844252, "comment_id": 100272560, "body": "I wish to change the USER INSTALLATION DIRECTORY from /Users/quochoantrinh/.gem/ruby/2.6.0 tp /Users/quochoantrinh/.gem/ruby/2.6.3."}, {"owner": {"reputation": 14471, "user_id": 735926, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6b5fa39f5bc4b397eb7e55766eecd8c4?s=128&d=identicon&r=PG", "display_name": "bfontaine", "link": "https://stackoverflow.com/users/735926/bfontaine"}, "edited": false, "score": 0, "creation_date": 1562143791, "post_id": 56844252, "comment_id": 100281457, "body": "I don\u2019t know how to do that :/"}], "answers": [{"tags": [], "owner": {"reputation": 4815, "user_id": 928191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-vdq7KZueF-4/AAAAAAAAAAI/AAAAAAAAAQg/qpGTedu5fXE/photo.jpg?sz=128", "display_name": "monfresh", "link": "https://stackoverflow.com/users/928191/monfresh"}, "is_accepted": false, "score": 0, "last_activity_date": 1607232962, "last_edit_date": 1607232962, "creation_date": 1607146246, "answer_id": 65154097, "question_id": 56844252, "link": "https://stackoverflow.com/questions/56844252/jekyll-command-not-found-problem-despite-installated-with-most-recent-versions/65154097#65154097", "title": "Jekyll: command not found problem despite installated with most recent versions", "body": "<p>There are a few things going on here, but to fix your immediate problem, I believe this should do it:</p>\n<pre><code>export PATH=&quot;$HOME/.gem/ruby/2.6.0/bin:$PATH&quot;\n</code></pre>\n<p>When you use the <code>--user-install</code> flag, it installs gems in the <code>USER_INSTALLATION_DIRECTORY</code> that's mentioned when you run <code>gem env</code>, which in your case is <code>/Users/quochoantrinh/.gem/ruby/2.6.0</code>, and then you have to add <code>/bin</code> when you add it to the <code>PATH</code>. It's not so much that you want to change the <code>USER_INSTALLATION_DIRECTORY</code>, but that you need to set the <code>PATH</code> to point to the <code>USER_INSTALLATION_DIRECTORY</code>. I know it's not very intuitive because you would think that you want to use the path that corresponds to your current Ruby version (2.6.3), but the <code>USER_INSTALLATION_DIRECTORY</code> always ends with a 0. It only uses the first 2 digits of the Ruby version. If you ever upgrade to 2.7.2, which is the latest version as of today, your PATH has to point to <code>2.7.0</code>.</p>\n<p>Note that running the <code>export PATH</code> command above will only work during your current session. If you want to be able to use <code>jekyll</code> every time you quit and relaunch Terminal, or open a new tab, you need to add that <code>export PATH</code> command to your shell startup file, typically either <code>~/.bash_profile</code> or <code>~/.zshrc</code>. If you're not sure which shell you are using, read this: <a href=\"https://www.moncefbelyamani.com/which-shell-am-i-using-how-can-i-switch/\" rel=\"nofollow noreferrer\">https://www.moncefbelyamani.com/which-shell-am-i-using-how-can-i-switch/</a></p>\n<p>I also noticed that you seem to have installed Ruby with both Homebrew and RVM. This could potentially cause problems. I always recommend that people install Ruby with a Ruby manager (such as RVM, rbenv, and chruby), because most of them automatically set everything up for you. You don't have to worry about setting the <code>PATH</code> manually and thinking about whether to add <code>--user-install</code>. My preferred manager is <a href=\"https://github.com/postmodern/chruby\" rel=\"nofollow noreferrer\">chruby</a> because it's the lightest and easiest to use.</p>\n<p>Based on your <code>gem env</code>, it looks like you are currently using the Homebrew version of Ruby, so I wanted to let you know of another issue you might run into. (I can tell it's Homebrew by looking at the <code>RUBY_EXECUTABLE</code>, and I know from experience that Homebrew installs things in <code>/usr/local</code> and I recognize that path as the Homebrew Ruby.)</p>\n<p>Let's say you want to install <code>rails</code> months from now, and you type <code>gem install rails</code> (without the <code>--user-install</code> flag). Once it's installed, if you try to use the <code>rails</code> command, you will get &quot;command not found&quot;, because when you use the Homebrew version of Ruby, and you don't use <code>--user-install</code>, the gem will get installed in a directory managed by Homebrew, not in your <code>USER_INSTALLATION_DIRECTORY</code>. The Jekyll documentation forgot to point out that you need to add the Homebrew gems location to your <code>PATH</code>. The fix is covered in my <a href=\"https://www.moncefbelyamani.com/the-definitive-guide-to-installing-ruby-gems-on-a-mac/#homebrew-ruby\" rel=\"nofollow noreferrer\">definitive guide to installing Ruby gems on a Mac</a>, and also in the <a href=\"https://github.com/jekyll/jekyll/pull/8496\" rel=\"nofollow noreferrer\">pull request I opened to fix the Jekyll documentation</a>.</p>\n<p>To understand more about how <code>PATH</code> works, and why you can get a &quot;command not found&quot; error, I recommend this article:\n<a href=\"https://www.moncefbelyamani.com/troubleshooting-command-not-found-in-the-terminal/\" rel=\"nofollow noreferrer\">https://www.moncefbelyamani.com/troubleshooting-command-not-found-in-the-terminal/</a></p>\n"}], "owner": {"reputation": 55, "user_id": 10830268, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGiXeAd-s6I/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXa6lgj80W3mDtueSrgWyX1AuAjg/mo/photo.jpg?sz=128", "display_name": "Tony Hoan Trinh", "link": "https://stackoverflow.com/users/10830268/tony-hoan-trinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1607232962, "creation_date": 1562031265, "question_id": 56844252, "link": "https://stackoverflow.com/questions/56844252/jekyll-command-not-found-problem-despite-installated-with-most-recent-versions", "title": "Jekyll: command not found problem despite installated with most recent versions", "body": "<p>I am having trouble with the Jekyll installation. Everything is up to date with Ruby, Homebrew and Gems:</p>\n\n<pre><code>Quocs-MacBook-Air:~ quochoantrinh$ brew -v\nHomebrew 2.1.6\nHomebrew/homebrew-core (git revision 2796; last commit 2019-07-01)\nQuocs-MacBook-Air:~ quochoantrinh$ ruby -v\nruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin16]\nQuocs-MacBook-Air:~ quochoantrinh$ gem -v\n3.0.3\n</code></pre>\n\n<p>Then I ran the following from the Jekyll on macOS setup from the official website (<a href=\"https://jekyllrb.com/docs/installation/macos/\" rel=\"nofollow noreferrer\">https://jekyllrb.com/docs/installation/macos/</a>)</p>\n\n<pre><code>export PATH=/usr/local/opt/ruby/bin:$PATH\n</code></pre>\n\n<p>Afterwards I did the next commands:</p>\n\n<pre><code>gem install --user-install bundler jekyll\nexport PATH=$HOME/.gem/ruby/2.6.3/bin:$PATH\n</code></pre>\n\n<p>However when I run jekyll in my terminal it gives me the \"command not found\".</p>\n\n<p>This is my gem env </p>\n\n<pre><code>Quocs-MacBook-Air:~ quochoantrinh$ gem env\nRubyGems Environment:\n  - RUBYGEMS VERSION: 3.0.3\n  - RUBY VERSION: 2.6.3 (2019-04-16 patchlevel 62) [x86_64-darwin16]\n  - INSTALLATION DIRECTORY: /Users/quochoantrinh/.rvm/gems/ruby-2.6.3\n  - USER INSTALLATION DIRECTORY: /Users/quochoantrinh/.gem/ruby/2.6.0\n  - RUBY EXECUTABLE: /usr/local/opt/ruby/bin/ruby\n  - GIT EXECUTABLE: /usr/bin/git\n  - EXECUTABLE DIRECTORY: /Users/quochoantrinh/.rvm/gems/ruby-2.6.3/bin\n  - SPEC CACHE DIRECTORY: /Users/quochoantrinh/.gem/specs\n  - SYSTEM CONFIGURATION DIRECTORY: /usr/local/Cellar/ruby/2.6.3/etc\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-16\n  - GEM PATHS:\n     - /Users/quochoantrinh/.rvm/gems/ruby-2.6.3\n     - /Users/quochoantrinh/.rvm/rubies/ruby-2.6.3/lib/ruby/gems/2.6.0\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - https://rubygems.org/\n  - SHELL PATH:\n     - /usr/local/opt/ruby/bin\n     - /Users/quochoantrinh/.yarn/bin\n     - /Users/quochoantrinh/.config/yarn/global/node_modules/.bin\n     - /Users/quochoantrinh/anaconda3/bin\n     - /Users/quochoantrinh/anaconda3/bin\n     - /Users/quochoantrinh/anaconda/bin\n     - /Users/quochoantrinh/.gem/ruby/2.6.3/bin\n     - /Users/quochoantrinh/.rvm/gems/ruby-2.6.3/bin\n     - /Users/quochoantrinh/.rvm/gems/ruby-2.6.3@global/bin\n     - /Users/quochoantrinh/.rvm/rubies/ruby-2.6.3/bin\n     - /Users/quochoantrinh/.yarn/bin\n     - /Users/quochoantrinh/.config/yarn/global/node_modules/.bin\n     - /Users/quochoantrinh/anaconda3/bin\n     - /Users/quochoantrinh/anaconda3/bin\n     - /Users/quochoantrinh/anaconda/bin\n     - /usr/local/bin\n     - /usr/bin\n     - /bin\n     - /usr/sbin\n     - /sbin\n     - /Library/Frameworks/Mono.framework/Versions/Current/Commands\n     - /Users/quochoantrinh/.rvm/bin\n\n</code></pre>\n"}, {"tags": ["ruby", "multiline"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1562029016, "post_id": 56843988, "comment_id": 100239609, "body": "Can you share an example of how you would like the result to look, versus how it looks? I&#39;m not really sure what you mean &quot;it outputs as separate lines&quot;, because you clearly have newlines in the string"}, {"owner": {"reputation": 11, "user_id": 11726745, "user_type": "registered", "profile_image": "https://graph.facebook.com/145769913269977/picture?type=large", "display_name": "Vidur Sanandan", "link": "https://stackoverflow.com/users/11726745/vidur-sanandan"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562029628, "post_id": 56843988, "comment_id": 100239696, "body": "Added this to my original post. But essentially instead of sending my text as one large paragraph, it will enter one line, submit that, enter the next line, submit that, etc. I want it to send as one large paragraph message."}, {"owner": {"reputation": 2225, "user_id": 3050238, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1366ae6924f53373cd89680640ecd974?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/3050238/vic"}, "edited": false, "score": 1, "creation_date": 1562037220, "post_id": 56843988, "comment_id": 100240984, "body": "I don&#39;t have experience with bots, or ruby, but it looks like you&#39;re pushing an array of strings. Try joining all the lines and send a single string."}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "reply_to_user": {"reputation": 2225, "user_id": 3050238, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1366ae6924f53373cd89680640ecd974?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/3050238/vic"}, "edited": false, "score": 1, "creation_date": 1562047218, "post_id": 56843988, "comment_id": 100243173, "body": "@Vic they are joining the array with newlines to make it a single string"}, {"owner": {"reputation": 11, "user_id": 11726745, "user_type": "registered", "profile_image": "https://graph.facebook.com/145769913269977/picture?type=large", "display_name": "Vidur Sanandan", "link": "https://stackoverflow.com/users/11726745/vidur-sanandan"}, "edited": false, "score": 0, "creation_date": 1562098083, "post_id": 56843988, "comment_id": 100268729, "body": "Yeah as far as I can tell it is already one string."}], "owner": {"reputation": 11, "user_id": 11726745, "user_type": "registered", "profile_image": "https://graph.facebook.com/145769913269977/picture?type=large", "display_name": "Vidur Sanandan", "link": "https://stackoverflow.com/users/11726745/vidur-sanandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562030238, "creation_date": 1562028115, "last_edit_date": 1562030238, "question_id": 56843988, "link": "https://stackoverflow.com/questions/56843988/text-outputs-as-multiple-separate-lines-instead-of-one-paragraph-with-linebreaks", "title": "Text outputs as multiple separate lines instead of one paragraph with linebreaks", "body": "<p>I have a bot that writes my message to a webpage. I want the message to be sent as one paragraph, but with the lines separated by a linebreak. However, when I actually run the code, the bot inputs and enters each line separately, instead of as one paragraph</p>\n\n<p>I've tried messing with the linebreak formatting and string formatting, but the issue persists</p>\n\n<pre><code>reply_messages = []\nreply_messages.push([\n  \"FREE BABY AVOCUDDLE - Thank you for your patience!\",\n  \"To redeem your FREE avocuddle, just use the LINK IN OUR BIO and ADD TO CART - just cover shipping, no additional charges!\",\n  \"Discount AUTOMATICALLY APPLIES! Super simple, no code!\",\n  \"If you order another avocuddle in addition, we cover shipping PLUS the free baby avocuddle! :)\",\n  \"Feel free to DM us if you need anything!\"\n].join(\"\\n\")+\"\\n\")\n.\n.\n.\nwhile true\n  browser.get 'https://twitter.com/messages/requests'\n  sleep 5\n  request = wait.until {\n    el = browser.find_element(:css, \"[data-testid='conversation']\")\n    el if el.displayed?\n  }\n  break if request.nil?\n\n  request.click\n  not_acceptable_link = true\n  na_link_index = 1\n  while not_acceptable_link == true\n    accept_btn = browser.find_element(:xpath, \"//*[contains(text(), 'Accept')]\")\n    unless accept_btn.displayed?\n      request_2 = wait.until {\n        el = browser.find_elements(:css, \"[data-testid='conversation']\")[na_link_index]\n        el if el.displayed?\n      }\n      request_2.click\n    else\n      not_acceptable_link = false\n    end\n    na_link_index += 1\n  end\n  accept_btn = browser.find_element(:xpath, \"//*[contains(text(), 'Accept')]\")\n  accept_btn.click\n  sleep 1\n  reply_input = wait.until {\n    el = browser.find_element(:css, \"[data-testid='dmComposerTextInput']\")\n    el if el.displayed?\n  }\n  reply_input.click\n  reply_input.send_keys(reply_messages)\n.\n.\n.\n</code></pre>\n\n<p>I would like for the code to output the entire text as one block of text. However, instead, it outputs as separate lines. </p>\n\n<p>Output currently looks like:</p>\n\n<pre><code>FREE BABY AVOCUDDLE - Thank you for your patience! \n(enters this into text box)\nTo redeem your FREE avocuddle, just use the LINK IN OUR BIO and ADD TO CART - just cover shipping, no additional charges!\n(enters this into text box)\netc. \n</code></pre>\n\n<p>Instead I would like for it to send as one message. </p>\n"}, {"tags": ["ruby", "amazon-web-services", "webmock", "aws-batch", "aws-sdk-ruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562017647, "post_id": 56842691, "comment_id": 100237487, "body": "Just as a remark you can try <a href=\"https://github.com/vcr/vcr\" rel=\"nofollow noreferrer\"><code>vcr gem</code></a> which gives you more convenient way of mocking http requests in tests"}, {"owner": {"reputation": 1483, "user_id": 217623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d631d2ba6af058cdffae8598a3d43e?s=128&d=identicon&r=PG", "display_name": "Jacob Dalton", "link": "https://stackoverflow.com/users/217623/jacob-dalton"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562018523, "post_id": 56842691, "comment_id": 100237734, "body": "@MartinZinovsky I&#39;m not a fan of VCR. I worked on a large Rails project that mocked hundreds of requests with VCR, and I found them to be very brittle. I much prefer to set an explicit mock that&#39;s defined in the test. When recording requests with VCR you also pick things that are not relevant (consider caching headers or tokens that expire) to what you&#39;re testing (also adding to the brittleness). Also in this case VCR would not help me -- the AWS SDK (specifically Seahorse) is not setting the <code>Content-Type</code> so even if I recorded the request, I&#39;d still have an ugly diff on failure."}], "answers": [{"tags": [], "owner": {"reputation": 1483, "user_id": 217623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d631d2ba6af058cdffae8598a3d43e?s=128&d=identicon&r=PG", "display_name": "Jacob Dalton", "link": "https://stackoverflow.com/users/217623/jacob-dalton"}, "is_accepted": false, "score": 0, "last_activity_date": 1562018106, "creation_date": 1562018106, "answer_id": 56842921, "question_id": 56842691, "link": "https://stackoverflow.com/questions/56842691/how-do-you-set-a-content-type-header-for-the-ruby-aws-sdk/56842921#56842921", "title": "How do you set a Content-Type Header for the Ruby AWS SDK?", "body": "<p>The base http client of the AWS SDK is called Seahorse and allows you to add handlers that change the behavior of the request chain.</p>\n\n<p>A handler that can add the header <code>Content-Type:application/json</code> looks like the following:</p>\n\n<pre><code>  class ContentType &lt; Seahorse::Client::Plugin\n    class Handler &lt; Seahorse::Client::Handler\n      def call(context)\n        context.http_request.headers['Content-Type'] = 'application/json'\n        @handler.call(context)\n      end\n    end\n    handler(Handler, step: :sign, priority: 0)\n  end\n</code></pre>\n\n<p>This can then be added to an AWS SDK service that inherits from Seahorse:</p>\n\n<pre><code>Aws::Batch::Client.add_plugin(ContentType)\n\n</code></pre>\n\n<p>Now Webmock will respond to a failure like this:</p>\n\n<pre><code>...\n       registered request stubs:\n\n       stub_request(:post, \"https://batch.us-east-1.amazonaws.com/v1/submitjob\").\n         with(\n           body: {\"jobDefinition\"=&gt;\"def\", \"jobName\"=&gt;\"Wrong\", \"jobQueue\"=&gt;\"queueName\", \"parameters\"=&gt;{\"task\"=&gt;\"{\\\"fake\\\":\\\"town\\\"}\"}})\n\n       Body diff:\n        [[\"~\", \"jobName\", \"Fakie\", \"Wrong\"]]\n</code></pre>\n"}], "owner": {"reputation": 1483, "user_id": 217623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d631d2ba6af058cdffae8598a3d43e?s=128&d=identicon&r=PG", "display_name": "Jacob Dalton", "link": "https://stackoverflow.com/users/217623/jacob-dalton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 508, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562019008, "creation_date": 1562016525, "last_edit_date": 1562019008, "question_id": 56842691, "link": "https://stackoverflow.com/questions/56842691/how-do-you-set-a-content-type-header-for-the-ruby-aws-sdk", "title": "How do you set a Content-Type Header for the Ruby AWS SDK?", "body": "<p>I'm using Webmock to test http requests made by the ruby aws-sdk (in this case aws-sdk-batch).</p>\n\n<p>Webmock handles json requests with a much more convenient hash diff and <a href=\"https://til.hashrocket.com/posts/pngi98pniw-partial-post-body-matching-with-webmock\" rel=\"nofollow noreferrer\">partial matching</a> when the requests fail, but it will only do so if the <code>Content-Type</code> of the stubbed request is <code>application/json</code>.</p>\n\n<p>However the <code>aws-sdk-batch</code> gem creates a request with an empty <code>Content-type</code> (<a href=\"https://docs.aws.amazon.com/batch/latest/APIReference/API_SubmitJob.html#API_SubmitJob_RequestSyntax\" rel=\"nofollow noreferrer\">despite having documented the content type as application/json</a>) and appears to rely on the default behavior of the endpoint to interpret this as <code>application/json</code>.</p>\n\n<p>I would like to manually add the header <code>Content-type: application/json</code>, so that I can benefit from Webmock's better handling of json request body. Is this possible?</p>\n\n<hr>\n\n<p>Example Webmock response without specifying <code>Content-Type:application/json</code>:</p>\n\n<pre><code>     WebMock::NetConnectNotAllowedError:\n       Real HTTP connections are disabled. Unregistered request: POST https://batch.us-east-1.amazonaws.com/v1/submitjob with body '{\"jobName\":\"Fakie\",\"jobQueue\":\"queue\",\"jobDefinition\":\"def\",\"parameters\":{\"task\":\"{\\\"fake\\\":\\\"town\\\"}\"}}' with headers {'Accept'=&gt;'*/*', 'Accept-Encoding'=&gt;'', 'Authorization'=&gt;'AWS4-HMAC-SHA256 Credential=ACCESS_KEY_ID/20190701/us-east-1/batch/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=5f4bf85ba48333e6cda6ff613b4ea2faacd0417b4136621c58b87a488c3019ee', 'Content-Length'=&gt;'106', 'Content-Type'=&gt;'', 'Host'=&gt;'batch.us-east-1.amazonaws.com', 'User-Agent'=&gt;'aws-sdk-ruby3/3.54.2 ruby/2.5.5 x86_64-darwin18 aws-sdk-batch/1.20.0', 'X-Amz-Content-Sha256'=&gt;'cf52595364d1a588b4ca4fdeaddb8170e4ad944fa28ac6df647484bb596de9c4', 'X-Amz-Date'=&gt;'20190701T215756Z'}\n\n       You can stub this request with the following snippet:\n\n       stub_request(:post, \"https://batch.us-east-1.amazonaws.com/v1/submitjob\").\n         with(\n           body: \"{\\\"jobName\\\":\\\"Fakie\\\",\\\"jobQueue\\\":\\\"quue\\\",\\\"jobDefinition\\\":\\\"def\\\",\\\"parameters\\\":{\\\"task\\\":\\\"{\\\\\\\"fake\\\\\\\":\\\\\\\"town\\\\\\\"}\\\"}}\",\n           headers: {\n          'Accept'=&gt;'*/*',\n          'Accept-Encoding'=&gt;'',\n          'Authorization'=&gt;'AWS4-HMAC-SHA256 Credential=ACCESS_KEY_ID/20190701/us-east-1/batch/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=5f4bf85ba48333e6cda6ff613b4ea2faacd0417b4136621c58b87a488c3019ee',\n          'Content-Length'=&gt;'106',\n          'Content-Type'=&gt;'',\n          'Host'=&gt;'batch.us-east-1.amazonaws.com',\n          'User-Agent'=&gt;'aws-sdk-ruby3/3.54.2 ruby/2.5.5 x86_64-darwin18 aws-sdk-batch/1.20.0',\n          'X-Amz-Content-Sha256'=&gt;'cf52595364d1a588b4ca4fdeaddb8170e4ad944fa28ac6df647484bb596de9c4',\n          'X-Amz-Date'=&gt;'20190701T215756Z'\n           }).\n         to_return(status: 200, body: \"\", headers: {})\n\n       registered request stubs:\n\n       stub_request(:post, \"https://batch.us-east-1.amazonaws.com/v1/submitjob\").\n         with(\n           body: {\"jobDefinition\"=&gt;\"def\", \"jobName\"=&gt;\"Wrong\", \"jobQueue\"=&gt;\"queue\", \"parameters\"=&gt;{\"task\"=&gt;\"{\\\"fake\\\":\\\"town\\\"}\"}})\n</code></pre>\n\n<p>As you can see when these tests fail for strings you're left with the agonizing task of picking through the body character by character which is a pretty horrible developer experience. The Hashdiff experience is FAR superior.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 0, "creation_date": 1562069340, "post_id": 56842735, "comment_id": 100254242, "body": "This looks much nicer. However, where do you catch any errors for the order creation?"}, {"owner": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 0, "creation_date": 1562069390, "post_id": 56842735, "comment_id": 100254274, "body": "On another note, do you think it would be worth it to completely swap out forms if they decide they need a new order and then have the form follow Rails convention of having the form for order, then nested attributes for the batch?"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "reply_to_user": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 1, "creation_date": 1562139955, "post_id": 56842735, "comment_id": 100279521, "body": "Yeah, it maybe  a good solution - you won&#39;t have to reimplement this logic in a controller. I&#39;d probably do that in this case."}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1562016887, "creation_date": 1562016887, "answer_id": 56842735, "question_id": 56842412, "link": "https://stackoverflow.com/questions/56842412/creating-2-models-in-controller-action-with-transaction-rails-4/56842735#56842735", "title": "Creating 2 Models in Controller Action With Transaction - Rails 4", "body": "<p>Why not move error handling and response rendering outside of the transaction?</p>\n\n<pre><code>def create\n  @batch = Batch.new(batch_params)\n  Batch.transaction do\n    if params[:new_order] == \"newOrder\"\n      @order = Order.new(order_params)\n      @order.project_id = params[:batch][:project_id]\n      @order.save!\n      @batch.order_id = @order.id\n      @batch.save!\n    end\n  end    \n  respond_to do |format|\n    format.html { redirect_to @batch, notice: 'Batch was successfully created.' }\n    format.json { render json: @batch }\n    format.js { render json: @batch }\n  end\nrescue StandardError =&gt; error\n   @error = error\n   format.html { render action: 'new' }\n   format.json { render json: {error: @error, batch: @batch.errors}, status: :unprocessable_entity }\n   format.js { render json: {error: @error, batch: @batch.errors}, status: :unprocessable_entity  }\nend\n</code></pre>\n\n<p>It's still quite complex, but it's definitely more readable. The next step would be to extract the whole transaction block to a service.</p>\n"}, {"comments": [{"owner": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 0, "creation_date": 1562069561, "post_id": 56844653, "comment_id": 100254368, "body": "Thanks! This is interesting, I&#39;ve never seen the convention before in a rails article. To me it seems like that would just be moving code elsewhere without much benefit; could you outline some of the benefits of this, please?"}, {"owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "reply_to_user": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 0, "creation_date": 1562082250, "post_id": 56844653, "comment_id": 100262186, "body": "Sure! 1) Details about the data layer should not be a dependency in your controllers. 2) Your models should just be a thin layer over the database, without introducing additional business logic. Let&#39;s say anytime you want to create a batch you need to follow this same flow. In that case having it in a dedicated class whose jobs it is to ask these questions and process it correctly makes it easier to unit test this behavior, reuse it, and makes the other parts of your application simpler and single responsibility."}, {"owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "reply_to_user": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "edited": false, "score": 0, "creation_date": 1562082509, "post_id": 56844653, "comment_id": 100262319, "body": "This is an interesting presentation from Gary Bernhardt highlighting some of these points - <a href=\"https://www.youtube.com/watch?v=iUe6tacW3JE\" rel=\"nofollow noreferrer\">youtube.com/watch?v=iUe6tacW3JE</a>"}], "tags": [], "owner": {"reputation": 531, "user_id": 4859818, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/26c8b231855a82a9de1aa2819b5f8899?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/4859818/jared"}, "is_accepted": false, "score": 2, "last_activity_date": 1562035494, "creation_date": 1562035494, "answer_id": 56844653, "question_id": 56842412, "link": "https://stackoverflow.com/questions/56842412/creating-2-models-in-controller-action-with-transaction-rails-4/56844653#56844653", "title": "Creating 2 Models in Controller Action With Transaction - Rails 4", "body": "<p>It seems like this is a great opportunity to use a Service Object: <a href=\"https://www.engineyard.com/blog/keeping-your-rails-controllers-dry-with-services\" rel=\"nofollow noreferrer\">https://www.engineyard.com/blog/keeping-your-rails-controllers-dry-with-services</a> .</p>\n\n<p>This pattern is very useful for keeping Model and Controllers clean, and making sure those parts of the application are keeping to the Single Responsibility Principle. </p>\n\n<p>What I would do in this case is create a service class called <code>CreateBatch</code> that takes in the parameters and performs the correct logic for each case. You can then render the correct output in the controller. This will also help clean up the conditionals and early returns you have. </p>\n\n<p>For example: </p>\n\n<pre><code># app/controllers/batches_controller.rb\ndef create\n  project_id = params[:batch][:project_id]\n  new_order = params[:new_order]\n\n  result = CreateBatch.new(new_order, batch_params, order_params, project_id).call\n\n  if result.errors\n    # handle errors with correct format\n  else\n    # handle successful response with correct format\n  end\nend\n\n# app/services/create_batch.rb\nclass CreateBatch\n\n  def initialize(new_order, batch_params, order_params, project_id)\n    @new_order = new_order\n    @batch_params = batch_params\n    @order_params = order_params\n    @project_id = project_id\n  end\n\n  def call\n    if new_order?\n      create_new_order\n    else\n      add_batch_to_existing_order\n    end\n  end\n\n  private\n\n  def new_order?\n    @new_order\n  end\n\n  def create_new_order\n    order_params = @order_params.merge(project_id: @project_id)\n    Order.save(order_params)\n  end\n\n  def add_batch_to_existing_order\n    Batch.create(@batch_params)\n  end\nend\n</code></pre>\n\n<p>I did not run this so it may take a bit of tweaking to work, however, I hope it's a good starting point. One of the awesome things about this refactor is you now have 1 conditional for the logic and 1 conditional for the response, no need for adding in <code>Transaction</code> blocks, and no early returns. It may make sense to break the <code>call</code> method into 2 different methods that you can call from the controller. Using service classes like this makes the code much easier to unit test as well. </p>\n"}], "owner": {"reputation": 4433, "user_id": 3390279, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/679111419/picture?type=large", "display_name": "karns", "link": "https://stackoverflow.com/users/3390279/karns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562035494, "creation_date": 1562014869, "question_id": 56842412, "link": "https://stackoverflow.com/questions/56842412/creating-2-models-in-controller-action-with-transaction-rails-4", "title": "Creating 2 Models in Controller Action With Transaction - Rails 4", "body": "<p>There are multiple answers that explain how you can have nested resources, however, my use case is a bit different.</p>\n\n<p>Batches belong to orders and an order has many batches.</p>\n\n<p>I can understand how it works if you have a form for an order and can create batches within that form, but cannot comprehend a good way for my situation.</p>\n\n<p>I have a form for a nested resource (batch) where the parent (order) may or may not exist. They may select whether or not it exists via radio buttons. If it exists, they then just simply select which order it belongs to .. simple. If it doesn't exist, I show fields for the order and submit order params alongside of batch params. I want to make sure to rollback the order creation if the batch does not save.</p>\n\n<p>Here is the code I have thus far. </p>\n\n<pre><code>def create\n  @batch = Batch.new(batch_params)\n\n  Batch.transaction do\n    if params[:new_order] == \"newOrder\"\n      @order = Order.new(order_params)\n      @order.project_id = params[:batch][:project_id]\n      begin\n        @order.save!\n      rescue\n        respond_to do |format|\n          format.html { render action: 'new' }\n          format.json { render json: {order: @order.errors}, status: :unprocessable_entity }\n          format.js { render json: {order: @order.errors}, status: :unprocessable_entity }\n        end\n        raise ActiveRecord::Rollback\n        return\n      end\n      #@batch.order_id = @order.id\n    end\n\n    respond_to do |format|\n      begin\n        @batch.save!\n        format.html { redirect_to @batch, notice: 'Batch was successfully created.' }\n        format.json { render json: @batch }\n        format.js { render json: @batch }\n      rescue\n        binding.pry\n        raise ActiveRecord.Rollback\n        format.html { render action: 'new' }\n        format.json { render json: {batch: @batch.errors}, status: :unprocessable_entity }\n        format.js { render json: {batch: @batch.errors}, status: :unprocessable_entity }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>This isn't behaving quite like I want it and seems quite ugly. I have a feeling I'm making it more difficult than I need to. What's the best approach in a situation like this? Much appreciated!</p>\n"}, {"tags": ["ruby", "jit", "ruby-2.6"], "owner": {"reputation": 95, "user_id": 10973211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de36ac107d545bb948526da4bba55e3c?s=128&d=identicon&r=PG&f=1", "display_name": "HJL", "link": "https://stackoverflow.com/users/10973211/hjl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1562014102, "creation_date": 1562014102, "question_id": 56842282, "link": "https://stackoverflow.com/questions/56842282/why-does-mjit-functions-get-invoked", "title": "Why does mjit functions get invoked?", "body": "<p>I'm doing research in ruby interpreter and mJIT.\nAnd, as a first step, I would like to understand the behaviors of both. Thus, I simply ran a very simple ruby program without --jit command <code>puts (\"hello world!\")</code> and got the execution trace of it. Then, one thing I found that even without mJIT enabled, some of the mJIT functions get invoked, such as <code>mjit_add_class_serial</code>, <code>mjit_remove_class_serial</code>, <code>mjit_mark</code>, <code>mjit_gc_finish_hook</code>, <code>mjit_free_iseq</code>, and <code>mjit_finish</code>.</p>\n\n<p>And, I would like to understand why that is. My guess is that the interpreter and mJIT shares some of those codes, but not 100% sure. Especially, the description of <code>mjit_finish</code> is briefly saying that it is for finishing up whatever the operation is happening by the mJIT compiler. In such case, why does this function gets invoked when interpreter-only execution code?</p>\n\n<p>If anyone has an idea regarding my question, any recommendation would be very much appreciated.</p>\n\n<p>Thank you.</p>\n\n<p>This is for ruby version 2.6.2. And, I've gone through the source code as well as the comments explaining each code, but they are not very clear.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562012778, "post_id": 56841880, "comment_id": 100235966, "body": "Try to run <code>CC=&#47;usr&#47;bin&#47;gcc rbenv install 1.8.6</code>. To check if you have gcc installed run <code>which gcc</code>"}, {"owner": {"reputation": 701, "user_id": 2105635, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/veVhN.png?s=128&g=1", "display_name": "Jessi", "link": "https://stackoverflow.com/users/2105635/jessi"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562013348, "post_id": 56841880, "comment_id": 100236175, "body": "hmm...nope...gives me back the exact same error .... <a href=\"https://pastebin.com/mN0waqPR\" rel=\"nofollow noreferrer\">pastebin.com/mN0waqPR</a>"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562014819, "post_id": 56841880, "comment_id": 100236696, "body": "please update your question with contents of <code>config.log</code>"}, {"owner": {"reputation": 701, "user_id": 2105635, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/veVhN.png?s=128&g=1", "display_name": "Jessi", "link": "https://stackoverflow.com/users/2105635/jessi"}, "reply_to_user": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562015073, "post_id": 56841880, "comment_id": 100236774, "body": "I do not know the location of config.log"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1562039341, "post_id": 56841880, "comment_id": 100241343, "body": "How about <code>&#47;var&#47;folders&#47;_w&#47;98n31_kn03qfjt51p2hmrfqh0000gp&#47;T&#47;ruby-build.&zwnj;&#8203;20190701155134.45412&zwnj;&#8203;.log</code>?"}, {"owner": {"reputation": 701, "user_id": 2105635, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/veVhN.png?s=128&g=1", "display_name": "Jessi", "link": "https://stackoverflow.com/users/2105635/jessi"}, "edited": false, "score": 0, "creation_date": 1562040027, "post_id": 56841880, "comment_id": 100241465, "body": "Tried that one..it just contains the 10 line output shown above."}], "owner": {"reputation": 701, "user_id": 2105635, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/veVhN.png?s=128&g=1", "display_name": "Jessi", "link": "https://stackoverflow.com/users/2105635/jessi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562019382, "creation_date": 1562011951, "last_edit_date": 1562019382, "question_id": 56841880, "link": "https://stackoverflow.com/questions/56841880/how-to-install-specific-version-of-ruby-1-8-6-with-rbenv", "title": "How to install specific version of ruby (1.8.6) with rbenv?", "body": "<p>I have some old source code that runs on ruby 1.8 and rails 2.3 . I have rbenv on my system. How can I install exactly this version of ruby (v1.8.6) with rbenv?</p>\n\n<pre><code>$ rbenv install 1.8.6\nDownloading ruby-1.8.6.tar.bz2...\n-&gt; https://cache.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6.tar.bz2\nInstalling ruby-1.8.6...\n\nWARNING: ruby-1.8.6 is past its end of life and is now unsupported.\nIt no longer receives bug fixes or critical security updates.\n\nruby-build: use readline from homebrew\n\nBUILD FAILED (OS X 10.14.2 using ruby-build 20190423)\n\nInspect or clean up the working tree at /var/folders/_w/98n31_kn03qfjt51p2hmrfqh0000gp/T/ruby-build.20190701155134.45412\nResults logged to /var/folders/_w/98n31_kn03qfjt51p2hmrfqh0000gp/T/ruby-build.20190701155134.45412.log\n\nLast 10 log lines:\n/var/folders/_w/98n31_kn03qfjt51p2hmrfqh0000gp/T/ruby-build.20190701155134.45412 ~\n/var/folders/_w/98n31_kn03qfjt51p2hmrfqh0000gp/T/ruby-build.20190701155134.45412/ruby-1.8.6 /var/folders/_w/98n31_kn03qfjt51p2hmrfqh0000gp/T/ruby-build.20190701155134.45412 ~\nchecking build system type... i686-apple-darwin18.2.0\nchecking host system type... i686-apple-darwin18.2.0\nchecking target system type... i686-apple-darwin18.2.0\nchecking for gcc... /usr/local/bin/gcc-4.2\nchecking for C compiler default output file name...\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details.\nmake: *** No targets specified and no makefile found.  Stop.\n</code></pre>\n\n<p>I've tried this solution but it does not work for me...\n<a href=\"https://github.com/rbenv/ruby-build/issues/999\" rel=\"nofollow noreferrer\">https://github.com/rbenv/ruby-build/issues/999</a></p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1562011934, "post_id": 56841833, "comment_id": 100235701, "body": "What if price/discount is different?"}, {"owner": {"reputation": 29, "user_id": 4905169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c578e0a447209238eec6ad2a5784b85?s=128&d=identicon&r=PG&f=1", "display_name": "RevolverBloom", "link": "https://stackoverflow.com/users/4905169/revolverbloom"}, "reply_to_user": {"reputation": 7565, "user_id": 1021515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Z9QcP.jpg?s=128&g=1", "display_name": "mwp", "link": "https://stackoverflow.com/users/1021515/mwp"}, "edited": false, "score": 0, "creation_date": 1562012132, "post_id": 56841833, "comment_id": 100235752, "body": "If it&#39;s different then that wouldn&#39;t be considered a duplicate entry."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562013088, "post_id": 56841833, "comment_id": 100236081, "body": "Then what would the output be?"}, {"owner": {"reputation": 759, "user_id": 4352003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0GKg.jpg?s=128&g=1", "display_name": "Yury Matusevich", "link": "https://stackoverflow.com/users/4352003/yury-matusevich"}, "edited": false, "score": 0, "creation_date": 1562017583, "post_id": 56841833, "comment_id": 100237466, "body": "You can not create a hash with different values for the same key. It should be something like this:  BREAD =&gt; [{price: 1, count: 2}, {price: 2, count: 1}]"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 759, "user_id": 4352003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0GKg.jpg?s=128&g=1", "display_name": "Yury Matusevich", "link": "https://stackoverflow.com/users/4352003/yury-matusevich"}, "edited": false, "score": 0, "creation_date": 1562050865, "post_id": 56841833, "comment_id": 100244668, "body": "@YuriMatusevich those are different hashes in the example."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1562051137, "post_id": 56841833, "comment_id": 100244817, "body": "@RevolverBloom having <code>&quot;BREAD&quot; =&gt; ...</code> looks nice, but it&#39;s kind of cumbersome when trying to process the data. Instead of creating nested single-key hashes, why don&#39;t you treat the name just like the other attributes, i.e. <code>{ name: &quot;BREAD&quot;, price: 1.50, ... }</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562029506, "post_id": 56843129, "comment_id": 100239684, "body": "The problem is that <code>{bread: {price:1.60, discount: false}}</code> should be considered uniq in comparison to <code>{bread: {price:1.50, discount: true}}</code> without a defined output"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562034710, "post_id": 56843129, "comment_id": 100240561, "body": "@engineersmnky, the question provides no guidance for what is required in the case you mention, so I concluded that was not being asked. Note the assumption I stated at the beginning of my answer."}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562036683, "post_id": 56843129, "comment_id": 100240890, "body": "However the comment from the OP states <i>&quot;If it&#39;s different then that wouldn&#39;t be considered a duplicate entry.&quot;</i> in response to the question <i>&quot;What if price/discount is different?&quot;</i>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1562038304, "post_id": 56843129, "comment_id": 100241172, "body": "@engineersmnky, so we infer the OP would want <code>{ BREAD: { price:1.60, discount:false, count:1 }, BREAD: { price:1.60, discount:true, count:1}, MARMITE: { price:1.6, discount:false, count:1 } }</code>? A wee problem with that. Without a clarification I&#39;ll stick with my assumption and move on."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1562019492, "creation_date": 1562019492, "answer_id": 56843129, "question_id": 56841833, "link": "https://stackoverflow.com/questions/56841833/convert-array-into-hash-and-add-a-counter-value-to-the-new-hash/56843129#56843129", "title": "Convert array into hash and add a counter value to the new hash", "body": "<p>We are given the array:</p>\n\n<pre><code>arr = [\n  {\"BREAD\"   =&gt; {:price =&gt; 1.50, :discount =&gt; true }},\n  {\"BREAD\"   =&gt; {:price =&gt; 1.50, :discount =&gt; true }},\n  {\"MARMITE\" =&gt; {:price =&gt; 1.60, :discount =&gt; false}}\n]\n</code></pre>\n\n<p>and make the assumption that each hash has a single key and if two hashes have the same (single) key, the value of that key is the same in both hashes.</p>\n\n<p>The first step is create an empty hash to which will add key-value pairs:</p>\n\n<pre><code>h = {}\n</code></pre>\n\n<p>Now we loop through <code>arr</code> to build the hash <code>h</code>. I've added a <code>puts</code> statement to display intermediate values in the calculation.</p>\n\n<pre><code>arr.each do |g|\n  k, v = g.first\n  puts \"k=#{k}, v=#{v}\"\n  if h.key?(k)\n    h[k][:count] += 1\n  else\n    h[k] = v.merge({ :count =&gt; 1 })\n  end\nend\n</code></pre>\n\n<p>displays:</p>\n\n<pre><code>k=BREAD, v={:price=&gt;1.5, :discount=&gt;true}\nk=BREAD, v={:price=&gt;1.5, :discount=&gt;true}\nk=MARMITE, v={:price=&gt;1.6, :discount=&gt;false}\n</code></pre>\n\n<p>and returns:</p>\n\n<pre><code>  #=&gt; [{\"BREAD\"  =&gt;{:price=&gt;1.5, :discount=&gt;true}},\n  #    {\"BREAD\"  =&gt;{:price=&gt;1.5, :discount=&gt;true}},\n  #    {\"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false}}] \n</code></pre>\n\n<p><code>each</code> always returns its receiver (here <code>arr</code>), which is not what we want.</p>\n\n<pre><code>h #=&gt; {\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true, :count=&gt;2},\n  #    \"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false, :count=&gt;1}} \n</code></pre>\n\n<p>is the result we need. See <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-key-3F\" rel=\"nofollow noreferrer\">Hash#key?</a> (aka, <code>has_key?</code>), <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-5B-5D\" rel=\"nofollow noreferrer\">Hash#[]</a>, <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-5B-5D-3D\" rel=\"nofollow noreferrer\">Hash#[]=</a> and <a href=\"http://ruby-doc.org/core-2.6.1/Hash.html#method-i-merge\" rel=\"nofollow noreferrer\">Hash#merge</a>. </p>\n\n<p>Now let's wrap this in a method.</p>\n\n<pre><code>def hashify(arr)\n  h = {}\n  arr.each do |g|\n    k, v = g.first\n    if h.key?(k)\n      h[k][:count] += 1\n    else\n      h[k] = v.merge({ :count=&gt;1 })\n    end\n  end\n  h\nend\n\nhashify(arr)\n  #=&gt; {\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true, :count=&gt;2},\n  #    \"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false, :count=&gt;1}} \n</code></pre>\n\n<p>Rubyists would often use the method <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a> to simplify.</p>\n\n<pre><code>def hashify(arr)\n  arr.each_with_object({}) do |g,h|\n    k, v = g.first\n    if h.key?(k)\n      h[k][:count] += 1\n    else\n      h[k] = v.merge({ :count =&gt; 1 })\n    end\n  end\nend\n</code></pre>\n\n<p>Compare the two methods to identify their differences. See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_with_object\" rel=\"nofollow noreferrer\">Enumerable#each_with_object</a>.</p>\n\n<p>When, as here, the keys are symbols, Ruby allows you to use the shorthand <code>{ count: 1 }</code> for <code>{ :count=&gt;1 }</code>. Moreover, she permits you to write <code>:count = 1</code> or <code>count: 1</code> without the braces when the hash is an argument. For example,</p>\n\n<pre><code>{}.merge('cat'=&gt;'meow', dog:'woof', :pig=&gt;'oink')\n  #=&gt; {\"cat\"=&gt;\"meow\", :dog=&gt;\"woof\", :pig=&gt;\"oink\"} \n</code></pre>\n\n<p>It's probably more common to see the form <code>count: 1</code> when keys are symbols and for the braces to be omitted when a hash is an argument.  </p>\n\n<p>Here's a further refinement you might see. First create </p>\n\n<pre><code>h = arr.group_by { |h| h.keys.first }\n  #=&gt; {\"BREAD\"  =&gt;[{\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true}},\n  #                {\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true}}],\n  #    \"MARMITE\"=&gt;[{\"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false}}]} \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Enumerable#group_by</a>. Now convert the values (arrays) to their sizes:</p>\n\n<pre><code>counts = h.transform_values { |arr| arr.size }\n  #=&gt; {\"BREAD\"=&gt;2, \"MARMITE\"=&gt;1}\n</code></pre>\n\n<p>which can be written in abbreviated form:</p>\n\n<pre><code>counts = h.transform_values(&amp;:size)\n  #=&gt; {\"BREAD\"=&gt;2, \"MARMITE\"=&gt;1}\n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-group_by\" rel=\"nofollow noreferrer\">Hash#transform_values</a>. We can now write:</p>\n\n<pre><code>uniq_arr = arr.uniq\n  #=&gt; [{\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true}}, \n  #=   {\"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false}}] \n\nuniq_arr.each_with_object({}) do |g,h|\n  puts \"g=#{g}\"\n  k,v = g.first\n  puts \"  k=#{k}, v=#{v}\"\n  h[k] = v.merge(counts: counts[k])\n  puts \"  h=#{h}\"\nend\n</code></pre>\n\n<p>which displays:</p>\n\n<pre><code>g={\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true}}\n  k=BREAD, v={:price=&gt;1.5, :discount=&gt;true}\n  h={\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true, :counts=&gt;2}}\ng={\"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false}}\n  k=MARMITE, v={:price=&gt;1.6, :discount=&gt;false}\n  h={\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true, :counts=&gt;2},\n     \"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false, :counts=&gt;1}}\n</code></pre>\n\n<p>and returns:</p>\n\n<pre><code>  #=&gt; {\"BREAD\"=&gt;{:price=&gt;1.5, :discount=&gt;true, :counts=&gt;2},\n  #    \"MARMITE\"=&gt;{:price=&gt;1.6, :discount=&gt;false, :counts=&gt;1}} \n</code></pre>\n\n<p>See <a href=\"http://ruby-doc.org/core-2.5.1/Array.html#method-i-uniq\" rel=\"nofollow noreferrer\">Array#uniq</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562037568, "post_id": 56843133, "comment_id": 100241057, "body": "You could speed this up by making a single pass through <code>arr</code> to obtain counts of all unique hashes (O(n)), rather than making a pass through <code>arr</code> for each unique element of <code>arr</code> to obtain the counts (O(n^2)). It should be noted that the calculation of <code>h</code> mutates <code>arr</code>. One generally assumes the given Ruby objects are not to be modified unless the question specifically calls for that."}], "tags": [], "owner": {"reputation": 1, "user_id": 9641938, "user_type": "registered", "profile_image": "https://graph.facebook.com/1681200218641446/picture?type=large", "display_name": "Ed Phillips", "link": "https://stackoverflow.com/users/9641938/ed-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1562019563, "creation_date": 1562019563, "answer_id": 56843133, "question_id": 56841833, "link": "https://stackoverflow.com/questions/56841833/convert-array-into-hash-and-add-a-counter-value-to-the-new-hash/56843133#56843133", "title": "Convert array into hash and add a counter value to the new hash", "body": "<p>This did the trick:</p>\n\n<pre><code>arr = [\n  { bread: { price: 1.50, discount: true } },\n  { bread: { price: 1.50, discount: true } },\n  { marmite: { price: 1.60, discount: false } }\n]\n</code></pre>\n\n<p>Get the count for each occurrence of hash, add as key value pair and store:</p>\n\n<pre><code>h = arr.uniq.each { |x| x[x.first.first][:count] = arr.count(x) }\n</code></pre>\n\n<p>Then convert hashes into arrays, flatten to a single array then construct a hash:</p>\n\n<pre><code>Hash[*h.collect(&amp;:to_a).flatten] \n#=&gt; {:bread=&gt;{:price=&gt;1.50, :discount=&gt;true, :count=&gt;2}, :marmite=&gt;{:price=&gt;1.60, :discount=&gt;false, :count=&gt;1}}\n</code></pre>\n\n<p>Combined a couple of nice ideas from here:\n  <a href=\"https://raycodingdotnet.wordpress.com/2013/08/05/array-of-hashes-into-single-hash-in-ruby/\" rel=\"nofollow noreferrer\">https://raycodingdotnet.wordpress.com/2013/08/05/array-of-hashes-into-single-hash-in-ruby/</a>\nand here:\n  <a href=\"http://carol-nichols.com/2015/08/07/ruby-occurrence-couting/\" rel=\"nofollow noreferrer\">http://carol-nichols.com/2015/08/07/ruby-occurrence-couting/</a></p>\n"}], "owner": {"reputation": 29, "user_id": 4905169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c578e0a447209238eec6ad2a5784b85?s=128&d=identicon&r=PG&f=1", "display_name": "RevolverBloom", "link": "https://stackoverflow.com/users/4905169/revolverbloom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1562019563, "creation_date": 1562011687, "question_id": 56841833, "link": "https://stackoverflow.com/questions/56841833/convert-array-into-hash-and-add-a-counter-value-to-the-new-hash", "title": "Convert array into hash and add a counter value to the new hash", "body": "<p>I have the following array of hashes:</p>\n\n<pre><code>[\n  {\"BREAD\" =&gt; {:price =&gt; 1.50, :discount =&gt; true }},\n  {\"BREAD\" =&gt; {:price =&gt; 1.50, :discount =&gt; true }},\n  {\"MARMITE\"    =&gt; {:price =&gt; 1.60, :discount =&gt; false}}\n]\n</code></pre>\n\n<p>And I would like to translate this array into a hash that includes the counts for each item:</p>\n\n<p>Output:</p>\n\n<pre><code> {\n  \"BREAD\" =&gt; {:price =&gt; 1.50, :discount =&gt; true, :count =&gt; 2},\n  \"MARMITE\"    =&gt; {:price =&gt; 1.60, :discount =&gt; false, :count =&gt; 1}\n   }\n</code></pre>\n\n<p>I have tried two approaches to translate the array into a hash.</p>\n\n<pre><code>new_cart = cart.inject(:merge)\n\nhash = Hash[cart.collect { |item| [item, \"\"] } ]\n</code></pre>\n\n<p>Both work but then I am stumped at how to capture and pass the count value.</p>\n\n<p>Expected output</p>\n\n<pre><code> {\n  \"BREAD\" =&gt; {:price =&gt; 1.50, :discount =&gt; true, :count =&gt; 2},\n  \"MARMITE\"    =&gt; {:price =&gt; 1.60, :discount =&gt; false, :count =&gt; 1}\n   }\n</code></pre>\n"}, {"tags": ["ruby", "trace"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1562011730, "post_id": 56841804, "comment_id": 100235630, "body": "Perhaps not exactly what you&#39;re looking for, but <a href=\"https://github.com/github/scientist\" rel=\"nofollow noreferrer\">Scientist</a> is a tool written specifically for methodically replacing parts of your Ruby infrastructure."}, {"owner": {"reputation": 1486, "user_id": 1603984, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bdf2290f0b1d87cb0853966e7e51606b?s=128&d=identicon&r=PG", "display_name": "AndrewO", "link": "https://stackoverflow.com/users/1603984/andrewo"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562071493, "post_id": 56841804, "comment_id": 100255552, "body": "Yeah, not exactly what I&#39;m looking for, but could be useful elsewhere in this project, so thanks!"}], "owner": {"reputation": 1486, "user_id": 1603984, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bdf2290f0b1d87cb0853966e7e51606b?s=128&d=identicon&r=PG", "display_name": "AndrewO", "link": "https://stackoverflow.com/users/1603984/andrewo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562011534, "creation_date": 1562011534, "question_id": 56841804, "link": "https://stackoverflow.com/questions/56841804/determine-actual-public-interface-for-a-ruby-gem", "title": "Determine actual public interface for a Ruby gem", "body": "<p>I have a Ruby gem that uses some internal, closed source libraries. I'm trying to build an interface compatible drop-in off of open libraries for one application in particular. This application only uses a subset of the library's public interface, so I don't need rewrite all of it.</p>\n\n<p>I need to figure out what subset of classes the application actually calls so I know what I need to target for reimplementation. If I could instrument the calls during the the app's test runs, maybe I could look at the stack and see where the points of entry into the library are.</p>\n\n<p>Does something like this exist, or do I need to write this myself?</p>\n"}, {"tags": ["ruby", "variables"], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 6162996, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oLM0m.jpg?s=128&g=1", "display_name": "Alexander Gorg", "link": "https://stackoverflow.com/users/6162996/alexander-gorg"}, "edited": false, "score": 0, "creation_date": 1562060216, "post_id": 56840931, "comment_id": 100249411, "body": "Comprehensively! Thx!"}], "tags": [], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "is_accepted": true, "score": 6, "last_activity_date": 1562010986, "last_edit_date": 1562010986, "creation_date": 1562006935, "answer_id": 56840931, "question_id": 56840571, "link": "https://stackoverflow.com/questions/56840571/array-is-being-modified-during-enumeration/56840931#56840931", "title": "Array is being modified during enumeration", "body": "<p>I believe your issue is <code>updated_hsh = my_hsh</code>.</p>\n\n<p>This does not duplicate the hash. Any changes to <code>updated_hsh</code> will change <code>my_hsh</code> and vice versa.</p>\n\n<p>Using <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-clone\" rel=\"nofollow noreferrer\">Object#clone</a> or <a href=\"https://ruby-doc.org/core-2.6.3/Object.html#method-i-dup\" rel=\"nofollow noreferrer\">Object#dup</a> is a step in the right direction, but won't actually duplicate inner objects (the \"numbers\" arrays):</p>\n\n<pre><code>h1 = [{numbers: [1,2,3], n_count: 3}]\nh2 = h1.map(&amp;:clone)\nh2[0][:numbers] &lt;&lt; 4\nh2[0][:n_count] += 1\n\nh1\n# =&gt; [{numbers: [1,2,3,4], n_count: 3}]\n</code></pre>\n\n<p>You can see that <code>n_count</code> was not altered in the original, but <code>numbers</code> was.</p>\n\n<p>To get around this, you can use <a href=\"https://apidock.com/rails/Hash/deep_dup\" rel=\"nofollow noreferrer\">Hash#deep_dup</a>. This method isn't available in Ruby core. It is part of Active Support which is required by Rails, and can easily be loaded to a plain Ruby program as well, if you require the gem. </p>\n\n<pre><code>require 'active_support/all'\n\nh1 = [{numbers: [1,2,3], n_count: 3}]\nh2 = h1.map(&amp;:deep_dup)\nh2[0][:numbers] &lt;&lt; 4\nh2[0][:n_count] += 1\n\nh1\n# =&gt; [{numbers: [1,2,3], n_count: 3}]\n</code></pre>\n\n<p>You can also implement <code>deep_dup</code> yourself, if you don't want to use active support. See <a href=\"https://stackoverflow.com/a/8206537/2981429\">How to create a deep copy of an object in Ruby?</a></p>\n\n<p>Another alternative is to manually build the inner hashes, like so:</p>\n\n<pre><code>h1 = [{numbers: [1,2,3], n_count: 3}]\nh2 = h1.map do |hsh|\n  {\n    numbers: hsh[:numbers].clone,\n    n_count: hsh[:n_count]\n  }\nend\n</code></pre>\n\n<p>Although <code>deep_dup</code> is more concise</p>\n"}], "owner": {"reputation": 898, "user_id": 6162996, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oLM0m.jpg?s=128&g=1", "display_name": "Alexander Gorg", "link": "https://stackoverflow.com/users/6162996/alexander-gorg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56840931, "answer_count": 1, "score": 1, "last_activity_date": 1562010986, "creation_date": 1562005125, "last_edit_date": 1562005470, "question_id": 56840571, "link": "https://stackoverflow.com/questions/56840571/array-is-being-modified-during-enumeration", "title": "Array is being modified during enumeration", "body": "<p>My situation is quite sophisticated, that's why I replaced original data with simple numbers. So, please, don't pay attention to very simple data and 'idiotic' if conditions. It's just an example. Also, please, ignore typos if there's any - original code has no typos.</p>\n\n<p>I have array of hashes with elements like <code>my_hsh = {\"numbers\" =&gt; [1, 2, 3, 4], \"n_count\" =&gt; 4}</code></p>\n\n<p>What I need to do:</p>\n\n<ol>\n<li>Loop through the parent array and select appropriate hashes, </li>\n<li>add each such hash to the array <code>my_arr_nochange</code>,</li>\n<li>loop through \"numbers\" in each such hash and add'em to <code>the_hash[\"numbers\"]</code>,</li>\n<li>add hashes without these numbers to <code>my_arr_updt</code>.</li>\n</ol>\n\n<p>So the code:</p>\n\n<pre><code>the_hash = {\"numbers\" =&gt; []}\nmy_arr_updt = []\nmy_arr_nochange = []\narray_of_hashes.each do |my_hsh|\n  if my_hsh[\"n_count\"] == 4\n    my_arr_nochange &lt;&lt; my_hsh\n    updated_hsh = my_hsh\n    my_hsh[\"numbers\"].each do |num|\n      if num == 2\n        the_hash[\"numbers\"] += [ num ]\n        updated_hsh[\"numbers\"] -= [ num ]\n      end\n    end\n    my_arr_updt &lt;&lt; updated_hsh\n  end\nend\n\nreturn the_hash, my_arr_updt, my_arr_nochange\n</code></pre>\n\n<p>The problem is <code>my_arr_nochange</code> is being modified, so instead of getting the old state of my_hsh inside I get the new one. Like:</p>\n\n<pre><code>my_arr_updt\n=&gt; [{\"numbers\" =&gt; [1, 3, 4], \"n_count\" =&gt; 4}]\nmy_arr_nochange \n=&gt; [{\"numbers\" =&gt; [1, 3, 4], \"n_count\" =&gt; 4}]\n</code></pre>\n\n<p>Tried splitting in different methods and using sub-variables. No result.</p>\n\n<p>P.S.: If you could help with more appropriate title, I would appreciate that too.</p>\n"}, {"tags": ["ruby", "docker"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562002866, "post_id": 56840042, "comment_id": 100232467, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15129355/ruby-2-0-rails-gem-install-error-cannot-load-such-file-openssl\">ruby 2.0 rails gem install error &quot;cannot load such file -- openssl&quot;</a>"}, {"owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "reply_to_user": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1562002998, "post_id": 56840042, "comment_id": 100232515, "body": "pls check my edit about the duplication"}, {"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 0, "creation_date": 1562003377, "post_id": 56840042, "comment_id": 100232656, "body": "It looks like you&#39;re saying it&#39;s not a duplicate because the system where Ruby lives isn&#39;t macOS. I suggest that you actually read through the answers on that question and try them, because it <b>will</b> solve your issue."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 1, "creation_date": 1562003499, "post_id": 56840042, "comment_id": 100232697, "body": "You\u2019re only installing the runtime libraries, not the header files you need to compile applications.  <code>libssl-dev</code> gets mentioned in one or two of the answers to the linked question."}, {"owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "edited": false, "score": 1, "creation_date": 1562004144, "post_id": 56840042, "comment_id": 100232954, "body": "pls check my second edit about <code>libssl-dev</code>"}, {"owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "edited": false, "score": 0, "creation_date": 1562008393, "post_id": 56840042, "comment_id": 100234474, "body": "why dont you use ruby debian image in <a href=\"https://docs.docker.com/samples/library/ruby/\" rel=\"nofollow noreferrer\"><code>ruby docker repo</code></a>? Or at least base on that"}, {"owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "edited": false, "score": 0, "creation_date": 1562011914, "post_id": 56840042, "comment_id": 100235695, "body": "I want some pretty old versions, not available in the above repo"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562034823, "post_id": 56840042, "comment_id": 100240590, "body": "I dug thru this a  bit and I agree, it&#39;s not a duplicate and none of the solutions work. It appears to be an issue w/ openssl libs not being recognized. I couldn&#39;t get a working solution, but I thought I&#39;d throw this out there: this might be a good time to try rvm and see if it will install the old version. If you cd into your tmp/ruby directory, there&#39;s an ext/openssl folder in there. <code>ruby extconf.rb</code> will generate the errors that I think you&#39;re looking for (I just couldn&#39;t figure out how to work around them)"}], "owner": {"reputation": 9276, "user_id": 2409793, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/QDLY9.png?s=128&g=1", "display_name": "pkaramol", "link": "https://stackoverflow.com/users/2409793/pkaramol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562004125, "creation_date": 1562002560, "last_edit_date": 1562004125, "question_id": 56840042, "link": "https://stackoverflow.com/questions/56840042/unable-to-install-bundler-after-installing-ruby-from-source", "title": "Unable to install bundler after installing ruby from source", "body": "<p>I am using a <code>Dockerfile</code> to build a custom <code>ruby</code> image as follows:</p>\n\n<pre><code>FROM debian:9\n\nRUN apt-get update \\\n    &amp;&amp; apt-get install -y \\\n        build-essential \\\n        gcc \\\n        openssl \\\n        procps \\\n        wget \\\n        zlib1g-dev \\\n    &amp;&amp; cd /tmp \\\n    &amp;&amp; wget http://ftp.ruby-lang.org/pub/ruby/2.0/ruby-2.0.0-p0.tar.gz \\\n    &amp;&amp; tar -xvzf ruby-2.0.0-p0.tar.gz \\\n    &amp;&amp; ls -al \\\n    &amp;&amp; cd ruby-2.0.0-p0 \\\n    &amp;&amp; ./configure \\\n    &amp;&amp; make \\\n    &amp;&amp; make install\n\nUSER someuser\nWORKDIR /home/someuser\n</code></pre>\n\n<p>The build finishes OK. </p>\n\n<p>As a matter of fact, from within the image:</p>\n\n<pre><code>$ ruby -v\nruby 2.0.0p0 (2013-02-24 revision 39474) [x86_64-linux]\n</code></pre>\n\n<p>But when I spin up the image and try to install <code>bundler</code></p>\n\n<pre><code>$ gem install bundler\nERROR:  Loading command: install (LoadError)\n    cannot load such file -- openssl\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n\n<p>Why is that, given I have installed <code>openssl</code>?</p>\n\n<p><strong>edit</strong>: It is <strong>NOT</strong> a duplicate of <a href=\"https://stackoverflow.com/questions/15129355/ruby-2-0-rails-gem-install-error-cannot-load-such-file-openssl\">this</a> because (although I am using OSX) I am compiling <code>ruby</code> <strong>WITHIN</strong> a <code>debian:9</code> image and <code>openssl</code> gets installed within the image (<code>Dockerfile</code>)</p>\n\n<p><strong>edit</strong>: installing <code>libssl-dev</code> as also indicated in the potential duplicate question does not solve the issue either:</p>\n\n<pre><code>(custom-ruby)*\u27a3 $ docker run -it --user=root pkaramol/test-ruby-new bash\nroot@bde5e149ced7:/home/someuser# dpkg -l | grep -i ssl\nii  libssl-dev:amd64          1.1.0j-1~deb9u1            amd64        Secure Sockets Layer toolkit - development files\nii  libssl-doc                1.1.0j-1~deb9u1            all          Secure Sockets Layer toolkit - development documentation\nii  libssl1.1:amd64           1.1.0j-1~deb9u1            amd64        Secure Sockets Layer toolkit - shared libraries\nii  openssl                   1.1.0j-1~deb9u1            amd64        Secure Sockets Layer toolkit - cryptographic utility\nroot@bde5e149ced7:/home/someuser# gem install bundler\nERROR:  Loading command: install (LoadError)\n    cannot load such file -- openssl\nERROR:  While executing gem ... (NoMethodError)\n    undefined method `invoke_with_build_args' for nil:NilClass\n</code></pre>\n"}, {"tags": ["android", "ruby", "automated-tests", "appium"], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 1757737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa4ca94ba048ae3852512de7a4e9e26?s=128&d=identicon&r=PG", "display_name": "Jovan Ilic", "link": "https://stackoverflow.com/users/1757737/jovan-ilic"}, "is_accepted": false, "score": 1, "last_activity_date": 1585904980, "creation_date": 1585904980, "answer_id": 61008509, "question_id": 56839515, "link": "https://stackoverflow.com/questions/56839515/not-able-to-set-date-for-native-date-field-on-android/61008509#61008509", "title": "Not able to set date for native date field on android", "body": "<p>Have you tried using UI Automator Viewer (which is part of Android SDK)?\nYou can connect a real device or use emulator, start the app, start UI Automator Viewer and grab a screenshot with it. You will be able to see entire screen and inspect it. This will help with creating the selectors for those nasty native elements.</p>\n\n<p>Video tutorial <a href=\"https://www.youtube.com/watch?v=XBhfYAYKZF4\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 329, "user_id": 3864693, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9fdb906c8f4c915dbffd34cc27905d9f?s=128&d=identicon&r=PG&f=1", "display_name": "buurkeey", "link": "https://stackoverflow.com/users/3864693/buurkeey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585904980, "creation_date": 1562000134, "question_id": 56839515, "link": "https://stackoverflow.com/questions/56839515/not-able-to-set-date-for-native-date-field-on-android", "title": "Not able to set date for native date field on android", "body": "<p>I'm trying to set a date on a native android application using with Ruby + Appium + UIAutomator2.</p>\n\n<p>First, Appium desktop doesn't show native datepicker on the inspection field. So, I couldn't try to swipe for the datepicker wheels.\nAfter that I tried</p>\n\n<pre><code>send_keys()\n</code></pre>\n\n<p>but not a chance.</p>\n\n<p>Finally, I tried the command below with \"appium --relaxed-security\":</p>\n\n<p><code>driver.execute_script('mobile: shell', {'command': 'input text', 'args': '04 / 05 / 1990'})</code>\nbut it didn't work neiether.</p>\n\n<p>How to solve the issue? Thanks</p>\n"}, {"tags": ["ruby", "rspec", "jwt"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 3, "creation_date": 1562000672, "post_id": 56839509, "comment_id": 100231643, "body": "I am not sure why this is happening but you can try <code>::JWT</code> which makes it resolve to the outermost level"}, {"owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "reply_to_user": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 0, "creation_date": 1562000856, "post_id": 56839509, "comment_id": 100231703, "body": "good suggestion, wasnt successful - but I was able to get it working by using require_relative to the <code>&#47;lib&#47;jwt.rb</code> file for some reason"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562010411, "post_id": 56839509, "comment_id": 100235184, "body": "The &quot;some reason&quot; is not very mysterious. JWT was defined in <code>jwt.rb</code>. You hadn&#39;t loaded <code>jwt.rb</code>, so JWT didn&#39;t exist when you tried to use it and you got an error. The error said BACKBONE::JWT because you happened to be inside BACKBONE. If you had tried to use JWT inside a module called Foo the error would have said Foo::JWT, because Ruby starts looking in whatever module you&#39;re in. Once you loaded the file where JWT was defined, the error went away because JWT existed. It&#39;s not a case of RSpec or Ruby being mistaken about anything\u2014it&#39;s a case of trying to use a module you hadn&#39;t loaded."}, {"owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562092657, "post_id": 56839509, "comment_id": 100266678, "body": "@JordanRunning please move your response to an answer - that was the correct solution"}], "owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562000103, "creation_date": 1562000103, "question_id": 56839509, "link": "https://stackoverflow.com/questions/56839509/how-can-i-force-rspec-to-not-falsely-think-another-module-is-nested-inside-the-p", "title": "How can I force Rspec to not falsely think another module is nested inside the parent?", "body": "<p>I have an issue that's appearing only when running <code>rspec</code>, my application loads and works fine locally and in production</p>\n\n<p>rspec seems to think that the gem <code>JWT</code> belongs to my module <code>BACKBONE</code></p>\n\n<pre><code>An error occurred while loading spec_helper.\nFailure/Error: JWT.encode(payload, ENV['APP_SECRET'], 'HS256')\n\nNameError:\n  uninitialized constant BACKBONE::JWT\n# ./lib/jwt.rb:6:in `encode'\n# ./lib/backbone/policies.rb:7:in `&lt;class:Policy&gt;'\n# ./lib/backbone/policies.rb:5:in `&lt;module:BACKBONE&gt;'\n# ./lib/backbone/policies.rb:3:in `&lt;top (required)&gt;'\n# ./init.rb:10:in `load'\n# ./init.rb:10:in `block in &lt;module:CrewManagement&gt;'\n# ./init.rb:10:in `glob'\n# ./init.rb:10:in `&lt;module:CrewManagement&gt;'\n# ./init.rb:4:in `&lt;top (required)&gt;'\n# ./spec/spec_helper.rb:16:in `require'\n# ./spec/spec_helper.rb:16:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>files are listed in the order they are loaded into memory, it may be useful to note that I have several other applications with the same setup that are not experiencing this issue</p>\n\n<h1>/spec/spec_helper.rb</h1>\n\n<pre><code>require 'bundler'\nrequire 'simplecov'\nSimpleCov.start\n\nBundler.require :default\nDotenv.load(\"./.env.#{(ENV['RACK_ENV'] || 'development')}\")\n\nrequire 'rack/test'\nrequire './init'\n\n# ...\n</code></pre>\n\n<h1>/init.rb</h1>\n\n<pre><code>module CrewManagement\n  ## ...\n  Dir.glob('./lib/**/*.rb') { |file| load file }\n  ## ...\nend\n</code></pre>\n\n<h1>/lib/jwt.rb</h1>\n\n<pre><code>module BACKBONE\n  def self.encode(payload)\n    JWT.encode(payload, ENV['APP_SECRET'], 'HS256')\n  end\n\n  def self.decode(token)\n    JWT.decode(token, ENV['APP_SECRET'], true, algorithm: 'HS256')\n  end\nend\n</code></pre>\n\n<h1>/lib/backbone/policies.rb</h1>\n\n<pre><code>module BACKBONE\n  headers = { 'Authorization' =&gt; BACKBONE.encode(app: '...') }\nend\n</code></pre>\n"}, {"tags": ["ruby", "graphql"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562010890, "post_id": 56839500, "comment_id": 100235362, "body": "Understand that <code>&lt;&lt;~GQL</code> is the start of a Ruby <a href=\"https://infinum.co/the-capsized-eight/multiline-strings-ruby-2-3-0-the-squiggly-heredoc\" rel=\"nofollow noreferrer\">heredoc</a> string. The letters <code>GQL</code> in your code could be anything\u2014say, <code>&lt;&lt;~FOO</code> or <code>&lt;&lt;~RUTO</code>\u2014as long as the same letters came at the end. To debug this, the first step is to print out that string and see if it&#39;s a valid GraphQL query. I suspect you&#39;ll find that it&#39;s not."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1562011069, "post_id": 56839500, "comment_id": 100235422, "body": "The right way to fix this depends on which GraphQL library you&#39;re using, but regardless I&#39;m willing to bet string interpolation (<code>#{...}</code>) is <i>not</i> the correct way to insert variables into a query. See, for example, the docs for <a href=\"https://graphql-ruby.org/queries/executing_queries#variables\" rel=\"nofollow noreferrer\">variables in graphql-ruby</a>."}, {"owner": {"reputation": 2695, "user_id": 6488361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLWMu.jpg?s=128&g=1", "display_name": "Kaka Ruto", "link": "https://stackoverflow.com/users/6488361/kaka-ruto"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1562018367, "post_id": 56839500, "comment_id": 100237697, "body": "@JordanRunning I guess you are right. Because I have inserted the variables directly, i.e <code>firstName: &quot;Ava&quot;</code>, and it worked. Let me follow the link you&#39;ve shared to figure out the right way to pass variables. Thanks!"}], "owner": {"reputation": 2695, "user_id": 6488361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QLWMu.jpg?s=128&g=1", "display_name": "Kaka Ruto", "link": "https://stackoverflow.com/users/6488361/kaka-ruto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562010518, "creation_date": 1562000060, "last_edit_date": 1562010518, "question_id": 56839500, "link": "https://stackoverflow.com/questions/56839500/graphql-gql-cannot-parse-ruby-symbols-or-hashrockets", "title": "Graphql GQL cannot parse Ruby symbols or hashrockets", "body": "<p>I have the following method that parses the mutation into a GraphqL-readable format using <code>GQL</code></p>\n\n<pre><code>def query(attributes:)\n    &lt;&lt;~GQL\n      mutation {\n        createBook(\n          attributes: #{attributes}\n        ) {\n          id\n          title\n          publicationDate\n          genre\n        }\n      }\n    GQL\n  end\n</code></pre>\n\n<p>I then send a post request to the <code>/graphql</code> endpoint while passing what the <code>query</code> returns as params. As follows</p>\n\n<pre><code>post '/graphql', params: { query: query(attributes: attributes) }\n</code></pre>\n\n<p>When I hit the endpoint, I get the following error</p>\n\n<pre><code>{\"errors\"=&gt;[{\"message\"=&gt;\"Parse error on \\\":\\\" (COLON) }]}\n</code></pre>\n\n<p>I later realised that <code>GQL</code> cannot parse Ruby symbols , i.e <code>:first_name</code>. So I tried to convert the <code>attributes</code> hash keys into strings with <code>attributes.stringify</code>, but seems <code>GQL</code> doesn't also recognise Ruby hashrockets, so it threw the error </p>\n\n<pre><code>{\"errors\"=&gt;[{\"message\"=&gt;\"Parse error on \\\"first_name\\\" (STRING) }]}\n</code></pre>\n\n<p>Is there a way to make <code>GraphQL</code> to parse Ruby symbols and/or hashrockets?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561998343, "post_id": 56839074, "comment_id": 100230687, "body": "It would seem you&#39;re getting that error because you&#39;re calling <code>ForecastsFacade.new(temperature, weather_code, description, wind, humidity)</code>, but, like the error says, you don&#39;t define a method or variable named <code>temperature</code> (or <code>weather_code</code>, <code>description</code>, <code>wind</code>, or <code>humidity</code>). Where do you expect those values to be coming from?"}, {"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "reply_to_user": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561998465, "post_id": 56839074, "comment_id": 100230731, "body": "@jvillian these methods are in <code>app&#47;facades&#47;forecasts_facade.rb</code>"}, {"owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "edited": false, "score": 0, "creation_date": 1561998706, "post_id": 56839074, "comment_id": 100230843, "body": "Right, but not in <code>ForecastsController</code>, which is why you can&#39;t call those methods in <code>ForecastsController</code>."}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1562001437, "post_id": 56839336, "comment_id": 100231943, "body": "Thanks for your help! Much appreciated. That&#39;s throwing a <code>ArgumentError in Forecasts#current_weather. Nil location provided. Can&#39;t build URI. </code> It might have something to do with my helper where the images are stored (have added that code to the question) but can&#39;t work out why"}, {"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1562004927, "post_id": 56839336, "comment_id": 100233291, "body": "AH, fixed it by adjusting my helper :) Thanks again for your help!"}], "tags": [], "owner": {"reputation": 18856, "user_id": 1359650, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/dffc4318ac93e728a26c8e8b51b4eb37?s=128&d=identicon&r=PG", "display_name": "jvillian", "link": "https://stackoverflow.com/users/1359650/jvillian"}, "is_accepted": true, "score": 2, "last_activity_date": 1561999276, "creation_date": 1561999276, "answer_id": 56839336, "question_id": 56839074, "link": "https://stackoverflow.com/questions/56839074/why-am-i-getting-a-nameerror-when-trying-to-shift-some-code-to-a-facade/56839336#56839336", "title": "Why am I getting a NameError when trying to shift some code to a facade?", "body": "<p>I believe you want your controller to look more like: </p>\n\n<pre><code>class ForecastsController &lt; ApplicationController\n\n  TOKEN = Rails.application.credentials.openweather_key\n\n  def current_weather\n    @city = params[:q]\n    if @city.nil?\n      @forecast = {}\n    else\n      @forecast = OpenWeatherApi.new(@city, TOKEN).my_location_forecast\n    end\n    @forecasts_facade = ForecastsFacade.new(@forecast)\n  end\nend\n</code></pre>\n\n<p>Then, your <code>ForecastsFacade</code> more like:</p>\n\n<pre><code>class ForecastsFacade\n\n  attr_accessor *%w(\n    forecast\n  ).freeze\n\n  def initialize(forecast)\n    @forecast = forecast\n  end\n\n  def temperature\n    @temperature = forecast.dig('main', 'temp').to_i - 273\n  end\n\n  def weather_code\n    @weather_code = forecast.dig('weather', 0, 'id').to_i\n  end\n\n  def description\n    @description = forecast.dig('weather', 0, 'description')\n  end\n\n  def wind\n    @wind = forecast.dig('wind', 'speed').to_i\n  end\n\n  def humidity\n    @humidity = forecast.dig('main', 'humidity')\n  end\n\n  def invalid_city?\n    forecast.dig('cod').to_i == 404 \n  end\n\n  def missing_city?\n    forecast.dig('cod').to_i == 400\n  end\n\nend\n</code></pre>\n\n<p>Then, in your view, it seems to be weird to do stuff like: </p>\n\n<pre><code>@forecasts_facade.forecast.dig('cod').to_i == 404\n</code></pre>\n\n<p>when the whole point is to hide this detail from the <code>view</code>. So, perhaps, something more like: </p>\n\n<pre><code>&lt;div class=\"page-wrapper\"&gt;\n  &lt;h1 class=\"title\"&gt;The weather in GIFs&lt;/h1&gt;\n\n  &lt;div class=\"search\"&gt;\n    &lt;%= form_tag(current_weather_forecasts_path, method: :get) do %&gt;\n      &lt;%= text_field_tag :q, nil, placeholder: \"Enter a city\", class: \"search-field\" %&gt;\n      &lt;%= button_tag type: 'submit', class: \"search-button\" do %&gt;\n        &lt;i class=\"fas fa-search\"&gt;&lt;/i&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;% if @forecasts_facade.invalid_city? %&gt;\n    &lt;p&gt;Please use a valid city name!&lt;/p&gt;\n  &lt;% elsif @forecasts_facade.missing_city? %&gt;\n    &lt;p&gt;Please type in a city name!&lt;/p&gt;\n  &lt;% elsif @forecasts_facade.forecast.blank? %&gt;\n  &lt;% else %&gt;\n    &lt;p class=\"weather-description\"&gt;&lt;%= \"#{@forecasts_facade.city.capitalize}: #{@forecasts_facade.description}\" %&gt;&lt;/p&gt;\n    &lt;div class=\"gif-container\"&gt;&lt;%= image_tag(find_gif_url, class: \"gif\") %&gt;\n      &lt;span class=\"temperature weather-attribute\"&gt;&lt;%= \"#{@forecasts_facade.temperature}\u00b0C\" %&gt;&lt;/span&gt;\n      &lt;span class=\"wind weather-attribute\"&gt;&lt;%= \"wind:#{(@forecasts_facade.wind * 3.6).to_i}km/h\" %&gt;&lt;/span&gt; &lt;!-- converts to km/hr --&gt;\n      &lt;span class=\"humidity weather-attribute\"&gt;&lt;%= \"humidity:#{@forecasts_facade.humidity}%\" %&gt;&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>It looks like you don't use that <code>elsif @forecasts_facade.forecast.blank?</code> branch. Not sure what's up wtih that.</p>\n"}], "owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 56839336, "answer_count": 1, "score": 1, "last_activity_date": 1562001239, "creation_date": 1561998050, "last_edit_date": 1562001239, "question_id": 56839074, "link": "https://stackoverflow.com/questions/56839074/why-am-i-getting-a-nameerror-when-trying-to-shift-some-code-to-a-facade", "title": "Why am I getting a NameError when trying to shift some code to a facade?", "body": "<p>I had a lot of instance variables in a controller action and I'm trying to move them into a facade but I've ran into an error. I'm new to Rails, so I'm having a bit of trouble.</p>\n\n<p>My app contacts the Open Weather API and returns some weather parameters (temperature, wind, humidity etc). The API call is handled in a service class and I'm trying to use the facade pattern and have some methods in a PORO that organise the returned data, which is then presented in my view. At the moment i'm getting a <code>NameError. undefined local variable or method 'temperature' for ForecastsController</code>. I'm new to this so any help would be much appreciated! My code is below.</p>\n\n<p>app/services/open_weather_api.rb</p>\n\n<pre><code>class OpenWeatherApi\n  include HTTParty\n  base_uri \"http://api.openweathermap.org\"\n\n  def initialize(city, appid)\n    @options = { query: { q: city, APPID: appid } }\n  end\n\n  def my_location_forecast\n    self.class.get(\"/data/2.5/weather\", @options)\n  end\nend\n</code></pre>\n\n<p>app/facades/forecasts_facade.rb</p>\n\n<pre><code>class ForecastsFacade\n\n  def initialize(temperature, weather_code, description, wind, humidity)\n    @temperature = temperature\n    @weather_code = weather_code\n    @description = description\n    @wind = wind\n    @humidity = humidity\n  end\n\n  def temperature\n    @temperature = @forecast.dig('main', 'temp').to_i - 273\n  end\n\n  def weather_code\n    @weather_code = @forecast.dig('weather', 0, 'id').to_i\n  end\n\n  def description\n    @description = @forecast.dig('weather', 0, 'description')\n  end\n\n  def wind\n    @wind = @forecast.dig('wind', 'speed').to_i\n  end\n\n  def humidity\n    @humidity = @forecast.dig('main', 'humidity')\n  end\nend\n</code></pre>\n\n<p>app/controllers/forecasts_controller.rb</p>\n\n<pre><code>class ForecastsController &lt; ApplicationController\n\n  TOKEN = Rails.application.credentials.openweather_key\n\n  def current_weather\n    @city = params[:q]\n    if @city.nil?\n      @forecast = {}\n    else\n      @forecast = OpenWeatherApi.new(@city, TOKEN).my_location_forecast\n    end\n    @forecasts_facade = ForecastsFacade.new(temperature, weather_code, description, wind, humidity)\n  end\nend\n</code></pre>\n\n<p>app/views/forecasts/current_weather.html.erb</p>\n\n<pre><code>&lt;div class=\"page-wrapper\"&gt;\n  &lt;h1 class=\"title\"&gt;The weather in GIFs&lt;/h1&gt;\n\n  &lt;div class=\"search\"&gt;\n    &lt;%= form_tag(current_weather_forecasts_path, method: :get) do %&gt;\n      &lt;%= text_field_tag :q, nil, placeholder: \"Enter a city\", class: \"search-field\" %&gt;\n      &lt;%= button_tag type: 'submit', class: \"search-button\" do %&gt;\n        &lt;i class=\"fas fa-search\"&gt;&lt;/i&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;% if @forecasts_facade.forecast.dig('cod').to_i == 404 %&gt;\n    &lt;p&gt;Please use a valid city name!&lt;/p&gt;\n  &lt;% elsif @forecasts_facade.forecast.dig('cod').to_i == 400 %&gt;\n    &lt;p&gt;Please type in a city name!&lt;/p&gt;\n  &lt;% elsif @forecasts_facade.forecast == {} %&gt;\n  &lt;% else %&gt;\n    &lt;p class=\"weather-description\"&gt;&lt;%= \"#{@forecasts_facade.city.capitalize}: #{@forecasts_facade.description}\" %&gt;&lt;/p&gt;\n    &lt;div class=\"gif-container\"&gt;&lt;%= image_tag(find_gif_url, class: \"gif\") %&gt;\n      &lt;span class=\"temperature weather-attribute\"&gt;&lt;%= \"#{@forecasts_facade.temperature}\u00b0C\" %&gt;&lt;/span&gt;\n      &lt;span class=\"wind weather-attribute\"&gt;&lt;%= \"wind:#{(@forecasts_facade.wind * 3.6).to_i}km/h\" %&gt;&lt;/span&gt; &lt;!-- converts to km/hr --&gt;\n      &lt;span class=\"humidity weather-attribute\"&gt;&lt;%= \"humidity:#{@forecasts_facade.humidity}%\" %&gt;&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>app/helpers/forecasts_helper.rb</p>\n\n<pre><code>module ForecastsHelper\n  GIFS = {\n    thunder:\n      {codes: [200, 201, 202, 210, 211, 212, 221, 230, 231, 232],\n       urls: %w(\n          https://media.giphy.com/media/26uf5HjasTtxtNCqQ/giphy.gif\n          https://media.giphy.com/media/vS09bj1KrXwje/giphy.gif\n          https://media.giphy.com/media/l41YsrmiyeNZtmecw/giphy.gif\n)},\n    light_rain:\n      {codes: [300, 301, 302, 310, 311, 312, 313, 314, 321, 500, 501, 520, 521],\n       urls: %w(\n          https://media.giphy.com/media/xT9GEz2CeU9uaI2KZi/giphy.gif\n          https://media.giphy.com/media/l0Expn6D0D3g9NExq/giphy.gif\n          https://media.giphy.com/media/14d8cRr25KPxbG/giphy.gif\n)},\n\n  def find_gif_url\n    GIFS.each do |key, value|\n      if value[:codes].include? @weather_code\n        return value[:urls].sample\n      end\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "methods", "reduce"], "comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 2, "creation_date": 1561997133, "post_id": 56838660, "comment_id": 100230211, "body": "Congrats for the question. We don&#39;t see complete specs every day."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 1, "creation_date": 1561997395, "post_id": 56838660, "comment_id": 100230307, "body": "I wonder why you do not use the build in method: <code>all?</code>, <code>any?</code>, <code>none?</code> and <code>sum</code>?"}, {"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 0, "creation_date": 1561997436, "post_id": 56838660, "comment_id": 100230324, "body": "Thanks, trial and error. I noticed I needed to provide the full details to get both the answer and explanation I need to learn!"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 0, "creation_date": 1562052603, "post_id": 56838775, "comment_id": 100245510, "body": "Appreciate the details! Thank you!"}], "tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 5, "last_activity_date": 1561996731, "creation_date": 1561996731, "answer_id": 56838775, "question_id": 56838660, "link": "https://stackoverflow.com/questions/56838660/using-a-method-that-accepts-blocks-and-can-return-truthy-or-falsey-values/56838775#56838775", "title": "Using a method that accepts blocks and can return truthy or falsey values", "body": "<ol>\n<li>If your job is to write your own <code>reduce</code>, don't use <code>Enumerable#reduce</code> inside. You can use <code>Enumerable#each</code> or <code>for</code>/<code>while</code> loop</li>\n<li>You can pass a block to another method just as you do it with <code>method(arg1, arg2, &amp;block)</code>.</li>\n<li>You can call your block with <code>#call</code>, e.g. <code>block.call(arg1, arg2)</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 0, "creation_date": 1561997387, "post_id": 56838834, "comment_id": 100230303, "body": "I see, that was very helpful. I will remember that one!"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 1, "creation_date": 1562003071, "post_id": 56838834, "comment_id": 100232544, "body": "@RoderickCardenas: Be sure to check mrzasa&#39;s answer too, specifically the 1st point."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 3, "last_activity_date": 1561997002, "creation_date": 1561997002, "answer_id": 56838834, "question_id": 56838660, "link": "https://stackoverflow.com/questions/56838660/using-a-method-that-accepts-blocks-and-can-return-truthy-or-falsey-values/56838834#56838834", "title": "Using a method that accepts blocks and can return truthy or falsey values", "body": "<p>You cannot specify a default value for <code>starting_point</code> which will work for every use case, since you want to use numbers &amp; booleans.</p>\n\n<p>If you don't specify a <code>starting_point</code>, <code>reduce</code> will simply use the first <a href=\"https://ruby-doc.org/core-2.6.3/Enumerable.html#method-i-inject\" rel=\"nofollow noreferrer\">element as starting_point</a>:</p>\n\n<pre><code>def reduce(elements, starting_point = nil, &amp;block)\n  if starting_point.nil?\n    elements.reduce(&amp;block)\n  else\n    elements.reduce(starting_point, &amp;block)\n  end\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1562002987, "post_id": 56838945, "comment_id": 100232511, "body": "Specs all seem reasonable. It means the tests should be made to pass by simply touching the code, no changing the specs."}], "tags": [], "owner": {"reputation": 13756, "user_id": 567762, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/908c9abc72ab86111a153b11cb584f26?s=128&d=identicon&r=PG", "display_name": "Jared Beck", "link": "https://stackoverflow.com/users/567762/jared-beck"}, "is_accepted": false, "score": 2, "last_activity_date": 1561997432, "creation_date": 1561997432, "answer_id": 56838945, "question_id": 56838660, "link": "https://stackoverflow.com/questions/56838660/using-a-method-that-accepts-blocks-and-can-return-truthy-or-falsey-values/56838945#56838945", "title": "Using a method that accepts blocks and can return truthy or falsey values", "body": "<p>I think the failing test should specify a <code>starting_point</code>.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>  it \"returns true when a truthy value is present\" do\n    source_array = [ false, nil, nil, nil, true]\n    - expect(reduce(source_array){|memo, n| memo || n}).to eq(true)\n    + expect(reduce(source_array, false){|memo, n| memo || n}).to eq(true)\n  end\n</code></pre>\n\n<p>The meaning of <code>||</code> depends on the left-hand side. <code>Integer#||</code> is different from eg. <code>FalseClass#||</code>. They are different methods.</p>\n"}], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 56838834, "answer_count": 3, "score": 3, "last_activity_date": 1562017074, "creation_date": 1561996174, "last_edit_date": 1562017074, "question_id": 56838660, "link": "https://stackoverflow.com/questions/56838660/using-a-method-that-accepts-blocks-and-can-return-truthy-or-falsey-values", "title": "Using a method that accepts blocks and can return truthy or falsey values", "body": "<p>So, I am back with another question! I have learned how to accept arguments with blocks but I need now to place a block in my method (I think). </p>\n\n<p>Here is what I have to do, it's a generalized <code>reduce</code> method with the following tests going through it:</p>\n\n<pre><code>describe 'my own reduce' do\n  it \"returns a running total when not given a starting point\" do\n    source_array = [1,2,3]\n    expect(reduce(source_array){|memo, n| memo + n}).to eq(6)\n  end\n\n  it \"returns a running total when given a starting point\" do\n    source_array = [1,2,3]\n    starting_point = 100\n    expect(reduce(source_array, starting_point){|memo, n| memo + n}).to eq(106)\n  end\n\n  it \"returns true when all values are truthy\" do\n    source_array = [1, 2, true, \"razmatazz\"]\n    expect(reduce(source_array){|memo, n| memo &amp;&amp; n}).to be_truthy\n  end\n\n  it \"returns false when any value is false\" do\n    source_array = [1, 2, true, \"razmatazz\", false]\n    expect(reduce(source_array){|memo, n| memo &amp;&amp; n}).to be_falsy\n  end\n\n  it \"returns true when a truthy value is present\" do\n    source_array = [ false, nil, nil, nil, true]\n    expect(reduce(source_array){|memo, n| memo || n}).to eq(true)\n  end\n\n  it \"returns false when no truthy value is present\" do\n    source_array = [ false, nil, nil, nil]\n    expect(reduce(source_array){|memo, n| memo &amp;&amp; n}).to eq(false)\n  end\nend\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>def reduce(element1, starting_point = 0, &amp;block)\n  element1.reduce(starting_point, &amp;block)\nend\n</code></pre>\n\n<p>Which passes 4 out of the 6 tests. But the last part requires checking the values in the <code>source_array</code> and if any are truthy return true or if any are falsey, return false. I tried putting in the follow block along with the <code>reduce</code> method:</p>\n\n<pre><code>def reduce(element1, starting_point = 0, &amp;block)\n  element1.reduce(starting_point, &amp;block){ |x, y| if x || y = true; p true; else p false; end}\nend\n</code></pre>\n\n<p>If you look at the tests, you can see it will pass one array with 'true' and one with 'false' and I need it to work for all the 6 tests.</p>\n\n<p>Please, any explanation has been helping me greatly.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "text", "types"], "answers": [{"tags": [], "owner": {"reputation": 8645, "user_id": 368167, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c9596f533dcd61ecf75f150b0d9997b3?s=128&d=identicon&r=PG", "display_name": "Tamer Shlash", "link": "https://stackoverflow.com/users/368167/tamer-shlash"}, "is_accepted": false, "score": 2, "last_activity_date": 1561994923, "creation_date": 1561994923, "answer_id": 56838359, "question_id": 56838332, "link": "https://stackoverflow.com/questions/56838332/how-do-i-display-the-text-with-all-of-the-tabs-and-new-lines-t-and-n-in-ruby/56838359#56838359", "title": "How do I display the text with all of the tabs and new lines (\\t and \\n) in Ruby on Rails?", "body": "<p>Use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/pre\" rel=\"nofollow noreferrer\">HTML <code>&lt;pre&gt;</code></a> tag.</p>\n\n<pre><code>&lt;pre&gt; &lt;%= @user.output %&gt; &lt;/pre&gt;\n</code></pre>\n\n<p>You could also use it in combination with the <code>&lt;code&gt;</code> tag, see <a href=\"https://stackoverflow.com/questions/4611591/code-vs-pre-vs-samp-for-inline-and-block-code-snippets\">this question</a> for the difference.</p>\n"}], "owner": {"reputation": 31, "user_id": 11594273, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IOFEkvCMF2w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdD4pEG-eRD8Il9rR4YHnkTVe-dJA/mo/photo.jpg?sz=128", "display_name": "sr1", "link": "https://stackoverflow.com/users/11594273/sr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561994923, "creation_date": 1561994792, "question_id": 56838332, "link": "https://stackoverflow.com/questions/56838332/how-do-i-display-the-text-with-all-of-the-tabs-and-new-lines-t-and-n-in-ruby", "title": "How do I display the text with all of the tabs and new lines (\\t and \\n) in Ruby on Rails?", "body": "<p>I have a variable 'messages' of type array and whenever I put it into the terminal it has tabs and new lines but whenever I save messages to a variable and display it on my rails application, it no longer has these. How do I fix this so it shows the new lines and tabs on the rails app.</p>\n\n<p>Code for outputting to the terminal in model (User): </p>\n\n<pre><code>   def runMessages\n     messages &lt;&lt; stdout.read\n     messages &lt;&lt; stderr.read\n     puts \"OUTPUT IS:\" + messages[0]\n     messages\n   end\n</code></pre>\n\n<p>Code in controller for saving to variable:</p>\n\n<pre><code>   messages = @user.runMessages\n   @user.output = messages[0]\n</code></pre>\n\n<p>Code in views:</p>\n\n<pre><code>    &lt;p&gt; &lt;%= @user.output %&gt; &lt;/p&gt;\n</code></pre>\n\n<p>In the terminal it looks something like this: </p>\n\n<pre><code>    Beginning run ...\n    Done.\n</code></pre>\n\n<p>While on the application it looks like this:</p>\n\n<pre><code>Beginning run...Done.\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1561992840, "post_id": 56837845, "comment_id": 100228180, "body": "name your file in lower-case, <code>mdms.rb</code>. And do you also have a module <code>MDMS</code>?"}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "edited": false, "score": 0, "creation_date": 1561994559, "post_id": 56837845, "comment_id": 100229041, "body": "I changed it to mdms in lowercase and it works."}, {"owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1561994604, "post_id": 56837845, "comment_id": 100229064, "body": "@SergioTulentsev you can answer the question if you want. The first is the right one. Thank you!"}, {"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1561994909, "post_id": 56837845, "comment_id": 100229200, "body": "@SergioTulentsev I can confirm the same as you and thus will remove my comment. It appears this is only an issue when there is a mix case situation like <code>RESTful #=&gt; &quot;res_tful&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1561998742, "creation_date": 1561998742, "answer_id": 56839216, "question_id": 56837845, "link": "https://stackoverflow.com/questions/56837845/why-my-module-is-not-being-loaded-in-rails/56839216#56839216", "title": "Why my Module is not being loaded in Rails?", "body": "<blockquote>\n  <p>Inside my app/models/MDMS.rb I have</p>\n</blockquote>\n\n<p>Your files should be named in snake_case. In this particular case, it should be named <code>mdms.rb</code></p>\n"}], "owner": {"reputation": 195, "user_id": 10219849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jd7rJQbzJLE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qytUQDlayHmqU1rzkDZco0givpbQ/mo/photo.jpg?sz=128", "display_name": "Fernando Maymone", "link": "https://stackoverflow.com/users/10219849/fernando-maymone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561998742, "creation_date": 1561992768, "question_id": 56837845, "link": "https://stackoverflow.com/questions/56837845/why-my-module-is-not-being-loaded-in-rails", "title": "Why my Module is not being loaded in Rails?", "body": "<p>I have an application that runs perfectly on my OSX environment. Now Im creating a Ubuntu env from scratch and having a weird class loading issue on my Rails application. </p>\n\n<p>Inside my app/models/MDMS.rb I have</p>\n\n<pre><code>class MDMS\n  include HTTParty\n\n  base_uri APP_CONFIG.mdms_url\n\n  def self.ip2location(ip)\n    Rails.cache.fetch(\"MDMS#ip2location(#{ip || 'empty'})\", expires_in: 15.days) do\n      request(\"/api/v1/ip2location\", { ip: ip })[:data]\n    end\n  end\n</code></pre>\n\n<p>And in my application_controller I have a call for this model. Like this: </p>\n\n<pre><code> if @zip.blank?\n    byebug\n    #guess from IP\n    #r = MDMS.ip2location(request.remote_ip)\n    r = MDMS.ip2location(\"216.189.182.112\")\n    @zip = session[:zip]  = r['zip_code']\n    update_user_zip_attributes(r)\n    if !@zip.blank?\n      set_legacy_zip_cookie(r['zip_code'])\n    end\n  end\n</code></pre>\n\n<p>The problem is. When I try to run it I got an error: </p>\n\n<pre><code>NoMethodError (undefined method `ip2location' for MDMS:Module):\n  app/controllers/application_controller.rb:90:in `current_zip'\n</code></pre>\n\n<p>So, I dont know why this is happening. Maybe a classloader issue? Someone have ideas on what to try to solve this? </p>\n\n<p>Thank You</p>\n"}, {"tags": ["ruby", "selenium", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1561993434, "post_id": 56837979, "comment_id": 100228477, "body": "Unfortunately im purely running on ruby in this case :/"}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 1, "creation_date": 1561993574, "post_id": 56837979, "comment_id": 100228546, "body": "I added the Ruby tag to the question"}], "tags": [], "owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "is_accepted": false, "score": 1, "last_activity_date": 1561993489, "last_edit_date": 1561993489, "creation_date": 1561993291, "answer_id": 56837979, "question_id": 56837464, "link": "https://stackoverflow.com/questions/56837464/capybara-wait-until-button-is-enabled/56837979#56837979", "title": "Capybara wait until button is enabled?", "body": "<p>In Python you can do something like this:</p>\n\n<pre><code>def wait_until_clickable(driver, xpath, timeout = 1):\n    while timeout &gt; 0:\n        try:\n            element = driver.find_element_by_xpath(xpath)\n            element.click()\n            return element\n\n        except:\n            time.sleep(0.1)\n            timeout = timeout - 0.1\n\n    return False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 0, "creation_date": 1561995744, "post_id": 56838212, "comment_id": 100229599, "body": "Im using <code>click_button</code> as it is actually a button with a <code>disabled</code> tag, but it seems to fail regardless. But this could just be a wait time problem as since it&#39;s a dropdown animation maybe it&#39;s just not long enough.  Can I do something like <code>click_button(&#39;button&#39;, wait: 10)</code> ? Or do I specifically need to use find.  Also what exactly do you mean by &quot;selector&quot; types. Im selecting based off the label text."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 1, "creation_date": 1561996232, "post_id": 56838212, "comment_id": 100229824, "body": "Yes, you can pass <code>wait</code> like that to <code>click_button</code>. As for selector types,   <code>click_button(&#39;x&#39;&#39;)</code> is implemented as <code>find(:button, &#39;x&#39;).click</code> where <code>:button</code> is the selector type. Capybara provides a number of selector types - <a href=\"https://github.com/teamcapybara/capybara/blob/master/lib/capybara/selector.rb#L52\" rel=\"nofollow noreferrer\">github.com/teamcapybara/capybara/blob/master/lib/capybara/&hellip;</a> - that find specific types of elements with relevant filters - and you can add your own custom selector types too - <a href=\"https://github.com/teamcapybara/capybara#xpath-css-and-selectors\" rel=\"nofollow noreferrer\">github.com/teamcapybara/capybara#xpath-css-and-selectors</a>."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "reply_to_user": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "edited": false, "score": 1, "creation_date": 1561996406, "post_id": 56838212, "comment_id": 100229893, "body": "Since you mention animation - it&#39;s also possible the button is enabled but being moved on the page.  That can also make clicking unreliable since the click doesn&#39;t always happen in the right place. To solve that you would need to find something on the page that indicates the animation has completed, change the page to only enable the button once the animation has completed, or disable animation while testing.  The best way to disable animation depends on everything being used for the animation, but setting <code>Capybara.disable_animation = true</code> in your config can do it in some cases."}], "tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 1, "last_activity_date": 1561994295, "creation_date": 1561994295, "answer_id": 56838212, "question_id": 56837464, "link": "https://stackoverflow.com/questions/56837464/capybara-wait-until-button-is-enabled/56838212#56838212", "title": "Capybara wait until button is enabled?", "body": "<p>Assuming the button you're referring to is actually a button (&lt;button> element, or &lt;input> element with type submit, reset, image, or button) then Capybaras :button selector will (by default) wait for it to be non-disabled.  </p>\n\n<pre><code>click_button('Something')\n</code></pre>\n\n<p>or</p>\n\n<pre><code>find_button('button_id').click\n</code></pre>\n\n<p>or </p>\n\n<pre><code>find(:button, 'button_value').click\n</code></pre>\n\n<p>If any of the finder or action methods aren't waiting long enough for a specific element you can always increase the maximum wait time for a specific finder/action by passing a :wait option</p>\n\n<pre><code>find(:button, 'Something', wait: 10).click\n</code></pre>\n\n<p>If you're not using selector types (if not, why not) and instead are just using raw CSS to locate the element then  you can use the <code>:enabled</code> pseudo class along with your existing CSS and something like</p>\n\n<pre><code>find('#my_button:enabled', wait: 10).click\n</code></pre>\n\n<p>If the element you're calling a button isn't actually a button but some other type of element (&lt;a> etc) styled to look like a button, then you'll need to explain exactly how you're disabling the \"button\".</p>\n"}], "owner": {"reputation": 1823, "user_id": 5065860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/faadf161352c9fca88a34c8f05103185?s=128&d=identicon&r=PG&f=1", "display_name": "msmith1114", "link": "https://stackoverflow.com/users/5065860/msmith1114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "accepted_answer_id": 56838212, "answer_count": 2, "score": 0, "last_activity_date": 1561994295, "creation_date": 1561991262, "last_edit_date": 1561994026, "question_id": 56837464, "link": "https://stackoverflow.com/questions/56837464/capybara-wait-until-button-is-enabled", "title": "Capybara wait until button is enabled?", "body": "<p>Surprised I actually haven't come across this, but I have a simple button that is disabled until a dropdown is selected. Sometimes the page isn't fast enough to \"enable\" the button to be clicked on after the previous dropdown is selected causing it to fail.</p>\n\n<p>I could throw in a \"sleep\" of a second or two and fix this, but that seems like a lazy/poor way to do this.</p>\n\n<p>Is there a way in capybara (or purely selenium) that I can make it wait until the button is actually enabled? I'd like to throw this is the page model method for this button (as im trying to avoid API specific methods/selenium/etc... in the actual test specs (Although I can if I need to).</p>\n\n<p>FWIW this is specifically for Ruby's capybara framework but pure selenium is fine as well.</p>\n"}, {"tags": ["arrays", "ruby", "dictionary", "methods"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 1, "creation_date": 1561992402, "post_id": 56837331, "comment_id": 100227962, "body": "I guess you could go with <code>def map(element1,&amp;block); element1.map(&amp;block); end</code>. Other options include <code>element1.each_with_object([]) {|e, arr| arr &lt;&lt; yield e }</code> or create a class, include <code>Enumerable</code>, instantiate with <code>element1</code> e.g. <code>def initialize(e); @element1 = e; end</code>, and define <code>each</code> as <code>def each(&amp;block); @element1.each(&amp;block); end</code>"}, {"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "reply_to_user": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1561992735, "post_id": 56837331, "comment_id": 100228123, "body": "That answered it and makes sense, the tests are passing an array and a block. Thank you"}, {"owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "edited": false, "score": 0, "creation_date": 1561995011, "post_id": 56837331, "comment_id": 100229249, "body": "pls. conside upvoting the accepted answer (it&#39;s worth even more than accepting)"}, {"owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "edited": false, "score": 1, "creation_date": 1561996222, "post_id": 56837331, "comment_id": 100229818, "body": "Ah thanks, wasn&#39;t aware!  :)"}], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": true, "score": 0, "last_activity_date": 1561990981, "creation_date": 1561990981, "answer_id": 56837390, "question_id": 56837331, "link": "https://stackoverflow.com/questions/56837331/using-a-generalized-map-method-to-pass-an-element-and-block-through-returning-mu/56837390#56837390", "title": "Using a generalized map method to pass an element and block through returning multiple outcomes", "body": "<p>You shouldn't use <code>Enumerable#map</code> to implement your own <code>map</code>. </p>\n\n<ol>\n<li>Use <code>while</code> or <code>for</code> loops or (and it'll be the best solution) <code>Enumerable#each</code>.</li>\n<li>Let your <code>map</code> accept a block and the call this block inside the loop or pass it to <code>each</code></li>\n</ol>\n"}], "owner": {"reputation": 85, "user_id": 11049762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jtvd9b_Qt8I/AAAAAAAAAAI/AAAAAAAAAAc/UEXSHz-9C6Q/photo.jpg?sz=128", "display_name": "Roderick Cardenas", "link": "https://stackoverflow.com/users/11049762/roderick-cardenas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56837390, "answer_count": 1, "score": 0, "last_activity_date": 1561991413, "creation_date": 1561990772, "question_id": 56837331, "link": "https://stackoverflow.com/questions/56837331/using-a-generalized-map-method-to-pass-an-element-and-block-through-returning-mu", "title": "Using a generalized map method to pass an element and block through returning multiple outcomes", "body": "<p>I hope you can help me out. I am trying to understand what's going on but here is what I have to do:</p>\n\n<p>Write a generalized map and reduce method. Both of these methods will take a block and require that you pass information between the method and the block.</p>\n\n<p>This is what the test is looking for:</p>\n\n<pre><code>describe 'my own map' do\n  it \"returns an array with all values made negative\" do\n    expect(map([1, 2, 3, -9]){|n| n * -1}).to eq([-1, -2, -3, 9])\n  end\n\n  it \"returns an array with the original values\" do\n    dune = [\"paul\", \"gurney\", \"vladimir\", \"jessica\", \"chani\"]\n    expect(map(dune){|n| n}).to eq(dune)\n  end\n\n  it \"returns an array with the original values multiplied by 2\" do\n    expect(map([1, 2, 3, -9]){|n| n * 2}).to eq([2, 4, 6, -18])\n  end\n\n  it \"returns an array with the original values squared\" do\n    expect(map([1, 2, 3, -9]){|n| n * n}).to eq([1, 4, 9, 81])\n  end\nend\n\n</code></pre>\n\n<p>My code so far:</p>\n\n<pre><code>def map(element1) \n  element1.map { |n| n * -1 }\nend\n</code></pre>\n\n<p>Now I haven't entered anything further because I need to understand how to use the same method that will be looking for different things? </p>\n\n<p>Here are the errors:</p>\n\n<pre><code>my own map\n  returns an array with all values made negative\n  returns an array with the original values (FAILED - 1)\n  returns an array with the original values multiplied by 2 (FAILED - 2)\n  returns an array with the original values squared (FAILED - 3)\n\n     ArgumentError:\n       negative argument\n     # ./lib/my_code.rb:2:in `*'\n     # ./lib/my_code.rb:2:in `block in map'\n     # ./lib/my_code.rb:2:in `map'\n     # ./lib/my_code.rb:2:in `map'\n     # ./spec/generalized_map_and_reduce_spec.rb:10:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Thank you for taking a look and any help in the right direction is much appreciated.</p>\n"}, {"tags": ["ruby", "rounding"], "comments": [{"owner": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "edited": false, "score": 2, "creation_date": 1561987807, "post_id": 56836563, "comment_id": 100225580, "body": "This will answer your question: <a href=\"https://stackoverflow.com/a/2910284/2424975\">stackoverflow.com/a/2910284/2424975</a>"}, {"owner": {"reputation": 11, "user_id": 6411910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd6caa14bd5727d542605c5cbefe80db?s=128&d=identicon&r=PG&f=1", "display_name": "JWilks", "link": "https://stackoverflow.com/users/6411910/jwilks"}, "reply_to_user": {"reputation": 3259, "user_id": 2424975, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jDtKZ.jpg?s=128&g=1", "display_name": "Cereal", "link": "https://stackoverflow.com/users/2424975/cereal"}, "edited": false, "score": 0, "creation_date": 1561988227, "post_id": 56836563, "comment_id": 100225809, "body": "Thanks, so (75.6 * 100).round(2) would be a workable way to get 7560 ?"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1561995407, "post_id": 56836563, "comment_id": 100229440, "body": "@JWilks: <code>(75.6 * 100).round</code> would give you <code>7560</code>. Is it what you want?"}], "owner": {"reputation": 11, "user_id": 6411910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd6caa14bd5727d542605c5cbefe80db?s=128&d=identicon&r=PG&f=1", "display_name": "JWilks", "link": "https://stackoverflow.com/users/6411910/jwilks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1561989890, "answer_count": 0, "score": 0, "last_activity_date": 1561987864, "creation_date": 1561987675, "last_edit_date": 1561987864, "question_id": 56836563, "link": "https://stackoverflow.com/questions/56836563/ruby-unexpected-output-when-multiplying", "closed_reason": "Duplicate", "title": "Ruby unexpected output when multiplying", "body": "<p>Probably not grasping something simple, but can someone explain whats happening here:</p>\n\n<pre><code>irb(main):042:0&gt; 75.5 * 100\n=&gt; 7550.0\nirb(main):043:0&gt; 75.6 * 100\n=&gt; 7559.999999999999\nirb(main):044:0&gt; 75.7 * 100\n=&gt; 7570.0\n</code></pre>\n\n<p>also</p>\n\n<pre><code>irb(main):049:0&gt; 75.6.class\n=&gt; Float\nirb(main):050:0&gt; 75.6.to_f * 100\n=&gt; 7559.999999999999\nirb(main):051:0&gt; 75.6.to_f * 100.to_i\n=&gt; 7559.999999999999\nirb(main):052:0&gt; 75.6.to_f * 100.to_f\n=&gt; 7559.999999999999\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "soap", "savon"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1561985646, "post_id": 56835818, "comment_id": 100224440, "body": "<i>&quot;sometimes the response xmls are showing in multiple lines&quot;</i> \u2013 try to narrow down &quot;sometimes&quot;. There&#39;s probably a reason for that."}, {"owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561986117, "post_id": 56835818, "comment_id": 100224697, "body": "Thanks a lot for your comment. By &#39;sometime&#39; I meant to say, when the response xml size is very big compared to others. But I maybe wrong as I don&#39;t know the exact reason. The size issue maybe a problem to break down to xml to new lines."}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1561997671, "post_id": 56835818, "comment_id": 100230416, "body": "are you getting this output in logs or where?"}, {"owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "reply_to_user": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "edited": false, "score": 0, "creation_date": 1562029204, "post_id": 56835818, "comment_id": 100239640, "body": "@lacostenycoder I&#39;m getting this output in rubymine console."}], "owner": {"reputation": 181, "user_id": 5756014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DiSqt.jpg?s=128&g=1", "display_name": "user5756014", "link": "https://stackoverflow.com/users/5756014/user5756014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1561984455, "creation_date": 1561984455, "question_id": 56835818, "link": "https://stackoverflow.com/questions/56835818/showing-savon-soapxml-response-in-one-line-in-rubymine-console", "title": "Showing Savon SOAP(xml) Response In One Line in Rubymine Console", "body": "<p>I've been using Savon as my SOAP client to request different APIs from Rails application. I've noticed that sometimes the response <code>xml</code>s are showing in multiple lines[see the pic] in console. But I want to get the response xml shown in one line. I've disabled <code>pretty_print_xml</code> and using <code>debug_level</code> <code>:info</code>. I've also tried with increasing buffer size(for lines) in rubymine but still is a no go. Please suggest me how can I get the <code>xml</code> response showing in one line. </p>\n\n<p><a href=\"https://i.stack.imgur.com/mWAnH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mWAnH.png\" alt=\"xml response in multiple lines\"></a>    </p>\n"}, {"tags": ["ruby", "saml", "onelogin"], "comments": [{"owner": {"reputation": 2464, "user_id": 1740662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3f09ad8d3af9982f70d2d5ce338aa?s=128&d=identicon&r=PG", "display_name": "Bernhard Thalmayr", "link": "https://stackoverflow.com/users/1740662/bernhard-thalmayr"}, "edited": false, "score": 0, "creation_date": 1562077053, "post_id": 56835048, "comment_id": 100259063, "body": "Did you check, that the IdP meta data file is schema compliant with the SAML meta data schema?"}, {"owner": {"reputation": 1034, "user_id": 3091835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfd5930c612d50bca560a3354d4695?s=128&d=identicon&r=PG", "display_name": "winstonhong", "link": "https://stackoverflow.com/users/3091835/winstonhong"}, "edited": false, "score": 0, "creation_date": 1563388368, "post_id": 56835048, "comment_id": 100687279, "body": "Another StackOverflow question <a href=\"https://stackoverflow.com/questions/41767262/certificate-to-pem-to-certificate-not-working-nested-asn1-error\">Certificate to pem to certificate not working: nested asn1 error</a> demonstrates that you may need more information in addition to X.509 Certificate."}], "owner": {"reputation": 1, "user_id": 5703097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b595de8012bf4ad9ae41ca4437239d4a?s=128&d=identicon&r=PG&f=1", "display_name": "papilip", "link": "https://stackoverflow.com/users/5703097/papilip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561981242, "creation_date": 1561981242, "question_id": 56835048, "link": "https://stackoverflow.com/questions/56835048/idp-metadata-parser-parse-remote-opensslx509certificateerror-nested-asn1-er", "title": "idp_metadata_parser.parse_remote OpenSSL::X509::CertificateError: nested asn1 error", "body": "<p>When i extract X509Certificate from a idp_metadata file, i can view and decode certificate.</p>\n\n<p>But when i use parse_remote, it\u2019s fail with this error<br>\n<code>OpenSSL::X509::CertificateError: nested asn1 error</code></p>\n\n<p>Can you have a idea about that ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "shell", "command-line", "rubygems"], "comments": [{"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1561980256, "post_id": 56834748, "comment_id": 100221727, "body": "If you use an absolute path how do you know it is not working? If you want the stdout and stderr you could try <a href=\"https://github.com/piotrmurach/tty-command\" rel=\"nofollow noreferrer\">tty-command</a>."}, {"owner": {"reputation": 5422, "user_id": 4697535, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XBZLy.png?s=128&g=1", "display_name": "Tal Zion", "link": "https://stackoverflow.com/users/4697535/tal-zion"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1561980363, "post_id": 56834748, "comment_id": 100221775, "body": "@Kris I updated my question. The absolute path was for testing to see that it works."}, {"owner": {"reputation": 2116, "user_id": 6780663, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9207ba3b9163582570078b687f9b2792?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Montilla", "link": "https://stackoverflow.com/users/6780663/alejandro-montilla"}, "edited": false, "score": 1, "creation_date": 1561980438, "post_id": 56834748, "comment_id": 100221815, "body": "When you run it with the relative path, do you get an error?"}, {"owner": {"reputation": 5422, "user_id": 4697535, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XBZLy.png?s=128&g=1", "display_name": "Tal Zion", "link": "https://stackoverflow.com/users/4697535/tal-zion"}, "edited": false, "score": 0, "creation_date": 1561980529, "post_id": 56834748, "comment_id": 100221868, "body": "Yes, I get <code>sh: ..&#47;lib&#47;{gem}&#47;create.sh: No such file or directory</code>"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1561980588, "post_id": 56834748, "comment_id": 100221902, "body": "Try using something like <code>File.join(__dir__, &#39;..&#39;, &#39;lib&#39;, &#39;gem&#39;, &#39;create.sh&#39;)</code>."}, {"owner": {"reputation": 5422, "user_id": 4697535, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XBZLy.png?s=128&g=1", "display_name": "Tal Zion", "link": "https://stackoverflow.com/users/4697535/tal-zion"}, "reply_to_user": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1561981055, "post_id": 56834748, "comment_id": 100222113, "body": "Thanks man @Kris, that worked <code>File.join(__dir__, &#39;create.sh&#39;)</code>. Can you post an answer? Will accept you as the correct answer."}], "answers": [{"tags": [], "owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "is_accepted": true, "score": 1, "last_activity_date": 1561994894, "last_edit_date": 1561994894, "creation_date": 1561994231, "answer_id": 56838195, "question_id": 56834748, "link": "https://stackoverflow.com/questions/56834748/how-to-call-a-shell-file-from-rubygem-command-line-tool/56838195#56838195", "title": "How to call a shell file from rubygem command line tool", "body": "<p>Use <code>__dir__</code> to get the directory of the Ruby file. From the <a href=\"https://docs.ruby-lang.org/en/2.4.0/Kernel.html#method-i-__dir__\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Returns the canonicalized absolute path of the directory of the file\n  from which this method is called. It means symlinks in the path is\n  resolved. If <code>__FILE__</code> is nil, it returns nil. The return value equals\n  to <code>File.dirname(File.realpath(__FILE__))</code></p>\n</blockquote>\n\n<p>So in your example you might do something like:</p>\n\n<pre><code>script = File.join(__dir__, '..', 'create.sh')\nexit_code = system(\"sh #{script\")\n</code></pre>\n\n<p>You can also set the cwd (current working directory) with <code>system</code>:</p>\n\n<pre><code>system(\"create.sh\", chdir: __dir__)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>Dir.chdir(__dir__) { system('create.sh') }\n</code></pre>\n"}], "owner": {"reputation": 5422, "user_id": 4697535, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/XBZLy.png?s=128&g=1", "display_name": "Tal Zion", "link": "https://stackoverflow.com/users/4697535/tal-zion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56838195, "answer_count": 1, "score": 0, "last_activity_date": 1561994894, "creation_date": 1561979918, "last_edit_date": 1561980316, "question_id": 56834748, "link": "https://stackoverflow.com/questions/56834748/how-to-call-a-shell-file-from-rubygem-command-line-tool", "title": "How to call a shell file from rubygem command line tool", "body": "<p>I have a command that needs to run a shell script. The shell file is in the gem root folder. When I execute the full path, everything is working fine, but can't get the root path.</p>\n\n<p>Running the script from <code>project_creator.rb</code></p>\n\n<p><em>I used for testing</em></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>system(\"sh /Users/user_name/folder/gem-project/lib/gem/create.sh\" + param)\n</code></pre>\n\n<p><strong>Tried:</strong></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>system(\"sh ../lib/gem/create.sh\" + param)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ARZ9f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ARZ9f.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "service-object"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 3, "creation_date": 1561976473, "post_id": 56833889, "comment_id": 100219970, "body": "&quot;problem in that i pass self in constructor&quot; - nope, not that. Something else."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 1, "creation_date": 1561978268, "post_id": 56833889, "comment_id": 100220796, "body": "The error states that you&#39;ve called the method with 1 argument, when it expects 0 arguments. This has got nothing to do with your question. What&#39;s the full stack trace? Where are you calling the method?"}, {"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 0, "creation_date": 1561978535, "post_id": 56833889, "comment_id": 100220927, "body": "use only in association callback <code>has_many :items, through: :order_items, after_add: :track_item_added</code>"}, {"owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "edited": false, "score": 0, "creation_date": 1561978660, "post_id": 56833889, "comment_id": 100220988, "body": "for test callback i run such commands in rails console: =&gt; order = Order.create; order.items &lt;&lt; Item.first. after last command output this error"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1561978821, "creation_date": 1561978821, "answer_id": 56834513, "question_id": 56833889, "link": "https://stackoverflow.com/questions/56833889/how-to-pass-self-from-model-to-service-object/56834513#56834513", "title": "How to pass self from model to service object", "body": "<blockquote>\n  <p>use only in association callback </p>\n\n<pre><code>has_many :items, through: :order_items, after_add: :track_item_added\n</code></pre>\n</blockquote>\n\n<p><code>after_add</code> callbacks expect one parameter.</p>\n\n<p><a href=\"https://guides.rubyonrails.org/v5.1/association_basics.html#association-callbacks\" rel=\"nofollow noreferrer\">https://guides.rubyonrails.org/v5.1/association_basics.html#association-callbacks</a></p>\n\n<blockquote>\n  <p>Rails passes the object being added or removed to the callback.</p>\n</blockquote>\n"}], "owner": {"reputation": 57, "user_id": 10387989, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-L-OQAZfcKTE/AAAAAAAAAAI/AAAAAAAAAA8/EvRiikg-sms/photo.jpg?sz=128", "display_name": "Trs MTV", "link": "https://stackoverflow.com/users/10387989/trs-mtv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56834513, "answer_count": 1, "score": 0, "last_activity_date": 1561978821, "creation_date": 1561976199, "last_edit_date": 1561976526, "question_id": 56833889, "link": "https://stackoverflow.com/questions/56833889/how-to-pass-self-from-model-to-service-object", "title": "How to pass self from model to service object", "body": "<p>I wanted to move def <code>track_item_added</code> from model into service object.\n  Model:</p>\n\n<pre><code>class Order &lt; ApplicationRecord\n  has_many :order_items\n  has_many :items, through: :order_items, after_add: :track_item_added\n\n  private\n\n  def track_item_added\n   aft = AutoFillTotal.new(self)\n   aft.multiply_cost_and_quantity\n  end\nend\n</code></pre>\n\n<p>and my service object</p>\n\n<pre><code>class AutoFillTotal\n  def initialize(order)\n   @order = order\n  end\n\n  def multiply_cost_and_quantity\n   @order.items.pluck(:cost).zip(@order.order_items.pluck(:quantity)).\n   map{|x, y| x * y}.sum\n  end\nend\n</code></pre>\n\n<p>that now in object service was in def <code>track_item_added</code> but now when I start this function as I get an error </p>\n\n<pre><code>Traceback (most recent call last):\n    2: from (irb):2\n    1: from app/models/order.rb:7:in `track_item_added'\nArgumentError (wrong number of arguments (given 1, expected 0))\n</code></pre>\n\n<p>May be it problem in that i pass self in constructor (new)</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 5397818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9cb814ff7be01c5ed386d697c6e894?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/5397818/adam"}, "is_accepted": true, "score": 0, "last_activity_date": 1561976025, "creation_date": 1561976025, "answer_id": 56833845, "question_id": 56833433, "link": "https://stackoverflow.com/questions/56833433/validation-on-uniqueness-record-on-the-association-relation/56833845#56833845", "title": "validation on uniqueness record on the association relation", "body": "<p>If you don't want to write a validate method, you can still use uniqueness options.Use conditional option to tell which rows should do the validation.</p>\n\n<pre><code>validates :truck_id, uniqueness: true, if: Proc.new { |assignment| assignment.on_specified_day? }\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10949610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1d982aec95597146d6b75148e090cdd?s=128&d=identicon&r=PG", "display_name": "user2369480", "link": "https://stackoverflow.com/users/10949610/user2369480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56833845, "answer_count": 1, "score": 0, "last_activity_date": 1561976025, "creation_date": 1561974484, "last_edit_date": 1561975010, "question_id": 56833433, "link": "https://stackoverflow.com/questions/56833433/validation-on-uniqueness-record-on-the-association-relation", "title": "validation on uniqueness record on the association relation", "body": "<p>I have some query, like a : </p>\n\n<pre><code>Assignment.where(date: \"2019-07-01\")\n         .includes(crews: :truck)\n         .where.not({ crews: {truck_id: nil}})\n         .count\n#=&gt;  2 records.\n</code></pre>\n\n<p>Here's an example with contain:</p>\n\n<pre><code>Assignment.where(date: \"2019-07-01\")\n         .includes(crews: :truck)\n         .where.not({ crews: {truck_id: nil}})\n         .distinct.pluck('trucks.name')\n\n#=&gt; [\"Mercedes\", \"BMW\"] \n</code></pre>\n\n<p>I want to check for the uniqueness of truck_id in Assignment.where(date: \"2019-07-01\")\nAnd in order to attach an existing truck_id to another Assignment object, validation was triggered.</p>\n\n<p>And a message pops up that you cannot add, since such a Truck object is already attached to one of the Assignment on the day that is specified in .where</p>\n\n<p>Please tell me how to implement it correctly. Thank.</p>\n"}, {"tags": ["ruby", "ruby-on-rails-3"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561974187, "post_id": 56832650, "comment_id": 100218790, "body": "What exactly is your question? Do you have a specific problem? Is there an error? And \u2013 because you tagged your question with rails 3 and rails 4 \u2013 what version of Rails do you actually use?"}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561975206, "post_id": 56832650, "comment_id": 100219342, "body": "hi @spickermann sorry i was using version 3 actually and my question was should i do it with controller or view? thx"}, {"owner": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "edited": false, "score": 0, "creation_date": 1562069338, "post_id": 56832650, "comment_id": 100254241, "body": "In <a href=\"https://stackoverflow.com/a/56741193/608359\">stackoverflow.com/a/56741193/608359</a> the comment describes some business logic around validating the email address, &quot;when the email is validated it will be stored into db as true and the ticked row will be disabled.&quot; Is that applicable to this question?"}, {"owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "reply_to_user": {"reputation": 1306, "user_id": 608359, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0a271650b730177f18910b6503f07c3?s=128&d=identicon&r=PG", "display_name": "Douglas Lovell", "link": "https://stackoverflow.com/users/608359/douglas-lovell"}, "edited": false, "score": 0, "creation_date": 1562332557, "post_id": 56832650, "comment_id": 100352325, "body": "hi @DouglasLovell, yes"}], "answers": [{"tags": [], "owner": {"reputation": 9447, "user_id": 1380867, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5dc27a551f77074a1dcc431e4158704b?s=128&d=identicon&r=PG", "display_name": "MZaragoza", "link": "https://stackoverflow.com/users/1380867/mzaragoza"}, "is_accepted": false, "score": 0, "last_activity_date": 1562695142, "creation_date": 1562695142, "answer_id": 56958250, "question_id": 56832650, "link": "https://stackoverflow.com/questions/56832650/how-to-disable-checkbox-on-condition/56958250#56958250", "title": "how to disable checkbox on condition?", "body": "<p>you can do something like </p>\n\n<pre><code>&lt;table class=\"table table-hover\"&gt;\n\n&lt;h1&gt;Scooties Coupons&lt;/h1&gt;\n\n&lt;%= form_with(url: validate_coupons_path, method: 'patch') do |f| %&gt;\n  &lt;table&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;Valid&lt;/th&gt;\n        &lt;th&gt;Coupon&lt;/th&gt;\n        &lt;th&gt;Redeemed&lt;/th&gt;\n        &lt;th&gt;First name&lt;/th&gt;\n        &lt;th&gt;Surname&lt;/th&gt;\n        &lt;th&gt;email&lt;/th&gt;\n        &lt;th&gt;occupation&lt;/th&gt;\n        &lt;th&gt;validation&lt;/th&gt;\n        &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n      &lt;% @scooties_coupons.each do |scooties_coupon| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt;\n            &lt;% if true %&gt;\n                SOMETHING HERE \n            &lt;% else %&gt;\n              &lt;%= fields_for('scooties_coupons[]', scooties_coupon) do |cf|\n                cf.check_box(:validated)\n              end %&gt;\n\n            &lt;% end %&gt;\n          &lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.coupon %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.redeemed %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.first_name %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.surname %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.email %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.occupation %&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n\n&lt;br&gt;\n\n&lt;/table&gt;\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 11539591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f70196f5d8b372232969cea4f7ae28?s=128&d=identicon&r=PG&f=1", "display_name": "developing", "link": "https://stackoverflow.com/users/11539591/developing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562695142, "creation_date": 1561971098, "last_edit_date": 1561980234, "question_id": 56832650, "link": "https://stackoverflow.com/questions/56832650/how-to-disable-checkbox-on-condition", "title": "how to disable checkbox on condition?", "body": "<p>I am trying to create a spreadsheet on index page to display items with checkbox and if validated - the checkbox will be disabled so that people won't mis-ticked it.I was wondering should i do it with controller or the view? thanks : can you help? </p>\n\n<p>In app/views/scooties_coupons/index.html.erb</p>\n\n<pre><code>&lt;table class=\"table table-hover\"&gt;\n\n&lt;h1&gt;Scooties Coupons&lt;/h1&gt;\n\n&lt;%= form_with(url: validate_coupons_path, method: 'patch') do |f| %&gt;\n  &lt;table&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;Valid&lt;/th&gt;\n        &lt;th&gt;Coupon&lt;/th&gt;\n        &lt;th&gt;Redeemed&lt;/th&gt;\n        &lt;th&gt;First name&lt;/th&gt;\n        &lt;th&gt;Surname&lt;/th&gt;\n        &lt;th&gt;email&lt;/th&gt;\n        &lt;th&gt;occupation&lt;/th&gt;\n        &lt;th&gt;validation&lt;/th&gt;\n        &lt;th colspan=\"3\"&gt;&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n      &lt;% @scooties_coupons.each do |scooties_coupon| %&gt;\n        &lt;tr&gt;\n          &lt;td&gt;\n            &lt;%= fields_for('scooties_coupons[]', scooties_coupon) do |cf|\n              cf.check_box(:validated)\n            end %&gt;\n          &lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.coupon %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.redeemed %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.first_name %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.surname %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.email %&gt;&lt;/td&gt;\n          &lt;td&gt;&lt;%= scooties_coupon.occupation %&gt;&lt;/td&gt;\n\n        &lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n\n&lt;br&gt;\n\n&lt;/table&gt;\n\n</code></pre>\n\n<p>in app/controllers/scotties_coupons_controller.rb:</p>\n\n<pre><code>\ndef set_valid_coupons\n  to_valid = params[:scooties_coupons].select do |id, attrs|\n    attrs[:validated] == '1'\n  end\n  to_not_valid = params[:scooties_coupons].reject do |id, attrs|\n    attrs[:validated] == '1'\n  end\n  ScootiesCoupon.transaction do\n    ScootiesCoupon.where(id: to_valid.keys, validated: false).update_all(\n      validated:true)\n    ScootiesCoupon.where(id: to_not_valid.keys, validated: true).update_all(\n      validated:false)\n  end\n  redirect_to action: :index, notice: 'Validations updated'\nend\n\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "rubymine", "pry"], "comments": [{"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1561986177, "post_id": 56831594, "comment_id": 100224733, "body": "Have you tried setting breakpoints in necessary test files and create a Run configuration for running them?"}, {"owner": {"reputation": 117, "user_id": 2924562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CbKx.jpg?s=128&g=1", "display_name": "Am33d", "link": "https://stackoverflow.com/users/2924562/am33d"}, "reply_to_user": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1562325195, "post_id": 56831594, "comment_id": 100348738, "body": "Yes. With Pry everything works fine. I was not able to create run configurations because that is a gem which doesn&#39;t run on rails-server, it is being consumed in another project."}, {"owner": {"reputation": 1311, "user_id": 4676887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QI0oc.jpg?s=128&g=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/4676887/olivia"}, "edited": false, "score": 0, "creation_date": 1562660879, "post_id": 56831594, "comment_id": 100435924, "body": "Could you please specify what exactly you&#39;re trying to debug?"}], "owner": {"reputation": 117, "user_id": 2924562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CbKx.jpg?s=128&g=1", "display_name": "Am33d", "link": "https://stackoverflow.com/users/2924562/am33d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561966256, "creation_date": 1561966256, "question_id": 56831594, "link": "https://stackoverflow.com/questions/56831594/debugging-a-gem-in-ruby-mine-using-the-integrated-debugger-instead-of-pry", "title": "Debugging a gem in ruby-mine using the integrated debugger instead of pry", "body": "<p>I can't debug the test cases (with the ruby-mine's debugger) of a project which is being used as an external library in one of my different projects. I <strong>can</strong> debug it using pry but not with the integrated ruby-mine debugger. \nIt doesn't have any configurations added and I am not sure what to add for this project. It doesn't run on it's own on a rails server, it is just being used as an external library.\nIf Pry can help so I am pretty sure I can debug it with ruby-mine's integrated debugger also. Any suggestions?</p>\n"}, {"tags": ["ruby", "string-formatting", "backslash"], "comments": [{"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561966400, "post_id": 56831572, "comment_id": 100215182, "body": "I know the difference between <code>puts hash</code> and <code>p hash</code>. But inside Ruby, as I think, it&#39;s anyway double backslash."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561969412, "post_id": 56831572, "comment_id": 100216394, "body": "Your question is unclear. There are exactly three backslashes in your string, one before each slash. None of them is a double backslash. Also, the result that you claim comes from <code>hash.to_json</code> is actually a Ruby literal and not JSON."}, {"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561970737, "post_id": 56831572, "comment_id": 100216991, "body": "@J&#246;rgWMittag <code>{:url=&gt;&quot;http:\\\\&#47;\\\\&#47;example.com\\\\&#47;test&quot;}</code> here is 2 backslashes before every slash, isn&#39;t it? I need a line where these 2 backslashes will be one backslash. Sorry for the misunderstanding, I asked as I see the problem."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1563024857, "post_id": 56831572, "comment_id": 100569858, "body": "No, there is only one backslash before every slash. In the output of <code>String#inspect</code>, backslashes are used as escape characters <i>in the display</i> to escape special characters. In this case, the first backslash that is <i>displayed</i> tells you that the backslash after it is actually part of the string and not an escape character. So, there are two backslashes <i>displayed</i> so that you know that there is only <i>one</i> backslash actually in the string. You can trivially test this by checking the length of the string."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561970965, "post_id": 56832555, "comment_id": 100217104, "body": "Yes, that&#39;s right about single quotes. But I need to keep them in my JSON result as a single backslash, while Ruby gives me only double backslash. Even with double quotes."}, {"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561971036, "post_id": 56832555, "comment_id": 100217143, "body": "I mean <code>{ url: &#39;http:\\&#47;\\&#47;example.com\\&#47;test&#39; }</code> and <code>{ url: &quot;http:\\&#47;\\&#47;example.com\\&#47;test&quot; }</code> got the same result <code>{&quot;url&quot;:&quot;http:\\\\&#47;\\\\&#47;example.com\\\\&#47;test&quot;}</code> while I need <code>{&quot;url&quot;:&quot;http:\\&#47;\\&#47;example.com\\&#47;test&quot;}</code>"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3092183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/496bb477dfd000e3a732225cf065202a?s=128&d=identicon&r=PG", "display_name": "Richard-Degenne", "link": "https://stackoverflow.com/users/3092183/richard-degenne"}, "is_accepted": false, "score": 1, "last_activity_date": 1561970696, "creation_date": 1561970696, "answer_id": 56832555, "question_id": 56831572, "link": "https://stackoverflow.com/questions/56831572/how-to-keep-single-backslash-in-ruby-string-after-to-json-formating/56832555#56832555", "title": "How to keep single backslash in Ruby string after to_json formating?", "body": "<p>Use single quotes around strings if you don't want to deal with escaping backslashes.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>hash = { url: 'http:\\/\\/example.com\\/test' }\njson = hash.to_json\nputs json\n\n# =&gt; {\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}\n</code></pre>\n\n<p>Just a quick reminder: in JSON, backslashes need to be escaped because they are considered as control characters.</p>\n\n<p>This way, when PHP parses this JSON document, you will get your string with a single backslash before each slash.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561971716, "post_id": 56832701, "comment_id": 100217493, "body": "Thank you for your answer. But the problem is not in communication. I need to encode my JSON using HMAC (SHA384). And the result is different in PHP and Ruby when I&#39;m using URL strings. If the string doesn&#39;t contain backslash all works fine..."}, {"owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561971967, "post_id": 56832701, "comment_id": 100217622, "body": "Ah, that&#39;s more clear, thanks. So does the PHP implementation (of HMAC(SHA384)) introduces the backslashes in JSON?"}, {"owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561972130, "post_id": 56832701, "comment_id": 100217721, "body": "PS suggestion: Add your comment to your original question for more clarity (&#39;I need to encode my JSON using HMAC (SHA384). And the result is different in PHP and Ruby when I&#39;m using URL strings. If the string doesn&#39;t contain backslash all works fine&#39;)"}, {"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561972691, "post_id": 56832701, "comment_id": 100217983, "body": "yes, PHP implementation introduces the backslashes. JSON using by PHP looks so <code>{&quot;url&quot;:&quot;http:\\&#47;\\&#47;example.com\\&#47;test&quot;}</code>  while Ruby&#39;s JSON is  <code>{&quot;url&quot;:&quot;http:\\\\&#47;\\\\&#47;example.com\\\\&#47;test&quot;}</code>"}, {"owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561973769, "post_id": 56832701, "comment_id": 100218580, "body": "if you use the option: JSON_UNESCAPED_SLASHES the backslashes won&#39;t be generated. Like so: echo json_encode(array(&quot;url&quot; =&gt; &quot;<a href=\"http://example.com/test&quot;\" rel=\"nofollow noreferrer\">example.com/test&quot;</a>), JSON_UNESCAPED_SLASHES);  result ==&gt; {&quot;url&quot;:&quot;<a href=\"http://example.com/test\" rel=\"nofollow noreferrer\">example.com/test</a>&quot;}"}, {"owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561974547, "post_id": 56832701, "comment_id": 100218989, "body": "better formatted: if you use the option: JSON_UNESCAPED_SLASHES the backslashes won&#39;t be generated. Like so: <code>echo json_encode(array(&quot;url&quot; =&gt; &quot;http:&#47;&#47;example.com&#47;test&quot;), JSON_UNESCAPED_SLASHES);</code>  result ==&gt; <code>{&quot;url&quot;:&quot;http:&#47;&#47;example.com&#47;test&quot;}</code>"}, {"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561975577, "post_id": 56832701, "comment_id": 100219531, "body": "Sure, but now PHP&#39;s result is right. And I need the same in Ruby. Not by modifying PHP&#39;s opts or codes, but modifying Ruby&#39;s string to get something like <code>qwe\\&#47;123</code>. Now Ruby gets me only <code>qwe\\\\&#47;123</code>."}, {"owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561977949, "post_id": 56832701, "comment_id": 100220632, "body": "Still not sure if this is the real problem. But a solution is: <code>hash = {&quot;url&quot;: &quot;http:&#47;&#47;example.com&#47;test&quot;}    # hash is a ruby object puts hash.to_json.split(&#39;&#47;&#39;).join(&#39;\\&#47;&#39;)      # ==&gt; {&quot;url&quot;:&quot;http:\\&#47;\\&#47;example.com\\&#47;test&quot;}</code>"}], "tags": [], "owner": {"reputation": 141, "user_id": 6110451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhsML.jpg?s=128&g=1", "display_name": "Alphons", "link": "https://stackoverflow.com/users/6110451/alphons"}, "is_accepted": false, "score": 0, "last_activity_date": 1561971287, "creation_date": 1561971287, "answer_id": 56832701, "question_id": 56831572, "link": "https://stackoverflow.com/questions/56831572/how-to-keep-single-backslash-in-ruby-string-after-to-json-formating/56832701#56832701", "title": "How to keep single backslash in Ruby string after to_json formating?", "body": "<p>The problem behind your question is probably the real problem. I'm not sure because your question is not totally clear to me so I'm taking a guess/assumption here with my answer.</p>\n\n<p>My assumption here is that you want to communicate between ruby and php, with json.</p>\n\n<p>Well, in that case your don't have to have a problem (with backslashes).</p>\n\n<p>Let ruby <strong>.to_json</strong> (<strong>JSON.generate(..)</strong>) and <strong>JSON.parse(..)</strong> solve the ruby part and let <strong>json_encode()</strong> and <strong>json_decode()</strong> solve the the php part and you are done.</p>\n\n<p><strong>so in ruby:</strong><br>\n- don't use extra escaping-backslashes, let <strong>.to_json</strong> solve that for you<br>\n- use the literal url string you would type in your browser like so:</p>\n\n<pre><code>hash = {\"url\":\"http://example.com/test\"} # hash is a ruby object\nputs hash.to_json                        # =&gt; {\"url\":\"http://example.com/test\"} is JSON (string)\n</code></pre>\n\n<p><strong>then in php</strong>:</p>\n\n<pre><code>var_dump( json_decode('{\"url\": \"http://example.com/test\"}') );\n</code></pre>\n\n<p>gives you:</p>\n\n<pre><code>object(stdClass)#1 (1) {\n  [\"url\"]=&gt;\n  string(23) \"http://example.com/test\"\n}\n</code></pre>\n\n<pre><code>var_dump( json_decode('{\"url\": \"http:\\/\\/example.com\\/test\"}') );\n</code></pre>\n\n<p>gives you:</p>\n\n<pre><code>object(stdClass)#1 (1) {\n  [\"url\"]=&gt;\n  string(23) \"http://example.com/test\"\n}\n</code></pre>\n\n<p><strong>Note</strong> that both JSON strings end up to be parsed correctly in PHP and end up as a normal PHP object</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561975324, "post_id": 56833163, "comment_id": 100219413, "body": "Yes, but this removes all backslashes from the string. While I need to keep ONE backslash. For example, if the string looks like this <code>&quot;qwe\\\\&#47;123&quot;</code> I need to get <code>&quot;qwe\\&#47;123&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11707511"}, "reply_to_user": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561976370, "post_id": 56833163, "comment_id": 100219921, "body": "There is two back slash on before and after the string"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11707511"}, "is_accepted": false, "score": 0, "last_activity_date": 1561973347, "creation_date": 1561973347, "answer_id": 56833163, "question_id": 56831572, "link": "https://stackoverflow.com/questions/56831572/how-to-keep-single-backslash-in-ruby-string-after-to-json-formating/56833163#56833163", "title": "How to keep single backslash in Ruby string after to_json formating?", "body": "<p>Try like below</p>\n\n<pre><code>hash = {\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}\nhash[:url] = hash[:url].delete(\"\\\\\")\nhash.to_json  #\"{\\\"url\\\":\\\"http://example.com/test\\\"}\"\n</code></pre>\n\n<p>Hope it will helps you</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "edited": false, "score": 0, "creation_date": 1561985006, "post_id": 56834902, "comment_id": 100224111, "body": "The last line with <code>gsub</code> helps me! Thanks a lot!"}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": true, "score": 3, "last_activity_date": 1561981143, "last_edit_date": 1561981143, "creation_date": 1561980623, "answer_id": 56834902, "question_id": 56831572, "link": "https://stackoverflow.com/questions/56831572/how-to-keep-single-backslash-in-ruby-string-after-to-json-formating/56834902#56834902", "title": "How to keep single backslash in Ruby string after to_json formating?", "body": "<p>My apologies, you do seem to have a valid issue on your hand. The key is this: <a href=\"https://stackoverflow.com/questions/4264877/why-is-the-slash-an-escapable-character-in-json\">Why is the slash an escapable character in JSON?</a> and its duplicate target, <a href=\"https://stackoverflow.com/questions/1580647/json-why-are-forward-slashes-escaped\">JSON: why are forward slashes escaped?</a>. Since both unescaped slashes and escaped slashes are allowed, Ruby chose to not escape them, and PHP chose to escape them, and both approaches are correct.</p>\n\n<p>(Aside: there's a bit of a complication in talking about this because <code>\\</code> is an escape character both for a string literal, and for JSON strings. Thus, in this answer, I take care to <code>puts</code> (or <code>echo</code>/<code>print_r</code>) all the values, to see the strings that do not have the string literal backslash escapes, only the backslashes that are actually present in the strings.)</p>\n\n<p>Thus, the JSON <code>{\"url\":\"http:\\/\\/example.com\\/test\"}</code> is a representation of the Ruby hash <code>{ 'url' =&gt; 'http://example.com/test' }</code>, where slashes are escaped (as PHP's <code>json_encode</code> would do it). Ruby's <code>to_json' would render that as</code>{\"url\":\"<a href=\"http://example.com/test\" rel=\"nofollow noreferrer\">http://example.com/test</a>\"}`:</p>\n\n<pre><code># Ruby\njson1 = '{\"url\":\"http:\\/\\/example.com\\/test\"}'\nputs json1                        # =&gt; {\"url\":\"http:\\/\\/example.com\\/test\"}\nputs JSON.parse(json1)            # =&gt; {\"url\"=&gt;\"http://example.com/test\"}\nputs JSON.parse(json1).to_json    # =&gt; {\"url\":\"http://example.com/test\"}\n\n# PHP\n$json1 = '{\"url\":\"http:\\/\\/example.com\\/test\"}';\necho $json1;                           # {\"url\":\"http:\\/\\/example.com\\/test\"}\nprint_r(json_decode($json1));          # stdClass Object\n                                       # (\n                                       #     [url] =&gt; http://example.com/test\n                                       # )\necho json_encode(json_decode($json1)); # {\"url\":\"http:\\/\\/example.com\\/test\"}\n</code></pre>\n\n<p>On the other hand, <code>{\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}</code> (represented in Ruby and PHP as the string <code>'{\"url\":\"http:\\\\\\\\/\\\\\\\\/example.com\\\\\\\\/test\"}'</code>) is a representation of the Ruby hash <code>{ 'url' =&gt; 'http:\\/\\/example.com\\/test' }</code>, where there are actual backslashes, but the slashes are not escaped. PHP's <code>json_encode</code> would render this value as <code>{\"url\":\"http:\\\\\\/\\\\\\/example.com\\\\\\/test\"}</code>.</p>\n\n<pre><code># Ruby\njson2 = '{\"url\":\"http:\\\\\\\\/\\\\\\\\/example.com\\\\\\\\/test\"}'\nputs json2                        # =&gt; {\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}\nputs JSON.parse(json2)            # =&gt; {\"url\"=&gt;\"http:\\\\/\\\\/example.com\\\\/test\"}\nputs JSON.parse(json2).to_json    # =&gt; {\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}\n\n# PHP\n$json2 = '{\"url\":\"http:\\\\\\\\/\\\\\\\\/example.com\\\\\\\\/test\"}';\necho $json2;                           # {\"url\":\"http:\\/\\/example.com\\/test\"}\nprint_r(json_decode($json2));          # stdClass Object\n                                       # (\n                                       #     [url] =&gt; http:\\/\\/example.com\\/test\n                                       # )\necho json_encode(json_decode($json2)); # {\"url\":\"http:\\\\\\/\\\\\\/example.com\\\\\\/test\"}\n</code></pre>\n\n<hr>\n\n<p>PHP <code>json_encode</code> has an option to prevent the PHP's default of escaping of backslashes:</p>\n\n<pre><code># PHP\necho json_encode('/');                         # \"\\/\"\necho json_encode('/', JSON_UNESCAPED_SLASHES); # \"/\"\n</code></pre>\n\n<p>Ruby does not have a similar option to force escaping of slashes, but since a slash has no special meaning in JSON, we can just manually replace <code>/</code> with <code>\\/</code>:</p>\n\n<pre><code># Ruby\nputs '/'.to_json                  # \"/\"\nputs '/'.to_json.gsub('/', '\\/')  # \"\\/\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7535204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554057e822f577cdf5e9b701a0fe0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/7535204/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 854, "favorite_count": 0, "accepted_answer_id": 56834902, "answer_count": 4, "score": 0, "last_activity_date": 1561981143, "creation_date": 1561966172, "last_edit_date": 1561973004, "question_id": 56831572, "link": "https://stackoverflow.com/questions/56831572/how-to-keep-single-backslash-in-ruby-string-after-to-json-formating", "title": "How to keep single backslash in Ruby string after to_json formating?", "body": "<p>I need to encode some hash containing URL string. I use to_json method and I need backslash in front of each slash (as PHP print such strings).\nFor example:</p>\n\n<pre><code>hash = {\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}\nhash.to_json\n</code></pre>\n\n<p>The result is </p>\n\n<pre><code>{:url=&gt;\"http:\\\\/\\\\/example.com\\\\/test\"}\n</code></pre>\n\n<p>While I need (and PHP's json_encode returns string with a single backslash).</p>\n\n<pre><code>{:url=&gt;\"http:\\/\\/example.com\\/test\"}\n</code></pre>\n\n<p>It's very important to keep the string as in PHP in case of encoding. Because strings with double and single backslashes get different results.</p>\n\n<p><strong>UPD:</strong>\nThe problem is not in communication. I need to encode my JSON using HMAC (SHA384). And the result is different in PHP and Ruby when I'm using URL strings. If the string doesn't contain backslash all works fine...</p>\n\n<p>PHP implementation introduces the backslashes. JSON using by PHP looks so <code>{\"url\":\"http:\\/\\/example.com\\/test\"}</code> while Ruby's JSON is <code>{\"url\":\"http:\\\\/\\\\/example.com\\\\/test\"}</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "facebook-graph-api", "koala"], "comments": [{"owner": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "edited": false, "score": 1, "creation_date": 1561964175, "post_id": 56831025, "comment_id": 100214382, "body": "&quot;The docs say acting as a page is much the same as acting as a user and the same commands should work.&quot; - where do the docs say that? also, what for exactly do you want to get the users who liked your page?"}, {"owner": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "edited": false, "score": 0, "creation_date": 1561964293, "post_id": 56831025, "comment_id": 100214414, "body": "another question: &quot;...can get access to their feeds...&quot; you can only do that if users authorize your app with the user_posts permission. even then, you don&#180;t get access to their feed, but only to their own posts."}, {"owner": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 0, "creation_date": 1561967612, "post_id": 56831025, "comment_id": 100215653, "body": "Pages don\u2019t have \u201cfriends\u201d, and friends and likes are not the same thing to begin with. There is no way to get a list of all people who liked your page via API."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "reply_to_user": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "edited": false, "score": 0, "creation_date": 1561970606, "post_id": 56831025, "comment_id": 100216935, "body": "@luschn - Regards 1st question it says it here at the bottom of the page -  <a href=\"https://github.com/arsduo/koala/wiki/Acting-as-a-Page\" rel=\"nofollow noreferrer\">github.com/arsduo/koala/wiki/Acting-as-a-Page</a>  Yes I am only after their posts not their entire feed! Will try to edit the question."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "reply_to_user": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 0, "creation_date": 1561970865, "post_id": 56831025, "comment_id": 100217048, "body": "@04FS yes I am aware which is why it is weird it does not have anything about getting them specifically in the docs. It does seem possible as per the old Stack post but unsure of the updated commands."}, {"owner": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 0, "creation_date": 1561970955, "post_id": 56831025, "comment_id": 100217097, "body": "That question you are referring to is over <i>n.i.n.e.</i> years old \u2026 There is no way with the current APIs, to get what you want. It\u2019s not in the docs, because it does not exist."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "reply_to_user": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "edited": false, "score": 0, "creation_date": 1561971252, "post_id": 56831025, "comment_id": 100217259, "body": "@luschn in terms of what we want from this we want to get access to their posts looking for when they post about certain topics so we can use those posts in our app..."}, {"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "reply_to_user": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 0, "creation_date": 1561971470, "post_id": 56831025, "comment_id": 100217360, "body": "@04FS sure but this part of the FB API docs seems to show that you can still get it for any object in the graph api?  <a href=\"https://developers.facebook.com/docs/graph-api/reference/v3.3/object/likes\" rel=\"nofollow noreferrer\">developers.facebook.com/docs/graph-api/reference/v3.3/object&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 5091, "user_id": 10955263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac8352744d1489964dc9ea418be332ed?s=128&d=identicon&r=PG&f=1", "display_name": "04FS", "link": "https://stackoverflow.com/users/10955263/04fs"}, "edited": false, "score": 0, "creation_date": 1561971756, "post_id": 56831025, "comment_id": 100217526, "body": "<i>\u201cThis reference describes the /likes edge that is common to multiple Graph API nodes.\u201d</i> - it would say \u201call\u201d instead of \u201cmultiple\u201d there, if that was what it meant. But it doesn\u2019t. <a href=\"https://developers.facebook.com/docs/graph-api/reference/v3.3/page/likes\" rel=\"nofollow noreferrer\"><code>&#47;{page-id}&#47;likes</code></a> gets you the objects liked <i>by</i> that page. There is no way to get the user profiles that liked your page."}, {"owner": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "edited": false, "score": 0, "creation_date": 1561971757, "post_id": 56831025, "comment_id": 100217527, "body": "that github link is not official docs..."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "edited": false, "score": 0, "creation_date": 1561973040, "post_id": 56832810, "comment_id": 100218158, "body": "OK thanks - I guess the only way then is if the users log into our app using Facebook and grant us the user_posts permission?"}, {"owner": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "reply_to_user": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "edited": false, "score": 0, "creation_date": 1561973537, "post_id": 56832810, "comment_id": 100218463, "body": "yeah, without authorization, you cannot get ANY data of a user, for privacy reasons."}], "tags": [], "owner": {"reputation": 68155, "user_id": 757508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbdf0220a07252e7fa441ca414bc612?s=128&d=identicon&r=PG", "display_name": "luschn", "link": "https://stackoverflow.com/users/757508/luschn"}, "is_accepted": true, "score": 0, "last_activity_date": 1561971829, "creation_date": 1561971829, "answer_id": 56832810, "question_id": 56831025, "link": "https://stackoverflow.com/questions/56831025/how-to-get-a-list-of-facebook-users-that-have-liked-our-page-using-koala-gem-for/56832810#56832810", "title": "How To Get A List Of Facebook Users That Have Liked Our Page Using Koala Gem For Ruby On Rails", "body": "<p><a href=\"https://developers.facebook.com/docs/graph-api/reference/v3.3/object/likes\" rel=\"nofollow noreferrer\">https://developers.facebook.com/docs/graph-api/reference/v3.3/object/likes</a></p>\n\n<blockquote>\n  <p>A User or Page can only query their own likes.</p>\n</blockquote>\n\n<p>In other words, you can only get Pages that are liked by the Page in question - or Pages that are liked by the User, if authorized with the <code>user_likes</code> permission and with a User Token.</p>\n\n<p><strong>There is no way to get Page Fans, and accessing the posts of a User is only possible by authorizing that User with the <code>user_posts</code> permission.</strong></p>\n\n<p>Btw, <code>/me/friends</code> is for getting the friends of a User, and it would only return friends who authorized the App too.</p>\n"}], "owner": {"reputation": 21, "user_id": 10797968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b88dedab72dfa6dde9049686aec1c06?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth32", "link": "https://stackoverflow.com/users/10797968/gareth32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56832810, "answer_count": 1, "score": -3, "last_activity_date": 1561971829, "creation_date": 1561963328, "question_id": 56831025, "link": "https://stackoverflow.com/questions/56831025/how-to-get-a-list-of-facebook-users-that-have-liked-our-page-using-koala-gem-for", "title": "How To Get A List Of Facebook Users That Have Liked Our Page Using Koala Gem For Ruby On Rails", "body": "<p>I want to get a list of all the Facebook users who have liked our Facebook page using the Koala gem for Ruby on Rails. </p>\n\n<p>Ideally returned as a JSON hash with the user objects so can get access to their feeds, and using just the page access token as we currently do not offer Facebook login.</p>\n\n<p>The docs say acting as a page is much the same as acting as a user and the same commands should work. Which means this should work - </p>\n\n<p><code>@page_graph.get_connections(\"me\", \"friends\")</code></p>\n\n<p>But this returns - </p>\n\n<p><code>Koala::Facebook::ClientError: type: OAuthException, code: 100, message: (#100) Tried accessing nonexisting field (friends) on node type (Page), x-fb-trace-id: EzD1J26UONf [HTTP 400]</code></p>\n\n<p>The only other Stack post I can find on this is here -</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5262163/rails-facebook-api-koala-gem-get-all-profiles-of-users-who-like-a-page\">Rails, Facebook API, Koala gem \u2014 get all profiles of users who &#39;Like&#39; a page</a></p>\n\n<p>But this is very old and does not work.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ruby", "algorithm"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561964532, "post_id": 56830856, "comment_id": 100214506, "body": "Instead of asking <i>us</i> to implement such method, tell us what&#39;s keeping <i>you</i> from doing so."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1561967185, "post_id": 56830856, "comment_id": 100215486, "body": "This might help: <a href=\"https://stackoverflow.com/q/9368205/477037\">Given a number, find the next higher number which has the exact same set of digits as the original number</a>"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1561969565, "post_id": 56830856, "comment_id": 100216466, "body": "You do this by writing a program which does what you want. If you have a problem with your program, carefully read the documentation of all the methods, classes, modules, and libraries you are using, write tests for your programs, trace the execution with pen and paper, single-step it in a debugger, then sleep on it, start again from the beginning, sleep on it again, and <i>then and only then</i> narrow your problem down to a concise, focused, simple, short, reproducible <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and ask a specific, focused, narrow question on <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 2, "creation_date": 1561986966, "post_id": 56830856, "comment_id": 100225147, "body": "Brimasen, your question has been reopened. If it is a homework problem please edit to describe efforts you have made to solve it yourself, as required by SO rules. Regardless, you should restate the question to tell us what help you need and to respond to comments. If you do not do so I think it is unlikely that readers will devote their time to helping you."}], "answers": [{"comments": [{"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1561975983, "post_id": 56830927, "comment_id": 100219726, "body": "Does not do the job, try with 1010."}], "tags": [], "owner": {"reputation": 3521, "user_id": 1801379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8623bb58fab9617aa3afe078e6b3e8d9?s=128&d=identicon&r=PG", "display_name": "Babar Al-Amin", "link": "https://stackoverflow.com/users/1801379/babar-al-amin"}, "is_accepted": false, "score": 2, "last_activity_date": 1562040181, "last_edit_date": 1562040181, "creation_date": 1561962718, "answer_id": 56830927, "question_id": 56830856, "link": "https://stackoverflow.com/questions/56830856/implement-a-ruby-method-to-find-the-next-largest-number-with-the-same-digits-of/56830927#56830927", "title": "Implement a ruby method to find the next largest number with the same digits of the input number in ruby", "body": "<p>It wouldn't be the fastest one, but does the job!</p>\n\n<pre><code>number = 38276\noptions = number.to_s.chars.permutation.map{|s| s.join.to_i}.uniq.sort\n\noptions[options.index(number) + 1] #=&gt; 38627\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1561986176, "post_id": 56834114, "comment_id": 100224731, "body": "The <code>uniq</code> call is what makes the difference. The <code>index &amp;&amp;</code> addition is superfluous."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1561986702, "post_id": 56834114, "comment_id": 100225005, "body": "Yep ^^ I added the <code>index &amp;&amp;</code> to prevent an unwanted exception (I could have used rescue or even raised something if index was nil)."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1561986863, "post_id": 56834114, "comment_id": 100225100, "body": "It won&#39;t be <code>nil</code> \u2013 the permutations of all digits will always generate the number itself."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1561988257, "post_id": 56834114, "comment_id": 100225825, "body": "Something like this :    def next_larger_number_with_same_digits(arg)     arg.to_s.chars.permutation.map { |i| i.join.to_i }.reject { |i| i &lt;= arg }.first   end ?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562013610, "post_id": 56834114, "comment_id": 100236270, "body": "No attribution required. If you have two solutions with a strong preference for one you can strengthen your answer by giving only the better solution. Think of it as writing an article or book. You circulate a draft for comments. Based on those comments you may revise your text, without providing a running commentary on your edits."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562014049, "post_id": 56834114, "comment_id": 100236435, "body": "A few points about the code you added: 1) <code>&lt;=</code> in <code>reject { |n| n &lt;= number }</code> should be <code>&gt;=</code> or, maybe clearer, write <code>select { |n| n &lt; number }</code> (notice I&#39;ve named the variable <code>n</code>, for &quot;number&quot;, as <code>i</code> is often used for &quot;index&quot;); 2) <code>sort.first</code> can be replaced by <code>max</code>; and 3) if the array produced by <code>select { |n| n &lt; number }</code> is empty, <code>[].max #=&gt; nil</code>, which is what you want."}, {"owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "edited": false, "score": 0, "creation_date": 1562048355, "post_id": 56834114, "comment_id": 100243622, "body": "Ok, I&#39;ll try to edit the answer to give the best solution but I have two questions first. With select n &lt; number followed by max I&#39;m getting the last number with the same digit. Did I understood the question wrong ?  And for the |i| used as index I agree with you, should I use e (element) or s (string) for the map ?"}], "tags": [], "owner": {"reputation": 175, "user_id": 11659763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7059fcac02dc17ae08896bbaf20cfa02?s=128&d=identicon&r=PG", "display_name": "user11659763", "link": "https://stackoverflow.com/users/11659763/user11659763"}, "is_accepted": false, "score": 0, "last_activity_date": 1562048676, "last_edit_date": 1562048676, "creation_date": 1561977176, "answer_id": 56834114, "question_id": 56830856, "link": "https://stackoverflow.com/questions/56830856/implement-a-ruby-method-to-find-the-next-largest-number-with-the-same-digits-of/56834114#56834114", "title": "Implement a ruby method to find the next largest number with the same digits of the input number in ruby", "body": "<p>Another way to get the next number with same digits :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def next_number_with_same_digits(number)\n  number.to_s.chars.permutation.map { |e| e.join.to_i }.select { |n| n &gt; number }.min\nend\n</code></pre>\n\n<p>If you want to get the last number with same digits :</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def last_number_with_same_digits(number)\n  number.to_s.chars.permutation.map { |e| e.join.to_i }.select { |n| n &lt; number }.max\nend\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 1351923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e90f5f2053a45b118f1ecae8c06030?s=128&d=identicon&r=PG", "display_name": "Bhimasen Rautaray", "link": "https://stackoverflow.com/users/1351923/bhimasen-rautaray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1562048676, "creation_date": 1561962242, "question_id": 56830856, "link": "https://stackoverflow.com/questions/56830856/implement-a-ruby-method-to-find-the-next-largest-number-with-the-same-digits-of", "title": "Implement a ruby method to find the next largest number with the same digits of the input number in ruby", "body": "<p>Implement a ruby method to find the next largest number with the same digits of the input number. Ex:  38276 would return 38627. </p>\n"}, {"tags": ["ruby", "oop", "username", "naming"], "comments": [{"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "edited": false, "score": 6, "creation_date": 1561951462, "post_id": 56829588, "comment_id": 100211632, "body": "Why don&#39;t you just use an array for holding those 100 student objects, each new object creation will be added into that array, then you can access them via index"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 5, "creation_date": 1561954797, "post_id": 56829588, "comment_id": 100212094, "body": "this is an <a href=\"https://meta.stackexchange.com/a/233676/319720\">XY problem</a>, you really want to use an array like Nguyen said"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561957713, "post_id": 56829588, "comment_id": 100212590, "body": "To anwer your question, since Ruby v1.9 it has not been possible to create a local variable dynamically. In earlier versions that could be done using <code>eval</code>."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1561963757, "post_id": 56829588, "comment_id": 100214249, "body": "@NathanWorden : Creating a variable - dynamically or not - means that you later access the variable in your program by its <i>name</i>; otherwise, why create it in the first place? Then I don&#39;t see what advantage you have from a dynamical creation. If you want to handle a collection of objects and still somehow give a &quot;name&quot; to the individual objects, use a Hash and make the &quot;name&quot; the hash key."}], "answers": [{"tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": false, "score": 2, "last_activity_date": 1561961397, "creation_date": 1561961397, "answer_id": 56830739, "question_id": 56829588, "link": "https://stackoverflow.com/questions/56829588/is-there-a-way-to-create-dynamic-variable-names-in-ruby/56830739#56830739", "title": "Is there a way to create dynamic variable names in Ruby?", "body": "<p>All you need is:</p>\n\n<pre><code>students = Array.new(100) { |i| Student.new(\"Name #{i}\") }\n</code></pre>\n\n<p>If you want to access the student i<sup>th</sup>, you can call</p>\n\n<pre><code>students[i]\n</code></pre>\n\n<p>There's no need to create a local variable called students_13 for example.</p>\n\n<p>The first student is <code>student[0]</code>, the last one <code>student[99]</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 7665522, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155166331713203/picture?type=large", "display_name": "Nathan Worden", "link": "https://stackoverflow.com/users/7665522/nathan-worden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1561963175, "answer_count": 1, "score": 1, "last_activity_date": 1561961397, "creation_date": 1561950239, "question_id": 56829588, "link": "https://stackoverflow.com/questions/56829588/is-there-a-way-to-create-dynamic-variable-names-in-ruby", "closed_reason": "Duplicate", "title": "Is there a way to create dynamic variable names in Ruby?", "body": "<p>If I create a <code>student</code> class and each time a new student object is created, how do I dynamically create a new variable name to distinguish between the different students? I don't know how many students there will be.</p>\n\n<p>On the last line of the code below I have used <code>student1</code> as the variable name for the new student object. If I want to create 100 student objects and have the variable name be <code>student1</code> through <code>student100</code> how would I dynamically create these variable names? </p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Student\n  attr_accessor :name\n\n  def initialize(name)\n    @name = name\n    puts \"Hello #{name}\"\n  end\nend\n\nputs \"What is your name?\"\nanswer = gets.chomp\nstudent1 = Student.new(answer)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "irb"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562347510, "post_id": 56829451, "comment_id": 100358917, "body": "Your first two sentences are contradictory. How can you select one name and return an object (is that a string?) that references all names?  You say, &quot;...then display either in Capital or Lowercase&quot;. Well, which is it?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6651760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a10cc7cbd2f21674df49b46cde63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Ezimoha", "link": "https://stackoverflow.com/users/6651760/christopher-ezimoha"}, "edited": false, "score": 0, "creation_date": 1562137095, "post_id": 56829538, "comment_id": 100278013, "body": "Thank you for your help. Please see further question and your help is highly need -` <a href=\"https://stackoverflow.com/q/56864526/6651760\">stackoverflow.com/q/56864526/6651760</a>"}, {"owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "reply_to_user": {"reputation": 1, "user_id": 6651760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a10cc7cbd2f21674df49b46cde63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Ezimoha", "link": "https://stackoverflow.com/users/6651760/christopher-ezimoha"}, "edited": false, "score": 0, "creation_date": 1562137330, "post_id": 56829538, "comment_id": 100278130, "body": "Hi @ChristopherEzimoha it&#39;s good to know it helps. Could you mark this as  solution first, and then, reformat your code in your new question, so other can see it better"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562346961, "post_id": 56829538, "comment_id": 100358737, "body": "Please don&#39;t ask the OP to select your answer, it&#39;s unbecoming. Had the OP been an SO veteran they would have merely disregarded the request; this OP, clearly new to SO, may not realise that there is no rush to select an answer, that most members wait at least a couple of hours before doing so. Christopher, invoking each method on the each name, then selecting one array randomly, is generally poor practice, better to select one name randomly then invoke each method on that name."}], "tags": [], "owner": {"reputation": 1175, "user_id": 2861567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GRa02.jpg?s=128&g=1", "display_name": "quyetdc", "link": "https://stackoverflow.com/users/2861567/quyetdc"}, "is_accepted": true, "score": 0, "last_activity_date": 1562155584, "last_edit_date": 1562155584, "creation_date": 1561949623, "answer_id": 56829538, "question_id": 56829451, "link": "https://stackoverflow.com/questions/56829451/how-do-i-randomly-return-an-element-from-an-array-in-ruby/56829538#56829538", "title": "How do I randomly return an element from an array in Ruby", "body": "<p>Try this</p>\n\n<pre><code> def random_case(names)  \n   names.flat_map{|name| [name.upcase, name.downcase, name.capitalize]}.sample\n end\n\n names= [\"James\", \"John\", \"Jane\"]\n\n puts random_case names\n</code></pre>\n\n<p>I think the code is quite simple to understand. Any trouble? leave a comment to let me know</p>\n"}, {"tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": false, "score": 2, "last_activity_date": 1561982817, "last_edit_date": 1561982817, "creation_date": 1561963876, "answer_id": 56831113, "question_id": 56829451, "link": "https://stackoverflow.com/questions/56829451/how-do-i-randomly-return-an-element-from-an-array-in-ruby/56831113#56831113", "title": "How do I randomly return an element from an array in Ruby", "body": "<p>I would start with:</p>\n\n<pre><code>def random_case(*names)\n  name = names.sample                                # pick a random name\n  [true, false].sample ? name.upcase : name.downcase # return name with random format\nend\n\nrandom_case(\"James\", \"John\", \"Jane\")    \n#=&gt; \"JAMES\"\nrandom_case(\"James\", \"John\", \"Jane\")\n#=&gt; \"john\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11664067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YOe41ShpUy4/AAAAAAAAAAI/AAAAAAAAABQ/DiX-DV3yhoU/photo.jpg?sz=128", "display_name": "Tushar Vaniya", "link": "https://stackoverflow.com/users/11664067/tushar-vaniya"}, "is_accepted": false, "score": 0, "last_activity_date": 1561965684, "creation_date": 1561965684, "answer_id": 56831467, "question_id": 56829451, "link": "https://stackoverflow.com/questions/56829451/how-do-i-randomly-return-an-element-from-an-array-in-ruby/56831467#56831467", "title": "How do I randomly return an element from an array in Ruby", "body": "<p>You can do like this.</p>\n\n<pre><code> names= [\"James\", \"John\", \"Jane\"]\n random = [names.sample.upcase, names.sample.downcase].sample\n puts \"Hello #{random}! How are you today?\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1562348282, "post_id": 56832236, "comment_id": 100359177, "body": "#3\ud83d\udc4d, #2\ud83d\udc4e, \ud83d\udc4e because in most contexts that&#39;s generally not a good idea, and the OP may be impressionable."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1561969328, "creation_date": 1561969328, "answer_id": 56832236, "question_id": 56829451, "link": "https://stackoverflow.com/questions/56829451/how-do-i-randomly-return-an-element-from-an-array-in-ruby/56832236#56832236", "title": "How do I randomly return an element from an array in Ruby", "body": "<p>I'd write <em>two</em> methods. One for returning a random name out of a list of names:</p>\n\n<pre><code>def random_name(*names)\n  names.sample\nend\n</code></pre>\n\n<p>and another one for changing a given name's case: (<code>rand &lt; 0.5</code> has a 50% chance of being <code>true</code>)</p>\n\n<pre><code>def random_case(name)\n  if rand &lt; 0.5\n    name.upcase\n  else\n    name.downcase\n  end\nend\n</code></pre>\n\n<p>Then combine both:</p>\n\n<pre><code>5.times do\n  puts random_case(random_name(\"James\", \"John\", \"Jane\"))\nend\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>JOHN\nJOHN\njane\nJAMES\njames\n</code></pre>\n\n<hr>\n\n<p>If you don't like the <code>rand &lt; 0.5</code> approach, you could also put both variants into an array and pick one randomly:</p>\n\n<pre><code>def random_case(name)\n  [name.upcase, name.downcase].sample\nend\n</code></pre>\n\n<p>Or you could put the method names <code>:upcase</code> and <code>:downcase</code> in an array, pick one of them randomly and use <a href=\"http://ruby-doc.org/core-2.6.3/Object.html#method-i-public_send\" rel=\"nofollow noreferrer\"><code>public_send</code></a> to invoke that method:</p>\n\n<pre><code>def random_case(name)\n  name.public_send([:upcase, :downcase].sample)\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6651760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1a10cc7cbd2f21674df49b46cde63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Ezimoha", "link": "https://stackoverflow.com/users/6651760/christopher-ezimoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 56829538, "answer_count": 4, "score": -3, "last_activity_date": 1562155584, "creation_date": 1561948599, "question_id": 56829451, "link": "https://stackoverflow.com/questions/56829451/how-do-i-randomly-return-an-element-from-an-array-in-ruby", "title": "How do I randomly return an element from an array in Ruby", "body": "<p>I will like to select a name randomly from an  array list then display either in Capital or Lowercase</p>\n\n<p>For example names= [\"James\", \"John\", \"Jane\"]\nOutput should be:  JOHN or john or jane or JAMES or JANE or james</p>\n\n<p>Please help!</p>\n\n<p>I have tried using the .sample() command which selects from an array. Also, I'm aware of the .upcase() and .lowercase(), the problem now is how to combine these whole methods together in order to get the desire result which is to select a name randomly for the array list then display in either Capital or Lowercase.</p>\n\n<pre><code> def random_case(*names)\n  names= [\"James\", \"John\", \"Jane\"]\n  names.sample { |names| names.upcase  names.downcase }\n  puts \"Hello #{names}! How are you today?\"\n end\n</code></pre>\n\n<p>random_case()</p>\n\n<p>I expect the output to be JOHN or john or jane or JAMES or JANE or james - randomly</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "answers": [{"comments": [{"owner": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 0, "creation_date": 1562598700, "post_id": 56830209, "comment_id": 100416029, "body": "<code>simple_form_for [:thread, @forum_section, @forum_thread]</code> generates <code>ActionView::Template::Error (undefined method `thread_forum_section_forum_threads_path&#39;</code> - adding <code>:thread</code> simply specifies the method name, and is used for adding things like <code>:edit</code> to a url."}, {"owner": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 0, "creation_date": 1562599048, "post_id": 56830209, "comment_id": 100416246, "body": "Re: naming - the names of the instance variables come directly from the generator - but rails doesn&#39;t care specifically what you call them - it infers the url from the class name of the objects in those variables. Changing to <code>@section</code> and <code>@thread</code> had no effect; it still tried to call <code>forum_section_forum_threads_path</code>. This has to do with namespacing, since without it, the generated url method calls work fine (but code becomes entirely unmanageable in large projects without namespacing)."}, {"owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "reply_to_user": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 1, "creation_date": 1562601115, "post_id": 56830209, "comment_id": 100417312, "body": "Have you tried moving the <code>Section</code> and <code>Thread</code> models out of the <code>Forum</code> namespace? I&#39;ve used namespaces before, and I only had to move the controller and views under a namespace. But my models did not have to be under the same namespace."}, {"owner": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 0, "creation_date": 1562604531, "post_id": 56830209, "comment_id": 100418910, "body": "While that would work, I think the solution is probably more ugly than specifying the url manually - while it doesn&#39;t violate DRY, it does limit maintainability of the models (no more nice namespacing), and destroys the convention of having the MVC structures mirrored. I want to be able to use namespacing everywhere, not just in some parts of the MVC structure."}, {"owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "reply_to_user": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 0, "creation_date": 1562618630, "post_id": 56830209, "comment_id": 100424642, "body": "Updated answer."}], "tags": [], "owner": {"reputation": 2390, "user_id": 4812050, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/hzLjT.jpg?s=128&g=1", "display_name": "Cruz Nunez", "link": "https://stackoverflow.com/users/4812050/cruz-nunez"}, "is_accepted": false, "score": 1, "last_activity_date": 1562682356, "last_edit_date": 1562682356, "creation_date": 1561957514, "answer_id": 56830209, "question_id": 56828184, "link": "https://stackoverflow.com/questions/56828184/shallow-nested-namespaced-classes-in-rails-5/56830209#56830209", "title": "Shallow, Nested, Namespaced classes in Rails 5", "body": "<h3>Non-namespaced solution</h3>\n\n<p>Try</p>\n\n<pre><code>= simple_form_for [:thread, @forum_section, @forum_thread] do |f|\n  # some form content here\n</code></pre>\n\n<p><a href=\"https://edgeguides.rubyonrails.org/routing.html#creating-paths-and-urls-from-objects\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p>This is assuming <code>@forum_section</code> is a persisted instance of the <code>Section</code> class and <code>@forum_thread</code> is a new instance of the <code>Thread</code> class.</p>\n\n<p>Normally, if your routes have resources like <code>:sections</code> and <code>:threads</code>, your models would be called <code>Section</code> and <code>Thread</code>. And for convention, your instance variables would also be called <code>@section</code> and <code>@thread</code>, but their name isn't so important. If your setup is different than this, it can make it hard for Rails to guess which URL you're trying to generate.</p>\n\n<h3>Namespaced solution</h3>\n\n<p>If you want to keep the models under the same namespace, like <code>Forum::Section</code> and <code>Forum::Thread</code>, you have to also change the default naming for the path helpers</p>\n\n<pre><code>namespace :forum do\n  resources :sections, shallow: true, as: :forum_sections do\n    resources :threads, shallow: true, as: :forum_threads do\n      resources :posts\n    end\n  end\nend\n</code></pre>\n\n<p><a href=\"https://guides.rubyonrails.org/routing.html#overriding-the-named-helpers\" rel=\"nofollow noreferrer\">Source</a></p>\n"}, {"comments": [{"owner": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "edited": false, "score": 0, "creation_date": 1562596909, "post_id": 56830805, "comment_id": 100414891, "body": "The problem here is the namespacing; this works just fine without, but with, it breaks. The issue here is in the controller:  <code>@forum_thread = Forum::Thread.new</code>  That namespacing destroys the nice url_for method that&#39;s used to make the url."}], "tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 0, "last_activity_date": 1562621473, "last_edit_date": 1562621473, "creation_date": 1561961926, "answer_id": 56830805, "question_id": 56828184, "link": "https://stackoverflow.com/questions/56828184/shallow-nested-namespaced-classes-in-rails-5/56830805#56830805", "title": "Shallow, Nested, Namespaced classes in Rails 5", "body": "<pre><code>#controller\n@forum_thread = Thread.new\n\n#view\n= simple_form_for [:forum, @forum_section, @forum_thread]\n</code></pre>\n\n<p>The form action will be POST /sections/:id/threads</p>\n"}], "owner": {"reputation": 1103, "user_id": 1864042, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fad79d3e7b978774feb2eb26d41eb18?s=128&d=identicon&r=PG", "display_name": "mschultz", "link": "https://stackoverflow.com/users/1864042/mschultz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562682356, "creation_date": 1561929947, "question_id": 56828184, "link": "https://stackoverflow.com/questions/56828184/shallow-nested-namespaced-classes-in-rails-5", "title": "Shallow, Nested, Namespaced classes in Rails 5", "body": "<p>I have the following setup:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># routes.rb\n\nnamespace :forum do\n  resources :sections, shallow: true do\n    resources :threads, shallow: true do\n      resources :posts\n    end\n  end\nend\n</code></pre>\n\n<p>with the expected models/etc. Rails routes looks like:\n<a href=\"https://i.stack.imgur.com/eywi2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eywi2.png\" alt=\"Picture of rails routes\"></a>\nWhen I try to use</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># /app/views/forum/threads/new.html.haml\n# @forum_section / @forum_thread correctly set in controller\n\n= simple_form_for [@forum_section, @forum_thread] do |f|\n  # some form content here\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `forum_section_forum_threads_path' for #&lt;#&lt;Class:0x00007f6af7623b80&gt;:0x00007f6af49780b8&gt;\nDid you mean?  forum_section_threads_path):\n</code></pre>\n\n<p>Well - yes, of course I meant that.</p>\n\n<p>But there has got to be a better way than:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>= simple_form_for [@forum_section, @forum_thread], url: forum_section_threads_path(@forum_section)\n</code></pre>\n\n<p>Yuck. A violation of DRY in one line.</p>\n\n<p>I <strong>know</strong> I must be missing something stupid here - help me out?</p>\n"}, {"tags": ["ruby", "sorbet"], "comments": [{"owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 0, "creation_date": 1561928734, "post_id": 56828043, "comment_id": 100208609, "body": "And to be clear: using <code>Hash</code> technically works in the signature, but then when you use <code>options.x</code> in the method it says <code>x</code> isn&#39;t defined on the Hash."}, {"owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 0, "creation_date": 1561932431, "post_id": 56828043, "comment_id": 100209218, "body": "<code>options.x</code> isn&#39;t a valid accessor for a hash... whoops. It should be <code>options[:x]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 0, "creation_date": 1561929605, "post_id": 56828107, "comment_id": 100208762, "body": "Interestingly, in your example for #4 the typechecker seems to fail on <code>options.x</code> (<code>Method x does not exist on T::Hash[T.untyped, T.untyped] component of {x: Integer}</code>), but <code>options[:x]</code> is fine."}, {"owner": {"reputation": 2817, "user_id": 1963973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5364da37e0b8fcf0af75906ee36b84fd?s=128&d=identicon&r=PG", "display_name": "marianosimone", "link": "https://stackoverflow.com/users/1963973/marianosimone"}, "reply_to_user": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "edited": false, "score": 1, "creation_date": 1561932185, "post_id": 56828107, "comment_id": 100209177, "body": "Ooops, sorry, you are right, was copy&amp;pasting the method from your example and forgot to change to the shape. Fixed now!"}], "tags": [], "owner": {"reputation": 2817, "user_id": 1963973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5364da37e0b8fcf0af75906ee36b84fd?s=128&d=identicon&r=PG", "display_name": "marianosimone", "link": "https://stackoverflow.com/users/1963973/marianosimone"}, "is_accepted": true, "score": 5, "last_activity_date": 1561932154, "last_edit_date": 1561932154, "creation_date": 1561929083, "answer_id": 56828107, "question_id": 56828043, "link": "https://stackoverflow.com/questions/56828043/how-to-define-a-signature-for-a-hash-with-attributes-in-sorbet/56828107#56828107", "title": "How to define a signature for a hash with attributes in Sorbet?", "body": "<p>Essentially, you have to choose to go one of various ways, (three which you've already mentioned):</p>\n\n<ol>\n<li>Use a <code>T::Hash[KeyType, ValueType]</code>. This allows you to use the <code>{}</code> syntax when calling a method that takes it as a param, but forces you to use the same type of key and value for every entry.</li>\n<li>Use a <code>T::Hash[KeyType, Object]</code>. This is a bit more flexible on the type of the value... but you loose type information.</li>\n<li>Use a <code>T::Hash[KeyType, T.any(Type1, Type2, ...)</code>. This is a middle ground between 1 and 2.</li>\n<li>Use shapes. As the docs say, the functionality might change and are experimental. It's the nicest way to model something like this without imposing the use of the <code>T::Struct</code> to the caller:</li>\n</ol>\n\n<pre><code>sig { params(options: {x: Integer}).void }\ndef method(options)\n  puts options[:x]\nend\n</code></pre>\n\n<ol start=\"5\">\n<li>Use a <code>T::Struct</code>, like you did. This forces you to call the method with <code>MyStruct.new(prop1: x, prop2: y, ...)</code></li>\n</ol>\n\n<p>All of them are valid, with 4 and 5 being the ones that give you the most type safety. Of the two, 4 is the most flexible on the caller, but 5 is the one that you know <code>Sorbet</code> is not going to change support in the short/medium term.</p>\n"}], "owner": {"reputation": 632, "user_id": 7143763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0QlJUg0F-uo/AAAAAAAAAAI/AAAAAAAAAJE/4OqZ-1jLIYc/photo.jpg?sz=128", "display_name": "Connor Shea", "link": "https://stackoverflow.com/users/7143763/connor-shea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "accepted_answer_id": 56828107, "answer_count": 1, "score": 2, "last_activity_date": 1561932154, "creation_date": 1561928333, "question_id": 56828043, "link": "https://stackoverflow.com/questions/56828043/how-to-define-a-signature-for-a-hash-with-attributes-in-sorbet", "title": "How to define a signature for a hash with attributes in Sorbet?", "body": "<p>(Note that this isn't reproducible on sorbet.run, it's only reproducible with a local copy of Sorbet as far as I can tell)</p>\n\n<p>I was hoping I could use the <a href=\"https://sorbet.org/docs/tstruct\" rel=\"nofollow noreferrer\">Typed Structs feature</a> to create a method signature where one of the parameters is an <code>options</code> hash, but this doesn't work:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># typed: true\nrequire 'sorbet-runtime'\nextend T::Sig\n\nclass OptionsStruct &lt; T::Struct\n  prop :x, Integer, default: 1\nend\n\nsig { params(options: OptionsStruct).void }\ndef method(options)\n  puts options.x\nend\n\n# This works\nmethod(OptionsStruct.new({x: 2}))\n\n# This causes the typechecker to throw.\nmethod({x: 2})\n</code></pre>\n\n<p>Essentially, when you typecheck this file it complains about passing a hash in, when a Struct is expected. My question is: how can I define a valid signature for a hash that has specific parameters? Structs clearly aren't working here. While I haven't tried Shapes, according to the docs they're very limited, so I'd prefer not to use them if possible.</p>\n\n<p>The <a href=\"https://sorbet.org/docs/stdlib-generics\" rel=\"nofollow noreferrer\">documentation on generics</a> mentions Hashes but seems to suggest they can only be used if the hash's keys and values are all of the same types (e.g. <code>Hash&lt;Symbol, String&gt;</code> requires that all keys be Symbols and all values be Strings), and doesn't provide any way (as far as I know) to define a hash with specific keys.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "edited": false, "score": 0, "creation_date": 1561952526, "post_id": 56827956, "comment_id": 100211777, "body": "please provide your <code>Order</code> schema"}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 4656581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NG8zbCOeemg/AAAAAAAAAAI/AAAAAAAAACQ/jqlfYccBMQc/photo.jpg?sz=128", "display_name": "Agustin Cornu", "link": "https://stackoverflow.com/users/4656581/agustin-cornu"}, "is_accepted": false, "score": 2, "last_activity_date": 1562875797, "last_edit_date": 1562875797, "creation_date": 1561929164, "answer_id": 56828115, "question_id": 56827956, "link": "https://stackoverflow.com/questions/56827956/out-of-ranger-error-typeinteger-during-rspec-test/56828115#56828115", "title": "Out of ranger error, Type::Integer during rspec test", "body": "<p>In a 4byte <code>INT</code> field you can store up to a <code>2147483647</code> integer.</p>\n\n<p>7554736346861994060 is way bigger than <code>2147483647</code> thus, it takes more than 4bytes.</p>\n\n<p>You need a different data type that can support such a number.</p>\n\n<p>Add a migration to alter the column to <code>BigInteger</code> which is supposed to store the large number.</p>\n"}], "owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562875797, "creation_date": 1561927429, "question_id": 56827956, "link": "https://stackoverflow.com/questions/56827956/out-of-ranger-error-typeinteger-during-rspec-test", "title": "Out of ranger error, Type::Integer during rspec test", "body": "<p>Getting a failed rspec test saying active record is out of range.  Not sure why it's failing though</p>\n\n<p>Heres the error</p>\n\n<pre><code>Failure/Error: Order.create! params.merge(user: user, subscription: subscription, product: product)\n\n ActiveModel::RangeError:\n   7554736346861994060 is out of range for ActiveModel::Type::Integer with limit 4 bytes\n</code></pre>\n\n<p>rspec test</p>\n\n<pre><code>context 'subscription order params' do\n      let(:subscription_order_params) { FactoryBot.attributes_for(:order,\n                                                                  party_user_id: subscription_user.party_id,\n                                                                  party_subscription_id: subscription.party_id,\n                                                                  party_product_id: product.party_id)}\n\n      it 'creates an order that belongs to a subscription customer' do\n        post :create, params: { order: subscription_order_params }, as: :json\n\n        expect(response.status).to eq 204\n      end\n    end\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "seo", "sitemap"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1561915707, "post_id": 56826632, "comment_id": 100205820, "body": "It looks like you have two initializers both trying to declare the same constant. Look more closely at those two files."}, {"owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561919787, "post_id": 56826632, "comment_id": 100206763, "body": "I removed one if the two initializer and I still have the same result :("}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 6275081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c03d69da90e7afc675db6851058d926?s=128&d=identicon&r=PG", "display_name": "Felipe Tuyama", "link": "https://stackoverflow.com/users/6275081/felipe-tuyama"}, "is_accepted": false, "score": 0, "last_activity_date": 1562866183, "creation_date": 1562866183, "answer_id": 56994537, "question_id": 56826632, "link": "https://stackoverflow.com/questions/56826632/how-to-correctly-create-a-sitemap-on-rails/56994537#56994537", "title": "How to correctly create a sitemap on rails", "body": "<p>Is your S3 bucket public? You must authorize public access so it works.</p>\n"}], "owner": {"reputation": 646, "user_id": 8919469, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f51a8277c113b7415c6b2bbd82be9615?s=128&d=identicon&r=PG&f=1", "display_name": "johan", "link": "https://stackoverflow.com/users/8919469/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562866183, "creation_date": 1561914644, "question_id": 56826632, "link": "https://stackoverflow.com/questions/56826632/how-to-correctly-create-a-sitemap-on-rails", "title": "How to correctly create a sitemap on rails", "body": "<p>I followed <a href=\"https://www.sitepoint.com/start-your-seo-right-with-sitemaps-on-rails/\" rel=\"nofollow noreferrer\">this</a> to create my sitemap.</p>\n\n<p>So in <strong>config/sitemap.rb</strong> I have </p>\n\n<pre><code>require 'fog-aws'\n\nSitemapGenerator::Sitemap.default_host = \"https://www.lapenderiedelhomme.fr\"\n\nSitemapGenerator::Sitemap.create do\n  add clients_products_path, :priority =&gt; 0.5, :changefreq =&gt; 'daily'\n\n  Product.find_each do |prod|\n    add clients_product_path(prod),:lastmod =&gt; prod.updated_at, :priority =&gt; 0.5\n  end\n\nend\n\nSitemapGenerator::Sitemap.adapter = SitemapGenerator::S3Adapter.new(fog_provider: 'AWS',\n                                                                    aws_access_key_id: ENV['AWS_ACCESS_KEY_ID'],\n                                                                    aws_secret_access_key: ENV['AWS_SECRET_ACCESS_KEY_ID'],\n                                                                    fog_directory: ENV['S3_BUCKET_NAME'],\n                                                                    fog_region: 'eu-west-3')\n\nSitemapGenerator::Sitemap.public_path = 'tmp/'\nSitemapGenerator::Sitemap.sitemaps_host = \"https://mybucket.s3.eu-west-3.amazonaws.com/\"\nSitemapGenerator::Sitemap.sitemaps_path = 'sitemap/'\n\nSitemapGenerator::Sitemap.ping_search_engines('https://lapenderiedelhomme.fr/sitemap')\n</code></pre>\n\n<p>in my routes I added </p>\n\n<pre><code>get '/sitemap', to: 'clients/pages#sitemap'\n</code></pre>\n\n<p>In my <strong>clients/pages_controller.rb</strong> </p>\n\n<p>I have this method:</p>\n\n<pre><code>def sitemap\n    redirect_to 'https://mybucket.s3.eu-west-3.amazonaws.com/sitemap/sitemap.xml.gz'\nend\n</code></pre>\n\n<p>in <strong>public/robot.txt</strong> </p>\n\n<pre><code>User-Agent: *\nSitemap: https://www.lapenderiedelhomme.fr/sitemap\n</code></pre>\n\n<p>Once everything is pushed on Heroku I ran this command: </p>\n\n<pre><code>heroku run rails sitemap:create --app lapenderie-production\n</code></pre>\n\n<p>And I have this result</p>\n\n<pre><code>Running rails sitemap:create on \u2b22 lapenderie-production... up, run.6997 (Hobby)\n/app/config/initializers/meta_tags.rb:1: warning: already initialized constant DEFAULT_META\n/app/config/initializers/default_meta.rb:1: warning: previous definition of DEFAULT_META was here\nIn '/app/public/':\nD, [2019-06-30T16:36:05.675507 #4] DEBUG -- :   Product Load (19.3ms)  SELECT  \"products\".* FROM \"products\" ORDER BY \"products\".\"id\" ASC LIMIT $1  [[\"LIMIT\", 1000]]\n+ sitemap.xml.gz                                          57 links /    1.23 KB\nSitemap stats: 57 links / 1 sitemaps / 0m00s\n\nPinging with URL 'https://lapenderiedelhomme.fr/sitemap':\n  Successful ping of Google\n  Successful ping of Bing\n\n</code></pre>\n\n<p>But when I visit this link <code>https://lapenderiedelhomme.fr/sitemap</code></p>\n\n<p>I have this: </p>\n\n<pre><code>&lt;Error&gt;\n&lt;Code&gt;AccessDenied&lt;/Code&gt;\n&lt;Message&gt;Access Denied&lt;/Message&gt;\n&lt;RequestId&gt;5DF520C4759DD7A2&lt;/RequestId&gt;\n&lt;HostId&gt;\nv2jM40g++QrfdB5TLtpo6hAwkshUkP6jZbgLXgozOyjuoEX8KlRBvnGaVqE9DzccuR81zZUN+pY=\n&lt;/HostId&gt;\n&lt;/Error&gt;\n</code></pre>\n\n<p>I've created a write and read folder <code>sitemap</code> in my bucket... </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561896690, "post_id": 56824697, "comment_id": 100201907, "body": "Where are you clicking to raise this error ?"}, {"owner": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "reply_to_user": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561896748, "post_id": 56824697, "comment_id": 100201919, "body": "let me edit the question"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561897245, "post_id": 56824697, "comment_id": 100202028, "body": "Can you show us your <code>routes.rb</code> file ?"}, {"owner": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "reply_to_user": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561899908, "post_id": 56824697, "comment_id": 100202451, "body": "sorry for making you wait, I updated my question"}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561900186, "post_id": 56824697, "comment_id": 100202497, "body": "Well looks like there&#39;s no error, can we have the full error trace ? It should be pointing at a particular line."}, {"owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "edited": false, "score": 0, "creation_date": 1561900841, "post_id": 56824697, "comment_id": 100202616, "body": "I think I found it, look at my answer :)"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "edited": false, "score": 1, "creation_date": 1561900080, "post_id": 56824851, "comment_id": 100202482, "body": "I tried the redirect_to but it still the same error"}, {"owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "reply_to_user": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "edited": false, "score": 0, "creation_date": 1561906533, "post_id": 56824851, "comment_id": 100203860, "body": "See updated answer based on the previous answer. Both should help you and make your code more readable."}], "tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 2, "last_activity_date": 1561906497, "last_edit_date": 1561906497, "creation_date": 1561897737, "answer_id": 56824851, "question_id": 56824697, "link": "https://stackoverflow.com/questions/56824697/no-route-matches-action-show-controller-shops-id-nil-missing-requ/56824851#56824851", "title": "No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;shops&quot;, :id=&gt;nil}, missing required keys: [:id]", "body": "<p>I think you want redirect instead of render and also make sure shop is persisted to the database.</p>\n\n<pre><code>def show\n  if current_user.shop&amp;.persisted?\n    redirect_to :new\n  else\n    @items = Item.where(shop_id: @shop.id)   \n  end\nend\n</code></pre>\n\n<p>Also in your view you can do this using safe navigation and use <code>.persisted?</code> since you care more about that the <code>shop.id</code> and this logic makes more sense than the other way around.</p>\n\n<pre><code>&lt;% if current_user.shop&amp;.persisted? %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", shop_path(current_user.shop.id)%&gt;&lt;/li&gt;\n&lt;% else %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", new_shop_path %&gt;&lt;/li&gt;\n&lt;% end %&gt; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 1, "creation_date": 1561911764, "post_id": 56825132, "comment_id": 100205054, "body": "It was supposed to be <code>current_user.shop&amp;.new_record?</code>, that takes care of the undefined error."}], "tags": [], "owner": {"reputation": 2184, "user_id": 8352929, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a74f883702be71738a2e3d6f59e466ed?s=128&d=identicon&r=PG&f=1", "display_name": "adesurirey", "link": "https://stackoverflow.com/users/8352929/adesurirey"}, "is_accepted": true, "score": 3, "last_activity_date": 1561904925, "last_edit_date": 1561904925, "creation_date": 1561900633, "answer_id": 56825132, "question_id": 56824697, "link": "https://stackoverflow.com/questions/56824697/no-route-matches-action-show-controller-shops-id-nil-missing-requ/56825132#56825132", "title": "No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;shops&quot;, :id=&gt;nil}, missing required keys: [:id]", "body": "<p>When you go to <code>new_shop_path</code> your controller action <code>new</code> seems to build a user shop : </p>\n\n<pre><code>@shop = current_user.build_shop\n</code></pre>\n\n<p>So from here <code>current_user.shop != nil</code></p>\n\n<p>But as it's not saved at that moment, this shop has no <code>id</code>. So in your view it goes in the <code>else</code> as shop is not nil but then there no <code>id</code> and it raises an error. </p>\n\n<pre><code>&lt;% if current_user.shop == nil %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", new_shop_path %&gt;&lt;/li&gt;\n&lt;% else %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", shop_path(current_user.shop.id)%&gt;&lt;/li&gt;    \n&lt;% end %&gt;   \n</code></pre>\n\n<p>change it to : </p>\n\n<pre><code>&lt;% if !current_user.shop || !current_user.shop.id %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", new_shop_path %&gt;&lt;/li&gt;\n&lt;% else %&gt;\n  &lt;li&gt;&lt;%= link_to \"Your shop\", shop_path(current_user.shop.id)%&gt;&lt;/li&gt;    \n&lt;% end %&gt;   \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11252688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397ea0442de6ccef0eaee8c0175077f2?s=128&d=identicon&r=PG&f=1", "display_name": "Minh T&#226;m L\u01b0\u01a1ng", "link": "https://stackoverflow.com/users/11252688/minh-t%c3%a2m-l%c6%b0%c6%a1ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 56825132, "answer_count": 2, "score": 0, "last_activity_date": 1561906497, "creation_date": 1561896197, "last_edit_date": 1561900601, "question_id": 56824697, "link": "https://stackoverflow.com/questions/56824697/no-route-matches-action-show-controller-shops-id-nil-missing-requ", "title": "No route matches {:action=&gt;&quot;show&quot;, :controller=&gt;&quot;shops&quot;, :id=&gt;nil}, missing required keys: [:id]", "body": "<p>I'm building an Ecommerce app, where every user can create their own shop. The association between user and shop should be </p>\n\n<pre><code>user has_one shop\nshop belongs_to user\n</code></pre>\n\n<p>And so far, the user who created a shop is working perfectly. But for those who didn't, It show me an error:</p>\n\n<pre><code>No route matches {:action=&gt;\"show\", :controller=&gt;\"shops\", :id=&gt;nil},  missing required keys: [:id]\n</code></pre>\n\n<p>In my <code>shops_controller.rb</code></p>\n\n<pre><code>class ShopsController &lt; ApplicationController\n  before_action :find_shop, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_user!\n  before_action :find_user\n\n  def show\n    if current_user.shop.blank?\n        render 'new'\n    else\n        @items = Item.where(shop_id: @shop.id)   \n    end\n  end\n\n  def index    \n    @shops = Shop.all.order(\"created at DESC\")    \n  end\n\n  def new\n    @shop = current_user.build_shop\n  end\n\n  def create \n    @shop = current_user.build_shop(shop_params)\n    if @shop.save\n        session[:shop_id] = @shop.id\n       flash[:success] = \"Creating item success\"\n       redirect_to @shop, notice: 'success'\n    else\n        render 'new'\n    end\n  end\n\nprivate \n\n  def shop_params\n    params.require(:shop).permit( :name , :user_id)\n  end\n\n  def find_store\n    @shop = Shop.find(params[:id])\n  end\n\n  def find_user\n    @user = UrStore.find_by(params[:user_id])\n  end\nend\n</code></pre>\n\n<p>In <code>application.html.erb</code></p>\n\n<pre><code> &lt;% if user_signed_in?%&gt;\n   &lt;%= link_to \"profile\", user_path(current_user.id) %&gt;\n   &lt;% if current_user.shop == nil %&gt;\n     &lt;li&gt;&lt;%= link_to \"Your shop\", new_shop_path %&gt;&lt;/li&gt;\n   &lt;% else %&gt;\n     &lt;li&gt;&lt;%= link_to \"Your shop\", shop_path(current_user.shop.id)%&gt;&lt;/li&gt;    \n   &lt;% end %&gt;   \n &lt;% end %&gt;\n</code></pre>\n\n<p>The <code>current_user</code> is generated automatically by gem 'devise'.</p>\n\n<p>The error occured when I click on \"Your Shop\", and the error only happen with user who doesn't create his/her shop  </p>\n\n<p>in routes.rb:</p>\n\n<pre><code>devise_for :users\nroot 'static_pages#home'\nas :user do\n  get \"signin\" =&gt; \"devise/sessions#new\"\n  post \"signin\" =&gt; \"devise/sessions#create\"\n  delete \"signout\" =&gt; \"devise/sessions#destroy\"\nend\nresources :shops\n</code></pre>\n\n<p>This line raised the error:</p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to \"Your Shop\",shop_path(current_user.shop.id)%&gt;&lt;/li&gt;\n</code></pre>\n\n<p>I'm looking for solutions to solve this problem :-)</p>\n"}, {"tags": ["ruby", "curl"], "answers": [{"comments": [{"owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "edited": false, "score": 0, "creation_date": 1561892771, "post_id": 56824337, "comment_id": 100201196, "body": "It works! Any idea why it wasn&#39;t working without the <code>-sSL</code> option?"}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "edited": false, "score": 1, "creation_date": 1561894685, "post_id": 56824337, "comment_id": 100201538, "body": "@user5783745: It would be helpful if you could explain what is unclear to you about the documentation of curl. That way, the curl developers can improve the documentation so that future developers don&#39;t stumble over the same problems again. In other words: you will be making the world a better place, and who doesn&#39;t want that?"}, {"owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561894779, "post_id": 56824337, "comment_id": 100201561, "body": "@J&#246;rgWMittag I followed <a href=\"https://quickleft.com/blog/command-line-tutorials-curl/\" rel=\"nofollow noreferrer\">this</a> (super basic) tutorial (actually, it was for something completely unrelated). But I came across the idea that you could curl in some code from github (I would have otherwise copy/pasted it)."}, {"owner": {"reputation": 920, "user_id": 1673227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbgZ.jpg?s=128&g=1", "display_name": "M.Elkady", "link": "https://stackoverflow.com/users/1673227/m-elkady"}, "edited": false, "score": 1, "creation_date": 1561895368, "post_id": 56824337, "comment_id": 100201643, "body": "-sSL are three options <code>-s</code> make it silent (remove the progress bar) <code>-S</code> (show errors in silent mode ) <code>-L</code> ( which solves the problem ) allow following redirections and the url above was redirecting to another URL you can use -v option to see the logs"}, {"owner": {"reputation": 920, "user_id": 1673227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbgZ.jpg?s=128&g=1", "display_name": "M.Elkady", "link": "https://stackoverflow.com/users/1673227/m-elkady"}, "edited": false, "score": 0, "creation_date": 1561896099, "post_id": 56824337, "comment_id": 100201782, "body": "i updated the answer it seems that people were downvoting :D because they didn&#39;t understand how it works"}], "tags": [], "owner": {"reputation": 920, "user_id": 1673227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbgZ.jpg?s=128&g=1", "display_name": "M.Elkady", "link": "https://stackoverflow.com/users/1673227/m-elkady"}, "is_accepted": true, "score": 3, "last_activity_date": 1561896039, "last_edit_date": 1561896039, "creation_date": 1561892682, "answer_id": 56824337, "question_id": 56824309, "link": "https://stackoverflow.com/questions/56824309/piping-raw-code-from-github-to-ruby-not-working/56824337#56824337", "title": "Piping raw code from github to ruby not working?", "body": "<p>use </p>\n\n<pre><code> curl  -sSL  https://raw.github.com/leachim6/hello-world/master/r/ruby.rb | ruby\n</code></pre>\n\n<p>this should work</p>\n\n<p><strong>Update to explain</strong></p>\n\n<ul>\n<li>this URL is redirecting to\n<code>https://raw.githubusercontent.com/leachim6/hello-world/master/r/ruby.rb</code>\nso -L option was required to follow the redirection (-L, --location)\nthis option will make curl redo the request on the new place</li>\n<li>sS to hide the progress bar and show errors if happened</li>\n<li>to debug curl request you can use -v option which will make you see exactly what is happening </li>\n</ul>\n"}], "owner": {"reputation": 14111, "user_id": 5783745, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/Z5VSF.jpg?s=128&g=1", "display_name": "stevec", "link": "https://stackoverflow.com/users/5783745/stevec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56824337, "answer_count": 1, "score": 1, "last_activity_date": 1561896039, "creation_date": 1561892425, "question_id": 56824309, "link": "https://stackoverflow.com/questions/56824309/piping-raw-code-from-github-to-ruby-not-working", "title": "Piping raw code from github to ruby not working?", "body": "<p>I am doing some basic piping of some simple raw code from github to terminal as shown <a href=\"https://quickleft.com/blog/command-line-tutorials-curl/\" rel=\"nofollow noreferrer\">here</a> i.e.</p>\n\n<pre><code>curl https://raw.github.com/leachim6/hello-world/master/r/ruby.rb | ruby\n</code></pre>\n\n<p>When I try it, it doesn't produce \"Hello World\", but instead I just see</p>\n\n<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 1547872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/x2Brf.jpg?s=128&g=1", "display_name": "dileep nandanam", "link": "https://stackoverflow.com/users/1547872/dileep-nandanam"}, "is_accepted": false, "score": 2, "last_activity_date": 1561907454, "creation_date": 1561907454, "answer_id": 56825926, "question_id": 56824122, "link": "https://stackoverflow.com/questions/56824122/calling-an-overriden-scope-from-an-included-concern-in-the-overriding-scope/56825926#56825926", "title": "Calling an overriden scope from an included concern in the overriding scope", "body": "<p>When you use included inside MyConcern, it happens after \"include YourModule\" is called on a class.\nBut doesn't change anything on MyConcern. If you want to have a superclass method, try</p>\n\n<pre><code>module MyConcern\n  extend ActiveSupport::Concern\n  def self.foo\n    puts \"Hello\"\n  end\nend\n\nNow you can call MyConcern.foo\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1561908875, "last_edit_date": 1561908875, "creation_date": 1561908514, "answer_id": 56826047, "question_id": 56824122, "link": "https://stackoverflow.com/questions/56824122/calling-an-overriden-scope-from-an-included-concern-in-the-overriding-scope/56826047#56826047", "title": "Calling an overriden scope from an included concern in the overriding scope", "body": "<p>The point of a concern is to avoid duplication and share methods between classes. So you don't need to call the Module to call the included method that you've included in the class.  Also, if you redefine the concern's method in the class, than it will override the concern's method.  Here's closer to what I think you're trying to do, but note you need a new method name in the class.</p>\n\n<pre><code>module MyConcern\n  extend ActiveSupport::Concern\n\n  included do\n    def self.foo # don't pass unused arguments so x is removed here\n      puts \"Hello\"\n    end\n  end\n\nend\n</code></pre>\n\n<p>Then in your class:</p>\n\n<pre><code> class MyClass \n  include MyConcern\n\n  # don't define foo but a new method name    \n  def self.fool(x)\n    foo\n    puts \"#{x} World\"\n  end\n\nend\n</code></pre>\n\n<p>Now you can call:</p>\n\n<pre><code>MyClass.fool('bar')\n</code></pre>\n\n<p>Also note your particular example is useless for the scope methods instead just define class methods as I've shown here.</p>\n"}], "owner": {"reputation": 59, "user_id": 11133451, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ICSfhbkaZcE/AAAAAAAAAAI/AAAAAAAAAX0/JeSlqUwECQQ/photo.jpg?sz=128", "display_name": "Tiu Wee Han", "link": "https://stackoverflow.com/users/11133451/tiu-wee-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1561908875, "creation_date": 1561890602, "question_id": 56824122, "link": "https://stackoverflow.com/questions/56824122/calling-an-overriden-scope-from-an-included-concern-in-the-overriding-scope", "title": "Calling an overriden scope from an included concern in the overriding scope", "body": "<p>So basically I have a class MyClass that includes a concern MyConcern with an included scope 'foo'. I want to be able to override the scope 'foo' in MyClass, but still be able to call the overriden scope in MyConcern.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>module MyConcern {\n  extend ActiveSupport::Concern\n\n  included do\n    scope :foo, lambda{ |x|\n      puts \"Hello\"\n    }\n  end\n}\n\nclass MyClass {\n  include MyConcern\n\n  scope :foo, lambda{ |x|\n    MyConcern.foo(x)\n    puts \" World\"\n  }\n}\n</code></pre>\n\n<p>So when I call <code>@myClass.foo(1)</code> where <code>@myClass</code> is an instance of MyClass, I should be able to see \"Hello World\" printed out.  </p>\n\n<p>A similar thread that I could find was <a href=\"https://stackoverflow.com/questions/28449044/calling-super-in-overriden-scope-defined-in-concern\">Calling super in overriden scope defined in concern</a>, but unfortunately I am unable to use regular class methods in my case.</p>\n\n<p>Any help will be appreciated!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 5, "creation_date": 1561883222, "post_id": 56823452, "comment_id": 100199534, "body": "It is equivalent to <code>tasks.all? { |task| task.complete? }</code>. Does that help?"}, {"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561883322, "post_id": 56823452, "comment_id": 100199553, "body": "it does help, thank you so much! so, the <code>&amp;:</code> part represents a block, right? or what? the <code>&amp;:</code> part is what confuses me"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 3, "creation_date": 1561883465, "post_id": 56823452, "comment_id": 100199572, "body": "The <code>:</code> is for a symbol, <code>:complete?</code>. Prepending <code>&amp;</code> converts it to a proc. See <a href=\"https://stackoverflow.com/questions/1217088/what-does-mapname-mean-in-ruby\" title=\"what does mapname mean in ruby\">stackoverflow.com/questions/1217088/&hellip;</a>"}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1561883490, "post_id": 56823452, "comment_id": 100199574, "body": "The answer to &quot;what does it mean?&quot; should be pretty clear if you simply read the code out loud."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1561894232, "post_id": 56823452, "comment_id": 100201449, "body": "Please, read <a href=\"https://meta.stackoverflow.com/a/253896/2988\">meta.stackoverflow.com/a/253896/2988</a> and <a href=\"https://softwareengineering.meta.stackexchange.com/a/7514/1352\">softwareengineering.meta.stackexchange.com/a/7514/1352</a> to understand why &quot;Explain this code&quot; questions are off-topic, and what you can do to improve your question to make it on-topic. The code you posted uses about 20 different concepts of Ruby, or, almost all of the entire language. The ISO Ruby Language Specification is about 120 pages just for the language and another 200 for the library and actually only contains a small subset of what we consider to be &quot;Ruby&quot;. We can&#39;t possibly explain all of that in a single answer."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561894368, "post_id": 56823452, "comment_id": 100201480, "body": "Also, your question is unclear. In the title, you ask about the meaning, i.e. the semantics of the code. But, in the first part of your question, you ask about the syntax. Then, at the end, you talk about what the code does, i.e. what the programmer wanted to achieve. Those are three completely different questions."}, {"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1561896147, "post_id": 56823452, "comment_id": 100201794, "body": "@J&#246;rgWMittag I just edited the question to improve its conciseness. You&#39;re right that there&#39;re three completely different questions since what I really wanted to ask is about the syntax."}, {"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "reply_to_user": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 1, "creation_date": 1561896819, "post_id": 56823452, "comment_id": 100201934, "body": "@EricDuminil thank you so much! This is exactly what I was looking for. The <code>proc</code> is actually the key here. Based on that, I found the complete explanation in page 452 -  the The Well-Grounded Rubyist 3rd (published date: 2019) book, which is about Using Symbol#to_proc for conciseness"}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561915818, "post_id": 56826599, "comment_id": 100205848, "body": "Might be better phrased &quot;<code>&amp;</code> converts a symbol to a method call of the same name using <code>Symbol#to_proc</code>&quot;."}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1561916675, "post_id": 56826599, "comment_id": 100206040, "body": "That\u2019s a side effect of the operator, but point is in passing as block, instead of symbol there may be a proc (<code>block = proc{}; method(&amp;block)</code>)"}, {"owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "edited": false, "score": 0, "creation_date": 1561948739, "post_id": 56826599, "comment_id": 100211289, "body": "Thank you for your answer! Btw, I also found another great explanation here <a href=\"https://stackoverflow.com/a/14881476/7932059\">stackoverflow.com/a/14881476/7932059</a>"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 1, "last_activity_date": 1561914142, "creation_date": 1561914142, "answer_id": 56826599, "question_id": 56823452, "link": "https://stackoverflow.com/questions/56823452/what-does-this-syntax-mean-in-ruby-tasks-allcomplete/56826599#56826599", "title": "what does this syntax mean in Ruby? .. tasks.all?(&amp;:complete?)", "body": "<p><code>&amp;</code> is for passing block to method as a block (also used the other way in parameter list to make implicit block a parameter), it implicitly calls <code>to_proc</code> on passed object.</p>\n\n<p><code>Symbol#to_proc</code> for <code>:symbol</code> makes a <code>proc{|param| param.symbol }</code></p>\n\n<p>So your code is equvalent to <code>tasks.all?{|task| task.complete? }</code></p>\n"}], "owner": {"reputation": 8447, "user_id": 7932059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aedf69bb41128a68d2a556a279c7698a?s=128&d=identicon&r=PG&f=1", "display_name": "Nguyen You", "link": "https://stackoverflow.com/users/7932059/nguyen-you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "closed_date": 1561917402, "accepted_answer_id": 56826599, "answer_count": 1, "score": 3, "last_activity_date": 1562134658, "creation_date": 1561883091, "last_edit_date": 1562134658, "question_id": 56823452, "link": "https://stackoverflow.com/questions/56823452/what-does-this-syntax-mean-in-ruby-tasks-allcomplete", "closed_reason": "Duplicate", "title": "what does this syntax mean in Ruby? .. tasks.all?(&amp;:complete?)", "body": "<p>I'm walking through the example project in the Rails 5 Test Prescriptions - Build a Healthy Codebase (published date: 2018) book and encountering this method:</p>\n\n<pre><code>#pages 29-30 of the book\nclass Project\n  .\n  .\n  def done?\n    tasks.all?(&amp;:complete?) #only this line confused me, especially the `&amp;` part\n  end\nend\n</code></pre>\n\n<p>the syntax looks really strange to me since I just learned Ruby &amp; Rails for more than one month..any hints just for pointing me to where I should read would be really appreciated</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "linkedin"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1561983498, "post_id": 56823376, "comment_id": 100223247, "body": "Are you using a omniauth/linkedin gem to enable omniauth in devise?? If so, which one?"}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562033816, "post_id": 56823376, "comment_id": 100240407, "body": "Thanks @JayDorsey I have added gemfile info."}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562034442, "post_id": 56823376, "comment_id": 100240517, "body": "It looks like <a href=\"https://github.com/skorks/omniauth-linkedin\" rel=\"nofollow noreferrer\">this gem</a> which hasn&#39;t been updated in 4+ years. The README states &quot;This gem contains the LinkedIn strategy for OmniAuth 1.0&quot; but the link on the microsoft site states &quot;The LinkedIn API uses OAuth 2.0 for user authorization and API authentication.&quot; I would assume the two aren&#39;t compatible given the age of the gem and I&#39;d probably investigate another gem (maybe <a href=\"https://github.com/decioferreira/omniauth-linkedin-oauth2\" rel=\"nofollow noreferrer\">this one</a>)"}, {"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562034604, "post_id": 56823376, "comment_id": 100240547, "body": "If you look thru the <a href=\"https://docs.microsoft.com/en-us/linkedin/compliance/release-notes\" rel=\"nofollow noreferrer\">release notes</a> you&#39;ll also find that linkedin is starting to deprecate at least some of the oauth 1.0 fields starting last year"}, {"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "reply_to_user": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 0, "creation_date": 1562035793, "post_id": 56823376, "comment_id": 100240747, "body": "Thanks for your help. I&#39;ll try to use it :)"}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "edited": false, "score": 0, "creation_date": 1561960582, "post_id": 56828628, "comment_id": 100213310, "body": "Thanks for your comment.    config.omniauth :linkedin,     Rails.application.credentials[Rails.env.to_sym][:linkedin][:&zwnj;&#8203;client_id],     Rails.application.credentials[Rails.env.to_sym][:linkedin][:&zwnj;&#8203;client_secret],     scope: &#39;r_liteprofile&#39;  I have added scope but that doesn&#39;t working."}], "tags": [], "owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "is_accepted": false, "score": 0, "last_activity_date": 1561935686, "creation_date": 1561935686, "answer_id": 56828628, "question_id": 56823376, "link": "https://stackoverflow.com/questions/56823376/cant-get-auth-information-from-linkedin/56828628#56828628", "title": "Can&#39;t get auth information from Linkedin", "body": "<p>There's so many things that this could actually be, but here's one thing you can try; you may not have requested the correct access when you configured your application. Per the <a href=\"https://docs.microsoft.com/en-us/linkedin/consumer/integrations/self-serve/sign-in-with-linkedin\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>When requesting an authorization code in Step 2 of the OAuth 2.0 Guide, make sure to request the r_liteprofile and/or r_emailaddress scopes!</p>\n</blockquote>\n\n<p>Per the <a href=\"https://docs.microsoft.com/en-us/linkedin/shared/authentication/authorization-code-flow?context=linkedin/context\" rel=\"nofollow noreferrer\">documentation</a> you can set these via the request, or thru the developer portal</p>\n"}], "owner": {"reputation": 555, "user_id": 10813827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b736f8f0de40f55f19c595a02be8b667?s=128&d=identicon&r=PG&f=1", "display_name": "k10a", "link": "https://stackoverflow.com/users/10813827/k10a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562034407, "creation_date": 1561882281, "last_edit_date": 1562034407, "question_id": 56823376, "link": "https://stackoverflow.com/questions/56823376/cant-get-auth-information-from-linkedin", "title": "Can&#39;t get auth information from Linkedin", "body": "<p>I'm working on authentication with LinkedIn. I don't know why but LinkedIn don't allow to sign in with suddenly. I can allow LinkedIn app but I can't get authentication information.</p>\n\n<pre><code>{\"provider\"=&gt;\"linkedin\",\n\"uid\"=&gt;nil,\n\"info\"=&gt;\n  {\"name\"=&gt;nil,\n  \"email\"=&gt;nil,\n  \"nickname\"=&gt;nil,\n  \"first_name\"=&gt;nil,\n  \"last_name\"=&gt;nil,\n  \"location\"=&gt;nil,\n  \"description\"=&gt;nil,\n  \"image\"=&gt;nil,\n  \"phone\"=&gt;nil,\n  \"headline\"=&gt;nil,\n  \"industry\"=&gt;nil,\n  \"urls\"=&gt;{\"public_profile\"=&gt;nil}},\n\"credentials\"=&gt;{\"token\"=&gt;\"facdxxx-xxx-xxxx-xxxx-xxxxxxxxx\", \"secret\"=&gt;\"2xxxxx-xxxx-xxxx-xxxx-xxxxxxx\"}}\n</code></pre>\n\n<p><em>omniauth_controller.rb</em></p>\n\n<pre><code>class OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n    def linkedin\n        @user = User.from_omniauth(request.env[\"omniauth.auth\"].except(\"extra\"))\n\n        if @user.persisted?\n            sign_in_and_redirect @user, event: :authentication\n        else\n            session[\"devise.user_attributes\"] = @user.attributes\n            redirect_to new_user_registration_url\n        end\n    end\nend\n</code></pre>\n\n<p>Should I update LinkedIn application settings? I wonder it doesn't matter to the rails application...</p>\n\n<p><em>Gemfile</em></p>\n\n<pre><code>gem 'omniauth-linkedin'\n</code></pre>\n\n<p>I use <code>omniauth-linkedin</code>.</p>\n\n<p>When I register in February, I have permission like below.</p>\n\n<p><img src=\"https://i.gyazo.com/87dc9f622269dcc52fa6be229d702142.png\" alt=\"\"></p>\n\n<p>But currently, Just three.</p>\n\n<p><img src=\"https://i.gyazo.com/dbc50fda63411b6093600bc96a798622.png\" alt=\"\"></p>\n\n<p>How can I add permissions on LinkedIn?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1561878574, "post_id": 56822952, "comment_id": 100198802, "body": "Depending on how other your need to do this operation it might make sense to build a hash with the language names as the keys and the line numbers as values. With such a hash each check would just be a simple lookup."}], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1561900824, "post_id": 56823080, "comment_id": 100202611, "body": "Thanks Aleksei. Your solution it outputs almost correct. I understand what you said about &quot;Basic&quot;, but I&#39;m not sure if there is a regex that could match C only when is alone (surrounded by spaces)?  I see that for &quot;Basic&quot; is more difficult."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1561878734, "creation_date": 1561878734, "answer_id": 56823080, "question_id": 56822952, "link": "https://stackoverflow.com/questions/56822952/how-to-search-strings-of-one-file-in-another-file-and-print-line-number-of-the-m/56823080#56823080", "title": "How to search strings of one file in another file and print line number of the match in ruby?", "body": "<p>The problem as it is stated does not have <em>a correct</em> solution because there is no way to explain Ruby that <code>Basic</code> (next to the last element in matchers list) <em>should not be taken into account</em> when matching the line <code>6.</code>. More sophisticated ruleset is required to accomplish what you want.</p>\n\n<p>That would be a good starting point though:</p>\n\n<pre><code>matchers = File.readlines(\"file1.txt\")\nlines = File.readlines(\"file2.txt\")\n\nmatchers.inject([]) do |acc, match|\n  acc | lines.each.with_index(1).map do |line, idx|\n    [match, idx, line].join(\"|\") if line =~ /\\b(#{match}\\b)/\n  end.compact\nend\n#\u21d2 [\"Ruby|6|1. lkd dsk Ruby kksdk\",\n#   \"C|3|4. cde fg z o Objective-C oode\",\n#   \"C|8|7. kdjd C jdjd\",\n#   \"Visual Basic|5|6. ab99r cde Visual Basic llso dkd\",\n#   \"R|11|3. rooor R kdk\",\n#   \"Objective-C|3|4. cde fg z o Objective-C oode\",\n#   \"Basic|5|6. ab99r cde Visual Basic llso dkd\",\n#   \"Basic|10|7. kkd Basic jjs\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562000713, "post_id": 56823680, "comment_id": 100231661, "body": "Surround the block of code that displays the result (<code>languages.each do |language| ... end</code>) with <code>File.open(&lt;file name&gt;, &quot;w+&quot;) do |f|</code> and <code>end</code>, and replace the two <code>puts ...</code> statements with <code>f.puts ...</code>."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562019569, "post_id": 56823680, "comment_id": 100237955, "body": "Hi Cary. Thanks. It works writing to an output file as you said. I have a question. your solution looks for a limited number of words? I ask because I tested with a more representative file1 and file2, as you can see below my UPDATE2, and in output only one text from file1 is found, even when the 5 sentences in file1 are present in file2."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562024113, "post_id": 56823680, "comment_id": 100238802, "body": "Try changing <code>&#47;\\b#{Regexp.escape(language)}(?= |\\z)&#47;</code> to <code>&#47;\\b#{Regexp.escape(language)}&#47;</code> and let me know."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562032586, "post_id": 56823680, "comment_id": 100240191, "body": "Changing to the regex you suggested, this time only the second sentence was not found, this one <code>&quot;The world&#39;s biggest cities: How do you measure them?&quot;</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562035792, "post_id": 56823680, "comment_id": 100240746, "body": "All five lines in the new file 1 (including <code>&quot;The world&#39;s biggest...&quot;</code>) were matched in file 2 after I changed <code>line.match?(&#47;\\b#{Regexp.escape(language)}&#47;)</code> to <code>line.match?(Regexp.escape(language))</code>. Note <code>Regexp.escape(language)</code> is the same as <code>&#47;#{Regexp.escape(language)}&#47;</code>. My original regex was consistent with your example, where the strings in file 1 were followed by a space or were at the end of a line in file 2. That&#39;s not the case with the larger data set."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1562046258, "post_id": 56823680, "comment_id": 100242851, "body": "Thanks a lot for your fix. It works now for the second samples. You&#39;re right, your first solution works for the first sample I posted. The real files have  file1 32K lines and file2 42K lines. I&#39;ve tried your last code and  after 1:20 hours the code still running. I think could be normal due to the number of lines of real files."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 1, "creation_date": 1562050139, "post_id": 56823680, "comment_id": 100244321, "body": "To build the hash <code>language_to_file2</code> (42K keys) you need make up to 32K regex searches for each of the 42K lines of file 2. That&#39;s 1.344 billion operations, so it could take awhile. If you rerun it I suggest you include a counter and a <code>puts</code> statement that displays a line number and the elapsed time from start each time a new line in file 2 is processed. That would allow you to estimate how long the calculation will take. You might also try replacing <code>line.match?(Regexp.escape(language))</code> with  <code>line.include?(language)</code>. I&#39;m guessing that would be considerably faster."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 1, "creation_date": 1562050613, "post_id": 56823680, "comment_id": 100244560, "body": "I edited my answer to replace <code>line.match?(Regexp.escape(language))</code> with <code>line.include?(language)</code>. I expect that will speed calculations."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 1, "creation_date": 1562130394, "post_id": 56823680, "comment_id": 100275550, "body": "Your last change really makes a big difference. Yesterday I needed to stop after 1:20 hours, now the execution time was 2 min!!! Thanks a lot for your great and kindly help."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 1, "last_activity_date": 1562050524, "last_edit_date": 1562050524, "creation_date": 1561885985, "answer_id": 56823680, "question_id": 56822952, "link": "https://stackoverflow.com/questions/56822952/how-to-search-strings-of-one-file-in-another-file-and-print-line-number-of-the-m/56823680#56823680", "title": "How to search strings of one file in another file and print line number of the match in ruby?", "body": "<p>I assume each line in file 1 appears in at most one line in file 2 and each line of file 2 contains no more than one language in file 1, which is consistent with the example given in the question.  </p>\n\n<p>Let's first construct the files. To make life more interesting, I've modified the contents of both files given in the question. </p>\n\n<pre><code>file1 =&lt;&lt;-END\nRuby\nC\nVisual Basic\nC++\nR\nObjective-C++\nBasic\nHTML\nEND\n\nFName1 = 'file1'\nFile.write(FName1, file1)\n  #=&gt; 51\n</code></pre>\n\n<h1><p></p></h1>\n\n<pre><code>file2 =&lt;&lt;-END\n5. ab cde fg Java hij kl\n2. ab PHP dddf llf \n4. cde fg z o Objective-C++ oode\n8. a12b cde JavaScript kdk\n6. ab99r cde Visual Basic llso dkd\n1. lkd dsk Ruby kksdk\n3. Python dsdls\n7. kdjd C jdjd\n9. CSS dkdsk\n10. blah C++ blah\n7. kkd Basic jjs\n3. rooor R kdk\nEND\n\nFName2 = 'file2'\nFile.write(FName2, file2)\n  #=&gt; 256\n</code></pre>\n\n<p>First read the lines of <code>FName1</code> into an array.</p>\n\n<pre><code>languages = File.readlines(FName1, chomp:true)\n  #=&gt; [\"Ruby\", \"C\", \"Visual Basic\", \"C++\",\n  #    \"R\", \"Objective-C++\", \"Basic\", \"HTML\"]  \n</code></pre>\n\n<p>Now, for convenience, order the elements of <code>languages</code> be decreasing length.</p>\n\n<pre><code>sorted_languages = languages.sort_by(&amp;:length).reverse\n  #=&gt; [\"Objective-C++\", \"Visual Basic\", \"Basic\",\n  #    \"Ruby\", \"HTML\", \"C++\", \"C\", \"R\"] \n</code></pre>\n\n<p>I've sorted the elements of <code>languages</code> by decreasing word length so that an attempt to match a line of <code>FName2</code> with 'Objective-C++' will be made before an attempt is made to match 'C++', and 'C++' will be considered before 'C'. Similarly, 'Visual Basic' will be considered as a match before 'Basic' is considered.</p>\n\n<p>Next, create a hash whose keys are those lines in <code>FName1</code> that appear in a line of <code>FName2</code> and whose values are hashes identifying the line number and line in <code>FName2</code> for the given key.</p>\n\n<pre><code>language_to_file2 = File.foreach(FName2, chomp: true).\n  with_index(1).\n  with_object({}) do |(line,n),h|\n    language = sorted_languages.find { |language| line.include?(language) }\n    h[language] = { line: line, nbr: n } unless language.nil?\n  end\n  #=&gt; {\"Objective-C++\"=&gt;{:line=&gt;\"4. cde fg z o Objective-C++ oode\", :nbr=&gt;3},\n  #    \"Visual Basic\" =&gt;{:line=&gt;\"6. ab99r cde Visual Basic llso dkd\", :nbr=&gt;5},\n  #    \"Ruby\"         =&gt;{:line=&gt;\"1. lkd dsk Ruby kksdk\", :nbr=&gt;6},\n  #    \"C\"            =&gt;{:line=&gt;\"7. kdjd C jdjd\", :nbr=&gt;8},\n  #    \"C++\"          =&gt;{:line=&gt;\"10. blah C++ blah\", :nbr=&gt;10},\n  #    \"Basic\"        =&gt;{:line=&gt;\"7. kkd Basic jjs\", :nbr=&gt;11},\n  #    \"R\"            =&gt;{:line=&gt;\"3. rooor R kdk\", :nbr=&gt;12}}\n</code></pre>\n\n<p>We may now display the desired result.</p>\n\n<pre><code>languages.each do |language|\n  print \"#{language}|\"\n  if language_to_file2.key?(language)\n    h = language_to_file2[language]\n    puts \"%d|%s\" % [h[:nbr], h[:line]]\n  else\n    puts \"Not found\"\n  end\nend\nRuby|6|1. lkd dsk Ruby kksdk\nC|8|7. kdjd C jdjd\nVisual Basic|5|6. ab99r cde Visual Basic llso dkd\nC++|10|10. blah C++ blah\nR|12|3. rooor R kdk\nObjective-C++|3|4. cde fg z o Objective-C++ oode\nBasic|11|7. kkd Basic jjs\nHTML|Not found\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56823680, "answer_count": 2, "score": 2, "last_activity_date": 1562050524, "creation_date": 1561877144, "last_edit_date": 1562019417, "question_id": 56822952, "link": "https://stackoverflow.com/questions/56822952/how-to-search-strings-of-one-file-in-another-file-and-print-line-number-of-the-m", "title": "How to search strings of one file in another file and print line number of the match in ruby?", "body": "<p>I have this 2 files:</p>\n\n<p>file1</p>\n\n<pre><code>Ruby\nC\nVisual Basic\nR\nObjective-C\nBasic\nHTML\n</code></pre>\n\n<p>file2</p>\n\n<pre><code>5. ab cde fg Java hij kl\n2. ab PHP dddf llf \n4. cde fg z o Objective-C oode\n8. a12b cde JavaScript kdk\n6. ab99r cde Visual Basic llso dkd\n1. lkd dsk Ruby kksdk\n3. Python dsdls\n7. kdjd C jdjd\n9. CSS dkdsk\n7. kkd Basic jjs\n3. rooor R kdk\n</code></pre>\n\n<p>I\u00b4d like to search the strings in file1 and if they are found within file2, then print the \"the string of file1\", followed by line number in file2,  and the line of file2 where each string is present.</p>\n\n<p>The output format would be like this:</p>\n\n<p>find \"string\" of file1|Line in file2 where \"string\" of file1 was found| text of line in file2 where \"string\" of file1 was found </p>\n\n<p>For the sample file1 and file2  the output I\u00b4m looking for is:</p>\n\n<pre><code>Ruby|6|1. lkd dsk Ruby kksdk\nC|8|7. kdjd C jdjd\nVisual Basic|5|6. ab99r cde Visual Basic llso dkd\nR|11|3. rooor R kdk\nObjective-C|3|4. cde fg z o Objective-C oode\nBasic|10|7. kkd Basic jjs\nHTML|Not found\n</code></pre>\n\n<p>I've tried with the following code, but doesn\u00b4t find anything. My real file1 has about 32K lines and real file2 has about 48K lines.  </p>\n\n<pre><code>require 'set'\n\nf2_set = File.readlines(\"file2.txt\").map(&amp;:chomp).to_set\nFile.foreach(\"file1.txt\") { |line| puts line if f2_set.include?(line) }\n</code></pre>\n\n<p>Thanks for any help</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Below I show <code>file1</code> and <code>file2</code> proposed by @CarySwoveland and how would be the <code>output</code> for those inputs.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RdCMb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RdCMb.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>UPDATE2</strong></p>\n\n<p>Below samples of <a href=\"https://www.dropbox.com/s/x7jsj5tdicz1nw0/f1?raw=1\" rel=\"nofollow noreferrer\">file1</a>, <a href=\"https://www.dropbox.com/s/hrv5p8j8r09himo/f2?raw=1\" rel=\"nofollow noreferrer\">file2</a> and output <a href=\"https://www.dropbox.com/s/vxkk8vs4s8khdma/f3?raw=1\" rel=\"nofollow noreferrer\">file3</a>. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-5"], "comments": [{"owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "edited": false, "score": 0, "creation_date": 1561869501, "post_id": 56822273, "comment_id": 100197580, "body": "Do you want an array of 5 numbers which are randomly generated between 0 and 10?"}, {"owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1561870492, "post_id": 56822273, "comment_id": 100197707, "body": "Need more clarity as to what is needed. Your implementation of it may be not be required for this question. Please some examples of expected sample output."}], "answers": [{"tags": [], "owner": {"reputation": 3705, "user_id": 8551976, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxgdN.jpg?s=128&g=1", "display_name": "asimhashmi", "link": "https://stackoverflow.com/users/8551976/asimhashmi"}, "is_accepted": false, "score": 2, "last_activity_date": 1561870217, "creation_date": 1561870217, "answer_id": 56822474, "question_id": 56822273, "link": "https://stackoverflow.com/questions/56822273/rails-random-unique-array-of-fixed-length/56822474#56822474", "title": "Rails: random unique array of fixed length", "body": "<blockquote>\n  <p>One way would be to generate a range of numbers from <code>0</code> to <code>10</code> and\n  then shuffle them to get the unique random numbers.</p>\n</blockquote>\n\n<p>You can convert that range to Array using <a href=\"https://apidock.com/ruby/Array/to_a\" rel=\"nofollow noreferrer\"><code>to_a</code></a> and shuffle them using <a href=\"https://apidock.com/ruby/Array/shuffle\" rel=\"nofollow noreferrer\"><code>shuffle</code></a></p>\n\n<p>You can do something like this:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> (0..10).to_a.shuffle[0..4] # =&gt; [8, 6, 1, 9, 10]\n</code></pre>\n\n<p><code>[0..4]</code> will give you the first 5 shuffled elements.</p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1561877935, "post_id": 56822547, "comment_id": 100198712, "body": "Whether you use <code>loop</code>, it does not need to be nested; check my answer for the clean solution with <code>loop</code>."}], "tags": [], "owner": {"reputation": 7019, "user_id": 2788206, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b577ff7b8c73ee8573d43fa2519c4faf?s=128&d=identicon&r=PG", "display_name": "Sampat Badhe", "link": "https://stackoverflow.com/users/2788206/sampat-badhe"}, "is_accepted": false, "score": 2, "last_activity_date": 1561871711, "last_edit_date": 1561871711, "creation_date": 1561871305, "answer_id": 56822547, "question_id": 56822273, "link": "https://stackoverflow.com/questions/56822273/rails-random-unique-array-of-fixed-length/56822547#56822547", "title": "Rails: random unique array of fixed length", "body": "<p>Using <code>SecureRandom</code></p>\n\n<pre><code>def fixed\n  unique_numbers = []\n\n  5.times.collect do \n    loop do\n      number = SecureRandom.random_number(10)\n      break number unless unique_numbers.include?(number)\n    end\n  end\nend\n</code></pre>\n\n<p>And if you want to generate unique numbers between 1 to 10, then you can create array of 1 to 10 and use <code>shuffle</code> or <code>sample</code> to get random numbers.</p>\n\n<p>Using <a href=\"https://apidock.com/ruby/Array/shuffle\" rel=\"nofollow noreferrer\">shuffle</a></p>\n\n<pre><code>&gt; (0...10).to_a.shuffle.take(5)\n=&gt; [4, 0, 1, 3, 7] \n&gt; (0...10).to_a.shuffle.take(5)\n=&gt; [6, 2, 3, 9, 1] \n&gt; (0...10).to_a.shuffle.take(5)\n=&gt; [9, 2, 5, 8, 4] \n&gt; (0...10).to_a.shuffle.take(5)\n=&gt; [5, 0, 6, 8, 7] \n&gt; (0...10).to_a.shuffle.take(5)\n=&gt; [2, 7, 1, 5, 0] \n</code></pre>\n\n<p>Using <a href=\"http://ruby-doc.org/core-1.9.3/Array.html#method-i-sample\" rel=\"nofollow noreferrer\">sample</a></p>\n\n<pre><code>&gt; (1..10).to_a.sample(5)\n=&gt; [4, 6, 3, 2, 7] \n&gt; (1..10).to_a.sample(5)\n=&gt; [5, 8, 2, 3, 7] \n&gt; (1..10).to_a.sample(5)\n=&gt; [2, 5, 6, 1, 3] \n&gt; (1..10).to_a.sample(5)\n=&gt; [8, 5, 10, 9, 3] \n&gt; (1..10).to_a.sample(5)\n=&gt; [8, 1, 5, 3, 4]\n</code></pre>\n\n<p>You can also pass <code>SecureRandom</code> custom random generator as an argument with <code>sample</code></p>\n\n<pre><code>&gt; (1..10).to_a.sample(5, random: SecureRandom)\n =&gt; [6, 3, 4, 7, 10] \n&gt; (1..10).to_a.sample(5, random: SecureRandom)\n =&gt; [7, 4, 8, 1, 5] \n&gt; (1..10).to_a.sample(5, random: SecureRandom)\n =&gt; [8, 3, 9, 5, 10] \n&gt; (1..10).to_a.sample(5, random: SecureRandom)\n =&gt; [6, 8, 9, 2, 1] \n&gt; (1..10).to_a.sample(5, random: SecureRandom)\n =&gt; [9, 10, 1, 8, 2] \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1561871697, "post_id": 56822560, "comment_id": 100197839, "body": "But the numbers won&#39;t be unique in the output. That&#39;s one of the condition."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1561872045, "post_id": 56822560, "comment_id": 100197875, "body": "@abhishek77in The number <b>will</b> be unique. In the first version <code>sample</code> only returns unique indexes from the range and in the second version using a <code>Set</code> guarantees only unique values (and speeds up the repeated check for duplicates). Why do you think it won&#39;t?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1561877464, "post_id": 56822560, "comment_id": 100198640, "body": "Both yours and mine are drastically inefficient on <code>size</code> approaching <code>max</code>. Your solution is easier to tweak to switch to <code>((1..max).to_a - values)</code> when approaching <code>size</code> (where <code>values</code> are calculated as is, but treated as  <i>undesired</i>.)"}, {"owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1561880163, "post_id": 56822560, "comment_id": 100199052, "body": "@spickermann each number in the array has to be unique. It&#39;s a very clever solution but each number within the array will not be unique in both the cases."}, {"owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 0, "creation_date": 1561880218, "post_id": 56822560, "comment_id": 100199059, "body": "@spickermann As I mentioned in the comment on the question, the problem is question is not well put."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "edited": false, "score": 1, "creation_date": 1561880596, "post_id": 56822560, "comment_id": 100199101, "body": "@abhishek77in: What do you mean by <i>each number has to be unique</i> and that my solution will <i>not be unique</i>? In both versions there <i>will not duplicates</i> and I think that is the definition of <i>unique</i>. This is guaranteed by <code>sample</code> and the use of a <code>Set</code>. I do not understand what you think is wrong. Please elaborate."}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 7, "last_activity_date": 1561872561, "last_edit_date": 1561872561, "creation_date": 1561871475, "answer_id": 56822560, "question_id": 56822273, "link": "https://stackoverflow.com/questions/56822273/rails-random-unique-array-of-fixed-length/56822560#56822560", "title": "Rails: random unique array of fixed length", "body": "<p>When the number of possible values is small \u2013 like 10 in your example \u2013 then I would generate an array with all options and just pick a random <a href=\"https://ruby-doc.org/core-2.6.3/Array.html#method-i-sample\" rel=\"nofollow noreferrer\"><code>sample</code></a> of entries:</p>\n\n<pre><code>(0..9).to_a.sample(5)\n</code></pre>\n\n<p>If the number of possible values is huge then generation all values first is certainly not an option. Then I would generate a random value as long as the array doesn't contain enough entries:</p>\n\n<pre><code>require 'set'\nvalues = Set.new\nuntil values.length == 5 do\n  values.add(SecureRandom.random_number(1_000_000))\nend\nvalues.to_a\n</code></pre>\n\n<p>Note the I am using a <a href=\"https://ruby-doc.org/stdlib-2.6.3/libdoc/set/rdoc/Set.html\" rel=\"nofollow noreferrer\"><code>Set</code></a> to ensure the uniqueness of the values in the second version.</p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1561877713, "last_edit_date": 1561877713, "creation_date": 1561877015, "answer_id": 56822941, "question_id": 56822273, "link": "https://stackoverflow.com/questions/56822273/rails-random-unique-array-of-fixed-length/56822941#56822941", "title": "Rails: random unique array of fixed length", "body": "<p>Just out of curiosity, using <a href=\"https://ruby-doc.org/core/Enumerable.html#method-i-cycle\" rel=\"nofollow noreferrer\"><code>Enumerable#cycle</code></a> infinite generator.</p>\n\n<pre><code>MAX = 10\nSIZE = 5\n\n[MAX].cycle.inject(Set.new) do |acc, max|\n  break acc if acc.size &gt;= SIZE\n  acc &lt;&lt; SecureRandom.random_number(max)\nend\n#\u21d2 #&lt;Set: {2, 1, 7, 0, 9}&gt;\n</code></pre>\n\n<p>or even with generic <code>loop</code>:</p>\n\n<pre><code>loop.each_with_object(Set.new) do |_, acc|\n  break acc if acc.size &gt;= SIZE\n  acc &lt;&lt; SecureRandom.random_number(10)\nend\n#\u21d2 #&lt;Set: {2, 6, 7, 1, 3}&gt;\n</code></pre>\n"}], "owner": {"reputation": 5836, "user_id": 1153022, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgpPs.jpg?s=128&g=1", "display_name": "okay56k", "link": "https://stackoverflow.com/users/1153022/okay56k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56822560, "answer_count": 4, "score": 1, "last_activity_date": 1561877713, "creation_date": 1561866408, "last_edit_date": 1561869915, "question_id": 56822273, "link": "https://stackoverflow.com/questions/56822273/rails-random-unique-array-of-fixed-length", "title": "Rails: random unique array of fixed length", "body": "<p>How can I ensure uniqueness in this array while maintaining its length at <code>5</code>?</p>\n\n<pre><code>def fixed\n  5.times.collect { SecureRandom.random_number(10) }\nend\n</code></pre>\n\n<p>This behaviour seems <em>odd</em>:</p>\n\n<pre><code>5.times.collect.uniq { SecureRandom.random_number(10) }\n# =&gt; [0, 2, 3, 4]\n5.times.collect.uniq { SecureRandom.random_number(10) }\n# =&gt; [0, 1, 3]\n5.times.collect.uniq { SecureRandom.random_number(10) }\n#\u00a0=&gt; [0, 1, 2, 3, 4]\n5.times.collect.uniq { SecureRandom.random_number(10) }\n# =&gt; [0, 1, 2, 4]\n5.times.collect.uniq { SecureRandom.random_number(10) }\n#\u00a0=&gt; [0, 1, 2, 3]\n</code></pre>\n"}, {"tags": ["ruby", "ruby-2.3", "ruby-2.6"], "comments": [{"owner": {"reputation": 3201, "user_id": 2892779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uvM8S.jpg?s=128&g=1", "display_name": "Jay Dorsey", "link": "https://stackoverflow.com/users/2892779/jay-dorsey"}, "edited": false, "score": 1, "creation_date": 1561852226, "post_id": 56821461, "comment_id": 100195931, "body": "Can you post the code you&#39;re using to load the CSV? I don&#39;t see this behavior when calling <code>CSV.read</code> with <code>headers: true</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561852908, "post_id": 56821461, "comment_id": 100196025, "body": "I don&#39;t think your first result could possibly be correct. After all, if <code>obj</code> is not an array <code>[[obj]].flatten #=&gt; [obj]</code>, regardless of whether <code>obj</code> is a CSV row object or something else."}, {"owner": {"reputation": 111, "user_id": 5593964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/866925096736429/picture?type=large", "display_name": "Kouta Osabe", "link": "https://stackoverflow.com/users/5593964/kouta-osabe"}, "edited": false, "score": 0, "creation_date": 1561857471, "post_id": 56821461, "comment_id": 100196440, "body": "In ruby 2.6, [[#&lt;CSV::Row &quot;no&quot;:&quot;001111&quot; &quot;status&quot;:&quot;1&quot; &gt;]].flatten(1) returns [#&lt;CSV::Row &quot;no&quot;:&quot;001111&quot; &quot;status&quot;:&quot;1&quot;&gt;]. CSV::Row object is not an array.so i expect that  [[#&lt;CSV::Row &quot;no&quot;:&quot;001111&quot; &quot;status&quot;:&quot;1&quot; &gt;]].flatten returns [#&lt;CSV::Row &quot;no&quot;:&quot;001111&quot; &quot;status&quot;:&quot;1&quot;&gt;]  but doesn&#39;t."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1561875781, "post_id": 56821461, "comment_id": 100198376, "body": "I reproduced the first result (v2.6.0rc1) using v2.7.0. I would think the second result (v2.3.8) is correct and the first result is due to a bug, but I can&#39;t mind-read the Ruby monks&#39; intent. I did notice that the C code for <code>Array#flatten</code> differs between the two versions, but I&#39;m not quite up to digging though it. I&#39;ll look at it tomorrow and at a minimum post some example data and code, and some thoughts on the subject. Interesting."}, {"owner": {"reputation": 111, "user_id": 5593964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/866925096736429/picture?type=large", "display_name": "Kouta Osabe", "link": "https://stackoverflow.com/users/5593964/kouta-osabe"}, "edited": false, "score": 0, "creation_date": 1561935028, "post_id": 56821461, "comment_id": 100209608, "body": "I reported bug issue below. <a href=\"https://bugs.ruby-lang.org/issues/15967\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org/issues/15967</a>  This is Known issue.   Kouhei Sutou said  &quot;It&#39;s introduced by #10013. Adding CSV::Row#to_ary may be wrong. But I couldn&#39;t remove CSV::Row#to_ary to avoid compatibility breakage again.&quot;"}], "owner": {"reputation": 111, "user_id": 5593964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/866925096736429/picture?type=large", "display_name": "Kouta Osabe", "link": "https://stackoverflow.com/users/5593964/kouta-osabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1561850589, "creation_date": 1561850589, "question_id": 56821461, "link": "https://stackoverflow.com/questions/56821461/two-dimensional-array-which-have-csvrow-object-returns-different-result-in-rub", "title": "Two dimensional array which have CSV::Row object returns different result in ruby 2.3 and ruby 2.6", "body": "<p>Two dimensional array has the element which is CSV::Row object like this.</p>\n\n<p>[[csv_row_object]]</p>\n\n<p>I tried to flatten this array and got different result in ruby 2.3 and 2.6.</p>\n\n<p>why different result?</p>\n\n<pre><code># in Ruby 2.6(ruby 2.6.0rc1)\n\n[[#&lt;CSV::Row \"no\":\"001111\" \"status\":\"1\" &gt;]].flatten\n\nreturns [\"no\",\"001111\",\"status\",\"1\"]\n\n\n# in Ruby 2.3.8\n\n[[#&lt;CSV::Row \"no\":\"001111\" \"status\":\"1\"&gt;]].flatten\n\nreturns [#&lt;CSV::Row \"no\":\"001111\" \"status\":\"1\"&gt;]\n</code></pre>\n"}, {"tags": ["ruby", "twitter", "twitter-gem"], "answers": [{"tags": [], "owner": {"reputation": 8733, "user_id": 3625433, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/N7qK6.png?s=128&g=1", "display_name": "lacostenycoder", "link": "https://stackoverflow.com/users/3625433/lacostenycoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1561849006, "creation_date": 1561849006, "answer_id": 56821372, "question_id": 56820614, "link": "https://stackoverflow.com/questions/56820614/event-loop-for-twitter4r/56821372#56821372", "title": "Event loop for Twitter4r", "body": "<p>The gem is just a wrapper for the API so refer to the <a href=\"https://developer.twitter.com/en/docs/basics/rate-limits\" rel=\"nofollow noreferrer\">Rate Limits</a> on Twitter where we find this:</p>\n\n<blockquote>\n  <p>GET endpoints The standard API rate limits described in this table\n  refer to GET (read) endpoints. Note that endpoints not listed in the\n  chart default to 15 requests per allotted user. All request windows\n  are 15 minutes in length.  These rate limits apply to the standard API\n  endpoints only, does not apply to premium APIs.</p>\n</blockquote>\n\n<pre><code>GET statuses/mentions_timeline  statuses    75  0\n</code></pre>\n\n<p>So it looks like you can only hit that endpoint 75 times per 15 minutes and the simple math for that is </p>\n\n<pre><code>15 * 60 / 75 = 12\n</code></pre>\n\n<p>So you probably should not hit it more than once every 12-15 seconds to be safe.</p>\n\n<p>You could also keep track of your calls over time, rescue the exception and retry the request in the event that you hit the rate limit.</p>\n"}], "owner": {"reputation": 71, "user_id": 6248404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06045e8f1e74c7f1f62d905c933316b8?s=128&d=identicon&r=PG&f=1", "display_name": "Marry Jane", "link": "https://stackoverflow.com/users/6248404/marry-jane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561849006, "creation_date": 1561839490, "last_edit_date": 1561842674, "question_id": 56820614, "link": "https://stackoverflow.com/questions/56820614/event-loop-for-twitter4r", "title": "Event loop for Twitter4r", "body": "<p>Is there an event loop for Twitter4R where when a user mentions the bot's handle, it will notify the bot?</p>\n\n<p>I have tried to make it work with checking <code>client.mentions_timeline</code> every 5 seconds to see if there are new tweets that are mentioning the bot's handle. It worked, however, the rate limit often time gets exceeded after checking <code>client.mentions_timeline</code> numerous times. Is there a way that I can optimize this or am I missing something?</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>         6: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/users.rb:237:in `user'\n         5: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/users.rb:53:in `verify_credentials'\n         4: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/utils.rb:57:in `perform_get_with_object'\n         3: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/utils.rb:72:in `perform_request_with_object'\n         2: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/utils.rb:50:in `perform_request'\n         1: from C:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/request.rb:39:in `perform'\nC:/Ruby26-x64/lib/ruby/gems/2.6.0/gems/twitter-6.2.0/lib/twitter/rest/request.rb:81:in `fail_or_return_response_body': Rate limit exceeded (Twitter::Error::TooManyRequests)\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1561882728, "post_id": 56820730, "comment_id": 100199446, "body": "I&#39;d rather find a solution without ajax. i&#39;ve never used it before"}, {"owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "reply_to_user": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1561899846, "post_id": 56820730, "comment_id": 100202443, "body": "then you should use <code>@forecasts_facade</code> instead of <code>ForecastsFacade</code> in the view"}, {"owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "edited": false, "score": 0, "creation_date": 1561994661, "post_id": 56820730, "comment_id": 100229088, "body": "THat&#39;s still giving me <code>undefined local variable or method &#39;city&#39; for #&lt;ForecastsController</code>"}], "tags": [], "owner": {"reputation": 1049, "user_id": 5832250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SnJA.jpg?s=128&g=1", "display_name": "Gagan Gupta", "link": "https://stackoverflow.com/users/5832250/gagan-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1561840613, "creation_date": 1561840613, "answer_id": 56820730, "question_id": 56820574, "link": "https://stackoverflow.com/questions/56820574/why-am-i-getting-a-name-error-in-my-rails-controller-whilst-initializing-my-faca/56820730#56820730", "title": "Why am I getting a name error in my Rails controller whilst initializing my facade class?", "body": "<p>From your code what I can see is that on the page <code>current_weather.html.erb</code>. You have written: </p>\n\n<pre><code>&lt;% if ForecastsFacade.forecast.dig('cod').to_i == 404 %&gt;\n    &lt;p&gt;Please use a valid city name!&lt;/p&gt;\n  &lt;% elsif ForecastsFacade.forecast.dig('cod').to_i == 400 %&gt;\n    &lt;p&gt;Please type in a city name!&lt;/p&gt;\n  &lt;% elsif ForecastsFacade.forecast == {} %&gt;\n  &lt;% else %&gt;\n    &lt;p class=\"weather-description\"&gt;&lt;%= \"#{ForecastsFacade.city.capitalize}: #{ForecastsFacade.description}\" %&gt;&lt;/p&gt;\n    &lt;div class=\"gif-container\"&gt;&lt;%= image_tag(find_gif_url, class: \"gif\") %&gt;\n      &lt;span class=\"temperature weather-attribute\"&gt;&lt;%= \"#{ForecastsFacade.temperature}\u00b0C\" %&gt;&lt;/span&gt;\n      &lt;span class=\"wind weather-attribute\"&gt;&lt;%= \"wind:#{(ForecastsFacade.wind * 3.6).to_i}km/h\" %&gt;&lt;/span&gt; &lt;!-- converts to km/hr --&gt;\n      &lt;span class=\"humidity weather-attribute\"&gt;&lt;%= \"humidity:#{ForecastsFacade.humidity}%\" %&gt;&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Here <code>ForecastsFacade</code> is a class. <code>forecast</code> is an instance method. So, <code>initialized</code> is not called when you're calling the function. </p>\n\n<p>Try to use ajax request and use <code>@forecasts_facade</code> in the <code>js.erb</code> to create a partial which will help you in achieving the functionality. </p>\n"}], "owner": {"reputation": 168, "user_id": 11058389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8db7ac2b919eb66c430dfaaab7fdcf?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/11058389/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1561840613, "creation_date": 1561839101, "question_id": 56820574, "link": "https://stackoverflow.com/questions/56820574/why-am-i-getting-a-name-error-in-my-rails-controller-whilst-initializing-my-faca", "title": "Why am I getting a name error in my Rails controller whilst initializing my facade class?", "body": "<p>I'm creating a simple Rails app that consumes the Open Weather Map API and returns various weather parameters. My API call is handled in a service class and I'm trying to follow the facade pattern and deal with the parameter data in a PORO. The code I have already is below. I am getting a <code>NameError. undefined local variable or method</code>city'` Any idea where I am going wrong?</p>\n\n<p>app/services/open_weather_api.rb</p>\n\n<pre><code>class OpenWeatherApi\n  include HTTParty\n  base_uri \"http://api.openweathermap.org\"\n\n  def initialize(city, appid)\n    @options = { query: { q: city, APPID: appid } }\n  end\n\n  def my_location_forecast\n    self.class.get(\"/data/2.5/weather\", @options)\n  end\nend\n</code></pre>\n\n<p>app/facades/forecasts_facade.rb</p>\n\n<pre><code>class ForecastsFacade\n  TOKEN = Rails.application.credentials.openweather_key\n\n  def initialize(city, forecast, temperature, weather_code, description, wind, humidity)\n    @city = city\n    @forecast = forecast\n    @temperature = temperature\n    @weather_code = weather_code\n    @description = description\n    @wind = wind\n    @humidity = humidity\n  end\n\n  def city\n    @city = params[:q]\n  end\n\n  def forecast\n    if @city.nil?\n      @forecast = {}\n    else\n      @forecast = OpenWeatherApi.new(@city, TOKEN).my_location_forecast\n    end\n  end\n\n  def temperature\n    @temperature = @forecast.dig('main', 'temp').to_i - 273\n  end\n\n  def weather_code\n    @weather_code = @forecast.dig('weather', 0, 'id').to_i\n  end\n\n  def description\n    @description = @forecast.dig('weather', 0, 'description')\n  end\n\n  def wind\n    @wind = @forecast.dig('wind', 'speed').to_i\n  end\n\n  def humidity\n    @humidity = @forecast.dig('main', 'humidity')\n  end\nend\n</code></pre>\n\n<p>forecasts_controller.rb</p>\n\n<pre><code>class ForecastsController &lt; ApplicationController\n  def current_weather\n    @forecasts_facade = ForecastsFacade.new(city, forecast, temperature, weather_code, description, wind, humidity)\n  end\nend\n</code></pre>\n\n<p>current_weather.html.erb</p>\n\n<pre><code>&lt;div class=\"page-wrapper\"&gt;\n  &lt;h1 class=\"title\"&gt;The weather in GIFs&lt;/h1&gt;\n\n  &lt;div class=\"search\"&gt;\n    &lt;%= form_tag(current_weather_forecasts_path, method: :get) do %&gt;\n      &lt;%= text_field_tag :q, nil, placeholder: \"Enter a city\", class: \"search-field\" %&gt;\n      &lt;%= button_tag type: 'submit', class: \"search-button\" do %&gt;\n        &lt;i class=\"fas fa-search\"&gt;&lt;/i&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n\n  &lt;% if ForecastsFacade.forecast.dig('cod').to_i == 404 %&gt;\n    &lt;p&gt;Please use a valid city name!&lt;/p&gt;\n  &lt;% elsif ForecastsFacade.forecast.dig('cod').to_i == 400 %&gt;\n    &lt;p&gt;Please type in a city name!&lt;/p&gt;\n  &lt;% elsif ForecastsFacade.forecast == {} %&gt;\n  &lt;% else %&gt;\n    &lt;p class=\"weather-description\"&gt;&lt;%= \"#{ForecastsFacade.city.capitalize}: #{ForecastsFacade.description}\" %&gt;&lt;/p&gt;\n    &lt;div class=\"gif-container\"&gt;&lt;%= image_tag(find_gif_url, class: \"gif\") %&gt;\n      &lt;span class=\"temperature weather-attribute\"&gt;&lt;%= \"#{ForecastsFacade.temperature}\u00b0C\" %&gt;&lt;/span&gt;\n      &lt;span class=\"wind weather-attribute\"&gt;&lt;%= \"wind:#{(ForecastsFacade.wind * 3.6).to_i}km/h\" %&gt;&lt;/span&gt; &lt;!-- converts to km/hr --&gt;\n      &lt;span class=\"humidity weather-attribute\"&gt;&lt;%= \"humidity:#{ForecastsFacade.humidity}%\" %&gt;&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku", "bundler"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 1, "creation_date": 1561837347, "post_id": 56819924, "comment_id": 100193745, "body": "Are your <code>Gemfile</code> and <code>Gemfile.lock</code> up to date, and included in your repository?"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561839148, "post_id": 56819924, "comment_id": 100194077, "body": "@Chris Yes, <code>Gemfile</code> and <code>Gemfile.lock</code> are included normally."}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561839351, "post_id": 56819924, "comment_id": 100194124, "body": "Please <a href=\"https://stackoverflow.com/posts/56819924/edit\">edit</a> your question and add the log output that precedes what you&#39;ve already shared."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561840526, "post_id": 56819924, "comment_id": 100194364, "body": "I just edited the post and added the Heroku logs."}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 1, "creation_date": 1561841180, "post_id": 56819924, "comment_id": 100194522, "body": "Okay, so your log says <code>No web processes running</code>. (a) What&#39;s in your <code>Procfile</code>? (b) Are your <code>Gemfile</code> and <code>Gemfile.lock</code> checked into your repository?"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561842282, "post_id": 56819924, "comment_id": 100194755, "body": "(a) I don&#39;t have this file in my project or I don&#39;t know that I have it. (b) yes, they are included."}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561851097, "post_id": 56819924, "comment_id": 100195824, "body": "Are the <code>Gemfile</code> and <code>Gemfile.lock</code> in the root (top directory) of your repository? Is that the complete build output? There should be a whole lot more."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561883591, "post_id": 56819924, "comment_id": 100199592, "body": "@Chris Yes, it&#39;s normal that this files are in the root of project. Where are they supposed to be like not in the main catalog?"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561900502, "post_id": 56819924, "comment_id": 100202553, "body": "No, they should be in the root. I&#39;m just trying to figure out why your build log is so short. It doesn&#39;t appear to install any dependencies... have you manually set a buildpack, or are you relying on buildpack detection? Try running <code>heroku buildpacks</code> and see what that says."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "reply_to_user": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 0, "creation_date": 1561903543, "post_id": 56819924, "comment_id": 100203219, "body": "@Chris Hmm, <code>heroku buildpacks</code> shows only <code>Buildpack URL</code> <code>https:&#47;&#47;github.com&#47;gunpowderlabs&#47;buildpack-ruby-rake-deploy-&zwnj;&#8203;tasks</code>"}], "answers": [{"comments": [{"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1561906807, "post_id": 56825624, "comment_id": 100203915, "body": "OK, I done your above suggestions. Everything is fine to time until bundle completed:  <code>remote:  !   Could not detect rake tasks</code>  <code>remote:  !   ensure you can run &#39;$ bundle exec rake -P&#39; against your app</code>  <code>remote:  !   and using the production group of your Gemfile.</code>  <code>remote:  !   Activating bundler (2.0.1) failed:</code>  <code>remote:  !   Could not find &#39;bundler&#39; (= 2.0.1) - did find: [bundler-2.0.2]</code>  <code>remote:  !   Checked in &#39;GEM_PATH=vendor&#47;bundle&#47;ruby&#47;2.4.0&#39;, execute &#39;gem env&#39;</code>  <code>remote:  !   To install the version of bundler this project requires, run &#39;gem install bundler -v &#39;2.0.1&#39;&#39;</code>"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "reply_to_user": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1561907242, "post_id": 56825624, "comment_id": 100204015, "body": "This is very hard to read in a comment. Please edit your question and add the updated information there instead."}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1561912007, "post_id": 56825624, "comment_id": 100205095, "body": "I see now one more thing: when I uninstall all bundler versions (2.0.1 and 2.0.2) and install 2.0.1 again as in below errors - I see that <code>Installing dependencies using bundler 2.0.2</code> when I try to <code>git push heroku master</code> again. Do you know why?"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1561914337, "post_id": 56825624, "comment_id": 100205553, "body": "And on the bottom of Gemfile.lock is: <code>RUBY VERSION: ruby 2.4.0p0</code> and <code>BUNDLED WITH: 2.0.1</code>"}, {"owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1561993304, "post_id": 56825624, "comment_id": 100228407, "body": "OK, I solved above problem and I add the updated information. Thanks :)"}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "reply_to_user": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "edited": false, "score": 0, "creation_date": 1562080290, "post_id": 56825624, "comment_id": 100261014, "body": "<a href=\"https://meta.stackexchange.com/a/116105/248627\">Please don&#39;t edit answers into your question or add &quot;solved&quot; to your title</a>. Instead, <a href=\"https://meta.stackexchange.com/q/5234/248627\">mark an answer correct by clicking on the checkmark</a>. You can also <a href=\"https://stackoverflow.com/help/self-answer\">add your own answer</a> and accept it if none of the ones you received solved your problem. I have rolled back your question to the previous version."}], "tags": [], "owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1561904873, "last_edit_date": 1592644375, "creation_date": 1561904873, "answer_id": 56825624, "question_id": 56819924, "link": "https://stackoverflow.com/questions/56819924/why-i-get-an-error-when-trying-deploy-ruby-on-rails-app-to-heroku/56825624#56825624", "title": "Why I get an Error when trying deploy Ruby on Rails app to Heroku?", "body": "<blockquote>\n<p>Hmm, <code>heroku buildpacks</code> shows only</p>\n<pre><code>Buildpack URL https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks\n</code></pre>\n</blockquote>\n<p>There's your problem. At some point you explicitly chose this buildpack, and it's the wrong one. I suggest <a href=\"https://devcenter.heroku.com/articles/buildpacks#removing-a-buildpack-from-an-app\" rel=\"nofollow noreferrer\">removing the buildpack setting</a>:</p>\n<pre><code>heroku buildpacks:remove https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks\n</code></pre>\n<p>Then run <code>heroku buildpacks</code> again. You should see something like</p>\n<pre><code>&lt;your-app&gt; has no Buildpack URL set.\n</code></pre>\n<p>Once that's done, <a href=\"https://stackoverflow.com/q/41345744/354577\">redeploy</a> your code. Heroku will recognize a Ruby project by the presence of a <code>Gemfile</code> and use the appropriate buildpack automatically.</p>\n"}, {"tags": [], "owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "is_accepted": true, "score": 0, "last_activity_date": 1562235015, "creation_date": 1562235015, "answer_id": 56885634, "question_id": 56819924, "link": "https://stackoverflow.com/questions/56819924/why-i-get-an-error-when-trying-deploy-ruby-on-rails-app-to-heroku/56885634#56885634", "title": "Why I get an Error when trying deploy Ruby on Rails app to Heroku?", "body": "<p>OK, I solved the problem. Maybe it will help someone in the future:</p>\n\n<ul>\n<li>update Ruby version to 2.6.1</li>\n<li><code>gem uninstall bundler</code> and install again  <code>gem install bundler -v 2.0.2</code></li>\n<li>delete Gemfile.lock and <code>bundle install</code></li>\n<li><code>git push heroku master</code></li>\n<li><strong>it works :)</strong></li>\n</ul>\n"}], "owner": {"reputation": 266, "user_id": 5779471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d4fd2113141c6c85e7b9c3052b1ef?s=128&d=identicon&r=PG&f=1", "display_name": "Miro", "link": "https://stackoverflow.com/users/5779471/miro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 56885634, "answer_count": 2, "score": 0, "last_activity_date": 1562235015, "creation_date": 1561832942, "last_edit_date": 1562080305, "question_id": 56819924, "link": "https://stackoverflow.com/questions/56819924/why-i-get-an-error-when-trying-deploy-ruby-on-rails-app-to-heroku", "title": "Why I get an Error when trying deploy Ruby on Rails app to Heroku?", "body": "<p>When I try to deploy my Ruby on Rails app to Heroku I get some errors:</p>\n\n<pre><code>git push heroku master\n</code></pre>\n\n<pre><code>Counting objects: 5, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (5/5), done.\nWriting objects: 100% (5/5), 585 bytes | 585.00 KiB/s, done.\nTotal 5 (delta 3), reused 0 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Rake app detected\nremote: rake aborted!\nremote: LoadError: cannot load such file -- bundler/setup\nremote: /tmp/build_7852350a661d0da59c96dfb8f01c0e07/config/boot.rb:3:in `&lt;top (required)&gt;'\nremote: /tmp/build_7852350a661d0da59c96dfb8f01c0e07/config/application.rb:1:in `require_relative'\nremote: /tmp/build_7852350a661d0da59c96dfb8f01c0e07/config/application.rb:1:in `&lt;top (required)&gt;'\nremote: /tmp/build_7852350a661d0da59c96dfb8f01c0e07/Rakefile:4:in `require_relative'\nremote: /tmp/build_7852350a661d0da59c96dfb8f01c0e07/Rakefile:4:in `&lt;top (required)&gt;'\nremote: (See full trace by running task with --trace)\nremote:  !     Push rejected, failed to compile Rake app.\nremote: \nremote:  !     Push failed\nremote: Verifying deploy...\nremote: \nremote: !   Push rejected to remojobs.\nremote: \nTo https://git.heroku.com/sampleapp-miro.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'https://git.heroku.com/sampleapp-miro.git'\n\n</code></pre>\n\n<p>I use Ruby 2.4.0, Rails 5.2.3, and Bundler is 2.0.2.</p>\n\n<p>Below I present full errors from <code>heroku logs</code>:</p>\n\n<pre><code>2019-06-29T18:04:32.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:04:34.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/a430cb9b-857a-4764-9abc-cefd14e45caf\n2019-06-29T18:08:37.167236+00:00 heroku[router]: at=error code=H14 desc=\"No web processes running\" method=GET path=\"/\" host=sampleapp-miro.herokuapp.com request_id=f2ff0cfa-9faa-46d8-81c2-cd8c200fdc8a fwd=\"195.136.56.0\" dyno= connect= service= status=503 bytes= protocol=https\n2019-06-29T18:08:41.059684+00:00 heroku[router]: at=error code=H14 desc=\"No web processes running\" method=GET path=\"/favicon.ico\" host=sampleapp-miro.herokuapp.com request_id=456e9d84-7286-4b75-8a7d-50e397b9b8be fwd=\"195.136.56.0\" dyno= connect= service= status=503 bytes= protocol=https\n2019-06-29T18:09:09.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:09:10.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/c596ea0f-4936-45e1-a415-517178338c70\n2019-06-29T18:13:26.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:13:27.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/c78a0330-354f-4c1f-b04e-24418ab36b02\n2019-06-29T18:14:42.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:14:43.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/29cfa1cd-6af1-4bcc-8b4d-825e9131043c\n2019-06-29T18:15:32.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:15:33.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/43c3e880-6880-4cc8-b8b1-5184e7d66c86\n2019-06-29T18:17:04.000000+00:00 app[api]: Build started by user info@myemail.com\n2019-06-29T18:17:05.000000+00:00 app[api]: Build failed -- check your build output: https://dashboard.heroku.com/apps/8a339527-87e4-40c9-bee5-326119c29f60/activity/builds/d10a1410-48e9-48d1-9400-43a1b4fa0ea1\n</code></pre>\n\n<p>When I run <code>heroku buildpacks</code> I just see</p>\n\n<pre><code>Buildpack URL https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks\n</code></pre>\n\n<p><strong>UPDATED</strong></p>\n\n<p>I used:\n<code>heroku buildpacks:remove https://github.com/gunpowderlabs/buildpack-ruby-rake-deploy-tasks</code></p>\n\n<p>and after this:</p>\n\n<p><code>git push heroku master</code> </p>\n\n<p>gives me below errors:</p>\n\n<p><code>remote:        Bundle completed (163.52s)\nremote:        Cleaning up the bundler cache.\nremote: -----&gt; Installing node-v10.15.3-linux-x64\nremote: -----&gt; Detecting rake tasks\nremote:  !     Could not detect rake tasks\nremote:  !     ensure you can run '$ bundle exec rake -P' against your app\nremote:  !     and using the production group of your Gemfile.\nremote:  !     Activating bundler (2.0.1) failed:\nremote:  !     Could not find 'bundler' (= 2.0.1) - did find: [bundler-2.0.2]\nremote:  !     Checked in 'GEM_PATH=vendor/bundle/ruby/2.4.0', execute 'gem env' for more information \nremote:  !     To install the version of bundler this project requires, run gem install bundler -v '2.0.1'\nremote: /app/tmp/buildpacks/b7af56db6e6816adee09d510091abc07/lib/language_pack/helpers/rake_runner.rb:106:in 'load_rake_tasks!': Could not detect rake tasks (LanguagePack::Helpers::RakeRunner::CannotLoadRakefileError)\nremote: ensure you can run '$ bundle exec rake -P' against your app\nremote: and using the production group of your Gemfile.\nremote: Activating bundler (2.0.1) failed:\nremote: Could not find 'bundler' (= 2.0.1) - did find: [bundler-2.0.2]\nremote: Checked in 'GEM_PATH=vendor/bundle/ruby/2.4.0', execute 'gem env' for more information\nremote: To install the version of bundler this project requires, run gem install bundler -v '2.0.1'</code></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "comments": [{"owner": {"reputation": 805, "user_id": 4544219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CLo94.jpg?s=128&g=1", "display_name": "Mosaaleb", "link": "https://stackoverflow.com/users/4544219/mosaaleb"}, "edited": false, "score": 0, "creation_date": 1561842509, "post_id": 56819516, "comment_id": 100194799, "body": "I don&#39;t know if I understand you right, but I think you need something like <code>expect(@user.role).to be(:batman)</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "edited": false, "score": 0, "creation_date": 1561833427, "post_id": 56819929, "comment_id": 100192906, "body": "You are right reload is not needed. Sorry new to rspec. Im getting an &#39;undefined method `do_something_with&#39;&#39;?"}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1561834110, "post_id": 56819929, "comment_id": 100193036, "body": "I think @Vashed meant that <code>do_something_with</code> is just pseudocode for something you want to check, like changing a role or something else"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "edited": false, "score": 0, "creation_date": 1561834155, "post_id": 56819929, "comment_id": 100193048, "body": "@AndyWalker replace that with method that you\u2019re testing that should change role"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 2, "last_activity_date": 1561833010, "creation_date": 1561833010, "answer_id": 56819929, "question_id": 56819516, "link": "https://stackoverflow.com/questions/56819516/checking-user-roles-in-rspec-factorybot/56819929#56819929", "title": "Checking user roles in rspec FactoryBot", "body": "<p>You can write expectations for model fields too. Code is pretty self-explanatory:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>let(:user){ create(:user) }\n\nit \"has role batman\" do\n  expect(user.role).to eq(\"batman\")\nend\n</code></pre>\n\n<p>For changing:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>it \"changes role\" do\n  expect{\n    do_something_with(user)\n  }.to change{ user.reload.role }.from(\"batman\").to(\"superman\")\nend\n</code></pre>\n\n<p><code>reload</code> might be not needed in model tests, but usually is for other (request/system/etc) where record can change in db but not in exact instance in memory.</p>\n"}], "owner": {"reputation": 67, "user_id": 11530585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s7MOFD9RSlY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGY4gDshJQMuCG_v7x_es3za-BqA/mo/photo.jpg?sz=128", "display_name": "Andy Walker", "link": "https://stackoverflow.com/users/11530585/andy-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 56819929, "answer_count": 1, "score": 0, "last_activity_date": 1561833010, "creation_date": 1561829498, "question_id": 56819516, "link": "https://stackoverflow.com/questions/56819516/checking-user-roles-in-rspec-factorybot", "title": "Checking user roles in rspec FactoryBot", "body": "<p>I have two user roles and i want to write a test in rspec to see if the user role are attached to the user after creation. Also admins should be able to switch the user roles from one to the other.</p>\n\n<p>Here is my user model how i structure the type of users using a enum</p>\n\n<pre><code> enum role: [:batman, :superman]\n  after_initialize :set_default_role, :if =&gt; :new_record?\n\n  protected \n\n  def set_default_role\n    self.role ||= :batman\n  end\n</code></pre>\n\n<p>I am stuck on the test below and not sure how to go about checking the if the role was successfully attached. Also is there a way to check if the user role can be changed for a user? For example if the user was created with the role of batman, it can be switch to superman?</p>\n\n<pre><code>RSpec.describe User, type: :model do\n\n  before do\n    @user = FactoryBot.create(:user)\n  end\n\n  describe \"creation\" do\n    it \"can be created\" do\n      expect(@user).to be_valid\n    end\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "reactjs", "devise"], "comments": [{"owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "edited": false, "score": 0, "creation_date": 1561815420, "post_id": 56817922, "comment_id": 100189169, "body": "Hello Tristan, your question is too broad to give you a specific answer, so I voted to close it. And there are many good answers to your questions, of which the better ones are opinion based. You might want to be more specific on what issue you want to solve, and come with some example that can be solved."}, {"owner": {"reputation": 12440, "user_id": 308731, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/eQxFn.jpg?s=128&g=1", "display_name": "Eyeslandic", "link": "https://stackoverflow.com/users/308731/eyeslandic"}, "edited": false, "score": 0, "creation_date": 1561816579, "post_id": 56817922, "comment_id": 100189410, "body": "There&#39;s a spinoff of device which you might want to look at <a href=\"https://github.com/lynndylanhurley/devise_token_auth\" rel=\"nofollow noreferrer\">github.com/lynndylanhurley/devise_token_auth</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22847, "user_id": 1290438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b689dcfa3833cb016dfbc4cc82bb0eae?s=128&d=identicon&r=PG", "display_name": "zmo", "link": "https://stackoverflow.com/users/1290438/zmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1561815558, "creation_date": 1561815558, "answer_id": 56817988, "question_id": 56817922, "link": "https://stackoverflow.com/questions/56817922/using-rails-devise-in-api-mode/56817988#56817988", "title": "Using Rails Devise in API mode", "body": "<p>my comment being said, and vote for close being done, here's my answer to you:</p>\n\n<p>if you don't use rails own views, it's fine, though that means you'll have to build manually all the basic CRUDs for each model element you'll want to expose. Or you can have a backoffice in vanilla rails that will help you manage the basic model elements, and a frontoffice communicating through the API (because you can have both).</p>\n"}], "owner": {"reputation": 59, "user_id": 7178832, "user_type": "registered", "profile_image": "https://graph.facebook.com/797934013679014/picture?type=large", "display_name": "Tristan Vermeesch", "link": "https://stackoverflow.com/users/7178832/tristan-vermeesch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1561815558, "creation_date": 1561814865, "question_id": 56817922, "link": "https://stackoverflow.com/questions/56817922/using-rails-devise-in-api-mode", "title": "Using Rails Devise in API mode", "body": "<p>So as you may know Rails can work as an API only, this will prevent view generations and some other stuff.\nSo now I installed the Devise gem but I don't know how to start working with it.\nI'm using a ReactJS front end but how do I create a user for example? With the views I figured it out before but not with only json requests.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11439790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YkgTfQ-Trt4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYbgZm2xHUtE0PWnMTZhoqXGjjHA/mo/photo.jpg?sz=128", "display_name": "Geni", "link": "https://stackoverflow.com/users/11439790/geni"}, "edited": false, "score": 0, "creation_date": 1561920169, "post_id": 56826067, "comment_id": 100206838, "body": "Thanks a lot for your suggestions. However, I created a &quot; views/favourites/created.js.erb&quot; as stated above. I don&#39;t know if I have to create another view file instead of the &#39;js.erb&#39; file I created above."}, {"owner": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "reply_to_user": {"reputation": 25, "user_id": 11439790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YkgTfQ-Trt4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYbgZm2xHUtE0PWnMTZhoqXGjjHA/mo/photo.jpg?sz=128", "display_name": "Geni", "link": "https://stackoverflow.com/users/11439790/geni"}, "edited": false, "score": 0, "creation_date": 1561986618, "post_id": 56826067, "comment_id": 100224961, "body": "@Geni check your <code>config&#47;initializers&#47;mime_types.rb</code> Maybe you have to add <code>js</code> as a valid type."}], "tags": [], "owner": {"reputation": 830, "user_id": 5136200, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gBAqD.jpg?s=128&g=1", "display_name": "Archer", "link": "https://stackoverflow.com/users/5136200/archer"}, "is_accepted": false, "score": 0, "last_activity_date": 1561908741, "creation_date": 1561908741, "answer_id": 56826067, "question_id": 56817728, "link": "https://stackoverflow.com/questions/56817728/ruby-on-rails-toggling-favourite-button-using-jquery-and-ajax-comes-with-render/56826067#56826067", "title": "Ruby on rails toggling favourite button using jquery and ajax comes with &quot;rendering head :no_content Completed 204 No Content&#39; Error", "body": "<p>Your <code>create</code> method doesn't have a view.<br>\nIf you don't want to respond something, you can add <code>head :ok</code> at the end of the method, to avoid the \"204\" Message.</p>\n\n<p>You can also use <code>head :created</code> if you want to respond with \"201 Created\"</p>\n"}], "owner": {"reputation": 25, "user_id": 11439790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YkgTfQ-Trt4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYbgZm2xHUtE0PWnMTZhoqXGjjHA/mo/photo.jpg?sz=128", "display_name": "Geni", "link": "https://stackoverflow.com/users/11439790/geni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1561925983, "creation_date": 1561813116, "last_edit_date": 1561925983, "question_id": 56817728, "link": "https://stackoverflow.com/questions/56817728/ruby-on-rails-toggling-favourite-button-using-jquery-and-ajax-comes-with-render", "title": "Ruby on rails toggling favourite button using jquery and ajax comes with &quot;rendering head :no_content Completed 204 No Content&#39; Error", "body": "<p>I am trying to create a favourite button where users will be able to use toggle button to 'favourite' a post and 'unfavourite' same depending on what they like. So far if I 'unfavourite' the post it seems to work but whenever i do otherwise the link does not change. I used jquery and ajax.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class FavouritesController &lt; ApplicationController\n  before_action :authenticate_user!\n\n  def create\n    @favourite = current_user.favourites.build(favourite_params)\n    if @favourite.save\n      @post = @favourite.post\n      respond_to :js\n    else\n      flash[:alert] = \"something went wrong...\"\n    end\n  end\n\n  def destroy\n    @favourite = Favourite.find(params[:id])\n    @school = @favourite.post\n    if @favourite.destroy\n      respond_to :js\n    else\n      flash[:alert] = \"Something Went Wrong...\"\n    end\n  end\n\n  private\n\n  def favourite_params\n    params.permit :user_id, :post_id\n  end\nend\n</code></pre>\n\n<p>HERE ARE THE MODELS</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Post &lt; ApplicationRecord\n  belongs_to :user\n  has_many :favourites\n\n  def is_favourited user\n    Favourite.find_by(user_id: user.id, post_id: id)\n  end\nend\n</code></pre>\n\n<p>FAVOURITE MODEL</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Favourite &lt; ApplicationRecord\n  belongs_to :user\n  belongs_to :post\nend\n</code></pre>\n\n<p>CREATED J.S IN THE FAVOURITE VIEW FOLDER I.E: views/favourites/created.js.erb</p>\n\n<pre><code>$('#favourite').html('&lt;%= j render \"posts/favourite\", {is_favourited: \n@is_favourited, post: @post} %&gt;');\nconsole.log(\"Added to your favourite List\");\n</code></pre>\n\n<p>CREATED J.S IN THE FAVOURITE VIEW FOLDER I.E: views/favourites/destroy.js.erb\n/destroy.js.erb</p>\n\n<pre><code>$('#favourite').html('&lt;%= j render \"posts/favourite\", {is_favourited: \n@is_favourited, post: @post} %&gt;');\nconsole.log(\"Added to your favourite List\");\n</code></pre>\n\n<p>FAVOURITE PARTIAL FILE IN THE POSTS FOLDER IE VIEWS/POSTS/_favourite.html.erb</p>\n\n\n\n\n\n  \n\n  \n\n<p>ON THE SHOW PAGE OF THE POST I RENDERED THE PARTIAL LIKE THIS</p>\n\n<pre><code>&lt;%= render 'favourite' %&gt;\n</code></pre>\n\n<p>HERE IS WHAT I GET ON THE CONSOLE</p>\n\n<pre><code>No template found for FavouritesController#create, rendering head \n:no_content Completed 204 No Content in 14084ms (ActiveRecord: 318.1ms)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku"], "comments": [{"owner": {"reputation": 243, "user_id": 10997704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z04CC.jpg?s=128&g=1", "display_name": "Marium", "link": "https://stackoverflow.com/users/10997704/marium"}, "edited": false, "score": 0, "creation_date": 1561836441, "post_id": 56817347, "comment_id": 100193563, "body": "Why is there a negative vote? I explained the question as thoroughly as possible and provided links to code repositories and logs"}], "answers": [{"tags": [], "owner": {"reputation": 1490, "user_id": 753705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3dc5b7c682d4dc91050904b494fcb1d6?s=128&d=identicon&r=PG", "display_name": "abhishek77in", "link": "https://stackoverflow.com/users/753705/abhishek77in"}, "is_accepted": true, "score": 1, "last_activity_date": 1561809594, "creation_date": 1561809594, "answer_id": 56817375, "question_id": 56817347, "link": "https://stackoverflow.com/questions/56817347/heroku-ruby-on-rails-server-logs-says-users-does-not-exist/56817375#56817375", "title": "Heroku Ruby On Rails Server Logs says &#39;Users&#39; does not Exist", "body": "<p><code>PG::UndefinedTable: ERROR</code> means you haven't created the table. You need to run <code>heroku run rake db:migrate</code> so that the tables are added to your <code>Heroku Postgres</code>.</p>\n"}], "owner": {"reputation": 243, "user_id": 10997704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z04CC.jpg?s=128&g=1", "display_name": "Marium", "link": "https://stackoverflow.com/users/10997704/marium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 56817375, "answer_count": 1, "score": -2, "last_activity_date": 1561809594, "creation_date": 1561809339, "question_id": 56817347, "link": "https://stackoverflow.com/questions/56817347/heroku-ruby-on-rails-server-logs-says-users-does-not-exist", "title": "Heroku Ruby On Rails Server Logs says &#39;Users&#39; does not Exist", "body": "<p>I am following <a href=\"https://www.railstutorial.org/book/toy_app\" rel=\"nofollow noreferrer\">Ruby On Rails Book Tutorial, Chapter 2, toy_app</a></p>\n\n<p>Repository is on BitBucket, <a href=\"https://bitbucket.org/Marium36/toy_app/\" rel=\"nofollow noreferrer\">https://bitbucket.org/Marium36/toy_app/</a></p>\n\n<p>So far, I can open the app on my local server, i.e</p>\n\n<pre><code>localhost:3000 \n</code></pre>\n\n<p>and </p>\n\n<pre><code>localhost:3000/users\n</code></pre>\n\n<p>Problem arises with heroku. </p>\n\n<p>Heroku app can only open </p>\n\n<p><a href=\"https://salty-wave-17330.herokuapp.com/\" rel=\"nofollow noreferrer\">https://salty-wave-17330.herokuapp.com/</a></p>\n\n<p>As soon as I attempt</p>\n\n<p><a href=\"https://salty-wave-17330.herokuapp.com/users\" rel=\"nofollow noreferrer\">https://salty-wave-17330.herokuapp.com/users</a></p>\n\n<p>I get error, </p>\n\n<blockquote>\n  <p>We're sorry, but something went wrong. If you are the application\n  owner check the logs for more information.</p>\n</blockquote>\n\n<p>Server logs, <a href=\"https://bitbucket.org/Marium36/toy_app/src/master/heroku_server_logs\" rel=\"nofollow noreferrer\">https://bitbucket.org/Marium36/toy_app/src/master/heroku_server_logs</a></p>\n\n<p>The continual error message that shows is that <code>Users</code> does not exist --- but it does, I can load in my local machine, i.e. <code>localhost:3000/users</code></p>\n\n<p>Please help!!!</p>\n\n<pre><code>2019-06-29T11:24:46.008853+00:00 app[web.1]: I, [2019-06-29T11:24:46.008752 #4]  INFO -- : [5d839ee1-e92f-46d7-81d0-9fd508157239] Started GET \"/users\" for PRIVATE_IP at 2019-06-29 11:24:46 +0000\n2019-06-29T11:24:46.010267+00:00 app[web.1]: I, [2019-06-29T11:24:46.010188 #4]  INFO -- : [5d839ee1-e92f-46d7-81d0-9fd508157239] Processing by UsersController#index as HTML\n2019-06-29T11:24:46.013170+00:00 app[web.1]: I, [2019-06-29T11:24:46.013098 #4]  INFO -- : [5d839ee1-e92f-46d7-81d0-9fd508157239]   Rendering users/index.html.erb within layouts/application\n2019-06-29T11:24:46.055431+00:00 app[web.1]: D, [2019-06-29T11:24:46.055315 #4] DEBUG -- : [5d839ee1-e92f-46d7-81d0-9fd508157239]   User Load (1.5ms)  SELECT \"users\".* FROM \"users\"\n2019-06-29T11:24:46.056103+00:00 app[web.1]: I, [2019-06-29T11:24:46.056041 #4]  INFO -- : [5d839ee1-e92f-46d7-81d0-9fd508157239]   Rendered users/index.html.erb within layouts/application (42.8ms)\n2019-06-29T11:24:46.056339+00:00 app[web.1]: I, [2019-06-29T11:24:46.056280 #4]  INFO -- : [5d839ee1-e92f-46d7-81d0-9fd508157239] Completed 500 Internal Server Error in 46ms (ActiveRecord: 13.4ms)\n2019-06-29T11:24:46.057108+00:00 app[web.1]: F, [2019-06-29T11:24:46.057045 #4] FATAL -- : [5d839ee1-e92f-46d7-81d0-9fd508157239]\n2019-06-29T11:24:46.063287+00:00 app[web.1]: F, [2019-06-29T11:24:46.057141 #4] FATAL -- : [5d839ee1-e92f-46d7-81d0-9fd508157239] ActionView::Template::Error (PG::UndefinedTable: ERROR:  relation \"users\" does not exist\n</code></pre>\n"}]